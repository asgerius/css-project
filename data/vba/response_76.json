[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1466635055, "post_id": 37979332, "comment_id": 63404546, "body": "one glaring issue is this line is not correct syntax: <code>If Left(String_2, 3).Range(&quot;C1&quot;).Select</code> <i>(and all lines like it)</i>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1466635072, "post_id": 37979332, "comment_id": 63404551, "body": "Unclear what <code>Left(String_1, 3).Range(&quot;C1&quot;).Select</code> is supposed to do."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1466635319, "post_id": 37979332, "comment_id": 63404624, "body": "Also, the <code>Fa</code> in <code>Application.CutCopyMode = Fa</code> is an uninitialized variable, so it will be 0.  It expects <code>xlCopy</code> or <code>xlCut</code>, which are 1 and 2 respectively, so that will error as well."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1466635399, "post_id": 37979332, "comment_id": 63404649, "body": "also, are you sure you want this done on the <code>Worksheet_Change</code> event? It will fire <b>everytime</b> you make a change on your sheet (especially because you don&#39;t really filter on Target cell)."}, {"owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466635812, "post_id": 37979332, "comment_id": 63404770, "body": "@ScottHoltzman It does not matter if it fires every time the only purpose of this code is create a file that another program then sees and initiates its purpose."}, {"owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1466636013, "post_id": 37979332, "comment_id": 63404822, "body": "@Comintern I am trying to get his code to select the first three digits from a sequence of numbers that is stored in range C1. Basically I have a bar-code and i scan it. It then sends three sequences of number to cells A1 B1 and C1 respectively, I need the code to read the first three numbers from cell C1 to determine what file to save to a folder."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "edited": false, "score": 0, "creation_date": 1466636642, "post_id": 37979536, "comment_id": 63405018, "body": "Yup that worked, I&#39;ll have to modify to create different files, but this works thank you."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1466636099, "creation_date": 1466636099, "answer_id": 37979536, "question_id": 37979332, "link": "https://stackoverflow.com/questions/37979332/create-a-save-as-file-in-regard-to-a-specified-sequence-of-numbers/37979536#37979536", "title": "create a Save As file in regard to a specified sequence of numbers", "body": "<p>Try something like this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n Dim String_1 As String\n Dim String_2 As String\n Dim String_3 As String\n\n String_1 = \"400\"\n String_2 = \"401\"\n String_3 = \"402\"\n\n If Len(Range(\"A1\").Value) &gt; 0 And Len(Range(\"B1\").Value) &gt; 0 And Len(Range(\"C1\").Value) &gt; 0 Then \n\n   Dim sComp as String\n   sComp = Left(Range(\"C1\"),3)\n\n     If sComp = String_1 or sComp = String_2 or sComp = String_3 Then\n\n        Range(\"A1:C1\").Copy\n        Dim wbCopy as Workbook\n        Set wbCopy = Workbooks.Add\n\n        With wbCopy\n           .Sheets(1).Range(\"A1\").PasteSpecial xlPasteValues\n           .SaveAs Filename:=\"u:\\CSV\\Diepunch\" &amp; sComp &amp; \".csv\", FileFormat:=xlCSV, CreateBackup:=False\n           .Close False\n        End With\n\n    End If\n\n End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 37979536, "answer_count": 1, "score": 0, "last_activity_date": 1466636099, "creation_date": 1466634858, "last_edit_date": 1531164843, "question_id": 37979332, "link": "https://stackoverflow.com/questions/37979332/create-a-save-as-file-in-regard-to-a-specified-sequence-of-numbers", "title": "create a Save As file in regard to a specified sequence of numbers", "body": "<p>I am trying to get VBA to to save a file dependent upon the first three sequenced numbers in a 9 digit number. The number looks something like this: 400-134004. I need to make three different files depending on the first sequence of numbers, they are 400, 401, 402. How do I go about it, or what is wrong with my code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n        Dim String_1 As String\n        Dim String_2 As String\n        Dim String_3 As String\n\n        String_1 = \"400\"\n        String_2 = \"401\"\n        String_2 = \"402\"\n\n  If Not Range(\"A1\").Value = \"\" And Not Range(\"B1\").Value = \"\" And Not Range(\"C1\").Value = \"\" Then\n\n  If Left(String_1, 3).Range(\"C1\").Select Then\n        '400 = 312B\n    ActiveCell.Offset(-1, 0).Range(\"A1:C1\").Select\n    Selection.Copy\n    Workbooks.Add\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = Fa\n    ActiveWorkbook.SaveAs Filename:=\"u:\\CSV\\Diepunch400.csv\", FileFormat:=xlCSV, CreateBackup:=False\n    ActiveWorkbook.Save\n    ActiveWindow.Close (SaveChange = False)\n  Else\n\n  End If\n\n  If Left(String_2, 3).Range(\"C1\").Select Then\n        '401 = 312HTG\n    ActiveCell.Offset(-1, 0).Range(\"A1:C1\").Select\n    Selection.Copy\n    Workbooks.Add\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = Fa\n    ActiveWorkbook.SaveAs Filename:=\"u:\\CSV\\Diepunch401.csv\", FileFormat:=xlCSV, CreateBackup:=False\n    ActiveWorkbook.Save\n    ActiveWindow.Close (SaveChange = False)\n   Else\n\n   End If\n\n       If Left(String_3, 3).Range(\"C1\").Select Then\n        '402 = 312HTX\n    ActiveCell.Offset(-1, 0).Range(\"A1:C1\").Select\n    Selection.Copy\n    Workbooks.Add\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    Application.CutCopyMode = Fa\n    ActiveWorkbook.SaveAs Filename:=\"u:\\CSV\\Diepunch402.csv\", FileFormat:=xlCSV, CreateBackup:=False\n    ActiveWorkbook.Save\n    ActiveWindow.Close (SaveChange = False)\n    Else\n\n    End If\n\n\n\n\n     Else\n\n     End If\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "edited": false, "score": 0, "creation_date": 1466634088, "post_id": 37979168, "comment_id": 63404271, "body": "<code>.HasFormlua</code> might need changing ;)"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "edited": false, "score": 0, "creation_date": 1466720447, "post_id": 37981070, "comment_id": 63449692, "body": "Thomas, Thank you for the code.  I have copied and pasted the code into VB but it doesn&#39;t do anything.  Nothing happens when i hit execute."}, {"owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "edited": false, "score": 0, "creation_date": 1466730821, "post_id": 37981070, "comment_id": 63452306, "body": "my apologies - it&#39;s working-ish now. The numeric cells have a formula in them on &#39;Key&#39; sheets, so that&#39;s why it wasn&#39;t working. However, the numeric cells (with formulas) on the &#39;Key&#39; sheet show #N/A until it&#39;s copied across to it&#39;s own sheet.  It is designed to show/calculate a value when copied to a different sheet. As long as it&#39;s on &#39;Key&#39;sheet it will show #N/A, hence, using &#39;Hasformula&#39; in code. Also the code is not copying the text cells (B:E) on first row of each product on &#39;key&#39; sheet to its own sheet on row one (H:K). Once the formula row is copied it needs to fill to last row."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1466721513, "last_edit_date": 1466721513, "creation_date": 1466647023, "answer_id": 37981070, "question_id": 37979168, "link": "https://stackoverflow.com/questions/37979168/copying-only-specific-cells-to-different-sheets-if-certain-conditions-are-true/37981070#37981070", "title": "Copying only specific cells to different sheets if certain conditions are true", "body": "<p>This should help.  I didn't do anything with the header row because I don't know why you would have to change it one, let alone once for each record.  </p>\n\n<pre><code>Sub copy_Text_Formulas_to_sheets1()\n    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\n    Dim Lastrow As Long, i As Long\n    Dim msg as String\n    Set ws1 = ThisWorkbook.Worksheets(\"Key\")    'this is the sheet I'm pulling data     from\n    Set ws2 = ThisWorkbook.Worksheets(\"Fizzy Drink\")    'this is the worksheet I'm pulling data into for Prd1\n    Set ws3 = ThisWorkbook.Worksheets(\"still water\")    'this is the worksheet I'm pulling data into for Prd2\n\n    With ws1\n        Lastrow = .Cells(ws1.rowS.Count, \"A\").End(xlUp).Row\n        MsgBox \"Last Row:\" &amp; Lastrow \n\n        For i = 1 To Lastrow\n            msg = msg  &amp; .Cells(i, \"A\") &amp; vbcrlf\n            If IsNumeric(.Cells(i, 2)) Then\n                If .Cells(i, \"A\").value = \"Fizzy Drink\" Then\n                    .Range(.Cells(i, \"B\"), .Cells(i, \"E\")).Copy getNextRow(ws2, \"H\")\n                ElseIf .Cells(i, \"A\").value = \"Still water\" Then\n                    .Range(.Cells(i, \"B\"), .Cells(i, \"E\")).Copy getNextRow(ws3, \"H\")\n                End If\n            End If\n        Next\n       MsgBox \"Range B2 is Numeric:\" &amp; .Cells(2, 2) &amp; vbCrLF &amp; \"Range B3 is Numeric:\" &amp; .Cells(3, 2)\n                  MsgBox \"Range B2 has formula:\" &amp; .Cells(2, 2).HasFormula &amp; vbCrLF &amp; \"Range B3 has formula:\" &amp; .Cells(3, 2).HasFormula\n       MsgBox msg\n    End With\nEnd Sub\n\nFunction getNextRow(xlWorksheet As Worksheet, colmnLetter As String) As Range\n    Set getNextRow = xlWorksheet.Cells(rowS.Count, colmnLetter).End(xlUp).Offset(1, 0)\nEnd Function\n</code></pre>\n\n<p>I added a couple of message to see what's up. Let me know what you  get back.  Can you provide a download link with sample data? </p>\n"}], "owner": {"reputation": 59, "user_id": 6138950, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/eedeb65e7ec6ea107e30c8ea90780983?s=128&d=identicon&r=PG&f=1", "display_name": "Zakky", "link": "https://stackoverflow.com/users/6138950/zakky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466721513, "creation_date": 1466633839, "last_edit_date": 1531164843, "question_id": 37979168, "link": "https://stackoverflow.com/questions/37979168/copying-only-specific-cells-to-different-sheets-if-certain-conditions-are-true", "title": "Copying only specific cells to different sheets if certain conditions are true", "body": "<p>I am working with 4 rows (test bed for my code) and each product is allocated 2 rows: Data range is A1:E5</p>\n\n<pre><code>Fizzy Drink Australia   Perth   no sugar    High\nFizzy Drink    3          5        7         5\nStill water Australia   Perth   flavoured   High\nStill water    4          7        5         4\n</code></pre>\n\n<p>The above is on sheet 1 and there's a sheet for each produce i.e. total 3 sheets. I'm using a For loop in column 'A' to find the product and then copy the text in each of the 4 columns to the right onto the respective product sheets in columns H1:K1. This text acts as headers for each product sheet, so the headers are not the same for each product. Each product's text must be copied to the correct product sheet. </p>\n\n<p>I'm having problems copying the text attached in the first row against each product in column 'A', as the 2nd row has values. The format is same for all the products - 2 rows - first row for text and second for formulas.</p>\n\n<p>The challenge (which I have failed miserably) is to make the code copy text in columns B:E for each particular product.\nThe text can change on often basis so if the code can identify the product in column 'A' and copy/paste the text that would be fantastic.</p>\n\n<pre><code>Option Explicit\nSub copy_Text_Formulas_to_sheets\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim Lastrow As Long\nDim Lastrow1 As Long\nDim Lastrow2 As Long\nDim i As Integer\nDim j As Integer\n\nSet ws1 = ThisWorkbook.Worksheets(\"Key\") 'this is the sheet I'm pulling data     from\nSet ws2 = ThisWorkbook.Worksheets(\"Fizzy Drink\") 'this is the worksheet I'm pulling data into for Prd1\nSet ws3 = ThisWorkbook.Worksheets(\"still water\") 'this is the worksheet I'm pulling data into for Prd2\n\nLastrow = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\nLastrow1 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row\nLastrow2 = ws3.Cells(ws3.Rows.Count, \"A\").End(xlUp).Row\n\n\n\nFor i = 1 To Lastrow\nFor j = 1 To Lastrow\n\nIf ws1.Cells(i, \"A\").Value = \"Fizzy Drink\" And ws1.Cells(i, \"B\").Value = \"Australia\" And _\nws1.Cells(i, \"C\").Value = \"Perth\" And ws1.Cells(i, \"D\").Value = \"no sugar\" And ws1.Cells(i, \"E\").Value = \"High\" Then\nws1.Range(\"B\" &amp; i, \"E\" &amp; i).Copy 'copy row with text from B to E including all formatting\nws2.Select\nws2.Range(\"H1:K1\").PasteSpecial xlPasteValues\n'If the above conditions are not met msg user\nEnd If\n\nIf ws1.Cells(j, \"A\").Value = \"Fizzy Drink\" And ws1.Range(i,\"B:E\").HasFormlua Then\nws2.Range(\"B2:E2\") = ws1.Range(j, \"H:K\") 'copy the formulas in row B:E with relative references\n'If the above conditions are not met msg user\nEnd If\n\nIf ws1.Cells(i, \"A\").Value = \"still water\" And ws1.Cells(i, \"B\").Value = \"Australia\" And _\nws1.Cells(i, \"C\").Value = \"Perth\" And ws1.Cells(i, \"D\").Value = \"flavoured\" And ws1.Cells(i, \"E\").Value = \"High\" Then\nws1.Range(\"B\" &amp; i, \"E\" &amp; i).Copy 'copy row with text from B to E including all formatting\nws3.Select\nws3.Range(\"H1:K1\").PasteSpecial xlPasteValues 'copy including all formatting\n'If the above conditions are not met msg user\nEnd If\nIf ws1.Cells(j, \"A\").Value = \"still water\" And ws1.Range(i, \"B:E\").HasFormlua Then\nws2.Range(\"B2:E2\") = ws1.Range(j, \"H:K\") 'copy the formulas in row B:E with relative references\n'If the above conditions are not met msg user\nEnd If\nNext j\nNext i\n\nOn Error Resume Next\nws2.Range(\"B2:E2\").AutoFill Destination:=Range(\"B2:E\" &amp; Lastrow1) 'copy formula in row to down to lastrow\nws3.Range(\"B2:E2\").AutoFill Destination:=Range(\"B2:E\" &amp; Lastrow2) 'copy formula in row to down to lastrow\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "edited": false, "score": 0, "creation_date": 1466634542, "post_id": 37979133, "comment_id": 63404412, "body": "<code>Application.ScreenUpdating = False For ... Next Application.ScreenUpdating = True</code> Might speed it up a bit"}, {"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466635750, "post_id": 37979133, "comment_id": 63404760, "body": "What is your Selection ? If it&#39;s the whole worksheet remember it&#39;s  1,048,576 rows by 16,384 columns (billions of operations). Limit your selection and it will be much more faster"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1466636889, "post_id": 37979133, "comment_id": 63405091, "body": "Try <a href=\"http://codereview.stackexchange.com/\">code review</a>"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1466637564, "post_id": 37979133, "comment_id": 63405278, "body": "You can turn off calculations: <code>Application.Calculation = xlCalculationManual</code> before entering the loop and <code>Application.Calculation = xlCalculationAutomatic</code> after exiting."}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466634327, "post_id": 37979193, "comment_id": 63404347, "body": "It seems we had the same idea."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466640694, "post_id": 37979193, "comment_id": 63406049, "body": "@Ralph I should have been quicker!"}], "tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1466640605, "last_edit_date": 1466640605, "creation_date": 1466633979, "answer_id": 37979193, "question_id": 37979133, "link": "https://stackoverflow.com/questions/37979133/vba-absolute-macro-taking-forver/37979193#37979193", "title": "VBA absolute macro taking forver", "body": "<p>I think you can save the range to an array, then process the array and write it back to the range, not tested but should be close.</p>\n\n<pre><code>Dim myArr() As Variant\nmyArr = Range(\"A1:A10\")\nDim iCount As Long\nFor iCount = LBound(myArr) To UBound(myArr)\n   myArr(iCount) = abs(myArr(iCount))\nNext iCount\nRange(\"A1:A10\") = myArr\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 4, "last_activity_date": 1466634219, "creation_date": 1466634219, "answer_id": 37979231, "question_id": 37979133, "link": "https://stackoverflow.com/questions/37979133/vba-absolute-macro-taking-forver/37979231#37979231", "title": "VBA absolute macro taking forver", "body": "<p>Give this a try and let me know how the performance is:</p>\n\n<pre><code>Option Explicit\n\nSub Positive()\n\nDim varArray As Variant\nDim lngRow As Long, lngColumn As Long\n\nvarArray = Selection.Value2\nFor lngRow = LBound(varArray, 1) To UBound(varArray, 1)\n    For lngColumn = LBound(varArray, 2) To UBound(varArray, 2)\n        If IsNumeric(varArray(lngRow, lngColumn)) Then\n            varArray(lngRow, lngColumn) = Abs(varArray(lngRow, lngColumn))\n        End If\n    Next lngColumn\nNext lngRow\nSelection.Value2 = varArray\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 32, "user_id": 5583494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mFAOB.png?s=128&g=1", "display_name": "ttrigger10", "link": "https://stackoverflow.com/users/5583494/ttrigger10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 37979231, "answer_count": 2, "score": 0, "last_activity_date": 1466640605, "creation_date": 1466633646, "last_edit_date": 1531164843, "question_id": 37979133, "link": "https://stackoverflow.com/questions/37979133/vba-absolute-macro-taking-forver", "title": "VBA absolute macro taking forver", "body": "<p>I am trying to make a select column of cells all be positive. I created this macro and it is working....just taking awhile. It's been running for probably 5min now. Mind you I do have 200k rows of data for it to search through...Anyone else have this problem before or ideas for it to be faster for next time???</p>\n\n<pre><code>Sub Positive()\nDim Cel As Range\nFor Each Cel In Selection \nIf IsNumeric(Cel.Value) Then\nCel.Value = Abs(Cel.Value)\nEnd If\nNext Cel \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466634342, "post_id": 37979105, "comment_id": 63404354, "body": "do you have any error ? Or the code just not run. I should run a test, but if you already set NewFileName as active workbook, you shouldn&#39;t need to specify the &quot;NewFileName&quot; in the Application.Run()"}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466634709, "post_id": 37979105, "comment_id": 63404445, "body": "@MaximePort&#233;, no error message or other complain from EXCEL. That is really strange, and I am not sure how to catch this error. Sometimes, the issue goes after after rebooting machine..."}, {"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466635174, "post_id": 37979105, "comment_id": 63404586, "body": "What is the value of &quot;NewFileName&quot; ? And from where do you call this code ? (A sub / function, an event ? which one) edit: take a look in the &quot;Macro&quot; button (your workbook NewFileName needs to be opened and set yourself on an other workbook), what is the display name of your Autorun function in it ?"}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466635648, "post_id": 37979105, "comment_id": 63404731, "body": "@MaximePort&#233;,  <code>NewFileName</code> is the EXCEL file to be called. I call this macro from a <code>sub</code>. I have verified that ` &quot;&#39;&quot; &amp; NewFileName &amp; &quot;&#39;!AUTORUN&quot; ` is correct."}, {"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466635896, "post_id": 37979105, "comment_id": 63404793, "body": "I know NewFileName is the excel file to be called ;) I asked for the value of this variable, I will run some test later in the day if you hadn&#39;t find it until then."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466636249, "post_id": 37979105, "comment_id": 63404899, "body": "@MaximePort&#233;, sorry my bad, and value of NewFileName is something like <code>test_6_22_2016.xlsm</code>. Thanks for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "is_accepted": false, "score": 1, "last_activity_date": 1466670587, "creation_date": 1466670587, "answer_id": 37986142, "question_id": 37979105, "link": "https://stackoverflow.com/questions/37979105/calling-a-macro-from-another-workbook-not-always-being-executed/37986142#37986142", "title": "Calling a macro from another workbook not always being executed", "body": "<p>I run some tests</p>\n\n<p><strong>File 1 (the caller):</strong></p>\n\n<p>The method AAATEST() is in a Module</p>\n\n<pre><code>Public Sub AAATEST()\n    Dim file As String: file = \"test.xlsm\"\n    call Workbooks.Open(\"C:\\temp\\\" &amp; file)\n\n    Workbooks(file).Activate\n    Call Application.Run(\"'\" &amp; file &amp; \"'!AUTORUN\")\nEnd Sub\n</code></pre>\n\n<p><strong>File 2 (with autorun):</strong></p>\n\n<p>The method AUTORUN() is in a Module</p>\n\n<pre><code>Public Sub AUTORUN()\n    MsgBox \"autorun is my life\"\nEnd Sub\n</code></pre>\n\n<p><strong>Result:</strong></p>\n\n<p>I always receive the message when running the AAATEST() method. I suspect a not raised error in the AUTORUN.</p>\n\n<p>To check if the Autorun is run or not, add Stop as first instruction in your Method and execute your code step by step (with F8)</p>\n\n<pre><code>Public Sub AUTORUN()\n    Stop\n    ...\n    MsgBox \"autorun is my life\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466670587, "creation_date": 1466633497, "last_edit_date": 1466633518, "question_id": 37979105, "link": "https://stackoverflow.com/questions/37979105/calling-a-macro-from-another-workbook-not-always-being-executed", "title": "Calling a macro from another workbook not always being executed", "body": "<p>In <code>Excel Workbook A</code>, I have a <code>macro</code> which</p>\n\n<ol>\n<li>fills inputs for a series of other workbooks </li>\n<li>calls the <code>AUTORUN</code> </li>\n<li>collects results in a summary tab</li>\n</ol>\n\n<p>The logic is quite simple but I found that <code>Step 2</code> is not always being executed, which is quite strange... I have <code>confirmed</code> that inputs have been properly entered and I can go each failed Excel workbook and run the simulation by clicking the button linked to <code>AUTORUN</code>. Does anyone have any suggestions on this (I am using EXCEL 2013)? Thanks in advance! Below is how <code>macro</code> from a different workbook is called. </p>\n\n<pre><code>        Workbooks(NewFileName).Activate\n        Application.Run (\"'\" &amp; NewFileName &amp; \"'!AUTORUN\")\n</code></pre>\n"}, {"tags": ["excel", "http-post", "multipartform-data", "boundary", "vba"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 6472210, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10107642683817285/picture?type=large", "display_name": "Zach Rochon", "link": "https://stackoverflow.com/users/6472210/zach-rochon"}, "edited": false, "score": 0, "creation_date": 1466633356, "post_id": 37979027, "comment_id": 63404033, "body": "without that line, I get the same error unfortunately"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 75, "user_id": 6472210, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10107642683817285/picture?type=large", "display_name": "Zach Rochon", "link": "https://stackoverflow.com/users/6472210/zach-rochon"}, "edited": false, "score": 0, "creation_date": 1466633530, "post_id": 37979027, "comment_id": 63404078, "body": "Yes - but it has to be correct. I&#39;ll update my post with code"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 75, "user_id": 6472210, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10107642683817285/picture?type=large", "display_name": "Zach Rochon", "link": "https://stackoverflow.com/users/6472210/zach-rochon"}, "edited": false, "score": 0, "creation_date": 1466634035, "post_id": 37979027, "comment_id": 63404250, "body": "Personally I&#39;d also prefer closing the workbook before you do all the sending stuff. It&#39;ll guarantee correct file size and remove any possibility of cached changes or possible locks on file. I&#39;d move the close wb line <code>newwkb.Close</code> tojust after <code>Call getToken</code>"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1466633793, "last_edit_date": 1466633793, "creation_date": 1466633024, "answer_id": 37979027, "question_id": 37978851, "link": "https://stackoverflow.com/questions/37978851/post-multipart-form-data-failing-corrupt-form-data-premature-ending/37979027#37979027", "title": "Post Multipart/Form-Data Failing, corrupt form data: premature ending", "body": "<p>EDIT - Add code for using correct file length</p>\n\n<p>At top of sub add:</p>\n\n<pre><code>Dim strFilename     As String\nDim lngFileLen      as Long\n</code></pre>\n\n<p>Change your call to <code>newwkb.SaveAs</code> to these three lines</p>\n\n<pre><code>strFilename = \"E:\\Documents\\PunchImport\" &amp; Format(Now(), \"yyyymmddhhmmss\") &amp; \".xls\"\nnewwkb.SaveAs (strFilename), 56\nlngFileLen = FileLen(strFilename)\n</code></pre>\n\n<p>Change this line</p>\n\n<pre><code>myrequestop.setRequestHeader \"Content-length\", 1000\n</code></pre>\n\n<p>To this</p>\n\n<pre><code>myrequestop.setRequestHeader \"Content-length\", lngFileLen\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 6472210, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10107642683817285/picture?type=large", "display_name": "Zach Rochon", "link": "https://stackoverflow.com/users/6472210/zach-rochon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 545, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1466633793, "creation_date": 1466632132, "last_edit_date": 1531161705, "question_id": 37978851, "link": "https://stackoverflow.com/questions/37978851/post-multipart-form-data-failing-corrupt-form-data-premature-ending", "title": "Post Multipart/Form-Data Failing, corrupt form data: premature ending", "body": "<p>I'm getting an error code that I cannot figure out!  In my vba I am creating an excel file and uploading it to a server using POST.  I can manually import this file no problem, but for some reason my code is getting a failure response from the server - code 415, corrupt form data: premature ending.</p>\n\n<pre><code>Sub offline_punch()\n\nDim newwkb As Workbook\nDim thiswkb As Workbook\nDim URLReportop As String\nDim myrequestop As Object\nDim LastRow As Long\nDim LastColumn As Long\nDim StartCell As Range\n\nSet thiswkb = ActiveWorkbook\nSet StartCell = thiswkb.Worksheets(\"offline_punch\").Range(\"A1\")\nSet newwkb = Workbooks.Add\n\n\n'Find LastRow and LastColumn\nLastRow = thiswkb.Worksheets(\"offline_punch\").Cells(thiswkb.Worksheets(\"offline_punch\").Rows.Count, StartCell.Column).End(xlUp).Row\nLastColumn = thiswkb.Worksheets(\"offline_punch\").Cells(StartCell.Row, thiswkb.Worksheets(\"offline_punch\").Columns.Count).End(xlToLeft).Column\nthiswkb.Worksheets(\"offline_punch\").Range(StartCell, thiswkb.Worksheets(\"offline_punch\").Cells(LastRow, LastColumn)).Copy\nnewwkb.Worksheets(\"sheet1\").Range(\"A1\").PasteSpecial xlPasteValues\nnewwkb.SaveAs (\"E:\\Documents\\PunchImport\" &amp; Format(Now(), \"yyyymmddhhmmss\") &amp; \".xls\"), 56\nthiswkb.Activate\nCall getToken\n\n'Send raw punch import to wfr\nSet myrequestop = CreateObject(\"winhttp.winhttprequest.5.1\")\nURLReportop = (\"https://secure.saashr.com:443/ta/rest/v1/import/119\")\nmyrequestop.Open \"POST\", URLReportop, False\nmyrequestop.setRequestHeader \"Authentication\", \"Bearer \" &amp; Token\nmyrequestop.setRequestHeader \"Content-Type\", \"multipart/form-data; boundary=abcdefghi-jklmnop; charset=UTF-8\"\nmyrequestop.setRequestHeader \"Content-length\", 1000\nmyrequestop.Send newwkb\n\nMsgBox (myrequestop.responseText &amp; \" \" &amp; Now)\n\nnewwkb.Close\nSet newwkb = Nothing\nthiswkb.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6387778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7938b5b13f0db076e8c732d192b4bb48?s=128&d=identicon&r=PG&f=1", "display_name": "Emma Tucker", "link": "https://stackoverflow.com/users/6387778/emma-tucker"}, "edited": false, "score": 0, "creation_date": 1466700258, "post_id": 37978873, "comment_id": 63438415, "body": "For some reason it&#39;s still not taking that last line. What does Resize do?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 55, "user_id": 6387778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7938b5b13f0db076e8c732d192b4bb48?s=128&d=identicon&r=PG&f=1", "display_name": "Emma Tucker", "link": "https://stackoverflow.com/users/6387778/emma-tucker"}, "edited": false, "score": 0, "creation_date": 1466700538, "post_id": 37978873, "comment_id": 63438576, "body": "I do not get that mine compiles just fine. Did you copy and paste everything?  Are you sure you got the whole line and replaced all the correct lines?"}, {"owner": {"reputation": 55, "user_id": 6387778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7938b5b13f0db076e8c732d192b4bb48?s=128&d=identicon&r=PG&f=1", "display_name": "Emma Tucker", "link": "https://stackoverflow.com/users/6387778/emma-tucker"}, "edited": false, "score": 0, "creation_date": 1466700732, "post_id": 37978873, "comment_id": 63438692, "body": "I think it&#39;s because I didn&#39;t add the space between 1, and 2. it just worked."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 55, "user_id": 6387778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7938b5b13f0db076e8c732d192b4bb48?s=128&d=identicon&r=PG&f=1", "display_name": "Emma Tucker", "link": "https://stackoverflow.com/users/6387778/emma-tucker"}, "edited": false, "score": 0, "creation_date": 1466700794, "post_id": 37978873, "comment_id": 63438747, "body": "@EmmaTucker feel free to mark as correct, by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1466632263, "creation_date": 1466632263, "answer_id": 37978873, "question_id": 37978805, "link": "https://stackoverflow.com/questions/37978805/copy-and-paste-value-to-a-destination/37978873#37978873", "title": "Copy and paste value to a destination", "body": "<ol>\n<li><p>Cells() format is <code>Cells(Rows,Column)</code> You probably want Range().</p></li>\n<li><p>When just pasting the values it is faster to just assign it directly.</p></li>\n<li><p>The Cells() was missing the <code>.</code> in front so it was not assigned to the proper parent sheet.</p></li>\n</ol>\n\n<p>Use this:</p>\n\n<pre><code>Sub Test()\n'\n' UpdateTablesAndCharts Macro\n'\n' Keyboard Shortcut: Option+Cmd+t\n'\n\n\nDim lngNextEmptyRow As Long\nDim lngLastImportRow As Long\nDim shtYstrdy As Worksheet\nSet shtYstrdy = ThisWorkbook.Worksheets(\"Yesterday\")\n\nWith ThisWorkbook.Worksheets(\"ICT Historical Crashlytics Data\")\n    lngNextEmptyRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    .Rows(lngNextEmptyRow).Insert Shift:=xlDown\n    .Cells(lngNextEmptyRow, \"A\").Value2 = _\n        .Cells(lngNextEmptyRow - 1, \"A\").Value2 + 1\n    .Range(\"A\" &amp; lngNextEmptyRow).Resize(1, 2).Value = shtYstrdy.Range(\"AM1:AN1\").Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6387778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7938b5b13f0db076e8c732d192b4bb48?s=128&d=identicon&r=PG&f=1", "display_name": "Emma Tucker", "link": "https://stackoverflow.com/users/6387778/emma-tucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466632263, "creation_date": 1466631911, "question_id": 37978805, "link": "https://stackoverflow.com/questions/37978805/copy-and-paste-value-to-a-destination", "title": "Copy and paste value to a destination", "body": "<p>I'm copying data from one sheet with yesterday's information to another sheet with a table of historical data. The first sheet is actually a vlookup formula, so I need to only paste the value to the historical table.  This is what I wrote, but it's saying that the last line doesn't work. Can anyone help?</p>\n\n<pre><code>Option Explicit\n\n\nSub Test()\n'\n' UpdateTablesAndCharts Macro\n'\n' Keyboard Shortcut: Option+Cmd+t\n'\n\n\nDim lngNextEmptyRow As Long\nDim lngLastImportRow As Long\nDim shtYstrdy As Worksheet\nSet shtYstrdy = ThisWorkbook.Worksheets(\"Yesterday\")\n\nWith ThisWorkbook.Worksheets(\"ICT Historical Crashlytics Data\")\nlngNextEmptyRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n.Rows(lngNextEmptyRow).Insert Shift:=xlDown\n.Cells(lngNextEmptyRow, \"A\").Value2 = _\n    .Cells(lngNextEmptyRow - 1, \"A\").Value2 + 1\nshtYstrdy.Range(\"AM1:AN1\").Copy\n    Cells(\"A\" &amp; lngNextEmptyRow).PasteSpecial xlPasteValues\n\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "tsql", "vb6"], "comments": [{"owner": {"reputation": 5511, "user_id": 1017065, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4yZUh.jpg?s=128&g=1", "display_name": "FLICKER", "link": "https://stackoverflow.com/users/1017065/flicker"}, "edited": false, "score": 0, "creation_date": 1466639201, "post_id": 37978439, "comment_id": 63405695, "body": "if you know the CASE syntax in SQL, it should be strait forward. is there anything special in this? Have you tried any query so far?"}], "answers": [{"comments": [{"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1466693559, "post_id": 37989961, "comment_id": 63433751, "body": "Thank you for your answer it is very helpful. I have a question, if you take a look, the VB CASE begins with Select Case Left(ID, 2) Case &quot;MN&quot;, then within that Case, there is another one: Select Case Right(PID, 2)  Case &quot;LC&quot;, &quot;LS&quot;, &quot;LM&quot;. How will these be done using IF/ ELSE? would a nested be the choice? Thank you."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1466685689, "last_edit_date": 1466685689, "creation_date": 1466680275, "answer_id": 37989961, "question_id": 37978439, "link": "https://stackoverflow.com/questions/37978439/vb-t-sql-how-to-convert-a-select-case-to-proper-t-sql-2012-syntax/37989961#37989961", "title": "VB, T-SQL: How to convert a Select Case to proper T-SQL (2012) syntax", "body": "<p><code>CASE</code> in VB is for control of logical flow, <code>CASE</code> in T-SQL is an <em>expression</em> intended to return a single value; the two are not equivalent despite their shared name.</p>\n\n<p>You can port what you have to SQL using <code>IF/ELSE</code> in place of the <code>SELECT CASE</code>.  You cannot replicate it exactly without using dynamic SQL/<code>sp_ExecuteSQL</code> as you build statements in strings, instead use complete inline statements in your SP:</p>\n\n<pre><code>IF (RIGHT(@PID, 2) IN ('LC', 'LS', 'LM'))\n   INSERT INTO TABLE SELECT COLUMNS ... WHERE COLUMN = @ID\nELSE IF ...\n</code></pre>\n\n<p>An alternative would be to keep the logic in B and call different procedures as appropriate.</p>\n"}], "owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 37989961, "answer_count": 1, "score": 0, "last_activity_date": 1466685689, "creation_date": 1466630384, "question_id": 37978439, "link": "https://stackoverflow.com/questions/37978439/vb-t-sql-how-to-convert-a-select-case-to-proper-t-sql-2012-syntax", "title": "VB, T-SQL: How to convert a Select Case to proper T-SQL (2012) syntax", "body": "<p>I am continuing migrating visual basic code to a SQL stored procedure. This is something I am doing for the first time, and I am not sure as what is the best practice, or approach when converting the code.</p>\n\n<p>I am dealing now with a Select Case statement. It is dependent on the value of the leftmost or rightmost characters of an input string, based on those values, the source SELECT part of the INSERT statement is determined.</p>\n\n<p>I was wondering if I could get some coding help, something that would help me start with, or a recommendation on how this can be efficiently managed by T-SQL code. Any help is appreciated it.</p>\n\n<p>Here is the template of the VB Select Case statement:</p>\n\n<pre><code>    Select Case Left(ID, 2)\n\n    Case \"MN\"                                        \n\n        QSQL = \"INSERT INTO table \"\n\n        Select Case Right(PID, 2)                        \n\n            Case \"LC\", \"LS\", \"LM\"\n\n                QSQL = QSQL &amp; \"SELECT columns \" \n                            &amp; \"FROM table \" _\n                            &amp; \"WHERE ((column) = '\" &amp; ID &amp; \"'));\"\n\n            Case Else\n\n                If Mid(ID, 3, 1) &lt;&gt; \"0\" Then\n\n                    QSQL = \"INSERT INTO table \"\n                    QSQL = QSQL &amp; \"SELECT columns\"\n                    QSQL = QSQL &amp; \"FROM table WHERE column ='\" &amp; PID &amp; \"';\"\n\n                Else\n\n                    If InStr(PID, \"_\") = 10 Then                                    \n\n                        QSQL = QSQL &amp; \"SELECT columns \"\n                        QSQL = QSQL &amp; \"FROM table\"\n                        QSQL = QSQL &amp; \"WHERE column = '\" &amp; ID &amp; \"';\"\n                    Else\n\n                        QSQL = QSQL &amp; \"SELECT columns \"\n                        QSQL = QSQL &amp; \"FROM table \"\n                        QSQL = QSQL &amp; \"WHERE column = '\" &amp; ID &amp; \"';\"\n                    End If\n\n                End If\n\n        End Select\n\n    Case \"CL\"\n\n    Case \"GT\"\n\n    Case \"SC\"\n\n    Case \"MS\"\n\n    Case Else\n\nEnd Select\n</code></pre>\n"}, {"tags": ["javascript", "html", "vba", "excel"], "comments": [{"owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "edited": false, "score": 1, "creation_date": 1466630444, "post_id": 37978352, "comment_id": 63402864, "body": "Have you tried using <code>Set jocation = doc.getElementsByClassName(&quot;paginationLink&quot;)(1)</code>. VBA likes to strongly define objects."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466630579, "post_id": 37978352, "comment_id": 63402922, "body": "perhaps there&#39;s an id associated with the <code>Previous</code> and <code>Next</code> button?"}, {"owner": {"reputation": 73, "user_id": 4382544, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-dkjLhP-I4UA/AAAAAAAAAAI/AAAAAAAAACA/lFokpb3fKuQ/photo.jpg?sz=128", "display_name": "Goku Frieza", "link": "https://stackoverflow.com/users/4382544/goku-frieza"}, "edited": false, "score": 0, "creation_date": 1466630908, "post_id": 37978352, "comment_id": 63403067, "body": "Yes, tried now. It works. :)"}, {"owner": {"reputation": 73, "user_id": 4382544, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-dkjLhP-I4UA/AAAAAAAAAAI/AAAAAAAAACA/lFokpb3fKuQ/photo.jpg?sz=128", "display_name": "Goku Frieza", "link": "https://stackoverflow.com/users/4382544/goku-frieza"}, "edited": false, "score": 1, "creation_date": 1466630955, "post_id": 37978352, "comment_id": 63403094, "body": "VBA likes to strongly define objects."}], "owner": {"reputation": 73, "user_id": 4382544, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh6.googleusercontent.com/-dkjLhP-I4UA/AAAAAAAAAAI/AAAAAAAAACA/lFokpb3fKuQ/photo.jpg?sz=128", "display_name": "Goku Frieza", "link": "https://stackoverflow.com/users/4382544/goku-frieza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466630096, "creation_date": 1466630096, "question_id": 37978352, "link": "https://stackoverflow.com/questions/37978352/object-required-error-on-clicking-dynamically-generated-link-in-vba", "title": "Object required: Error on clicking dynamically generated link in VBA", "body": "<p>I am relatively new to VBA and was working on parsing a website using VBA. This website had dynamically generated table elements with pagination.</p>\n\n<pre><code>&lt;a onclick=\"showPage(this.href); return false;\" href=\"/member-finder?p=2\" class=\"paginationLink\"&gt;Next &amp;gt;&lt;/a&gt;\n</code></pre>\n\n<p>After I click on next, previous button comes up in the next page</p>\n\n<pre><code>&gt; &lt;a onclick=\"showPage(this.href); return false;\"\n&gt; href=\"/member-finder?p=1\" class=\"paginationLink\"&gt;&amp;lt; Previous&lt;/a&gt;\n&gt; \n&gt; &lt;a onclick=\"showPage(this.href); return false;\"\n&gt; href=\"/member-finder?p=3\" class=\"paginationLink\"&gt;Next &amp;gt;&lt;/a&gt;\n</code></pre>\n\n<p>So, to click on this next link, I made the following code in VBA:</p>\n\n<pre><code>        Dim focation\n        Dim jocation\n\n        If j = 1 Then\n            focation = doc.getElementsByClassName(\"paginationLink\")\n            focation.Click\n            Do\n            Loop Until ie.readyState = READYSTATE_COMPLETE '= 4\n            Sleep 2000\n        ElseIf j &gt; 1 And j &lt; TotalPages Then\n            jocation = doc.getElementsByClassName(\"paginationLink\")(1)\n            jocation.Click\n            Sleep 2000\n        Else\n            Exit For\n        End If\n        j = j + 1\n</code></pre>\n\n<p>But after the first page, I cannot somehow click on next link as I always have an \"Run time error 424: Object required error\". I don't know why. If I declare jocation = doc.getElementsByClassName(\"paginationLink\")(0)\nthe previous link gets clicked. But I want to click on Next link. Tried declaring jocation as IHTMLElement but receive Automation error or unspecified error when I reach 2nd. Is this a problem, because the links are dynamically loaded, but if it works on \"previous\" link, why not on \"next\" link . I tried searching here but couldn't find a satisfactory answer. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "edited": false, "score": 0, "creation_date": 1466630519, "post_id": 37978373, "comment_id": 63402899, "body": "I tried that snippet out. Total duration worked great, however cost still had the same issue."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "edited": false, "score": 1, "creation_date": 1466630745, "post_id": 37978373, "comment_id": 63402987, "body": "@CeFu - look down column E. make sure there is no other text in the columns. Go to the last filled row you can see in column E, then press <code>Ctrl + &lt;down arrow&gt;</code>. What happens? Also, see my edit for another solution."}, {"owner": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "edited": false, "score": 0, "creation_date": 1466630912, "post_id": 37978373, "comment_id": 63403071, "body": "I did, it was 120k rows down. That was so odd! Thanks!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "edited": false, "score": 0, "creation_date": 1466631415, "post_id": 37978373, "comment_id": 63403306, "body": "@CeFu - sometimes that happens with system generated reports, if this is one, which it looks like"}, {"owner": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "edited": false, "score": 0, "creation_date": 1466631580, "post_id": 37978373, "comment_id": 63403370, "body": "The initial generated report contains over 30k records. My first, separate script eliminated toll free &amp; local numbers. I use KuTools to easily split the data into separate sheets, and then apply this script to total duration, code and last remaining formatting."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1466630840, "last_edit_date": 1466630840, "creation_date": 1466630173, "answer_id": 37978373, "question_id": 37978283, "link": "https://stackoverflow.com/questions/37978283/sum-expression-not-displaying-sum-if-theres-1-data-row-in-sheet/37978373#37978373", "title": "Sum expression not displaying sum if there&#39;s 1 data row in sheet", "body": "<p>The problem is the <code>End(xlDown)</code> and when you use it against <code>B2</code> and <code>E2</code></p>\n\n<p>Because there's only 1 row, the <code>End(xlDown)</code> method will go to last row on the spreadsheet. <em>Look there and you will see the formula :)</em></p>\n\n<p>Use this instead:</p>\n\n<pre><code>.Range(\"E\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Value = _\n    WorksheetFunction.Sum(.Range(\"E2:E\" &amp; .Cells.SpecialCells(xlLastCell).Row))\n.Range(\"B\" &amp; .Rows.Count).End(xlUp).Offset(1, 0).Value = _\n    Format(WorksheetFunction.Sum(.Range(\"B2:B\" &amp; .Cells.SpecialCells(xlLastCell).Row)), \"hh:mm:ss\")\n</code></pre>\n\n<p>Alternately, if you know you will <strong>always</strong> have <em>at least</em> one row of data you can change the 2 row reference in your original code to 1.</p>\n\n<pre><code>.Range(\"E1\").End(xlDown).Offset(1, 0).Value = _\n    WorksheetFunction.Sum(.Range(\"E2:E\" &amp; .Cells.SpecialCells(xlLastCell).Row))\n.Range(\"B1\").End(xlDown).Offset(1, 0).Value = _\n    Format(WorksheetFunction.Sum(.Range(\"B2:B\" &amp; .Cells.SpecialCells(xlLastCell).Row)), \"hh:mm:ss\")\n</code></pre>\n\n<p>As a side note, this line makes no real sense:</p>\n\n<pre><code>.Range(\"B\" &amp; Rows.Count).End(xlUp).Row = LastRow\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 37978373, "answer_count": 1, "score": 1, "last_activity_date": 1466630840, "creation_date": 1466629800, "question_id": 37978283, "link": "https://stackoverflow.com/questions/37978283/sum-expression-not-displaying-sum-if-theres-1-data-row-in-sheet", "title": "Sum expression not displaying sum if there&#39;s 1 data row in sheet", "body": "<p>Sorry if title was confusing.</p>\n\n<p>I have multiple sheets, my code below will go through each sheet, calculate duration/cost &amp; then input remaining values. It works great, however there's one issue.</p>\n\n<p>Issue: If there's only 1 row of data under header, it will not display total duration &amp; cost where it inserts Total duration &amp; cost.</p>\n\n<p>Exact Issue Example:</p>\n\n<pre><code>Start Time  Duration    Calling Name    Dialed Number    Cost \n6/2/2016 8:58   0:01:15 BLANK_F333       1303900000      $0.12 \nTotal Duration:                               Total Cost:   \n</code></pre>\n\n<p>Here's exact example out if there's multiple rows of data.</p>\n\n<pre><code>Start Time  Duration    Calling Name    Dialed Number    Cost \n6/1/2016 15:07  0:30:55 BLANK_I380  6052340000   $3.72 \n6/3/2016 12:26  0:05:40 BLANK_I380  1605230000   $0.72 \n6/6/2016 13:49  0:00:08 BLANK_I380  1605380000   $0.12 \n6/6/2016 13:50  0:00:08 BLANK_I380  1605380000   $0.12 \n6/6/2016 13:51  0:01:15 BLANK_I380  1605320000   $0.12 \n6/16/2016 8:29  0:01:42 BLANK_I380  1703290000   $5.04 \nTotal Duration: 0:39:48                      Total Cost:     $9.84 \n</code></pre>\n\n<p>I can't figure out how to output single row data sheets.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub FormatEntry()\nDim TotalCost As Double\nDim TotalTime As Double\nDim LastRow As Long\n\n\nFor Each ws In ActiveWorkbook.Worksheets\n    On Error Resume Next     'Will continue if an error results\n    With ws\n        .Range(\"E:E\").NumberFormat = \"_-[$$-40B]* #,##0.00_ ;_-[$$-40B]* -#,##0.00 ;_-[$$-40B]* \"\"-\"\"??_ ;_-@_ \"\n        .Range(\"E2\").End(xlDown).Offset(1, 0).Value = _\n    WorksheetFunction.Sum(.Range(\"E2:E\" &amp; .Cells.SpecialCells(xlLastCell).Row))\n    .Range(\"B2\").End(xlDown).Offset(1, 0).Value = _\n    Format(WorksheetFunction.Sum(.Range(\"B2:B\" &amp; .Cells.SpecialCells(xlLastCell).Row)), \"hh:mm:ss\")\n            .Range(\"A1\").End(xlDown).Offset(1).Font.Bold = True\n    .Range(\"A1\").End(xlDown).Offset(1).Value = \"Total Duration:\"\n    .Range(\"D1\").End(xlDown).Offset(1).Font.Bold = True\n    .Range(\"D1\").End(xlDown).Offset(1).Value = \"Total Cost:\"\n    .Range(\"B\" &amp; Rows.Count).End(xlUp).Row = LastRow\n\nEnd With\nNext ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "combobox", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466631122, "post_id": 37978405, "comment_id": 63403171, "body": "Both throw a &quot;Subscript out of range&quot; Run-time error &#39;9&#39; which is the same thing I was getting before"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466631810, "post_id": 37978405, "comment_id": 63403461, "body": "Place a breakpoint in that line and query all relevant variables in the Immediate Window. Like: 1) ?Sheets(&quot;OtherSheet&quot;).Name 2)?ComboBox1.ListIndex 3) ActiveSheet.Name"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466662745, "post_id": 37978405, "comment_id": 63412190, "body": "@slurrr did you do that?"}, {"owner": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466692277, "post_id": 37978405, "comment_id": 63432783, "body": "honestly, I am horrible with excel. Right now I am googling how to debug. I am good with adding stops but not sure how to query or even where to start. You know a good place to learn about that?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466692835, "post_id": 37978405, "comment_id": 63433239, "body": "in the VBE editor place the cursor in the offending line and press F9. This will place the breakpoint. Then press F5 and have the code Run. It&#39;ll stop at the breakpoint. Then open the Immediate Window (CTRL+G) , type <code>?Sheets(&quot;OtherSheet&quot;).Name</code> and press return. And watch the result. Similarly with <code>?ComboBox1.ListIndex</code> and <code>?ActiveSheet.Name</code>"}, {"owner": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466697258, "post_id": 37978405, "comment_id": 63436568, "body": "apparently the problem is in the <code>?Sheets(&quot;OtherSheet&quot;).Name</code> it&#39;s coming up as unknown name"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466697645, "post_id": 37978405, "comment_id": 63436806, "body": "which is also one of the most common causes of the &quot;Subscript out of range&quot; error. While still in the breakpoint (i.e. with the error ruling) go on typing in the immediate window <code>?ActiveSheet.Name</code> and return and  <code>?ActiveWorkbook.Name</code>  and return. Moreover, are you working with more than one workbook?"}, {"owner": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466698316, "post_id": 37978405, "comment_id": 63437247, "body": "those both call out sheet2 and current workbook respectively. I do have multiple workbooks open, but that doesn&#39;t seem to be causing an issue. Either way I closed them and still get same"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466698464, "post_id": 37978405, "comment_id": 63437334, "body": "does your macro requires open workbooks other than the one it resides in? in other words what&#39;s the minimum workbooks scenario to have your macro begin and what other workbooks are opened/processed by it?"}, {"owner": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466698493, "post_id": 37978405, "comment_id": 63437347, "body": "The table is on sheet1, is there a better way to call that out?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466698589, "post_id": 37978405, "comment_id": 63437410, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/115425/discussion-between-user3598756-and-slurrr\">continue this discussion in chat</a>."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "edited": false, "score": 0, "creation_date": 1466747621, "post_id": 37978405, "comment_id": 63456321, "body": "You&#39;d better edit your post and add more info: what is <code>ActivtyM</code>? Is <code>Combobox1</code>the name of a userform or a sheet combobox ? and so on..."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1466630271, "creation_date": 1466630271, "answer_id": 37978405, "question_id": 37978224, "link": "https://stackoverflow.com/questions/37978224/how-do-i-trigger-a-formula-with-a-combobox-thats-listfillrange-is-from-a-two-co/37978405#37978405", "title": "How do I trigger a formula with a ComboBox that&#39;s ListFillRange is from a two column table?", "body": "<p>Try this (untested):</p>\n\n<pre><code>Private Sub ActivtyM_Change()\n\nRange(\"C3\").FormulaR1C1 = \"=RC[-1]*\" &amp; Sheets(\"OtherSheet\").Cells(ComboBox1.ListIndex + 1, 2).Value\n\nEnd Sub\n</code></pre>\n\n<p>Or, if you don't need formulas:</p>\n\n<pre><code>Private Sub ActivtyM_Change()\n\n    Range(\"C3\").Value = Range(\"B3\").Value * Sheets(\"OtherSheet\").Cells(ComboBox1.ListIndex + 1, 2).Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1524, "user_id": 5166824, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10100529329346776/picture?type=large", "display_name": "slurrr", "link": "https://stackoverflow.com/users/5166824/slurrr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478091128, "creation_date": 1466629466, "last_edit_date": 1531161705, "question_id": 37978224, "link": "https://stackoverflow.com/questions/37978224/how-do-i-trigger-a-formula-with-a-combobox-thats-listfillrange-is-from-a-two-co", "title": "How do I trigger a formula with a ComboBox that&#39;s ListFillRange is from a two column table?", "body": "<p>Table: Column one values are strings. Column two values are numerical. I want to select the string value from a dropdown which will trigger a formula in a specific cell that will pull the corresponding numerical value into a simple formula that multiplies that value by a user input into an adjacent cell. </p>\n\n<p>Here is the basic idea that I cannot get to work:</p>\n\n<pre><code>Private Sub ActivtyM_Change()\n\nRange(\"C3\").Select\nActiveCell.FormulaR1C1 = \"=RC[-1]\" * Sheets(\"OtherSheet\").Cells(ComboBox1.ListIndex + 1, 2).Value\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1466629199, "post_id": 37978119, "comment_id": 63402314, "body": "What do you mean by <code>Cells(i1, j1)</code>? That&#39;s where your issue is.  Should that just be <code>Cells(i,j)</code>?  Or <code>Cells(i &amp; 1, j &amp; 1)</code>?"}, {"owner": {"reputation": 85, "user_id": 6475475, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54b2e8a1345a1dc242660c01e28f57ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bubs", "link": "https://stackoverflow.com/users/6475475/bubs"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1466629517, "post_id": 37978119, "comment_id": 63402449, "body": "Thanks @BruceWayne, you got a great eye! It&#39;s suppose to be Cells(i,j). One quick question, how do you type the blue highlighted code type text in comments?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1466629633, "post_id": 37978119, "comment_id": 63402508, "body": "@BruceWayne ok, I&#39;m done doing this. Next time <i>you</i> post answers as answers and then I can stop feeling like I&#39;m stealing your checkmarks =)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466629890, "post_id": 37978119, "comment_id": 63402615, "body": "@Mat&#39;sMug - haha, I don&#39;t mind at all!"}, {"owner": {"reputation": 85, "user_id": 6475475, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54b2e8a1345a1dc242660c01e28f57ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bubs", "link": "https://stackoverflow.com/users/6475475/bubs"}, "edited": false, "score": 0, "creation_date": 1466632095, "post_id": 37978119, "comment_id": 63403589, "body": "I corrected my code and everything works great. Thank you both!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466637107, "post_id": 37978119, "comment_id": 63405154, "body": "The best <i>thank you</i> you can give on Stack Overflow is an upvote; also, consider marking the answer as <i>the</i> answer by clicking the checkmark next to it, that will remove this question from the gigantic pool of unanswered questions."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466629840, "post_id": 37978241, "comment_id": 63402590, "body": "Yes! Best practice! Nice answer amigo.  (Fun fact: you can use <code>Dim myVar&amp;</code>  for <code>Dim myVar as Long</code>, and <code>Dim myString$</code> for <code>Dim myString as String</code>)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1466630011, "post_id": 37978241, "comment_id": 63402669, "body": "@BruceWayne yep. Those are <i>type hints</i>, inherited from ancient dialects of VB - in <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> I&#39;ve implemented an inspection that finds them, and a &quot;quick-fix&quot; that automatically removes them everywhere they are, and replaces them in declarations by the explicit type =)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1466629593, "last_edit_date": 1592644375, "creation_date": 1466629593, "answer_id": 37978241, "question_id": 37978119, "link": "https://stackoverflow.com/questions/37978119/excel-vba-error-on-my-msgbox-line/37978241#37978241", "title": "Excel VBA Error on my Msgbox line", "body": "<p>As <a href=\"https://stackoverflow.com/questions/37978119/excel-vba-error-on-my-msgbox-line#comment63402314_37978119\">@BruceWayne correctly identified</a>, you're using undeclared variables. Use <code>Option Explicit</code>.</p>\n<p>Let me rephrase that...</p>\n<h1>ALWAYS use Option Explicit</h1>\n<p>Simple: stick the words <code>Option Explicit</code> at the top of <em>every single module</em> you ever see, and VBA will refuse to compile code where you're using an undeclared variable.</p>\n<p>In this instance, you're referring to <code>i1</code> and <code>j1</code>, which both contain the non-value <code>Empty</code>, since they're undeclared and uninitialized variants.</p>\n<p>Here are the variables you need to declare:</p>\n<pre><code>Dim i As Long\nDim j As Long\nDim ans As vbMsgBoxResult\nDim sheetName1 As String\nDim sheetName2 As String\n</code></pre>\n<p>Without <code>Option Explicit</code>, VBA happily compiles a typo and takes it as &quot;oh, I've never seen that guy, must be a new variable!&quot;</p>\n"}], "owner": {"reputation": 85, "user_id": 6475475, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/54b2e8a1345a1dc242660c01e28f57ee?s=128&d=identicon&r=PG&f=1", "display_name": "Bubs", "link": "https://stackoverflow.com/users/6475475/bubs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 37978241, "answer_count": 1, "score": 1, "last_activity_date": 1466631952, "creation_date": 1466629064, "last_edit_date": 1466631952, "question_id": 37978119, "link": "https://stackoverflow.com/questions/37978119/excel-vba-error-on-my-msgbox-line", "title": "Excel VBA Error on my Msgbox line", "body": "<p>I'm getting an Application-defined or object-defined error on my Msgbox line. I have both InputBox variables declared as String. I tried changing Sheets(sheetname1) to an actual sheet name but same error. I tried everything I know, I'm puzzled with this error. Any help is appreciated.</p>\n\n<pre><code>sheetname1 = Application.InputBox(\"Enter the name of your first sheet.\")\nsheetname2 = Application.InputBox(\"Enter the name of your second sheet.\")\nFor i = 1 To 100\n    For j = 1 To 100\n        If Not Sheets(sheetname1).Cells(i, j).Value = Sheets(sheetname2).Cells(i, j).Value Then\n            Sheets(sheetname1).Select\n            Cells(i, j).Select\n            With Selection.Interior\n                .Pattern = xlSolid\n                .PatternColorIndex = xlAutomatic\n                .Color = 65535\n                .TintAndShade = 0\n                .PatternTintAndShade = 0\n            End With\n            ans = MsgBox(\"Cells \" &amp; i &amp; \",\" &amp; j &amp; \" do not match.\" &amp; vbNewLine &amp; \"The value on \" &amp; sheetname1 &amp; \" is \" &amp; Sheets(sheetname1).Cells(i, j).Value &amp; \" and the value on \" &amp; sheetname2 &amp; \" is \" &amp; Sheets(\"sheetname2\").Cells(i, j).Value, vbOKCancel + vbQuestion)\n            If ans = vbCancel Then Exit Sub\n            Else\n                GoTo skip1\n        End If\nskip1:\n    Next j\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1466629144, "post_id": 37978108, "comment_id": 63402285, "body": "use the variant data type in your method signature  Function Blah(myArray as Variant) as Variant"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466629236, "post_id": 37978108, "comment_id": 63402333, "body": "if you read the answers to the question you linked to carefully, you will see where you need to adjust your code."}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1466629881, "post_id": 37978108, "comment_id": 63402609, "body": "@Sorceri, correct, defining F(X as VARIANT) AS VARIANT then assigning the call result to a Variant makes data appear inside the passed parameter!!! Thank you. I would mark this an answer if your comment as an answer."}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466629918, "post_id": 37978108, "comment_id": 63402632, "body": "@ScottHoltzman, you may be right, I just could not see it!"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466630341, "post_id": 37978108, "comment_id": 63402823, "body": "@NoChance - It&#39;s tricky stuff, no doubt :)"}], "answers": [{"comments": [{"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1466630233, "post_id": 37978280, "comment_id": 63402760, "body": "Yes this works perfectly and I could use the original type without using a Variant. Very good."}, {"owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "reply_to_user": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 1, "creation_date": 1466630455, "post_id": 37978280, "comment_id": 63402871, "body": "@NoChance thanks. I also modified my answer slightly to change the Array populator as a Sub, not a Function as it returns no value."}, {"owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "edited": false, "score": 0, "creation_date": 1466633229, "post_id": 37978280, "comment_id": 63403987, "body": "This is also correct, thanks again. It is good idea to send data byRef for efficiency but it is harmful to let the called program to change it. Anyway, it looks like the universe has managed to survive without  my wisdom!"}], "tags": [], "owner": {"reputation": 4595, "user_id": 314507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35fa938f2b64b7620be0181281f2ae1?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/314507/jeremy"}, "is_accepted": true, "score": 3, "last_activity_date": 1466630422, "last_edit_date": 1466630422, "creation_date": 1466629783, "answer_id": 37978280, "question_id": 37978108, "link": "https://stackoverflow.com/questions/37978108/return-an-array-from-function-in-vba/37978280#37978280", "title": "Return an array from function in VBA", "body": "<p>One solution is to just pass the array ByRef</p>\n\n<pre><code>Sub main1()\n    Dim A(1, 3) As String\n    Call F(A)\n    Debug.Print A(1, 1)\nEnd Sub\nSub F(ByRef x() As String)\n    x(1, 1) = 3.14\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5081, "user_id": 1010405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/uJsDG.gif?s=128&g=1", "display_name": "NoChance", "link": "https://stackoverflow.com/users/1010405/nochance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5774, "favorite_count": 0, "accepted_answer_id": 37978280, "answer_count": 1, "score": 1, "last_activity_date": 1547686873, "creation_date": 1466629013, "last_edit_date": 1547686873, "question_id": 37978108, "link": "https://stackoverflow.com/questions/37978108/return-an-array-from-function-in-vba", "title": "Return an array from function in VBA", "body": "<p>I want to code a function that accepts an array as an argument.  Then the function fills some elements.  Finally, the array filled by the function becomes visible from the caller.</p>\n\n<pre><code>sub main1()\n    Dim A(1,3) as string\n    F(A) '???How to get the value of each array element here?\n    ...\nEnd Sub\n\nFunction F(X(1,3) as string) string()\n    X(1,1)=3.14\nEnd Function\n</code></pre>\n\n<p>I looked at the following post but did not get it, somehow the questions are not the same.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31564846/return-array-from-function-in-vba\">return array from function in VBA</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466628697, "post_id": 37977889, "comment_id": 63402056, "body": "What is the error?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466628843, "post_id": 37977889, "comment_id": 63402127, "body": "<i>It breaks on the name of the sub</i> - did you compile the code first? And what in the world does the title have to do with the question?"}, {"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1466630185, "post_id": 37977889, "comment_id": 63402738, "body": "Sorry forgot to change the title.  See attached image for error msg."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466630405, "post_id": 37977889, "comment_id": 63402852, "body": "Are you using Form Controls or ActiveX Controls? BTW, the error is because there is no such thing as <code>CommandButton</code> (when declaring variables)."}, {"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1466630471, "post_id": 37977889, "comment_id": 63402878, "body": "I am using default Excel commandbutton  I found the code else where and modified it.  All I am trying to accomplish to change the caption on the button when the filter is applied and also when the filter is removed."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466630615, "post_id": 37977889, "comment_id": 63402937, "body": "Neither form controls nor activeX controls are &quot;default&quot;. Well, it seems you don&#39;t know. So, let&#39;s assume that you are using form controls. So, try to change <code>Dim cmdButton As CommandButton</code> to <code>Dim cmdButton As Button</code>. Here you can read-up on ActiveX Controls vs Form Controls: <a href=\"http://stackoverflow.com/questions/15455179/what-is-the-difference-between-form-controls-and-activex-control-in-excel-20\" title=\"what is the difference between form controls and activex control in excel 20\">stackoverflow.com/questions/15455179/&hellip;</a>"}, {"owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "edited": false, "score": 0, "creation_date": 1466630787, "post_id": 37977889, "comment_id": 63403009, "body": "I changed to Dim cmdButton As Button and still get The item with the specified name wasn&#39;t found (Set cmdButton = ActiveSheet.Shapes(&quot;cmdShowDif&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466631330, "post_id": 37978572, "comment_id": 63403266, "body": "This works only for ActiveX controls. But it seems to me that Karen is using Form Controls."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466688422, "post_id": 37978572, "comment_id": 63429611, "body": "The <code>CommandButton</code> data type is ActiveX and the <code>Shapes()</code> accessor is more commonly used in Forms. I wonder where she copied that code from and what the heck they were using."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1466630932, "creation_date": 1466630932, "answer_id": 37978572, "question_id": 37977889, "link": "https://stackoverflow.com/questions/37977889/excel-vba-to-change-the-caption-on-an-excel-command-button/37978572#37978572", "title": "Excel VBA to change the caption on an Excel command button", "body": "<p>Go to the Developer tab and click Design Mode. Now select your CommandButton. The name of the button will appear in the name box - to the left of the formula bar. Change this line</p>\n\n<pre><code>Set cmdButton = ActiveSheet.Shapes(\"cmdShowDif\")\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Set cmdButton = ActiveSheet.OLEObjects(\"cmdShowDif\").Object\n</code></pre>\n\n<p>But that uses the correct name instead of <code>cmdShowDif</code> (or change the name in the name box to <code>cmdShowDif</code></p>\n"}, {"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1466630945, "creation_date": 1466630945, "answer_id": 37978577, "question_id": 37977889, "link": "https://stackoverflow.com/questions/37977889/excel-vba-to-change-the-caption-on-an-excel-command-button/37978577#37978577", "title": "Excel VBA to change the caption on an Excel command button", "body": "<p>Here is the working code:</p>\n\n<pre><code>Sub ShowDifference()\n\nDim cmdButton As Button\n\nSet cmdButton = ActiveSheet.Buttons(\"cmdShowDif\")\n\nIf cmdButton.Caption = \"Show Difference\" Then\n    cmdButton.Caption = \"Show All\"\nElse\n    cmdButton.Caption = \"Show Difference\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Alternatively, you can also use the following code:</p>\n\n<pre><code>Sub ShowDifference()\n\nDim cmdButton As Button\n\nFor Each cmdButton In ActiveSheet.Buttons\n    If cmdButton.Name = \"cmdShowDif\" Then\n        If cmdButton.Caption = \"Show Difference\" Then\n            cmdButton.Caption = \"Show All\"\n        Else\n            cmdButton.Caption = \"Show Difference\"\n        End If\n    Else\n        Debug.Print cmdButton.Name &amp; \" is not the one... moving to next button...\"\n    End If\nNext cmdButton\n\nEnd Sub\n</code></pre>\n\n<p>Let me know if you have any questions.</p>\n"}], "owner": {"reputation": 99, "user_id": 6241632, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/74d23fcd7775f20dba819eb06f248a23?s=128&d=identicon&r=PG&f=1", "display_name": "Karen Schaefer", "link": "https://stackoverflow.com/users/6241632/karen-schaefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4058, "favorite_count": 0, "accepted_answer_id": 37978577, "answer_count": 2, "score": 0, "last_activity_date": 1466630945, "creation_date": 1466628105, "last_edit_date": 1531164843, "question_id": 37977889, "link": "https://stackoverflow.com/questions/37977889/excel-vba-to-change-the-caption-on-an-excel-command-button", "title": "Excel VBA to change the caption on an Excel command button", "body": "<p>I am looking for Excel VBA to change the caption on an Excel command button on the fly.  The default caption should be  \"Show Difference\" and should change to Show All when the filter is applied.</p>\n\n<p>This is what I have so far.</p>\n\n<pre><code>Sub ShowDifference()\nDim cmdButton As CommandButton\n</code></pre>\n\n<p>'Breaks Here</p>\n\n<pre><code>Set cmdButton = ActiveSheet.Shapes(\"cmdShowDif\")\n\n\nIf cmdButton.Caption = \"Show Difference\" Then\n    ActiveSheet.ListObjects(\"qryDifference\").Range.AutoFilter Field:=4, _\n    Criteria1:=Array(\"&lt;&gt;0.00\"), Operator:=xlAnd\n    cmdButton.Caption = \"Show All\"\nElse\n    ActiveSheet.ListObjects(\"qryDifference\").Range.AutoFilter Field:=4\n    cmdButton.Caption = \"Show Difference\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>It breaks on the name of the sub.  Why?</p>\n\n<p>Error:\n<a href=\"https://i.stack.imgur.com/cmTA8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cmTA8.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1466628052, "post_id": 37977849, "comment_id": 63401734, "body": "See that&#39;s what I thought as well, but I kept getting a &quot;Runtime Error &#39;91&#39;: Object variable or With block variable not set&quot; with the &quot;Set UserNameInputBox = LoginForm.getElementById(&quot;BIA_Login&quot;)&quot; line of code highlighted"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 1, "creation_date": 1466628152, "post_id": 37977849, "comment_id": 63401790, "body": "@Davey - try late binding, dim everything as object. <i>(disclaimer, I mostly say that because that is what I typically do. I rarely work with the references)</i>. It could be that you have the wrong object types associated with the variables .... wait ... try <code>Set UserNameInputBox = doc.getElementById(&quot;BIA_Login&quot;)</code>"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1466628288, "post_id": 37977849, "comment_id": 63401860, "body": "yeah when I highlight getElementById its not found in the HTMLInputElement class. I&#39;ll try that though"}, {"owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1466628685, "post_id": 37977849, "comment_id": 63402052, "body": "the Set UserNameInputBox = doc.getElementById(&quot;BIA_Login&quot;) solution worked! Thank you so much."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "edited": false, "score": 0, "creation_date": 1466628728, "post_id": 37977849, "comment_id": 63402069, "body": "@Davey - you&#39;re welcome. Glad I caught it. :) I updated the answer."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1466628709, "last_edit_date": 1466628709, "creation_date": 1466627866, "answer_id": 37977849, "question_id": 37977761, "link": "https://stackoverflow.com/questions/37977761/using-vba-to-login-to-an-internet-site/37977849#37977849", "title": "Using VBA to login to an Internet site", "body": "<p>Use <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById\" rel=\"nofollow\"><code>getElementByID</code></a> and use it directly against the Document element.</p>\n\n<pre><code>Set UserNameInputBox = doc.getElementById(\"BIA_Login\")\nUserNameInputBox.Value = cUsername\n\nSet PasswordInputBox = doc.getElementById(\"BIA_Pass\")\nPasswordInputBox.Value = cPassword\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6190062, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ecacb85aa6e43a64450919689ec38b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Davey ", "link": "https://stackoverflow.com/users/6190062/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 37977849, "answer_count": 1, "score": 0, "last_activity_date": 1553381817, "creation_date": 1466627537, "last_edit_date": 1553381817, "question_id": 37977761, "link": "https://stackoverflow.com/questions/37977761/using-vba-to-login-to-an-internet-site", "title": "Using VBA to login to an Internet site", "body": "<p>I'm trying to use VBA to open and login to an internet site.</p>\n\n<p>I'm struggling with the HTML portion of my code. There is no \"name\" attribute in the HTML code. This is what is throwing me off.</p>\n\n<p>References Checked:<br>\nMicrosoft Internet Controls,<br>\nMicrosoft Script Control 1.0,<br>\nMicrosoft HTML Object Library</p>\n\n<p>HTML for login text box:</p>\n\n<pre><code>&lt;input class=\"ui-autocomplete-input\" id=\"BIA_Login\" autofocus=\"\" type=\"text\" autocomplete=\"off\"&gt;\n</code></pre>\n\n<p>HTML for password text box: </p>\n\n<pre><code>&lt;input class=\"ui-autocomplete-input\" id=\"BIA_Pass\" type=\"password\" autocomplete=\"off\"&gt;\n\n\n\nPrivate Sub CommandButton21_Click()\n\n    Const cURL = \"xxxxxxxxxxx.com\"\n    Const cUsername = \"xxxxxxx\"\n    Const cPassword = \"xxxxxxx\"\n\n    Dim IE As InternetExplorer\n    Dim doc As HTMLDocument\n    Dim LoginForm As HTMLFormElement\n    Dim UserNameInputBox As HTMLInputElement\n    Dim PasswordInputBox As HTMLInputElement\n    Dim SignInButton As HTMLInputButtonElement\n    Dim HTMLelement As IHTMLElement\n\n    Set IE = New InternetExplorer\n\n    IE.Visible = True\n    IE.navigate cURL\n\n    Do While IE.readyState &lt;&gt; READYSTATE_COMPLETE Or IE.busy: DoEvents: Loop\n\n    Set doc = IE.document\n\n    Set LoginForm = doc.forms(0)\n\n    Set UserNameInputBox = LoginForm.elements(\"BIA_Login\")\n    UserNameInputBox.Value = cUsername\n\n    Set PasswordInputBox = LoginForm.elements(\"BIA_Pass\")\n    PasswordInputBox.Value = cPassword\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1466627393, "post_id": 37977633, "comment_id": 63401429, "body": "one item <code>Range(&quot;col&quot; &amp; Rows.Count)</code> should be using Cells() instead <code>Cells(Rows.Count,col)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1466628937, "post_id": 37978009, "comment_id": 63402174, "body": "<code>.Range(&quot;col&quot; &amp; Rows.count).</code> Is not proper, unless the OP wants column COL.  But I think he wants the value of the variable <code>col</code>.  Also the formula may need a little work."}], "tags": [], "owner": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1466688300, "last_edit_date": 1466688300, "creation_date": 1466628588, "answer_id": 37978009, "question_id": 37977633, "link": "https://stackoverflow.com/questions/37977633/update-column-range-with-the-cell-value/37978009#37978009", "title": "Update Column Range with the cell value", "body": "<p>Define <code>col</code> before you start your first loop, and don't put <code>col = col + 1</code> in the <code>For j = 7 to 1000</code> loop. Otherwise <code>col</code> will increment for every <code>j</code> instead of every <code>i</code>. Something like this:</p>\n\n<pre><code>Sub ARB13()\n    Dim col as Long\n    Dim i  as Long\n    Dim j as Long\n\n    col = 0\n\n    For i = 11 To 382\n        For j = 7 to 1000\n            LB = 2\n            UB = Sheets(\"Admin\").Cells(Rows.count, col).End(xlUp).row\n            Cells(i, j).Select\n            ActiveCell.FormulaR1C1 = Sheets(\"Admin\").Range(\"Y\" &amp; Int((UB - LB + 1) * Rnd + LB))\n        Next j\n\n        col = col +1\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 6486566, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/zEwq0.jpg?s=128&g=1", "display_name": "Tai Lung", "link": "https://stackoverflow.com/users/6486566/tai-lung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466688300, "creation_date": 1466627150, "last_edit_date": 1531164843, "question_id": 37977633, "link": "https://stackoverflow.com/questions/37977633/update-column-range-with-the-cell-value", "title": "Update Column Range with the cell value", "body": "<p>I have an input sheet called \"Testfall-Input-Vorschlag where we have to choose a value from a dropdown in the cells of the first row from the 7th (J)column and when a value gets chosen for example \"ARB13\" I want to fill out the column where it is selected. The filling of the column is with random values. There is a Sheet called \"Admin\" which has values stored in the cells of columns from A:ZZ. Now I in the \"Testfall-Input-Vorschlag\" sheet I want to fill out the cells of the column sequentially. Which means for example for cell(11,7) i want to generate a random value from column A in \"Admin\" for cell (12,7) the value has to be from Column B in \"Admin\" for cell (13,7) the value is from column C in \"Admin and so on. So I have been trying  and I've come up with this code</p>\n\n<pre><code>Sub ARB13()\n\n\nDim col As Integer\n\n\nFor i = 11 To 382\n\n\nFor j = 7 To 1000\n\n\nIf Sheets(\"Testfall-Input_Vorschlag\").Cells(1, j) = \"ARB13\" Then\ncol = 0\ncol = col + 1\n LB = 2\n    UB = Sheets(\"Admin\").Range(\"col\" &amp; Rows.Count).End(xlUp).Row\n    Cells(i, j).Select\n    ActiveCell.FormulaR1C1 = Sheets(\"Admin\").Range(\"Y\" &amp; Int((UB - LB + 1) *       Rnd + LB))\n\n\n End If\n Next j\n Next i\n End Sub\n</code></pre>\n\n<p>How can I update the col value for every i. Which means for every i I need col value to be increased by 1. Where am I going wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1466628154, "post_id": 37977552, "comment_id": 63401792, "body": "What&#39;s the rule by which choosing the right occurence of the &quot;^&quot; charachter?"}], "answers": [{"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 2, "last_activity_date": 1466628359, "creation_date": 1466628359, "answer_id": 37977956, "question_id": 37977552, "link": "https://stackoverflow.com/questions/37977552/vba-search-and-copy/37977956#37977956", "title": "VBA search and copy", "body": "<p>If you always want to return the value <em>after</em> the word 'ScreenRecording`, you can use the following function to do so.</p>\n\n<p>Include it in a <code>SubRoutine</code> to replace in place if needed:</p>\n\n<pre><code>Function SplitScreenRecording(sInput As String) As String\n    Dim a As Variant\n\n    Const SDELIM As String = \"^\"\n    Const LOOKUP_VAL As String = \"ScreenRecording\"\n\n    a = Split(sInput, SDELIM)\n\n    If IsError(Application.Match(LOOKUP_VAL, a, 0)) Then\n        SplitScreenRecording = CVErr(2042)\n    Else\n        SplitScreenRecording = a(Application.Match(LOOKUP_VAL, a, 0))\n    End If\nEnd Function\n\nSub ReplaceInPlace()\n    Dim rReplace As Range\n    Dim rng As Range\n\n    Set rReplace = Range(\"A1:A3\")\n\n    For Each rng In rReplace\n        rng.Value = SplitScreenRecording(rng.Value)\n    Next rng\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 6501124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8990e4be208924b61bd722fb5e8bf295?s=128&d=identicon&r=PG&f=1", "display_name": "salm", "link": "https://stackoverflow.com/users/6501124/salm"}, "edited": false, "score": 0, "creation_date": 1466862622, "post_id": 37990566, "comment_id": 63498531, "body": "Thanks for your suggestions, it&#39;s a great help."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 25, "user_id": 6501124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8990e4be208924b61bd722fb5e8bf295?s=128&d=identicon&r=PG&f=1", "display_name": "salm", "link": "https://stackoverflow.com/users/6501124/salm"}, "edited": false, "score": 0, "creation_date": 1466865991, "post_id": 37990566, "comment_id": 63499428, "body": "You are welcome. If I fullfilled your question please mark the answer as accepted. Thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1466694102, "last_edit_date": 1466694102, "creation_date": 1466681926, "answer_id": 37990566, "question_id": 37977552, "link": "https://stackoverflow.com/questions/37977552/vba-search-and-copy/37990566#37990566", "title": "VBA search and copy", "body": "<p>if you want to replace:</p>\n\n<pre><code>Sub main2()\n    Dim key As String\n    Dim replacementStrng As String\n\n    key = \"ScreenRecording\"\n    replacementStrng = \"AAA\"\n    With Worksheets(\"mysheet01\").columns(\"A\") '&lt;--| change \"mysheet01\" and \"A\" to your actual sheet name and column to filter\n        .Replace what:=key &amp; \"^*^\", replacement:=key &amp; \"^\" &amp; replacementStrng &amp; \" ^ \", LookAt:=xlPart\n        .Replace what:=\"^\" &amp; key &amp; \"^*\", replacement:=\"^\" &amp; key &amp; \"^\" &amp; replacementStrng, LookAt:=xlPart\n    End With\nEnd Sub\n</code></pre>\n\n<p>while if you want to place what you need in the next column:</p>\n\n<pre><code>Sub main()\n    Dim myRng As Range\n\n    Set myRng = GetRange(Worksheets(\"mysheet01\").columns(\"A\"), \"ScreenRecording^\") '&lt;--| change \"mysheet01\" and \"A\" to your actual sheet name and column to filter\n    myRng.Offset(, 1) = \"value that I need to place in next row\" '&lt;--| change the right part of the assignment to what you need\nEnd Sub\n\nFunction GetRange(rng As Range, key As String) As Range\n    With rng\n        .AutoFilter Field:=1, Criteria1:=\"*\" &amp; key &amp; \"*\" '&lt;--| apply current filtering\n        If Application.WorksheetFunction.Subtotal(103, .Cells) &gt; 0 Then '&lt;--| if there are visible cells other than the \"header\" one\n            With .SpecialCells(xlCellTypeConstants)\n                If InStr(.SpecialCells(xlCellTypeVisible).Cells(1, 1), key  &amp; \"^\") &gt; 0 Then\n                    Set GetRange = .SpecialCells(xlCellTypeVisible) '&lt;--|select all visible cells\n                Else\n                    Set GetRange = .Resize(.Parent.Cells(.Parent.Rows.Count, .Column).End(xlUp).row - 1).Offset(1).SpecialCells(xlCellTypeVisible) '&lt;--|select visible rows other than the first (\"headers\") one\n                End If\n            End With\n        End If\n        .Parent.AutoFilterMode = False '&lt;--| remove drop-down arrows\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6501124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8990e4be208924b61bd722fb5e8bf295?s=128&d=identicon&r=PG&f=1", "display_name": "salm", "link": "https://stackoverflow.com/users/6501124/salm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 37990566, "answer_count": 2, "score": 0, "last_activity_date": 1466694102, "creation_date": 1466626866, "last_edit_date": 1531164843, "question_id": 37977552, "link": "https://stackoverflow.com/questions/37977552/vba-search-and-copy", "title": "VBA search and copy", "body": "<p>I'm automating an update I have to do and part of the macro I want to write needs specific text from what gets populated.\nI have the following types of text in the same column for hundreds of rows:</p>\n\n<p>ScreenRecording^<strong>naushi02</strong>^procr^10035</p>\n\n<p>procr^10635^ScreenRecording^<strong>misby01</strong></p>\n\n<p>ScreenRecording^<strong>liw03</strong>^procr^10046</p>\n\n<p>I've <strong>bold</strong> the text I need. I want to either replace the whole text with just what I need or place what I need in the next column, same row.</p>\n\n<p>I had wrote something which worked for 60 or so lines before I realised that there are variations in the format. For the main, it's all the same which is why I didn't realise at first and I've spent a lot of wasted time writing something that is now useless... so I'm asking for expert help please.</p>\n\n<p>Once I've got what I need from the first row, I need to move down until the last entry repeating.</p>\n\n<p>I had some code which obviously didn't work fully.</p>\n\n<p>I have thought about using the text 'ScreenRecording' in a search along with the special character which I can't find on my keyboard  and then trying to copy all text from that point upto and including the 2nd numerical character. I don't know how to do this, if it would work or even if it's a good idea but because I've spent so much time trying to figure it out, I need some help please.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "validation", "autofilter", "vba"], "comments": [{"owner": {"reputation": 866, "user_id": 4429501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bJd5A.jpg?s=128&g=1", "display_name": "CRUTER", "link": "https://stackoverflow.com/users/4429501/cruter"}, "edited": false, "score": 0, "creation_date": 1466627327, "post_id": 37977264, "comment_id": 63401396, "body": "if it is on a different worksheet / tab then you need to specify which worksheet range &quot;C2&quot; is pulling from.  Use something like:    <code>sheets(&quot;sheetName&quot;).Range(&quot;C2&quot;).Value</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6501042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb544252bb6fb889c8a1cef81a695a8?s=128&d=identicon&r=PG&f=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/6501042/irshad"}, "edited": false, "score": 0, "creation_date": 1466632171, "post_id": 37977720, "comment_id": 63403618, "body": "my work sheet name is &quot;MappingSheet&quot;, when i try this in the code below , i get compile error &quot;Sub or Function not defined&quot; Below is my code  Private Sub Worksheet_Change(ByVal Target As Range)  Dim r As Range  If Target.Address = &quot;$D$5&quot; Then     Set r = MappingSheet(&quot;Sheet4&quot;).AutoFilter.Range     If Len(Trim(Target.Value)) &gt; 0 Then         r.AutoFilter Field:=1, Criteria1:=Target.Value     Else         r.AutoFilter Field:=1     End If  End If End Sub"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 11, "user_id": 6501042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb544252bb6fb889c8a1cef81a695a8?s=128&d=identicon&r=PG&f=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/6501042/irshad"}, "edited": false, "score": 0, "creation_date": 1466633008, "post_id": 37977720, "comment_id": 63403918, "body": "@irshad - <code>Set r = Worksheets(&quot;MappingSheet&quot;).AutoFilter.Range</code>"}, {"owner": {"reputation": 11, "user_id": 6501042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb544252bb6fb889c8a1cef81a695a8?s=128&d=identicon&r=PG&f=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/6501042/irshad"}, "edited": false, "score": 0, "creation_date": 1466693247, "post_id": 37977720, "comment_id": 63433523, "body": "Thank you very much Scott! It worked i modified the code (see code below)  and it worked for me. but this doesn&#39;t end here, i have data in  another sheet which needs to populate based on the selection which i make on first sheet.      Private Sub Worksheet_Change(ByVal Target As Range)      Dim r As Range      If Target.Address = &quot;$D$5&quot; Then         Set r = Worksheets(&quot;MappingSheet&quot;).AutoFilter.Range      If Len(Trim(Target.Value)) &gt; 0 Then           r.AutoFilter Field:=1, Criteria1:=Range(&quot;D5&quot;).Value      Else           r.AutoFilter Field:=1      End If      End If      End Sub"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 11, "user_id": 6501042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb544252bb6fb889c8a1cef81a695a8?s=128&d=identicon&r=PG&f=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/6501042/irshad"}, "edited": false, "score": 0, "creation_date": 1466694794, "post_id": 37977720, "comment_id": 63434749, "body": "@Irshad - * but this doesn&#39;t end here, i have data in another sheet which needs to populate based on the selection which i make on first sheet. * - please post a new question for new issues tthat were not raised in the original question. If this answer works, please mark as such so others benefit."}, {"owner": {"reputation": 11, "user_id": 6501042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb544252bb6fb889c8a1cef81a695a8?s=128&d=identicon&r=PG&f=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/6501042/irshad"}, "edited": false, "score": 0, "creation_date": 1466695786, "post_id": 37977720, "comment_id": 63435518, "body": "Got it Scott, The below code is working, Thanks again!!  Private Sub Worksheet_Change(ByVal Target As Range)  Dim r As Range  If Target.Address = &quot;$D$5&quot; Then     Set r = Worksheets(&quot;MappingSheet&quot;).AutoFilter.Range  If Len(Trim(Target.Value)) &gt; 0 Then   r.AutoFilter Field:=1, Criteria1:=Range(&quot;D5&quot;).Value  Else   r.AutoFilter Field:=1  End If  End If  End Sub"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1466627409, "creation_date": 1466627409, "answer_id": 37977720, "question_id": 37977264, "link": "https://stackoverflow.com/questions/37977264/excel-and-macros-autofiltering-using-data-validation/37977720#37977720", "title": "Excel and Macros - Autofiltering using Data Validation", "body": "<p>You need to just specifically reference the sheet you want to autofilter. See my refactor below, specifically, the <code>Set r = ...</code> line.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n Dim r As Range\n\n If Target.Address = \"$C$2\" Then\n\n    Set r = Worksheets(\"Sheet2\").AutoFilter.Range\n\n    If Len(Trim(Target.Value)) &gt; 0 Then\n        r.AutoFilter Field:=1, Criteria1:=Target.Value\n    Else\n        r.AutoFilter Field:=1\n    End If\n\n End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6501042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8eb544252bb6fb889c8a1cef81a695a8?s=128&d=identicon&r=PG&f=1", "display_name": "Irshad", "link": "https://stackoverflow.com/users/6501042/irshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466632367, "creation_date": 1466625857, "last_edit_date": 1531161705, "question_id": 37977264, "link": "https://stackoverflow.com/questions/37977264/excel-and-macros-autofiltering-using-data-validation", "title": "Excel and Macros - Autofiltering using Data Validation", "body": "<p>I am auto filtering using data validation, the below code works if I have the data in the same spreadsheet. However, I have data in different sheets and I want them to filter based on the selection I make on the data validation list I created.\nCan some help please let me knowhow to resolve this issue.\nThanks in advance!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Dim r As Range\n If Target.Address = \"$C$2\" Then\n    Set r = Me.AutoFilter.Range\n If Len(Trim(Target.Value)) &gt; 0 Then\n  r.AutoFilter Field:=1, Criteria1:=Range(\"C2\").Value\n Else\n  r.AutoFilter Field:=1\n End If\n End If\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466625920, "post_id": 37977180, "comment_id": 63400696, "body": "What is <code>Main.ddMonthOfUse</code>?"}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466625982, "post_id": 37977180, "comment_id": 63400728, "body": "That is the combobox in the userform"}, {"owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "edited": false, "score": 0, "creation_date": 1466626740, "post_id": 37977180, "comment_id": 63401112, "body": "I assume you have fill your combobox with &quot;January February March ...&quot;, it is it ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466626885, "post_id": 37977180, "comment_id": 63401175, "body": "Please clarify exactly what you&#39;re trying to accomplish, I can&#39;t figure out what <code>month</code> is <i>supposed</i> to be doing - all I can say is that coupling the default instance of your UserForm to all instances of that <code>clsMonth</code> class is a very very very bad idea."}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466626893, "post_id": 37977180, "comment_id": 63401180, "body": "Correct, it fills it on the userform initializing."}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1466627051, "post_id": 37977180, "comment_id": 63401268, "body": "@Mat&#39;sMug when the combobox in the userform is selected (say the user chooses May), I want the message box to display the value of chillwater.May"}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466627117, "post_id": 37977180, "comment_id": 63401292, "body": "I was told creating a class would be the easiest way to do this, but I have never done that before so this is all very new to me. I think using the get method is giving me problems, I have never used it till today"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1466628409, "post_id": 37977180, "comment_id": 63401922, "body": "Just to notice the spelling of &quot;Janurary&quot; and &quot;Feburary&quot;..."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466688935, "post_id": 37977809, "comment_id": 63430024, "body": "Matt, thanks for your help. I do have a few questions is you get the chance to answer them."}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466689398, "post_id": 37977809, "comment_id": 63430396, "body": "I am a little confused on the VbGet parameter. Is that a built in VBA function or is that referring to something in your code that I don&#39;t see. Second, I&#39;m confused with the first part of the code overall. The part with Dim Instance as Object, and then using that combined with the VbGet. Thanks again"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466689698, "post_id": 37977809, "comment_id": 63430667, "body": "See <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278760.aspx\" rel=\"nofollow noreferrer\">CallByName</a> docs; the function requires an instance of an object that exposes the member you want to call; in this case the object is <code>Me</code> - the current instance; but <code>Me</code> cannot be passed directly to <code>CallByName</code> for some reason, so you make a copy (<code>instance</code>) and pass that instead. The function also requires the name of the member to call and an enum value that tells VBA how it should call it - <code>VbGet</code> works for <code>Property Get</code> members (and public fields) and says &quot;I&#39;m expecting something to be returned from this call&quot;."}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466690264, "post_id": 37977809, "comment_id": 63431145, "body": "And two more questions now, bare with me. All of this is done in the clsMonth Module, correct? And does the Private Type TMonth eliminate the need for my initial deceleration of all the months in my original code?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466690483, "post_id": 37977809, "comment_id": 63431345, "body": "Nah, the <code>Private Type TMonth</code> is just making it easier to encapsulate things with properties (vs exposing public fields), and eventually to serialize the data into a binary file, if that&#39;s ever needed. I just systematically do it that way, because I don&#39;t like exposing public fields in objects. And yes, <code>TMonth</code>, the <code>this</code> field, the 12 properties and the <code>ValueFor</code> function all belong in that class module."}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466694194, "post_id": 37977809, "comment_id": 63434280, "body": "Would you have any idea why VBA says that ValueFor function is not defined? I am calling it from the form code like you suggested. Again, sorry for so much follow up, you have been so very helpful!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466694545, "post_id": 37977809, "comment_id": 63434566, "body": "<code>ValueFor</code> should be a function defined in the class module, so you need to access it from an instance of that class, like I do in this answer (the dot in front of it makes it work against the <code>With</code> block variable)"}, {"owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "edited": false, "score": 0, "creation_date": 1466695376, "post_id": 37977809, "comment_id": 63435195, "body": "Do you take cash, check, or card? Haha Thanks so much for your help, your generosity is making the world go round!!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1466627719, "creation_date": 1466627719, "answer_id": 37977809, "question_id": 37977180, "link": "https://stackoverflow.com/questions/37977180/vba-object-reference-from-userform-not-working/37977809#37977809", "title": "vba object reference from userform not working", "body": "<blockquote>\n  <p><em>@Mat'sMug when the combobox in the userform is selected (say the user chooses May), I want the message box to display the value of chillwater.May</em></p>\n</blockquote>\n\n<p>Okay, got it. Remove all these, they're toxic:</p>\n\n<pre><code>Public chillWater As clsMonth, DX As clsMonth\n\nPublic Property Get month() As String\n\nmonth = Main.ddMonthOfUse.value\n\nEnd Property\n</code></pre>\n\n<p>You need to expose a <code>Function</code> that takes a month's name and returns the corresponding field's value.</p>\n\n<p>One way could be to leverage <code>CallByName</code> and do something like this:</p>\n\n<pre><code>Public Function ValueFor(ByVal monthName As String) As Single\n    On Error GoTo CleanFail\n\n    Dim instance As Object\n    Set instance = Me 'CallByName can't take \"Me\" directly\n\n    Dim result As Single\n    result = CallByName(instance, monthName, VbGet)\n\nCleanExit:\n    ValueFor = result\n    Exit Function\nCleanFail:\n    result = 0\n    Resume CleanExit\nEnd Function\n</code></pre>\n\n<p>Notice the <code>VbGet</code> parameter - it's going to work with a public field (I just tested it), but ideally you would <em>encapsulate</em> these values and expose them as <em>properties</em> instead. I like encapsulating my stuff like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Type TMonth '\"T\" + ClassName, just by convention\n    January As Single\n    February As Single\n    '...\n    December As Single\nEnd Type\n\nPrivate this As TMonth 'the only private field you need!\n\n'now expose a property accessor for each member:\n\nPublic Property Get January() As Single\n    January = this.January\nEnd Property\n\nPublic Property Let January(ByVal value As Single)\n    this.January = value\nEnd Property\n\n'...\n</code></pre>\n\n<hr>\n\n<p>And then your form code can do this:</p>\n\n<pre><code>Set chillWater = New clsMonth\nWith chillWater\n    .Janurary = 0.7136\n    .Feburary = 0.6755\n    .March = 0.6528\n    .April = 0.7773\n    .May = 0.8213\n    .June = 0.8715\n    .July = 0.9\n    .August = 1.0243\n    .September = 1.0516\n    .October = 0.8514\n    .November = 0.7095\n    .December = 0.6994\n\n    MsgBox \"Value for \" &amp; ddMonthOfUse.value &amp; \": \" &amp; .ValueFor(ddMonthOfUse.Value)\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6501021, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c8305e9ccfc9961f860ac20071fd0fbf?s=128&d=identicon&r=PG&f=1", "display_name": "ct4242", "link": "https://stackoverflow.com/users/6501021/ct4242"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 37977809, "answer_count": 1, "score": 1, "last_activity_date": 1466627719, "creation_date": 1466625542, "last_edit_date": 1531164843, "question_id": 37977180, "link": "https://stackoverflow.com/questions/37977180/vba-object-reference-from-userform-not-working", "title": "vba object reference from userform not working", "body": "<p>I am working and have hit a bit of a roadblock. For one I am not the strongest programmer, I was just given this task but have hit a roadblock (I think its syntax but not sure). </p>\n\n<p>We have done a lot of research to find some data correlations for some of our less technical consultants, and this VBA tool is going to be a quick reference for them to give customers real time projections. The subject is irrelevant to the question. </p>\n\n<p>I have created a class to contain the values, and then the plan was to reference the class from the VBA userform. When I reference the class, I don't get the value that I have stored, but I get the name of the property. </p>\n\n<pre><code>Private Sub ddMonthOfUse_Change()\n\nDim mv As String\n\nSet chillWater = New clsMonth\n    With chillWater\n        .Janurary = 0.7136\n        .Feburary = 0.6755\n        .March = 0.6528\n        .April = 0.7773\n        .May = 0.8213\n        .June = 0.8715\n        .July = 0.9\n        .August = 1.0243\n        .September = 1.0516\n        .October = 0.8514\n        .November = 0.7095\n        .December = 0.6994\n    End With\n\nSet DX = New clsMonth\n    With DX\n        .Janurary = 0.5777\n        .Feburary = 0.5536\n        .March = 0.5166\n        .April = 0.6112\n        .May = 0.7035\n        .June = 0.75\n        .July = 0.8\n        .August = 0.8345\n        .September = 0.9333\n        .October = 0.6865\n        .November = 0.5976\n        .December = 0.4907\n    End With\n\n\n    MsgBox chillWater.month\n\n    End Sub\n</code></pre>\n\n<p>In the class module I have this</p>\n\n<pre><code> Option Explicit\n\n'property decleration\nPublic Janurary As Single\nPublic Feburary As Single\nPublic March As Single\nPublic April As Single\nPublic May As Single\nPublic June As Single\nPublic July As Single\nPublic August As Single\nPublic September As Single\nPublic October As Single\nPublic November As Single\nPublic December As Single\nPublic chillWater As clsMonth, DX As clsMonth\n\nPublic Property Get month() As String\n\nmonth = Main.ddMonthOfUse.value\n\nEnd Property\n</code></pre>\n\n<p>Instead of the message box returning the value, if the user selects month March the message box says \"March.\" If, for example, I replace the reference to the dropdown and just type March, I get the value. </p>\n\n<p>I can't figure this out for the life of me. Please keep in mind I am not a veteran programmer at all, I have very rudimentary knowledge of the subject so I could be completely off here. Also I should mention that the message box is not the final use of the information, I was just testing to see if I was calling it correctly.  </p>\n"}, {"tags": ["excel", "loops", "solver", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466625691, "post_id": 37977158, "comment_id": 63400574, "body": "look into <a href=\"https://msdn.microsoft.com/en-us/library/5z06z1kb.aspx\" rel=\"nofollow noreferrer\"><code>For ... Next Loops</code></a> using the a <code>For each cel in Range(&quot;I96:AP96&quot;)</code> construct where <code>cel</code> is the variable <code>Dim cel as Range</code>."}], "answers": [{"tags": [], "owner": {"reputation": 960, "user_id": 5151278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-ilDIXFcHqdo/AAAAAAAAAAI/AAAAAAAADnQ/j3pEZAQLJ28/photo.jpg?sz=128", "display_name": "Maxime Port&#233;", "link": "https://stackoverflow.com/users/5151278/maxime-port%c3%a9"}, "is_accepted": false, "score": 0, "last_activity_date": 1466626225, "creation_date": 1466626225, "answer_id": 37977376, "question_id": 37977158, "link": "https://stackoverflow.com/questions/37977158/looping-a-solver-calculation-by-column/37977376#37977376", "title": "Looping A solver calculation by column", "body": "<p>If you want to execute this fragment of code for a given range:</p>\n\n<ol>\n<li><p>define your fragment of code as a function receiving \"setcell\" and \"bychange\" as range (if \"bychange\" never change, you can let it hard defined in the funtion and remove it from parameters)</p>\n\n<pre><code>Public Sub Solver(byval cell as range, byval change as range)\n    SolverOk SetCell:=cell, MaxMinVal:=3, ValueOf:=0, ByChange:=change, Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverSolve userFinish = False\nEnd sub\n</code></pre></li>\n<li><p>Define the range you want to calculate and run this function for each cell in the range</p>\n\n<pre><code>dim cell as range, rng as range\nset rng = Range(\"I96:AP96\")    ' You should need to set range with Worksheet(&lt;sheet&gt;).Range()\nfor each cell in rng\n    call Solver(cell, Range(\"I72\"))\nnext\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2382, "user_id": 3596337, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/342bc87e52c3a697732300f833e50036?s=128&d=identicon&r=PG&f=1", "display_name": "keiv.fly", "link": "https://stackoverflow.com/users/3596337/keiv-fly"}, "is_accepted": false, "score": 0, "last_activity_date": 1466626642, "creation_date": 1466626642, "answer_id": 37977485, "question_id": 37977158, "link": "https://stackoverflow.com/questions/37977158/looping-a-solver-calculation-by-column/37977485#37977485", "title": "Looping A solver calculation by column", "body": "<p>You can use a for loop and then generate the address string via cells function and Address method:</p>\n\n<pre><code>Dim i As Integer\nFor i = 9 To 42\n    s1 = Cells(96, i).Address(RowAbsolute:=True, ColumnAbsolute:=True)\n    s2 = Cells(72, i).Address(RowAbsolute:=True, ColumnAbsolute:=True)\n    SolverOk SetCell:=s1, MaxMinVal:=3, ValueOf:=0, ByChange:=s2, Engine _\n        :=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverOk SetCell:=s1, MaxMinVal:=3, ValueOf:=0, ByChange:=s2, Engine _\n        :=1, EngineDesc:=\"GRG Nonlinear\"\n    SolverSolve userFinish = False\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6501038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67ac740ce3efa5ce10f6aacf2081421c?s=128&d=identicon&r=PG&f=1", "display_name": "J.Dobson", "link": "https://stackoverflow.com/users/6501038/j-dobson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1466626642, "creation_date": 1466625444, "last_edit_date": 1531164843, "question_id": 37977158, "link": "https://stackoverflow.com/questions/37977158/looping-a-solver-calculation-by-column", "title": "Looping A solver calculation by column", "body": "<p>I'm just starting out in VBA and I'm trying to setup where a solver calculation is done for a range of multiple years, one after the other.  This is the simple code for 1 year.  How do I program it to tell it to do it for a range of columns, like from $I$96 to AP$96, one after the other?  Much appreciated.   </p>\n\n<pre><code>    SolverOk SetCell:=\"$i$96\", MaxMinVal:=3, ValueOf:=0, ByChange:=\"$i$72\", Engine _\n    :=1, EngineDesc:=\"GRG Nonlinear\"\nSolverOk SetCell:=\"$i$96\", MaxMinVal:=3, ValueOf:=0, ByChange:=\"$i$72\", Engine _\n    :=1, EngineDesc:=\"GRG Nonlinear\"\nSolverSolve userFinish = False\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "time", "format"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1466629418, "post_id": 37977010, "comment_id": 63402411, "body": "With respect I&#39;ve read this six times now and I still don&#39;t understand what you want. Could you re-phrase the question? Be specific and assume no one knows what your form looks like. What is it you want to do?"}, {"owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "reply_to_user": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1466635258, "post_id": 37977010, "comment_id": 63404609, "body": "ok I Got a Form with cboTime, [Text101] and [txtEndTime], I just want to be able to sum the text box of cboTime and the time value that is stored in [Text101] and the end result will be presented in [txtEndTime], like if cboTime.text is (9:00) and my duration is (0:10) then the end result will be 9:10"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1466635467, "post_id": 37977010, "comment_id": 63404673, "body": "The &quot;#####&quot; might be the result of spreadsheet columns too narrow --- make your columns wider. Maybe could happen if cboTime or Text101 has invalid data. Also, to get the end time you should do the sum <b>before</b> formatting: <code>Format(Me.cboTime + [Text101], &quot;h:nn AM&#47;PM&quot;)</code>"}, {"owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "edited": false, "score": 0, "creation_date": 1466637776, "post_id": 37977010, "comment_id": 63405329, "body": "Ok I made that text box bigger and it showed me only the equation &quot;8:55 AM+0:55&quot; without doing the operation... I want it to sum those values and display the end value, like &quot;9:50 AM&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1466789478, "last_edit_date": 1466789478, "creation_date": 1466788624, "answer_id": 38018871, "question_id": 37977010, "link": "https://stackoverflow.com/questions/37977010/determining-the-end-time-of-my-procedure/38018871#38018871", "title": "Determining the end time of my procedure", "body": "<p>Ok so I solved it, I had to do some more extra stuff to tell the program 9:00 AM + 0:55 = 9:55 AM... here's what I did:\n    Dim d, e, m, l As Date</p>\n\n<pre><code>    d = Format([Text101], \"n\")\n    m = Format(Me.txtAppointDate, \"Long Date\")\n    l = Format([cboTime], \"h:nn\")\n    e = DateAdd(\"n\", d, l)\n    Me.txtEndTime = Format(e, \"h:nn AMPM\")\n</code></pre>\n\n<p>'I needed to make this equation get the value of the duration time of a procedure depending on cboProcedure, so I built a select case:</p>\n\n<pre><code> Select Case Me.cboProcedure\nCase \"Haircut\"\ndDuration = TimeValue([Text101])\n    d = Format([Text101], \"n\")\n    m = Format(Me.txtAppointDate, \"Long Date\")\n    l = Format([cboTime], \"h:nn\")\n    e = DateAdd(\"n\", d, l)\n    Me.txtEndTime = Format(e, \"h:nn AMPM\")\n Case \"Hair Coloring\"\n dDuration = TimeValue([Text107])\n    d = Format([Text107], \"n\")\n    m = Format(Me.txtAppointDate, \"Long Date\")\n    l = Format([cboTime], \"h:nn\")\n    e = DateAdd(\"n\", d, l)\n    Me.txtEndTime = Format(e, \"h:nn AMPM\")\nCase \"Eyebrows Making\"\ndDuration = TimeValue([Text109])\n    d = Format([Text109], \"n\")\n    m = Format(Me.txtAppointDate, \"Long Date\")\n    l = Format([cboTime], \"h:nn\")\n    e = DateAdd(\"n\", d, l)\n    Me.txtEndTime = Format(e, \"h:nn AMPM\")\nCase \"Other\"\ndDuration = TimeValue([Text111])\n    d = Format([Text111], \"n\")\n    m = Format(Me.txtAppointDate, \"Long Date\")\n    l = Format([cboTime], \"h:nn\")\n    e = DateAdd(\"n\", d, l)\n    Me.txtEndTime = Format(e, \"h:nn AMPM\")\nEnd Select\n</code></pre>\n\n<p>now depending on a procedure my duration time will cost, so if the procedure is \"X\" then do this math</p>\n"}], "owner": {"reputation": 47, "user_id": 6312676, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/FXwNj.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6312676/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593958417, "creation_date": 1466624919, "last_edit_date": 1593958417, "question_id": 37977010, "link": "https://stackoverflow.com/questions/37977010/determining-the-end-time-of-my-procedure", "title": "Determining the end time of my procedure", "body": "<p>In my form I have 2 combo boxes and 2 text boxes also 1 temp variable </p>\n\n<p>cboProcedure = Displays the registered procedures\ndDuration = This is the temp variable , it will store the duration of the procedure\ncboTime = Displays the time of the day, divided by what the the temp variable says(Ex. dDuration = \"1:00\", cboTime will display in a dropdown menu, 9:00, 10:00, 11:00,12:00)<br>\ntxtEndTime = The end of the procedure, this is what Im trying to get \nText101 = This is the text box that displays the actual value of dDuration.(ex 1:00)\nI tried to make a code to sum the cboTime.Text(What I chose) + [Text101] = its supposed to give me the End Time of the procedure, but All I get is \"8:55 AM+0:55\". This is what I tried.</p>\n\n<pre><code>    Format(Me.cboTime, \"h:nn AM/PM\") &amp; \"+\" &amp; Format([Text101], \"h:nn AM/PM\")\n</code></pre>\n\n<p>I don't know if this is the correct way to sum time values...is this possible?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "edited": false, "score": 0, "creation_date": 1466688097, "post_id": 37977875, "comment_id": 63429336, "body": "When I press enter on Description 1 textbox after typing some words, it shows the Description 2 textbox which is good. However, when I press enter on the Description 1 textbox, whatever words are written is copied to the Description 2 textbox"}], "tags": [], "owner": {"reputation": 3917, "user_id": 1275255, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/40ffdb2f9ea3c58d2d8b5d53d23308cd?s=128&d=identicon&r=PG", "display_name": "Ivan Cachicatari", "link": "https://stackoverflow.com/users/1275255/ivan-cachicatari"}, "is_accepted": false, "score": 1, "last_activity_date": 1466628421, "last_edit_date": 1466628421, "creation_date": 1466628003, "answer_id": 37977875, "question_id": 37976982, "link": "https://stackoverflow.com/questions/37976982/how-to-create-expandable-retractable-form-ms-access-2013-vba/37977875#37977875", "title": "How to create expandable/retractable form MS Access 2013 VBA?", "body": "<p>Follow these steps:</p>\n\n<ol>\n<li><p>Mark the visible property as false</p>\n\n<p><a href=\"https://i.stack.imgur.com/xiZHz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xiZHz.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Add <code>OnChange</code> event for each textbox.</p>\n\n<p><a href=\"https://i.stack.imgur.com/0RGqW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0RGqW.png\" alt=\"enter image description here\"></a></p></li>\n<li><p>Write the VBA code to determine if the next control will be showed or hide. Note, the <code>Me!FormControlItem.Text</code> is accessible only if the control is focused.</p></li>\n</ol>\n\n<p>There is the 3 functions for each control.</p>\n\n<pre><code>Private Sub text1_Change()\n    If Not Trim(Me!text1.Text) = \"\" Then\n        Me!Text2.Visible = True\n        Me!Label2.Visible = True\n    ElseIf Not Trim(Me!Text2) = \"\" Then\n        Me!Text2.Visible = True\n        Me!Label2.Visible = True\n    Else\n        Me!Text2.Visible = False\n        Me!Label2.Visible = False\n    End If\nEnd Sub\n\nPrivate Sub Text2_Change()\n    If Not Trim(Me!Text2.Text) = \"\" Then\n        Me!Text3.Visible = True\n        Me!Label3.Visible = True\n    ElseIf Not Trim(Me!Text3) = \"\" Then\n        Me!Text3.Visible = True\n        Me!Label3.Visible = True\n    Else\n        Me!Text3.Visible = False\n        Me!Label3.Visible = False\n    End If\nEnd Sub\n\nPrivate Sub Text3_Change()\n    If Not Trim(Me!Text3.Text) = \"\" Then\n        Me!Text4.Visible = True\n        Me!Label4.Visible = True\n    ElseIf Not Trim(Me!Text4) = \"\" Then\n        Me!Text4.Visible = True\n        Me!Label4.Visible = True\n    Else\n        Me!Text4.Visible = False\n        Me!Label4.Visible = False\n    End If\nEnd Sub\n</code></pre>\n\n<ol start=\"5\">\n<li>Enjoy!</li>\n</ol>\n"}], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466628421, "creation_date": 1466624815, "question_id": 37976982, "link": "https://stackoverflow.com/questions/37976982/how-to-create-expandable-retractable-form-ms-access-2013-vba", "title": "How to create expandable/retractable form MS Access 2013 VBA?", "body": "<p>I am creating a data entry form for one of my database tables. For one of the sections, I have the text field with ONLY the caption: \"Description 1\" showing. If the Description 1 textbox is filled out by the user, I want it to show the Description 2 textbox. If the user fills out the Description 2 textbox, the Description 3 textbox will show up and so on up to 10 Description textboxes. Is there a way to hide the extra text boxes kind of like when you fill out the information while creating a macro? For example when you click Create --> Macro, there is only a dropdown box for you to select an action. If you choose Open Form and hit enter, 6 more text boxes with captions appear. </p>\n\n<p>Is there a way to get that kind of functionality in a form? Also, in the Macro builder, it dynamically rearranges the page for you, can this also be done with the form?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 1, "creation_date": 1466625614, "post_id": 37976855, "comment_id": 63400533, "body": "Have you considered using a dictionary to replace <code>arr2</code>. If you store the unique value as the key, you can protect against duplication relatively easily."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 6, "last_activity_date": 1466625184, "creation_date": 1466625184, "answer_id": 37977096, "question_id": 37976855, "link": "https://stackoverflow.com/questions/37976855/adding-to-arrays-and-finding-values-in-arrays/37977096#37977096", "title": "Adding to arrays and finding values in arrays", "body": "<p>I don't like using Filter because it also matches on <em>substrings</em>, and often that's not what you want</p>\n\n<pre><code>Function IsInArray(stringToBeFound As String, arr2 As Variant) As Boolean\n\n    IsInArray = Not IsError(Application.Match(stringToBeFound, arr2, 0))\n\nEnd Function\n</code></pre>\n\n<p>Also:</p>\n\n<pre><code>ReDim Preserve arr2(0 To UBound(arr2) + 1) As Variant\n</code></pre>\n\n<p>should probably be:</p>\n\n<pre><code>ReDim Preserve arr2(0 To UBound(arr2) + 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 4, "last_activity_date": 1466627907, "creation_date": 1466627907, "answer_id": 37977858, "question_id": 37976855, "link": "https://stackoverflow.com/questions/37976855/adding-to-arrays-and-finding-values-in-arrays/37977858#37977858", "title": "Adding to arrays and finding values in arrays", "body": "<p>I figured I'd add in my comment here as an answer. (I hope it's not outside the scope of this question/forum). If you're looking to store unique values in a collection, I'm not sure that you can beat the performance of a dictionary. </p>\n\n<p>Outside of the loop, you would declare and instantiate the <code>Dictionary</code>:</p>\n\n<pre><code>Dim oDict as Object\nSet oDict = CreateObject(\"Scripting.Dictionary\")\n</code></pre>\n\n<p>The code that you currently use to search <code>arr2</code> then add the value if unique would be amended to look something like:</p>\n\n<pre><code>If Not oDict.Exists(fRange.Offset(lRow - 6), 0).Address(False, False)) then\n    oDict(fRange.Offset(lRow - 6), 0).Address(False, False)) = \"\"\nEnd If\n\nSet fRange = WA.Cells.Find(What:=fVal, LookIn:=xlFormulas _\n, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\nMatchCase:=False, SearchFormat:=False)\n</code></pre>\n\n<p>I don't know how many records you expect to be inserting or searching through, or how performant your software needs to be, but performance can be significantly different. </p>\n"}], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 2, "accepted_answer_id": 37977096, "answer_count": 2, "score": 4, "last_activity_date": 1466627907, "creation_date": 1466624310, "last_edit_date": 1531164843, "question_id": 37976855, "link": "https://stackoverflow.com/questions/37976855/adding-to-arrays-and-finding-values-in-arrays", "title": "Adding to arrays and finding values in arrays", "body": "<p>I have 2 arrays:  one that has values to search a document for (<code>arr</code>) and one that will put in associated cell addresses with the found values (<code>arr2</code>).  I have no issues with <code>arr</code>, and have used it earlier in my code successfully.</p>\n\n<p>With <code>arr2</code>, I want to find any cells that contain the values in <code>arr</code>, and add the cell address <code>lRow</code> amount of rows down from it to <code>arr2</code>, but ONLY if that address isn't already in <code>arr2</code>.</p>\n\n<p>I found 2 SO answers that I'm trying to combine in order to solve my issue, but so far with no luck.</p>\n\n<p><a href=\"https://superuser.com/questions/808798/excel-vba-adding-an-element-to-the-end-of-an-array\">Excel VBA - adding an element to the end of an array</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/10951687/how-to-search-for-string-in-an-array\">How to search for string in an array</a></p>\n\n<p>My code below:</p>\n\n<pre><code>Sub Initiate()\n\nDim arr(3) As Variant\n    arr(0) = \"Value1\"\n    arr(1) = \"Value2\"\n    arr(2) = \"Value3\"\n    arr(3) = \"Value4\"\nDim arr2() As Variant\nDim Alc as String\nDim lRow as Long\nDim fVal as String\n\nlRow = Activesheet.Cells(Activesheet.Rows.Count, 1).End(xlUp).Row\n\nFor Each element In arr\n\nfVal = element\n\nSet fRange = WA.Cells.Find(What:=fVal, LookIn:=xlFormulas _\n    , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\nWhile Not fRange Is Nothing\n\n    While Not IsInArray(fRange.Offset(lRow - 6, 0).Address(False, False), arr2)\n\n        ReDim Preserve arr2(0 To UBound(arr2) + 1) As Variant\n\n        arr2(UBound(arr2)) = fRange.Offset(lRow - 6, 0).Address(False, False)\n\n    Set fRange = WA.Cells.Find(What:=fVal, LookIn:=xlFormulas _\n    , LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False, SearchFormat:=False)\n\n    Wend\n\nWend\n\nNext element\n\nAlc = \"=\"\n\n    For Each element In arr2\n\n        Alc = Alc &amp; element &amp; \"+\"\n\n    Next element\n\nAlc = Left(Alc, Len(Alc) - 1)\n\nMsgBox Alc\n\nEnd Sub\n\nFunction IsInArray(stringToBeFound As String, arr2 As Variant) As Boolean\n\n    IsInArray = (UBound(Filter(arr2, stringToBeFound)) &gt; -1)\n\nEnd Function\n</code></pre>\n\n<p>When run I get the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dk59e.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dk59e.png\" alt=\"enter image description here\"></a></p>\n\n<p>On this line of code (within the <code>IsInArray</code> function):</p>\n\n<p><code>IsInArray = (UBound(Filter(arr2, stringToBeFound)) &gt; -1)</code></p>\n\n<p>Any help is greatly appreciated!</p>\n"}, {"tags": ["vba", "excel", "events", "dynamic", "user-controls"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1466625021, "post_id": 37976647, "comment_id": 63400209, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/3014421/4088852\">How to add events to Controls created at runtime in Excel with VBA</a>, <a href=\"http://stackoverflow.com/q/25384623/4088852\">Create event handlers for multiple dynamic controls</a>, and probably others."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 4, "last_activity_date": 1466689850, "last_edit_date": 1466689850, "creation_date": 1466623926, "answer_id": 37976759, "question_id": 37976647, "link": "https://stackoverflow.com/questions/37976647/how-do-i-effectively-create-controls-dynamically-in-excels-vba-or-how-do-i-use/37976759#37976759", "title": "How do I effectively create controls dynamically in Excel&#39;s VBA or How do I use Application.OnTime()?", "body": "<blockquote>\n  <p><em>Obviously neither of those suggestions are valid. Macros ARE enabled and the sub is in the same darn <strong>class module</strong>.</em></p>\n</blockquote>\n\n<p>There's the problem: a <strong>macro</strong> cannot be in a <strong>class module</strong>. The message is entirely correct: VBA cannot see the <code>Timer</code> procedure, because it's not accessible.</p>\n\n<p>A class module is a blueprint for an <strong>object</strong>, VBA (or any OOP language for that matter) can't do anything with a class module, without an <strong>instance</strong> of that class - i.e. an object.</p>\n\n<p>Your timer callback needs to be a <code>Public Sub</code> in a <strong>standard module</strong>, so that it can be called directly <strong>as a macro</strong>. Public procedures of a class modules are <em>methods</em>, not <em>macros</em>.</p>\n\n<p>Depending on what <code>' DO SOME RANDOM THINGS '</code> actually stands for, this may or may not require some restructuring.</p>\n\n<p>1500-liner spaghetti code can be written in any language BTW.</p>\n"}], "owner": {"reputation": 22, "user_id": 6426023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0e47506cc643eda919fe142da76f36?s=128&d=identicon&r=PG&f=1", "display_name": "Apachi", "link": "https://stackoverflow.com/users/6426023/apachi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 37976759, "answer_count": 1, "score": 0, "last_activity_date": 1466689850, "creation_date": 1466623515, "question_id": 37976647, "link": "https://stackoverflow.com/questions/37976647/how-do-i-effectively-create-controls-dynamically-in-excels-vba-or-how-do-i-use", "title": "How do I effectively create controls dynamically in Excel&#39;s VBA or How do I use Application.OnTime()?", "body": "<p>I am working on a very large VBA project in Excel at my job.  We are about 1500 lines of code for just one feature and have about a dozen more features to add.  Because of this, I've been trying to break everything down so that I can keep code for each feature in separate places.  OOP sucks in VBA... The problem being that these controls MUST have events fired.  Of course, some events (like the TextBox_AfterUpdate event) are not available when you dynamically create controls.  It's a bit convoluted because of everything that is going on, so I'll break it down the best I can:</p>\n\n<p>I have a class module that represents a tab for a multipage control.  When a user clicks on a tab, the Userform calls this class module and THERE I have the controls created dynamically.  This way I can keep the code in that class module.  I have a sub that I deemed as the \"AfterUpdate\" sub and put code that I needed to run there.  Now the problem is to get that sub to be called at the appropriate time.</p>\n\n<p>So what I did is to set up a Timer of sorts to check and see if the \"ActiveControl\" is said textbox.  If it is not, we can assume that focus has left and we can raise that event.  Here's the code I'm using:</p>\n\n<p>An abbreviated version of the tab creation...</p>\n\n<pre><code>Private WithEvents cmbMarketplace As MSForms.ComboBox\n\nPublic Sub LoadTab(ByVal oPageTab As Object)\n    If TabLoaded Then Exit Sub\n\n    Set PageTab = oPageTab\n\n    Dim tmp As Object\n\n    Set tmp = PageTab.Add(\"Forms.Label.1\")\n    tmp.Top = 6: tmp.Left = 6: tmp.Width = 48\n    tmp.Caption = \"Marketplace:\"\n\n    Set cmbMarketplace = PageTab.Add(\"Forms.ComboBox.1\", \"cmbMarketplace\")\n\n    ' LOAD OTHER CONTROLS '\n\n    TabLoaded = True\n    Start_Timer\nEnd Sub\n</code></pre>\n\n<p>Then Start_Timer:</p>\n\n<pre><code>Public Sub Start_Timer()\n    TimerActive = True\n    Application.OnTime Now() + TimeValue(\"00:00:01\"), \"Timer\"\nEnd Sub\n</code></pre>\n\n<p>And the sub that is to be fired:</p>\n\n<pre><code>Public Sub Timer()\n    If TimerActive Then\n        ' DO SOME RANDOM THINGS '\n        Application.OnTime Now() + TimeValue(\"00:00:01\"), \"Timer\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Does this seem like a reasonable approach to solving the problem I'm facing?  I'm open to suggestions...</p>\n\n<p>That's the first problem.  This seems like a lot of work to accomplish this.  (I'm working on getting visual studio, but I don't know if that's going to happen)</p>\n\n<p>The above code will work but the \"Timer\" sub will not get raised at all.  I get no errors if I just run the code.  Everything is created, everything works as I would hope.  However, if I step through the code, I eventually will get the following error:</p>\n\n<pre><code>Cannot run the macro \"...xlsm!Timer\".  The macro may not be available in this workbook or all macros may be disabled.\n</code></pre>\n\n<p>Obviously neither of those suggestions are valid.  Macros ARE enabled and the sub is in the same darn class module.  I tried making it public, same problem.  Tried \"ClassModule1!Timer\" to no avail.  I'm at my wits end trying to figure this out.  Thinking of having people write ALL this in the Userform or just giving up.</p>\n\n<p>Does anybody have any suggestions on how to effectively break up large chunks of code?  And does anybody have a clue why this sub will not run and seemingly cannot be found?</p>\n\n<p>I understand that this is a confusing situation, so if you need more info or code examples or want to know why I have something set up the way I do, let me know.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1466623489, "post_id": 37976493, "comment_id": 63399466, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service. Yet, we are eager to help fellow programmers (and those looking to learn) with their code. Please read the help topics on [How do I Ask a Good Question][1]. You might also want to [take the tour][2] and earn a badge while doing so. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve.    [1]: <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>   [2]: <a href=\"http://stackoverflow.com/tour\">stackoverflow.com/tour</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6464830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3caf6fff53a6b8869c8bce765f943c7?s=128&d=identicon&r=PG&f=1", "display_name": "Bill M.", "link": "https://stackoverflow.com/users/6464830/bill-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1466623678, "creation_date": 1466623678, "answer_id": 37976693, "question_id": 37976493, "link": "https://stackoverflow.com/questions/37976493/vba-2010-saveas-filename/37976693#37976693", "title": "(VBA 2010) SaveAs Filename", "body": "<p>I could be more helpful if you could post your code.</p>\n\n<p>Use the cells(row,column) to get the values in the cells.  Creating a file in VBA, I recall is done with the Freefile and Open, Print#, Close syntax.</p>\n\n<p>(This is almost usable code, but not 100%)</p>\n\n<pre><code>Dim intHandle as Integer\nintHandle = FreeFile()\nOpen \"Filename.txt\" for output as intHandle\nPrint #intHandle, Excel.Cells(Row,Column).Value\nClose intHandle\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1466624006, "creation_date": 1466624006, "answer_id": 37976787, "question_id": 37976493, "link": "https://stackoverflow.com/questions/37976493/vba-2010-saveas-filename/37976787#37976787", "title": "(VBA 2010) SaveAs Filename", "body": "<p>This will do the job</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Not Range(\"A1\").Value = \"\" And Not Range(\"B1\").Value = \"\" And Not Range(\"C1\").Value = \"\" Then\n\n    Dim workbookName As String\n    workbookName = \"whatever.xls\"\n\n    ThisWorkbook.SaveAs \"C:\\\" &amp; workbookName\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>You need to decide how you want to name your file. If you just choose the <code>workbookName</code> to be anything, then the files are saved with an increment in the file name, like</p>\n\n<pre><code>workbookName(1).xls\nworkbookName(2).xls\n</code></pre>\n\n<p>etc..</p>\n"}], "owner": {"reputation": 47, "user_id": 6500895, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/af74d2b4769a02a766d12b6d200951b3?s=128&d=identicon&r=PG&f=1", "display_name": "Charlie West", "link": "https://stackoverflow.com/users/6500895/charlie-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "accepted_answer_id": 37976787, "answer_count": 2, "score": 0, "last_activity_date": 1466630408, "creation_date": 1466622909, "last_edit_date": 1531164843, "question_id": 37976493, "link": "https://stackoverflow.com/questions/37976493/vba-2010-saveas-filename", "title": "(VBA 2010) SaveAs Filename", "body": "<p>I need help to figure out how to get vba to create and save a file in a folder on my desktop after three cells have been filled in by a scanner. Imagine a grocery store scanner, it scans a product. Three pieces of information are  pulled from the bar-code and then placed in three separate cells say A1 B1 C1, how do I get VBA to see this information copy it and paste it into the saved file? this is what i have so far: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Not Range(\"A1\").Value = \"\" And Not Range(\"B1\").Value = \"\" And Not Range(\"C1\").Value = \"\" Then\n\n        Dim workbookName As String\n        workbookName = \"DiePunch.csv\"\n        ActiveCell.Range(\"A1:C1\").Select\n        Selection.Copy\n        Workbooks.Add\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        Application.CutCopyMode = Fa\n        ActiveWorkbook.SaveAs Filename:=\"u:\\CSV\\Diepunch.csv\", FileFormat:=xlCSV, CreateBackup:=False\n        ActiveWorkbook.Save\n        ActiveWindow.Close (SaveChange = False)\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "tsql", "vb6"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1466620568, "post_id": 37975769, "comment_id": 63397912, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/ms181984.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms181984.aspx</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466620663, "post_id": 37975769, "comment_id": 63397978, "body": "Your posted code seems to differ from your description - seems more like a <code>Split(ID, &quot;.&quot;)(0)</code> operation, not just &quot;remove period&quot;"}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466621059, "post_id": 37975769, "comment_id": 63398188, "body": "I might be wrong in my explanation of what the code is doing, my bad. That is how I understood the vb code. Please if the code is actually doing something different let me know. The existent code actually uses a Instr function, not a Split function."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466621204, "post_id": 37975769, "comment_id": 63398265, "body": "Your code is recovering everything to the left of the dot character - like the first part of a filename"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466621269, "post_id": 37975769, "comment_id": 63398295, "body": "Use suggestions from @Tim Williams link - might have to adjust for non SQL Server - you didn&#39;t say what SQL you&#39;re using"}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1466621315, "post_id": 37975769, "comment_id": 63398315, "body": "I am using SQL Server 2012. I think the function to use would be CHARINDEX."}, {"owner": {"reputation": 2356, "user_id": 3965828, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FfGGI.png?s=128&g=1", "display_name": "Jeffrey Van Laethem", "link": "https://stackoverflow.com/users/3965828/jeffrey-van-laethem"}, "edited": false, "score": 0, "creation_date": 1466621500, "post_id": 37975769, "comment_id": 63398415, "body": "I&#39;m no VB expert, but isn&#39;t that getting the first X characters of the string, where X = count of periods - 1?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1466622960, "post_id": 37975769, "comment_id": 63399167, "body": "Using your example &quot;VQAL1-SQ994.1&quot; your VB code returns &quot;VQAL1-SQ994&quot; ie. everything to the left of the first period."}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1466623103, "post_id": 37975769, "comment_id": 63399247, "body": "Yes that is true. The SQL that I updated the question wit, returns a blank value when the same string is passed, and if the value has no periods then it throws an error."}], "answers": [{"comments": [{"owner": {"reputation": 2356, "user_id": 3965828, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FfGGI.png?s=128&g=1", "display_name": "Jeffrey Van Laethem", "link": "https://stackoverflow.com/users/3965828/jeffrey-van-laethem"}, "edited": false, "score": 0, "creation_date": 1466621764, "post_id": 37975834, "comment_id": 63398557, "body": "Initially question was &quot;how to replace characters in a string&quot;, which explains this answer."}], "tags": [], "owner": {"reputation": 2356, "user_id": 3965828, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FfGGI.png?s=128&g=1", "display_name": "Jeffrey Van Laethem", "link": "https://stackoverflow.com/users/3965828/jeffrey-van-laethem"}, "is_accepted": false, "score": 2, "last_activity_date": 1466620728, "last_edit_date": 1466620728, "creation_date": 1466620525, "answer_id": 37975834, "question_id": 37975769, "link": "https://stackoverflow.com/questions/37975769/vba-convert-snippet-from-vba-to-sql/37975834#37975834", "title": "VBA: Convert snippet from VBA to SQL", "body": "<pre><code>REPLACE(yourstringcolumn, '.', '')\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms186862.aspx\" rel=\"nofollow\">Replace on MSDN</a></p>\n"}, {"comments": [{"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1466622225, "post_id": 37976121, "comment_id": 63398806, "body": "I updated my question to show what I am doing when migrating the VB code to a stored procedure in sql server 2012."}, {"owner": {"reputation": 2356, "user_id": 3965828, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FfGGI.png?s=128&g=1", "display_name": "Jeffrey Van Laethem", "link": "https://stackoverflow.com/users/3965828/jeffrey-van-laethem"}, "reply_to_user": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1466622510, "post_id": 37976121, "comment_id": 63398973, "body": "What you have looks correct now. If you pass in a string with 3 periods in it, you&#39;ll get the first 2 characters of the string you passed in. If the string you pass in has 22 periods, you&#39;ll get the first 21 characters, etc. It mimics what the VBA code you posted does."}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1466622860, "post_id": 37976121, "comment_id": 63399116, "body": "But if I pass a string: VQAL1-SQ994.1, then is passes a blank value. When it is supposed to pass everything to the left of the period. And if I pass a string that does not contains a period: VQAL1-SQ994, then it throws a message: Invalid length parameter passed to the LEFT or SUBSTRING function."}, {"owner": {"reputation": 2356, "user_id": 3965828, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FfGGI.png?s=128&g=1", "display_name": "Jeffrey Van Laethem", "link": "https://stackoverflow.com/users/3965828/jeffrey-van-laethem"}, "reply_to_user": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 1, "creation_date": 1466623152, "post_id": 37976121, "comment_id": 63399286, "body": "Yes, you&#39;d still need to wrap this in the IF logic. Your original code didn&#39;t do anything to the string if there were no periods. And the blank is getting returned because 1-1=0. If you want everything before the first period, use SELECT                         LEFT(@ProductID, CharIndex(&#39;.&#39;, @productID)-1)"}, {"owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "edited": false, "score": 0, "creation_date": 1466623424, "post_id": 37976121, "comment_id": 63399441, "body": "Perfect. That seems to be working. Thank you Jeffrey."}], "tags": [], "owner": {"reputation": 2356, "user_id": 3965828, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FfGGI.png?s=128&g=1", "display_name": "Jeffrey Van Laethem", "link": "https://stackoverflow.com/users/3965828/jeffrey-van-laethem"}, "is_accepted": true, "score": 2, "last_activity_date": 1466621559, "creation_date": 1466621559, "answer_id": 37976121, "question_id": 37975769, "link": "https://stackoverflow.com/questions/37975769/vba-convert-snippet-from-vba-to-sql/37976121#37976121", "title": "VBA: Convert snippet from VBA to SQL", "body": "<p>It looks like it's returning the first X characters of the string, with X being count of periods - 1. In TSQL you can do this via:</p>\n\n<pre><code>SELECT Left(id, LEN(id) - Len(Replace(id, '.', '')) - 1)\n</code></pre>\n"}], "owner": {"reputation": 772, "user_id": 5476615, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/f4tWm.gif?s=128&g=1", "display_name": "erasmo carlos", "link": "https://stackoverflow.com/users/5476615/erasmo-carlos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 37976121, "answer_count": 2, "score": 3, "last_activity_date": 1466622180, "creation_date": 1466620333, "last_edit_date": 1466622180, "question_id": 37975769, "link": "https://stackoverflow.com/questions/37975769/vba-convert-snippet-from-vba-to-sql", "title": "VBA: Convert snippet from VBA to SQL", "body": "<p>I have a small If statement that I would like to ask for help to convert it to SQL syntax.</p>\n\n<p>If I am correct, the If statement checks for the position where a period on the string passed might be found. If found (> 0) e.g. string: \"VQAL1-SQ994.1\", would be 12 so > 0 would be true, then can someone explain to me what the output of:         Id = Left(ID, InStr(ID, \".\") - 1) wuld be given the example string?</p>\n\n<pre><code>If InStr(ID, \".\") &gt; 0 Then \n    Id = Left(ID, InStr(ID, \".\") - 1)\nEnd If\n</code></pre>\n\n<p>Thank you for your help. </p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I put together a small stored procedure to see if I was able to make this work, but so far I think it is not working because it returns nothing from the string I pass.</p>\n\n<p>Test execute:</p>\n\n<pre><code>/*\nEXEC Test_String  'VQAL1-SQ994.1'\n*/\n</code></pre>\n\n<p>Stored Procedure contents:</p>\n\n<pre><code>ALTER PROCEDURE [dbo].[Test_String] (@ProductID VARCHAR(25))\nAS\nBEGIN\n\n    DECLARE @ID VARCHAR (25)\n    SET @ID = (\n                      SELECT\n                        LEFT(@ProductID, LEN(@ProductID) - LEN(REPLACE(@ProductID, '.', '')) - 1)\n                     );\n\n    SELECT @ID;\nEND;\n</code></pre>\n"}, {"tags": ["excel", "powerquery", "vba"], "comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466621657, "post_id": 37975724, "comment_id": 63398504, "body": "Have you tried <a href=\"http://www.nullskull.com/a/1602/profiling-and-optimizing-vba.aspx\" rel=\"nofollow noreferrer\">profiler</a>? The images are down in the official site, but, I saved the site before that, <a href=\"http://postimg.org/gallery/30nktztwq/\" rel=\"nofollow noreferrer\">check this link</a> to get the images"}, {"owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "reply_to_user": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466621807, "post_id": 37975724, "comment_id": 63398580, "body": "@Sgdva that profiles VBA code? I&#39;m looking to profile Power Query code. While I&#39;m using VBA do to so, profiling the VBA code itself doesn&#39;t help me. That&#39;d be like profiling the profiler."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466622047, "post_id": 37975724, "comment_id": 63398708, "body": "I see, yeah, it profiles VBA Coding, I misunderstood that you were trying to profile the routines for connections in your code, to look which ones were the slower, my bad."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466624336, "post_id": 37975724, "comment_id": 63399867, "body": "What / who is hosting the data you are querying? If you&#39;re connecting to an SQL Server then you should use the profiler there: <a href=\"https://www.mssqltips.com/sqlservertutorial/272/profiler-and-server-side-traces/\" rel=\"nofollow noreferrer\">mssqltips.com/sqlservertutorial/272/&hellip;</a> I am using this all the time for my queries."}, {"owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1466625544, "post_id": 37975724, "comment_id": 63400490, "body": "@Ralph I&#39;m using power query to transform flat files into usable data for exploratory analysis. I may ask for help on the specifics of optimizing those queries separately. But here I&#39;m asking about techniques to help figure it out myself. To try and answer the next question: I&#39;m working in a mildly tech-phobic corporate environment. I&#39;m only allowed to use the MS Office suite, no MS Access, and they are afraid of VBA. For some reason Power Query is acceptable. Insane corporate politics. (I can use VBA myself, just not in anything sustained or shared.)"}, {"owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "edited": false, "score": 0, "creation_date": 1527724764, "post_id": 37975724, "comment_id": 88239519, "body": "I&#39;ve never understood why asking how to profile a programming language so a developer can figure out how to improve performance got voted into oblivion. Oh SO, so friendly and helpful."}], "answers": [{"comments": [{"owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "edited": false, "score": 0, "creation_date": 1467130642, "post_id": 38003833, "comment_id": 63599162, "body": "This looks to be quite helpful! Thanks!"}], "tags": [], "owner": {"reputation": 13436, "user_id": 1787137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bdtdu.jpg?s=128&g=1", "display_name": "Mike Honey", "link": "https://stackoverflow.com/users/1787137/mike-honey"}, "is_accepted": true, "score": 2, "last_activity_date": 1466727234, "creation_date": 1466727234, "answer_id": 38003833, "question_id": 37975724, "link": "https://stackoverflow.com/questions/37975724/profiling-power-query/38003833#38003833", "title": "Profiling Power Query", "body": "<p>Power Query has a Tracing option which writes detailed info out to trace files.  Navigate to Options / Diagnostics to turn it on. </p>\n\n<p>A few people have blogged about using Power Query (what else?) to interpret and analyse those files:</p>\n\n<p><a href=\"http://excelando.co.il/en/analyzing-power-query-performance-source-large-files/\" rel=\"nofollow\">http://excelando.co.il/en/analyzing-power-query-performance-source-large-files/</a></p>\n\n<p><a href=\"https://blog.crossjoin.co.uk/2014/12/11/reading-the-power-query-trace-filewith-power-query/\" rel=\"nofollow\">https://blog.crossjoin.co.uk/2014/12/11/reading-the-power-query-trace-filewith-power-query/</a></p>\n"}], "owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 0, "accepted_answer_id": 38003833, "answer_count": 1, "score": -1, "last_activity_date": 1466727234, "creation_date": 1466620202, "last_edit_date": 1531164843, "question_id": 37975724, "link": "https://stackoverflow.com/questions/37975724/profiling-power-query", "title": "Profiling Power Query", "body": "<p>I'm trying to get a better idea of how to better optimize my Power Query code. Is there a way to profile queries and determine where they are spending their time?</p>\n\n<p>So far all I've been able to come up with is to break the query apart into separate queries that I can then connect to tables in Excel time using the below VBA code. The problem is, it is quite laborious to break the queries down and track down performance issues. Especially since the act of breaking them down may change how they perform.</p>\n\n<pre><code>'MicroTimer from http://stackoverflow.com/a/7116928/2250183\nPublic Function TestQuery(connectionName As String) As Double\n    Dim startTime As Double\n    Dim connection As OLEDBConnection\n    Set connection = ThisWorkbook.Connections(connectionName).OLEDBConnection\n\n    connection.BackgroundQuery = False\n    startTime = MicroTimer()\n    connection.Refresh\n    TestQuery = MicroTimer() - startTime\n    connection.BackgroundQuery = True\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "dao"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466620222, "post_id": 37975702, "comment_id": 63397715, "body": "I don&#39;t have anything to test this with, but is there a <code>.Value</code> property for the <code>.GetRows</code> method? Or what about <code>x = CInt(LBound(Db.OpenRecordset(&quot;SELECT COUNT(Asset_Name) FROM Assets WHERE Active = True&quot;).GetRows(1)))</code>"}, {"owner": {"reputation": 13, "user_id": 4678057, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GJrrKf8iMKg/AAAAAAAAAAI/AAAAAAAAAAA/pyGYPbJN2hE/photo.jpg?sz=128", "display_name": "Sean Colter O&#39;Connell", "link": "https://stackoverflow.com/users/4678057/sean-colter-oconnell"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466620467, "post_id": 37975702, "comment_id": 63397855, "body": "When I add <code>.value</code> to end of the statement to make it: <code>x = Db.OpenRecordset(&quot;SELECT COUNT(Asset_Name) FROM Assets WHERE Active = True&quot;).GetRows(1).Value</code> I get an &quot;Object Required&quot; Error."}, {"owner": {"reputation": 13, "user_id": 4678057, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GJrrKf8iMKg/AAAAAAAAAAI/AAAAAAAAAAA/pyGYPbJN2hE/photo.jpg?sz=128", "display_name": "Sean Colter O&#39;Connell", "link": "https://stackoverflow.com/users/4678057/sean-colter-oconnell"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466620682, "post_id": 37975702, "comment_id": 63397992, "body": "Wait, misread your statement. Your code doesn&#39;t error, but it returns x as a zero. But this is still progress."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466620822, "post_id": 37975702, "comment_id": 63398063, "body": "<code>.GetRows(0, 0)</code> it&#39;s a 2-D array.    Also need to see your declaration for <code>x</code>"}, {"owner": {"reputation": 13, "user_id": 4678057, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GJrrKf8iMKg/AAAAAAAAAAI/AAAAAAAAAAA/pyGYPbJN2hE/photo.jpg?sz=128", "display_name": "Sean Colter O&#39;Connell", "link": "https://stackoverflow.com/users/4678057/sean-colter-oconnell"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466621442, "post_id": 37975702, "comment_id": 63398380, "body": "@Tim-Williams <code>.GetRows(0, 0)</code> returns the &quot;Wrong number of arguments&quot; error. The <code>.GetRows(1)</code> doesn&#39;t have any issues when I just ask it to be stored in the spreadsheet, so I <i>assume</i> that&#39;s fine as is. I did declare x as an integer I just didn&#39;t display it in my question."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1466621866, "post_id": 37975702, "comment_id": 63398612, "body": "I changed the tags from <code>ADODB</code> to <code>DAO</code>. Still, <code>.Fields(0).Value</code> should work for both."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4678057, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GJrrKf8iMKg/AAAAAAAAAAI/AAAAAAAAAAA/pyGYPbJN2hE/photo.jpg?sz=128", "display_name": "Sean Colter O&#39;Connell", "link": "https://stackoverflow.com/users/4678057/sean-colter-oconnell"}, "edited": false, "score": 0, "creation_date": 1466622079, "post_id": 37976200, "comment_id": 63398728, "body": "PERFECT! Ran like a charm. Thank you, much appreciated, including the tag change"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": 1, "last_activity_date": 1466621808, "creation_date": 1466621808, "answer_id": 37976200, "question_id": 37975702, "link": "https://stackoverflow.com/questions/37975702/vba-store-recordset-as-integer-variable/37976200#37976200", "title": "vba store recordset as integer variable", "body": "<p>The following should give you the correct result:</p>\n\n<pre><code>Dim x As Integer\nDim db As DAO.Recordset\n\ndb.MoveFirst\nIf IsNumeric(db.OpenRecordset(\"SELECT COUNT(Asset_Name) FROM Assets WHERE Active = True\").Fields(0).Value) Then\n    x = CInt(db.OpenRecordset(\"SELECT COUNT(Asset_Name) FROM Assets WHERE Active = True\").Fields(0).Value)\nElse\n    MsgBox \"The query did not return a number.\" &amp; Chr(10) &amp; \"Aborting...\"\nEnd If\n</code></pre>\n\n<p>Note, that you are using <code>DAO</code> and not <code>ADO</code> as your original tags on the post indicated. Still, they both behave rather similar and the cursor is normally on the first row (when the data is returned). So, <code>MoveFirst</code> should not be necessary. Still, Microsoft themselves keep using it in its own sample code all the time. The first column if for <code>DAO</code> and <code>ADO</code> alike <code>.Fields(0)</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 4678057, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GJrrKf8iMKg/AAAAAAAAAAI/AAAAAAAAAAA/pyGYPbJN2hE/photo.jpg?sz=128", "display_name": "Sean Colter O&#39;Connell", "link": "https://stackoverflow.com/users/4678057/sean-colter-oconnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1220, "favorite_count": 1, "accepted_answer_id": 37976200, "answer_count": 1, "score": 1, "last_activity_date": 1466621808, "creation_date": 1466620095, "last_edit_date": 1466621475, "question_id": 37975702, "link": "https://stackoverflow.com/questions/37975702/vba-store-recordset-as-integer-variable", "title": "vba store recordset as integer variable", "body": "<p>First time poster, I finally had a question that I couldn't find an answer to here.</p>\n\n<p>I have an MS Access query that returns 1 result (which is a number) that I want to store as an integer variable (x) so I can use it later for a loop. The issue is that because I'm using it as a recordset and the variable is an integer, I'm receiving a \"Type Mismatch\" error.</p>\n\n<p>Right now I'm just storing the result to a cell and setting the variable equal to the cell:</p>\n\n<pre><code>Ws.Range(\"A1\") = Db.OpenRecordset(\"SELECT COUNT(Asset_Name) FROM Assets WHERE Active = True\").GetRows(1)\n\nx = Ws.Range(\"A1\")\n\nWs.Range(\"A1\").Delete\n</code></pre>\n\n<p>And then later I just have a loop that runs <em>x</em> times:</p>\n\n<pre><code>For i = 0 To x\n</code></pre>\n\n<p>Basically, I just want to have some code that looks like this:</p>\n\n<pre><code>x = Db.OpenRecordset(\"SELECT COUNT(Asset_Name) FROM Assets WHERE Active = True\").GetRows(1)\n</code></pre>\n\n<p>Any help here would be huge. Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1466622578, "post_id": 37975598, "comment_id": 63398997, "body": "are you sure you have more than 1 <code>xlsm</code> file in the folder? If so, it will immediately end the do loop."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466622586, "post_id": 37975598, "comment_id": 63399002, "body": "I&#39;m assuming the <code>Next</code> at the beginning of the last code snippet is from some other For loop in the copy and pasting operations, correct?"}, {"owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "edited": false, "score": 0, "creation_date": 1466622928, "post_id": 37975598, "comment_id": 63399150, "body": "Yes. The &quot;next&quot; is from a &quot;for each&quot; loop I used"}, {"owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "edited": false, "score": 0, "creation_date": 1466625383, "post_id": 37975598, "comment_id": 63400399, "body": "ISSUE WAS RESOLVED: It turns out it was something I used in my for loop within the do while loop. I used a Dir() function to equal the value of a cell. Creating a new variable as a string and having equate to my Dir() function solved it."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466625567, "post_id": 37975598, "comment_id": 63400502, "body": "Glad to hear you got it resolved! Please post your resolution as an answer and accept it so this question no longer appears as unanswered."}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "is_accepted": true, "score": 0, "last_activity_date": 1466625657, "creation_date": 1466625657, "answer_id": 37977217, "question_id": 37975598, "link": "https://stackoverflow.com/questions/37975598/opening-files-in-folder-with-loop/37977217#37977217", "title": "Opening files in folder with loop", "body": "<p>ISSUE WAS RESOLVED: It turns out it was something I used in my for loop within the do while loop. I used a Dir() function to equal the value of a cell. Creating a new variable as a string and having equate to my Dir() function solved it. </p>\n\n<p>Was:</p>\n\n<pre><code>Workbooks(DumpLocation).Sheets(DumpSheet) _\n               .Range(\"A\" &amp; NextOpenCellRow + 1).Value =Dir(RFQ_VendorFolder, vbDirectory)\n</code></pre>\n\n<p>is now:</p>\n\n<pre><code>                Workbooks(DumpLocation).Sheets(DumpSheet) _\n               .Range(\"A\" &amp; NextOpenCellRow + 1).Value = RFQ_Vendor\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6320502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c4f033120170e2764e85256ed6ff2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/6320502/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 37977217, "answer_count": 1, "score": 0, "last_activity_date": 1466625657, "creation_date": 1466619707, "last_edit_date": 1531164843, "question_id": 37975598, "link": "https://stackoverflow.com/questions/37975598/opening-files-in-folder-with-loop", "title": "Opening files in folder with loop", "body": "<p>I am trying to open excel files from a folder and copy and paste details into a master folder. Within each first level folder, there are some .xlsm files available to open, but there are also some within a second level folder within the first level folder (so an extra \\filepath).</p>\n\n<p>Right now, I am trying to figure out how to loop through the first level folder and open the \"loose\" workbooks (files in the first level folder that ARE NOT in a second level folder).</p>\n\n<p>This is what I have. Please note I will eventually add another \"level\" of folders, hence the large amount of variables:</p>\n\n<pre><code>Sub Compile_RFQ_Parts()\n\nDim RFQ_Ecoat As String 'file path for RFQ folder in ecoat folder\nDim RFQ_VendorFolder As String  'file path for specific vendor\nDim RFQ_FileFolder As String    'file path for RFQ folder within a vendor folder\nDim RFQ_File As String  'file within RFQ #### style folder in vendor folder\nDim RFQ_FileLooseVendor As String 'loose file in vendor folder\nDim RFQ_FileLooseEcoat As String    'loose file in ecoat RFQ folder\nDim RFQ_Num As String   'Number of RFQ from formula\nDim DumpLocation As String  'Bulk workbook\nDim DumpSheet As String     'Target sheet in bulk workbook\nDim NextOpenCellRow As Integer 'next open cell at the dump location\nDim RFQcell As Range  'counter for each cell in \"part number\" range in RFQ file\nDim RFQrange As Range   'range to look for part numbers in RFQ file\n</code></pre>\n\n<p>Define Variables</p>\n\n<pre><code>RFQ_Ecoat = \"S:\\FACILITY\\Sales\\RFQ\"\nRFQ_VendorFolder = RFQ_Ecoat &amp; \"\\Jensen Metals\"\nRFQ_FileLooseVendor = Dir(RFQ_VendorFolder &amp; \"\\*.xlsm\") 'wildcard to open spreadsheets\n\nDumpLocation = \"RFQ_Compile test target.xlsx\"\nDumpSheet = \"Sheet1\"\n</code></pre>\n\n<p>Begin Loop</p>\n\n<pre><code>'######loop through each .xlsm file in a Vendor folder (not in RFQ folder    but loose in vendor folder)######\n\n\n\nDo While RFQ_FileLooseVendor &lt;&gt; \"\"\n\nApplication.DisplayAlerts = False\nWorkbooks.Open Filename:=RFQ_VendorFolder &amp; \"\\\" &amp; RFQ_FileLooseVendor,       UpdateLinks:=False\nApplication.DisplayAlerts = True\n\n'vvvvvv%%%%%%%%%Copy and pasting operations%%%%%%%%%vvvvvv\n</code></pre>\n\n<p>Next File in loop within Folder</p>\n\n<pre><code>Next\n\n\n'#########close RFQ and loop to the next RFQ_FileLooseVendor#########\n\nApplication.DisplayAlerts = False\nWorkbooks(RFQ_FileLooseVendor).Close\nApplication.DisplayAlerts = True\nRFQ_FileLooseVendor = Dir() '&lt;&lt;&lt;This clears my RFQ_FileLooseVendor string, which ends my Do While loop before getting to other files\n\nLoop\n\n\nEnd Sub\n</code></pre>\n\n<p>When I get to the RFQ_FileLooseVendor=dir() line, it clears that variable (makes it = \"\"). I have seen this on countless other forums and I can't understand how it does not immediately end the Do While loop for everyone else like it does for me.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466623150, "post_id": 37975417, "comment_id": 63399284, "body": "Wouldn&#39;t it be easier to add your comments as an Input Message under Data Validation? Then your comments will appear when the cell is selected, but there is no indicator placed in the cell."}, {"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466623521, "post_id": 37975417, "comment_id": 63399485, "body": "As of right now I&#39;m working towards figuring out how I would do this but a macro is most logical with a comment. I need a comment on each cell in reference to the values of multiple cells on another worksheet. As far as I know, not possible to do with input message through data validation but might be possible with macros."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466623888, "post_id": 37975417, "comment_id": 63399661, "body": "You can use the <code>.Validation.InputMessage</code> property of a cell to set your input message in a macro if needed. I tend to avoid adding unnecessary shapes to Excel sheets because they can cause other unintended issues as well; especially if they are invisible."}, {"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466624209, "post_id": 37975417, "comment_id": 63399802, "body": "Once I start working on a macro, I&#39;ll give it a shot. The shapes has already been causing issues just depending on the person&#39;s zoom."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466624417, "post_id": 37975417, "comment_id": 63399910, "body": "Sounds good. I will add it as an answer. Let me know if you have any questions once you try it out."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466621224, "post_id": 37975888, "comment_id": 63398280, "body": "The code still seems to be making it the cover red. With enuming colors, I have about 7 different colors I will be using but they change depending on the conditions I have set, is there a nice way to embed them into a macro? I&#39;m a VBA newbie trying to learn as much as I can, let me give that code a shot though."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1466621710, "post_id": 37975888, "comment_id": 63398528, "body": "you could set the color indexes to variables and then in your condition code just say myCell.Interior.ColorIndex = variable1. Or you could say myCell.Interior.ColorIndex = myCell2.Interior.ColorIndex to match it with another cell&#39;s color"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466622254, "post_id": 37975888, "comment_id": 63398825, "body": "@adrenom that&#39;s strange, I tested it and works, have you tried different color combinations? Please note, this doesn&#39;t change the original color, this is just a nice workaround that adds a shape to the cell to mimic the &quot;arrow&quot; from comments, I don&#39;t think there&#39;s a a way to change the original one."}, {"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466622697, "post_id": 37975888, "comment_id": 63399053, "body": "I actually tried it with the &quot;+ 2&quot; aspect and it works however without it, it doesn&#39;t seem to copy the parent cell color scheme."}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466628626, "post_id": 37975888, "comment_id": 63402022, "body": "@adrenom that&#39;s strange, have you tried to store it in a previous variable and then re use?"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1466620708, "creation_date": 1466620708, "answer_id": 37975888, "question_id": 37975417, "link": "https://stackoverflow.com/questions/37975417/pulling-color-scheme-from-cell-and-applying-to-macro/37975888#37975888", "title": "Pulling Color Scheme from Cell and Applying to Macro", "body": "<p>This should cover it:</p>\n\n<pre><code>.Fill.ForeColor.SchemeColor = cmt.Parent.Interior.ColorIndex + 2 ' + 2 just a number to let the color be different from the color index in the cell\n</code></pre>\n\n<p>Also, I think it's a good idea to <a href=\"http://www.ozgrid.com/forum/showthread.php?t=53791\" rel=\"nofollow\">enum the colors</a> you may define for this.</p>\n"}, {"tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": true, "score": 1, "last_activity_date": 1466624513, "creation_date": 1466624513, "answer_id": 37976908, "question_id": 37975417, "link": "https://stackoverflow.com/questions/37975417/pulling-color-scheme-from-cell-and-applying-to-macro/37976908#37976908", "title": "Pulling Color Scheme from Cell and Applying to Macro", "body": "<p>Instead of adding shapes to the cells and trying to match cell colors, just add your comment as an Input Message under Data Validation. Then your comments will appear when the cell is selected, but there is no indicator placed in the cell.</p>\n\n<p>If you need to do this with a macro, you can use the <code>.Validation.InputMessage</code> property of a cell to set your input message. Try it once with the macro recorder and then modify the code to suit your needs.</p>\n"}], "owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 37976908, "answer_count": 2, "score": 0, "last_activity_date": 1466624513, "creation_date": 1466619132, "last_edit_date": 1531164843, "question_id": 37975417, "link": "https://stackoverflow.com/questions/37975417/pulling-color-scheme-from-cell-and-applying-to-macro", "title": "Pulling Color Scheme from Cell and Applying to Macro", "body": "<p>I have a macro put in place to cover over the comment indicators (generally red) so that it would blend in with the color of the cell. I was wondering what additions I needed to make to this macro so that it would instead pull the color scheme from the cell its referencing and place that value for the color scheme?</p>\n\n<pre><code>Option Explicit\n\nSub CoverCommentIndicator()\nDim ws As Worksheet\nDim cmt As Comment\nDim rngCmt As Range\nDim shpCmt As Shape\nDim shpW As Double 'shape width\nDim shpH As Double 'shape height\n\nSet ws = ActiveSheet\nshpW = 6\nshpH = 4\n\nFor Each cmt In ws.Comments\n  Set rngCmt = cmt.Parent\n  With rngCmt\n    Set shpCmt = ws.Shapes.AddShape(msoShapeRightTriangle, _\n      rngCmt.Offset(0, 1).Left - shpW, .Top, shpW, shpH)\n  End With\n  With shpCmt\n    .Flip msoFlipVertical\n    .Flip msoFlipHorizontal\n    .Fill.ForeColor.SchemeColor = 10\n    .Fill.Visible = msoTrue\n    .Fill.Solid\n    .Line.Visible = msoFalse\n  End With\nNext cmt\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "edited": false, "score": 0, "creation_date": 1466684715, "post_id": 37975271, "comment_id": 63426792, "body": "Anyone at all?? Please point me in the right direction..."}, {"owner": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "edited": false, "score": 0, "creation_date": 1466790792, "post_id": 37975271, "comment_id": 63480547, "body": "Anyone at all?  Can I put a bounty on a solution? will that help?"}], "owner": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466618625, "creation_date": 1466618625, "last_edit_date": 1531164843, "question_id": 37975271, "link": "https://stackoverflow.com/questions/37975271/filling-out-a-website-form-with-excel-vba", "title": "Filling out a website form with excel vba", "body": "<p>I have a website that I want to read some data off, do a bunch of calcs, then fill out a form and submit it, all using excel vba.</p>\n\n<p>I can read the website well enough, and do the calcs. I can also fill out a few of the inputs.</p>\n\n<p>However, on this final form, my technique no longer works.</p>\n\n<p>On the first few pages, the html has looked like</p>\n\n<pre><code>&lt;input name=\"ProjectFile-BuildingPermitNumber\" class=\"form-control\" type=\"text\" maxlength=\"100\" data-bind=\"textInput: ProjectFile().BuildingPermitNumber\"&gt;\n</code></pre>\n\n<p>and i I have been using , with elementname being projectfile-buildingpermitnumber</p>\n\n<p><code>IEValue = objIE.document.getElementsByName(ElementName)(0).Value</code></p>\n\n<p>to obtain the values and </p>\n\n<p><code>objHTML.getElementsByName(ElementName)(0).Value = ValueCheck</code></p>\n\n<p>to return them</p>\n\n<p>I have also used </p>\n\n<pre><code>Set AllLinks = objIE.document.getElementsByTagName(\"A\")\n</code></pre>\n\n<p>and a for loop to find buttons to click on. not the best technique, i probably should use a .click, but it works.</p>\n\n<p>anyway, on this new form, I do not have an id or name to work with.</p>\n\n<pre><code>&lt;div class=\"form-group\"&gt;\n&lt;label class=\"col-sm-3 control-label\"&gt;\n&lt;span&gt; Structural&lt;/span&gt;\n&lt;/label&gt;\n&lt;div class=\"input col-sm-7\"&gt;\n    &lt;input class=\"form-control\" type=\"text\" data-bind=\"value: DrawingsDocuments.Structural\"&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>Anyone got an idea on how I can refer to these types of boxes using excel? Ive tried all the different getelement etc that MS HTML controls give. </p>\n\n<p>Regards\nBryan</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466618286, "post_id": 37975131, "comment_id": 63396619, "body": "I believe you mean to have <code>Sheets(&quot;Sheet1&quot;).Select</code> but best would be to do this without selecting anything."}, {"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466618629, "post_id": 37975131, "comment_id": 63396791, "body": "No, I am trying to grab information from sheet 2 - I named it &quot;2&quot; so our inspectors can quickly click on it. So what I am trying to do is our contractors like to copy and paste but they do not use special paste so it ruins our named ranges. I hid the ranges and I am trying to write something that copies from lets say Day 2 and can be put into Day 23 for example. I would like to copy the data from a different day and post it in the current sheet they are working in"}, {"owner": {"reputation": 71, "user_id": 3294519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b612d78c9b8fe9bc918e61bd19bdb7b7?s=128&d=identicon&r=PG&f=1", "display_name": "Juanpablomo", "link": "https://stackoverflow.com/users/3294519/juanpablomo"}, "edited": false, "score": 0, "creation_date": 1466618775, "post_id": 37975131, "comment_id": 63396866, "body": "And you have a sheet with name &quot;ActiveSheet&quot;, if you don&#39;t have only need erase the line <code>Sheets(&quot;ActiveSheet&quot;).Select</code>"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466623354, "post_id": 37975131, "comment_id": 63399408, "body": "Take a look <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">here</a> for avoiding <code>Select</code> in your macros."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1466673050, "post_id": 37975131, "comment_id": 63418550, "body": "what is the benefit of <code>activesheet.select</code> ?! if it is already active, why would you re-active it ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466618790, "post_id": 37975264, "comment_id": 63396870, "body": "Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:H44&quot;) = Worksheets(&quot;Sheet2&quot;).Range(&quot;A1:H44&quot;) makes sense to me but how do I get it on the current sheet im working on. that&#39;s my problem I run into"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 1, "creation_date": 1466618912, "post_id": 37975264, "comment_id": 63396937, "body": "Then change <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:H44&quot;).Value</code> to <code>ActiveSheet.Range(&quot;A1:H44&quot;).Value</code>. Don&#39;t omit the <code>.Value</code> like I originally did."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466618937, "post_id": 37975264, "comment_id": 63396960, "body": "@hipster_pete - Just change the left part of the formula to refer to the sheet you&#39;re working on. If it&#39;s not &quot;Sheet1&quot;, just change that to &quot;mySheetName&quot; or whatever..."}, {"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466619053, "post_id": 37975264, "comment_id": 63397028, "body": "I don&#39;t want to do that because I want to run a macro that can be run on any day without having to change the posting location - Id rather have it on the current active sheet."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 1, "creation_date": 1466619107, "post_id": 37975264, "comment_id": 63397067, "body": "@hipster_pete did you see my comment?"}, {"owner": {"reputation": 206726, "user_id": 5459839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iehrR.jpg?s=128&g=1", "display_name": "trincot", "link": "https://stackoverflow.com/users/5459839/trincot"}, "reply_to_user": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466619147, "post_id": 37975264, "comment_id": 63397088, "body": "@hipster_pete, So just change the left most <code>Worksheets(&quot;Sheet1&quot;)</code> to <code>ActiveSheet</code>... no? Seems straightforward."}, {"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466619301, "post_id": 37975264, "comment_id": 63397169, "body": "@MattCremeens I am now completely lost but I did see your comment. I keep getting an error"}, {"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466619630, "post_id": 37975264, "comment_id": 63397380, "body": "This is what I inputed"}, {"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466619643, "post_id": 37975264, "comment_id": 63397389, "body": "Sub Macro1()     Worksheets(&quot;2&quot;).Range(&quot;A1:H44&quot;).Value = Worksheets(&quot;ActiveSheet&quot;).Range(&quot;A1:H44&quot;).Value End Sub  the error I get is saying it&#39;s not in range"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466619753, "post_id": 37975264, "comment_id": 63397457, "body": "No, use <code>ActiveSheet.Range(&quot;A1:H44&quot;).Value = Worksheets(&quot;Sheet2&quot;).Range(&quot;A1:H44&quot;).Value</code>"}, {"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466619949, "post_id": 37975264, "comment_id": 63397560, "body": "@MattCremeens THAT WORKED YOU ARE MY HERO &lt;3"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466619999, "post_id": 37975264, "comment_id": 63397579, "body": "Glad to hear. All the best."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 3, "last_activity_date": 1466618597, "creation_date": 1466618597, "answer_id": 37975264, "question_id": 37975131, "link": "https://stackoverflow.com/questions/37975131/excel-vba-macro-issue/37975264#37975264", "title": "Excel VBA Macro Issue", "body": "<p>Instead of selecting, cutting and pasting, consider</p>\n\n<pre><code>Sub Macro1()\n    Worksheets(\"Sheet1\").Range(\"A1:H44\").Value = Worksheets(\"Sheet2\").Range(\"A1:H44\").Value\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "edited": false, "score": 0, "creation_date": 1466618960, "post_id": 37975306, "comment_id": 63396970, "body": "I agree with that too - I like the = part, I am getting stuck on the getting info onto the current sheet I am on"}], "tags": [], "owner": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1466618735, "creation_date": 1466618735, "answer_id": 37975306, "question_id": 37975131, "link": "https://stackoverflow.com/questions/37975131/excel-vba-macro-issue/37975306#37975306", "title": "Excel VBA Macro Issue", "body": "<p>Change</p>\n\n<pre><code>Sheets(\"ActiveSheet\").Select\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ActiveSheet.Select\n</code></pre>\n\n<p>However, I agree with Matt on the point that you should try to stay away from <code>.Select</code></p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1466620330, "post_id": 37975675, "comment_id": 63397780, "body": "Please don&#39;t do that. Mark Matt&#39;s answer as accepted instead, by clicking the checkmark next to it."}], "tags": [], "owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "is_accepted": false, "score": -3, "last_activity_date": 1466619990, "creation_date": 1466619990, "answer_id": 37975675, "question_id": 37975131, "link": "https://stackoverflow.com/questions/37975131/excel-vba-macro-issue/37975675#37975675", "title": "Excel VBA Macro Issue", "body": "<p>Sub Macro1()\n    ActiveSheet.Range(\"A1:H44\").Value = Worksheets(\"2\").Range(\"A1:H44\").Value\nEnd Sub</p>\n\n<p>Kudos to Matt for the answer! </p>\n"}, {"tags": [], "owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "is_accepted": false, "score": 0, "last_activity_date": 1466674046, "creation_date": 1466674046, "answer_id": 37987523, "question_id": 37975131, "link": "https://stackoverflow.com/questions/37975131/excel-vba-macro-issue/37987523#37987523", "title": "Excel VBA Macro Issue", "body": "<p><code>\"ActiveSheet\"</code> is a string.\n<code>Activesheet</code> is a Worksheet Object.</p>\n\n<p><code>Activesheet.range(\"A1\").value</code> is equivalent to <code>Sheets(Activesheet.name).value</code> or to <code>Sheets(Activesheet.index).value</code>.</p>\n\n<p>That is because <code>Sheets</code> (or <code>Worksheets</code>, wich are the same) , can be referenced in braquets () trough either their names (being strings), or their Index (number, wich is the sheet's position in the Workbook).</p>\n\n<p><code>Worksheets</code>is a collection (by collection , i mean a kind of array) of your workbook's sheets.</p>\n\n<p><code>Activesheet</code> is a VBA easy way to access a sheet wich is already active, in the same way that <code>ActiveWorkbook' for workbooks, or</code>ActiveCell` for cells. They are all Objects , not Strings.</p>\n"}], "owner": {"reputation": 1, "user_id": 6500618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148d9721d66786f516dd56247a913a50?s=128&d=identicon&r=PG&f=1", "display_name": "hipster_pete", "link": "https://stackoverflow.com/users/6500618/hipster-pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1466674046, "creation_date": 1466618137, "last_edit_date": 1466618235, "question_id": 37975131, "link": "https://stackoverflow.com/questions/37975131/excel-vba-macro-issue", "title": "Excel VBA Macro Issue", "body": "<p>I am currently having a problem compiling a Macro that I am trying to make. I am either trying to use a Named Range or the actual range on a different sheet and copy and paste that data into the current sheet. I want the data to post to the current sheet so I can run this Macro on every day of the month. Here is what I have compiled but for some reason I cannot use the ActiveSheet. Attached is my code.</p>\n\n<pre><code>Sub Macro1()\n\n' Daily Route Sheet\n\n    Sheets(\"2\").Select\n    ActiveCell.Range(\"A1:H44\").Select\n    Selection.Copy\n    Sheets(\"ActiveSheet\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6500603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f070e2d8aab11097f13abdf719731d2?s=128&d=identicon&r=PG&f=1", "display_name": "Colin F.", "link": "https://stackoverflow.com/users/6500603/colin-f"}, "edited": false, "score": 1, "creation_date": 1466624552, "post_id": 37976019, "comment_id": 63399991, "body": "Fabulous! Thank you!"}], "tags": [], "owner": {"reputation": 84, "user_id": 1698780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baca58d0e482a436d744e3e82dd26848?s=128&d=identicon&r=PG", "display_name": "Steven Chang", "link": "https://stackoverflow.com/users/1698780/steven-chang"}, "is_accepted": true, "score": 0, "last_activity_date": 1466621192, "creation_date": 1466621192, "answer_id": 37976019, "question_id": 37975113, "link": "https://stackoverflow.com/questions/37975113/vba-txt-file-with-two-delimiters-for-rows-and-columns/37976019#37976019", "title": "VBA - Txt file with two delimiters for rows and columns", "body": "<p>You can pre-process the text before importing to Excel using a more powerful text editor such as <a href=\"http://www.textpad.com\" rel=\"nofollow noreferrer\">TextPad</a>.</p>\n\n<p>In TextPad, do a Replace (F8 key). First let's get rid of your so called \"end of notepad space\" which I read as line breaks.</p>\n\n<p>Use regular expression to replace double carriage returns \"\\n\\n\" with nothing:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ta9dS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ta9dS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then, replace pipes \"\\|\" with spaces \" \":</p>\n\n<p><a href=\"https://i.stack.imgur.com/P72ee.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P72ee.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then, replace \"_ ~ ~ _ \" with a carriage return \"\\n\":</p>\n\n<p><a href=\"https://i.stack.imgur.com/mlMfv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mlMfv.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is the final text that should be ready to import into Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YaFXs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YaFXs.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope that helps! TextPad is a great tool to have around.</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1466623916, "last_edit_date": 1466623916, "creation_date": 1466623314, "answer_id": 37976594, "question_id": 37975113, "link": "https://stackoverflow.com/questions/37975113/vba-txt-file-with-two-delimiters-for-rows-and-columns/37976594#37976594", "title": "VBA - Txt file with two delimiters for rows and columns", "body": "<p>You can do this in a single step using a VBA macro.</p>\n\n<ul>\n<li>Read in the entire file to a VBA String variable</li>\n<li>Remove the <code>newline</code> characters</li>\n<li>Split on the row delimiter\n\n<ul>\n<li>This results in a 1D array</li>\n<li>Convert the array to a 2D array</li>\n<li>write the results to the worksheet</li>\n<li>Do text to columns using the pipe as the delimiter</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit\n'SET REFERENCE to Microsoft Scripting Runtime\n\nSub ImportSpecial()\n    Dim FSO As FileSystemObject\n    Dim TS As TextStream\n    Dim sFN As Variant\n    Dim S As String\n    Dim V As Variant\n    Dim R As Range\n\nsFN = Application.GetOpenFilename(\"Text Files (*.txt), *.txt\")\nIf Not sFN = False Then\n    Set FSO = New FileSystemObject\n    Set TS = FSO.OpenTextFile(sFN, ForReading, False, TristateFalse)\n\n    'Remove the linefeeds\n    S = TS.ReadAll\n    S = Replace(S, vbNewLine, \"\")\n\n    'If data is large, will need to transpose manually\n    V = Application.WorksheetFunction.Transpose(Split(S, \"_ ~|~ _\"))\n\n    Set R = ActiveSheet.Cells(1, 1).Resize(UBound(V), 1)\n    With R\n        .EntireColumn.Clear\n        .Value = V\n        .TextToColumns Destination:=R(1), _\n                        DataType:=xlDelimited, _\n                        Tab:=False, semicolon:=False, comma:=False, Space:=False, _\n                        other:=True, otherchar:=\"|\"\n        .EntireColumn.AutoFit\n    End With\n End If\n End Sub\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 27, "user_id": 6500603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f070e2d8aab11097f13abdf719731d2?s=128&d=identicon&r=PG&f=1", "display_name": "Colin F.", "link": "https://stackoverflow.com/users/6500603/colin-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1015, "favorite_count": 0, "accepted_answer_id": 37976019, "answer_count": 2, "score": 2, "last_activity_date": 1466623916, "creation_date": 1466618070, "last_edit_date": 1466620394, "question_id": 37975113, "link": "https://stackoverflow.com/questions/37975113/vba-txt-file-with-two-delimiters-for-rows-and-columns", "title": "VBA - Txt file with two delimiters for rows and columns", "body": "<p>I have a <code>.txt</code> file where columns are delimited with <code>|</code> (pipe) but rows are delimited with the following string: <code>_ ~|~ _</code></p>\n\n<p>Is there a way to import this by delimiting rows based on the string? If I could just do that, I would be able to do text to columns easily. </p>\n\n<p>This is tricky because the space in each row in Notepad is being exhausted. For example:</p>\n\n<pre><code>Policy|Name|Cost _ ~|~ _ 11924|Joe|$20 _ ~|~ _ 154 (end of notepad space)\n\n35|Bob|$40 _ ~|~ _ 18439|Jane|$30 _ ~|~ _ 18492|Ri\n\nchard|$50\n</code></pre>\n\n<p>I need this to read:</p>\n\n<pre><code>Policy Name Cost\n\n11924  Joe  $20\n\n15435  Bob  $40\n\n18439  Jane $30\n\n18492 Richard $50\n</code></pre>\n\n<p>and so on. Note that values at the far right are split because notepad has exhausted its line length.</p>\n\n<p>Thanks for any ideas!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1466620835, "post_id": 37975084, "comment_id": 63398070, "body": "Protip: make an account and post your <b>actual, working code</b> in full context on <a href=\"https://codereview.stackexchange.com\">Code Review</a>, make the title say <i>what problem your code is solving</i>, explain reviewers what the code is doing and why, and you&#39;ll get feedback and suggestions about all aspects of the code, <i>including</i> ways to extract methods and parameterize your procedural code."}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "edited": false, "score": 0, "creation_date": 1466620462, "post_id": 37975379, "comment_id": 63397851, "body": "How would I go about changing the <code>random operations</code> though? I don&#39;t have a problem generalizing to use on other sheets or workbooks. It&#39;s the fact that I have to re-write this code for each <code>random operation</code> that I want to do"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "edited": false, "score": 0, "creation_date": 1466621473, "post_id": 37975379, "comment_id": 63398400, "body": "Structurally, do the random operations do the same thing like pass a formula/value to each cell which you can pass a parameter? Does code differ by grouping/category which you can add conditionals in general function. Please post more detail."}, {"owner": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "edited": false, "score": 0, "creation_date": 1466625903, "post_id": 37975379, "comment_id": 63400685, "body": "I included some examples of what I&#39;m trying to do in my edit"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "edited": false, "score": 0, "creation_date": 1466643718, "post_id": 37975379, "comment_id": 63406786, "body": "See edit passing in an <i>OperationType</i> parameter that will condition the <code>for</code> loop operation using <code>Select...Case</code> logic. You may want to nest for/loops within the Cases."}, {"owner": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "edited": false, "score": 0, "creation_date": 1466688603, "post_id": 37975379, "comment_id": 63429772, "body": "Ok, that&#39;s what my original plan was. I was just wondering if looping through that <code>Select...Case</code> logic was the most efficient way to do that."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "edited": false, "score": 0, "creation_date": 1466694812, "post_id": 37975379, "comment_id": 63434759, "body": "As mentioned, try reversing by nesting for/loop inside the case blocks so you do not need to check iteratively. Check performance of either."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1466643584, "last_edit_date": 1466643584, "creation_date": 1466619008, "answer_id": 37975379, "question_id": 37975084, "link": "https://stackoverflow.com/questions/37975084/how-do-i-avoid-this-repetitive-code/37975379#37975379", "title": "How do I avoid this repetitive code?", "body": "<p>Consider using a generalized user-defined function and place it where all macros have access to it, either the <code>ThisWorkbook</code> section or a standard module:</p>\n\n<pre><code>Public Function randomSub(SheetName As String, ColumnLetter As String, _\n                          OperationType As String)\n    Dim wsh As Worksheet\n    Dim i As Long, finalRow As Long\n    Dim stringHolder() As String\n\n    Set wsh = ThisWorkbook.Worksheets(SheetName)\n\n    With wsh\n        finalRow = wsh.Cells(wsh.Rows.Count, ColumnLetter).End(xlUp).Row\n        For i = 3 To finalRow                              \n             Select Case OperationType\n\n                 Case \"MoveToFront\"\n                    stringHolder = Split(Sheet2.Cells(i, 11), \"; \")\n                    If stringHolder(1) = \"\" Then\n                        .Cells(i, 11) = stringHolder(0)\n                    Else\n                        .Cells(i, 11) = stringHolder(1) &amp; \"; \" &amp; stringHolder(0)\n                    End If\n\n                 Case  \"fillInTotals\"\n                    If .Cells(i, 3) &lt;&gt; \"\" Then\n                            .Cells(i, 1) = \"='EUS Graph'!$C$\" &amp; _\n                                     Application.WorksheetFunction.Match(.Cells(i, 3), _\n                                     Sheet4.Range(\"$A:$A\"), 0)\n                    Else\n                            .Cells(i, 1) = \"='EUS Graph'!$C$\"\n                    End If\n\n             End Select\n        Next i\n    End With\nEnd Function\n</code></pre>\n\n<p>Then, call the function as needed, passing required parameters:</p>\n\n<pre><code>Call randomSub(ActiveSheet.Name, \"A\", \"MoveToFront\")\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 4153027, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa775e0da83a15b363890244fb802dba?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Trowbridge", "link": "https://stackoverflow.com/users/4153027/devin-trowbridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 37975379, "answer_count": 1, "score": 0, "last_activity_date": 1466643584, "creation_date": 1466617979, "last_edit_date": 1531164843, "question_id": 37975084, "link": "https://stackoverflow.com/questions/37975084/how-do-i-avoid-this-repetitive-code", "title": "How do I avoid this repetitive code?", "body": "<p>I have a bunch of subroutines for a worksheet that all start and end exactly the same way. They all basically loop through every row in the table and perform some unique operation to each individual row. I do not want them all to run every time, instead I want to be able to call them individually.</p>\n\n<p>Here's what the actual code looks like:</p>\n\n<pre><code>Sub randomSub()\n    Dim finalRow As Long\n    Dim i As Long\n\n    finalRow = Sheet.Cells(Rows.count, Column).End(xlUp).row\n\n    With Sheet2\n        For i = 3 To finalRow\n            ' Do some random operations here\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>Setting the code up to loop through every row is not hard but after repeating it across 4 or 5 different subs I imagine there is a better way.</p>\n\n<p>So I guess my question is this: Is there a best practice for avoiding writing a loop set-up like this over and over for every new sub I make?</p>\n\n<p>EDIT: Here's some examples of the type of operations I'm doing, and would normally replace the <code>' Do random operations here</code></p>\n\n<pre><code>Sub moveToFront()\n    Dim stringHolder() As String\n\n    stringHolder = Split(Sheet2.Cells(i, 11), \"; \")\n    If stringHolder(1) = \"\" Then\n        .Cells(i, 11) = stringHolder(0)\n    Else\n        .Cells(i, 11) = stringHolder(1) &amp; \"; \" &amp; stringHolder(0)\n    End If\nEnd Sub\n</code></pre>\n\n<p>And another</p>\n\n<pre><code>Sub fillInTotals()\n    If .Cells(i, 3) &lt;&gt; \"\" Then\n        .Cells(i, 1) = \"='EUS Graph'!$C$\" &amp; _\n            Application.WorksheetFunction.Match(.Cells(i, 3), Sheet4.Range(\"$A:$A\"), 0)\n    Else\n        .Cells(i, 1) = \"='EUS Graph'!$C$\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466617344, "post_id": 37974627, "comment_id": 63396058, "body": "I think some of your troubles could be fixed by <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">avoiding using <code>.Select</code></a>.  When it gets to <code>ActiveCell</code>, that&#39;s <i>likely</i> not the cell you&#39;re expecting it to be."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466617872, "post_id": 37974627, "comment_id": 63396380, "body": "With web scraping, if it works when stepping through but not when run straight (without any pauses) that often points to a timing issue: additional content may be being loaded <i>after</i> the page reports as &quot;complete&quot;.  Try adding a pause before trying to access any content."}, {"owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466622812, "post_id": 37974627, "comment_id": 63399092, "body": "@TimWilliams I added an Application.Wait(Now + TimeValue(&quot;0:00:01&quot;)) in the first line below the if statement and still the same problem. Do you think it should go somewhere else?"}, {"owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466622816, "post_id": 37974627, "comment_id": 63399095, "body": "@BruceWayne, I commented out the active Cell and Select lines and left the Debug.Print strOutput, and still only getting the first two keywords in the Immediate window."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466623369, "post_id": 37974627, "comment_id": 63399416, "body": "Try a 10sec wait directly after the &quot;Wait for IE page to finish loading&quot; loop."}, {"owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1466623424, "post_id": 37974627, "comment_id": 63399440, "body": "@TimWilliams, THANK YOU SO MUCH! I moved the application.wait to right below my do until readystate Loop and it works! I never would have guessed it was because the whole page wasn&#39;t finished loading i thought thats what the do Until Ready state loop was for! guess it doesn&#39;t hurt to be redundant when it comes to vba."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466623599, "post_id": 37974627, "comment_id": 63399515, "body": "That &quot;wait&quot; loop only gets you so far - in the &quot;old days&quot; of the web it would have been enough, but these days there&#39;s often dynamic content which gets loaded only <i>after</i> the main page content has completed."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "is_accepted": false, "score": 0, "last_activity_date": 1466623506, "creation_date": 1466623506, "answer_id": 37976642, "question_id": 37974627, "link": "https://stackoverflow.com/questions/37974627/html-search-code-runs-as-intended-when-debugging-but-not-completely-when-fully/37976642#37976642", "title": "HTML Search Code Runs As Intended when Debugging, but not completely when fully Ran", "body": "<p>Found the Answer thanks to @TimWilliams. </p>\n\n<p>I put</p>\n\n<pre><code>  Application.Wait (Now + TimeValue(\"0:00:01\"))\n</code></pre>\n\n<p>Below the </p>\n\n<pre><code>Do Until ie.ReadyState = READYSTATE_COMPLETE Or ie.ReadyState =        READYSTATE_INTERACTIVE\n        'DoEvents\n    Loop\n</code></pre>\n\n<p>and now the code runs as intended!</p>\n"}], "owner": {"reputation": 71, "user_id": 6466375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/52ee600c33fb5df0d038e42d91bf8a26?s=128&d=identicon&r=PG&f=1", "display_name": "A.Cod", "link": "https://stackoverflow.com/users/6466375/a-cod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466623506, "creation_date": 1466616295, "last_edit_date": 1531161705, "question_id": 37974627, "link": "https://stackoverflow.com/questions/37974627/html-search-code-runs-as-intended-when-debugging-but-not-completely-when-fully", "title": "HTML Search Code Runs As Intended when Debugging, but not completely when fully Ran", "body": "<p>I have a code that runs perfectly when stepping through, but it doesn't run completely when ran as whole. There are no errors. The code searches through HTML tags and scans for a keyword, if that keyword is found within an HTML cell, the whole cell is outputted to an Excel cell. I am looking for a keyword that appears 3 times on a webpage. When I debug and step through, all 3 instances of the keyword are found, and the cell it is in populates cells A1:C1 in Excel. However, when the code is ran as a whole, only the first two instances are found. Can anyone tell me why that is? My guess is the IF statement is not triggered for the last keyword for some reason... I will include the HTML body and my VBA code. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;HTML&gt;\r\n&lt;HEAD&gt;\r\n&lt;META NAME=\"name\" CONTENT=\"sldfkjsd\"&gt;\r\n&lt;TITLE&gt;Title&lt;/TITLE&gt;\r\n\r\n&lt;P&gt;\r\n&lt;TABLE BORDER=3 CELLPADDING=6 CELLSPACING=3&gt;\r\n&lt;TR&gt;\r\n&lt;TD&gt;\r\n&lt;PRE&gt;\r\n\r\nAAAA AAAA AAAA AAA AAA AAAA AAA AAAA AAAA AAA\r\n  BBBBb BBBBB BBBBB BBBBB BBBBBBBBBBBBBB B\r\n  keyword\r\n  CCCCCCCcc CCCCCCCCCC CCCCCCCCCCCC DDDDDDDD\r\n\r\n&lt;/PRE&gt;\r\n&lt;/TD&gt;\r\n&lt;/TR&gt;\r\n&lt;TR&gt;\r\n&lt;TD&gt;\r\n&lt;PRE&gt;\r\nAAAA AAAA AAAA AAA AAA AAAA AAA AAAA AAAA AAA\r\n  BBBBb BBBBB BBBBB BBBBB BBBBBBBBBBBBBB B\r\n  keyword\r\n  CCCCCCCcc CCCCCCCCCC CCCCCCCCCCCC DDDDDDDD\r\n\r\n&lt;/PRE&gt;\r\n&lt;/TD&gt;\r\n&lt;/TR&gt;\r\n&lt;TR&gt;\r\n&lt;TD&gt;\r\n&lt;PRE&gt;\r\nAAAA AAAA AAAA AAA AAA AAAA AAA AAAA AAAA AAA\r\n  BBBBb BBBBB BBBBB BBBBB BBBBBBBBBBBBBB B\r\n  keyword\r\n  CCCCCCCcc CCCCCCCCCC CCCCCCCCCCCC DDDDDDDD\r\n\r\n&lt;/PRE&gt;\r\n&lt;/TD&gt;\r\n&lt;/TR&gt;\r\n&lt;NEXT&gt;&lt;/NEXT&gt;\r\n&lt;/TABLE&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<pre><code>Sub subFindScrollIE()\n\n'Set Variables\nDim boolFound As Boolean\nDim strTemp() As Variant, txt As String\nDim strOutput As String\nDim tbl As HTMLTable, tables As IHTMLElementCollection\nDim tr As HTMLTableRow, r As Integer, i As Integer\nDim tRows As IHTMLElementCollection\nDim ie As InternetExplorer\n'Delete Rows and Select A1\nRows(\"1:100\").Delete\nActiveSheet.Range(\"A1\").Select\n\n\nSet ie = New InternetExplorer\n\n'Show Webpage (optional)\n'ie.Visible = True\nDim dateToday As String\n\n'Get Today's date in yyyymmmdd to input into URL for most today's alert page\ndateToday = Format((Now), \"yyyymmdd\")\n\n\n'Navigate to Desired URL with today's date\nie.Navigate \"URL\" &amp; dateToday &amp; \".html\"\n\n'Input Keywords\nstrTemp = Array(\"Keyword\")\n\n'Wait for IE page to finish loading\nDo Until ie.ReadyState = READYSTATE_COMPLETE Or ie.ReadyState = READYSTATE_INTERACTIVE\n    'DoEvents\nLoop\n\n    'Declare rows\nSet allrows = ie.Document.body.getElementsByTagName(\"tr\")\n\n' loop through rows\nFor Each trow In allrows\n\n    Set tcell = trow.Cells\n\n    ' loop through cells\n    For r = 0 To (tcell.Length - 1)\n\n        Set td = tcell(r)\n\n        ' loop through search text\n        For i = 0 To UBound(strTemp)\n            ' search row for string\n            txt = LCase(td.innerHTML)\n            If (InStr(txt, LCase(strTemp(i))) &gt; 0) Then\n\n             Application.PrintCommunication = True\n                ' search string found. create output html table\n                'strOutput = strOutput &amp; tRows(r).outerHTML &amp; vbCrLf\n                strOutput = tcell(r).innerHTML\n\n                'Output string to new workbook\n                ActiveCell.Value = strOutput\n\n                'Move one cell to the right for next possible match to be pasted\n                ActiveCell.Offset(0, 1).Select\n\n\n                'Reset string (just in case, not needed)\n                Debug.Print strOutput\n                strOutput = \"\"\n            End If\n        Next i\n    Next r\nNext trow\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 367, "user_id": 5113478, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/dfbfb7059a7b15cf4ff01b4a6acf9704?s=128&d=identicon&r=PG&f=1", "display_name": "Garuda", "link": "https://stackoverflow.com/users/5113478/garuda"}, "edited": false, "score": 0, "creation_date": 1466686867, "post_id": 37975243, "comment_id": 63428370, "body": "Thanks for you help. I did as you said but my ribbon did not show up :("}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 2, "last_activity_date": 1466618519, "creation_date": 1466618519, "answer_id": 37975243, "question_id": 37974447, "link": "https://stackoverflow.com/questions/37974447/get-name-or-id-of-a-ribbon-controls/37975243#37975243", "title": "Get name or Id of a ribbon controls", "body": "<p><strong><em>Short answer:</em></strong> You can't do this in Excel\n<br> 1. I'd suggest you to try <a href=\"http://openxmldeveloper.org/blog/b/openxmldeveloper/archive/2009/08/07/7293.aspx\" rel=\"nofollow noreferrer\">CustomUIEditor</a>\n<br> 2. You may change the extension of excel to .zip and look in the archives for some XML that resembles the buttons. (For example my file has the button \"Archivos de Ayuda\")</p>\n\n<p><a href=\"https://i.stack.imgur.com/D19mb.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D19mb.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "is_accepted": false, "score": 1, "last_activity_date": 1466627493, "creation_date": 1466627493, "answer_id": 37977754, "question_id": 37974447, "link": "https://stackoverflow.com/questions/37974447/get-name-or-id-of-a-ribbon-controls/37977754#37977754", "title": "Get name or Id of a ribbon controls", "body": "<p>For your first question <code>How do I trigger a ribbon button click using VBA code?</code></p>\n\n<p>I use the following on the Workbook.Open event that creates the new tab in the ribbon, creates the button with an icon and assigns a Macro to the button.  When button pressed it calls a sub from a custom AddIn I created.</p>\n\n<pre><code>Sub RibbonChange()\n\nDim hFile As Long\nDim path As String, fileName As String, ribbonXML As String  \n\nhFile = FreeFile\nfileName = \"Excel.officeUI\"\n\n\nribbonXML = \"&lt;mso:customUI      xmlns:mso='http://schemas.microsoft.com/office/2009/07/customui'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"  &lt;mso:ribbon&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"    &lt;mso:qat/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"    &lt;mso:tabs&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"      &lt;mso:tab id='reportTab' label='YOUR LABLE' insertBeforeQ='mso:TabFormat'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"        &lt;mso:group id='reportGroup' label='YOUR LABLE' autoScale='true'&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"          &lt;mso:button id='runReport' label='YOUR LABLE' \" &amp; vbNewLine\nribbonXML = ribbonXML + \"imageMso='AppointmentColor2'      onAction='YOUR SUB NAME'/&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"        &lt;/mso:group&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"      &lt;/mso:tab&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"    &lt;/mso:tabs&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"  &lt;/mso:ribbon&gt;\" &amp; vbNewLine\nribbonXML = ribbonXML + \"&lt;/mso:customUI&gt;\"\n\nribbonXML = Replace(ribbonXML, \"\"\"\", \"\")\n\nOpen path &amp; fileName For Output Access Write As hFile\nPrint #hFile, ribbonXML\nClose hFile\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 367, "user_id": 5113478, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/dfbfb7059a7b15cf4ff01b4a6acf9704?s=128&d=identicon&r=PG&f=1", "display_name": "Garuda", "link": "https://stackoverflow.com/users/5113478/garuda"}, "is_accepted": false, "score": 5, "last_activity_date": 1466687087, "last_edit_date": 1495541346, "creation_date": 1466687087, "answer_id": 37992513, "question_id": 37974447, "link": "https://stackoverflow.com/questions/37974447/get-name-or-id-of-a-ribbon-controls/37992513#37992513", "title": "Get name or Id of a ribbon controls", "body": "<p>I found this below link\n<a href=\"https://stackoverflow.com/questions/615482/how-to-get-ribbon-custom-tabs-ids\">How to get Ribbon custom Tabs IDs?</a></p>\n\n<p>further reading reached me to this link </p>\n\n<p><a href=\"http://www.wordarticles.com/Shorts/RibbonVBA/RibbonVBADemo.php\" rel=\"nofollow noreferrer\">http://www.wordarticles.com/Shorts/RibbonVBA/RibbonVBADemo.php</a></p>\n\n<p>In the download section I downloaded the word template that has a VBA program to read the ribbon,tab and buttons. It also has a code to trigger/ execute the selected button. This VBA function can also be used for excel.</p>\n"}], "owner": {"reputation": 367, "user_id": 5113478, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/dfbfb7059a7b15cf4ff01b4a6acf9704?s=128&d=identicon&r=PG&f=1", "display_name": "Garuda", "link": "https://stackoverflow.com/users/5113478/garuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5576, "favorite_count": 2, "answer_count": 3, "score": 3, "last_activity_date": 1485513978, "creation_date": 1466615586, "last_edit_date": 1531161705, "question_id": 37974447, "link": "https://stackoverflow.com/questions/37974447/get-name-or-id-of-a-ribbon-controls", "title": "Get name or Id of a ribbon controls", "body": "<p>I have a custom ribbon control in my excel that ribbon is developed through 3rd party c# add in. How do I trigger a ribbon button click using VBA code? Many examples over the net show this but my first problem is I even don't know the name of the ribbon. How do I get the name of the ribbon and ribbon button i am interested in?</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1466615440, "post_id": 37974377, "comment_id": 63394945, "body": "Look into dictionaries and Collections.  Or you could simply copy and paste then use Remove Duplicates. Then you can load that into an array."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466615447, "post_id": 37974377, "comment_id": 63394950, "body": "Do you have any code?"}, {"owner": {"reputation": 49, "user_id": 6500426, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/59ca0db84f06fdd0e03499840fe7a198?s=128&d=identicon&r=PG&f=1", "display_name": "aggieman", "link": "https://stackoverflow.com/users/6500426/aggieman"}, "edited": false, "score": 0, "creation_date": 1466616404, "post_id": 37974377, "comment_id": 63395494, "body": "I have some but I don&#39;t even know how to set up a multidimensional array where the number of rows is a variable. I want to take an array( ACRYLIC 0.04&quot;   WHITE) then add the next unique array under it (blue, 0.04&quot;   WHITE). The dimension then would be 2*3 then 3*3 and so on. The number of rows must be able to change and I dont know how to define the multidimensional array without errors."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466617576, "post_id": 37974377, "comment_id": 63396210, "body": "A good start would be searching for &quot;vba multidimensional array&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1466629735, "creation_date": 1466629735, "answer_id": 37978269, "question_id": 37974377, "link": "https://stackoverflow.com/questions/37974377/vba-macro-material-organizination/37978269#37978269", "title": "VBA macro material organizination", "body": "<p>IMO the most efficient way is to put the data into an array. Then, loop through the array and add the item to a dictionary if the item does not already exist in the dictionary e.g. If not dictionary.Exists(myItemName) then dictionary.Add myItemName, myItemValue. See <a href=\"https://msdn.microsoft.com/en-us/library/wak0wfyt.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/wak0wfyt.aspx</a> and <a href=\"https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx</a>\nYou can then iterate the dictionary and output the data as you need it.</p>\n"}], "owner": {"reputation": 49, "user_id": 6500426, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/59ca0db84f06fdd0e03499840fe7a198?s=128&d=identicon&r=PG&f=1", "display_name": "aggieman", "link": "https://stackoverflow.com/users/6500426/aggieman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466629735, "creation_date": 1466615289, "last_edit_date": 1466615370, "question_id": 37974377, "link": "https://stackoverflow.com/questions/37974377/vba-macro-material-organizination", "title": "VBA macro material organizination", "body": "<pre><code>ACRYLIC 0.04\"   WHITE\nACRYLIC 0.04\"   WHITE\nACRYLIC 0.04\"   WHITE\nblue    0.04\"   WHITE\nACRYLIC 0.04\"   WHITE\nACRYLIC 0.04\"   WHITE\nblue    0.04\"   g\n</code></pre>\n\n<p>I want to create an array that stores only unique material.\nfor example. The program should step through the list and store in a i X 3 array. i being the row that changes. Im having a hard time preserving the values in an array. I want to take each unique 1 X 3 matrix and store them in the array. </p>\n\n<p>array should hold</p>\n\n<pre><code>ACRYLIC 0.04\"   WHITE\nblue    0.04\"   WHITE\nblue    0.04\"   g\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1466615079, "post_id": 37974311, "comment_id": 63394746, "body": "Not sure why it didn&#39;t add the picture, but here it is. I don&#39;t have enough reputation yet to post pictures. <a href=\"http://i.stack.imgur.com/zzXK1.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/zzXK1.png</a>"}, {"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1466615137, "post_id": 37974311, "comment_id": 63394771, "body": "The dark grey lines are where my data is"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1466615222, "post_id": 37974311, "comment_id": 63394828, "body": "Will it always start in Row 4? Or always start in a specific row?"}, {"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 1, "creation_date": 1466615306, "post_id": 37974311, "comment_id": 63394872, "body": "I have it always start in row 4"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1466615401, "post_id": 37974311, "comment_id": 63394917, "body": "Selecting a range of cells can be done by: ActiveSheet.Range(Cells(15,1),Cells(16,16)). The cells() function takes two parameters, a Row Index and a Column Index, both are numbers."}, {"owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "edited": false, "score": 0, "creation_date": 1466615563, "post_id": 37974311, "comment_id": 63395024, "body": "oh ok nice, so I can add in ActiveSheet.Range(Cells(LastRow,1),Cells(LastRow + 1,16)) ?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466615703, "post_id": 37974311, "comment_id": 63395095, "body": "Also, <i>avoid using <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\"><code>.Select</code></a></i>"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1466616028, "post_id": 37974311, "comment_id": 63395279, "body": "@rdan1 your statement is correct. Assuming your LastRow is holding the correct value."}], "answers": [{"tags": [], "owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1466615712, "creation_date": 1466615712, "answer_id": 37974477, "question_id": 37974311, "link": "https://stackoverflow.com/questions/37974311/adding-data-below-last-used-row-and-merging-the-cells/37974477#37974477", "title": "Adding data below last used row and merging the cells", "body": "<p>To select the range requested, I would use:</p>\n\n<pre><code>With ActiveSheet\n    .Range(\"A4:P\" &amp; .cells(rows.count,1).end(xlup).row).Select\nEnd with\n</code></pre>\n\n<p>I must recommend not selecting this range though. I recommend performing whatever action is necessary directly on the range.</p>\n\n<pre><code>With ActiveSheet\n    .Range(\"A4:P\" &amp; .cells(rows.count,1).end(xlup).row).Merge\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6481029, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2dc03256511a24ea40d258e57c83fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "rdan1", "link": "https://stackoverflow.com/users/6481029/rdan1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466615712, "creation_date": 1466615018, "last_edit_date": 1466615383, "question_id": 37974311, "link": "https://stackoverflow.com/questions/37974311/adding-data-below-last-used-row-and-merging-the-cells", "title": "Adding data below last used row and merging the cells", "body": "<p>I am trying to make a compare file script that'll check for a certain ticketID on file 1 that isn't on file 2, and vice versa. That compare will add the whole row to a sheet if it wasn't found in a file. I have the data separated and have text that is a description for the first block of data (the IDs in file1 not in file2).</p>\n\n<p><em>I have attached an image of what the current output looks like (I've erased the pertinent data but the data goes in the light grey lines).</em> \nI have my code ordered to where I want to insert the description text for the second compare. So I check for last row after the first compare loop. </p>\n\n<pre><code>Sheets(\"Sheet3\").Select\nLastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nActiveSheet.Cells(LastRow, \"A\").Value = \"here\"\nActiveSheet.Cells(LastRow, \"A\").Select\n</code></pre>\n\n<p>My issue is that I don't know how to grab that range of cells. In my current output, I want to grab from (A15:P16), so two rows all the way to column P. I always know it'll be Row A and Column P, but I never know what row number. This is because when I compare files I won't know how many differences I will have and therefore how many rows are used in sheet3. Once I have this range selected or available, I'd like to put in my description text for the second block of data and be able to merge and indent and customize it so I can have it where I want. Then I will do the second compare and insert the data from file 2 not found in file1. So the main issue is I don't know how to grab that range of cells I want because I won't know the exact rows it'll be on.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466617767, "post_id": 37974224, "comment_id": 63396329, "body": "It&#39;s not clear what workbook/sheet you&#39;re trying to copy from - I assume that code is working okay? And what workbook/sheet are you trying to paste it into - FullPath or SaveAs file?"}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466618014, "post_id": 37974224, "comment_id": 63396465, "body": "So I am trying to copy from the workbook that I am in using this code here:                                Range(&quot;&#39;owssvr&#39;!A1:O18&quot;).CopyPicture                     Sheets(&quot;Image&quot;).Select                     Range(&quot;A1&quot;).Select                     ActiveSheet.Paste"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466618344, "post_id": 37974224, "comment_id": 63396655, "body": "I&#39;m asking what workbooks is sheet &quot;owssvr&quot; located"}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466618814, "post_id": 37974224, "comment_id": 63396884, "body": "It&#39;s in the template that I use and it is in the excel documents that are created using the template."}], "answers": [{"comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1466621396, "post_id": 37975468, "comment_id": 63398352, "body": "Sadly doesn&#39;t help - what gives you the error - I&#39;m just using the same lines you use in your own code. What&#39;s your new code - and what line gives you the error and what is the error message. You can help us help you"}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1466622169, "post_id": 37975468, "comment_id": 63398771, "body": "the error was coming from this line that you had me add:Set objActiveWkbk = objXL.Application.Workbooks.Open FullPath which I changed to say this: objXL.Application.Workbooks.Open FullPath after it threw a syntax error on that line. After I changed it, it still didn&#39;t work, saying that something was wrong with this line: Range(&quot;&#39;owssvr&#39;!A1:O18&quot;).CopyPicture."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1466623626, "post_id": 37975468, "comment_id": 63399525, "body": "I can see you&#39;re having issues reading my siggestions. If you&#39;re getting an error on the CopyPicture line it must mean yiu didn&#39;t follow instructions to put the OpenPath statement AFTER that line - not BEFORE it. If you&#39;re going to change things or not copy/paste suggestions - then edit your original post and insert your amended code at the bottom with an EDIT statement."}, {"owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1466628736, "post_id": 37975468, "comment_id": 63402071, "body": "Ok, so this is going to suck a little for me, but I am afraid that I have figured it out, It was in my console application, I was calling the path to the template instead of the document it created. Sorry for wasting all your time, but I do really appreciate all your time helping me out."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "edited": false, "score": 0, "creation_date": 1466632718, "post_id": 37975468, "comment_id": 63403827, "body": "Being new to the site, it&#39;s probably worth mentioning that people appreciate any little acknowledgement - and upvoting helpful replies is one way to show it. Enjoy your time on SO"}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1466619290, "creation_date": 1466619290, "answer_id": 37975468, "question_id": 37974224, "link": "https://stackoverflow.com/questions/37974224/trying-to-cut-and-paste-an-image-from-excel-to-my-email-it-is-working-just-not/37975468#37975468", "title": "Trying to cut and paste an image from excel to my email, it is working, just not right", "body": "<p>Assuming CopyPicture is working as designed, you probably need to reopen the path</p>\n\n<p>After </p>\n\n<pre><code>Range(\"'owssvr'!A1:O18\").CopyPicture\n</code></pre>\n\n<p>and Before this line</p>\n\n<pre><code>Sheets(\"Image\").Select\n</code></pre>\n\n<p>Insert line between the two lines:</p>\n\n<pre><code> Set objActiveWkbk = objXL.Application.Workbooks.Open FullPath\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 1964100, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/5977b0f7659513889c30c380bdac1b1e?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/1964100/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466619290, "creation_date": 1466614736, "last_edit_date": 1531161705, "question_id": 37974224, "link": "https://stackoverflow.com/questions/37974224/trying-to-cut-and-paste-an-image-from-excel-to-my-email-it-is-working-just-not", "title": "Trying to cut and paste an image from excel to my email, it is working, just not right", "body": "<p>Well, this one is interesting. So I have this template that loads up items from a sharepoint list, and then I do things with the items.</p>\n\n<p>One of the things that I need to do is to be able to take a screen shot of the excel doc, attach it to an email, and send it out. The thing is that I am using a template excel doc that sits in a folder on a shared drive. From this template I create reports everyday. This part works fine, it is just the cut and paste issue, it seems that the way this is working is that it will only take the screen shot from the template document and add it to the template document, not the one that I just created, which is what need.</p>\n\n<p>Anyway, my code:</p>\n\n<pre><code>    run_date = Date\n    Dim s2 As String\n    s2 = Format(run_date, \"MM-dd-yyyy\")\n    Dim FS As Object\n\nDim FullPath As String\nFullPath = \"\\\\path\\Report\\Reports\\Status Reports\\Daily\\DailyReportStatusFor\" + s2 + \".xlsm\"\n\n        Set objXL = CreateObject(\"Excel.Application\")\n        objXL.DisplayAlerts = False\n        objXL.Application.Workbooks.Open FullPath\n        Set objActiveWkbk = objXL.Application.ActiveWorkbook\n\n' Where you will enter Sharepoint location path\n    objXL.Application.Workbooks.Open FullPath\n\n\n\n            objXL.ActiveWorkbook.SaveAs Filename:= _\n                \"https://Sharepoint/lists/shared documents/DailyReportStatusFor\" + s2 + \".xlsm\", FileFormat:=1, CreateBackup:=False\n\n\n   Range(\"'owssvr'!A1:O18\").CopyPicture\n   Sheets(\"Image\").Select\n   Range(\"A1\").Select\n   ActiveSheet.Paste\n\nDim objOLApp As Object    'Outlook.Application\nDim outItem As Object    'Outlook.MailItem\nDim outFolder As Object    'MAPIFolder\nDim DestFolder As Object    'MAPIFolder\nDim outNameSpace As Object    'NameSpace\nDim lngAttachment As Long\nSendFrom = \"me@me.com\"\nSendTo = \"me@me.com\" \nccTo = \"me@me.com\"\nEmailSubject = \"Dashboard - Daily Review Status for \" + s2\nEmailBody = \"Attached is the  Dashboard - Daily Review Status for \" + s2\n'Set application settings\nWith Application\n.ScreenUpdating = False\n.EnableEvents = False\nEnd With\n\nSheets(\"Image\").Select\nRange(\"A1\").Select\nSet Sendrng = Selection\nWith Sendrng\n\nActiveWorkbook.EnvelopeVisible = False\nWith .Parent.MailEnvelope\nWith .Item\n\n.Subject = EmailSubject \n.To = SendTo \n.CC = ccTo \n.SentOnBehalfOfName = SendFrom     \n.Attachments.Add (\"\\\\Path to report\\Report\\Reports\\Status Reports\\Daily\\DailyReportStatusFor\" + s2 + \".xlsm\")\n.Body = \"Attached is the Dashboard - Daily Review Status for \" + s2\n.Send\nEnd With\nEnd With\n'Outlook_SendEmail = True\nEnd With\n     objXL.ActiveWorkbook.Close SaveChanges:=False\n\n\n   ' objXL.Application.COMAddIns(\"AmericanExpress.ExcelMetadataAddin\").Connect = True\n    objXL.DisplayAlerts = True\n    Set objActiveWkbk = Nothing\n    objXL.Application.Quit\n    Set objXL = Nothing\n    Set objNet = Nothing\n    Set FS = Nothing\n    Set App = Nothing\n    Set Itm = Nothing\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466615554, "post_id": 37974220, "comment_id": 63395017, "body": "Take out the <code>On Error</code>, what error does it throw? Any? Or does it run, just not accurately?"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "edited": false, "score": 1, "creation_date": 1466616375, "post_id": 37974458, "comment_id": 63395477, "body": "Works great. I totally forgot to use With."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "edited": false, "score": 0, "creation_date": 1466616408, "post_id": 37974458, "comment_id": 63395496, "body": "@CeFu - no worries! Glad it was a simple fix"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1466616388, "last_edit_date": 1466616388, "creation_date": 1466615634, "answer_id": 37974458, "question_id": 37974220, "link": "https://stackoverflow.com/questions/37974220/not-correctly-summing-column-between-all-sheets-in-workbook/37974458#37974458", "title": "Not correctly summing column between all sheets in Workbook", "body": "<p>It could be due to your <code>Range()</code> use in the <code>Sum</code> functions - it doesn't reference a worksheet, so can cause issues.  Try this:</p>\n\n<pre><code>Sub FormatEntry()\nDim TotalCost As Double\nDim TotalTime As Double\n\nFor Each ws In ActiveWorkbook.Worksheets\n    On Error Resume Next     'Will continue if an error results\n    With ws\n        .Range(\"E:E\").NumberFormat = \"_-[$$-40B]* #,##0.00_ ;_-[$$-40B]* -#,##0.00 ;_-[$$-40B]* \"\"-\"\"??_ ;_-@_ \"\n        .Range(\"A1\").End(xlDown).Offset(1).Font.Bold = True\n        .Range(\"A1\").End(xlDown).Offset(1).Value = \"Total Duration:\"\n        .Range(\"D1\").End(xlDown).Offset(1).Font.Bold = True\n        .Range(\"D1\").End(xlDown).Offset(1).Value = \"Total Cost:\"\n        .Range(\"E2\").End(xlDown).Offset(1, 0).Value = _\n        WorksheetFunction.Sum(.Range(\"E2:E\" &amp; .Cells.SpecialCells(xlLastCell).Row))\n        .Range(\"B2\").End(xlDown).Offset(1, 0).Value = _\n        Format(WorksheetFunction.Sum(.Range(\"B2:B\" &amp; .Cells.SpecialCells(xlLastCell).Row)), \"hh:mm:ss\")\n    End With\nNext ws\nEnd Sub\n</code></pre>\n\n<p>The main idea is that <strong>any time</strong> you have <code>Range()</code>, <code>Cells()</code>, <code>Columns()</code>, <code>Rows()</code>, etc. you want to explicitly state the worksheet that you expect the Range/Cells/Columns to be on.  Otherwise, as you've discovered, VBA can return some unexpected results.</p>\n"}], "owner": {"reputation": 149, "user_id": 3470588, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16094897c96f1af7eeb4357da74dd862?s=128&d=identicon&r=PG&f=1", "display_name": "CeFu", "link": "https://stackoverflow.com/users/3470588/cefu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 37974458, "answer_count": 1, "score": 0, "last_activity_date": 1466619142, "creation_date": 1466614713, "last_edit_date": 1466619142, "question_id": 37974220, "link": "https://stackoverflow.com/questions/37974220/not-correctly-summing-column-between-all-sheets-in-workbook", "title": "Not correctly summing column between all sheets in Workbook", "body": "<p><strong>Backstory:</strong> I'm pulling off phone records off a PBX server. I'm adjusting &amp; calculating long distance calls. I have already filtered out local &amp; toll free numbers. I split the workbook into sheets by tenant's name. My macro below is formatting &amp; calculating all sums for duration &amp; total cost of that call.</p>\n\n<p><strong>The issue:</strong> My macro is not selecting all the phone calls rows correctly (I beleive). It is able to correctly calculate the first sheet (I select all phone call rows), but when it moves to the others, it is unable to correctly sum them all.</p>\n\n<p><strong>Exact Error sheet:</strong> </p>\n\n<pre><code>Start Time  Duration    Calling Name    Dialed Number    Cost \n6/1/2016 15:07  0:30:55 BLANK_I380            NUMBER     $3.72 \n6/3/2016 12:26  0:05:40 BLANK_I380            NUMBER     $0.72 \n6/6/2016 13:49  0:00:08 BLANK_I380            NUMBER     $0.12 \n6/6/2016 13:50  0:00:08 BLANK_I380            NUMBER     $0.12 \n6/6/2016 13:51  0:01:15 BLANK_I380            NUMBER     $0.12 \n6/16/2016 8:29  0:01:42 BLANK_I380            NUMBER     $0.24 \nTotal Duration: 0:02:50                       Total Cost:    $0.72 \n</code></pre>\n\n<p><strong>First Correct sheet</strong></p>\n\n<pre><code>Start Time  Duration    Calling Name    Dialed Number    Cost \n6/1/2016 9:20   0:00:09 BLANK Shining_I113  1313600000   $0.12 \n6/1/2016 9:25   0:00:22 BLANK Shining_I113  1248600000   $0.12 \n6/1/2016 9:26   0:00:54 BLANK Shining_I113  1248600000   $0.12 \nTotal Duration: 0:01:25                                 Total Cost:  $0.36 \n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Sub FormatEntry()\nDim TotalCost As Double\nDim TotalTime As Double\n\nFor Each ws In ActiveWorkbook.Worksheets\n             On Error Resume Next 'Will continue if an error results\n    ws.Range(\"E:E\").NumberFormat = \"_-[$$-40B]* #,##0.00_ ;_-[$$-40B]* -#,##0.00 ;_-[$$-40B]* \"\"-\"\"??_ ;_-@_ \"\n    ws.Range(\"A1\").End(xlDown).Offset(1).Font.Bold = True\n    ws.Range(\"A1\").End(xlDown).Offset(1).Value = \"Total Duration:\"\n    ws.Range(\"D1\").End(xlDown).Offset(1).Font.Bold = True\n    ws.Range(\"D1\").End(xlDown).Offset(1).Value = \"Total Cost:\"\n     ws.Range(\"E2\").End(xlDown).Offset(1, 0).Value = _\n     WorksheetFunction.Sum(Range(\"E2:E\" &amp; Cells.SpecialCells(xlLastCell).Row))\n     ws.Range(\"B2\").End(xlDown).Offset(1, 0).Value = _\n     Format(WorksheetFunction.Sum(Range(\"B2:B\" &amp; Cells.SpecialCells(xlLastCell).Row)), \"hh:mm:ss\")\nNext ws\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["excel", "excel-formula", "spreadsheet", "vba"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1466614672, "post_id": 37974098, "comment_id": 63394495, "body": "Is <code>=SUBTOTAL(3,H:H)</code> not an option?"}, {"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "reply_to_user": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1466616160, "post_id": 37974098, "comment_id": 63395352, "body": "That was the first option I tried but it turns the total to &quot;0&quot;. The sum formula sits in a H cell as well (H:35)"}], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 3997177, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8d3cd0795367113b8d0f4b51b87e772e?s=128&d=identicon&r=PG&f=1", "display_name": "Bryan Davies", "link": "https://stackoverflow.com/users/3997177/bryan-davies"}, "is_accepted": false, "score": 1, "last_activity_date": 1466616171, "last_edit_date": 1495542162, "creation_date": 1466616171, "answer_id": 37974599, "question_id": 37974098, "link": "https://stackoverflow.com/questions/37974098/excel-adding-a-row-outside-of-forumla-range/37974599#37974599", "title": "Excel - Adding a row outside of forumla range", "body": "<p>you could use a named range like =sum(range1) and something like;</p>\n\n<p><a href=\"https://stackoverflow.com/questions/14957994/select-first-empty-cell-in-column-f-starting-from-row-1-without-using-offset\">Select first empty cell in column F starting from row 1. (without using offset )</a></p>\n\n<p>to find the first empty cell to change the reference for the named range.</p>\n\n<p>Triggering it would be difficult... potentially could use on_save?</p>\n\n<p>or option 2.... bit of a dodge, but can work....</p>\n\n<p>you say your sum is in cell H35... maybe move it to h36, and create a dummy hidden row in 35 (0.1 row height). that way when you add a row, it is always above 35. Use sum H1:H35 and it will always auto update? its not a neat solution, but should work</p>\n"}, {"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466617134, "post_id": 37974793, "comment_id": 63395930, "body": "As an OT: Integer is deprecated, you may google Integer vs Long to see why, just change Integer to Long"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466617233, "post_id": 37974793, "comment_id": 63395982, "body": "I would change it to a Double instead, as both Integer and Long will remove the decimal, if there are any."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1466617247, "last_edit_date": 1466617247, "creation_date": 1466616952, "answer_id": 37974793, "question_id": 37974098, "link": "https://stackoverflow.com/questions/37974098/excel-adding-a-row-outside-of-forumla-range/37974793#37974793", "title": "Excel - Adding a row outside of forumla range", "body": "<p>Use the following code, you need to adjust column \"H\" to whatever column you need.</p>\n\n<pre><code>Dim sumtest    As Variant\n\nsumstest = Application.WorksheetFunction.Subtotal(9, Range(\"H2:H\" &amp; ActiveSheet.Cells(ActiveSheet.Rows.Count, \"H\").End(xlUp).Row))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "edited": false, "score": 0, "creation_date": 1466619069, "post_id": 37975104, "comment_id": 63397041, "body": "Golden. This solved my problem.Ty! Good to see there is a resolution outside of macros."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1466618036, "creation_date": 1466618036, "answer_id": 37975104, "question_id": 37974098, "link": "https://stackoverflow.com/questions/37974098/excel-adding-a-row-outside-of-forumla-range/37975104#37975104", "title": "Excel - Adding a row outside of forumla range", "body": "<p>With your formula being the extent of the range minus one row we can use this:</p>\n\n<pre><code>=SUBTOTAL(3,H2:INDEX(H:H,ROW()-1))\n</code></pre>\n\n<p>Now as rows are added or deleted the reference will remain intact.</p>\n\n<p>If there is a chance that row 2 would be deleted you will get #Ref errors.  To avoid that you can use this formula:</p>\n\n<pre><code>=SUBTOTAL(3,INDEX(H:H,2):INDEX(H:H,ROW()-1))\n</code></pre>\n\n<p>Now there are no specific cell references and adding or deleting will not effect the formula and the range will be dynamic.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pBj4i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pBj4i.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/jE9Mj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jE9Mj.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1093, "user_id": 1536344, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/eed718cc4ea62ca4ac52fa3b70de6e67?s=128&d=identicon&r=PG&f=1", "display_name": "LOZ", "link": "https://stackoverflow.com/users/1536344/loz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 37975104, "answer_count": 3, "score": 0, "last_activity_date": 1466618036, "creation_date": 1466614298, "last_edit_date": 1531161705, "question_id": 37974098, "link": "https://stackoverflow.com/questions/37974098/excel-adding-a-row-outside-of-forumla-range", "title": "Excel - Adding a row outside of forumla range", "body": "<p>Currently I have a couple of SUM functions setup in my worksheet. </p>\n\n<p>Lets use H2:H34 for my example: If I add a row within that range, the sum function will automatically adjust. The problem is when I add new rows, it is below the range (below H:33). In this case, I would just have to highlight the column and expand/drag the range to where it needs to be. There are a total of 8 columns that are doing a sum function. Is this only possible by using a macro?</p>\n\n<pre><code>=SUBTOTAL(3,H2:H34)\n</code></pre>\n"}, {"tags": ["excel", "reddit", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1466618519, "post_id": 37973473, "comment_id": 63396735, "body": "It&#39;s possible to do, and you are headed in the right direction. Is there a specific problem with this code that you are struggling with. Does that <code>htm.getElementById(&quot;comments&quot;)</code> work? Is there an element with that ID in that page&#39;s html?"}, {"owner": {"reputation": 27, "user_id": 6300374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fddd1a800208114cc018048d30eb55d?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6300374/bob"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1466618694, "post_id": 37973473, "comment_id": 63396829, "body": "I actually wasn&#39;t too sure what element ID I would be able to use to pull just the comments, so I used it as a placeholder."}, {"owner": {"reputation": 27, "user_id": 6300374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fddd1a800208114cc018048d30eb55d?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6300374/bob"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1466618824, "post_id": 37973473, "comment_id": 63396889, "body": "@JNevill As for the problem with this code, it is just the fact that I&#39;ve gotten stuck and don&#39;t know where the problem is. Whenever I try running it, it returns nothing. I&#39;ve tried tweaking it for a while now and nothing seems to work."}, {"owner": {"reputation": 11462, "user_id": 120999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/PrVf3.png?s=128&g=1", "display_name": "Xiong Chiamiov", "link": "https://stackoverflow.com/users/120999/xiong-chiamiov"}, "edited": false, "score": 0, "creation_date": 1466787955, "post_id": 37973473, "comment_id": 63479135, "body": "As an aside, it may be worth taking this opportunity as an exercise to learn Python, as <a href=\"https://praw.readthedocs.io/en/stable/\" rel=\"nofollow noreferrer\">PRAW</a> is excellent, there are several good Excel-writing Python libraries, and the entire process will be much simpler than trying to do this directly in Excel."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6300374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fddd1a800208114cc018048d30eb55d?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6300374/bob"}, "edited": false, "score": 0, "creation_date": 1466619797, "post_id": 37975464, "comment_id": 63397485, "body": "Awesome, thanks for the explanation as well. Is there a way I can now move the data from the Immediate Window into the spreadsheet cells?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 27, "user_id": 6300374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fddd1a800208114cc018048d30eb55d?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6300374/bob"}, "edited": false, "score": 0, "creation_date": 1466620545, "post_id": 37975464, "comment_id": 63397898, "body": "No problem. I&#39;ve added how to get the username (you&#39;ll see how to navigate through the nodes/elements in the structure with that) and then how to print out to the sheet instead of the debug window. Just keep poking around the nodes until you find what you want. Scraping is more of an art than a science."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 1, "last_activity_date": 1466620476, "last_edit_date": 1466620476, "creation_date": 1466619282, "answer_id": 37975464, "question_id": 37973473, "link": "https://stackoverflow.com/questions/37973473/excel-macro-to-draw-thread-comments-from-website-into-cells/37975464#37975464", "title": "Excel Macro to draw thread comments from website into cells", "body": "<p>You'll really need to analyze the contents of the web page you are scraping with a decent HTML editor. I would suggest navigating to the page in question in chrome and using F12 to open it's developer tool. In the \"Elements\" tab you can quickly see which HTML is producing which part of the page (open both the page and the developer tools next to each other).</p>\n\n<p>You'll notice as you head into the comments that the text of each comment is inside a <code>&lt;p&gt;</code> tag and each <code>&lt;p&gt;</code> tag is inside a <code>&lt;div&gt;</code>. We are looking for patterns, so this is a good start.</p>\n\n<p>You'll also notice that each one of those <code>&lt;div&gt;</code> tags has a <code>class</code> of <code>md</code>. \nSo... Lets load all of the pages <code>&lt;div&gt;</code> tags into an object and then look for the ones that have a <code>className</code> that contains <code>\"md\"</code>:</p>\n\n<p>Sub getRedditData()</p>\n\n<pre><code>Dim x As Long, y As Long\nDim htm As Object\n\nSet htm = CreateObject(\"htmlFile\")\n\nWith CreateObject(\"msxml2.xmlhttp\")\n    .Open \"GET\", \"https://www.reddit.com/r/AskReddit/comments/4p7qsx/what_are_the_most_common_modern_day_scams/\", False\n    .send\n    htm.body.innerhtml = .responsetext\nEnd With\n\nSet Divelements = htm.getElementsByTagName(\"div\")\n\nFor Each DivElement In Divelements\n    If InStr(1, DivElement.ClassName, \"md\") Then\n        'print contents to the Immediate window for debugging View&gt;&gt;Immediate Window to insure it's up in your VBE\n        Debug.Print DivElement.InnerText\n    End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n\n<p>With that you'll see all of the comments stuck in the Immediate window (go to View>>Immediate Window) so you can see this debug output.</p>\n\n<hr>\n\n<p>After skipping around the nodes it looks like you can navigate up a couple of elements and back down the tree to get the username:</p>\n\n<pre><code>Sub getRedditData()\n\n    Dim x As Long, y As Long\n    Dim htm As Object\n\n    Set htm = CreateObject(\"htmlFile\")\n\n    With CreateObject(\"msxml2.xmlhttp\")\n        .Open \"GET\", \"https://www.reddit.com/r/AskReddit/comments/4p7qsx/what_are_the_most_common_modern_day_scams/\", False\n        .send\n        htm.body.innerhtml = .responsetext\n    End With\n\n    Set Divelements = htm.getElementsByTagName(\"div\")\n\n\n    On Error Resume Next\n\n    For Each divElement In Divelements\n        If InStr(1, divElement.className, \"md\") And Not InStr(1, divElement.className, \"md-container\") Then\n            Set commentEntry = divElement.ParentNode.ParentNode.ParentNode\n\n            'Print the name and the comment\n            Debug.Print commentEntry.FirstChild.FirstChild.NextSibling.InnerText &amp; \":\", divElement.InnerText\n\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>To print this out to the sheet just point to a cell instead of the <code>debug.print</code> immediate window. Something like:</p>\n\n<pre><code>Sub getRedditData()\n\n    Dim x As Long, y As Long\n    Dim htm As Object\n    Dim ws As Worksheet, wsCell As Integer\n\n    'set the worksheet to print to and the first row to start printing.\n    Set ws = Sheets(\"Sheet1\")\n    wsCell = 1\n\n    Set htm = CreateObject(\"htmlFile\")\n\n    With CreateObject(\"msxml2.xmlhttp\")\n        .Open \"GET\", \"https://www.reddit.com/r/AskReddit/comments/4p7qsx/what_are_the_most_common_modern_day_scams/\", False\n        .send\n        htm.body.innerhtml = .responsetext\n    End With\n\n    Set Divelements = htm.getElementsByTagName(\"div\")\n\n\n    On Error Resume Next\n\n    For Each divElement In Divelements\n        If InStr(1, divElement.className, \"md\") And Not InStr(1, divElement.className, \"md-container\") Then\n            Set commentEntry = divElement.ParentNode.ParentNode.ParentNode\n\n            'Print the name and the comment to ws sheet columns 1 and 2\n            ws.Cells(wsCell, 1).Value = commentEntry.FirstChild.FirstChild.NextSibling.InnerText\n            ws.Cells(wsCell, 2).Value = divElement.InnerText\n\n            'iterate to the next row\n            wsCell = wsCell + 1\n\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6300374, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2fddd1a800208114cc018048d30eb55d?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/6300374/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 37975464, "answer_count": 1, "score": 0, "last_activity_date": 1466620476, "creation_date": 1466612386, "last_edit_date": 1531161705, "question_id": 37973473, "link": "https://stackoverflow.com/questions/37973473/excel-macro-to-draw-thread-comments-from-website-into-cells", "title": "Excel Macro to draw thread comments from website into cells", "body": "<p>I am trying to store Reddit thread comments in an excel spreadsheet, however I have had trouble trying to figure out how to do this. I do not have much experience with using macros to get data from webpages, so I have been finding it hard to figure out how exactly to draw out each comment from a specified Reddit thread and place it in a cell, and whether or not it is possible to do.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Sub getRedditData()\n\nDim x As Long, y As Long\nDim htm As Object\n\nSet htm = CreateObject(\"htmlFile\")\n\nWith CreateObject(\"msxml2.xmlhttp\")\n    .Open \"GET\", \"https://www.reddit.com/r/AskReddit/comments/4p7qsx/what_are_the_most_common_modern_day_scams/\", False\n    .send\n    htm.body.innerhtml = .responsetext\nEnd With\n\nWith htm.getelementbyid(\"comments\")\n    Set cellrangex = .Rows(x).Cells.Length - 1\n    Set cellrangey = .Rows(x).Cells.Length - 1\n    Set cellrange1 = Sheets(1).Cells(x + 1, y + 1).Value\n    Set cellrange2 = .Rows(x).Cells(y).innertext\n\n    For x = 0 To cellrangex\n        For y = 0 To cellrangey\n            cellrange = cellrange2\n        Next y\n    Next x\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 7165, "user_id": 2250183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07f863401bc800df07245b6dfd1a66ab?s=128&d=identicon&r=PG", "display_name": "AndASM", "link": "https://stackoverflow.com/users/2250183/andasm"}, "is_accepted": false, "score": 1, "last_activity_date": 1466614943, "creation_date": 1466614943, "answer_id": 37974284, "question_id": 37973323, "link": "https://stackoverflow.com/questions/37973323/return-to-original-pivot-table-view-via-vba/37974284#37974284", "title": "Return to Original Pivot Table View via VBA", "body": "<p>Yes, but it wont be super easy.</p>\n\n<p>I just used the macro recorder while building a simple pivot table from made up data. I got this:</p>\n\n<pre><code>Sub Macro1()\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"A\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"B\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable1\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable1\").PivotFields(\"C\"), \"Sum of C\", xlSum\nEnd Sub\n</code></pre>\n\n<p>From the recorded macro we can see that the Pivot table object has properties like PivotFields and DataFields. You'd have to loop through all the relevant items in the various properties in the PivotTable object, then store that data somewhere. Either by serializing it out to a hidden worksheet or by storing it in a global VBA variable.</p>\n\n<p>Documentation on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835831.aspx\" rel=\"nofollow\" title=\"PivotTable Object Members\">Pivot Table Object is available here</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6500188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10534f85affff136319d0e696064876d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy H", "link": "https://stackoverflow.com/users/6500188/jeremy-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466614943, "creation_date": 1466611984, "question_id": 37973323, "link": "https://stackoverflow.com/questions/37973323/return-to-original-pivot-table-view-via-vba", "title": "Return to Original Pivot Table View via VBA", "body": "<p>I understand that this is very complicated b/c pivot tables can be incredibly different depending on use case, but I was hoping to find a way that would allow me to essentially memorialize the current view of the Pivot Table, and then go back to it after I drill around. At the highest level, click a button that resets the pivot back to its original state when I opened the file.</p>\n\n<p>I know there are probably several ways to approach this (including just copying to a new sheet), but I was hoping for a universal way to do it that didn't require the addition of a new sheet.</p>\n\n<p>Thanks!\nJeremy</p>\n"}, {"tags": ["vba", "excel", "import", "connection"], "answers": [{"comments": [{"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 1, "user_id": 6450733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d599ed54e8f496d1b161ecfc5dae5f46?s=128&d=identicon&r=PG&f=1", "display_name": "AEPImiranda", "link": "https://stackoverflow.com/users/6450733/aepimiranda"}, "edited": false, "score": 0, "creation_date": 1466617064, "post_id": 37973503, "comment_id": 63395892, "body": "The simpler the better right? However, don&#39;t forget to upvote and/or check the green mark for the best answer you received -I see quite a few useful ones now :) -"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1466612463, "creation_date": 1466612463, "answer_id": 37973503, "question_id": 37973080, "link": "https://stackoverflow.com/questions/37973080/finding-imported-data-in-a-cell-to-stop-importing-it-vba/37973503#37973503", "title": "Finding imported data in a cell to stop importing it VBA", "body": "<p>Perhaps you may find the connections name?</p>\n\n<pre><code>Sub test()\nDim ItemConnection As Variant\nDim TotalConnections As Connections: Set TotalConnections = ThisWorkbook.Connections\n    For Each ItemConnection In TotalConnections\n    MsgBox ItemConnection.Name\n    Next ItemConnection\n\nEnd Sub\n</code></pre>\n\n<p>PS: Variant is because I didn't find a way to declare connection as a single item of connection</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6450733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d599ed54e8f496d1b161ecfc5dae5f46?s=128&d=identicon&r=PG&f=1", "display_name": "AEPImiranda", "link": "https://stackoverflow.com/users/6450733/aepimiranda"}, "edited": false, "score": 0, "creation_date": 1466622892, "post_id": 37974328, "comment_id": 63399133, "body": "This seems what i was looking for, but im new at this so i dont understand the &quot;cn.Ranges(1)&quot;, does it took the value of the cell(1,1) of the connection &quot;table&quot;?, assuming the connection made is a table imported on the sheet"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 1, "user_id": 6450733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d599ed54e8f496d1b161ecfc5dae5f46?s=128&d=identicon&r=PG&f=1", "display_name": "AEPImiranda", "link": "https://stackoverflow.com/users/6450733/aepimiranda"}, "edited": false, "score": 0, "creation_date": 1466624302, "post_id": 37974328, "comment_id": 63399839, "body": "@AEPImiranda <code>cn.Ranges(1)</code> produces the area of cells currently covered by the connection. You can check this by using a <code>debug.print</code> on <code>cn.Ranges(1).Address</code>. It will show the range area for a table, or pivot table for example."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 0, "last_activity_date": 1466616036, "last_edit_date": 1466616036, "creation_date": 1466615062, "answer_id": 37974328, "question_id": 37973080, "link": "https://stackoverflow.com/questions/37973080/finding-imported-data-in-a-cell-to-stop-importing-it-vba/37974328#37974328", "title": "Finding imported data in a cell to stop importing it VBA", "body": "<p>I just built and tested this nifty little procedure that checks if a connection exists for a specific worksheet range and if so, refreshes it. I also left a spot to  add the part where it creates a new one if it's not found.</p>\n\n<p><em>Warning - as written, this will potentially fail if there is another connection listed on the worksheet outside the desired range and it checks that connection first while there is also an existing connection within the desired range. You'll need to adjust for that.</em></p>\n\n<pre><code>Sub RefreshMakeConnection()\n\nDim cnT As Connections\nSet cnT = ThisWorkbook.Connections\n\nDim sWS As String\nsWS = \"Hoja1\"\n\nDim cn As WorkbookConnection\n\nFor Each cn In cnT\n\n    If cn.Ranges(1).Parent.Name = sWS Then\n\n        With Worksheets(sWS)\n\n            If Not Intersect(.Range(\"A1\"), cn.Ranges(1)) Is Nothing Then\n                cn.Refresh\n            Else\n                'code to create new connection\n            End If\n\n        End With\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6450733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d599ed54e8f496d1b161ecfc5dae5f46?s=128&d=identicon&r=PG&f=1", "display_name": "AEPImiranda", "link": "https://stackoverflow.com/users/6450733/aepimiranda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 37974328, "answer_count": 2, "score": -1, "last_activity_date": 1466616036, "creation_date": 1466611177, "last_edit_date": 1531164843, "question_id": 37973080, "link": "https://stackoverflow.com/questions/37973080/finding-imported-data-in-a-cell-to-stop-importing-it-vba", "title": "Finding imported data in a cell to stop importing it VBA", "body": "<p>Im making a macro on excel that import data from MySQL (with querytables.add and using OBCD) and every time i run the macro it creates a new connection and its a waste of time and space. Is there a function to know if a cell/sheet has a connection on it so i dont have to import the data again and create a new connection or a code to know when was the last time the connection was refreshed.</p>\n\n<p>i looked up for something but it seems there is nothing like it, so maybe and alternative way to do it will be useful, thanks!</p>\n\n<p>Code:</p>\n\n<pre><code>Worksheets(\"Hoja1\").Activate\n\nDim sqlstring As String\nConst connstring As String = \"ODBC;DSN=blabla;UID=blabla;PWD=blabla\"\n\nif \"***Range(\"A1\") has a connection***\" then\n    ActiveWorkbook.Connections(\"Conexi\u00f3n\").Refresh 'actualize the connection previously made\nElse 'import the table from sql server\n    sqlstring = vbNullString\n    sqlstring = \"SELECT * FROM ExTable WHERE year &gt; '2012'\"\n    With ActiveSheet.QueryTables.Add(Connection:=connstring, Destination:=Range(\"A1\"), Sql:=sqlstring)\n        .RefreshStyle = xlOverwriteCells\n        .Refresh BackgroundQuery:=False\n    End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "find"], "comments": [{"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466611336, "post_id": 37973021, "comment_id": 63392410, "body": "Just thought of this - is there anything similar to regex in other languages so that I could maybe use &quot;RCP\\s1&quot; as a search term? EDIT: just searched it up and found it. I&#39;m still curious about my first question though."}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466611786, "post_id": 37973021, "comment_id": 63392712, "body": "Hmm I can&#39;t really get the regex to work, actually. I tried &quot;RCP\\s+1&quot; and &quot;RCP(\\s+)1&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466611898, "post_id": 37973021, "comment_id": 63392795, "body": "Best you can do with Find would be &quot;RCP*1&quot;"}, {"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1466612059, "post_id": 37973021, "comment_id": 63392897, "body": "Smart @TimWilliams. If  you post that as an answer I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "edited": false, "score": 0, "creation_date": 1466612108, "post_id": 37973267, "comment_id": 63392926, "body": "I like your answer in the comments!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1466614568, "last_edit_date": 1466614568, "creation_date": 1466611789, "answer_id": 37973267, "question_id": 37973021, "link": "https://stackoverflow.com/questions/37973021/looking-for-multiple-terms-sorted-by-priority/37973267#37973267", "title": "Looking for multiple terms (sorted by priority)", "body": "<p><em>EDIT</em> - there is only limited support for wildcards in <code>Find()</code> - you would probably not class it as \"regex-level\" functionality:</p>\n\n<pre><code>* - zero or more characters\n? - single character\n~ - escapes * or ? if you want to find those literal characters\n</code></pre>\n\n<p>Alternatively can put the <code>Find</code> into a separate function:</p>\n\n<pre><code>Sub Tester()\n\n    Dim foundCell, PLCount As Long\n\n    PLCount = 3\n    Set foundCell = FindFirst(Cells, Array(\"RCP 1\", \"RCP- 1\"))\n\n    If Not foundCell Is Nothing Then\n        'no need for any select/activate\n        foundCell.EntireRow.Copy Destination:=Range(\"A\" &amp; (PLCount + 8))\n    End If\n\nEnd Sub\n\n'return the first match to a value in the array \"arrWhat\"\n'   Returns Nothing if no match\nFunction FindFirst(rngWhere, arrWhat) As Range\n    Dim v, f As Range\n    For Each v In arrWhat\n        Set f = rngWhere.Find(what:=v, After:=ActiveCell, LookIn:=xlFormulas, _\n                LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                MatchCase:=False, SearchFormat:=False)\n        If Not f Is Nothing Then Exit For\n    Next v\n    Set FindFirst = f\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 642, "user_id": 4187485, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/52b374d6ab6360b829a6d2c4570f9cfb?s=128&d=identicon&r=PG&f=1", "display_name": "G.T.", "link": "https://stackoverflow.com/users/4187485/g-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 1, "accepted_answer_id": 37973267, "answer_count": 1, "score": 1, "last_activity_date": 1466614568, "creation_date": 1466610986, "last_edit_date": 1531164843, "question_id": 37973021, "link": "https://stackoverflow.com/questions/37973021/looking-for-multiple-terms-sorted-by-priority", "title": "Looking for multiple terms (sorted by priority)", "body": "<p>Would it be possible to use the find method to search for back-up options?</p>\n\n<p>Here's my code right now:</p>\n\n<pre><code> Set foundCell = Cells.Find(What:=\"RCP 1\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n            :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n            False, SearchFormat:=False)\n        If Not foundCell Is Nothing Then\n            foundCell.Activate\n            foundCell.Rows(\"1:1\").EntireRow.Select\n            Selection.Copy\n            Range(\"A\" &amp; (PLcount + 8)).Select\n            ActiveSheet.Paste\n        Else\n            Set foundCell = Cells.Find(What:=\"RCP- 1\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n            :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n            False, SearchFormat:=False)\n                If Not foundCell Is Nothing Then\n                    foundCell.Activate\n                    foundCell.Rows(\"1:1\").EntireRow.Select\n                    Selection.Copy\n                    Range(\"A\" &amp; (PLcount + 8)).Select\n                    ActiveSheet.Paste\n                End If\n        End If\n</code></pre>\n\n<p>I would like to be able to do something like below. Note the text after .Find(What:=)</p>\n\n<pre><code> Set foundCell = Cells.Find(What:=\"RCP 1\" \"RCP- 1\" \"RCP  1\", After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n            :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n            False, SearchFormat:=False)\n        If Not foundCell Is Nothing Then\n            foundCell.Activate\n            foundCell.Rows(\"1:1\").EntireRow.Select\n            Selection.Copy\n            Range(\"A\" &amp; (PLcount + 8)).Select\n            ActiveSheet.Paste\n        End If\n</code></pre>\n\n<p>Where the first term is the first priority, the second term is the second priority, the third term is the third priority, etc.</p>\n"}, {"tags": ["vba", "excel", "for-loop", "range"], "comments": [{"owner": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 0, "creation_date": 1466610347, "post_id": 37972749, "comment_id": 63391732, "body": "Is there any rules you could use for this? i.e. what determines which column has what width? Is it the colour or is there a pattern?"}, {"owner": {"reputation": 55, "user_id": 6461568, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2c78a271e31b8eeb19d6f04a57f9250?s=128&d=identicon&r=PG&f=1", "display_name": "beks123", "link": "https://stackoverflow.com/users/6461568/beks123"}, "reply_to_user": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "edited": false, "score": 0, "creation_date": 1466614835, "post_id": 37972749, "comment_id": 63394613, "body": "sorry the color was just to better highlight what I was trying to do...its the pattern I&#39;m trying to loop not the color"}], "answers": [{"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 1, "last_activity_date": 1466610619, "creation_date": 1466610619, "answer_id": 37972882, "question_id": 37972749, "link": "https://stackoverflow.com/questions/37972749/using-for-loop-to-set-ranges-of-column-widths-in-vba/37972882#37972882", "title": "Using for loop to set ranges of column widths in VBA", "body": "<p>Use <code>Columns(index)</code></p>\n\n<pre><code>Dim i As Long\n\nFor i = 5 To 105 Step 4\n    Columns(i).Columwidth = 0.92\nnext i\n\nFor i = 6 To 106 Step 2\n    Columns(i).Columwidth = 7.29\nnext i\n\nFor i = 7 To 107 Step 4\n    Columns(i).Columwidth = 0.83\nnext i\n</code></pre>\n\n<p>The other way would be to determine the width based on the index</p>\n\n<pre><code>For i = 5 To 100\n    'find you what width this column should have\n    Columns(i).Columnwidth = x\nnext i\n</code></pre>\n\n<p>This is assuming the widths are not defined by the colors but by their position</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466611158, "post_id": 37972892, "comment_id": 63392277, "body": "I like this answer, as it takes the color into consideration. It <i>looks</i> like OP&#39;s columns follow a pattern, but there are no guarantees so I&#39;d go with this one."}, {"owner": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466611752, "post_id": 37972892, "comment_id": 63392682, "body": "@BruceWayne. Presumably the OP doesn&#39;t want to manually do the colouring and then use a macro to do the widths. Oh, the joys of interpreting ambiguous client briefs :)"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466616608, "post_id": 37972892, "comment_id": 63395626, "body": "Exactly. It&#39;s not clear if the spreadsheet truly is colored or if the color was added to illustrate a patter."}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": false, "score": 1, "last_activity_date": 1466616731, "last_edit_date": 1466616731, "creation_date": 1466610633, "answer_id": 37972892, "question_id": 37972749, "link": "https://stackoverflow.com/questions/37972749/using-for-loop-to-set-ranges-of-column-widths-in-vba/37972892#37972892", "title": "Using for loop to set ranges of column widths in VBA", "body": "<p>While I'm not sure what those colors are, it would be easy enough to find out. If the entire column is the same color, you could just loop through the columns and look at row 1. Something like</p>\n\n<pre><code>for i = 1 to 1000 'or whatever your last column is\n    if cells(1, i).interior.color = rgb(255, 0, 0) then 'red, for example\n        cells(1, i).columnwidth = 0.83 'or whatever the column width needs to be here\n    else if cells(1, i).interior.color = rgb(...) then 'next color\n        cells(1, i).columnwidth = ... 'etc.\n    end if\nnext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "edited": false, "score": 1, "creation_date": 1466611119, "post_id": 37973006, "comment_id": 63392239, "body": "This is better than mine if you change <code>[]</code> to <code>()</code> and use <code>i</code>, <code>i+1</code>, <code>i+2</code>, <code>i+3</code> ;)"}], "tags": [], "owner": {"reputation": 688, "user_id": 5726827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f9bea4b67d779a3ecc212123b1d0256?s=128&d=identicon&r=PG&f=1", "display_name": "David Glickman", "link": "https://stackoverflow.com/users/5726827/david-glickman"}, "is_accepted": true, "score": 2, "last_activity_date": 1466611584, "last_edit_date": 1466611584, "creation_date": 1466610948, "answer_id": 37973006, "question_id": 37972749, "link": "https://stackoverflow.com/questions/37972749/using-for-loop-to-set-ranges-of-column-widths-in-vba/37973006#37973006", "title": "Using for loop to set ranges of column widths in VBA", "body": "<p>If you are doing a pattern, black-orange-green-orange you can loop so.</p>\n\n<pre><code>for i = [first column] to [last column] step 4\n     Columns(i).ColumnWidth = 0.92\n     Columns(i+1).ColumnWidth = 7.29\n     Columns(i+2).ColumnWidth = 0.83\n     Columns(i+3).ColumnWidth = 7.29\nnext i\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 6461568, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/a2c78a271e31b8eeb19d6f04a57f9250?s=128&d=identicon&r=PG&f=1", "display_name": "beks123", "link": "https://stackoverflow.com/users/6461568/beks123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1936, "favorite_count": 1, "accepted_answer_id": 37973006, "answer_count": 3, "score": 0, "last_activity_date": 1466616731, "creation_date": 1466610211, "question_id": 37972749, "link": "https://stackoverflow.com/questions/37972749/using-for-loop-to-set-ranges-of-column-widths-in-vba", "title": "Using for loop to set ranges of column widths in VBA", "body": "<p><a href=\"https://i.stack.imgur.com/DanTH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DanTH.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to be able to use some sort of for loop to set column widths in an excel sheet so I don't have to type out each column I want to change the width of. In the case of this picture, I want all black columns to have a width of 0.92, green to be 0.83, and orange to be 7.29, and I want these to continue past what I've shown here for a set range. Below is the general code I used, but like I said, I don't want to have to type out every column to change the width.</p>\n\n<pre><code>sub Set_Column_Width\n\n   Range(\"E:E, I:I, M:M, Q:Q, U:U, Y:Y, AC:AC, AG:AG, AK:AK, AO:AO, AS:AS, AT:AT, AX:AX\").ColumnWidth = 0.92\n  Range(\"G:G,K:K,O:O,S:S\").ColumnWidth = 0.83\n   Range(\"F:F, H:H, J:J, L:L\").ColumnWidth = 7.29\n\nEnd sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1466610227, "post_id": 37972695, "comment_id": 63391651, "body": "should be <code>ActiveCell.FormulaR1C1 = &quot;=Sheet1!R[&quot; &amp; counter &amp; &quot;]C[1]&quot;</code>"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466624021, "post_id": 37972695, "comment_id": 63399714, "body": "Take a look <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">here</a> for tips on avoiding <code>Select</code> in your code."}], "answers": [{"tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": false, "score": 0, "last_activity_date": 1466610214, "creation_date": 1466610214, "answer_id": 37972750, "question_id": 37972695, "link": "https://stackoverflow.com/questions/37972695/how-to-pass-an-integer-variable-into-a-vba-formula/37972750#37972750", "title": "How to pass an integer variable into a vba formula", "body": "<p>The reference to 'counter' needs to be outside the quotations:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=Sheet1!R[\" &amp; counter &amp; \"]C[1]\"\n</code></pre>\n"}], "owner": {"reputation": 1381, "user_id": 5072010, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8f044c7b7dee6227de800f0ade7a82c3?s=128&d=identicon&r=PG&f=1", "display_name": "Runeaway3", "link": "https://stackoverflow.com/users/5072010/runeaway3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1446, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466610214, "creation_date": 1466610058, "question_id": 37972695, "link": "https://stackoverflow.com/questions/37972695/how-to-pass-an-integer-variable-into-a-vba-formula", "title": "How to pass an integer variable into a vba formula", "body": "<p>I am having a bit of trouble with this code that I have written:</p>\n\n<pre><code>Sub lol()\n\nDim counter As Integer\n\ncounter = 1\n\nDo Until Selection.Value = \"\"\n    Dim ws As Worksheet\n    Sheets(\"Row1\").Copy after:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n    Set ws = ActiveSheet\n\n\n\n    Sheets(\"Sheet1\").Select\n    ws.Name = \"Row \" + CStr(ActiveCell.Value)\n    Set newSelection = ActiveCell.Offset(1, 0)\n\n    ws.Select\n    ActiveCell.FormulaR1C1 = \"=Sheet1!R[counter]C[1]\"\n    ws.Range(\"A1\").Select\n    Selection.AutoFill Destination:=ws.Range(\"A1:C1\"), Type:=xlFillDefault\n    ws.Range(\"A1:C1\").Select\n    Sheets(\"Sheet1\").Select\n    newSelection.Select\n\n    counter = counter + 1\n\n    Loop\n\n    ActiveCell.Offset(-1, 0).Select\n\n    MsgBox (\"All sheets updated\")\n\n\nEnd Sub\n</code></pre>\n\n<p>I get an error when running this line:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=Sheet1!R[counter]C[1]\"\n</code></pre>\n\n<p>But I am not sure why. I defined that variable as an integer and so I do not understand why it won't work. If I remove the counter, and instead just write \"=Sheet1!R[1]C[1]\" it works fine, so I know the thing in there has to be an integer. (Problem with that in particular is that it will always be the same row, but I need it to drop one row for each iteration, which is why I created the counter variable, but don't really get why it won't work. Any thoughts? (Is it that I have defined  the variable type incorrectly, or is this just not the right semantically to do what I am trying to do?)</p>\n"}, {"tags": ["excel", "vba", "macros"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466610128, "post_id": 37972594, "comment_id": 63391579, "body": "Best if you try something and then post what you&#39;ve tried here (along with a description of any errors) if you run into trouble."}, {"owner": {"reputation": 11, "user_id": 6500055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa66da13751d3855da017d8af72cfb89?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Manley", "link": "https://stackoverflow.com/users/6500055/chris-manley"}, "edited": false, "score": 0, "creation_date": 1466611519, "post_id": 37972594, "comment_id": 63392539, "body": "I have tried ActiveCell.value = ActiveCell.value + TIME(1,0,0) but all I get is a mismatch error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1466611948, "post_id": 37972594, "comment_id": 63392832, "body": "<code>ActiveCell.value = ActiveCell.value + 1&#47;24</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466612193, "post_id": 37972594, "comment_id": 63392986, "body": "Or <code>ActiveCell.value = ActiveCell.value + TimeSerial(1,0,0)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1466630353, "creation_date": 1466630353, "answer_id": 37978425, "question_id": 37972594, "link": "https://stackoverflow.com/questions/37972594/add-1-hour-to-time-to-entire-column-on-sheet-load/37978425#37978425", "title": "add 1 hour to time to entire column on sheet load", "body": "<p>Why these kinds of questions get voted down I don't know. Everyone has a different ability to be specific about the question they're asking. If you don't know enough about a question to need help on it how are you going to be specific about what you need? Anyhow, here's how to do it:</p>\n\n<p>1) Identify the column number the data is in e.g. column A = 1, B = 2 etc.\n2) Get the last used row of the data, something like this:</p>\n\n<pre><code>lastRow = theWorksheetTheDataIsOn.Cells(theColumnNumber, 1000000).end(xlUp).row\n</code></pre>\n\n<p>This goes from row one million upwards and finds the first row that has data on it. </p>\n\n<p>3) Then you can go from the first row (I'll assumse this is row 2) to the last row you just identified in step 2, like this:</p>\n\n<pre><code>For x = 2 to lastRow\n\n     theWorksheetTheDataIsOn.Cells(x, theColumnNumber) = DateAdd(\"h\", 1, Cells(x, theColumnNumber))\n\nNext x\n</code></pre>\n\n<p>The DateAdd formula is what you're looking for. A good explanation can be found here <a href=\"http://www.techonthenet.com/excel/formulas/dateadd.php\" rel=\"nofollow\">http://www.techonthenet.com/excel/formulas/dateadd.php</a></p>\n"}], "owner": {"reputation": 11, "user_id": 6500055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa66da13751d3855da017d8af72cfb89?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Manley", "link": "https://stackoverflow.com/users/6500055/chris-manley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 330, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1466630353, "creation_date": 1466609790, "question_id": 37972594, "link": "https://stackoverflow.com/questions/37972594/add-1-hour-to-time-to-entire-column-on-sheet-load", "title": "add 1 hour to time to entire column on sheet load", "body": "<p>I have a spreadsheet that has a column with a time in it, I need some vba to run that adds 1 hour to every cell in the time Column. the column does not have a fixed length.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "edited": false, "score": 0, "creation_date": 1466609895, "post_id": 37972614, "comment_id": 63391389, "body": "you may have to mess around with the file format, but i&#39;d suggest recording a macro and looking at the code after you save it"}, {"owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466610028, "post_id": 37972614, "comment_id": 63391495, "body": "I have no idea as to how I would even record that @jellz77"}, {"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "reply_to_user": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466610176, "post_id": 37972614, "comment_id": 63391617, "body": "also, your sheet reference is invalid in your original post.  when referencing a sheet you want to use <code>sheets(&quot;Sheet1&quot;).range(&quot;b25&quot;).value</code>"}, {"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "reply_to_user": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466610203, "post_id": 37972614, "comment_id": 63391634, "body": "<a href=\"http://www.dummies.com/how-to/content/how-to-record-a-macro-to-automate-tasks-in-excel-2.html\" rel=\"nofollow noreferrer\">dummies.com/how-to/content/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466610317, "post_id": 37972614, "comment_id": 63391712, "body": "it brought back an error saying the file did not exist"}, {"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "reply_to_user": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466610713, "post_id": 37972614, "comment_id": 63391969, "body": "your file path is missing a back slash <code>W:\\356487\\Desktop\\ExcelFiles\\ABCtemplate.xlsb</code>"}, {"owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466610887, "post_id": 37972614, "comment_id": 63392084, "body": "Still an error saying the file does not exist...is it because it is not recognizing the last part? Otherwise I have no idea as to how to make it save to that exact file path with that same name ABCtemplate.xlsb"}, {"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "reply_to_user": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466611026, "post_id": 37972614, "comment_id": 63392170, "body": "can you try saving to the <code>c:</code> drive (if you have access...not sure if you&#39;re at work)"}, {"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "reply_to_user": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466611062, "post_id": 37972614, "comment_id": 63392199, "body": "is <code>w:</code> a server path?"}, {"owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466611107, "post_id": 37972614, "comment_id": 63392229, "body": "it is my shared drive"}, {"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "reply_to_user": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466611145, "post_id": 37972614, "comment_id": 63392265, "body": "also change your file format to <code>xlExcel12</code> if xlsb"}, {"owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "reply_to_user": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466621118, "post_id": 37972614, "comment_id": 63398220, "body": "@JHags please mark your answer as solved if you were able to use this (or any other answer) as a resolution. thanks."}], "tags": [], "owner": {"reputation": 135, "user_id": 2612083, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EUhKy.png?s=128&g=1", "display_name": "jellz77", "link": "https://stackoverflow.com/users/2612083/jellz77"}, "is_accepted": false, "score": 0, "last_activity_date": 1466609849, "creation_date": 1466609849, "answer_id": 37972614, "question_id": 37972549, "link": "https://stackoverflow.com/questions/37972549/what-code-do-i-use-to-automatically-save-as-that-references-a-file-path-in-the-s/37972614#37972614", "title": "What code do I use to automatically Save As that references a file path in the sheet the macro is stored?", "body": "<pre><code>ThisWorkbook.SaveAs Filename:=range(\"b25\").value, _ FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "edited": false, "score": 0, "creation_date": 1466610724, "post_id": 37972831, "comment_id": 63391979, "body": "I want to save the file as that name.xlsb in the file path which is in B25, but for some reason it still brings about an error"}], "tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1466610470, "creation_date": 1466610470, "answer_id": 37972831, "question_id": 37972549, "link": "https://stackoverflow.com/questions/37972549/what-code-do-i-use-to-automatically-save-as-that-references-a-file-path-in-the-s/37972831#37972831", "title": "What code do I use to automatically Save As that references a file path in the sheet the macro is stored?", "body": "<p>There was some syntax issues in your line, corrected below: -</p>\n\n<pre><code>ThisWorkbook.SaveAs Filename:=Sheets(\"Sheet1\").Range(\"B25\")\n</code></pre>\n\n<p>Also ensure that the path in B25 points to an existing folder.</p>\n"}], "owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1466610470, "creation_date": 1466609687, "question_id": 37972549, "link": "https://stackoverflow.com/questions/37972549/what-code-do-i-use-to-automatically-save-as-that-references-a-file-path-in-the-s", "title": "What code do I use to automatically Save As that references a file path in the sheet the macro is stored?", "body": "<pre><code>**ThisWorkbook.SaveAs Filename:=Sheets.(Sheet1).Range(\"B25\")**\n</code></pre>\n\n<p>Cell (\"B25\") is equal to W:356487\\Desktop\\ExcelFiles\\ABCtemplate.xlsb</p>\n\n<p>The Save As portion is located at the end of my macro once the code has finished running. </p>\n"}, {"tags": ["ms-access", "combobox", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1466638565, "post_id": 37972506, "comment_id": 63405527, "body": "Hard time trying to figure out what exactly you&#39;re looking to do. is there something that doesn&#39;t work - if so, post the code or post the query SQL for the combobox RowSource"}], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 4261132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48fe986c0e0707d0a1ac2127e723a165?s=128&d=identicon&r=PG&f=1", "display_name": "james.sw.clark", "link": "https://stackoverflow.com/users/4261132/james-sw-clark"}, "edited": false, "score": 0, "creation_date": 1466678849, "post_id": 37973413, "comment_id": 63422618, "body": "Good point about the dates. I was actually trying &quot;[ResearchArea].text&quot;, and missed that dot. ResearchArea is not a text field, but a number - according to the design view of the Staff table."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 3, "last_activity_date": 1466612242, "creation_date": 1466612242, "answer_id": 37973413, "question_id": 37972506, "link": "https://stackoverflow.com/questions/37972506/microsoft-access-2010-combobox-text-extraction-search/37973413#37973413", "title": "Microsoft Access 2010: ComboBox text extraction / search", "body": "<p>You have a dot to remove on this line:</p>\n\n<pre><code>\"Or [ResearchArea]. Like '*\" &amp; [Forms]![StaffTotalQuery]![StaffTotalSearchText] &amp; \"*'\" &amp; _\n</code></pre>\n\n<p>Aside, you cannot search dates - in a meaningful way - as you do.</p>\n"}], "owner": {"reputation": 337, "user_id": 4261132, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/48fe986c0e0707d0a1ac2127e723a165?s=128&d=identicon&r=PG&f=1", "display_name": "james.sw.clark", "link": "https://stackoverflow.com/users/4261132/james-sw-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 37973413, "answer_count": 1, "score": 0, "last_activity_date": 1513002305, "creation_date": 1466609586, "last_edit_date": 1513002305, "question_id": 37972506, "link": "https://stackoverflow.com/questions/37972506/microsoft-access-2010-combobox-text-extraction-search", "title": "Microsoft Access 2010: ComboBox text extraction / search", "body": "<p>I have a text search in my form, which uses the following code to filter my table of staff data:</p>\n\n<pre><code> Private Sub Command71_Click()\n\n DoCmd.ApplyFilter \"\", _\n\n \"[Forename] Like '*\" &amp; [Forms]![StaffTotalQuery]![StaffTotalSearchText] &amp; \"*'\" &amp; _\n\n \"Or [Surname] Like '*\" &amp; [Forms]![StaffTotalQuery]![StaffTotalSearchText] &amp; \"*'\" &amp; _\n\n \"Or [ResearchArea]. Like '*\" &amp; [Forms]![StaffTotalQuery]![StaffTotalSearchText] &amp; \"*'\" &amp; _\n\n \"Or [Skills] Like '*\" &amp; [Forms]![StaffTotalQuery]![StaffTotalSearchText] &amp; \"*'\" &amp; _\n\n \"Or [EndDate] Like '*\" &amp; [Forms]![StaffTotalQuery]![StaffTotalSearchText] &amp; \"*'\"\n\n End Sub\n</code></pre>\n\n<p>The search works for all fields apart from [ResearchArea].\nBoth ResearchArea and Skills are ComboBoxes on my split form.</p>\n\n<p>Both ResearchArea and Skills are fields in my Staff table.</p>\n\n<p>New Skills can be added in the split form, but new ResearchArea's can only be added in the table.</p>\n\n<p>The drop-down box on the Skills ComboBox contains repeated entries( e.g. if my listed skills on five staff are: \"\", \"\", \"\", \"Accounting\", \"Accounting\", then these options will appear in the drop-box), and blanks. I'd like it only to show unique entries, but also for me to be able to create new ones in this split form. </p>\n\n<p>I'd also like to be able to search all staff's ResearchArea's, which I could do if they were text (like \"Forename\").</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 1, "creation_date": 1466610146, "post_id": 37972466, "comment_id": 63391592, "body": "Hi can you show what work you have done so far to achieve this? This is a support site, not development site."}, {"owner": {"reputation": 1, "user_id": 6499985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a756c3819c025979d027bce1363a12?s=128&d=identicon&r=PG&f=1", "display_name": "user6499985", "link": "https://stackoverflow.com/users/6499985/user6499985"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1466622286, "post_id": 37972466, "comment_id": 63398845, "body": "this is what I thought would work for one sheet... once I got this working simple one working properly I figured I could format it for multiple sheets...Sub Test() For Each Cell In Sheets(1).Range(&quot;E:E&quot;)     If Cell.Value = &quot;NO&quot; Then         matchRow = Cell.Row         Rows(matchRow &amp; &quot;:&quot; &amp; matchRow).Select         Selection.Copy          Sheets(&quot;Sheet2&quot;).Select         ActiveSheet.Rows(matchRow).Select         ActiveSheet.Paste         Sheets(&quot;Sheet1&quot;).Select     End If Next End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1466610743, "creation_date": 1466610743, "answer_id": 37972935, "question_id": 37972466, "link": "https://stackoverflow.com/questions/37972466/copy-rows-from-multiple-sheets-into-one-sheet-based-on-a-cell-value/37972935#37972935", "title": "Copy rows from multiple sheets into one sheet based on a cell value", "body": "<p>For the first part, where you want a list of just those facilities with \"No\", you can use this array formula (enter with <kbd>CTRL+SHIFT+ENTER</kbd>):</p>\n\n<p><code>=INDEX(B$2:B$4,SMALL(IF($D$2:$D$4=\"Yes\",ROW(B$2:B$4)-ROW(B$2)+1),ROWS(B$2:B2)))</code></p>\n\n<p>Assuming your data is laid out like this:\n<a href=\"https://i.stack.imgur.com/cBBGf.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cBBGf.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then, wrap <code>IfError([formula],\"\")</code> around that to hide the <code>#NUM</code> errors.  As you change \"No\" in \"Completed\" to \"Yes\", the list on the right will update.</p>\n"}], "owner": {"reputation": 1, "user_id": 6499985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a756c3819c025979d027bce1363a12?s=128&d=identicon&r=PG&f=1", "display_name": "user6499985", "link": "https://stackoverflow.com/users/6499985/user6499985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544646868, "creation_date": 1466609471, "last_edit_date": 1544646868, "question_id": 37972466, "link": "https://stackoverflow.com/questions/37972466/copy-rows-from-multiple-sheets-into-one-sheet-based-on-a-cell-value", "title": "Copy rows from multiple sheets into one sheet based on a cell value", "body": "<p>I want to copy rows from multiple sheets into one combined sheet based on a cell valve.</p>\n\n<p>Details:<br>\nI have multiple project numbers that are tabs (2016-010-082, 2016-010-086, 2016-060-015... etc).  In column E on each of these sheets I have a dropdown box where you can pick \"yes\" or \"no\" based on if this task is completed or not.  I would like where all the tasks that are \"no\", the row will copy over into a single sheet so I can see all the tasks for all the projects that are not yet completed.  </p>\n\n<p>When the \"no\" is changed to a \"yes\" on the specific project tab, I would like the row to be removed from the compiled sheet as well.</p>\n\n<p>I would also like cells D2 and D3 from each show up in rows A and B of the compiled sheet as that is standard information for each tab that I will need to see on the compiled sheet so I know which project number it is and the project name.  </p>\n\n<p>Sample image.\n<a href=\"https://i.stack.imgur.com/jvOVU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jvOVU.jpg\" alt=\"Sample Image\"></a></p>\n\n<p>This is what I thought would work for one sheet.</p>\n\n<pre><code>Sub Test()\n    For Each Cell In Sheets(1).Range(\"E:E\")\n        If Cell.Value = \"NO\" Then\n            matchRow = Cell.Row\n            Rows(matchRow &amp; \":\" &amp; matchRow).Select\n            Selection.Copy\n            Sheets(\"Sheet2\").Select\n            ActiveSheet.Rows(matchRow).Select\n            ActiveSheet.Paste\n            Sheets(\"Sheet1\").Select\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "overflow"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466609444, "post_id": 37972414, "comment_id": 63391062, "body": "What version of excel are you using?"}, {"owner": {"reputation": 5046, "user_id": 1490783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fef598821e961cd446ac3f452a2346?s=128&d=identicon&r=PG", "display_name": "Olle Sj&#246;gren", "link": "https://stackoverflow.com/users/1490783/olle-sj%c3%b6gren"}, "edited": false, "score": 1, "creation_date": 1466609523, "post_id": 37972414, "comment_id": 63391121, "body": "Make sure all variables are Long by explicitly declaring them; <code>Dim R as Long</code> etc"}, {"owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "edited": false, "score": 0, "creation_date": 1466610038, "post_id": 37972414, "comment_id": 63391509, "body": "I&#39;m using excel 2013, i&#39;ll include the whole code to give a clearer picture and exactly where the overflow is occurring!"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "edited": false, "score": 0, "creation_date": 1466610627, "post_id": 37972824, "comment_id": 63391916, "body": "Thank you! just realized that and was coming here to point out that I realized the variables themselves had to be converted to Longs,  Thank you so much!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "edited": false, "score": 1, "creation_date": 1466643549, "post_id": 37972824, "comment_id": 63406743, "body": "Correct. That&#39;s what <i>declaring a variable</i> does: it <i>allocates</i> a chunk of memory to hold that value - specifying a type determines how large that chunk needs to be: <code>Integer</code> is a signed 16-bit integer type; <code>Long</code> is a signed 32-bit integer type. If you&#39;re on 64-bit Office, then you also get a signed 64-bit integer type, <code>LongLong</code>. A variable that says &quot;I need 16 bits of memory (2 bytes)&quot;, or one that says &quot;I need 32 bits of memory (4 bytes)&quot;, reserves that much space in memory up front: it&#39;s less work than allocating a <code>Variant</code> on-the-fly and working out the type dynamically."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1466610438, "creation_date": 1466610438, "answer_id": 37972824, "question_id": 37972414, "link": "https://stackoverflow.com/questions/37972414/cells-overflow-row-value/37972824#37972824", "title": "Cells Overflow Row Value", "body": "<blockquote>\n<pre><code>Dim nr As Integer '# of people to copy\nDim r2s As Integer 'will copy each data set for however many questions there is\nDim R As Integer 'Counts how many people are in the dataset\n</code></pre>\n</blockquote>\n\n<p>Change to:</p>\n\n<pre><code>Dim nr As Long\nDim r2s As Long\nDim R As Long\n</code></pre>\n\n<p>Whenever you deal with worksheet rows, or any value that doesn't fit the maximum value of a 16-bit integer (<code>Integer</code>), you need to declare your variables as <code>Long</code>, because 32,768 overflows an <code>Integer</code>, as you've noticed.</p>\n\n<hr>\n\n<p>That said, I'd warmly recommend you rename these variables to use <strong>meaningful identifiers</strong>, so that you don't need a comment to tell you what they represent.</p>\n\n<pre><code>Dim lastColumn As Long\nDim rowToCopy As Long\nDim nbPeopleToCopy As Long\nDim r2s As Long 'sorry, not clear from comment or usage\nDim nbRows As Long\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5477060, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/10153083819422115/picture?type=large", "display_name": "Asim Ahmed", "link": "https://stackoverflow.com/users/5477060/asim-ahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 37972824, "answer_count": 1, "score": 0, "last_activity_date": 1466610438, "creation_date": 1466609346, "last_edit_date": 1592644375, "question_id": 37972414, "link": "https://stackoverflow.com/questions/37972414/cells-overflow-row-value", "title": "Cells Overflow Row Value", "body": "<pre><code>Sub InsertRow()\nCall BlankColumns\n'Call DeleteZeros\n'normalizes the data extracted from QM QSRs\n'If Columns included in QSR Change, THe column references will have to be adjusted\nDim lastcol As Integer 'Idenfies How many Questions are in Dataset\nDim r2a As Long 'Row to copy\nDim nr As Integer '# of people to copy\nDim r2s As Integer 'will copy each data set for however many questions there is\nDim R As Integer 'Counts how many people are in the dataset\n\nR = Range(&quot;A4&quot;, Range(&quot;A4&quot;).End(xlDown)).Rows.Count\n\n    With ActiveSheet\n        lastcol = .Cells(1, .Columns.Count).End(xlToLeft).Column - 6\n         r2a = (lastcol / 2) - 2\n         r2s = (lastcol / 2)\n             End With\n    \nFor nr = 0 To R\n     Cells(((nr * r2s) + 4), 1).EntireRow.Copy\n    \n         Range(ActiveCell, ActiveCell.Offset((r2a), 0)).EntireRow.Insert Shift:=xlDown\n            Next nr\n\nCall pasteanswers\nCall PasteActivityCode\n\nQuestion = MsgBox(&quot;Upload information to Database?&quot;, vbYesNo + vbQuestion, &quot;Database Upload&quot;)\n\nIf Question = vbYes Then\nCall SaveWorkbook\nCall ExportData\n\nElse\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n<p>The Error is occurring within</p>\n<pre><code>Cells(((nr * r2s) + 4), 1).EntireRow.Copy\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/ohRPS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ohRPS.png\" alt=\"enter image description here\" /></a>\nWith the code above I am having issues when  the cells row value is greater than  32,768, how do I make this allow for Long instead of Integer</p>\n<p>I am not sure how to define this cell to allow it to reference rows greater than an integer. Alternative solutions are also appreciated!</p>\n"}, {"tags": ["vba", "excel", "adodb", "recordset"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1466610745, "post_id": 37972353, "comment_id": 63391997, "body": "Have you tried passing it byVal?"}, {"owner": {"reputation": 165, "user_id": 6499901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089fe0017c8d9a16f386996646ef3ff?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6499901/nick"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1466611152, "post_id": 37972353, "comment_id": 63392272, "body": "Gives me the same thing, runtime error 13: Type Mismatch"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1466612362, "last_edit_date": 1466612362, "creation_date": 1466611343, "answer_id": 37973132, "question_id": 37972353, "link": "https://stackoverflow.com/questions/37972353/passing-recordset-type-error/37973132#37973132", "title": "Passing Recordset Type Error", "body": "<blockquote>\n<pre><code>dataWriter.write (rs)\n</code></pre>\n</blockquote>\n\n<p>Remove the parentheses. These are forcing <code>rs</code> to be <em>evaluated</em> and passed <code>ByVal</code> <strong>regardless</strong> of what the signature for <code>write</code> says: basically you're passing the recordset's default property value (which is its <code>Fields</code> property getter, so an <code>ADODB.Fields</code> object) into a parameter that expects an <code>ADODB.Recordset</code>, hence the <em>Type Mismatch</em> error.</p>\n\n<pre><code>dataWriter.Write rs\n</code></pre>\n\n<p>Will pass the recordset reference... which should really be passed <code>ByVal</code>, since <code>Write</code> doesn't need to reassign that reference at all.</p>\n\n<pre><code>Sub Write(ByVal record As ADODB.Recordset)\n    Range(\"A1\").CopyFromRecordset record\nEnd Sub\n</code></pre>\n\n<p>The takeaway is that parentheses <em>evaluate</em> an expression - try this in the immediate pane:</p>\n\n<pre><code>?TypeName(New ADODB.Recordset)\n Recordset\n\n?TypeName((New ADODB.Recordset))\n Fields\n</code></pre>\n\n<hr>\n\n<p>Note that <code>Range(\"A1\")</code> is implicitly referring to the active worksheet, which is sloppy. You should explicitly take a <code>target</code> parameter there:</p>\n\n<pre><code>Sub Write(ByVal record As ADODB.Recordset, ByVal target As Excel.Worksheet)\n    target.Range(\"A1\").CopyFromRecordset record\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 6499901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a089fe0017c8d9a16f386996646ef3ff?s=128&d=identicon&r=PG&f=1", "display_name": "nick", "link": "https://stackoverflow.com/users/6499901/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 37973132, "answer_count": 1, "score": 1, "last_activity_date": 1466612362, "creation_date": 1466609187, "question_id": 37972353, "link": "https://stackoverflow.com/questions/37972353/passing-recordset-type-error", "title": "Passing Recordset Type Error", "body": "<p>I am getting a type error when trying to pass a Recordset to a method of one of my classes.\nMy code looks like this: </p>\n\n<pre><code>Dim rs As ADODB.recordset\nSet rs = New ADODB.recordset\n'do some connection stuff\n'create command\nrs.Open cmd\ndataWriter.write(rs)\n</code></pre>\n\n<p>And the method looks like this:</p>\n\n<pre><code>sub write(byRef record as ADODB.recordset)\n    range(\"A1\").CopyFromRecordset record\nend sub\n</code></pre>\n\n<p>Everything works except the type error I get when trying to pass the recordset to the <code>write</code> sub (for example If I call <code>range(\"A1\").copyfromrecordset rs</code> in the first block of code it works fine).</p>\n\n<p>Any thoughts? Thanks.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 1, "creation_date": 1466609062, "post_id": 37972255, "comment_id": 63390791, "body": "It is always good to provide some test data."}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1466609527, "post_id": 37972255, "comment_id": 63391124, "body": "Instead of splitting each line it stops after the first one and if there were underlines those would disappear as well"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 2, "creation_date": 1466609563, "post_id": 37972255, "comment_id": 63391157, "body": "Because you are not looping the rows."}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1466614076, "post_id": 37972255, "comment_id": 63394104, "body": "What should I change to get the rows looping?\\"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1466617748, "post_id": 37972255, "comment_id": 63396317, "body": "So you have data in column A and you want to split it and put it in column B, C, etc...?"}], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466619012, "post_id": 37974398, "comment_id": 63397001, "body": "The code works but only splits the first word and move it over one cell. It also removes underlines. How can you fix it?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466620073, "post_id": 37974398, "comment_id": 63397624, "body": "@johndoe253, I&#39;ve added a row for the underline. What do you want to have in the original column ? The whole string ? What do you want to have in the second column ?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466620739, "post_id": 37974398, "comment_id": 63398022, "body": "I would like to keep the original string in the left and create the splits next to the original column"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466621744, "post_id": 37974398, "comment_id": 63398549, "body": "@johndoe253, try the updated code now. You can adjust the parameters you want to retrieve from the original string by modifying the value 2 when calling the <code>Function FindWord(Source As String, Position As Integer)</code>"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466628875, "post_id": 37974398, "comment_id": 63402142, "body": "Thank you for the help! It was much appreciated!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1466621638, "last_edit_date": 1466621638, "creation_date": 1466615379, "answer_id": 37974398, "question_id": 37972255, "link": "https://stackoverflow.com/questions/37972255/arrays-in-excel-change-format-of-string/37974398#37974398", "title": "Arrays in excel change format of string", "body": "<p>The following code will work for an array of size 100, you can modify it to a higher value, or use a dynamic array with <code>REDIM</code>.</p>\n\n<pre><code>Sub find()\n\nDim s As String\nDim Data(100) As Variant\nDim i As Integer\n\nFor i = 1 To Range(\"A1\").End(xlDown).Row\n    Cells(i, 1).Font.Underline = True\n    Cells(i, 2).Value = FindWord(Cells(i, 1), 2) ' change 2 to whatever word position in the original string you want to copy to the right column\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>' And I added this function</p>\n\n<pre><code>Function FindWord(Source As String, Position As Integer)\n\nDim cell_strarr() As String\ncell_strarr = Split(Source, \" \")\nstrWordCount = UBound(cell_strarr)\nIf strWordCount &lt; 1 Or (Position - 1) &gt; strWordCount Or Position &lt; 0 Then\n    FindWord = \"\"\nElse\n    FindWord = cell_strarr(Position - 1)\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466628853, "post_id": 37975917, "comment_id": 63402131, "body": "Thanks for the help! It&#39;s much appreciated!"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 1, "last_activity_date": 1466620796, "creation_date": 1466620796, "answer_id": 37975917, "question_id": 37972255, "link": "https://stackoverflow.com/questions/37972255/arrays-in-excel-change-format-of-string/37975917#37975917", "title": "Arrays in excel change format of string", "body": "<p>This following code will assume you have data in column A. It will put values in column B, C, etc...  </p>\n\n<pre><code>Sub find()\n\n    Dim s As String\n    Dim Data As Variant\n    Dim i As Integer\n\n    NumRows = ActiveSheet.Range(\"A1048576\").End(xlUp).Row\n    s = ActiveCell.Value\n    Data = Split(s, \" \")\n\n    For i = 0 To NumRows\n        Data = Split(Cells(i + 1, 1), \" \")\n        x = 2\n        For j = 0 To UBound(Data)\n            Cells(i + 1, x).Value = Data(j)\n            x = x + 1\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466632265, "post_id": 37978100, "comment_id": 63403667, "body": "Is the outcome of the data considered an array?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466637763, "post_id": 37978100, "comment_id": 63405324, "body": "@johndoe253  What definition of <b>array</b> are you considering?  And why might you think the outcome to not be an array?"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466693748, "post_id": 37978100, "comment_id": 63433910, "body": "well I would like to be able to search through the outcome for certain words and Im not sure what search function to use"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466695800, "post_id": 37978100, "comment_id": 63435528, "body": "@johndoe253 Your response doesn&#39;t really indicate what you mean by <code>array</code> and why you think the results might not be considered an <code>array</code>.  With regard to searching for words, there are a number of different ways to do this, making it quite a broad question. I suggest you formulate a new question, and follow the guidelines laid out in HELP for <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>, and also <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466697175, "post_id": 37978100, "comment_id": 63436516, "body": "A question I had about your code: When I run the code if there are and places where theres an indentation it stops and moves to the next cell. A semicolon separates the beginning of the indentation so I changed it to true but it doesn&#39;t seem to work"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466707810, "post_id": 37978100, "comment_id": 63443213, "body": "@johndoe253 If your data format is dissimilar to what you presented in your original post, then, yes, the code may not function as you desire.  If you want it to run on data formatted differently, you will need to either alter the data, or alter the code.  If you need help doing so, edit your original post to show the types of format you need to process, and how you want it processed.  Please see <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verfiable example</a>"}, {"owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1466709319, "post_id": 37978100, "comment_id": 63444132, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/115442/discussion-between-johndoe253-and-ron-rosenfeld\">continue this discussion in chat</a>."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "edited": false, "score": 0, "creation_date": 1466709829, "post_id": 37978100, "comment_id": 63444414, "body": "@johndoe253  OK, but I don&#39;t see you there"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1466628989, "creation_date": 1466628989, "answer_id": 37978100, "question_id": 37972255, "link": "https://stackoverflow.com/questions/37972255/arrays-in-excel-change-format-of-string/37978100#37978100", "title": "Arrays in excel change format of string", "body": "<p>The following code will not only split the data, but also copy over the formatting, which it seems you also wanted.  Assumes data is in Column A</p>\n\n<pre><code>Option Explicit\nSub SplitWithFormat()\n    Dim R As Range, C As Range\n    Dim i As Long, V As Variant\n\nSet R = Range(\"a1\", Cells(Rows.Count, \"A\").End(xlUp))\nFor Each C In R\n    With C\n        .TextToColumns Destination:=.Offset(0, 1), DataType:=xlDelimited, _\n        consecutivedelimiter:=True, Tab:=False, semicolon:=False, comma:=False, _\n        Space:=True, other:=False\n\n        .Copy\n        Range(.Offset(0, 1), Cells(.Row, Columns.Count).End(xlToLeft)).PasteSpecial xlPasteFormats\n    End With\nNext C\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fIxT4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fIxT4.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 237, "user_id": 6491167, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/238bdafacc3c577f2a56aa726a5b1b87?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe253", "link": "https://stackoverflow.com/users/6491167/johndoe253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 1, "accepted_answer_id": 37978100, "answer_count": 3, "score": 3, "last_activity_date": 1466710140, "creation_date": 1466608915, "last_edit_date": 1592644375, "question_id": 37972255, "link": "https://stackoverflow.com/questions/37972255/arrays-in-excel-change-format-of-string", "title": "Arrays in excel change format of string", "body": "<p><a href=\"https://i.stack.imgur.com/s9Ce9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s9Ce9.png\" alt=\"enter image description here\" /></a></p>\n<p>I have the data in the image I would like to separate. The code in the image doesn't separate once it gets to the semicolon and indentation. I would like to separate the words onto a new sheet so I'm about to search through the array for certain words.</p>\n<p>Thanks for the help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1466609578, "post_id": 37972073, "comment_id": 63391164, "body": "What do you mean &quot;each name has several intervals&quot;?"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466625710, "post_id": 37972073, "comment_id": 63400588, "body": "So you want to loop down through your data and restart your procedure each time you encounter a new name?"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466626794, "post_id": 37972073, "comment_id": 63401133, "body": "As a general comment, your variables are not all declared as you expect them to be. <code>Dim Cancelled, OldStatusbar As Boolean</code> declares <code>Cancelled</code> as a Variant and <code>OldStatusbar</code> As a Boolean. If you want them both to be a Boolean, you need to change it to <code>Dim Cancelled As Boolean, OldStatusbar As Boolean</code>."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1466673662, "post_id": 37972073, "comment_id": 63418964, "body": "@Kyle: I have a list in Column &#39;A&#39; with 2 names (see picture sheet &#39;Data&#39;). Both names have several intervals (Column B=Top and Column C=Base). I want my code to detect that it needs to start with a new loop when the name changes in Column A, which is the same as finding a value of &#39;0&#39; in Column B (maximum top=surface level). My real database is set up the same way, but there are more than 200 &#39;names&#39;. But I want to keep it simple at first, so that I really understand what is happening."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466673788, "post_id": 37972073, "comment_id": 63419054, "body": "@TheEngineer Yes that is exactly what I want to do. My real database has over 200 names. And I want the loop to restart everytime a new name is found in Column A. I managed to do this for 1 name, but when I add a second name the loop just continues without starting a new loop. I want the results to be splitted, preferably in a new excel file."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466674897, "post_id": 37972073, "comment_id": 63419827, "body": "@TheEngineer Do you mean that I need to do this for every &#39;Dim&#39; row? So every time declaring the variable?"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466679388, "post_id": 37972073, "comment_id": 63422951, "body": "Yes, every <code>Dim</code> row needs each variable declared separately. Otherwise they will all be inherently <code>Variant</code>. I&#39;ll work up an answer a little later"}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466682544, "post_id": 37972073, "comment_id": 63425113, "body": "@The Engineer Thank you very much I changed the Dim&#39;s. I will wait for your answer!"}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466695330, "post_id": 37972073, "comment_id": 63435161, "body": "@The Engineer: I managed to incorporate adding a new workbook in my code. The results of the first &#39;name&#39; are put in this new workbook."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466695412, "post_id": 37972073, "comment_id": 63435233, "body": "@The Engineer: Now I&#39;m Looking into getting a Dim variable as file name for my newly created workbook."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466711615, "post_id": 37972073, "comment_id": 63445442, "body": "Great! I suggest updating your code in your question and I&#39;ll take a look at it. It will be until tomorrow before I can get back to this. One other suggestion is to assign your worksheets to variables declared as <code>Worksheet</code> and your workbooks to variables declared as <code>Workbook</code>. That will help when working with multiple workbooks and it will make it easier if you ever need to change a worksheet name in the future."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466768673, "post_id": 37972073, "comment_id": 63467593, "body": "@TheEngineer: I updated my code in the Question. I declared the workbooks and sheets. This meant that I needed to change the name of sheet &quot;samples&quot; in sheet &quot;start&quot;."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "reply_to_user": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466768815, "post_id": 37972073, "comment_id": 63467679, "body": "@TheEngineer: I&#39;m not sure yet if I want to make a new workbook for every new name. However, I do know that at least I want to create a new workbook for the results. I managed to do this as you can see in the new code. The most important thing now is to let the code loop again when a new name is reached. This will also mean that the results need to move at least a few columns with every new name. But I want to keep the same layout for every new name. I guess that I need to move the part in which I define the results into the loop section. But, I think it is better if you take a look at this."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "edited": false, "score": 0, "creation_date": 1466769689, "post_id": 37972073, "comment_id": 63468191, "body": "The layout of the results I want to get is show in the picture of  &#39;Sheet1 in new workbook Well1&#39;. In the mean time I will ofcourse try to start the new loop myself. But it would be great if you could take a look at it :)"}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466772021, "post_id": 37972073, "comment_id": 63469617, "body": "I just added an answer. I didn&#39;t add the loop code to your code because you&#39;ll need to combine your three loops first."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "edited": false, "score": 0, "creation_date": 1466782567, "post_id": 38013656, "comment_id": 63476195, "body": "Thanks for the Answer! I cleaned up my code as you suggested and it still works. I&#39;m now looking into combining my &#39;For Loops&#39;."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "edited": false, "score": 0, "creation_date": 1466783962, "post_id": 38013656, "comment_id": 63477010, "body": "Great! If you have any questions, let me know and I can update my answer. If this answer satisfies your request, please mark it as the correct answer."}, {"owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "edited": false, "score": 0, "creation_date": 1467119888, "post_id": 38013656, "comment_id": 63591263, "body": "Can you help me further? I tried several things, but combining the loops is challenging. Also the curName and NameCount don&#39;t work properly. I updated my loop code below."}, {"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "reply_to_user": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "edited": false, "score": 0, "creation_date": 1467423588, "post_id": 38013656, "comment_id": 63740567, "body": "It will be difficult for me help you combine your loops without knowing what each loop is trying to accomplish. Also, you should not add an answer that is incomplete. If you have updated code, just revise your question to include it. If you find the right answer yourself, you can add that and mark it as correct."}], "tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": true, "score": 0, "last_activity_date": 1466771867, "creation_date": 1466771867, "answer_id": 38013656, "question_id": 37972073, "link": "https://stackoverflow.com/questions/37972073/detecting-new-loop-when-interval-starts-at-0-again/38013656#38013656", "title": "Detecting new loop when interval starts at 0 again", "body": "<p>Here is a cleaned up version of your code:</p>\n\n<pre><code>Option Explicit\n\nSub IntervalToSample()\n\nDim Cancelled As Boolean, OldStatusbar As Boolean\nDim NOI As Integer, TI As Integer, TS As Integer, DOF As Integer\nDim i As Integer, j As Integer, Samples As Integer, SII As Integer\nDim Counter As Long, Bounter As Long, LastRow As Long\nDim Top As Double, Base As Double, Inc As Double, TopI As Double, BaseI As Double\nDim WellN As String, Well_Name As String, Well_Top As String, Well_Base As String\nDim Incremental_Step As String, Total_Intervals As String, Total_Samples As String\nDim wbMain As Workbook, wbWell1 As Workbook\nDim wsStart As Worksheet, wsData As Worksheet, wsSheet1 As Worksheet\n\nOldStatusbar = Application.DisplayStatusBar\n\nSet wbMain = ActiveWorkbook\nSet wsStart = wb.Sheets(\"Start\")\nSet wsData = wb.Sheets(\"Data\")\n\nDOF = 5\nCounter = 0\nBounter = 0\nSII = 0\nWellN = wsData.Cells(DOF + 1, 1)\nTop = wsData.Cells(DOF + 1, 2)\nInc = wsStart.Cells(1, 6)\nLastRow = wsData.Columns(1).End(xlDown).Row\nTI = LastRow - DOF\nBase = wsData.Cells(LastRow, 3)\nTS = Int((Base - Top) / Inc) + 2\n\nWith wsStart\n    Incremental_Step = .Cells(1, 5)\n    Well_Name = .Cells(2, 5)\n    Well_Top = .Cells(3, 5)\n    Well_Base = .Cells(4, 5)\n    Total_Intervals = .Cells(5, 5)\n    Total_Samples = .Cells(6, 5)\nEnd With\n\nSet wbWell1 = Workbooks.Add\nwbWell1.SaveAs \"H:\\.......\\.......\\VBA\\Code Set-up\\VBA-DATABASE\\Well1.xls\"\n\nSet wsSheet1 = wbWell1.Sheets(\"Sheet1\")\nWith wsSheet1\n    .Cells(1, 5) = Well_Name\n    .Cells(2, 5) = Well_Top\n    .Cells(3, 5) = Well_Base\n    .Cells(4, 5) = Total_Intervals\n    .Cells(5, 5) = Incremental_Step\n    .Cells(6, 5) = Total_Samples\n\n    .Cells(1, 6) = WellN\n    .Cells(2, 6) = Top\n    .Cells(3, 6) = Base\n    .Cells(4, 6) = TI\n    .Cells(5, 6) = Inc\n    .Cells(6, 6) = TS\nEnd With\n\nApplication.ScreenUpdating = False\nApplication.StatusBar = True\n\nIf Not Cancelled Then\n    For i = 1 To TI\n        TopI = wsData.Cells(i + DOF, 2)\n        BaseI = wsData.Cells(i + DOF, 3)\n        Samples = CInt((BaseI - TopI) / Inc)\n        wsSheet1.Cells(i, 12) = Samples\n        Application.StatusBar = i\n    Next i\n\n    For i = 1 To TS\n        wsSheet1.Cells(i, 8) = Top + (i - 1) * Inc\n    Next i\n\n    For i = 1 To TI\n        SII = wsSheet1.Cells(i, 12)\n        If i = TI Then SII = SII + 1\n        For j = 1 To SII\n            Counter = Counter + 1\n            wsSheet1.Cells(Counter, 9) = wsData.Cells(i + DOF, 13)\n            Bounter = Bounter + 1\n            wsSheet1.Cells(Bounter, 10) = wsData.Cells(i + DOF, 34)\n        Next j\n    Next i\nEnd If\n\nwbWell1.Close True\n\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = OldStatusbar\n\nEnd Sub\n</code></pre>\n\n<p>Notice that I added <code>Option Explicit</code> at the top. This requires you to declare all of your variables before the code will run. You did a good job of this, but it is always good to include.</p>\n\n<p>Also, I'm not sure what the purpose of <code>If Not Cancelled Then</code> is. You don't use the variable <code>Cancelled</code> anywhere else in your code, so it will always be the same.</p>\n\n<p>You have three different For loops in your code. I suggest combining them into one if you can so you don't need to loop down through thousands of lines of data multiple times. You can then add the following to account for the change in name:</p>\n\n<pre><code>Dim curName As String\nDim NameCount As Long\n\n'Add this just before your For loop\ncurName = wsData.Cells(DOF + 1, 1).Value\nNameCount = 0\n\n'Add this just inside your For loop\nIf wsData.Cells(i + DOF, 1) &lt;&gt; curName Then\n    curName = wsData.Cells(i + DOF, 1).Value\n    NameCount = NameCount + 1\nEnd If\n</code></pre>\n\n<p>You can then use <code>curName</code> and <code>NameCount</code> to change where the data is being stored for the new name.</p>\n"}], "owner": {"reputation": 19, "user_id": 6499854, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac6e4bdbe80fbad9482077c7d2533c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kickk05", "link": "https://stackoverflow.com/users/6499854/kickk05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 38013656, "answer_count": 1, "score": 0, "last_activity_date": 1467119719, "creation_date": 1466608463, "last_edit_date": 1466769497, "question_id": 37972073, "link": "https://stackoverflow.com/questions/37972073/detecting-new-loop-when-interval-starts-at-0-again", "title": "Detecting new loop when interval starts at 0 again", "body": "<p>I need help with a VBA code.</p>\n\n<p>I have a database in which names are listed. Each name has several intervals! Starting at the maximum top with value '0' and ending with a maximum base at a certain depth (2000-4000).</p>\n\n<p>Each interval is classified with a number (1 to 6).\nI want to make a continuous series with a certain incremental step. This means that the intervals are replaced by a continuous series with small incremental steps. And next to the continuous series, the classification is noted. </p>\n\n<p>The results are put in a second worksheet ('Samples' sheet).\nI managed to get the results I want for 1 name. Now I want to get results for more Names, but I don't know how to let the code know that it needs to start a new loop at a new name and do the same all over again (new maximum top of '0').</p>\n\n<p>I would like to have the results of every new name in a new workbook if possible.</p>\n\n<p>This is my code which I have constructed till this point:</p>\n\n<p>[Code]</p>\n\n<pre><code>Sub IntervalToSample()\n\nDim Cancelled As Boolean, OldStatusbar As Boolean\nDim NOI As Integer, TI As Integer, TS As Integer, DOF As Integer\nDim i As Integer, j As Integer, Samples As Integer, SII As Integer\nDim Counter As Long, Bounter As Long\nDim Top As Double, Base As Double, Inc As Double, TopI As Double, BaseI As Double\nDim WellN As String, Well_Name As String, Well_Top As String, Well_Base As String\nDim Incremental_Step As String, Total_Intervals As String, Total_Samples As String\nDim MainWkbk As Workbook, Well1 As Workbook\nDim Start As Worksheet, Data As Worksheet, Sheet1 As Worksheet\n\nOldStatusbar = Application.DisplayStatusBar\n\nSet MainWkbk = ActiveWorkbook\n\nDOF = 5\nCounter = 0\nBounter = 0\nSII = 0\nWellN = Sheets(\"Data\").Cells(DOF + 1, 1)\nTop = Sheets(\"Data\").Cells(DOF + 1, 2)\nInc = Sheets(\"Start\").Cells(1, 6)\nSheets(\"Data\").Select\nRange(\"A1\").End(xlDown).Select\nTI = ActiveCell.Row - DOF\nBase = Sheets(\"Data\").Cells(ActiveCell.Row, 3)\nTS = Int((Base - Top) / Inc) + 2\n\nIncremental_Step = Sheets(\"Start\").Cells(1, 5)\nWell_Name = Sheets(\"Start\").Cells(2, 5)\nWell_Top = Sheets(\"Start\").Cells(3, 5)\nWell_Base = Sheets(\"Start\").Cells(4, 5)\nTotal_Intervals = Sheets(\"Start\").Cells(5, 5)\nTotal_Samples = Sheets(\"Start\").Cells(6, 5)\n\nWorkbooks.Add\nActiveWorkbook.SaveAs \"H:\\.......\\.......\\VBA\\Code Set-up\\VBA-DATABASE\\Well1.xls\"\nSet Well1 = ActiveWorkbook\n\nActiveWorkbook.Sheets(\"Sheet1\").Cells(1, 5) = Well_Name\nActiveWorkbook.Sheets(\"Sheet1\").Cells(2, 5) = Well_Top\nActiveWorkbook.Sheets(\"Sheet1\").Cells(3, 5) = Well_Base\nActiveWorkbook.Sheets(\"Sheet1\").Cells(4, 5) = Total_Intervals\nActiveWorkbook.Sheets(\"Sheet1\").Cells(5, 5) = Incremental_Step\nActiveWorkbook.Sheets(\"Sheet1\").Cells(6, 5) = Total_Samples\n\nActiveWorkbook.Sheets(\"Sheet1\").Cells(1, 6) = WellN\nActiveWorkbook.Sheets(\"Sheet1\").Cells(2, 6) = Top\nActiveWorkbook.Sheets(\"Sheet1\").Cells(3, 6) = Base\nActiveWorkbook.Sheets(\"Sheet1\").Cells(4, 6) = TI\nActiveWorkbook.Sheets(\"Sheet1\").Cells(5, 6) = Inc\nActiveWorkbook.Sheets(\"Sheet1\").Cells(6, 6) = TS\n\nApplication.ScreenUpdating = False\nApplication.StatusBar = True\n\n If Not Cancelled Then\n  MainWkbk.Activate\n  For i = 1 To TI\n    MainWkbk.Activate\n    TopI = Sheets(\"Data\").Cells(i + DOF, 2)\n    BaseI = Sheets(\"Data\").Cells(i + DOF, 3)\n    Samples = CInt((BaseI - TopI) / Inc)\n    Well1.Activate\n    Sheets(\"Sheet1\").Cells(i, 12) = Samples\n    Application.StatusBar = i\n  Next i\n\n  For i = 1 To TS\n   Sheets(\"Sheet1\").Cells(i, 8) = Top + (i - 1) * Inc\n  Next i\n\n  For i = 1 To TI\n    SII = Sheets(\"Sheet1\").Cells(i, 12)\n    If i = TI Then SII = SII + 1\n    For j = 1 To SII\n      Counter = Counter + 1\n      Well1.Sheets(\"Sheet1\").Cells(Counter, 9) = MainWkbk.Sheets(\"Data\").Cells(i + DOF, 13)\n      Bounter = Bounter + 1\n      Well1.Sheets(\"Sheet1\").Cells(Bounter, 10) = MainWkbk.Sheets(\"Data\").Cells(i + DOF, 34)\n     Next j\n  Next i\n\nEnd If                                    \n\nWell1.Activate\nActiveWorkbook.Close True\nMainWkbk.Activate\nRange(\"A1\").Select\nActiveWindow.ScrollRow = Range(\"A1\").Row\n\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = OldStatusbar\n</code></pre>\n\n<p>End Sub</p>\n\n<p><a href=\"http://i.stack.imgur.com/qdLgv.png\" rel=\"nofollow\">Sheet 'Data'</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/RSYC8.png\" rel=\"nofollow\">'Sheet1' in new workbook 'Well1'</a></p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 2073, "user_id": 1058365, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/193101959b3babdccfb0693171ed5915?s=128&d=identicon&r=PG", "display_name": "Whencesoever", "link": "https://stackoverflow.com/users/1058365/whencesoever"}, "edited": false, "score": 0, "creation_date": 1466608800, "post_id": 37972057, "comment_id": 63390608, "body": "<a href=\"http://stackoverflow.com/questions/7847284/subscript-out-of-range-with-redim-vba\" title=\"subscript out of range with redim vba\">stackoverflow.com/questions/7847284/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 6396025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c398eedb69d4b17d75d0875ff3dae59?s=128&d=identicon&r=PG&f=1", "display_name": "Gudbahri", "link": "https://stackoverflow.com/users/6396025/gudbahri"}, "reply_to_user": {"reputation": 2073, "user_id": 1058365, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/193101959b3babdccfb0693171ed5915?s=128&d=identicon&r=PG", "display_name": "Whencesoever", "link": "https://stackoverflow.com/users/1058365/whencesoever"}, "edited": false, "score": 0, "creation_date": 1466614621, "post_id": 37972057, "comment_id": 63394461, "body": "Would that mean you cant use Preserve on multidimensional arrays?"}, {"owner": {"reputation": 2073, "user_id": 1058365, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/193101959b3babdccfb0693171ed5915?s=128&d=identicon&r=PG", "display_name": "Whencesoever", "link": "https://stackoverflow.com/users/1058365/whencesoever"}, "edited": false, "score": 0, "creation_date": 1466614677, "post_id": 37972057, "comment_id": 63394501, "body": "You can, but You can only change one dimension."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6396025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c398eedb69d4b17d75d0875ff3dae59?s=128&d=identicon&r=PG&f=1", "display_name": "Gudbahri", "link": "https://stackoverflow.com/users/6396025/gudbahri"}, "edited": false, "score": 0, "creation_date": 1466698428, "post_id": 37976755, "comment_id": 63437305, "body": "Thanks @Tim , The code above is a portion of a code I am writing. I wanted to differentiate where each cell goes so I can manipulate the cell based on certain criteria. The following actually worked for what I am dealing with."}, {"owner": {"reputation": 1, "user_id": 6396025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c398eedb69d4b17d75d0875ff3dae59?s=128&d=identicon&r=PG&f=1", "display_name": "Gudbahri", "link": "https://stackoverflow.com/users/6396025/gudbahri"}, "edited": false, "score": 0, "creation_date": 1466698798, "post_id": 37976755, "comment_id": 63437529, "body": "For i = 2 To wsTemp.UsedRange.Rows.count           ReDim Preserve outerArrData(2 To i)               arrSpecificWS(1) = wsTemp.Cells(i, 4).Value           arrSpecificWS(2) = wsTemp.Cells(i, 5).Value          arrSpecificWS(3) = wsTemp.Cells(i, 6).Value                      outerArrData(i) = arrSpecificWS          Next i"}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1466623911, "creation_date": 1466623911, "answer_id": 37976755, "question_id": 37972057, "link": "https://stackoverflow.com/questions/37972057/copying-cells-to-an-array-vba/37976755#37976755", "title": "Copying cells to an array VBA", "body": "<p>Is this a shortened version of your code? If not, and you are simply adding a range to an array, why bother looping over the range and assigning values one cell at a time? You can set an array by assigning a range to it like this:</p>\n\n<pre><code>Dim arrRange() As Variant ' declare an unallocated array.\narrRange = Range(\"D2:E\" &amp; wsTemp.UsedRange.Rows.count)\n</code></pre>\n\n<p>This is much quicker and then you don't have to monkey with redimming arrays.</p>\n"}], "owner": {"reputation": 1, "user_id": 6396025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c398eedb69d4b17d75d0875ff3dae59?s=128&d=identicon&r=PG&f=1", "display_name": "Gudbahri", "link": "https://stackoverflow.com/users/6396025/gudbahri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466623911, "creation_date": 1466608416, "question_id": 37972057, "link": "https://stackoverflow.com/questions/37972057/copying-cells-to-an-array-vba", "title": "Copying cells to an array VBA", "body": "<p>I am attempting to increase the array <I>arrSpecificWS</i> as I copy ranges from worksheet wsTemp. I am getting an <i>Subscript out of range </i> error on the <I><b>ReDim Preserve arrSpecificWS(UBound(arrSpecificWS, 1) + 1)</I></b> line. What am I missing ?</p>\n\n<pre><code>Dim I as  long\nDim arrSpecificWS()\n\n 'Prepare data to the array\n  ReDim arrSpecificWS(0, 1 To 6)\n\n\n\nFor i = 2 To wsTemp.UsedRange.Rows.count\n   arrSpecificWS(UBound(arrSpecificWS), 1) = wsTemp.Range(\"D2\" &amp; i).Value\n   arrSpecificWS(UBound(arrSpecificWS), 2) = wsTemp.Range(\"E2\" &amp; i).Value\n   ReDim Preserve arrSpecificWS(UBound(arrSpecificWS, 1) + 1)\n   ReDim Preserve arrSpecificWS(UBound(arrSpecificWS, 2) + 1)\n\nNext i\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1194, "user_id": 4702471, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/t1LzO.jpg?s=128&g=1", "display_name": "Sauced Apples", "link": "https://stackoverflow.com/users/4702471/sauced-apples"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466608366, "post_id": 37971887, "comment_id": 63390317, "body": "Same issue, barcode is shorttext as i needed to keep the begining 000&#39;s which are on the barcodes, sorry I forgot to add that"}, {"owner": {"reputation": 1194, "user_id": 4702471, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/t1LzO.jpg?s=128&g=1", "display_name": "Sauced Apples", "link": "https://stackoverflow.com/users/4702471/sauced-apples"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466608535, "post_id": 37971887, "comment_id": 63390438, "body": "That did not, still a Syntax error"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466608609, "post_id": 37971887, "comment_id": 63390489, "body": "I left out a needed <code>&amp;</code> character.  Should be this: <code>rst.FindFirst &quot;[Barcode] = &#39;&quot; &amp; Me.searchtext &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 1194, "user_id": 4702471, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/t1LzO.jpg?s=128&g=1", "display_name": "Sauced Apples", "link": "https://stackoverflow.com/users/4702471/sauced-apples"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466608728, "post_id": 37971887, "comment_id": 63390552, "body": "That seems to make my form disappear but no syntax error"}, {"owner": {"reputation": 1194, "user_id": 4702471, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/t1LzO.jpg?s=128&g=1", "display_name": "Sauced Apples", "link": "https://stackoverflow.com/users/4702471/sauced-apples"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1466608793, "post_id": 37971887, "comment_id": 63390601, "body": "And thats because the script is telling it to close, yep working great thank you.  pop it as an answer and ill accept"}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1466609133, "last_edit_date": 1466609133, "creation_date": 1466608926, "answer_id": 37972258, "question_id": 37971887, "link": "https://stackoverflow.com/questions/37971887/vba-syntax-error/37972258#37972258", "title": "VBA Syntax Error", "body": "<p>Give <code>FindFirst</code> a string expression ...</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>'rst.FindFirst (Barcode) =  &amp; Me.searchtext\nrst.FindFirst \"[Barcode] = '\" &amp; Me.searchtext &amp; \"'\"\n</code></pre>\n\n<p>However, I'm not sure why the original code triggered a runtime error.  Giving <code>FindFirst</code> this ... <code>(Barcode) =  &amp; Me.searchtext</code> ... should trigger a compile error.  I don't understand why you didn't get a compile error.  Make sure you have <code>Option Explicit</code> in the Declarations section of your code module.  </p>\n"}], "owner": {"reputation": 1194, "user_id": 4702471, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/t1LzO.jpg?s=128&g=1", "display_name": "Sauced Apples", "link": "https://stackoverflow.com/users/4702471/sauced-apples"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 37972258, "answer_count": 1, "score": 1, "last_activity_date": 1466609160, "creation_date": 1466607930, "last_edit_date": 1466609160, "question_id": 37971887, "link": "https://stackoverflow.com/questions/37971887/vba-syntax-error", "title": "VBA Syntax Error", "body": "<p>I am trying to use an unbound textbox and button to search my ID column (<code>Barcode</code>) and list the record in a form.</p>\n\n<p>The issue I'm having is that according to many examples it looks correct, but I'm new to VBA.</p>\n\n<pre><code>Private Sub searchbutton_Click()\n\nDim db As DAO.Database\nDim rst As DAO.Recordset\n\nDoCmd.OpenForm \"Update\"\n\nSet rst = Forms!Update.Recordset.Clone\n\nrst.FindFirst (Barcode) =  &amp; Me.searchtext\nForms!Update.Bookmark = rst.Bookmark\n\nDoCmd.Close acForm, Me.Name\n\nEnd Sub\n</code></pre>\n\n<p>The issue is with line <code>rst.FindFirst (Barcode) =  &amp; Me.searchtext</code> and throws a syntax error, but no specifics.</p>\n\n<p>I've also tried:</p>\n\n<pre><code>rst.FindFirst [Barcode] = Me.searchtext\nrst.FindFirst \"[Barcode] = \" Me.searchtext\nrst.FindFirst (Barcode) = \" Me.searchtext\n</code></pre>\n\n<p>The <code>[Barcode]</code> lines throw:</p>\n\n<blockquote>\n  <p>Run-time error '3464' Data type mismatch in criteria expression.</p>\n</blockquote>\n\n<p>the Barcode field is ShortText as it needs to support my barcodes which as \"000001\".....</p>\n"}, {"tags": ["excel", "vba", "save"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1466607844, "post_id": 37971812, "comment_id": 63389940, "body": "Try replacing <code>thisworkbook</code> with <code>workbook(filenameOfNewBook)</code>."}, {"owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1466607981, "post_id": 37971812, "comment_id": 63390025, "body": "Filename of the workbook keeps changing! I have several files that needs to be saved ."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1466608093, "post_id": 37971812, "comment_id": 63390101, "body": "Use the variable <code>&amp; FileName1 &amp; &quot;-&quot; &amp; &quot;List&quot; &amp; &quot;.xlsm&quot;</code> Edit: I like Oliver&#39;s architecture below better but he has it backwards."}, {"owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1466609267, "post_id": 37971812, "comment_id": 63390941, "body": "Can you clarify how to use the variable  again as said in previous comment    &amp; FileName1 &amp; &quot;-&quot; &amp; &quot;List&quot; &amp; &quot;.xlsm&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "is_accepted": false, "score": 0, "last_activity_date": 1466631606, "creation_date": 1466631606, "answer_id": 37978742, "question_id": 37971812, "link": "https://stackoverflow.com/questions/37971812/delete-cell-content-after-saveas/37978742#37978742", "title": "Delete Cell content after Saveas", "body": "<p>You need to get a handle on the workbook you just saved, make the changes you want and then save it again. The easiest way to do this is to assign a variable to it. In your declarations do something like this:</p>\n\n<pre><code>Dim wb as Workbook\n</code></pre>\n\n<p>then before your save-as line assign the saved workbook to that variable like this:</p>\n\n<p>Set wb = ThisWorkbook.SaveCopyAs FileName:=\"C:\\Users......\\\"    &amp; FileName1 &amp; \"-\" &amp; \"List\" &amp; \".xlsm\"</p>\n\n<p>Then you can work with wb as required as save it with wb.Save True etc etc</p>\n"}], "owner": {"reputation": 47, "user_id": 4736081, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4590e852d78fe647666cf1ec8d19dc07?s=128&d=identicon&r=PG&f=1", "display_name": "Swathi", "link": "https://stackoverflow.com/users/4736081/swathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466631606, "creation_date": 1466607713, "question_id": 37971812, "link": "https://stackoverflow.com/questions/37971812/delete-cell-content-after-saveas", "title": "Delete Cell content after Saveas", "body": "<p>I am trying to delete the contents of few cell in the saved copies of my workbook that is under different file names. As code below, this is deleting the content from original workbook and retaining the content in the saved wb. It is doing the right opposite task that I wanted for! </p>\n\n<p>Also, any suggestion on how to disable few modules and delete few pictures in the saved wb ?</p>\n\n<p>Thanks in Advance for help ! </p>\n\n<pre><code> Sub SaveAsNewCopy()\n Dim Path As String\n Dim FileName1 As String\n\n Application.DisplayAlerts = False\n\n FileName1 = Range(\"D3\")\n\n\n  ThisWorkbook.SaveCopyAs FileName:=\"C:\\Users\\..\\..\\..\\\"    &amp; FileName1 &amp; \"-\" &amp; \"List\" &amp; \".xlsm\"\n  MsgBox \"File Saved successfully!\", , \"Save\"\n\n  ThisWorkbook.Sheets(\"Sheet1\").Range(\"E5:F5\").ClearContents\n   ThisWorkbook.Sheets(\"Sheet1\").Range(\"E9:F9\").ClearContents\n\n   Application.DisplayAlerts = True\n\n   End Sub\n</code></pre>\n"}, {"tags": ["vba", "email", "ms-word", "outlook"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1466617666, "post_id": 37971684, "comment_id": 63396268, "body": "Did you try using SendUsingAccount to switch the account you want to send from? I could be wrong, but doesn&#39;t the signature get generated based on the account you are sending from?"}, {"owner": {"reputation": 347, "user_id": 5179637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-zMgbZYJkQoU/AAAAAAAAAAI/AAAAAAAAAJ8/mUhZW3vN3kg/photo.jpg?sz=128", "display_name": "Neil Dunlop", "link": "https://stackoverflow.com/users/5179637/neil-dunlop"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1466704981, "post_id": 37971684, "comment_id": 63441386, "body": "I did try.  It does not work, at least not on a system with both POP3 and Exchange accounts attached to it."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 5179637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-zMgbZYJkQoU/AAAAAAAAAAI/AAAAAAAAAJ8/mUhZW3vN3kg/photo.jpg?sz=128", "display_name": "Neil Dunlop", "link": "https://stackoverflow.com/users/5179637/neil-dunlop"}, "edited": false, "score": 0, "creation_date": 1466705561, "post_id": 37974875, "comment_id": 63441776, "body": "Nice idea.  As you say, not very elegant, possibly fairly expensive on CPU and requiring both the HTMLbody (as text) and the .oft to be saved for the duration but it would work, I think.  So far, my workaround during testing has been to simply find and delete the &#39;usual suspect&#39; signature from the body before it is sent.  Your method would do better than that.  Thanks.  I&#39;ll wait a bit before trying it, in the hope that someone knows how to switch off the problem at source rather than hack round it."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 347, "user_id": 5179637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-zMgbZYJkQoU/AAAAAAAAAAI/AAAAAAAAAJ8/mUhZW3vN3kg/photo.jpg?sz=128", "display_name": "Neil Dunlop", "link": "https://stackoverflow.com/users/5179637/neil-dunlop"}, "edited": false, "score": 0, "creation_date": 1466706109, "post_id": 37974875, "comment_id": 63442151, "body": "I&#39;m with you, yeah I poked around a bit and I couldn&#39;t find much either. Maybe poke Dmitry Streblechenko, Dmitry knows lots re: Outlook :)"}, {"owner": {"reputation": 347, "user_id": 5179637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-zMgbZYJkQoU/AAAAAAAAAAI/AAAAAAAAAJ8/mUhZW3vN3kg/photo.jpg?sz=128", "display_name": "Neil Dunlop", "link": "https://stackoverflow.com/users/5179637/neil-dunlop"}, "edited": false, "score": 0, "creation_date": 1466718292, "post_id": 37974875, "comment_id": 63448871, "body": "Thanks.  I&#39;ll try to get his attention.  Hi, <a href=\"http://stackoverflow.com/users/332059/dmitry-streblechenko\">Dimitry streblechenko</a>.  In my thread, <a href=\"http://stackoverflow.com/users/4839827/ryan-wildry\">Ryan Wildry</a> has suggested bringing this question to your notice.  The core of it is: &#39;Is it possible in VBA code to switch off the Default signature for an arbitrary Outlook Account?&#39;"}, {"owner": {"reputation": 347, "user_id": 5179637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-zMgbZYJkQoU/AAAAAAAAAAI/AAAAAAAAAJ8/mUhZW3vN3kg/photo.jpg?sz=128", "display_name": "Neil Dunlop", "link": "https://stackoverflow.com/users/5179637/neil-dunlop"}, "edited": false, "score": 0, "creation_date": 1475861051, "post_id": 37974875, "comment_id": 67129191, "body": "I&#39;m now using <a href=\"http://stackoverflow.com/users/4839827/ryan-wildry\">Ryan Wildry&#39;s</a> solution as the only one that works at all.  It was pretty complicated to implement.  It seems to be important to use <code>MailItem.Display</code> after making any edits to the Document created with <code>Set Doc = MailItem,.GetInspector.WordEditor</code> .  I actively don&#39;t want to see it displayed, but without the <code>.Display</code> the Signature in the original template is automatically changed to the Session default.  Sadly, <a href=\"http://stackoverflow.com/users/332059/dmitry-streblechenko\">Dimitry streblechenko</a> didn&#39;t pick up on this!"}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1466617261, "creation_date": 1466617261, "answer_id": 37974875, "question_id": 37971684, "link": "https://stackoverflow.com/questions/37971684/prevent-outlook-adding-unwanted-signatures-repeatedly-in-vba/37974875#37974875", "title": "Prevent Outlook Adding unwanted Signatures repeatedly in VBA", "body": "<p>Not the most elegant solution, but something like this should work.</p>\n\n<p>Basically, store the HTML of the email prior to displaying, then compare it after it's shown and update the HTML if it's different.</p>\n\n<pre><code>Public Sub OutlookTest()\n    Dim Outlook             As Object\n    Dim MyTemplateItem      As Object\n    Dim OriginalBody        As String\n\n    Set Outlook = CreateObject(\"Outlook.application\")\n    Set MyTemplateItem = Outlook.CreateItemFromTemplate(\"C:\\SomePath\\Example.oft\")\n\n    OriginalBody = MyTemplateItem.HTMLBody\n    MyTemplateItem.Display\n\n    If MyTemplateItem.HTMLBody &lt;&gt; OriginalBody Then MyTemplateItem.HTMLBody = OriginalBody\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 5179637, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-zMgbZYJkQoU/AAAAAAAAAAI/AAAAAAAAAJ8/mUhZW3vN3kg/photo.jpg?sz=128", "display_name": "Neil Dunlop", "link": "https://stackoverflow.com/users/5179637/neil-dunlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 888, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466705085, "creation_date": 1466607359, "last_edit_date": 1466705085, "question_id": 37971684, "link": "https://stackoverflow.com/questions/37971684/prevent-outlook-adding-unwanted-signatures-repeatedly-in-vba", "title": "Prevent Outlook Adding unwanted Signatures repeatedly in VBA", "body": "<p>I want to prevent Outlook from Appending a Signature to any newly opened Outlook MailItem.  When using <code>Outlook.CreateItemFromTemplate(TemplateName)</code> a default signature is automatically appended to the new MailItem.  When working with multiple accounts attached to the Outlook Client that Signature is often unwanted, or is simply the wrong one.  To make things worse, many Outlook Methods append further duplicate copies of the unwanted signature.  It is possible to  wind up with a whole slew of them attached.</p>\n\n<p>When opening a Template, the Signature appended is the Default for the Account that was active when TemplateName was <em>saved</em>.  It is <em>not</em> the Default for the currently active Account.  One idea is to temporarily switch off the signature for the relevant Account and add the required Signature directly as this would be a fairly simple fix for the problem.  <strong>Is there a way to switch off the signature for a specific account?  I can't find one.</strong>  </p>\n\n<p>The signature for the Default account <strong>can</strong> be Switched off by setting\n<code>appWd.EmailOptions.EmailSignature.NewMessageSignature = vbNullString</code> and it can also be restored later but this does not help.  An idea for a possible workaround was to programattically change the default account, switch off the default account's signature, open the required TemplateName and then restore everything back to the original state.  However, it doesn't work because:</p>\n\n<ul>\n<li>a) I can't find a way to switch the Default Account programattically.  It seems that this is only possible by clicking in the User Interface. </li>\n<li>b) And it would make no difference, anyway, because the Signature for the\nAccount that saved TemplateName would be used despite the change.</li>\n</ul>\n\n<p>Underlying this requirement is the fact that I need to merge parts of existing MailItems in Outlook using VBA.  The objective is to merge parts of multiple items into a new MailItem for onward distribution to a mail list.  The merging all works effectively using <code>MailItem.GetInspector.WordEditor</code> and I have sorted out the issues related to attachments and embedded pictures but the multiple Signatures, which would seem to be such a simple matter in comparison, are causing a problem.  Is there way to switch them off? Getting rid of them in the WordEditor or in the HTML would be very difficult as Signatures have arbitrary structures.</p>\n"}, {"tags": ["python-2.7", "excel", "format", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": true, "score": 0, "last_activity_date": 1466616510, "last_edit_date": 1525816189, "creation_date": 1466616510, "answer_id": 37974677, "question_id": 37971645, "link": "https://stackoverflow.com/questions/37971645/format-text-file-using-python-or-excel/37974677#37974677", "title": "Format text file using Python or Excel", "body": "<p>In VBA, this should help you to get started.</p>\n\n<pre><code>Sub test()\nDim InputString As String\nDim RowToPerform As Long\nDim TextPath As Variant\nDim ArrayString() As String\nDim CounterArray As Long\n\nTextPath = Application.GetOpenFilename(\"Txt Files,*.txt\", Title:=\"Select Txt\")\nOpen TextPath For Input As #1\n    Do Until EOF(1)\n        Line Input #1, InputString\n        RowToPerform = Cells(Rows.Count, 1).End(xlUp).Row + 1\n        'ArrayString = Split(InputString, \"|\")\n        ArrayString = Split(InputString, \"ROOT:\")\n        Cells(RowToPerform, 1).Value = \"ROOT: \"\n        Cells(RowToPerform - 1, 1).Value = Cells(RowToPerform - 1, 1).Value &amp; ArrayString(0)\n        For CounterArray = LBound(ArrayString) To UBound(ArrayString)\n        If CounterArray &gt; 0 Then Cells(RowToPerform, 1).Value = Cells(RowToPerform, 1).Value &amp; ArrayString(CounterArray)\n        Next CounterArray\n    Loop\n    Close #1\nEnd Sub\n</code></pre>\n\n<p><a href=\"http://www.cpearson.com/excel/ImpText.aspx\" rel=\"nofollow noreferrer\">These</a> <a href=\"http://www.excel-easy.com/vba/examples/read-data-from-text-file.html\" rel=\"nofollow noreferrer\">links</a> may be useful as well.\n<a href=\"https://i.stack.imgur.com/4MozK.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4MozK.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 592, "user_id": 3390373, "user_type": "registered", "accept_rate": 95, "profile_image": "https://graph.facebook.com/100000459972376/picture?type=large", "display_name": "kskp", "link": "https://stackoverflow.com/users/3390373/kskp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 37974677, "answer_count": 1, "score": 0, "last_activity_date": 1466616510, "creation_date": 1466607255, "last_edit_date": 1531161705, "question_id": 37971645, "link": "https://stackoverflow.com/questions/37971645/format-text-file-using-python-or-excel", "title": "Format text file using Python or Excel", "body": "<p>I have a text file that looks like:</p>\n\n<pre><code>ROOT: are   DOBJ: money DOBJ: deal  \nDOBJ: products  ROOT: count DOBJ: me    DOBJ: deal  \nPOBJ: amp   ROOT: dads. POBJ: diapers   \nROOT: get   DOBJ: ecard DOBJ: it    \nROOT: hutang    \n</code></pre>\n\n<p>Each word is seperated by a tab. The file has about 50,000 lines like this. I want to format the file in such a way that each line starts with a ROOT followed by DOBJ, and then by POBJ. Every line has exactly one ROOT and the count of DOBJ/POBJ is unknown and can vary from 0-5. I tried to import the file into an excel sheet and trying doing a HLOOKUP but I am not getting what I want. I want to write the following logic in VBA (I have never used VBA before):</p>\n\n<pre><code>Dim sh As Worksheet\nDim rw As Range\nDim RowCount As Integer\n\nSet sh = ActiveSheet\nFor Each rw In sh.Rows\n    if cellnumber(ROOT) != A\n        swap content(A), content of cell containing ROOT\n</code></pre>\n\n<p>Can someone help me with this code or tell me if there is a better way to do it either using Python or Excel?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1466607106, "post_id": 37971444, "comment_id": 63389376, "body": "<a href=\"https://support.office.com/en-us/article/OFFSET-function-c8de19ae-dd79-4b9b-a14e-b4d906d11b66\" rel=\"nofollow noreferrer\"><code>OFFSET</code></a> can be helpful."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466607275, "post_id": 37971444, "comment_id": 63389511, "body": "can it be done using an array =((A:A=criteria1)*(B:B=criteria2)*(C:C)) where C is the value?"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 1, "creation_date": 1466607746, "post_id": 37971444, "comment_id": 63389869, "body": "I can&#39;t see where <code>source</code> (in <code>src = Split(source.address(External:=True), &quot;!&quot;)(0)</code>) is defined.  Could this be the problem?"}, {"owner": {"reputation": 11, "user_id": 6499755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdb3655f2cbd3161ce57a2570795971?s=128&d=identicon&r=PG&f=1", "display_name": "user6499755", "link": "https://stackoverflow.com/users/6499755/user6499755"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1466637299, "post_id": 37971444, "comment_id": 63405199, "body": "@aucuparia oops sorry, i just changed the variable names for readability.. i edited the OP thanks :)"}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1466656267, "creation_date": 1466656267, "answer_id": 37982382, "question_id": 37971444, "link": "https://stackoverflow.com/questions/37971444/to-modify-index-match-which-is-not-working/37982382#37982382", "title": "To modify INDEX-MATCH which is not working", "body": "<p>You don't say what line is give you the VALUE error. That would help.\nOr is it in a specific cell?</p>\n\n<p>You haven't defined \"addr\" variable type anywhere that I can see\nand you don't have OPTION EXPLICIT at the top, so by default \"addr\" wil be a Variant data type.</p>\n\n<p>It needs to be <code>Object</code> at minimum and preferably <code>Range</code> </p>\n\n<p>You should add <code>Option Explicit</code> to the top of your module (above <code>Option Compare Text</code>) and recompile until you can fix all the errors (if there are more)  </p>\n"}], "owner": {"reputation": 11, "user_id": 6499755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdb3655f2cbd3161ce57a2570795971?s=128&d=identicon&r=PG&f=1", "display_name": "user6499755", "link": "https://stackoverflow.com/users/6499755/user6499755"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1466656267, "creation_date": 1466606751, "last_edit_date": 1466637379, "question_id": 37971444, "link": "https://stackoverflow.com/questions/37971444/to-modify-index-match-which-is-not-working", "title": "To modify INDEX-MATCH which is not working", "body": "<p>Basically this is supposed to be a modified <code>INDEX/MATCH</code> formula but will depend on variables and headers on another workbook, as well as hopefully make it easier on the user by only requiring them to provide two parameters.</p>\n\n<pre><code>Option Compare Text\nFunction DATAFILL(ID_number, source_headerRow) As Variant\n    ID_header_name = Cells.Item(1, ID_number.column).Value\n    Dim wb As String, ws As String\n    Dim ID_src As Range\n'check if source_headerRow is an external workbook\n    If source_headerRow Like \"'\" Then\n        src = Split(source_headerRow.address(External:=True), \"!\")(0)\n        wb = Replace(Split(src, \"]\")(0),\"[\",\"\")\n        ws = Split(src, \"]\")(1)\n        id_col = Application.WorksheetFunction.Match(ID_header_name, source, 0)\n        Set ID_src = Workbooks(wb).Worksheets(ws).Range(Cells(1, id_col))\n    Else\n        Set ID_src = Range(Cells(1, Application.WorksheetFunction.Match(ID_header_name, source_headerRow, 0)))\n    End If\n\n    headername = \"Shift\" 'placeholder\n    Set addr = Workbooks(wb).Range(\"A:Z\")\n    DATAFILL = Application.WorksheetFunction.Index(addr, Application.WorksheetFunction.Match(ID_number, ID_src), Application.WorksheetFunction.Match(headername, source_headerRow, 0))\n\nEnd Function\n</code></pre>\n\n<p>I'm very new to VBA so I can't pinpoint exactly where I'm going wrong...\nNo matter what I do, I get <code>#VALUE!</code> error.</p>\n\n<p>Or is there a way to make <code>INDEX/MATCH</code> <em>user</em> friendly without needing VBA/Macros?</p>\n"}, {"tags": ["vba", "excel", "listbox"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466607844, "post_id": 37971427, "comment_id": 63389941, "body": "Your <code>set</code> statements (e.g. <code>Set table_object_rowA = table_list_objectA.ListRows.Add</code>) are, as they say, <code>Add</code>ing a row to the tables?  Also you might want to move the code checking <code>Me.ProjectNameTextBox.Value</code> further up the code, before you set the row value to it?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6331073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad3a785da9ee2d887cd8963a93c179f?s=128&d=identicon&r=PG&f=1", "display_name": "Robertscoder", "link": "https://stackoverflow.com/users/6331073/robertscoder"}, "edited": false, "score": 0, "creation_date": 1466689922, "post_id": 37972489, "comment_id": 63430864, "body": "Ignore this message. I started typing in the wrong space"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 23, "user_id": 6331073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad3a785da9ee2d887cd8963a93c179f?s=128&d=identicon&r=PG&f=1", "display_name": "Robertscoder", "link": "https://stackoverflow.com/users/6331073/robertscoder"}, "edited": false, "score": 0, "creation_date": 1466692542, "post_id": 37972489, "comment_id": 63432994, "body": "@Nisaa Roberts: well, the code you posted as working is much the one I posted in this answer. Then, please mark this answer as accepted. thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1466609541, "creation_date": 1466609541, "answer_id": 37972489, "question_id": 37971427, "link": "https://stackoverflow.com/questions/37971427/add-new-row-with-data-entered-to-specific-table-on-worksheet-if-certain-listbox/37972489#37972489", "title": "Add new row with data entered to specific table on worksheet if certain listbox item selected", "body": "<p><code>ListIndex</code> property returns the item position inside the listbox list, while <code>.Value</code> property returns its selected value (if any) or an error (if no item selected)</p>\n\n<p>So you may need something like follows:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub AddNewButton_Click()\n    Dim the_sheet As Worksheet\n    Dim table_list_object As ListObject\n    Dim table_object_row As ListRow\n    Dim last_row_with_data As Long\n    Dim tableName As String, errMsg As String\n\n\n    If Me.ProjectNameTextBox.Value = \"\" Then\n        MsgBox \"Please enter Project Name.\", vbExclamation, \"Project Tracker Template\"\n        Me.ProjectNameTextBox.SetFocus\n    End If\n\n    With Me.StatusListBox\n        If .ListIndex &lt;&gt; -1 Then\n            Select Case .Value\n                Case \"Secured\", \"Live\", \"Completed\"\n                    tableName = \"Table3\"\n                Case \"Tender (Pipeline)\", \"Tender (Negotiated)\", \"Tender (Favourable)\"\n                    tableName = \"Table4\"\n                Case Else\n                    errMsg = \"No valid item selected!\"\n            End Select\n        Else\n            errMsg = \"No item selected!\"\n        End If\n    End With\n    If tableName = \"\" Then\n        MsgBox errMsg, vbCritical\n        Exit Sub\n    End If\n\n    Set the_sheet = Sheets(\"Data Sheet\")\n\n    With the_sheet\n\n        Set table_list_object = .ListObjects(\"Table3\")\n        Set table_object_row = table_list_object.ListRows.Add\n        table_object_row.Range(1, 1).Value = ProjectNameTextBox.Value\n\n        last_row_with_data = .Range(.Rows.Count, 1).End(xlUp).row + 1\n\n        .Range(\"B\" &amp; last_row_with_data) = ClientTextBox.Value\n        .Range(\"C\" &amp; last_row_with_data) = SectorListBox.Value\n        .Range(\"D\" &amp; last_row_with_data) = StatusListBox.Value\n        .Range(\"E\" &amp; last_row_with_data) = ContractValueTextBox.Value\n        .Range(\"F\" &amp; last_row_with_data) = AFATextBox.Value\n        .Range(\"G\" &amp; last_row_with_data) = RTPTextBox.Value\n        .Range(\"H\" &amp; last_row_with_data) = TwentyFifteenTextBox.Value\n        .Range(\"I\" &amp; last_row_with_data) = TwentySixteenTextBox.Value\n        .Range(\"J\" &amp; last_row_with_data) = TwentySeventeenTextBox.Value\n        .Range(\"K\" &amp; last_row_with_data) = TwentyEighteenTextBox.Value\n        .Range(\"L\" &amp; last_row_with_data) = TwentyNineteenTextBox.Value\n        .Range(\"M\" &amp; last_row_with_data) = DisciplineListBox.Value\n        .Range(\"N\" &amp; last_row_with_data) = BoardDirectorListBox.Value\n        .Range(\"O\" &amp; last_row_with_data) = AssociateDirectorTextBox.Value\n        .Range(\"P\" &amp; last_row_with_data) = CommercialManagerTextBox.Value\n        .Range(\"Q\" &amp; last_row_with_data) = ProjectManagerTextBox.Value\n        .Range(\"R\" &amp; last_row_with_data) = QuantitySurveyorTextBox.Value\n        .Range(\"S\" &amp; last_row_with_data) = PreConTextBox.Value\n        .Range(\"T\" &amp; last_row_with_data) = ActualTextBox.Value\n        .Range(\"U\" &amp; last_row_with_data) = DPStartTextBox.Value\n        .Range(\"V\" &amp; last_row_with_data) = DPEndTextBox.Value\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 6331073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad3a785da9ee2d887cd8963a93c179f?s=128&d=identicon&r=PG&f=1", "display_name": "Robertscoder", "link": "https://stackoverflow.com/users/6331073/robertscoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1466691402, "creation_date": 1466691402, "answer_id": 37994254, "question_id": 37971427, "link": "https://stackoverflow.com/questions/37971427/add-new-row-with-data-entered-to-specific-table-on-worksheet-if-certain-listbox/37994254#37994254", "title": "Add new row with data entered to specific table on worksheet if certain listbox item selected", "body": "<p>I have managed to solve the issue with thanks to those that contributed.</p>\n\n<p>I replaced .ListObjects(\"Table3\") with .ListObjects(tableName)</p>\n\n<p>This is the code that now works:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub AddNewButton_Click()\nDim the_sheet As Worksheet\nDim table_list_object As ListObject\nDim table_object_row As ListRow\nDim last_row_with_data As Long\nDim tableName As String, errMsg As String\n\n\nIf Me.ProjectNameTextBox.Value = \"\" Then\n    MsgBox \"Please enter Project Name.\", vbExclamation, \"Project Tracker Template\"\n    Me.ProjectNameTextBox.SetFocus\nEnd If\n\nWith Me.StatusListBox\n    If .ListIndex &lt;&gt; -1 Then\n        Select Case .Value\n            Case \"Secured\", \"Live\", \"Completed\"\n                tableName = \"Table3\"\n            Case \"Tender (Pipeline)\", \"Tender (Negotiated)\", \"Tender (Favourable)\"\n                tableName = \"Table4\"\n            Case Else\n                errMsg = \"No valid item selected!\"\n        End Select\n    Else\n        errMsg = \"No item selected!\"\n    End If\nEnd With\nIf tableName = \"\" Then\n    MsgBox errMsg, vbCritical\n    Exit Sub\nEnd If\n\nSet the_sheet = Sheets(\"Data Sheet\")\n\nWith the_sheet\n\n    Set table_list_object = .ListObjects(tableName)\n    Set table_object_row = table_list_object.ListRows.Add\n\n    last_row_with_data = the_sheet.Range(\"A65536\").End(xlUp).Row\n\n    table_object_row.Range(1, 1).Value = ProjectNameTextBox.Value\n    table_object_row.Range(1, 2).Value = ClientTextBox.Value\n    table_object_row.Range(1, 3).Value = SectorListBox.Value\n    table_object_row.Range(1, 4).Value = StatusListBox.Value\n    table_object_row.Range(1, 5).Value = ContractValueTextBox.Value\n    table_object_row.Range(1, 6).Value = AFATextBox.Value\n    table_object_row.Range(1, 7).Value = RTPTextBox.Value\n    table_object_row.Range(1, 8).Value = TwentyFifteenTextBox.Value\n    table_object_row.Range(1, 9).Value = TwentySixteenTextBox.Value\n    table_object_row.Range(1, 10).Value = TwentySeventeenTextBox.Value\n    table_object_row.Range(1, 11).Value = TwentyEighteenTextBox.Value\n    table_object_row.Range(1, 12).Value = TwentyNineteenTextBox.Value\n    table_object_row.Range(1, 13).Value = DisciplineListBox.Value\n    table_object_row.Range(1, 14).Value = BoardDirectorListBox.Value\n    table_object_row.Range(1, 15).Value = AssociateDirectorTextBox.Value\n    table_object_row.Range(1, 16).Value = CommercialManagerTextBox.Value\n    table_object_row.Range(1, 17).Value = ProjectManagerTextBox.Value\n    table_object_row.Range(1, 18).Value = QuantitySurveyorTextBox.Value\n    table_object_row.Range(1, 19).Value = PreConTextBox.Value\n    table_object_row.Range(1, 20).Value = ActualTextBox.Value\n    table_object_row.Range(1, 21).Value = DPStartTextBox.Value\n    table_object_row.Range(1, 22).Value = DPEndTextBox.Value\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Many thanks.</p>\n"}], "owner": {"reputation": 23, "user_id": 6331073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad3a785da9ee2d887cd8963a93c179f?s=128&d=identicon&r=PG&f=1", "display_name": "Robertscoder", "link": "https://stackoverflow.com/users/6331073/robertscoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 37972489, "answer_count": 2, "score": 0, "last_activity_date": 1466691402, "creation_date": 1466606708, "question_id": 37971427, "link": "https://stackoverflow.com/questions/37971427/add-new-row-with-data-entered-to-specific-table-on-worksheet-if-certain-listbox", "title": "Add new row with data entered to specific table on worksheet if certain listbox item selected", "body": "<p>Using Excel 2013 VBA</p>\n\n<p>I have a bit of code where I am looking for a new row of data to be added to the bottom of the tables of a worksheet. The worksheet that needs to be populated is Sheet3 (\"Data Sheet\") or just Data Sheet on the tab.</p>\n\n<p>On the worksheet there are two tables (Table3 and Table4) and depending on the category selected from the listbox (called StatusListBox), the row of data is added to the bottom of either one of the two tables.</p>\n\n<p>If the user selects \"Live\", \"Secured\" or \"Completed\" then Table3 should be populated but if the user selects \"Tender (Pipeline\"), Tender (Negotiated)\" or \"Tender (Favourable)\" then Table 4 should be populated.</p>\n\n<p>With the current code I have a new row of data is added to the bottom of BOTH Table3 and Table4.</p>\n\n<pre><code>Private Sub AddNewButton_Click()\nDim the_sheet As Worksheet\nDim table_list_object As ListObject\nDim table_object_row As ListRow\nSet the_sheet = Sheets(\"Data Sheet\")\nSet table_list_objectA = the_sheet.ListObjects(\"Table3\")\nSet table_list_objectB = the_sheet.ListObjects(\"Table4\")\nSet table_object_rowA = table_list_objectA.ListRows.Add\nSet table_object_rowB = table_list_objectB.ListRows.Add\n\nIf Me.StatusListBox.ListIndex = \"Secured\" Then\ntable_list_objectA.ListRows.Add\nElseIf Me.StatusListBox.ListIndex = \"Live\" Then\ntable_list_objectA.ListRows.Add\nElseIf Me.StatusListBox.ListIndex = \"Completed\" Then\ntable_list_objectA.ListRows.Add\nElseIf Me.StatusListBox.ListIndex = \"Tender (Pipeline)\" Then\ntable_list_objectB.ListRows.Add\nElseIf Me.StatusListBox.ListIndex = \"Tender (Negotiated)\" Then\ntable_list_objectB.ListRows.Add\nElseIf Me.StatusListBox.ListIndex = \"Tender (Favourable)\" Then\ntable_list_objectB.ListRows.Add\nEnd If\n\ntable_object_rowA.Range(1, 1).Value = ProjectNameTextBox.Value\ntable_object_rowB.Range(1, 1).Value = ProjectNameTextBox.Value\n\nlast_row_with_data = the_sheet.Range(\"A65536\").End(xlUp).Row\nlast_row_with_data = last_row_with_data\n\nthe_sheet.Range(\"B\" &amp; last_row_with_data) = ClientTextBox.Value\nthe_sheet.Range(\"C\" &amp; last_row_with_data) = SectorListBox.Value\nthe_sheet.Range(\"D\" &amp; last_row_with_data) = StatusListBox.Value\nthe_sheet.Range(\"E\" &amp; last_row_with_data) = ContractValueTextBox.Value\nthe_sheet.Range(\"F\" &amp; last_row_with_data) = AFATextBox.Value\nthe_sheet.Range(\"G\" &amp; last_row_with_data) = RTPTextBox.Value\nthe_sheet.Range(\"H\" &amp; last_row_with_data) = TwentyFifteenTextBox.Value\nthe_sheet.Range(\"I\" &amp; last_row_with_data) = TwentySixteenTextBox.Value\nthe_sheet.Range(\"J\" &amp; last_row_with_data) = TwentySeventeenTextBox.Value\nthe_sheet.Range(\"K\" &amp; last_row_with_data) = TwentyEighteenTextBox.Value\nthe_sheet.Range(\"L\" &amp; last_row_with_data) = TwentyNineteenTextBox.Value\nthe_sheet.Range(\"M\" &amp; last_row_with_data) = DisciplineListBox.Value\nthe_sheet.Range(\"N\" &amp; last_row_with_data) = BoardDirectorListBox.Value\nthe_sheet.Range(\"O\" &amp; last_row_with_data) = AssociateDirectorTextBox.Value\nthe_sheet.Range(\"P\" &amp; last_row_with_data) = CommercialManagerTextBox.Value\nthe_sheet.Range(\"Q\" &amp; last_row_with_data) = ProjectManagerTextBox.Value\nthe_sheet.Range(\"R\" &amp; last_row_with_data) = QuantitySurveyorTextBox.Value\nthe_sheet.Range(\"S\" &amp; last_row_with_data) = PreConTextBox.Value\nthe_sheet.Range(\"T\" &amp; last_row_with_data) = ActualTextBox.Value\nthe_sheet.Range(\"U\" &amp; last_row_with_data) = DPStartTextBox.Value\nthe_sheet.Range(\"V\" &amp; last_row_with_data) = DPEndTextBox.Value\n\nIf Me.ProjectNameTextBox.Value = \"\" Then\nMsgBox \"Please enter Project Name.\", vbExclamation, \"Project Tracker Template\"\nMe.ProjectNameTextBox.SetFocus\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Would appreciate any help.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 567, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466606688, "creation_date": 1466606688, "last_edit_date": 1531161705, "question_id": 37971416, "link": "https://stackoverflow.com/questions/37971416/hovering-over-cells-display-certain-values", "title": "Hovering over cells display certain values", "body": "<p>So right now I have this calendar set-up:</p>\n\n<p><a href=\"http://imgur.com/xhaHEMH\" rel=\"nofollow\">http://imgur.com/xhaHEMH</a> - can't post images yet</p>\n\n<p>And I have a formula like:</p>\n\n<pre><code>=IF(ISNUMBER(FIND(\"Yes\",'HI Project Database'!D2)), ('HI Project Database'!$B2&amp;\" - \"&amp;'HI Project Database'!$A2), \"\")\n</code></pre>\n\n<p>In the cells to pull data based on certain conditions from a separate spreadsheet.</p>\n\n<p>Now I want to also display certain values if you hover the cells, specifically display text pulled from the \"HI Project Database\" sheet from cells AB:AG with commas and spaces in between.</p>\n\n<p>What's the best way to go about doing this?</p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1466607018, "post_id": 37971408, "comment_id": 63389309, "body": "Is it VBA or VB.NET, these are two distinct languages."}, {"owner": {"reputation": 85, "user_id": 1425918, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/954650f8b11aa5f7f724a3a80f12552e?s=128&d=identicon&r=PG&f=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/1425918/santosh"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1466784537, "post_id": 37971408, "comment_id": 63477357, "body": "I meant VBA, dont know why it shows vb.net sometimes in the subject"}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1466948431, "post_id": 37971408, "comment_id": 63517835, "body": "it is because it was tagged as such. Somebody else edited your post to removed it."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 1425918, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/954650f8b11aa5f7f724a3a80f12552e?s=128&d=identicon&r=PG&f=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/1425918/santosh"}, "edited": false, "score": 0, "creation_date": 1466750537, "post_id": 37976526, "comment_id": 63457514, "body": "Excellent! Thanks a lot for quick response. I could not test it immediately, but now I tested and it works well."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1466623054, "creation_date": 1466623054, "answer_id": 37976526, "question_id": 37971408, "link": "https://stackoverflow.com/questions/37971408/import-xml-data-into-excel-using-vba-selectnodes-is-not-working-returns-nothin/37976526#37976526", "title": "Import XML data into excel using VBA, selectnodes is not working (returns nothing)", "body": "<p>An often made mistake with XML parsing is the undeclared namespace in the root. As a result, you have to assign a namespace prefix during parsing of the document and use such a prefix in the XPath expression. Below, <em>doc</em> is assigned:</p>\n\n<pre><code>...\nDim xpathToExtractRow As String, XMLNamespaces As String\nDim dom As DOMDocument60\n\nxpathToExtractRow = \"/doc:cqresponse/doc:rows/doc:row\"\nXMLNamespaces = \"xmlns:doc='http://ibm.com/rational/cqweb/v7.1'\"\n\nSet dom = New DOMDocument60\ndom.Load (\"C:\\ABC.xml\")\ndom.setProperty \"SelectionNamespaces\", XMLNamespaces\n...\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 1425918, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/954650f8b11aa5f7f724a3a80f12552e?s=128&d=identicon&r=PG&f=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/1425918/santosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 1, "accepted_answer_id": 37976526, "answer_count": 1, "score": 2, "last_activity_date": 1466750457, "creation_date": 1466606678, "last_edit_date": 1466750457, "question_id": 37971408, "link": "https://stackoverflow.com/questions/37971408/import-xml-data-into-excel-using-vba-selectnodes-is-not-working-returns-nothin", "title": "Import XML data into excel using VBA, selectnodes is not working (returns nothing)", "body": "<p>I have the below XML</p>\n\n<pre><code>&lt;cqresponse xmlns=\"http://ibm.com/rational/cqweb/v7.1\"&gt;\n&lt;rows&gt;\n    &lt;row&gt;\n        &lt;id&gt;\n            &lt;![CDATA[ ABC00082474 ]]&gt;\n        &lt;/id&gt;\n        &lt;Short_Desc&gt;\n            &lt;![CDATA[\n            Some Description 1\n            ]]&gt;\n        &lt;/Short_Desc&gt;\n        &lt;State&gt;\n            &lt;![CDATA[ Some State 1 ]]&gt;\n        &lt;/State&gt;\n     &lt;/row&gt;\n     &lt;row&gt;\n        &lt;id&gt;\n            &lt;![CDATA[ ABC00082475 ]]&gt;\n        &lt;/id&gt;\n        &lt;Short_Desc&gt;\n            &lt;![CDATA[\n            Some Description 2\n            ]]&gt;\n        &lt;/Short_Desc&gt;\n        &lt;State&gt;\n            &lt;![CDATA[ Some State 2 ]]&gt;\n        &lt;/State&gt;\n    &lt;/row&gt;\n&lt;/rows&gt;\n&lt;/cqresponse&gt;\n</code></pre>\n\n<p>I want to import this into Excel using VB script. I had the below code, but the SelectNodes is not returning anything. It just returns Nothing</p>\n\n<pre><code>Sub Test()\n    Dim nodeList As IXMLDOMNodeList\n    Dim nodeRow As IXMLDOMNode\n    Dim nodeCell As IXMLDOMNode\n    Dim rowCount As Integer\n    Dim cellCount As Integer\n    Dim rowRange As Range\n    Dim cellRange As Range\n    Dim sheet As Worksheet\n    Dim xpathToExtractRow As String\n    Dim dom As DOMDocument60\n\n    xpathToExtractRow = \"/cqresponse/rows/row\"\n\n    Set dom = New DOMDocument60\n    dom.Load (\"C:\\ABC.xml\") ' this file contains the same xml data as mentioned above\n    Set sheet = ActiveSheet\n    Set nodeList = dom.SelectNodes(xpathToExtractRow)\n\n    rowCount = 0\n    For Each nodeRow In nodeList\n        rowCount = rowCount + 1\n        cellCount = 0\n        For Each nodeCell In nodeRow.ChildNodes\n            cellCount = cellCount + 1\n            Set cellRange = sheet.Cells(rowCount, cellCount)\n            cellRange.Value = nodeCell.Text\n        Next nodeCell\n    Next nodeRow\nEnd Sub\n</code></pre>\n\n<p>Is there something wrong in this or do I need to take a different approach?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466606527, "post_id": 37971271, "comment_id": 63388940, "body": "Doesn&#39;t require VBA at all -- just a rather straightforward application of Excel&#39;s <code>IF</code> function. Read the help on it."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466606765, "post_id": 37971271, "comment_id": 63389105, "body": "You can&#39;t really do this without an <code>If</code> type condition, whether it&#39;s in the worksheet as an <code>IF</code> function, or processed in <code>VBA</code> directly.  Why would you want to not use an <code>If</code> anyway?"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1466606586, "creation_date": 1466606586, "answer_id": 37971373, "question_id": 37971271, "link": "https://stackoverflow.com/questions/37971271/display-string-in-excel-with-math-operator/37971373#37971373", "title": "Display string in excel with math operator", "body": "<p>How about:</p>\n\n<pre><code>=IF(A1-A2=0,\"OK\",A1-A2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1762, "user_id": 3661120, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2945ed0aa05dd03ab9ebbc5f33668360?s=128&d=identicon&r=PG&f=1", "display_name": "dashnick", "link": "https://stackoverflow.com/users/3661120/dashnick"}, "is_accepted": true, "score": 0, "last_activity_date": 1466606629, "creation_date": 1466606629, "answer_id": 37971390, "question_id": 37971271, "link": "https://stackoverflow.com/questions/37971271/display-string-in-excel-with-math-operator/37971390#37971390", "title": "Display string in excel with math operator", "body": "<p>If you don't want to use <code>IF</code>, as stated, you could use a custom number format, like <code>0;0;\"ok\"</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/MQALH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MQALH.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 6499811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c92fc7e322c6c5468611112edc5db139?s=128&d=identicon&r=PG&f=1", "display_name": "ashay", "link": "https://stackoverflow.com/users/6499811/ashay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 37971390, "answer_count": 2, "score": 1, "last_activity_date": 1466606629, "creation_date": 1466606309, "last_edit_date": 1531161705, "question_id": 37971271, "link": "https://stackoverflow.com/questions/37971271/display-string-in-excel-with-math-operator", "title": "Display string in excel with math operator", "body": "<p>I want to subract 2 numbers. For example 2 numbers are in Cell A1 and A2.\nI want to subract them in cell A3. i.e in cell A3 i'll have \"=A1-A2\"</p>\n\n<p>If A1-A2 is 0 i want to display \"Ok!\" else i want to display whatever is answer.</p>\n\n<p>But i want to do this without using if condition.\ni.e in cell A3 it should be only \"A1-A2\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1466606406, "post_id": 37971186, "comment_id": 63388831, "body": "Seems like an ill-posed question. If you are doing floating-point calculations then your computed number might well have a decimal even if, mathematically, it shouldn&#39;t. What if the computed number is 10.00000001 or 9.999999999? Either do your calculations so that all numbers are always integers (and strive for a remainder to be 0), or introduce an error tolerance. As it is, it sounds like you are headed for an infinite loop."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 2, "creation_date": 1466607583, "post_id": 37971186, "comment_id": 63389749, "body": "This seems like a very strange way of solving (what I assume is) your problem.  There are only 52 3-digit numbers exactly divisible by 17.  Either list them all and pick one at random from the list; or pick a random integer between 6 and 58 and multiply that by 17."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6499788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c979a8377245f1843e2d65b75e1fd4?s=128&d=identicon&r=PG&f=1", "display_name": "DChain", "link": "https://stackoverflow.com/users/6499788/dchain"}, "edited": false, "score": 0, "creation_date": 1466750812, "post_id": 37971609, "comment_id": 63457665, "body": "Yes correct. I only want single digit in A1 through C1.  Your formula works!!   Although my actual situation is slightly more complicated than the one i have illustrated, it does its job brilliantly. Much appreciated for your effort!   Many thanks.  Having said so, I am thinking if there is another way to make the code slightly less clumsy. Because the calculation I am working on is 11-digit number. :)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 3, "user_id": 6499788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c979a8377245f1843e2d65b75e1fd4?s=128&d=identicon&r=PG&f=1", "display_name": "DChain", "link": "https://stackoverflow.com/users/6499788/dchain"}, "edited": false, "score": 0, "creation_date": 1466765072, "post_id": 37971609, "comment_id": 63465548, "body": "@DChain  You are quite welcome !  create a new Post and we will assis with the 11-digit problem as well."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1466765113, "last_edit_date": 1466765113, "creation_date": 1466607164, "answer_id": 37971609, "question_id": 37971186, "link": "https://stackoverflow.com/questions/37971186/how-to-run-calcuation-until-the-value-has-no-decimals-in-vba/37971609#37971609", "title": "How to run calcuation until the value has no decimals in VBA?", "body": "<p>Consider:</p>\n\n<pre><code>Sub dural()\n    With Application.WorksheetFunction\n    Do\n        Range(\"A1\").Value = .RandBetween(1, 100)\n        Range(\"B1\").Value = .RandBetween(1, 100)\n        Range(\"C1\").Value = .RandBetween(1, 100)\n        If Range(\"A3\").Value Mod 17 = 0 Then Exit Sub\n    Loop\n    End With\nEnd Sub\n</code></pre>\n\n<p>This assumes that cell <strong>A3</strong> contains:</p>\n\n<pre><code>=SUM(A1:C1)\n</code></pre>\n\n<p>rather than your formula.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RgSKu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RgSKu.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>If you want only single digits in <strong>A1</strong> through <strong>C1</strong>, then put this formula in <strong>A3</strong>:</p>\n\n<pre><code>=A1*100+B1*10+C1\n</code></pre>\n\n<p>and use this macro:</p>\n\n<pre><code>Sub dural2()\n    With Application.WorksheetFunction\n    Do\n        Range(\"A1\").Value = .RandBetween(1, 9)\n        Range(\"B1\").Value = .RandBetween(0, 9)\n        Range(\"C1\").Value = .RandBetween(0, 9)\n        If Range(\"A3\").Value Mod 17 = 0 Then Exit Sub\n    Loop\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "edited": false, "score": 0, "creation_date": 1466607767, "post_id": 37971761, "comment_id": 63389883, "body": "@DChain do you want only single digit numbers in cells A1, B1, C1. so you have a random range of 0 - 999? if so you will need to concatenate them."}, {"owner": {"reputation": 3, "user_id": 6499788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c979a8377245f1843e2d65b75e1fd4?s=128&d=identicon&r=PG&f=1", "display_name": "DChain", "link": "https://stackoverflow.com/users/6499788/dchain"}, "edited": false, "score": 0, "creation_date": 1466751129, "post_id": 37971761, "comment_id": 63457851, "body": "I actually want single digit number in cell A1 to C1. the rand function i place in the cell is &quot;Randbetween(0,9)&quot;.   How to concatenate them in your formula, just wondering?  Would love to learn more :)  Thank you :)"}], "tags": [], "owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "is_accepted": false, "score": 0, "last_activity_date": 1466607589, "creation_date": 1466607589, "answer_id": 37971761, "question_id": 37971186, "link": "https://stackoverflow.com/questions/37971186/how-to-run-calcuation-until-the-value-has-no-decimals-in-vba/37971761#37971761", "title": "How to run calcuation until the value has no decimals in VBA?", "body": "<p>Run this Macro</p>\n\n<pre><code>Sub Macro()\n    Do Until Range(\"A3\") = 17\n        Range(\"C1\").Value = Int((100 - 0 + 1) * Rnd + 0)\n        Range(\"B1\").Value = Int((100 - 0 + 1) * Rnd + 0)\n        Range(\"A1\").Value = Int((100 - 0 + 1) * Rnd + 0)\n\n        Range(\"A3\") = (Range(\"A1\") + Range(\"B1\") + Range(\"C1\")) / 17\n    Loop\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6499788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c979a8377245f1843e2d65b75e1fd4?s=128&d=identicon&r=PG&f=1", "display_name": "DChain", "link": "https://stackoverflow.com/users/6499788/dchain"}, "edited": false, "score": 0, "creation_date": 1466751028, "post_id": 37972797, "comment_id": 63457798, "body": "Thank you sir but Round is to round up the decimals to integer, do i understand it correctly?  If so, it does not fit the work I am trying to achieve.  I do have to thank you for providing this solution as it can be useful for other work I will be doing :)  Much appreciated."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1466774022, "last_edit_date": 1466774022, "creation_date": 1466610375, "answer_id": 37972797, "question_id": 37971186, "link": "https://stackoverflow.com/questions/37971186/how-to-run-calcuation-until-the-value-has-no-decimals-in-vba/37972797#37972797", "title": "How to run calcuation until the value has no decimals in VBA?", "body": "<p>From @aucuparia's comment, you could pick a random integer in the range the results in a three digit number when multiplied by 17, multiply it, and get a \"random\" three digit number that's divisible by 17.</p>\n\n<p>This code takes a divisor (17 in your case, but it can be integer). It determines the smallest number that when multiplied by the divisor results in a three digit number (lLower) and does the same for the largest number. Then it picks a random integer between those two numbers, multiplies it by 17, and returns the product.</p>\n\n<pre><code>Function RandomDivisible(ByVal lDivisor As Long) As Double\n\n    Dim lLower As Long, lUpper As Long\n    Dim i As Long\n\n    lLower = Round(100 / lDivisor + 0.4999, 0)\n    lUpper = Round(1000 / lDivisor - 0.4999, 0)\n\n    RandomDivisible = Int((lUpper - lLower + 1) * Rnd + lLower) * lDivisor\n\nEnd Function\n</code></pre>\n\n<p>Use as</p>\n\n<pre><code>=RandomDivisible(17)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6499788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2c979a8377245f1843e2d65b75e1fd4?s=128&d=identicon&r=PG&f=1", "display_name": "DChain", "link": "https://stackoverflow.com/users/6499788/dchain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 37971609, "answer_count": 3, "score": 0, "last_activity_date": 1466774022, "creation_date": 1466606079, "question_id": 37971186, "link": "https://stackoverflow.com/questions/37971186/how-to-run-calcuation-until-the-value-has-no-decimals-in-vba", "title": "How to run calcuation until the value has no decimals in VBA?", "body": "<p>I am new to VBA but i would like to create a VBA script that can run a calculation until the answer has no decimals. (NOTE: rounding is not what I am after though)</p>\n\n<p>For instance:\nI would like to generate 3-digit number that can be divided by a constant number, 17. However, I do not know the combinations. Therefore I scripted cell A1 to C1 with random function between 0-9.</p>\n\n<ul>\n<li>A1:C1 contains random numbers </li>\n<li>A3 has a formula of \"=sum(A1:C1) / 17\"</li>\n<li>*17 is a constant number</li>\n</ul>\n\n<p>If I want the calculation in cell A3 to run until the combination of numbers in A1:C1 that can be divided by constant number 17 in full; which there are no decimals.  (e.g. 170 / 17 = 10 which has no decimals. So, the value displayed in cell A1 to C1 would be 1, 7, 0; which is the answer) </p>\n\n<p>Is it possible to create a VBA script to perform this?</p>\n\n<p>Thank you. </p>\n"}, {"tags": ["excel", "vba", "search", "filter"], "comments": [{"owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "edited": false, "score": 0, "creation_date": 1466627739, "post_id": 37970984, "comment_id": 63401610, "body": "Do you want <code>mySearch</code> to be a string with the text from all four shapes?"}], "answers": [{"tags": [], "owner": {"reputation": 1185, "user_id": 3772845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ef979cb1d14448a779201e9cdf717cc?s=128&d=identicon&r=PG&f=1", "display_name": "TheEngineer", "link": "https://stackoverflow.com/users/3772845/theengineer"}, "is_accepted": true, "score": 0, "last_activity_date": 1520605049, "last_edit_date": 1520605049, "creation_date": 1466711836, "answer_id": 38000719, "question_id": 37970984, "link": "https://stackoverflow.com/questions/37970984/using-multiple-search-boxes-to-filter-2-tables-can-this-be-done-and-how/38000719#38000719", "title": "using multiple search boxes to filter 2 tables: can this be done and how?", "body": "<p>Try this:</p>\n\n<pre><code>'Filtered Data Range (include column heading cells)\n Set DataRange = sht.Range(\"A41:O72\") 'Cell Range\n\n'Retrieve User's Search Input\n mySearch = sht.Shapes(\"staff1\").TextFrame.Characters.Text 'Control Form\n mySearch = mySearch &amp; \" \" &amp; sht.Shapes(\"staff2\").TextFrame.Characters.Text\n mySearch = mySearch &amp; \" \" &amp; sht.Shapes(\"staff3\").TextFrame.Characters.Text\n mySearch = mySearch &amp; \" \" &amp; sht.Shapes(\"staff4\").TextFrame.Characters.Text\n</code></pre>\n\n<p>That will make <code>mysearch</code> a string with the text from all four shapes with a space between each.</p>\n"}], "owner": {"reputation": 59, "user_id": 6464610, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/23a820997a16d1ab38b5d58d0c9c1a2b?s=128&d=identicon&r=PG&f=1", "display_name": "SRag", "link": "https://stackoverflow.com/users/6464610/srag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 38000719, "answer_count": 1, "score": 0, "last_activity_date": 1520605049, "creation_date": 1466605572, "question_id": 37970984, "link": "https://stackoverflow.com/questions/37970984/using-multiple-search-boxes-to-filter-2-tables-can-this-be-done-and-how", "title": "using multiple search boxes to filter 2 tables: can this be done and how?", "body": "<p>I have two tables (ErrorSummary and VolumeSummary) that describe some variables for my entire team. The tables have the same number of rows, as each row header is the name of one employee. There are also some affiliated charts that are connected to the data.</p>\n\n<p>I want to create 4 search fields at the top of the sheet so that the user can compare the data for 4 employees at once. </p>\n\n<p>I tried to code this, but this is the line that is getting tripped up:</p>\n\n<pre><code>'Filtered Data Range (include column heading cells)\n Set DataRange = sht.Range(\"A41:O72\") 'Cell Range\n\n'Retrieve User's Search Input\n mySearch = sht.Shapes    (\"staff1\"\"staff2\"\"staff3\"\"staff4\").TextFrame.Characters.Text 'Control Form\n</code></pre>\n\n<p>^ the user search input line. I'm trying to get it to reference all the shapes one by one. Is this possible? </p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1466605706, "post_id": 37970886, "comment_id": 63388212, "body": "What do you mean by <b><code>it doesn&#39;t read in the number</code></b> ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1466605758, "post_id": 37970886, "comment_id": 63388256, "body": "You did notice you are reffering to <code>Cells(13, 15)</code> instead of <code>Cells(6, 15)</code> ?"}, {"owner": {"reputation": 1533, "user_id": 1681664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02d5ff49713c8d0600f8c450b35e34b1?s=128&d=identicon&r=PG", "display_name": "user1681664", "link": "https://stackoverflow.com/users/1681664/user1681664"}, "reply_to_user": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 0, "creation_date": 1466605865, "post_id": 37970886, "comment_id": 63388370, "body": "@ManishChristian When I debug it says that array1(I) = 0 instead of the actual value"}, {"owner": {"reputation": 1533, "user_id": 1681664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02d5ff49713c8d0600f8c450b35e34b1?s=128&d=identicon&r=PG", "display_name": "user1681664", "link": "https://stackoverflow.com/users/1681664/user1681664"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1466605883, "post_id": 37970886, "comment_id": 63388392, "body": "@ShaiRado I&#39;m sorry, that was a typo on my end. I meant O13"}, {"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1466606177, "post_id": 37970886, "comment_id": 63388635, "body": "Try <code>ReDim array1(1 To WS_Count)</code> and <code>Range(Cells(40, 1), Cells(40, 1 + WS_Count)) = array1</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1466605683, "creation_date": 1466605683, "answer_id": 37971028, "question_id": 37970886, "link": "https://stackoverflow.com/questions/37970886/simple-worksheet-loop-and-put-cell-value-into-vba-array/37971028#37971028", "title": "simple worksheet loop and put cell value into vba array", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196261.aspx\" rel=\"nofollow\"><code>WorksheetFunction.Transpose</code></a> method to transpose the array into the range you wish to output into.</p>\n\n<pre><code>Range(\"A40:A83\") = WorksheetFunction.Transpose(array1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1466605955, "creation_date": 1466605955, "answer_id": 37971140, "question_id": 37970886, "link": "https://stackoverflow.com/questions/37970886/simple-worksheet-loop-and-put-cell-value-into-vba-array/37971140#37971140", "title": "simple worksheet loop and put cell value into vba array", "body": "<p>This works by me:</p>\n\n<pre><code>Public Sub SWL()\n\n    Dim WS_Count    As Long\n    Dim I           As Long\n    Dim array1(43)  As String\n    Dim str         As String\n\n    WS_Count = ActiveWorkbook.Worksheets.Count\n\n    For I = 1 To WS_Count\n\n       array1(I) = ActiveWorkbook.Worksheets(I).Cells(1, 1).Value\n\n    Next I\n\n    str = CStr(Join(array1, \" \"))\n    ActiveWorkbook.Worksheets(1).Cells(1, 2) = str\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1533, "user_id": 1681664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02d5ff49713c8d0600f8c450b35e34b1?s=128&d=identicon&r=PG", "display_name": "user1681664", "link": "https://stackoverflow.com/users/1681664/user1681664"}, "edited": false, "score": 0, "creation_date": 1466606279, "post_id": 37971159, "comment_id": 63388724, "body": "Thank you so much. This worked perfect. VBA is so complicated. I come from matlab. Thank you again"}], "tags": [], "owner": {"reputation": 71, "user_id": 3294519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b612d78c9b8fe9bc918e61bd19bdb7b7?s=128&d=identicon&r=PG&f=1", "display_name": "Juanpablomo", "link": "https://stackoverflow.com/users/3294519/juanpablomo"}, "is_accepted": true, "score": 2, "last_activity_date": 1466606005, "creation_date": 1466606005, "answer_id": 37971159, "question_id": 37970886, "link": "https://stackoverflow.com/questions/37970886/simple-worksheet-loop-and-put-cell-value-into-vba-array/37971159#37971159", "title": "simple worksheet loop and put cell value into vba array", "body": "<p>You need start the array in 1 <code>Dim array1(1 to 43) As Double</code> and after set the range to put the array and use Transpose <code>Range(\"A40:A83\") = Application.Transpose(array1)</code></p>\n"}], "owner": {"reputation": 1533, "user_id": 1681664, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/02d5ff49713c8d0600f8c450b35e34b1?s=128&d=identicon&r=PG", "display_name": "user1681664", "link": "https://stackoverflow.com/users/1681664/user1681664"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 37971159, "answer_count": 3, "score": 1, "last_activity_date": 1466606005, "creation_date": 1466605324, "last_edit_date": 1466605822, "question_id": 37970886, "link": "https://stackoverflow.com/questions/37970886/simple-worksheet-loop-and-put-cell-value-into-vba-array", "title": "simple worksheet loop and put cell value into vba array", "body": "<p>I want to do a very simple program, but for some reason it is not working.\nI want to loop through every worksheet in my workbook and get the cell value of O13 and put it in an array. then print the entire array in 1 worksheet. For some reason, it doesn't read in the number. I tried setting the array to variant, integer, and double, nothing works.</p>\n\n<pre><code>     Dim WS_Count As Integer\n\n     Dim I As Integer\n\n     WS_Count = ActiveWorkbook.Worksheets.Count\n\n     Dim array1(43) As Double\n\n     For I = 1 To WS_Count\n\n        array1(I) = ActiveWorkbook.Worksheets(I).Cells(13, 15).Value\n\n     Next I\n\n     Range(\"A40\") = array1\n</code></pre>\n"}, {"tags": ["excel", "vba", "macros", "autofill"], "comments": [{"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 2, "creation_date": 1466604887, "post_id": 37970624, "comment_id": 63387444, "body": "It&#39;s not the code filling the cells which takes the time, it&#39;s the calculations being performed by the formulas. The only way to speed it up, would be to write a more efficient formula."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1466605096, "post_id": 37970624, "comment_id": 63387639, "body": "Switch off automatic calculation during the fill and reenable it after?"}, {"owner": {"reputation": 321, "user_id": 5594985, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2fddf1255905e7a24e43c436408bf294?s=128&d=identicon&r=PG&f=1", "display_name": "Istvan", "link": "https://stackoverflow.com/users/5594985/istvan"}, "edited": false, "score": 0, "creation_date": 1466663409, "post_id": 37970624, "comment_id": 63412500, "body": "Unfortunately, turning automatic calculation off and on after does not work either, because when it finishes, the columns are simply just empty, it does not fill in anything."}], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 5594985, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2fddf1255905e7a24e43c436408bf294?s=128&d=identicon&r=PG&f=1", "display_name": "Istvan", "link": "https://stackoverflow.com/users/5594985/istvan"}, "edited": false, "score": 0, "creation_date": 1466664606, "post_id": 37971413, "comment_id": 63413139, "body": "This works as well, but just as slow as my solutions :("}, {"owner": {"reputation": 71, "user_id": 3294519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b612d78c9b8fe9bc918e61bd19bdb7b7?s=128&d=identicon&r=PG&f=1", "display_name": "Juanpablomo", "link": "https://stackoverflow.com/users/3294519/juanpablomo"}, "reply_to_user": {"reputation": 321, "user_id": 5594985, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2fddf1255905e7a24e43c436408bf294?s=128&d=identicon&r=PG&f=1", "display_name": "Istvan", "link": "https://stackoverflow.com/users/5594985/istvan"}, "edited": false, "score": 0, "creation_date": 1466691704, "post_id": 37971413, "comment_id": 63432329, "body": "To reduce the time, use <code>Application.Calculation = xlCalculationManual</code> before run the code and  <code>Application.Calculation = xlCalculationAutomatic</code> after the code."}], "tags": [], "owner": {"reputation": 71, "user_id": 3294519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b612d78c9b8fe9bc918e61bd19bdb7b7?s=128&d=identicon&r=PG&f=1", "display_name": "Juanpablomo", "link": "https://stackoverflow.com/users/3294519/juanpablomo"}, "is_accepted": false, "score": 0, "last_activity_date": 1466607049, "last_edit_date": 1466607049, "creation_date": 1466606686, "answer_id": 37971413, "question_id": 37970624, "link": "https://stackoverflow.com/questions/37970624/vba-autofill-speed-issue/37971413#37971413", "title": "VBA AutoFill Speed Issue", "body": "<pre><code>program.Worksheets(\"Data\").Activate\nRange(\"X2:AC\").AutoFill Destination:=Range(\"X2:AC\" &amp; LastRow)\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 5594985, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2fddf1255905e7a24e43c436408bf294?s=128&d=identicon&r=PG&f=1", "display_name": "Istvan", "link": "https://stackoverflow.com/users/5594985/istvan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1076, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466607049, "creation_date": 1466604742, "question_id": 37970624, "link": "https://stackoverflow.com/questions/37970624/vba-autofill-speed-issue", "title": "VBA AutoFill Speed Issue", "body": "<p>I have this piece of code which copies the formula from one cell down the column and is incredibly slow (15 minutes for a 10 thousand row sheet). The code is: <code>program.Worksheets(\"Data\").Range(\"X2:AC2\").AutoFill program.Worksheets(\"Data\").Range(\"X2:AC\" &amp; LastRow)</code></p>\n\n<p>I have also tried putting <code>.AutoFill Destination</code> in, didn't solve the issue. I am using a <code>With Worksheets(\"Data\")</code>, but still does not work. I also tried to insert the formulas manually, that did not work either (at all). \nAny suggestions about how could it be faster?\nThanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "edited": false, "score": 3, "creation_date": 1466604685, "post_id": 37970550, "comment_id": 63387270, "body": "Let me <a href=\"https://www.google.com/search?q=excel+vba+timer&amp;oq=excel+vba+timer&amp;aqs=chrome..69i57j0l5.7041j0j4&amp;sourceid=chrome&amp;es_sm=122&amp;ie=UTF-8\" rel=\"nofollow noreferrer\"><b>Google</b></a> that for you."}], "answers": [{"comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 1, "creation_date": 1466608187, "post_id": 37970650, "comment_id": 63390181, "body": "If this answer helped you please consider <a href=\"http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">accepting it</a>.  This will reward @Dave for his effort and help others with the same problem to find the correct answer."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 4, "last_activity_date": 1466604785, "creation_date": 1466604785, "answer_id": 37970650, "question_id": 37970550, "link": "https://stackoverflow.com/questions/37970550/how-do-i-include-a-timer-from-start-to-finish-of-the-sub-each-call-is-a-separat/37970650#37970650", "title": "How do I include a timer from start to finish of the sub? Each call is a separate sub", "body": "<p>Record the start time, figure the elapsed time between the end and the recorded start time...</p>\n\n<pre><code>Sub ComparisonTemplate()\n    Dim startTime : startTime = Now()\n    Call WbtoWb2\n    Call WbtoWb3\n    Call WbtoWb4\n    Call WbtoWb5\n    Call WbtoWb6\n    Call WbtoWb7\n    Call WbtoWb8\n    Call WbtoWb9\n    Call WbtoWb10\n    MsgBox \"Finished in \" &amp; DateDiff(\"s\", startTime, Now()) &amp; \" seconds.\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6496121, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12e1780a2235d4efa72aef740fedfb28?s=128&d=identicon&r=PG&f=1", "display_name": "JHags", "link": "https://stackoverflow.com/users/6496121/jhags"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466604785, "creation_date": 1466604567, "question_id": 37970550, "link": "https://stackoverflow.com/questions/37970550/how-do-i-include-a-timer-from-start-to-finish-of-the-sub-each-call-is-a-separat", "title": "How do I include a timer from start to finish of the sub? Each call is a separate sub", "body": "<p>I need the timer function included to compute the total time it takes to run the macro from WbtoWb2 to WbtoWb10...what code would be needed to include?</p>\n\n<pre><code> Sub ComparisonTemplate()\n    Call WbtoWb2\n    Call WbtoWb3\n    Call WbtoWb4\n    Call WbtoWb5\n    Call WbtoWb6\n    Call WbtoWb7\n    Call WbtoWb8\n    Call WbtoWb9\n    Call WbtoWb10\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter", "sumifs", "accounting"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6496758, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0216D3-GTd0/AAAAAAAAAAI/AAAAAAAAYC0/Dq8IeUPWxZ8/photo.jpg?sz=128", "display_name": "Tato Mamardashvili", "link": "https://stackoverflow.com/users/6496758/tato-mamardashvili"}, "is_accepted": false, "score": 0, "last_activity_date": 1466614299, "last_edit_date": 1466614299, "creation_date": 1466605023, "answer_id": 37970742, "question_id": 37970540, "link": "https://stackoverflow.com/questions/37970540/sum-a-list-of-account-balances-excluding-a-specific-range-of-accounts/37970742#37970742", "title": "SUM a list of account balances excluding a specific range of accounts", "body": "<p>first write in <strong>J2</strong>:  </p>\n\n<pre><code>=iferror(vlookup(F2,K:K,1,false),1)\n</code></pre>\n\n<p>Then copy this formula till the end of table.</p>\n\n<p>After that in cell where you want to sum, put following  </p>\n\n<pre><code>=sumif(J:J,\"1\",H:H)\n</code></pre>\n\n<p>Hope this will help you</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1466606411, "last_edit_date": 1466606411, "creation_date": 1466605352, "answer_id": 37970896, "question_id": 37970540, "link": "https://stackoverflow.com/questions/37970540/sum-a-list-of-account-balances-excluding-a-specific-range-of-accounts/37970896#37970896", "title": "SUM a list of account balances excluding a specific range of accounts", "body": "<p>You could use an array, data in A:B and exclusions in e1:e3</p>\n\n<p><code>=SUM((ISERROR(MATCH($A$1:$A$4000,$E$1:$E$3,0)))*($B$1:$B$4000))</code></p>\n\n<p>This will give you the total sum - exclusions\n and this will be for certain accounts in column J</p>\n\n<p><code>=SUM(($A$1:$A$4000=$J4)*(ISERROR(MATCH($A$1:$A$4000,$E$1:$E$3,0)))*($B$1:$B$4000))</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 6436385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a89891eff29e4a3b45c2267869796d?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6436385/brad"}, "edited": false, "score": 0, "creation_date": 1466611927, "post_id": 37971964, "comment_id": 63392815, "body": "This works great. Except I wasn&#39;t specific enough. Instead of having it take the total sum of everything, how can I have it sum on every change in plant number (Column E). To clarify...the exclusion of certain accounts works but instead of having it sum everything I would want to get the sum for every change in plant # column E."}, {"owner": {"reputation": 561, "user_id": 6351010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ConsW4crsu8/AAAAAAAAAAI/AAAAAAAAABQ/wVNl0DBDJpc/photo.jpg?sz=128", "display_name": "Elnur Ibrahim-zade", "link": "https://stackoverflow.com/users/6351010/elnur-ibrahim-zade"}, "reply_to_user": {"reputation": 1, "user_id": 6436385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a89891eff29e4a3b45c2267869796d?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6436385/brad"}, "edited": false, "score": 0, "creation_date": 1466627665, "post_id": 37971964, "comment_id": 63401586, "body": "Could you show me Column E? and be more clear ? Please first of all add some visualization of your table."}, {"owner": {"reputation": 1, "user_id": 6436385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a89891eff29e4a3b45c2267869796d?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6436385/brad"}, "edited": false, "score": 0, "creation_date": 1466628065, "post_id": 37971964, "comment_id": 63401745, "body": "I added an updated screenshot. I will try to explain more clearly sorry I am new. The array formula you gave works but it sums all the columns in the worksheet. What I want is to do the samething but provide the sum of every profit centre (column A). For example: I would want the sum of profit centre 64010 accounts excluding the specified accounts in column G. Then I want the samething for only profit centre 64011 so on and so forth."}], "tags": [], "owner": {"reputation": 561, "user_id": 6351010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ConsW4crsu8/AAAAAAAAAAI/AAAAAAAAABQ/wVNl0DBDJpc/photo.jpg?sz=128", "display_name": "Elnur Ibrahim-zade", "link": "https://stackoverflow.com/users/6351010/elnur-ibrahim-zade"}, "is_accepted": false, "score": 1, "last_activity_date": 1466628777, "last_edit_date": 1466628777, "creation_date": 1466608166, "answer_id": 37971964, "question_id": 37970540, "link": "https://stackoverflow.com/questions/37970540/sum-a-list-of-account-balances-excluding-a-specific-range-of-accounts/37971964#37971964", "title": "SUM a list of account balances excluding a specific range of accounts", "body": "<p>Use this formula as array formula. Press <strong>CTRL+SHIFT+ENTER</strong> after you enter formula.</p>\n\n<pre><code>=SUM(IF(A2:A25=H13,IF(ISERROR(MATCH(B2:B25,F2:F5,0)),C2:C25,0),0))\nColumn A - Your profit centers\nColumn B - Your accounts\nColumn C - Amounts to sum\nColumn F - Accounts you want to exclude\nCell H13 - Profit center that you want to sum up\n</code></pre>\n\n<p>Note: After each time you edit formula press <strong>CTRL+SHIFT+ENTER</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1466632081, "creation_date": 1466632081, "answer_id": 37978840, "question_id": 37970540, "link": "https://stackoverflow.com/questions/37970540/sum-a-list-of-account-balances-excluding-a-specific-range-of-accounts/37978840#37978840", "title": "SUM a list of account balances excluding a specific range of accounts", "body": "<p>Consider an aggregate SQL query which can be run within Excel using the Jet/ACE SQL Engine (Windows .dll files), assuming you use Excel for PC. With SQL you can filter according to <code>Account number</code> and group by <code>Profit Center</code>. No arrays or loops needed.</p>\n\n<p>For your needs, you can select regions inside a worksheet to be used as tables. Be sure to add column headers and reference in SQL statement accordingly. Main columns will be main table and the do not include as the subquery table. Below setup queries data in worksheet named <em>DATA</em> and outputs results in empty worksheet named <em>EMPTY</em>.</p>\n\n<p><strong>SQL</strong> <em>(embedded below in VBA as string)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT d.[Profit Center], Sum(d.Amount) As [Sum Amount]\nFROM [DATA$A:D] d\nWHERE NOT EXISTS (SELECT 1 FROM [DATA$I:J] sub\n                  WHERE sub.[DNI_Account number] = d.[Account number])\nGROUP BY d.[Profit Center]\n</code></pre>\n\n<p><strong>VBA</strong> </p>\n\n<pre><code>Public Sub RunSQL()\n    Dim conn As Object, rst As Object, fld As Object\n    Dim strConnection As String, strSQL As String\n    Dim i As Integer: i = 0\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rst = CreateObject(\"ADODB.Recordset\")\n\n    strConnection = \"DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};\" _\n                          &amp; \"DBQ=C:\\Path\\To\\Workbook.xlsm;\"\n    strSQL = \" SELECT d.[Profit Center], Sum(d.Amount) As [Sum Amount]\" _\n                &amp; \" FROM [DATA$A:D] d \" _\n                &amp; \" WHERE NOT EXISTS (SELECT 1 FROM [DATA$G:H] sub\" _\n                &amp; \"              WHERE sub.[Account number] = d.[Account number])\" _\n                &amp; \" GROUP BY d.[Profit Center]\"\n\n    ' OPEN DB CONNECTION AND RECORDSET\n    conn.Open strConnection\n    rst.Open strSQL, conn\n\n    Worksheets(\"RESULTS\").Activate\n    Worksheets(\"RESULTS\").Range(\"A1\").Activate\n\n    ' COLUMN HEADERS\n    For Each fld In rst.Fields\n        ActiveCell.Offset(0, i) = fld.Name\n        i = i + 1\n    Next fld\n\n    ' DATA ROWS\n    Worksheets(\"RESULTS\").Range(\"A2\").CopyFromRecordset rst\n\n    rst.Close\n    conn.Close\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12117093, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219777296803865/picture?type=large", "display_name": "Asaf Bentulila", "link": "https://stackoverflow.com/users/12117093/asaf-bentulila"}, "is_accepted": false, "score": 0, "last_activity_date": 1569393030, "creation_date": 1569393030, "answer_id": 58092338, "question_id": 37970540, "link": "https://stackoverflow.com/questions/37970540/sum-a-list-of-account-balances-excluding-a-specific-range-of-accounts/58092338#58092338", "title": "SUM a list of account balances excluding a specific range of accounts", "body": "<p>i think i have a much better solution,\nyou can do vlookup to the list of values you want to exclude, and near to each line of the column you do want to sum just put some kind of marking to (as yes\\no) than in the sumifs function just add 1 condition \"from column x:x take only the values marked with \"yes\" and this it,\nworked fine for me</p>\n"}], "owner": {"reputation": 1, "user_id": 6436385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0a89891eff29e4a3b45c2267869796d?s=128&d=identicon&r=PG&f=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/6436385/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1569393030, "creation_date": 1466604544, "last_edit_date": 1466628014, "question_id": 37970540, "link": "https://stackoverflow.com/questions/37970540/sum-a-list-of-account-balances-excluding-a-specific-range-of-accounts", "title": "SUM a list of account balances excluding a specific range of accounts", "body": "<p>How would I sum a large amount of GL accounts (4,000 lines about 100 unique accounts) while excluding a specific range of accounts (about 40 unique accounts).</p>\n\n<p>I want to be able to do this without manually writing out \"&lt;> XXX\" 40 times for each account. Ideally I have a table of the accounts I want to not include in the sum that is referenced. </p>\n\n<p>Screenshot of values I want to sum in Column H, based off accounts in Column  F while excluding the accounts in Column K.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BqobD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BqobD.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><img src=\"https://i.stack.imgur.com/l0P3Y.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466604645, "post_id": 37970491, "comment_id": 63387238, "body": "Where/how are the URLs stored? In a single cell? I one row or one column? Is Chrome closed when you run your code?"}, {"owner": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466608676, "post_id": 37970491, "comment_id": 63390523, "body": "Each hyperlink is stored in a single cell, for example hyperlink 1 is in cell A1 hyperlink 2 cell A2 and so on... chrome is open"}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "edited": false, "score": 0, "creation_date": 1466717137, "post_id": 37998916, "comment_id": 63448340, "body": "Nope still not opening them in order I wonder if what I&#39;m trying to do is possible I tried <code>Application.Wait Now() + TimeValue(&quot;00:00:01&quot;)</code> but still same behaviour"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1466705501, "last_edit_date": 1495542778, "creation_date": 1466705501, "answer_id": 37998916, "question_id": 37970491, "link": "https://stackoverflow.com/questions/37970491/how-to-open-hyperlinks-in-excel-in-order-using-chrome/37998916#37998916", "title": "How to open hyperlinks in excel in order using chrome", "body": "<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Don't use <code>.Select</code></a>, as it can cause issues.  </p>\n\n<p>Does this work for you?</p>\n\n<pre><code>Sub Open_HyperLinks()\nDim chromePath As String, hl As Hyperlink\nDim rng As Range, visRng As Range\n\nchromePath = Environ(\"PROGRAMFILES(X86)\") &amp; \"\\Google\\Chrome\\Application\\chrome.exe\"\n\nSet rng = Selection\n\nIf rng.Count &gt; 1 Then\n    Set visRng = rng.SpecialCells(xlCellTypeVisible)\nEnd If\n'On Error Resume Next\nFor Each hl In visRng.Hyperlinks\n\n    Shell chromePath &amp; \" -url \" &amp; hl.Address\nNext hl\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 3822027, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/dcef5e4ca84d2f9df03b342d802b70f4?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Ruiz", "link": "https://stackoverflow.com/users/3822027/tom-ruiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1607, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466705501, "creation_date": 1466604422, "question_id": 37970491, "link": "https://stackoverflow.com/questions/37970491/how-to-open-hyperlinks-in-excel-in-order-using-chrome", "title": "How to open hyperlinks in excel in order using chrome", "body": "<p>I have a code to open hyperlinks from an excel sheet in chrome. it works just fine, however I have noticed a strange behavior, it opens the hyperlinks not in from up t down order but using some criteria I don't understand it's not randomly because when testing I noticed it always opened the links in tha same order i.e</p>\n\n<p>Hyperlink 1\nHyperlink 2\nHyperlink 3\nHyperlink 4\nHyperlink 5</p>\n\n<p>It would always open </p>\n\n<p>Hyperlink 2 Hyperlink 1 Hyperlink 3 Hyperlink 4 Hyperlink 5</p>\n\n<p>Everytime I ran the code it open them in that order I need it to open the hyperlinks in a top to bottom order. Here is the code</p>\n\n<pre><code>Sub Open_HyperLinks()\n    Dim chromePath As String, hl As Hyperlink\n\n    chromePath = Environ(\"PROGRAMFILES(X86)\") &amp; \"\\Google\\Chrome\\Application\\chrome.exe\"\n If Selection.Count &gt; 1 Then\n    Selection.SpecialCells(xlCellTypeVisible).Select\n End If\n    'On Error Resume Next\n    For Each hl In Selection.Hyperlinks\n        Shell chromePath &amp; \" -url \" &amp; hl.Address\n      Next hl\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba"], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 7023632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e524dc1322d404b13ab1fdcf0fe0383?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertLau14100", "link": "https://stackoverflow.com/users/7023632/albertlau14100"}, "is_accepted": false, "score": 2, "last_activity_date": 1476556724, "last_edit_date": 1476556724, "creation_date": 1476546537, "answer_id": 40061098, "question_id": 37970485, "link": "https://stackoverflow.com/questions/37970485/vba-handling-data-in-document-object-model/40061098#40061098", "title": "VBA: handling data in Document Object Model", "body": "<p>Try the below change which will solve your issue. In brief, you will need to treat the <code>allRowofData</code> as a collection.</p>\n\n<pre><code>myValue = allRowOfData(0).Cells(1).innerHTML\n</code></pre>\n"}], "owner": {"reputation": 2971, "user_id": 1584009, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/76984cfe5803365e2c41a8765137636a?s=128&d=identicon&r=PG", "display_name": "Lisa Ann", "link": "https://stackoverflow.com/users/1584009/lisa-ann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1476556724, "creation_date": 1466604410, "last_edit_date": 1495535401, "question_id": 37970485, "link": "https://stackoverflow.com/questions/37970485/vba-handling-data-in-document-object-model", "title": "VBA: handling data in Document Object Model", "body": "<p>I am currently trying to scrap data from a website using VBA. I am following <a href=\"https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\">this</a> tutorial and hence my code is the following one:</p>\n\n<pre><code>Sub Foo()\n\n    Dim appIE As Object\n    Set appIE = CreateObject(\"internetexplorer.application\")\n\n    With appIE\n        .Navigate \"https://www.ishares.com/it/investitore-privato/it/prodotti/251843/ishares-euro-high-yield-corporate-bond-ucits-etf\"\n        .Visible = True\n    End With\n\n    Do While appIE.Busy\n        DoEvents\n    Loop\n\n    Set allRowOfData = appIE.document.getElementsByClassName(\"visible-data totalNetAssets\")\n    Dim myValue As String\n    myValue = allRowOfData.Cells(1).innerHTML\n    MsgBox myValue\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunately there are some differences between data I want to scrap and those ones used in the example: this line</p>\n\n<pre><code>myValue = allRowOfData.Cells(1).innerHTML\n</code></pre>\n\n<p>is wrong according to VBA debug.</p>\n\n<p>Anyone could provide me with some explanations about why that doesn't work and how am I supposed to pick the right method to scrap HTML pages?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466606258, "post_id": 37970471, "comment_id": 63388701, "body": "You have <code>ActiveDocument.ToggleFormsDesign</code> twice here... does the code stop after the first one, skipping <code>ThisDocument.cmdFormPreencher.Select</code> and <code>.Delete</code>, or does it stop after the second one, skipping <code>UserForm2.Show</code>?"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1466606415, "post_id": 37970471, "comment_id": 63388839, "body": "@Mat&#39;sMug After the first one"}], "answers": [{"comments": [{"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466620687, "post_id": 37974069, "comment_id": 63397995, "body": "Yes it is an ActiveX button. The part of figuring out the number of the InlineShape is the problem now... I read in another post that InlineShapes are listed in Selection Panel, but even I access it the ActiveX button is not showed there... Is there another way to discover it?"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466621036, "post_id": 37974069, "comment_id": 63398173, "body": "I tried to assign the inlineShape as number 1: Set inlineShape = ActiveDocument.InlineShapes(1) but I get error 5941 &quot;The requested members of colection does not exist&quot;"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466623905, "post_id": 37974069, "comment_id": 63399669, "body": "Are you sure it&#39;s an InlineShape and not a Shape? Graphically, is it formatted with text wrap or as inline? It&#39;s not in a Header, Footer or anything else by any chance?"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466628024, "post_id": 37974069, "comment_id": 63401724, "body": "In Wrap Text it is set as In Front Of Text"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466628205, "post_id": 37974069, "comment_id": 63401822, "body": "No, it isn&#39;t in header or in footer"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466628452, "post_id": 37974069, "comment_id": 63401938, "body": "Then it&#39;s a Shape, not an InlineShape."}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466629507, "post_id": 37974069, "comment_id": 63402443, "body": "I just edited my question, with the code returned when I recorded a macro. But even the macro doesn&#39;t work..."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1466696975, "post_id": 37974069, "comment_id": 63436387, "body": "No, of course it doesn&#39;t work because, as I state, you can&#39;t run code when Design Mode is activated. See my edited response."}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1467050959, "post_id": 37974069, "comment_id": 63559818, "body": "Man, you&#39;re great! After following your answer the code runs fine! The only thing I did was substitute the name  for &quot;Control 52&quot; from the recorded Macro (as you said, MS Word changed the name to &quot;Control 52&quot;), because this document is shared with others in my office, they don&#39;t need to know to go in Visual Basic and to assign the name to this commandButton"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "edited": false, "score": 0, "creation_date": 1467051383, "post_id": 37974069, "comment_id": 63560062, "body": "The only thing is the document doesn&#39;t retain the VBA Code (I&#39;m working in a Macro Template Document), and the documents based on this template shows the Button but doesn&#39;t have any code. Is there something I can do to have a Template and the other users in my office create documents and run the code?"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1466696917, "last_edit_date": 1466696917, "creation_date": 1466614213, "answer_id": 37974069, "question_id": 37970471, "link": "https://stackoverflow.com/questions/37970471/vba-code-not-running-after-toggleformsdesign/37974069#37974069", "title": "VBA: Code not running after ToggleFormsDesign", "body": "<p>This is by design. When an Office application is in Design Mode code should not run on an ActiveX object that's part of the document.</p>\n\n<p>I take it this is an ActiveX button and in that case, it's a member of the InlineShapes or Shapes collection - Word handles it like a graphic object. It should be enough to delete the graphical representation, which you can do by changing it to display as an icon instead of a button.</p>\n\n<p>For example, for an InlineShape:</p>\n\n<pre><code>Sub DeleteActiveX()\n  Dim ils As word.InlineShape\n\n  Set ils = ActiveDocument.InlineShapes(1)\n  ils.OLEFormat.DisplayAsIcon = True\n  ils.Delete\nEnd Sub\n</code></pre>\n\n<p>You just have to figure out how to identify the InlineShape or Shape. You could bookmark an InlineShape; a Shape has a Name property.</p>\n\n<p>EDIT: Since according to subsequent information provided in Comments you have a Shape object, rather than an InlineShape, the following approach should work:</p>\n\n<pre><code>Dim shp As word.Shape\n\nSet shp = ActiveDocument.Shapes(\"Shape Name\") 'Index value can also be used\nshp.Delete\n</code></pre>\n\n<p>Note that Word will automatically assign something to the <code>Shape.Name</code> property, but in the case of ActiveX controls these names can change for <em>apparently</em> no reason. So if you identify a control using its name instead of the index value it's much better to assign a name yourself, which Word will not change \"on a whim\". </p>\n\n<ol>\n<li>Activate Design Mode.</li>\n<li>Click on the control to select it</li>\n<li>Go to the VB Editor window</li>\n<li>Ctrl+G to put the focus in the \"Immediate Window\"</li>\n<li><p>Type the following (substituting the name you want), then press Enter to execute:</p>\n\n<p>Selection.ShapeRange(1).Name = \"Name to assign\"</p></li>\n<li><p>Use this <code>Name</code> in the code above</p></li>\n</ol>\n"}], "owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 37974069, "answer_count": 1, "score": 0, "last_activity_date": 1466696917, "creation_date": 1466604382, "last_edit_date": 1466689172, "question_id": 37970471, "link": "https://stackoverflow.com/questions/37970471/vba-code-not-running-after-toggleformsdesign", "title": "VBA: Code not running after ToggleFormsDesign", "body": "<p>I have the following code in VBA (MS Word), that is meant to run after I click in a button, named <em>cmdFormPreencher</em> inserted in my Document:</p>\n\n<pre><code>Private Sub cmdFormPreencher_Click()\n'\nIf ActiveDocument.FormsDesign = False Then\n    ActiveDocument.ToggleFormsDesign\nEnd If\n'\nThisDocument.cmdFormPreencher.Select\nThisDocument.cmdFormPreencher.Delete\n\nActiveDocument.ToggleFormsDesign\n\n'\nUserForm2.Show\nEnd Sub\n</code></pre>\n\n<p>The purpose of the code above is to delete that button inserted in my document.\nBut when I run the code only the button is selected. When I tried to figure out what is happening by debugging, it showed me the code runs until <code>ActiveDocument.ToggleFormsDesign</code> and not running the code remaining</p>\n\n<p>Is this a bug of VBA, or am I doing something wrong? If so, how can I get around this problem?</p>\n\n<p>Thanks!</p>\n\n<p><strong>Note</strong>: The ActiveX button is not in Header and Footer. The Text Wrap is set to <em>In Front of Text</em></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>When I try to run a macro, activating FormDesign, Selecting the ActiveX button and then deleting, I get this code:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n'\n    ActiveDocument.ToggleFormsDesign\n    ActiveDocument.Shapes(\"Control 52\").Select\n    Selection.ShapeRange.Delete\n    ActiveDocument.ToggleFormsDesign\nEnd Sub\n</code></pre>\n\n<p>But when I run this code nothing happens...</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466603150, "post_id": 37969974, "comment_id": 63385798, "body": "I have Dimed WS_Temp as Worksheet and Selected_Range As Range earlier.. FYI"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 2, "creation_date": 1466603286, "post_id": 37969974, "comment_id": 63385923, "body": "Can you try taking off the <code>.Value</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1466603389, "post_id": 37969974, "comment_id": 63386045, "body": "<a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">Don&#39;t use <code>.Select</code></a>, that&#39;s likely part of it. Also, don&#39;t use <code>Value</code> at the end. You just set the <code>Range()</code>, then if you need the value of the range, do <code>Selected_Range.Value</code>."}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466603405, "post_id": 37969974, "comment_id": 63386065, "body": "When I do that I get &quot;Run-Time error &#39;381&#39; Could not set the Column property. Invalid property array index.&quot;"}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466603547, "post_id": 37969974, "comment_id": 63386210, "body": "I have also tried the lined commented out I just posted. None of which worked"}, {"owner": {"reputation": 2503, "user_id": 6408573, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/642b728886504bd0f8139083a2b0e3b6?s=128&d=identicon&r=PG&f=1", "display_name": "RGA", "link": "https://stackoverflow.com/users/6408573/rga"}, "edited": false, "score": 0, "creation_date": 1466603786, "post_id": 37969974, "comment_id": 63386444, "body": "Can you rephrase what you are trying to accomplish?"}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466604182, "post_id": 37969974, "comment_id": 63386824, "body": "I have successfully taken an array and placed it where I want in a newly created ws. I have also taken a range and placed it in the worksheet where I want it. I know that this much works. Now I want to take all of the data on that sheet (which will be a dynamic range - sometimes more columns/ sometimes more rows) and set it to a variable name for use later."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466604242, "post_id": 37969974, "comment_id": 63386874, "body": "what is Selected_Range, a range or an array? if an array, try removing the set, if a range, try removing the value."}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466604253, "post_id": 37969974, "comment_id": 63386888, "body": "Ultimately, later one I will use .Columns to set a ListBox equal to this variable name to populate the data into the listbox"}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466604287, "post_id": 37969974, "comment_id": 63386924, "body": "I dimed Selected_Range as a range."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466604483, "post_id": 37970400, "comment_id": 63387105, "body": "I get Run-Time error &#39;381&#39; Could not set the Column property. Invalid property array index"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466604621, "post_id": 37970400, "comment_id": 63387219, "body": "@Liz no repro here, perhaps <code>Selection</code> needs to be validated first? works fine here. <code>Range</code> is a parameterized <code>Property Get</code> member of <code>Worksheet</code>; getting that error means you&#39;re giving it invalid parameters. Verify that <code>Selection</code> is in the <code>WS_Temp</code> sheet."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466605017, "post_id": 37970400, "comment_id": 63387566, "body": "*assuming you&#39;re getting that error on that specific line. Avoid problems, avoid working with <code>Selection</code>, see the linked post @BruceWayne gave you."}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466605546, "post_id": 37970400, "comment_id": 63388041, "body": "I am getting this error later on in my code.  I will include more of my code above"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466605711, "post_id": 37970400, "comment_id": 63388216, "body": "@Liz ok, so the specific issue you asked about in this question is fixed, right? This is a Q&amp;A site, not a discussion forum. People will google &quot;vba object required&quot; and land here and find what they&#39;re looking for. Please don&#39;t edit your question to add new problems every time one gets answered, that&#39;s not how this site works. Chameleon questions are very much frowned upon. Thank you."}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466605872, "post_id": 37970400, "comment_id": 63388376, "body": "I understand... very new to vba and this site. I will return it to it&#39;s original version."}, {"owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "edited": false, "score": 0, "creation_date": 1466605983, "post_id": 37970400, "comment_id": 63388485, "body": "Thank you all for your help!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1466604196, "last_edit_date": 1495541773, "creation_date": 1466604196, "answer_id": 37970400, "question_id": 37969974, "link": "https://stackoverflow.com/questions/37969974/excel-vba-object-required-error/37970400#37970400", "title": "Excel VBA Object Required Error", "body": "<blockquote>\n  <p><a href=\"https://stackoverflow.com/questions/37969974/excel-vba-object-required-error#comment63385923_37969974\">Can you try taking off the .Value? \u2013 Matt Cremeens</a></p>\n</blockquote>\n\n<p>The <code>Set</code> keyword is used to assign <em>object references</em>. Using it to assign <em>values</em> throws the error you're getting, \"Object required\".</p>\n\n<p>And that's exactly what you're doing here:</p>\n\n<pre><code>Set Selected_Range = WS_Temp.Range(Selection, Selection.SpecialCells(xlLastCell)).Value\n</code></pre>\n\n<p>You're trying to assign the <code>Selected_Range</code> object <em>the value of</em> <code>WS_Temp.Range(...)</code>, which you cannot do legally. Remove <code>.Value</code> and you will assign <code>Selected_Range</code> a <em>reference</em> pointing to a <code>Range</code> object returned by that <code>Range</code> call on your <code>WS_Temp</code> sheet.</p>\n"}], "owner": {"reputation": 117, "user_id": 6490774, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0007af80f208740bdd22aa970131b468?s=128&d=identicon&r=PG&f=1", "display_name": "Liz ", "link": "https://stackoverflow.com/users/6490774/liz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6131, "favorite_count": 0, "accepted_answer_id": 37970400, "answer_count": 1, "score": 1, "last_activity_date": 1466605654, "creation_date": 1466603110, "last_edit_date": 1466605654, "question_id": 37969974, "link": "https://stackoverflow.com/questions/37969974/excel-vba-object-required-error", "title": "Excel VBA Object Required Error", "body": "<p>I have been looking at this code and can't seem to figure out why I keep getting an object required error. I am trying to add a new sheet, place and array and range in the sheet (this works). Next I want to name all of the cells on the sheet a variable name to be used later. Can anyone see why it's not working? </p>\n\n<pre><code>    Set WS_Temp = Sheets.Add\nWith WS_Temp\n    .Range(Cells(1, 1), Cells(1, LastColRA)) = Sheet1.Range(\"Dynamic_Range\").Value\n    .Range(Cells(2, 1), Cells(counter + 1, LastColRA)) = Application.Transpose(vList)\n    '.Range(Cells(1, 1), Cells(counter + 1, LastColRA)) = Selected_Range\n    '.Range(Selection, Selection.SpecialCells(xlLastCell)).Select = Selected_Range\nEnd With\n\nSet Selected_Range = WS_Temp.Range(Selection, Selection.SpecialCells(xlLastCell)).Value ***ERRORS HERE \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6494867, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fb9211573476c42a65b8b08d3836a372?s=128&d=identicon&r=PG&f=1", "display_name": "E. Weglarz", "link": "https://stackoverflow.com/users/6494867/e-weglarz"}, "edited": false, "score": 0, "creation_date": 1466604745, "post_id": 37970007, "comment_id": 63387326, "body": "Excellent suggestion, I&#39;ve made progress but got hung up at the following error: Method&#39;Range&quot; of Object&#39;_Global&#39; Failed. Do you have any insight as to why im arriving at that error?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "reply_to_user": {"reputation": 37, "user_id": 6494867, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fb9211573476c42a65b8b08d3836a372?s=128&d=identicon&r=PG&f=1", "display_name": "E. Weglarz", "link": "https://stackoverflow.com/users/6494867/e-weglarz"}, "edited": false, "score": 0, "creation_date": 1466605143, "post_id": 37970007, "comment_id": 63387686, "body": "woops! my bad range is not needed there, check my updated answer"}, {"owner": {"reputation": 37, "user_id": 6494867, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fb9211573476c42a65b8b08d3836a372?s=128&d=identicon&r=PG&f=1", "display_name": "E. Weglarz", "link": "https://stackoverflow.com/users/6494867/e-weglarz"}, "edited": false, "score": 0, "creation_date": 1466605787, "post_id": 37970007, "comment_id": 63388294, "body": "No worries!! Im still having struggles of my own, heres what I have, but is still giving me some issues: IE.navigate &quot;<a href=\"http://www.website.com\" rel=\"nofollow noreferrer\">website.com</a> /sub/directory/ &amp; Format (Cells(1,1).Value, \u201cdd/MM/yyyy\u201d) &amp; /subdirectory/file.txt&quot;"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 1, "creation_date": 1466606488, "post_id": 37970007, "comment_id": 63388908, "body": "If what&#39;s in your comment is whats actually in your code you are missing some closing quotes. <code>IE.navigate &quot;website.com &#47;sub&#47;directory&#47;&quot; &amp; Format (Cells(1,1).Value, \u201cdd&#47;MM&#47;yyyy\u201d) &amp; &quot;&#47;subdirectory&#47;file.txt&quot;</code>"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466607119, "post_id": 37970007, "comment_id": 63389387, "body": "Why would you need to change the format from <code>yyyymmdd</code>?  The question doesn&#39;t seem to call for that as far as I can see, and changing that format could potentially affect the end URL because of the backslashes in the date format?"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466607222, "post_id": 37970007, "comment_id": 63389462, "body": "This is just an example to show how format works (you&#39;d need to change for: &amp; Format (Cells(1,1).Value, \u201cyyyymmdd\u201d) only or for &amp; Format (Cells(1,1).Value, \u201cyyyy\u201d)  &amp; Format (Cells(1,1).Value, \u201cmm\u201d)  ... -and if this approach suit him-"}, {"owner": {"reputation": 37, "user_id": 6494867, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fb9211573476c42a65b8b08d3836a372?s=128&d=identicon&r=PG&f=1", "display_name": "E. Weglarz", "link": "https://stackoverflow.com/users/6494867/e-weglarz"}, "edited": false, "score": 0, "creation_date": 1466607616, "post_id": 37970007, "comment_id": 63389774, "body": "This is baffling, usually I get the result after some help! I apologize for my directory changes, my internship&#39;s protocols on what we can share are strict. My reference cell is A1 in the sheet, and is labelled 6/20/2016. This is my code with the added quotes, still no luck changing the date on the URL when I run the script:"}, {"owner": {"reputation": 37, "user_id": 6494867, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fb9211573476c42a65b8b08d3836a372?s=128&d=identicon&r=PG&f=1", "display_name": "E. Weglarz", "link": "https://stackoverflow.com/users/6494867/e-weglarz"}, "edited": false, "score": 0, "creation_date": 1466607734, "post_id": 37970007, "comment_id": 63389857, "body": "Sub OpenMyWebPage()  Set IE = CreateObject(&quot;InternetExplorer.Application&quot;) IE.Visible = True  IE.navigate &quot;<a href=\"http://www.website.com/directory/subdirectory/\" rel=\"nofollow noreferrer\">website.com/directory/subdirectory</a>&quot; &amp; Format(Cells(1, 1).Value, &quot;ddmmyyyy&quot;) &amp;  &quot;/3rd directory/file.txt&quot;  &#39;Check for good connection to web page loop!  Do If IE.readyState = 4 Then IE.Visible = True Exit Do Else DoEvents End If Loop  &#39;Wait for window to open! Application.wait (Now + TimeValue(&quot;0:00:02&quot;)) &#39;MsgBox &quot;Done&quot; IE.Visible = True"}, {"owner": {"reputation": 37, "user_id": 6494867, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fb9211573476c42a65b8b08d3836a372?s=128&d=identicon&r=PG&f=1", "display_name": "E. Weglarz", "link": "https://stackoverflow.com/users/6494867/e-weglarz"}, "edited": false, "score": 0, "creation_date": 1466607818, "post_id": 37970007, "comment_id": 63389916, "body": "So its critical that the date in the end product on the URL shows with no slashes and is in yyyymmdd format, I noticed I would get overflow if I formatted otherwise"}, {"owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "edited": false, "score": 0, "creation_date": 1466610166, "post_id": 37970007, "comment_id": 63391608, "body": "If this solved your issue, don&#39;t forget to check the green mark! Have a good day"}], "tags": [], "owner": {"reputation": 2266, "user_id": 3221380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zaKk5.png?s=128&g=1", "display_name": "Sgdva", "link": "https://stackoverflow.com/users/3221380/sgdva"}, "is_accepted": false, "score": 0, "last_activity_date": 1466605151, "last_edit_date": 1466605151, "creation_date": 1466603203, "answer_id": 37970007, "question_id": 37969900, "link": "https://stackoverflow.com/questions/37969900/reference-cell-in-vba-script/37970007#37970007", "title": "Reference Cell in VBA Script", "body": "<p>Have you tried <a href=\"http://www.techonthenet.com/excel/formulas/format_date.php\" rel=\"nofollow\">format</a>?</p>\n\n<pre><code>'...\nIE.navigate \"http://website.com/\" &amp; Format (Cells(1,1).Value, \u201cdd/MM/yyyy\u201d) &amp; \"/subdirectory/file.txt\" '...\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6494867, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/fb9211573476c42a65b8b08d3836a372?s=128&d=identicon&r=PG&f=1", "display_name": "E. Weglarz", "link": "https://stackoverflow.com/users/6494867/e-weglarz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466605226, "creation_date": 1466602901, "last_edit_date": 1466605226, "question_id": 37969900, "link": "https://stackoverflow.com/questions/37969900/reference-cell-in-vba-script", "title": "Reference Cell in VBA Script", "body": "<p>I was curious if there is a way to reference a specific cell within the following VBA script. The cell contains a date in <strong><code>yyyymmdd</code></strong> format, which would go in the commented section below. </p>\n\n<pre><code>Sub OpenData()\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = False\n\nIE.navigate \"http://website.com/'desired cell value'/subdirectory/file.txt\"\n\n'Check for good connection to web page loop!\n\nDo\n    If IE.readyState = 4 Then\n        IE.Visible = True\n        Exit Do\n    Else\n        DoEvents\n    End If\nLoop\n\n'Wait for window to open!\nApplication.wait (Now + TimeValue(\"0:00:02\"))\n'MsgBox \"Done\"\nIE.Visible = True\n</code></pre>\n\n<p>Eric</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 4, "creation_date": 1466602861, "post_id": 37969832, "comment_id": 63385525, "body": "RIGHT(string,number)"}], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 6493950, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NKPkM.png?s=128&g=1", "display_name": "Diogo", "link": "https://stackoverflow.com/users/6493950/diogo"}, "is_accepted": false, "score": 0, "last_activity_date": 1466606972, "creation_date": 1466606972, "answer_id": 37971527, "question_id": 37969832, "link": "https://stackoverflow.com/questions/37969832/vba-excel-vba-code-to-search-cells-for-1st-3-digits-string-and-replace/37971527#37971527", "title": "VBA Excel - VBA code to search cells for 1st 3 digits string and replace", "body": "<pre><code>phone_number = Right(phone_number, 10)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6499484, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MDnohU-ZOgU/AAAAAAAAAAI/AAAAAAAAAt8/t6z5T2DyMGU/photo.jpg?sz=128", "display_name": "Peter John Gallego", "link": "https://stackoverflow.com/users/6499484/peter-john-gallego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1466606972, "creation_date": 1466602740, "question_id": 37969832, "link": "https://stackoverflow.com/questions/37969832/vba-excel-vba-code-to-search-cells-for-1st-3-digits-string-and-replace", "title": "VBA Excel - VBA code to search cells for 1st 3 digits string and replace", "body": "<p>I have a system generated excel sheet which has phone number of staff. What I wanted to do is to cleanup the numbers on the first column so it will show only the last 10digits(i.e 9151234567).</p>\n\n<p>Ex. Some numbers show 00639151234567, +639151234567, 639151234567</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 2, "creation_date": 1466602634, "post_id": 37969762, "comment_id": 63385318, "body": "What is it supposed to do?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1466602928, "post_id": 37969762, "comment_id": 63385574, "body": "don&#39;t copy and paste, just use the values, ws2.range(&quot;a1&quot;).value=ws.range(&quot;a1&quot;).value, turn calculation to manual, and yes, what&#39;s the desired output?  Also ws1, wont be defined the same as ws2 only the last one takes the type, you need to define each one.  You also don&#39;t set ws1 to anything"}, {"owner": {"reputation": 1, "user_id": 6499440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a419457ce84830f52460ddfa8e6715f?s=128&d=identicon&r=PG&f=1", "display_name": "El Tigre", "link": "https://stackoverflow.com/users/6499440/el-tigre"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466604188, "post_id": 37969762, "comment_id": 63386827, "body": "@Nathan_Sav  I liked the idea of copy/pasting but i tried with your approch  ws2.Range(&quot;A&quot; &amp; k) = ws1.Range(&quot;C&quot; &amp; i).Value and it work just fine - thank you very much"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466604321, "post_id": 37969762, "comment_id": 63386953, "body": "No probs, but you&#39;re essentially cutting it to memory each time.  Also, define ws1, so <code>dim ws1 as excel.worksheet</code> and <code>dim ws2 as excel.worksheet</code>"}], "answers": [{"tags": [], "owner": {"reputation": 379, "user_id": 4605562, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1cc0d5e9c5eb7270d612da79231e285c?s=128&d=identicon&r=PG&f=1", "display_name": "MJ95", "link": "https://stackoverflow.com/users/4605562/mj95"}, "is_accepted": false, "score": 0, "last_activity_date": 1466627431, "creation_date": 1466627431, "answer_id": 37977726, "question_id": 37969762, "link": "https://stackoverflow.com/questions/37969762/vba-while-looping-with-for-if-conditions/37977726#37977726", "title": "VBA while-looping with for/if conditions", "body": "<p>I would suggest using a <code>For Loop</code> first of all, and then checking if the cell values match something like:</p>\n\n<pre><code>For i = 2 to lastRow\nIf Cell(i, columnNumber).value = Cell(i, columnNumber).Value Then\n  //Do Something\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6499440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a419457ce84830f52460ddfa8e6715f?s=128&d=identicon&r=PG&f=1", "display_name": "El Tigre", "link": "https://stackoverflow.com/users/6499440/el-tigre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466627431, "creation_date": 1466602574, "last_edit_date": 1466603770, "question_id": 37969762, "link": "https://stackoverflow.com/questions/37969762/vba-while-looping-with-for-if-conditions", "title": "VBA while-looping with for/if conditions", "body": "<p>I'm working on this macro to extract the relavant information from an excel sheet to a new one. But i just can't seem to get it to work and it's making me crazy. </p>\n\n<p>Can you find the error or suggest a better approch?</p>\n\n<p>EDIT: I want to sort through the data in a sheets column c and if it matches my critera (if) i want to match it to the Group (fruit/berry) and also get data from adjecent columns (P,I,R) and take this whole extraxt and add it to a new sheet (ws2)</p>\n\n<pre><code>Private Sub Extract_Click()\n\nDim ws1, ws2 As Worksheet\nDim i,k as Integer\n\nset ws1 = Workbook.Activesheet\n\nSet ws2 = Worksheets.Add(After:= _\n      Worksheets(ThisWorkbook.Sheets.Count)) \nws2.Name = \"Extract\" &amp; ThisWorkbook.Sheets.Count \n\nWith ws1\n\ni = 10\nk = 2  \n\n    Do While Not Range(\"C\" &amp; i).Value = \"\"\n\n            If Range(\"C\" &amp; i).Value = \"Strawberry\" Then\n\n                ws1.Range(\"C\" &amp; i).Copy\n                ws2.Range(\"A\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n                ws2.Range(\"B\" &amp; k).Value = \"Berry\"\n\n                ws1.Range(\"P\" &amp; i).Copy\n                ws2.Range(\"C\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n                ws1.Range(\"I\" &amp; i).Copy\n                ws2.Range(\"D\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n                ws1.Range(\"R\" &amp; i).Copy\n                ws2.Range(\"E\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n            ElseIf Range(\"C\" &amp; i).Value = \"banana\" Then\n\n                ws1.Range(\"C\" &amp; i).Copy\n                ws2.Range(\"A\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n                ws2.Range(\"B\" &amp; k).Value = \"Fruit\"\n\n                ws1.Range(\"P\" &amp; i).Copy\n                ws2.Range(\"C\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n                ws1.Range(\"I\" &amp; i).Copy\n                ws2.Range(\"D\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n                ws1.Range(\"R\" &amp; i).Copy\n                ws2.Range(\"E\" &amp; k).PasteSpecial Paste:=xlPasteValues\n\n            End If\n\n       k = k+1\n   i = i +1 \n\nLoop \n\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["php", "vba", "encryption", "vb6"], "comments": [{"owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "edited": false, "score": 0, "creation_date": 1466914094, "post_id": 37969548, "comment_id": 63510188, "body": "Hashing is not encryption."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6499275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09008f1f0d5413555ecd7371dc9a2c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/6499275/malik"}, "edited": false, "score": 0, "creation_date": 1466680105, "post_id": 37971008, "comment_id": 63423440, "body": "If we encrypt the data without pack method both are the outputs are same, but if we does with pack it shows different results.   Please suggest some solution"}, {"owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "reply_to_user": {"reputation": 23, "user_id": 6499275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09008f1f0d5413555ecd7371dc9a2c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/6499275/malik"}, "edited": false, "score": 0, "creation_date": 1466684508, "post_id": 37971008, "comment_id": 63426634, "body": "As stated in the answer, the PHP code produces the correct hash.You need to figure out what needs to be changed in the VB6 implementation, closely looking at the documentation for the expected input formats should help."}], "tags": [], "owner": {"reputation": 107760, "user_id": 451475, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a632afa4c11779c0cabd7df04eb26ba6?s=128&d=identicon&r=PG", "display_name": "zaph", "link": "https://stackoverflow.com/users/451475/zaph"}, "is_accepted": false, "score": 0, "last_activity_date": 1466605628, "creation_date": 1466605628, "answer_id": 37971008, "question_id": 37969548, "link": "https://stackoverflow.com/questions/37969548/hmacsha1-encrpyt-in-vba-does-not-equal-to-php-hmac-sha1-value-with-pack-method/37971008#37971008", "title": "hmacsha1 encrpyt in vba does not equal to php hmac_sha1 value with pack method", "body": "<p>If <code>\"1989151498577ad12a9f8adf157f5abf\"</code> is supposed to be the key in hexadecimal the php code is correct.</p>\n\n<p>Verify if <code>Encryp_HMACSHA1</code> expects the key to be data or a hexadecimal string.<br>\nVerify if the keys after conversion to data are the same by displaying them in hex</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6499275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09008f1f0d5413555ecd7371dc9a2c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/6499275/malik"}, "edited": false, "score": 0, "creation_date": 1467632991, "post_id": 38035822, "comment_id": 63793763, "body": "Thank you for your answer ,your answer is perfectly worked, you made my day.    I obliged"}], "tags": [], "owner": {"reputation": 12917, "user_id": 126278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b99033319a7f46661aaf0324c47f335?s=128&d=identicon&r=PG", "display_name": "Bob77", "link": "https://stackoverflow.com/users/126278/bob77"}, "is_accepted": true, "score": 2, "last_activity_date": 1466922728, "creation_date": 1466922728, "answer_id": 38035822, "question_id": 37969548, "link": "https://stackoverflow.com/questions/37969548/hmacsha1-encrpyt-in-vba-does-not-equal-to-php-hmac-sha1-value-with-pack-method/38035822#38035822", "title": "hmacsha1 encrpyt in vba does not equal to php hmac_sha1 value with pack method", "body": "<p>Your VB6 <code>Pack</code> function is:</p>\n\n<ul>\n<li>converting two hex digits at a time to bytes, then</li>\n<li>converting those values to characters with ANSI-to-Unicode translation.</li>\n</ul>\n\n<p>Then your <code>Encryp_HMACSHA1</code>:</p>\n\n<ul>\n<li>takes such String values and converts them into Byte arrays using conversion to UTF-8, and</li>\n<li>feeds that into <code>crypto.Key</code> to munch on.</li>\n</ul>\n\n<p>Playing fast and loose using Strings in this manner has corrupted your key value.</p>\n\n<p>I was apply to reproduce the incorrect signature result by taking known-working VB6 code and altering it to perform the same distortion.</p>\n\n<p>I'm not sure why you are using this great big heavy .Net inter-clop approach to doing part of the job and then taking another really heavy run through an MSXML DOM just for Base64 encoding.  Wow, do you have enough RAM for this to even run?</p>\n\n<p>I used the <code>HS1.cls</code> from the attachment (<code>HS1 Demo 1-1.zip</code>) at:</p>\n\n<p><a href=\"http://www.vbforums.com/showthread.php?635398-VB6-HMAC-SHA-256-HMAC-SHA-1-Using-Crypto-API&amp;p=4326461&amp;viewfull=1#post4326461\" rel=\"nofollow\">[VB6] HMAC-SHA-256, HMAC-SHA-1 Using Crypto API #35</a></p>\n\n<p>Then all that was required was:</p>\n\n<pre><code>Private Function HMACSHA1(ByVal Data As String, ByVal Key As String) As String\n    With New HS1\n        .InitHmac .Decode(Key, edfHexRaw)\n        HMACSHA1 = .Encode(.HMACSHA1(.ToUTF8(Data)), edfBase64, efNoFolding)\n    End With\nEnd Function\n</code></pre>\n\n<p>Where Data is VB6/Windows \"Unicode\" text (UCS-2/UTF-16LE) and Key is a \"Unicode\" string of hexadecimal text.  E.g.:</p>\n\n<pre><code>txtSignature.Text = HMACSHA1(\"test\", \"1989151498577ad12a9f8adf157f5abf\")\n</code></pre>\n\n<p>Sure enough, it produces:</p>\n\n<pre><code>4QXpNBD/cv0sLIfFIsFGe5D57gI=\n</code></pre>\n\n<p>This is also far lighter weight than using (a.) the .Net CLR and Framework libraries plus \"interop\" and (b.) MSXML as super-fat wrappers around simple API calls.</p>\n\n<p>But you could keep all of that overhead if you really want to as long as you correct your \"String of hex digits to Key\" parsing logic.</p>\n"}], "owner": {"reputation": 23, "user_id": 6499275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09008f1f0d5413555ecd7371dc9a2c0b?s=128&d=identicon&r=PG&f=1", "display_name": "Malik", "link": "https://stackoverflow.com/users/6499275/malik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "accepted_answer_id": 38035822, "answer_count": 2, "score": 2, "last_activity_date": 1466922728, "creation_date": 1466602098, "question_id": 37969548, "link": "https://stackoverflow.com/questions/37969548/hmacsha1-encrpyt-in-vba-does-not-equal-to-php-hmac-sha1-value-with-pack-method", "title": "hmacsha1 encrpyt in vba does not equal to php hmac_sha1 value with pack method", "body": "<p>This is my VB6 Code</p>\n\n<pre><code>Private Function Encryp_HMACSHA1(pData As String, pSecretKey As String) As String\nDim encoder  As Object\nDim crypto As Object\nDim i As Integer\nDim bSecretKey() As Byte\nDim bData() As Byte\nDim bEncrypted() As Byte\n\nSet encoder = CreateObject(\"System.Text.UTF8Encoding\")\nSet crypto = CreateObject(\"System.Security.Cryptography.HMACSHA1\")\n\nbData = encoder.Getbytes_4(pData)\nbSecretKey = encoder.Getbytes_4(pSecretKey)\ncrypto.Key = bSecretKey\nbEncrypted = crypto.ComputeHash_2(bData)\n\n\nSet encoder = Nothing\nSet crypto = Nothing\n\nDim objXML As MSXML2.DOMDocument\nDim objNode As MSXML2.IXMLDOMElement\nSet objXML = New MSXML2.DOMDocument\nSet objNode = objXML.createElement(\"b64\")\n\nobjNode.dataType = \"bin.base64\"\nobjNode.nodeTypedValue = bEncrypted\nEncodeBase64 = objNode.Text\n\nEncryp_HMACSHA1 = EncodeBase64\n\nSet objNode = Nothing\nSet objXML = Nothing\n\nEnd Function\n\nPublic Function Pack(strlength As String) As String\nDim Temp As String\nDim MyString As String\nDim i As Integer\n\nMyString = \"\"\nFor i = 1 To Len(strlength) Step 2\n    Temp = Mid(strlength, i, 2)\n    MyString = MyString &amp; Chr(CLng(\"&amp;H\" &amp; Temp))\nNext\n\nPack = MyString\nEnd Function\n\nPrivate Sub Command1_Click()\nDim pKey As String\n   pKey = Pack(\"1989151498577ad12a9f8adf157f5abf\")\n   Text1.Text = Encryp_HMACSHA1(\"test\", pKey)\nEnd Sub\n</code></pre>\n\n<p>result for vb is : <code>03AM+k4B3mPEZlkCatDvdiHOuuc=</code></p>\n\n<p>This is my php code</p>\n\n<pre><code>$key = \"1989151498577ad12a9f8adf157f5abf\";\n\n$decodeKey = pack(\"H*\",$key);\n\n$data = \"test\";\n\n$hash = hash_hmac(\"SHA1\", $data, $decodeKey, TRUE);\n\n$signature = base64_encode($hash);\n\n\necho $signature;\n</code></pre>\n\n<p>result for the php is : <code>4QXpNBD/cv0sLIfFIsFGe5D57gI=</code></p>\n\n<p>Please help in solving the equation.\nAnd There is another problem, If we encrypt the data without pack method both are the outputs are same, but if we does with pack it shows different results.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44153, "user_id": 109035, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CrLfp.jpg?s=128&g=1", "display_name": "Raj More", "link": "https://stackoverflow.com/users/109035/raj-more"}, "edited": false, "score": 0, "creation_date": 1466601673, "post_id": 37969279, "comment_id": 63384371, "body": "I don&#39;t think using <code>CALL</code> affects the <code>ByVal</code> vs <code>ByRef</code>.  IMO, you have a bug in the bubble sort code."}, {"owner": {"reputation": 44153, "user_id": 109035, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CrLfp.jpg?s=128&g=1", "display_name": "Raj More", "link": "https://stackoverflow.com/users/109035/raj-more"}, "edited": false, "score": 0, "creation_date": 1466601811, "post_id": 37969279, "comment_id": 63384511, "body": "Whoa.. I was wrong.. there is a <code>ByRef</code> issue at play  <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2003/09/15/what-do-you-mean-cannot-use-parentheses/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/ericlippert/2003/09/15/&hellip;</a>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466602170, "post_id": 37969279, "comment_id": 63384867, "body": "Is <code>AlphaSortArray()</code> a <b>function</b> or a <b>sub</b> ??"}, {"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466602215, "post_id": 37969279, "comment_id": 63384913, "body": "@Gary&#39;sStudent it&#39;s a function"}, {"owner": {"reputation": 107, "user_id": 6490042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QyMCF.png?s=128&g=1", "display_name": "kttii", "link": "https://stackoverflow.com/users/6490042/kttii"}, "edited": false, "score": 0, "creation_date": 1466602261, "post_id": 37969279, "comment_id": 63384964, "body": "see this post:  <a href=\"http://stackoverflow.com/questions/479891/what-does-the-call-keyword-do-in-vb6\" title=\"what does the call keyword do in vb6\">stackoverflow.com/questions/479891/&hellip;</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466602264, "post_id": 37969279, "comment_id": 63384967, "body": "I doubt that things are as you describe (though it is hard to know without seeing the actual code)."}, {"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466602359, "post_id": 37969279, "comment_id": 63385058, "body": "@JohnColeman good point, I will post some of the code up now - was just trying to keep it short in case I was asking an obvious question :)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466606723, "post_id": 37969279, "comment_id": 63389077, "body": "Another issue -- <i>bubble sort</i>??? Why use one of the worst sort algorithms there is?"}, {"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1466613072, "post_id": 37969279, "comment_id": 63393512, "body": "@JohnColeman yes I had heard it was rather clunky/slow! using as placeholder only while testing some other things, fixing properly now - still pretty new to vba, so many things I don&#39;t know :/"}, {"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "reply_to_user": {"reputation": 44153, "user_id": 109035, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CrLfp.jpg?s=128&g=1", "display_name": "Raj More", "link": "https://stackoverflow.com/users/109035/raj-more"}, "edited": false, "score": 0, "creation_date": 1466613221, "post_id": 37969279, "comment_id": 63393609, "body": "@RajMore thanks, that was a really interesting link that went a long way to answering my question"}, {"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "reply_to_user": {"reputation": 107, "user_id": 6490042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QyMCF.png?s=128&g=1", "display_name": "kttii", "link": "https://stackoverflow.com/users/6490042/kttii"}, "edited": false, "score": 0, "creation_date": 1466613281, "post_id": 37969279, "comment_id": 63393643, "body": "@kttii thanks, a handy clarification on Call"}], "answers": [{"comments": [{"owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "edited": false, "score": 0, "creation_date": 1466613675, "post_id": 37969728, "comment_id": 63393856, "body": "Ah brilliant, yes having the function write into a variable fixed the problem perfectly (I&#39;ve set to rewrite into same variable: <code>arrMRange = AlphSortArray(arrMRange)</code>). And a better looking sort algorithm too!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1466602494, "creation_date": 1466602494, "answer_id": 37969728, "question_id": 37969279, "link": "https://stackoverflow.com/questions/37969279/vba-what-is-the-difference-between-calling-a-function-with-call-and-without/37969728#37969728", "title": "vba what is the difference between calling a function with &#39;Call&#39; and without? (array sort function - different results)", "body": "<p>If you are dealing with a <strong>function</strong>, then avoid using <code>Call</code>.  This works for me:</p>\n\n<pre><code>Sub MAIN2()\n    Dim ary(1 To 3) As String, bry\n    Dim i As Long\n\n    ary(1) = \"zip\"\n    ary(2) = \"AAA\"\n    ary(3) = \"bbb\"\n\n    bry = fSort(ary)\n\n    For i = 1 To 3\n        MsgBox bry(i)\n    Next i\nEnd Sub\n\nPublic Function fSort(ByVal InOut) As Variant\n\n    Dim i As Long, J As Long, Low As Long\n    Dim Hi As Long, Temp As Variant\n\n    Low = LBound(InOut)\n    Hi = UBound(InOut)\n\n    J = (Hi - Low + 1) \\ 2\n    Do While J &gt; 0\n        For i = Low To Hi - J\n          If InOut(i) &gt; InOut(i + J) Then\n            Temp = InOut(i)\n            InOut(i) = InOut(i + J)\n            InOut(i + J) = Temp\n          End If\n        Next i\n        For i = Hi - J To Low Step -1\n          If InOut(i) &gt; InOut(i + J) Then\n            Temp = InOut(i)\n            InOut(i) = InOut(i + J)\n            InOut(i + J) = Temp\n          End If\n        Next i\n        J = J \\ 2\n    Loop\n    fSort = InOut\nEnd Function\n</code></pre>\n\n<p><strong><em>Note:</em></strong></p>\n\n<p>The array <code>ary()</code> in <code>MAIN2()</code> is <strong>not</strong> changed by the UDF.</p>\n"}], "owner": {"reputation": 148, "user_id": 5940053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa6118f9c52406a2aad2e0c9e08221ce?s=128&d=identicon&r=PG&f=1", "display_name": "Marisa", "link": "https://stackoverflow.com/users/5940053/marisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1466602796, "creation_date": 1466601496, "last_edit_date": 1466602796, "question_id": 37969279, "link": "https://stackoverflow.com/questions/37969279/vba-what-is-the-difference-between-calling-a-function-with-call-and-without", "title": "vba what is the difference between calling a function with &#39;Call&#39; and without? (array sort function - different results)", "body": "<p>This is more of a 'understanding a concept' question than a 'fix code issues' type question...</p>\n\n<p>I have an array containing a list of strings, and a function which will sort these alphabetically (using BubbleSort method).</p>\n\n<p>If I use</p>\n\n<pre><code>Call AlphSortArray(arr)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>AlphSortArray arr\n</code></pre>\n\n<p>it works perfectly. But</p>\n\n<pre><code>AlphSortArray(arr)\n</code></pre>\n\n<p>leaves the items unsorted, and chops off the first in the list...</p>\n\n<p>I've been reading around for a reason and have seen mentioned that it might be something to do with calling byVal vs byRef, but haven't been able to find a clear explanation.</p>\n\n<p>While the code works fine, it would be a huge help if anyone can point me in the right direction so that I understand for future reference!</p>\n\n<p>Many thanks in advance</p>\n\n<hr>\n\n<p>Context: I've been setting up an excel userform which contains a combobox, where the source is taken from a list of names on a worksheet (the names and number of names are constantly changing based on user inputs). The code currently finds the right range of cells, puts it into an array, alphabetically sorts it and then sets it as the source.</p>\n\n<hr>\n\n<p>Some of the code:</p>\n\n<p>In the main initialize userform code:</p>\n\n<pre><code>Call AlphSortArray(arrMRange)   'replace with lines above for error/no error\nComboBox1.List = arrMRange      'arrMRange is declared as Variant previously\n</code></pre>\n\n<p>Then the function:</p>\n\n<pre><code>Dim x As Long, y As Long\nDim strTemp1 As String\nFor x = LBound(arr) To UBound(arr) - 1\n    For y = x + 1 To UBound(arr)\n        If UCase(arr(x)) &gt; UCase(arr(y)) Then\n            strTemp1 = arr(x)\n            arr(x) = arr(y)\n            arr(y) = strTemp1\n        End If\n    Next y\nNext x\n</code></pre>\n\n<p>(bubblesort code adapted from comment in: <a href=\"https://social.msdn.microsoft.com/Forums/en-US/830b42cf-8c97-4aaf-b34b-d860773281f7/sorting-an-array-in-vba-without-excel-function?forum=isvvba\" rel=\"nofollow\">https://social.msdn.microsoft.com/Forums/en-US/830b42cf-8c97-4aaf-b34b-d860773281f7/sorting-an-array-in-vba-without-excel-function?forum=isvvba</a>)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1466601727, "post_id": 37969250, "comment_id": 63384422, "body": "Try instead of <code>.Formula</code> use <code>.FormulaArray</code>"}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1466604951, "post_id": 37969250, "comment_id": 63387509, "body": "Hi Scott, it does work with FormulaArray but only if I copy cell D2 seperately. Not if I want to copy the whole selection from B2 til D6."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1466605553, "post_id": 37969250, "comment_id": 63388047, "body": "Sheets(&quot;Sheet1&quot;).Range(&quot;B2:D6&quot;).Copy Sheets(&quot;Sheet1&quot;).Range(&quot;E2:G6&quot;).pastespecial xlformulas"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1466605602, "post_id": 37969250, "comment_id": 63388099, "body": "Those were two lines of code..."}, {"owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "edited": false, "score": 0, "creation_date": 1466607202, "post_id": 37969250, "comment_id": 63389451, "body": "Thanks man, works perfectly."}, {"owner": {"reputation": 1767, "user_id": 5134722, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YvI1j.jpg?s=128&g=1", "display_name": "Colm Bhandal", "link": "https://stackoverflow.com/users/5134722/colm-bhandal"}, "edited": false, "score": 0, "creation_date": 1552651743, "post_id": 37969250, "comment_id": 97102436, "body": "The problem with using the copy/paste option: it&#39;s slower than reading to an array and then writing the array, like you can do for values."}], "answers": [{"tags": [], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "is_accepted": true, "score": 0, "last_activity_date": 1569928015, "creation_date": 1569928015, "answer_id": 58183553, "question_id": 37969250, "link": "https://stackoverflow.com/questions/37969250/copy-array-formula-with-vba/58183553#58183553", "title": "Copy array formula with VBA", "body": "<p>As already described in the comments the solution is the following VBA:</p>\n\n<pre><code>Sub Copy_Array_Formula()\nSheet1.Range(\"B2:D6\").Copy\nSheet1.Range(\"E2:G6\").PasteSpecial xlFormulas\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3991, "user_id": 4934150, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6edf08d542b9812f5ef681d0a44d9ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4934150/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1684, "favorite_count": 0, "accepted_answer_id": 58183553, "answer_count": 1, "score": 0, "last_activity_date": 1569928015, "creation_date": 1466601450, "last_edit_date": 1531161705, "question_id": 37969250, "link": "https://stackoverflow.com/questions/37969250/copy-array-formula-with-vba", "title": "Copy array formula with VBA", "body": "<p>I have the following Excel table:</p>\n\n<pre><code>          A                 B                    C                    D                       E\n1                     Purchase Price        Sales Price      Purchase Price &gt; Sales Price\n2     Product A            50                    40        ={COUNT(IF(ISNUMBER(B2:B10),IF(B2:B10&gt;C2:C10-10,B2:B10)))}\n3     Product B            60                    65\n4     Product C            80                    60\n5     Product D            10                    20\n6     Product E            50                    30\n7     \n</code></pre>\n\n<p>Now I want use the following Macro to copy the formulas from cell B2:D6 into cell E2:G6:</p>\n\n<pre><code>Sub Array_Formula()\nSheets(\"Sheet1\").Range(\"E2:G6\").Formula = Sheets(\"Sheet1\").Range(\"B2:D6\").Formula\nEnd Sub\n</code></pre>\n\n<p>This macro copies the formulas from cell B2:D6 into cell E2:G6. However, it does not copy the { } of the formula in cell D2 so it does not stay as an array.</p>\n\n<p>How do I have to change my macro so it copies the formula including the array?</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466601407, "post_id": 37969180, "comment_id": 63384141, "body": "I&#39;m not sure what you mean by &quot;fit in to the MasterMacro.&quot;"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466601503, "post_id": 37969180, "comment_id": 63384212, "body": "@MattCremeens Sorry for not being clear. I can&#39;t figure out how to edit it to include ws so that it will run through all the Worksheets."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466601605, "post_id": 37969180, "comment_id": 63384314, "body": "Sub SeekParen(wsToUse as excel.Worksheet) then prefix you range, or any worksheet references with wsToUse. like wsToUse.Range(&quot;a1&quot;).value"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466602961, "post_id": 37969180, "comment_id": 63385609, "body": "Are the worksheets you are looping through in the same workbook as the main program or a different workbook from the main program?"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "reply_to_user": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "edited": false, "score": 0, "creation_date": 1466603761, "post_id": 37969180, "comment_id": 63386421, "body": "@MattCremeens That&#39;s my next challenge haha. As of now it only works in the same workbook but I want it to work in a different workbook."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1466602082, "post_id": 37969375, "comment_id": 63384771, "body": "Ah yeah this is what I tried too but doesn&#39;t work. Might just have to rewrite the macro. Thank you though."}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1466602120, "post_id": 37969375, "comment_id": 63384805, "body": "What didn&#39;t work about it? What error was thrown and what line was indicated?"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1466602445, "post_id": 37969375, "comment_id": 63385133, "body": "No error - the macro just only runs on the first worksheet"}, {"owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "reply_to_user": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1466602598, "post_id": 37969375, "comment_id": 63385284, "body": "Instead of using <code>.Select</code>. Can you try just referencing the range, like <code>Set thisRng = ws.Range(&quot;A2&quot;)</code> and then try <code>thisRng.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove</code>?"}, {"owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "edited": false, "score": 0, "creation_date": 1466603598, "post_id": 37969375, "comment_id": 63386256, "body": "I actually think I didn&#39;t realize it was working. Thank you!"}], "tags": [], "owner": {"reputation": 4621, "user_id": 1939638, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vu1kQ.jpg?s=128&g=1", "display_name": "Matt Cremeens", "link": "https://stackoverflow.com/users/1939638/matt-cremeens"}, "is_accepted": true, "score": 1, "last_activity_date": 1466602210, "last_edit_date": 1466602210, "creation_date": 1466601707, "answer_id": 37969375, "question_id": 37969180, "link": "https://stackoverflow.com/questions/37969180/edit-standalone-code-to-receive-a-parameter/37969375#37969375", "title": "Edit standalone code to receive a parameter", "body": "<p>If you pass a worksheet reference to the function, like this</p>\n\n<pre><code>Call SeekParen(ws)\n</code></pre>\n\n<p>and modify <code>SeekParen</code> to receive it, like so</p>\n\n<pre><code>Sub SeekParen(ws as Worksheet)\n</code></pre>\n\n<p>then you should be able to attach the passed worksheet reference to each relevant line in the body of <code>SeekParen</code>, like so</p>\n\n<pre><code>Dim c As Range, wheree As Range\nDim whatt As String\nDim TotalCycle As Long, CounterCycle As Long\nwhatt = \")\"\nSet c = ws.Range(\"A1:A10\")\n\nSet wheree = c.Find(what:=whatt, after:=c(1)).Offset(0, 1)\nTotalCycle = Application.WorksheetFunction.CountIf(c, whatt)\nFor CounterCycle = 1 To TotalCycle\n    If wheree.Value &lt;&gt; \"\" Then\n        ws.Range(\"A2\").Select\n        Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        Set wheree = c.Find(what:=whatt, after:=c(wheree.Row)).Offset(0, 1)\n    Else\n        Exit For\n    End If\nNext CounterCycle\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6410038, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77be0072775a0e0f1bed5c42428da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/6410038/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 37969375, "answer_count": 1, "score": 0, "last_activity_date": 1553391649, "creation_date": 1466601262, "last_edit_date": 1553391649, "question_id": 37969180, "link": "https://stackoverflow.com/questions/37969180/edit-standalone-code-to-receive-a-parameter", "title": "Edit standalone code to receive a parameter", "body": "<p>I have this query that looks for a \")\" and shifts it down until it is not next to any data.</p>\n\n<pre><code>Sub SeekParen()\n\nDim c As Range, wheree As Range\nDim whatt As String\nDim TotalCycle As Long, CounterCycle As Long\nwhatt = \")\"\nSet c = Range(\"A1:A10\")\n\nSet wheree = c.Find(what:=whatt, after:=c(1)).Offset(0, 1)\n    TotalCycle = Application.WorksheetFunction.CountIf(c, whatt)\nFor CounterCycle = 1 To TotalCycle\n    If wheree.Value &lt;&gt; \"\" Then\n        Range(\"A2\").Select\n        Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n        Set wheree = c.Find(what:=whatt, after:=c(wheree.Row)).Offset(0, 1)\n    Else\n        Exit For\n    End If\nNext CounterCycle\n\nEnd Sub\n</code></pre>\n\n<p>I also have a master query that runs each query through all Worksheets.</p>\n\n<pre><code>Sub MasterTransformationMacro()\n\n'Dim wb As Workbook\n'Set wb = Workbooks(\"Book2.xlsm\")\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n    Call SeekParen(ws)\n    Call SeekParen(ws)\n    Call Move(ws)\n    Call DoTrim(ws)\n    Call CopyA(ws)\n    Call ReplaceDelimit(ws)\n    Call Split(ws)\n    Call DeleteAllEmptyCRows(ws)\n    Call DeleteC(ws)\n    Call Formuoli(ws)\n    Call InsertSystemPath(ws)\nNext\n\nEnd Sub\n</code></pre>\n\n<p>I only can't figure out how to edit SeekParen to fit in to the MasterMacro. Any help would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466607769, "post_id": 37971466, "comment_id": 63389887, "body": "This is great, do you know where I would go about changing it so that they would only need to select a month from the current year or the next year and not both? As of right now, if they select a month in the next year, it requires them to choose a month for the current year."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466607950, "post_id": 37971466, "comment_id": 63390003, "body": "well, let&#39;s see some proposals from you. study the code, step through it and see what it actually does. then make changes and see the results. and if there are issues then come back with them"}, {"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466609670, "post_id": 37971466, "comment_id": 63391237, "body": "I&#39;ve added some versions I&#39;ve tried to run in my original post."}, {"owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "edited": false, "score": 0, "creation_date": 1466610316, "post_id": 37971466, "comment_id": 63391709, "body": "Yeah that was my bad, I editted my original question trying to make a new control errror checking as well as trying an OR statement. Might just be clueless when it comes to the syntax in VBA in comparison with SQL and C#"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1466606805, "creation_date": 1466606805, "answer_id": 37971466, "question_id": 37968996, "link": "https://stackoverflow.com/questions/37968996/code-fluency-errorchecking-click-unclick-pulling-new-values/37971466#37971466", "title": "Code Fluency - ErrorChecking, Click/Unclick, Pulling New Values", "body": "<p>to process two listboxes in a similar way but with some different parameters add a <code>ProcessListBox()</code> sub to handle a <code>ListBox</code> control processing, and specify as its parameters those that can change, like:</p>\n\n<pre><code>Sub ProcessListBox(lb As msforms.ListBox, ws As Worksheet, iRow As Long, ByVal iniCol As Long)\n    Dim MonthNumber As Byte\n\n    With ws\n        For MonthNumber = 0 To 11\n            If lb.Selected(MonthNumber) Then\n                .Cells(iRow, iniCol).Value = \"Yes\"\n            Else\n                .Cells(iRow, iniCol).Value = \"No\"\n            End If\n            iniCol = iniCol + 1 'Increase the column Index for each time through the loop\n        Next MonthNumber\n    End With\nEnd Sub\n</code></pre>\n\n<p>so that your processing \"core\" of <code>Process()</code> sub would be:</p>\n\n<pre><code>With ws\n    '.Unprotect Password:=\"password\"\n    .Cells(iRow, 1).Value = Me.nameTextbox.Value\n    .Cells(iRow, 2).Value = Me.projectTextbox.Value\n    .Cells(iRow, 3).Value = Me.audienceCombobox.Value\n\n    If rvpCheckbox Then .Cells(iRow, 28).Value = \"RVP\"\n    If uwCheckbox Then .Cells(iRow, 29).Value = \"UW\"\n    If uaCheckbox Then .Cells(iRow, 30).Value = \"UA\"\n    If umCheckbox Then .Cells(iRow, 31).Value = \"UM\"\n    If baCheckbox Then .Cells(iRow, 32).Value = \"BA\"\n    If otherCheckbox Then .Cells(iRow, 33).Value = \"Other\"\nEnd With\n\nProcessListBox lengthListbox, ws, iRow, 4 '&lt;--| process lengthListbox passing \"4\" as starting column\nProcessListBox lengthListbox2, ws, iRow, 16 '&lt;--| process lengthListbox2 passing \"16\" as starting column\n</code></pre>\n\n<p>as for the listboxes and corresponding checkboxes cross checking, since you actually only care about the former, just check listboxes for any selected value</p>\n\n<p>and you could that by means of a specific Function like:</p>\n\n<pre><code>Private Function CountSelectedListBoxItems(lb As msforms.ListBox) As Long\n    Dim i As Long\n    With lb\n        For i = 0 To .ListCount - 1\n            If .Selected(i) Then CountSelectedListBoxItems = CountSelectedListBoxItems + 1\n        Next i\n    End With\nEnd Function\n</code></pre>\n\n<p>to add to your <code>CheckControl()</code> function <code>Case</code> block:</p>\n\n<pre><code>Function CheckControl(ctrl As msforms.Control, errMsg As String) As Boolean\n    Select Case TypeName(ctrl)\n        Case \"TextBox\"\n            CheckControl = Trim(ctrl.Value) &lt;&gt; \"\"\n        Case \"ComboBox\"\n            CheckControl = ctrl.ListIndex &lt;&gt; -1\n        Case \"ListBox\" '&lt;--| add the case of a ListBox control passed to check\n            CheckControl = CountSelectedListBoxItems(ctrl) &gt; 0 '&lt;--| call new function to check listboxes\n'        Case Else\n    End Select\n    If CheckControl Then Exit Function\n    ctrl.SetFocus\n    MsgBox errMsg\nEnd Function\n</code></pre>\n\n<p>and therefore update your <code>CheckInputs()</code> function</p>\n\n<pre><code>Function CheckInputs() As Boolean\n    If Not CheckControl(Me.nameTextbox, \"Please enter your name\") Then Exit Function\n    If Not CheckControl(Me.projectTextbox, \"Please enter a Project Name\") Then Exit Function\n    If Not CheckControl(Me.audienceCombobox, \"Please select an Audience\") Then Exit Function\n    If Not CheckControl(Me.impactCombobox, \"Please select Impact Type\") Then Exit Function\n    If Not CheckControl(Me.lengthListbox, \"Please select a current year month\") Then Exit Function '&lt;--| check \"lengthListbox\"\n    If Not CheckControl(Me.lengthListbox2, \"Please select a next year month\") Then Exit Function '&lt;--| check \"lengthListbox2\"\n\n    CheckInputs = True\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>I also think you need to update your <code>ClearUFData()</code> sub to handle both <code>lengthListbox</code> and <code>lengthListbox2</code>. and qXCheckbox2, too...</p>\n\n<pre><code>Sub ClearUFData()\n    'clear the data\n    With Me\n        .nameTextbox.Value = \"\"\n        .projectTextbox.Value = \"\"\n        .nameTextbox.SetFocus\n        .audienceCombobox.Value = Null\n        .impactCombobox.Value = Null\n        .q1Checkbox.Value = False\n        .q2Checkbox.Value = False\n        .q3Checkbox.Value = False\n        .q4Checkbox.Value = False\n        .q1Checkbox2.Value = False '&lt;-- uncheck q1Checkbox2\n        .q2Checkbox2.Value = False '&lt;-- uncheck q2Checkbox2\n        .q3Checkbox2.Value = False '&lt;-- uncheck q3Checkbox2\n        .q4Checkbox2.Value = False '&lt;-- uncheck q4Checkbox2\n        DeselectListBox lengthListbox '&lt;-- deselect all listbox items\n        DeselectListBox lengthListbox2 '&lt;-- deselect all lkistbox items\n    End With\nEnd Sub\n</code></pre>\n\n<p>where I'd use a <code>DeselectListBox()</code> sub like follows:</p>\n\n<pre><code>Private Sub DeselectListBox(lb As msforms.ListBox)\n    Dim i As Long\n    With lb\n        For i = 0 To .ListCount - 1\n            .Selected(i) = False\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Finally some little improvements</p>\n\n<p><code>checkbox</code> control default property is <code>Value</code> that returns True or False whether it is checked or not</p>\n\n<p>so instead of </p>\n\n<pre><code>If q1Checkbox.Value = False Then\n</code></pre>\n\n<p>you can simply use</p>\n\n<pre><code>If Not q1Checkbox Then\n</code></pre>\n\n<p>and the likes</p>\n\n<p>this can have you simplify and shorten the following code:</p>\n\n<pre><code>Private Sub q1Checkbox_Click()\n    lengthListbox.Selected(0) = True\n    lengthListbox.Selected(1) = True\n    lengthListbox.Selected(2) = True\n    If Not q1Checkbox Then\n        lengthListbox.Selected(0) = False\n        lengthListbox.Selected(1) = False\n        lengthListbox.Selected(2) = False\n    End If\nEnd Sub\n\nPrivate Sub q2Checkbox_Click()\n    lengthListbox.Selected(3) = True\n    lengthListbox.Selected(4) = True\n    lengthListbox.Selected(5) = True\n    If Not q2Checkbox Then\n        lengthListbox.Selected(3) = False\n        lengthListbox.Selected(4) = False\n        lengthListbox.Selected(5) = False\n    End If\nEnd Sub\n\nPrivate Sub q3Checkbox_Click()\n    lengthListbox.Selected(6) = True\n    lengthListbox.Selected(7) = True\n    lengthListbox.Selected(8) = True\n    If Not q3Checkbox Then\n        lengthListbox.Selected(6) = False\n        lengthListbox.Selected(7) = False\n        lengthListbox.Selected(8) = False\n    End If\nEnd Sub\n\nPrivate Sub q4Checkbox_Click()\n    lengthListbox.Selected(9) = True\n    lengthListbox.Selected(10) = True\n    lengthListbox.Selected(11) = True\n    If Not q4Checkbox Then\n        lengthListbox.Selected(9) = False\n        lengthListbox.Selected(10) = False\n        lengthListbox.Selected(11) = False\n    End If\nEnd Sub\nPrivate Sub q1Checkbox2_Click()\n    lengthListbox2.Selected(0) = True\n    lengthListbox2.Selected(1) = True\n    lengthListbox2.Selected(2) = True\n    If Not q1Checkbox2 Then\n        lengthListbox2.Selected(0) = False\n        lengthListbox2.Selected(1) = False\n        lengthListbox2.Selected(2) = False\n    End If\nEnd Sub\n\nPrivate Sub q2Checkbox2_Click()\n    lengthListbox2.Selected(3) = True\n    lengthListbox2.Selected(4) = True\n    lengthListbox2.Selected(5) = True\n    If q2Checkbox2.Value = False Then\n        lengthListbox2.Selected(3) = False\n        lengthListbox2.Selected(4) = False\n        lengthListbox2.Selected(5) = False\n    End If\nEnd Sub\n\nPrivate Sub q3Checkbox2_Click()\n    lengthListbox2.Selected(6) = True\n    lengthListbox2.Selected(7) = True\n    lengthListbox2.Selected(8) = True\n    If Not q3Checkbox2 Then\n        lengthListbox2.Selected(6) = False\n        lengthListbox2.Selected(7) = False\n        lengthListbox2.Selected(8) = False\n    End If\nEnd Sub\n\nPrivate Sub q4Checkbox2_Click()\n    lengthListbox2.Selected(9) = True\n    lengthListbox2.Selected(10) = True\n    lengthListbox2.Selected(11) = True\n    If Not q4Checkbox2 Then\n        lengthListbox2.Selected(9) = False\n        lengthListbox2.Selected(10) = False\n        lengthListbox2.Selected(11) = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>UserForm_Initialize can be also made more \"codeable\" and readable with the use of <code>With</code> statement as follows:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n' sets name textbox to focus on load and loads combobox list\n    nameTextbox.SetFocus\n\n    With audienceCombobox\n        .AddItem \"HR Activities/Initiatives\"\n        .AddItem \"BI Underwriting\"\n        .AddItem \"Product Management\"\n        .AddItem \"CI Operations\"\n        .AddItem \"UW Systems\"\n        .AddItem \"Regional Initiatives\"\n        .AddItem \"Other\"\n    End With\n\n    With lengthListbox\n        .AddItem \"January\"\n        .AddItem \"February\"\n        .AddItem \"March\"\n        .AddItem \"April\"\n        .AddItem \"May\"\n        .AddItem \"June\"\n        .AddItem \"July\"\n        .AddItem \"August\"\n        .AddItem \"September\"\n        .AddItem \"October\"\n        .AddItem \"November\"\n        .AddItem \"December\"\n    End With\n\n    'New Year\n    With lengthListbox2\n        .AddItem \"January\"\n        .AddItem \"February\"\n        .AddItem \"March\"\n        .AddItem \"April\"\n        .AddItem \"May\"\n        .AddItem \"June\"\n        .AddItem \"July\"\n        .AddItem \"August\"\n        .AddItem \"September\"\n        .AddItem \"October\"\n        .AddItem \"November\"\n        .AddItem \"December\"\n    End With\n\n    With impactCombobox\n        .AddItem \"High\"\n        .AddItem \"Low\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 6490294, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/cf5ddaa8025b8ba7e5a7d60fad47a6e2?s=128&d=identicon&r=PG&f=1", "display_name": "adrenom", "link": "https://stackoverflow.com/users/6490294/adrenom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 37971466, "answer_count": 1, "score": 0, "last_activity_date": 1466610268, "creation_date": 1466600849, "last_edit_date": 1531164843, "question_id": 37968996, "link": "https://stackoverflow.com/questions/37968996/code-fluency-errorchecking-click-unclick-pulling-new-values", "title": "Code Fluency - ErrorChecking, Click/Unclick, Pulling New Values", "body": "<p>So here is my initial code:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub clearButton_Click()\nClearUFData 'clears the form\nEnd Sub\n\n\nPrivate Sub enterButton_Click()\n    If Not CheckInputs Then Exit Sub 'check for fields to have values\n    Process GetWs(Me.impactCombobox.Value) ' process data passing the proper worksheet got from GetWs() function\n    MsgBox \"Project Entered Successfully\"\n    ClearUFData 'clear the data\nEnd Sub\n\nPrivate Sub Process(ws As Worksheet)\n    Dim iRow As Long\n    Dim MonthNumber As Byte\n    Dim ColumnNumber As Long: ColumnNumber = 4\n\n    'find first empty row in database\n    iRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues).row + 1\n\n    'copy the data to the database\n    'use protect and unprotect lines,\n    '     with your password\n    '     if worksheet is protected\n\n    With ws\n        '.Unprotect Password:=\"password\"\n        .Cells(iRow, 1).Value = Me.nameTextbox.Value\n        .Cells(iRow, 2).Value = Me.projectTextbox.Value\n        .Cells(iRow, 3).Value = Me.audienceCombobox.Value\n        For MonthNumber = 0 To 11\n            If lengthListbox.Selected(MonthNumber) Then\n                .Cells(iRow, ColumnNumber).Value = \"Yes\"\n            Else\n                .Cells(iRow, ColumnNumber).Value = \"No\"\n            End If\n\n            'Increase the column Index for each time through the loop\n            ColumnNumber = ColumnNumber + 1\n\n        Next MonthNumber\n        If rvpCheckbox.Value = True Then\n            .Cells(iRow, 28).Value = \"RVP\"\n        End If\n        If uwCheckbox.Value = True Then\n            .Cells(iRow, 29).Value = \"UW\"\n        End If\n        If uaCheckbox.Value = True Then\n            .Cells(iRow, 30).Value = \"UA\"\n        End If\n        If umCheckbox.Value = True Then\n            .Cells(iRow, 31).Value = \"UM\"\n        End If\n        If baCheckbox.Value = True Then\n            .Cells(iRow, 32).Value = \"BA\"\n        End If\n        If otherCheckbox.Value = True Then\n            .Cells(iRow, 33).Value = \"Other\"\n        End If\n\n    End With\n\nEnd Sub\n\nFunction CheckInputs() As Boolean\n    If Not CheckControl(Me.nameTextbox, \"Please enter your name\") Then Exit Function\n    If Not CheckControl(Me.projectTextbox, \"Please enter a Project Name\") Then Exit Function\n    If Not CheckControl(Me.audienceCombobox, \"Please select an Audience\") Then Exit Function\n    If Not CheckControl(Me.impactCombobox, \"Please select Impact Type\") Then Exit Function\n    CheckInputs = True\nEnd Function\n\nFunction CheckControl(ctrl As MSForms.Control, errMsg As String) As Boolean\n    Select Case TypeName(ctrl)\n        Case \"TextBox\"\n            CheckControl = Trim(ctrl.Value) &lt;&gt; \"\"\n        Case \"ComboBox\"\n            CheckControl = ctrl.ListIndex &lt;&gt; -1\n'        Case Else\n    End Select\n    If CheckControl Then Exit Function\n    ctrl.SetFocus\n    MsgBox errMsg\nEnd Function\n\nFunction GetWs(impact As String) As Worksheet\n    Select Case impact\n        Case \"High\"\n            Set GetWs = Worksheets(\"HI Project Database\")\n        Case \"Low\"\n            Set GetWs = Worksheets(\"LI Project Database\")\n'        Case Else\n    End Select\nEnd Function\n\nSub ClearUFData()\n    Dim i As Integer\n   'clear the data\n    Me.nameTextbox.Value = \"\"\n    Me.projectTextbox.Value = \"\"\n    Me.nameTextbox.SetFocus\n    Me.audienceCombobox.Value = Null\n    Me.impactCombobox.Value = Null\n    Me.q1Checkbox.Value = False\n    Me.q2Checkbox.Value = False\n    Me.q3Checkbox.Value = False\n    Me.q4Checkbox.Value = False\n    For i = lengthListbox.ListCount - 1 To 0 Step -1\n        If lengthListbox.Selected(i) = True Then\n            lengthListbox.Selected(i) = False\n        End If\n    Next i\nEnd Sub\n\nPrivate Sub exitButton_Click()\n' exits the form\nUnload Me\nEnd Sub\n\nPrivate Sub q1Checkbox_Click()\n    lengthListbox.Selected(0) = True\n    lengthListbox.Selected(1) = True\n    lengthListbox.Selected(2) = True\nIf q1Checkbox.Value = False Then\n    lengthListbox.Selected(0) = False\n    lengthListbox.Selected(1) = False\n    lengthListbox.Selected(2) = False\nEnd If\nEnd Sub\n\nPrivate Sub q2Checkbox_Click()\n    lengthListbox.Selected(3) = True\n    lengthListbox.Selected(4) = True\n    lengthListbox.Selected(5) = True\nIf q2Checkbox.Value = False Then\n    lengthListbox.Selected(3) = False\n    lengthListbox.Selected(4) = False\n    lengthListbox.Selected(5) = False\nEnd If\nEnd Sub\n\nPrivate Sub q3Checkbox_Click()\n    lengthListbox.Selected(6) = True\n    lengthListbox.Selected(7) = True\n    lengthListbox.Selected(8) = True\nIf q3Checkbox.Value = False Then\n    lengthListbox.Selected(6) = False\n    lengthListbox.Selected(7) = False\n    lengthListbox.Selected(8) = False\nEnd If\nEnd Sub\n\nPrivate Sub q4Checkbox_Click()\n    lengthListbox.Selected(9) = True\n    lengthListbox.Selected(10) = True\n    lengthListbox.Selected(11) = True\nIf q4Checkbox.Value = False Then\n    lengthListbox.Selected(9) = False\n    lengthListbox.Selected(10) = False\n    lengthListbox.Selected(11) = False\nEnd If\nEnd Sub\nPrivate Sub q1Checkbox2_Click()\n    lengthListbox2.Selected(0) = True\n    lengthListbox2.Selected(1) = True\n    lengthListbox2.Selected(2) = True\nIf q1Checkbox2.Value = False Then\n    lengthListbox2.Selected(0) = False\n    lengthListbox2.Selected(1) = False\n    lengthListbox2.Selected(2) = False\nEnd If\nEnd Sub\n\nPrivate Sub q2Checkbox2_Click()\n    lengthListbox2.Selected(3) = True\n    lengthListbox2.Selected(4) = True\n    lengthListbox2.Selected(5) = True\nIf q2Checkbox2.Value = False Then\n    lengthListbox2.Selected(3) = False\n    lengthListbox2.Selected(4) = False\n    lengthListbox2.Selected(5) = False\nEnd If\nEnd Sub\n\nPrivate Sub q3Checkbox2_Click()\n    lengthListbox2.Selected(6) = True\n    lengthListbox2.Selected(7) = True\n    lengthListbox2.Selected(8) = True\nIf q3Checkbox2.Value = False Then\n    lengthListbox2.Selected(6) = False\n    lengthListbox2.Selected(7) = False\n    lengthListbox2.Selected(8) = False\nEnd If\nEnd Sub\n\nPrivate Sub q4Checkbox2_Click()\n    lengthListbox2.Selected(9) = True\n    lengthListbox2.Selected(10) = True\n    lengthListbox2.Selected(11) = True\nIf q4Checkbox2.Value = False Then\n    lengthListbox2.Selected(9) = False\n    lengthListbox2.Selected(10) = False\n    lengthListbox2.Selected(11) = False\nEnd If\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n' sets name textbox to focus on load and loads combobox list\nnameTextbox.SetFocus\naudienceCombobox.AddItem \"HR Activities/Initiatives\"\naudienceCombobox.AddItem \"BI Underwriting\"\naudienceCombobox.AddItem \"Product Management\"\naudienceCombobox.AddItem \"CI Operations\"\naudienceCombobox.AddItem \"UW Systems\"\naudienceCombobox.AddItem \"Regional Initiatives\"\naudienceCombobox.AddItem \"Other\"\nlengthListbox.AddItem \"January\"\nlengthListbox.AddItem \"February\"\nlengthListbox.AddItem \"March\"\nlengthListbox.AddItem \"April\"\nlengthListbox.AddItem \"May\"\nlengthListbox.AddItem \"June\"\nlengthListbox.AddItem \"July\"\nlengthListbox.AddItem \"August\"\nlengthListbox.AddItem \"September\"\nlengthListbox.AddItem \"October\"\nlengthListbox.AddItem \"November\"\nlengthListbox.AddItem \"December\"\n'New Year\nlengthListbox2.AddItem \"January\"\nlengthListbox2.AddItem \"February\"\nlengthListbox2.AddItem \"March\"\nlengthListbox2.AddItem \"April\"\nlengthListbox2.AddItem \"May\"\nlengthListbox2.AddItem \"June\"\nlengthListbox2.AddItem \"July\"\nlengthListbox2.AddItem \"August\"\nlengthListbox2.AddItem \"September\"\nlengthListbox2.AddItem \"October\"\nlengthListbox2.AddItem \"November\"\nlengthListbox2.AddItem \"December\"\nimpactCombobox.AddItem \"High\"\nimpactCombobox.AddItem \"Low\"\nEnd Sub\n</code></pre>\n\n<p>Now, some specific areas I need to address are that I just added in a new lengthListbox2 that is an exact replica and does everything lengthListbox does, it just starts the data starting from ColumnNumber = 16 but I can't figure how to adjust the DIMs to address this.</p>\n\n<p>I am also trying to figure out the proper way to error check the q1-q4 checkboxes and the lengthListbox(2) so that they have to have clicked either one of the q1-q4 boxes or one of the options in the lengthListbox.</p>\n\n<p>Also another small addition I'm trying to add is that if they click the first 3 properties in the listbox (months) q1 is checked, and the next 3 then q2 is selected. Right now my code only does vice versa, if Q1 is selected then it selects the first 3 months.</p>\n\n<p>Excuse the messiness in some areas, I've had a lot of help putting the code together for fluency in certain areas and my newbie skills did the rest.</p>\n\n<p>EDIT: \nProject length is now trying to pull a requirement from both current and next year when it just needs to be one or the other.</p>\n\n<p>I've tried using this by setting up another control check but for lists specifically and separating two controlcheck situations but I need more so an or statement in there:</p>\n\n<pre><code>Function CheckInputs() As Boolean\n    If Not CheckControl(Me.nameTextbox, \"Please enter your name\") Then Exit Function\n    If Not CheckControl(Me.projectTextbox, \"Please enter a Project Name\") Then Exit Function\n    If Not CheckControl(Me.audienceCombobox, \"Please select an Audience\") Then Exit Function\n    If Not CheckControl(Me.impactCombobox, \"Please select Impact Type\") Then Exit Function\n    If Not CheckControlList(Me.lengthListbox, Me.lengthListbox2, \"Please Select Project Length\") Then Exit Function\n\n    CheckInputs = True\nEnd Function\n\nPrivate Function CountSelectedListBoxItems(lb As MSForms.ListBox) As Long\n    Dim i As Long\n    With lb\n        For i = 0 To .ListCount - 1\n            If .Selected(i) Then CountSelectedListBoxItems = CountSelectedListBoxItems + 1\n        Next i\n    End With\nEnd Function\n\nFunction CheckControlList(ctrl As MSForms.Control, ctrl2 As MSForms.Control, errMsg As String) As Boolean\n    Select Case TypeName(ctrl)\n        Case \"ListBox\" '&lt;--| add the case of a ListBox control passed to check\n            CheckControlList = CountSelectedListBoxItems(ctrl) &gt; 0 '&lt;--| call new function to check listboxes\n'        Case Else\n    End Select\n    Select Case TypeName(ctrl2)\n        Case \"ListBox\" '&lt;--| add the case of a ListBox control passed to check\n            CheckControlList = CountSelectedListBoxItems(ctrl) &gt; 0 '&lt;--| call new function to check listboxes\n'        Case Else\n    End Select\n    If CheckControlList Then Exit Function\n    ctrl.SetFocus\n    MsgBox errMsg\nEnd Function\n\nFunction CheckControl(ctrl As MSForms.Control, errMsg As String) As Boolean\n    Select Case TypeName(ctrl)\n        Case \"TextBox\"\n            CheckControl = Trim(ctrl.Value) &lt;&gt; \"\"\n        Case \"ComboBox\"\n            CheckControl = ctrl.ListIndex &lt;&gt; -1\n        Case \"ListBox\" '&lt;--| add the case of a ListBox control passed to check\n            CheckControl = CountSelectedListBoxItems(ctrl) &gt; 0 '&lt;--| call new function to check listboxes\n'        Case Else\n    End Select\n    If CheckControl Then Exit Function\n    ctrl.SetFocus\n    MsgBox errMsg\nEnd Function\n</code></pre>\n\n<p>I've tried using an OR statement to separate the two as well but it just ends up displaying \"Please enter Project Length\" prior to saying it was successfully entered:</p>\n\n<pre><code>Function CheckInputs() As Boolean\n    If Not CheckControl(Me.nameTextbox, \"Please enter your name\") Then Exit Function\n    If Not CheckControl(Me.projectTextbox, \"Please enter a Project Name\") Then Exit Function\n    If Not CheckControl(Me.audienceCombobox, \"Please select an Audience\") Then Exit Function\n    If Not CheckControl(Me.impactCombobox, \"Please select Impact Type\") Then Exit Function\n    If Not (CheckControl(Me.lengthListbox) Or (CheckControl(Me.lengthListbox2)) Then MsgBox \"Please Enter Project Length\": Exit Function\n\n    CheckInputs = True\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "csv", "ms-access"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1466600760, "post_id": 37968862, "comment_id": 63383587, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff835958.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff835958.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5975743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04c5ed2de2b7ac39d3525d563b2b24e9?s=128&d=identicon&r=PG&f=1", "display_name": "Traceur", "link": "https://stackoverflow.com/users/5975743/traceur"}, "reply_to_user": {"reputation": 9, "user_id": 6499338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4212faa29135005595346e0d81a26a71?s=128&d=identicon&r=PG&f=1", "display_name": "Rashed Farah", "link": "https://stackoverflow.com/users/6499338/rashed-farah"}, "edited": false, "score": 0, "creation_date": 1466694209, "post_id": 37968954, "comment_id": 63434292, "body": "np, if you could &#39;accept&#39; my answer, that&#39;d be nice :)"}, {"owner": {"reputation": 8864, "user_id": 243925, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/94b734ac6e85d9f279ee7286f28d6145?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/243925/tony"}, "edited": false, "score": 0, "creation_date": 1516921470, "post_id": 37968954, "comment_id": 83899704, "body": "Because you use <code>acLinkDelim</code> it only <i>links</i> the file to Access, it does not <i>import</i> the data. You need to use <code>acImportdelim</code>"}], "tags": [], "owner": {"reputation": 33, "user_id": 5975743, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04c5ed2de2b7ac39d3525d563b2b24e9?s=128&d=identicon&r=PG&f=1", "display_name": "Traceur", "link": "https://stackoverflow.com/users/5975743/traceur"}, "is_accepted": false, "score": 4, "last_activity_date": 1466600753, "creation_date": 1466600753, "answer_id": 37968954, "question_id": 37968862, "link": "https://stackoverflow.com/questions/37968862/import-csv-file-into-existing-access-table-using-vba/37968954#37968954", "title": "Import csv file into existing access table using VBA", "body": "<p>this should work    </p>\n\n<pre><code>DoCmd.TransferText TransferType:=acLinkDelim, TableName:=\"tblImport\", _\n        FileName:=\"C:\\MyData.csv\", HasFieldNames:=true\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6499338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4212faa29135005595346e0d81a26a71?s=128&d=identicon&r=PG&f=1", "display_name": "Rashed Farah", "link": "https://stackoverflow.com/users/6499338/rashed-farah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9311, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466600753, "creation_date": 1466600495, "question_id": 37968862, "link": "https://stackoverflow.com/questions/37968862/import-csv-file-into-existing-access-table-using-vba", "title": "Import csv file into existing access table using VBA", "body": "<p>Hi i have a quick question what is the VBA code that will allow me to import a CSV file into a existing table in Access 2010 with its own field names?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 4, "creation_date": 1466599250, "post_id": 37968233, "comment_id": 63382315, "body": "Can you define <i>not working</i>"}, {"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "edited": false, "score": 0, "creation_date": 1466600804, "post_id": 37968233, "comment_id": 63383621, "body": "I  don&#39;t think I&#39;m prepared to dive into a full solution. But you should look into an ODBC query, depending on how the data is structured you might be able to pull it without opening the file at all."}], "answers": [{"tags": [], "owner": {"reputation": 324, "user_id": 6421449, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-byMP_uB_itg/AAAAAAAAAAI/AAAAAAAAF9c/zan1F_ZCbwI/photo.jpg?sz=128", "display_name": "zatbusch", "link": "https://stackoverflow.com/users/6421449/zatbusch"}, "is_accepted": true, "score": 0, "last_activity_date": 1466602212, "creation_date": 1466602212, "answer_id": 37969596, "question_id": 37968233, "link": "https://stackoverflow.com/questions/37968233/working-with-named-ranges-and-objects/37969596#37969596", "title": "Working with Named Ranges and Objects", "body": "<p>A working example below:</p>\n\n<ul>\n<li>Comments are embedded and works as is (without changes). Try this on a \nworkbooks first with random data.</li>\n<li>The example works for a workbook already open, just alter it for \"Opening\" a workbook.</li>\n<li>I have used the range address in the example. You can play with this depending on what you want to do.</li>\n</ul>\n\n<p>The below works so should be easy to implement, copy and paste into excel.</p>\n\n<pre><code>Public Sub CopyData()\n\n\nDim wkb1 As Workbook\nDim wkb2 As Workbook\nDim sht1 As Worksheet\nDim sht2 As Worksheet\nDim wkb1rng As Range\nDim wkb2rng As Range\n\n'Point to Workbook and Sheet 1\n'Set wkb1 = Workbooks.Open(Model1) ' To Open Workbook\nSet wkb1 = Workbooks(\"Book1\") ' If workbook is open already\n\n\n'Sheets is the Index use String for the sheet name\nSet sht1 = wkb1.Sheets(1)\n\n' Dont need this if you moving objects directly in and out of memory.\n' Workbooks(Model1).Activate\n\n' Point to Range\nSet wkb1rng = sht1.Range(\"First_Input\")\n\n' What is the address of the Range\nDim address As String\naddress = wkb1rng.Cells.address\n\n'Point to Workbook and Sheet 2\nSet wkb2 = Workbooks(\"Book2\")\n\n'Sheets is the Index use String for the sheet name\nSet sht2 = wkb2.Sheets(1)\n\n'I imagine Second_Input should be output?\n'Use this only if the data range is exactly the same size\n'Set wkb2rng = Range(\"Second_Output\")\n'else use this ...\nSet wkb2rng = sht2.Range(address)\n\n'Copy data across ...\nwkb2rng.Value = wkb1rng.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6499208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52ca41313cc7f316c716c5bdf83d5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar", "link": "https://stackoverflow.com/users/6499208/shankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37969596, "answer_count": 1, "score": 0, "last_activity_date": 1466602212, "creation_date": 1466599046, "last_edit_date": 1466599407, "question_id": 37968233, "link": "https://stackoverflow.com/questions/37968233/working-with-named-ranges-and-objects", "title": "Working with Named Ranges and Objects", "body": "<p>I need to copy a range of cells from one workbook to another. However, unfortunately, because of the size of the two workbook I can't have them open at the same time. </p>\n\n<p>So the idea was to do it in two steps:</p>\n\n<p>1) Open <code>workbook1</code> save the range from one workbook to a object range and close <code>workbook1</code></p>\n\n<p>2) Open <code>workbook2</code> save the range from the object to the range in workbook</p>\n\n<p>But this is not working. Could someone help with the code. Thanks. Sample code below </p>\n\n<pre><code>Dim Temp as Range\nWorkbooks.Open (Model1)\nWorkbooks(Model1).Activate\nTemp = Range(\"First_Input\").Value\nWorkbook(Model1).Close\n\nWorkbooks.Open(Model2)\nWorkbooks(Model2).Activiate\nRange(\"Second_Input\").Value = Temp.Value\n</code></pre>\n"}, {"tags": ["excel", "loops", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6449510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ea22a93c9e189fa949527c4e5130b6?s=128&d=identicon&r=PG&f=1", "display_name": "steep_learning_curve", "link": "https://stackoverflow.com/users/6449510/steep-learning-curve"}, "edited": false, "score": 0, "creation_date": 1466603196, "post_id": 37969267, "comment_id": 63385833, "body": "Thanks Darrell for the reply. I thought I would of got a error on the second line too but its working fine so I left it like that. What can I use instead of . Select and .Activate? The code works for what I need it to do so I scared to change it in case I mess it up. I know about the end of the loop It the middle I&#39;m struggling with."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 3, "user_id": 6449510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ea22a93c9e189fa949527c4e5130b6?s=128&d=identicon&r=PG&f=1", "display_name": "steep_learning_curve", "link": "https://stackoverflow.com/users/6449510/steep-learning-curve"}, "edited": false, "score": 0, "creation_date": 1466625170, "post_id": 37969267, "comment_id": 63400286, "body": "See the code I posted.  This is a much more efficient way to copy a value from one spreadsheet to a range in a newly opened file.  Not sure what the filtering was doing for you, but you couldn&#39;t paste a copied range into single cells in a loop anyway.  I assume your <code>CountA</code> formulas were just trying to get the number of cells as well."}, {"owner": {"reputation": 3, "user_id": 6449510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ea22a93c9e189fa949527c4e5130b6?s=128&d=identicon&r=PG&f=1", "display_name": "steep_learning_curve", "link": "https://stackoverflow.com/users/6449510/steep-learning-curve"}, "edited": false, "score": 0, "creation_date": 1466673753, "post_id": 37969267, "comment_id": 63419029, "body": "Thanks Darrell that&#39;s a lot more efficient"}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1466624964, "last_edit_date": 1466624964, "creation_date": 1466601478, "answer_id": 37969267, "question_id": 37968094, "link": "https://stackoverflow.com/questions/37968094/how-do-i-use-a-loop-to-paste-my-selected-text-into-cells/37969267#37969267", "title": "How do I use a loop to paste my selected &quot;text&quot; into cells?", "body": "<p>There's a lot going on here...First, it looks like you are using CountA formulas in the worksheet to do what you should be doing in VBA.  There is a lot of work around being done to make that work.  You are probably getting an error on the second line because you are trying to clear the contents of a sheet that has not been opened yet.  To find the number of occupied rows in a column you can use <code>LastRow = Sheets(\"Historic\").Cells(Rows.Count,1).End(xlUp).Row</code>.  You should try to minimize or eliminate the use of <code>Select</code> and <code>Activate</code>. If you try to clean that up it may make more sense to you and me.  Don't forget to end the loop with <code>Next x</code>. </p>\n\n<pre><code>Sub MON_ImportHistory()\n\nDim LastRow, LastCol As Integer\nDim ws1, ws2 As Worksheet\nDim m_import As String\nDim x As Integer\n\nSet ws1 = Worksheets(\"Help\")\n\n'\nIf ws1.Cells(18, 9) = \"Data already present\" Then\n   MsgBox (\"Import aborted: Data for selected date already present\")\n   Exit Sub\n\nElse\n\n\nWorkbooks.Open \"C:\\Somefile.xlsx\" 'Here is where you put your filename\n\nSet ws2 = Workbooks(\"Somefile.xlsx\").Worksheets(\"Historic\")\n\nLastRow = ws2.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = ws2.Cells(1, Columns.Count).End(xlToLeft).Column\n\nws2.Range(ws2.Cells(2, 2), ws2.Cells(LastRow, LastCol)).ClearContents\n\nm_import = ws1.Cells(17, 9)\n\nFor x = 2 To LastRow\n\n        ws2.Cells(x, 2) = m_import\n\nNext x\n\nEnd If\n\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6449510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ea22a93c9e189fa949527c4e5130b6?s=128&d=identicon&r=PG&f=1", "display_name": "steep_learning_curve", "link": "https://stackoverflow.com/users/6449510/steep-learning-curve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 37969267, "answer_count": 1, "score": 0, "last_activity_date": 1466624964, "creation_date": 1466598683, "last_edit_date": 1531164843, "question_id": 37968094, "link": "https://stackoverflow.com/questions/37968094/how-do-i-use-a-loop-to-paste-my-selected-text-into-cells", "title": "How do I use a loop to paste my selected &quot;text&quot; into cells?", "body": "<p>I'm trying to input text for example \"code\" into a column, using the Counta formula in two cells in my historic tab.</p>\n\n<p><code>mystart</code> and <code>mystop</code> both have Counta formulas in the cells and I want to paste the word \"code\" for example in all the cells between the two values, but I don't how to finish my code.</p>\n\n<p>The text \"code\" will change thought out my code to something else </p>\n\n<pre><code>Sub MON_ImportHistory()\n\nSheets(\"Historic\").Range(\"B2:AZ3000\").ClearContents\n\n'\nIf Worksheets(\"Help\").Cells(18, 9) = \"Data already present\" Then\n   MsgBox (\"Import aborted: Data for selected date already present\")\n\nElse\n\nDim myRange As Range\nDim NumRows As Integer\nDim myCopyrange As Range\nDim mystart As Range\nDim mystop As Range\n\n\n\nm_import = Worksheets(\"Help\").Cells(17, 9)\nm_criteria = \"=\" &amp; m_import\n\n\n\nWorkbooks.Open Filename:= _\n    \"file on my data base\"\nSheets(\"Historic\").Select\nIf Application.WorksheetFunction.CountIf(Range(\"A:A\"), m_import) &gt; 0 Then\n   m_Filterrange = \"$A$1:$AV$\" &amp; Trim(Str(Worksheets(\"Historic\").Cells(1, 18) - 1))\n   ActiveSheet.Range(m_Filterrange).AutoFilter Field:=1, Criteria1:= _\n   m_criteria, Operator:=xlAnd\n\n   m_extractrange = \"$A$90000:$AV$\" &amp; Trim(Str(Worksheets(\"Historic\").Cells(1, 18) - 1))\n   Range(m_extractrange).Select\n   Selection.Copy\n   Windows(\"My File name\").Activate\n   Sheets(\"Historic\").Select\n   mystart = Worksheets(\"Historic\").Cells(1, 19)\n   mystop = Worksheets(\"Historic\").Cells(1, 20)\n\n   For x = mystart To mystop\n\n   myDestination = \"B\" &amp; Trim(Str(Worksheets(\"Historic\").Cells(1, 19)))\n   Range(myDestination).Select\n   ActiveSheet.Paste\n   Windows(\"My file name\").Activate\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1466599029, "creation_date": 1466599029, "answer_id": 37968225, "question_id": 37967999, "link": "https://stackoverflow.com/questions/37967999/importing-specific-text-from-text-file-into-excel-sheet/37968225#37968225", "title": "Importing specific text from text file into excel sheet", "body": "<p>This should do the job. When the next line in your .txt file isn't a 'header', then paste in the adjacent column to <code>x</code></p>\n\n<pre><code>Private Sub DatafrmTxt()\n\nDim myFile As String, text As String\nDim F As Long\nDim x As Integer, col As Integer\n\nmyFile = \"C:\\test.txt\"\n\nF = FreeFile\nx = 1\n\nOpen myFile For Input As F\nDo Until EOF(F)\nLine Input #F, text\n\n   If InStr(text, \"^USER \") &gt; 0 Then\n      Range(\"A\" &amp; x).Value = text\n      x = x + 1\n      col = 2\n   Else\n      Cells(x, col).Value = text\n      col = col + 1\n   End If\n\nLoop\n\nEnd Sub \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1466599292, "creation_date": 1466599292, "answer_id": 37968346, "question_id": 37967999, "link": "https://stackoverflow.com/questions/37967999/importing-specific-text-from-text-file-into-excel-sheet/37968346#37968346", "title": "Importing specific text from text file into excel sheet", "body": "<p>Something like this might help, I've not got the correct file, so tried it with HTML using HTML tags, it may need some tweaking.  It uses the Scripting Runtime reference</p>\n\n<pre><code>Sub TestTextStream()\n\nDim f As Scripting.FileSystemObject\nDim t As Scripting.TextStream\nDim lngRow As Long\nDim intXshift As Integer\n\nSet f = New Scripting.FileSystemObject\n\n Set t = f.OpenTextFile(\"c:\\test\\JavascriptAccordian.txt\", ForReading)\n\nlngRow = 1\n\nWhile Not t.AtEndOfStream\n\n    If Left(t.ReadLine, 1) = \"^\" Then\n        intXshift = 0\n        lngRow = lngRow + 1\n        Range(\"a\" &amp; lngRow).value = t.ReadLine\n    Else\n        Range(\"b\" &amp; lngRow).Offset(0, intXshift).value = t.ReadLine\n        intXshift = intXshift + 1\n    End If\n\nWend\n\nSet t = Nothing\nSet f = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6499142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d84e096ea8259f094aac9b5029d2e0?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/6499142/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466605303, "creation_date": 1466598418, "last_edit_date": 1531164843, "question_id": 37967999, "link": "https://stackoverflow.com/questions/37967999/importing-specific-text-from-text-file-into-excel-sheet", "title": "Importing specific text from text file into excel sheet", "body": "<p>I am trying to import a text file into Excel through VBA, but after a lot of searching and tests I can't seem to figure out how to format it as I want.</p>\n\n<p>Here's a part of the text file:</p>\n\n<pre><code>^USER ADDRESS\nUser's name\nStreet address\nPostal code and town\n^USER ORDER NUMBER\nOrder number\n^AND SO ON.....\n</code></pre>\n\n<p>When importing, I want it to format it like this:</p>\n\n<pre><code>^USER ADDRESS | User's name | Street address | Postal code and town\n^USER ORDER NUMBER | Order number\n^AND SO ON .... \n</code></pre>\n\n<p>This is my script this far. It copies the rows including ^USER and pastes it - but I need it to copy the row(s) below each ^ until the next ^.</p>\n\n<pre><code>Private Sub DatafrmTxt()\n\nDim myFile As String, text As String\nDim F As Long\nDim x As Integer\n\nmyFile = \"C:\\test.txt\"\n\nF = FreeFile\nx = 1\n\nOpen myFile For Input As F\nDo Until EOF(F)\nLine Input #F, text\n\nIf InStr(text, \"^USER \") &gt; 0 Then\nRange(\"A\" &amp; x).Value = text\nx = x + 1\nEnd If\nLoop\nClose F\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "printing"], "comments": [{"owner": {"reputation": 1096, "user_id": 2436859, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ac93344f8743c4577c1fe1bafdf2c905?s=128&d=identicon&r=PG", "display_name": "Taegost", "link": "https://stackoverflow.com/users/2436859/taegost"}, "edited": false, "score": 1, "creation_date": 1466598748, "post_id": 37967998, "comment_id": 63381930, "body": "How do you want it to display?  3-dimensional arrays are hard to display on a 2-dimensional screen without explicitly telling it how to display"}], "answers": [{"comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 1, "creation_date": 1466600671, "post_id": 37968412, "comment_id": 63383503, "body": "I would like to replace <code>0</code> to <code>Lbound(myArray,1)</code>, <code>Lbound(myArray,2)</code>, <code>Lbound(myArray,3)</code> ."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1466599445, "creation_date": 1466599445, "answer_id": 37968412, "question_id": 37967998, "link": "https://stackoverflow.com/questions/37967998/vba-print-out-an-three-dimension-data/37968412#37968412", "title": "vba print out an three dimension data", "body": "<p>You can always nest a <code>For</code> loop as such:</p>\n\n<pre><code>For d1 = 0 to Ubound(myArray,1)\n    For d2 = 0 to UBound(myArray,2)\n        For d3 = 0 to UBound(myArray, 3)\n            sValue = sValue &amp; vbNewLine &amp; myArray(d1, d2, d3)\n        Next\n    Next\nNext\nMsgBox sValue\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6499161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3da3f83f5c4e3ecc173af8fb5bfb7bd?s=128&d=identicon&r=PG&f=1", "display_name": "leb.james", "link": "https://stackoverflow.com/users/6499161/leb-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466599445, "creation_date": 1466598417, "question_id": 37967998, "link": "https://stackoverflow.com/questions/37967998/vba-print-out-an-three-dimension-data", "title": "vba print out an three dimension data", "body": "<p>how to display a 3-dimension array without knowing its exactsize? If the variable name is DataSet. But I'm not sure the height and the length.       In Macro,</p>\n\n<pre><code>msgbox(DataSet) 'type mismatch\nmsgbox(DataSet(0,0,0))'subscript out of range\n</code></pre>\n\n<p>or give general example. Appreciate your help, thanks. </p>\n"}, {"tags": ["vba", "excel", "syntax"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466598181, "post_id": 37967846, "comment_id": 63381503, "body": "What is the error?"}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466600717, "post_id": 37967846, "comment_id": 63383554, "body": "The error is within the If statement, the entire statement is highlighted."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466600967, "post_id": 37967846, "comment_id": 63383750, "body": "What is the error though, it will say"}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466601599, "post_id": 37967846, "comment_id": 63384309, "body": "My mistake, I misread. When I run it, it slows down/freezes excel to the point where I have to restart. Because I have to restart, there is no error given. The reason I knew where the error was is because it did not freeze once the first time I tried, but I cannot remember what the error read. Since then, its been all freezing."}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466605105, "post_id": 37967846, "comment_id": 63387651, "body": "Run-time Error 1004: Application-defined or object-defined error"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466606766, "post_id": 37967846, "comment_id": 63389108, "body": "have you tried debugging the code, adding a breakpoint at the line and then evaluating each of the IFs see which one is giving the error"}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466684823, "post_id": 37967846, "comment_id": 63426885, "body": "I&#39;ve tried going line by line, and each individual criteria works together, except the last one. Granted, what I want it to output is not correct because it is missing that last line; however, it does write to the sheet I want. That third &quot;And...&quot; line slows it all up and seems to screw up the results when I un-comment it."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1466601309, "post_id": 37968650, "comment_id": 63384046, "body": "I&#39;ve updated with some pictures. I will try your code you just sent and let you know. Thanks!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1466604360, "post_id": 37968650, "comment_id": 63386992, "body": "@Justin Anderson , try the code above. I made a modification to the following line <code>For i = 4 To Worksheets(&quot;Chart Data&quot;).Cells(Rows.count, &quot;B&quot;).End(xlUp).row</code> , you need to adjust Column &quot;B&quot; to whatever column holds the datayou are scanning."}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1466605049, "post_id": 37968650, "comment_id": 63387597, "body": "You have fixed my freezing problem, however I am still getting an error now with that If statement. Run-time Error 1004: application-defined or object-defined error"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1466605342, "post_id": 37968650, "comment_id": 63387859, "body": "@Justin Anderson, I am not getting any errors with this code. Do you have other Excel workbooks open ? Make sure your worksheets names are spelled exactly like in your code &quot;Running Avg Log&quot; and &quot;Chart Data&quot;."}, {"owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "edited": false, "score": 0, "creation_date": 1466605551, "post_id": 37968650, "comment_id": 63388044, "body": "Nope, no other workbooks open, and spelling is all correct. Am I missing something minuscule here?"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1466604268, "last_edit_date": 1466604268, "creation_date": 1466600006, "answer_id": 37968650, "question_id": 37967846, "link": "https://stackoverflow.com/questions/37967846/syntax-loop-errors/37968650#37968650", "title": "Syntax / Loop Errors", "body": "<p>The following updated piece of code works without throwing errors.\nHowever, not sure what do you want to code to do ?? \nWhere exactly are your table's values ? Where do you want to place them ?</p>\n\n<p>Try attaching a screenshot of the desired worksheet results your are trying to obtain.</p>\n\n<pre><code>Sub GraphLoop()\n\nDim i, j, k, m                          As Long\n\nWorksheets(\"Chart Data\").Range(\"C6:DR10000\").Value = \"\"\n\nj = 3\n    Do Until Worksheets(\"Chart Data\").Cells(4, j).Value = \"\"\n        For i = 4 To Worksheets(\"Chart Data\").Cells(Rows.count, \"B\").End(xlUp).row  ' modify according to your Column                k = i + 3\n            m = i + 2\n\n            ThisWorkbook.Sheets(\"Running Avg Log\").Activate\n            ' If the current row in running avg log doesnt meet this if statement criteria, it skips &amp; increments i w/o doing anything\n            If Worksheets(\"Running Avg Log\").Cells(i, 2).Value = 1 _\n                And Worksheets(\"Running Avg Log\").Cells(i, 3).Value = 1 _\n                And Worksheets(\"Running Avg Log\").Cells(i, 4).Value = 1 _\n                And Worksheets(\"Running Avg Log\").Cells(i, 1).Value = Worksheets(\"Chart Data\").Cells(k, 1).Value Then\n\n                ThisWorkbook.Worksheets(\"Chart Data\").Activate\n                ' When if statement is entered, this sets the selected dimension # in this accepted row and puts it into corresponding spot in chart data\n                Worksheets(\"Chart Data\").Cells(m, j).Value = Worksheets(\"Running Avg Log\").Cells(i, 6 + Worksheets(\"Analysis\").Range(\"C5\").Value).Value\n            End If\n        Next i\n\n        ' j (column number) will increment across after each row in one column is done, testing the entire table\n        j = j + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6499135, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/61a1ffd5b17daac4a66b52d476607fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Anderson", "link": "https://stackoverflow.com/users/6499135/justin-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 37968650, "answer_count": 1, "score": 1, "last_activity_date": 1466691782, "creation_date": 1466597987, "last_edit_date": 1466691782, "question_id": 37967846, "link": "https://stackoverflow.com/questions/37967846/syntax-loop-errors", "title": "Syntax / Loop Errors", "body": "<p>I am coding a nested loop to run through every cell (row and then column) of a table I have. Each cell has a distinct \"combination\" that it must be equal to, and if it matches values that I am referencing on another sheet, it will take a value (specified in Analysis worksheet) from that same row and return it in this table. Here's my code. I am getting an error in the larger If statement. Any help is appreciated. Thanks!</p>\n\n<p>Updated code, all works except the last \"And...\" within the if statement. Without it, the code runs, but not correctly (for obvious reasons). When I include it back in, excel freezes up and it never finishes running. Please help.</p>\n\n<p>Private Sub Worksheet_Change(ByVal Target As Range)</p>\n\n<p>Dim i, j, k, m, n As Long</p>\n\n<p>Worksheets(\"Chart Data\").Range(\"C6:DR10000\").Value = \"\"</p>\n\n<p>j = 3</p>\n\n<pre><code>Do Until Worksheets(\"Chart Data\").Cells(4, j).Value = \"\"\n\n    For i = 4 To Worksheets(\"Chart Data\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n        k = i + 3\n        m = i + 2\n        n = 1\n\n        ThisWorkbook.Sheets(\"Running Avg Log\").Activate\n        ' If the current row in running avg log doesnt meet this if statement criteria, it skips &amp; increments i w/o doing anything\n        If Worksheets(\"Running Avg Log\").Cells(i, 2).Value = 1 _\n            And Worksheets(\"Running Avg Log\").Cells(i, 3).Value = n _\n            And Worksheets(\"Running Avg Log\").Cells(i, 4).Value = 1 _\n            And Worksheets(\"Running Avg Log\").Cells(i, 1).Value = Worksheets(\"Chart Data\").Cells(k, 2).Value Then\n\n            ' When if statement is entered, this sets the selected dimension # in this accepted row and puts it into corresponding spot in chart data\n            Worksheets(\"Chart Data\").Cells(m, j).Value = Worksheets(\"Running Avg Log\").Cells(i, 6 + Worksheets(\"Analysis\").Range(\"C5\").Value).Value\n\n            n = n + 1\n\n        End If\n    Next i\n\n    ' j (column number) will increment across after each row in one column is done, testing the entire table\n    j = j + 1\nLoop\n</code></pre>\n\n<p>End Sub  </p>\n\n<p><a href=\"http://i.stack.imgur.com/Fe6nD.png\" rel=\"nofollow\">sheet where code will input the values</a></p>\n\n<p><a href=\"http://i.stack.imgur.com/5hzDu.png\" rel=\"nofollow\">sheet where the values are found. If statement looks for date, and the three values following the date. If they match what i want, it returns one of the dimension numbers in that same row. The dimension number is a drop down menu cell selected in the Analysis worksheet, and can be referenced with the cell I have shown in the line within the If statement.</a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 523, "user_id": 4790933, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5aca199c41cf592863b3487daf714ffb?s=128&d=identicon&r=PG&f=1", "display_name": "LifeOfPi", "link": "https://stackoverflow.com/users/4790933/lifeofpi"}, "edited": false, "score": 0, "creation_date": 1466598221, "post_id": 37967802, "comment_id": 63381533, "body": "No its not. VB string type can hold data more than 255 character."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466598360, "post_id": 37967802, "comment_id": 63381652, "body": "use a string?????? <a href=\"https://msdn.microsoft.com/en-us/library/thwcx436.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/thwcx436.aspx</a>"}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466599025, "post_id": 37967802, "comment_id": 63382143, "body": "@Nathan_Sav I have updated my question."}, {"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1466602148, "post_id": 37967802, "comment_id": 63384841, "body": "probably not a string issue, more likely a limitation on commandbutton.parameter but it&#39;s not documented. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff861822.aspx\" rel=\"nofollow noreferrer\">link</a>  I&#39;d try storing your parameters in an array/dictionary and using the id/key as a parameter."}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "reply_to_user": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1466603073, "post_id": 37967802, "comment_id": 63385716, "body": "@Phil Can you give me example about how to pass parameters in array/dictionary that you have tried? It will be helpful to get some idea. (there can be 100 buttons and that all initialize when Ms Word started. In short, above code is execute when Word start and button click event will fire when user click.)"}], "answers": [{"comments": [{"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466599044, "post_id": 37967960, "comment_id": 63382159, "body": "I have updated my question. Please suggest me accordingly."}, {"owner": {"reputation": 523, "user_id": 4790933, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5aca199c41cf592863b3487daf714ffb?s=128&d=identicon&r=PG&f=1", "display_name": "LifeOfPi", "link": "https://stackoverflow.com/users/4790933/lifeofpi"}, "reply_to_user": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466600616, "post_id": 37967960, "comment_id": 63383454, "body": "The maximum length of text on MsgBox is approximately 1024 characters, depending on the width of the characters used. Did you checked whether Application.CommandBars.ActionControl.Parameter line giving you any ouput. Try to get first 50 character."}, {"owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "edited": false, "score": 0, "creation_date": 1466602040, "post_id": 37967960, "comment_id": 63384731, "body": "I have tried 2 cases. 1- I have passed 244 character in parameter. On other side <code>parameterText = Application.CommandBars.ActionControl.Parameter</code> returns all 244 character........ 2- I have passed 259 character in parameter. On other side <code>parameterText = Application.CommandBars.ActionControl.Parameter</code> returns blank. I really need to manage this. Please suggest if you have any idea."}], "tags": [], "owner": {"reputation": 523, "user_id": 4790933, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5aca199c41cf592863b3487daf714ffb?s=128&d=identicon&r=PG&f=1", "display_name": "LifeOfPi", "link": "https://stackoverflow.com/users/4790933/lifeofpi"}, "is_accepted": false, "score": 1, "last_activity_date": 1466603748, "last_edit_date": 1466603748, "creation_date": 1466598299, "answer_id": 37967960, "question_id": 37967802, "link": "https://stackoverflow.com/questions/37967802/how-to-pass-more-that-255-characters-in-parameter-in-vba/37967960#37967960", "title": "How to pass more that 255 characters in parameter in vba?", "body": "<p>No its not. VB string type can hold data more than 255 character.</p>\n\n<p>A variable-length string can contain up to approximately 2 billion (2^31) characters</p>\n\n<p>A fixed-length string can contain 1 to approximately 64K (2^16) characters. </p>\n\n<p>and for SPLIT you can try like below</p>\n\n<pre><code>Dim LString As String\nDim LArray() As String\n\nLString = \"foobar.com\"\nLArray = Split(LString, \".\")\n\nMsgBox LArray(0)\nMsgBox LArray(1)\n</code></pre>\n\n<p>Note: <a href=\"https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/6x627e5f(v=vs.90).aspx</a></p>\n\n<p>Try to use below code if you get some idea.</p>\n\n<pre><code>Function Over255()\n\n    Dim myArray(3)  As String '&lt;&lt;&lt;&lt;&lt; not variant\n\n    myArray(0) = String(300, \"a\")\n    myArray(1) = String(300, \"b\")\n    myArray(2) = String(300, \"c\")\n    myArray(3) = String(300, \"d\")\n\n    'Over255 = Application.Transpose(myArray())\n    Over255 = TR(myArray)\n\nEnd Function\n\n'like Application.Transpose...\nFunction TR(arrIn) As String()\n    Dim arrOut() As String, r As Long, ln As Long, i As Long\n\n    ln = (UBound(arrIn) - LBound(arrIn)) + 1\n    ReDim arrOut(1 To ln, 1 To 1)\n    i = 1\n    For r = LBound(arrIn) To UBound(arrIn)\n        arrOut(i, 1) = arrIn(r)\n        i = i + 1\n    Next r\n    TR = arrOut\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "is_accepted": true, "score": 1, "last_activity_date": 1466605021, "last_edit_date": 1466605021, "creation_date": 1466604182, "answer_id": 37970395, "question_id": 37967802, "link": "https://stackoverflow.com/questions/37967802/how-to-pass-more-that-255-characters-in-parameter-in-vba/37970395#37970395", "title": "How to pass more that 255 characters in parameter in vba?", "body": "<p>Assuming that there is a limitation on the .parameter, you can bypass this by using an array to store the string you want to display.</p>\n\n<pre><code> Option Explicit\n\n    Public AllParameters(100) As String\n    Public AllAdviceTexts(100) as String\n\n\n    Sub defineParameters()\n\n    AllParameters(0) = \"First Parameter Value\"\n    AllParameters(1) = \"Third Parameter Value \"\n    AllParameters(2) = \"Third Parameter Value \"\n    'etc\n'set advice texts here too    \n\n    End Sub\n\n\n    Private Sub Workbook_Open()\n\n    Dim AdviceItem As CommandBarButton\n    Dim i As Integer\n    Call defineParameters\n    For i = 0 To 100\n\n    Set AdviceItem = CategoryItem.Controls.Add(msoControlButton, , , , True)\n    With AdviceItem\n        .Caption = AllAdviceTexts(i)\n        .Visible = True\n        .Parameter = i\n        .OnAction = \"myFunction\"\n    End With\n\n    Next i\n\n    End Sub\n\n\n    Sub myFunction()\n        Dim parameterText As String\n        Dim index As Integer\n        index = Application.CommandBars.ActionControl.Parameter\n        parameterText = AllParameters(index)\n        MsgBox (\"parameterText\" &amp; parameterText)\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1701, "user_id": 5462074, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3081c0aa6736a12c971dd5f9e33bcb85?s=128&d=identicon&r=PG&f=1", "display_name": "Nanji Mange", "link": "https://stackoverflow.com/users/5462074/nanji-mange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2349, "favorite_count": 0, "accepted_answer_id": 37970395, "answer_count": 2, "score": 0, "last_activity_date": 1466605021, "creation_date": 1466597866, "last_edit_date": 1466599010, "question_id": 37967802, "link": "https://stackoverflow.com/questions/37967802/how-to-pass-more-that-255-characters-in-parameter-in-vba", "title": "How to pass more that 255 characters in parameter in vba?", "body": "<p>I have a button and I pass String as parameter. If string parameter increase more that 255 characters, it doesn't get any value. If string parameter is less than 255 characters, it is working fine.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim parameterText As String\nparameterText = \"First Parameter Value | Third Parameter Value | Third Parameter Value\"\nDim AdviceItem As CommandBarButton\nSet AdviceItem = CategoryItem.Controls.Add(msoControlButton, , , , True)               \nWith AdviceItem\n    .Caption = adviceText\n    .Visible = True\n    .Parameter = strParameter\n    .OnAction = \"myFunction\"\nEnd With\n\nSub myFunction()\n    Dim parameters() As String\n    ReDim parameters(3)\n    Dim parameterText As String\n    parameterText = Application.CommandBars.ActionControl.Parameter\n    'parameterText is blank if there are more than 255 characters passed from above function\n    MsgBox (\"parameterText\" &amp; parameterText)\n    parameters() = Split(parameterText, \"|\")\nEnd Sub\n</code></pre>\n\n<p>Can anybody suggest me how to achieve it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1466595766, "post_id": 37966853, "comment_id": 63379788, "body": "Just add a formula into E1 that reads <code>=A1</code>?  No VBA required here at all to copy the value from one cell to the other.  Or is that not what you&#39;re after?  It&#39;s a little unclear."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1466595939, "creation_date": 1466595939, "answer_id": 37967108, "question_id": 37966853, "link": "https://stackoverflow.com/questions/37966853/writing-a-cell-in-excel/37967108#37967108", "title": "Writing a cell in Excel", "body": "<p>In <strong>E1</strong> enter the formula:</p>\n\n<pre><code>=\"minimum:\" &amp; A1 &amp; \"():utilization\"\n</code></pre>\n\n<p>as you update <strong>A1</strong>, the displayed text in <strong>E1</strong> will follow.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 3769813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b1e590cf0fa22495928da8d98562b?s=128&d=identicon&r=PG&f=1", "display_name": "dknedtn", "link": "https://stackoverflow.com/users/3769813/dknedtn"}, "edited": false, "score": 0, "creation_date": 1466608279, "post_id": 37968777, "comment_id": 63390254, "body": "what does &quot;#,##0.00&quot; stand for?"}, {"owner": {"reputation": 51, "user_id": 1409706, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/135e9e7eedc6cfa624fc0dc24ec7a518?s=128&d=identicon&r=PG", "display_name": "Cuchulainn", "link": "https://stackoverflow.com/users/1409706/cuchulainn"}, "reply_to_user": {"reputation": 11, "user_id": 3769813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b1e590cf0fa22495928da8d98562b?s=128&d=identicon&r=PG&f=1", "display_name": "dknedtn", "link": "https://stackoverflow.com/users/3769813/dknedtn"}, "edited": false, "score": 0, "creation_date": 1466967651, "post_id": 37968777, "comment_id": 63524106, "body": "It gives you thousand separator and 2 decimals as a number format. See also <a href=\"https://support.office.com/en-us/article/Create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4\" rel=\"nofollow noreferrer\">link</a>."}], "tags": [], "owner": {"reputation": 51, "user_id": 1409706, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/135e9e7eedc6cfa624fc0dc24ec7a518?s=128&d=identicon&r=PG", "display_name": "Cuchulainn", "link": "https://stackoverflow.com/users/1409706/cuchulainn"}, "is_accepted": false, "score": -1, "last_activity_date": 1466600332, "creation_date": 1466600332, "answer_id": 37968777, "question_id": 37966853, "link": "https://stackoverflow.com/questions/37966853/writing-a-cell-in-excel/37968777#37968777", "title": "Writing a cell in Excel", "body": "<p>Adding to the solutions already given, you can define the format to be used for A1 with the TEXT function:</p>\n\n<pre><code>=\"minimum:\" &amp; TEXT(A1,\"#,##0.00\") &amp; \"():utilization\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3769813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b1e590cf0fa22495928da8d98562b?s=128&d=identicon&r=PG&f=1", "display_name": "dknedtn", "link": "https://stackoverflow.com/users/3769813/dknedtn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1466608493, "creation_date": 1466595332, "last_edit_date": 1466608493, "question_id": 37966853, "link": "https://stackoverflow.com/questions/37966853/writing-a-cell-in-excel", "title": "Writing a cell in Excel", "body": "<p>This query might seem a bit childish, but this has been bugging me for quite a few days.\nI am completely new to Microsoft Excel and want to know how do hold same values in two different excel cells?</p>\n\n<blockquote>\n  <p>Example: Cell A1=bandwidth Cell E1=[minimum:bandwidth():utilization]\n  I want the word \"bandwidth\" to be same in both the cells. So if the user\n  inputs \"bandwidth\" into cell A1, then this generated into E1.</p>\n</blockquote>\n\n<p>Kindly help me with this one.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1466594395, "post_id": 37966384, "comment_id": 63378911, "body": "But Excel can handle only <b><i>15</i></b> digits."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1466594838, "post_id": 37966384, "comment_id": 63379176, "body": "@Gary&#39;sStudent I feel inclined to specify: you can <a href=\"https://msdn.microsoft.com/en-us/library/x99xtshc.aspx\" rel=\"nofollow noreferrer\">enter and use much larger numbers</a>. But Excel should not be used if a precision beyond the 15th digit is important: <a href=\"http://superuser.com/questions/373997/adding-more-than-15-digits-in-excel\" title=\"adding more than 15 digits in excel\">superuser.com/questions/373997/&hellip;</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1466619145, "post_id": 37966384, "comment_id": 63397085, "body": "I believe my solution will work for your situation."}, {"owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "edited": false, "score": 0, "creation_date": 1467123562, "post_id": 37966384, "comment_id": 63594066, "body": "Can you please say the correct answer for 3259300700853850 (Dividend)  and 97 (divisor)?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1467305991, "post_id": 37966384, "comment_id": 63689671, "body": "All the examples in bounty description have wrong results. <code>98-mod(3100400300327166;97)=50</code> <b>but</b> <code>98-mod(3100400300327166*100;97)=51</code>, you have correct answer from @RonRosenfeld, if it doesn&#39;t work - you have to describe in detail why."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1467309809, "post_id": 37966384, "comment_id": 63691815, "body": "@BrakNicku As you wrote, my UDF gives all the correct results (as per the current rendition in bounty description).  When Stefan commented that he was having a problem with the UDF, I asked about system separator issues, as that is one cause, but he never responded.  I will post a screen shot of his numbers and the results of my formula in my Answer."}], "answers": [{"comments": [{"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1466606805, "post_id": 37966640, "comment_id": 63389138, "body": "I&#39;ve tried this vba code, but it returns  an overflow error. I&#39;m not sure that is correct?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1466607613, "post_id": 37966640, "comment_id": 63389773, "body": "Neither of your solutions will work as the OP wants to deal with 16 digit numbers"}, {"owner": {"reputation": 203, "user_id": 964789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac0e3f86e1101afb4511597fe32a1039?s=128&d=identicon&r=PG", "display_name": "Robbie", "link": "https://stackoverflow.com/users/964789/robbie"}, "edited": false, "score": 0, "creation_date": 1466609452, "post_id": 37966640, "comment_id": 63391067, "body": "I thought Excel could handle very long numbers - just with the caveat of imprecision - so I dug further. I&#39;ll update my suggested solution shortly."}, {"owner": {"reputation": 203, "user_id": 964789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac0e3f86e1101afb4511597fe32a1039?s=128&d=identicon&r=PG", "display_name": "Robbie", "link": "https://stackoverflow.com/users/964789/robbie"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1466610121, "post_id": 37966640, "comment_id": 63391575, "body": "Hi @Stefan0309, my suggested solution is updated above. This gives me the expected numbers (in Excel 2013)."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1466613890, "post_id": 37966640, "comment_id": 63393992, "body": "But the number you are testing is <code>200,000,000,012,346,000</code> and the number in the OP&#39;s post was <code>200,000,000,012,345,600</code>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1466614318, "post_id": 37966640, "comment_id": 63394244, "body": "Also, I think, even using your <code>200,000,000,012,346,000 </code> value, you are getting the wrong result.  Using your code in Excel 2016, I get <code>94</code> as the result.  Using my code, xNumbers, or an online <a href=\"http://www.javascripter.net/math/calculators/100digitbigintcalculator.htm\" rel=\"nofollow noreferrer\">Big Integer Calculator</a>, I get <code>13</code> as a result."}, {"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1467116787, "post_id": 37966640, "comment_id": 63588936, "body": "For number <code>160580010074623000</code> it must be 7 and for example <code>160580010074613000</code> it must be also 7 control digit."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1467309019, "post_id": 37966640, "comment_id": 63691329, "body": "@Stefan0309  Those are not the correct results for the formula <code>MOD(160580010074623000,97)</code> \u25ba <code>95</code>  and <code>MOD(160580010074613000,97)</code> \u25ba 86"}], "tags": [], "owner": {"reputation": 203, "user_id": 964789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac0e3f86e1101afb4511597fe32a1039?s=128&d=identicon&r=PG", "display_name": "Robbie", "link": "https://stackoverflow.com/users/964789/robbie"}, "is_accepted": false, "score": 0, "last_activity_date": 1466638055, "last_edit_date": 1466638055, "creation_date": 1466594728, "answer_id": 37966640, "question_id": 37966384, "link": "https://stackoverflow.com/questions/37966384/excel-error-on-function-mod/37966640#37966640", "title": "Excel error on function MOD", "body": "<p><strong>For numbers with abs() less than or equal to 2,147,483,647</strong></p>\n\n<p>This is a known issue per the Microsoft Support article <a href=\"https://support.microsoft.com/en-us/kb/119083\" rel=\"nofollow\">XL: MOD() Function Returns #NUM! Error Value</a>.</p>\n\n<p>Note that this article is quite dated - so this might not be the true root cause in your instance.</p>\n\n<p>The article suggests the following as a workaround:</p>\n\n<blockquote>\n  <p>Instead of using this formula <code>=MOD(J13,K13)</code> use this formula: <code>=J13-(INT(J13/K13)*K13)</code></p>\n</blockquote>\n\n<p>Alternatively, <a href=\"http://excel.tips.net/T003302_Large_Numbers_in_the_MOD_Function.html\" rel=\"nofollow\">this article</a> suggests a VBA equivalent:</p>\n\n<pre><code>Function DblMod(Dividend, Divisor)\n    ' Declare two double precision variables\n    Dim D1 As Double\n    Dim D2 As Double\n\n    ' Copy function arguments to local variables\n    D1 = Dividend\n    D2 = Divisor\n\n    DblMod = D1 Mod D2\nEnd Function\n</code></pre>\n\n<p><strong>For numbers with abs() greater than 2,147,483,647</strong></p>\n\n<p>In this scenario, the VBA MOD function overflows with <code>Run Time Error '6': Overflow</code>. This is addressed in Microsoft Support article <a href=\"https://support.microsoft.com/en-us/kb/205053\" rel=\"nofollow\">PRB: \"Overflow\" with Integer Division and MOD Operator</a>. The article suggests the below solution in VBA, which I have tested works as expected with the OP's given numbers:</p>\n\n<pre><code>Sub Main()\n    Call DblMod2(3259300700853850, 97) \n    ' returns 46, which matches the Big Integer Calculator at http://www.javascripter.net/math/calculators/100digitbigintcalculator.htm suggested by Ron\nEnd Sub\n\nFunction DblMod2(Dividend, Divisor)\n\n    Dim dblX As Double\n    Dim dblY As Double\n    dblX = Dividend               ' numerator\n    dblY = Divisor                ' denominator\n\n    ' round off the numerator and denominator (ensure number is .0)\n    dblX = Int(dblX + 0.5)\n    dblY = Int(dblY + 0.5)\n\n    ' Emulate integer division with: Fix(dblX / dblY)\n    ' Emulate modulo arithmetic with: dblX - (dblY * Fix(dblX / dblY))\n    DblMod2 = dblX - (dblY * Fix(dblX / dblY))\n    Debug.Print DblMod2\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1466607658, "post_id": 37966956, "comment_id": 63389804, "body": "Note that the last digit in the OP&#39;s 16 digit number has been changed"}], "tags": [], "owner": {"reputation": 2637, "user_id": 2231100, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QGMnf.jpg?s=128&g=1", "display_name": "Karthick Gunasekaran", "link": "https://stackoverflow.com/users/2231100/karthick-gunasekaran"}, "is_accepted": false, "score": 0, "last_activity_date": 1467126265, "last_edit_date": 1495535332, "creation_date": 1466595566, "answer_id": 37966956, "question_id": 37966384, "link": "https://stackoverflow.com/questions/37966384/excel-error-on-function-mod/37966956#37966956", "title": "Excel error on function MOD", "body": "<p>There is an alternate for the MOD function <a href=\"https://stackoverflow.com/questions/4378047/vba-equivalent-to-excels-mod-function\">here</a> </p>\n\n<pre><code>a - (b * (a / b))\n\n=98-((2000000000123450*100)-(97*((2000000000123450*100)/97)))\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>Try with below, it will return 46</p>\n\n<pre><code>Function DblMod(Dividend, Divisor)\n    ' Declare two double precision variables\n    Dim D1 As Double\n    Dim D2 As Double\n    Dim D3 As Double\n    Dim str1\n    Dim Str2\n    ' Copy function arguments to local variables\n    D1 = CDbl(Dividend)\n    D2 = Divisor\n    DblMod = CDec(D1) - (Round(CDec(D1) / D2) * D2)\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Sub test()\n    test = DblMod(\"3259300700853850\", 97)\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1467118487, "post_id": 37970489, "comment_id": 63590221, "body": "Unfortunately it doesnt let me to run this function, &quot;The formula you typed contains an error&quot;."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1467120952, "post_id": 37970489, "comment_id": 63592065, "body": "@Stefan0309 are you using the correct system separator signal for your Locale. Semicolon vs. Comma period"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "edited": false, "score": 0, "creation_date": 1467308259, "post_id": 37970489, "comment_id": 63690890, "body": "@Stefan0309 Have you checked your system separator that the one you are using is correct for your locale?  If that is correct, please copy and paste (do NOT type in) your exact formulas and data to which the formula refers or, preferably, upload a workbook that shows the problem and post a link here."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1467432061, "post_id": 37970489, "comment_id": 63741728, "body": "Smart solution, you could even slim down the function to just one line      i.e. &#39;xMOD = CDec(Num) - Int(CDec(Num) / CDec(Div)) * CDec(Div)&#39;"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1467456101, "post_id": 37970489, "comment_id": 63746843, "body": "@EEM Thanks.  One liner&#39;s are fun, but they can sometimes make the algorithm a bit more difficult to decipher.  I&#39;ve never tested to see if there is any speed advantage of one way over the other."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 4, "last_activity_date": 1467310013, "last_edit_date": 1467310013, "creation_date": 1466604418, "answer_id": 37970489, "question_id": 37966384, "link": "https://stackoverflow.com/questions/37966384/excel-error-on-function-mod/37970489#37970489", "title": "Excel error on function MOD", "body": "<p>As has been written, Excel has a limitation of 15 digits precision.  So when you enter your formula above, your 16-digit number will be altered:</p>\n\n<p><code>2000000000123456</code> becomes <code>2000000000123460</code></p>\n\n<p>One way to do work around this limitation involves using VBA and also changing your formula.</p>\n\n<p>Instead of writing  <code>16 digit number * 100</code>, enter the entire value as a string:</p>\n\n<p>\"200000000012345600\"</p>\n\n<p>eg:</p>\n\n<pre><code>=98-xMOD(\"200000000012345600\";97)\n</code></pre>\n\n<p>Then use this UDF which makes use of the increased precision afforded by VBA's Decimal data type:</p>\n\n<pre><code>Option Explicit\nFunction xMOD(Num As Variant, Div As Long)\n    Dim x As Variant, y As Variant\n\nx = CDec(Num)\ny = CDec(Div)\n\nxMOD = x - Int(x / y) * y\n\nEnd Function\n</code></pre>\n\n<p>If you will be entering your 16 digit number (<strong>as a string</strong>) in some cell, and always multiplying by 100, you can use the following formula:</p>\n\n<pre><code>=98-xMOD(C1&amp;\"00\";97)\n</code></pre>\n\n<p>Or, you could just enter the 18 digit number, <strong>as a string</strong> into some cell and reference it in your formula, omitting the <code>&amp;\"00\"</code> part.</p>\n\n<p>Another option, if you can find it, would be an unsupported free add-in called <code>xNumbers</code>.  The latest version <code>6.0</code> still works with Excel 2016, although the integration with the ribbon is non-existent, so some of the configuration options cannot be used.</p>\n\n<p><strong>EDIT</strong> Since you wrote that you were unable to get this UDF to work in your system, I will post a screen shot showing that it does work in mine, and also that it agrees with the results you have posted in your bounty description.  (xIntMod from xNumbers also returns the same results)</p>\n\n<p><a href=\"https://i.stack.imgur.com/pJ5RS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pJ5RS.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1467320484, "creation_date": 1467320484, "answer_id": 38133190, "question_id": 37966384, "link": "https://stackoverflow.com/questions/37966384/excel-error-on-function-mod/38133190#38133190", "title": "Excel error on function MOD", "body": "<p>Instead of dealing with very big numbers, just split them up like this:</p>\n\n<pre><code>Public Function ExtMod(Dividend As String, Divisor As Long) As Double\n  Dim i As Long, j As Double\n  For i = 1 To Len(Dividend)\n    If Not IsNumeric(Mid(Dividend, i, 1)) Then\n      j = j &amp; Mid(Dividend, i)\n      Exit For\n    End If\n    j = j * 10 + Mid(Dividend, i, 1)\n    While j &gt;= Divisor\n      j = j - Divisor\n    Wend\n  Next\n  ExtMod = j\nEnd Function\n</code></pre>\n\n<p>Also works with decimals and locale should not matter. Only limitation is is the max length of strings which you probably never will hit.</p>\n\n<p>Tested it with \"123456789012345678901234567890.3241543\" and 643 which is 435.3241543.</p>\n\n<p>If you have any questions, just ask ;)</p>\n"}], "owner": {"reputation": 1287, "user_id": 5383872, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d36e0367b8929161b2afb4430a6e545f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan0309", "link": "https://stackoverflow.com/users/5383872/stefan0309"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2069, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1467320484, "creation_date": 1466594012, "last_edit_date": 1466606956, "question_id": 37966384, "link": "https://stackoverflow.com/questions/37966384/excel-error-on-function-mod", "title": "Excel error on function MOD", "body": "<p>I want to input this formula in my excel file (VBA preferably). But from some reason I get an error when I put this function im my formula bar:</p>\n\n<pre><code>#NUM! - Number Error\n</code></pre>\n\n<p>My function is:</p>\n\n<pre><code>=98-mod(2000000000123456*100;97))\n</code></pre>\n\n<p>But When I enter just 10 digits, then it works. I need to work with 16 digits.\nI am trying basically to validate number based on  ISO 7064 Mod 97,10 formula\nThanks in advance.</p>\n\n<p>Thanks pepople, for your effort, but I've tried code that @Robyn wrote, and I get overflow error. Here is my code (I will write just Function section):\n'Note: An entering paramters are: 3259300700853850 and 97</p>\n\n<pre><code> Function DblMod(Dividend, Divisor)\n' Declare two double precision variables\nDim D1 As Double\nDim D2 As Double\n' Copy function arguments to local variables\nD1 = Dividend\nD2 = Divisor\nDblMod = D1 Mod D2\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "list", "msgbox"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1466593533, "post_id": 37966121, "comment_id": 63378347, "body": "What did you try so far?"}, {"owner": {"reputation": 264, "user_id": 4948368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UbYt4.jpg?s=128&g=1", "display_name": "Peter Mogford", "link": "https://stackoverflow.com/users/4948368/peter-mogford"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1466595066, "post_id": 37966121, "comment_id": 63379325, "body": "To be honest i haven&#39;t tried anything as i don&#39;t know where to start, the best i could think of was <code>MsgBox &quot; Please complete the following mandatory fields:&quot; &amp; vbNewLine &amp; &quot;Customer Name&quot;</code> but this doesn&#39;t cycle through the list and add each item until it finds a blank cell then stops"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1466595444, "post_id": 37966121, "comment_id": 63379556, "body": "Start with the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264383.aspx\" rel=\"nofollow noreferrer\">documentation</a>.  You could solve this by combining a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251601.aspx\" rel=\"nofollow noreferrer\">for...next</a> with a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251821.aspx\" rel=\"nofollow noreferrer\">MsgBox</a>."}, {"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1466596724, "post_id": 37966121, "comment_id": 63380478, "body": "I wasn&#39;t going to answer this as you showed no existing effort but your comments shows some thought. For best results always give it a shot and explain your issue and how you would like help."}], "answers": [{"tags": [], "owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "is_accepted": false, "score": 1, "last_activity_date": 1466595493, "creation_date": 1466595493, "answer_id": 37966922, "question_id": 37966121, "link": "https://stackoverflow.com/questions/37966121/vba-message-box-with-a-list-of-failed-checks/37966922#37966922", "title": "VBA message box with a list of failed checks", "body": "<p>This assumes CHECK means there's a problem</p>\n\n<pre><code>Sub ErrorMessage()\nDim strErrMsg As String\nDim cell As Range\nIf Application.CountIf(-yourfilteredrangehere-), \"CHECK\") = 0 Then Exit Sub\n'no problems to output\nFor Each cell In Range(-yourfilteredrangehere-)\n    'next line assumes checkitem in previous column, change if not\n    If cell = \"check\" Then strErrMsg = strErrMsg &amp; \"Please check \" &amp; cell.Offset(0, -1) &amp; vbCrLf\nNext cell\nMsgBox strErrMsg\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "is_accepted": true, "score": 1, "last_activity_date": 1466596651, "creation_date": 1466596651, "answer_id": 37967368, "question_id": 37966121, "link": "https://stackoverflow.com/questions/37966121/vba-message-box-with-a-list-of-failed-checks/37967368#37967368", "title": "VBA message box with a list of failed checks", "body": "<p>The below sample goes through <code>Table11</code> and creates a list of all those with marked with 'Check', Then displays a message if there were items.</p>\n\n<pre><code>Public Sub Sample()\nDim LngCounter  As Long\nDim Tbl         As Excel.Range\nDim StrMsg      As String\n\nSet Tbl = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"Table11\")\n    For LngCounter = 2 To Tbl.Rows.Count\n        If Trim(UCase(Tbl.Cells(LngCounter, 2))) = \"CHECK\" Then\n            StrMsg = StrMsg &amp; Tbl.Cells(LngCounter, 1) &amp; vbNewLine\n        End If\n    Next\nSet Tbl = Nothing\n\nIf StrMsg &lt;&gt; \"\" Then\n    MsgBox \"The following items need attention before continuing: - \" &amp; vbNewLine &amp; vbNewLine &amp; StrMsg, vbOKOnly + vbExclamation, \"Data Validation\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 264, "user_id": 4948368, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/UbYt4.jpg?s=128&g=1", "display_name": "Peter Mogford", "link": "https://stackoverflow.com/users/4948368/peter-mogford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 37967368, "answer_count": 2, "score": 0, "last_activity_date": 1466596651, "creation_date": 1466593387, "question_id": 37966121, "link": "https://stackoverflow.com/questions/37966121/vba-message-box-with-a-list-of-failed-checks", "title": "VBA message box with a list of failed checks", "body": "<p>how do i create a message box that shows all of the mandatory fields that have not been filled in.</p>\n\n<p>I am using a table that has an auto filter on it (\"Table11\") to show only the checks that have failed.</p>\n\n<p>I want to translate these into a message box that show when a sales agent tries to create the contract.</p>\n\n<p>Table layout below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bPslA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bPslA.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 4, "creation_date": 1466592741, "post_id": 37965748, "comment_id": 63377816, "body": "I am going to use your question as an example of how to ask a question."}, {"owner": {"reputation": 192, "user_id": 2717382, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/JmAXt.jpg?s=128&g=1", "display_name": "Skaterhaz", "link": "https://stackoverflow.com/users/2717382/skaterhaz"}, "edited": false, "score": 1, "creation_date": 1466593118, "post_id": 37965748, "comment_id": 63378100, "body": "Perhaps <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">MSDN - SpecialCells</a> might help. Particularly <code>xlCellTypeLastCell</code>"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 1, "creation_date": 1466709842, "post_id": 37966048, "comment_id": 63444420, "body": "Thank you for your comment Gary&#39;s Student. I can see how this can work on my sheet. But I have to ask, to perform these actions everytime I add a row, will this slow down my sheet a lot?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1466593185, "creation_date": 1466593185, "answer_id": 37966048, "question_id": 37965748, "link": "https://stackoverflow.com/questions/37965748/vba-code-does-not-look-through-hidden-rows-for-adding-a-row-with-tracking-number/37966048#37966048", "title": "VBA-code does not look through hidden rows for adding a row with tracking number", "body": "<p>Say we have a status column  <strong>AB</strong> and we currently close an item by placing the word \"Closed\" in that column and then hiding the row.</p>\n\n<p><strong>Instead:</strong></p>\n\n<ol>\n<li>Unhide <strong>all</strong> rows</li>\n<li>Perform any required inserts and edits</li>\n<li>Via a loop, hide all rows marked \"Closed\"</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1466665939, "post_id": 37966886, "comment_id": 63413912, "body": "The UsedRange doesn&#39;t necessarily start in row 1. This is unreliable."}, {"owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "reply_to_user": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1466684234, "post_id": 37966886, "comment_id": 63426405, "body": "When I try it with the example that the OP suggested that we use, it works. So based on that... it seems to work just fine. o.O"}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1466709488, "post_id": 37966886, "comment_id": 63444219, "body": "I understand this can be unreliable, but in this specific macro, at that specific point, I think it may work. Thank you for your answer Rodger."}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 1, "creation_date": 1466709971, "post_id": 37966886, "comment_id": 63444501, "body": "To add to my previous comment. I have tested this and it does what it says it does."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 1, "creation_date": 1466730288, "post_id": 37966886, "comment_id": 63452194, "body": "It may work for the case as tested, but <code>UsedRange</code> is unreliable as Excel routinely &quot;forgets&quot; the actual range and Rows.Count in this manner assumes there is data starting in row1."}], "tags": [], "owner": {"reputation": 819, "user_id": 2943555, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5d78c48da39d0b440314f31529ba3098?s=128&d=identicon&r=PG&f=1", "display_name": "Rodger", "link": "https://stackoverflow.com/users/2943555/rodger"}, "is_accepted": false, "score": 0, "last_activity_date": 1466595417, "creation_date": 1466595417, "answer_id": 37966886, "question_id": 37965748, "link": "https://stackoverflow.com/questions/37965748/vba-code-does-not-look-through-hidden-rows-for-adding-a-row-with-tracking-number/37966886#37966886", "title": "VBA-code does not look through hidden rows for adding a row with tracking number", "body": "<p>Use this for getting the last row and it will see the last row, even if it is hidden.</p>\n\n<pre><code>LastRow = wsActiviteiten.UsedRange.Rows.Count\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1466709618, "post_id": 37984288, "comment_id": 63444296, "body": "I am trying to use this specific code in a seperate module on my sheet. When I hide one row, this macro turns up with location of the next value up, but not the hidden one. When reading up on xlFormulas it should turn up a value from a hidden location. Is there something I am missing here?"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1466730326, "post_id": 37984288, "comment_id": 63452205, "body": "@simon are you able to upload a sample workbook (to the cloud etc)?"}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1466772997, "post_id": 37984288, "comment_id": 63470187, "body": "Sure, here you go: we.tl/smyHLFDM49. I have added your code to the sheet already. (this is the second link, the other was not good)."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 1, "creation_date": 1466780209, "post_id": 37984288, "comment_id": 63474740, "body": "@simon pls try this updated code. File was useful :)"}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1466941211, "post_id": 37984288, "comment_id": 63516010, "body": "Thank you for the working code. This is stuff I have not used before, so I am going to see if I can understand what is happening and how I can use it in my code.   I am going on a trip in a few day&#39;s time, if I have not responded by then I will respond when I come. I appreciate it that you are taking the time to help me and I believe it&#39;s only fair that I reply to you when I have cracked this nut. For now I am not going to mark it as answered, since I need to understand and apply this first.  Cheers, Simon"}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1467059542, "post_id": 37984288, "comment_id": 63564465, "body": "It works! With some local help I managed to get it working in my sheet. Can you explain what the code does? We could not fully understand it. As far as I understand it is that Split locates the empty row under a range of data. What Range(1) means we could not find out. There are other elements that go beyond my VBA-skills, but I am fairly certain that with time that will become clear. Also, on another sheet I tried to use the code, but that one has formula&#39;s in cells and this method sees formula&#39;s and goes to the next line to paste. But that is another question for later.Cheers, Simon"}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "reply_to_user": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 1, "creation_date": 1467097244, "post_id": 37984288, "comment_id": 63576137, "body": "@simon This line returns the range of the autofilter <code>ActiveSheet.AutoFilter.Range.Address</code>. The split breaks up the range, and then returns the second portion (ie C10 if the range was C1:C10). <code>Split(ActiveSheet.AutoFilter.Range.Address, &quot;:&quot;)(0))</code> would return the  first portion C1. Range then makes an address of this."}, {"owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "edited": false, "score": 0, "creation_date": 1472123329, "post_id": 37984288, "comment_id": 65631298, "body": "can you help me with another question that is related to this one? It would help me out a lot, cheers. <a href=\"http://stackoverflow.com/questions/39120212/copying-and-adding-a-row-to-the-end-of-the-sheet-with-an-autofilter-enabled-and\" title=\"copying and adding a row to the end of the sheet with an autofilter enabled and\">stackoverflow.com/questions/39120212/&hellip;</a>"}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": true, "score": 2, "last_activity_date": 1466780178, "last_edit_date": 1466780178, "creation_date": 1466664951, "answer_id": 37984288, "question_id": 37965748, "link": "https://stackoverflow.com/questions/37965748/vba-code-does-not-look-through-hidden-rows-for-adding-a-row-with-tracking-number/37984288#37984288", "title": "VBA-code does not look through hidden rows for adding a row with tracking number", "body": "<p><em>Update</em></p>\n\n<p>I see your sheet has an autofilter \"hiding\" the status rows - which <code>Find</code> wont detect, unlike hidden rows. </p>\n\n<p>Suggest you try this updated code below:</p>\n\n<pre><code>Sub Test()\n\nDim rng1 As Range\nIf ActiveSheet.AutoFilterMode Then\n    MsgBox ActiveSheet.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Row\nElse\n    Set rng1 = Columns(\"A:A\").Find(\"*\", [a1], xlFormulas, , xlByRows, xlPrevious)\n    If Not rng1 Is Nothing Then MsgBox rng1.Row\nEnd If\nEnd Sub\n</code></pre>\n\n<p><em>initial post</em></p>\n\n<p>If you are hiding rows then you can use <code>Find</code> with the <code>xlFormulas</code> option to find entries in hidden rows (unlike <code>xlValues</code>).</p>\n\n<pre><code>Dim rng1 As Range\nSet rng1 = Columns(\"A:A\").Find(\"*\", [a1], xlFormulas, , xlByRows, xlPrevious)\nMsgBox rng1.Address\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10238727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be665e37ea17671609e896de1f27b85f?s=128&d=identicon&r=PG", "display_name": "Damir", "link": "https://stackoverflow.com/users/10238727/damir"}, "is_accepted": false, "score": 0, "last_activity_date": 1534500436, "creation_date": 1534500436, "answer_id": 51893041, "question_id": 37965748, "link": "https://stackoverflow.com/questions/37965748/vba-code-does-not-look-through-hidden-rows-for-adding-a-row-with-tracking-number/51893041#51893041", "title": "VBA-code does not look through hidden rows for adding a row with tracking number", "body": "<p>I've just found solution:</p>\n\n<p>If you have at least one column in your range with 'consistent' data (all cells in that column are not empty/blank) you can use formula COUNTA and you can reference you code to value of that COUNTA formula.</p>\n\n<p>For example:</p>\n\n<p>Insert formula '=COUNTA(A1:A100000)' in 'B1' cell.</p>\n\n<p>In B1 you will get how many rows you have they are hidden or not.</p>\n\n<p>In your code change:</p>\n\n<pre><code>wsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteAll)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>wsActiviteiten.Range(\"A\" &amp; Range(\"B1\").Value).Offset(1, 0).PasteSpecial (xlPasteAll)\n</code></pre>\n\n<p>Of course, if, for example, cell 'A2' is blank and this is the only blank cell you will need to adjust your formula to '=COUNTA(A1:A100000) +1'.</p>\n\n<p>If you have more blank/empty cells and you don't know the exact number of them (blank cells have been changed dynamically) this method will not work.\nAs I said previously you need to have at least one column with 'consistent' data (with known number of empty cells in advance if any).</p>\n"}], "owner": {"reputation": 137, "user_id": 6098778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87cf0e0cdb97a4dfac1684b64628ba53?s=128&d=identicon&r=PG&f=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/6098778/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2663, "favorite_count": 0, "accepted_answer_id": 37984288, "answer_count": 4, "score": 7, "last_activity_date": 1534500436, "creation_date": 1466592369, "last_edit_date": 1502190033, "question_id": 37965748, "link": "https://stackoverflow.com/questions/37965748/vba-code-does-not-look-through-hidden-rows-for-adding-a-row-with-tracking-number", "title": "VBA-code does not look through hidden rows for adding a row with tracking number", "body": "<p>I have another question which I hope to resolve with your help. </p>\n\n<p><strong>What do I want to do.</strong>\nI use Excel to track my work, activities, contacts, et cetera. While doing that I found I was doing a lot of repetitive work in adding rows at the end of a sheet called \"Activities\". </p>\n\n<p>What I want to do is this:\n - Press a button and adding a row.\n - Increase the trackingnumber with 1\n - Insert default values</p>\n\n<p><strong>The code.</strong>\nTo automate this, I have found (copy, pasted, adjusted it to my needs) the following code:</p>\n\n<pre><code> Sub AddRowActiviteiten_NewAtEnd()\n'Add's a new row at the end of the sheet.\n\nDim wsActiviteiten As Worksheet\nSet wsActiviteiten = Sheets(\"Activiteiten\")\n\nDefType = \"Daily\"\nDefStatus = \"Open\"\nDefIssue = \"*****\"\nDefImpact = \"*****\"\nDefPrio = \"Laag\"\nMyDate = Date\n\nwsActiviteiten.Range(\"A4\").Value = \"1\"\n\n'Copy the \"One Row To Rule Them All\"\nwsActiviteiten.Range(\"A3:Q3\").Copy\n\nwsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial (xlPasteAll)\n\n'Stop the \"copy-action\"\nApplication.CutCopyMode = False\n\n'Increase the tracking number with \"one\"\nLastNumber = wsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Value\nwsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = LastNumber + 1\n\n'Insert default values\nLastRow = wsActiviteiten.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(-1, 0).Row\nCells(LastRow + 1, 2) = DefType\nCells(LastRow + 1, 3) = DefStatus\nCells(LastRow + 1, 4) = DefIssue\nCells(LastRow + 1, 5) = DefImpact\nCells(LastRow + 1, 6) = DefPrio\nCells(LastRow + 1, 8) = MyDate\n\n'Step down 1 row from present location.\nActiveCell.Offset(1, 0).Select\n\nEnd Sub\n</code></pre>\n\n<p><strong>The problem.</strong>\nIn this sheet I open new items, but I also close them. I do this by changing their status and hide them from view. And this is the point where it goes wrong. When I close the <em>last item</em> on the list and want to add a new row, the macro adds a <em>new row</em> below the <em>last visible</em> entry. It does not find the last entry I have just hidden. And also, when this happens, adding the default values to the new row does not work. It adds them at the row above the added one. </p>\n\n<p>Somehow this makes perfect sense. I tell the macro to look for the last entry, but what I don't understand is why it looks at the last <em>visible</em> entry and why it does not look in the hidden rows. </p>\n\n<p><strong>To replicate.</strong> Copy the code into a sheet (maybe you need to change the name of the sheet) and add a few lines. Put some info in the last row and hide it. Add another few lines and see what happens. </p>\n\n<p><strong>The solution.</strong> Is there a way to resolve this? Maybe there is a smarter way of doing things? I looked into things, but mostly I got results using \"(\"A\" &amp; Rows.Count).End(xlUp)\". A loop could work, but I am afraid that 1) It does not search through hidden rows and 2) it makes the sheet (somewhat) sluggish. I must say I have tried to make a loop, first I want to see if my first solution is salvageable. </p>\n\n<p>Thank you for your input, if there are any questions please let me know. </p>\n\n<p>Simon\n<strong>EDIT: Working code for anyone interested</strong></p>\n\n<pre><code>  Sub AddRowActiviteiten_NewAtEnd()\n'Add's a new row at the end of the sheet.\n\nDim wsActiviteiten As Worksheet\nSet wsActiviteiten = Sheets(\"Activiteiten\")\n\nDefType = \"Daily\"\nDefStatus = \"Open\"\nDefIssue = \"*****\"\nDefImpact = \"*****\"\nDefPrio = \"Laag\"\nMyDate = Date\n\n'Copy the One Row To Rule Them All\nwsActiviteiten.Range(\"A3:Q3\").Copy\n\n'Offset(y,x)\n'De -16 is een getal dat iets doet, maar ik weet niet wat.\nwsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(1, -16).PasteSpecial (xlPasteAll)\n\n'Stop the \"copy-action\"\nApplication.CutCopyMode = False\n\n'Het volgnummer verhogen met 1\n'Het laatste getal selecteren (LastNumber) en dan plus 1.\nLastNumber = wsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(0, -16).Value\nwsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(1, -16).Value = LastNumber + 1\n\n'Insert default values\nLastRow = wsActiviteiten.Range(Split(ActiveSheet.AutoFilter.Range.Address, \":\")(1)).Offset(-1, 0).Row\nCells(LastRow + 1, 2) = DefType\nCells(LastRow + 1, 3) = DefStatus\nCells(LastRow + 1, 4) = DefIssue\nCells(LastRow + 1, 5) = DefImpact\nCells(LastRow + 1, 6) = DefPrio\nCells(LastRow + 1, 8) = MyDate\n\n'Step down 1 row from present location.\nActiveCell.Offset(1, 0).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 1, "creation_date": 1466592637, "post_id": 37965591, "comment_id": 63377749, "body": "It would be very helpful, if you showed us your code. ;)"}, {"owner": {"reputation": 183, "user_id": 3102456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/id6IA.png?s=128&g=1", "display_name": "Brent Hackers", "link": "https://stackoverflow.com/users/3102456/brent-hackers"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466593670, "post_id": 37965591, "comment_id": 63378441, "body": "@Tom Done.  Hopefully that helps."}, {"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 1, "creation_date": 1466594075, "post_id": 37965591, "comment_id": 63378704, "body": "Ah, there we have it. The problem lies within the <code>BeforeDoubleClick</code>-event. Take a look at this question: <a href=\"http://stackoverflow.com/questions/13098369/avoid-selection-in-a-form-when-double-click\" title=\"avoid selection in a form when double click\">stackoverflow.com/questions/13098369/&hellip;</a>"}, {"owner": {"reputation": 183, "user_id": 3102456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/id6IA.png?s=128&g=1", "display_name": "Brent Hackers", "link": "https://stackoverflow.com/users/3102456/brent-hackers"}, "reply_to_user": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1466594217, "post_id": 37965591, "comment_id": 63378810, "body": "@Tom Awesome!  I looked for that but couldn&#39;t find it to save my life.  Duplicate question then.  The shame!  +1"}], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1466594248, "creation_date": 1466594248, "answer_id": 37966467, "question_id": 37965591, "link": "https://stackoverflow.com/questions/37965591/when-i-double-click-on-a-cell-to-open-a-form-a-checkbox-on-the-form-behind-my-c/37966467#37966467", "title": "When I double click on a cell to open a form, a checkbox on the form behind my cursor is checked/unchecked. How can I prevent this from happening?", "body": "<p>What about using Cancel = True?</p>\n\n<pre><code>If Target = Range(\"aParticularRangeName\") Then\n    Cancel = True\n    frmSelectStuff.Show\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 3102456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/id6IA.png?s=128&g=1", "display_name": "Brent Hackers", "link": "https://stackoverflow.com/users/3102456/brent-hackers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1466594248, "creation_date": 1466591967, "last_edit_date": 1466593577, "question_id": 37965591, "link": "https://stackoverflow.com/questions/37965591/when-i-double-click-on-a-cell-to-open-a-form-a-checkbox-on-the-form-behind-my-c", "title": "When I double click on a cell to open a form, a checkbox on the form behind my cursor is checked/unchecked. How can I prevent this from happening?", "body": "<p>I have a form that appears on a double click event of a specific cell.  </p>\n\n<p>The form contains a list box with a bunch of checkboxes in it and in my _Activate() sub, the checkboxes are set to true or false based on values on the active sheet.  </p>\n\n<p>The trouble is that when the form opens up behind the cursor, the second click of the double click that opens the form is also checking/unchecking a checkbox in the form.  </p>\n\n<p>I've tried sticking \"DoEvents\" in the activate sub before the code sets the checkbox values but it hasn't made a difference - The checkbox behind my cursor where the form opens will be checked/unchecked.</p>\n\n<p>I don't expect that the code will help much but it is essentially as below:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n\n    If Target = Range(\"aParticularRangeName\") Then\n        frmSelectStuff.Show\n    End If\n\nEnd Sub\n\nPublic Sub UserForm_Activate()\n\n    Dim iRegions As Integer\n    Dim sRecheck As Variant\n    Dim sRecheckList() As String\n\n    sRecheckList = Split(ActiveCell.Value, \"; \")\n    For Each sRecheck In sRecheckList\n        For iRegions = 0 To lbRegionsTemp.ListCount - 1\n            If sRecheck = lbRegionsTemp.List(iRegions) Then lbRegionsTemp.Selected(iRegions) = True\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vb6"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466591618, "post_id": 37965359, "comment_id": 63377049, "body": "Is this actually vba? or vb6? They are not the same thing. If it&#39;s vba please also include the office application that you are using it with"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 6493026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcf2db04019a76464f1dea62d6939c67?s=128&d=identicon&r=PG&f=1", "display_name": "nordscan", "link": "https://stackoverflow.com/users/6493026/nordscan"}, "edited": false, "score": 0, "creation_date": 1466592141, "post_id": 37965462, "comment_id": 63377401, "body": "its calculate the qty, but step by step... 1step = 5, 2step=7, but i need to get already in first step the total = 7 ....but thank you"}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 115, "user_id": 6493026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcf2db04019a76464f1dea62d6939c67?s=128&d=identicon&r=PG&f=1", "display_name": "nordscan", "link": "https://stackoverflow.com/users/6493026/nordscan"}, "edited": false, "score": 0, "creation_date": 1466592764, "post_id": 37965462, "comment_id": 63377832, "body": "You are reading the file line by line, you have to count the value up as each line is read..."}, {"owner": {"reputation": 115, "user_id": 6493026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcf2db04019a76464f1dea62d6939c67?s=128&d=identicon&r=PG&f=1", "display_name": "nordscan", "link": "https://stackoverflow.com/users/6493026/nordscan"}, "edited": false, "score": 0, "creation_date": 1466592910, "post_id": 37965462, "comment_id": 63377947, "body": "yes, because that i ask if is there a way fist get the total of QTY and then ready line by line.."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "reply_to_user": {"reputation": 115, "user_id": 6493026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcf2db04019a76464f1dea62d6939c67?s=128&d=identicon&r=PG&f=1", "display_name": "nordscan", "link": "https://stackoverflow.com/users/6493026/nordscan"}, "edited": false, "score": 0, "creation_date": 1466593512, "post_id": 37965462, "comment_id": 63378338, "body": "Yes, you could query the CSV file as a SQL object and sum the qty value directly, before you run the loop on the file.  I&#39;ve edited the answer to include an example of how you could do this with your example file"}, {"owner": {"reputation": 115, "user_id": 6493026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcf2db04019a76464f1dea62d6939c67?s=128&d=identicon&r=PG&f=1", "display_name": "nordscan", "link": "https://stackoverflow.com/users/6493026/nordscan"}, "edited": false, "score": 0, "creation_date": 1466597052, "post_id": 37965462, "comment_id": 63380703, "body": "Thank you its working, i just changed it for csv without header"}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1466593652, "last_edit_date": 1466593652, "creation_date": 1466591659, "answer_id": 37965462, "question_id": 37965359, "link": "https://stackoverflow.com/questions/37965359/get-total-value-of-a-column-from-csv/37965462#37965462", "title": "Get total value of a column from CSV", "body": "<p>Add a new variable called TotaLineValues and increment it with each LineValues(3)</p>\n\n<p>At the top of the Sub add this</p>\n\n<pre><code>Dim TotalLineValues As Long\nTotalLineValues = 0\n</code></pre>\n\n<p>Before the <code>Loop</code> add this:</p>\n\n<pre><code>TotalLineValues = TotalLineValues + LineValues(3)\nDebug.Print TotalLineValues\n</code></pre>\n\n<p>And you will see the total increment by the value each time</p>\n\n<p>EDIT: To query the file and sum the QTY in one go, before you loop through it, try querying it as a SQL object:</p>\n\n<pre><code>Public Sub GetDataFromCSV()\n    Const adOpenStatic = 3\n    Const adLockOptimistic = 3\n    Const adCmdText = &amp;H1\n    Set objConnection = CreateObject(\"ADODB.Connection\")\n    Set objRecordSet = CreateObject(\"ADODB.Recordset\")\n    strPathtoTextFile = \"C:\\temp\\\"\n    strFile = \"tesFile.csv\"\n    objConnection.Open \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; strPathtoTextFile &amp; \";Extended Properties='text;HDR=YES;FMT=Delimited'\"\n    objRecordSet.Open \"Select sum(QTY) as Quantity from \" &amp; strFile, objConnection, adOpenStatic, adLockOptimistic, adCmdText\n\n    If Not objRecordSet.EOF Then\n        Debug.Print objRecordSet.Fields.Item(\"Quantity\") ' This will tell you the total quantity in the file is 7\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 6493026, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcf2db04019a76464f1dea62d6939c67?s=128&d=identicon&r=PG&f=1", "display_name": "nordscan", "link": "https://stackoverflow.com/users/6493026/nordscan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 37965462, "answer_count": 1, "score": -1, "last_activity_date": 1466593652, "creation_date": 1466591410, "question_id": 37965359, "link": "https://stackoverflow.com/questions/37965359/get-total-value-of-a-column-from-csv", "title": "Get total value of a column from CSV", "body": "<p>Here i have a code with this i load CSV file.\nIt see like this:</p>\n\n<pre><code>//profile, lenght, width, qty, color//\nr2,500,800,5,white\nr2,200,100,2,white\n</code></pre>\n\n<p>I parse it with this:</p>\n\n<pre><code>Sub Main()\n\n    Dim CDLG As Object\n    Set CDLG = CreateObject(\"MSComDlg.CommonDialog\")\n    With CDLG\n      .DialogTitle = \"Choose file\"\n      .Filter = \"CSV Documents|*.csv\"\n      .ShowOpen\n      m_strFileURI = .Filename\n      m_strFileName = .FileTitle\n\n    Dim cesta As String\n    cesta = Left(m_strFileURI, InStrRev(m_strFileURI, \"\\\"))\n    End With\n    Set CDLG = Nothing\n\n\n    Dim FSO As New FileSystemObject\n'array of values in each line\n    Dim LineValues() As String\n'each new line read in from the text stream\n    Dim ReadLine As String\n    Dim ts As TextStream\n'open file\n    Set ts = FSO.OpenTextFile(m_strFileURI)\n'keep going till no more lines\n    Do Until ts.AtEndOfStream\n'read first line\n    ReadLine = ts.ReadLine\n\n    LineValues = Split(ReadLine, \",\")\n\nDebug.Print LineValues(3)\n\n\n**'--&gt; Need finaly generate filename as:  Totalqty - lenght - width**\n\n\nLoop\nEnd Sub\n</code></pre>\n\n<p>but how can i get TOTAL QTY from - LineValues(3)\nso i can use it for create a filename which contains Totalqty - lenght - width??</p>\n\n<p>thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466591739, "post_id": 37965314, "comment_id": 63377117, "body": "Can you apply a sort on Sequence column before?"}, {"owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466592289, "post_id": 37965314, "comment_id": 63377496, "body": "There is a column that has the sequence number. Which is where i get the <code>instance</code> value from in each chunk of text. However at the moment it reads the rows top to bottom. I would like it to read depending on the value in that column. e.g row with sequence value 1, then 2, etc."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466592336, "post_id": 37965314, "comment_id": 63377532, "body": "So sort the column before your code, then remove the sort."}, {"owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466592490, "post_id": 37965314, "comment_id": 63377642, "body": "It is a table that has 500+ rows. not every row will have a sequence number. And for other parts of the code require certain rows to be in order. if i can get VBA to order it for me would be ideal."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466592998, "post_id": 37965314, "comment_id": 63378019, "body": "You&#39;ll need to put all the data in a collection (array, collection, dictionary) then write your own sort routine on it.  Could, a workaround, put the data in a sheet, then sort, then do your formatting, so just put the data in a sheet, sort it, then do your code.   <a href=\"https://support.microsoft.com/en-us/kb/246067\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/246067</a>"}, {"owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466596041, "post_id": 37965314, "comment_id": 63379981, "body": "I have this line of code: <code>If Not (activeCell.Offset(0, 1).value = &quot;&quot;) Then</code> which makes sure it only writes out if there is a value it the sequence column. Is there a way I can have it to say for example run this code if <code>activeCell.Offset(0, 1).value = &quot;1&quot;</code> and then rerun this for values of 2 and so on"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1466597186, "post_id": 37965314, "comment_id": 63380811, "body": "Yes, the way you&#39;ve said with an IF, but you&#39;ll need to wrap it in a loop from 1 to the max of the seq #"}], "answers": [{"comments": [{"owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "edited": false, "score": 0, "creation_date": 1466599397, "post_id": 37967637, "comment_id": 63382435, "body": "I have added more of my code to the question. i can seem to work out where you put you code to make it work. At the moment the Sequence column is N. The data that is used to populate the chunks of code is from column A,C,F,H,I,K. sorry just getting a bit confused."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1466599556, "last_edit_date": 1466599556, "creation_date": 1466597400, "answer_id": 37967637, "question_id": 37965314, "link": "https://stackoverflow.com/questions/37965314/vba-iterating-rows-depending-on-value-in-cells/37967637#37967637", "title": "VBA iterating rows depending on value in cells", "body": "<p>Something like this, not posted as an answer, just to use the code formatting.  I have my data in A and the seq number in B</p>\n\n<pre><code>Sub testing()\n\nDim OutputCollection As New Collection                  '   For ease\nDim intMaxSeq As Integer\nDim intSeq As Integer\nDim intRow As Integer\n\nintMaxSeq = WorksheetFunction.Max(Range(\"N:N\"))\n\nFor intSeq = 1 To intMaxSeq\n\n    For intRow = 1 To Range(\"A1\").End(xlDown).Row\n\n        If Range(\"N\" &amp; intRow) = intSeq Then\n            '   Your code will sit here to build the o/p\n\n            '   Like this example only!!!!!!!!\n            sheet(\"Output\").range(\"a1\").value=range(\"A\" &amp; introw).value\n            sheet(\"Output\").range(\"b1\").value=range(\"C\" &amp; introw).value\n            sheet(\"Output\").range(\"c1\").value=range(\"J\" &amp; introw).value\n            '\n\n\n\n        End If\n\n    Next intRow\n\nNext intSeq\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1831, "user_id": 5429320, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e02691284796e5cf261da5a449fdabec?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/5429320/ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1466599741, "creation_date": 1466591275, "last_edit_date": 1466599741, "question_id": 37965314, "link": "https://stackoverflow.com/questions/37965314/vba-iterating-rows-depending-on-value-in-cells", "title": "VBA iterating rows depending on value in cells", "body": "<p>I would like to get my VBA script to write of a section of text in order of instance value from another worksheet. I have a section of code that writes out a chunk of text to worksheet A. </p>\n\n<pre><code>Dim selectedTest As String\nDim activeCell As Range\nDim outputCell As Range\nDim currentValue As String\nDim activePage As String\nDim row As String\nDim instancecol As String\n\nselectedTest = template.Range(\"I6, I6\").value\nSet activeCell = template.Cells.Find(selectedTest + \" Data\")\nSet activeCell = activeCell.Offset(0, 1)\ninstancecol = Split(activeCell(1).Address(1, 0), \"$\")(0)\nSet activeCell = activeCell.Offset(2, -1)\ncurrentValue = activeCell.value\nrow = activeCell.row\nactivePage = template.Range(\"B\" + row)\n\nSet outputCell = json.Range(\"D26\")\n\noutputCell.Activate\noutputCell.value = Chr(34) + \"name\" + Chr(34) + \": \" + Chr(34) + activePage + Chr(34) + \",\"\nSet outputCell = outputCell.Offset(1, 0)\noutputCell.value = Chr(34) + \"instance\" + Chr(34) + \": \" + Chr(34) + \"1\" + Chr(34) + \",\"\nSet outputCell = outputCell.Offset(1, 0)\noutputCell.value = Chr(34) + \"Input\" + Chr(34) + \": [\"\nSet outputCell = outputCell.Offset(0, 1)\n\nWhile Not currentValue = \"ENDPARSE\"\n\nIf Not (activeCell.Offset(0, 1).value = \"\") Then\n\n    Dim currentPage As String\n    Dim referenceType As String\n    Dim reference As String\n    Dim action As String\n    Dim wait As String\n    Dim screenshot As String\n    Dim instance As String\n\n    Set outputCell = outputCell.Offset(1, 0)\n    outputCell.value = \"{\"\n    Set outputCell = outputCell.Offset(1, 1)\n\n\n    row = activeCell.row\n    currentPage = template.Range(\"B\" + row)\n\n    If Not (activePage = currentPage) Then\n        activePage = currentPage\n        Set outputCell = outputCell.Offset(-1, -1)\n        outputCell.value = \"\"\n        Set outputCell = outputCell.Offset(-1, 0)\n        outputCell.value = \"}\"\n        Set outputCell = outputCell.Offset(1, -1)\n        outputCell.value = \"]\"\n        Set outputCell = outputCell.Offset(1, -1)\n        outputCell.value = \"},\"\n        Set outputCell = outputCell.Offset(1, 0)\n        outputCell.value = \"{\"\n        Set outputCell = outputCell.Offset(1, 1)\n        outputCell.value = Chr(34) + \"name\" + Chr(34) + \": \" + Chr(34) + activePage + Chr(34) + \",\"\n        Set outputCell = outputCell.Offset(1, 0)\n        outputCell.value = Chr(34) + \"instance\" + Chr(34) + \": \" + Chr(34) + \"1\" + Chr(34) + \",\"\n        Set outputCell = outputCell.Offset(1, 0)\n        outputCell.value = Chr(34) + \"Input\" + Chr(34) + \": [\"\n        Set outputCell = outputCell.Offset(1, 1)\n        outputCell.value = \"{\"\n        Set outputCell = outputCell.Offset(1, 1)\n    End If\n\n    referenceType = template.Range(\"C\" + row)\n    reference = template.Range(\"A\" + row)\n    action = template.Range(\"F\" + row)\n    wait = template.Range(\"H\" + row)\n    screenshot = template.Range(\"I\" + row)\n    instance = template.Range(instancecol + row)\n    currentValue = activeCell.value\n\n    outputCell.value = Chr(34) + \"type\" + Chr(34) + \": \" + Chr(34) + referenceType + Chr(34) + \",\"\n    Set outputCell = outputCell.Offset(1, 0)\n    outputCell.value = Chr(34) + \"reference\" + Chr(34) + \": \" + Chr(34) + reference + Chr(34) + \",\"\n    Set outputCell = outputCell.Offset(1, 0)\n    outputCell.value = Chr(34) + \"action\" + Chr(34) + \": \" + Chr(34) + action + Chr(34) + \",\"\n    Set outputCell = outputCell.Offset(1, 0)\n    outputCell.value = Chr(34) + \"instance\" + Chr(34) + \": \" + Chr(34) + instance + Chr(34) + \",\"\n    Set outputCell = outputCell.Offset(1, 0)\n    outputCell.value = Chr(34) + \"wait\" + Chr(34) + \": \" + Chr(34) + wait + Chr(34) + \",\"\n\n    If Not (currentValue = \"\") Then\n        Set outputCell = outputCell.Offset(1, 0)\n        outputCell.value = Chr(34) + \"value\" + Chr(34) + \": \" + Chr(34) + currentValue + Chr(34) + \",\"\n    End If\n\n    Set outputCell = outputCell.Offset(1, 0)\n    outputCell.value = Chr(34) + \"screenshot\" + Chr(34) + \": \" + Chr(34) + screenshot + Chr(34)\n\n    Set outputCell = outputCell.Offset(1, -1)\n    outputCell.value = \"},\"\n\nEnd If\n\nSet activeCell = activeCell.Offset(1, 0)\ncurrentValue = activeCell.value\nWend\n\noutputCell.value = \"}\"\nSet outputCell = outputCell.Offset(1, -1)\noutputCell.value = \"]\"\nSet outputCell = outputCell.Offset(1, -1)\noutputCell.value = \"}\"\nSet outputCell = outputCell.Offset(1, -1)\noutputCell.value = \"]\"\nSet outputCell = outputCell.Offset(1, -1)\noutputCell.value = \"}\"\n\nDim dataRange As Range\nSet dataRange = json.UsedRange\nSet fs = CreateObject(\"Scripting.FileSystemObject\")\nSet a = fs.CreateTextFile(template.Range(\"I2,I2\") + \"\\\\\" + template.Range(\"I3,I3\") + \".json\", True)\nFor Each C In dataRange\na.WriteLine (C.value)\nNext C\na.Close\n\ntemplate.Activate\n\nEnd Sub\n</code></pre>\n\n<p>This takes values from worksheet B to write the information in worksheet A. At the moment my output looks like this:</p>\n\n<pre><code>{           \n\"name\": \"Search\",       \n\"instance\": \"1\",        \n\"Input\": [      \n    {   \n        \"type\": \"button\",\n        \"reference\": \"Search\",\n        \"action\": \"Click\",\n        \"instance\": \"1\",\n        \"wait\": \"10\",\n        \"screenshot\": \"true\"\n    },  \n    {   \n        \"type\": \"dropdown\",\n        \"reference\": \"PostcodeLogic\",\n        \"action\": \"SelectByText\",\n        \"instance\": \"2\",\n        \"wait\": \"10\",\n        \"value\": \"Is\",\n        \"screenshot\": \"true\"\n    },  \n    {   \n        \"type\": \"text\",\n        \"reference\": \"PostCodeInput\",\n        \"action\": \"SendKeys\",\n        \"instance\": \"3\",\n        \"wait\": \"10\",\n        \"value\": \"AL2 4ED\",\n        \"screenshot\": \"true\"\n    },  \n    {   \n        \"type\": \"button\",\n        \"reference\": \"Search\",\n        \"action\": \"Click\",\n        \"instance\": \"5\",\n        \"wait\": \"10\",\n        \"screenshot\": \"true\"\n    },  \n    {   \n        \"type\": \"link\",\n        \"reference\": \"ClientName \",\n        \"action\": \"Click\",\n        \"instance\": \"4\",\n        \"wait\": \"10\",\n        \"screenshot\": \"true\"\n    }   \n]       \n}           \n</code></pre>\n\n<p>As you can see all the information i want is there and work correctly. I now need to make it so that it write out the chunk of test in order of <code>instance</code>. I have a field called <code>sequence</code> that reads then number and puts it into the <code>instance</code> field.</p>\n\n<p>Apologies if this is not explained well, still very new to VBA.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466591933, "post_id": 37965169, "comment_id": 63377258, "body": "Does your <code>pathtosubfolder</code> include the drive letter or server name?"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466592107, "post_id": 37965169, "comment_id": 63377382, "body": "@Rory          Yes, the <code>Pathtosubfolder</code> has the driver included."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466592203, "post_id": 37965169, "comment_id": 63377446, "body": "If you open the workbook in question, then run this from the immediate window, what do you see: <code>Msgbox Dir(Activeworkbook.Fullname)</code>"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466592824, "post_id": 37965169, "comment_id": 63377876, "body": "@Rory          I don&#39;t have permission to alter that specfic file. I did however make a copy of the file, and made it macroenabled. Then using <code>MsgBox (ActiveWorkbook.Path &amp; &quot;\\&quot; &amp; Dir(ActiveWorkbook.FullName))</code> returned what could be expected, i.e. the correct file path and name. This path is not different from the one I try to use in order to open up the particular file from my &quot;original workbook&quot;, which seems strange."}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466592918, "post_id": 37965169, "comment_id": 63377958, "body": "@Rory          Or well, it was a difference. In the new file it was &quot;.xlsm&quot; instead of &quot;.xlsx&quot;. The original file I want to open uses &quot;.xlsx&quot; though. Also, from my original workbook I use Dir with the &quot;*&quot; wildcard in the end, so file extensions should not cause any problems."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1466592944, "post_id": 37965169, "comment_id": 63377975, "body": "You didn&#39;t need to alter the file at all, just open it. There must be some difference between the two - perhaps a space here or there."}], "answers": [{"comments": [{"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1466591773, "post_id": 37965351, "comment_id": 63377144, "body": "Thanks, I adjusted the code. It still returns NULL. What I find the most particular is that using the Dir function &quot;hard-coded&quot; still returns NULL. &#39;"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1466591844, "post_id": 37965351, "comment_id": 63377194, "body": "Have you got some kind of custom error handling going on? If the file can&#39;t be found the <code>Dir()</code> method will return <code>vbNullString</code> (i.e. an empty value, displayed as blank) rather than &#39;NULL&#39;"}, {"owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1466592071, "post_id": 37965351, "comment_id": 63377358, "body": "Thanks for replying again. It appears that I have been rather vague. I mean that when I use the MsgBox all I see is blank, which I take as NULL. I have not however used any custom error handling."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "edited": false, "score": 0, "creation_date": 1466592384, "post_id": 37965351, "comment_id": 63377569, "body": "Then unfortunately it has to be the case that you&#39;re getting the path or the filename wrong in some way. See Rory&#39;s comment above (rather than duplicating the discussion in these comments)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 2, "last_activity_date": 1466591394, "creation_date": 1466591394, "answer_id": 37965351, "question_id": 37965169, "link": "https://stackoverflow.com/questions/37965169/dir-function-does-not-find-a-file-even-after-copy-pasting-the-path-as-a-paramet/37965351#37965351", "title": "Dir function does not find a file, even after copy pasting the path as a parameter", "body": "<pre><code>Month(Date)\n</code></pre>\n\n<p>Will return a number, not a name. So you are passing the following argument:</p>\n\n<blockquote>\n  <p>PathToSubFolder\\2016\\6\\Production 6 2016.xlsx</p>\n</blockquote>\n\n<p>Which doesn't exist, hence you get a null string returned.</p>\n\n<p>Try</p>\n\n<pre><code>Dim Path as String\n\nPath = Dir(\"PathToSubfolder\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(Month(Date)) &amp;  _ \n                             \"\\Production \" &amp; MonthName(Month(Date)) &amp; \"*.xlsx\")\nMsgBox Path\n</code></pre>\n\n<p>the <code>MonthName()</code> method takes a number between 1 - 12 and returns the name of that month, which is what you need for your string.</p>\n"}], "owner": {"reputation": 1070, "user_id": 2074697, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/696a99004dff7b490a12a7e78306edfc?s=128&d=identicon&r=PG", "display_name": "Cenderze", "link": "https://stackoverflow.com/users/2074697/cenderze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1518, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1466594246, "creation_date": 1466590926, "last_edit_date": 1466594246, "question_id": 37965169, "link": "https://stackoverflow.com/questions/37965169/dir-function-does-not-find-a-file-even-after-copy-pasting-the-path-as-a-paramet", "title": "Dir function does not find a file, even after copy pasting the path as a parameter", "body": "<p>I've tried to get the Dir() function to work some time now using a rather complicated concatenated string, as seen below:</p>\n\n<pre><code>  Dim Path as String\n\n  Path = Dir(\"PathToSubfolder\\\" &amp; Year(Date) &amp; \"\\\" &amp; MonthName(Month(Date)) &amp;  _ \n                             \"\\Production \" &amp; MonthName(Month(Date)) &amp; \"*.xlsx\")\n  MsgBox Path\n</code></pre>\n\n<p>The message box prints nothing (it's just a blank Message Box). After trying to figure out whether I had mistyped the Path somehow, I opened up the correct file, and copypasted its actual Path from options, and subsequently performed: <code>Path = Dir(\"PathToSubFolder\\2016\\June\\Production June 2016.xlsx\")</code>, i.e. without any concatenation or anything, simply just the actual filepath and -name. However, Printing <code>MsgBox Path</code> returned nothing (NULL) again. </p>\n\n<p>Does anyone have any clue as to why this wont work? I have used Dir quite extensively the last days from the same workbook (albeit not from the same module) without any issues. </p>\n\n<p>Edit: Finally found a workaround. I simply made a variable with the path to the file, <code>pathtoFile</code>, and subsequently:</p>\n\n<pre><code>Dim pathtoFile As String \npathtoFile = \"C:\\Path.to.file\\\"\nPath = Dir(pathtoFile &amp; \"*\" &amp; MonthName(Month(Date)) &amp; \"*\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 2, "creation_date": 1466590882, "post_id": 37965109, "comment_id": 63376584, "body": "There is no loop in this code - why would you expect it to move to another row?"}, {"owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466591900, "post_id": 37965109, "comment_id": 63377236, "body": "@MacroMan I removed the for loop and then pasted."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466591983, "post_id": 37965109, "comment_id": 63377292, "body": "Well we can&#39;t hep with code that we can&#39;t see now can we.... on another note, you&#39;re just ignoring errors in your code rather than actually dealing with them which also makes it impossible to help with."}, {"owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466592081, "post_id": 37965109, "comment_id": 63377368, "body": "@MacroMan Added the code. Now request you to help me. Thank you"}, {"owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466686230, "post_id": 37965109, "comment_id": 63427862, "body": "@MacroMan Hi, I request you to help me with this. Your help will mean a lot to me. Thank you."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466693303, "post_id": 37965109, "comment_id": 63433561, "body": "I will respectfully decline your request - you have added the code back in but I have seen no proof that you have actually tried to get that code working before asking someone else to &#39;fix&#39; it for you. There are also many other issues such as the repeated use of <code>On Error Resume Next</code> that make code like this difficult to debug. Maybe someone else will have a go at it though."}, {"owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466703567, "post_id": 37965109, "comment_id": 63440574, "body": "@MacroMan cool. Thanks. Really thought you would help. N please dont say that I didnt try. You may not know.. Thanks once again for ur help."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1466703865, "post_id": 37965109, "comment_id": 63440753, "body": "I never said you didn&#39;t try, I said &quot;I have seen no proof&quot;. You use <code>For i = 1 To 4</code> but then don&#39;t actually use <code>i</code> inside your loop to control the row. This suggests that actually the problem is caused by you not understanding how a loop works. Something that is widely covered on the Internet with detailed examples and not something that would be answered on Stack Overflow as it&#39;s too broad."}, {"owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466741841, "post_id": 37965109, "comment_id": 63454652, "body": "@MacroMan I apologize for this.. It was my mistake. I will try to work this out. Thank you for guiding. Cheers!"}, {"owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1466750615, "post_id": 37965109, "comment_id": 63457553, "body": "@MacroMan Sorry to bother you again... I made some changes in the code. Now its giving me error on <code>Next x</code> of <code>runtime error 92</code>... If now you could help me"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "is_accepted": true, "score": 0, "last_activity_date": 1466763784, "creation_date": 1466763784, "answer_id": 38011114, "question_id": 37965109, "link": "https://stackoverflow.com/questions/37965109/send-bulk-mail-using-excel-vba/38011114#38011114", "title": "Send bulk mail using Excel VBA", "body": "<p>Solved: This will solve the problem above.</p>\n\n<pre><code>Sub Data_RoundedRectangle1_Click()\nDim OutApp As Object\nDim OutMail As Object\nDim rng As Range\n\nFor i = 2 To Cells(Rows.Count, 1).End(xlUp).row\n\nIf Cells(i, 21).Value = \"Open\" And Cells(i, 17).Value &lt;= Now() Then\n\nSet rng = Nothing\n            On Error Resume Next\n            'Only the visible cells in the selection\n            Set rng = Selection.SpecialCells(xlCellTypeVisible)\n            'You can also use a fixed range if you want\n            Set rng = Sheets(\"Data\").Range(\"C1:V5\").SpecialCells(xlCellTypeVisible)\n            On Error GoTo 0\n\n\n            With Application\n            .EnableEvents = False\n            .ScreenUpdating = False\n            End With\n\n\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nOn Error Resume Next\nWith OutMail\n\n\n    If Cells(i, 3).Value = \"Operation_Support\" And Cells(i, 5).Value = \"Quality_Assurance\" Then\n\n\n        StrBody = \"Hi,\" &amp; \"&lt;br&gt;\" &amp; _\n          \"PFB the process details which requires your attention.\" &amp; \"&lt;br&gt;\" &amp; _\n          \"The review for this process has crossed overdue.\" &amp; \"&lt;br&gt;\" &amp; _\n          \"Please ask the process owner to review the Process Manuals and Maps.\" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n    .To = \"a\"\n    .CC = \"b\"\n    .BCC = \"\"\n    .Subject = \"\"\n    .HTMLBody = StrBody &amp; RangetoHTML(rng)\n    .Attachments.Add ActiveWorkbook.FullName\n    ' You can add other files by uncommenting the following line.\n    '.Attachments.Add (\"C:\\test.txt\")\n    .Display\n    '.Send\n\n    ElseIf Cells(i, 3).Value = \"Operation_Support\" And Cells(i, 5).Value = \"Analytics\" Then\n\nStrBody = \"Hi,\" &amp; \"&lt;br&gt;\" &amp; _\n          \"PFB the process details which requires your attention.\" &amp; \"&lt;br&gt;\" &amp; _\n          \"The review for this process has crossed over due.\" &amp; \"&lt;br&gt;\" &amp; _\n          \"Please ask the process owner to review the Process Manuals and Maps.\" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n    .To = \"c\"\n    .CC = \"s\"\n    .BCC = \"\"\n    .Subject = \"\"\n    .HTMLBody = StrBody &amp; RangetoHTML(rng)\n    .Attachments.Add ActiveWorkbook.FullName\n    ' You can add other files by uncommenting the following line.\n    '.Attachments.Add (\"C:\\test.txt\")\n    .Display\n    '.Send\n\nEnd If\nEnd With\n\n\nOn Error GoTo 0\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nEnd If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6461111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8a76d3a4ef2c637afaeba5266183bf?s=128&d=identicon&r=PG&f=1", "display_name": "Mehul Rastogi", "link": "https://stackoverflow.com/users/6461111/mehul-rastogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 38011114, "answer_count": 1, "score": -3, "last_activity_date": 1466763784, "creation_date": 1466590730, "last_edit_date": 1466752825, "question_id": 37965109, "link": "https://stackoverflow.com/questions/37965109/send-bulk-mail-using-excel-vba", "title": "Send bulk mail using Excel VBA", "body": "<p>Was working on a project which will be sending bulk mail to different people if the conditions are met.</p>\n\n<p>Conditions : </p>\n\n<ol>\n<li>Column U contains the final status (Open or WIP) (will not send if Closed no matter if current date is larger)</li>\n<li>Column Q contains Closure date. Which when compared to current date, if less then automatic shooting mails to people.</li>\n</ol>\n\n<p>I had tried to do with for loop but its giving shooting 4 mails with same To and CC. And not going to the next row to compare.</p>\n\n<p>Thank you in advance.</p>\n\n<p>Code as below:</p>\n\n<pre><code>Dim rng As Range\nDim OutApp As Object\nDim OutMail As Object\nDim StrBody As String\nDim x As Variant\nDim arr1 As Variant\n\nDim i As Long, r As Long\n\nOn Error Resume Next\narr1 = Worksheets(\"Data\").Range(\"Q2:Q\" &amp; Range(\"Q\" &amp; Rows.Count).End(xlUp).row).Value\ni = 1\nFor Each x In arr1\n    For r = 1 To 2\n\n        If x &lt; Now() Then\n\n\n        If Sheets(\"Data\").Worksheets(\"Data\").Cells(i, \"U\").Value = \"Open\" Then   \n\n\n            Set rng = Nothing\n            On Error Resume Next\n            'Only the visible cells in the selection\n            Set rng = Selection.SpecialCells(xlCellTypeVisible)\n            'You can also use a fixed range if you want\n            Set rng = Sheets(\"Checklist\").Range(\"A2:B25\").SpecialCells(xlCellTypeVisible)\n            On Error GoTo 0\n\n\n            With Application\n            .EnableEvents = False\n            .ScreenUpdating = False\n            End With\n\n            Set OutApp = CreateObject(\"Outlook.Application\")\n            Set OutMail = OutApp.CreateItem(0)\n\n    With OutMail\n\n\n            If Worksheets(\"Data\").Cells(i, \"C\").Value = \"Operation_Support\" And Worksheets(\"Data\").Cells(i, \"E\").Value = \"Quality_Assurance\" Then\n\n\n     StrBody = \"Hi,\" &amp; \"&lt;br&gt;\" &amp; _\n\n\n    .To = \"a\"\n\n    .CC = \"b\"\n    .BCC = \"\"\n    .Subject = \"\"\n    .HTMLBody = StrBody &amp; RangetoHTML(rng)\n    .Attachments.Add ActiveWorkbook.FullName\n    ' You can add other files by uncommenting the following line.\n    '.Attachments.Add (\"C:\\test.txt\")\n    .Display\n    '.Send\n\n    ElseIf Worksheets(\"Data\").Cells(i, \"C\").Value = \"Operation_Support\" And Worksheets(\"Data\").Cells(i, \"E\").Value = \"Analytics\" Then\n\nStrBody = \"Hi,\" &amp; \"&lt;br&gt;\" &amp; _\n          \"PFB the process details which requires your attention.\" &amp; \"&lt;br&gt;\" &amp; _\n          \"The review for this process has crossed over due.\" &amp; \"&lt;br&gt;\" &amp; _\n          \"Please ask the process owner to review the Process Manuals and Maps.\" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n    .To = \"c\"\n\n    .CC = \"d\"\n    .BCC = \"\"\n    .Subject = \"Process Manual and Maps Review is Overdue\"\n    .HTMLBody = StrBody &amp; RangetoHTML(rng)\n    .Attachments.Add ActiveWorkbook.FullName\n    ' You can add other files by uncommenting the following line.\n    '.Attachments.Add (\"C:\\test.txt\")\n    .Display\n    '.Send\nEnd If\n\n    End With\n\n    i = i + 1\n    Exit For\n\n    End If\nEnd If\n\nNext r\n\nOn Error GoTo 0\n\nWith Application\n    .EnableEvents = True\n    .ScreenUpdating = True\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nNext x\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/VrO6m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VrO6m.png\" alt=\"First the code will run to compare 3-Jun-16 date and Closed(Final Status) then next it will run to compare 16-May-2016 and Closed(Final Status)\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1468406966, "post_id": 37965078, "comment_id": 64111623, "body": "How can i make it just copy the formula and not the text."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1466591832, "post_id": 37965327, "comment_id": 63377186, "body": "Sorry but VBA is new to me.  Can you explain??"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "edited": false, "score": 0, "creation_date": 1466592192, "post_id": 37965327, "comment_id": 63377436, "body": "@Chris  See my <b>EDIT#1</b>"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1466592168, "last_edit_date": 1466592168, "creation_date": 1466591326, "answer_id": 37965327, "question_id": 37965078, "link": "https://stackoverflow.com/questions/37965078/copying-formula-from-above/37965327#37965327", "title": "Copying Formula From Above", "body": "<p>You need to do a <code>Copy/Paste</code>.  For example, if <strong>A1</strong> contains:</p>\n\n<pre><code>=B1+C1\n</code></pre>\n\n<p>running:</p>\n\n<pre><code>Sub qwerty()\n    Range(\"A2\").Formula = Range(\"A1\").Formula\nEnd Sub\n</code></pre>\n\n<p>will leave <strong>A2</strong> with <code>=B1+C1</code> as well.</p>\n\n<p>If you want the copied formula to \"adjust\" then:</p>\n\n<pre><code>Sub ytrewq()\n    Range(\"A1\").Copy Range(\"A2\")\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>Rather than:</p>\n\n<pre><code>ws.Range(\"A\" &amp; (firstRow + myLoop) &amp; \":BB\" &amp; (firstRow + myLoop)).Formula = ws.Range(\"A\" &amp; firstRow &amp; \":BB\" &amp; firstRow).Formula\n</code></pre>\n\n<p>use something like:</p>\n\n<pre><code>ws.Range(\"A\" &amp; firstRow &amp; \":BB\" &amp; firstRow).Copy ws.Range(\"A\" &amp; (firstRow + myLoop) &amp; \":BB\" &amp; (firstRow + myLoop))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "is_accepted": false, "score": 1, "last_activity_date": 1466592154, "creation_date": 1466592154, "answer_id": 37965666, "question_id": 37965078, "link": "https://stackoverflow.com/questions/37965078/copying-formula-from-above/37965666#37965666", "title": "Copying Formula From Above", "body": "<p>Cannot take any praise for this.  Thanks Dave.</p>\n\n<pre><code>Sub Loop_InsertRowsandFormulas()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Risk Input Sheet\")\nDim vRows As Long\nDim lastCol As Long\nDim firstRow As Long\n\nfirstRow = InputBox(\"Enter Row To Start Insert From.\")\nvRows = InputBox(\"Enter Number Of Rows Required\")\n\nIf firstRow = 0 Or vRows = 0 Then Exit Sub\nDebug.Print firstRow\nIngA = ws.Cells(5, ws.Columns.Count).End(xlToLeft).Column\nFor Myloop = 1 To vRows\n    ws.Range(\"A\" &amp; (firstRow + Myloop)).EntireRow.Insert\n    ws.Range(\"N\" &amp; (firstRow) &amp; \":AW\" &amp; (firstRow + Myloop)).FillDown\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6498625, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10209803559902973/picture?type=large", "display_name": "Chris ", "link": "https://stackoverflow.com/users/6498625/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2744, "favorite_count": 0, "accepted_answer_id": 37965327, "answer_count": 2, "score": 1, "last_activity_date": 1466592168, "creation_date": 1466590628, "last_edit_date": 1531164843, "question_id": 37965078, "link": "https://stackoverflow.com/questions/37965078/copying-formula-from-above", "title": "Copying Formula From Above", "body": "<p>We have a macro working via a button in Excel 2013 to insert a new row with formula from above.  the Problem is when it runs and i say for example copy from row 10 the formula in the new row 11 all still read back to row 10 not 11?</p>\n\n<pre><code>Sub Loop_InsertRowsandFormulas()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Risk Input Sheet\")\nDim vRows As Long\nDim lastCol As Long\nDim firstRow As Long\n\nfirstRow = InputBox(\"Enter Row To Start Insert From.\")\nvRows = InputBox(\"Enter Number Of Rows Required\")\n\nIf firstRow = 0 Or vRows = 0 Then Exit Sub\nDebug.Print firstRow\nIngA = ws.Cells(5, ws.Columns.Count).End(xlToLeft).Column\nFor myLoop = 1 To vRows\n    ws.Range(\"A\" &amp; (firstRow + myLoop)).EntireRow.Insert\n    ws.Range(\"A\" &amp; (firstRow + myLoop) &amp; \":BB\" &amp; (firstRow + myLoop)).Formula = ws.Range(\"A\" &amp; firstRow &amp; \":BB\" &amp; firstRow).Formula\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1466749017, "post_id": 37964852, "comment_id": 63456868, "body": "You can try the <code>DBEngine.Errors</code> collection (this is a different thing than the <code>VBA.Err</code> object), see <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835711.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff835711.aspx</a> . It is useful to get more information about ODBC errors, I&#39;m not sure it will help in your case."}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1466762411, "post_id": 37964852, "comment_id": 63464034, "body": "I&#39;ve tried triggering this in various places but the collection is always empty, the collection seems to relate more to attempting to open an external database than working within one"}], "answers": [{"comments": [{"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 0, "creation_date": 1466595777, "post_id": 37966822, "comment_id": 63379797, "body": "Unfortunately that just returns application-defined or object-defined error in the msgbox"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 1, "creation_date": 1466598880, "post_id": 37966822, "comment_id": 63382043, "body": "Did you run it in the sub function itself? Anyway, I believe the common errors are these: [DataErr 2169 Customization]<a href=\"http://www.tek-tips.com/viewthread.cfm?qid=1080271\" rel=\"nofollow noreferrer\">tek-tips.com/viewthread.cfm?qid=1080271</a>"}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 0, "creation_date": 1466604150, "post_id": 37966822, "comment_id": 63386792, "body": "Yes it&#39;s running in the sub function. The link you provide goes along the same lines as AVG suggestion above of using the before update event rather than the on error event, although again is not referring to referential integrity checks, rather error situations where the number is sufficient. It seems frustrating that this is the solution. The error description I need in my code is right there on the default message, but there seems to be no way to work with it"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1466595224, "creation_date": 1466595224, "answer_id": 37966822, "question_id": 37964852, "link": "https://stackoverflow.com/questions/37964852/how-to-return-a-description-with-the-form-error-event-in-ms-access/37966822#37966822", "title": "How to return a description with the form_error event in MS Access", "body": "<p>Normally it is just to pass the number to <em>Error</em> to obtain the description:</p>\n\n<pre><code>MsgBox Error(DataErr)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 0, "creation_date": 1466603834, "post_id": 37968686, "comment_id": 63386499, "body": "This is fine for missing data etc. I am specifically referring to referential integrity though. In order to check for that I&#39;d believe I&#39;d have to go down the DLookup route, which just seem&#39;s like a lot of effort to circumvent access inbuilt table relationships functionality."}, {"owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "reply_to_user": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 1, "creation_date": 1466610979, "post_id": 37968686, "comment_id": 63392143, "body": "I agree that it&#39;s not ideal, however, AFAIK what you (and all of us) would like, doesn&#39;t exist. Lookups should be minimal if you are using comboboxes and/or listboxes for data entry."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 0, "creation_date": 1466766667, "post_id": 37968686, "comment_id": 63466427, "body": "I think the previous comment would be my answer too. If user input can break ref. integrity, don&#39;t allow arbitrary input, let the user select from a combobox. @HelloWorld"}, {"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 0, "creation_date": 1466768182, "post_id": 37968686, "comment_id": 63467294, "body": "In this case I want the user to be able to retrieve and work with multiple records directly, which is why I&#39;m specifically looking at error and change events rather than linking to buttons/comboboxes with a standard on error goto with an update/insert etc. I agree that using before update event on field/form seems to be the best <b>workaround</b>, I&#39;ll upvote as such, but leave as unanswered in case someone has a direct solution"}], "tags": [], "owner": {"reputation": 1262, "user_id": 1680712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f58684b74f0abaed8824df29ae8c232?s=128&d=identicon&r=PG", "display_name": "AVG", "link": "https://stackoverflow.com/users/1680712/avg"}, "is_accepted": false, "score": 3, "last_activity_date": 1466600100, "creation_date": 1466600100, "answer_id": 37968686, "question_id": 37964852, "link": "https://stackoverflow.com/questions/37964852/how-to-return-a-description-with-the-form-error-event-in-ms-access/37968686#37968686", "title": "How to return a description with the form_error event in MS Access", "body": "<p>Create a separate function to perform all of your validation and message the user with anything missing. Run that in the form's beforeupdate event and cancel the event if needed. That would probably eliminate many of your form_error's. In the form_error event, you could call the same function. It is has found an issue, suppress the default message. Any other error that pops up you'll can handle separately if needed. </p>\n"}, {"comments": [{"owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "edited": false, "score": 0, "creation_date": 1466762844, "post_id": 38006348, "comment_id": 63464317, "body": "This doesn&#39;t relate to the form_error event, there is no button clicked and error$ returns nothing in the case of this question, that&#39;s exactly the problem"}], "tags": [], "owner": {"reputation": 2827, "user_id": 4050261, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/Ax2IC.jpg?s=128&g=1", "display_name": "Adarsh Madrecha", "link": "https://stackoverflow.com/users/4050261/adarsh-madrecha"}, "is_accepted": false, "score": 0, "last_activity_date": 1466747150, "creation_date": 1466747150, "answer_id": 38006348, "question_id": 37964852, "link": "https://stackoverflow.com/questions/37964852/how-to-return-a-description-with-the-form-error-event-in-ms-access/38006348#38006348", "title": "How to return a description with the form_error event in MS Access", "body": "<p>I always use the below code pattern so that users can get a proper error message, which they can then convey to me to understand the reason.</p>\n\n<pre><code>Private Sub cmdSearch_Click()\nOn Error GoTo Sub_Err\n\n     --Your code here---\n\n'errors catching stuff\nSub_Exit:\n    Exit Sub\nSub_Err:\n    MsgBox Error$\n    Resume Sub_Exit\nEnd Sub\n</code></pre>\n\n<p>Use the same thing for every <code>sub</code> you use in code.</p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 872154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b19f0bafc44095ec7ded908043cc099?s=128&d=identicon&r=PG", "display_name": "John Bentley", "link": "https://stackoverflow.com/users/872154/john-bentley"}, "is_accepted": false, "score": 1, "last_activity_date": 1604575540, "creation_date": 1604575540, "answer_id": 64696221, "question_id": 37964852, "link": "https://stackoverflow.com/questions/37964852/how-to-return-a-description-with-the-form-error-event-in-ms-access/64696221#64696221", "title": "How to return a description with the form_error event in MS Access", "body": "<h2>In short</h2>\n<p>As far as I know @AVG's solution is probably the best available workaround, with one exception. That is, @AVG probably gets it right that the best workaround is to: try to catch the error at the <code>Form_BeforeUpdate</code> event; and (probably, depending on your needs) cancel the event in <code>Form_BeforeUpdate</code>.</p>\n<p>However, it is a good idea <em>not to</em> suppress the default error at the <code>Form_Error</code> level. If you catch and cancel the error at <code>Form_BeforeUpdate</code> then the error won't arise at <code>Form_Error</code>. So there's no need to suppress the error at <code>Form_Error</code> in that case. But if there's another kind of referential integrity violation laying in wait (e.g. an Category/Organisation violation rather than a Category/Subcategory violation), that you haven't thought to handle as a developer, then having the default error message arise in <code>Form_Error</code> will alert you to it. You wouldn't want to suppress a message for an error you haven't caught.</p>\n<p>Below I provide example code for this workaround.</p>\n<p>I also discuss how <code>AccessError(DataErr)</code> looks like a possible solution, but isn't quite. That is, it can be used to map <code>DataErr</code> numbers to messages. This is partially helpful. But, unfortunately, the messages are the variable <em>unsubstituted</em> versions. So, for example, we can't use <code>AccessError(DataErr)</code> in code to interrogate <em>specific</em> referential integrity violation messages.</p>\n<h2>Making the problem sharper</h2>\n<p>A <code>Form_Error</code> event will fire when a user, through a form: violates referential integrity (that you've set precisely to prevent such attempts at invalid data states); violates a validation rule set at the table level; or otherwise (?) produces a data error.</p>\n<p>However, the default message returned is likely to be user-unfriendly. E.g., in the case of a referential integrity violation ...</p>\n<blockquote>\n<p>You cannot add or change a record because a related record is required in table 'CategorySubcategory'.</p>\n</blockquote>\n<p>In this example the table 'CategorySubcategory' expresses a many-to-many relationship between tables 'Category' and 'CategorySubcategory', defining the particular Subcategories that belong to particular Categories. (In my example) it is also expressed, in CategorySubcategory, that some of the Categories have no Subcategories.</p>\n<p>What's needed is a means to have a user friendly message in place of the user-unfriendly message. And to do this it would be convenient to interrogate the default error message as it arises, suppress it, and substitute your own.</p>\n<p>(As far as I know) the closest we can come to interrogating the default message, in <code>Form_Error</code>, is <code>AccessError(DataErr)</code>. Unlike <code>Error(DataErr)</code>, <code>AccessError</code> promises to</p>\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.application.accesserror\" rel=\"nofollow noreferrer\">Microsoft &gt; Docs &gt; Office VBA Reference &gt; Access &gt; Object model &gt; Application object &gt; Methods &gt; AccessError </a></p>\n<blockquote>\n<p>... return the descriptive string associated with a Microsoft Access or <strong>DAO error</strong> [Emphasis added]</p>\n<p>[And the promise is that you] can use the AccessError method to return a descriptive string from within a form's Error event.</p>\n</blockquote>\n<p>So you might be tempted to do something like, and it would be convenient if you could do something like ...</p>\n<pre><code>Private Sub Form_Error(DataErr As Integer, Response As Integer)\n\n  If AccessError(DataErr) Like &quot;*CategorySubcategory*&quot; Then\n    MsgBox &quot;[My user friendly message] Choose the right Subcategory given the Category; or change the Category.&quot;, vbOKOnly Or vbExclamation\n    Response = acDataErrContinue ' Suppress default message\n  End If\n\nEnd Sub\n</code></pre>\n<h2>Might <code>AccessError</code> work?</h2>\n<p>However, it turns out <code>AccessError</code> only returns the variable <em>unsubstituted</em> version of the error message, not the variable <em>substituted</em> message the user sees at run-time. For example <code>AccessError</code> returns something like ...</p>\n<blockquote>\n<p>You cannot add or change a record because a related record is required in table '|'.</p>\n</blockquote>\n<p>... rather than ...</p>\n<blockquote>\n<p>You cannot add or change a record because a related record is required in table 'CategorySubcategory'.</p>\n</blockquote>\n<p>To prove this trigger a <em>data</em> error (E.g. by violating referential integrity) with the following.</p>\n<pre><code>Private Sub Form_Error(DataErr As Integer, Response As Integer)\n\n  ' For some reason you'll need to call AccessError(DataErr) before Error(DataErr) \n  Debug.Print &quot;AccessError(DataErr): &quot;, AccessError(DataErr)\n  Debug.Print &quot;Error(DataErr): &quot;, Error(DataErr)\n\nEnd Sub\n</code></pre>\n<p>Observe both: <code>AccessError</code> returns a specific message where <code>Error</code> returns the uselessly generic 'Application-defined or object-defined error'; and <code>AccessError</code> returns the variable <em>unsubstituted</em> version of the error message.</p>\n<p>@Hello World correctly quotes from <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/Access.Form.Error\" rel=\"nofollow noreferrer\">MS Docs &gt; ... &gt; Form.Error event (Access)</a></p>\n<blockquote>\n<p>You can use the DataErr argument with the Error function to map the number to the corresponding error message</p>\n</blockquote>\n<p>Even with <code>AccessError</code> substituted for <code>Error</code> @Hello World's lament remains fair ...</p>\n<blockquote>\n<p>[The MS docs don't] actually give an example of this and I'm struggling to figure it out.</p>\n</blockquote>\n<h2>Mapping messages to the <code>DataErr</code> number</h2>\n<p>What the MS doc author probably has in mind is code like the following</p>\n<pre><code>Function AccessAndJetErrorsTable() As Boolean\n' Source: Access 2000 Help &quot;Determine the Error Codes Reserved by Microsoft Access\n'          and the Microsoft Jet Database Engine&quot;\n    Const strTable As String = &quot;zttblAccessAndJetErrors&quot;\n    Dim cat As New ADOX.Catalog\n    Dim tbl As New ADOX.Table\n    Dim cnn As ADODB.Connection\n    Dim rst As New ADODB.Recordset, lngCode As Long\n    Dim strAccessErr As String\n    \n    Const conAppObjectError = &quot;Application-defined or object-defined error&quot;\n    On Error GoTo Error_AccessAndJetErrorsTable\n\n    Set cnn = CurrentProject.Connection\n        ' Create Errors table with ErrorNumber and ErrorDescription fields.\n    tbl.Name = strTable\n    tbl.Columns.Append &quot;ErrorCode&quot;, adInteger\n    tbl.Columns.Append &quot;ErrorString&quot;, adLongVarWChar\n    \n    Set cat.ActiveConnection = cnn\n    cat.Tables.Append tbl\n    ' Open recordset on Errors table.\n    rst.Open strTable, cnn, adOpenStatic, adLockOptimistic\n    ' Loop through error codes.\n    For lngCode = 0 To 35000\n        On Error Resume Next\n        ' Raise each error.\n        strAccessErr = AccessError(lngCode)\n        DoCmd.Hourglass True\n        ' Skip error numbers without associated strings.\n        If strAccessErr &lt;&gt; &quot;&quot; Then\n            ' Skip codes that generate application or object-defined errors.\n            If strAccessErr &lt;&gt; conAppObjectError Then\n                ' Add each error code and string to Errors table.\n                rst.AddNew\n                rst!ErrorCode = lngCode\n                ' Append string to memo field.\n                rst!ErrorString = strAccessErr\n                rst.Update\n            End If\n        End If\n    Next lngCode\n    ' Close recordset.\n    rst.Close\n    DoCmd.Hourglass False\n    RefreshDatabaseWindow\n    MsgBox strTable &amp; &quot; errors table created.&quot;\n    AccessAndJetErrorsTable = True\n\nExit_AccessAndJetErrorsTable:\n    Exit Function\n\nError_AccessAndJetErrorsTable:\n    MsgBox Err &amp; &quot;: &quot; &amp; Err.Description\n    AccessAndJetErrorsTable = False\n    Resume Exit_AccessAndJetErrorsTable\nEnd Function\n</code></pre>\n<p>To use that code, create a new Database, put the code in a module, your cursor in the middle of the code, then hit F5 (to run it). A table <code>zttblAccessAndJetErrors</code> will be created where you can look up all the variable <em>unsubstituted</em> versions of the Access and Jet error messages; and correspond these to a <code>DataErr</code> number.</p>\n<p>That code will give you the most up to date list of error messages. However, as an alternative you could just lookup an online source where this is published. E.g. <a href=\"https://www.fmsinc.com/MicrosoftAccess/Errors/ErrorNumber_Description2010.html\" rel=\"nofollow noreferrer\">FMS &gt; Microsoft Access 2010 Error Numbers and Descriptions</a></p>\n<p>So either with <code>zttblAccessAndJetErrors</code> or a lookup online you can now determine the <code>DataErr</code> number that corresponds most closely to the error message you are seeing during testing. So that gives us the ability to do something like ...</p>\n<pre><code>Private Sub Form_Error(DataErr As Integer, Response As Integer)\n\n  Select Case DataErr\n    Case 3201\n      ' &quot;You cannot add or change a record because a related record is required in table '|'.&quot;\n      \n        MsgBox &quot;[My user friendly message] Choose the right Subcategory given the Category; or change the Category.&quot;, vbOKOnly Or vbExclamation\n        Response = acDataErrContinue ' Suppress default message\n\n  End Select\nEnd Sub\n</code></pre>\n<p>That is, we don't use <code>AccessError</code> directly in <code>Form_Error</code> to return a message. Rather we've used <code>AccessError</code> (or relied on someone else to have used) to produce the DataErr/Message mapping. In <code>Form_Error</code> we continue to match against the <code>DataErr</code> number only. But now we can copy the relevant message as a comment for our <code>DataErr</code> number.</p>\n<p>However, at least in this referential integrity (DataErr 3201) case our problem remains. If we suppressed the default message for a specific referential integrity violation (like a Category/Subcategory mismatch), as with the code above, then that risks burying other specific referential integrity violations. E.g. If another referential integrity violation occurred with respect to, say a Category and Organisation chosen by the user, then the above code would wrongly express (beguilingly in a user friendly manner) that a Category/Subcategory violation had occurred.</p>\n<h2>The probable best available workaround</h2>\n<p>So, as far as I know @AVG's solution is probably the best available workaround, with one exception. That is, @AVG probably gets it right that the best workaround is to: try to catch the error at the <code>Form_BeforeUpdate</code> event; and (probably, depending on your needs) cancel the event in <code>Form_BeforeUpdate</code>.</p>\n<p>However, it is a good idea <em>not to</em> suppress the default error at the <code>Form_Error</code> level. If you catch and cancel the error at <code>Form_BeforeUpdate</code> then the error won't arise at <code>Form_Error</code>. So there's no need to suppress the error at <code>Form_Error</code> in that case. But if there's another kind of referential integrity violation laying in wait (e.g. an Category/Organisation violation rather than a Category/Subcategory violation), that you haven't thought to handle as a developer, then having the default error message arise in <code>Form_Error</code> will alert you to it. You wouldn't want to suppress a message for an error you haven't caught.</p>\n<p>So, in my case, the workaround code looks like (having to &quot;go down the DLookup route&quot; as @Hello World suggests).</p>\n<pre><code>Private Sub Form_BeforeUpdate(Cancel As Integer)\n\n  ' Head off a Form_Error referential integrity error 3201:\n  ' &quot;You cannot add or change a record because a related record is required in table 'CategorySubcategory'.&quot;\n  Dim subCategoryIDGivenCategoryIDAtTableLevel As Variant\n  If IsNull(Me.cboSubcategory) Then\n    subCategoryIDGivenCategoryIDAtTableLevel = DLookup(&quot;[SubcategoryID]&quot;, &quot;[CategorySubcategory]&quot;, &quot;[CategoryID] = &quot; &amp; Me.cboCategory)\n\n    If Not IsNull(subCategoryIDGivenCategoryIDAtTableLevel) Then\n      ' The user has not chosen a value for cboSubcategory, when they should have chosen some value\n      message = &quot;For this Category you need to choose a Subcategory. Either choose a Subcategory or change the Category.&quot;\n      Me.cboSubcategory.SetFocus\n      Cancel = True\n    End If\n\n  End If\n\n  If Cancel Then\n    MsgBox message, vbOKOnly Or vbExclamation, GetApplicationTitle() &amp; &quot; (Record Level Validation)&quot;\n  End If\n\nEnd if\n\nPrivate Sub Form_Error(DataErr As Integer, Response As Integer)\n  Select Case DataErr\n    Case 3201\n      ' A referential integrity error ...\n      ' &quot;You cannot add or change a record because a related record is required in table '|'.&quot;\n      \n      ' We display the default error message in case we haven't caught a referential integrity\n      ' condition in Form_BeforeUpdate\n      Response = acDataErrDisplay\n\n  End Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 855, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1604575540, "creation_date": 1466590013, "last_edit_date": 1466595751, "question_id": 37964852, "link": "https://stackoverflow.com/questions/37964852/how-to-return-a-description-with-the-form-error-event-in-ms-access", "title": "How to return a description with the form_error event in MS Access", "body": "<p>I'm using the form_error event in MS Access to catch errors, which gives only a <code>dataerr integer</code> and not a description like a vba error, however the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836345.aspx\" rel=\"nofollow\">MS Website</a> gives the following description of the event:</p>\n\n<blockquote>\n  <p>You can use the DataErr argument with the Error function to map the\n  number to the corresponding error message</p>\n</blockquote>\n\n<p>But doesn't actually give an example of this and I'm struggling to figure it out.</p>\n\n<p>The specific situation is that the user will be updating records in a subform, some fields may break referential integrity rules, the number will only tell me that a referential integrity rule has been broken, whereas the description will give me the table name, which allows me to give a prescriptive error message relating to the field where the error occurs</p>\n\n<p>Is there an easy way to do this? </p>\n"}]