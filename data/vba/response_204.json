[{"tags": ["vba", "outlook", "outlook-2010"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1544052743, "post_id": 53642191, "comment_id": 94144118, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26225014/save-outlook-attachment-to-disk\">Save Outlook attachment to disk</a>"}, {"owner": {"reputation": 13, "user_id": 7948113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095d1972c581d6f8b795fe8235f4fee0?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon168", "link": "https://stackoverflow.com/users/7948113/brandon168"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1544053426, "post_id": 53642191, "comment_id": 94144282, "body": "I used some of the code in the link you provided and I added more code to move the email to Deleted Items.  It works when I run it manually by highlighting it but won&#39;t work when new email arrival.  It saves the attachments from a different email in the Inbox folder and did not move the just arrived email to the Deleted Items folder."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1544054049, "post_id": 53642191, "comment_id": 94144455, "body": "The answer to the question was to remove code related to selection."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 2, "creation_date": 1544054765, "post_id": 53642191, "comment_id": 94144646, "body": "You have the relevant object in MItem. Do not go looking for it in selection."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1544159889, "post_id": 53642191, "comment_id": 94185097, "body": "If the item will always have attachment then add the to your rule then clean up your code - keep it simple"}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": -1, "last_activity_date": 1544064726, "last_edit_date": 1544064726, "creation_date": 1544064392, "answer_id": 53643857, "question_id": 53642191, "link": "https://stackoverflow.com/questions/53642191/save-attachment-on-arriving-email/53643857#53643857", "title": "Save Attachment on arriving email", "body": "<p>According to my test, you could save email attachment and delete it using the below code:</p>\n\n<pre><code>Sub SaveAutoAttach()\n\nDim object_attachment As Outlook.attachment\n\nDim saveFolder As String\nDim oOutlook As Object\nDim oOlns As Object\nDim oOlInb As Object\nDim unRead, m As Object, att As Object\nDim some As String, other As String\n\nConst olFolderInbox = 6\n\n'~~&gt; Get Outlook instance\nSet oOutlook = GetObject(, \"Outlook.application\")\nSet oOlns = oOutlook.GetNamespace(\"MAPI\")\nSet oOlInb = oOlns.GetDefaultFolder(olFolderInbox)\n\n'~~&gt; Check if there are any actual unread emails\nSet unRead = oOlInb.Items.Restrict(\"[UnRead] = True\")\n\nIf unRead.Count = 0 Then\n    MsgBox \"NO Unread Email In Inbox\"\nElse\n\n    some = \"\"\n    other = \"\"\n    saveFolder = \"D:\\\"\n    For Each m In unRead\n        If m.Attachments.Count &gt; 0 Then\n            For Each object_attachment In m.Attachments\n            ' Criteria to save .doc files only\n                If InStr(object_attachment.DisplayName, \".doc\") Then\n                    object_attachment.SaveAsFile saveFolder &amp; \"\\\" &amp; object_attachment.DisplayName\n                End If\n             Next\n        End If\n        m.Delete\n    Next m\nEnd Sub\n</code></pre>\n\n<p>For more information, please refer to this link:</p>\n\n<p><a href=\"https://topbullets.com/2016/10/01/auto-download-outlook-email-attachment-code-in-vba-by-topbullets-com/\" rel=\"nofollow noreferrer\">Auto Download Outlook Email Attachment \u2013 Code in VBA by Topbullets.com</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7948113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095d1972c581d6f8b795fe8235f4fee0?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon168", "link": "https://stackoverflow.com/users/7948113/brandon168"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1595977050, "creation_date": 1544051332, "last_edit_date": 1595977050, "question_id": 53642191, "link": "https://stackoverflow.com/questions/53642191/save-attachment-on-arriving-email", "title": "Save Attachment on arriving email", "body": "<p>I created an Outlook rule to save an attachment then move it to the Deleted Items folder. The code works when I highlight the arrived email in the Inbox then move the email to the Deleted Items folder.</p>\n<p>When the new email arrives, it is saving the attachment(s) from different email in the inbox and not moving the email to the Deleted Items folder.</p>\n<p>The Outlook rule is:</p>\n<pre><code>Apply this rule after the message arrives\nfrom Sender\n and with Gift Card in the subject\n and on this computer only\nrun Project1.SaveAttachments\n</code></pre>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub SaveAttachments(MItem As Outlook.Mailitem)\n    Dim objOL As Outlook.Application\n    Dim objMsg As Outlook.Mailitem 'Object\n    Dim objAttachments As Outlook.Attachments\n    Dim objSelection As Outlook.Selection\n    Dim i As Long\n    Dim lngCount As Long\n    Dim strFile As String\n    Dim strFolderpath As String\n    Dim objNamespace As Outlook.NameSpace\n    Dim objDestFolder As Outlook.MAPIFolder\n    \nOn Error Resume Next\n\nSet objOL = CreateObject(&quot;Outlook.Application&quot;)\n\nSet objSelection = objOL.ActiveExplorer.Selection\n\nstrFolderpath = &quot;Y:\\&quot;\n\nFor Each objMsg In objSelection\n\n    Set objAttachments = objMsg.Attachments\n    lngCount = objAttachments.Count\n    strDeletedFiles = &quot;&quot;\n\n    If lngCount &gt; 0 Then\n\n        For i = lngCount To 1 Step -1\n\n            strFile = objAttachments.Item(i).FileName\n            strFile = strFolderpath &amp; strFile\n            objAttachments.Item(i).SaveAsFile strFile\n        Next i\n        Set objNamespace = objOL.GetNamespace(&quot;MAPI&quot;)\n        Set objDestFolder = objNamespace.GetDefaultFolder(olFolderDeletedItems)\n                    \n        objMsg.Move objDestFolder\n\n    End If\n    \nNext\n \nSet objAttachments = Nothing\nSet objMsg = Nothing\nSet objSelection = Nothing\nSet objOL = Nothing\nSet objNamespace = Nothing\nSet objDestFolder = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "listbox", "vba", "ms-access-2016", "autoscroll"], "answers": [{"tags": [], "owner": {"reputation": 237, "user_id": 3304214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RwjY3.jpg?s=128&g=1", "display_name": "trevor", "link": "https://stackoverflow.com/users/3304214/trevor"}, "is_accepted": false, "score": 0, "last_activity_date": 1544055955, "creation_date": 1544055955, "answer_id": 53642818, "question_id": 53642190, "link": "https://stackoverflow.com/questions/53642190/ms-access-automatic-scroll-on-list-box/53642818#53642818", "title": "MS - Access automatic scroll on list box.", "body": "<p>To do what you appear to be asking I think you need to build your own scroller!\nI would use these things to achieve that:</p>\n\n<ul>\n<li>a text box set to multi-line</li>\n<li>an array with each line of text to display in separate cells (or a recordset if you are brave)</li>\n<li>a timer function to update the text box</li>\n<li>a global counter to track the current first-line number of the text being displayed</li>\n</ul>\n\n<p>Pseudocode:</p>\n\n<pre><code>Init:\n    clear the text box\n    load the array with the text &amp; append each line to the text box as you go.\n    set the pointer to 1\n\nUpdateText (timer event):  \n' get length of current string\n    iLength = array(counter).text.length\n    ' chop the first row off the text\n    textbox.text  = right(textbox.text, len(textbox.text) - iLength)\n    ' add the text back on to the end\n    textbox.text.appendtext( array(counter).text)\n    increment counter\n    if counter &gt; array-num-items, set counter to 1   ' scroll over\n</code></pre>\n\n<p>have fun!</p>\n"}], "owner": {"reputation": 112, "user_id": 6850229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bb5a860c7cb69c0a1ebe5511772d6f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Komakino_1251", "link": "https://stackoverflow.com/users/6850229/komakino-1251"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544055955, "creation_date": 1544051321, "question_id": 53642190, "link": "https://stackoverflow.com/questions/53642190/ms-access-automatic-scroll-on-list-box", "title": "MS - Access automatic scroll on list box.", "body": "<p>I have created an access database form that displays a list of users and their productivity within a listbox. However when I get above 20 users, the list box cannot display the rest without scrolling. </p>\n\n<p>Is there a way that I can make the listbox scroll automatically to the bottom and then reset to the top like the end credits in a movie played on an endless loop?</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10236765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c410a82d98b9acdf4077bc782a2aeed?s=128&d=identicon&r=PG&f=1", "display_name": "vinylmike", "link": "https://stackoverflow.com/users/10236765/vinylmike"}, "edited": false, "score": 0, "creation_date": 1544056852, "post_id": 53642459, "comment_id": 94145133, "body": "This is not quite what I am looking for. Thank you for the comment though. What I really need to be able to do is copy the data from the account list Sheet, special paste it to cell C10 in the Input Sheet, Copy the result in range F5:C28 in the Output Sheet, paste it to A1 in the Load Profiles Sheet, and finally loop back to Account Sheet and repeat, adding the next set of data to the bottom of the first set. This would continue until it reached a blank cell."}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 23, "user_id": 10236765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c410a82d98b9acdf4077bc782a2aeed?s=128&d=identicon&r=PG&f=1", "display_name": "vinylmike", "link": "https://stackoverflow.com/users/10236765/vinylmike"}, "edited": false, "score": 1, "creation_date": 1544057239, "post_id": 53642459, "comment_id": 94145232, "body": "There seems to be a breakdown between what you want to do and what you are describing you want to do."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1544124591, "post_id": 53642459, "comment_id": 94175029, "body": "@MichalRosa It&#39;s <a href=\"https://en.wikipedia.org/wiki/XY_problem\" rel=\"nofollow noreferrer\">XY Problem</a> :)"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 0, "last_activity_date": 1544053056, "creation_date": 1544053056, "answer_id": 53642459, "question_id": 53642130, "link": "https://stackoverflow.com/questions/53642130/adding-a-loop-to-macro/53642459#53642459", "title": "Adding a Loop to Macro", "body": "<p>That should get you started. You can make your own adjustements to the code to suit your needs.</p>\n\n<pre><code>Sub Button2_Click()\n\n    Dim cll As Range\n    Dim lng As Long\n\n    ' Assuming the numbers for pricing are in cells G2:R2 in the Account List sheet\n    For Each cll In Sheets(\"Account List\").Range(\"G2:R2\")\n\n        ' Loop thru every number and populate cells C10 on the Input sheet\n        Sheets(\"Input\").Range(\"C10\").Value = cll.Value\n\n        ' Find the last row on be Load Profile sheet\n        With Sheets(\"Load Profile\")\n            lng = .Range(\"A2\", .Range(\"A\" &amp; .Rows.Count).End(xlUp)).Row\n\n        ' Copy data from the Output sheet to the first available row on the Load Profile sheet\n            .Range(\"A\" &amp; lng).Value = Sheets(\"Output\").Range(\"F5:C28\").Value\n\n        End With\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10236765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c410a82d98b9acdf4077bc782a2aeed?s=128&d=identicon&r=PG&f=1", "display_name": "vinylmike", "link": "https://stackoverflow.com/users/10236765/vinylmike"}, "edited": false, "score": 0, "creation_date": 1544111537, "post_id": 53644929, "comment_id": 94168675, "body": "This is exactly what I was looking for. Thank you very much for the help!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1544074354, "last_edit_date": 1544074354, "creation_date": 1544072405, "answer_id": 53644929, "question_id": 53642130, "link": "https://stackoverflow.com/questions/53642130/adding-a-loop-to-macro/53644929#53644929", "title": "Adding a Loop to Macro", "body": "<h1>AIOL</h1>\n\n<pre><code>Option Explicit\n\nSub AIOL()\n\n  Const cStrAL As String = \"Account List\"\n  Const cStrIn As String = \"Input\"\n  Const cStrOut As String = \"Output\"\n  Const cStrLP As String = \"Load Profiles\"\n\n  Const cStrRngAL As String = \"G2:R2\"\n  Const cStrRngIn As String = \"C10\"\n  Const cStrRngOut As String = \"F5:AC28\"\n  Const cStrRngLP As String = \"A1\"\n\n  Dim rngAL As Range\n  Dim rngIn As Range\n  Dim rngOut As Range\n  Dim rngLP As Range\n\n  Dim vnt1 As Variant    ' Array 1: Account List Array, Output Array\n  Dim vnt2 As Variant    ' Array 2: Input Array\n\n  Dim lngRow As Long     ' Account List Range Rows Counter\n  Dim intCol As Integer  ' Array Columns/Rows Counter\n\n  With ThisWorkbook\n    Set rngAL = .Worksheets(cStrAL).Range(cStrRngAL)\n    Set rngIn = .Worksheets(cStrIn).Range(cStrRngIn)\n    Set rngOut = .Worksheets(cStrOut).Range(cStrRngOut)\n    Set rngLP = .Worksheets(cStrLP).Range(cStrRngLP)\n  End With\n\n  ' ClearContents of 'Load Profiles'.\n  rngLP.Resize(Rows.Count, rngOut.Columns.Count).ClearContents\n\n  ' Assuming data in first column of rngAL is contiguous i.e. spans from the\n  ' first row's cell to the cell before the first empty cell.\n  For lngRow = rngAL.Row To rngAL.Cells(1, 1).End(xlDown).Row\n\n    ' Paste 'Account List' into Array 1.\n    vnt1 = rngAL.Offset(lngRow - rngAL.Row, 0)\n\n      ' Resize Array 2.\n      ReDim vnt2(1 To UBound(vnt1, 2), 1 To 1)\n      ' Transpose Array 1 to Array 2 (rows to columns and columns to rows).\n      For intCol = 1 To UBound(vnt1, 2)\n        vnt2(intCol, 1) = vnt1(1, intCol)\n      Next\n\n    Erase vnt1\n\n    ' Paste Array 2 into 'Input'.\n    rngIn.Resize(UBound(vnt2), 1) = vnt2\n\n    Erase vnt2\n\n    ' Paste 'Output' into Array 1.\n    vnt1 = rngOut\n\n      ' Paste Array 1 into 'Load Profiles'.\n      If lngRow &gt; rngAL.Row Then\n        rngLP.Parent.Cells(Rows.Count, rngLP.Column).End(xlUp).Offset(1, 0) _\n            .Resize(UBound(vnt1), UBound(vnt1, 2)) = vnt1\n       Else\n        ' Only first run through.\n        rngLP.Resize(UBound(vnt1), UBound(vnt1, 2)) = vnt1\n      End If\n\n    Erase vnt1\n\n  Next\n\n  ' Clean up.\n  Set rngAL = Nothing\n  Set rngIn = Nothing\n  Set rngOut = Nothing\n  Set rngLP = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10236765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c410a82d98b9acdf4077bc782a2aeed?s=128&d=identicon&r=PG&f=1", "display_name": "vinylmike", "link": "https://stackoverflow.com/users/10236765/vinylmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1544123979, "creation_date": 1544051043, "last_edit_date": 1544123979, "question_id": 53642130, "link": "https://stackoverflow.com/questions/53642130/adding-a-loop-to-macro", "title": "Adding a Loop to Macro", "body": "<p>Good afternoon,</p>\n\n<p>I have a pricing model at work that I have to fill out manually in order to determine our forecast. I essentially copy/paste data from one sheet to the next letting the formulas calculate the price shape. I would like to add a loop to my macro to cut down on the manual process.</p>\n\n<p>I would like the data from sheet \"<strong>Account list</strong>\", one row range at the time, starting with range <strong><code>G2:R2</code></strong>, copied transposing (rows to columns, columns to rows) into sheet \"<strong>Input</strong>\" starting on cell <strong><code>C10</code></strong>. This would generate my pricing. I would then go to sheet \"<strong>Output</strong>\" and copy the selection <strong><code>F5:C28</code></strong> and dump it into the sheet \"<strong>Load Profile</strong>\". I would like to loop it adding the data each time to the bottom of sheet \"<strong>Load Profile</strong>\" starting on cell <strong><code>A1</code></strong>, until there is no more data in sheet \"<strong>Account List</strong>\" i.e. a blank cell in column <strong><code>G</code></strong> is reached.</p>\n\n<p>Below is what I have so far:</p>\n\n<pre><code> Sub Button2_Click()\n\n  Sheets(\"Account List\").Select\n  Range(\"G2:R2\").Select\n  Selection.Copy\n  Sheets(\"Input\").Select\n  Range(\"C10\").Select\n  Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= False, _\n      Transpose:=True\n  Sheets(\"Output\").Select\n  Range(\"F5:AC28\").Select\n  Selection.Copy\n  Sheets(\"Load Profiles\").Select\n  Range(\"A1\").Select\n  Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, _\n      Transpose:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1544061408, "post_id": 53641953, "comment_id": 94146099, "body": "<i>This does not work though.</i> - Posting a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> will help you get more attention to your problem."}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1544085185, "post_id": 53641953, "comment_id": 94153037, "body": "I have rectified this"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1544085043, "post_id": 53643670, "comment_id": 94152964, "body": "Thank you very much. This works perfectly. Could i ask is it possible to merge the cells in Column B with the row below (seeing as it is empty)? It may be the case that for some of the data i want to merge the cells as well as i will have a common statistic for both teams...."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "reply_to_user": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1544087980, "post_id": 53643670, "comment_id": 94154535, "body": "Just add this after the &quot;B&quot; Line: &#39;.Cells(ltaLR, &quot;B&quot;).Resize(2, 1).Merge&#39; (without the quotes) and delete the commented second &quot;B&quot; Line."}, {"owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "edited": false, "score": 0, "creation_date": 1544088220, "post_id": 53643670, "comment_id": 94154683, "body": "Perfect. Thank you so much for your help. Everything is working as wanted!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1544089874, "last_edit_date": 1544089874, "creation_date": 1544062817, "answer_id": 53643670, "question_id": 53641953, "link": "https://stackoverflow.com/questions/53641953/how-can-i-copy-cells-from-one-row-on-sheet-to-two-different-rows-on-different-sh/53643670#53643670", "title": "How can I copy cells from one row on Sheet to two different rows on different sheet using VBA?", "body": "<h1>LTA Trades Test</h1>\n\n<pre><code>Option Explicit\n\nSub LTATradesTest()\n\n    Application.ScreenUpdating = False\n\n    Dim LastRow As Long, fs As Worksheet, ds As Worksheet, x As Long\n    Dim ltaLR As Long\n\n    With ThisWorkbook\n        Set fs = .Worksheets(\"Filters\")\n        Set ds = .Worksheets(\"Data\")\n    End With\n\n    LastRow = ds.Cells.Find(\"*\", LookIn:=xlFormulas, Lookat:=xlWhole, _\n        SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    ClearSelections\n    SortData\n\n    For x = 4 To LastRow\n\n        If ds.Cells(x, 1) = ds.Range(\"E1\") And ds.Cells(x, 40) &gt;= _\n            fs.Range(\"C2\") And ds.Cells(x, 41) &gt;= fs.Range(\"C2\") Then\n\n            With ThisWorkbook.Worksheets(\"LTA\")\n\n                ltaLR = .Cells.Find(\"*\", LookIn:=xlFormulas, Lookat:=xlWhole, _\n                    SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row + 1\n\n                .Cells(ltaLR, \"B\").Value = ds.Cells(x, 3)\n                .Cells(ltaLR, \"B\").Resize(2, 1).Merge\n\n                .Cells(ltaLR, \"C\").Value = ds.Cells(x, 4)\n                .Cells(ltaLR + 1, \"C\").Value = ds.Cells(x, 5)\n                .Cells(ltaLR, \"D\").Value = ds.Cells(x, 81)\n                .Cells(ltaLR + 1, \"D\").Value = ds.Cells(x, 91)\n                .Cells(ltaLR, \"E\").Value = ds.Cells(x, 82)\n                .Cells(ltaLR + 1, \"E\").Value = ds.Cells(x, 92)\n                .Cells(ltaLR, \"F\").Value = ds.Cells(x, 83)\n                .Cells(ltaLR + 1, \"F\").Value = ds.Cells(x, 93)\n                .Cells(ltaLR, \"G\").Value = ds.Cells(x, 84)\n                .Cells(ltaLR + 1, \"G\").Value = ds.Cells(x, 94)\n                .Cells(ltaLR, \"H\").Value = ds.Cells(x, 85)\n                .Cells(ltaLR + 1, \"H\").Value = ds.Cells(x, 96)\n                .Cells(ltaLR, \"I\").Value = ds.Cells(x, 95)\n                .Cells(ltaLR + 1, \"I\").Value = ds.Cells(x, 86)\n                .Cells(ltaLR, \"J\").Value = ds.Cells(x, 88)\n                .Cells(ltaLR + 1, \"J\").Value = ds.Cells(x, 98)\n\n                .Cells(ltaLR, \"K\").Value = Round((ds.Cells(x, 57).Value _\n                    / ds.Cells(x, 40).Value) * 100, 0) &amp; \"% (\" _\n                    &amp; ds.Cells(x, 57).Value &amp; \"/\" &amp; ds.Cells(x, 40).Value &amp; \")\"\n                .Cells(ltaLR + 1, \"K\").Value = Round((ds.Cells(x, 71).Value _\n                    / ds.Cells(x, 41).Value) * 100, 0) &amp; \"% (\" _\n                    &amp; ds.Cells(x, 71).Value &amp; \"/\" &amp; ds.Cells(x, 41).Value &amp; \")\"\n                .Cells(ltaLR, \"L\").Value = Round((ds.Cells(x, 58).Value _\n                    / ds.Cells(x, 40).Value) * 100, 0) &amp; \"% (\" _\n                    &amp; ds.Cells(x, 58).Value &amp; \"/\" &amp; ds.Cells(x, 40).Value &amp; \")\"\n                .Cells(ltaLR + 1, \"L\").Value = Round((ds.Cells(x, 72).Value _\n                    / ds.Cells(x, 41).Value) * 100, 0) &amp; \"% (\" _\n                    &amp; ds.Cells(x, 72).Value &amp; \"/\" &amp; ds.Cells(x, 41).Value &amp; \")\"\n\n                .Cells(ltaLR, \"M\").Value = Round(((ds.Cells(x, 229).Value _\n                    + ds.Cells(x, 243).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 229).Value + ds.Cells(x, 243).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n                .Cells(ltaLR + 1, \"M\").Value = Round(((ds.Cells(x, 257).Value _\n                    + ds.Cells(x, 275).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 257).Value + ds.Cells(x, 275).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n                .Cells(ltaLR, \"N\").Value = Round(((ds.Cells(x, 54).Value + _\n                    ds.Cells(x, 68).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 54).Value + ds.Cells(x, 68).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n                .Cells(ltaLR + 1, \"N\").Value = Round(((ds.Cells(x, 55).Value _\n                    + ds.Cells(x, 69).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 55).Value + ds.Cells(x, 69).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n                .Cells(ltaLR, \"O\").Value = Round(((ds.Cells(x, 56).Value _\n                    + ds.Cells(x, 70).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 56).Value + ds.Cells(x, 70).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n                .Cells(ltaLR + 1, \"O\").Value = Round(((ds.Cells(x, 59).Value _\n                    + ds.Cells(x, 73).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 59).Value + ds.Cells(x, 73).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n                .Cells(ltaLR, \"P\").Value = Round(((ds.Cells(x, 144).Value _\n                    + ds.Cells(x, 159).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 144).Value + ds.Cells(x, 159).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n                .Cells(ltaLR + 1, \"P\").Value = Round(((ds.Cells(x, 147).Value _\n                    + ds.Cells(x, 162).Value) / (ds.Cells(x, 40).Value _\n                    + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" _\n                    &amp; (ds.Cells(x, 147).Value + ds.Cells(x, 162).Value) &amp; \"/\" _\n                    &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n\n            End With\n\n        End If\n\n    Next x\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3672422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8890529ccc2202f5e0161776429d775?s=128&d=identicon&r=PG&f=1", "display_name": "MA84", "link": "https://stackoverflow.com/users/3672422/ma84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "closed_date": 1544074512, "accepted_answer_id": 53643670, "answer_count": 1, "score": 0, "last_activity_date": 1581692621, "creation_date": 1544050072, "last_edit_date": 1581692621, "question_id": 53641953, "link": "https://stackoverflow.com/questions/53641953/how-can-i-copy-cells-from-one-row-on-sheet-to-two-different-rows-on-different-sh", "closed_reason": "Needs details or clarity", "title": "How can I copy cells from one row on Sheet to two different rows on different sheet using VBA?", "body": "<p>In my excel workbook I have a 'data sheet' that is 294 columns wide, and contains lots of data for football matches. <strong>Each row</strong> on that data sheet corresponds to the data for <strong>one match</strong>. Due to the amount of columns the data is almost unreadable so to filter the data, I have written a VBA code which currently loops through all of the data and when various criteria for a match are met it adds the data to columns in a row on a different sheet e.g.\ncolumn A (home team), column B (away team), column C (some data), column D (some data) etc...</p>\n\n<p>I want to change it so that instead of having <strong>one match in one row</strong>, I'd like to split it into <strong>one match in two rows</strong>. The simple reason for this is so that I gain a bit of space and it becomes more readable.</p>\n\n<p>So for example i want it to read :</p>\n\n<p>ROW 3 (home team) and the columns hold all the data for the home team.\nROW 4 (away team) and the columns hold all the data for the away team.</p>\n\n<p>Here is my original VBA: </p>\n\n<pre><code>Sub LTATrades()\n\n    Application.ScreenUpdating = False\n    Dim LastRow As Long, fs As Worksheet, ds As Worksheet, x As Long\n    Set fs = Sheets(\"Filters\")\n    Set ds = Sheets(\"Data\")\n    LastRow = ds.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    ClearSelections\n    SortData\n    DeleteCF\n    For x = 4 To LastRow\n        If ds.Cells(x, 1) = ds.Range(\"E1\") And ds.Cells(x, 40) &gt;= fs.Range(\"C2\") And ds.Cells(x, 41) &gt;= fs.Range(\"C2\") Then\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"B\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 3)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"C\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 4)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"D\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 5)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"E\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 81)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"F\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 91)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"G\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 82)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"H\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 92)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"I\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 83)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"J\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 93)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"K\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 84)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"L\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 94)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"M\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 85)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"N\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 96)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"O\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 95)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"P\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 86)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"Q\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 88)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"R\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 98)\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"S\").End(xlUp).Offset(1, 0).Value = Round((ds.Cells(x, 57).Value / ds.Cells(x, 40).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 57).Value &amp; \"/\" &amp; ds.Cells(x, 40).Value &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"T\").End(xlUp).Offset(1, 0).Value = Round((ds.Cells(x, 71).Value / ds.Cells(x, 41).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 71).Value &amp; \"/\" &amp; ds.Cells(x, 41).Value &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"U\").End(xlUp).Offset(1, 0).Value = Round((ds.Cells(x, 58).Value / ds.Cells(x, 40).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 58).Value &amp; \"/\" &amp; ds.Cells(x, 40).Value &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"V\").End(xlUp).Offset(1, 0).Value = Round((ds.Cells(x, 72).Value / ds.Cells(x, 41).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 72).Value &amp; \"/\" &amp; ds.Cells(x, 41).Value &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"W\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 229).Value + ds.Cells(x, 243).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 229).Value + ds.Cells(x, 243).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"X\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 257).Value + ds.Cells(x, 275).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 257).Value + ds.Cells(x, 275).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"Y\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 54).Value + ds.Cells(x, 68).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 54).Value + ds.Cells(x, 68).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"Z\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 55).Value + ds.Cells(x, 69).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 55).Value + ds.Cells(x, 69).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"AA\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 56).Value + ds.Cells(x, 70).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 56).Value + ds.Cells(x, 70).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"AB\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 59).Value + ds.Cells(x, 73).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 59).Value + ds.Cells(x, 73).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"AC\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 144).Value + ds.Cells(x, 159).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 144).Value + ds.Cells(x, 159).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n            Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"AD\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 147).Value + ds.Cells(x, 162).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 147).Value + ds.Cells(x, 162).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        End If\n    Next x\n    ResetCFLTA\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>And now, here is what i have tried to make it work as i want...</p>\n\n<pre><code>Sub LTATradesTest()\n    Application.ScreenUpdating = False\n    Dim LastRow As Long, fs As Worksheet, ds As Worksheet, x As Long\n    Set fs = Sheets(\"Filters\")\n    Set ds = Sheets(\"Data\")\n    LastRow = ds.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    ClearSelections\n    SortData\n\n\n    For x = 4 To LastRow\n    If ds.Cells(x, 1) = ds.Range(\"E1\") And ds.Cells(x, 40) &gt;= fs.Range(\"C2\") And ds.Cells(x, 41) &gt;= fs.Range(\"C2\") Then\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"B\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 3)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"C\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 4)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"C\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 5)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"D\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 81)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"D\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 91)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"E\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 82)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"E\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 92)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"F\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 83)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"F\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 93)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"G\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 84)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"G\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 94)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"H\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 85)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"H\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 96)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"I\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 95)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"I\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 86)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"J\").End(xlUp).Offset(1, 0).Value = ds.Cells(x, 88)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"J\").End(xlUp).Offset(2, 0).Value = ds.Cells(x, 98)\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"K\").End(xlUp).Offset(1, 0).Value = Round((ds.Cells(x, 57).Value / ds.Cells(x, 40).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 57).Value &amp; \"/\" &amp; ds.Cells(x, 40).Value &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"K\").End(xlUp).Offset(2, 0).Value = Round((ds.Cells(x, 71).Value / ds.Cells(x, 41).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 71).Value &amp; \"/\" &amp; ds.Cells(x, 41).Value &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"L\").End(xlUp).Offset(1, 0).Value = Round((ds.Cells(x, 58).Value / ds.Cells(x, 40).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 58).Value &amp; \"/\" &amp; ds.Cells(x, 40).Value &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"L\").End(xlUp).Offset(2, 0).Value = Round((ds.Cells(x, 72).Value / ds.Cells(x, 41).Value) * 100, 0) &amp; \"% (\" &amp; ds.Cells(x, 72).Value &amp; \"/\" &amp; ds.Cells(x, 41).Value &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"M\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 229).Value + ds.Cells(x, 243).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 229).Value + ds.Cells(x, 243).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"M\").End(xlUp).Offset(2, 0).Value = Round(((ds.Cells(x, 257).Value + ds.Cells(x, 275).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 257).Value + ds.Cells(x, 275).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"N\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 54).Value + ds.Cells(x, 68).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 54).Value + ds.Cells(x, 68).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"N\").End(xlUp).Offset(2, 0).Value = Round(((ds.Cells(x, 55).Value + ds.Cells(x, 69).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 55).Value + ds.Cells(x, 69).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"O\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 56).Value + ds.Cells(x, 70).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 56).Value + ds.Cells(x, 70).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"O\").End(xlUp).Offset(2, 0).Value = Round(((ds.Cells(x, 59).Value + ds.Cells(x, 73).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 59).Value + ds.Cells(x, 73).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"P\").End(xlUp).Offset(1, 0).Value = Round(((ds.Cells(x, 144).Value + ds.Cells(x, 159).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 144).Value + ds.Cells(x, 159).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n        Sheets(\"LTA\").Cells(Sheets(\"LTA\").Rows.Count, \"P\").End(xlUp).Offset(2, 0).Value = Round(((ds.Cells(x, 147).Value + ds.Cells(x, 162).Value) / (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value)) * 100, 0) &amp; \"% (\" &amp; (ds.Cells(x, 147).Value + ds.Cells(x, 162).Value) &amp; \"/\" &amp; (ds.Cells(x, 40).Value + ds.Cells(x, 41).Value) &amp; \")\"\n    End If\nNext x\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Can anyone help me achieve what i want?</p>\n\n<p>There is a slight snag. As you can see the first piece of data is common to both teams (it is the name of the league) Is there anyway to tell excel to merge the two rows for column B?</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba", "email"], "comments": [{"owner": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "edited": false, "score": 0, "creation_date": 1544068575, "post_id": 53641714, "comment_id": 94147677, "body": "can you simply replace <code>.To = &quot;&quot;</code> with <code>.To = Range(&quot;L2&quot;).Value</code>? As well, <code>.Subject = Range(&quot;E1&quot;).Value&amp;Range(&quot;F1&quot;).Value&amp;Range(&quot;G1&quot;).Value...etc.&zwnj;&#8203;&quot;</code>? The picture seems more complicated, and is answered <a href=\"https://stackoverflow.com/questions/44869790/embed-picture-in-outlook-mail-body-excel-vba\">here</a>"}, {"owner": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "reply_to_user": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "edited": false, "score": 0, "creation_date": 1544130995, "post_id": 53641714, "comment_id": 94177843, "body": "I am getting an &#39;error mismatch&#39; when using that format. Do you have any ideas why?"}, {"owner": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "edited": false, "score": 0, "creation_date": 1544194604, "post_id": 53641714, "comment_id": 94201289, "body": "I see you have a solution, however I sill still answer this. the type must be a string, however the value in the cell may be a number of some sort(int, long, etc.) so you can use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/vartype-function\" rel=\"nofollow noreferrer\">vartype</a> to confirm it is a string. You can also use <code>.Text</code> instead of <code>.Value.</code> in the code."}, {"owner": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "reply_to_user": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "edited": false, "score": 0, "creation_date": 1544878691, "post_id": 53641714, "comment_id": 94435954, "body": "Apologies for the delayed reply. Thanks for that, the To and Subject address is working as intended - although I&#39;m getting a syntax error with the &amp;Range aspect. Is there an easier method of copying the Excel range specified in to the email body, like the solution below?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "edited": false, "score": 0, "creation_date": 1544132003, "post_id": 53644874, "comment_id": 94178231, "body": "That method is so much cleaner, I didn&#39;t know that was possible! I did manage to get it partially working, the email body is working perfectly but I am struggling to get the recipient and the subject section to work. Is it because the cell value is a formula that it is creating the error?  I&#39;ve included an image to the original post, if it makes it more clearer what I am trying to do. But, thanks, that is already an amazing step in the right direction!!"}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "reply_to_user": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "edited": false, "score": 0, "creation_date": 1544158642, "post_id": 53644874, "comment_id": 94184780, "body": "From all I can see, e.g. <code>.Cells(2, 12).Value</code>should return the result of the formula. Just tried: String is filled as it should be. What do you see if you add <code>debug.print strRecipients</code>and <code>debug.print strSubject</code>right after the lines where you fill the variables?"}, {"owner": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "edited": false, "score": 0, "creation_date": 1544206518, "post_id": 53644874, "comment_id": 94207261, "body": "Awesome, that seems to have done it! Two quick questions though, when I remove &quot;.Item.Attachments&quot;, the code doesn&#39;t work, how can I remove this without crashing the code? Also, is it possible to import the user&#39;s signatures in excel or default all messages with that user&#39;s signature?"}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "reply_to_user": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "edited": false, "score": 0, "creation_date": 1544417736, "post_id": 53644874, "comment_id": 94254295, "body": "Did you remove the whole line of code, not just <code>.Item.Attachments</code>? Should work then. Never tried adding a signature, and not sure whether that would work either. But as a workaround, you might at least include the signature text in the selected cells. Not ideal, but feasable. Glad it worked for you so far. If you are fine with the answer, accepting it would be much appreciated."}, {"owner": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "edited": false, "score": 0, "creation_date": 1544878986, "post_id": 53644874, "comment_id": 94436022, "body": "That worked perfectly, thank you. I&#39;ve been thinking of a way around the signature text. If I use a code to identify the user when they input in to a certain cell (it finds their windows user name), I could then use another vLookup formula to change the signatures depending on the user. I could then extend the range so that it sends the signature along with the body of text. How does that sound, is it to complex?"}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "reply_to_user": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "edited": false, "score": 0, "creation_date": 1545034521, "post_id": 53644874, "comment_id": 94470588, "body": "Should be feasable."}], "tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": true, "score": 1, "last_activity_date": 1544072033, "creation_date": 1544072033, "answer_id": 53644874, "question_id": 53641714, "link": "https://stackoverflow.com/questions/53641714/excel-vba-to-create-email-generator-compatible-with-vlookup/53644874#53644874", "title": "Excel VBA to create email generator compatible with VLookup", "body": "<p>whenever I need to send a part of a spreadsheet, I usually do that directly via Excel, not including Outlook:</p>\n\n<pre><code>Sub SendTheStuff()\n    Dim strRecipients As String\n    Dim strSubject As String\n\n    strRecipients = Worksheets(\"Sheet 1\").Cells(2, 12).Value   'your client's mail adress, assuming it to be on Sheet 1 of your book, adjust to your needs\n    strSubject = Worksheets(\"Sheet 1\").Cells(1, 5).Value   'The content of Sheet 1, Cell \"E1\" - see if you can combine the range you want into one cell to keep code simple - and adjust the Sheet if necessary\n\n    Worksheets(\"Sheet 1\").Range(\"B4:L36\").Select\n    With Selection\n        ActiveWorkbook.EnvelopeVisible = True\n        With ActiveSheet.MailEnvelope\n            .Item.Subject = strSubject\n            .Item.To = strRecipients\n            .Item.Attachments.Add \"T:\\he\\Path\\To\\An\\Attachm.ent\"   'you may even add a file in case you need to\n            .Item.Send\n        End With\n    End With\n\nActiveWorkbook.EnvelopeVisible = False\n\nEnd Sub\n</code></pre>\n\n<p>This method uses Excel as the mail client, works fine for me - give it a try!</p>\n"}], "owner": {"reputation": 25, "user_id": 10751634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GcDri.jpg?s=128&g=1", "display_name": "ToySoldier", "link": "https://stackoverflow.com/users/10751634/toysoldier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 53644874, "answer_count": 1, "score": 1, "last_activity_date": 1581745517, "creation_date": 1544048781, "last_edit_date": 1581745517, "question_id": 53641714, "link": "https://stackoverflow.com/questions/53641714/excel-vba-to-create-email-generator-compatible-with-vlookup", "title": "Excel VBA to create email generator compatible with VLookup", "body": "<p>I currently have a spreadsheet that pulls information out from another sheet. It uses a series of Vlookup formulas to generate a message using the client's details in Sheet1. To send these emails I have been using two macro commands. One simply copies the range (B4:L36): </p>\n\n<pre><code>Sub Copy()\nCopy Macro\nRange(\"B4:L36\").Select\nSelection.Copy\nEnd Sub\n</code></pre>\n\n<p>The other command opens a blank email: </p>\n\n<pre><code>Sub MailIt()\nDim oMailItem As Object\nDim oOLapp As Object\nSet oOLapp = CreateObject(\"Outlook.application\")\nSet oMailItem = oOLapp.CreateItem(0)\nWith oMailItem\n.To = \"\"\n.CC = \"\"\n.Subject = \"\"\n.Body = \"\"\n.Display\nEnd With\nSet oOLapp = Nothing\nSet oMailItem = Nothing\nEnd Sub\n</code></pre>\n\n<p>I then paste the message as a picture in the email body. I go back to my spreadsheet and copy the generated title from the range E1:J1 and paste this as my email subject. Lastly, I copy the recipient address from L2 and paste it into my email and send. </p>\n\n<p>Is there a way to have a VBA command that: </p>\n\n<ol>\n<li>looks at the address in L2 and pastes it as the recipient address in the email (assuming that the VLookup formula would not interfere with this).</li>\n<li>copies the title range from E1:J1 and pastes it as the email subject.</li>\n<li>copies the message range (B4:L36) and pastes it as the email body (as a picture).  </li>\n</ol>\n\n<p>As a <a href=\"https://imgur.com/NqZxQf0\" rel=\"nofollow noreferrer\">visual example</a> of what the spreadsheet is doing please see the hyperlink. The basic idea is that it is taking the details from the INFO tab and using the VLookup formulas to generate the message in the Proforma tab (for data protective reasons, I've blacked out the message). If there are better methods of doing this, please let me know - I'm always happy to learn more! </p>\n\n<p>I have done a lot of research into this and have found that it is possible to create emails that do this, however, I am struggling to get it to work and would appreciate some help! </p>\n\n<p>Thank you.</p>\n"}, {"tags": ["html", "vba", "callbyname"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544047475, "post_id": 53641324, "comment_id": 94142393, "body": "It would help if you share HTML samples and expected outcomes. There may be a better way. And as you already have a Select Case why not just put your selector direct in there?"}, {"owner": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1544047832, "post_id": 53641324, "comment_id": 94142510, "body": "Unfortunately the webpages are in private. Your idea about css selector is good and I think it is better. THANKS!"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "edited": false, "score": 0, "creation_date": 1544052702, "post_id": 53641882, "comment_id": 94144100, "body": "I can&#39;t use this way, because the element &quot;MyElem&quot; created after Case."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "edited": false, "score": 1, "creation_date": 1544053095, "post_id": 53641882, "comment_id": 94144212, "body": "So create it before ?  Or wrap the select in a function, passing in MyElem as an argument."}, {"owner": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "edited": false, "score": 0, "creation_date": 1544053597, "post_id": 53641882, "comment_id": 94144326, "body": "I should try it. Is there any way to use CallByName to set an object to another? Like this: <code>Set obj = CallByName(MyElem,property,VbSet)</code> If it is possible I can make final object which has multiple levels of properties."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "edited": false, "score": 0, "creation_date": 1544056566, "post_id": 53641882, "comment_id": 94145072, "body": "Yes - it would be <code>Set obj = CallByName(MyElem,property, VbGet)</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1544049719, "creation_date": 1544049719, "answer_id": 53641882, "question_id": 53641324, "link": "https://stackoverflow.com/questions/53641324/callbyname-with-multiple-levels-of-properties/53641882#53641882", "title": "CallByName with multiple levels of properties", "body": "<p>Why not this?</p>\n\n<pre><code>Dim res\n\nSelect Case Webpage\n     Case \"webpage_1\"\n        res = MyElem.parentElement.parentElement.parentElement.getelementsbytagname(\"tr\")(3).innertext\n     Case \"webpage_2\"\n        res = MyElem.parentElement.parentElement.getelementsbytagname(\"div\")(2).innertext\n\n      ' and so on ...\n\n End Select\n\nMsgBox res\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 353, "user_id": 4476460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd8dfa9fc2eee39eada8e9bc761795b4?s=128&d=identicon&r=PG", "display_name": "Harry S", "link": "https://stackoverflow.com/users/4476460/harry-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1603761378, "creation_date": 1603761378, "answer_id": 64547075, "question_id": 53641324, "link": "https://stackoverflow.com/questions/53641324/callbyname-with-multiple-levels-of-properties/64547075#64547075", "title": "CallByName with multiple levels of properties", "body": "<pre><code>Function PropDotVal(wObjName$, PropNa$)\n</code></pre>\n<p>Dim wObj As Object: Set wObj = ObjFromStr(wObjName)</p>\n<p>'  ObjFromStr in module with lines like\n' there has got to be an inbuilt  vba function  that does not need many case functions\n'       str                       obj\n'Case &quot;sTable&quot;: Set ObjFromStr = sTable ' ShapePlus\n'Case &quot;WHCages&quot;: Set ObjFromStr = WHCages ' spt</p>\n<p>Dim Si%, NaA$()\nPropDotVal = &quot;NA&quot;\nOn Error GoTo NotAvailable\nNaA = Split(PropNa, &quot;.&quot;)</p>\n<p>If UBound(NaA) &gt; 0 Then</p>\n<pre><code>  ' PropNa format multi like  wObj.Objb.objc  etc  .prop\n  '  convert wObj as  FredsFarm      with     PropNa as TopEnd.fill.backcolor.rgb\n  ' to wobj as FredsFarm.TopEnd.fill.backcolor\n  'and  Nsa(si) as &quot;rgb&quot; to CallByName from it\n\n  For Si = 0 To UBound(NaA) - 1\n     Set wObj = CallByName(wObj, NaA(Si), VbGet)\n  Next Si\n</code></pre>\n<p>End If</p>\n<p>PropDotVal = CallByName(wObj, NaA(Si), VbGet)\nNotAvailable:</p>\n<p>End Function</p>\n<pre><code>enter code here\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8105211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5c75204f5e524f1b18438c0e3994750?s=128&d=identicon&r=PG&f=1", "display_name": "AliM67", "link": "https://stackoverflow.com/users/8105211/alim67"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1603761378, "creation_date": 1544046796, "question_id": 53641324, "link": "https://stackoverflow.com/questions/53641324/callbyname-with-multiple-levels-of-properties", "title": "CallByName with multiple levels of properties", "body": "<p>I want to use CallByName in VBA to read a specific data from such webpages. Those webpages have different html structures. In my case, there is a element that I need to refer 2 or 3 parent nodes and get an element with  or  tags. See the code:</p>\n\n<p>element in all webpages I named <code>MyElem</code></p>\n\n<p>in one webpage I need this code:</p>\n\n<pre><code>MsgBox MyElem.parentElement.parentElement.parentElement.getelementsbytagname(\"tr\")(3).innertext\n</code></pre>\n\n<p>in another webpage I need this code:</p>\n\n<pre><code>MsgBox MyElem.parentElement.parentElement.getelementsbytagname(\"div\")(2).innertext\n</code></pre>\n\n<p>and so on ...</p>\n\n<p>I want to write in VBA as below:</p>\n\n<pre><code>Select Case Webpage\n     Case \"webpage_1\"\n        property =\"parentElement.parentElement.parentElement.getelementsbytagname(\"tr\")(3).innertext\"\n     Case \"webpage_2\"\n        property = \"parentElement.parentElement.getelementsbytagname(\"div\")(2).innertext\"\n\n      ' and so on ...\n\n End Select\n\nMsgBox CallByName(MyElem, property, VbGet)\n</code></pre>\n\n<p>The problem is that CallByName don't support multiple levels of properties.\nI read similar topic <a href=\"https://stackoverflow.com/questions/43809480/visual-basic-callbyname-with-multiple-levels\">here</a> but it doesn't help to my case. Is there any idea?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 2, "creation_date": 1544046767, "post_id": 53641197, "comment_id": 94142153, "body": "never ending loop....because you are running it in worksheet change. How do you want the code to activate? From an button? or a certain cell?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1544047006, "post_id": 53641197, "comment_id": 94142238, "body": "You may find <a href=\"https://stackoverflow.com/questions/15761530/vba-worksheet-change-event-bypass\">this</a> to be useful"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544048747, "post_id": 53641327, "comment_id": 94142818, "body": "I believe the issue is the code itself triggers a worksheet change. ...which triggers the macro, which triggers a worksheet change, which triggers the macro, which ..."}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": -1, "last_activity_date": 1544046818, "creation_date": 1544046818, "answer_id": 53641327, "question_id": 53641197, "link": "https://stackoverflow.com/questions/53641197/vba-multiply-columns/53641327#53641327", "title": "VBA - multiply columns", "body": "<p>I don't see how it would \"crash\" Excel, abyway you don't need <code>Change(ByVal Target As Range)</code>so it's simply:</p>\n\n<pre><code>Private Sub foo()\n\n    For i = 27 To 52\n\n      Cells(i, 6).Value = Cells(i, 4).Value * Cells(i, 5).Value\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1555553725, "post_id": 53641449, "comment_id": 98154004, "body": "Michael and Justyna...thank you for your assistance on the above. I just got around to fixing this and am using the Worksheet_Change event. If i may ask, in the request above i was simply trying to automate a multiplication of column D X column E to column F. Would there be a way for the user to be able to &#39;override&#39; the multiplication in column F to provide them with two options?"}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 5, "last_activity_date": 1544047419, "creation_date": 1544047419, "answer_id": 53641449, "question_id": 53641197, "link": "https://stackoverflow.com/questions/53641197/vba-multiply-columns/53641449#53641449", "title": "VBA - multiply columns", "body": "<p>Excel will crash as your code is creating an infinite loop, due to Change Event that you are using. Every time your code multiplies two given cells it is being identified as a change event, so your code will be triggered again, and again...</p>\n\n<p>You can either use the adjusted code that Michal has posted, or you can adjust your original code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    For i = 27 To 52\n        Cells(i, 6) = Cells(i, 4) * Cells(i, 5)\n    Next i\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Hope it helps!</p>\n"}], "owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1242, "favorite_count": 0, "accepted_answer_id": 53641327, "answer_count": 2, "score": 1, "last_activity_date": 1581692634, "creation_date": 1544046252, "last_edit_date": 1581692634, "question_id": 53641197, "link": "https://stackoverflow.com/questions/53641197/vba-multiply-columns", "title": "VBA - multiply columns", "body": "<p>I am running a small VBA to loop through a range of rows (27 - 52) to return a simple multiplication of column D X column E to column F.</p>\n\n<p>My code below crashes Excel. Can anyone point out the obvious as to where i am going wrong. I am clearly no expert!</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nFor i = 27 To 52\n\n  Cells(i, 6) = Cells(i, 4) * Cells(i, 5)\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1544046325, "post_id": 53641104, "comment_id": 94142009, "body": "whats your code?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1544046402, "post_id": 53641104, "comment_id": 94142034, "body": "WordEditor the <a href=\"https://www.microsoft.com/p/wordeditor/9wzdncrdgbpk\" rel=\"nofollow noreferrer\">add-in</a> or WordEditor the <a href=\"https://docs.microsoft.com/office/vba/api/outlook.inspector.wordeditor\" rel=\"nofollow noreferrer\">property</a>? Can you add to specific detail about what you&#39;re trying to do and what you&#39;ve tried so far?  (see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> as well as <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}, {"owner": {"reputation": 115, "user_id": 7549586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2237335cbaf7629c33c82664fe0926c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kuljeet Keshav", "link": "https://stackoverflow.com/users/7549586/kuljeet-keshav"}, "edited": false, "score": 0, "creation_date": 1544090530, "post_id": 53641104, "comment_id": 94155961, "body": "Sorry for not adding Code before. I have added the code in the question."}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1544062113, "creation_date": 1544062113, "answer_id": 53643570, "question_id": 53641104, "link": "https://stackoverflow.com/questions/53641104/paste-text-and-multiple-excel-ranges-as-images-in-outlook-using-wordeditor/53643570#53643570", "title": "Paste text and multiple Excel ranges as images in Outlook using wordeditor", "body": "<p>You could refer to the below code:</p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim rng As Range\n    Dim olApp As Object\n    Dim Email As Object\n    Dim Sht As Excel.Worksheet\n    Dim wdDoc As Word.Document\n\n    Set Sht = ActiveWorkbook.Sheets(\"Dashboard\")\n    Set rng = Sht.Range(\"B4:L17\")\n        rng.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set Email = olApp.CreateItem(0)\n    Set wdDoc = Email.GetInspector.WordEditor\n\n    With Email\n        .To = \"\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"\"\n        .Attachments.Add ActiveWorkbook.FullName\n\n         wdDoc.Range.PasteAndFormat Type:=wdChartPicture\n\n'        if need setup inlineshapes hight &amp; width\n         With wdDoc\n            .InlineShapes(1).Height = 130\n         End With\n\n        .Display\n    End With\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set Email = Nothing\n    Set olApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>For more information, please refer to these links:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/48896499/copy-excel-range-as-picture-to-outlook\">Copy Excel range as Picture to Outlook</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/49682060/copy-range-of-cells-from-excel-as-picture-and-add-text-in-the-email-body\">Copy range of cells from Excel as picture and add text in the email body</a></p>\n"}], "owner": {"reputation": 115, "user_id": 7549586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2237335cbaf7629c33c82664fe0926c2?s=128&d=identicon&r=PG&f=1", "display_name": "Kuljeet Keshav", "link": "https://stackoverflow.com/users/7549586/kuljeet-keshav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1473, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1544090887, "creation_date": 1544045684, "last_edit_date": 1544090887, "question_id": 53641104, "link": "https://stackoverflow.com/questions/53641104/paste-text-and-multiple-excel-ranges-as-images-in-outlook-using-wordeditor", "title": "Paste text and multiple Excel ranges as images in Outlook using wordeditor", "body": "<p>I am trying to paste multiple Excel ranges as images in Outlook mail using VBA. I am using the answer to this question (<a href=\"https://stackoverflow.com/questions/29092999/pasting-an-excel-range-into-an-email-as-a-picture\">Pasting an Excel range into an email as a picture</a>) to paste a range of excel as image in mail but as soon as I paste another  range, it overwrites the previous image. Is there anyway to change the cursor position in Outlook mail using wordeditor. I tried using collapse before pasting the image but it did not help. Also how do I add the text to it as using Outmail.body to edit anything gets overwritten too by the image pasted afterwards. \n This is the code I am using:</p>\n\n<pre><code>Sub Sendmail()\nDim r as range\nSet r = Range(\"C2:O13)\nr.copy\ndim outlookapp as Outlook.Application\nset outlookapp = CreateObject(\"Outlook.Application\")\ndim outMail As Outlook.Mailitem\nSet outMail = outlookApp.CreateItem(olMailItem)\nWith outMail\n.Display\n.CC = \"xyz@abc.com\"\n.Subject = \"Test\"\n.Body = \"Dear\" &amp; \"Macro\" &amp; vbnewline\nend with\noutmail.Display\n'Opening wordeditor\ndim worddoc as Word.Document\nSet worddoc = Outmail.GetInspector.WordEditor\nworddoc.range.PasteandFormat wdChartPicture\n'Adding new line after pasting image\nworddoc.range.Insertafter vbNewline\n' Adding second image\ndim s as range\nset s= Range(P2:Z30)\ns.copy\nworddoc.range.PasteandFormat wdChartPicture\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 3, "creation_date": 1544045272, "post_id": 53640888, "comment_id": 94141560, "body": "<code>ws.Cells(i, Z.Column)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 483, "user_id": 10553841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26a3593367ffd4a0a86def4051490360?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Vote", "link": "https://stackoverflow.com/users/10553841/jon-vote"}, "is_accepted": false, "score": 1, "last_activity_date": 1544047377, "creation_date": 1544047377, "answer_id": 53641442, "question_id": 53640888, "link": "https://stackoverflow.com/questions/53640888/finding-column-based-on-header-then-formatting-rows/53641442#53641442", "title": "Finding column based on header then formatting rows", "body": "<p>It's not exactly clear to me what you want - but from the title it appears you want to get the column number based on the header text? If so, this will do that: </p>\n\n<pre><code> Private Function GetColumn(headerName As String) As Integer\n\n    Dim col As Integer\n    GetColumn = 0\n    For col = 1 To ActiveSheet.UsedRange.Columns.Count\n        If ActiveSheet.Cells(1, col).Value = headerName Then\n            GetColumn = col\n            Exit For\n        End If\n    Next col\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7582160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0535d7a0f4e90b125cf7abfe8ee04a18?s=128&d=identicon&r=PG&f=1", "display_name": "a_powell22", "link": "https://stackoverflow.com/users/7582160/a-powell22"}, "edited": false, "score": 0, "creation_date": 1544130692, "post_id": 53643199, "comment_id": 94177728, "body": "Works Great, THANK YOU!"}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": true, "score": 0, "last_activity_date": 1544058942, "creation_date": 1544058942, "answer_id": 53643199, "question_id": 53640888, "link": "https://stackoverflow.com/questions/53640888/finding-column-based-on-header-then-formatting-rows/53643199#53643199", "title": "Finding column based on header then formatting rows", "body": "<h1>Find Header and Format Cells</h1>\n\n<pre><code>Option Explicit\n\n'*******************************************************************************\n' Purpose:    Finds a column containing a specified header and applies\n'             formatting to its cells that match a criteria.\n'*******************************************************************************\nSub FindHeaderFormatCells()\n\n    Const vntLast As Variant = \"I\"        ' Last Row Column e.g. \"I\" or 9\n    Const strRange As String = \"I1:BM1\"   ' Search Range\n    Const strHeader As String = \"Avg\"     ' Search Column Header Title\n    Const vntMatch As Variant = 8         ' Match Column e.g. 8 or \"H\"\n    Const intColor As Integer = 4         ' ColorIndex for Match (Bright Green)\n\n    Dim rngCell As Range                  ' Range Control Variable\n\n    Dim lastRow As Long                   ' Last Row of Data in column vntLast\n    Dim i As Long                         ' Rows Counter\n    Dim j As Integer                      ' Search Column\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        lastRow = .Cells(Rows.Count, vntLast).End(xlUp).Row\n\n        ' Calculate Search Column (j) by finding the column containing\n        ' Search Column Header Title (strHeader) in Search Range (strRange).\n        For Each rngCell In .Range(strRange).Cells\n            ' vbTextCompare i.e. no matter if \"Avg\" or \"AVG\" or \"avg\" or...\n            If InStr(1, rngCell.Value, strHeader, vbTextCompare) Then\n              j = rngCell.Column\n              Exit For ' When found, no need to search anymore.\n            End If\n        Next\n\n        ' When Search Column Header Title is NOT found.\n        If j = 0 Then GoTo SearchErr\n\n        ' Apply colors to Search Column cells that match criteria.\n        For i = 2 To lastRow\n            If .Cells(i, vntMatch) - .Cells(i, j) &lt; 0 Then\n                .Cells(i, j).Interior.ColorIndex = intColor\n            End If\n        Next\n\n    End With\n\nExit Sub  ' Program ends here if Search Column Header Title was found.\n\nSearchErr:\n    MsgBox \"Could not find the header title (\" &amp; strHeader &amp; \") in the \" _\n      &amp; \"specified range (\" &amp; strRange &amp; \").\"\n\nEnd Sub   ' Program ends here if Search Column Header Title was NOT found.\n'*******************************************************************************\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7582160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0535d7a0f4e90b125cf7abfe8ee04a18?s=128&d=identicon&r=PG&f=1", "display_name": "a_powell22", "link": "https://stackoverflow.com/users/7582160/a-powell22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 53643199, "answer_count": 2, "score": 2, "last_activity_date": 1581745528, "creation_date": 1544044636, "last_edit_date": 1581745528, "question_id": 53640888, "link": "https://stackoverflow.com/questions/53640888/finding-column-based-on-header-then-formatting-rows", "title": "Finding column based on header then formatting rows", "body": "<p>I am attempting to build a loop that searches through headers and finds a contained value, In this case, \"Avg\". If the value is found it will work down the column and apply a format based on a comparison to another column. I am trying to convert my cell variable in the For loop (Z) into a column address so I can use to control my ws.Cells() value in the next loop. </p>\n\n<p>Any help is greatly appreciated, thanks!!!!</p>\n\n<pre><code>Sub foo()\nDim ws As Worksheet: Set ws = Sheets(\"Sheet1\")\nDim Z As Range\nlastRow = ws.Cells(ws.Rows.Count, \"I\").End(xlUp).Row\n\nFor Each Z In Range(\"I1:BM1\").Cells\n    If InStr(1, Z.Value, \"Avg\") Then\n\n        For i = 2 To lastRow 'loop from row 2 to last\n            If ws.Cells(i, 8) - ws.Cells(i, Z) &lt; 0 Then \n                ws.Cells(i, Z).Interior.ColorIndex = 4 \n            End If\n        Next i\n    End If\nNext Z\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "back-button"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10740456, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cvSL1Fhz_iE/AAAAAAAAAAI/AAAAAAAAKoI/VAMRLCGLoFw/photo.jpg?sz=128", "display_name": "rohail nisar", "link": "https://stackoverflow.com/users/10740456/rohail-nisar"}, "edited": false, "score": 0, "creation_date": 1545922882, "post_id": 53690885, "comment_id": 94732329, "body": "thanks brother, that was best explaination, and code works great, can u please also explain what if i want more then one cell, can u help me guide how to do that, while keeping it as fast as it is now, and is there a way we can also display index you explained above to destination sheet"}, {"owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "reply_to_user": {"reputation": 75, "user_id": 10740456, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cvSL1Fhz_iE/AAAAAAAAAAI/AAAAAAAAKoI/VAMRLCGLoFw/photo.jpg?sz=128", "display_name": "rohail nisar", "link": "https://stackoverflow.com/users/10740456/rohail-nisar"}, "edited": false, "score": 0, "creation_date": 1546064970, "post_id": 53690885, "comment_id": 94772193, "body": "@rohailnisar You&#39;re welcome. 1) I&#39;m not sure what you mean by <i>&quot;more then one cell&quot;</i>. Do you mean that you wish to, for example, copy three consecutive source cell values to three consecutive destination sheet cells? 2) Displaying the index in, say <code>F4</code>, can be done very simply with <code>Worksheets(s_DestSheet).Range(&quot;F4&quot;).Value2 = sidxCurrentCell + 1</code>. 3) FYI, now that you&#39;ve earned 15+ reputation, you can also upvote any/all answers (including accepted ones ;-) ) by clicking on the upwards pointing grey triangle at the top-left of the answer. You can also upvote any question you find useful too."}], "tags": [], "owner": {"reputation": 5449, "user_id": 1961728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bqpz6.png?s=128&g=1", "display_name": "robinCTS", "link": "https://stackoverflow.com/users/1961728/robincts"}, "is_accepted": true, "score": 2, "last_activity_date": 1544405142, "last_edit_date": 1544405142, "creation_date": 1544347108, "answer_id": 53690885, "question_id": 53640786, "link": "https://stackoverflow.com/questions/53640786/modifying-the-next-button-code-so-it-works-with-a-previous-button/53690885#53690885", "title": "Modifying the &quot;Next&quot; button code so it works with a &quot;Previous&quot; button", "body": "<p>That code was written (by me) for the specific case where there is only a <kbd>Next</kbd> button.</p>\n\n<p>It would seem that changing the first <code>+ 1</code> to <code>- 1</code> would be the way to modify the code to create a <kbd>Previous</kbd> button. This sort of works, but has a couple of issues which will be explained shortly. Before getting to that, however, note that the second <code>+ 1</code> must remain unchanged. It is there simply to convert the zero-base stored index to a one-base index as required by the <code>Cell</code> property. (And yes, for the <kbd>Next</kbd> button only case, it would have been simpler to store the one-base index instead. Fortuitously, storing the zero-based index turns out to be the simplest method for the case of both <kbd>Next</kbd> and <kbd>Previous</kbd> buttons.)</p>\n\n<p>So, what are the issues with the <code>- 1</code>?</p>\n\n<p>Well firstly, whilst it will correctly update the index to point to the previous row of the source range, it fails to wrap from the first row of the range to the last row. Instead, it results in a <code>1004</code> error (as <code>.Cells(sidxCurrentCell + 1).Copy</code> evaluates to <code>.Cells(0).Copy</code>). This is because the assignment statement containing the <code>Mod</code> operator was written in the simplest way to wrap from the last row to the first row, without allowing for the reverse case.</p>\n\n<p>Secondly, since the current index is stored as a static variable in the subroutine called when a button is pressed, having two such subroutines means that there are two stored indexes operating independently of each other. Thus, assuming the indexes are both set to the second row, the sequence of button presses, <kbd>Next</kbd>+<kbd>Next</kbd>+<kbd>Previous</kbd>, will not result in displaying the third row's value, but will instead show the first row's value.</p>\n\n<p>To solve the first issue, you need to add the number of rows of the source range to the first operand of the <code>Mod</code> operator. (Note that with this modification the <kbd>Next</kbd> subroutine will also continue to work correctly.)</p>\n\n<p>The second issue is solved by using a generalised Previous/Next subroutine which takes a parameter to determine the direction, and assigning two other separate subroutines to each button respectively. These helper subroutines just call the main routine with the appropriate argument value (<code>1</code> for the <kbd>Next</kbd> button and <code>-1</code> for the <kbd>Previous</kbd> button). Thus, there is only one stored index which is used by both buttons.</p>\n\n<p>The following is the full modified code where <code>Button1</code> is the <kbd>Next</kbd> button, and <code>Button2</code> is the <kbd>Previous</kbd> button:</p>\n\n<pre><code>'============================================================================================\n' Module     : &lt;any non-class module&gt;\n' Version    : 0.1.0\n' Part       : 1 of 1\n' References : N/A\n' Source     : https://stackoverflow.com/a/53690885/1961728\n'============================================================================================\nOption Explicit\n\nPrivate Sub Next_or_Previous( _\n                                       ByRef direction As Long _\n                            )\n        Dim plngDirection As Long: plngDirection = direction\n\n  Const s_DestSheet As String = \"MIRCALCULATION\"\n  Const s_DestRange As String = \"F5\"\n  Const s_SrcSheet As String = \"MIRDATA\"\n  Const s_SrcCell As String = \"A1:A100\"\n\n  Static sidxCurrentCell As Variant: If IsEmpty(sidxCurrentCell) Then sidxCurrentCell = -plngDirection\n\n  With Worksheets(s_SrcSheet).Range(s_SrcCell)\n    sidxCurrentCell = (sidxCurrentCell + plngDirection + .Cells.Count) Mod .Cells.Count\n    .Cells(sidxCurrentCell + 1).Copy Destination:=Worksheets(s_DestSheet).Range(s_DestRange)\n  End With\n\nEnd Sub\n\nPublic Sub Button1_Click()\n  Next_or_Previous 1\nEnd Sub\n\nPublic Sub Button2_Click()\n  Next_or_Previous -1\nEnd Sub\n</code></pre>\n\n<p>Note that initialising <code>sidxCurrentCell</code> to <code>-plngDirection</code> results in the destination cell containing the value of the first row of the source range when either <kbd>Next</kbd> or <kbd>Previous</kbd> is first pressed after opening the workbook.</p>\n"}], "owner": {"reputation": 75, "user_id": 10740456, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-cvSL1Fhz_iE/AAAAAAAAAAI/AAAAAAAAKoI/VAMRLCGLoFw/photo.jpg?sz=128", "display_name": "rohail nisar", "link": "https://stackoverflow.com/users/10740456/rohail-nisar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53690885, "answer_count": 1, "score": 0, "last_activity_date": 1544405142, "creation_date": 1544044218, "last_edit_date": 1544405134, "question_id": 53640786, "link": "https://stackoverflow.com/questions/53640786/modifying-the-next-button-code-so-it-works-with-a-previous-button", "title": "Modifying the &quot;Next&quot; button code so it works with a &quot;Previous&quot; button", "body": "<p>I have a \"Next\" button that runs the following code. It copies the contents of the next (below) row of the source range and pastes it to a cell in the destination sheet.</p>\n\n<p>I would also like to have similar code that is run by a \"Previous\" button which copy/pastes the contents of the previous row (above) instead.</p>\n\n<p>I tried <code>- 1</code> instead of <code>+ 1</code>, but that didn't work.</p>\n\n<p>Can someone here help me to modify the code to correctly create a \"Previous\" button?</p>\n\n<pre><code>Option Explicit\n\nSub Button1_Click()\n\n    Const s_DestSheet As String = \"MIRCALCULATION\"\n    Const s_DestRange As String = \"F5\"\n    Const s_SrcSheet As String = \"MIRDATA\"\n    Const s_SrcCell As String = \"A1:A100\"\n\n    Static sidxCurrentCell As Variant: If IsEmpty(sidxCurrentCell) Then sidxCurrentCell = 1\n\n    With Worksheets(s_SrcSheet).Range(s_SrcCell)\n        sidxCurrentCell = (sidxCurrentCell + 1) Mod .Cells.Count\n        .Cells(sidxCurrentCell + 1).Copy Destination:=Worksheets(s_DestSheet).Range(s_DestRange)\n    End With    \n\nEnd sub\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "edited": false, "score": 0, "creation_date": 1544043134, "post_id": 53640539, "comment_id": 94140553, "body": "quick comment, sorry the field i want will be/relate to the Policy Number. First Name &amp; Last Name comes after it. not sure the exact name but it s/b similar."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "edited": false, "score": 0, "creation_date": 1544065838, "post_id": 53641193, "comment_id": 94147095, "body": "Thank you very much for the comments. I&#39;ll run it tomorrow at the office. QuerySelector is not syntax i&#39;m familiar with. I&#39;m assuming I can assign a value to it? Normally I&#39;ve had something like HTMLinput.value = &quot;sometext&quot;   where HTMLinput was an element set in the VBA earlier, maybe looped thru in a collection."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "edited": false, "score": 0, "creation_date": 1544067664, "post_id": 53641193, "comment_id": 94147481, "body": "<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector\" rel=\"nofollow noreferrer\">querySelector</a> returns a single node. The first element that matches the css selector specified inside the (). querySelectorAll returns a nodeList, a collection of all matching elements which you loop the .Length of (you can&#39;t For Each over it - it will crash Excel). And yes, in this instance you can assign a value to it with .value = &quot;&quot;."}, {"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "edited": false, "score": 1, "creation_date": 1544115760, "post_id": 53641193, "comment_id": 94171036, "body": "Outstanding! I ran it and worked like a charm first go! Thank you very much! I would not have looked at querySelector so I think this will be a good new tool for me to learn to use."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "edited": false, "score": 0, "creation_date": 1544115813, "post_id": 53641193, "comment_id": 94171064, "body": "It is a method that gives you access to some powerful and flexible syntax."}, {"owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "edited": false, "score": 0, "creation_date": 1544125349, "post_id": 53641193, "comment_id": 94175332, "body": "Well, i had one more thing to do on that page &amp; I grabbed that item my old way using a little for each loop, confirmed it work, but then applied your way &amp; that one is working too &amp; a touch quicker since I&#39;m not looping through anything, so again thank you very much. I&#39;m feeling pretty good today, making progress on the project!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1544046220, "creation_date": 1544046220, "answer_id": 53641193, "question_id": 53640539, "link": "https://stackoverflow.com/questions/53640539/how-to-get-a-field-on-a-control-group/53641193#53641193", "title": "How to get a field on a control group", "body": "<p>That is the first input box for your shown HTML. I would combine a CSS attribute = value selector with element selector to target</p>\n\n<pre><code>input[ng-model='policySearchRequestView.policyNumber.value']\n</code></pre>\n\n<p>Assuming using IE:</p>\n\n<pre><code>ie.document.querySelector(\"input[ng-model='policySearchRequestView.policyNumber.value']\")\n</code></pre>\n\n<p>You can use same syntax but replacing attribute value with</p>\n\n<pre><code>policySearchRequestView.firstName.value\n</code></pre>\n\n<p>and</p>\n\n<pre><code>policySearchRequestView.lastName.value\n</code></pre>\n\n<p>for the others.</p>\n"}], "owner": {"reputation": 77, "user_id": 10747068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee45f050dc0ba5301c3edab48f051726?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Carney", "link": "https://stackoverflow.com/users/10747068/jim-carney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 53641193, "answer_count": 1, "score": 0, "last_activity_date": 1544046264, "creation_date": 1544043047, "last_edit_date": 1544046264, "question_id": 53640539, "link": "https://stackoverflow.com/questions/53640539/how-to-get-a-field-on-a-control-group", "title": "How to get a field on a control group", "body": "<p>I'm trying to get access to a field on a website &amp; write an answer to it. I cannot for the life of me figure out it's name or how to reference it. I can see it's sitting on a form. There are 3 fields on it, I want the first one. There don't seem to be any id's to work with. I've tried looping through getting it to print tag names and such I;m using VBA to open the webpage, etc.</p>\n\n<p>This is the HTML:</p>\n\n<pre class=\"lang-htm prettyprint-override\"><code>&lt;ng-form class=\"form ng-pristine ng-valid\" name=\"policySearchForm\"&gt;\n   &lt;div class=\"gw-control-group-wrapper\"&gt;\n      &lt;div class=\"form-item select-form-fli form-item-grid-fli ng-isolate-scope\" model=\"policySearchRequestView.policyNumber\" label=\"Policy Number\" gw-pl-ctrl-group=\"\"&gt;\n         &lt;div class=\"gw-control-group\" aria-hidden=\"false\" ng-class=\"{ 'gw-error': showError(), 'gw-inline-control-group': inline, 'gw-control-group': !inline, 'gw-control-group-focused' : focused, 'required-fli': model.aspects.required }\" ng-show=\"isVisible()\"&gt;\n            &lt;!-- ngIf: label --&gt;\n            &lt;label title=\"\" class=\"ng-scope gw-control-label\" ng-class=\"{'gw-control-inline-label': inline, 'gw-control-label': !inline}\" ng-if=\"label\"&gt;\n               &lt;span class=\"ng-binding\"&gt;\n                  Policy Number\n                  &lt;!-- Information icon for Useful Hints --&gt;\n                  &lt;!-- ngIf: usefulHint --&gt;\n               &lt;/span&gt;\n               &lt;span class=\"gw-required-asterisk ng-hide\" aria-hidden=\"true\" ng-show=\"(model.aspects.required &amp;amp;&amp;amp; !readonly) || (showAsterisk &amp;amp;&amp;amp; !readonly &amp;amp;&amp;amp; label === 'Date Of Birth')\"&gt;*&lt;/span&gt;\n            &lt;/label&gt;\n            &lt;!-- end ngIf: label --&gt;\n            &lt;div class=\"gw-controls\" ng-class=\"{'gw-inline-controls': inline, 'gw-controls': !inline}\"&gt;\n               &lt;ng-transclude&gt;\n                  &lt;input tabindex=\"0\" class=\"ng-pristine ng-valid ng-scope ng-touched\" aria-invalid=\"false\" type=\"text\" ng-model=\"policySearchRequestView.policyNumber.value\" ng-keypress=\"($event.which === 13)?searchPolicies():0\"&gt;\n               &lt;/ng-transclude&gt;\n               &lt;div class=\"gw-inline-messages\" aria-hidden=\"false\" ng-show=\"!readonly\"&gt;\n                  &lt;!-- ngRepeat: errorMessage in model.aspects.validationMessages track by $index --&gt;\n               &lt;/div&gt;\n            &lt;/div&gt;\n         &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;!-- ngIf: policySearchRequestView.IsPersonalPolicy === 'true' --&gt;\n      &lt;div class=\"form-item-grid-fli ng-scope ng-isolate-scope\" ng-if=\"policySearchRequestView.IsPersonalPolicy === 'true'\" model=\"policySearchRequestView.firstName\" label=\"First Name\" gw-pl-ctrl-group=\"\"&gt;\n         &lt;div class=\"gw-control-group\" aria-hidden=\"false\" ng-class=\"{ 'gw-error': showError(), 'gw-inline-control-group': inline, 'gw-control-group': !inline, 'gw-control-group-focused' : focused, 'required-fli': model.aspects.required }\" ng-show=\"isVisible()\"&gt;\n            &lt;!-- ngIf: label --&gt;\n            &lt;label title=\"\" class=\"ng-scope gw-control-label\" ng-class=\"{'gw-control-inline-label': inline, 'gw-control-label': !inline}\" ng-if=\"label\"&gt;\n               &lt;span class=\"ng-binding\"&gt;\n                  First Name\n                  &lt;!-- Information icon for Useful Hints --&gt;\n                  &lt;!-- ngIf: usefulHint --&gt;\n               &lt;/span&gt;\n               &lt;span class=\"gw-required-asterisk ng-hide\" aria-hidden=\"true\" ng-show=\"(model.aspects.required &amp;amp;&amp;amp; !readonly) || (showAsterisk &amp;amp;&amp;amp; !readonly &amp;amp;&amp;amp; label === 'Date Of Birth')\"&gt;*&lt;/span&gt;\n            &lt;/label&gt;\n            &lt;!-- end ngIf: label --&gt;\n            &lt;div class=\"gw-controls\" ng-class=\"{'gw-inline-controls': inline, 'gw-controls': !inline}\"&gt;\n               &lt;ng-transclude&gt;\n                  &lt;input tabindex=\"0\" class=\"ng-pristine ng-valid ng-scope ng-touched\" aria-invalid=\"false\" type=\"text\" ng-model=\"policySearchRequestView.firstName.value\" ng-keypress=\"($event.which === 13)?searchPolicies():0\"&gt;\n                  &lt;!--&lt;div class=\"exact-match-fli\"&gt;--&gt;\n                  &lt;!--&lt;div class=\"gw-control-label\"&gt;--&gt;\n                  &lt;!--{{'agent.views.policy-landing.Exact Match' | translate}}--&gt;\n                  &lt;!--&lt;input type=\"checkbox\"--&gt;\n                  &lt;!--ng-model=\"policySearchRequest.isFirstNameExact\"--&gt;\n                  &lt;!--class=\"gw-check\"--&gt;\n                  &lt;!--id=\"firstNamePolicyCheckboxLabel{{$index}}\"&gt;--&gt;\n                  &lt;!--&lt;label class=\"gw-checkbox\" id=\"firstNamePolicyCheckboxLabel\" for=\"firstNamePolicyCheckboxLabel{{$index}}\"&gt;&lt;/label&gt;--&gt;\n                  &lt;!--&lt;/div&gt;--&gt;\n                  &lt;!--&lt;/div&gt;--&gt;\n               &lt;/ng-transclude&gt;\n               &lt;div class=\"gw-inline-messages\" aria-hidden=\"false\" ng-show=\"!readonly\"&gt;\n                  &lt;!-- ngRepeat: errorMessage in model.aspects.validationMessages track by $index --&gt;\n               &lt;/div&gt;\n            &lt;/div&gt;\n         &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;!-- end ngIf: policySearchRequestView.IsPersonalPolicy === 'true' --&gt;\n      &lt;!-- ngIf: policySearchRequestView.IsPersonalPolicy == 'true' --&gt;\n      &lt;div class=\"form-item-grid-fli full-width-input-fli ng-scope ng-isolate-scope\" ng-if=\"policySearchRequestView.IsPersonalPolicy == 'true'\" model=\"policySearchRequestView.lastName\" label=\"Last Name\" gw-pl-ctrl-group=\"\"&gt;\n         &lt;div class=\"gw-control-group\" aria-hidden=\"false\" ng-class=\"{ 'gw-error': showError(), 'gw-inline-control-group': inline, 'gw-control-group': !inline, 'gw-control-group-focused' : focused, 'required-fli': model.aspects.required }\" ng-show=\"isVisible()\"&gt;\n            &lt;!-- ngIf: label --&gt;\n            &lt;label title=\"\" class=\"ng-scope gw-control-label\" ng-class=\"{'gw-control-inline-label': inline, 'gw-control-label': !inline}\" ng-if=\"label\"&gt;\n               &lt;span class=\"ng-binding\"&gt;\n                  Last Name\n                  &lt;!-- Information icon for Useful Hints --&gt;\n                  &lt;!-- ngIf: usefulHint --&gt;\n               &lt;/span&gt;\n               &lt;span class=\"gw-required-asterisk ng-hide\" aria-hidden=\"true\" ng-show=\"(model.aspects.required &amp;amp;&amp;amp; !readonly) || (showAsterisk &amp;amp;&amp;amp; !readonly &amp;amp;&amp;amp; label === 'Date Of Birth')\"&gt;*&lt;/span&gt;\n            &lt;/label&gt;\n            &lt;!-- end ngIf: label --&gt;\n            &lt;div class=\"gw-controls\" ng-class=\"{'gw-inline-controls': inline, 'gw-controls': !inline}\"&gt;\n               &lt;ng-transclude&gt;\n                  &lt;input tabindex=\"0\" class=\"ng-pristine ng-valid ng-scope ng-touched\" aria-invalid=\"false\" type=\"text\" ng-model=\"policySearchRequestView.lastName.value\" ng-keypress=\"($event.which === 13)?searchPolicies():0\"&gt;\n                  &lt;!--&lt;div class=\"exact-match-fli\"&gt;--&gt;\n                  &lt;!--&lt;div class=\"gw-control-label\"&gt;--&gt;\n                  &lt;!--{{'agent.views.policy-landing.Exact Match' | translate}}--&gt;\n                  &lt;!--&lt;input type=\"checkbox\"--&gt;\n                  &lt;!--ng-model=\"policySearchRequest.isLastNameExact\"--&gt;\n                  &lt;!--class=\"gw-check\"--&gt;\n                  &lt;!--id=\"lastNamePolicyCheckboxLabel{{$index}}\"&gt;--&gt;\n                  &lt;!--&lt;label class=\"gw-checkbox\" id=\"lastNamePolicyCheckboxLabel\" for=\"lastNamePolicyCheckboxLabel{{$index}}\"&gt;&lt;/label&gt;--&gt;\n                  &lt;!--&lt;/div&gt;--&gt;\n                  &lt;!--&lt;/div&gt;--&gt;\n               &lt;/ng-transclude&gt;\n               &lt;div class=\"gw-inline-messages\" aria-hidden=\"false\" ng-show=\"!readonly\"&gt;\n                  &lt;!-- ngRepeat: errorMessage in model.aspects.validationMessages track by $index --&gt;\n               &lt;/div&gt;\n            &lt;/div&gt;\n         &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;!-- end ngIf: policySearchRequestView.IsPersonalPolicy == 'true' --&gt;\n      &lt;!-- ngIf: policySearchRequestView.IsPersonalPolicy === 'false' --&gt;\n   &lt;/div&gt;\n&lt;/ng-form&gt;\n</code></pre>\n\n<p>Can anyone point me in the right direction how I can determine how to reference it or the input boxes name?</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping", "google-translate"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544044530, "post_id": 53640420, "comment_id": 94141225, "body": "I will try this but in the past i needed to do my own encoding before sending the url to IE, i still have many subs and functions that can do this. The issue with this is that IE has a 2000 character limit on URLs and Japanese text becomes extremely long when encoded. I thought that using this code: <code>.Document.querySelector(&quot;#source&quot;).Value = trans_text</code> would be a way to bypass that, since google translate website has limit of 5000 (not encoded) characters. If i have a wait command after putting the text into that element will the website make that url instead of my encoding subs?"}, {"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544044967, "post_id": 53640420, "comment_id": 94141402, "body": "Now that I think about it I am positive that when encoded this text block will be over 2000 characters. I&#39;m guessing the error is caused by the website trying to encode the text and it being too long for IE and stopping the website from refreshing/translating the text. What do you think?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544045916, "post_id": 53640420, "comment_id": 94141838, "body": "This particular phrase worked for me with IE (I think). Is selenium basic an option?"}, {"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544104887, "post_id": 53640420, "comment_id": 94164462, "body": "Sadly i can only use IE, Edge or Chrome. I only know how to use IE currently."}, {"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544105026, "post_id": 53640420, "comment_id": 94164562, "body": "That did actually work on IE, although it loses all formatting."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544105082, "post_id": 53640420, "comment_id": 94164593, "body": "Last time I used clipboard which copied formatting across as well."}, {"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544105470, "post_id": 53640420, "comment_id": 94164858, "body": "clipboard to put text into the url or into the input box?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544105638, "post_id": 53640420, "comment_id": 94164960, "body": "To retrieve the translation and paste to Excel. For the current version if using your method I think there is an event that needs to be triggered for the translation to happen properly."}, {"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544108627, "post_id": 53640420, "comment_id": 94166944, "body": "I did some testing and it seems that google translate doesnt format the text back if its over roughly 500 characters. Any reason why that is? or how i can fix it? Regardless i can just give google translate 500 char chunks and it will work just fine."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 0, "creation_date": 1544108846, "post_id": 53640420, "comment_id": 94167074, "body": "I am not aware of that limitation though sounds possible. No idea why. Is the limit exact or approximate?"}, {"owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "edited": false, "score": 1, "creation_date": 1544109457, "post_id": 53640420, "comment_id": 94167435, "body": "Seems like a hard limit, 499 worked, 501 didnt. Maybe the website thinks it will take too long? Not sure Thanks for the help working with the HTML though, really appreciate it."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1544043292, "last_edit_date": 1544043292, "creation_date": 1544042552, "answer_id": 53640420, "question_id": 53640216, "link": "https://stackoverflow.com/questions/53640216/google-translate-not-translating-in-ie-when-website-opened-from-vba/53640420#53640420", "title": "Google translate not translating in IE when website opened from vba", "body": "<p>Alter your URL slightly and let the browser handle the encoding of the URL. Here I am reading your text from a cell. When the site does a translation it generates a new URL which has a query string parameter of <code>text=&lt;your string to translate&gt;</code>; so add the <code>text=</code> onto your start URL and concatenate in your phrase for translation. </p>\n\n<p>Remember you need to close your IE instance at some point. I am not a fan of passing IE as an object in this manner and would probably look to having it held in a class which generates the IE object in class <code>Class_Initialize()</code>. You then instantiate that class with a variable in the sub.</p>\n\n<p>I frequently forget that the appropriate navigate method I believe is now <code>.navigate2</code>.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    Dim ie As InternetExplorer, trans_text As String\n    Const URL As String = \"https://translate.google.com/#view=home&amp;op=translate&amp;sl=ja&amp;tl=en&amp;text=\"\n    Set ie = New InternetExplorer\n    trans_text = [A1].Value\n    Debug.Print OutlookGetTransItem(ie, URL, trans_text)\n    ie.Quit\nEnd Sub\n\nPublic Function OutlookGetTransItem(ByVal ie As Object, ByVal URL As String, ByVal trans_text As String) As String\n    Dim t As Date\n\n    If trans_text = vbNullString Then OutlookGetTransItem = trans_text: Exit Function\n\n    Const MAX_WAIT_SEC As Long = 5\n\n    With ie\n        .Visible = True\n        .navigate2 URL &amp; trans_text\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim translation As Object, translationText As String\n        t = Timer\n        Do\n            On Error Resume Next\n            Set translation = .document.querySelector(\".tlid-translation.translation\")\n            translationText = translation.innerText\n            On Error GoTo 0\n            If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n        Loop While translationText = vbNullString\n        OutlookGetTransItem = translationText\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10741166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/160ab1d044984886443d42a26cee4230?s=128&d=identicon&r=PG&f=1", "display_name": "Zamorak", "link": "https://stackoverflow.com/users/10741166/zamorak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 53640420, "answer_count": 1, "score": 2, "last_activity_date": 1544043292, "creation_date": 1544041627, "last_edit_date": 1544042726, "question_id": 53640216, "link": "https://stackoverflow.com/questions/53640216/google-translate-not-translating-in-ie-when-website-opened-from-vba", "title": "Google translate not translating in IE when website opened from vba", "body": "<p>Google translate is not translating text (Japanese to English). The function always returns \"\" when the website is opened and the text is input using the following code:</p>\n\n<pre><code>Function OutlookGetTransItem(IE As Object, URL As String, trans_text As String) As String\nDim t As Date\n\nIf trans_text = \"\" Then OutlookGetTransItem = trans_text: Exit Function\n\nConst MAX_WAIT_SEC As Long = 5\n\nWith IE\n    .Visible = True\n    .navigate URL\n\n    While .Busy Or .ReadyState &lt; 4: DoEvents: Wend\n\n    .Document.querySelector(\"#source\").Value = trans_text\n\n    Dim translation As Object, translationText As String\n    t = Timer\n    Do\n        On Error Resume Next\n        Set translation = .Document.querySelector(\".tlid-translation.translation\")\n        translationText = translation.innerText\n        On Error GoTo 0\n        If Timer - t &gt; MAX_WAIT_SEC Then Exit Do\n    Loop While translationText = vbNullString\n    OutlookGetTransItem = translationText\nEnd With\nEnd Function\n</code></pre>\n\n<p>IE gives this error when i try to manually click the translate arrow/button on the website:\nSCRIPT5025: The URI to be decoded is not a valid encoding\ntranslate_m.js (207,484)</p>\n\n<p>This is the URL i am navigating to:</p>\n\n<p><a href=\"https://translate.google.com/#view=home&amp;op=translate&amp;sl=ja&amp;tl=en\" rel=\"nofollow noreferrer\">https://translate.google.com/#view=home&amp;op=translate&amp;sl=ja&amp;tl=en</a></p>\n\n<p>Here is the text i am setting as <code>trans_text</code> this text is taken from an outlook email using its <code>.body</code> property:</p>\n\n<p>\u95a2\u4fc2\u5404\u4f4d      </p>\n\n<p>\u3044\u3064\u3082\u304a\u4e16\u8a71\u306b\u306a\u3063\u3066\u304a\u308a\u307e\u3059\u3002\n    \u300c111117_NAM_L42L_TR2k2_3\u60aa_\u7b2c1\u90e8\u7b2c2\u90e8.pdf\uff08\u8b70\u4e8b\u677f\u66f8)\u300d\u3092\u9001\u4ed8\u3044\u305f\u3057\u307e\u3059\u3002\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u81f4\u3057\u307e\u3059\u3002\u3000\u3000\u3000\u3000\u3000\u3000</p>\n\n<p>\u3000\u3000\u7d50\u8ad6\uff1a\u9014\u4e2d\n\u3000\u3000\u4e0b\u8a1813\u4ef6\u306e\u8ab2\u984c\u304c\u3042\u308a\uff8c\uff6b\uff9b\uff70\u3092\u5b9f\u65bd\u3059\u308b</p>\n\n<p>\u3000\u3000 \u3000 \uff74\uff9d\u62c5,\uff8c\uff9f\uff9b\uff7e\uff9d\n\u3000\u3000\u3000\u3000\u3000       \u30fb\u6b8b\u8ab2\u984c\u5bfe\u5fdc\u3092\u5b9f\u65bd\u3059\u308b\u4e8b\uff08D\uff9a\uff9d\uff7c\uff9e\uff71\uff72\uff84\uff9e\uff99\u56de\u8ee2\u691c\u8a0e,\uff71\uff72\uff84\uff9e\uff99\u632f\u52d5\uff83\uff9e\uff70\uff80\u5165\u624b,\u5236\u5fa1\u4e0d\u5177\u5408\u5bfe\u5fdc,\u5168ROM\u5b9a\u6570\uff81\uff6a\uff6f\uff78,\u71c3\u6599PUMP\u4e0d\u5177\u5408\u8abf\u67fb,\u51b7\u623f\u6027\u80fd\u672a\u9054\u5bfe\u5fdc\uff09\n\u3000\u3000\u3000\u3000\u3000\u3000     \u30fbT/M IP\u306eFK\u3068FKk2\u3068\u306e\u6bd4\u8f03\u3092\u63d0\u793a\u3059\u308b\u4e8b\n\u3000\u3000\u3000\u3000\u3000\u3000     \u30fb \uff7b\uff70\uff93\uff7d\uff80\uff6f\uff84\u306e\uff92\uff70\uff76\uff70\u3092\u518d\u78ba\u8a8d\u3059\u308b\u3053\u3068\n\u3000\u3000\u3000\u3000\u3000        \u30fb\u59cb\u52d5\uff74\uff9d\uff7d\uff84\uff81\uff6a\uff6f\uff78\uff98\uff7d\uff84\u306e\u518d\uff81\uff6a\uff6f\uff78\u3092\u5b9f\u65bd\u3059\u308b\u4e8b\uff08\uff74\uff9d\uff7d\uff84\u4f59\u88d5\u7387,\uff8a\uff9f\uff70\uff7c\uff9e\u306e\u5224\u65ad,AF/M\u96fb\u6e90\u6295\u5165\u7279\u6027\uff09\n\u3000\u3000\u3000\u3000\u59cb\u52d5ISC\u3000\u3000<br>\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000  \u30fb\u4e0d\u61f8\u6b8b\u9805\u76ee\u306e\u5bfe\u5fdc\u3092\u5b9f\u65bd\u3059\u308b\u4e8b\uff08\u8eca\u4e21\u632f\u52d5,\u59cb\u52d5\u5373R\uff7e\uff9a\uff78\uff84\uff74\uff9d\uff7d\uff84,A/F\u56de\u8ee2\u7dcf\uff81\uff6a\uff6f\uff78,\u5e38\u6e29\u59cb\u52d5\u8efd\u8cea\u78ba\u8a8d,\u304b\u3076\u308a,\uff7e\uff9a\uff78\uff84\uff71\uff72\uff8c\uff97,PCV\uff8a\uff9d\uff81\uff9d\uff78\uff9e\u78ba\u8a8d,\u5373\u59cb\u52d5\u78ba\u8a8d,\u62bc\u3057\u51fa\u3055\u308c\u78ba\u8a8d\uff09 \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000  \u30fbH1\u3092\u6700\u7d42\u4ed5\u69d8\u3067\u307e\u3068\u3081\u308b\u4e8b\u3000\u3000\u3000\u3000\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000  \u30fb\u5404\u76f8\u5834\uff81\uff6a\uff6f\uff78\uff83\uff9e\uff70\uff80\u306e\u53e4\u3044L42L\u306e\uff97\uff72\uff9d\u3092\u524a\u9664\u3059\u308b\u4e8b\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000  \u30fb\uff8c\uff9e\uff9a\uff70\uff77\uff74\uff9d\uff7d\uff84\u56de\u8ee2\u4f4e\u4e0b\u6642\u306e\u8eca\u4e21\u632f\u52d5\u3078\u306e\u5f71\u97ff\u3092\u78ba\u8a8d\u3059\u308b\u4e8b\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000  \u30fb\u4f4e\u6e29\u59cb\u52d5\u6642\u306eTp\u3092\u78ba\u8a8d\u3059\u308b\u4e8b\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30fb\uff78\uff97\uff9d\uff77\uff9d\uff78\uff9e\u56de\u8ee2\u6570\u306e0\u2103\u306e\u76ee\u6a19\u5024\u306e\u51fa\u6240\u3092\u78ba\u8a8d\u3059\u308b\u4e8b\n\u3000\u3000\u3000\u3000\u53f0\u4e0a\u9069\u5408\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30fbH2\u5168ROM\u5b9a\u6570\uff81\uff6a\uff6f\uff78\u3092\u5b9f\u65bd\u3059\u308b\u4e8b\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u30fb\u4e0d\u61f8\u6b8b\u9805\u76ee\u306e\u5bfe\u5fdc\u3092\u5b9f\u65bd\u3059\u308b\u4e8b\uff08R/L\uff7b\uff70\uff7c\uff9e,\u6696\u6a5f\u4e2d\uff97\uff8c\uff71\uff72\uff84\uff9e\uff99,\uff9b\uff7c\uff9e\uff6f\uff78\uff8a\uff9e\uff78\uff9e\u4fee\u6b63\u5f8c\u306e\u78ba\u8a8d,\uff8c\uff9e\uff9b\uff6f\uff78_\uff8d\uff6f\uff84\u5909\u66f4\u5f8c\u306e\uff89\uff6f\uff78\u78ba\u8a8d\uff09\n                    \u30fbBCV\u78ba\u8a8d\u306eTH/C\u3064\u307e\u308a\uff83\uff9e\uff70\uff80\u306e\u518d\u78ba\u8a8d\u3092\u5b9f\u65bd\u3059\u308b\u4e8b\uff08\uff71\uff99\uff90\uff8e\uff9e\uff71\u5316\uff09</p>\n\n<p>&lt;\\Jp-nml-fs-a01\\U00\\PT\u5171\u901a\uff08\u30a4\u30f3\u30d5\u30e9\uff09\\A01_\u96c6\u7d04(\u30d5\u30ea\u30fc)\\3\u60aa\u683c\u7d0d\uff8c\uff6b\uff99\uff80\uff9e2\\111117_NAM_L42L_TR2k2_3\u60aa></p>\n"}, {"tags": ["excel", "vba", "pivot"], "owner": {"reputation": 69, "user_id": 3915771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0da0660e3b462c541661f6082c5a18?s=128&d=identicon&r=PG&f=1", "display_name": "Jack89515", "link": "https://stackoverflow.com/users/3915771/jack89515"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544048662, "creation_date": 1544041022, "last_edit_date": 1544048662, "question_id": 53640076, "link": "https://stackoverflow.com/questions/53640076/vba-how-do-i-group-columns-in-a-pivot-table-collapse-the-group-and-rename-th", "title": "VBA - How do I group columns in a pivot table, collapse the group, and rename the label?", "body": "<p>How would I group columns in a pivot table, collapse the group, and rename the label given my pivot table \"PivotTable1\" look like the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DW42O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DW42O.png\" alt=\"Pivot Table\"></a></p>\n\n<p>As you can my column labels are dates. Normally I would have to manually shift+click dates together and right click to group them into \"Group#\" Then rename the label into something more meaningful such as \"Q1 2019\" etc.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ah3lZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ah3lZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see the 2 things I did above are grouping months Jan, Feb, Mar of 2018 together into one group, and renamed the label \"Q1 2019\".</p>\n\n<p>Now this process becomes very time consuming and repetitive when the file goes off to 2030+ so I was wondering if there's any way to achieve this via VBA?</p>\n\n<p>Again the goals of the macro would be:</p>\n\n<ol>\n<li>Group column labels using some criteria - in my case grouping dates\ntogether into quarters.</li>\n<li>Renaming the newly grouped column labels</li>\n<li>Collapsing the newly created groups.</li>\n</ol>\n\n<p>I can rename with something like the following.\n<code>Sheets(\"Sheet1\").PivotTables(1).PivotFields(\"date\").PivotItems(\"rdates\").Caption = \"Q1 2019\"</code></p>\n\n<p>Also I can manipulate pivotfields' attributes\n    <code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"date\").Orientation = \n    xlHidden\n        With ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"date\")\n            .Orientation = xlRowField\n            .Position = 2\n        End With</code></p>\n\n<p>but not sure how you would be able to group by criteria? I.E all jan-mar = Q1 + year</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1544040783, "post_id": 53639978, "comment_id": 94139483, "body": "<i>ALERT, ALERT!</i> - There is a  <i>way</i> easier way to convert Excel to XML - I&#39;d recommend taking a look <a href=\"http://www.meadinkent.co.uk/xl_xml1.htm\" rel=\"nofollow noreferrer\">here</a> and adapting your code to the boilerplate code written there."}, {"owner": {"reputation": 1, "user_id": 10751465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cv8BNJKMJP4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKEm-_mXzMBiC0mLsePZ_5bjFBjg/mo/photo.jpg?sz=128", "display_name": "simrita", "link": "https://stackoverflow.com/users/10751465/simrita"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544040996, "post_id": 53639978, "comment_id": 94139573, "body": "@dwirony hey thanks for responding :) would this apply if i want to convert rows of data to separate xml files?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544041084, "post_id": 53639978, "comment_id": 94139611, "body": "Yes. The idea is that instead of using elements/childs/nodes, just print your XML files line by line."}, {"owner": {"reputation": 1, "user_id": 10751465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cv8BNJKMJP4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKEm-_mXzMBiC0mLsePZ_5bjFBjg/mo/photo.jpg?sz=128", "display_name": "simrita", "link": "https://stackoverflow.com/users/10751465/simrita"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544042730, "post_id": 53639978, "comment_id": 94140382, "body": "@dwirony hi sorry im very new to this would i run that marco on that site on the data i already have entered in excel (emails) and run the macro? sorry super new still trying to learn :)!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1544042738, "post_id": 53639978, "comment_id": 94140384, "body": "Your doc is missing an opening <code>&lt;EmailValues&gt;</code>"}, {"owner": {"reputation": 1, "user_id": 10751465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cv8BNJKMJP4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKEm-_mXzMBiC0mLsePZ_5bjFBjg/mo/photo.jpg?sz=128", "display_name": "simrita", "link": "https://stackoverflow.com/users/10751465/simrita"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544043041, "post_id": 53639978, "comment_id": 94140512, "body": "@TimWilliams hi tim wow so silly! thank you so much!!! :)"}, {"owner": {"reputation": 1, "user_id": 10751465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cv8BNJKMJP4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKEm-_mXzMBiC0mLsePZ_5bjFBjg/mo/photo.jpg?sz=128", "display_name": "simrita", "link": "https://stackoverflow.com/users/10751465/simrita"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544045325, "post_id": 53639978, "comment_id": 94141589, "body": "@TimWilliams hey tim thank you for the code below!! i tried running it with my macro however i get the &#39;run time error - 2147024773 (8007007b)&#39;: the filename, directory name, or volume label syntax is incorrect.&#39;    and     doc.Save rw.Cells(13).Value is highlighted any ideas?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544045429, "post_id": 53639978, "comment_id": 94141628, "body": "Most likely whatever is in column 13 of that row is not a valid file name/path"}, {"owner": {"reputation": 1, "user_id": 10751465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cv8BNJKMJP4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKEm-_mXzMBiC0mLsePZ_5bjFBjg/mo/photo.jpg?sz=128", "display_name": "simrita", "link": "https://stackoverflow.com/users/10751465/simrita"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544045662, "post_id": 53639978, "comment_id": 94141729, "body": "@TimWilliams hi tim so i have the following entered in one of the lines &quot;c:\\temp\\xmls\\emailtest.xml&quot;  in the xmls folder in my directory i do not have anything saved at the moment it is an empty folder should i only not have the file name that i want it to save as in that column either?"}, {"owner": {"reputation": 1, "user_id": 10751465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cv8BNJKMJP4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKEm-_mXzMBiC0mLsePZ_5bjFBjg/mo/photo.jpg?sz=128", "display_name": "simrita", "link": "https://stackoverflow.com/users/10751465/simrita"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544045849, "post_id": 53639978, "comment_id": 94141809, "body": "also here is a line from my original code that gave me the same error:  sFile = &quot;C:\\Temp\\XMLs\\&quot; &amp; ActiveWorkbook.ActiveSheet.Cells(lrow, 1).Value &amp; &quot;\\&quot; &amp; ActiveWorkbook.ActiveSheet.Cells(lrow, 10).Value         and in column 10 all it was was data like &#39;testemail.xml&#39; @TimWilliams"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544048647, "post_id": 53639978, "comment_id": 94142783, "body": "I can&#39;t really tell what the problem is - as long as the filename is valid and the destination folder exists (and you have permission to write to it) then you should be OK"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1544044632, "creation_date": 1544044632, "answer_id": 53640886, "question_id": 53639978, "link": "https://stackoverflow.com/questions/53639978/run-time-error-error-when-trying-to-export-data-from-xls-to-a-named-xml-file/53640886#53640886", "title": "Run time error error when trying to export data from XLS to a named XML file", "body": "<p>Could be much tidier with a little refactoring:</p>\n\n<pre><code>Sub SaveRowsToXml()\n    Dim lLastRow As Long, lrow As Long\n    With ActiveWorkbook.ActiveSheet\n        lLastRow = .UsedRange.Rows.Count\n        For lrow = 2 To lLastRow\n            SaveToXml .Rows(lrow)\n        Next lrow\n    End With\nEnd Sub\n\n'save a single row of data as XML\nSub SaveToXml(rw As Range)\n    Dim doc As Object, r\n    Set doc = CreateObject(\"MSXML2.DOMDocument\")\n    doc.appendChild doc.createProcessingInstruction(\"xml\", \"version='1.0'\")\n    Set r = doc.createElement(\"EmailValues\") '&lt;&lt; create the root element\n    doc.appendChild r\n    'append child nodes\n    r.appendChild NodeWithContent(doc, \"FromEmail\", rw.Cells(3).Value)\n    r.appendChild NodeWithContent(doc, \"FromName\", rw.Cells(2).Value)\n    r.appendChild NodeWithContent(doc, \"ToEmail\", rw.Cells(5).Value)\n    r.appendChild NodeWithContent(doc, \"CCAddresses\", rw.Cells(7).Value)\n    'etc\n    'etc\n    'Debug.Print doc.XML\n    doc.Save rw.Cells(13).Value\n    Set doc = Nothing\nEnd Sub\n\n'return a named element with content\nFunction NodeWithContent(doc, nodename, content)\n    Dim el\n    Set el = doc.createElement(nodename)\n    el.appendChild doc.createTextNode(content)\n    Set NodeWithContent = el\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10751465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Cv8BNJKMJP4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iKEm-_mXzMBiC0mLsePZ_5bjFBjg/mo/photo.jpg?sz=128", "display_name": "simrita", "link": "https://stackoverflow.com/users/10751465/simrita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 53640886, "answer_count": 1, "score": -1, "last_activity_date": 1544044632, "creation_date": 1544040530, "last_edit_date": 1544041034, "question_id": 53639978, "link": "https://stackoverflow.com/questions/53639978/run-time-error-error-when-trying-to-export-data-from-xls-to-a-named-xml-file", "title": "Run time error error when trying to export data from XLS to a named XML file", "body": "<p>I've written my first VBA macro to export rows of data from XLS to separate named XML files in a specific location. My initial, simplified tests went fine but the full version errors with the message:</p>\n\n<p>Run-time error 91: object variable or with block variable not set </p>\n\n<p>macro:</p>\n\n<pre><code>  Sub XML()\n sTemplateXML = _\n\"&lt;?xml version='1.0'?&gt;\" + vbNewLine + _\n \"&lt;FromEmail&gt;\" + \"&lt;/FromEmail&gt;\" + vbNewLine + _\n \"&lt;FromName&gt;\" + \"&lt;/FromName&gt;\" + vbNewLine + _\n \"&lt;ToEmail&gt;\" + \"&lt;/ToEmail&gt;\" + vbNewLine + _\n \"&lt;CCAddresses&gt;\" + \"&lt;/CCAddresses&gt;\" + vbNewLine + _\n \"&lt;BCCAddresses&gt;\" + \"&lt;/BCCAddresses&gt;\" + vbNewLine + _\n \"&lt;ReplyTo&gt;\" + \"&lt;/ReplyTo&gt;\" + vbNewLine + _\n \"&lt;Subject&gt;\" + \"&lt;/Subject&gt;\" + vbNewLine + _\n \"&lt;Body&gt;\" + \"&lt;/Body&gt;\" + vbNewLine + _\n \"&lt;/EmailValues&gt;\" + vbNewLine\n\n Set doc = CreateObject(\"MSXML2.DOMDocument\")\n doc.async = False\n doc.validateOnParse = False\n doc.resolveExternals = False\n\nWith ActiveWorkbook.ActiveSheet\nlLastRow = ActiveWorkbook.ActiveSheet.UsedRange.Rows.Count\n\nFor lRow = 2 To lLastRow\nsFile = ActiveWorkbook.ActiveSheet.Cells(lRow, 13).Value\nsfromemail = ActiveWorkbook.ActiveSheet.Cells(lRow, 3).Value\nsFromname = ActiveWorkbook.ActiveSheet.Cells(lRow, 2).Value\nsToEmail = ActiveWorkbook.ActiveSheet.Cells(lRow, 5).Value\nsCCAddresses = ActiveWorkbook.ActiveSheet.Cells(lRow, 7).Value\nsBCCAddresses = ActiveWorkbook.ActiveSheet.Cells(lRow, 8).Value\nsReplyTo = ActiveWorkbook.ActiveSheet.Cells(lRow, 4).Value\nsSubject = ActiveWorkbook.ActiveSheet.Cells(lRow, 11).Value\nsBody = ActiveWorkbook.ActiveSheet.Cells(lRow, 12).Value\n\n\ndoc.LoadXML sTemplateXML\ndoc.getElementsbyTagName(\"FromEmail\")(0).appendChild \ndoc.createTextNode(sfromemail) (ERROR POPS UP HERE)\ndoc.getElementsbyTagName(\"FromName\")(0).appendChild \ndoc.createTextNode(sFromname)\ndoc.getElementsbyTagName(\"ToEmail\")(0).appendChild \ndoc.createTextNode(sToEmail)\ndoc.getElementsbyTagName(\"CCAddresses\")(0).appendChild \ndoc.createTextNode(sCCAddresses)\ndoc.getElementsbyTagName(\"BCCAddresses\")(0).appendChild \ndoc.createTextNode(sBCCAddresses)\ndoc.getElementsbyTagName(\"ReplyTo\")(0).appendChild \ndoc.createTextNode(sReplyTo)\ndoc.getElementsbyTagName(\"Subject\")(0).appendChild \ndoc.createTextNode(sSubject)\ndoc.getElementsbyTagName(\"Body\")(0).appendChild doc.createTextNode(sBody)\n\ndoc.Save sFile\nNext\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 11, "user_id": 10751346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o0ZsRS5Y7Jc/AAAAAAAAAAI/AAAAAAAAAOQ/lNZO_JtkPTA/photo.jpg?sz=128", "display_name": "Austin Olson", "link": "https://stackoverflow.com/users/10751346/austin-olson"}, "edited": false, "score": 0, "creation_date": 1544046563, "post_id": 53640342, "comment_id": 94142089, "body": "What&#39;s the value of wcount in the MsgBox?"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1544042217, "creation_date": 1544042217, "answer_id": 53640342, "question_id": 53639562, "link": "https://stackoverflow.com/questions/53639562/vba-font-and-bolding-text/53640342#53640342", "title": "VBA font and bolding text?", "body": "<p>Working with Word <code>Range</code> objects will help with this. Think of a <code>Range</code> like an invisible selection, except that code can work with multiple <code>Range</code> objects, while there can be only one <code>Selection</code>. </p>\n\n<p>Assign the document's content to a <code>Range</code>, then perform the <code>Find</code> and extension on that. Then the formatting can also be applied to the <code>Range</code>. I've altered (but not tested) the code in the question to demonstrate.</p>\n\n<p>In the last part, where text is written at the end of the document, the <code>Range</code> object is set to the entire document, then collapsed (think of it like pressing the right-arrow key with a selection). Then the new text is assigned to the range and formatting applied. Because the range will contain only the new text, the formatting is applied to that, only.</p>\n\n<p>(Additional notes: I've changed the <code>Word</code> variable name to <code>sWord</code> because \"Word\" could be misunderstood to mean the Word application. I've also changed the comparison to check whether <code>sWord</code> contains something to <code>Len(sWord) &gt; 0</code> because the \"greater than \"\"\" comparison is not guaranteed.)</p>\n\n<pre><code>Sub a3()\n\nDim sWord As String\nDim wcount As Integer\nDim rng as Word.Range\n\nSet rng = ActiveDocument.Content\nsWord = InputBox(\"Search for a word\")\nIf (sWord &lt;= \"\") Then\n    MsgBox (\"Did not enter word\")\nEnd If\n\nIf (Len(sWord) &gt; 0) Then\n    wcount = 0\n    With Selection\n            .HomeKey Unit:=wdStory\n            With rng.Find\n                .Text = sWord\n                Do While .Execute\n                    wcount = wcount + 1\n                    rng.Collapse wdCollapseEnd\n                Loop\n            End With\n            MsgBox (\"The word: '\" &amp; sWord &amp; \"' shows up \" &amp; wcount &amp; \" times in the document\")\n        End With\n    End If\n\nSet rng = ActiveDocument.Content\nrng.Collapse wdCollapseEnd\nIf (wcount &lt;= 2) Then\n  rng.Text = (vbCrLf &amp; \"Number occurrences: \" &amp; wcount)\n  rng.Font.ColorIndex = wdRed\n\nElseIf (wcount &lt;= 3) Then\n    rng.Text = (vbCrLf &amp; \"Number occurrences: \" &amp; wcount)\n    rng.Font.ColorIndex = wdRed\n    rng.Font.Bold = True\nElse\n    rng.Text = (vbCrLf &amp; \"Number occurrences: \" &amp; wcount)\n    rng.Font.ColorIndex = wdBlack\n    rng.Font.Bold = False\nEnd If\n\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1540, "user_id": 4705583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iBboA.jpg?s=128&g=1", "display_name": "Rich Michaels", "link": "https://stackoverflow.com/users/4705583/rich-michaels"}, "is_accepted": false, "score": 0, "last_activity_date": 1544044438, "creation_date": 1544044438, "answer_id": 53640833, "question_id": 53639562, "link": "https://stackoverflow.com/questions/53639562/vba-font-and-bolding-text/53640833#53640833", "title": "VBA font and bolding text?", "body": "<p>There are many ways to do this, some of them are based on a preference for ranges or selections and also the structure of the Find statement. Here is my preference.</p>\n\n<pre><code>Sub a3()\n    Dim wrd As String\n    Dim wcount As Integer\n    Dim rng As Word.Range\n    wrd = InputBox(\"Search for a word\")\n    If wrd = vbNullString Then\n        MsgBox (\"Did not enter word\")\n        Exit Sub\n    End If\n    Set rng = ActiveDocument.Content\n    wcount = 0\n    With rng.Find\n        .ClearFormatting\n        .Format = False\n        .Forward = True\n        .MatchWholeWord = True\n        .Text = wrd\n        .Wrap = wdFindStop\n        .Execute\n        Do While .found\n            wcount = wcount + 1\n            rng.Collapse Word.WdCollapseDirection.wdCollapseEnd\n            .Execute\n        Loop\n    End With\n    MsgBox (\"The word: \" &amp; \"\" &amp; wrd &amp; \"\" &amp; \" shows up \" &amp; wcount &amp; \" times in the document\")\n\n    ActiveDocument.Content.InsertParagraphAfter\n    Set rng = ActiveDocument.Content\n    rng.Collapse Word.WdCollapseDirection.wdCollapseEnd\n    rng.Text = \"Number occurrences: \" &amp; wcount\n    If wcount &lt; 3 Then\n        rng.Font.ColorIndex = wdRed\n    ElseIf wcount &lt; 4 Then\n        rng.Font.ColorIndex = wdRed\n        rng.Font.Bold = True\n    Else\n        rng.Font.ColorIndex = wdAuto\n        rng.Font.Bold = False\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10751346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-o0ZsRS5Y7Jc/AAAAAAAAAAI/AAAAAAAAAOQ/lNZO_JtkPTA/photo.jpg?sz=128", "display_name": "Austin Olson", "link": "https://stackoverflow.com/users/10751346/austin-olson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1544046958, "creation_date": 1544038749, "last_edit_date": 1544041359, "question_id": 53639562, "link": "https://stackoverflow.com/questions/53639562/vba-font-and-bolding-text", "title": "VBA font and bolding text?", "body": "<p>I'm trying to make the \"number of occurrences\" either be written in red or in bolded red. Can someone please point me in the right direction. I'm new to coding. This is a word-counter, and when 2+ words are found...it displays the number of words found at the bottom of the word document.</p>\n\n<pre><code>Sub a3()\n\nDim Word As String\nDim wcount As Integer\n\nWord = InputBox(\"Search for a word\")\nIf (Word &lt;= \"\") Then\n    MsgBox (\"Did not enter word\")\nEnd If\n\nIf (Word &gt; \"\") Then\n    wcount = 0\n    With Selection\n            .HomeKey Unit:=wdStory\n            With ActiveDocument.Content.Find\n                .Text = Word\n                Do While .Execute\n                    wcount = wcount + 1\n                    Selection.MoveRight\n                Loop\n            End With\n            MsgBox (\"The word: '\" &amp; Word &amp; \"' shows up \" &amp; wcount &amp; \" times in the document\")\n        End With\n    End If\n\nIf (wcount &lt;= 2) Then\n  ActiveDocument.Content.InsertAfter Text:=(vbCrLf &amp; \"Number occurrences: \" &amp; wcount)\n  Selection.Font.ColorIndex = wdRed\n\nElseIf (wcount &lt;= 3) Then\n    ActiveDocument.Content.InsertAfter Text:=(vbCrLf &amp; \"Number occurrences: \" &amp; wcount)\n    Selection.Font.ColorIndex = wdRed\n    Selection.Font.Bold = True\n\nElse\n    ActiveDocument.Content.InsertAfter Text:=(vbCrLf &amp; \"Number occurrences: \" &amp; wcount)\n    Selection.Font.ColorIndex = wdBlack\n    Selection.Font.Bold = False\n\nEnd If\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1544037301, "post_id": 53639237, "comment_id": 94138041, "body": "What is <code>MyObject</code>?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1544039324, "post_id": 53639237, "comment_id": 94138873, "body": "<code>MyObject</code> should be a FileSystemObject.  <code>Name</code> is a property of <code>file</code> but <code>msg</code> is not a property of <code>file.Name</code>.  Did you mean <code>file.Name &amp; &quot;.msg&quot;</code>?  If so, property <code>Name</code> already includes the extension.  However, <code>file.Name</code> does not include the path so you would need to add that.  <code>MyItem</code> is of type <code>MailItem</code>.  <code>file.Name</code> is of type <code>String</code>.  You cannot set a <code>MailItem</code> to a <code>String</code>. Have a look at this answer, <a href=\"https://stackoverflow.com/a/19426859/973283\">stackoverflow.com/a/19426859/973283</a>, for instructions on converting a filename to a mail item."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10751189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4mMyqe38Oac/AAAAAAAAAAI/AAAAAAAAB5g/WIvo4HulDVs/photo.jpg?sz=128", "display_name": "CodeHunter", "link": "https://stackoverflow.com/users/10751189/codehunter"}, "edited": false, "score": 0, "creation_date": 1544045548, "post_id": 53640399, "comment_id": 94141679, "body": "I tried this code, but it is generating this error: User-Defined Object not defined on &quot;Dim FileCrnt....&quot; line."}, {"owner": {"reputation": 1, "user_id": 10751189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4mMyqe38Oac/AAAAAAAAAAI/AAAAAAAAB5g/WIvo4HulDVs/photo.jpg?sz=128", "display_name": "CodeHunter", "link": "https://stackoverflow.com/users/10751189/codehunter"}, "edited": false, "score": 0, "creation_date": 1544046071, "post_id": 53640399, "comment_id": 94141915, "body": "Sorry error is : &quot;user-defined type not defined.&quot; Just so you know that I already have &quot;Microsoft Outlook 16.0 Object Library&quot; checked in the reference."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 10751189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4mMyqe38Oac/AAAAAAAAAAI/AAAAAAAAB5g/WIvo4HulDVs/photo.jpg?sz=128", "display_name": "CodeHunter", "link": "https://stackoverflow.com/users/10751189/codehunter"}, "edited": false, "score": 0, "creation_date": 1544053015, "post_id": 53640399, "comment_id": 94144189, "body": "As I said at the top of the code, this code needs  &quot;Microsoft Scripting Runtime&quot;.  Within the Editor, click Tools then References.  Scroll down the list (which is in alphabetic sequence) until you reach &quot;Microsoft Scripting Runtime&quot;.  Click the box on the left to tick it then click OK.  If you click Tools then References again, &quot;Microsoft Scripting Runtime&quot; will be near the top and ticked.  &quot;Microsoft Outlook 16.0 Object Library&quot; gives you access to objects such as <code>MailItem</code> it does not give you access to objects such as <code>FileSystemObject</code> which you need to use <code>GetFolder</code>."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 10751189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4mMyqe38Oac/AAAAAAAAAAI/AAAAAAAAB5g/WIvo4HulDVs/photo.jpg?sz=128", "display_name": "CodeHunter", "link": "https://stackoverflow.com/users/10751189/codehunter"}, "edited": false, "score": 0, "creation_date": 1544053429, "post_id": 53640399, "comment_id": 94144284, "body": "Without its libraries, VBA is a very limited language.  Some libraries are automatically ticked such as &quot;Microsoft Outlook 16.0 Object Library&quot; for Outlook and &quot;Microsoft Excel 16.0 Object Library&quot; for Excel.  Anything that is not standard for a particular Office product will have to be explicitly referenced.  If you go hunting for code, check what references it needs.  A few authors forget to mention required libraries.  If you get a message saying &quot;xxxxxx&quot; is an undefined user type, look up &quot;xxxxxx&quot; and you should be able to find a website which tells you which library defines it."}, {"owner": {"reputation": 1, "user_id": 10751189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4mMyqe38Oac/AAAAAAAAAAI/AAAAAAAAB5g/WIvo4HulDVs/photo.jpg?sz=128", "display_name": "CodeHunter", "link": "https://stackoverflow.com/users/10751189/codehunter"}, "edited": false, "score": 0, "creation_date": 1544053728, "post_id": 53640399, "comment_id": 94144366, "body": "I checked &quot;Microsoft Scripting Runtime&quot; in the reference and now I am getting &quot;Run time error 13: Type mismatch&quot; on &quot;Set FldrCrnt....&quot; line. Any suggestions?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 1, "user_id": 10751189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4mMyqe38Oac/AAAAAAAAAAI/AAAAAAAAB5g/WIvo4HulDVs/photo.jpg?sz=128", "display_name": "CodeHunter", "link": "https://stackoverflow.com/users/10751189/codehunter"}, "edited": false, "score": 0, "creation_date": 1544055047, "post_id": 53640399, "comment_id": 94144721, "body": "That bit of code was copied almost unchanged from one of my Excel macros so I could not see the cause of the problem.  After some thought I realised the problem is that a Windows <code>Folder</code> as returned by <code>GetFolder</code> is not an Outlook <code>Folder</code>,  Try <code>FldrCrnt As Scripting.Folder</code>.  It is gone midnight here so I will not reply again until the morning.  If you have anymore problems, I will create some msg files so I can test my code."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1544082050, "post_id": 53640399, "comment_id": 94151637, "body": "Change <b><code>Dim FldrCrnt As Folder</code></b> To <b><code>Dim FldrCrnt As Object</code></b>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1544102602, "post_id": 53640399, "comment_id": 94162956, "body": "@0m3r  I agree that <code>Dim FldrCrnt As Object</code> would have avoided this problem.  However, in general, properly typing variables reduces the incidence of obscure errors.  One case where not typing an object is helpful does not make this good advice."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1544042465, "creation_date": 1544042465, "answer_id": 53640399, "question_id": 53639237, "link": "https://stackoverflow.com/questions/53639237/how-to-send-all-outlook-mail-items-stored-as-msg-in-folder/53640399#53640399", "title": "How to send all Outlook mail items stored as *.msg in folder", "body": "<p>I have not tested this code or even attempted to compile it.  It fixes the most obvious errors in your code so at least you will get a better class of error.</p>\n\n<p>Technique for converting filename to mail item from: <a href=\"https://stackoverflow.com/a/19426859/973283\">https://stackoverflow.com/a/19426859/973283</a>.</p>\n\n<p>This code needs a reference to \"Microsoft Scripting Runtime\".  Without this, <code>File</code>, <code>Folder</code> and <code>FileSystemObject</code> with be unknown types.</p>\n\n<pre><code>Sub SendMSGs()\n\n  Dim FileCrnt As File\n  dim FldrCrnt As Folder\n  Dim Fso As FileSystemObject\n  Dim ItemCrnt As MailItem\n  Dim Path As String\n\n  Path = \"Y:\\UI_messages\\\"\n\n  Set Fso = CreateObject(\"Scripting.FileSystemObject\")\n  Set FldrCrnt = Fso.GetFolder(Path)\n\n  For Each FileCrnt In FldrCrnt.Files\n    If LCase(Right$(FileCrnt.Name, 4)) = \".msg\" Then \n      Set ItemCrnt = Application.CreateItemFromTemplate(Path &amp; FileCrnt.Name)\n      ItemCrnt.Send\n    End If\n  Next FileCrnt\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1544081736, "creation_date": 1544081736, "answer_id": 53646579, "question_id": 53639237, "link": "https://stackoverflow.com/questions/53639237/how-to-send-all-outlook-mail-items-stored-as-msg-in-folder/53646579#53646579", "title": "How to send all Outlook mail items stored as *.msg in folder", "body": "<p><em>Should be - Example</em></p>\n\n<pre><code>Option Explicit\nSub SendMSGs()\n    Dim MyItem As Outlook.MailItem\n\n    Dim MyObject As Object\n    Set MyObject = CreateObject(\"Scripting.FileSystemObject\")\n\n    Dim MySource As Object\n    Set MySource = MyObject.GetFolder(\"C:\\Temp\\\")\n\n    Dim oFile As Object\n    For Each oFile In MySource.Files\n        If LCase(Right$(oFile.Name, 4)) = \".msg\" Then\n            Set MyItem = Application.CreateItemFromTemplate(\"C:\\Temp\\\" &amp; oFile.Name)\n            MyItem.Display\n        End If\n    Next oFile\n\nEnd Sub\n</code></pre>\n\n<p><em>Try using <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">Option Explicit</a></em></p>\n\n<p><em><a href=\"https://stackoverflow.com/a/53640399/4539709\">@Tony Dallimore Answer</a> Should work if you change <strong><code>Dim FldrCrnt As Folder</code></strong> To <strong><code>Dim FldrCrnt As Object</code></em></strong></p>\n"}], "owner": {"reputation": 1, "user_id": 10751189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4mMyqe38Oac/AAAAAAAAAAI/AAAAAAAAB5g/WIvo4HulDVs/photo.jpg?sz=128", "display_name": "CodeHunter", "link": "https://stackoverflow.com/users/10751189/codehunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592723527, "creation_date": 1544037235, "last_edit_date": 1592723527, "question_id": 53639237, "link": "https://stackoverflow.com/questions/53639237/how-to-send-all-outlook-mail-items-stored-as-msg-in-folder", "title": "How to send all Outlook mail items stored as *.msg in folder", "body": "<p>I have a program that creates multiple email messages and save them in a folder on a shared drive mapped as \"Y:\" as .msg files. Each message has a different recipient, subject and message body. </p>\n\n<p>In order to send these messages using my outlook I wrote this code, but it is generating an error \"Object Required 424\" and debugger highlights line \"Set MySource = . . . .\". Any advise please</p>\n\n<pre><code>Sub SendMSGs()\n\n    Dim MyItem As Outlook.MailItem, MySource As Object, file As Variant\n    Set MySource = MyObject.GetFolder(\"Y:\\UI_messages\\\")\n    For Each file In MySource.Files\n        Set MyItem = file.Name.msg\n        MyItem.Send\n    Next file\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1544037217, "post_id": 53639206, "comment_id": 94137996, "body": "YOu may want to take a look at [this](L:\\Delivery (A-L)\\FRR\\FRR_PLIAQX_002\\144\\01_SRC\\Orig)"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 3, "creation_date": 1544037258, "post_id": 53639206, "comment_id": 94138016, "body": "Right away, I can tell you that you that having <code>Select</code>/<code>Selection</code>/ in your code will slow you down. You should read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. Additionally, inserting/deleting rows is very taxing on Excel."}, {"owner": {"reputation": 129, "user_id": 4564486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d37788de40c90bb90b57c09055b355e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sooji", "link": "https://stackoverflow.com/users/4564486/sooji"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544037656, "post_id": 53639206, "comment_id": 94138164, "body": "Thanks @dwirony. This looks like an example where I can easily avoid doing selection. I will make sure to update the code to reflect that. Adding and removing rows starts only taking ~0.5 seconds but if i do it a few times it takes upwards of 3 seconds. It makes me wonder if it&#39;s a memory issue I havent considered or if there&#39;s something that&#39;s painfully unoptimized in the code. Thanks for the feedback!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1544038100, "post_id": 53639206, "comment_id": 94138332, "body": "@Sooji I believe you&#39;re overthinking it a bit - It looks like all you&#39;re doing is format painting a couple rows, then deleting another. In all honesty, I think it&#39;s an overkill to use those subs <code>OptimizeCode_Begin</code> and <code>OptimizeCode_End</code>. Unless you actually have to turn off events for a <code>Change</code> event, I don&#39;t think any of that will help too much."}, {"owner": {"reputation": 129, "user_id": 4564486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d37788de40c90bb90b57c09055b355e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sooji", "link": "https://stackoverflow.com/users/4564486/sooji"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544038269, "post_id": 53639206, "comment_id": 94138409, "body": "@dwirony I agree-- really it was just an attempt to consider every possible option. What&#39;s puzzling to me is that it&#39;s gotten to the point where the spreadsheet is in it&#39;s original state before I added/removed rows yet the file size is nearly double. Could it be that I&#39;m inserting a full row that&#39;s causing the issue?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1544038349, "post_id": 53639206, "comment_id": 94138442, "body": "@Sooji I&#39;d say the culprit is that you&#39;re format painting rows, all the way over to the last column in the workbook. If the font is bold, the cell&#39;s interior color is yellow and the font color is red, then you&#39;ve got a lot of empty cells holding that format for no purpose."}, {"owner": {"reputation": 129, "user_id": 4564486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d37788de40c90bb90b57c09055b355e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sooji", "link": "https://stackoverflow.com/users/4564486/sooji"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544039193, "post_id": 53639206, "comment_id": 94138806, "body": "@dwirony that&#39;s a great point! In fact, I think it&#39;s the source of the error. After changing this from what I copy/pasting from the &quot;record macro&quot; function to just a <code>&lt;my_range&gt;.PasteSpecial Paste:=xlPasteFormats</code>, things sped up substantially and my file size doesnt keep increasing in size. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 4564486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d37788de40c90bb90b57c09055b355e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sooji", "link": "https://stackoverflow.com/users/4564486/sooji"}, "is_accepted": false, "score": 3, "last_activity_date": 1544040155, "creation_date": 1544040155, "answer_id": 53639911, "question_id": 53639206, "link": "https://stackoverflow.com/questions/53639206/vba-add-remove-row-macros-runs-progressively-slower-each-time-i-run-them/53639911#53639911", "title": "VBA Add/Remove Row macros runs progressively slower each time I run them", "body": "<p>Thanks to @dwirony for the help. The issue was not in the insert/delete row, but rather the paste special that I (stupidly) copied from a record macro function. I simplified the paste and removed all unnecessary \"Select\" code.</p>\n\n<pre><code>Sub Add_System()\n\n    Application.ScreenUpdating = False\n\n    'Select bottom row of table and insert a new row\n    Range(\"calcCOPbottomRow\").Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    Dim formatRange As Range\n    Dim rowNum As Long\n\n    'Clean up formatting\n    rowNum = Range(\"calcCOPbottomRow\").Row - 3\n    Set formatRange = Range(CStr(rowNum) &amp; \":\" &amp; CStr(rowNum + 1))\n    formatRange.Copy\n    Rows(CStr(rowNum + 1) &amp; \":\" &amp; CStr(rowNum + 2)).PasteSpecial Paste:=xlPasteFormats\n\n    'Select new row\n    Range(\"calcCOPTableEnd\").Offset(-1, 0).Select\n\nEnd Sub\n\nSub Remove_System()\n\n    If Range(\"nSystems\") &lt;= 1 Then\n        MsgBox \"Cannot remove final row of COP Calculator Table\"\n        Exit Sub\n    End If\n\n    Application.ScreenUpdating = False\n\n    Dim formatRange As Range\n    Dim rowNum As Long\n\n    'Clean up formatting\n    rowNum = Range(\"calcCOPbottomRow\").Row - 2\n    Set formatRange = Range(CStr(rowNum) &amp; \":\" &amp; CStr(rowNum + 1))\n    formatRange.Copy\n    Rows(CStr(rowNum - 1) &amp; \":\" &amp; CStr(rowNum)).PasteSpecial Paste:=xlPasteFormats\n\n    'Delete system row\n    Range(\"calcCOPbottomRow\").Offset(-1, 0).Delete Shift:=xlUp\n\n    'Select new row\n    Range(\"calcCOPTableEnd\").Offset(-1, 0).Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 4564486, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d37788de40c90bb90b57c09055b355e5?s=128&d=identicon&r=PG&f=1", "display_name": "Sooji", "link": "https://stackoverflow.com/users/4564486/sooji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544043048, "creation_date": 1544037074, "last_edit_date": 1544043048, "question_id": 53639206, "link": "https://stackoverflow.com/questions/53639206/vba-add-remove-row-macros-runs-progressively-slower-each-time-i-run-them", "title": "VBA Add/Remove Row macros runs progressively slower each time I run them", "body": "<p>I have two simple scripts that runs progressively slower each time I run them.  One adds a row, another removes a row. Besides that, all that's done is some format copying to ensure the table still looks pretty.</p>\n\n<p>Here's the issue: I found if I add a row, remove it, then save the xlsm, the file size increases. Each time I do this, it seems to increase the runtime to the point where the spreadsheet locks up for a few seconds.</p>\n\n<p>For context: <code>calcCOPbottomRow</code> is a row in the excel spreadsheet.</p>\n\n<p>All other named cells are single cell values.</p>\n\n<p>Here they are:  </p>\n\n<pre><code>Sub Add_System()\n\n    Call OptimizeCode_Begin\n\n    'Select bottom row of table and insert a new row\n    Range(\"calcCOPbottomRow\").Select\n    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove\n\n    Dim formatRange As Range\n    Dim rowNum As Long\n\n    'Clean up formatting\n    rowNum = Range(\"calcCOPbottomRow\").Row - 3\n    Set formatRange = Range(CStr(rowNum) &amp; \":\" &amp; CStr(rowNum + 1))\n    formatRange.Copy\n    Rows(CStr(rowNum + 1) &amp; \":\" &amp; CStr(rowNum + 2)).Select\n    ActiveSheet.PasteSpecial Format:=4, Link:=1, DisplayAsIcon:=False, _\n        IconFileName:=False\n\n    'Select new row\n    Range(\"calcCOPTableEnd\").Offset(-1, 0).Select\n\n    Call OptimizeCode_End\nEnd Sub\n\nSub Remove_System()\n\n    If Range(\"nSystems\") &lt;= 1 Then\n        MsgBox \"Cannot remove final row of COP Calculator Table\"\n        Exit Sub\n    End If\n\n    Call OptimizeCode_Begin\n\n    Dim formatRange As Range\n    Dim rowNum As Long\n\n    'Clean up formatting\n    rowNum = Range(\"calcCOPbottomRow\").Row - 2\n    Set formatRange = Range(CStr(rowNum) &amp; \":\" &amp; CStr(rowNum + 1))\n    formatRange.Copy\n    Rows(CStr(rowNum - 1) &amp; \":\" &amp; CStr(rowNum)).Select\n    ActiveSheet.PasteSpecial Format:=4, Link:=1, DisplayAsIcon:=False, _\n        IconFileName:=False\n\n    'Delete system row\n    Range(\"calcCOPbottomRow\").Offset(-1, 0).Select\n    Selection.Delete Shift:=xlUp\n\n    'Select new row\n    Range(\"calcCOPTableEnd\").Offset(-1, 0).Select\n\n    Call OptimizeCode_End\n\nEnd Sub\n</code></pre>\n\n<p><strong>Is there something in that code I'm not considering that causes this progressive slowdown?</strong> For the record, the OptimizeCode_End and OptimizeCode_Start had no impact on this, but if you're curious they're here:  </p>\n\n<pre><code>Sub OptimizeCode_Begin()\n\nApplication.ScreenUpdating = False\n\nEventState = Application.EnableEvents\nApplication.EnableEvents = False\n\nCalcState = Application.Calculation\nApplication.Calculation = xlCalculationManual\n\nPageBreakState = ActiveSheet.DisplayPageBreaks\nActiveSheet.DisplayPageBreaks = False\n\nEnd Sub\n\nSub OptimizeCode_End()\n\nActiveSheet.DisplayPageBreaks = PageBreakState\nApplication.Calculation = CalcState\nApplication.EnableEvents = EventState\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Any tips would be appreciated-- I'm pretty new to this stuff. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1544036992, "post_id": 53639135, "comment_id": 94137886, "body": "Data structures in VBA are certainly possible.  You can have <a href=\"https://www.tutorialspoint.com/vba/vba_arrays.htm\" rel=\"nofollow noreferrer\">arrays</a> and even <a href=\"https://stackoverflow.com/questions/915317/does-vba-have-dictionary-structure\">dictionaries</a>."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544037833, "post_id": 53639135, "comment_id": 94138227, "body": "@RobertHarvey Of course, that would still mean typing things out..."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544037899, "post_id": 53639135, "comment_id": 94138251, "body": "Do you propose generating this array somehow?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544037945, "post_id": 53639135, "comment_id": 94138267, "body": "I&#39;m not really sure what you have in mind, since any solution will involve typing in the data that&#39;s currently in a book... Keep the data in an Excel table or a database that VBA can read? Type it into a Word table? Put it in an XML file that can be imported to a Custom XML Part so that the data travels with the document (or template)? You don&#39;t really provide enough information to give you good advice..."}, {"owner": {"reputation": 1, "user_id": 4922371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9b6b6500063153cb6839b887412270?s=128&d=identicon&r=PG&f=1", "display_name": "hal", "link": "https://stackoverflow.com/users/4922371/hal"}, "edited": false, "score": 0, "creation_date": 1544038202, "post_id": 53639135, "comment_id": 94138382, "body": "I don&#39;t mind typing out the DIM ARR stuff since that would keep all the numbers in one spot, and the comparisons can be done hopefully with just one chunk of code instead of code for every single week. However, How would I make comparisons to the array?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544038918, "post_id": 53639135, "comment_id": 94138687, "body": "@hal Imo, the easiest way to do this would be to have a separate Excel file where on the main worksheet, you have your 52 weeks or so written out in columns A through C (or B through D, if that&#39;s easier). Then when you&#39;ve gotten your week #, you open that file and pull your 3 numbers that you need in."}, {"owner": {"reputation": 1, "user_id": 4922371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9b6b6500063153cb6839b887412270?s=128&d=identicon&r=PG&f=1", "display_name": "hal", "link": "https://stackoverflow.com/users/4922371/hal"}, "edited": false, "score": 0, "creation_date": 1544042766, "post_id": 53639135, "comment_id": 94140399, "body": "I&#39;m a little hesitant to start with the excel file if I can just Dim and array. I Imagine I&#39;d start with &quot;Dim Arr(2,3) as Percentile&quot;, and store each week number as the arr(x,0) value as &quot;1&quot;, &quot;2&quot;, &quot;3&quot;) and each weight number as the arr(x,1), arr(x,2), and arr(x,3) values. To first identify the correct week in my comparisons, is there a wild-card I&#39;d need to use for the first dimension in the array?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1544056771, "post_id": 53639135, "comment_id": 94145113, "body": "@hal Keeping the data in an external file makes it much easier to update when your criteria change; it doesn&#39;t need to be an Excel workbook, though - a plain text file with tabs between &#39;columns&#39; and paragraph breaks between &#39;rows&#39; would do."}], "owner": {"reputation": 1, "user_id": 4922371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c9b6b6500063153cb6839b887412270?s=128&d=identicon&r=PG&f=1", "display_name": "hal", "link": "https://stackoverflow.com/users/4922371/hal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544036779, "creation_date": 1544036779, "question_id": 53639135, "link": "https://stackoverflow.com/questions/53639135/is-there-a-way-to-use-a-lookup-table-in-ms-word-vba", "title": "Is there a way to use a lookup table in MS Word VBA?", "body": "<p>I'm creating a macro form in Word VBA that allows users to enter a week and a weight value which will calculate a percentile for them. I'm building this off of a table from a book that looks like this (Sorry, I'm not sure how to add tables to Stack Overflow questions yet):</p>\n\n<p>Percentile 10th 50th 90th</p>\n\n<p>Week1........3....12....34</p>\n\n<p>Week2........5....17....39</p>\n\n<p>Week3........8....21....42</p>\n\n<p>Currently my VBA code looks like this:</p>\n\n<pre><code>If Week = 1 then\n   If Weight &lt; 3 then\n   Selection.TypeText \"less than 10th percentile for age\"\n   ElseIf Weight = 3 then\n   Selection.TypeText \"10th percentile for age\"\n   ElseIf Weight &lt; 12 then\n   Selection.TypeText \"less than 50th percentile for age\"\n   ElseIf Weight = 12 then\n   Selection.TypeText \"50th percentile for age\"\n   ElseIf Weight &lt; 34 then\n   Selection.TypeText \"less than 90th percentile for age\"\n   ElseIf Weight = 34 then\n   Selection.TypeText \"90th percentile for age\"\n   ElseIf Weight &gt; 34 then\n   Selection.TypeText \"greater than 90th percentile for age\"\n   End If\nElseIf Week = 2 then\n   If Weight &lt; 5 then\n   Selection.TypeText \"less than 10th percentile for age\"\n...\n</code></pre>\n\n<p>The table is actually much bigger than 3 columns and 3 rows, so you can imagine this is very tedious. The table itself is not to be visible to the user, but coded behind the scenes. I'm wondering if instead of typing out all the code like I've done above, if there's a way to add a table to this so that future maintenance of the values is more straightforward. Thank you!</p>\n\n<p>I'm using Word 2016.</p>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 3, "creation_date": 1544037693, "post_id": 53639071, "comment_id": 94138175, "body": "A couple things - try to avoid using so many comments. Reserve comments for when you REALLY need to convey something to the reader. Instead of using <code>y</code>, use something like <code>lastrow</code> instead - that&#39;ll give more readability than any comment would. Also, instead of using <code>.End(xlDown).Row</code> and <code>.End(xlToRight).Column</code>, you should use <code>xlUp</code> and <code>xlToLeft</code> instead - this will allow you to capture all the rows, even if there&#39;s a blank in column A."}], "owner": {"reputation": 11, "user_id": 10751168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d27ad4df60d3cf38d40d3f992ef4ea1?s=128&d=identicon&r=PG&f=1", "display_name": "xkid", "link": "https://stackoverflow.com/users/10751168/xkid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1559020104, "creation_date": 1544036484, "last_edit_date": 1559020104, "question_id": 53639071, "link": "https://stackoverflow.com/questions/53639071/how-to-copy-columns-when-there-are-blanks-in-the-data", "title": "How to copy columns when there are blanks in the data?", "body": "<p>I've been trying to copy several columns from another file (from several sheets).</p>\n\n<p>I created a kind of matrix where the user can configure the name and column position to copy. I realized when there is a blank in a column my code is copying from, it skips the information next to the blank cell and moves on to the next sheet. </p>\n\n<p>Another option I was thinking of is to fill all the blanks with a module as function and call it to my main program but I don't know how:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'GLOBAL VARIABLES\n'\n'Variable used to pick a file in the beginning (\"Activo Fijo\" File)\nDim file_in As String\n'Variable to name the Workbook where are generated the macro file\nDim Entrance As Workbook\n'Variable to calculate the accumulated range of the \"Activo Fijo\" (columns)\nDim x, a As Long\n'Variables to measure the rows and columns on the \"Configuration\" sheet (located on the Macro Workbook)\nDim y, w As Integer\n'Variable to measure the copy range from \"Activo Fijo\"\nDim seg1 As String\n'Variable to copy info\nDim copyinfo As String\n'Variable to locate the \"Activo Fijo\" file sheets on the matrix\nDim pestana As String\n'Variable to measure the matrix range\nDim seg2 As RANGE\n'Variable to change the matrix range\nDim rangesize As String\n'Variable to create the new Workbook where is pasted the info\nDim wc As Workbook\n\n'CLEAR THE ALREADY CONSOLIDATED DATA\n'\n'Subroutine to erased the old data and generate the new ones\nSub clean()\n\nMe.Sheets(2).Cells.ClearContents\n\nEnd Sub\n\n'CONSOLIDATING ALL SOURCES AND NECESSARY SHEETS FROM \"ACTIVO FIJO\" FILE\n'\n'Subroutine to take all necessary information from the input file to create PANDA file\nSub ActivoFijo()\n'sentences to avoid unnecessary Pop-Ups\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n'Instruction to pick a file (\"Activo Fijo\" File)\nfile_in = Module1.pick_file(\"Selecionar Activo Fijo\")\n\nIf (file_in = \"\") Then\n'Exit if the file is not found\n    Exit Sub\nEnd If\n'Open if the file is found\nSet Entrance = Workbooks.Open(file_in)\n\nclean\n'Giving value 1 to skip headers\na = 1\n'Measuring until the last row on the \"Configuration\" sheet\n\ny = Me.Sheets(3).Cells(1, 1).End(xlDown).Row\n\n'Measuring until the last column on the \"Configuration\" sheet\n\nw = Me.Sheets(3).Cells(1, 1).End(xlToRight).Column\n\n'LOOP TO GENERATE CONSOLIDATED INFO\n'\n'READING THE DATA ON THE MATRIX LOCATED ON THE \"CONFIGURATION\" SHEET\n'\n\nDo While y &lt;&gt; 1\n\n'Pop-Up that shows up if exist and column name error\n\n    pestana = Me.Sheets(3).Cells(y, 1).Value\n    On Error Resume Next\n    If IsError(Entrance.Sheets(pestana).Select) Then\n    Msgbox (\"El nombre de alguna pesta\u00f1a esta mal escrito. Reviselo y vuelva a ejecutar\")\n\n    Else\n        End If\n    Entrance.Sheets(pestana).Select\n    rangesize = Me.Sheets(3).Cells(y, 2).Value\n    Set seg2 = RANGE(rangesize, RANGE(rangesize).End(xlDown))\n    x = seg2.Count\n    For Z = 2 To w\n\n\n'READING THE DATA ON THE \"ACTIVO FIJO\" FILE AFTER HAVE BEEN SEARCHED ON THE MATRIX\n'\n            If a = 1 Then\n                Me.Sheets(2).Cells(1, Z - 1).Value = Me.Sheets(3).Cells(1, Z).Value\n                copyinfo = Me.Sheets(3).Cells(y, Z)\n                If Z = w Then\n\n'Loop to \"TRAMOS FO\" Sheet to add to its columns the \"x\"item (item used on the process)\n\n                    If copyinfo &lt;&gt; \"\" Then\n                        For tfo = 1 To x\n                            Me.Sheets(2).Cells(a + tfo, Z - 1).Value = copyinfo\n                        Next tfo\n                    End If\n                Else\n\n'If the column is not needed or is not mapping on the matrix, go to next column\n\n                    If copyinfo = \"\" Then\n                        GoTo moveforeward\n                    Else\n                        If IsNumeric(Mid(copyinfo, 2, 1)) Then\n\n'Copying info if occurs the first case\n\n                            seg1 = copyinfo &amp; \":\" &amp; Left(copyinfo, 1) &amp; seg2.item(x).Row\n                            RANGE(seg1).copy\n\n'Pasting info if occurs the first case\n\n                            Me.Sheets(2).Cells(a + 1, Z - 1).PasteSpecial Paste:=xlPasteValues\n                        Else\n\n'Copying info if occurs the second case\n\n                            seg1 = copyinfo &amp; \":\" &amp; Left(copyinfo, 2) &amp; seg2.item(x).Row\n                            RANGE(seg1).copy\n\n'Pasting info if occurs the second case\n\n                            Me.Sheets(2).Cells(a + 1, Z - 1).PasteSpecial Paste:=xlPasteValues\n                        End If\n                    End If\n                End If\n            Else\n                copyinfo = Me.Sheets(3).Cells(y, Z)\n                If Z = w Then\n\n'Loop to \"TRAMOS FO\" Sheet to add to its columns the \"x\"item (item used on the process)\n\n                    If copyinfo &lt;&gt; \"\" Then\n                        For tfo = 1 To x\n                            Me.Sheets(2).Cells(a + 1 + tfo, Z - 1).Value = copyinfo\n                        Next tfo\n                    End If\n                Else\n\n'If the column is not needed or is not mapping on the matrix, go to next column\n\n                    If copyinfo = \"\" Then\n                        GoTo moveforeward\n                    Else\n\n'If the column is out of range, change it to the mid item and read from there to do not copy unnecessary info\n\n                        If IsNumeric(Mid(copyinfo, 2, 1)) Then\n                            seg1 = copyinfo &amp; \":\" &amp; Left(copyinfo, 1) &amp; seg2.item(x).Row\n                            RANGE(seg1).copy\n                            Me.Sheets(2).Cells(a + 1, Z - 1).PasteSpecial Paste:=xlPasteValues\n                        Else\n\n'If the column is not out of range, read it normal\n\n                            seg1 = copyinfo &amp; \":\" &amp; Left(copyinfo, 2) &amp; seg2.item(x).Row\n                            RANGE(seg1).copy\n                            Me.Sheets(2).Cells(a + 1, Z - 1).PasteSpecial Paste:=xlPasteValues\n                        End If\n                    End If\n                End If\n            End If\n\n\nmoveforeward:\n    Next Z\n\n'formulas to keep increasing and decreasing ranges\n\n    y = y - 1\n    a = a + x\n\nLoop\n        SaveFile\n        Entrance.Close\nEnd Sub\n\n'SAVING NEW \"ACTIVO FIJO\" FILE ALREADY CONSOLIDATED\n'\n'Subroutine to copy consolidated \"Activo fijo\" File sheet on a new Workbook\nSub SaveFile()\n'Variable to create a new workbook\nSet wc = Workbooks.Add\n'Using \"Me\" Variable to copy sheet 2 from the macro file\n'Using destination property to paste sheet 2 from the macro file on the already created new Workbook (\"wc\" variable)\nMe.Sheets(2).UsedRange.copy Destination:=wc.Sheets(1).RANGE(\"A1\")\n'Using TempFile properties to saving the new Workbook as a new file with XSLX extention, and name it as \"AF\" (Do Not Change name). It will be used on the nex processes\n    TempFilePath = Application.DefaultFilePath &amp; \"\\\"\n    TempFileName = \"AF\" &amp; \"_\" &amp; Format(Now, \"mm-yy\")\n    With wc\n        .SaveAs TempFilePath &amp; TempFileName\n        .Close SaveChanges:=False\n'Pop-Up that shows up the path and the save file direction\n    End With\n    Msgbox \"A generado un nuevo archivo en \" &amp; TempFilePath\n'Ending routine\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "out-of-memory"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544036172, "post_id": 53638958, "comment_id": 94137530, "body": "Hmm, sounds like you have a recursive call to your form opens in there somewhere.  You&#39;re not going to see it before it crashes, because you&#39;ve tied up the message pump thread."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1544036271, "post_id": 53638958, "comment_id": 94137572, "body": "Are you getting reasonable values for <code>Application.Width</code> and <code>Application.Height</code>? If your image is auto-scaling and they&#39;re, say, MAX_INT, that could do it."}, {"owner": {"reputation": 13, "user_id": 10660148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6306e3689a67a59a08bcacb5a39452e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10660148/kevin"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1544037044, "post_id": 53638958, "comment_id": 94137903, "body": "@Comintern Tried just removing the part that rescales it and still getting the same error :/"}, {"owner": {"reputation": 13, "user_id": 10660148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6306e3689a67a59a08bcacb5a39452e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10660148/kevin"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544037101, "post_id": 53638958, "comment_id": 94137935, "body": "@RobertHarvey Can you elaborate on this? I&#39;m sorry I&#39;m a bit of a n00b and have been self-teaching myself all of this as I go.  I appreciate your help, just don&#39;t fully understand your suggestion."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544037148, "post_id": 53638958, "comment_id": 94137956, "body": "Do you know what recursion is?"}, {"owner": {"reputation": 13, "user_id": 10660148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6306e3689a67a59a08bcacb5a39452e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10660148/kevin"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544037320, "post_id": 53638958, "comment_id": 94138048, "body": "@RobertHarvey A formula or section that calls itself, right?"}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544037379, "post_id": 53638958, "comment_id": 94138067, "body": "Yes.  So imagine a form that opens a new instance of itself, which opens a new instance of itself, which ..."}, {"owner": {"reputation": 13, "user_id": 10660148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6306e3689a67a59a08bcacb5a39452e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10660148/kevin"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1544037473, "post_id": 53638958, "comment_id": 94138093, "body": "@RobertHarvey hmmm... So everything in the userform code is above.  The button that opens it is literally just  &quot;Sub Button1_Click() ControllerForm.Show  End Sub&quot;  Does the &quot;click&quot; mean while it&#39;s clicked so that it&#39;s continually opening my userform?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544039011, "post_id": 53638958, "comment_id": 94138736, "body": "Comment-out all that code. Does it fix the problem? Uncomment one procedure at a time, one instruction at a time, testing again between every change, starting with the <code>Initialize</code> handler, then the <code>Activate</code> hander. Delete the empty stub handler procedures."}, {"owner": {"reputation": 13, "user_id": 10660148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6306e3689a67a59a08bcacb5a39452e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10660148/kevin"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544039604, "post_id": 53638958, "comment_id": 94138976, "body": "@MathieuGuindon  Even with everything commented out I still get the error when the button is pressed to open the user form.Could it be something with the button itself to open it.   <code>Sub Button 1_Click()</code> <code>ControllerForm.Show</code> <code>End Sub</code>  Not sure how that simple of a module could be causing a problem!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544040054, "post_id": 53638958, "comment_id": 94139179, "body": "<code>With New ControllerForm</code>/ <code>.Show</code> / <code>End With</code> - don&#39;t show the default instance. Works? If not, the form module itself might be corrupted. Avoid working with the default instance, especially when adding controls at runtime."}, {"owner": {"reputation": 13, "user_id": 10660148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6306e3689a67a59a08bcacb5a39452e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10660148/kevin"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544046905, "post_id": 53638958, "comment_id": 94142206, "body": "@MathieuGuindon Same error.  Debugger says it&#39;s getting hungup on the first line of <code>Sub Button1_Click()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": -1, "last_activity_date": 1544052855, "creation_date": 1544052855, "answer_id": 53642428, "question_id": 53638958, "link": "https://stackoverflow.com/questions/53638958/catastrophic-failure-out-of-memory-when-opening-a-user-form/53642428#53642428", "title": "Catastrophic Failure - Out of Memory when opening a User Form", "body": "<h1>Enigma</h1>\n\n<p>Not much to go on:</p>\n\n<p><a href=\"https://i.stack.imgur.com/p1r7f.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p1r7f.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>To load the form, I have the code for a <strong>Command Button OLE Object</strong> in the <strong>Sheet3 code window</strong>:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Load ControllerForm\n  ControllerForm.Show\nEnd Sub\n</code></pre>\n\n<p>Notice two differences from your code:</p>\n\n<pre><code>Sub Button1_Click()\n  ControllerForm.Show\nEnd Sub\n</code></pre>\n\n<ol>\n<li>Do you maybe need to use <code>Load ControllerForm</code>?</li>\n<li>There is a difference between those buttons: Commandbutton1 and Button1. Your Button1 is a <strong>msoFormControl</strong> (8), while my button is a <strong>msoOLEControlObject</strong>(12).\nLook <a href=\"https://stackoverflow.com/questions/53094140/excel-vba-error-1004-when-trying-to-delete-buttons-from-a-range-of-cells/53095898#53095898\"><strong>here</strong></a>. </li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13758999, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/50786521c0f387e3cf05143e5ee27106?s=128&d=identicon&r=PG", "display_name": "Teddy", "link": "https://stackoverflow.com/users/13758999/teddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1592344508, "creation_date": 1592344508, "answer_id": 62418182, "question_id": 53638958, "link": "https://stackoverflow.com/questions/53638958/catastrophic-failure-out-of-memory-when-opening-a-user-form/62418182#62418182", "title": "Catastrophic Failure - Out of Memory when opening a User Form", "body": "<p>Appreciate this is an old thread but I had a similar problem which has been causing me a headache for a few hours.</p>\n\n<p>I'd been working on dual monitors and set up half a dozen user forms</p>\n\n<p>If I then tried to open some of the user forms on my laptop without any monitors connected I was getting he dramatic, 'catastrophic failure.</p>\n\n<p>I found that the issue was something to do with the screen scale in display settings. My monitors were 100%, with my laptop 125%.</p>\n\n<p>When I changed the laptop to 100%... voila. all working. Bit daft to be honest but thought it worth a mention</p>\n"}], "owner": {"reputation": 13, "user_id": 10660148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6306e3689a67a59a08bcacb5a39452e?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10660148/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 712, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1592344508, "creation_date": 1544036044, "last_edit_date": 1555477137, "question_id": 53638958, "link": "https://stackoverflow.com/questions/53638958/catastrophic-failure-out-of-memory-when-opening-a-user-form", "title": "Catastrophic Failure - Out of Memory when opening a User Form", "body": "<p>I have a VBA program that opens a series of userforms.<br>\nI designed the entire thing on my laptop, and tested it on some other laptops.  Both in Excel 2010 and 2016. </p>\n\n<p>I shared it with coworkers who use a different style of laptop (Win7, Office 2010).  Every time they hit the button to open the userform they get a Catastrophic Failure, out of memory error.</p>\n\n<p>I've seen online that modules should be under 64kb.  The module used to open the button is very small (just opens up UserForm1).  </p>\n\n<p>The Userform frm file is 4 KB.<br>\nThe Userform frx file is 1.24 MB, larger because there are pictures etc. on this form.  </p>\n\n<p>The code that the User Form runs.</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n\n'Determines the controller model based off selection\nIf ComboBox1.Text = \"VHX-6000 + VHX-A60E\" Then\n    Controller = 6000\nElse\n    Controller = 950\nEnd If\n\n'Updates textbox1 with current pricing info\nTextBox1.Text = Application.VLookup(Controller, Sheet3.Range(\"A37:C45\"), 2, 0)   \n\nEnd Sub\n\nPrivate Sub Continue1_Click()\n\nprice = 0\n\n'Determines if it should show the camera page based on the controller selection\nIf Controller = 6000 Then\n    CameraForm.Show\nElse\n    Camera = 6020\n    StageForm.Show\nEnd If\n\nEnd Sub\n\nPrivate Sub Image6_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal Data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)\n\nEnd Sub\n\nPrivate Sub Label2_Click()\n\nEnd Sub\n\nPrivate Sub UserForm_Activate()\n\n'Make Sheet 3 activate to avoid that weird error message towards the end\nWorksheets(\"sheet3\").Activate\n\n'Sets the dropdown list\nComboBox1.List() = Sheet3.Range(\"C6:C7\").Value\n\n'Clears the quote information if present\nSheet3.Range(\"M51:O100\").ClearContents\n\nController = 0\n\nEnd Sub\n\nPrivate Sub UserForm_Click()\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n'Full Screen\nWith Me\n    .Width = Application.Width\n    .Height = Application.Height\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544038022, "post_id": 53639130, "comment_id": 94138302, "body": "Which line is highlighted (click &quot;Debug&quot; when the error pops up)?"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544038396, "post_id": 53639130, "comment_id": 94138457, "body": "Thank you for your solution. I tried using it but it is giving an error: wrong number of arguments. I have written the code as follows: <code>Const HIGHLIGHT_COLOR = 9894500  Function Hilighted(c As range)     Highlighted = (c.Interior.Color = HIGHLIGHT_COLOR) End Function Sub Highlighted()     With Worksheets(&quot;Monday&quot;)         If Highlighted(.range(&quot;B12&quot;)) Then             .range(&quot;B12&quot;).Offset(0, -2).Value = &quot;Baize, Artress L.&quot;         End If     End With End Sub</code>"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544038467, "post_id": 53639130, "comment_id": 94138476, "body": "Sorry for the double comments, the line highlighted is this: &#39;Sub Highlighted()`"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544040163, "post_id": 53639130, "comment_id": 94139232, "body": "Do you already have a Sub called <code>Highlighted</code>?  My posted code only has a function with that name."}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544041538, "post_id": 53639130, "comment_id": 94139825, "body": "Even after I change the Sub name its still giving the error Sub or Function not defined. Highlighting the <code>Sub AssignBidded()</code>"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544041868, "post_id": 53639130, "comment_id": 94139993, "body": "Okay I figured out what was wrong with my iteration of code. Now its giving me <code>Application defined or object defined error</code> and highlights <code>.range(&quot;B12&quot;).Offset(0, -2).Value = &quot;ABC&quot;</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544042005, "post_id": 53639130, "comment_id": 94140065, "body": "I didn&#39;t notice this when I posted, but you can&#39;t offset two columns to the left of column B...  what column would that be?"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544042408, "post_id": 53639130, "comment_id": 94140245, "body": "Got it running! Thank you for all your help and clarification!"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544051734, "post_id": 53639130, "comment_id": 94143828, "body": "You were right, I cannot offset two columns to left, it was a mistake in the code, soon as I replaced &quot;-2&quot; with &quot;2&quot; Voila!! it worked! :D"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544052581, "post_id": 53639130, "comment_id": 94144068, "body": "On the same topic if I have a list of names and i want to loop through them and assign them to only the highlighted cells how would you think I should go about this? I am really sorry for bothering about this."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544053156, "post_id": 53639130, "comment_id": 94144226, "body": "Time for a new question?"}, {"owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "edited": false, "score": 0, "creation_date": 1544053570, "post_id": 53639130, "comment_id": 94144321, "body": "I guess yes! New to the forum. Was blocked before for asking too many questions. Will do! Thanks..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1544051881, "last_edit_date": 1544051881, "creation_date": 1544036756, "answer_id": 53639130, "question_id": 53638900, "link": "https://stackoverflow.com/questions/53638900/only-select-value-according-to-highlighted-cells/53639130#53639130", "title": "Only select value according to highlighted cells", "body": "<p>You can create a simple function to check for highlighting...</p>\n\n<pre><code>'use a constant to store the highlight color, since it's used\n'   in multiple places in your code\nConst HIGHLIGHT_COLOR = 9894500 'RGB(100, 250, 150)\n\nSub AssignBided()\n    With Worksheets(\"Monday\")\n        If IsHighlighted(.Range(\"B12\")) Then\n            .Range(\"B12\").Offset(0, 2).Value = \"ABC\" 'changed offset from -2...\n        End If\n    End With\nEnd Sub\n\n'Is a cell highlighted? EDIT: changed the function name to IsHighlighted\nFunction IsHighlighted(c As Range)\n    IsHighlighted = (c.Interior.Color = HIGHLIGHT_COLOR)\nEnd Function\n\n\nSub Hilight(RNG As Range, Hilight As Boolean)\n    With RNG.Interior\n        If Hilight Then\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = HIGHLIGHT_COLOR '&lt;&lt; use contant here\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        Else\n            .Pattern = xlNone\n            .PatternTintAndShade = 0\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10187439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ge6nn.jpg?s=128&g=1", "display_name": "LewisThelemon", "link": "https://stackoverflow.com/users/10187439/lewisthelemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53639130, "answer_count": 1, "score": 1, "last_activity_date": 1581745541, "creation_date": 1544035811, "last_edit_date": 1581745541, "question_id": 53638900, "link": "https://stackoverflow.com/questions/53638900/only-select-value-according-to-highlighted-cells", "title": "Only select value according to highlighted cells", "body": "<p>I am trying a code which would select a value from a Data Validation Dropdown list only if the cell, which is two blocks to its left, is highlighted. But I am not able to figure out how to do this. Can anyone help please? Thanks</p>\n\n<p>I have the following code which is wrong but just as an example:</p>\n\n<pre><code>Sub AssignBided()\nWorksheets(\"Monday\").Select\nWith Worksheets(\"Monday\")\n    If Hilight.range(\"B12\") = True Then\n        range(\"B12\").Activate\n        ActiveCell.Offset(0, -2).Select\n        .Selection.Value = \"ABC\"\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The code to highlight cells is as follows:</p>\n\n<pre><code>Sub Hilight(RNG As range, Hilight As Boolean)\n    With RNG.Interior\n        If Hilight Then\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .Color = RGB(100, 250, 150)\n            .TintAndShade = 0\n            .PatternTintAndShade = 0\n        Else\n            .Pattern = xlNone\n            .PatternTintAndShade = 0\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>The hilight Sub is used as follows:</p>\n\n<pre><code>Dim L8Product As String\nDim i As Long\nDim L8Rnge As range\nL8Product = range(\"Line8_P_Mon\")\n'Line 8 Resource requirement code\n'Determine if change was made in cell B39\nIf Not Intersect(Target, Me.range(\"Line8_P_Mon\")) Is Nothing Then\n        Hilight range(\"Line8_Hilight_Mon\"), False\n'Below Code searches in the KP and Osgood Table and then highlights the \nappropriate cells\n    If Trim(L8Product) &lt;&gt; \"\" Then\n        With Sheets(\"Products\").range(\"KP_Table\")                     \n'searchs in the KP Table on Sheet Overtime_Pos_Table\n\n            'The code below will search the KP table for the product that you will select from the Line 8 drop down\n            Set L8Rnge = .Find(what:=L8Product, _\n                            after:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            lookat:=xlWhole, _\n                            searchorder:=xlByRows, _\n                            searchdirection:=xlNext, _\n                            MatchCase:=False)\n            If Not L8Rnge Is Nothing Then\n                    Hilight range(\"KP_Hilight_Mon\"), True               \n'Hilights the cells for the KP and the Prep material required\n            Else: With Sheets(\"Products\").range(\"Osgood_Table\")\n                    Set L8Rnge = .Find(what:=L8Product, _\n                                    after:=.Cells(.Cells.Count), _\n                                    LookIn:=xlValues, _\n                                    lookat:=xlWhole, _\n                                    searchorder:=xlByRows, _\n                                    searchdirection:=xlNext, _\n                                    MatchCase:=False)\n                    If Not L8Rnge Is Nothing Then\n                            Hilight range(\"Osgood_Hilight_Mon\"), True   \n'Hilights the cells for the Osgood and the Prep material required\n                    End If\n                  End With\n            End If\n        End With\n    Else: Hilight range(\"Line8_Hilight_Mon\"), False\n    End If\nEnd If\n</code></pre>\n\n<p>Hope the question is clear. Thank you in advance.</p>\n"}, {"tags": ["excel", "vba", "data-entry"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1544049940, "post_id": 53638586, "comment_id": 94143238, "body": "So, you want to insert new data at row 2, right?"}], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1544050751, "last_edit_date": 1544050751, "creation_date": 1544050394, "answer_id": 53642016, "question_id": 53638586, "link": "https://stackoverflow.com/questions/53638586/transfer-move-added-data-down-instead-of-appending/53642016#53642016", "title": "Transfer/move added data down (instead of appending)", "body": "<p>Just insert a new row at <code>Range(\"A2\")</code> and the change your last row variable to a <code>2</code> to signify <code>row 2</code></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    With ThisWorkbook.Sheets(\"WOTracker\") \n        .Cells(2, 1).EntireRow.insert\n        .Cells(2, 1).Value = TextBox1.Value\n        .Cells(2, 5).Value = TextBox2.Value\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9183266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nEhiFl8tojg/AAAAAAAAAAI/AAAAAAAAAJg/IprzCQgBcaU/photo.jpg?sz=128", "display_name": "Dani", "link": "https://stackoverflow.com/users/9183266/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544115968, "creation_date": 1544034524, "last_edit_date": 1544115968, "question_id": 53638586, "link": "https://stackoverflow.com/questions/53638586/transfer-move-added-data-down-instead-of-appending", "title": "Transfer/move added data down (instead of appending)", "body": "<p>I have the following macro which works fine for me in terms of adding data and new lines:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim emptyRow As Long\n\n  'Make WOTracker active\n  Sheets(\"WOTracker\").Activate\n\n  'Determine emptyRow\n   emptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n  'Transfer information\n   Cells(emptyRow, 1).Value = TextBox1.Value\n   Cells(emptyRow, 5).Value = TextBox2.Value\nEnd Sub\n</code></pre>\n\n<p>What I need help with is modifying the code so that instead of adding data below existing rows (to a new line), it pushes the previously added data down. So what was in row 2 goes to row 3 and the new data is inserted into Row 2.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12241, "user_id": 130611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0548fbba2b82688a059127e65dd29c9?s=128&d=identicon&r=PG", "display_name": "the_lotus", "link": "https://stackoverflow.com/users/130611/the-lotus"}, "edited": false, "score": 0, "creation_date": 1544034006, "post_id": 53638085, "comment_id": 94136532, "body": "If the error Is in the loop, I would put the line into two. Just to see if it&#39;s the Elszamolas or the download sheet that cause the error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1544034041, "post_id": 53638085, "comment_id": 94136558, "body": "Which line gives the error?  The message you&#39;re getting points to one of your sheet names being wrong."}, {"owner": {"reputation": 109, "user_id": 9161191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/796950840489024/picture?type=large", "display_name": "M&#225;rton Gerg\u0151", "link": "https://stackoverflow.com/users/9161191/m%c3%a1rton-gerg%c5%91"}, "reply_to_user": {"reputation": 12241, "user_id": 130611, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b0548fbba2b82688a059127e65dd29c9?s=128&d=identicon&r=PG", "display_name": "the_lotus", "link": "https://stackoverflow.com/users/130611/the-lotus"}, "edited": false, "score": 0, "creation_date": 1544034172, "post_id": 53638085, "comment_id": 94136622, "body": "@the_lotus the error is in the loop because if I only take out the loop it doesn&#39;t give error"}, {"owner": {"reputation": 109, "user_id": 9161191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/796950840489024/picture?type=large", "display_name": "M&#225;rton Gerg\u0151", "link": "https://stackoverflow.com/users/9161191/m%c3%a1rton-gerg%c5%91"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544034220, "post_id": 53638085, "comment_id": 94136639, "body": "@TimWilliams There is just a pop up window &quot;Run-time error &#39;9&#39;: Subscript out of range"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1544034762, "post_id": 53638085, "comment_id": 94136911, "body": "Look <a href=\"https://excelmacromastery.com/excel-vba-worksheet/#Subscript_Out_of_Range\" rel=\"nofollow noreferrer\">here</a>. There you find all the typical cases for this situation."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544036250, "post_id": 53638085, "comment_id": 94137565, "body": "<code>Worksheets(&quot;Elszamolas&quot;)</code> will check the activeworkbook for a sheet with that name - you will need <code>ThisWorkbook.Worksheets(&quot;Elszamolas&quot;)</code> if the sheet is in the workbook where the code is running."}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544040237, "post_id": 53638673, "comment_id": 94139261, "body": "I&#39;d guess that &quot;Elszamolas&quot; is in the workbook with the code, not in the <code>src</code> workbook"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1544137267, "post_id": 53638673, "comment_id": 94180293, "body": "Where are each of the sheets located"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1544034857, "creation_date": 1544034857, "answer_id": 53638673, "question_id": 53638085, "link": "https://stackoverflow.com/questions/53638085/excel-vba-creates-subscript-error-with-a-for-loop/53638673#53638673", "title": "Excel VBA creates Subscript error with a for loop", "body": "<p>You could have an issue with unqualified ranges which has been corrected for in the below code. Please give this a try! If this does not work, my guess would be that you have a minor mismatch between your sheet name written in the code and the sheet name that actually exists in the workbook. </p>\n\n<p>Code also updated to dim worksheet variables for readability, use more standard last row (<code>LR</code>) calculation and loop name (<code>i</code>). </p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim src As Workbook: Set src = Workbooks.Open(\"C:\\Users\\gregg\\Downloads\\download.xls\", True, True)\nDim DL As Worksheet: Set DL = src.Sheets(\"download\")\nDim EZ As Worksheet: Set EZ = src.Sheets(\"Elszamolas\")\n\nDim i As Long\n\nFor i = 1 To DL.Range(\"B\" &amp; DL.Rows.Count).End(xlUp).Row\n    EZ.Range(\"B\" &amp; i).Formula = DL.Range(\"B\" &amp; i).Formula\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9161191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/796950840489024/picture?type=large", "display_name": "M&#225;rton Gerg\u0151", "link": "https://stackoverflow.com/users/9161191/m%c3%a1rton-gerg%c5%91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1581745550, "creation_date": 1544032453, "last_edit_date": 1581745550, "question_id": 53638085, "link": "https://stackoverflow.com/questions/53638085/excel-vba-creates-subscript-error-with-a-for-loop", "title": "Excel VBA creates Subscript error with a for loop", "body": "<p>I'm new to VBA but I'm trying.</p>\n\n<p>I'm trying to when you press a button on the worksheet, to open another Excel file, get the rows from it and copy it to my current Excel file. I want this automated so you only have to press 1 button.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim src As Workbook\n    Set src = Workbooks.Open(\"C:\\Users\\gregg\\Downloads\\download.xls\", True, True)\n\n    Dim iTotalRows As Integer\n    iTotalRows = src.Worksheets(\"download\").Range(\"B1:B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row).Rows.Count\n\n    Dim iCnt As Integer\n    For iCnt = 1 To iTotalRows\n        Worksheets(\"Elszamolas\").Range(\"B\" &amp; iCnt).Formula = src.Worksheets(\"download\").Range(\"B\" &amp; iCnt).Formula\n    Next iCnt\nEnd Sub\n</code></pre>\n\n<p>This is what I have currently. I want to copy from file download sheet download to file napiElszamolas sheet Elszamolas. When I run the script I get \"Subscript out of range\" \"Run-time error 9\".</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1544031587, "post_id": 53637750, "comment_id": 94135391, "body": "If the pivot field is a string, the value should be in quotes in <code>getpivotdata</code> (not the other way round though: you may put quotes around a number value in <code>getpivotdata</code> if the field is numeric). If it is then a <code>#ref</code>, then either the value does not exist or is not visible."}, {"owner": {"reputation": 43, "user_id": 10750798, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mDlIlPJlgbw/AAAAAAAAAAI/AAAAAAAADKQ/1D8HLwHGq0Y/photo.jpg?sz=128", "display_name": "Fabz", "link": "https://stackoverflow.com/users/10750798/fabz"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1544032099, "post_id": 53637750, "comment_id": 94135628, "body": "GSerg, the weird thing is that I can see the summed value in the table as we speak. Right now the table shows that for 123 the sum is 25 and for 234 the sum is 26 When I do the getpivotdata for &quot;123&quot; the formula returns 25 When I take the formula and just change it to &quot;234&quot; I get a #REF! error"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1544032129, "post_id": 53637750, "comment_id": 94135644, "body": "Can you show a screenshot?"}, {"owner": {"reputation": 43, "user_id": 10750798, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mDlIlPJlgbw/AAAAAAAAAAI/AAAAAAAADKQ/1D8HLwHGq0Y/photo.jpg?sz=128", "display_name": "Fabz", "link": "https://stackoverflow.com/users/10750798/fabz"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1544032257, "post_id": 53637750, "comment_id": 94135710, "body": "screenshot would be difficult due to proprietary data. If I can&#39;t figure this out, I will just have to iterate through which shouldn&#39;t be too slow, but still, it is such a weird error"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1544032351, "post_id": 53637750, "comment_id": 94135770, "body": "Create a table with three columns with random data of the same type as your actual data. Create a pivot with the same structure from it. Format the fields in the same way. See if it reproduces there and if it does, post a screenshot of that."}, {"owner": {"reputation": 43, "user_id": 10750798, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mDlIlPJlgbw/AAAAAAAAAAI/AAAAAAAADKQ/1D8HLwHGq0Y/photo.jpg?sz=128", "display_name": "Fabz", "link": "https://stackoverflow.com/users/10750798/fabz"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1544033080, "post_id": 53637750, "comment_id": 94136106, "body": "Thx, but I&#39;ll just iterate for now. If I ever figure it out at some point, I will try and update. I just don&#39;t know what else a number could be stored as besides a string and why only this one version all the other ones in the table"}], "answers": [{"comments": [{"owner": {"reputation": 2401, "user_id": 12695027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i74ZG.png?s=128&g=1", "display_name": "Scratte", "link": "https://stackoverflow.com/users/12695027/scratte"}, "edited": false, "score": 0, "creation_date": 1581719826, "post_id": 60229342, "comment_id": 106543691, "body": "I think the Question wants a solution to how to use <code>getpivotdata</code>, not how to abandon the idea."}, {"owner": {"reputation": 1901, "user_id": 9808063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yv1vF.jpg?s=128&g=1", "display_name": "Naresh", "link": "https://stackoverflow.com/users/9808063/naresh"}, "reply_to_user": {"reputation": 2401, "user_id": 12695027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i74ZG.png?s=128&g=1", "display_name": "Scratte", "link": "https://stackoverflow.com/users/12695027/scratte"}, "edited": false, "score": 0, "creation_date": 1581758360, "post_id": 60229342, "comment_id": 106549243, "body": "If we need to refer to a data cell in a pivot, wouldn&#39;t it be better to refer to it absolutely (like &quot;F5&quot;) instead of through getpivotdata? Just curious, why would anyone want to refer to the pivotdata after making a pivot table? He/She could have used sum, count or average function directly on the pivot data instead... Its just a suggestion."}, {"owner": {"reputation": 1901, "user_id": 9808063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yv1vF.jpg?s=128&g=1", "display_name": "Naresh", "link": "https://stackoverflow.com/users/9808063/naresh"}, "reply_to_user": {"reputation": 2401, "user_id": 12695027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i74ZG.png?s=128&g=1", "display_name": "Scratte", "link": "https://stackoverflow.com/users/12695027/scratte"}, "edited": false, "score": 0, "creation_date": 1581759034, "post_id": 60229342, "comment_id": 106549397, "body": "#Ref error may mean the pivot cell is not supported by the data(missing vlaue in data). Its better to clear cache or not to use getpivotdata and refer the cell directly."}], "tags": [], "owner": {"reputation": 1901, "user_id": 9808063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yv1vF.jpg?s=128&g=1", "display_name": "Naresh", "link": "https://stackoverflow.com/users/9808063/naresh"}, "is_accepted": false, "score": -1, "last_activity_date": 1581793862, "last_edit_date": 1581793862, "creation_date": 1581694716, "answer_id": 60229342, "question_id": 53637750, "link": "https://stackoverflow.com/questions/53637750/getpivotdata-ref-error-data-format-issue/60229342#60229342", "title": "GetPivotData #REF Error, data format issue?", "body": "<p>I usually prefer not to use the GetPivotData function for excel. You can remove the option by not selecting the use GetPivotData function in excel options on the file tab. Please see the ScreenShot<a href=\"https://i.stack.imgur.com/2Mms1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2Mms1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If we need to refer to a data cell in a pivot, wouldn't it be better to refer to it absolutely (like \"F5\") instead of through getpivotdata? Just curious, why would anyone want to refer to the pivotdata after making a pivot table? He/She could have used sum, count or average function directly on the pivot data instead... Its just a suggestion.\n<strong>#Ref error may mean the pivot cell is not supported by the data(missing vlaue in data). Its better to clear cache or not to use getpivotdata and refer the cell directly.</strong></p>\n"}, {"tags": [], "owner": {"reputation": 6097, "user_id": 2876079, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6NZXD.png?s=128&g=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2876079/stefan"}, "is_accepted": false, "score": 0, "last_activity_date": 1600785420, "creation_date": 1600785420, "answer_id": 64012045, "question_id": 53637750, "link": "https://stackoverflow.com/questions/53637750/getpivotdata-ref-error-data-format-issue/64012045#64012045", "title": "GetPivotData #REF Error, data format issue?", "body": "<p>If some of you are looking for an error handling (#ref error might be caused by filters):</p>\n<pre><code>=if(isError(formula);defaultValue;formula)\n</code></pre>\n<p>In Excel you can define names/variables for long expressions, e.g</p>\n<pre><code>formula=getpivotdata(&quot;my_sum&quot;, ptable_ref, col_name, &quot;COL_VAL&quot;, row_name, row_val)\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10750798, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mDlIlPJlgbw/AAAAAAAAAAI/AAAAAAAADKQ/1D8HLwHGq0Y/photo.jpg?sz=128", "display_name": "Fabz", "link": "https://stackoverflow.com/users/10750798/fabz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3067, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1600785420, "creation_date": 1544031051, "last_edit_date": 1581692647, "question_id": 53637750, "link": "https://stackoverflow.com/questions/53637750/getpivotdata-ref-error-data-format-issue", "title": "GetPivotData #REF Error, data format issue?", "body": "<p>I am getting a #Ref error when I try to reference an element from a pivottable.</p>\n\n<p>I am literally doing a \"=\" and clicking on the pivot table to get the formula and even that is returning a #REF error.</p>\n\n<p>To be a bit more specific, I am using a pivot table to sum up a datafield across some rows and columns. The columns have numbers formatted as string, so when I do the formula I get:\n=getpivotdata(\"my_sum\", ptable_ref, col_name, <strong>\"COL_VAL\"</strong>, row_name, row_val)</p>\n\n<p>COL_VAL is a number like 123, 234 but formatted as a string. Right now when I do the formula for \"123\" it works, but the same formula for \"234\" gives me a #REF error. If I leave off the quotes to use the number itself, I still get an error.</p>\n\n<p>I've restarted excel and my computer, but that doesn't help. The data is being pulled from a database query, but col_name is the same format for all of them. I don't see any trailing or leading spaces either. I am scratching my head about what this could be. I'd rather not have to iterate through the rows for the values I need and just use the function to make it easy on myself.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1544031106, "post_id": 53637652, "comment_id": 94135157, "body": "You do under stand your data will shift when you delete. Or do you just want to clear the cells?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1544031116, "post_id": 53637652, "comment_id": 94135162, "body": "Does <code>CopyRng.Delete (xlShiftUp)</code> not do what you want to do?"}, {"owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1544034165, "post_id": 53637652, "comment_id": 94136618, "body": "@GMalc I want to copy the data into Sheet 3 and then delete it from Sheet 1. I do want it to shift. Only problem is not the entire row, only A to J."}, {"owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1544034233, "post_id": 53637652, "comment_id": 94136646, "body": "@JoshEller I don&#39;t want to copy and delete the entire row, only the range from A to J."}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1544034332, "post_id": 53637652, "comment_id": 94136700, "body": "Ok... so why are you running <code>CopyRng.EntireRow.Copy</code> and <code>CopyRng.EntireRow.Delete</code>?? Just get rid of the <code>.EntireRow</code>"}, {"owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1544034556, "post_id": 53637652, "comment_id": 94136804, "body": "@JoshEller Thank you! For .Copy as well? How do i specify that I only want to copy range from A to J?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1544036105, "post_id": 53637652, "comment_id": 94137506, "body": "Is <code>CopyRng</code> not the range you want to copy? If it&#39;s just a cell on the row, then use <code>CopyRng.EntireRow.Range(&quot;A1:J1&quot;)</code> for both the <code>.copy</code> and <code>.delete</code>."}, {"owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1544037354, "post_id": 53637652, "comment_id": 94138057, "body": "@JoshEller I used EntireRow.Range(&quot;A1:J1&quot;) but it copies only the first row, and not all the matching rows of CopyRng."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "edited": false, "score": 0, "creation_date": 1544033995, "post_id": 53638210, "comment_id": 94136528, "body": "Hello @GMalc The code works. However, it replaces the data in Sheet 3 (not copying from the LastRow + 1). Also, it deletes the entire row from Sheet 1 and not the range A to J."}, {"owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "edited": false, "score": 0, "creation_date": 1544042282, "post_id": 53638210, "comment_id": 94140186, "body": "I could get the copying to work. But it&#39;s deleting entire rows. Any thoughts?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "edited": false, "score": 0, "creation_date": 1544049370, "post_id": 53638210, "comment_id": 94143046, "body": "@Siddharth try my edited code, i think the Rng was causing problems with selecting the range to copy."}, {"owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "edited": false, "score": 0, "creation_date": 1548192020, "post_id": 53638210, "comment_id": 95453124, "body": "Hello, it is still deleting the entire sheet row."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "edited": false, "score": 0, "creation_date": 1548255934, "post_id": 53638210, "comment_id": 95478305, "body": "@Siddharth Try my edit, Excel has issues when trying to delete a range of cells in a filtered range, it just deletes the rows. The workaround is to clear the visible cells in a filtered range, then remove the filter and delete the blank cells in the range."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1548255780, "last_edit_date": 1548255780, "creation_date": 1544032972, "answer_id": 53638210, "question_id": 53637652, "link": "https://stackoverflow.com/questions/53637652/copy-a-range-and-not-the-entire-row/53638210#53638210", "title": "Copy a range and not the entire row", "body": "<p>The basic code below uses an auto-filter(much faster then looping) and copies the visible cells in the range to the first empty cell in column A. </p>\n\n<p>Deleting part of your data will cause the rows to shift and possible screw up your data. I also provided a line of code to only clear you range.</p>\n\n<pre><code>Dim ws1 As Worksheet, ws3 As Worksheet, lRow As Long, Rng As Range\n\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet ws3 = ThisWorkbook.Sheets(\"Sheet3\")\nlRow = ws3.Cells(Rows.Count, 1).End(xlUp).Row\nSet Rng = ws1.Range(\"A1\").CurrentRegion\n\n    Rng.AutoFilter Field:=2, Criteria1:=ws1.Range(\"M15\").Value\n\n    ws1.Range(Cells(2, 1), Cells(Rng.Rows.Count, 10)).SpecialCells(xlCellTypeVisible).Copy _\n    Destination:=ws3.Range(\"A\" &amp; lRow + 1)\n\n    'You must clear the range and then remove the filter before deleting blank cells.\n    ws1.Range(Cells(2, 1), Cells(Rng.Rows.Count, 10)).SpecialCells(xlCellTypeVisible).Clear\n    ws1.Cells.AutoFilter\n    ws1.Range(Cells(2, 1), Cells(Rng.Rows.Count, 10)).SpecialCells(xlCellTypeBlanks).Delete Shift:=xlUp\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10592565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccf368a43acf03ecc66cfd10c01001d0?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth", "link": "https://stackoverflow.com/users/10592565/siddharth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1548255780, "creation_date": 1544030643, "last_edit_date": 1546660220, "question_id": 53637652, "link": "https://stackoverflow.com/questions/53637652/copy-a-range-and-not-the-entire-row", "title": "Copy a range and not the entire row", "body": "<p>I have code for matching values in column 'B' with the value in Cell 'M15' and copy and delete those rows.</p>\n\n<p>I only need to copy and delete a range (A to J) and not the entire row.</p>\n\n<pre><code>Sub MoveRows()\n\nDim Sht1 As Worksheet, Sht3 As Worksheet\nDim tfRow As Range, C As Range \nDim CopyRng As Range\nDim LastRow As Long\n\nApplication.ScreenUpdating = False\n\nSet Sht1 = Sheets(\"Sheet1\")\nSet Sht3 = Sheets(\"Sheet3\")\nWith Sht1\n   LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row \n\n   Set tfRow = .Range(\"B2:B\" &amp; LastRow)\n\nFor Each C In tfRow\n\n    If IsEmpty(C) Then\n        Exit Sub\n    End If\n\n    If C.Value = .Range(\"M15\").Value Then \n        If Not CopyRng Is Nothing Then\n            Set CopyRng = Application.Union(CopyRng, C)   \n        Else\n            Set CopyRng = C\n        End If\n    End If\n\nNext C\nEnd With\n\nIf Not CopyRng Is Nothing Then\n\n   LastRow = Sht3.Cells(Sht3.Rows.Count, \"B\").End(xlUp).Row\n   CopyRng.EntireRow.Copy Destination:=Sht3.Range(\"A\" &amp; LastRow + 1)\n   CopyRng.EntireRow.Delete (xlShiftUp)\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1544029584, "post_id": 53637199, "comment_id": 94134400, "body": "Some more information on the crashing coml2.dll: <a href=\"https://windows10dll.nirsoft.net/coml2_dll.html\" rel=\"nofollow noreferrer\">windows10dll.nirsoft.net/coml2_dll.html</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544030900, "post_id": 53637199, "comment_id": 94135081, "body": "Is that code in the form&#39;s code-behind? If so, avoid referring to the form&#39;s default instance (conveniently called <code>main</code>, just like the form&#39;s class name) in the form&#39;s code-behind. Use <code>Me</code> to refer to <i>the current instance</i>, and don&#39;t store state in forms&#39; default instance."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544031175, "post_id": 53637199, "comment_id": 94135189, "body": "Adding controls at run-time to the default instance of the form could have corrupted it. Try rebuilding it from scratch."}, {"owner": {"reputation": 1384, "user_id": 3893519, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ac2e81d6f659ddb9ee0f3e4f864368eb?s=128&d=identicon&r=PG", "display_name": "kneeki", "link": "https://stackoverflow.com/users/3893519/kneeki"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1544033273, "post_id": 53637199, "comment_id": 94136193, "body": "@MathieuGuindon The code resides in a separate Controller I created to generate &#39;thumbnails&#39;. It is not executed until the user clicks a checkbox."}, {"owner": {"reputation": 1384, "user_id": 3893519, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ac2e81d6f659ddb9ee0f3e4f864368eb?s=128&d=identicon&r=PG", "display_name": "kneeki", "link": "https://stackoverflow.com/users/3893519/kneeki"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1544033314, "post_id": 53637199, "comment_id": 94136212, "body": "@L8n Thank you, though it didn&#39;t help me diagnose the issue; it did help me understand the dll&#39;s purpose."}], "answers": [{"tags": [], "owner": {"reputation": 1384, "user_id": 3893519, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ac2e81d6f659ddb9ee0f3e4f864368eb?s=128&d=identicon&r=PG", "display_name": "kneeki", "link": "https://stackoverflow.com/users/3893519/kneeki"}, "is_accepted": true, "score": 0, "last_activity_date": 1548872055, "last_edit_date": 1592644375, "creation_date": 1544111358, "answer_id": 53655020, "question_id": 53637199, "link": "https://stackoverflow.com/questions/53637199/excel-crashing-without-error-when-form-controls-add-is-called/53655020#53655020", "title": "Excel crashing without error when form.Controls.Add is called", "body": "<p>Throughout my searching I found other people with the same crash and error logs in Windows Event Viewer. None of those posts were using VBA as I was. <s>I solved the issue by deleting the referenced Control <code>main.pageThumbnails</code> and recreating it in the editor.</s></p>\n<p>At this time I have no idea what caused the issue nor if this solution is permanent.</p>\n<hr />\n<h1>Update 30 Jan 2019</h1>\n<p>After continuing to struggle with this issue and not coming up with a final solution or even an explanation as to why it's happening I created a workaround.</p>\n<p>Instead of adding a <code>MSForms.Frame</code> object to the container I instead added the frame contents (an image and four labels) to the container and control their positioning via a <code>Sub setTop</code> method.</p>\n<p>At this moment I'm unsure of the performance impact but at least I'm able to continue working on additional functionality.</p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 10286012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/667193e34d0c9a6dd7804e95e358a047?s=128&d=identicon&r=PG&f=1", "display_name": "HiPierr0t", "link": "https://stackoverflow.com/users/10286012/hipierr0t"}, "is_accepted": false, "score": 0, "last_activity_date": 1608123309, "creation_date": 1608123309, "answer_id": 65323723, "question_id": 53637199, "link": "https://stackoverflow.com/questions/53637199/excel-crashing-without-error-when-form-controls-add-is-called/65323723#65323723", "title": "Excel crashing without error when form.Controls.Add is called", "body": "<p>Is <code>pageThumbnails</code> also a frame? And do you have other containers in your userform? If so, this is an Excel bug.</p>\n<p>This is an old question but I've just spent hours trying to find a solution so here are my findings.</p>\n<p>First, to replicate the issue:</p>\n<ul>\n<li>Create a new UserForm (UserForm1)</li>\n<li>Add a Frame (FrameA)</li>\n<li>Add this code:</li>\n</ul>\n<pre><code>Private Sub UserForm_Activate()\n    Set b = FrameA.Controls.Add(&quot;Forms.Frame.1&quot;, &quot;FrameB&quot;)\nEnd Sub\n</code></pre>\n<ul>\n<li>Add a module (Module1) with:</li>\n</ul>\n<pre><code>Sub showUserForm1()\n    UserForm1.Show\nEnd Sub\n</code></pre>\n<ul>\n<li>Run showUserForm1</li>\n</ul>\n<p>Everything works fine. Now add a second Frame (FrameC) along with this code in UserForm_Activate(): <code>Set d = FrameC.Controls.Add(&quot;Forms.Frame.1&quot;, &quot;FrameD&quot;)</code>. Run showUserForm1 again: Excel crashes. More precisely, it crashes on the first line (if you skip it, the second line works fine).</p>\n<p>After further testings, it appears that it fails only if the frame you are trying to add another frame in is at the back. If you bring successively FrameA or Frame C at the front you will notice that it fails always on the Frame wich is at the back.</p>\n<p>So I can think of only 3 possibilities:</p>\n<ul>\n<li>don't use frames and place your controls directly in the UserForm as the OP suggested,</li>\n<li>make sure your frame is at the top in design mode (using Zorder does not work),</li>\n<li>if you can't have your frame at the top (e.g. multiple frames), try by creating them all at runtime (FrameA and FrameB within, then FrameC and FrameD within etc).</li>\n</ul>\n"}], "owner": {"reputation": 1384, "user_id": 3893519, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ac2e81d6f659ddb9ee0f3e4f864368eb?s=128&d=identicon&r=PG", "display_name": "kneeki", "link": "https://stackoverflow.com/users/3893519/kneeki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 53655020, "answer_count": 2, "score": 0, "last_activity_date": 1608123309, "creation_date": 1544029030, "last_edit_date": 1581745561, "question_id": 53637199, "link": "https://stackoverflow.com/questions/53637199/excel-crashing-without-error-when-form-controls-add-is-called", "title": "Excel crashing without error when form.Controls.Add is called", "body": "<p>Excel 2016 <em>version 1811 (build 11029.20079 Click-to-Run)</em> is crashing without error when the following code is called from a user's interaction with a UserForm. Thing is, it only crashes in THIS <code>(main)</code> UserForm. If I add the container to any other UserForm it executes without any issue.</p>\n\n<pre><code>Private container As Object\n\n'***************************************************************************\n'Purpose: Create the container frame that holds the page title and preview image\n'***************************************************************************\nPrivate Sub createContainer()\n    Set container = main.pageThumbnails.Controls.add(\"Forms.Frame.1\", name) ' Break here, continuing causes *CRASH*\n\n    With container\n        .Caption = \"\"\n\n        .height = containerHeight\n        .width = containerWidth\n        .Left = 12\n        .top = areaHeight\n\n        .BackColor = defaultBackColor\n        .BorderColor = defaultBorderColor\n    End With\n\n    With main.pageThumbnails\n        .ScrollHeight = areaHeight\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Checking Windows Event Viewer gives me the following:</p>\n\n<pre><code>Faulting application name: EXCEL.EXE, version: 16.0.11029.20079, time stamp: 0x5bf4c8c3\nFaulting module name: coml2.dll, version: 10.0.17134.407, time stamp: 0xaad4943a\nException code: 0xc0000005\nFault offset: 0x0000000000016521\nFaulting process id: 0x100788\nFaulting application start time: 0x01d48cb0460efe6f\nFaulting application path: C:\\Program Files\\Microsoft Office\\root\\Office16\\EXCEL.EXE\nFaulting module path: C:\\WINDOWS\\System32\\coml2.dll\nReport Id: 3ff6565e-7c37-4733-87fd-7e5ab12cba1f\nFaulting package full name: \nFaulting package-relative application ID: \n</code></pre>\n\n<p>Things I've tried:</p>\n\n<ol>\n<li>Running in compatibility mode (Windows 7 and 8) </li>\n<li>Moving the file from a network location to my Downloads folder on the local machine</li>\n<li>Casting <code>container</code> as an <code>MSForms.frame</code> instead of an <code>Object</code></li>\n<li>Restarting the computer and Excel</li>\n<li>Running Excel in safe mode: <code>excel.exe /s</code></li>\n<li>Changing <code>container</code> from <strong>Private</strong> to <strong>Public</strong> and referencing <code>Me.container</code></li>\n<li>Tried each (and every) method provided by Microsoft <a href=\"https://stackoverflow.com/questions/53637199/excel-crashing-without-error-when-form-controls-add-is-called\">here</a></li>\n<li>Installed the <a href=\"https://support.microsoft.com/en-us/help/4011128/may-23-2018-update-for-office-2016-kb4011128\" rel=\"nofollow noreferrer\">KB4011128</a> update from Microsoft. <em>It detected an issue and \"fixed it\" but the problem remains</em></li>\n<li>Redditors <a href=\"https://www.reddit.com/r/sysadmin/comments/8cx7x1/april_office_updates_kb_4018319office_2016_and_kb/\" rel=\"nofollow noreferrer\">suggested</a> that uninstalling update 4018319 could fix the issue but I don't have it installed.</li>\n<li>Referencing the <code>main</code> form using a singleton module instead of <code>main.thumbnails</code></li>\n<li>Creating the frame on the <code>main</code> form code-behind</li>\n<li>Referencing the created frame from a singleton module</li>\n<li>Created a new <code>.xlsm</code> file, copied over all class, modules, and forms (except <code>main</code>). Created <code>main</code> from scratch</li>\n<li>Added a newly created <code>CommandButton</code> to the frame <strong>(this worked...)</strong></li>\n<li>Changed the Id of <code>thumbs</code> frame to a bunch of random letters</li>\n</ol>\n"}, {"tags": ["excel", "vba", "excel-formula", "colors", "vlookup"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544029545, "post_id": 53637150, "comment_id": 94134369, "body": "You&#39;d need to do this with VBA - a formula can&#39;t copy a color.  Have you tried some VBA to solve this?  It&#39;s not really clear from your screenshot where the input is, or what determines which cells on the row are colored."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1544080908, "last_edit_date": 1544080908, "creation_date": 1544044917, "answer_id": 53640952, "question_id": 53637150, "link": "https://stackoverflow.com/questions/53637150/vlookup-cell-background-colour-from-another-workbook-vba/53640952#53640952", "title": "Vlookup cell background colour from another workbook VBA", "body": "<p>I'm not sure exactly what you're doing but since i have this code anyway...</p>\n\n<pre><code>Function Tester(rngLookup As Range, v)\n    Dim c As Range, f As Range, clr As Long\n\n    Set c = Application.ThisCell '&lt;&lt; the cell with the formula\n    Set f = rngLookup.Find(v, lookat:=xlWhole)\n    If Not f Is Nothing Then\n        clr = f.Interior.Color\n    Else\n        clr = vbWhite\n    End If\n    'change the background for the cell with the formula\n    Application.Evaluate \"ChangeColor(\"\"\" &amp; c.Parent.Name &amp; \"\"\",\"\"\" &amp; c.Address() &amp; \"\"\",\" &amp; clr &amp; \")\"\n    Tester = v 'or whatever is appropriate...\nEnd Function\n\nSub ChangeColor(sht As String, addr As String, clr As Long)\n    ThisWorkbook.Sheets(sht).Range(addr).Interior.Color = clr\nEnd Sub\n</code></pre>\n\n<p>Example usage (with show formulas enabled):</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ayqeb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ayqeb.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10750641, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215281723654507/picture?type=large", "display_name": "Ollie Smart", "link": "https://stackoverflow.com/users/10750641/ollie-smart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581745574, "creation_date": 1544028852, "last_edit_date": 1581745574, "question_id": 53637150, "link": "https://stackoverflow.com/questions/53637150/vlookup-cell-background-colour-from-another-workbook-vba", "title": "Vlookup cell background colour from another workbook VBA", "body": "<p>So I have a Gant chart like workbook that has a unique number for each worker (representing a row) then I want to retrieve the cell color from this row and a specified column, much like a normal vlookup. see image below. </p>\n\n<p><a href=\"https://i.stack.imgur.com/IZYrY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IZYrY.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want this green to be picked up in the cell corresponding to the day i.e. the column and the row i.e. Job no.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 772, "user_id": 3445378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f48a9ba697fd1462d2852a044c29402?s=128&d=identicon&r=PG&f=1", "display_name": "testo", "link": "https://stackoverflow.com/users/3445378/testo"}, "is_accepted": false, "score": 2, "last_activity_date": 1544028992, "creation_date": 1544028992, "answer_id": 53637193, "question_id": 53637137, "link": "https://stackoverflow.com/questions/53637137/how-can-i-bind-an-sub-to-an-event-by-code/53637193#53637193", "title": "How can I bind an Sub to an Event by Code?", "body": "<p>Sorry, I answer by myself. After finishing the question I saw my problem:</p>\n\n<p><code>[event procedure]</code> is just a String. Set it and the sub with the correct name is connected.</p>\n\n<blockquote>\n<pre><code>MyForm.OnClick = \"[event procedure]\"\n</code></pre>\n</blockquote>\n\n<p>After that <code>Form_OnClick()</code> is used as Eventhandler.</p>\n"}], "owner": {"reputation": 772, "user_id": 3445378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f48a9ba697fd1462d2852a044c29402?s=128&d=identicon&r=PG&f=1", "display_name": "testo", "link": "https://stackoverflow.com/users/3445378/testo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544028992, "creation_date": 1544028825, "question_id": 53637137, "link": "https://stackoverflow.com/questions/53637137/how-can-i-bind-an-sub-to-an-event-by-code", "title": "How can I bind an Sub to an Event by Code?", "body": "<p>I have a simple Form. The form contains an <code>OnClick</code>-Event. When I print its value, I get <code>[Event Procedure]</code> as result.</p>\n\n<p>How can I set this <code>event procedure</code> by vba-code?</p>\n\n<p>I mean not bind a expression that uses a function.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1544028961, "post_id": 53637041, "comment_id": 94134022, "body": "&quot;But the code is not working&quot; is not very specific. Can you please <a href=\"https://stackoverflow.com/posts/53637041/edit\">edit your question</a> to let us know what the expected result is and how your code fails to achieve it? <a href=\"https://stackoverflow.com/help/how-to-ask\">reading this</a> may  be useful"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544029758, "post_id": 53637200, "comment_id": 94134519, "body": "Technically Ok in this case since the event handler only updates Column I, and changes in that column are filtered out by the <code>Intersect()</code>.  For sure though you need events turned back on ;-) - preferrably you have an error handler to ensure this happens in case anything goes wrong."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1544029030, "creation_date": 1544029030, "answer_id": 53637200, "question_id": 53637041, "link": "https://stackoverflow.com/questions/53637041/excel-vba-change-cell-value-dynamically-based-on-the-value-in-two-columns/53637200#53637200", "title": "Excel VBA - Change cell value dynamically based on the value in two columns", "body": "<p>As soon as you execute Range(\"I\" &amp; r) =  you fire the worksheet change event again, and again and again . If you want to change cells in a change event you need to turn the change event off within the routine</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nApplication.EnableEvents = false\n</code></pre>\n\n<p>and then turn it on at the end</p>\n\n<pre><code>Application.EnableEvents = true\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10715294, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6O7tFWLLcG4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jl-5uorAz9bv6DrERxrp2E1FyBcA/mo/photo.jpg?sz=128", "display_name": "Sundaram Kanagaraj", "link": "https://stackoverflow.com/users/10715294/sundaram-kanagaraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544029831, "creation_date": 1544028532, "last_edit_date": 1544028978, "question_id": 53637041, "link": "https://stackoverflow.com/questions/53637041/excel-vba-change-cell-value-dynamically-based-on-the-value-in-two-columns", "title": "Excel VBA - Change cell value dynamically based on the value in two columns", "body": "<p>i worte a vba code to change cell value dynamically based on the values entered in two columns. But the code is not working.</p>\n\n<p>Kindly anyone help me to get to know the process.</p>\n\n<p>Thanks</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rng As Range\nDim r As Long\n\nIf Not Intersect(Range(\"G:H\"), Target) Is Nothing Then\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n    For Each rng In Intersect(Range(\"G:H\"), Target)\n        r = rng.Row\n        If Range(\"G\" &amp; r) = 5 And Range(\"H\" &amp; r) = \"A\" Then\n            Range(\"I\" &amp; r) = \"M\"\n            Range(\"I\" &amp; r).Interior.ColorIndex = 3\n        ElseIf Range(\"G\" &amp; r) = 5 And Range(\"H\" &amp; r) = \"B\" Then\n            Range(\"I\" &amp; r) = \"H\"\n            Range(\"I\" &amp; r).Interior.ColorIndex = 4\n        Else\n            Range(\"I\" &amp; r).Interior.ColorIndex = 0                                  \n        End If\n    Next rng\nEnd if\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "find", "matching"], "comments": [{"owner": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "edited": false, "score": 0, "creation_date": 1544028202, "post_id": 53636827, "comment_id": 94133605, "body": "can you post the code that doesn&#39;t seem to work? Also, does your data have any gaps in the C4 to Z4 range?"}, {"owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "edited": false, "score": 0, "creation_date": 1544028225, "post_id": 53636827, "comment_id": 94133620, "body": "Welcome to Stack Overflow! You will find that you will have a better experience if you take moment to take the <a href=\"https://stackoverflow.com/tour\">Stack Overflow tour</a>. You can also read about asking a <a href=\"https://stackoverflow.com/help/how-to-ask\">good question</a>.  If you follow the norms of the Stack Overflow community and approach it with an attitude of helping others too, it will serve you well."}, {"owner": {"reputation": 3, "user_id": 10750474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iR87W4PPreU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iVDpxjEPUweVTDG3LcR-E0RzmYmw/mo/photo.jpg?sz=128", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/10750474/michael-kohl"}, "reply_to_user": {"reputation": 567, "user_id": 9221467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7617a21b1802c874e04be0db0f58ea0b?s=128&d=identicon&r=PG&f=1", "display_name": "SRT HellKitty", "link": "https://stackoverflow.com/users/9221467/srt-hellkitty"}, "edited": false, "score": 0, "creation_date": 1544181683, "post_id": 53636827, "comment_id": 94194475, "body": "Thank you @SRT HellKitty. It does not have a gap between C4 and Z4."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10750474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iR87W4PPreU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iVDpxjEPUweVTDG3LcR-E0RzmYmw/mo/photo.jpg?sz=128", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/10750474/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1544029849, "post_id": 53636985, "comment_id": 94134573, "body": "Thank you Harassed Dad. Your macro looks good. However, my Excel keeps crashing when I execute it. Maybe it doesnt stop at the end of the row."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 3, "user_id": 10750474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iR87W4PPreU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iVDpxjEPUweVTDG3LcR-E0RzmYmw/mo/photo.jpg?sz=128", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/10750474/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1544030682, "post_id": 53636985, "comment_id": 94134980, "body": "use f8 to step through the code and see if you can see what line it crashes on - if the cells after the end of row 4 aren&#39;t empty it would continue till it fell off the end of the spreadsheet. Do you get an error message when it crashes?"}, {"owner": {"reputation": 3, "user_id": 10750474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iR87W4PPreU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iVDpxjEPUweVTDG3LcR-E0RzmYmw/mo/photo.jpg?sz=128", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/10750474/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1544181582, "post_id": 53636985, "comment_id": 94194418, "body": "It does not give me an error message @Harassed Dad. After playing around a little bit with it, it offsets the search correctly until a <code>where = what</code>. However, it just loops indefinitely. So the <code>where = &quot;&quot; </code>is never fullfilled. I tried with replacing a zero and looking for zero, but that also didnt work."}, {"owner": {"reputation": 3, "user_id": 10750474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iR87W4PPreU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iVDpxjEPUweVTDG3LcR-E0RzmYmw/mo/photo.jpg?sz=128", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/10750474/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1544184094, "post_id": 53636985, "comment_id": 94195710, "body": "Found a solution. Thank you @Harassed. I had to change to <code>Loop Until where = what</code> and add <code>Set found = where</code> after the loop. Do you know if it is possible to copy a specific number of cells in the <code>B</code> column, instead of all with <code>End(xlDown)</code>? Copying all makes Excel quite slow and typically the list of entries is &lt;100."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 3, "user_id": 10750474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iR87W4PPreU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iVDpxjEPUweVTDG3LcR-E0RzmYmw/mo/photo.jpg?sz=128", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/10750474/michael-kohl"}, "edited": false, "score": 0, "creation_date": 1544539299, "post_id": 53636985, "comment_id": 94306260, "body": "you can replace range(&quot;b5&quot;).end(xldown) with range(&quot;b20&quot;) or whatever to stop at a specific row"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1544028361, "creation_date": 1544028361, "answer_id": 53636985, "question_id": 53636827, "link": "https://stackoverflow.com/questions/53636827/vba-excel-macro-that-searches-a-row-for-a-certain-variable-value-from-specific/53636985#53636985", "title": "VBA Excel : Macro that searches a row for a certain variable value from specific cell and then copy&amp;pastes value to this column", "body": "<pre><code>Sub FindandCopy\nDim what as range\ndim where as range\ndim found as range\nset what = range(\"b4\")  'what we're looking for\nset where = range(\"c4\")  'start of search range\ndo\nif where = what then \n    set found = where  'that's where we found it\nelse\n set where = where.offset(0,1) 'otherwise keep looking\nend if\nloop until where = \"\"   'stop if blank\nif found = \"\" then  'we fell off the end\n      msgbox what &amp; \" not found \"\nelse\n      range(range(\"b5\"),range(\"b5\").end(xldown)).copy \n      found.offset(1,0).pastespecial xlpastevalues\nend if\nend sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10750474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iR87W4PPreU/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iVDpxjEPUweVTDG3LcR-E0RzmYmw/mo/photo.jpg?sz=128", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/10750474/michael-kohl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 53636985, "answer_count": 1, "score": 0, "last_activity_date": 1544028750, "creation_date": 1544027809, "last_edit_date": 1544028750, "question_id": 53636827, "link": "https://stackoverflow.com/questions/53636827/vba-excel-macro-that-searches-a-row-for-a-certain-variable-value-from-specific", "title": "VBA Excel : Macro that searches a row for a certain variable value from specific cell and then copy&amp;pastes value to this column", "body": "<p>I have done some VBA in the past but just cannot find a solution for this one.</p>\n\n<p>I am looking for a macro which searches cells C4 to Z4 (one infinite long row starting from C4) for a value (number) from cell B4 which changes weekly. If a match is found then copy&amp;pastes the values of cells B5 to B100 (one infinite long column starting from B5) into the correct column C to Z (from C5 etc., downwards).</p>\n\n<p>With correct column I mean the column where the macro finds the match between B4 and C4 to Z4. C4 to Z4 are non-identical.</p>\n\n<p>I searched long and hard and the nearest I could find is this:\n<a href=\"https://stackoverflow.com/questions/8706555/macro-that-looks-for-a-value-in-a-cell-then-paste-a-range-in-the-column-of-tha\">Macro that looks for a value in a cell &amp; then paste a range in the column of that cell. EXCEL 2007</a></p>\n\n<p>However it does not work for me. The solution in that thread says that the matching cell values should be in a date format. I recontructed all of this, but even with dates instead of numbers it does not work. The macro always gives the message according to the VBA line</p>\n\n<p>MsgBox \"Date Column for \" &amp; CStr([B2].Value) &amp; \" Not Found\"</p>\n\n<p>So it does not find any matches for me, even I run it with identical dates in the matching cells. (I changed of course this macro to my cell locations)</p>\n\n<p>This forum is my final try :)</p>\n\n<p>I have following code which does not work:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim ws As Worksheet\nDim rSrc As Range\nDim rDst As Range\nDim cl As Range\nDim dat As Variant\n\nSet ws = ActiveSheet\n\n' Get the Source range\nSet rSrc = ws.Range([B5], ws.Columns(2).Cells(ws.Rows.Count, 1).End(xlUp))\ndat = rSrc\n\n' Find the Destination column and copy data\nSet rDst = ws.Range([D4], ws.Rows(1).Cells(1, ws.Columns.Count).End(xlToLeft))\nSet cl = rDst.Find(What:=[B4], _\n  After:=rDst.Cells(1, 1), _\n  LookIn:=xlValues, _\n  LookAt:=xlWhole, _\n  SearchOrder:=xlByRows, _\n  SearchDirection:=xlNext)\nIf cl Is Nothing Then\n    MsgBox \"Column for \" &amp; CStr([B4].Value) &amp; \" Not Found\"\nElse\n    Set rDst = cl.Offset(1, 0).Resize(UBound(dat, 1), 1)\n    rDst = dat\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Thank you.</p>\n\n<p>Regards</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2013", "ms-access-2016"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1544028559, "post_id": 53636659, "comment_id": 94133800, "body": "It might be much simpler just to create a new record. Why close and reopen? I&#39;ve never seen that."}, {"owner": {"reputation": 11, "user_id": 2096185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85efafb744e0f450259c8f1937ffe3a?s=128&d=identicon&r=PG", "display_name": "user2096185", "link": "https://stackoverflow.com/users/2096185/user2096185"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1544029173, "post_id": 53636659, "comment_id": 94134149, "body": "I didn&#39;t write this code, so I&#39;m going off the previous developer on this, but I asked the same question. That was how it was originally working. This form has a huge amount of dropdown lists on it, each of them will be filled in every time. After the database was split, they found that after you entered one record you were very close to hitting the limit of the amount of open tables allowed and would receive the error &quot;cannot open any more databases&quot;, which caused a large amount of issues. So they wrote this function to invisibly close and reopen the form to close those connections."}, {"owner": {"reputation": 11, "user_id": 2096185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85efafb744e0f450259c8f1937ffe3a?s=128&d=identicon&r=PG", "display_name": "user2096185", "link": "https://stackoverflow.com/users/2096185/user2096185"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1544029219, "post_id": 53636659, "comment_id": 94134175, "body": "If there is a simpler way to close off all the previous connections and just generate a new record, then that would be an ideal way to handle this."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1544035075, "post_id": 53636659, "comment_id": 94137043, "body": "There certainly is, but modifying an application out of context is way too broad for this forum. To be honest, it sounds like a several-days paid job for a skilled developer."}, {"owner": {"reputation": 11, "user_id": 2096185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85efafb744e0f450259c8f1937ffe3a?s=128&d=identicon&r=PG", "display_name": "user2096185", "link": "https://stackoverflow.com/users/2096185/user2096185"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1544035382, "post_id": 53636659, "comment_id": 94137179, "body": "I understand that. I was just explaining the reasoning for the function, not looking for a way to it to be changed. I&#39;m really just looking to see if there is anything in the function that would be locking the record to rule out this function as the reason for the error."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1544040412, "post_id": 53636659, "comment_id": 94139343, "body": "Created_Date  could possibly use textbox DefaultValue property set to Now() instead of code to populate. Have you confirmed that Refresh actually commits record to table? A better approach may be: <code>If Me.1IPCOR_Sform.Form.Dirty Then Me.1IPCOR_Sform.Form.Dirty = False</code>"}, {"owner": {"reputation": 11, "user_id": 2096185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85efafb744e0f450259c8f1937ffe3a?s=128&d=identicon&r=PG", "display_name": "user2096185", "link": "https://stackoverflow.com/users/2096185/user2096185"}, "edited": false, "score": 0, "creation_date": 1544055239, "post_id": 53636659, "comment_id": 94144771, "body": "Thank you I&#39;ll have a look at this tomorrow, but the refresh seems to be inaerting the record, yes."}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "edited": false, "score": 0, "creation_date": 1544069529, "post_id": 53636659, "comment_id": 94147906, "body": "I don&#39;t see any issues with this code related to locking. I would check other places. First of all, check that all opened recordsets are properly closed even in case of errors. The problem with too many open connections may be related to not closed recordsets"}], "owner": {"reputation": 11, "user_id": 2096185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85efafb744e0f450259c8f1937ffe3a?s=128&d=identicon&r=PG", "display_name": "user2096185", "link": "https://stackoverflow.com/users/2096185/user2096185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 561, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544039097, "creation_date": 1544027279, "last_edit_date": 1544039097, "question_id": 53636659, "link": "https://stackoverflow.com/questions/53636659/could-not-update-currently-locked-error-caused-by-vba", "title": "&quot;Could not update; currently locked&quot; Error caused by VBA?", "body": "<p>I have inherited and MS Access application. There are many issues that could be changed within the application but unfortunately it was rushed to production and major redesign changes cannot be made.</p>\n\n<p>I have split and given FEs to 6 different users. for the most part there does not seem to be many issues with this, however some users are getting the error \"Could not update; currently locked\" intermittently when they create a new record on one of the forms and enter into a subform to insert information into it. The main form contains a customers details and the subform contains information on the product that they have. </p>\n\n<p>Optimistic locking being used throughout the application and this doesn't seem to be occurring because two users are updating a single record, as they will basically never being looking at the same records.</p>\n\n<p>I think that the issue may be code that is being used to generate that customer ID. The form where the error occurs is (1_1)Customer Subform. There is a subform within that subform called (1_1_1)Product Subform. These are linked by a PID, which is present in each subform. When the mouse is clicked within the product subform, the application hangs for a few seconds before giving the error \"Could not update; currently locked\". </p>\n\n<p>There is a button on the form that does the following:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub NewCustomerRecord_Click()\n\nDoCmd.Close acForm, \"1Main_IPCOR\"\nDoCmd.OpenForm \"1Main_IPCOR\", acNormal, \"\", \"\", , acNormal\n\nForms![1Main_IPCOR]![1IPCOR_Sform]![(1_1)Customer Subform].SetFocus\nDoCmd.GoToRecord , , acNewRec\n\nForms![1Main_IPCOR]![1IPCOR_Sform]![CREATED_DATE] = Now()\n\nForms![1Main_IPCOR]![1IPCOR_Sform]![P_ID] = NewP_ID()\nForms![1Main_IPCOR]![1IPCOR_Sform].Form.Refresh\n\nExit_New_record_Click:\nExit Sub\n\nErr_New_record_Click:\nMsgBox Err.Description\nResume Exit_New_record_Click\nEnd Sub\n\n\nPrivate Function NewP_ID() As String\nDim strTemplate As String\n\nstrTemplate = Replace(\"CUSXX\", \"XX\", Right(Year(Date), 2))\nNewP_ID = Nz(DMax(Expr:=\"Right([P_ID], 5)\", _\n                Domain:=\"[(1_1)_Customer]\", _\n                Criteria:=\"[P_ID] Like '\" &amp; strTemplate &amp; \"*'\"), \"0\")\nNewP_ID = strTemplate &amp; Format(Val(NewP_ID) + 1, \"00000\")\n    'Exit function now after successful incrementing or after error message\n\nExit_P_ID:\nExit Function\n\n   'If an error occurred, display a message, then go to Exit statement\nP_ID_Err:\n    MsgBox \"Error \" &amp; Err &amp; \": \" &amp; Error$\n\n    Resume Exit_P_ID\nEnd Function\n</code></pre>\n\n<p>What the function is doing is closing the main form and reopening it with a new ID so a new customer can be added.</p>\n\n<p>Is there anything within the method that may be causing the record to be locked, and never unlocked?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 2160123, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dc7c9793b0e213d40151d63f9a40dc4f?s=128&d=identicon&r=PG&f=1", "display_name": "Jaden Ng", "link": "https://stackoverflow.com/users/2160123/jaden-ng"}, "edited": false, "score": 0, "creation_date": 1544058687, "post_id": 53636651, "comment_id": 94145559, "body": "Thank you for the idea. I can leverage the algorithm for other purposes. :)"}], "tags": [], "owner": {"reputation": 725, "user_id": 9822003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed3d2cb4e0198690dd921f61e42937c?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Yahiaoui Martinez", "link": "https://stackoverflow.com/users/9822003/alex-yahiaoui-martinez"}, "is_accepted": false, "score": 1, "last_activity_date": 1544027259, "creation_date": 1544027259, "answer_id": 53636651, "question_id": 53636506, "link": "https://stackoverflow.com/questions/53636506/excel-offset-formula-to-get-data-from-horizontal-to-vertical/53636651#53636651", "title": "Excel OFFSET formula to get data from horizontal to vertical", "body": "<p>try this ! Change the range() if you need !</p>\n\n<pre><code>Sub macro()\n\n'Variable declaration\nDim tbl As Range\nDim col1 As Variant\n\ncol1 = Array(1, 3, 5, 7)\nSet tbl = Range(\"A1:A4\")\n\nWith tbl\n    .Value = Application.Transpose(col1)\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 2160123, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dc7c9793b0e213d40151d63f9a40dc4f?s=128&d=identicon&r=PG&f=1", "display_name": "Jaden Ng", "link": "https://stackoverflow.com/users/2160123/jaden-ng"}, "edited": false, "score": 0, "creation_date": 1544058647, "post_id": 53636823, "comment_id": 94145554, "body": "Thank you very much. It can achieve what I wanted. :)"}], "tags": [], "owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "is_accepted": true, "score": 1, "last_activity_date": 1544027792, "creation_date": 1544027792, "answer_id": 53636823, "question_id": 53636506, "link": "https://stackoverflow.com/questions/53636506/excel-offset-formula-to-get-data-from-horizontal-to-vertical/53636823#53636823", "title": "Excel OFFSET formula to get data from horizontal to vertical", "body": "<p>Enter <code>=OFFSET($H$2,0,3*(ROW()-6))</code> in E6 and fill down to achieve the result shown in your image.</p>\n"}], "owner": {"reputation": 141, "user_id": 2160123, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dc7c9793b0e213d40151d63f9a40dc4f?s=128&d=identicon&r=PG&f=1", "display_name": "Jaden Ng", "link": "https://stackoverflow.com/users/2160123/jaden-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 53636823, "answer_count": 2, "score": 1, "last_activity_date": 1581745596, "creation_date": 1544026785, "last_edit_date": 1581745596, "question_id": 53636506, "link": "https://stackoverflow.com/questions/53636506/excel-offset-formula-to-get-data-from-horizontal-to-vertical", "title": "Excel OFFSET formula to get data from horizontal to vertical", "body": "<p><a href=\"https://i.stack.imgur.com/IN5BN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IN5BN.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to reference data from Horizontal and output to vertical cell without space in between. May I know how should I use OFFSET formula to achieve the desire output in vertical?</p>\n"}, {"tags": ["vba", "controls", "user-defined-functions", "commandbar"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544027948, "post_id": 53636232, "comment_id": 94133462, "body": "Is the cell that you&#39;re attempting click in a row less than 83 and in a column less than 14?"}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1544031138, "post_id": 53636232, "comment_id": 94135174, "body": "Yes. I am clicking cell C8, which has data validation list = Yes, No. I have stepped through the code and it goes all the way down into that if block, adds the control, the caption, and the OnAction properties without an issue"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1544031919, "post_id": 53636232, "comment_id": 94135544, "body": "The problem is that that there are <b>two</b> CELL menus: 1) in Normal layout and 2) Page layout. Switching to either layout affects menu visibility."}, {"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "edited": false, "score": 0, "creation_date": 1544033098, "post_id": 53636232, "comment_id": 94136112, "body": "I was using the page break view in this worksheet. How do I know which cell menu I&#39;m dealing with? Do they have different scopes? Even stranger, now I am debugging and I added a watch across all modules and procedures for Application.CommandBars(&quot;cell&quot;).Controls.Count and for some incredible reason, simply adding another watch to the list for Application.CommandBars(&quot;cell&quot;).Controls.Count while in break mode caused the count to increase by 1. The count also goes up by one each time I press F8 to step to the next line, even when an error is thrown."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "edited": false, "score": 0, "creation_date": 1544041666, "post_id": 53638330, "comment_id": 94139894, "body": "That solved it. Thank you for the insight! I had no idea there were two menus. Although this still does not explain why I was seeing variables&#39; properties change every time I added a watch to the list. Never seen anything like that in my life"}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": true, "score": 1, "last_activity_date": 1544033451, "creation_date": 1544033451, "answer_id": 53638330, "question_id": 53636232, "link": "https://stackoverflow.com/questions/53636232/vba-custom-right-click-menu-option-isnt-visible/53638330#53638330", "title": "VBA: Custom Right Click Menu Option Isn&#39;t Visible", "body": "<p>The problem is that that there are two CELL menus: 1) in Normal layout and 2) Page layout. Switching to either layout affects menu visibility - this means that if you create menu in Normal layout, you won't see it in Page layout - and vice versa.</p>\n\n<p>You can ensure that there are two CELL menus by running the following code:</p>\n\n<pre><code>Sub ListCommandBars()\n    Dim r%, cmb As CommandBar\n    For Each cmb In CommandBars\n        r = r + 1\n        Cells(r, 1) = cmb.Name\n    Next\n    [A1].CurrentRegion.Sort Key1:=[A1]\nEnd Sub\n</code></pre>\n\n<p>To differentiate one from another, you can use their <code>Index</code> property which returns internal number. The real problem is that these numbers are different from version to version. I advise you to add your menu in both layouts. For it you need to iterate over all command bars filtering CELL menu:</p>\n\n<pre><code>Sub AddMenu2()\n    Dim cmb As CommandBar\n    For Each cmb In CommandBars\n        If cmb.Name = \"Cell\" Then\n            '// Add your menu here\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4502102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/728556994/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/4502102/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 53638330, "answer_count": 1, "score": 0, "last_activity_date": 1544033710, "creation_date": 1544025755, "last_edit_date": 1544033710, "question_id": 53636232, "link": "https://stackoverflow.com/questions/53636232/vba-custom-right-click-menu-option-isnt-visible", "title": "VBA: Custom Right Click Menu Option Isn&#39;t Visible", "body": "<p>I am trying to create an option that allows the user to remove data validation from a cell via the right click menu option. So far, the code is compiling and executing without errors. It is succesfully adding the custom control to the collection Commandbars(\"cell\").Controls. It also has the correct tag and the correct OnAction value. But for some reason it is not appearing in the right click menu. I copied and pasted this code from another project I did, and it still runs fine in the other excel workbook. All I changed was the caption and the OnAction strings. I am baffled by this. Any help is greatly appreciated. Code below.</p>\n\n<p>[EDIT]: I am debugging and I added a watch across all modules and procedures for Application.CommandBars(\"cell\").Controls.Count and for some incredible reason, simply adding another identical watch to the list, for Application.CommandBars(\"cell\").Controls.Count, in break mode, caused the count to increase by 1. </p>\n\n<p>The count also goes up by one each time I press F8 to step to the next line, even when an error is thrown due to the objControl object not being initialized for some reason. See screenshot below to see what I saw during debugging. The highlighted yellow line is throwing an error for an object that hasn't been initialized yet, and each time I try to execute that line, the Count increases by 1.</p>\n\n<p>[EDIT 2]: Apparently adding a watch for literally anything, even while in break mode, causes the count to increase by 1. I have no idea how or why.</p>\n\n<pre><code>Private Sub Worksheet_BeforeRightClick(ByVal Target As Range, Cancel As Boolean)\nDim objControl As Object, sum As Double, vCell As Variant, fieldtype As Integer\nDim tagArr() As String, i As Integer\nIf Target.Count &gt; 1 And Target.MergeCells = False Then GoTo lbl_Exit\nIf Intersect(Target, Cells.SpecialCells(xlCellTypeAllValidation)) Is Nothing \nThen GoTo lbl_Exit\nReDim tagArr(0)\ntagArr(0) = \"brccm\"\ni = 0\nFor i = 0 To UBound(tagArr)\n    For Each objControl In Application.CommandBars(\"cell\").Controls\n        If objControl.Tag = \"\" Then objControl.Delete\n        If tagArr(i) = objControl.Tag Then\n            objControl.Delete\n            GoTo lbl_Deleted\n        End If\nlbl_Next:\n    Next objControl\nlbl_Deleted:\nNext i\ni = 0\nIf Target.row &lt; 83 And Target.Column &lt; 14 Then 'the active area for the order form\n    'If Not Intersect(ActiveSheet.Cells.SpecialCells(xlCellTypeAllValidation), Target) Is Nothing Then 'if cell has any validation settings at all\n        capture_target_range Target\n        'For i = 0 To UBound(tagArr)\n        With Application.CommandBars(\"cell\").Controls.Add(Type:=msoControlButton, before:=1, temporary:=True)\n            .Tag = tagArr(0)\n            .Caption = \"Clear data validation restrictions from cell\"\n            .OnAction = \"'RightClick_ClearValidation'\"\n        End With\nEnd If\nExit Sub\nlbl_Exit:\nOn Error Resume Next\ni = 0\nFor Each objControl In Application.CommandBars(\"cell\").Controls\n    For i = 0 To UBound(tagArr)\n        If objControl.Tag = tagArr(i) Then objControl.Delete\n    Next i\nNext objControl\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Vkmkq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vkmkq.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook", "outlook-addin", "excel-2013"], "comments": [{"owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "edited": false, "score": 0, "creation_date": 1544074579, "post_id": 53635954, "comment_id": 94149122, "body": "You could try to change registry like this: HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\office\\15.0\\ou&zwnj;&#8203;tlook\\resiliency\\add&zwnj;&#8203;inlist RG_SZ= add-in name Value = 1 For more information, please refer to this link: <a href=\"https://www.slipstick.com/outlook/always-load-an-outlook-addin/\" rel=\"nofollow noreferrer\">slipstick.com/outlook/always-load-an-outlook-addin</a>"}, {"owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "reply_to_user": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "edited": false, "score": 0, "creation_date": 1544434617, "post_id": 53635954, "comment_id": 94260418, "body": "Thanks @AlinaLi but I am unable to alter Registry keys due to Company policy. The AddIn is available to all users and works OK manually. I need to find a way, using VBA, to launch it."}], "owner": {"reputation": 337, "user_id": 4374280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001915578210/picture?type=large", "display_name": "Jason Stallard", "link": "https://stackoverflow.com/users/4374280/jason-stallard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544024823, "creation_date": 1544024823, "question_id": 53635954, "link": "https://stackoverflow.com/questions/53635954/call-webex-outlook-addin-from-excel-2013", "title": "Call WebEx Outlook AddIn from Excel 2013", "body": "<p>I'm automating most of an Outlook calendar invite but struggling with calling a COM Addin. I've figured out the ProgID to specify it correctly but can't see a way to list the available Objects.</p>\n\n<pre><code>Dim OutlookApp As Object, OutlookInvite As Object\nDim addIn As COMAddIn, automationObject As Object\nSet OutlookApp = GetObject(class:=\"Outlook.Application\") \nSDM = Sheets(\"Sheet1\").Range(\"F2\").Value\nSet OutlookInvite = OutlookApp.CreateItem(1)\nWith OutlookInvite\n    .MeetingStatus = 1\n    .Subject = \"foo\"\n    .Body = \"bar\"\n    .Recipients.Add SDM\n    .Start = Now()\n    .Duration = 30\n    .BusyStatus = 2\n    .ReminderMinutesBeforeStart = 15\n    .ReminderSet = True\n    Set addIn = OutlookApp.COMAddIns(\"WebExOI.Addin\")\n    Set automationObject = addIn.Object\n    automationObject.AddPersonalRoom\n    .Display\nEnd With\n</code></pre>\n\n<p>The AddPersonalRoom is just my best guess but it does nothing. I'm missing a trick.</p>\n"}, {"tags": ["arrays", "excel", "vba", "class"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1544024783, "post_id": 53635861, "comment_id": 94131545, "body": "If you&#39;re working with an array of 30-40 items and writing to the sheet is terribly slow, something is very wrong - that should be instantaneous. The choice of a class or an array in this case is only going to be an implementation decision."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1544024896, "post_id": 53635861, "comment_id": 94131604, "body": "Looping through the array one element at a time and writing that to a cell in the workbook will be slow (for some values of slow). Writing the entire array to a range in one statement should be quite speedy."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544025116, "post_id": 53635861, "comment_id": 94131756, "body": "Impossible to answer, but I can assure you that well-written object-oriented VBA code has absolutely no inherent performance problems. If your code works but you need help refactoring it towards a more object-oriented approach, or identifying &amp; fixing performance issues, consider posting it on <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1544180821, "post_id": 53635861, "comment_id": 94194018, "body": "I think that array would be the most quick solution. Even VBA-Collection uses probably an array internally. But array is fixed size structure, to add new elements to it, new array needs to be created. Class is not relevant to performance, class can be done in a bad way, so performance will be bad or it can be done in a good way. So if you want to do it in object oriented way, use classes and VBA-Collection, if you do it well then the performance of VBA-Collection will be ok, I hope :)."}], "owner": {"reputation": 33, "user_id": 9493835, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brandon Lewallen", "link": "https://stackoverflow.com/users/9493835/brandon-lewallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544024545, "creation_date": 1544024545, "question_id": 53635861, "link": "https://stackoverflow.com/questions/53635861/which-is-better-in-performance-a-dynamic-array-determined-at-run-time-vs-a-clas", "title": "Which is better in performance: a dynamic array determined at run-time vs a class structure in VBA?", "body": "<p>I have created a spreadsheet userform that allows users to input information, do surface level data verification, and other things. The problem that I run into is because part of it involves adding all items involved in their submission (the input this is used for could be related to one or more items, sometimes in the higher 30's) I had to create an array and have the array write to the new sheet. This is terribly slow.</p>\n\n<p>I've been learning about classes and thinking that they may be able to provide a sufficient alternative to an array since each item has the exact same information needed. (QTY, UOM, Type, etc) I was thinking of doing 2 classes, one where I have the member class for the item and another where it's the collection and it composes the members objects. </p>\n\n<p>My question is if the performance of doing this would be better than using an array. Are arrays generally the better way of handling collections of data that need to be inputted and outputted to a sheet?</p>\n"}, {"tags": ["excel", "vba", "replace", "special-characters", "vbe"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "edited": false, "score": 0, "creation_date": 1544107330, "post_id": 53636027, "comment_id": 94166073, "body": "i will try that option, I found a workaround: I created a loop in VBA that takes each time 1 character and deletes it if it ain&#39;t one of which i want"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1544025030, "creation_date": 1544025030, "answer_id": 53636027, "question_id": 53635472, "link": "https://stackoverflow.com/questions/53635472/editor-shows-unseen-question-marks/53636027#53636027", "title": "Editor shows unseen question marks", "body": "<p>This is Ghost character.</p>\n\n<p>Copying a character from sheet's cell and replacing it with Find In Replace, insert the Finder into the corresponding character, do not type in Replace, and the Replace All will remove that character.</p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1544107659, "creation_date": 1544107659, "answer_id": 53653951, "question_id": 53635472, "link": "https://stackoverflow.com/questions/53635472/editor-shows-unseen-question-marks/53653951#53653951", "title": "Editor shows unseen question marks", "body": "<p>You can identify this character using the Immediate pane in VBA, enter the query like:</p>\n\n<pre><code>?Asc(ActiveCell)\n</code></pre>\n\n<p>And that should return an integer value. Then, in your code you can do:</p>\n\n<pre><code>Const char_code As Long = 63 '&lt;-- Modify based on the output from Immediate window\nx = Replace(ActiveCell.Value, Chr(char_code), \"\")\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 9828454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Assaf", "link": "https://stackoverflow.com/users/9828454/assaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1547042834, "creation_date": 1544023287, "last_edit_date": 1547042834, "question_id": 53635472, "link": "https://stackoverflow.com/questions/53635472/editor-shows-unseen-question-marks", "title": "Editor shows unseen question marks", "body": "<p>On my Worksheet cell I see text I want, but in the editor it shows question marks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ymRcL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymRcL.png\" alt=\"Pic\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1544022643, "post_id": 53635182, "comment_id": 94130227, "body": "<a href=\"https://stackoverflow.com/help/how-to-ask\">Okay</a>. <a href=\"https://stackoverflow.com/help/mcve\">What have you tried</a>?"}, {"owner": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544023064, "post_id": 53635182, "comment_id": 94130481, "body": "Sheets(&quot;sheet1&quot;).Range(&quot;A1:L50000&quot;).Copy  With Sheets(&quot;Sheet2&quot;).Range(&quot;A1&quot;)     .Cells.PasteSpecial xlPasteColumnWidths  End With"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544023666, "post_id": 53635182, "comment_id": 94130838, "body": "That code simply is pasting the column formatting. What are you wanting to copy? The headers too?"}, {"owner": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544023759, "post_id": 53635182, "comment_id": 94130893, "body": "yes, thats were I m stuck. Idk how to copy only the headings of a sheet into all the other sheets in a workbook."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1544024228, "post_id": 53635182, "comment_id": 94131228, "body": "<code>Worksheets(&quot;Sheet1&quot;).Range(&quot;A1:F1&quot;).Copy Worksheets(&quot;NewSheet&quot;).Range(&quot;A1:F1&quot;)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "edited": false, "score": 0, "creation_date": 1547128597, "post_id": 53637661, "comment_id": 95091556, "body": "I have 10 sheets in that workbook, I will be creating 25more sheets. I m trying to automate the headings of the sheets. So that I dont want to copy paste the same headings in the remaining sheets. Do I need to record the macro and copy paste your code , or how does i shoudl proceed with that. Please help me"}, {"owner": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "edited": false, "score": 0, "creation_date": 1547128840, "post_id": 53637661, "comment_id": 95091714, "body": "if i try running this code, it says, compile error: invalid outside procedure"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "edited": false, "score": 0, "creation_date": 1547145478, "post_id": 53637661, "comment_id": 95101344, "body": "Please clarify; in your question comments you stated &quot;to copy only the headings of a sheet into all the other sheets&quot; but in today&#39;s comments you stated &quot;I dont want to copy paste the same headings in the remaining sheets&quot;. What do you need help with? Also, if you don&#39;t place the above code inside <code>Sub Test()</code> and <code>End Sub</code> you will get that error.There are plenty of free online tutorials that you can go to and learn basic vba scripting. Do a Google search for &quot;excel vba tutorial&quot;."}, {"owner": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "edited": false, "score": 0, "creation_date": 1547150098, "post_id": 53637661, "comment_id": 95103537, "body": "hi Gmalc. u misunderstood my previous comment. what i meant is..I badly want to automate the copying of heading using macro..so that I dnt need to copy them manually ( ctrl+c, ctrl+v)."}, {"owner": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "edited": false, "score": 0, "creation_date": 1548337977, "post_id": 53637661, "comment_id": 95511836, "body": "hi Gmalc ,could you please tell me.. if i have something like this { ws1.Range(&quot;A1:L1, A2:L2&quot;).Copy } now how will i paste a2:l2 in the a2 of the new sheets"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "edited": false, "score": 0, "creation_date": 1548342986, "post_id": 53637661, "comment_id": 95514956, "body": "If you are just asking how to copy paste the header values (only) from sheet ws1 to ws2; the basic code would be `ws1.Range(&quot;A1:L2&quot;).Copy wsX.Range(&quot;A1&quot;).PasteSpecial Paste:=xlPasteValues&#39;"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1547211708, "last_edit_date": 1547211708, "creation_date": 1544030667, "answer_id": 53637661, "question_id": 53635182, "link": "https://stackoverflow.com/questions/53635182/automate-formatting-of-the-sheet-headings-to-the-all-the-other-sheet-using-macro/53637661#53637661", "title": "Automate formatting of the sheet headings to the all the other sheet using macro excel", "body": "<p>This is just to help if anyone else is looking for basic code to accomplish the task.</p>\n\n<pre><code>Sub CopyHeaderstosheets()\n\nDim wsX As Worksheet\nDim ws1 As Worksheet\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")\n\n    For Each wsX In ThisWorkbook.Worksheets\n        If wsX.Name &lt;&gt; \"Sheet1\" Then\n            ws1.Range(\"A1:F1\").Copy\n            With wsX\n                .Range(\"A1\").PasteSpecial Paste:=xlPasteAll\n\n                'Use this line if you don't want to paste the values\n                '.Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n\n                .Range(\"A1\").PasteSpecial Paste:=xlPasteColumnWidths\n                .Rows(1).RowHeight = ws1.Rows(1).RowHeight\n            End With\n        End If\n    Next wsX\n\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10670973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a5eae47ac195082935f437a0e6f5e90?s=128&d=identicon&r=PG&f=1", "display_name": "kutty", "link": "https://stackoverflow.com/users/10670973/kutty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53637661, "answer_count": 1, "score": -1, "last_activity_date": 1581745608, "creation_date": 1544022250, "last_edit_date": 1581745608, "question_id": 53635182, "link": "https://stackoverflow.com/questions/53635182/automate-formatting-of-the-sheet-headings-to-the-all-the-other-sheet-using-macro", "title": "Automate formatting of the sheet headings to the all the other sheet using macro excel", "body": "<p>As, I m new to macro. I want help in doing the below task.\n I want the heading formatting in a new sheet , but not copying it from another sheet, but by formatting the corresponding cells via the macro/script.</p>\n"}, {"tags": ["excel", "vba", "dll", "operating-system"], "owner": {"reputation": 3028, "user_id": 558619, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1618a853824f6ed866aa0fe4385b8687?s=128&d=identicon&r=PG", "display_name": "keynesiancross", "link": "https://stackoverflow.com/users/558619/keynesiancross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1544021234, "creation_date": 1544021234, "question_id": 53634879, "link": "https://stackoverflow.com/questions/53634879/excel-vba-dll-not-found-unless-placed-on-c", "title": "Excel VBA - DLL Not found unless placed on C:", "body": "<p>I have two DLLs that contain functions that I want to call from VBA, and normally these DLLs are held in a network location.  They both have functions declared in the exact same way:</p>\n\n<pre><code>Declare Function buildMatrix Lib \"T:\\_____Dllv2.dll\" (Variables) As Double\nDeclare Function DoSomethingElse Lib \"T:\\_____Dllv1.dll\" (Variables) As Double\n</code></pre>\n\n<p>Dllv1 works perfectly fine. Dllv2 throws a \"File Not Found\" error. </p>\n\n<p>When I put Dllv2 onto my C:/ through, it works perfectly fine!   I know it's not the security issue with network directory though, because it's the same directory as Dllv1 which works fine!</p>\n\n<p>Any thoughts...  Driving me nuts..</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39, "user_id": 10728318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0540b703f094be094b2b828ce9ae55d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Laszkowski", "link": "https://stackoverflow.com/users/10728318/m-laszkowski"}, "edited": false, "score": 0, "creation_date": 1544021051, "post_id": 53634800, "comment_id": 94129133, "body": "@urdearboy thought I would tag you in this as you have helped me develop the code! Thanks again!"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1544021410, "post_id": 53634800, "comment_id": 94129383, "body": "You have provided a wish list, but what attempts and progress have you made?"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 1, "creation_date": 1544022173, "post_id": 53634800, "comment_id": 94129913, "body": "Your post needs to demonstrate your attempt(s) and ask a specific <b>question</b>, otherwise you are simply asking someone to write your code for you."}, {"owner": {"reputation": 39, "user_id": 10728318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0540b703f094be094b2b828ce9ae55d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Laszkowski", "link": "https://stackoverflow.com/users/10728318/m-laszkowski"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1544022636, "post_id": 53634800, "comment_id": 94130224, "body": "I have tried many things, with some success however not quite what I am looking for. More specifically I have scoured the internet and found a few useful posts. Mostly subs that copy a range only and not certain cells and a range. I have been able to use this as a new section in the code and the range is copied as well as the cells however I cannot incorporate this into the code any better and the condition of copying ONLY from not looped files is not met. I have also tried incorporating selection.copy and selection.paste without success."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1544022674, "post_id": 53634800, "comment_id": 94130244, "body": "Welcome to Stack Overflow! Please read <a href=\"https://meta.stackoverflow.com/q/284236/1188513\"><i>Why is \u201cCan someone help me?\u201d not an actual question?</i></a>"}, {"owner": {"reputation": 39, "user_id": 10728318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0540b703f094be094b2b828ce9ae55d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Laszkowski", "link": "https://stackoverflow.com/users/10728318/m-laszkowski"}, "reply_to_user": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1544023512, "post_id": 53634800, "comment_id": 94130754, "body": "Thanks guys, I will try and make sense of it all. I am new to all this so it is taking a while. @AndyG Does the comment above provide more clarification on the developments that I have tried undertaking?"}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1544023794, "post_id": 53634800, "comment_id": 94130911, "body": "@M.Laszkowski Explaining verbally what you have attempted is good, but still doesn&#39;t get beyond the &quot;fill in the blanks for me&quot; request. Actually providing the code attempt is necessary. On revisiting your attempts stick with one part of your tasklist, then your new question will be more focused and have some code to show what you have been trying."}, {"owner": {"reputation": 39, "user_id": 10728318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0540b703f094be094b2b828ce9ae55d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Laszkowski", "link": "https://stackoverflow.com/users/10728318/m-laszkowski"}, "edited": false, "score": 0, "creation_date": 1544023981, "post_id": 53634800, "comment_id": 94131056, "body": "I will edit the question asap with the two attempts that have come closest to giving me a result."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1544024114, "post_id": 53634800, "comment_id": 94131153, "body": "@M.Laszkowski I would have thought it better to start over with a new, more focused, single question."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10728318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0540b703f094be094b2b828ce9ae55d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Laszkowski", "link": "https://stackoverflow.com/users/10728318/m-laszkowski"}, "edited": false, "score": 0, "creation_date": 1544086364, "post_id": 53644253, "comment_id": 94153696, "body": "Unfortunately that doesn&#39;t work either, I am guessing because the code was originally written to paste data into single rows and when I try to add code that also pastes blocks of data, it can&#39;t cope with that. I am yet to figure out why! Thanks for your input! I will try and re-work the question and post a new one like the guys have suggested in the comments."}], "tags": [], "owner": {"reputation": 16, "user_id": 10752420, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-k5rHkOD3s6I/AAAAAAAAAAI/AAAAAAAABCs/FBjE-OPCSjA/photo.jpg?sz=128", "display_name": "Tyler Miles", "link": "https://stackoverflow.com/users/10752420/tyler-miles"}, "is_accepted": false, "score": 0, "last_activity_date": 1544067277, "creation_date": 1544067277, "answer_id": 53644253, "question_id": 53634800, "link": "https://stackoverflow.com/questions/53634800/vba-loop-through-files-in-a-folder-only-if-multiple-conditions-are-met/53644253#53644253", "title": "VBA - Loop through files in a folder ONLY if multiple conditions are met", "body": "<p>I ran into a similar problem when copying a range into an array. What fixed it was using .Value2 instead of .Value. Might be worth a try. </p>\n"}], "owner": {"reputation": 39, "user_id": 10728318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0540b703f094be094b2b828ce9ae55d6?s=128&d=identicon&r=PG&f=1", "display_name": "M.Laszkowski", "link": "https://stackoverflow.com/users/10728318/m-laszkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544067277, "creation_date": 1544020952, "last_edit_date": 1544026015, "question_id": 53634800, "link": "https://stackoverflow.com/questions/53634800/vba-loop-through-files-in-a-folder-only-if-multiple-conditions-are-met", "title": "VBA - Loop through files in a folder ONLY if multiple conditions are met", "body": "<p>I am currently using a piece of code to loop through files in a folder and copy certain cells from each file into a master list. There are a number of files being added into the folder every week. One of the columns in the master list includes the filenames of previously looped files. The code only loops through files that are not included in the filename list and therefore also have not previously been looped.</p>\n\n<p>I would like to extend this and add two adjustments. I would like the code to copy an extra bit of data, however this time it is a range not just a cell (<code>A20:H33</code> specifically).When I try to change the code to copy a range the code stops working. </p>\n\n<p>Furthermore, I would like to only copy data from files with a specific filename ending (\"<code>xxxxFAM</code>\" for example) as well as only from files that have not been looped yet - this filename ending would be chosen within a cell on the worksheet that the data is being copied to. (Cell P3 for example). Any ideas on how I might do this?</p>\n\n<p>Here is the code that I am currently using and that has been kindly developed with the help of a stack overflow member! Please note that most of my work is trial and error, see below the attempts that have been made.</p>\n\n<pre><code>Option Explicit\n\nSub CopyFromFolderExample()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(1)\nDim strFolder As String, strFile As String, r As Long, wb As Workbook\nDim varTemp(1 To 6) As Variant\n\nApplication.ScreenUpdating = False\nstrFolder = \"D:\\Other\\folder\\\"\n\nws.Range(\"A4:E\" &amp; ws.Rows.Count).ClearContents\nr = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nstrFile = Dir(strFolder &amp; \"*.xl*\")\nDo While Len(strFile) &gt; 0\n    If Not Looped(strFile, ws) Then\n        Application.StatusBar = \"Reading data from \" &amp; strFile &amp; \"...\"\n        Set wb = Workbooks.Add(strFolder &amp; strFile)\n        With wb.Worksheets(1)\n            varTemp(1) = .Range(\"A13\").Value\n            varTemp(2) = .Range(\"H8\").Value\n            varTemp(3) = .Range(\"H9\").Value\n            varTemp(4) = .Range(\"H36\").Value\n            varTemp(5) = .Range(\"H37\").Value\n            varTemp(6) = strFile\n        End With\n        wb.Close False\n\n        r = r + 1\n        ws.Range(ws.Cells(r, 1), ws.Cells(r, 6)).Formula = varTemp\n    End If    \n  strFile = Dir\nLoop\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>Private Function Looped(strFile As String, ws As Worksheet) As Boolean\n\nDim Found As Range\nSet Found = ws.Range(\"F:F\").Find(strFile)\n\nIf Found Is Nothing Then\nLooped = False\nElse\nLooped = True\nEnd If\n\nEnd Function\n</code></pre>\n\n<p><strong>Here is attempt 1 using I simply change one of the vartemps into a range - unsurprisingly this did not work (No error - range is simply not copied)</strong></p>\n\n<pre><code>Sub CopyFromFolderExample()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(4)\nDim strFolder As String, strFile As String, r As Long, wb As Workbook\nDim varTemp(1 To 6) As Variant\n\nApplication.ScreenUpdating = False\nstrFolder = \"D:\\Other\\folder\\\"\n\n'ws.Range(\"A2:E\" &amp; ws.Rows.Count).ClearContents\nr = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nstrFile = Dir(strFolder &amp; \"*.xl*\")\nDo While Len(strFile) &gt; 0\n    If Not Looped(strFile, ws) Then\n        Application.StatusBar = \"Reading data from \" &amp; strFile &amp; \"...\"\n        Set wb = Workbooks.Add(strFolder &amp; strFile)\n        With wb.Worksheets(1)\n            varTemp(1) = strFile\n            varTemp(2) = .Range(\"A13\").Value\n            varTemp(3) = .Range(\"H8\").Value\n            varTemp(4) = .Range(\"H9\").Value\n            varTemp(5) = .Range(\"H37\").Value\n            varTemp(6) = .Range(\"A20:A33\").Value\n\n        End With\n        wb.Close False\n\n        r = r + 1\n        ws.Range(ws.Cells(r, 10), ws.Cells(r, 15)).Formula = varTemp\n    End If\n  strFile = Dir\nLoop\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p><strong>Here is attempt 2 using selection.copy and selection.paste (\"Object doesn't support this property or method\" error with no workaround found:</strong></p>\n\n<pre><code>Sub CopyFromFolderExample()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(4)\nDim strFolder As String, strFile As String, r As Long, wb As Workbook\nDim varTemp(1 To 6) As Variant\n\nApplication.ScreenUpdating = False\nstrFolder = \"D:\\Other\\folder\\\"\n\n'ws.Range(\"A2:E\" &amp; ws.Rows.Count).ClearContents\nr = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nstrFile = Dir(strFolder &amp; \"*.xl*\")\nDo While Len(strFile) &gt; 0\n    If Not Looped(strFile, ws) Then\n        Application.StatusBar = \"Reading data from \" &amp; strFile &amp; \"...\"\n        Set wb = Workbooks.Add(strFolder &amp; strFile)\n        With wb.Worksheets(1)\n            varTemp(1) = strFile\n            varTemp(2) = .Range(\"A13\").Value\n            varTemp(3) = .Range(\"H8\").Value\n            varTemp(4) = .Range(\"H9\").Value\n            varTemp(5) = .Range(\"H37\").Value\n\n.Range(\"A20:H33\").Select\n.Range(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\nws.Activate\n\nIf ws.Range(\"A1\") = \"\" Then\nws.Range(\"A1\").Select\nSelection.Paste\nElse\nSelection.End(xlDown).Offset(6, 0).Select\nSelection.Paste\nEnd If\n\n        End With\n        wb.Close False\n\n        r = r + 1\n        ws.Range(ws.Cells(r, 10), ws.Cells(r, 15)).Formula = varTemp\n    End If\n  strFile = Dir\nLoop\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p><strong>Here is attempt 3 using a modified sub that is incorporated into the main code:(Both range and cells are copied however I have been unable to incorporate this into the main code so the range is copied only if conditions are met):</strong></p>\n\n<pre><code>Sub CopyFromFolderExample()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(4)\nDim strFolder As String, strFile As String, r As Long, wb As Workbook\nDim varTemp(1 To 6) As Variant\n\nApplication.ScreenUpdating = False\nstrFolder = \"D:\\Other\\folder\\\"\n\n'ws.Range(\"A2:E\" &amp; ws.Rows.Count).ClearContents\nr = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row\n\nstrFile = Dir(strFolder &amp; \"*.xl*\")\nDo While Len(strFile) &gt; 0\n    If Not Looped(strFile, ws) Then\n        Application.StatusBar = \"Reading data from \" &amp; strFile &amp; \"...\"\n        Set wb = Workbooks.Add(strFolder &amp; strFile)\n        With wb.Worksheets(1)\n            varTemp(1) = strFile\n            varTemp(2) = .Range(\"A13\").Value\n            varTemp(3) = .Range(\"H8\").Value\n            varTemp(4) = .Range(\"H9\").Value\n            varTemp(5) = .Range(\"H37\").Value\n            'varTemp(6) = .Range(\"A20:A33\").Value\n\n        End With\n        wb.Close False\n\n        r = r + 1\n        ws.Range(ws.Cells(r, 10), ws.Cells(r, 15)).Formula = varTemp\n    End If\n  strFile = Dir\nLoop\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\n\nDim xRg As Range\nDim xSelItem As Variant\nDim xFileDlg As FileDialog\nDim xFileName, xSheetName, xRgStr As String\nDim xBook, xWorkBook As Workbook\nDim xSheet As Worksheet\nOn Error Resume Next\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\nxSheetName = \"DELIVERY NOTE\"\nxRgStr = \"A20:H33\"\nSet xFileDlg = Application.FileDialog(msoFileDialogFolderPicker)\nWith xFileDlg\n    If .Show = -1 Then\n        xSelItem = .SelectedItems.Item(1)\n        Set xWorkBook = ThisWorkbook\n        Set xSheet = xWorkBook.Sheets(\"DN Compile\")\n        If xSheet Is Nothing Then\n\nxWorkBook.Sheets.Add(after:=xWorkBook.Worksheets ---&gt; \n---&gt;(xWorkBook.Worksheets.Count)).Name = \"DN Compile\"\n            Set xSheet = xWorkBook.Sheets(\"DN Compile\")\n        End If\n        xFileName = Dir(xSelItem &amp; \"\\*.xlsx\", vbNormal)\n        If xFileName = \"\" Then Exit Sub\n        Do Until xFileName = \"\"\n           Set xBook = Workbooks.Open(xSelItem &amp; \"\\\" &amp; xFileName)\n            Set xRg = xBook.Worksheets(xSheetName).Range(xRgStr)\n            xRg.Copy xSheet.Range(\"A65536\").End(xlUp).Offset(1, 0)\n            xFileName = Dir()\n            xBook.Close\n        Loop\n    End If\nEnd With\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\n\nApplication.ScreenUpdating = True\nEnd Sub\n\n\nPrivate Function Looped(strFile As String, ws As Worksheet) As Boolean\n\nDim Found As Range\nSet Found = ws.Range(\"A:A\").Find(strFile)\n\nIf Found Is Nothing Then\nLooped = False\nElse\nLooped = True\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 900, "user_id": 1587451, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca143c644b5da7796f746de7bbaedb80?s=128&d=identicon&r=PG", "display_name": "user1587451", "link": "https://stackoverflow.com/users/1587451/user1587451"}, "edited": false, "score": 0, "creation_date": 1544022259, "post_id": 53634923, "comment_id": 94129977, "body": "SheetA shall be constant and never be altered. Further, the cells edited shall contain references not values."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 900, "user_id": 1587451, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca143c644b5da7796f746de7bbaedb80?s=128&d=identicon&r=PG", "display_name": "user1587451", "link": "https://stackoverflow.com/users/1587451/user1587451"}, "edited": false, "score": 0, "creation_date": 1544022816, "post_id": 53634923, "comment_id": 94130331, "body": "@user1587451 if you want the cells to contain a formula, assign the cells&#39; <code>Formula</code> property to a formula that refers to the address of the cell you want &quot;linked&quot;. Your question is rather unclear TBH."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1544026592, "post_id": 53634923, "comment_id": 94132619, "body": "The code is in SheetsB, like you have asked for...Further why would you ask for VBA if you are just going to use formulas anyway?"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1544021400, "creation_date": 1544021400, "answer_id": 53634923, "question_id": 53634752, "link": "https://stackoverflow.com/questions/53634752/how-to-check-if-value-is-a-reference-from-others-sheet-column/53634923#53634923", "title": "How to check if value is a reference from others sheet column?", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Column = 1 Then\n        Sheets(\"SheetA\").Cells(Target.Row, \"A\").Value = Target.Value\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 900, "user_id": 1587451, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ca143c644b5da7796f746de7bbaedb80?s=128&d=identicon&r=PG", "display_name": "user1587451", "link": "https://stackoverflow.com/users/1587451/user1587451"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 53634923, "answer_count": 1, "score": 0, "last_activity_date": 1581745618, "creation_date": 1544020823, "last_edit_date": 1581745618, "question_id": 53634752, "link": "https://stackoverflow.com/questions/53634752/how-to-check-if-value-is-a-reference-from-others-sheet-column", "title": "How to check if value is a reference from others sheet column?", "body": "<p>I want to auto-update a row in some sheet depending on antoher sheet. All this with a macro.</p>\n\n<p>In the frist step I have:</p>\n\n<pre><code>SheetA!A$1 = \"first\"\nSheetA!A$2 = \"second\"\nSheetA!A$3 = \"third\"\nSheetB!A$1 = empty\nSheetB!A$2 = empty\nSheetB!A$2 = empty\n</code></pre>\n\n<p>Then I edit SheetB!A$1 by hand</p>\n\n<pre><code>SheetA!A$1 = \"first\"\nSheetA!A$2 = \"second\"\nSheetA!A$3 = \"third\"\nSheetB!A$1 = SheetA!A$1\nSheetB!A$2 = empty\nSheetB!A$2 = empty\n</code></pre>\n\n<p>Now the macro kicks in</p>\n\n<pre><code>SheetA!A$1 = \"first\"\nSheetA!A$2 = \"second\"\nSheetA!A$3 = \"third\"\nSheetB!A$1 = SheetA!A$1\nSheetB!A$2 = SheetA!A$2\nSheetB!A$2 = SheetA!A$3\n</code></pre>\n\n<p>I would prefer to put the code into <code>SheetB</code></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Target.Column = 1 'if changes in sheetB, col1\n    'TODO\n  End If\nEnd Sub\n</code></pre>\n\n<p>How would such a auto-copy look like?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1544020764, "post_id": 53634621, "comment_id": 94128929, "body": "thanks. I think you  put an extra <code>&quot;</code> at the end of <code>.value</code> . I am having trouble with this though, the <code>Worksheets(&quot;Manager&quot;).Range(&quot;C2&quot;).Value</code> is providing the right value in the formula, which is same as <code>A330</code>.. but its a date not sure if this is matching correctly."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 2, "last_activity_date": 1544020787, "last_edit_date": 1544020787, "creation_date": 1544020383, "answer_id": 53634621, "question_id": 53634443, "link": "https://stackoverflow.com/questions/53634443/vba-combine-formula-with-vba/53634621#53634621", "title": "VBA,Combine .Formula with VBA", "body": "<p>Just concate it like a normal string using the <code>&amp;</code> operator. Since you are not joining text ,but rather a VBA object, do not wrap quotes around the object. </p>\n\n<pre><code>\"=INDEX(Spread!$C:$C, MATCH(1,INDEX((\" &amp; Worksheets(\"Manager\").Range(\"C2\").Value &amp; \"= Spread!$A:$A) * (\"\"Stack\"\" =Spread!$B:$B),),0))\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 9598272, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m992ybDpciM/AAAAAAAAAAI/AAAAAAAAABQ/4DLwgR-Dsv0/photo.jpg?sz=128", "display_name": "onur rr", "link": "https://stackoverflow.com/users/9598272/onur-rr"}, "is_accepted": false, "score": 1, "last_activity_date": 1554413977, "creation_date": 1554413977, "answer_id": 55525308, "question_id": 53634443, "link": "https://stackoverflow.com/questions/53634443/vba-combine-formula-with-vba/55525308#55525308", "title": "VBA,Combine .Formula with VBA", "body": "<p>You can also store the data in a variable and use it instead of A330. This way you can always use newly created variable inside your code anytime anywhere in your code</p>\n\n<pre><code>myData = Worksheets(\"Manager\").Range(\"C2\").Value\n.Range(\"D\" &amp; lastrow + 1).Formula = \"=INDEX(Spread!$C:$C, MATCH(1,INDEX((myData = Spread!$A:$A) * (\"\"Stack\"\" =Spread!$B:$B),),0))\"\n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 53634621, "answer_count": 2, "score": 0, "last_activity_date": 1581745626, "creation_date": 1544019813, "last_edit_date": 1581745626, "question_id": 53634443, "link": "https://stackoverflow.com/questions/53634443/vba-combine-formula-with-vba", "title": "VBA,Combine .Formula with VBA", "body": "<p>I have the following vba code which puts a formula in a cell.</p>\n\n<pre><code> .Range(\"D\" &amp; lastrow + 1).Formula = \"=INDEX(Spread!$C:$C, MATCH(1,INDEX((A330 = Spread!$A:$A) * (\"\"Stack\"\" =Spread!$B:$B),),0))\"\n</code></pre>\n\n<p>How can I change <code>A330</code> in my formula to vba code like  <code>Worksheets(\"Manager\").Range(\"C2\").Value</code></p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1544019676, "post_id": 53634046, "comment_id": 94128132, "body": "Hello and welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"https://stackoverflow.com/help\">help center</a> to learn what we&#39;ll do to help you. TL;DR: this isn&#39;t a code writing service so you&#39;ll have to provide your best shot at it and indicate where you&#39;re stuck, then someone will help you fix that specific issue."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1544020084, "post_id": 53634046, "comment_id": 94128398, "body": "@Freeman Your TL;DR is longer than the &quot;long&quot; version :D"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1544020395, "post_id": 53634046, "comment_id": 94128656, "body": "@DarrenBartrup-Cook it&#39;s shorter than taking the tour and reading the help..."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1544020464, "post_id": 53634046, "comment_id": 94128714, "body": "@Freeman  Fair point."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10608234, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156903798109853/picture?type=large", "display_name": "Mostafa Mekky", "link": "https://stackoverflow.com/users/10608234/mostafa-mekky"}, "edited": false, "score": 0, "creation_date": 1544021461, "post_id": 53634175, "comment_id": 94129423, "body": "That&#39;s a very old version, I am using Access 2018, this is not compatible"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 11, "user_id": 10608234, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156903798109853/picture?type=large", "display_name": "Mostafa Mekky", "link": "https://stackoverflow.com/users/10608234/mostafa-mekky"}, "edited": false, "score": 0, "creation_date": 1544025750, "post_id": 53634175, "comment_id": 94132159, "body": "As it works for Access 2010, convert it to an accdb file."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1544018848, "creation_date": 1544018848, "answer_id": 53634175, "question_id": 53634046, "link": "https://stackoverflow.com/questions/53634046/how-do-i-exit-and-save-access-automaticlly-using-a-macro/53634175#53634175", "title": "How do I Exit and Save Access automaticlly using a macro?", "body": "<p>It is not that easy to get working under all conditions. Thus, a tool has been created by <em>Peter's Software</em> to do it for you:</p>\n\n<p><a href=\"http://www.peterssoftware.com/isd.htm\" rel=\"nofollow noreferrer\">Inactive Shut Down Control</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10608234, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156903798109853/picture?type=large", "display_name": "Mostafa Mekky", "link": "https://stackoverflow.com/users/10608234/mostafa-mekky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594625838, "creation_date": 1544018381, "last_edit_date": 1594625838, "question_id": 53634046, "link": "https://stackoverflow.com/questions/53634046/how-do-i-exit-and-save-access-automaticlly-using-a-macro", "title": "How do I Exit and Save Access automaticlly using a macro?", "body": "<p>I am having difficulties developing a macro that saves and closes access automatically after a certain amount of time</p>\n\n<p>I did a bit of research already and tried a couple of vba functions in modules but nothing seems to work</p>\n"}, {"tags": ["vba", "dictionary"], "comments": [{"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1544019023, "post_id": 53633939, "comment_id": 94127700, "body": "This question could be better structured but, more importantly, doesn&#39;t even feature a dictionary in the code?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1544019127, "post_id": 53633939, "comment_id": 94127771, "body": "The code you are showing is not compiling, but anyhow, it is just declaring a bunch of (unused) variables and call another routine. Nothing related to looping, a dictionary or anything else you mention. So my suggestion is that you start by showing the code you are talking about."}, {"owner": {"reputation": 35, "user_id": 2262031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca2b98ddfc86cf7c34b818c0241bbf7?s=128&d=identicon&r=PG", "display_name": "user2262031", "link": "https://stackoverflow.com/users/2262031/user2262031"}, "edited": false, "score": 0, "creation_date": 1544019408, "post_id": 53633939, "comment_id": 94127954, "body": "I&#39;ve added the dictionary routine which doesn&#39;t work i.e. gets overwritten as it&#39;s defined the sub. The other attempts entail defining outside the sub as a public which fail dramtically"}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 2, "creation_date": 1544023831, "post_id": 53633939, "comment_id": 94130939, "body": "<code>Dim inputer, inputer2, inputer3, inputer4 As String</code> will result in three variants and one string being defined.  Put them on separate lines and specify each variable&#39;s data type."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 2262031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca2b98ddfc86cf7c34b818c0241bbf7?s=128&d=identicon&r=PG", "display_name": "user2262031", "link": "https://stackoverflow.com/users/2262031/user2262031"}, "edited": false, "score": 0, "creation_date": 1544020607, "post_id": 53634326, "comment_id": 94128818, "body": "Thanks , I see what you mean. When I define it this way I always get an object require 424 when it comes to the add.dict part. Does this mean it&#39;s not finding the dictionary ?"}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "reply_to_user": {"reputation": 35, "user_id": 2262031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca2b98ddfc86cf7c34b818c0241bbf7?s=128&d=identicon&r=PG", "display_name": "user2262031", "link": "https://stackoverflow.com/users/2262031/user2262031"}, "edited": false, "score": 0, "creation_date": 1544023692, "post_id": 53634326, "comment_id": 94130858, "body": "<code>add.dict y , x</code> should be <code>dict.add y , x</code>"}], "tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": false, "score": 0, "last_activity_date": 1544019379, "creation_date": 1544019379, "answer_id": 53634326, "question_id": 53633939, "link": "https://stackoverflow.com/questions/53633939/vba-dictionary-problems/53634326#53634326", "title": "VBA dictionary problems", "body": "<p>Although I can't actually see a dictionary variable defined, I suspect that you need to declare that variable at the module level (possibly as Private) so that all procs within that module can refer to it.</p>\n\n<p>Make sure that you only declare the variable at module level and that in the entry proc you actually set it to a new dictionary.  This approach ensures that you control when it is created.</p>\n\n<pre><code>Option Explicit\nDim dctCurrent As Dictionary\n\nPrivate Sub EntryProcToMyLogic()\n    Set dctCurrent = New Dictionary\n\n    [other functionality to set up call to CalculateCoordinates()]\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 2262031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca2b98ddfc86cf7c34b818c0241bbf7?s=128&d=identicon&r=PG", "display_name": "user2262031", "link": "https://stackoverflow.com/users/2262031/user2262031"}, "edited": false, "score": 0, "creation_date": 1544448461, "post_id": 53705908, "comment_id": 94267811, "body": "Thanks very much, it is now working as expected. Absolutely brilliant !!"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 35, "user_id": 2262031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca2b98ddfc86cf7c34b818c0241bbf7?s=128&d=identicon&r=PG", "display_name": "user2262031", "link": "https://stackoverflow.com/users/2262031/user2262031"}, "edited": false, "score": 0, "creation_date": 1544451038, "post_id": 53705908, "comment_id": 94269294, "body": "@user2262031 Please vote for good Anserws/Questions that were helpful and mark the best answer as accepted to help others with similar question estimating which answers should be considered first as the default sort is accepted answer first, then votes Desc."}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 0, "last_activity_date": 1544446743, "last_edit_date": 1544446743, "creation_date": 1544445795, "answer_id": 53705908, "question_id": 53633939, "link": "https://stackoverflow.com/questions/53633939/vba-dictionary-problems/53705908#53705908", "title": "VBA dictionary problems", "body": "<p>To prevent overwriting, you can check if<code>dctCurrent</code>is allready created (if not<code>dctCurrent Is Nothing</code>) before<code>Set dctCurrent = New Dictionary</code>.</p>\n\n<p>Create a Function that returns your<code>dctCurrent</code> and you don't have to worry about.</p>\n\n<pre><code>Option Explicit 'Top of module\nPrivate dctCurrent As Scripting.Dictionary\n\nPublic Function CurrentDict() as Scripting.Dictionary\n  If dctCurrent Is Nothing Then\n    Set dctCurrent = New Scripting.Dictionary\n  End If\n  Set  CurrentDict = dctCurrent\nEnd Function\n</code></pre>\n\n<p>Now you can use<code>CurrentDict</code>without knowing if<code>dctCurrent</code>has been created or not.</p>\n\n<pre><code>Public Sub EntryProcToMyLogic(x, y)\n  CurrentDict.Add x, y\n\n  Debug.Print \"max KEY:- \"; Application.Max(CurrentDict.Keys)\n  Debug.Print \"max ITEM:- \"; Application.Max(CurrentDict.Items)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 2262031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca2b98ddfc86cf7c34b818c0241bbf7?s=128&d=identicon&r=PG", "display_name": "user2262031", "link": "https://stackoverflow.com/users/2262031/user2262031"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 53705908, "answer_count": 2, "score": 0, "last_activity_date": 1544453850, "creation_date": 1544017997, "last_edit_date": 1544453850, "question_id": 53633939, "link": "https://stackoverflow.com/questions/53633939/vba-dictionary-problems", "title": "VBA dictionary problems", "body": "<p>I have the following sub which I iterate through several when running the full work book. What I am trying to do is to create a dictionary which is written to in the sub and then also accessed in the sub to get a max value. If i create the dictionary in the sub it is overwritten line by line so I can't get a max value , if I create the dictionary in another sub I have issues writing to it. What you suggest ? </p>\n\n<pre><code>Private Sub CalculateCoordinates(sThread, node As IXMLDOMNode)\n  Dim parent_node As IXMLDOMNode, x As Integer, y As Integer, \n  y_max_branch As Integer, nList As IXMLDOMNodeList\n  Dim StepId As String, strXpath As String\n  Dim inputer, inputer2, inputer3, inputer4 As String\n  Dim stry As String\n  Dim dict As Scripting.Dictionary\n\n  set dict = New Scripting.Dictionary\n\n  add.dict y , x \n\n  debug.print Application.WorksheetFunction.Max(dict.keys)\n\n  Call AddCoordinates(node, x, y)\nEnd Sub\n</code></pre>\n\n<p>Thanks for the replies, i've modfied the code accordinly but I still get the dictionary overwritten each line. I believe this is causing it :- Set dctCurrent = New Dictionary Where can I define it out of the sub to stop it being overwritten each line ?</p>\n\n<pre><code>Public dctCurrent As Dictionary\nDebug.Print \"max ITEM:- \"; Application.Max(dctCurrent.Items)\nCall EntryProcToMyLogic(x, y)\nCall AddCoordinates(node, x, y)\nEnd Sub\n</code></pre>\n\n<p>^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>\n\n<pre><code>Public Sub EntryProcToMyLogic(x, y)\n  Set dctCurrent = New Dictionary      \n  Call CalculateCoordinates()\n\n  dctCurrent.Add x, y\n\n  Debug.Print \"max KEY:- \"; Application.Max(dctCurrent.Keys)\n  Debug.Print \"max ITEM:- \"; Application.Max(dctCurrent.Items)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1544018064, "post_id": 53633784, "comment_id": 94127154, "body": "&#39;nothing online seems to explain Excel VBA in a very good manner&#39;? You cannot be serious? There are thousands of tutorials out there, and then there is the official documentation at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/overview/excel\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/overview/excel</a>"}, {"owner": {"reputation": 29, "user_id": 3127298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c4cc3bf7b0a74d0da5065f3ff01c12?s=128&d=identicon&r=PG&f=1", "display_name": "abberto", "link": "https://stackoverflow.com/users/3127298/abberto"}, "reply_to_user": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1544018153, "post_id": 53633784, "comment_id": 94127192, "body": "OK, maybe not so much that it&#39;s not in a good manner, but I can&#39;t seem to apply the information to the code above. I&#39;m sure it&#39;s something simple and something that I am missing that is glaringly obvious, but it&#39;s all starting to melt together and look the same"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1544018588, "post_id": 53633784, "comment_id": 94127445, "body": "<code>A1:A550</code> is relative to the selected cell.  If <code>A1</code> is selected then it will refer to <code>A1:A550</code>.  If <code>B2</code> is selected then that cell is considered to be the <code>A1</code> of the selection so it will refer to the range <code>B2:B551</code>.  The same with <code>ActiveCell.Offset(0, 1).Range(&quot;A1&quot;)</code> - it&#39;s telling it to select the first cell one column across from the <code>ActiveCell</code> - you could just say <code>ActiveCell.Offset(0, 1)</code>."}, {"owner": {"reputation": 29, "user_id": 3127298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c4cc3bf7b0a74d0da5065f3ff01c12?s=128&d=identicon&r=PG&f=1", "display_name": "abberto", "link": "https://stackoverflow.com/users/3127298/abberto"}, "edited": false, "score": 0, "creation_date": 1544018773, "post_id": 53633784, "comment_id": 94127544, "body": "Brilliant!! Thank you both! That makes sense and, clearly, I was missing a relatively obvious notion. Thanks again!!"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1544018843, "post_id": 53633784, "comment_id": 94127583, "body": "So all the code is doing is sorting the 550 cells below &amp; including the currently selected cell."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1544025640, "post_id": 53634302, "comment_id": 94132092, "body": "You can remove the <code>SortMethod:=xlPinYin</code> as well unless you&#39;re sorting Chinese characters."}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1544019704, "last_edit_date": 1544019704, "creation_date": 1544019282, "answer_id": 53634302, "question_id": 53633784, "link": "https://stackoverflow.com/questions/53633784/excel-vba-clarification/53634302#53634302", "title": "Excel VBA - Clarification", "body": "<p>The <code>.SetRange ActiveCell.Range(\"A1:A550\")</code> line in that code is <strong>Relative</strong> to the Range determined by the line <code>Range(Selection, Selection.End(xlDown)).Select</code> - and just says to use the first 550 lines.  (If there are less than 550 cells selected, it expands the selection to match, so that first line is actually unnecessary)</p>\n\n<p>That said, the entire block can be made much shorter, to do exactly the same thing without any \"extraneous\" code:</p>\n\n<pre><code>Range(Selection.Cells(1,1), Selection.Cells(550, 1)).Sort Selection, xlAscending, _\n    Header:=xlNo, Orientation:=xlSortColumns, SortMethod:=xlPinYin\nActiveCell.Offset(0, 1).Select\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3127298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41c4cc3bf7b0a74d0da5065f3ff01c12?s=128&d=identicon&r=PG&f=1", "display_name": "abberto", "link": "https://stackoverflow.com/users/3127298/abberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544019704, "creation_date": 1544017526, "last_edit_date": 1544018060, "question_id": 53633784, "link": "https://stackoverflow.com/questions/53633784/excel-vba-clarification", "title": "Excel VBA - Clarification", "body": "<p>I was just wondering if anybody had any advice on what this piece of VBA code is doing. A colleague of mine left recently and hadn't commented any of their work so I am a bit confused.</p>\n\n<p>There is some code to sort some cells but I'm not sure how it knows what to sort, as a range is specified which isn't the data I want sorting. I think I am missing something but nothing online seems to explain Excel VBA in a very good manner.</p>\n\n<p>The code looks like this:</p>\n\n<pre><code>    Range(Selection, Selection.End(xlDown)).Select\n    ActiveWorkbook.ActiveSheet.SORT.SortFields.Clear\n    ActiveWorkbook.ActiveSheet.SORT.SortFields.Add Key:=ActiveCell, _\n        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortTextAsNumbers\n    With ActiveWorkbook.ActiveSheet.SORT\n        .SetRange ActiveCell.Range(\"A1:A550\")\n        .Header = xlNo\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    ActiveCell.Offset(0, 1).Range(\"A1\").Select\n</code></pre>\n\n<p>I know that the top stuff sets the criteria to be used to sort the data, but I am unsure why range(\"A1:A550\") is there, as the data to be sorted usually begins somewhere around cell C15. Is the code just saying \"Use the current cell as A1, select the next 550 rows down from this and sort the data accordingly\"?</p>\n\n<p>Thank you all in advance.</p>\n"}, {"tags": ["vba", "range", "cell", "autofill"], "comments": [{"owner": {"reputation": 583, "user_id": 1075298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7b7650271ebf475d19a1a201714794e?s=128&d=identicon&r=PG", "display_name": "sempasha", "link": "https://stackoverflow.com/users/1075298/sempasha"}, "edited": false, "score": 0, "creation_date": 1544019288, "post_id": 53633631, "comment_id": 94127887, "body": "Describe an error, please."}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1545489076, "creation_date": 1545489076, "answer_id": 53896503, "question_id": 53633631, "link": "https://stackoverflow.com/questions/53633631/vba-autofill-adjacent-dynamic-column-results-in-error/53896503#53896503", "title": "VBA AutoFill adjacent dynamic column results in error?", "body": "<h1>Adjacent vs Last Column</h1>\n\n<p>Your <code>AutoFill</code> isn't doing anything so I've used just <code>Copy</code>.</p>\n\n<h2>Adjacent</h2>\n\n<p>Adjacent to the right <strong>ALWAYS</strong> means the next right column which would be column <code>X</code> in this case.</p>\n\n<pre><code>Sub AdjacentToTheRightColumn()\n\n  Const cWBName As String = \"Outbound Month\"\n  Const cWsName As String = \"Summary\"\n  Const cRange As String = \"W1:W39\"\n\n  With Workbooks(cWBName).Worksheets(cWsName)\n    .Range(cRange).Copy .Range(cRange).Offset(0, 1)\n  End With\n\nEnd Sub\n</code></pre>\n\n<h2>After Last</h2>\n\n<p>After last column <strong>ONLY</strong> means column <code>X</code>, <strong>IF</strong> <code>W</code> is last column.</p>\n\n<pre><code>Sub AfterLastColumn()\n\n  Const cWBName As String = \"Outbound Month\"\n  Const cWsName As String = \"Summary\"\n  Const cRange As String = \"W1:W39\"\n\n  Dim LastColumn As Integer\n\n  With Workbooks(cWBName).Worksheets(cWsName)\n      LastColumn = .Cells(1, .Columns.Count).End(xlToLeft).Column\n      .Range(cRange).Copy .Range(cRange) _\n          .Offset(0, LastColumn - Range(cRange).Column + 1)\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 10749681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d42b9a076b87a5fb6c301536a952dc?s=128&d=identicon&r=PG&f=1", "display_name": "timetravelprimer", "link": "https://stackoverflow.com/users/10749681/timetravelprimer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545489076, "creation_date": 1544017040, "question_id": 53633631, "link": "https://stackoverflow.com/questions/53633631/vba-autofill-adjacent-dynamic-column-results-in-error", "title": "VBA AutoFill adjacent dynamic column results in error?", "body": "<p>I am trying to AutoFill dynamic and adjacent column but I'm getting an error. Tried lots of tips but nothing works. Would appreciate the help</p>\n\n<pre><code>Dim Column As Integer\nColumn = Workbooks(\"Outbound Month\").Worksheets(\"Summary\").Range(\"A1\", Range(\"A1\").End(xlToRight)).Columns.Count + 1\n\nWorkbooks(\"Outbound Month\").Worksheets(\"Summary\").Activate\nActiveSheet.Range(\"W1:W39\").AutoFill Destination:=Range(Range(Cells(1, Column), Cells(39, Column)), Type:=xlFillDefault)\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1544020839, "post_id": 53633546, "comment_id": 94128984, "body": "I would suggest using the filesystemobject, and it&#39;s file.type property and look at the registry"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 2, "last_activity_date": 1544028897, "creation_date": 1544028897, "answer_id": 53637166, "question_id": 53633546, "link": "https://stackoverflow.com/questions/53633546/how-to-discover-oleobject-classtype-of-files/53637166#53637166", "title": "How to discover Oleobject ClassType of files?", "body": "<p>In order to insert a file as an OLE Object the file type needs to have an available OLE Server installed on the machine, or it needs to be in a format that the Windows Packager mechanism can \"wrap up\" into an OLE type. Before you go this route you need to ensure that anyone who tries to work with such a document has corresponding OLE Server software installed on the machine on which the document is opened. Just because the machine that creates an embedded OLE object can do so doesn't mean another machine can work with the result, later on.</p>\n\n<p>OLE Server software will be noted in the Registry. The Microsoft Office applications (Word, Excel, PowerPoint, etc.) are able to function as OLE Servers. In the Registry you'll find corresponding entries such as <code>Word.Document</code> and <code>Excel.Workbook</code>... or <code>AcroExch.Document</code> for PDF files <em>if</em> Microsoft Office and the Adobe Acrobat Reader are installed. </p>\n\n<p>One way to figure out which <code>ClassType</code>s to use would be to manually insert each file type and inspect the resulting <code>Embed</code> field code. </p>\n\n<p>To look the <code>ClassType</code>s up in the Registry, something like the following code sample can be used in Word. Word has the function <code>System.PrivateProfileString</code> that wraps up a Windows API call to the Registry. It can be used to retrieve and to write information. (This code does not loop the files in a directory as the question was about how to determine the <code>ClassType</code>. For the sake of simplicity a file extension is hard-coded.)</p>\n\n<p>A file type that does not have an OLE Server won't have a <code>.</code> in the default value of the Registry key. A <code>.txt</code> file, for example, is listed as <code>txtfile</code>. You may have to watch out for some file types; for example on my installation a <code>csv</code> file is listed as <code>Excel.CSV</code>, which may not be what you want...</p>\n\n<pre><code>Sub RetrieveOLEInfo()\n    Dim fileExt As String\n    Dim regKey As String\n    Dim oleServer As String\n\n    fileExt = \"docx\"\n    regKey = \"HKEY_Classes_Root\\.\"\n    oleServer = System.PrivateProfileString(\"\", regKey &amp; fileExt, \"\")\n    'Debug.Print oleServer\n    If InStr(oleServer, \".\") = 0 Then\n        Debug.Print \"Insert as a Package\"\n    Else\n        Debug.Print \"Insert as: \" &amp; oleServer\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1544029050, "creation_date": 1544016807, "last_edit_date": 1544029050, "question_id": 53633546, "link": "https://stackoverflow.com/questions/53633546/how-to-discover-oleobject-classtype-of-files", "title": "How to discover Oleobject ClassType of files?", "body": "<p>I'm stuck how to determine files' Classtypes needed to use in code to embed these files into a Word document:</p>\n\n<pre><code>Selection.InlineShapes.AddOLEObject ClassType:=\"AcroExch.Document.11\", _\n        FileName:=\"C:\\Work\\Dashbaord &amp; \".pdf\", LinkToFile:=False, _\n        DisplayAsIcon:=False\n</code></pre>\n\n<p>I need to embed csv, pdf, xlsx and txt files. How I can automatically loop all files in folders and automatically determine the <code>ClassType</code> of each?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 1, "creation_date": 1544019790, "post_id": 53634396, "comment_id": 94128208, "body": "You beat me to it. :) In addition, I&#39;d recommend something like <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">this</a> as a lecture for OP."}], "tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 1, "last_activity_date": 1544023039, "last_edit_date": 1544023039, "creation_date": 1544019616, "answer_id": 53634396, "question_id": 53633512, "link": "https://stackoverflow.com/questions/53633512/how-can-i-return-two-header-rows/53634396#53634396", "title": "How can I return two header rows?", "body": "<h1>Paste Range Into Array</h1>\n\n<p>That's all you need (no looping).</p>\n\n<pre><code>Sub CIB_Cuts()\n    Dim varArray As Variant\n\n    With ThisWorkbook.Worksheets(\"Data\")\n      varArray = .Range(\"A1:S2\")\n    End With\n</code></pre>\n\n<p><strong>This is a one-based two-dimensional 'horizontal' array i.e. it contains more columns than rows. So when you loop through it, it might look like this:</strong></p>\n\n<pre><code>For j = LBound(varArray, 2) to UBound(varArray, 2) ' more data\n  For i = LBound(varArray) to UBound(varArray)\n    x = varArray(i, j)\n  Next  \nNext\n</code></pre>\n\n<p><strong>instead of the classical 'vertical' array looping:</strong> </p>\n\n<pre><code>For i = LBound(varArray) to UBound(varArray) ' more data\n  For j = LBound(varArray, 2) to UBound(varArray, 2)\n    x = varArray(i, j)\n  Next\nNext\n</code></pre>\n\n<p><strong>So if you want to loop through the data of first row (now in first column of array) you would do the following:</strong></p>\n\n<pre><code>For i = LBound(varArray) to UBound(varArray) ' more data\n  x = varArray(1, i)\nNext\n</code></pre>\n\n<p><strong>or for the second row (now in second column of array) you would do this:</strong></p>\n\n<pre><code>For i = LBound(varArray) to UBound(varArray) ' more data\n  x = varArray(2, i)\nNext\n</code></pre>\n\n<p><strong>The complete code could look like this:</strong></p>\n\n<pre><code>Option Explicit\n\nSub CIBCutsPaste()\n    Dim varArray As Variant\n\n    With ThisWorkbook.Worksheets(\"Data\")\n      varArray = .Range(\"A1:S2\")\n    End With\n\n    ' Print contents to Immediate Window\n    With ThisWorkbook.Worksheets(\"Data\")\n      Dim str1 As String\n      Dim k As Integer\n      Dim x As Integer\n      For k = 1 To UBound(varArray)         ' 2 Rows\n        For x = 1 To UBound(varArray, 2)    ' 19 Columns\n          If x = 1 Then\n            str1 = str1 &amp; vbCr &amp; varArray(k, x)\n           Else\n            str1 = str1 &amp; \",\" &amp; varArray(k, x)\n          End If\n        Next\n      Next\n      Debug.Print str1\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>If you insist on looping i.e. copying rows of worksheet into columns of array, it could look like this:</strong></p>\n\n<pre><code>Sub CIBCutsLoop()\n    k As Long, x As Long\n    Dim varArray() As Variant\n    ReDim varArray(1 To 19, 1 To 2)\n\n    With ThisWorkbook.Worksheets(\"Data\")\n        For k = 1 To UBound(varArray)         ' 19 Rows\n            For x = 1 To UBound(varArray, 2)  ' 2 Columns\n                varArray(k, x) = .Cells(x, k)\n            Next\n        Next\n    End With\n\n    ' Print contents to Immediate Window\n    With ThisWorkbook.Worksheets(\"Data\")\n        Dim str1 As String\n        For k = 1 To UBound(varArray)         ' 19 Rows\n            For x = 1 To UBound(varArray, 2)  ' 2 Columns\n                If x = 1 Then\n                    str1 = str1 &amp; vbCr &amp; varArray(k, x)\n                  Else\n                    str1 = str1 &amp; \",\" &amp; varArray(k, x)\n                End If\n            Next\n        Next\n        Debug.Print str1\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1544038639, "post_id": 53635541, "comment_id": 94138560, "body": "it compiles the two rows into the array, but it presents a <code>subscript out of range</code> error on this line <code>varArray(k, x) = vDB(k, x)</code>"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1544058877, "post_id": 53635541, "comment_id": 94145591, "body": "@nicklanta, In my test, it works well. I added a picture to my answer."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 0, "last_activity_date": 1544058739, "last_edit_date": 1544058739, "creation_date": 1544023469, "answer_id": 53635541, "question_id": 53633512, "link": "https://stackoverflow.com/questions/53633512/how-can-i-return-two-header-rows/53635541#53635541", "title": "How can I return two header rows?", "body": "<p>You can use static arrays and dynamic arrays appropriately. vDB is static array.</p>\n\n<pre><code>Dim j As Long, k As Long, x As Long\nDim varArray() As Variant\nDim varArray2() As Variant\nDim vDB As Variant\n\nReDim varArray(1 To 2, 1 To 19)\n\n        With ThisWorkbook.Worksheets(\"Data\")\n            vDB = .Range(\"a1\").Resize(2, 19) '&lt;~~vDB It is itself a two-line header.\n            'if you want to pass data to a varArray array\n            For k = 1 To UBound(varArray, 1)\n                For x = 1 To UBound(varArray, 2)\n                    varArray(k, x) = vDB(k, x)\n                Next x\n            Next\n\n        End With\n</code></pre>\n\n<p>Working image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/n8et2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n8et2.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 53635541, "answer_count": 2, "score": 1, "last_activity_date": 1565525718, "creation_date": 1544016702, "last_edit_date": 1565525718, "question_id": 53633512, "link": "https://stackoverflow.com/questions/53633512/how-can-i-return-two-header-rows", "title": "How can I return two header rows?", "body": "<p>Below, I have part of a script that grabs the header row of a master file into an array before grabbing other data and printing it into a new worksheet. </p>\n\n<pre><code>Option Explicit\n\nSub CIB_Cuts()\n    Dim j As Long, k As Long, x As Long\n    Dim varArray() As Variant\n    Dim varArray2() As Variant\n    ReDim varArray(1 To 19, 1 To 1)\n\n    With ThisWorkbook.Worksheets(\"Data\")\n        ReDim varArray(1 To UBound(varArray, 1), 1 To 1)\n        x = 1\n        For k = 1 To UBound(varArray, 1)\n            varArray(k, x) = .Cells(1, k)\n        Next\n</code></pre>\n\n<p>What would I change to extract the first row for 19 columns and then then second row for 19 columns before it grabs the specific data I want elsewhere? \nI have two header rows and can extract only one.</p>\n\n<p>Would I change the <code>ReDim varArray(1 To 19, 1 To 1)</code> to <code>ReDim varArray(1 To 19, 1 To 2</code> or would I have to edit the <code>with</code> statement below that?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544026353, "post_id": 53633158, "comment_id": 94132485, "body": "I&#39;m not really clear on what this last object is. On the one hand you say &quot;On top of that picture exists another chart&quot; and then you say &quot;the last one as the picture type does not have a chart object&quot;. Is the chart &quot;on top&quot; of the picture? Or is it in a Drawing Canvas? Or is it a static picture? You might try querying Word with <code>ActiveDocument.Shapes.Count</code>. If, as you say, it&#39;s &quot;on top of the picture&quot; then it would be a <code>Shape</code>, not an <code>InlineShape</code>."}, {"owner": {"reputation": 1, "user_id": 10749529, "user_type": "registered", "profile_image": "https://graph.facebook.com/1988690967879642/picture?type=large", "display_name": "Marek Pawlaczyk", "link": "https://stackoverflow.com/users/10749529/marek-pawlaczyk"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544028607, "post_id": 53633158, "comment_id": 94133831, "body": "Thank you Cindy, reffering to the objet using Shapes solved the problem"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544029187, "post_id": 53633158, "comment_id": 94134159, "body": "Glad it helped :-) FWIW you could make your code more effiicient by not repeating the entire hierarchy <code>ActiveDocument.InlineShapes(6).Chart.ChartData</code> in every line. Try, for example: <code>Dim cd as ChartData : Set cd= ActiveDocument.InlineShapes(6).Chart.ChartData</code> and then you can use <code>cd.Activate</code>, etc."}], "owner": {"reputation": 1, "user_id": 10749529, "user_type": "registered", "profile_image": "https://graph.facebook.com/1988690967879642/picture?type=large", "display_name": "Marek Pawlaczyk", "link": "https://stackoverflow.com/users/10749529/marek-pawlaczyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544026359, "creation_date": 1544015563, "last_edit_date": 1544026359, "question_id": 53633158, "link": "https://stackoverflow.com/questions/53633158/acessing-chart-data-in-a-picture-type-inline-object", "title": "Acessing chart data in a Picture Type Inline object", "body": "<p>I'm currently working on a simple word macro that reads data from an excel spreadsheet and inserts it into specified places in multiple word documents.</p>\n\n<p>Apart from placing the data as text the macro also inserts data into existing charts in the Word template.</p>\n\n<p>To do this im using the InlineShapes object like such:</p>\n\n<pre><code>ActiveDocument.InlineShapes(6).Chart.ChartData.Activate\nActiveDocument.InlineShapes(6).Chart.ChartData.Workbook.Worksheets(1).Range(\"B2\").Value = uwp\nActiveDocument.InlineShapes(6).Chart.ChartData.Workbook.Worksheets(1).Range(\"C2\").Value = uwpsamo\nActiveDocument.InlineShapes(6).Chart.ChartData.Workbook.Worksheets(1).Range(\"D2\").Value = uwpprze\nActiveDocument.InlineShapes(6).Chart.ChartData.Workbook.Worksheets(1).Range(\"E2\").Value = uwprown\nActiveDocument.InlineShapes(6).Chart.ChartData.Workbook.Worksheets(1).Range(\"F2\").Value = uwppodw\nActiveDocument.InlineShapes(6).Chart.ChartData.Workbook.Close\n</code></pre>\n\n<p>This works fine with one excepton</p>\n\n<p>There is a total of 18 inline objects in my word document, first is of type 3 (picture), after that 16 are of type 12 (chart) and the last one is of type 3 (picture again). The last one is the problem. On top of that picture exists another chart which is not in ActiveDocument.InlineShapes collection</p>\n\n<p><img src=\"https://i.stack.imgur.com/gvSbf.png\" alt=\"enter image description here\"></p>\n\n<p>Any idea how to access the chart data in the last inline shape?\nInlineShapes.Chart does not work for the last one as the picture type does not have a chart object.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1544015802, "post_id": 53632901, "comment_id": 94125821, "body": "Sheets(&quot;Sheet1&quot;).Name = NewName    should be either Sheets(&quot;Files&quot;).Name = NewName  or Sheets(1).Name = NewName"}], "answers": [{"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1544106835, "post_id": 53633402, "comment_id": 94165770, "body": "Also worth checking that the sheet name isn&#39;t already in use!"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1544106669, "last_edit_date": 1544106669, "creation_date": 1544016310, "answer_id": 53633402, "question_id": 53632901, "link": "https://stackoverflow.com/questions/53632901/excel-vba-let-user-to-input-new-sheet-name/53633402#53633402", "title": "Excel VBA let user to input new sheet name", "body": "<p>Try using</p>\n\n<pre><code>With Sheets.Add\n    .Name = NewName\n    .Range(\"A1\").Resize(AllFiles.Count, 1) = WorksheetFunction.Transpose(AllFiles.keys)\nEnd With\n</code></pre>\n\n<p>Also, no need to to loop to test if the sheet exists. Use Error Handling instead</p>\n\n<pre><code>Dim FilesSheet as Worksheet\n\nOn Error Resume Next\nSet FilesSheet = Thisworkbook.Sheets(\"Files\")\nOn Error GoTo 0\n\nIf Not FilesSheet is Nothing then\n    F = True\n    Set FilesSheet = ThisWorkbook.Sheets.Add\n    FilesSheet.Name = NewName\nElse\n    F = False\n    FilesSheet.Cells.Delete\nEnd If\n\nFilesSheet.Range(\"A1\").Resize(AllFiles.Count, 1) = WorksheetFunction.Transpose(AllFiles.keys)\n</code></pre>\n\n<p>If you are creating this for End Users you may also want to build in functionality to check that the <code>NewName</code> they enter isn't too long (>31 Characters) for an Excel Sheet Name and doesn't contain any illegal characters (<kbd>\\</kbd> <kbd>/</kbd> <kbd>*</kbd> <kbd>[</kbd> <kbd>]</kbd> <kbd>:</kbd> <kbd>?</kbd>)</p>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 53633402, "answer_count": 1, "score": 2, "last_activity_date": 1581745638, "creation_date": 1544014686, "last_edit_date": 1581745638, "question_id": 53632901, "link": "https://stackoverflow.com/questions/53632901/excel-vba-let-user-to-input-new-sheet-name", "title": "Excel VBA let user to input new sheet name", "body": "<p>I have code to list all files in chosen folder. Now it creates new sheet with name \"Files\". How to modify this code to let user input folder name every time he clicks the button? So basically scenario would look like this:</p>\n\n<ol>\n<li>Click button</li>\n<li>Choose folder to List files from</li>\n<li>Type new Worksheet name where files will be listed</li>\n<li>Code processed</li>\n<li>Click button</li>\n<li>Choose folder to List files from</li>\n<li>Type new Worksheet name where files will be listed</li>\n<li>Code processed</li>\n<li>Same actions till the end of the world</li>\n</ol>\n\n<p>I have tried this one but probably have mistakes inputting to my code:</p>\n\n<pre><code>Dim NewName As String \nNewName = InputBox(\"What Do you Want to Name the Sheet1 ?\") \nSheets(\"Sheet1\").Name = NewName \n</code></pre>\n\n<p>I have tried to modify this with:</p>\n\n<pre><code>Sheets.Add.Name = NewName\n        Sheets(NewName).[A1].Resize(AllFiles.Count, 1) = WorksheetFunction.Transpose(AllFiles.keys)\n</code></pre>\n\n<p>My code for listing files and full path to each file:</p>\n\n<pre><code>Sub ListAllFilesInAllFolders()\n\n    Dim MyPath As String, MyFolderName As String, MyFileName As String\n    Dim i As Integer, F As Boolean\n    Dim objShell As Object, objFolder As Object, AllFolders As Object, AllFiles As Object\n    Dim MySheet As Worksheet\n\n    On Error Resume Next\n\n    '************************\n    'Select folder\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objFolder = objShell.BrowseForFolder(0, \"\", 0, 0)\n    If Not objFolder Is Nothing Then\n        'MyPath = \n        MyPath = objFolder.self.Path &amp; \"\\\"\n    Else\n        Exit Sub\n\n    End If\n    Set objFolder = Nothing\n    Set objShell = Nothing\n\n    '************************\n    'List all folders\n\n    Set AllFolders = CreateObject(\"Scripting.Dictionary\")\n    Set AllFiles = CreateObject(\"Scripting.Dictionary\")\n    AllFolders.Add (MyPath), \"\"\n    i = 0\n    Do While i &lt; AllFolders.Count\n        Key = AllFolders.keys\n        MyFolderName = Dir(Key(i), vbDirectory)\n        Do While MyFolderName &lt;&gt; \"\"\n            If MyFolderName &lt;&gt; \".\" And MyFolderName &lt;&gt; \"..\" Then\n                If (GetAttr(Key(i) &amp; MyFolderName) And vbDirectory) = vbDirectory Then\n                    AllFolders.Add (Key(i) &amp; MyFolderName &amp; \"\\\"), \"\"\n                End If\n            End If\n            MyFolderName = Dir\n        Loop\n        i = i + 1\n    Loop\n\n    'List all files\n    For Each Key In AllFolders.keys\n        MyFileName = Dir(Key &amp; \"*.*\")\n        'MyFileName = Dir(Key &amp; \"*.PDF\")    'only PDF files\n        Do While MyFileName &lt;&gt; \"\"\n            AllFiles.Add (Key &amp; MyFileName), \"\"\n            MyFileName = Dir\n        Loop\n    Next\n\n    '************************\n    'List all files in Files sheet\n\n    For Each MySheet In ThisWorkbook.Worksheets\n        If MySheet.Name = \"Files\" Then\n            Sheets(\"Files\").Cells.Delete\n            F = True\n            Exit For\n        Else\n            F = False\n        End If\n    Next\n    If Not F Then Sheets.Add.Name = \"Files\"\n\n    'Sheets(\"Files\").[A1].Resize(AllFolders.Count, 1) = WorksheetFunction.Transpose(AllFolders.keys)\n    Sheets(\"Files\").[A1].Resize(AllFiles.Count, 1) = WorksheetFunction.Transpose(AllFiles.keys)\n    Set AllFolders = Nothing\n    Set AllFiles = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2016"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1544016207, "post_id": 53632593, "comment_id": 94126031, "body": "Me.ListView.Form.filter = &quot;ControlDate &gt;=&quot; &amp; format(Me.DateSelector.Value,&quot;dd mmm yyyy&quot;)  might be worth a try"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1544016830, "post_id": 53632593, "comment_id": 94126426, "body": "I would also check to see if the .filter command needs dates to be wrapped in hash characters (#1/1/18#). VBA needs dates in between hashes. Since you getting invalid operator, this seems to be the most likely cuase imo"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10051952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0f83f5b4db53861b1341788315310d?s=128&d=identicon&r=PG&f=1", "display_name": "Ninsa", "link": "https://stackoverflow.com/users/10051952/ninsa"}, "edited": false, "score": 0, "creation_date": 1544018171, "post_id": 53633745, "comment_id": 94127203, "body": "Many thanks, that worked perfectly. I didn&#39;t know that Access not only needed hashes for formatted dates but also dates to be casted for format. I apprechiate it :)"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1544017388, "creation_date": 1544017388, "answer_id": 53633745, "question_id": 53632593, "link": "https://stackoverflow.com/questions/53632593/ms-access-filtering-for-date-causes-error-3075/53633745#53633745", "title": "MS Access filtering for date causes Error 3075", "body": "<p>You filter will end up as:</p>\n\n<pre><code>\"ControlDate &gt;= 01.12.2018\"\n</code></pre>\n\n<p>which Access cannot read. So, apply a proper format of the string expression of the date value:</p>\n\n<pre><code>\"ControlDate &gt;= #\" &amp; Format(Me!DateSelector.Value, \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10051952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e0f83f5b4db53861b1341788315310d?s=128&d=identicon&r=PG&f=1", "display_name": "Ninsa", "link": "https://stackoverflow.com/users/10051952/ninsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 53633745, "answer_count": 1, "score": 0, "last_activity_date": 1544017388, "creation_date": 1544013664, "last_edit_date": 1544017205, "question_id": 53632593, "link": "https://stackoverflow.com/questions/53632593/ms-access-filtering-for-date-causes-error-3075", "title": "MS Access filtering for date causes Error 3075", "body": "<p>I have a text field, called <code>DateSelector</code> that is formatted as a <em>Short Date</em>, and a subform with a list of entries, one column named <code>ControlDate</code> contains values that are formatted as <em>Short Date</em> as well.</p>\n\n<p>What I want:<br>\nIf you change the value of <code>DateSelector</code> it is supposed to filter the column <code>ControlDate</code> to between now and the value of <code>DateSelector</code>, or at least be below that of <code>DateSelector</code>.</p>\n\n<p>This is the code I have:</p>\n\n<pre><code>Private Sub DateSelector_AfterUpdate()\nOn Error GoTo Proc_Error\n\nIf Me.DateSelector.Value = \"\" Then\n   Me.ListView.Form.filter = \"\"\n   Me.ListView.Form.FilterOn = False\n\nElse\n    MsgBox (Me.DateSelector.Value)\n'This is a Check, if the Value is correct.\n    Me.ListView.Form.filter = \"ControlDate &gt;=\" &amp; Me.DateSelector.Value\n    Me.ListView.Form.FilterOn = True\nEnd If\nProc_Exit:\n   Exit Sub\nProc_Error:\n   MsgBox \"Error \" &amp; Err.Number &amp; \" when creating Filter:\" &amp; vbCrLf &amp; Err.Description\n   Resume Proc_Exit\nEnd Sub\n</code></pre>\n\n<p>The error thrown is <code>3075: Syntax Error</code>. The <code>MsgBox</code> shows the correct date, where the error message shows the date missing the last digit (e.g.: 05.12.2018 --> 05.12.201) and I have absolutely no clue why.</p>\n\n<p>I am thankfull for any answers, thank you for reading,</p>\n\n<p>_Ninsa</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 444, "user_id": 3375218, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/333e24c726e1fd787becb4ecbf6e4e55?s=128&d=identicon&r=PG", "display_name": "juanora", "link": "https://stackoverflow.com/users/3375218/juanora"}, "edited": false, "score": 0, "creation_date": 1544013146, "post_id": 53632348, "comment_id": 94124200, "body": "I guess you cant... you need to copy and paste twice"}, {"owner": {"reputation": 444, "user_id": 3375218, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/333e24c726e1fd787becb4ecbf6e4e55?s=128&d=identicon&r=PG", "display_name": "juanora", "link": "https://stackoverflow.com/users/3375218/juanora"}, "edited": false, "score": 0, "creation_date": 1544013231, "post_id": 53632348, "comment_id": 94124257, "body": "AN2:AP1000 is inside the range of A2:A1000 so you can just copy and paste A2:A1000"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1544013234, "post_id": 53632348, "comment_id": 94124261, "body": "Also why are you copying 1000 rows if you just want to copy 20 rows?"}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544013308, "post_id": 53632348, "comment_id": 94124296, "body": "Because I have 1000 rows and after I filter my data,I could have one at row 400"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1544013422, "post_id": 53632348, "comment_id": 94124370, "body": "Ah...then you may just need to paste to <code>range(&quot;O15&quot;)</code> and <code>range(&quot;N15&quot;)</code>"}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544013658, "post_id": 53632348, "comment_id": 94124512, "body": "But by using Range(&quot;AN2:AP1000&quot;).Select it just pastes more than 20 data, that s the one I have to adjust, if I choose AP20, that just selectes 2 rows of data. I dont know what&#39;s wrong..."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1544013924, "post_id": 53632348, "comment_id": 94124665, "body": "I was just saying to paste to one cell, not a range of cells. @Harassed Dad answer is correct as the code is not selecting the cells, that way just the visible cells will be copied., but I would still recommend to just paste to O15 and N15"}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544014849, "post_id": 53632348, "comment_id": 94125223, "body": "His code doesn&#39;t work..."}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544017343, "post_id": 53632348, "comment_id": 94126740, "body": "I have posted an update with an image of the table to be copied"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544014801, "post_id": 53632465, "comment_id": 94125195, "body": "I get a lot of errors from with windows and the range from dest1"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544015889, "post_id": 53632465, "comment_id": 94125868, "body": "is there actually a Workbook2 open when you run it? Are you sure it&#39;s not named Workbook2.xlsx ?"}, {"owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544016252, "post_id": 53632465, "comment_id": 94126058, "body": "Yes, it is opened and it&#39;s an xlsm. I put the extension but it still gives me this error: &quot;Object doesn&#39;t support the property or method&quot;"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "edited": false, "score": 0, "creation_date": 1544020293, "post_id": 53632465, "comment_id": 94128570, "body": "Sorry, I had a senile moment - it&#39;s workbook not windows - see edit in my answer"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1544539190, "last_edit_date": 1544539190, "creation_date": 1544013239, "answer_id": 53632465, "question_id": 53632348, "link": "https://stackoverflow.com/questions/53632348/excel-copy-a-range-of-cells-to-another-workbook/53632465#53632465", "title": "Excel copy a range of cells to another workbook", "body": "<p>Never use select or activate - use range variables instead</p>\n\n<pre><code>dim Source1 as range\ndim source2 as range\ndim dest1 as range\ndim dest2 as range\nset source1 = Range(\"A2:A1000\").SpecialCells(xlCellTypeVisible)\nset source2 = Range(\"AN2:AP1000\").SpecialCells(xlCellTypeVisible)\nwith Workbooks(\"Workbook2\").worksheets(1)  'i assume first sheet\n     set dest1 = .Range(\"O15\") \n     set dest2 = .Range(\"N15\")\nend with\nsource1.copy dest1\nsource2.copy dest2\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10738998, "user_type": "registered", "profile_image": "https://graph.facebook.com/2088443494547813/picture?type=large", "display_name": "Mazilu Isabela Elena", "link": "https://stackoverflow.com/users/10738998/mazilu-isabela-elena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581745650, "creation_date": 1544012896, "last_edit_date": 1581745650, "question_id": 53632348, "link": "https://stackoverflow.com/questions/53632348/excel-copy-a-range-of-cells-to-another-workbook", "title": "Excel copy a range of cells to another workbook", "body": "<p>In the first workbook, after I filter all the cells, I have to copy the first 20 rows into another workbook. </p>\n\n<p>This is my code, but I don't know how to make it copy the first 20 rows:</p>\n\n<pre><code>Range(\"AN2:AP1000\").Select\nRange(\"A2:A1000\").Select\nSelection.Copy\nWindows(\"Workbook2\").Activate\nRange(\"O15:Q35\").Select\nRange(\"N15:N35\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I have 2 ranges because the data to copy is on 2 different columns.\nThis is the table to be copied(first 20 rows of data):\n<a href=\"https://i.stack.imgur.com/phmBV.png\" rel=\"nofollow noreferrer\">table</a></p>\n"}, {"tags": ["c#", "vba", "visual-studio", "dll"], "comments": [{"owner": {"reputation": 465, "user_id": 2292368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9656238f23065edc53ad0731600997a8?s=128&d=identicon&r=PG", "display_name": "Jay Buckman", "link": "https://stackoverflow.com/users/2292368/jay-buckman"}, "edited": false, "score": 0, "creation_date": 1544012542, "post_id": 53632182, "comment_id": 94123823, "body": "Since the class is static, call <code>ThingOne.Method1();</code>"}, {"owner": {"reputation": 6439, "user_id": 5427842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FqbRH.jpg?s=128&g=1", "display_name": "S\u1d07M", "link": "https://stackoverflow.com/users/5427842/s%e1%b4%87m"}, "edited": false, "score": 0, "creation_date": 1544012745, "post_id": 53632182, "comment_id": 94123928, "body": "Why you made your class and method static? Is there any reason to do so?"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1544012794, "post_id": 53632182, "comment_id": 94123957, "body": "Why doesn&#39;t it give me intellisense options for this as defined by my interface? Also, it doesn&#39;t work - it tells me an object is required, but this might be due to the &quot;whatever&quot; - I&#39;m going to try and simplify the method &quot;whatever&quot; and see what happens."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 6439, "user_id": 5427842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FqbRH.jpg?s=128&g=1", "display_name": "S\u1d07M", "link": "https://stackoverflow.com/users/5427842/s%e1%b4%87m"}, "edited": false, "score": 0, "creation_date": 1544012880, "post_id": 53632182, "comment_id": 94124024, "body": "@SeM it&#39;s a connection class, so I didn&#39;t really want to have people create multiple instances of it. I wanted to have it as a static one-off, with the connection initialised each time the &quot;send request&quot; methods are called."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1544012906, "post_id": 53632182, "comment_id": 94124037, "body": "Strictly speaking I could just make this easy for myself by removing static but I&#39;m curious to why it&#39;s not working with intellisense."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "reply_to_user": {"reputation": 6439, "user_id": 5427842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FqbRH.jpg?s=128&g=1", "display_name": "S\u1d07M", "link": "https://stackoverflow.com/users/5427842/s%e1%b4%87m"}, "edited": false, "score": 0, "creation_date": 1544012973, "post_id": 53632182, "comment_id": 94124078, "body": "OK after reading the answers in the link provided by @SeM I&#39;ve decided to remove static altogether."}, {"owner": {"reputation": 6439, "user_id": 5427842, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FqbRH.jpg?s=128&g=1", "display_name": "S\u1d07M", "link": "https://stackoverflow.com/users/5427842/s%e1%b4%87m"}, "edited": false, "score": 0, "creation_date": 1544013024, "post_id": 53632182, "comment_id": 94124119, "body": "@jamheadart you can accept duplicate question and this one will be marked as duplicate and closed."}], "owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "closed_date": 1544013870, "answer_count": 0, "score": 0, "last_activity_date": 1544012332, "creation_date": 1544012332, "question_id": 53632182, "link": "https://stackoverflow.com/questions/53632182/visual-studio-using-compiled-static-classes-in-client-apps", "closed_reason": "Duplicate", "title": "Visual Studio - Using compiled static classes in client apps", "body": "<p>I've created a library and can instance this and call methods from Excel VBA no problem, having registered it all for COM interop etc.</p>\n\n<pre><code>[ComVisible(true)]\n[InterfaceType(ComInterfaceType.InterfaceIsIDispatch)]\n[Guid(\"blahblahblah1\")]\npublic interface IThingOne\n{\n    bool Method1();\n}\n\n\n[ComVisible(true)]\n[ClassInterface(ClassInterfaceType.None)]\n[ProgId(\"NameSpace.ThingOne\")]\n[Guid(\"blahblahblah2\")]\npublic class ThingONe\n{\n    public bool Method1() { //Whatever; }\n}\n</code></pre>\n\n<p>If I apply STATIC keyword to the <code>public class ThingOne</code> and the <code>public bool Method1()</code> then how can I call these static methods? I can't instantiate them because they're static. I don't want to instantiate them. I just want to be able to call them.</p>\n\n<p>The most I can get working in VBA is</p>\n\n<pre><code>Dim x as ThingOne\n</code></pre>\n\n<p>Can't do <code>Dim x as new ThingOne</code> and then I can't get the methods to work e.g. \n<code>x.Method1</code></p>\n\n<p>When I do the intellisense dropdown for x I get standard <code>Equals, GetHashCode, GetType and ToString</code></p>\n"}, {"tags": ["excel", "vba", "outlook", "outlook-filter"], "comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1544025283, "post_id": 53631775, "comment_id": 94131875, "body": "today()  is not enable. Cange to date"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1544046899, "post_id": 53631775, "comment_id": 94142202, "body": "Try implementing a restrict <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.items.restrict\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/outlook.items.restri&zwnj;&#8203;ct</a> based on aKey which is Category then sort by date. Example sort the opposite way <a href=\"https://stackoverflow.com/questions/32443783/how-to-sort-emails-by-date-and-open-the-latest-email-found\" title=\"how to sort emails by date and open the latest email found\">stackoverflow.com/questions/32443783/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1544084195, "creation_date": 1544084195, "answer_id": 53647165, "question_id": 53631775, "link": "https://stackoverflow.com/questions/53631775/get-the-date-of-the-oldest-mail-per-category/53647165#53647165", "title": "Get the date of the oldest mail per category", "body": "<p><em>Work with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Outlook.Items.GetFirst\" rel=\"nofollow noreferrer\">Items.GetFirst Method (Outlook)</a> which Returns An Object value that represents the first object contained by the collection</em> </p>\n\n<p><em>Code Example</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim olNs As Outlook.NameSpace\n    Set olNs = Application.GetNamespace(\"MAPI\")\n\n    Dim Inbox  As Outlook.MAPIFolder\n    Set Inbox = olNs.GetDefaultFolder(olFolderInbox)\n\n    Dim Items As Outlook.Items\n    Set Items = Inbox.Items.Restrict(\"[Categories] = 'Red Category'\")\n\n    Dim Item As Object\n    Set Item = Items.GetFirst\n\n    Debug.Print Item.Subject &amp; \" \" &amp; Item.ReceivedTime\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10705092, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T0o1ZwnX6QI/AAAAAAAAAAI/AAAAAAAAAVI/bNYE-rp3crw/photo.jpg?sz=128", "display_name": "Abhishek Singhal", "link": "https://stackoverflow.com/users/10705092/abhishek-singhal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592723558, "creation_date": 1544010964, "last_edit_date": 1592723558, "question_id": 53631775, "link": "https://stackoverflow.com/questions/53631775/get-the-date-of-the-oldest-mail-per-category", "title": "Get the date of the oldest mail per category", "body": "<p>I have a macro to get the count of mails category-wise in Outlook.</p>\n\n<p>Along with that I want the oldest mail date in a particular category. e.g. in the Red category there are 20 mails, so what is the date of the oldest mail in the Red category?</p>\n\n<pre><code>Sub CategoriesEmails()\n\nDim oFolder As MAPIFolder\nDim oDict As Object\nDim sStartDate As String\nDim sEndDate As String\nDim oItems As Outlook.Items\nDim sStr As String\nDim sMsg As String\nDim strFldr As String\nDim OutMail As Object\nDim xlApp As Object\n\nOn Error Resume Next\nSet oFolder = Application.ActiveExplorer.CurrentFolder\n\nSet oDict = CreateObject(\"Scripting.Dictionary\")\n\nsStartDate = Date - 365\nsEndDate = Date\nSet oItems = oFolder.Items.Restrict(\"[Received] &gt;= '\" &amp; sStartDate &amp; \"' And [Received] &lt;= '\" &amp; sEndDate &amp; \"'\")\noItems.SetColumns (\"Categories\")\n\nFor Each aItem In oItems\nsStr = aItem.Categories\nIf Not oDict.Exists(sStr) Then\noDict(sStr) = 0\nEnd If\noDict(sStr) = CLng(oDict(sStr)) + 1\nNext aItem\n\nsMsg = \"\"\ni = 0\n\nstrFldr = \"C:\\Users\\singhab\\Desktop\\Macro\\\"\nSet xlApp = CreateObject(\"Excel.Application\")\nxlApp.Application.Visible = True\nxlApp.Workbooks.Open strFldr &amp; \"Test.xlsx\"\nxlApp.Sheets(\"Sheet1\").Select\nFor Each aKey In oDict.Keys\nxlApp.Range(\"a1\").Offset(i, 0).Value = sMsg &amp; aKey\nxlApp.Range(\"B1\").Offset(i, 0).Value = oDict(aKey) &amp; vbCrLf\ni = i + 1\nNext\nxlApp.Save\n\nSet oFolder = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I get the output<br>\n<a href=\"https://i.stack.imgur.com/AM9NJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AM9NJ.png\" alt=\"Result after running the above macro\"></a></p>\n\n<p>What I want is<br>\n<a href=\"https://i.stack.imgur.com/MjU0j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MjU0j.png\" alt=\"oldest mail date for each particular category\"></a></p>\n"}, {"tags": ["oracle", "ms-access", "vba", "data-transfer"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "edited": false, "score": 0, "creation_date": 1544014729, "post_id": 53632123, "comment_id": 94125147, "body": "Hi thanks for the heads up on the acexport. This method of &quot;User.&quot; &amp; tbloracle triggers another run time error &#39;3450&#39; which says syntax in error. Incomplete query clause"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "edited": false, "score": 0, "creation_date": 1544014860, "post_id": 53632123, "comment_id": 94125229, "body": "Well, what <i>is</i> your target table in Oracle? I suggest to supply the full actual name for the <code>Destination</code> parameter as constant string while testing."}, {"owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "edited": false, "score": 0, "creation_date": 1544015115, "post_id": 53632123, "comment_id": 94125387, "body": "The table name is rpt."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "edited": false, "score": 0, "creation_date": 1544017325, "post_id": 53632123, "comment_id": 94126725, "body": "And what happens if you change <code>User.tbloracle</code> to <code>&quot;rpt&quot;</code> ?"}, {"owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "edited": false, "score": 0, "creation_date": 1545288313, "post_id": 53632123, "comment_id": 94574799, "body": "Sorry Andre. I was out on Vacation and the worst part is the issue still persists and when I change it to just the table name it puts up on error called ORA-1747"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1544012126, "creation_date": 1544012126, "answer_id": 53632123, "question_id": 53631657, "link": "https://stackoverflow.com/questions/53631657/do-cmd-transfer-database-vba/53632123#53632123", "title": "Do cmd Transfer Database VBA", "body": "<p>From Access to Oracle you need <code>acExport</code>, not <code>acImport</code>.</p>\n\n<p>The error is probably <code>User.tbloracle</code>, I guess you want</p>\n\n<pre><code>\"User.\" &amp; tbloracle\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9600149, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-i4lLH--Wpro/AAAAAAAAAAI/AAAAAAAACWE/GHOjIXo72tI/photo.jpg?sz=128", "display_name": "Archana", "link": "https://stackoverflow.com/users/9600149/archana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594625869, "creation_date": 1544010626, "last_edit_date": 1594625869, "question_id": 53631657, "link": "https://stackoverflow.com/questions/53631657/do-cmd-transfer-database-vba", "title": "Do cmd Transfer Database VBA", "body": "<p>Team</p>\n\n<p>Am trying to copy data from access table to oracle database using transfer database in VBA. But I get an error that says object required . This is the script and don't understand why I get this error</p>\n\n<pre><code>DoCmd.TransferDatabase acImport, _\n\"ODBC Database\", _\n\"ODBC;DSN=xxx;UID=User;PWD=#007;LANGUAGE=us_english;\" _\n&amp; \"Database=xxx\", _\nacTable, _\ntblaccess, _\nUser.tbloracle, False, False\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 780, "user_id": 8900664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/803949066451518/picture?type=large", "display_name": "Nixen85", "link": "https://stackoverflow.com/users/8900664/nixen85"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1544010371, "post_id": 53631418, "comment_id": 94122567, "body": "I have not started yet, because I am not even sure, if this is feasible. So no reason downvote me - it is not forbidden here to start from scratch."}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1544010668, "post_id": 53631418, "comment_id": 94122731, "body": "I suspect the downvotes are due to the lack of clarity in the question.  Is this a single cell with this value entered as an array?  You want to treat this value as an array, but which value do you want to extract, or do you want to be able to flexibly specify the index of the value? (etc.)"}, {"owner": {"reputation": 780, "user_id": 8900664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/803949066451518/picture?type=large", "display_name": "Nixen85", "link": "https://stackoverflow.com/users/8900664/nixen85"}, "edited": false, "score": 0, "creation_date": 1544011028, "post_id": 53631418, "comment_id": 94122952, "body": "Okay, i tried to sharpen my question. The array value stands in cell A1 as a string. I want to get the value in A1, find type &quot;brand&quot; and return the name of the brand and paste it to A2. That&#39;s all."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1544011660, "post_id": 53631418, "comment_id": 94123303, "body": "For this specific use-case, you could cobble something together by repeated use of <code>Mid</code> (to remove brackets) and <code>Split</code> (on either <code>&quot;,&quot;</code> or <code>&quot;:&quot;</code>), but it might be preferable to find a VBA JSON parser (of which there are several), since that is a difficult wheel to reinvent properly. I haven&#39;t used it, but I have seen <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">this tool</a> recommended on Stack Overflow."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1544013863, "post_id": 53631418, "comment_id": 94124625, "body": "@Nixen85 Expect to be downvoted and flagged as &quot;too broad&quot; or &quot;unclear what you&#39;re asking&quot; when treating SO like a &quot;write my code for free&quot;-service.  &quot;How can I extract the value of the array by using VBA?&quot; has lots of answers and is not a particular programming problem that you need help with. People aren&#39;t too kind on 0-effort questions."}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1544012421, "creation_date": 1544012421, "answer_id": 53632200, "question_id": 53631418, "link": "https://stackoverflow.com/questions/53631418/how-to-extract-a-value-from-an-array-in-excel-with-vba/53632200#53632200", "title": "How to extract a value from an array in excel with VBA", "body": "<p>Assumng the word brand preceeds the brand name each time then</p>\n\n<pre><code>Function GetNameOfBrand(celltext As String) As String\nDim x As Long\nDim s As String\nx = InStr(celltext, \"brand\")\nIf x = 0 Then\n    GetNameOfBrand = \"\"\nElse\n    s = Mid(celltext, x + 16, Len(celltext) - x + 15)\n    x = InStr(s, \"'\")\n    s = Left(s, x - 1)\n    GetNameOfBrand = s\nEnd If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 780, "user_id": 8900664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/803949066451518/picture?type=large", "display_name": "Nixen85", "link": "https://stackoverflow.com/users/8900664/nixen85"}, "edited": false, "score": 1, "creation_date": 1544042938, "post_id": 53633884, "comment_id": 94140467, "body": "Thank you! Both ways are working fine. This is basically what I wanted to do. The solution with JSONParser however seems more reliable to me..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 780, "user_id": 8900664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/803949066451518/picture?type=large", "display_name": "Nixen85", "link": "https://stackoverflow.com/users/8900664/nixen85"}, "edited": false, "score": 0, "creation_date": 1544043077, "post_id": 53633884, "comment_id": 94140526, "body": "It absolutely is more robust."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1544018419, "last_edit_date": 1544018419, "creation_date": 1544017828, "answer_id": 53633884, "question_id": 53631418, "link": "https://stackoverflow.com/questions/53631418/how-to-extract-a-value-from-an-array-in-excel-with-vba/53633884#53633884", "title": "How to extract a value from an array in excel with VBA", "body": "<p>You could use a custom function to read value from A1, apply split with search term and parse out the required info. It seems a bit overkill to use a JSON parser though that string is JSON and you could extract that way.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    [A2] = GetValue([a1], \"brand\")\nEnd Sub\nPublic Function GetValue(ByVal rng As Range, ByVal searchTerm As String) As Variant\n    '[{'type':'general', 'name':'light'},{'type':'brand', 'name':'lighti'},{'type':'misc', 'name':'Sale%'}]\n    On Error GoTo errhand\n    GetValue = Split(Split(rng.Value, \"{'type':'\" &amp; searchTerm &amp; \"', 'name':'\")(1), \"'\")(0)\n    Exit Function\nerrhand:\n    GetValue = CVErr(xlErrNA)\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>If you were to use a JSONParser like <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">JSONConverter.bas</a> you could parse the JSON as follows. Note: After adding the .bas to your project you need to go VBE > Tools > References and add a reference to Microsoft Scripting Runtime.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    [A2] = GetValue([a1], \"brand\")\nEnd Sub\nPublic Function ExtractItem(ByVal rng As Range, ByVal searchTerm As String) As Variant\n    Dim json As Object, key As Object\n    json = JsonConverter.ParseJson(rng.Value)\n    For Each item In json\n        For Each key In item\n            If key = searchTerm Then\n                GetValue = item(key)\n                Exit Function\n            End If\n        Next\n    Next\n    ExtractItem = CVErr(xlErrNA)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 780, "user_id": 8900664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/803949066451518/picture?type=large", "display_name": "Nixen85", "link": "https://stackoverflow.com/users/8900664/nixen85"}, "edited": false, "score": 0, "creation_date": 1544042862, "post_id": 53634196, "comment_id": 94140431, "body": "This worked like a charme and the direct access to the object seems a robust solution to get the information. Thanks. However, I asked for VBA and in this case QHarr&#39;s Answer is correct"}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 3, "last_activity_date": 1544024930, "last_edit_date": 1544024930, "creation_date": 1544018908, "answer_id": 53634196, "question_id": 53631418, "link": "https://stackoverflow.com/questions/53631418/how-to-extract-a-value-from-an-array-in-excel-with-vba/53634196#53634196", "title": "How to extract a value from an array in excel with VBA", "body": "<p>You can use ActiveX <code>ScriptControl</code> with <code>Language</code> set to <code>JScript</code> and parse the string as actual JSON. </p>\n\n<p>Then you can just write a Javascript function that returns the \"name\" based on the \"type\". For this you don't need any external libraries / other macro's etc.:</p>\n\n<pre><code>Option Explicit\nPublic Sub UseScriptControlAndJSON()\n    Dim JsonObject As Object\n    Dim resultString As String\n    Dim ScriptEngine As Object\n\n    'get the script control:\n    Set ScriptEngine = CreateObject(\"ScriptControl\")\n    ScriptEngine.Language = \"JScript\"\n\n    'Add javascript to get the \"name\" based on \"typeName\":\n    ScriptEngine.AddCode \"function findByType(jsonObj, typeName) { for (var i = 0; i &lt; jsonObj.length; i++) { if (jsonObj[i].type == typeName){ return jsonObj[i].name; }}}\"\n\n    'Get the string and parse it:\n    Set JsonObject = ScriptEngine.Eval(\"(\" &amp; Range(\"A1\").Value &amp; \")\")\n\n    'Now get the resulting \"name\" using the JS function, by passing in \"brand\" as type:\n    resultString = ScriptEngine.Run(\"findByType\", JsonObject, \"brand\")\n\n    'Will pop-up: \"lighti\"\n    MsgBox resultString\nEnd Sub\n</code></pre>\n\n<p>Note 1: that the JS function will return the first occurance.</p>\n\n<p>Note 2: Strictly speaking you're not using VBA to extract the value.</p>\n\n<p>Note 3: Tested with 32 bit Excel 2016 on a 64 bit machine; script control is a 32 bit-component - see for example this <a href=\"https://stackoverflow.com/questions/9725882/getting-scriptcontrol-to-work-with-excel-2010-x64\">question+answers</a> - On 64bit you can get it to work with some workarounds as per one of the answers in that link.</p>\n"}], "owner": {"reputation": 780, "user_id": 8900664, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/803949066451518/picture?type=large", "display_name": "Nixen85", "link": "https://stackoverflow.com/users/8900664/nixen85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1139, "favorite_count": 0, "accepted_answer_id": 53633884, "answer_count": 3, "score": 0, "last_activity_date": 1544024930, "creation_date": 1544009829, "last_edit_date": 1544011104, "question_id": 53631418, "link": "https://stackoverflow.com/questions/53631418/how-to-extract-a-value-from-an-array-in-excel-with-vba", "title": "How to extract a value from an array in excel with VBA", "body": "<p>In my table, I have a cell A1 containing an array as string with the following format: <code>[{'type':'general', 'name':'light'},{'type':'brand', 'name':'lighti'},{'type':'misc', 'name':'Sale%'}]</code></p>\n\n<p>Now I want to create a new sheet, with the name of the brand \"lighti\" as separate cell-value. This means: I want to get the value in A1, find type \"brand\" and return the name of the brand and paste it to A2. That's all.</p>\n\n<p>How can I extract the value of the array by using VBA?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 1, "creation_date": 1544010842, "post_id": 53631338, "comment_id": 94122842, "body": "I&#39;d suggest using a cell style rather than relying on copy/pasting one particular cell&#39;s formatting.  You could then name that style and apply that to any cells that require it."}, {"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "reply_to_user": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1544029149, "post_id": 53631338, "comment_id": 94134143, "body": "there are too manies diff&#233;rences from each rows"}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1544111738, "post_id": 53631338, "comment_id": 94168821, "body": "Let&#39;s assume you have 26 columns in your table and that you&#39;re applying the formatting from the top row to everything in that column - are you saying that you have a different style for each column?"}, {"owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "reply_to_user": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1544117458, "post_id": 53631338, "comment_id": 94171922, "body": "Yes, I have number, percent, standard format with center, right, left text, with different colors..."}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "is_accepted": true, "score": 0, "last_activity_date": 1544184068, "creation_date": 1544184068, "answer_id": 53669139, "question_id": 53631338, "link": "https://stackoverflow.com/questions/53631338/copy-past-format-with-conditionnals-rules/53669139#53669139", "title": "Copy/Past format with conditionnals rules", "body": "<p>If I've understood correctly, you want to apply the formatting from the top row to the rest of the cells in that column without losing the conditional formatting of those destination cells.</p>\n\n<p>You can achieve this with a slight modification to your existing code, so instead of:</p>\n\n<pre><code>Range(\"B2\").Copy\n</code></pre>\n\n<p>make it this, so all of the formats from the top row are picked up in one go:</p>\n\n<pre><code>Range(\"B2:G2\").Copy\n</code></pre>\n\n<p>Then you can then apply the formats to the whole region in one step:</p>\n\n<pre><code>Selection.CurrentRegion.PasteSpecial Paste:=xlPasteFormats\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>This will apply the formatting from the top row to each of the rows below, maintaining the formatting for each column and, crucially, the conditional formatting.</p>\n"}], "owner": {"reputation": 227, "user_id": 6573951, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2eadb862478c4a11831a27ed0fa573f0?s=128&d=identicon&r=PG&f=1", "display_name": "babou", "link": "https://stackoverflow.com/users/6573951/babou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 53669139, "answer_count": 1, "score": 0, "last_activity_date": 1581745662, "creation_date": 1544009528, "last_edit_date": 1581745662, "question_id": 53631338, "link": "https://stackoverflow.com/questions/53631338/copy-past-format-with-conditionnals-rules", "title": "Copy/Past format with conditionnals rules", "body": "<p>I have a table in a sheet.</p>\n\n<p>I clear all contents of the table in a macro.</p>\n\n<p>But I want a special format in each Column :</p>\n\n<p>A : Center, Bold, Standard format\u2026\nB : Left, Number format\u2026</p>\n\n<p>The question is How can I fit Columns to my desired format without forget the conditionnals rules !</p>\n\n<p>Because actually my code is like this :</p>\n\n<pre><code>Range(\"B2\").Select\nSelection.Copy\nRange(\"B2\").Select ''''' mise en forme Standar\nRange(Selection, Selection.End(xlDown)).Select\nSelection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _\n    SkipBlanks:=False, Transpose:=False\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Not really efficient\u2026 I copy B2 to paste to the rest of column B...</p>\n"}, {"tags": ["vba", "ms-word", "installation"], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1544012957, "creation_date": 1544012957, "answer_id": 53632372, "question_id": 53631228, "link": "https://stackoverflow.com/questions/53631228/installing-a-program-written-in-vba-changing-office-settings/53632372#53632372", "title": "Installing a program written in vba: changing office settings", "body": "<p>Macros cannot change the security level that allows macros to run, because \n1 if macros aren't allowed to run they don't run so they can't do anything \nand \n2  because otherwise bad people would do it without asking and steal all your money from your bank account whenever you opened a word document</p>\n\n<p>However, if your installer is written in some other language it could possibly change the setting. if it was run with sufficiently elevated privileges. But you shouldn't do this for all word documents because bad people. Instead, set up a trusted location - a folder whose file's can run macros, and save your file there. That maintains security for general word documents while allowing your file to run.</p>\n"}], "owner": {"reputation": 1, "user_id": 10749014, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-9R2LrLsaSvI/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iBBMIKRt7x63r9eGxLLcq3qL9T2A/mo/photo.jpg?sz=128", "display_name": "Badacsonyi Andr&#225;s", "link": "https://stackoverflow.com/users/10749014/badacsonyi-andr%c3%a1s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544035669, "creation_date": 1544009146, "last_edit_date": 1544035669, "question_id": 53631228, "link": "https://stackoverflow.com/questions/53631228/installing-a-program-written-in-vba-changing-office-settings", "title": "Installing a program written in vba: changing office settings", "body": "<p>I want to make an installer for programs (games) written in VBA(Office Word).\nThe problem I need an answer for:\nIt obviosly uses macros. For these to run the user suppose to change the security settings of word. But I can\u2019t hope that they are able to do that or willing to make that extra effort. So I was wondering if there was a way to do that with the installer. You know, ask them if they want to allow it, and then the program would change the setting of office that the game could run.\nDoes any of you know if that is possible and if it is what the program is that I should use that for?</p>\n"}, {"tags": ["vba", "ms-word", "ms-office", "word-table"], "comments": [{"owner": {"reputation": 192, "user_id": 4391394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bHzd6.jpg?s=128&g=1", "display_name": "Chandraprakash", "link": "https://stackoverflow.com/users/4391394/chandraprakash"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1544015904, "post_id": 53631041, "comment_id": 94125875, "body": "Catch here is, i need to know how to split cells to maximum number possible, which is not possible by recording as even while doing manually, we need to enter the number or rows/columns to split the cell manually. But here the code will take care of all that by itself."}], "answers": [{"tags": [], "owner": {"reputation": 192, "user_id": 4391394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bHzd6.jpg?s=128&g=1", "display_name": "Chandraprakash", "link": "https://stackoverflow.com/users/4391394/chandraprakash"}, "is_accepted": true, "score": 0, "last_activity_date": 1544016115, "last_edit_date": 1544016115, "creation_date": 1544015700, "answer_id": 53633210, "question_id": 53631041, "link": "https://stackoverflow.com/questions/53631041/how-to-split-all-the-vertically-merged-cells-in-microsoft-word-table-using-word/53633210#53633210", "title": "How to split all the vertically merged cells in Microsoft Word table using word vba?", "body": "<p>I searched through a lot of reference, but couldn't find any other shorter way to split all vertical merging in Table cell in Word.</p>\n\n<p>This function will take the first table in word, and will remove all the vertical merges for all cells for the table in MS Word.</p>\n\n<pre><code>Function SplitVerticalMerge()\n    'Created by Chandraprakash [Yoh]\n    Dim i As Long, j As Long, k As Long, cols As Long, m As Long\n    Dim sData() As Variant\n    Dim oTable As Table\n    Dim oCell As Cell\n    Dim oRng As Range\n    Dim sText As String\n    Dim sRow As String\n    Dim iRow As Long\n\n    'Rows of Merged and NonMerged cells in Table\n    Dim oColl1 As New Collection\n\n    'Row with number of merged cells in Table (Vertical Split Number)\n    Dim oColl2 As New Collection\n\n    Set oTable = ActiveDocument.Tables(1)\n    With oTable\n\n        'Load all the Table cell index\n        ReDim sData(1 To .Rows.Count, 1 To .Columns.Count)\n        Set oCell = .Cell(1, 1)\n        Do While Not oCell Is Nothing\n            sData(oCell.RowIndex, oCell.ColumnIndex) = oCell.RowIndex &amp; \",\" &amp; oCell.ColumnIndex\n            Set oCell = oCell.Next\n        Loop\n\n        '1. Mark the merged cell as \"X\"\n        '2. Mark the non merged cell as \"A\"\n        '3. Load the result for each row to Collection1\n        For i = 1 To UBound(sData)\n            sRow = \"\"\n            For j = 1 To UBound(sData, 2)\n                sRow = sRow &amp; IIf(IsEmpty(sData(i, j)), \"X\", \"A\") ' &amp; \"|\"\n            Next j\n            oColl1.Add sRow\n        Next i\n\n        For cols = 1 To oTable.Columns.Count\n            'Load one by one Row with number of merged cells in Table (Vertical Split Number)\n            Set oColl2 = Nothing\n            j = 1\n            For i = oColl1.Count To 1 Step -1\n                '\"X\" - Merged\n                If Mid(oColl1(i), cols, 1) = \"X\" Then\n                    j = j + 1\n                    k = j\n                '\"A\" - NotMerged\n                Else\n                    k = j\n                    j = 1\n                End If\n                If j = 1 Then oColl2.Add k\n            Next i\n\n            iRow = oTable.Columns(cols).Cells.Count\n            k = iRow\n            For j = 1 To oColl2.Count\n                For i = oColl2.Count To 1 Step -iRow\n                    'cols - Column Number\n                    'k - cell row number in column (cols)\n                    'j - Split number for the cell (k)\n\n                    'Split the cell by above attributes defined\n                    oTable.Columns(cols).Cells(k).Split oColl2(j), 1\n\n                    '1. Enter if merged cell is split (j&gt;1)\n                    '2. Will fill the values for split empty cell with previous merged cell value\n                    If oColl2(j) &gt; 1 Then\n                        For m = 1 To oColl2(j) - 1\n                            oTable.Columns(cols).Cells(k + m).Range.Text = oTable.Columns(cols).Cells(k).Range.Text\n                        Next m\n                    End If\n\n                    k = k - 1\n                Next i\n            Next j\n        Next cols\n\n        'To avoid application freezing\n        DoEvents\n    End With\n\nlbl_Exit:\n    Set oColl1 = Nothing\n    Set oColl2 = Nothing\n\n    Set oTable = Nothing\n    Set oCell = Nothing\n    Set oRng = Nothing\n    Exit Function\nEnd Function\n</code></pre>\n\n<p><strong>Reference:</strong> Base code by Graham Mayor - MS MVP (Word)\n<strong>URL:</strong> <a href=\"http://www.vbaexpress.com/forum/showthread.php?59760-Unmerging-Vertically-merged-cells\" rel=\"nofollow noreferrer\">http://www.vbaexpress.com/forum/showthread.php?59760-Unmerging-Vertically-merged-cells</a></p>\n"}], "owner": {"reputation": 192, "user_id": 4391394, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bHzd6.jpg?s=128&g=1", "display_name": "Chandraprakash", "link": "https://stackoverflow.com/users/4391394/chandraprakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 862, "favorite_count": 2, "accepted_answer_id": 53633210, "answer_count": 1, "score": 0, "last_activity_date": 1544026603, "creation_date": 1544008558, "last_edit_date": 1544026603, "question_id": 53631041, "link": "https://stackoverflow.com/questions/53631041/how-to-split-all-the-vertically-merged-cells-in-microsoft-word-table-using-word", "title": "How to split all the vertically merged cells in Microsoft Word table using word vba?", "body": "<p>I have a word table which contains numerous vertical merges. </p>\n\n<p>I need to split all the cells which are merged, into individual cells with the previous value in merged cells.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 323, "user_id": 10106356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T7Tr6ot8gJY/AAAAAAAAAAI/AAAAAAAAAX0/Md6jAbDvlKc/photo.jpg?sz=128", "display_name": "Karthick Ganesan", "link": "https://stackoverflow.com/users/10106356/karthick-ganesan"}, "edited": false, "score": 0, "creation_date": 1544009251, "post_id": 53630998, "comment_id": 94121856, "body": "Can you please explain your problem further so that we can better understand the scenario ?"}, {"owner": {"reputation": 1, "user_id": 10748948, "user_type": "registered", "profile_image": "https://graph.facebook.com/2433518429998734/picture?type=large", "display_name": "Yves Nowa Tatsi", "link": "https://stackoverflow.com/users/10748948/yves-nowa-tatsi"}, "reply_to_user": {"reputation": 323, "user_id": 10106356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T7Tr6ot8gJY/AAAAAAAAAAI/AAAAAAAAAX0/Md6jAbDvlKc/photo.jpg?sz=128", "display_name": "Karthick Ganesan", "link": "https://stackoverflow.com/users/10106356/karthick-ganesan"}, "edited": false, "score": 0, "creation_date": 1544039625, "post_id": 53630998, "comment_id": 94138983, "body": "@KarthickGanesan I Already have a timeline slicer. and for some specifics operations I need to get this timeline slicer value and affect them into cells. everay time i&#39;ll change the end date en start date on this slicer, values in the corresponding cells should change automaticaly or by using a macro."}], "owner": {"reputation": 1, "user_id": 10748948, "user_type": "registered", "profile_image": "https://graph.facebook.com/2433518429998734/picture?type=large", "display_name": "Yves Nowa Tatsi", "link": "https://stackoverflow.com/users/10748948/yves-nowa-tatsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544008412, "creation_date": 1544008412, "question_id": 53630998, "link": "https://stackoverflow.com/questions/53630998/how-to-recuperate-end-date-and-start-date-value-from-a-time-line-slicer-and-put", "title": "How to recuperate end date and start date value from a Time Line slicer and put them into cells", "body": "<p>Please I need Help to recuperate in a timeline  slicer, end date and start date values in order to put them in cells and do seceral op\u00e9rations on it ( duration interval). </p>\n"}, {"tags": ["arrays", "excel", "vba", "variant", "jagged-arrays"], "comments": [{"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1544009433, "post_id": 53630774, "comment_id": 94121971, "body": "just leave array(...)  out"}, {"owner": {"reputation": 1623, "user_id": 3745431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bd2fefe0413a3f56e3ac7104ae26dde?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/3745431/dave"}, "edited": false, "score": 0, "creation_date": 1544009851, "post_id": 53630774, "comment_id": 94122237, "body": "^ As EvR says. The reason is that VBA will already treat your range object like an array, so when you put it inside the Array() function it is creating an array object and putting another array object inside it."}, {"owner": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "edited": false, "score": 0, "creation_date": 1544010056, "post_id": 53630774, "comment_id": 94122372, "body": "That makes sense, thank you."}, {"owner": {"reputation": 823, "user_id": 4786843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwVWr.jpg?s=128&g=1", "display_name": "NeepNeepNeep", "link": "https://stackoverflow.com/users/4786843/neepneepneep"}, "edited": false, "score": 0, "creation_date": 1544010436, "post_id": 53630774, "comment_id": 94122613, "body": "Also remember that while regular arrays are 0-based, cell arrays are 1-based"}], "answers": [{"tags": [], "owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "is_accepted": true, "score": 0, "last_activity_date": 1544014651, "creation_date": 1544014651, "answer_id": 53632890, "question_id": 53630774, "link": "https://stackoverflow.com/questions/53630774/vba-unintentionally-creating-an-array-within-an-array/53632890#53632890", "title": "VBA - Unintentionally creating an array within an array", "body": "<p>The reason you are getting a nested array is because of this line:</p>\n\n<pre><code>arr_Agency = Array(rng_Agency.Value2)\n</code></pre>\n\n<p>Do this instead:</p>\n\n<pre><code>arr_Agency = rng_Agency.Value2\n</code></pre>\n\n<p>That will create a one dimensional array, because when you assign to a variant its automatically treated as being an array.</p>\n"}], "owner": {"reputation": 29, "user_id": 10748933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed46e4351e5c29e936d9febe6885ec06?s=128&d=identicon&r=PG&f=1", "display_name": "jakrooster", "link": "https://stackoverflow.com/users/10748933/jakrooster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53632890, "answer_count": 1, "score": 0, "last_activity_date": 1544014651, "creation_date": 1544007732, "last_edit_date": 1544008945, "question_id": 53630774, "link": "https://stackoverflow.com/questions/53630774/vba-unintentionally-creating-an-array-within-an-array", "title": "VBA - Unintentionally creating an array within an array", "body": "<p>Below is the extract of some code I am writing that attempts to compare a range at the beginning of a process (captured in a global array in a sheet activate event) with the same range when the sheet is deactivated.</p>\n\n<p>Here is the activate code:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n\ngarr_Agency = Array(Range(\"rng_Lst_Agencies\").Value2) 'rng_Lst_Agencies is a 1D column.\n\nEnd Sub\n</code></pre>\n\n<p>And here is the deactivate:</p>\n\n<pre><code>Private Sub Worksheet_Deactivate()\n\nDim arr_Agency() As Variant\nDim rng_Agency As Range\nDim lng_Agencies As Long\nDim lng_i As Long\n\nSet rng_Agency = Range(\"rng_Lst_Agencies\")\n\narr_Agency = Array(rng_Agency.Value2)\n\nlng_Agencies = rng_Agency.Cells.Count\nlng_i = 1\n\nDo Until lng_i = lng_Agencies + 1\n            If arr_Agency(0)(lng_i, 1) &lt;&gt; garr_Agency(0)(lng_i, 1) Then \n*rest of the code*\n</code></pre>\n\n<p>I would have thought I could just use:</p>\n\n<pre><code>If arr_Agency(lng_i, 1) &lt;&gt; garr_Agency(lng_i, 1) Then\n</code></pre>\n\n<p>but I get a \"Subscript out of range\" error.</p>\n\n<p>Why do I need to add the extra \"(0)\"? From the locals window it looks as if I have created an array within an array somewhere along the line but I don't see how.</p>\n\n<p>Many thanks.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1544013533, "post_id": 53630104, "comment_id": 94124442, "body": "open using visible property set  =false, check and either close or set visible property = true depending on values"}], "answers": [{"tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 0, "last_activity_date": 1544040792, "creation_date": 1544040792, "answer_id": 53640025, "question_id": 53630104, "link": "https://stackoverflow.com/questions/53630104/how-to-openform-using-two-conditions-in-macro-builder-microsoft-access/53640025#53640025", "title": "How to OpenForm using two conditions in macro builder Microsoft Access", "body": "<p>there's a couple issues to clarify: \n* the 2 fields: if the form's data depends on these then where are these fields displaying? ...and what is their source of data?</p>\n\n<ul>\n<li>how does a user change the values of these 2 fields? - are they linked together so that both get changed at the same time i.e. Last Name First Name - - or are they separate?</li>\n</ul>\n\n<p>I think what you may be seeking is a standard combobox/selector in the header of a form to select the record that is to display....but that will depend on your feedback.</p>\n"}], "owner": {"reputation": 21, "user_id": 6131484, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh3.googleusercontent.com/-Ogdes-hXJkk/AAAAAAAAAAI/AAAAAAAAAnc/XrPvwNesJPU/photo.jpg?sz=128", "display_name": "Jee Whizz", "link": "https://stackoverflow.com/users/6131484/jee-whizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594636363, "creation_date": 1544005538, "last_edit_date": 1594636363, "question_id": 53630104, "link": "https://stackoverflow.com/questions/53630104/how-to-openform-using-two-conditions-in-macro-builder-microsoft-access", "title": "How to OpenForm using two conditions in macro builder Microsoft Access", "body": "<p>I am building a database that needs to open a form and fill in all the fields based on two values, Contract Type and P.No but i cannot create the macro that checks the 2 fields before displaying the result. </p>\n\n<p>How can i build a macro that checks both the fields and shows the result accordingly.  </p>\n\n<p>The form that has the two fields:</p>\n\n<p><a href=\"https://i.stack.imgur.com/b33GE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b33GE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Underlying macro code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6KMnl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6KMnl.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would appreciate it if anyone could help me with this.</p>\n"}, {"tags": ["vba", "outlook", "office365", "skype-for-business"], "comments": [{"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1544005947, "post_id": 53629679, "comment_id": 94119868, "body": "your question is not clear but to move the contents of a folder to an  archive folder have a look :  [here] (<a href=\"https://www.rondebruin.nl/win/s3/win026.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s3/win026.htm</a>)"}, {"owner": {"reputation": 11, "user_id": 2492799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbae42f9f7d7a53bb095535420adc3c?s=128&d=identicon&r=PG", "display_name": "user2492799", "link": "https://stackoverflow.com/users/2492799/user2492799"}, "reply_to_user": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1544009722, "post_id": 53629679, "comment_id": 94122141, "body": "Sorry, my question is not clear: I mean moving the contents of the outlook &quot;folder&quot; in which skype conversations are stored"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1544084621, "post_id": 53629679, "comment_id": 94152790, "body": "What have you tried can you share?"}, {"owner": {"reputation": 11, "user_id": 2492799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbae42f9f7d7a53bb095535420adc3c?s=128&d=identicon&r=PG", "display_name": "user2492799", "link": "https://stackoverflow.com/users/2492799/user2492799"}, "edited": false, "score": 0, "creation_date": 1544086002, "post_id": 53629679, "comment_id": 94153479, "body": "Not at this moment. I&#39;ve a code to read and managed the items in Inbox and its subfolders, but I can&#39;t find a way to access (and manage) to the items of &quot;Conversation History&quot;"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1544218444, "post_id": 53629679, "comment_id": 94212097, "body": "I do not have Skype so have no folder named &quot;Conversation History&quot;.  Is this folder listed in the folder pane like other folders?  Inbox is a standard folder and has a &quot;standard&quot; technique for accessing it.  Non-standard folders are easy to access if you know the technique.  Is this what you need to know?"}, {"owner": {"reputation": 11, "user_id": 2492799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbae42f9f7d7a53bb095535420adc3c?s=128&d=identicon&r=PG", "display_name": "user2492799", "link": "https://stackoverflow.com/users/2492799/user2492799"}, "edited": false, "score": 0, "creation_date": 1544303316, "post_id": 53629679, "comment_id": 94230399, "body": "The folder is listed in the folder pane as 1st level folder (like a &quot;Inbox&quot;). To access to Inbox folder I can use &quot;Set olFolder = objNS.GetDefaultFolder(olFolderInbox)&quot;, but to access to &quot;Conversation History&quot; I don&#39;t know the technique."}], "answers": [{"tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1544296627, "creation_date": 1544296627, "answer_id": 53686039, "question_id": 53629679, "link": "https://stackoverflow.com/questions/53629679/how-do-i-archive-the-contents-of-the-conversation-history-folder-with-vba-in-o/53686039#53686039", "title": "How do I archive the contents of the &quot;Conversation History&quot; folder with VBA in Outlook (O365)?", "body": "<p>Any folder can be accessed in multiple ways:</p>\n\n<ol>\n<li>Use NameSpace.GetDefaultFolder to access any of the named folders (e.g. Inbox, Drafts, Deleted Items, etc.)</li>\n<li>Use NameSpace.GetFolderFromID, if you know the EntryID and (optionally) StoreID values for the folder</li>\n<li>Use Folder.Parent to get the parent folder</li>\n<li>Use Folder.Folders(\"FolderName\") to get a child folder by name</li>\n<li>Use Store.GetRootFolder to get the top-level folder for any loaded mailbox or .pst via its relevant Store object</li>\n</ol>\n\n<p>See this example to give you some ideas:\n<a href=\"https://docs.microsoft.com/en-us/office/vba/outlook/how-to/items-folders-and-stores/enumerate-folders-on-all-stores\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/outlook/how-to/items-folders-and-stores/enumerate-folders-on-all-stores</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11633133, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lSG5Upu5bKU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMCcloJ3meSHbh4cV_zaGKyyDbOw/mo/photo.jpg?sz=128", "display_name": "BenN", "link": "https://stackoverflow.com/users/11633133/benn"}, "is_accepted": false, "score": 0, "last_activity_date": 1609530919, "last_edit_date": 1609530919, "creation_date": 1609449698, "answer_id": 65525632, "question_id": 53629679, "link": "https://stackoverflow.com/questions/53629679/how-do-i-archive-the-contents-of-the-conversation-history-folder-with-vba-in-o/65525632#65525632", "title": "How do I archive the contents of the &quot;Conversation History&quot; folder with VBA in Outlook (O365)?", "body": "<p>I used the following method to successfully reference the &quot;Conversation History&quot;</p>\n<pre><code>Application.GetNamespace(&quot;Mapi&quot;).DefaultStore.GetRootFolder.Folders(&quot;Conversation History&quot;)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2492799, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfbae42f9f7d7a53bb095535420adc3c?s=128&d=identicon&r=PG", "display_name": "user2492799", "link": "https://stackoverflow.com/users/2492799/user2492799"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1088, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1609530919, "creation_date": 1544004266, "last_edit_date": 1592869724, "question_id": 53629679, "link": "https://stackoverflow.com/questions/53629679/how-do-i-archive-the-contents-of-the-conversation-history-folder-with-vba-in-o", "title": "How do I archive the contents of the &quot;Conversation History&quot; folder with VBA in Outlook (O365)?", "body": "<p>On Outlook, Is it possible to automatically archive the contents of the \"Conversation History\" folder using VBA?</p>\n\n<p>Analyzing the vba docs I can't find a way to access that folder</p>\n\n<p>Thx</p>\n"}, {"tags": ["excel", "vba", "spreadsheet"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1544004296, "post_id": 53629656, "comment_id": 94118902, "body": "If you download the googlesheet it will automatically download as excel spreadsheet."}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 9095947, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JvEIukPgz8I/AAAAAAAAAAI/AAAAAAAABBs/dYDjhIRLkvk/photo.jpg?sz=128", "display_name": "David Davila", "link": "https://stackoverflow.com/users/9095947/david-davila"}, "is_accepted": false, "score": 1, "last_activity_date": 1544004397, "creation_date": 1544004397, "answer_id": 53629727, "question_id": 53629656, "link": "https://stackoverflow.com/questions/53629656/how-to-automatically-export-google-spreadsheet-to-excel/53629727#53629727", "title": "How to automatically export Google Spreadsheet to Excel?", "body": "<p>Just download the googlesheet from the same API, when you download it, the file is an excel spreadsheet.</p>\n"}], "owner": {"reputation": 1, "user_id": 10732997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/029fb1b6a5222e9d3479005e2d642d4d?s=128&d=identicon&r=PG&f=1", "display_name": "Radek Marcin", "link": "https://stackoverflow.com/users/10732997/radek-marcin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1581745671, "creation_date": 1544004205, "last_edit_date": 1581745671, "question_id": 53629656, "link": "https://stackoverflow.com/questions/53629656/how-to-automatically-export-google-spreadsheet-to-excel", "title": "How to automatically export Google Spreadsheet to Excel?", "body": "<p>How to automatically export Excel Google Spreadsheet to Excel?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11619622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/28KB9.jpg?s=128&g=1", "display_name": "iaskey", "link": "https://stackoverflow.com/users/11619622/iaskey"}, "is_accepted": false, "score": 0, "last_activity_date": 1562191544, "last_edit_date": 1562191544, "creation_date": 1562190381, "answer_id": 56878308, "question_id": 53629597, "link": "https://stackoverflow.com/questions/53629597/setting-new-internetexplorer-generates-automation-error-2125463506-8150002e/56878308#56878308", "title": "Setting &#39;New InternetExplorer&#39; generates automation error: -2125463506 (8150002e)", "body": "<p>I believe you should use <em>Set MyBrowser = New InternetExplorerMedium</em>. IE updated its security within the browser.</p>\n"}], "owner": {"reputation": 1, "user_id": 9665396, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M7BuTlpPlM4/AAAAAAAAAAI/AAAAAAAABcY/DOh31bet4Uo/photo.jpg?sz=128", "display_name": "Remy", "link": "https://stackoverflow.com/users/9665396/remy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1801, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563302266, "creation_date": 1544004023, "last_edit_date": 1563302266, "question_id": 53629597, "link": "https://stackoverflow.com/questions/53629597/setting-new-internetexplorer-generates-automation-error-2125463506-8150002e", "title": "Setting &#39;New InternetExplorer&#39; generates automation error: -2125463506 (8150002e)", "body": "<p>I have VBA code to login to a website. Sometimes it works, but other times I get </p>\n\n<blockquote>\n  <p>automation error: 2125463506 (8150002e).</p>\n</blockquote>\n\n<p>I have read a number of posts related to this topic, tried a number of different methods and still can't get it to work.</p>\n\n<p>My OS is Windows 10. In Windows 7 I didnt get this error.</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim MyBrowser As InternetExplorer\n\nSub Repsol1()\n\nDim MyHTML_Element As IHTMLElement\nDim MyURL As String\nDim form As HTMLFormElement\nMyURL = \"https://login.repsol.com/es/Landing/AuthnPage?returnUrl=https://www.repsol.com/es_es/\"\nSet MyBrowser = New InternetExplorer\nMyBrowser.Silent = True\nMyBrowser.Navigate MyURL\nMyBrowser.Visible = True\nDo\n    DoEvents\nLoop Until MyBrowser.ReadyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = MyBrowser.Document\n\nDo While HTMLDoc.getElementById(\"gigya-login-form\") Is Nothing\n    DoEvents\nLoop\n\nSet form = HTMLDoc.getElementById(\"gigya-login-form\")\n\nform.all.UserName.Value = \"XXXXX@XXXXX\"\nform.all.Password.Value = \"XXXXX\"\n\nform.getElementsByClassName(\"gigya-input-submit\")(0).Click\n\nDo\nLoop Until MyBrowser.ReadyState = READYSTATE_COMPLETE\n\nWith CreateObject(\"InternetExplorer.Application\")\n    .Visible = True\n    .Navigate \"https://www.repsol.com/es_es/aplicaciones/SO/WebEESS/default.aspx?usuario=XXXXX\"\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/82pxF.jpg\" alt=\"Automation error\">\n<img src=\"https://i.stack.imgur.com/T8mrf.jpg\" alt=\"Debug error\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1544006684, "post_id": 53629435, "comment_id": 94120320, "body": "have a look at this <a href=\"https://stackoverflow.com/questions/35776555/using-html-as-a-interface-for-vba-excel\" title=\"using html as a interface for vba excel\">stackoverflow.com/questions/35776555/&hellip;</a>"}, {"owner": {"reputation": 5, "user_id": 10678156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v_F9Mwn6j70/AAAAAAAAAAI/AAAAAAAAACM/4mJ2-ylcBWU/photo.jpg?sz=128", "display_name": "Sourish Atorthy", "link": "https://stackoverflow.com/users/10678156/sourish-atorthy"}, "reply_to_user": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1544444758, "post_id": 53629435, "comment_id": 94265848, "body": "doesn&#39;t answer my question. not even related, sir. but thanks anyways :)"}, {"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1544618205, "post_id": 53629435, "comment_id": 94338904, "body": "if you wanted to learn that was the right place for you to start but any way here is the code just copy and past and rename controls to what you have"}, {"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1544703658, "post_id": 53629435, "comment_id": 94375193, "body": "did the later solve your problem if it did please mark it as your answer"}, {"owner": {"reputation": 5, "user_id": 10678156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v_F9Mwn6j70/AAAAAAAAAAI/AAAAAAAAACM/4mJ2-ylcBWU/photo.jpg?sz=128", "display_name": "Sourish Atorthy", "link": "https://stackoverflow.com/users/10678156/sourish-atorthy"}, "reply_to_user": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "edited": false, "score": 0, "creation_date": 1545203570, "post_id": 53629435, "comment_id": 94540019, "body": "It didn&#39;t but thanks."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 10678156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v_F9Mwn6j70/AAAAAAAAAAI/AAAAAAAAACM/4mJ2-ylcBWU/photo.jpg?sz=128", "display_name": "Sourish Atorthy", "link": "https://stackoverflow.com/users/10678156/sourish-atorthy"}, "edited": false, "score": 0, "creation_date": 1547726553, "post_id": 53743111, "comment_id": 95295574, "body": "It is giving me &quot;Cannot insert object&quot;   @Tim"}, {"owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "reply_to_user": {"reputation": 5, "user_id": 10678156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v_F9Mwn6j70/AAAAAAAAAAI/AAAAAAAAACM/4mJ2-ylcBWU/photo.jpg?sz=128", "display_name": "Sourish Atorthy", "link": "https://stackoverflow.com/users/10678156/sourish-atorthy"}, "edited": false, "score": 0, "creation_date": 1547740675, "post_id": 53743111, "comment_id": 95304033, "body": "please explain  what you are doing"}, {"owner": {"reputation": 5, "user_id": 10678156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v_F9Mwn6j70/AAAAAAAAAAI/AAAAAAAAACM/4mJ2-ylcBWU/photo.jpg?sz=128", "display_name": "Sourish Atorthy", "link": "https://stackoverflow.com/users/10678156/sourish-atorthy"}, "edited": false, "score": 0, "creation_date": 1548054767, "post_id": 53743111, "comment_id": 95391175, "body": "I am trying to insert a Microsoft Web Browser Control in my Excel 2017 worksheet from the Insert button in the Developer Tools. Just when I draw the Web Browser Control, it is showing me &quot;Cannot Insert Object&quot;"}], "tags": [], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "is_accepted": true, "score": 0, "last_activity_date": 1544617966, "creation_date": 1544617966, "answer_id": 53743111, "question_id": 53629435, "link": "https://stackoverflow.com/questions/53629435/how-to-add-an-html-web-browser-window-in-an-excel-sheet/53743111#53743111", "title": "How to add an HTML web browser window in an Excel sheet", "body": "<p>To achieve this you have to put the  Microsoft Web Browser control on your spread sheet or form and on your code open the file using this control like so;</p>\n\n<pre><code>     Private Sub CommandButton1_Click()\n     Me.WebBrowser1.Navigate \"H:\\folder in your pc\\test.html\" '\"http://www.google.com\"\n     End Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10678156, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-v_F9Mwn6j70/AAAAAAAAAAI/AAAAAAAAACM/4mJ2-ylcBWU/photo.jpg?sz=128", "display_name": "Sourish Atorthy", "link": "https://stackoverflow.com/users/10678156/sourish-atorthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "accepted_answer_id": 53743111, "answer_count": 1, "score": 0, "last_activity_date": 1547390993, "creation_date": 1544003494, "last_edit_date": 1547390993, "question_id": 53629435, "link": "https://stackoverflow.com/questions/53629435/how-to-add-an-html-web-browser-window-in-an-excel-sheet", "title": "How to add an HTML web browser window in an Excel sheet", "body": "<p>I have an Excel file with data.</p>\n\n<p>I retrieve the data and create an image through 3js and it will create an html file.</p>\n\n<p>When I open that html file on a button click from Excel it renders a browser window and shows it there.</p>\n\n<p>I want the browser window to appear embedded on the Excel worksheet I am working on.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1544003406, "post_id": 53629377, "comment_id": 94118315, "body": "Why you need <code>VBA</code>. you can do it by regular formula."}, {"owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "reply_to_user": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1544003557, "post_id": 53629377, "comment_id": 94118404, "body": "Because it is part of a bigger project, but still the formula doesn&#39;t work correctly"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 1, "creation_date": 1544003580, "post_id": 53629377, "comment_id": 94118418, "body": "So <code>=sum(B:B)&#47;count(A:A)</code>?"}, {"owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1544003805, "post_id": 53629377, "comment_id": 94118586, "body": "@eirikdaude I tried =sum(B:B)/E3 and it works now"}], "answers": [{"tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 0, "last_activity_date": 1544004586, "creation_date": 1544004586, "answer_id": 53629784, "question_id": 53629377, "link": "https://stackoverflow.com/questions/53629377/excel-formula-make-the-average-depending-on-a-cell/53629784#53629784", "title": "Excel formula: make the average depending on a cell", "body": "<p>You can use <code>AverageIf</code> for such a purpose, as you can see in my example:</p>\n\n<pre><code>Row/Column  A   B   C   D\n         1\n         2      2       =AVERAGE(B2:B5) =&gt; value 3\n         3      4       =AVERAGEIF(B2:B5;\"&lt;&gt;0\") =&gt; value 4\n         4      0\n         5      6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 1, "last_activity_date": 1544013345, "creation_date": 1544013345, "answer_id": 53632491, "question_id": 53629377, "link": "https://stackoverflow.com/questions/53629377/excel-formula-make-the-average-depending-on-a-cell/53632491#53632491", "title": "Excel formula: make the average depending on a cell", "body": "<p>The easiest way to do this, is to get the total of column B by using <code>sum(B:B)</code> (or a more specific range, if you want), and the amount of non-blank cells in column A by using <code>counta(A:A)</code> (in my comment I used <code>count</code> which only counts the amount of numbers in the range, <code>counta</code> should count all non-blank cells). You can then divide the former by the latter to get the number you are looking for, resulting in a formula looking something like</p>\n\n<pre><code>=SUM(B:B)/COUNTA(A:A)\n</code></pre>\n\n<p>If you already have the count of column A in a cell (e.g. E3), it's even simpler, just use something like </p>\n\n<pre><code>=SUM(B:B)/E3\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 9433566, "user_type": "registered", "profile_image": "https://graph.facebook.com/1858556497510549/picture?type=large", "display_name": "Anca Vulc", "link": "https://stackoverflow.com/users/9433566/anca-vulc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1581745683, "creation_date": 1544003268, "last_edit_date": 1581745683, "question_id": 53629377, "link": "https://stackoverflow.com/questions/53629377/excel-formula-make-the-average-depending-on-a-cell", "title": "Excel formula: make the average depending on a cell", "body": "<p>I want to make a formula that turns in a VBA code that makes the average for column A even though there are some 0 there. I want to divide it by a the number in a cell that counts the objects in column A.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1kpL1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1kpL1.png\" alt=\"enter image description here\"></a></p>\n\n<p>I used to use this formula, but it divides my sum incorrectly because I have 0's (I want to keep the 0's there):</p>\n\n<pre><code>=AVERAGE(Sheet1!$B$2:$B$10000)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1544004963, "post_id": 53629010, "comment_id": 94119294, "body": "What is r at debug time?"}, {"owner": {"reputation": 13, "user_id": 6414334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f0d7ab63c4f2d63e72fe704b2c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Dariusz Wesolowski", "link": "https://stackoverflow.com/users/6414334/dariusz-wesolowski"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1544085086, "post_id": 53629010, "comment_id": 94152990, "body": "It&#39;s &quot;Print!$A$xxx&quot;, where xxx is variable - so as expected (otherwise &quot;r.PageBreak = xlPageBreakManual&quot; would fail, I guess)"}], "owner": {"reputation": 13, "user_id": 6414334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b7f0d7ab63c4f2d63e72fe704b2c45b?s=128&d=identicon&r=PG&f=1", "display_name": "Dariusz Wesolowski", "link": "https://stackoverflow.com/users/6414334/dariusz-wesolowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581745693, "creation_date": 1544002050, "last_edit_date": 1581745693, "question_id": 53629010, "link": "https://stackoverflow.com/questions/53629010/range-pastespecial-causes-runtime-error-1004", "title": "Range.PasteSpecial causes Runtime Error &#39;1004&#39;", "body": "<p>Requirement:</p>\n\n<p>We have a chart with a considerable cardinality in filters. User wants to single-click print all permutations.</p>\n\n<p>My idea:</p>\n\n<p>Iterate all, setting the filters and rendering the chart as image to a single sheet (unfortunately, I haven't found a way to do it w/o using clipboard).</p>\n\n<p>Solution:</p>\n\n<pre><code>#If VBA7 Then\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'For 64 Bit Systems\n#Else\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long) 'For 32 Bit Systems\n#End If\n\nSub PrintButton_Click()\n    Dim ps As Worksheet\n    Dim gs As Worksheet\n    Dim r As Range\n    Dim c As ChartObject\n    Dim s As Shapes\n    Dim n As Integer\n\n    Application.ScreenUpdating = False\n\n    Set gs = Sheets(\"Graph\")\n    Set ps = gs\n    Set c = gs.ChartObjects(\"Chart\")\n\n    n = 0\n    For Each loopRow In Sheets(\"Klassen\").UsedRange.Rows\n        ' there seems to be 1024 PageBreaks per Sheet limit\n        If n Mod 1024 = 0 Then\n            Set ps = Sheets.Add(After:=ps)\n            ps.Name = \"Print\" + IIf(n / 1024 = 0, \"\", \"_\" + CStr(n / 1024))\n            ps.PageSetup.Orientation = xlLandscape\n            Set s = ps.Shapes\n            Set r = ps.Cells(1, 1)\n        End If\n\n        If loopRow.Row &lt;&gt; 1 And loopRow.Cells(1).Value &lt;&gt; \"\" And loopRow.Cells(2).Value &lt;&gt; \"\" Then\n            gs.Cells(1, 2).Value = loopRow.Cells(1).Value\n            gs.Cells(2, 2).Value = loopRow.Cells(2).Value\n\n            c.CopyPicture\n            DoEvents\n\n            'Sleep 1000\n            'DoEvents\n\n            'EnsureClipboard (xlClipboardFormatPICT)\n            'dbg = Application.ClipboardFormats(1)\n\n            r.PasteSpecial\n            'ps.Paste Destination:=r\n\n            Set r = ps.Cells(s(s.Count).BottomRightCell.Row + 1, 1)\n            r.PageBreak = xlPageBreakManual\n\n            'gs.Cells(1, 1).Copy\n            'EnsureClipboard (xlClipboardFormatText)\n        End If\n\n        n = n + 1\n    Next\n\n    gs.Cells(1, 2).Value = \"(All)\"\n    gs.Cells(2, 2).Value = \"(All)\"\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nSub EnsureClipboard(desiredFmt As XlClipboardFormat)\n    Dim present As Boolean\n\n    DoEvents\n    present = False\n    Do While Not present\n        aFmts = Application.ClipboardFormats\n        For Each fmt In aFmts\n            If fmt = desiredFmt Then\n                present = True\n            End If\n        Next\n        If Not present Then\n            DoEvents\n            Sleep 100\n            DoEvents\n        End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Problem:</p>\n\n<p>After a variable amount of iterations, Excel throws \"Run-time error '1004' PasteSpecial method of Range class failed\".</p>\n\n<p>Debug:</p>\n\n<p>Both \"r.PasteSpecial\" and \"ps.Paste Destination:=r\" fails.</p>\n\n<p>dbg variable contains xlClipboardFormatPICT, so it seems the data is there and inspecting the clipboard confirms it.</p>\n\n<p>I was even desperate enough to wait a whole second between copying and pasting to eliminate the race condition - paste typically fails after pretty much the same number of successes.</p>\n\n<p>I'm using Office 365 ProPlus. Funny thing is it used to work on v1705, it fails on v1803. Even funnier is that for some time after the upgrade it worked, so I'm not sure if it would still work on previous version...</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "edited": false, "score": 0, "creation_date": 1544002070, "post_id": 53628902, "comment_id": 94117536, "body": "You could also investigate Excel&#39;s data export options, rather than iterating rows and columns."}, {"owner": {"reputation": 25, "user_id": 6234724, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1169122129786946/picture?type=large", "display_name": "Miroslav Kostadinov", "link": "https://stackoverflow.com/users/6234724/miroslav-kostadinov"}, "edited": false, "score": 0, "creation_date": 1544002081, "post_id": 53628902, "comment_id": 94117541, "body": "Thanks, but in this way its export the last column as a string: &quot;350.50&quot;,  I want to be exported as  number 350.50, without quotes....."}, {"owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "reply_to_user": {"reputation": 25, "user_id": 6234724, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1169122129786946/picture?type=large", "display_name": "Miroslav Kostadinov", "link": "https://stackoverflow.com/users/6234724/miroslav-kostadinov"}, "edited": false, "score": 0, "creation_date": 1544004127, "post_id": 53628902, "comment_id": 94118794, "body": "@MiroslavKostadinov I have added to my answer."}], "tags": [], "owner": {"reputation": 18498, "user_id": 620444, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/592e6e89add7a3937a41c963941e10e1?s=128&d=identicon&r=PG", "display_name": "Andy G", "link": "https://stackoverflow.com/users/620444/andy-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1544003845, "last_edit_date": 1544003845, "creation_date": 1544001705, "answer_id": 53628902, "question_id": 53628749, "link": "https://stackoverflow.com/questions/53628749/export-data-as-double-with-vba/53628902#53628902", "title": "Export data as double with VBA", "body": "<p>Format the value to display 2 decimal places when writing it to the file</p>\n\n<pre><code>    If j = rng.Columns.Count Then\n        Write #1, Format(cellValue, \"#.00\")\n        'or Format(cellValue, \"Standard\")\n    Else\n        Write #1, cellValue,\n    End If\n</code></pre>\n\n<p>This is because, by default, only the value/content of the cell is being written, not the cell formatting.</p>\n\n<hr>\n\n<p>If you wish to avoid writing the value as a string with quotes then, rather than iterating rows and columns, you could construct a single string to write for each row. For example,</p>\n\n<pre><code>cellValues = rng.Cells(i, 1).Value &amp; \",\"\"\" &amp; rng.Cells(i, 2).Value &amp; \"\"\",\" _ \n    &amp; ... &amp; Format(rng.Cells(i, 5), \"#.00\")\n</code></pre>\n\n<p>Doubling-up on the quotes \"\" is necessary to embed a quote.</p>\n"}], "owner": {"reputation": 25, "user_id": 6234724, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1169122129786946/picture?type=large", "display_name": "Miroslav Kostadinov", "link": "https://stackoverflow.com/users/6234724/miroslav-kostadinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544445964, "creation_date": 1544001188, "last_edit_date": 1544445964, "question_id": 53628749, "link": "https://stackoverflow.com/questions/53628749/export-data-as-double-with-vba", "title": "Export data as double with VBA", "body": "<p>I want to export selected data  from Excel sheet  to simple txt file.\nColumn A must be exported as INT, column B as String, column C as INT , column D as String, column E as Double (on export must save data as double format - 35.50, 30.00, 0.00)\nYou can take a look to attached picture for more info.\nColumn A.B,C,D are fine, but I can not force column E values to to be extracted to txt file as double (in excel this column is look fine - 35.00 for example, but when is extracted to txt file is 35 )\nThis is my VBA script:</p>\n\n<pre><code>Rem Attribute VBA_ModuleType=VBADocumentModule\nOption VBASupport 1\nOption Explicit\n\nPrivate Sub CommandButton1_Click()  \n    Dim myFile As String, rng As Range, cellValue As Variant, i As Integer, j As Integer\n\n    myFile = Application.DefaultFilePath &amp; \"\\rezultat.txt\"\n    Set rng = Selection\n\n    Open myFile For Output As #1\n\n    For i = 1 To rng.Rows.Count\n        For j = 1 To rng.Columns.Count\n            cellValue = rng.Cells(i, j).Value\n\n            If j = rng.Columns.Count Then\n                Write #1, cellValue\n            Else\n                Write #1, cellValue,\n            End If\n        Next j\n    Next i\n\n    Close #1 \nEnd Sub\n</code></pre>\n\n<p>and that is result in my txt file:</p>\n\n<pre><code>1,\"1144641\",1,\"NAME-STRING VALUE\",350.5\n</code></pre>\n\n<p>Everythink is just fine, except last value: must be 350.50\nYou can take a look at the screenshot in the attachment</p>\n\n<p><a href=\"https://i.stack.imgur.com/67RGj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/67RGj.png\" alt=\"screenshot\"></a></p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10741757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WFbjfG-Zxag/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hha9Jbhcebyr2iq8j5CGH-pVHurw/mo/photo.jpg?sz=128", "display_name": "PP TT", "link": "https://stackoverflow.com/users/10741757/pp-tt"}, "edited": false, "score": 0, "creation_date": 1544060059, "post_id": 53638855, "comment_id": 94145795, "body": "That&#39;s what i was looking for. Thanks for the help!!"}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 0, "last_activity_date": 1544035585, "creation_date": 1544035585, "answer_id": 53638855, "question_id": 53628126, "link": "https://stackoverflow.com/questions/53628126/vba-powerpoint-textbox-convert-wordwrap-to-carriage-return/53638855#53638855", "title": "VBA Powerpoint - Textbox - Convert WordWrap to Carriage Return", "body": "<p>Here's something to get you started: </p>\n\n<pre><code>Sub TestIt()\n    Dim osh As Shape\n    Set osh = ActiveWindow.Selection.ShapeRange(1)\n    Call WordwrapToLineEnd(osh)\nEnd Sub\n\nFunction WordwrapToLineEnd(osh As Shape)\n\n    Dim x As Long\n\n    With osh.TextFrame.TextRange\n        For x = 1 To .Lines.Count\n            .Lines(x).Text = .Lines(x).Text &amp; vbCrLf\n        Next\n    End With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10741757, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WFbjfG-Zxag/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hha9Jbhcebyr2iq8j5CGH-pVHurw/mo/photo.jpg?sz=128", "display_name": "PP TT", "link": "https://stackoverflow.com/users/10741757/pp-tt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53638855, "answer_count": 1, "score": 0, "last_activity_date": 1544035585, "creation_date": 1543998971, "question_id": 53628126, "link": "https://stackoverflow.com/questions/53628126/vba-powerpoint-textbox-convert-wordwrap-to-carriage-return", "title": "VBA Powerpoint - Textbox - Convert WordWrap to Carriage Return", "body": "<p>I have a few textboxes in a slide. Each of them have different font sizes.</p>\n\n<p>The text in the textbox are multi-line. But their line-breaks are word-wrapped, not manual carriage returned.</p>\n\n<p>I need to convert those word-wrapped text to proper carriage-returned text, so i can export it to a CSV text file.</p>\n\n<p>I have many Powerpoint presentation files, with hundreds of slides in each file. And each slide a few wordwrapped textboxes with different font sizes.</p>\n\n<p>How should i solve this problem? </p>\n\n<p>Hope someone can point me to the right direction.\nThanks!</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544030925, "post_id": 53627849, "comment_id": 94135089, "body": "No idea, really, but... Which line of code is causing the error?"}, {"owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544071405, "post_id": 53627849, "comment_id": 94148338, "body": "@CindyMeister Error 5018 seems to be regarding regular expressions, as mentioned in questions like these : <a href=\"https://superuser.com/questions/62456/why-does-my-regular-expressions-invoke-error-5018-in-my-vba-script-in-excel\" title=\"why does my regular expressions invoke error 5018 in my vba script in excel\">superuser.com/questions/62456/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544075026, "post_id": 53627849, "comment_id": 94149217, "body": "No, I asked which line of code is triggering the error? If it&#39;s none of the lines you show then provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544156567, "post_id": 53627849, "comment_id": 94184254, "body": "@CindyMeister I am getting error in the regex, but the cause is the value added to the dictionary. I have added details."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544202369, "post_id": 53627849, "comment_id": 94205437, "body": "I can&#39;t test it, but I&#39;m wondering whether it has to do with the &quot;code page&quot; used by the other machine, meaning ANSI 176 would be something else. Try <code>ChrW(176)</code> and see if that makes a difference? (That would treat the symobl as Unicode.)"}, {"owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544674102, "post_id": 53627849, "comment_id": 94362342, "body": "after using <code>ChrW(176)</code>, I am able to run the code without any issues. however, I can&#39;t match the symbols in the document. Similar behavior has been reported in this thread <a href=\"https://stackoverflow.com/questions/14602843/vba-match-greek-in-regular-expression\" title=\"vba match greek in regular expression\">stackoverflow.com/questions/14602843/&hellip;</a>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544682141, "post_id": 53627849, "comment_id": 94364467, "body": "Why are you using regex in Word?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1544776962, "post_id": 53627849, "comment_id": 94403347, "body": "After some thought, my best guess as to the &quot;why&quot; is that the information in the Word document is not coming in as <code>ChrW</code> only <code>Chr</code> so the comparison isn&#39;t working. To test this you use a very small document, use code to convert every character in the string you pass to RegEx to <code>ChrW</code> and see if that works."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1617265082, "post_id": 53627849, "comment_id": 118257848, "body": "The problem with the regex is simple to explain: <code>\\b</code> is a zero-width assertion, and zero-width assertions (and start of the pattern) cannot be quantified in a ECMAScript regex. <code>?</code> means the preceding token can be matched 1 or 0 times, and it is not allowed here. And as for handling Chinese Trad. in Win10, I could not make it work, thus, I just created a VSTO Add-in in Visual Studio to do the handling for me. If anyone knows a VBA solution, I&#39;d be glad to hear."}], "owner": {"reputation": 280, "user_id": 1844496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce7e43dfc07547b04318e0240370a2ca?s=128&d=identicon&r=PG", "display_name": "entryton", "link": "https://stackoverflow.com/users/1844496/entryton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1544157907, "creation_date": 1543997733, "last_edit_date": 1544157907, "question_id": 53627849, "link": "https://stackoverflow.com/questions/53627849/problems-while-adding-symbols-in-vba-string", "title": "Problems while adding symbols in VBA string", "body": "<p>I have a requirement where I need to check a document for text that may contain symbols like <code>\u00b0</code> and <code>\u03b2</code>.</p>\n\n<p>I used the below code to add the text to a dictionary.</p>\n\n<pre><code>dict.Add Chr(176) + \"C\", \"degrees Celsius\"\ndict.Add Chr(223) + \"-hCG\", \"beta-human chorionic gonadotropin\"\n</code></pre>\n\n<p>Further, the below code takes the dictionary key and puts it in a regex, so that I can scan my document using it.</p>\n\n<pre><code>Document_Search = \"\\b\" &amp; dict.keys()(ia) &amp; \"\\b\"\nDim regEx, Match, Matches\nSet regEx = New regExp\n\nWith regEx\n    .Global = True\n    .IgnoreCase = False\n    .Pattern = Document_Search\nEnd With\n</code></pre>\n\n<p>The code is working fine on my system, which has only one language installed - <code>English (United States)</code>.</p>\n\n<p>However, when somebody tries to run the code on a Windows 10 system that has <code>Chinese (Simplified)</code> also installed, we are getting an error.</p>\n\n<p><strong>Run time error 5018, Application-defined or object-defined error</strong></p>\n\n<p>I am not sure if the extra language is the actual cause; this is the only difference that I can think of right now.</p>\n\n<p>I added Chinese (Simplified) to my system, but did not get the error.</p>\n\n<p>How can I work around this error, and use the symbols in my code?</p>\n\n<p><strong>EDIT</strong>: I have debugged the code on the system with the issue.</p>\n\n<p>The values added to the dictionary are <code>?C</code> and <code>?-hCG</code>; whereas on my system they are <code>\u00b0C</code> and <code>\u03b2-hCG</code>.</p>\n\n<p>My regex comes out to be <code>Document_Search : \"\\b?C\\b\"</code>.</p>\n\n<p>Why is <code>Chr(176)</code> not working as expected?</p>\n"}, {"tags": ["vba", "outlook", "outlook-2016"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1544014328, "post_id": 53627247, "comment_id": 94124899, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27262798/for-each-loop-not-deleting-all-emails\">For Each loop: Not deleting all emails</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11526, "user_id": 235671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xKXSM.png?s=128&g=1", "display_name": "t3chb0t", "link": "https://stackoverflow.com/users/235671/t3chb0t"}, "edited": false, "score": 0, "creation_date": 1543999977, "post_id": 53628221, "comment_id": 94116465, "body": "This looks more like a Code Review :-] I don&#39;t think that moving variable declarations will fix the issue that this script is not handling all emails in the <code>Inbox</code> on each execution. It handles just a couple of them. Sometimes more, sometimes fewer. Or is <code>VBA</code> really so <i>dumb</i> that it virtually <i>distroys</i> the local variables and as soon as there is some categorized email it won&#39;t process anything after that. This would be terrible! You know what, I&#39;ll take your advice and refactor the script, even though it seems to be counterintuitvie... but so is <code>VBA</code> ;-)"}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "reply_to_user": {"reputation": 11526, "user_id": 235671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xKXSM.png?s=128&g=1", "display_name": "t3chb0t", "link": "https://stackoverflow.com/users/235671/t3chb0t"}, "edited": false, "score": 0, "creation_date": 1544000074, "post_id": 53628221, "comment_id": 94116511, "body": "True, just changed those parts I could assume to result in problems. Let me know if it works for you :-)"}, {"owner": {"reputation": 11526, "user_id": 235671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xKXSM.png?s=128&g=1", "display_name": "t3chb0t", "link": "https://stackoverflow.com/users/235671/t3chb0t"}, "edited": false, "score": 0, "creation_date": 1544000598, "post_id": 53628221, "comment_id": 94116763, "body": "I took a couple of old emails and dropped them back to <code>Inbox</code> but unfortunatelly I had to execute this version also a couple of times before all items went back to the <code>Archive</code> - this seems to have no logic at all :-("}, {"owner": {"reputation": 11526, "user_id": 235671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xKXSM.png?s=128&g=1", "display_name": "t3chb0t", "link": "https://stackoverflow.com/users/235671/t3chb0t"}, "edited": false, "score": 0, "creation_date": 1544003648, "post_id": 53628221, "comment_id": 94118468, "body": "Busted! Take a look at my <a href=\"https://stackoverflow.com/a/53629464/235671\">answer</a> ;-)"}], "tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": false, "score": 1, "last_activity_date": 1543999353, "creation_date": 1543999353, "answer_id": 53628221, "question_id": 53627247, "link": "https://stackoverflow.com/questions/53627247/script-moves-only-a-couple-of-inbox-items-on-each-execution/53628221#53628221", "title": "Script moves only a couple of &#39;Inbox&#39; items on each execution", "body": "<p>Not sure whether I miss something here, but your code seems to handle any mail as old, for you set <code>isOld</code> to true within the loop. Is there a special reason for declaring <code>isPined</code>and <code>isTTYL</code>each loop? Have you tried:</p>\n\n<pre><code>Sub CleanUpInbox()\n\nDim ns As Outlook.Namespace\nDim inbox As Outlook.Folder: Set inbox = ns.GetDefaultFolder(olFolderInbox)\nDim archive As Outlook.Folder: Set archive = ns.Folders(\"my@mailbox.abc\").Folders(\"Archives\").Folders(\"2018\")\nDim maxDiffInDays As Integer: maxDiffInDays = 14\nDim today As Date: today = DateValue(Now())\nDim mail As Variant ' Outlook.MailItem\nDim receivedOn As Date\nDim diff  As Integer\nDim isOld As Boolean\nDim isPinned As Boolean\nDim isTTYL As Boolean\n\nSet ns = GetNamespace(\"MAPI\")\nOn Error GoTo bang\n\nFor Each mail In inbox.Items\n\n    If mail Is Nothing Then\n        GoTo continue\n    End If\n\n    isOld = False\n    receivedOn = DateValue(mail.ReceivedTime)\n    diff = DateDiff(\"d\", receivedOn, today)\n\n    If diff &gt; maxDiffInDays Then\n        isOld = True\n    End If\n    isPinned = InStr(mail.Categories, \"PINNED\")\n    isTTYL = InStr(mail.Categories, \"TTYL\")\n\n    If LinqAll(False, isPinned, isTTYL) Then\n        Debug.Print mail.Subject\n        mail.Move archive\n    End If\n\n    GoTo continue\n\nbang:\n    Debug.Print \"bang!\"\n    Debug.Print Err.Description\n\ncontinue:\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11526, "user_id": 235671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xKXSM.png?s=128&g=1", "display_name": "t3chb0t", "link": "https://stackoverflow.com/users/235671/t3chb0t"}, "is_accepted": false, "score": 1, "last_activity_date": 1544003598, "creation_date": 1544003598, "answer_id": 53629464, "question_id": 53627247, "link": "https://stackoverflow.com/questions/53627247/script-moves-only-a-couple-of-inbox-items-on-each-execution/53629464#53629464", "title": "Script moves only a couple of &#39;Inbox&#39; items on each execution", "body": "<p>I've solved it. You must not use <code>Items</code> in a <code>For Each</code> loop and at the samve time <code>.Move</code> its items. It's like modifying the loop collection in <code>C#</code>. The only difference is that <code>C#</code> is throwing a nice exception while <code>VBA</code> just reduces the number of items and then just stops :-o</p>\n\n<p>Instead, I used <code>Do While</code> and two counters. One that counts the processed items and the other that is the current index for <code>Items</code>. Now it processes everything.</p>\n\n<pre><code>Sub CleanUpInbox2()\n\n    ' ... other variables\n\n    Dim processCount As Integer\n    Dim itemIndex As Integer: itemIndex = 1\n    Dim itemCount As Integer: itemCount = inbox.Items.Count\n    Do While processCount &lt; itemCount\n\n        processCount = processCount + 1\n\n        Set mail = inbox.Items(itemIndex)\n\n        ' ... body\n\n        If LinqAll(False, isPinned, isTTYL) Then\n            Debug.Print mail.Subject\n            mail.Move archive\n            moveCount = moveCount + 1\n        Else\n            itemIndex = itemIndex + 1\n        End If\n\nbang:\n        Debug.Print \"bang!\"\n        Debug.Print Err.Description\n\ncontinue:\n\n    Loop\n\n    Debug.Print \"Emails processed: \" &amp; processCount\n    Debug.Print \"Emails moved: \" &amp; moveCount\n\nEnd Sub\n</code></pre>\n\n<p>I tried to copy <code>Items</code> first but I didn't succeed with that (apparently there is no <code>new Outlook.Items</code>) so I use indexes.</p>\n"}], "owner": {"reputation": 11526, "user_id": 235671, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xKXSM.png?s=128&g=1", "display_name": "t3chb0t", "link": "https://stackoverflow.com/users/235671/t3chb0t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1592724429, "creation_date": 1543994996, "last_edit_date": 1592724429, "question_id": 53627247, "link": "https://stackoverflow.com/questions/53627247/script-moves-only-a-couple-of-inbox-items-on-each-execution", "title": "Script moves only a couple of &#39;Inbox&#39; items on each execution", "body": "<p>I have the follwing <code>VBA</code> script for <code>Outlook</code> that should move emails to the <code>Archives</code> folder (that are not categorized in one of the special categories). It both works and not. I mean it moves <em>some</em> emails but skips the others so I have to run it mulitple times until the <code>Inbox</code> is cleaned-up. I don't understand why it behaves this way. It doesn't throw any exceptions it just doesn't do its job for all items. Can you see anything suspicios here?</p>\n\n<pre><code>Option Explicit\n\nSub CleanUpInbox()\n\n    Dim ns As Outlook.NameSpace\n    Set ns = GetNamespace(\"MAPI\")\n    Dim inbox As Outlook.Folder: Set inbox = ns.GetDefaultFolder(olFolderInbox)\n    Dim archive As Outlook.Folder: Set archive = ns.Folders(\"my@mailbox.abc\").Folders(\"Archives\").Folders(\"2018\")\n\n    Dim maxDiffInDays As Integer: maxDiffInDays = 14\n    Dim today As Date: today = DateValue(now())\n\n    On Error GoTo bang\n\n    Dim mail As Variant ' Outlook.MailItem\n    For Each mail In inbox.Items\n\n        If mail Is Nothing Then\n            GoTo continue\n        End If\n\n        Dim receivedOn As Date: receivedOn = DateValue(mail.ReceivedTime)\n        Dim diff  As Integer: diff = DateDiff(\"d\", receivedOn, today)\n        Dim isOld As Boolean: isOld = True ' diff &gt; maxDiffInDays\n        If isOld Then\n\n            'Debug.Print diff\n            'Debug.Print mail.Subject\n            'Debug.Print mail.Categories\n\n            Dim isPinned As Boolean: isPinned = InStr(mail.Categories, \"PINNED\")\n            Dim isTTYL As Boolean: isTTYL = InStr(mail.Categories, \"TTYL\")\n\n            If LinqAll(False, isPinned, isTTYL) Then\n                Debug.Print mail.Subject\n                mail.Move archive\n            End If\n\n        End If\n\n\nGoTo continue\n\nbang:\n\n        Debug.Print \"bang!\"\n        Debug.Print Err.Description\n\ncontinue:\n\n    Next\n\nEnd Sub\n\nFunction LinqAll(ByVal Expected As Boolean, ParamArray Values() As Variant) As Boolean\n\n    Dim x As Variant\n    For Each x In Values\n        If x &lt;&gt; Expected Then\n            LinqAll = False\n            Exit Function\n        End If\n    Next\n    LinqAll = True\n\nEnd Function\n\nFunction LinqAny(ByVal Expected As Boolean, ParamArray Values() As Variant) As Boolean\n\n    Dim x As Variant\n    For Each x In Values\n        If x = Expected Then\n            LinqAny = True\n            Exit Function\n        End If\n    Next\n    LinqAny = False\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 106, "user_id": 9709187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63acda9cc082e30023c3d2301d48a68a?s=128&d=identicon&r=PG&f=1", "display_name": "Ruvox", "link": "https://stackoverflow.com/users/9709187/ruvox"}, "edited": false, "score": 2, "creation_date": 1543994320, "post_id": 53627031, "comment_id": 94113846, "body": "Is there anything you have tried so far? Any bit of code you tried working with?"}, {"owner": {"reputation": 1, "user_id": 10747930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JNFFctoGEac/AAAAAAAAAAI/AAAAAAAACZQ/5shC3SLWHqI/photo.jpg?sz=128", "display_name": "Dheeraj Nagarjuna DJ", "link": "https://stackoverflow.com/users/10747930/dheeraj-nagarjuna-dj"}, "reply_to_user": {"reputation": 106, "user_id": 9709187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63acda9cc082e30023c3d2301d48a68a?s=128&d=identicon&r=PG&f=1", "display_name": "Ruvox", "link": "https://stackoverflow.com/users/9709187/ruvox"}, "edited": false, "score": 0, "creation_date": 1543994662, "post_id": 53627031, "comment_id": 94113991, "body": "For Each Sh1Cell In Sh1Range Set c = Sh2Range.Find( _ what:=Sh1Cell, LookIn:=xlValues) If c Is Nothing Then Sh1Cell.Interior.ColorIndex = 3 Sh1Cell.Offset(0, 1).Interior.ColorIndex = 3 Else If Sh1Cell.Offset(0, 1) &lt;&gt; c.Offset(0, 1) Then Sh1Cell.Interior.ColorIndex = 6 Sh1Cell.Offset(0, 1).Interior.ColorIndex = 8 End If End If Next Sh1Cell"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1543999406, "post_id": 53627031, "comment_id": 94116199, "body": "Please, edit your question and put the code into it. In a comment, it is unreadable."}], "owner": {"reputation": 1, "user_id": 10747930, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JNFFctoGEac/AAAAAAAAAAI/AAAAAAAACZQ/5shC3SLWHqI/photo.jpg?sz=128", "display_name": "Dheeraj Nagarjuna DJ", "link": "https://stackoverflow.com/users/10747930/dheeraj-nagarjuna-dj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593586232, "creation_date": 1543994103, "last_edit_date": 1593586232, "question_id": 53627031, "link": "https://stackoverflow.com/questions/53627031/compare-two-columns-from-one-excel-sheet-with-other-2-columns-in-other-sheet-and", "title": "compare two columns from one excel sheet with other 2 columns in other sheet and highlight the differences", "body": "<p>Let me be more specific and clear about the question. All i want to do is ...\nI want to compare for example say, column 1 (C1) is fruits. column 2 (C2) is quantity.</p>\n\n<p><strong>Sheet1 :</strong></p>\n\n<pre><code>  C1       C2  \n\nOrange     324\n\nApple      108\n\nGrape      24\n\nMango      30\n</code></pre>\n\n<p><strong>Sheet2:</strong></p>\n\n<pre><code>C1        C2 \n\nApple      40   \n\nGrape      90\n\nPeach      24\n</code></pre>\n\n<p>Now, The two sheets needed to be compared, All the fruits which are present in sheet1 but not in sheet2 should be colored in red and all the fruits which are present in sheet2 but not in sheet1 should be colored in red.\nAnd,\nkeeping sheet1 as constant, \nsheet 2 is compared with sheet1, and if apples are present in sheet1 then, if apples in sheet2 are lesser than sheet1 then the quantity should be colored in yellow. \nIf the quantity in sheet2 is greater than sheet 1 then the quantity should be colored in  green. so on.. for all the fruits(column1) and quantity(column2) in sheet2 with all the fruits(column1) and quantity(column2) in sheet1.</p>\n\n<p>Please help me. Thank you.</p>\n\n<p>This is the code I have tried..  </p>\n\n<pre><code>Sub checkrev2()  \n\nWith Sheets(\"Sheet1\")  \nSh1LastRow = .Cells(Rows.Count, \"C\").End(xlUp).Row  \nSet Sh1Range = .Range(\"E9:F\" &amp; Sh1LastRow)  \nSet num1Range = .Range(\"F9:F\" &amp; Sh1LastRow)  \nEnd With  \nWith Sheets(\"Sheet2\")  \nSh2LastRow = .Cells(Rows.Count, \"C\").End(xlUp).Row  \nSet Sh2Range = .Range(\"G14:H\" &amp; Sh2LastRow)  \nSet num2Range = .Range(\"H14:H\" &amp; Sh2LastRow)  \nEnd With  \n\n'compare sheet 1 with sheet 2  \nFor Each Sh1Cell In Sh1Range  \nSet c = Sh2Range.Find( _  \nwhat:=Sh1Cell, LookIn:=xlValues)  \nIf c Is Nothing Then  \nSh1Cell.Interior.ColorIndex = 3  \nSh1Cell.Offset(0, 1).Interior.ColorIndex = 3  \nElse  \nIf Sh1Cell.Offset(1, 0) &gt; c.Offset(1, 0) Then  \nSh1Cell.Offset(0, 1).Interior.ColorIndex = 0  \nEnd If  \nEnd If  \nNext Sh1Cell  \n\nFor Each Sh2Cell In Sh2Range  \nSet f = Sh1Range.Find( _  \nwhat:=Sh2Cell, LookIn:=xlValues)  \nIf f Is Nothing Then  \nSh2Cell.Interior.ColorIndex = 3  \nSh2Cell.Offset(0, 1).Interior.ColorIndex = 3  \nElse  \nIf c.Offset(1, 0) = f.Offset(1, 0) Then  \nc.Offset(0, 1).Interior.ColorIndex = 8  \nEnd If  \nEnd If  \nNext Sh2Cell  \nEnd Sub \n</code></pre>\n\n<p>With this code I am able to do the first part of the question... that is, comparing the columns in sheet1 with columns in sheet2 and highlighting the differences in RED color.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10228012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3gndE.jpg?s=128&g=1", "display_name": "Hooksta_v1", "link": "https://stackoverflow.com/users/10228012/hooksta-v1"}, "edited": false, "score": 0, "creation_date": 1544567272, "post_id": 53710935, "comment_id": 94320439, "body": "Hi Wyatt, Thanks for looking at this for me. Unfortunately after altering the code as you suggest I&#39;m still getting the exact Run-time error 1004 &quot;Unable to get the WorkDay property of the WorksheetFunction.&quot;"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 25, "user_id": 10228012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3gndE.jpg?s=128&g=1", "display_name": "Hooksta_v1", "link": "https://stackoverflow.com/users/10228012/hooksta-v1"}, "edited": false, "score": 0, "creation_date": 1544718055, "post_id": 53710935, "comment_id": 94384020, "body": "Please check your data, based on my edit. if you still have an issue, you can share what your data looks like."}, {"owner": {"reputation": 25, "user_id": 10228012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3gndE.jpg?s=128&g=1", "display_name": "Hooksta_v1", "link": "https://stackoverflow.com/users/10228012/hooksta-v1"}, "edited": false, "score": 0, "creation_date": 1544999477, "post_id": 53710935, "comment_id": 94462748, "body": "That&#39;s the money - I had checked, re-checked &amp; then triple checked the cells were in date format but it turns out that it was stumbling on a couple of blank cells in the range. When I populated them the macro ran without an issue. thanks again - m.h."}], "tags": [], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "is_accepted": true, "score": 0, "last_activity_date": 1544718001, "last_edit_date": 1544718001, "creation_date": 1544463888, "answer_id": 53710935, "question_id": 53626511, "link": "https://stackoverflow.com/questions/53626511/pasting-date-fomat-to-suit-workday-function/53710935#53710935", "title": "Pasting Date fomat to suit WorkDay Function", "body": "<p>I assume you have an End Sub, but aside from that, your WorkDay function is not like entering the formula into a spreadsheet. You would need to use VBA to call out the range on MPS_data like below:</p>\n\n<p>Instead of: <code>Application.WorksheetFunction.WorkDay(Date, 1, [MPS_Data!Z4:Z100])</code></p>\n\n<p>Try referencing the range like: <code>Application.WorksheetFunction.WorkDay(Date, 1, Sheets(\"MPS_data\").Range(\"Z4:Z100\"))</code></p>\n\n<p>When you get that 1004 error, you probably have a value in the range for holidays that isn't the type that is expected. Check your <code>MPS_Data!Z4:Z100</code> for data that isn't a date. I can replicate this error by changing a date in the holiday list to a value of \"X\"</p>\n"}], "owner": {"reputation": 25, "user_id": 10228012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3gndE.jpg?s=128&g=1", "display_name": "Hooksta_v1", "link": "https://stackoverflow.com/users/10228012/hooksta-v1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 53710935, "answer_count": 1, "score": 0, "last_activity_date": 1544720314, "creation_date": 1543991880, "last_edit_date": 1544720314, "question_id": 53626511, "link": "https://stackoverflow.com/questions/53626511/pasting-date-fomat-to-suit-workday-function", "title": "Pasting Date fomat to suit WorkDay Function", "body": "<p>I am trying to change cell format depending on dates and am using <code>Application.WorksheetFunction.Workday</code> so I can account for non-working days.</p>\n\n<p>The non-working days have been brought in via a link to a master spreadsheet and it looks like the format does not suit this function as I get a Run-time error 1004 \"Unable to get the WorkDay property of the WorksheetFunction.</p>\n\n<p>Does anyone have an idea how I can get this data from another workbook in a format that will work?</p>\n\n<p>I have tried copying the non-working days values to another row, tried all sorts of formatting tricks, even using a named range. All give me same run-time code 1004.</p>\n\n<p>The code works if I remove the <code>[MPS_Data!Z4:Z100]</code> or I manually type the dates in so I believe it is a formatting issue only.</p>\n\n<p>Below is a test example of my code, any help would be appreciated.</p>\n\n<pre><code>Sub Test()\n\nDim cell As Range\n\nFor Each cell In Sheet1.Range(\"Traffic_Light_Cells\") 'Blank cells\n    If cell.Offset(0, 1).Value = \"\" And cell.Value &gt;= Application.WorksheetFunction.WorkDay(Date, 1, [MPS_Data!Z4:Z100]) And cell.Value &lt;= Application.WorksheetFunction.WorkDay(Date, 5, [MPS_Data!Z4:Z100]) Then\n        cell.Interior.Color = RGB(188, 253, 175)\n        cell.Font.Bold = True\n        cell.Font.Color = RGB(84, 130, 53)\n    End If\nNext\n</code></pre>\n"}, {"tags": ["vba", "format", "substring"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1543992482, "post_id": 53626065, "comment_id": 94113081, "body": "Why do you have <code>On Error Resume Next</code>?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543992500, "post_id": 53626065, "comment_id": 94113091, "body": "Which application does this apply to? Excel? Bad idea to have <code>On Error Resume Next</code> - turning off error handling will suppress important information about why code may not be working. Comment it out, run the code, then use the <a href=\"https://stackoverflow.com/posts/53626065/edit\">edit</a> link to include the missing information in your question."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1543992777, "post_id": 53626065, "comment_id": 94113185, "body": "Karthik, perhaps you should carefully review the code to understand what it does, and then you may either answer your own question or find a more specific question. I can see a number of issues in the code that are outside the bounds of your question to address (e.g. <code>On Error</code>, not using the <code>InputBox</code> parameters to force a <code>String</code>, strange use of Hungarian Notation, <code>Selection</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 10222735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pkIcITJv5Qc/AAAAAAAAAAI/AAAAAAAAAP8/-R7GnQkA-H8/photo.jpg?sz=128", "display_name": "Directionsky", "link": "https://stackoverflow.com/users/10222735/directionsky"}, "edited": false, "score": 0, "creation_date": 1544164262, "post_id": 53645535, "comment_id": 94186436, "body": "Hi Ahmed AU thank you for the solution, you made my day easier.. its very helpful as guys like you guide the people in need of knowledge, great work keep up"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1544107103, "last_edit_date": 1544107103, "creation_date": 1544076444, "answer_id": 53645535, "question_id": 53626065, "link": "https://stackoverflow.com/questions/53626065/need-suggestion-or-help-to-modify-a-macro-that-can-search-a-sub-string-and-forma/53645535#53645535", "title": "Need suggestion or help to modify a macro that can search a sub-string and format after wildcard search for VBA", "body": "<p>Though question is not clear and the code have multiple issues, I presumed that it applies to Excel and will intended to work only with * as wildcard charterer. Code is  tried to be modified for presumed intended use. </p>\n\n<pre><code>Sub X_FormatSubStrings()\nDim xHStr As String, CellStr As String\nDim xStrTmp As String, xHStrLen As Long\nDim xCount As Long, i As Long, StPos As Long, EndPos As Long, Pos As Long\nDim xCell As Range\nDim xArr\n\nxHStr = InputBox(\"What is the string to highlight:\", \"Enter the string\", \"*asd*rt*ss*\")\nIf TypeName(xHStr) &lt;&gt; \"String\" Then Exit Sub\nIf Len(xHStr) = 0 Then Exit Sub\nxArr = Split(xHStr, \"*\")\n\n    For Each xCell In Selection\n    CellStr = xCell.Value\n    StPos = 0\n    EndPos = 0\n\n\n            For i = LBound(xArr) To UBound(xArr)\n            Pos = InStr(1, CellStr, xArr(i))\n            If Pos &lt;= 0 Then Exit For\n            If i = LBound(xArr) Then StPos = Pos\n            If i = UBound(xArr) Then EndPos = Pos + Len(xArr(i)) - 1\n            If i = UBound(xArr) And xArr(i) = \"\" Then EndPos = Len(CellStr)\n            Next i\n\n            If StPos &gt; 0 And EndPos &gt;= StPos Then\n            xCell.Characters(StPos, EndPos - StPos + 1).Font.ColorIndex = 3\n            xCell.Characters(StPos, EndPos - StPos + 1).Font.Bold = True\n            End If\n\n    Next xCell\n    MsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 88, "user_id": 10222735, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-pkIcITJv5Qc/AAAAAAAAAAI/AAAAAAAAAP8/-R7GnQkA-H8/photo.jpg?sz=128", "display_name": "Directionsky", "link": "https://stackoverflow.com/users/10222735/directionsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 53645535, "answer_count": 1, "score": 0, "last_activity_date": 1544107103, "creation_date": 1543989675, "last_edit_date": 1543992455, "question_id": 53626065, "link": "https://stackoverflow.com/questions/53626065/need-suggestion-or-help-to-modify-a-macro-that-can-search-a-sub-string-and-forma", "title": "Need suggestion or help to modify a macro that can search a sub-string and format after wildcard search for VBA", "body": "<p>I have a question for you all brilliant people here, who are experts in VBA.\nI have found this super cool macro that colors a text that is provided through an input box.\nHowever, I tried to make a little modification, I am trying to make it to use a wildcard <code>\"*\"</code>\nfor instance if I provide <code>VBA*</code>, in the input the string from <code>\"VBA\"</code> to end of the text in that selected range should be formatted.\nA goggled sub-string formatting vba code. None were found so I altered this code hoping one of you can add some magic in a moment.</p>\n\n<p>This is the code I found in search:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub X_FormatSubStrings()\n    Dim xHStr As String, xStrTmp As String\n    Dim xHStrLen As Long, xCount As Long, i As Long\n    Dim xCell As Range\n    Dim xArr\n    On Error Resume Next\n    xHStr = Application.InputBox(\"What is the string to highlight:\", \"Enter the string\", \"\")\n    If TypeName(xHStr) &lt; &gt; \"String\" Then Exit Sub\n    Application.ScreenUpdating = False\n    xHStrLen = Len(xHStr)\n    For Each xCell In Selection\n        xArr = Split(xCell.Value, xHStr)\n        xCount = UBound(xArr)\n        If xCount &gt; 0 Then\n            xStrTmp = \"\"\n            For i = 0 To xCount - 1\n                xStrTmp = xStrTmp &amp; xArr(i)\n                xCell.Characters(Len(xStrTmp) + 1, xHStrLen).Font.ColorIndex = 3\n                xCell.Characters(Len(xStrTmp) + 1, xHStrLen).Font.Bold = 3\n                xStrTmp = xStrTmp &amp; xHStr\n            Next\n        End If\n    Next\n    Application.ScreenUpdating = True\n    MsgBox \"Done\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10747731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156769174792488/picture?type=large", "display_name": "Jiakee Lee", "link": "https://stackoverflow.com/users/10747731/jiakee-lee"}, "edited": false, "score": 0, "creation_date": 1543998807, "post_id": 53626906, "comment_id": 94115920, "body": "i tested the code but it seems only all range A1:A5 filled up only will trigger the fuction.. i need whenever any cell in A1 to A5 is filled up it willl trigger the fuction.."}, {"owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "reply_to_user": {"reputation": 3, "user_id": 10747731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156769174792488/picture?type=large", "display_name": "Jiakee Lee", "link": "https://stackoverflow.com/users/10747731/jiakee-lee"}, "edited": false, "score": 0, "creation_date": 1544023371, "post_id": 53626906, "comment_id": 94130663, "body": "@JiakeeLee, I thought you mean all the cell is filled up. I modified the solution"}], "tags": [], "owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1544023340, "last_edit_date": 1544023340, "creation_date": 1543993507, "answer_id": 53626906, "question_id": 53626064, "link": "https://stackoverflow.com/questions/53626064/vba-call-function-on-next-cell-when-specified-range-is-selected/53626906#53626906", "title": "VBA - call function on next cell when specified range is selected", "body": "<p>So you are going to use <strong>Worksheet Change Event</strong> + <strong>IsEmpty</strong> method to help you determine \"whenever A1 to A5 cell is filled up\". For programming with worksheet event, you should place your code in the corresponding worksheet object, not normal module object. Below the code shall get u start</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(\"A1:A5\")) Is Nothing Then\n        For Each cell In Me.Range(\"A1:A5\")\n            If IsEmpty(cell.Value) Then\n                Exit Sub\n            End If\n        Next cell\n\n        'Call YourOwnFunction(......) From Here...\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>if you want <strong>any</strong> of the cell is filled up instead of the all cells filled up:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(\"A1:A5\")) Is Nothing Then\n        For Each cell In Me.Range(\"A1:A5\")\n            If Not IsEmpty(cell.Value) Then\n                'Call YourOwnFunction(......) From Here...\n                 Exit Sub\n            End If\n        Next cell      \n    End If      \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1544034185, "creation_date": 1544034185, "answer_id": 53638509, "question_id": 53626064, "link": "https://stackoverflow.com/questions/53626064/vba-call-function-on-next-cell-when-specified-range-is-selected/53638509#53638509", "title": "VBA - call function on next cell when specified range is selected", "body": "<p>In worksheet module:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Application.CountA([A1:A5]) = 5 Then\n        '// Your code here\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10747731, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156769174792488/picture?type=large", "display_name": "Jiakee Lee", "link": "https://stackoverflow.com/users/10747731/jiakee-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 53626906, "answer_count": 2, "score": -1, "last_activity_date": 1544034185, "creation_date": 1543989654, "last_edit_date": 1543992631, "question_id": 53626064, "link": "https://stackoverflow.com/questions/53626064/vba-call-function-on-next-cell-when-specified-range-is-selected", "title": "VBA - call function on next cell when specified range is selected", "body": "<p>I have a range of empty cell eg: A1 to A5</p>\n\n<p>I would like to have a private sub to call an function on B1 to B5 whenever A1 to A5 cell is filled up.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["arrays", "json", "excel", "vba", "type-mismatch"], "comments": [{"owner": {"reputation": 35, "user_id": 10747454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737bc085119dcbcd383c446789e699ae?s=128&d=identicon&r=PG&f=1", "display_name": "A Kapadia", "link": "https://stackoverflow.com/users/10747454/a-kapadia"}, "edited": false, "score": 1, "creation_date": 1543984759, "post_id": 53625191, "comment_id": 94110629, "body": "Please note that JSON(2)(element) should be JSON(x)(element)."}, {"owner": {"reputation": 10897, "user_id": 736172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b2d80f32ba198cf07c5ab0e0af469d?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/736172/ahmad"}, "edited": false, "score": 0, "creation_date": 1543992905, "post_id": 53625191, "comment_id": 94113231, "body": "H A Kapadia. Welcome to stackoverflow!. For your information: <code>Dim x, y, r As Integer</code> will give you <code>x As Object</code>, <code>y As Object</code> and <code>r As Integer</code>. What you need to type is <code>Dim x As Integer, y As Integer, r As Integer</code>"}, {"owner": {"reputation": 7749, "user_id": 4046632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e6a87a176719c607a2a73ce6728d88?s=128&d=identicon&r=PG&f=1", "display_name": "buran", "link": "https://stackoverflow.com/users/4046632/buran"}, "reply_to_user": {"reputation": 10897, "user_id": 736172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b2d80f32ba198cf07c5ab0e0af469d?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/736172/ahmad"}, "edited": false, "score": 0, "creation_date": 1543995981, "post_id": 53625191, "comment_id": 94114630, "body": "@Ahmad, actually x and y will be Variant. And although it&#39;s better to declare x and y as Integer explicitly, this declaration will not prevent it from working if everything else is correct"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1543998920, "post_id": 53625191, "comment_id": 94115968, "body": "JsonConverter.ParseJson can return a Collection or a Dictionary, (so your arrayLen Variabel is already confusing). Try using the watch window to see how your data is structured. The twin braces in JSON(2)(element) also look wrong....  If &#39;JSON&#39; is a dictionary you are trying to write whatever is in &#39;element&#39; to the key &quot;2&quot; (as integer/long), although it expects a String.  What data are you expecting from the JSON Object."}], "answers": [{"tags": [], "owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "is_accepted": true, "score": 1, "last_activity_date": 1544001003, "creation_date": 1544001003, "answer_id": 53628697, "question_id": 53625191, "link": "https://stackoverflow.com/questions/53625191/json-import-generates-run-time-error-13-type-mismatch/53628697#53628697", "title": "JSON import generates run-time error &#39;13&#39; Type mismatch", "body": "<p>I just ran the JSON through the converter and this is the structure that I get:  </p>\n\n<ul>\n<li>-Dictionary(2 items)</li>\n<li>--Collection(4 items)</li>\n<li>---Dictionary(20 items)</li>\n</ul>\n\n<p>You need to extract the data accordingly. Collections can be looped through with a simple for each loop. Dictionarys can be looped through with the following structure.</p>\n\n<pre><code>Option Explicit\n\n\nSub PrintFinancialReports()\n\n    Dim apiURL As String\n    apiURL = \"https://api.iextrading.com/1.0/stock/aapl/financials?period=annual\"\n\n    Dim myrequest As WinHttpRequest\n    Set myrequest = New WinHttpRequest\n\n    myrequest.Open \"Get\", apiURL\n    myrequest.Send\n\n    Debug.Print myrequest.ResponseText ' print received JSON to check if it is valid\n\n    Dim FinancialReportQuery As Dictionary\n    Set FinancialReportQuery = JsonConverter.ParseJson(myrequest.ResponseText)\n\n    Debug.Print FinancialReportQuery.Item(\"symbol\")\n\n    Dim Reports As Collection\n    Set Reports = FinancialReportQuery.Item(\"financials\")\n\n    Dim report As Dictionary\n    For Each report In Reports\n        Dim reportContentKey As Variant '&lt;-- variant is needed to loop a dictionary\n        For Each reportContentKey In report\n            Debug.Print reportContentKey, report.Item(reportContentKey)\n        Next reportContentKey\n    Next report\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 35, "user_id": 10747454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737bc085119dcbcd383c446789e699ae?s=128&d=identicon&r=PG&f=1", "display_name": "A Kapadia", "link": "https://stackoverflow.com/users/10747454/a-kapadia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 53628697, "answer_count": 1, "score": 2, "last_activity_date": 1546798770, "creation_date": 1543984106, "last_edit_date": 1546798770, "question_id": 53625191, "link": "https://stackoverflow.com/questions/53625191/json-import-generates-run-time-error-13-type-mismatch", "title": "JSON import generates run-time error &#39;13&#39; Type mismatch", "body": "<p>I receive run-time error '13' Type mismatch when trying to import some data via IEX API using JSON.</p>\n\n<p>I receive the error when setting the values for the cells in the For Each loop.</p>\n\n<p>Here's a link to view the API data: \n<a href=\"https://api.iextrading.com/1.0/stock/aapl/financials?period=annual\" rel=\"nofollow noreferrer\">https://api.iextrading.com/1.0/stock/aapl/financials?period=annual</a></p>\n\n<pre><code>Sub getFinancials()\n\n'Write to ws\nDim ws As Worksheet\nSet ws = Sheets(\"Financials\")\n\nDim ticker As String\nticker = ws.Range(\"P7\").value\n\nDim lastrow As Long\nlastrow = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'Clear Range\nws.Range(\"A1:L\" &amp; lastrow).Clear\n\n'Array Column Headers\nDim myarray As Variant\nmyarray = Array(\"reportDate\", \"grossProfit\", \"costOfRevenue\", \"operatingRevenue\", \"totalRevenue\", \"operatingIncome\", \"netIncome\", \"researchAndDevelopment\", \"operatingExpense\", \"currentAssets\", \"totalAssets\", \"totalLiabilities\", \"currentCash\", \"currentDebt\", \"totalCash\", \"totalDebt\", \"shareholderEquity\", \"cashChange\", \"cashFlow\", \"operatingGainsLosses\")\nArrsize = UBound(myarray) - LBound(myarray) + 1\n\nDim rngTarget As Range\nSet rngTarget = ws.Range(Cells(2, 1), Cells(Arrsize + 1, 1))\nrngTarget.value = Application.Transpose(myarray)    \n\n'Send web request for API Data\nu = \"https://api.iextrading.com/1.0/stock/\" &amp; ticker &amp; \"/financialsperiod=annual\"\n' https://api.iextrading.com/1.0/stock/aapl/financials?period=annual\nSet myrequest = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nmyrequest.Open \"Get\", u\nmyrequest.Send\n\n'Parse JSON\nDim JSON As Object\nSet JSON = JsonConverter.ParseJson(myrequest.ResponseText)\n\n'Get # of Objects in Array\nDim arrayLen As Integer\narrayLen = JSON.Count\n\n'Loop through Elements\nDim element As Variant\nDim x, y, r As Integer\nr = 2\ny = 2\nx = 1\n\nWhile x &lt; arrayLen + 1\n    For Each element In myarray\n        ws.Cells(r, y).value = JSON(2)(element)\n        y = y + 1\n    Next element\n\n    y = 2\n    x = x + 1\n    r = r + 1\nWend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "object"], "answers": [{"comments": [{"owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "edited": false, "score": 0, "creation_date": 1543987210, "post_id": 53625415, "comment_id": 94111261, "body": "Thanks for your time into this. ~~~   I am so confused when I find this, lol.  BTW, I prefer still use the full qualifier in the future. The shortcut way can be confusing."}], "tags": [], "owner": {"reputation": 101, "user_id": 4209542, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LU9qTK2gQHo/AAAAAAAAAAI/AAAAAAAAAAA/-6ZlzT4HEJc/photo.jpg?sz=128", "display_name": "Diederik Sieburgh", "link": "https://stackoverflow.com/users/4209542/diederik-sieburgh"}, "is_accepted": false, "score": 0, "last_activity_date": 1543985874, "creation_date": 1543985874, "answer_id": 53625415, "question_id": 53625186, "link": "https://stackoverflow.com/questions/53625186/excel-vba-application-find-method/53625415#53625415", "title": "Excel VBA Application.Find() Method", "body": "<p>This is indeed very interesting. It appears that this is a shortcut to Application.WorksheetFunction.Find. The Find method you are using is not the same as the VBA Find method for Range.Find, it is the same as the worksheet function Find. </p>\n\n<p>I also tested other Worksheet Functions and they all appear to also work: Application.Sum, Application.Count. But others already have a defined Application method (such as Application.Left does not shortcut to Worksheet Function).</p>\n"}, {"comments": [{"owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "edited": false, "score": 0, "creation_date": 1543988303, "post_id": 53625640, "comment_id": 94111590, "body": "Thanks!! a comprehensive explain~~      At runtime <code>Application.Find</code> is extended via Excel calculation engine to <code>Application.worksheetfunction.find</code>. um...cool~"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "edited": false, "score": 0, "creation_date": 1543988846, "post_id": 53625640, "comment_id": 94111761, "body": "There&#39;s no reason to use either in VBA code: use <code>InStr</code> instead."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1543989290, "post_id": 53625640, "comment_id": 94111892, "body": "A small nit: by default all COM types are extensible. One must explicitly mark it as nonextensible to prevent additional methods getting tacked on an interface. In that case, Excel type didn&#39;t have to be marked as extensible."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 5, "last_activity_date": 1543989347, "last_edit_date": 1543989347, "creation_date": 1543987388, "answer_id": 53625640, "question_id": 53625186, "link": "https://stackoverflow.com/questions/53625186/excel-vba-application-find-method/53625640#53625640", "title": "Excel VBA Application.Find() Method", "body": "<p><code>Application.Find</code> is an extended member of the <code>Excel.Application</code> interface.. it's pretty much tacked-on at runtime, that's why it's not showing anywhere. The COM type for <code>Excel.Application</code> is  <em>extensible</em>, and extended with what appears to be members of the <code>WorksheetFunction</code> interface, but through the Excel calculation engine (or at least, consistent with how Excel would evaluate it) rather than through the VBA runtime.</p>\n\n<p>In other words this:</p>\n\n<pre><code>Debug.Print Application.Find(\"4\", \"12345\", 1)\n</code></pre>\n\n<p>Is pretty much this:</p>\n\n<pre><code>Debug.Print Application.WorksheetFunction.Find(\"4\", \"12345\", 1)\n</code></pre>\n\n<p>The difference is more obvious when you give them invalid parameters:</p>\n\n<pre><code>Debug.Print TypeName(Application.Find(\"4\", \"12345\", 10))\nDebug.Print TypeName(Application.WorksheetFunction.Find(\"4\", \"12345\", 10))\n</code></pre>\n\n<p>The first prints <code>Error</code>, the second throws run-time error 1004, allowing for more idiomatic error handling (i.e. an <code>On Error</code> statement will kick in). The <code>Error</code> type can't be converted to any other VBA type, so expect run-time error 13 \"type mismatch\" if you try to assign it to a <code>String</code>, or anything other than a <code>Variant</code>. The <code>IsError</code> function returns <code>True</code> given a <code>Variant/Error</code> variable/expression.</p>\n\n<p>If you need to locate the position of a substring inside a <code>String</code>, use the <code>VBA.Strings.InStr</code> function:</p>\n\n<pre><code>Debug.Print InStr(1, \"12345\", \"4\", vbTextCompare)\n</code></pre>\n\n<p>Note the order of the parameters, and the additional <code>VbCompareMethod</code> parameter that makes a case-insensitive search with <code>vbTextCompare</code>, a case-sensitive search with <code>vbBinaryCompare</code>, and if you're in Access, <code>vbDatabaseCompare</code> matches the comparison method of the current database. If omitted, <code>Option Compare</code> specified at module level determines the parameter value; <code>Option Compare Binary</code> being the default.</p>\n\n<p>Invoking early-bound VBA standard library functions should incur less run-time overhead than querying <code>IDispatch</code> on an <code>Object</code> to locate a <code>Find</code> function... and then get Excel to evaluate the result.</p>\n\n<p>Other examples of extended interfaces include <code>ADODB.Connection</code>, against which you <em>can</em> (whether you <em>should</em> is another question!) invoke a stored procedure as you would a member call - note that here again, <em>intellisense</em> can't help, and <code>Option Explicit</code> will turn a blind eye, for these calls are always late-bound (i.e. resolved at run-time).</p>\n"}], "owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3062, "favorite_count": 0, "accepted_answer_id": 53625640, "answer_count": 2, "score": 3, "last_activity_date": 1543989347, "creation_date": 1543984059, "question_id": 53625186, "link": "https://stackoverflow.com/questions/53625186/excel-vba-application-find-method", "title": "Excel VBA Application.Find() Method", "body": "<p>Based on Microsoft VBA docs, I know there's <code>Range.Find(What, After, LookIn, Lookat, SearchOrder....)</code>, but there is no <code>Application.Find()</code> method. And if I go to the <strong>Object Browser</strong> in <strong>VBE</strong> to inspect the <em>Application</em> object, I still not see any <em>Find</em> method attached to <em>Application</em> object. And it makes sense there is no intellisense when I type \"Application.Find(\"</p>\n\n<p>However, The Application.Find() method just works.</p>\n\n<pre><code>txt = \"EEZ || EZE 123\"\npos = Application.Find(\" \", txt, 1)\n</code></pre>\n\n<p>the pos will have value 4. Why? ... no docs, no method in the object browser, the method can still work?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2292, "user_id": 4502035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38a1b21c3e83f9d10aaa56c93f6150a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/4502035/andreas"}, "edited": false, "score": 2, "creation_date": 1543982916, "post_id": 53624991, "comment_id": 94110160, "body": "Please elaborate more on how the code is not working"}, {"owner": {"reputation": 51, "user_id": 2829218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/046076f4867d2b4dd689c90db6e5d854?s=128&d=identicon&r=PG&f=1", "display_name": "user2829218", "link": "https://stackoverflow.com/users/2829218/user2829218"}, "reply_to_user": {"reputation": 2292, "user_id": 4502035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38a1b21c3e83f9d10aaa56c93f6150a?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/4502035/andreas"}, "edited": false, "score": 0, "creation_date": 1543983155, "post_id": 53624991, "comment_id": 94110201, "body": "sure, it throwing error as &quot;Name already exists&quot;. In fact it creates sheet but loop not ending."}, {"owner": {"reputation": 10897, "user_id": 736172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/25b2d80f32ba198cf07c5ab0e0af469d?s=128&d=identicon&r=PG", "display_name": "Ahmad", "link": "https://stackoverflow.com/users/736172/ahmad"}, "edited": false, "score": 0, "creation_date": 1543993749, "post_id": 53624991, "comment_id": 94113583, "body": "At which line does the error is raised? And what sheet name are you trying to set when the error is raised?"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1544003583, "creation_date": 1544003583, "answer_id": 53629457, "question_id": 53624991, "link": "https://stackoverflow.com/questions/53624991/comparing-2-workbooks-for-missing-sheet-in-excel-vba/53629457#53629457", "title": "Comparing 2 workbooks for missing sheet in excel vba", "body": "<p>Rather than check each worksheet you could try and set a reference to it - if the reference is set then the sheet exists, if it throws an error then it doesn't exist.  </p>\n\n<p>I'd use a separate function to return TRUE/FALSE on the sheet existing - one of the few times that I'd use <code>On Error Resume Next</code> to ignore any errors.  </p>\n\n<pre><code>Public Sub CopySheets()\n\n    Dim wrkBk As Workbook\n    Dim wrkSht As Worksheet\n    Dim wrkShtNew As Worksheet\n\n    Set wrkBk = Workbooks(\"Book2\")\n\n    For Each wrkSht In ThisWorkbook.Worksheets\n        If Not WorkSheetExists(wrkSht.Name, wrkBk) Then\n            Set wrkShtNew = wrkBk.Worksheets.Add\n            wrkShtNew.Name = wrkSht.Name\n        Else\n            MsgBox wrkSht.Name &amp; \" exists.\", vbOKOnly + vbInformation\n        End If\n    Next wrkSht\n\nEnd Sub\n\nPublic Function WorkSheetExists(SheetName As String, Optional wrkBk As Workbook) As Boolean\n    Dim wrkSht As Worksheet\n\n    If wrkBk Is Nothing Then\n        Set wrkBk = ThisWorkbook\n    End If\n\n    On Error Resume Next\n        Set wrkSht = wrkBk.Worksheets(SheetName)\n        WorkSheetExists = (Err.Number = 0)\n        Set wrkSht = Nothing\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 2829218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/046076f4867d2b4dd689c90db6e5d854?s=128&d=identicon&r=PG&f=1", "display_name": "user2829218", "link": "https://stackoverflow.com/users/2829218/user2829218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 53629457, "answer_count": 1, "score": 0, "last_activity_date": 1581745726, "creation_date": 1543982420, "last_edit_date": 1581745726, "question_id": 53624991, "link": "https://stackoverflow.com/questions/53624991/comparing-2-workbooks-for-missing-sheet-in-excel-vba", "title": "Comparing 2 workbooks for missing sheet in excel vba", "body": "<p>I had a requirement which is in excel macro. Here is the scenario : </p>\n\n<p>I have 2 workbooks, Say A and B</p>\n\n<p>Workbook \"A\" contains, sheet 1, sheet2 and sheet3, Workbook \"B\" contains sheet4</p>\n\n<p>Now i need to compare Workbook \"B\" with Workbook A. If a sheet exist in Workbook \"A\" which is not in Workbook \"B\" (Here Sheet1, Sheet2, Sheet3) then i need to add these 3 sheets to Workbook \"B\"</p>\n\n<p>So finally, B workbook should contain : Sheet 1, sheet 2, sheet 3 and sheet 4.</p>\n\n<p>Tried below code but its not working.</p>\n\n<pre><code>Set act = ThisWorkbook\npath = Sheet1.TextBox1.Text\nSet owb = Workbooks.Open(Filename:=path)\nFor Each ws In ThisWorkbook.Worksheets\n    a = ws.Name\n    For Each ws1 In owb.Worksheets\n       If ws1.Name = a Then\n          MsgBox \"Found\"\n       Else\n          Set wsnew = owb.Sheets.Add\n          wsnew.Name = a\n       End If\n     Next ws1\nNext ws\n</code></pre>\n"}, {"tags": ["excel", "vba", "sum", "subtotal"], "comments": [{"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1543983441, "post_id": 53624670, "comment_id": 94110273, "body": "If dates.Cells(i) &lt;= thold And dates.Cells(1).EntireRow.Hidden = False Then"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10735198"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 0, "creation_date": 1544000653, "post_id": 53624670, "comment_id": 94116784, "body": "@MichalRosa - you shouldn&#39;t have to compare a boolean to a boolean constant to determine a boolean result. <code>... And Not dates.Cells(i).EntireRow.Hidden</code> should be sufficient. (note <b>i</b> not <b>1</b>)"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "is_accepted": false, "score": 0, "last_activity_date": 1544585314, "creation_date": 1544585314, "answer_id": 53735630, "question_id": 53624670, "link": "https://stackoverflow.com/questions/53624670/sum-filtered-visible-data-only-vba/53735630#53735630", "title": "Sum Filtered/Visible Data only VBA", "body": "<p>Thanks to Michal and user 10735198 for your input:</p>\n\n<pre><code>Function maxUniqueWithThresholda(ids As Range, vals As Range, _\n                            dates As Range, thold As Long)\nStatic d As Object, i As Long\n\n'create a dictionary for unique ids only if not previously created\nIf d Is Nothing Then Set d = CreateObject(\"scripting.dictionary\")\nd.RemoveAll\n\n'limit the processing ranges\nSet ids = Intersect(ids, ids.Parent.UsedRange)\nSet vals = vals.Resize(ids.Rows.Count, ids.Columns.Count)\nSet dates = dates.Resize(ids.Rows.Count, ids.Columns.Count)\n\n'cycle through the processing ranges\nFor i = 1 To ids.Cells.Count\n    'is date within threshold?\n    If dates.Cells(i) &lt;= thold And dates.Cells(i).EntireRow.Hidden = False Then\n        'collect the maximum value for each unique id into dictionary Items\n        d.Item(ids.Cells(i).Value2) = _\n          Application.Max(d.Item(ids.Cells(i).Value2), vals.Cells(i).Value2)\n    End If\nNext i\n\nmaxUniqueWithThresholda = Application.Sum(d.items)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6343949, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b42b4daee750816750ba1b4582a92772?s=128&d=identicon&r=PG&f=1", "display_name": "ERZUT", "link": "https://stackoverflow.com/users/6343949/erzut"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 703, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581745736, "creation_date": 1543979957, "last_edit_date": 1581745736, "question_id": 53624670, "link": "https://stackoverflow.com/questions/53624670/sum-filtered-visible-data-only-vba", "title": "Sum Filtered/Visible Data only VBA", "body": "<p>I have a VBA script that was very kindly <a href=\"https://stackoverflow.com/questions/24935099/summing-values-in-filtered-rows-only\">provided by another member</a>.</p>\n\n<p>Since requesting help, I have realised that I need to sum just the data in the visible cells as the SUBTOTAL function does (e.g. if a filter is applied). I have attempted to insert <code>xlCellTypeVisible</code> but have not had much luck (still new to VBA!). The context behind this macro can be found by reading the thread in the above link.</p>\n\n<p>Can anyone help with the correct code?</p>\n\n<pre><code> Function maxUniqueWithThresholda(ids As Range, vals As Range, _\n                                 dates As Range, thold As Long)\n     Static d As Object, i As Long\n\n     'create a dictionary for unique ids only if not previously created\n     If d Is Nothing Then Set d = CreateObject(\"scripting.dictionary\")\n     d.RemoveAll\n\n     'limit the processing ranges\n     Set ids = Intersect(ids, ids.Parent.UsedRange)\n     Set vals = vals.Resize(ids.Rows.Count, ids.Columns.Count)\n     Set dates = dates.Resize(ids.Rows.Count, ids.Columns.Count)\n\n     'cycle through the processing ranges\n     For i = 1 To ids.Cells.Count\n         'is date within threshold?\n         If dates.Cells(i) &lt;= thold And xlCellTypeVisible Then\n             'collect the maximum value for each unique id into dictionary Items\n             d.Item(ids.Cells(i).Value2) = _\n               Application.Max(d.Item(ids.Cells(i).Value2), vals.Cells(i).Value2)\n         End If\n     Next i\n\n     maxUniqueWithThresholda = Application.Sum(d.items)\n\n End Function\n</code></pre>\n\n<p>Many thanks for any help in advance</p>\n"}, {"tags": ["vba", "powerpoint", "transition"], "owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2159, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1543979759, "creation_date": 1543979759, "question_id": 53624649, "link": "https://stackoverflow.com/questions/53624649/powerpoint-curtain-closing-transition-effect-workaround", "title": "Powerpoint curtain &#39;closing&#39; transition effect workaround", "body": "<p>In MS Powerpoint 2016(maybe 2013) or above, there is a transition effect which opens the slide with a curtain.\nThe only way to make the curtain close is to pressing 'P' key (or 'BackSpace', PgUp  keys).\nI know there are users' voices to request this closing curtain effect ( <a href=\"https://powerpoint.uservoice.com/forums/288949-powerpoint-for-windows-desktop-application/suggestions/15570894-please-make-a-curtain-closing-transition-in-powerp\" rel=\"nofollow noreferrer\">https://powerpoint.uservoice.com/forums/288949-powerpoint-for-windows-desktop-application/suggestions/15570894-please-make-a-curtain-closing-transition-in-powerp</a> )</p>\n\n<p>So I thought about how to accomplish this.\nI figured out that if I send those 'Back' keys(P, BackSpace or PgUp) on the next slide of the transition slide, it would be possible to make it close the curtain.</p>\n\n<p>Here I suppose the transition effect is on slide #2. And I added a closing button(shape) on the last slide. If the presenter presses the 'close' button on the last slide, it goes like this:\n1. move to slide #2 where the curtain effect is applied \n2. send a(ny) key to stop the previous transition effect.\n3. wait for a second\n4. send a real BackSpace key(or 'P', 'PgUp' key)\n5. Finally, here comes the closing curtain effect.</p>\n\n<p>Following is the macro code that I wrote.</p>\n\n<pre><code>Sub CloseCurtain()\n\n    SlideShowWindows(1).View.GotoSlide 2\n\n    'Send any key\n    SendKeys \"{PGUP}\"   'make the transition effect(opening curtain) finish\n\n    'wait for 1 second\n    Wait = Timer\n    Do While Timer &lt; Wait + 1\n        DoEvents\n    Loop\n\n    SendKeys \"{PGUP}\"   'move to the previous slide and close the curtain\n    'SendKeys \"{BS}\" \"{P}\" \"{UP}\" is the same\n\nEnd Sub\n</code></pre>\n\n<p>Do you have any suggestion or better ideas about this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1543973797, "creation_date": 1543973797, "answer_id": 53623909, "question_id": 53623772, "link": "https://stackoverflow.com/questions/53623772/copy-dynamically-and-paste-to-different-excel-sheet/53623909#53623909", "title": "Copy Dynamically and paste to different excel sheet", "body": "<p>Try this out. Capture the used range address of the sheet and then paste to the same region.</p>\n\n<pre><code>Dim filename As String\nfilename = Application.GetOpenFilename\nDim src As Workbook\nSet src = Workbooks.Open(filename, True, True)\n\n\nDim addressText As String\nThisWorkbook.Activate\naddressText = Worksheets(1).UsedRange.Address\nWorksheets(1).Range(addressText).Formula = src.Worksheets(2).Range(addressText).Formula\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8251764, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c005033dcf27c51baac868ff36753ce?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/8251764/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544003827, "creation_date": 1543972517, "last_edit_date": 1544003827, "question_id": 53623772, "link": "https://stackoverflow.com/questions/53623772/copy-dynamically-and-paste-to-different-excel-sheet", "title": "Copy Dynamically and paste to different excel sheet", "body": "<p>I am trying to copy data from a closed excel sheet another excel sheet. The code below is working fine as expected. However, I want to dynamically copy all filled rows and columns, instead of having these ranges hard coded in my macro. Can you please help me on this?</p>\n\n<pre><code>Dim filename As String\nfilename = Application.GetOpenFilename\nDim src As Workbook\nSet src = Workbooks.Open(filename, True, True)\nThisWorkbook.Activate\nWorksheets(1).Range(\"A1:BL648\").Formula = src.Worksheets(2).Range(\"A1:BL648\").Formula\n</code></pre>\n\n<p>Like I mentioned, the code above is working fine, but I have hard coded both copy and paste ranges. Instead  Ineed those to be made dynamic to copy only filled values from src.worksheets(2) and paste these to worksheets(1).</p>\n\n<pre><code>Worksheets(1).Range(\"A1:BL648\").Formula = src.Worksheets(2).Range(\"A1:BL648\").Formula\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10735198"}, "edited": false, "score": 0, "creation_date": 1543970837, "post_id": 53623542, "comment_id": 94107416, "body": "Isn&#39;t the addition of client B going to muck up your original &#39;paste macro&#39; or is it robust enough that displacing the Lists worksheet isn&#39;t going to make a differebnce? For that matter, do the changes have to be reviewed before running the sub procedure? IOW, why aren&#39;t the values transferred directly  and immediately with a Worksheet_Change private sub?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543975533, "post_id": 53623542, "comment_id": 94108523, "body": "It would help to see your code."}], "owner": {"reputation": 11, "user_id": 8625138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72c031d3e9523f247a1202d85bab866b?s=128&d=identicon&r=PG&f=1", "display_name": "M.CHA", "link": "https://stackoverflow.com/users/8625138/m-cha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1581745759, "creation_date": 1543970560, "last_edit_date": 1581745759, "question_id": 53623542, "link": "https://stackoverflow.com/questions/53623542/copy-values-to-only-certain-types-of-sheets", "title": "Copy values to only certain types of sheets", "body": "<p>I want to copy certain values from one 'Master' sheet, to certain multiple other sheets. </p>\n\n<p>For example, I have 5 sheets in my workbook:</p>\n\n<ol>\n<li>Intro (with a button to activate the paste macro)</li>\n<li>Mock-up</li>\n<li>Master</li>\n<li>Client A</li>\n<li>Lists</li>\n</ol>\n\n<p>If there is a change to the 'Master' sheet I want to copy that across to Client A. I am able to achieve this by specifying the macro button to paste changes onto sheet 4.</p>\n\n<p>My question is if I now add another sheet 'Client B':</p>\n\n<ol>\n<li>Intro (with a button to activate the paste macro)</li>\n<li>Mock-up</li>\n<li>Master</li>\n<li>Client A</li>\n<li>Client B</li>\n<li>Lists</li>\n</ol>\n\n<p>How do I get the same macro button to paste into 'Client A' and 'Client B'(and Client C, D, etc. when added later)?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1543970297, "creation_date": 1543970297, "answer_id": 53623508, "question_id": 53623494, "link": "https://stackoverflow.com/questions/53623494/apply-relative-references-to-a-formula-in-vba/53623508#53623508", "title": "Apply relative references to a formula in VBA", "body": "<p>Simply change <code>.FormulaR1C1</code> to <code>.Formula</code></p>\n\n<hr>\n\n<pre><code>...DataBodyRange.Formula = \"=IF(VLOOKUP([@[Account Name and ID]], FirstTimeDonor!$A$3:$C$5000, 3, FALSE)=[@Date], 1, 0)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": -1, "last_activity_date": 1543970578, "creation_date": 1543970578, "answer_id": 53623546, "question_id": 53623494, "link": "https://stackoverflow.com/questions/53623494/apply-relative-references-to-a-formula-in-vba/53623546#53623546", "title": "Apply relative references to a formula in VBA", "body": "<p>FormulaR1C1-your formula is using absolute references, not relative ones. Use just DataBodyRange.Formula= instead. </p>\n"}], "owner": {"reputation": 1, "user_id": 10583673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/144719d462726181f239de30713bda8d?s=128&d=identicon&r=PG&f=1", "display_name": "ChloVoe", "link": "https://stackoverflow.com/users/10583673/chlovoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1546632543, "creation_date": 1543970183, "last_edit_date": 1546632543, "question_id": 53623494, "link": "https://stackoverflow.com/questions/53623494/apply-relative-references-to-a-formula-in-vba", "title": "Apply relative references to a formula in VBA", "body": "<p>When posting the formula below in an Excel cell directly the correct results are displayed. However, when adding this to the VBA to refresh, when new data is uploaded, no output is given.</p>\n\n<p>Excel formula :  </p>\n\n<blockquote>\n  <p>=IF(VLOOKUP([@[Account Name and ID]], FirstTimeDonor!$A$3:$C$5000, 3, FALSE)=[@Date], \"FTD\", \"Non-FTD\")</p>\n</blockquote>\n\n<p>VBA: </p>\n\n<pre><code>tbl.ListColumns(\"First Time Donation\").DataBodyRange.FormulaR1C1 = _\n\"=IF(VLOOKUP([@[Account Name and ID]], FirstTimeDonor!$A$3:$C$5000, 3, FALSE)=[@Date], 1, 0)\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1543969172, "post_id": 53623335, "comment_id": 94107068, "body": "You already have a line of code that calculates the last row, why not alter it to find the bounds of the sheet that you&#39;re copying from"}, {"owner": {"reputation": 13, "user_id": 9553292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11526b590cf5c2e4dbfcdf30549ddbea?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Jump", "link": "https://stackoverflow.com/users/9553292/sam-jump"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1543969510, "post_id": 53623335, "comment_id": 94107145, "body": "I Frankensteined this code together from multiple posts to meet my needs, but have little grasp of VBA. Can you assist with how to find the bounds of the sheet?"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1543969753, "post_id": 53623335, "comment_id": 94107191, "body": "<a href=\"https://stackoverflow.com/a/11169920/10361731\">stackoverflow.com/a/11169920/10361731</a> This shows you how to find the last row with a bit more explanation. To find it for a new sheet, just change the sheets qualifier."}, {"owner": {"reputation": 13, "user_id": 9553292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11526b590cf5c2e4dbfcdf30549ddbea?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Jump", "link": "https://stackoverflow.com/users/9553292/sam-jump"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1543971807, "post_id": 53623335, "comment_id": 94107634, "body": "I added <i>lastrow = Sheets(ws,Name).Cells(Rows.Count, &quot;F&quot;).End(xlUp).Row + 1</i> within the for loop, but have taken steps backwards. Also changed the <i>ws.Range(&quot;F1:G15&quot;).Copy</i> to <i>ws.Range(&quot;F&quot; &amp; lastrow).Copy</i>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543976005, "post_id": 53623335, "comment_id": 94108623, "body": "Please edit your question to update your code."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 4127865, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/575827761/picture?type=large", "display_name": "Raphael Lee", "link": "https://stackoverflow.com/users/4127865/raphael-lee"}, "is_accepted": false, "score": -1, "last_activity_date": 1543982306, "last_edit_date": 1543982306, "creation_date": 1543980210, "answer_id": 53624705, "question_id": 53623335, "link": "https://stackoverflow.com/questions/53623335/consolidate-column-from-multiple-sheets-into-single-column-on-another-sheet/53624705#53624705", "title": "Consolidate column from multiple sheets into single column on another sheet", "body": "<p>I tried to keep your code as intact as possible. Here is one way to make it work (with as much preservation of your code as possible). There are still minor \"touch ups\" you would need to do (eg your \"Master\" sheet would have a blank row).</p>\n\n<pre><code>Sub MM1()\nDim ws As Worksheet\nFor Each ws In Worksheets\n     If ws.Name &lt;&gt; \"Master\" Then\n         ws.Range(ws.Range(\"F1\"), ws.Range(\"F1\").End(xlDown)).Copy\n         Sheets(\"Master\").Range(\"A65535\").End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues\n     End If\nNext ws\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9553292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11526b590cf5c2e4dbfcdf30549ddbea?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Jump", "link": "https://stackoverflow.com/users/9553292/sam-jump"}, "edited": false, "score": 0, "creation_date": 1544028254, "post_id": 53625146, "comment_id": 94133637, "body": "Thanks for the reply. This solution worked but copied the Formulas instead of Values. Additionally, I edited my original post for clarification."}], "tags": [], "owner": {"reputation": 101, "user_id": 2086121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FiCZV.jpg?s=128&g=1", "display_name": "Nirav Raval", "link": "https://stackoverflow.com/users/2086121/nirav-raval"}, "is_accepted": false, "score": 0, "last_activity_date": 1543983755, "creation_date": 1543983755, "answer_id": 53625146, "question_id": 53623335, "link": "https://stackoverflow.com/questions/53623335/consolidate-column-from-multiple-sheets-into-single-column-on-another-sheet/53625146#53625146", "title": "Consolidate column from multiple sheets into single column on another sheet", "body": "<p>only small changes and its working good :) <br/>\n1. I changed the <strong>Master to Sheet5</strong> => you can use your sheet name.<br/>\n2. Added <strong>a new variable</strong> in loop <strong>to identify the range for each sheet to be copied</strong>.<br/>\n3. Change the <strong>method to paste the copied data</strong> to destination. </p>\n\n<pre><code>Sub MM1()\nDim ws As Worksheet, lr As Long\nlr = Sheets(\"Sheet5\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Sheet5\" Then\n        Dim currentRange As Long\n        currentRange = ws.Cells(Rows.Count, \"A\").End(xlUp).Row\n        ws.Range(\"A1:A\" &amp; currentRange).Copy Destination:=Sheets(\"Sheet5\").Range(\"A\" &amp; lr)\n        lr = Sheets(\"Sheet5\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p><br/>let me know if this works for you or not ?</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9553292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11526b590cf5c2e4dbfcdf30549ddbea?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Jump", "link": "https://stackoverflow.com/users/9553292/sam-jump"}, "edited": false, "score": 0, "creation_date": 1544028151, "post_id": 53625408, "comment_id": 94133578, "body": "Thanks for the reply. Please see my edit to my post. Your solution works, but i&#39;d like to not copy the Blank values to the destination. I would like the loop to start on the next ws when a Blank value is present."}, {"owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "reply_to_user": {"reputation": 13, "user_id": 9553292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11526b590cf5c2e4dbfcdf30549ddbea?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Jump", "link": "https://stackoverflow.com/users/9553292/sam-jump"}, "edited": false, "score": 0, "creation_date": 1544029710, "post_id": 53625408, "comment_id": 94134485, "body": "@Sam Jump Use <code>ws.Cells(Rows.Count, &quot;F&quot;).End(xlUp).Row</code> assume your data  is reside in continues range. If you wanna have the logic \u201cWhenever facing a empty value, then jump to new sheet\u201d you can add one more control statement to code <code>If ws.Cells(i, &quot;F&quot;).Value = &quot;&quot; Then exit For</code> in the inner most loop"}, {"owner": {"reputation": 13, "user_id": 9553292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11526b590cf5c2e4dbfcdf30549ddbea?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Jump", "link": "https://stackoverflow.com/users/9553292/sam-jump"}, "edited": false, "score": 0, "creation_date": 1544132449, "post_id": 53625408, "comment_id": 94178419, "body": "Thank you! exactly what I needed."}], "tags": [], "owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1543985808, "creation_date": 1543985808, "answer_id": 53625408, "question_id": 53623335, "link": "https://stackoverflow.com/questions/53623335/consolidate-column-from-multiple-sheets-into-single-column-on-another-sheet/53625408#53625408", "title": "Consolidate column from multiple sheets into single column on another sheet", "body": "<p>First of all, you can use the same logic to get the last row in the column \"F\" in each datasheet instead of hard-coding 3 rows using<code>range.end(xlUp).Row</code> method.</p>\n\n<p>2nd I don't like the copy-paste method. it is slow and is very bothering you always calculate new insertion point and paste. You can utilize array in VBA to realize this functionality. And work with Array is very straightforward and fast.</p>\n\n<p>Below is the code you can grab and use.</p>\n\n<pre><code>Sub MM1()\nApplication.ScreenUpdating = False\n'Loop through worksheets, put the values in column F into arr array\nDim arr(1 To 10000), cnt As Integer, i As Integer\ncnt = 0\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Master\" Then\n        For i = 1 To ws.Cells(Rows.Count, \"F\").End(xlUp).Row\n            cnt = cnt + 1\n            arr(cnt) = ws.Cells(i, \"F\").Value\n        Next i\n    End If\nNext ws\n\n'Loop through arr array, populate value into Master sheet, column A\nFor i = 1 To cnt\n    ThisWorkbook.Sheets(\"Master\").Cells(i, \"A\") = arr(i)\nNext i\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9553292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11526b590cf5c2e4dbfcdf30549ddbea?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Jump", "link": "https://stackoverflow.com/users/9553292/sam-jump"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 53625408, "answer_count": 3, "score": 1, "last_activity_date": 1581745773, "creation_date": 1543968919, "last_edit_date": 1581745773, "question_id": 53623335, "link": "https://stackoverflow.com/questions/53623335/consolidate-column-from-multiple-sheets-into-single-column-on-another-sheet", "title": "Consolidate column from multiple sheets into single column on another sheet", "body": "<p>I need to copy all the text values from Column F on +10 sheets and place them in a single Column on an aggregate sheet. I do not need to perform any computation on the data, just copy the text values derived from formulas. For example:</p>\n\n<p>Sheet1 Col F:</p>\n\n<p>1</p>\n\n<p>2</p>\n\n<p>3</p>\n\n<p>Sheet2 Col F:</p>\n\n<p>4</p>\n\n<p>5</p>\n\n<p>6</p>\n\n<p>I would like \"Master\" Col A be:</p>\n\n<p>1</p>\n\n<p>2</p>\n\n<p>3</p>\n\n<p>...</p>\n\n<p>6</p>\n\n<p>This code gets me mostly there, but I need the Range to vary. For instance, not every sheet has 3 rows of data, but I want them to be copied directly after each other.</p>\n\n<pre><code>Sub MM1()\nDim ws As Worksheet, lr As Long\nlr = Sheets(\"Master\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Master\" Then\n        ws.Range(\"F1:G15\").Copy \n        Sheets(\"Master\").Range(\"A\" &amp; lr).PasteSpecial xlPasteValues\n        lr = Sheets(\"Master\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong> Every sheet DOES have the same number of rows with a formula in them, but the Values vary from sheet to sheet. So I need some check that looks for a \"\" Value as the \"last row\" then move to the next sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543970026, "post_id": 53623314, "comment_id": 94107246, "body": "What is the value? Static? Dynamic? Text? Number?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543970139, "post_id": 53623314, "comment_id": 94107268, "body": "Do you want to copy row by row? Or if any value in <code>Column A</code> = <code>Value</code> then copy the entire column of <code>B</code>, <code>C</code>, <code>D</code>? Is this a loop? When people tend to have a lot of questions, it hints to a poorly asked question. You also have not shared any code attempt."}, {"owner": {"reputation": 1, "user_id": 10746845, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATxhQwnf_k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hhGp8S3odxVCu61KO-ZpHa_a883g/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/10746845/chris"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1544024996, "post_id": 53623314, "comment_id": 94131672, "body": "I added an example to show what I&#39;m trying to do, hopefully this is more specific than my poor attempt at explaining it. I have not shared any code attempt because it would be offensive to the eyes and mind. I&#39;ve done some much more basic VBA ( This is probably basic to you ), but I wouldn&#39;t even know where to begin with this. Thanks for the tips!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10746845, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATxhQwnf_k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hhGp8S3odxVCu61KO-ZpHa_a883g/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/10746845/chris"}, "edited": false, "score": 0, "creation_date": 1544024492, "post_id": 53626365, "comment_id": 94131363, "body": "Thank you, this is very helpful! I added some examples to be more specific. Basically I have a worksheet with data from 4 sources, I need to create a separate worksheet for each individual source. So if a cell in Column A = Value1, I need the cells in column B, C, D of the same row to go to the new worksheet. I hope I&#39;m explaining this well enough. I appreciate the help!"}, {"owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "reply_to_user": {"reputation": 1, "user_id": 10746845, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATxhQwnf_k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hhGp8S3odxVCu61KO-ZpHa_a883g/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/10746845/chris"}, "edited": false, "score": 0, "creation_date": 1544026783, "post_id": 53626365, "comment_id": 94132725, "body": "@Chris glad you find it helpful. based on your modified question, I created a new script which will do what you want."}, {"owner": {"reputation": 1, "user_id": 10746845, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATxhQwnf_k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hhGp8S3odxVCu61KO-ZpHa_a883g/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/10746845/chris"}, "edited": false, "score": 0, "creation_date": 1544029836, "post_id": 53626365, "comment_id": 94134563, "body": "Excellent, I will give this a try. Thank you so much!"}], "tags": [], "owner": {"reputation": 314, "user_id": 10497887, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EenXU.jpg?s=128&g=1", "display_name": "Gen.L", "link": "https://stackoverflow.com/users/10497887/gen-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1544026955, "last_edit_date": 1544026955, "creation_date": 1543991201, "answer_id": 53626365, "question_id": 53623314, "link": "https://stackoverflow.com/questions/53623314/vba-if-a-cell-in-column-a-value-then-copy-column-b-c-d-of-same-row-to-new/53626365#53626365", "title": "VBA - IF a cell in column A = Value, then copy column B, C, D of same row to new worksheet", "body": "<p>You should ask the question more clearly so that we can help u. And every single step is easy. Just don't know what do you really need. You said you have some VBA done, so I assume you have the basics.\nFor \"column A = Value\" Part, I assume you are asking if the value is contained in column A somewhere.\nFor \"copy column B, C, D to column A, B, C on a new worksheet.\" I assume you are copying the whole column.\nThe following code gonna help you organize your thoughts and may get u start.</p>\n\n<pre><code>Sub YourMacr(ByVal compare_value)\n    Dim arr As Variant, srcSheet As Worksheet, destSheet As Worksheet\n    Set srcSheet = Sheets(\"xxxxxx\")\n    Set destSheet = Sheets(\"xxxxx\")\n    arr = srcSheet.Columns(\"A:A\")\n    If IsInArray(compare_value, arr) Then\n        srcSheet.Columns(\"B:D\").Copy\n        destSheet.Columns(\"A:C\").PasteSpecial xlPasteValues\n    End If\nEnd Sub\n\nPrivate Function IsInArray(target As Variant, arr As Variant) As Boolean\n    Dim ele As Variant\n    On Error GoTo IsInArrayError:\n    For Each ele In arr\n        If ele = target Then\n            IsInArray = True\n            Exit Function\n        End If\n    Next ele\n    Exit Function\nIsInArrayError:\n    On Error GoTo 0\n    IsInArray = False\nEnd Function\n</code></pre>\n\n<p>Based on your new description of you question, you want to copy paste the specific row to new sheet, not the whole data grid to sheet. Then, I prefer to use array to finished the task. The below code shall help you well. Hope this get u start</p>\n\n<pre><code>Public Sub YourMacr(ByVal compare_val)\n    Dim srcSheet As Worksheet, destSheet As Worksheet\n\n    Set srcSheet = ThisWorkbook.Sheets(\"your source sheet name ..........\")\n    Set destSheet = ThisWorkbook.Sheets(\"your new sheet name ...........\")\n\n    'Determine the last row in the source sheet, here I assume your data is on continues range and start from row 1\n    Dim lastRow As Long\n    lastRow = srcSheet.Range(\"A1\").End(xlDown).Row\n\n    'Loop through the column A, find which rows has value wanted\n    ReDim idx_arr(1 To lastRow)\n    Dim cnt As Integer\n    cnt = 0\n    For i = 1 To lastRow\n        If srcSheet.Cells(i, 1).Value = compare_value Then\n            cnt = cnt + 1\n            idx_arr(cnt) = i\n        End If\n    Next\n\n    If cnt = 0 Then Exit Sub\n\n    For i = 1 To cnt\n        destSheet.Cells(i, \"A\").Value = srcSheet.Cells(idx_arr(i), \"B\")\n        destSheet.Cells(i, \"B\").Value = srcSheet.Cells(idx_arr(i), \"C\")\n        destSheet.Cells(i, \"C\").Value = srcSheet.Cells(idx_arr(i), \"D\")\n    Next i\n\n    Dim targetRows(1 To 10000)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10746845, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vATxhQwnf_k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hhGp8S3odxVCu61KO-ZpHa_a883g/mo/photo.jpg?sz=128", "display_name": "Chris", "link": "https://stackoverflow.com/users/10746845/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 1, "answer_count": 1, "score": -6, "last_activity_date": 1581745783, "creation_date": 1543968769, "last_edit_date": 1581745783, "question_id": 53623314, "link": "https://stackoverflow.com/questions/53623314/vba-if-a-cell-in-column-a-value-then-copy-column-b-c-d-of-same-row-to-new", "title": "VBA - IF a cell in column A = Value, then copy column B, C, D of same row to new worksheet", "body": "<p>I'm struggling to find any info that I can use on this. I searched heavily before coming here and any help would be greatly appreciated. I've got some basic VBA down, but this is a bit advanced to even know where to begin from scratch.</p>\n\n<p>If a cell in Column A = Value, then copy columns B, C, D of source worksheet to columns A, B, C of a new worksheet.</p>\n\n<p>Here's an example</p>\n\n<p><a href=\"https://i.stack.imgur.com/tGSzw.png\" rel=\"nofollow noreferrer\">Source worksheet</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/kb4pl.png\" rel=\"nofollow noreferrer\">New worksheet</a></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1543971932, "post_id": 53623186, "comment_id": 94107662, "body": "By <code>export certain elements</code>, are you exporting sheets and saves it as another workbook? I assume you do it by code? Please post it?"}], "answers": [{"tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1543971614, "creation_date": 1543971614, "answer_id": 53623669, "question_id": 53623186, "link": "https://stackoverflow.com/questions/53623186/getting-a-button-to-apply-to-an-imported-module-automatically/53623669#53623669", "title": "Getting a Button to Apply to an Imported Module Automatically", "body": "<ol>\n<li><p>When assigning macros using <kbd>[Alt]</kbd> + <kbd>[F8]</kbd> (Pop up the Macro window - Alternatively, Click 'Macros' in 'Developer' tab)</p></li>\n<li><p>There is an option (Macros in: ), please choose \"This Workbook\" instead of \"All Open Workbooks\" and you would be able to assign right macro that you created to the button.</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/TKJu7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TKJu7.png\" alt=\"Macro Window - Microsoft Excel\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 10735868, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pBzXK3hYNIA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-i5xoOvv0gocZSgAyfU1JgUOPtO7g/mo/photo.jpg?sz=128", "display_name": "MACROCHAMP", "link": "https://stackoverflow.com/users/10735868/macrochamp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1581745830, "creation_date": 1543967846, "last_edit_date": 1581745830, "question_id": 53623186, "link": "https://stackoverflow.com/questions/53623186/getting-a-button-to-apply-to-an-imported-module-automatically", "title": "Getting a Button to Apply to an Imported Module Automatically", "body": "<p>I went through the painstaking process (for a rookie such as myself) of building a template,writing a macro to get it to export certain elements to different workbooks in a directory, and distributing modules and user forms to those different workbooks.</p>\n\n<p>My problem is that the buttons in my output templates still refer to macros in my source workbook (rather than the modules I've Imported) and I'm wondering how I can get it to automatically break this link and apply the imported code to the new button.</p>\n\n<p>If anyone could point me in the direction of a general solution I'd be eternally grateful.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1543972264, "post_id": 53623152, "comment_id": 94107730, "body": "So what is your specific question? The code is not working or what? As for the direction, I think you&#39;re on the right track."}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1543972900, "post_id": 53623152, "comment_id": 94107883, "body": "I don\u2019t know what code to write to actually make it work"}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1544017427, "creation_date": 1544017427, "answer_id": 53633754, "question_id": 53623152, "link": "https://stackoverflow.com/questions/53623152/delete-row-using-location-of-shape/53633754#53633754", "title": "Delete row using location of shape", "body": "<pre><code>Sub NoSymbol1_Click()\n\n    Dim r As Range, shp As Shape\n    Set r = ActiveSheet.Shapes(Application.Caller).TopLeftCell    'find the range of the button clicked.\n    For Each shp In ActiveSheet.Shapes\n        If ActiveSheet.Shapes(Application.Caller).TopLeftCell = r.Address Then\n            shp.Delete\n        End If\n    Next shp\n    r.EntireRow.Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546653646, "creation_date": 1543967662, "last_edit_date": 1546653646, "question_id": 53623152, "link": "https://stackoverflow.com/questions/53623152/delete-row-using-location-of-shape", "title": "Delete row using location of shape", "body": "<p>I am trying to delete a row based on the location of a shape. In the screen shot there is a blue shape in B7, I would like to click on that shape, delete the row completely and shift the data below it up 1 row.</p>\n\n<p>Once I have that I can copy the shape and accompanying macro on each row so the user can delete any name they want.</p>\n\n<p>I did some searching and started off with this code.</p>\n\n<pre><code>Sub Delete_Borrower()\n'Macros ro delete individual borrowers fron dbase\nDim mysht As Worksheet\nDim myDropDown As Shape\nDim MLO As Range\nSet mysht = ThisWorkbook.Worksheets(\"Borrower Database\")\nCallingShapeName = ActiveSheet.Shapes(Application.Caller).Name\nSet MLO = Range(mysht.Shapes(CallingShapeName).TopLeftCell.Address)\nMsgBox \"OK\" &amp; MLO\n\n'Code to delete row and shift rows below up one row\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/qA0wu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qA0wu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "powerpoint", "outline"], "comments": [{"owner": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1543967750, "post_id": 53623133, "comment_id": 94106706, "body": "It may not help, but when I displayed data and charts from Excel in Powerpoint slides, I usually copy them into Paint first and then copy and paste the image into the slide. This pastes it as an actual image rather than an embedded Excel object that bloats my presentation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10723523"}, "reply_to_user": {"reputation": 13431, "user_id": 2169762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nns8w.png?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/2169762/martin"}, "edited": false, "score": 0, "creation_date": 1543967872, "post_id": 53623133, "comment_id": 94106743, "body": "@Martin Parkin I have a macro that takes data from over 200 rows of Excel data and updates it into Powerpoint so I won&#39;t be able to copy and paste images, unfortunately. Thank you though!! :)"}], "answers": [{"tags": [], "owner": {"reputation": 301, "user_id": 6354194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhVfQ.png?s=128&g=1", "display_name": "konahn", "link": "https://stackoverflow.com/users/6354194/konahn"}, "is_accepted": false, "score": 0, "last_activity_date": 1543983363, "creation_date": 1543983363, "answer_id": 53625092, "question_id": 53623133, "link": "https://stackoverflow.com/questions/53623133/add-box-around-text-for-excel-to-powerpoint-vba/53625092#53625092", "title": "Add box around text for Excel to Powerpoint VBA", "body": "<p>TextFrame or TextRange doesn't have the border element.\nThe parent 'Shape' can have borders like this.</p>\n\n<pre><code>Dim sld as Slide, shp as Shape\nSet sld = Activepresentation.Slides(1)\nSet shp = sld.Shapes.AddShapes(msoShapeRectangle, 100,100,100,100)\nWith shp\n    .Line.Visible = True\n    .Line.Weight = 2\n    .Line.ForeColor.RGB = RGB(255,0,0)\nEnd with\n</code></pre>\n\n<p>To put a static border, I think you can add a rectangle or TextBox first.\nAnd then add a TextBox again with Excel cell contents.\n(But if you add a Textbox with AddTextBox, the shape's border is static by default even if it has no text in it.)</p>\n\n<p>Any way, I tested the following code:</p>\n\n<pre><code>Set ppSlide2 = ActivePresentation.Slides.Add(ActivePresentation.Slides.Count, ppLayoutBlank).Shapes\n\n'first, add a box(rectangle) or textbox so that the z-order can be lower than the next Textbox\nSet HeaderBOX = ppSlide2.AddShape(msoShapeRectangle, 75, 150, 800, 700)\n'or Set HeaderBOX = ppSlide2.AddTextbox(msoTextOrientationHorizontal, 75, 150, 800, 700)\nWith HeaderBOX\n    .Name = \"HeaderBOX\"\n    .Fill.Visible = False   'make it transparent\n    .Line.Visible = True\n    .Line.ForeColor.RGB = rgbBlack 'RGB(0,0,0)\n    .Line.Weight = 2\nEnd With\n\n'then, add a textbox\nSet HeaderPPT = ppSlide2.AddTextbox(msoTextOrientationHorizontal, 75, 150, 800, 700).TextFrame.TextRange\nWith HeaderPPT\n    .Text = vbNewLine &amp; \"Excel Cell Text Here\"\n    .ParagraphFormat.Alignment = ppAlignCenter\n    .Font.Bold = True\n    .Font.Name = \"Calibri Light\"\n    .Font.Size = 55\nEnd With\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10723523"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 623, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543983363, "creation_date": 1543967535, "question_id": 53623133, "link": "https://stackoverflow.com/questions/53623133/add-box-around-text-for-excel-to-powerpoint-vba", "title": "Add box around text for Excel to Powerpoint VBA", "body": "<p>I am importing data from Excel into Powerpoint slides. How would I be able to add a box/outline around the textframe? Also is there any way in which I can add a static outline that does not move, even if I have no text in the cell I am importing from? </p>\n\n<p>Thank you for any and all help! </p>\n\n<p>Here's snippet of my code: </p>\n\n<pre><code>Set ppSlide2 = ppPres.Slides.Add(i + 1, ppLayoutBlank).Shapes\nSet HeaderPPT = ppSlide2.AddTextbox(msoTextOrientationHorizontal, 75, 150, 800, 700).TextFrame.TextRange\nIf Sheet1.Range(\"P\" &amp; RowExcel).Text = \"Title\" Then          \n            With HeaderPPT\n                .Text = vbNewLine &amp; Cells(RowExcel, col + 9)\n                .ParagraphFormat.Alignment = ppAlignCenter\n                .Font.Bold = True\n                .Font.Name = \"Calibri Light\"\n                .Font.Size = 55\n            End With\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1543967354, "post_id": 53622941, "comment_id": 94106592, "body": "It would be more efficient to put Sheet2.Cells(1, 1)  into a variable so as to avoid repeatedly going back to same cell to retrieve its value."}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1543972447, "post_id": 53622941, "comment_id": 94107775, "body": "You have messed up the ending block statements. For example if [] represents FOR-NEXT and {} represents IF-ENDIF, your code is like [ [ { ] ] } which is wrong. Ideally, in the representational format, it should be [ [ { } ] ].  Hope it was easy to understand."}], "answers": [{"tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": 1, "last_activity_date": 1543966646, "last_edit_date": 1543966646, "creation_date": 1543966289, "answer_id": 53622972, "question_id": 53622941, "link": "https://stackoverflow.com/questions/53622941/how-to-do-an-if-statement-inside-a-loop/53622972#53622972", "title": "How to do an if statement inside a loop?", "body": "<p>Your <code>END IF</code> was in the wrong place and you've swapped your <code>NEXTs</code> as well:</p>\n\n<pre><code>For i = 2 To 318\n    For j = 46 To 1 Step (-2)\n        If Sheet1.Cells(i, j) &gt;= Sheet2.Cells(1, 1) And Sheet1.Cells(i, j - 1) = \"Re\u00e7u\" Then\n            count = count + 1\n        End If\n    Next\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4528, "user_id": 3386310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/MnYbO.jpg?s=128&g=1", "display_name": "Taher Ahmed Ghaleb", "link": "https://stackoverflow.com/users/3386310/taher-ahmed-ghaleb"}, "is_accepted": false, "score": 1, "last_activity_date": 1543966407, "creation_date": 1543966407, "answer_id": 53622989, "question_id": 53622941, "link": "https://stackoverflow.com/questions/53622941/how-to-do-an-if-statement-inside-a-loop/53622989#53622989", "title": "How to do an if statement inside a loop?", "body": "<p>You should first close the <code>If</code> condition with <code>End If</code>. Then, close the inner <code>For</code> loop with <code>Next j</code>. Finally, close the outer <code>For</code> loop with <code>Next i</code>. So, your code should look like this:</p>\n\n<pre><code>Sub CheckDates4()\n    Dim count As Integer\n    Dim i As Integer\n    Dim j As Integer\n\n    count = 0\n    i = 2\n    j = 24\n\n    For i = 2 To 318\n        For j = 46 To 1 Step (-2)\n            If Sheet1.Cells(i, j) &gt;= Sheet2.Cells(1, 1) And Sheet1.Cells(i, j - 1) = \"Re\u00e7u\" Then\n                count = count + 1\n            End If\n        Next j\n    Next i\n\n    Sheet2.Cells(1, 7) = count\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 10730112, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KBDhUYjKpw0/AAAAAAAAAAI/AAAAAAAAAqk/FohA7vxM70c/photo.jpg?sz=128", "display_name": "Joel Bastien", "link": "https://stackoverflow.com/users/10730112/joel-bastien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": -5, "last_activity_date": 1581745839, "creation_date": 1543966107, "last_edit_date": 1581745839, "question_id": 53622941, "link": "https://stackoverflow.com/questions/53622941/how-to-do-an-if-statement-inside-a-loop", "title": "How to do an if statement inside a loop?", "body": "<p>I'm having trouble with the if statement inside a loop. Every time I try and run it, it gives me an error of:</p>\n\n<blockquote>\n  <p>next without for</p>\n</blockquote>\n\n<pre><code>Sub CheckDates4()\n\n    Dim count As Integer\n    Dim i As Integer\n    Dim j As Integer\n\n    count = 0\n    i = 2\n    j = 24\n\n    For i = 2 To 318\n        For j = 46 To 1 Step (-2)\n            If Sheet1.Cells(i, j) &gt;= Sheet2.Cells(1, 1) And Sheet1.Cells(i, j - 1) = \"Re\u00e7u\" Then\n                count = count + 1\n            Next i\n        Next j\n\n    End If\n\n    Sheet2.Cells(1, 7) = count\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas how to fix this?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "bigdata", "countif"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1543965805, "post_id": 53622847, "comment_id": 94106185, "body": "If you have code then it&#39;s best to include it in your question."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543966329, "post_id": 53622847, "comment_id": 94106306, "body": "How many unique values do you have?"}, {"owner": {"reputation": 945, "user_id": 4778565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebcc04d46859697213ac612773d64673?s=128&d=identicon&r=PG&f=1", "display_name": "mock_blatt", "link": "https://stackoverflow.com/users/4778565/mock-blatt"}, "edited": false, "score": 0, "creation_date": 1543966457, "post_id": 53622847, "comment_id": 94106343, "body": "I just remembered I don&#39;t have Excel on this computer, which makes it hard to check a few things. Have you tested this with just a few rows just to make sure the problem is the size, and that it works correctly in the first place? You could try turning calculations to manual before running (along with screenupdating like you do) and then back to automatic at the end"}, {"owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543966475, "post_id": 53622847, "comment_id": 94106349, "body": "@TimWilliams 340k. What Im trying to do is get this count then do the same with two similar lists of Grantees then use that to determine who is buying and selling the most"}, {"owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "reply_to_user": {"reputation": 945, "user_id": 4778565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebcc04d46859697213ac612773d64673?s=128&d=identicon&r=PG&f=1", "display_name": "mock_blatt", "link": "https://stackoverflow.com/users/4778565/mock-blatt"}, "edited": false, "score": 0, "creation_date": 1543966626, "post_id": 53622847, "comment_id": 94106383, "body": "@mock_blatt Yes I have tested it. I changed my range to 700  rows and it worked like it should."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543969683, "post_id": 53622847, "comment_id": 94107176, "body": "Best I can do here is ~30sec (700k values, ~300k uniques) using arrays and a dictionary.  Hopefully we can re-open this and I&#39;ll post my code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10735198"}, "edited": false, "score": 0, "creation_date": 1543971848, "post_id": 53622847, "comment_id": 94107641, "body": "The good news is that if I am predicting Tim&#39;s method correctly, you can discard the RemoveDuplicates or AdvancedFilter  w/unique call to the second sheet because a unique list and associated count will be constructed in one operation."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543972779, "post_id": 53622847, "comment_id": 94107851, "body": "@user10735198 - actually no ;-)  I&#39;m not making any assumptions about the content of the list in ColB...."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10735198"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543973702, "post_id": 53622847, "comment_id": 94108098, "body": "@TimWilliams, I thought the dictionary keys would be the unique list and the items the count. Need a custom transpose function to overcome the application.transpose limits but there are a few of those hanging around."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1543974206, "creation_date": 1543974206, "answer_id": 53623966, "question_id": 53622847, "link": "https://stackoverflow.com/questions/53622847/countif-on-sheet-with-700k-rows-freezes-program/53623966#53623966", "title": "Countif on sheet with 700k rows freezes program", "body": "<p>Something like this:</p>\n\n<pre><code>Sub Countif()\n\n    Dim allVals, uniqueVals, i As Long, dict, v, dOut(), r As Long\n\n     ''creating dummy data\n'    With Sheet2.Range(\"A2:A700000\")\n'        .Formula = \"=\"\"VAL_\"\" &amp; round(RAND()*340000,0)\"\n'        .Value = .Value\n'    End With\n'\n\n    'get the raw data and unique values\n    With Sheet2\n        allVals = .Range(\"A2:A\" &amp; .Cells(.Rows.Count, \"A\").End(xlUp).Row).Value\n        uniqueVals = .Range(\"B2:B\" &amp; .Cells(.Rows.Count, \"B\").End(xlUp).Row).Value\n    End With\n    ReDim dOut(1 To UBound(uniqueVals, 1), 1 To 1) 'for counts...\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    'map unique value to index\n    For i = 1 To UBound(uniqueVals, 1)\n        v = uniqueVals(i, 1)\n        If Len(v) &gt; 0 Then dict(v) = i\n    Next i\n\n\n    'loop over the main list and count each unique value in colB\n    For i = 1 To UBound(allVals, 1)\n        v = allVals(i, 1)\n        If Len(v) &gt; 0 Then\n            If dict.exists(v) Then\n                r = dict(v)\n                dOut(r, 1) = dOut(r, 1) + 1\n            End If\n        End If\n    Next i\n\n    'output the counts\n    Sheet2.Range(\"C2\").Resize(UBound(dOut, 1), 1).Value = dOut\n\nEnd Sub\n</code></pre>\n\n<p>Runs in ~30sec with 700k values in A and 300k uniques in B</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10735198"}, "is_accepted": false, "score": 1, "last_activity_date": 1543975117, "creation_date": 1543975117, "answer_id": 53624067, "question_id": 53622847, "link": "https://stackoverflow.com/questions/53622847/countif-on-sheet-with-700k-rows-freezes-program/53624067#53624067", "title": "Countif on sheet with 700k rows freezes program", "body": "<p>... or maybe this.</p>\n\n<blockquote>\n  <p><sub>Caution: this overwrites the de-duplicated values in column A of the target worksheet.</sub></p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nSub countUnique()\n    Dim arr As Variant, i As Long, dict As Object\n\n    Debug.Print Timer\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    dict.comparemode = vbTextCompare\n\n    With Worksheets(\"sheet2\")\n        arr = .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp)).Value2\n    End With\n\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        dict.Item(arr(i, 1)) = dict.Item(arr(i, 1)) + 1\n    Next i\n\n    With Worksheets(\"sheet3\")\n        .Cells(2, \"A\").Resize(dict.Count, 1) = bigTranspose(dict.keys)\n        .Cells(2, \"B\").Resize(dict.Count, 1) = bigTranspose(dict.items)\n    End With\n\n    Debug.Print Timer\n\nEnd Sub\n\nFunction bigTranspose(arr1 As Variant)\n    Dim t As Long\n    ReDim arr2(LBound(arr1) To UBound(arr1), 1 To 1)\n\n    For t = LBound(arr1) To UBound(arr1)\n        arr2(t, 1) = arr1(t)\n    Next t\n    bigTranspose = arr2\nEnd Function\n</code></pre>\n\n<p>42.64 seconds for 700K originals and 327K uniques on a Surface Pro tablet. This might be improved by turning off calculation and enableevents. Screenupdating really shouldn't be an issue.</p>\n"}], "owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1581745819, "creation_date": 1543965420, "last_edit_date": 1581745819, "question_id": 53622847, "link": "https://stackoverflow.com/questions/53622847/countif-on-sheet-with-700k-rows-freezes-program", "title": "Countif on sheet with 700k rows freezes program", "body": "<p>I currently have two lists. A list of \"Grantors\" in column A and the same list with duplicates removed in column B. I am trying to get a count of how many times a given Grantor is in Column A using countif however my list in Column A is over 700k rows. I am using 64bit excel but every time I run code to do this excel freezes and crashes.</p>\n\n<p>Is there a way to do this in excel or do I need to take another approach like using a pivot table or creating tables in access?</p>\n\n<p>I have written a few sub routines but this is the latest, got from another post on this forum.</p>\n\n<pre><code>Sub Countif()\n\n  Dim lastrow As Long\n  Dim rRange As Range\n  Dim B As Long '&lt; dummy variable to represent column B\n\n  B = 2\n\n  With Application\n    .ScreenUpdating = False 'speed up processing by turning off screen updating\n    .DisplayAlerts = False\n  End With\n\n  'set up a range to have formulas applied\n  With Sheets(2)\n    lastrow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rRange = .Range(.Cells(2, B), .Cells(lastrow, B))\n  End With\n\n  'apply the formula to the range\n  rRange.Formula = \"=COUNTIF($A$2:$A$777363,C2)\"\n  'write back just the value to the range\n  rRange.Value = rRange.Value\n\n  With Application\n    .ScreenUpdating = True\n    .DisplayAlerts = True\n  End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1543966532, "post_id": 53622878, "comment_id": 94106362, "body": "Thanks Hussain.. I have used the code as above but am getting a run-time error 13 - Type Mismatch. It is related to diffPercent = ((Range(&quot;J&quot; &amp; i).Value - Range(&quot;G&quot; &amp; i).Value) / Range(&quot;G&quot; &amp; i).Value) * 100."}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1543966764, "post_id": 53622878, "comment_id": 94106421, "body": "Is there any non-number data in <code>J12:J42, G12:G42</code>?. As the error message says the data type is not matching for numerical calculation."}, {"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1543967136, "post_id": 53622878, "comment_id": 94106544, "body": "Hi...nope, i am dealing with values only."}, {"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1543967814, "post_id": 53622878, "comment_id": 94106728, "body": "Oppps...just found the error. .i have an equation in G! Would you be able to comment on how to get around this?"}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1543970107, "post_id": 53622878, "comment_id": 94107260, "body": "What equation? Can you post it here?"}, {"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1543974422, "post_id": 53622878, "comment_id": 94108273, "body": "Thank you for your support. I have a index match function looking up a value on another sheet and returning that value to G12. =IFERROR(INDEX(User_Library!$C$9:$C$65,MATCH(Glazing_Systems&zwnj;&#8203;!E12,User_Library!$B&zwnj;&#8203;$9:$B$65,0)),&quot;&quot;)"}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1544001212, "post_id": 53622878, "comment_id": 94117074, "body": "Change the function to <code>=IFERROR(INDEX(User_Library!$C$9:$C$65,MATCH(Glazing_Systems&zwnj;&#8203;!E12,User_Library!$B&zwnj;&#8203;$9:$B$65,0)),0)</code>"}, {"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1544005735, "post_id": 53622878, "comment_id": 94119761, "body": "Thank you Hussain. Unfortunately, this code is proving to be tricky. The code you have kindly provided is giving me a % difference, that i really don;t need to show the user. I simply want to trigger the message based on a diffPercentage as per the original question.  Thanks again."}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1544006026, "post_id": 53622878, "comment_id": 94119915, "body": "I guess you are totally new to vba, just change the <code>MsgBox &quot;Oppps. Your system is not working! The difference is :&quot; &amp; diffPercent</code> to <code>MsgBox &quot;Oppps. Your system is not working!&quot;</code>"}, {"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1544007087, "post_id": 53622878, "comment_id": 94120586, "body": "New enough but not that new. The following code still remains the issue from what i can see my end. diffPercent = ((Range(&quot;J&quot; &amp; i).Value - Range(&quot;G&quot; &amp; i).Value) / Range(&quot;G&quot; &amp; i).Value) * 100. The Msg is triggered, provides the popup, but this code is highlighted, now as a runtime 6 error. You have been very kind with your time Hussain, i appreciate your patience."}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1544007502, "post_id": 53622878, "comment_id": 94120828, "body": "Share your total code. I will look into it. Along with the sample data."}, {"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1544226191, "post_id": 53622878, "comment_id": 94214190, "body": "Here you go...<a href=\"http://www.filedropper.com/mdazadhussain0812\" rel=\"nofollow noreferrer\">filedropper.com/mdazadhussain0812</a>    Thanks for having a look at this for me. I have been trying to get over the challenge myself but am not a skilled VBA author. Sticking point remains a runtime error 6."}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1544302385, "post_id": 53622878, "comment_id": 94230146, "body": "Updated the answer."}], "tags": [], "owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "is_accepted": false, "score": 1, "last_activity_date": 1544234060, "last_edit_date": 1544234060, "creation_date": 1543965649, "answer_id": 53622878, "question_id": 53622758, "link": "https://stackoverflow.com/questions/53622758/worksheet-change-event-with-minimum-difference/53622878#53622878", "title": "Worksheet Change Event with minimum % Difference", "body": "<p>Here is the updated code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim diffPercent\n    'Check that the data is changed between row 12 and 42 and it is even row. eg 12,14,16...42.\n    If (Target.Row &gt; 10 And Target.Row &lt; 44) And ((Target.Row Mod 2) = 0) Then  'And _\n            '(Target.Column = 7 Or Target.Column = 10) Then\n\n        'Get the values in J ang G columns of that particular row.\n        number1 = Range(\"G\" &amp; Target.Row).Value\n        number2 = Range(\"J\" &amp; Target.Row).Value\n\n        'Check for presence of both the inputs to calculate difference in percentage.\n        If Not chkInputs(number1, number2) Then\n            Exit Sub\n        End If\n        'Calculate the percentage difference.\n        diff = number2 - number1\n        diffPercent = (diff / number2) * 100\n\n        'Give alert if difference more than 10 percent\n        If diffPercent &gt; 10 Then\n            MsgBox \"Oppps. Your system is not working! The difference is :\" &amp; diff &amp; \"|\" &amp; diffPercent\n        End If\n    End If\n\nEnd Sub\n\nFunction chkInputs(number1, number2)\nchkInputs = False\nIf IsNumeric(number1) And IsNumeric(number2) Then\n    chkInputs = True\nEnd If\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547440981, "creation_date": 1543964873, "last_edit_date": 1547440981, "question_id": 53622758, "link": "https://stackoverflow.com/questions/53622758/worksheet-change-event-with-minimum-difference", "title": "Worksheet Change Event with minimum % Difference", "body": "<p>I have a worksheet change event.</p>\n\n<p>Original Code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n   If Range(\"J12\") &lt; Range(\"G12\") Then\n      MsgBox \"Oppps. Your system is not working!\"\n   End If\nEnd Sub\n</code></pre>\n\n<p>I am trying to expand upon the code to:</p>\n\n<p>a. Increase the range from single cells (J12 and G12) to an extended cell range (J12:42, G12:42).</p>\n\n<p>b. Instead of having the change event triggered by less than (J12 &lt; G12), have it triggered by a % difference between J12 &lt; G12.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1543959762, "post_id": 53621824, "comment_id": 94104182, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/418622/find-the-directory-part-minus-the-filename-of-a-full-path-in-access-97\">Find the directory part (minus the filename) of a full path in access 97</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9916065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f515d483f2f22a8f4052e8bc13919f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Garett", "link": "https://stackoverflow.com/users/9916065/garett"}, "edited": false, "score": 0, "creation_date": 1543961896, "post_id": 53621991, "comment_id": 94105003, "body": "Hi, I updated my question since I realized that the file is located in a subfolder. I tried your code but it returned the whole filepath which I think is because the file is located within a folder within a folder within a folder if that makes sense. Do you know how to get around that"}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 19, "user_id": 9916065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f515d483f2f22a8f4052e8bc13919f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Garett", "link": "https://stackoverflow.com/users/9916065/garett"}, "edited": false, "score": 0, "creation_date": 1543963236, "post_id": 53621991, "comment_id": 94105475, "body": "Updated my answer as you required. Kindly mark as answer if it helps."}, {"owner": {"reputation": 19, "user_id": 9916065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f515d483f2f22a8f4052e8bc13919f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Garett", "link": "https://stackoverflow.com/users/9916065/garett"}, "edited": false, "score": 0, "creation_date": 1543963994, "post_id": 53621991, "comment_id": 94105707, "body": "Hmm, it still returns the whole filepath"}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 19, "user_id": 9916065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f515d483f2f22a8f4052e8bc13919f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Garett", "link": "https://stackoverflow.com/users/9916065/garett"}, "edited": false, "score": 0, "creation_date": 1543964455, "post_id": 53621991, "comment_id": 94105836, "body": "What do you mean by <code>folder name of the file location</code>  and <code>main folder where the file is located</code>. Kindly post path  names and what do you want to return."}, {"owner": {"reputation": 19, "user_id": 9916065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f515d483f2f22a8f4052e8bc13919f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Garett", "link": "https://stackoverflow.com/users/9916065/garett"}, "edited": false, "score": 0, "creation_date": 1543965154, "post_id": 53621991, "comment_id": 94106010, "body": "This is the filepath C:\\Store Location\\Employees\\Contact Information\\Phone Numbers\\11373, I just want to extract the 11373 part and store it as a variable"}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "reply_to_user": {"reputation": 19, "user_id": 9916065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f515d483f2f22a8f4052e8bc13919f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Garett", "link": "https://stackoverflow.com/users/9916065/garett"}, "edited": false, "score": 0, "creation_date": 1543966103, "post_id": 53621991, "comment_id": 94106257, "body": "Update the answer again. Check now it should give you 11373 in the msgbox."}], "tags": [], "owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "is_accepted": true, "score": 0, "last_activity_date": 1543966019, "last_edit_date": 1543966019, "creation_date": 1543960332, "answer_id": 53621991, "question_id": 53621824, "link": "https://stackoverflow.com/questions/53621824/setting-variable-to-subfolder-name-based-on-user-selection/53621991#53621991", "title": "Setting variable to subfolder name based on user selection", "body": "<p>Okay, So you want to set a default folder for getOpenFileName.\nPrecede getOpenFileName with <code>ChDir \"D:\\Test\"</code>. If the drive is other than C: then precede ChDir with ChDrive \"DriveLetter:\"</p>\n\n<pre><code>Sub test()\nChDrive \"D:\"\nApplication.DefaultFilePath = \"D:\\Test\"\n\nfileAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.csv),*.csv\", Title:=\"Select a file\")\nIf fileAndPath = False Then\nExit Sub\nEnd If\nfolderPath = Left(fileAndPath, InStrRev(fileAndPath, \"\\\") - 1)\nMsgBox (Mid(folderPath, InStrRev(folderPath, \"\\\") + 1))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 9916065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f515d483f2f22a8f4052e8bc13919f1b?s=128&d=identicon&r=PG&f=1", "display_name": "Garett", "link": "https://stackoverflow.com/users/9916065/garett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 53621991, "answer_count": 1, "score": 0, "last_activity_date": 1547979489, "creation_date": 1543959544, "last_edit_date": 1547979489, "question_id": 53621824, "link": "https://stackoverflow.com/questions/53621824/setting-variable-to-subfolder-name-based-on-user-selection", "title": "Setting variable to subfolder name based on user selection", "body": "<p>My code prompts the user to select a file. I want to set a variable to the folder name of the file location but the file is located in a subfolder.</p>\n\n<p>I have this code to open the file.</p>\n\n<pre><code>fileAndPath = Application.GetOpenFilename(FileFilter:=\"Excel Files (*.csv), _ \n*.csv\", Title:=\"Select a file\")\nIf fileAndPath = False Then Exit Sub\n</code></pre>\n\n<p>This is the filepath C:\\Store Location\\Employees\\Contact Information\\Phone Numbers\\11373</p>\n\n<p>I want to extract the 11373 part and store it as a variable</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543961597, "post_id": 53621635, "comment_id": 94104879, "body": "Always helps to explain exactly what the problem is - what happens when you run your code?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543962030, "post_id": 53621635, "comment_id": 94105059, "body": "Sorry - its been a  long day.  The Content Control Checkbox on the word doc remains unchecked no matter if the cell  that is referenced has a value of &quot;TRUE&quot; or &quot;FALSE&quot;.  I did also look to see if the word document was opening in read only and it isnt."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543964034, "post_id": 53621635, "comment_id": 94105722, "body": "Does your module have &quot;Option Explicit&quot; at the top?  If not I&#39;d recommend adding it and recompiling your code. Does your code know what <code>wdContentControlCheckBox</code> represents?  If you don&#39;t have a reference to the Word object library then you&#39;ll need to define that constant."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543964538, "post_id": 53621635, "comment_id": 94105855, "body": "Yes, it has the &quot;Option Explicit&quot; at the top(I learned early on that having that is best practice).  I do not have <code>wdContentControlCheckBox</code> as a constant.  I have never declared a constant, but i do understand the logic behind it.  I will research how to declare <code>CONST wdContentControlCheckBox</code>.  I do have the Word Object Library referenced in Tools &gt; Reference as well."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1543965362, "post_id": 53621635, "comment_id": 94106057, "body": "If you have option explicit set and a reference to the Word library then you&#39;re all set.  Have you debugged to see if <code>If cc.Type = wdContentControlCheckBox Then</code> actually passes?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1544015705, "post_id": 53621635, "comment_id": 94125761, "body": "It was actually the <code>If wsFI.Range(&quot;Plat_DrawingYes&quot;) = &quot;True&quot; Then</code> that was causing the issue.  Once i removed the quotation marks around the word True it worked as expected.  Thanks again for your help Tim."}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": true, "score": 0, "last_activity_date": 1544026705, "creation_date": 1544026705, "answer_id": 53636489, "question_id": 53621635, "link": "https://stackoverflow.com/questions/53621635/vba-in-excel-to-control-content-control-checkbox-in-a-word-document/53636489#53636489", "title": "VBA in Excel to control Content Control Checkbox in a Word Document", "body": "<p>The issue that was causing this not to work was because of how I set the cell value based on a Check Box UserForm Control.  I thought the value in the Cell was a Text String, but it apparently wasn't (not sure why), so once I removed the \"\" from around the workd \"TRUE\" in <code>If wsFI.Range(\"Plat_DrawingYes\")=\"TRUE\"</code> the code ran as expected.  Below is the solution.  Thanks @Tim Williams for the assistance.</p>\n\n<pre><code>Private Sub TitleOrder_Click()\n    Dim WordApp As Object\n    Dim WordDoc As Object\n    Dim cc As ContentControl  'Maybe this should this be Dim cc as object instead??\"\n\n    ContLoanFile.Hide\n\n    Application.ScreenUpdating = False\n\n    SaveAsName = ThisWorkbook.path &amp; \"\\Title Order Form - \" &amp; Split(wsSI.Range(\"PBName\"))(2) &amp; \".docx\"\n\n    Set WordApp = CreateObject(\"Word.Application\")\n    WordApp.Visible = True\n    Set WordDoc = WordApp.Documents.Add(Template:=\"Z:\\Title Work Template.docx\", NewTemplate:=False, DocumentType:=0)\n    Set cc = WordDoc.SelectContentControlsByTag(\"mpfPlat\").Item(1)\n\n    If wsFI.Range(\"Plat_DrawingYes\") = TRUE Then\n        If cc.Type = wdContentControlCheckBox Then\n            cc.Checked = True\n        End If\n    End If\n\n\n    WordApp.ActiveDocument.SaveAs FileName:=SaveAsName\n    WordApp.Quit\n    Set WordApp = Nothing\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 53636489, "answer_count": 1, "score": 1, "last_activity_date": 1544026829, "creation_date": 1543958741, "last_edit_date": 1544026829, "question_id": 53621635, "link": "https://stackoverflow.com/questions/53621635/vba-in-excel-to-control-content-control-checkbox-in-a-word-document", "title": "VBA in Excel to control Content Control Checkbox in a Word Document", "body": "<p><br>\nI have researched numerous posts on this topic and below is the code I have come up with in a Standard Module in Excel to try and accomplish marking a Content Control Check Box in a Word Document as True, but I seem to be missing a key piece of code and am unable to figure out what that piece of code is that is causing this code to not execute and leave the Control Check Boxes unchecked. Any help is greatly appreciated.</p>\n\n<pre><code>Private Sub TitleOrder_Click()\n    Dim WordApp As Object\n    Dim WordDoc As Object\n    Dim cc As ContentControl  'Maybe this should this be Dim cc as object instead??\"\n\n    ContLoanFile.Hide\n\n    Application.ScreenUpdating = False\n\n    SaveAsName = ThisWorkbook.path &amp; \"\\Title Order Form - \" &amp; Split(wsSI.Range(\"PBName\"))(2) &amp; \".docx\"\n\n    Set WordApp = CreateObject(\"Word.Application\")\n    WordApp.Visible = True\n    Set WordDoc = WordApp.Documents.Add(Template:=\"Z:\\Title Work Template.docx\", NewTemplate:=False, DocumentType:=0)\n    Set cc = WordDoc.SelectContentControlsByTag(\"mpfPlat\").Item(1)\n\n    If wsFI.Range(\"Plat_DrawingYes\") = \"TRUE\" Then\n        If cc.Type = wdContentControlCheckBox Then\n            cc.Checked = True\n        End If\n    End If\n\n\n    WordApp.ActiveDocument.SaveAs FileName:=SaveAsName\n    WordApp.Quit\n    Set WordApp = Nothing\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1543957754, "post_id": 53621434, "comment_id": 94103293, "body": "Dim gCount As Date &#39;Updateby20140925 Sub Timer() gCount = Now + TimeValue(&quot;00:00:01&quot;) Application.OnTime gCount, &quot;ResetTime&quot; End Sub Sub ResetTime() Dim xRng As Range Set xRng = Application.ActiveSheet.Range(&quot;D2&quot;) Set xRng = Application.ActiveSheet.Range(&quot;D3&quot;) xRng.Value = xRng.Value - TimeSerial(0, 0, 1)     If xRng.Value &lt;= 0      MsgBox &quot;Countdown complete.&quot; Exit Sub End If Call Timer End Sub"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1543989199, "post_id": 53622716, "comment_id": 94111857, "body": "Thanks Joku for your support. Actually I getting an error while compiling the code with the error as : Object varialble or with block variable not set at If xRng.Value &gt; 0 Then"}, {"owner": {"reputation": 35, "user_id": 7332468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d592b2a52aceba67204bcf841b505065?s=128&d=identicon&r=PG&f=1", "display_name": "Joku", "link": "https://stackoverflow.com/users/7332468/joku"}, "reply_to_user": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1544045148, "post_id": 53622716, "comment_id": 94141499, "body": "You need to run the procedure &quot;StartTimer&quot;, not one of the other ones.  You&#39;re getting the error because a range hasn&#39;t been assigned to xRng yet; that&#39;s done in the &quot;StartTimer&quot; procedure."}, {"owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1544335230, "post_id": 53622716, "comment_id": 94235868, "body": "Thanks Joku...It is working fine for me now..But now I am stuck with one more requirement.Request you to please help me for this -- I have column B with the team name as Development and there are many rows with Development tasks and for each and every row we have a timer.So as per the current code I am getting a popup of countdown completed for the timer column whereas I need the popup once all the timers of Development(B column) is completed and mark it in green color.  Is their a possibility we can do this?"}, {"owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1544335704, "post_id": 53622716, "comment_id": 94235924, "body": "Column A with Tasks, Column B with the Team name(Development), column C with the Flag such as Y/N , Column D as Time Required...I need to give a popup once all the tasks of development(B Column) is over and should turn into green."}, {"owner": {"reputation": 35, "user_id": 7332468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d592b2a52aceba67204bcf841b505065?s=128&d=identicon&r=PG&f=1", "display_name": "Joku", "link": "https://stackoverflow.com/users/7332468/joku"}, "reply_to_user": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1544474445, "post_id": 53622716, "comment_id": 94281138, "body": "So column B has a number of different team names, but you&#39;re concerned with rows where the team name is &quot;Development&quot;. Do you want to run the timer for every task, or only Development tasks? If for every task, do you want the timers to continue if there are more after the last Development task? Which cells do you want to turn green? Do you only want them to turn green after all timers are done, or would it be better if they turned green after each timer?"}, {"owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1544540316, "post_id": 53622716, "comment_id": 94306936, "body": "Hi Joku, I want to run the timer for every task that is assigned for all the teams and  the timer should continue further but once all the tasks for a particular team is over a popup should come saying that Development task is over please proceed further and then then the timer for the next team is over a new popup should come saying that the testing task is over please proceed further like that...and once the timer for individual task is over that particular row should turn Green."}, {"owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1544540377, "post_id": 53622716, "comment_id": 94306976, "body": "Also would like to thank you for your response and for the time you spent to understand the requirement. Thanks a lot.."}, {"owner": {"reputation": 35, "user_id": 7332468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d592b2a52aceba67204bcf841b505065?s=128&d=identicon&r=PG&f=1", "display_name": "Joku", "link": "https://stackoverflow.com/users/7332468/joku"}, "reply_to_user": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1544569244, "post_id": 53622716, "comment_id": 94321013, "body": "I edited my answer. Be sure to scroll down in the code box to get everything."}, {"owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "edited": false, "score": 0, "creation_date": 1545079971, "post_id": 53622716, "comment_id": 94494355, "body": "Thanks a lot joku... Code ia working fine as per the requirement.. Thanks again."}], "tags": [], "owner": {"reputation": 35, "user_id": 7332468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d592b2a52aceba67204bcf841b505065?s=128&d=identicon&r=PG&f=1", "display_name": "Joku", "link": "https://stackoverflow.com/users/7332468/joku"}, "is_accepted": false, "score": 0, "last_activity_date": 1544569117, "last_edit_date": 1544569117, "creation_date": 1543964443, "answer_id": 53622716, "question_id": 53621434, "link": "https://stackoverflow.com/questions/53621434/i-want-to-run-the-timer-in-excel-using-macros-serially-i-e-once-the-d2-cell-tim/53622716#53622716", "title": "I want to run the timer in Excel using macros serially i.e. once the D2 cell time is over then D3 cell time should start", "body": "<p>I made the assumption that you want the user to see the time counting down. </p>\n\n<p>I set xRng to D2 in a separate procedure (\"StartTimer\"). When D2 is done counting down, xRng will be set to the next cell down. Once xRng is set to an empty cell, the procedure exits.</p>\n\n<p>I included message boxes after each cell is done counting down, as well as when all cells have finished to make it clear where you can add procedure calls when timers end.</p>\n\n<pre><code>Dim xRng As Range\n\nSub StartTimer()\n    Set xRng = Application.ActiveSheet.Range(\"D2\")\n    Call Timer\nEnd Sub\n\nSub Timer()\n    Dim gCount As Date\n    gCount = Now + TimeValue(\"00:00:01\")\n    Application.OnTime gCount, \"ResetTime\"\nEnd Sub\n\nSub ResetTime()\n    If xRng.value &gt; 0 Then\n        xRng.value = xRng.value - TimeSerial(0, 0, 1)\n    End If\n    If xRng.value &lt;= 0 Then\n        MsgBox \"Countdown for \" &amp; xRng.Address &amp; \" complete.\"\n        Set xRng = xRng.Offset(1) 'Move to next cell in column\n        If xRng.value = vbNullString Then\n            MsgBox \"Countdown complete.\"\n            Exit Sub\n        End If\n    End If\n    Call Timer\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Edit: This updated code should satisfy your other requirements.</p>\n\n<pre><code>Dim xRng As Range\nDim oDict As Object\n\nSub StartTimer()\n    Set xRng = Application.ActiveSheet.Range(\"D2\")\n    Set oDict = CreateObject(\"Scripting.Dictionary\")\n\n    Call PopDict\n    Call Timer\nEnd Sub\n\nSub Timer()\n    Dim gCount As Date\n    gCount = Now + TimeValue(\"00:00:01\")\n    Application.OnTime gCount, \"ResetTime\"\nEnd Sub\n\nSub ResetTime()\n    If xRng.value &gt; 0 Then\n        xRng.value = xRng.value - TimeSerial(0, 0, 1)\n    End If\n    If xRng.value &lt;= 0 Then\n        xRng.EntireRow.Interior.ColorIndex = 43\n        If xRng.Row = oDict(xRng.Offset(, -2).value) Then\n            MsgBox xRng.Offset(, -2).value &amp; \" task is over. Please proceed further.\"\n        End If\n        Set xRng = xRng.Offset(1) 'Move to next cell in column\n        If xRng.value = vbNullString Then\n            MsgBox \"All tasks over.\"\n            Exit Sub\n        End If\n    End If\n    Call Timer\nEnd Sub\n\nSub PopDict()\n    Dim lRow As Long\n\n    lRow = 2\n\n    Do Until ActiveSheet.Cells(lRow, 2).value = vbNullString\n        oDict(ActiveSheet.Cells(lRow, 2).value) = lRow\n        lRow = lRow + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Before the timer starts, this program loops through every cell in column B. When it encounters a new team name, it adds that name to a dictionary as a key. It also adds the row number for the current cell to the dictionary as an item associated with the team name (key). When it's done, the dictionary will contain a list of all team names, and with each name is the number of the last row the name appears on.</p>\n\n<p>So when a timer finishes, we can check the dictionary using team name for the current row. If the current row matches the row in the dictionary, that means it's the last row for the current team, so we can notify the user.</p>\n"}], "owner": {"reputation": 13, "user_id": 8174851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd09252dd45feb5dbe5c0e3517827ac?s=128&d=identicon&r=PG&f=1", "display_name": "Manu ", "link": "https://stackoverflow.com/users/8174851/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544569117, "creation_date": 1543957712, "last_edit_date": 1543959502, "question_id": 53621434, "link": "https://stackoverflow.com/questions/53621434/i-want-to-run-the-timer-in-excel-using-macros-serially-i-e-once-the-d2-cell-tim", "title": "I want to run the timer in Excel using macros serially i.e. once the D2 cell time is over then D3 cell time should start", "body": "<p>I want to run the timer in Excel using macros serially i.e. once the D2 cell time is over then D3 cell time should start and then D4 like this until we have the times in D column.\nAs per the below code all the times are running parallel where as I want to run it sequentially.</p>\n\n<p>Currently I am using below code:</p>\n\n<pre><code>Dim gCount As Date\n\nSub Timer()\n    gCount = Now + TimeValue(\"00:00:01\")\n    Application.OnTime gCount, \"ResetTime\"\nEnd Sub\n\nSub ResetTime()\n    Dim xRng As Range\n    Set xRng = Application.ActiveSheet.Range(\"D2\")\n    Set xRng = Application.ActiveSheet.Range(\"D3\")\n    xRng.Value = xRng.Value - TimeSerial(0, 0, 1)\n    If xRng.Value &lt;= 0 Then\n        MsgBox \"Countdown complete.\"\n        Exit Sub\n    End If\n    Call Timer\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1543956688, "post_id": 53621163, "comment_id": 94102826, "body": "I will ask the obvious question: <i>does</i> <code>Count</code> equal <code>input1</code>? If not, then no surprise there."}, {"owner": {"reputation": 11, "user_id": 10746212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83ba081e37341f5a89204a5e063080b?s=128&d=identicon&r=PG&f=1", "display_name": "user34567", "link": "https://stackoverflow.com/users/10746212/user34567"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1543977802, "post_id": 53621163, "comment_id": 94109044, "body": "After the first tym completion the count equals input1 but its getting out of the loop. I am not able to understand whr actually i am doing the mistake"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1544015244, "post_id": 53621163, "comment_id": 94125465, "body": "I think you really need to check the values of all your variables as you loop through the code. Use a few <code>debug.print</code> statements or step through it and check the value of <i>all</i> variables (for example, if <code>f C(b) = D(b)</code> is never true, then <code>count</code> will never go up in value. <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">This</a> and <a href=\"https://softwareengineering.stackexchange.com/questions/10735/how-to-most-effectively-debug-code\">this</a> may also prove useful reading"}, {"owner": {"reputation": 11, "user_id": 10746212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83ba081e37341f5a89204a5e063080b?s=128&d=identicon&r=PG&f=1", "display_name": "user34567", "link": "https://stackoverflow.com/users/10746212/user34567"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1544077077, "post_id": 53621163, "comment_id": 94149784, "body": "Thanx for answering but i have done that. I got the culprit in  the code my input1 was variant and count was Integer so it was not comparing when i changed it worked. Since i am a newbie to this VBA thing if you could let me know the exact reason. As per my understanding it may be because of the mismatch. Let me know if i require any corrections. Thanks in advance"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10746212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83ba081e37341f5a89204a5e063080b?s=128&d=identicon&r=PG&f=1", "display_name": "user34567", "link": "https://stackoverflow.com/users/10746212/user34567"}, "edited": false, "score": 0, "creation_date": 1543977656, "post_id": 53621557, "comment_id": 94109020, "body": "Thanx for answering the question\ud83d\ude0aEven after doing so its not checking the if statement even when count = input1"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1543958308, "creation_date": 1543958308, "answer_id": 53621557, "question_id": 53621163, "link": "https://stackoverflow.com/questions/53621163/vba-comparison-of-two-excel-files/53621557#53621557", "title": "VBA comparison of two excel files", "body": "<p>You never reset <code>Count</code> to zero inside the loop, so the value just keeps incrementing</p>\n\n<pre><code>'...\nCount = 0\nFor b = 1 To y\n'...\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10746212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83ba081e37341f5a89204a5e063080b?s=128&d=identicon&r=PG&f=1", "display_name": "user34567", "link": "https://stackoverflow.com/users/10746212/user34567"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1581745853, "creation_date": 1543956422, "last_edit_date": 1581745853, "question_id": 53621163, "link": "https://stackoverflow.com/questions/53621163/vba-comparison-of-two-excel-files", "title": "VBA comparison of two excel files", "body": "<p>I am trying to compare two excel sheets using vba macro based on specific columns (will vary file to file). If the content of the columns is same then I am trying to copy the remaining column content of the destination file to source file. I have written a code for the same but I am not able to understand why its not going inside the last IF statement after calculating the value of count.</p>\n\n<pre><code>Sub Compare_sheet()\n\nDim vnt As Variant\nDim myValue As Variant\nDim myString As String\nDim F1_Workbook As Workbook\nDim F2_Workbook As Workbook\nDim k As Variant\nDim identifier() As Integer\nDim identifier2() As Integer\nDim Other() As Integer\nDim Other2() As Integer\nDim copy_cell As Variant\nDim C() As Variant\nDim D() As Variant\n\nCount = 0\n\nMsgBox \" Please select the source file \"\nvnt_Source = Application.GetOpenFilename(\"Excel Files (*.xlsx; *.xls; \n*.xlsm),*.xlsx;*.xls;*.xlsm\", 1, \"Please select the file to open\")\n\nMsgBox \" Please select the destination file\"\nvnt_destination = Application.GetOpenFilename(\"Excel Files (*.xlsx; *.xls; \n*.xlsm),*.xlsx;*.xls;*.xlsm\", 1, \"Please select the file to open\")\n\nSet F1_Workbook = Workbooks.Open(vnt_Source)\nSet F2_Workbook = Workbooks.Open(vnt_destination)\n\nlastRow1 = F1_Workbook.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\nlastrow2 = F2_Workbook.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\ninput1 = InputBox(\"Input the number of identifiers you want\")\nReDim identifier(1 To input1) As Integer\nReDim identifier2(1 To input1) As Integer\nReDim C(1 To input1) As Variant\nReDim D(1 To input1) As Variant\n\nFor k = 1 To input1\n    identifier(k) = InputBox(\"Enter the identifier column number in source file\")\n    identifier2(k) = InputBox(\"Enter the same identifier column number in destination file\")\nNext k\ny = input1\n\nFor i = 1 To lastRow1\n    For j = 1 To lastrow2\n        For x = 1 To input1\n            C(x) = F1_Workbook.Sheets(1).Cells(i, identifier(x)).Value\n            D(x) = F2_Workbook.Sheets(1).Cells(j, identifier2(x)).Value\n            MsgBox \"c d\" &amp; C(x) &amp; D(x)\n        Next x\n\n        For b = 1 To y\n            If C(b) = D(b) Then\n                Count = Count + 1\n            End If\n        Next b\n\n        MsgBox \"count\" &amp; Count\n\n        If Count = input1 Then\n            copycell = InputBox(\"enter the number of cells you want to copy\")\n            ReDim Other(1 To copy_cell) As Integer\n            ReDim Other2(1 To copy_cell) As Integer\n\n            For copynum = 1 To copy_cell\n                Other(copynum) = InputBox(\"enter the column number of the cell to be copied in the source file\")\n                Other2(copynum) = InputBox(\"enter the column number of the same cell to be copied in the destination file\")\n            Next copynum\n\n            For a = 1 To copy_cell\n                myValue = F1_Workbook.Sheets(1).Cells(i, Other(a)).Value\n                F2_Workbook.Sheets(1).Cells(j, Other2(a)).Value = myValue\n            Next a\n\n        End If\n\n    Next j\n\nNext i\n\nMsgBox \"DONE!!!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "edited": false, "score": 0, "creation_date": 1543956569, "post_id": 53620999, "comment_id": 94102760, "body": "Dim bisnumberic As Boolean is also problematic. Better use Option Explicit."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10745280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wYWydxt9YuQ/AAAAAAAAAAI/AAAAAAAABUQ/MYfV0BAlyS0/photo.jpg?sz=128", "display_name": "Jessy Cawley", "link": "https://stackoverflow.com/users/10745280/jessy-cawley"}, "edited": false, "score": 0, "creation_date": 1543957068, "post_id": 53621139, "comment_id": 94102980, "body": "I appreciate all the help! It is still not working.. I have changed the code to now read bisnumeric throughout. The problem is that it doesn&#39;t seem to be changing the sheet name by the Case definition. That is, when I put a non-numeric number into tab &quot;AltB&quot; I still get the code for if bIsNumeric = True, ie. the pivot table refreshes.  My latest code in next comment."}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "edited": false, "score": 0, "creation_date": 1543958537, "post_id": 53621139, "comment_id": 94103647, "body": "Use of case statement is not required at all. The <code>For Each sh</code> part takes care of looping through the sheets."}], "tags": [], "owner": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "is_accepted": false, "score": 0, "last_activity_date": 1543956336, "creation_date": 1543956336, "answer_id": 53621139, "question_id": 53620999, "link": "https://stackoverflow.com/questions/53620999/how-to-create-error-message-if-column-contains-non-numeric-field-vba/53621139#53621139", "title": "How to create error message if column contains non-numeric field - VBA", "body": "<p>The problem here is in your if statement:</p>\n\n<pre><code>            If Not IsNumeric(Cells(i, 1).Value) Then\n                bisnumber = False\n            End If\n</code></pre>\n\n<p>You are changing the <code>bisnumber</code> variable.</p>\n\n<p>Later on, you actually check the <code>bIsNumeric</code> variable to see if something is or is not a number. You would need to change:</p>\n\n<pre><code>            If Not IsNumeric(Cells(i, 1).Value) Then\n                bisnumber = False\n            End If\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>            If Not IsNumeric(Cells(i, 1).Value) Then\n                bIsNumeric = False\n            End If\n</code></pre>\n\n<p>Good code writing - and welcome to Stack Overflow.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10735198"}, "is_accepted": true, "score": 0, "last_activity_date": 1543958301, "last_edit_date": 1543958301, "creation_date": 1543957097, "answer_id": 53621311, "question_id": 53620999, "link": "https://stackoverflow.com/questions/53620999/how-to-create-error-message-if-column-contains-non-numeric-field-vba/53621311#53621311", "title": "How to create error message if column contains non-numeric field - VBA", "body": "<p><code>lRow = Cells(Rows.Count, 1).End(xlUp).Row</code> should have a clearly defined parent worksheet. Remember that you are cycling through a series of worksheets. Same with <code>If Not IsNumeric(Cells(i, 1).Value) Then</code>.</p>\n\n<pre><code>Sub Refresh()\n    '\n    ' Warning Code to check if all values are numeric\n    '-----------------------------------------------------------------------\n\n    Dim sh As Worksheet, i As Long, bIsNumeric As Boolean, lRow As Long, errng as range\n\n    bIsNumeric = True\n\n    For Each sh In ActiveWorkbook.Worksheets\n        Select Case sh.Name\n            Case \"AltA\", \"AltB\", \"AltC1\", \"AltC2\"\n                lRow = sh.Cells(sh.Rows.Count, 1).End(xlUp).Row\n                For i = 3 To lRow\n                    If Not IsNumeric(sh.Cells(i, 1).Value) Then\n                        bIsNumeric = False\n                        set errng  = sh.Cells(i, 1)\n                        Exit For\n                    End If\n                Next i\n        End Select\n        If Not bIsNumeric Then Exit For\n    Next sh\n\n    If Not bIsNumeric Then\n        'There are non-numeric values in your range\n        MsgBox \"There are non-numeric values in your range. Go check yourself and try again.\" _\n               &amp; chr(10) &amp; errng.address(0, 0, external:=true)\n    Else\n        '---------------------------------------------------\n        ' Code to summarize data\n        With Sheets(\"AlternativeSummary\")\n            .Activate\n            .Range(\"B5\").Select\n            .PivotTables(\"PivotTable5\").PivotCache.Refresh\n            MsgBox \"Complete\"\n            'All values in your range are numeric\n        end with\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "edited": false, "score": 0, "creation_date": 1543958169, "post_id": 53621438, "comment_id": 94103484, "body": "Corrected now! Thanks for your input."}, {"owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "edited": false, "score": 0, "creation_date": 1543958426, "post_id": 53621438, "comment_id": 94103600, "body": "Use of case statement is not required at all. The <code>For Each sh</code> part takes care of looping through the sheets."}], "tags": [], "owner": {"reputation": 192, "user_id": 10735793, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pq1LqstOSTQ/AAAAAAAAAAI/AAAAAAAAACY/j_g5X-BLPxw/photo.jpg?sz=128", "display_name": "MD AZAD HUSSAIN", "link": "https://stackoverflow.com/users/10735793/md-azad-hussain"}, "is_accepted": false, "score": 0, "last_activity_date": 1543958143, "last_edit_date": 1543958143, "creation_date": 1543957741, "answer_id": 53621438, "question_id": 53620999, "link": "https://stackoverflow.com/questions/53620999/how-to-create-error-message-if-column-contains-non-numeric-field-vba/53621438#53621438", "title": "How to create error message if column contains non-numeric field - VBA", "body": "<pre><code>Option Explicit\nSub Refresh()\n'\n' Warning Code to check if all values are numeric\n'-----------------------------------------------------------------------\n\nDim sh As Worksheet\nDim i As Integer\nDim bIsNumeric As Boolean\n\nbIsNumeric = True\n\nFor Each sh In ActiveWorkbook.Sheets\n    Dim lRow As Long\n    lRow = sh.Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 3 To lRow + 1\n        If Not IsNumeric(sh.Cells(i, 1).Value) Then\n            bIsNumeric = False\n        End If\n    Next i\nNext sh\n\nIf bIsNumeric = False Then 'There are non-numeric values in your range\n    MsgBox \"There are non-numeric values in your range. Go check-yourself and try again.\"\nElse\n '-----------------------------------------------------------------------\n' Code to summarize data           Sheets(\"AlternativeSummary\").Select\nRange(\"B5\").Select\nActiveSheet.PivotTables(\"PivotTable5\").PivotCache.Refresh\nMsgBox \"Complete\"\n'All values in your range are numeric\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>This will loop through all the sheets and check for non-numeric fields.</p>\n"}], "owner": {"reputation": 3, "user_id": 10745280, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wYWydxt9YuQ/AAAAAAAAAAI/AAAAAAAABUQ/MYfV0BAlyS0/photo.jpg?sz=128", "display_name": "Jessy Cawley", "link": "https://stackoverflow.com/users/10745280/jessy-cawley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 53621311, "answer_count": 3, "score": 0, "last_activity_date": 1581745802, "creation_date": 1543955717, "last_edit_date": 1581745802, "question_id": 53620999, "link": "https://stackoverflow.com/questions/53620999/how-to-create-error-message-if-column-contains-non-numeric-field-vba", "title": "How to create error message if column contains non-numeric field - VBA", "body": "<p>I am trying to write a code to produce an error message if the values of the table are non-numeric. I am not getting any error messages but the code isn't accomplishing the task. Any help? Code below:</p>\n\n<pre><code>Sub Refresh()\n'\n' Warning Code to check if all values are numeric\n'-----------------------------------------------------------------------\n\nDim sh As Worksheet\nDim i As Integer\nDim bisnumberic As Boolean\n\nbIsNumeric = True\n\nFor Each sh In ActiveWorkbook.Sheets\n    Select Case sh.Name\n        Case \"AltA\", \"AltB\", \"AltC1\", \"AltC2\"\n            Dim lRow As Long\n            lRow = Cells(Rows.Count, 1).End(xlUp).Row\n            For i = 3 To lRow\n                If Not IsNumeric(Cells(i, 1).Value) Then\n                    bisnumber = False\n                End If\n            Next i\n    End Select\nNext sh\n\n    If bIsNumeric = False Then\n            'There are non-numeric values in your range\n            MsgBox \"There are non-numeric values in your range. Go check-            \nyourself and try again.\"\n        Else\n '-----------------------------------------------------------------------\n' Code to summarize data           Sheets(\"AlternativeSummary\").Select\n        Range(\"B5\").Select\n        ActiveSheet.PivotTables(\"PivotTable5\").PivotCache.Refresh\n        MsgBox \"Complete\"\n        'All values in your range are numeric\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 1, "creation_date": 1543955186, "post_id": 53620817, "comment_id": 94102121, "body": "You might need to <code>Ctrl+Shift+Esc</code>, kill Excel active and background processes -- then re-execute the code and see if the macro runs (it might be good to close the workbook before the code ends, plus <code>appXL.Quit</code> at the end and/or explicitly <code>Set appxl = nothing</code> at the end). Just to see if there are previous application instances which persist after <code>End sub</code>. The other thing you might need to check for is protected mode."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1543955296, "post_id": 53620817, "comment_id": 94102178, "body": "Try <code>appXL.Run &quot;Book3.xlsm!macro1&quot;</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543955374, "post_id": 53620817, "comment_id": 94102220, "body": "Are you running anything else before this?  I was able to run your code without issues."}, {"owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543955730, "post_id": 53620817, "comment_id": 94102364, "body": "@BruceWayne There&#39;s nothing else running."}, {"owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1543955922, "post_id": 53620817, "comment_id": 94102468, "body": "@dwirony same thing happened with that code."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1543956163, "post_id": 53620817, "comment_id": 94102559, "body": "@Brett What is <code>macro1</code>?"}, {"owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1543956287, "post_id": 53620817, "comment_id": 94102624, "body": "@dwirony  <code>Sub macro1() Range(&quot;A1&quot;).Value = &quot;test&quot; End Sub</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543956329, "post_id": 53620817, "comment_id": 94102644, "body": "Replace macro1 with just <code>msgbox &quot;hi&quot;</code> to see if it fires...?"}, {"owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "edited": false, "score": 0, "creation_date": 1543956485, "post_id": 53620817, "comment_id": 94102714, "body": "Which workbook should I replace on?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1543956985, "post_id": 53620817, "comment_id": 94102941, "body": "@Brett Isn&#39;t there only one workbook with the macro called &quot;macro1&quot;?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1543957662, "post_id": 53620817, "comment_id": 94103249, "body": "Why are you creating a new instance of Excel rather than running macro1 within the current instance?  I have never tried this but I assume it allows you to run macro1 as a background process and I do not see how you are terminating the new instance of Excel.  I wonder what problems this might introduce."}, {"owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "edited": false, "score": 0, "creation_date": 1543959390, "post_id": 53620817, "comment_id": 94104026, "body": "There&#39;s 2 workbooks. The first workbook opens the second workbook and calls macro1. I will eventually put a code in macro1 to close the workbook when it&#39;s finished. This is just a test and I do want to have macro1 running in the backround while test_open is running as well."}, {"owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "edited": false, "score": 0, "creation_date": 1543959832, "post_id": 53620817, "comment_id": 94104208, "body": "I can manually run two separate macros on two separate workbooks at the same time no problem."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1543966616, "post_id": 53620817, "comment_id": 94106379, "body": "When I want a second workbook open, I write <code>Dim Wbk2 As Workbook</code> <code>Set Wbk2 = Workbooks.Open(\u2026)</code>.  This means I have one copy of Excel running which has two workbooks open.  You have two copies of Excel running each with one workbook open.  I have never tried having multiple copies of Excel running and would not try unless I had some very good reason for trying."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "is_accepted": true, "score": 0, "last_activity_date": 1544026856, "creation_date": 1544026856, "answer_id": 53636534, "question_id": 53620817, "link": "https://stackoverflow.com/questions/53620817/opening-a-workbook-in-a-new-window-and-running-a-macro-in-that-workbook/53636534#53636534", "title": "Opening a workbook in a new window and running a macro in that workbook", "body": "<p>I figured it out. I had to have the Sub in a Module folder instead of \"ThisWorkbook\" sheet.</p>\n"}], "owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 53636534, "answer_count": 1, "score": 1, "last_activity_date": 1544026856, "creation_date": 1543954841, "question_id": 53620817, "link": "https://stackoverflow.com/questions/53620817/opening-a-workbook-in-a-new-window-and-running-a-macro-in-that-workbook", "title": "Opening a workbook in a new window and running a macro in that workbook", "body": "<p>When I try to open a new workbook and run a macro in that workbook I get the following error:</p>\n\n<pre><code>\"Run-time error '1004': Application-defined or object-defined error\"\n</code></pre>\n\n<p>Randomly it shows this different error as well:</p>\n\n<pre><code>\"Cannot run the macro 'macro1'. The macro may not be available in the workbook or all macros may be disabled\"\n</code></pre>\n\n<p>The code I am using is:</p>\n\n<pre><code>Sub test_open()\nDim appXL As New Excel.Application\n\nappXL.Workbooks.Open \"W:\\Brett\\_Test\\Excel\\Book3.xlsm\", IgnoreReadOnlyRecommended:=True\nappXL.Visible = True\nappXL.Run \"macro1\"\n\nEnd Sub\n</code></pre>\n\n<p>Macro settings are set to Enable all macros.</p>\n\n<p>It successfully opens the workbook in a new window but throws the errors.</p>\n"}, {"tags": ["excel", "vba", "vlookup", "userform"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1543955674, "post_id": 53620796, "comment_id": 94102340, "body": "First off, remove your error handling and run the code again so that you can see what error message you&#39;re getting, then let us know what it is. Additionally, you use <code>Sheets(&quot;Feuil1&quot;)</code> with your first range, then you use <code>Feuil1</code> as a variable in your <code>VLOOKUP</code> - where did you declare <code>Feuil1</code>? Should that be <code>Sheets(&quot;Feuil1&quot;)</code>?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1543956478, "post_id": 53620796, "comment_id": 94102710, "body": "&quot;I can&#39;t make it work&quot; - how is it supposed to work?  It&#39;s difficult to suggest fixes without knowing what you want to do."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1544204337, "post_id": 53620796, "comment_id": 94206366, "body": "Allow me a remark: it&#39;s good use and also helpful for other readers to mark one of them as accepted if you found it helpful (acceptance is indicated by a colored checkmark next to the answer). C.f. <a href=\"https://stackoverflow.com/help/someone-answers\">&quot;Someone answers&quot;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1543956653, "creation_date": 1543956653, "answer_id": 53621208, "question_id": 53620796, "link": "https://stackoverflow.com/questions/53620796/vlookup-with-userform/53621208#53621208", "title": "Vlookup with userform", "body": "<p>Drop the <code>WorksheetFunction</code> and then there will be no run-time error if there's no match:</p>\n\n<pre><code>Private Sub TextBox1_AfterUpdate()\n    Dim r\n\n    r = Application.VLookup(CLng(Me.TextBox1), Feuil1.Range(\"A:E\"), 2, False)\n\n    Me.TextBox2 = IIf(IsError(r),\"Introuvable\", r)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10746142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74351a3f6af348d612c69e08dfdd6d30?s=128&d=identicon&r=PG&f=1", "display_name": "simo", "link": "https://stackoverflow.com/users/10746142/simo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1609016482, "creation_date": 1543954738, "last_edit_date": 1543955591, "question_id": 53620796, "link": "https://stackoverflow.com/questions/53620796/vlookup-with-userform", "title": "Vlookup with userform", "body": "<p>I'm trying to configure Userform research with 3 textboxes, but I can't make it work and don't know why.</p>\n\n<p>This is my code:</p>\n\n<pre><code>Private Sub TextBox1_AfterUpdate()\nOn Error GoTo 1\nIf WorksheetFunction.CountIf(Sheets(\"Feuil1\").Range(\"A:A\"), Me.TextBox1.Value) = 0 Then\n\n MsgBox \"introuvable\"\nEnd If\nWith Me\n .TextBox2 = Application.WorksheetFunction.VLookup(CLng(Me.TextBox1), Feuil1.Range(\"A:E\"), 2, 0)\nEnd With\n1\nEnd Sub\n</code></pre>\n\n<p>hoping for your help </p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 5785, "user_id": 7306999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9dNzL.jpg?s=128&g=1", "display_name": "Xukrao", "link": "https://stackoverflow.com/users/7306999/xukrao"}, "edited": false, "score": 0, "creation_date": 1543954487, "post_id": 53620656, "comment_id": 94101867, "body": "Not sure. When I execute this code on my Windows machine with Excel 2013 I&#39;m unable to reproduce the issue (i.e. not getting any errors)."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "edited": false, "score": 1, "creation_date": 1543954561, "post_id": 53620656, "comment_id": 94101895, "body": "@Luiz, Seen this: <a href=\"https://stackoverflow.com/questions/48583900/excel-vba-throws-overflow-error-with-a-simple-division\" title=\"excel vba throws overflow error with a simple division\">stackoverflow.com/questions/48583900/&hellip;</a>? Try <code>NumberTest = cdbl(1 &#47; 2)</code> or some other variant of the equation <code>NumberTest = cdbl(1) &#47; 2</code> (as per the link) and see if the error persists."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543955716, "post_id": 53620656, "comment_id": 94102358, "body": "You&#39;re dividing two <code>Integer</code> literals. Try converting either (or both) to <code>Double</code> first, using the <code>CDbl</code> conversion function. Are you sure this <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is correctly representative of the actual problem? Real code seldom divides two integer literals like this (you&#39;d conceivably have <code>Const half As Double = 0.5</code> instead)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543955911, "post_id": 53620656, "comment_id": 94102465, "body": "Alternatively, use <code>Double</code> literals. Does <code>NumberTest = 1# &#47; 2#</code> still overflow?"}, {"owner": {"reputation": 11, "user_id": 10746066, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157057413653442/picture?type=large", "display_name": "Luiz", "link": "https://stackoverflow.com/users/10746066/luiz"}, "edited": false, "score": 0, "creation_date": 1543965870, "post_id": 53620656, "comment_id": 94106206, "body": "None of those work, I still get the same error... Code runs normally on windows, but I need it to work on Mac"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1543972895, "post_id": 53620656, "comment_id": 94107880, "body": "Try removing spaces around / and if that doesn&#39;t work then change the code to Evaluate(&quot;1/2&quot;), this will definitely work."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10781293, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217711829128816/picture?type=large", "display_name": "Jim Gordon", "link": "https://stackoverflow.com/users/10781293/jim-gordon"}, "is_accepted": false, "score": 0, "last_activity_date": 1544624003, "creation_date": 1544624003, "answer_id": 53744947, "question_id": 53620656, "link": "https://stackoverflow.com/questions/53620656/getting-run-time-error-6-overflow-in-very-simple-excel-vba-code-mac/53744947#53744947", "title": "Getting Run-Time error 6: Overflow in very simple Excel VBA code (Mac)", "body": "<p>I am not able to reproduce the error in Excel version 16.21 (181210). Perhaps if you install updates the problem will be resolved.</p>\n\n<p>To find which version of Excel you have, go to the Excel menu and choose About Excel. You should have version 16.16.4 or 16.16.5 if you have Office 2016. If you have Office 2019 you should have version 16.19 or 16.20. Insider Fast build is 16.21 (181210). If your version is not one of these, use the Help menu and choose Check for Updates. If your version is any 15.x version, checking for updates won't get you updates. You'll have to download a new copy of AutoUpdate from Microsoft.<a href=\"https://i.stack.imgur.com/iJUdZ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}], "owner": {"reputation": 11, "user_id": 10746066, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157057413653442/picture?type=large", "display_name": "Luiz", "link": "https://stackoverflow.com/users/10746066/luiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 706, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1608917489, "creation_date": 1543954125, "question_id": 53620656, "link": "https://stackoverflow.com/questions/53620656/getting-run-time-error-6-overflow-in-very-simple-excel-vba-code-mac", "title": "Getting Run-Time error 6: Overflow in very simple Excel VBA code (Mac)", "body": "<p>I've gotten a Run-Time Error 6 while running some code, and while debugging I started to take away parts of it, until I was left with this very, very simple code, and still got an error</p>\n\n<pre><code>Sub test()\n\nDim NumberTest As Double\n\nNumberTest = 1 / 2\n\nEnd Sub\n</code></pre>\n\n<p>Error happens on the third line when I step into the code. Anyone knows what could be causing it? I'm on Excel 2016 for Mac</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1543955837, "post_id": 53620907, "comment_id": 94102415, "body": "I prefer the use of the WITH"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1543955303, "creation_date": 1543955303, "answer_id": 53620907, "question_id": 53620616, "link": "https://stackoverflow.com/questions/53620616/sub-or-function-not-defined-error-on-arccos/53620907#53620907", "title": "Sub or function not defined error on ArcCos", "body": "<p>The problem is with the arc-cosine function.  Try:</p>\n\n<pre><code>Function DAVIDLATLON(lat1, lon1, lat2, lon2)\n    With Application.WorksheetFunction\n        DAVIDLATLON = .Acos(Cos(.Radians(90 - lat1)) * Cos(.Radians(90 - lat2)) + Sin(.Radians(90 - lat1)) * Sin(.Radians(90 - lat2)) * Cos(.Radians(lon1 - lon2))) * 6371\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10735198"}, "is_accepted": false, "score": 1, "last_activity_date": 1543955337, "creation_date": 1543955337, "answer_id": 53620913, "question_id": 53620616, "link": "https://stackoverflow.com/questions/53620616/sub-or-function-not-defined-error-on-arccos/53620913#53620913", "title": "Sub or function not defined error on ArcCos", "body": "<p>There is no native VBA ArcCos function. Use <code>worksheetfunction.acos</code> instead.</p>\n\n<pre><code>Function DAVIDLATLON(lat1, lon1, lat2, lon2)\n  DAVIDLATLON = WorksheetFunction.Acos(Cos(WorksheetFunction.Radians(90 - lat1)) * _\n                                       Cos(WorksheetFunction.Radians(90 - lat2)) + _\n                                       Sin(WorksheetFunction.Radians(90 - lat1)) * _\n                                       Sin(WorksheetFunction.Radians(90 - lat2)) * _\n                                       Cos(WorksheetFunction.Radians(lon1 - lon2))) * 6371\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 0, "last_activity_date": 1543956880, "creation_date": 1543956880, "answer_id": 53621265, "question_id": 53620616, "link": "https://stackoverflow.com/questions/53620616/sub-or-function-not-defined-error-on-arccos/53621265#53621265", "title": "Sub or function not defined error on ArcCos", "body": "<p>Since the ArcCos Function is not known by VBA my understanding is you could first define the ArcCos function and then reference it from your second function.</p>\n\n<pre><code>Function ArcCos(RadAngle)\n    ArcCos = Atn(-RadAngle / Sqr(-RadAngle * RadAngle + 1)) + 2 * Atn(1)\nEnd Function\n\nFunction DAVIDLATLON(Lat1, Lon1, Lat2, Lon2)\n    DAVIDLATLON = ArcCos(Cos(Application.WorksheetFunction.Radians(90 - Lat1)) * Cos(Application.WorksheetFunction.Radians(90 - Lat2)) + Sin(Application.WorksheetFunction.Radians(90 - Lat1)) * Sin(Application.WorksheetFunction.Radians(90 - Lat2)) * Cos(Application.WorksheetFunction.Radians(Lon1 - Lon2))) * 6371\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2524, "user_id": 473872, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9bd86ecff80a795ebe6542d0d7da3846?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/473872/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 53620907, "answer_count": 3, "score": 0, "last_activity_date": 1546628089, "creation_date": 1543953893, "last_edit_date": 1546628089, "question_id": 53620616, "link": "https://stackoverflow.com/questions/53620616/sub-or-function-not-defined-error-on-arccos", "title": "Sub or function not defined error on ArcCos", "body": "<p>I'm trying to create a function in Excel to calculate the distance between two points in latitude longitude.</p>\n\n<p>This function gives me the error </p>\n\n<blockquote>\n  <p>Compile error:</p>\n  \n  <p>Sub or function not defined</p>\n</blockquote>\n\n<pre><code>Function DAVIDLATLON(lat1, lon1, lat2, lon2)\n DAVIDLATLON = ArcCos(Cos(Application.WorksheetFunction.Radians(90 - lat1)) * Cos(Application.WorksheetFunction.Radians(90 - lat2)) + Sin(Application.WorksheetFunction.Radians(90 - lat1)) * Sin(Application.WorksheetFunction.Radians(90 - lat2)) * Cos(Application.WorksheetFunction.Radians(lon1 - lon2))) * 6371\nEnd Function\n</code></pre>\n"}]