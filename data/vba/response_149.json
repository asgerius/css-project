[{"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510796989, "post_id": 47319297, "comment_id": 81591651, "body": "Your code works correctly if you Print Preview, or Print.  Try placing your code in the Report_Activate event."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1510847387, "post_id": 47319297, "comment_id": 81618917, "body": "Assuming the checkbox is bound to the report&#39;s query, you can apply conditional formating to the control based on expression e.g. <code>[CheckBoxField] = -1</code> to make it invisible."}], "answers": [{"tags": [], "owner": {"reputation": 726, "user_id": 8786602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VvBoB.jpg?s=128&g=1", "display_name": "Wellspring", "link": "https://stackoverflow.com/users/8786602/wellspring"}, "is_accepted": false, "score": 0, "last_activity_date": 1510799336, "creation_date": 1510799336, "answer_id": 47320568, "question_id": 47319297, "link": "https://stackoverflow.com/questions/47319297/ms-access-show-hide-label-based-on-checkbox/47320568#47320568", "title": "MS Access - Show/hide label based on checkbox", "body": "<p>I didn't download the file, but I am guessing you are not changing the checkbox during the right event. As I recall, Detail_Format is the right event in which to place this code if you want to change visibility of items in the Detail section. MS Access is sometimes finicky, however, and I recall times when this sort of task did not go smoothly. Good luck!</p>\n"}], "owner": {"reputation": 6884, "user_id": 351320, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/eafd8fa01bed58c27c5baabdd110a0d8?s=128&d=identicon&r=PG", "display_name": "Barbara", "link": "https://stackoverflow.com/users/351320/barbara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510799336, "creation_date": 1510789901, "question_id": 47319297, "link": "https://stackoverflow.com/questions/47319297/ms-access-show-hide-label-based-on-checkbox", "title": "MS Access - Show/hide label based on checkbox", "body": "<p>I need to print a label on a report only if a checkbox is checked.\nI've tried many different lines of code but I can't get it to work. This is what I have at the moment (on the OnFormat event of the footer of my report):</p>\n\n<pre><code>If chkSignature = True Then\n  CEOsign.Visible = True\nElse\n  CEOsign.Visible = False\nEnd If\n</code></pre>\n\n<p>and this is a <a href=\"https://my.syncplicity.com/share/dar002ji5f77shx/test\" rel=\"nofollow noreferrer\">working example</a> you can play with.</p>\n\n<p>If the checkbox is ticked I want to print the label for the signature. If the checkbox is unticked I want to hide it. Can you help me? Thanks.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 3, "creation_date": 1510788077, "post_id": 47318942, "comment_id": 81589145, "body": "<code>&amp; &quot;, &quot;&quot;)&quot;</code> at the end should be <code>&amp; &quot;, &quot;&quot;&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1510788336, "post_id": 47318942, "comment_id": 81589235, "body": "FWIW - <code>Cells(j, Allocation).Formula = &quot;=&quot; &amp; Allocation &amp; j &amp; &quot;* S&quot; &amp; CustomerLast</code> (after you assign a value to <code>CustomerLast</code>) is going to cause circular reference errors."}, {"owner": {"reputation": 27, "user_id": 8020918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1b74db5f69dc157d5331c67c38d974?s=128&d=identicon&r=PG&f=1", "display_name": "Purpletiger", "link": "https://stackoverflow.com/users/8020918/purpletiger"}, "edited": false, "score": 0, "creation_date": 1510846207, "post_id": 47318942, "comment_id": 81618034, "body": "Thank you! I had tried that before but getting confirmation suddenly made it work!"}], "answers": [{"tags": [], "owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "is_accepted": false, "score": 1, "last_activity_date": 1510788362, "last_edit_date": 1510788362, "creation_date": 1510788309, "answer_id": 47319034, "question_id": 47318942, "link": "https://stackoverflow.com/questions/47318942/formula-using-variables-with-vba/47319034#47319034", "title": "Formula using Variables with VBA", "body": "<p>Try <a href=\"https://stackoverflow.com/questions/47318942/formula-using-variables-with-vba#comment81589145_47318942\">this</a>:</p>\n\n<pre><code> Cells(j, Dist).Formula = \"=IFERROR(\" &amp; MidPointE &amp; j &amp; \" / \" &amp; MidPointE &amp;  CustomerLast &amp; \", \"\"\"\")\"\n</code></pre>\n\n<p>Quotes inside a string literal must be escaped - and that's done by doubling them up.</p>\n"}, {"tags": [], "owner": {"reputation": 2454, "user_id": 8784938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/753bb55c80a644f950a41ae11cfbe48c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperStew", "link": "https://stackoverflow.com/users/8784938/superstew"}, "is_accepted": false, "score": 0, "last_activity_date": 1510788360, "creation_date": 1510788360, "answer_id": 47319042, "question_id": 47318942, "link": "https://stackoverflow.com/questions/47318942/formula-using-variables-with-vba/47319042#47319042", "title": "Formula using Variables with VBA", "body": "<p>It's at the end here</p>\n\n<pre><code>&amp; \", \"\")\"\n</code></pre>\n\n<p>The two quotes between the comma and ) end the string and start a new one.</p>\n\n<pre><code>'first string\n\",\"\n\n'second string\n\")\"\n</code></pre>\n\n<p>Since you can't just throw two strings together like that, i would replace the two quotes with the CHR equivalent. Should look something like this:</p>\n\n<pre><code>Cells(j, Dist).Formula = \"=IFERROR(\" &amp; MidPointE &amp; j &amp; \" / \" &amp; MidPointE &amp;  CustomerLast &amp; \", \"&amp; CHR(034) &amp; CHR(034) &amp; \")\"\n'pretty sure 034 is the ascii code for \"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1510789343, "post_id": 47319163, "comment_id": 81589550, "body": "And that AO cell is still going to cause a circular reference - but only the OP can solve that."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 1, "last_activity_date": 1510789708, "last_edit_date": 1510789708, "creation_date": 1510789071, "answer_id": 47319163, "question_id": 47318942, "link": "https://stackoverflow.com/questions/47318942/formula-using-variables-with-vba/47319163#47319163", "title": "Formula using Variables with VBA", "body": "<p>You can also assign multiple formulas at the same time:</p>\n\n<pre><code>Range(\"AN1:AN300\").Formula = \"=IFERROR(AM1 / AM$\" &amp;  CustomerLast &amp; \", \"\"\"\")\"\nRange(\"AO1:AO300\").Formula = \"=AO1 * S$\" &amp; CustomerLast\n</code></pre>\n\n<p>I also recommend looking into Excel Tables and <a href=\"https://msdn.microsoft.com/en-us/library/bb833052\" rel=\"nofollow noreferrer\">Structured References</a> </p>\n\n<p>To avoid the circular reference issue, you can calculate the formulas and assign the values directly:</p>\n\n<pre><code>Range(\"AN1:AN300\") = Evaluate(\"IFERROR(AM1:AM300 / AM$\" &amp;  CustomerLast &amp; \", \"\"\"\")\")\nRange(\"AO1:AO300\") = Evaluate(\"INDEX(AO1:AO300 * S$\" &amp; CustomerLast &amp; \",)\")\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8020918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f1b74db5f69dc157d5331c67c38d974?s=128&d=identicon&r=PG&f=1", "display_name": "Purpletiger", "link": "https://stackoverflow.com/users/8020918/purpletiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 47319163, "answer_count": 3, "score": 0, "last_activity_date": 1510789708, "creation_date": 1510787741, "question_id": 47318942, "link": "https://stackoverflow.com/questions/47318942/formula-using-variables-with-vba", "title": "Formula using Variables with VBA", "body": "<p>I am wrestling with the syntax of this one line of some code. the formula with \"IfError\" seems to have the wrong syntax. I believe I have the quotes in the right places. </p>\n\n<pre><code>    Dim j As Integer\n    Dim MidPointE As String\n    Dim Dist As String\n    Dim Allocation As String\n\n    MidPointE = \"AM\"\n    Dist = \"AN\"\n    Allocation = \"AO\"\n\n   for J= 1 to 300\n     Cells(j, Dist).Formula = \"=IFERROR(\" &amp; MidPointE &amp; j &amp; \" / \" &amp; MidPointE &amp;  CustomerLast &amp; \", \"\")\"\n    Cells(j, Allocation).Formula = \"=\" &amp; Allocation &amp; j &amp; \"* S\" &amp; CustomerLast\n\n     Next J\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511001913, "post_id": 47318866, "comment_id": 81683054, "body": "Does Quick Steps in Outlook cover this? <a href=\"https://www.msoutlook.info/question/reply-with-a-message-template-via-quick-steps\" rel=\"nofollow noreferrer\">msoutlook.info/question/&hellip;</a>"}, {"owner": {"reputation": 1313, "user_id": 8538074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6232149945927ce05412641c7b87c24?s=128&d=identicon&r=PG&f=1", "display_name": "Tlatwork", "link": "https://stackoverflow.com/users/8538074/tlatwork"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511264474, "post_id": 47318866, "comment_id": 81777672, "body": "almost yes! I dont see a way to dynamically insert the Name, but it covers the rest! Thanks and feel free to add it as an answer so i can upvote!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511265127, "post_id": 47318866, "comment_id": 81778106, "body": "Have added. You are dynamically trying to add the sender&#39;s name?"}, {"owner": {"reputation": 1313, "user_id": 8538074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6232149945927ce05412641c7b87c24?s=128&d=identicon&r=PG&f=1", "display_name": "Tlatwork", "link": "https://stackoverflow.com/users/8538074/tlatwork"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1511272493, "post_id": 47318866, "comment_id": 81783104, "body": "yes, see in the question: &quot;Hi [firstname]&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1511265088, "creation_date": 1511265088, "answer_id": 47412465, "question_id": 47318866, "link": "https://stackoverflow.com/questions/47318866/automatic-draft-when-hitting-reply-button/47412465#47412465", "title": "Automatic draft when hitting reply button", "body": "<p>From version Excel 2010 onwards you can create a boilerplate template with custom text incorporating many of your desired features using Quick Steps.</p>\n\n<p>In case this <a href=\"https://www.msoutlook.info/question/reply-with-a-message-template-via-quick-steps\" rel=\"nofollow noreferrer\">link</a> dies here are the edited screenshot highlights:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7aOxH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7aOxH.png\" alt=\"First screenshot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/YHxSE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YHxSE.png\" alt=\"Second screenshot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/LQRab.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LQRab.png\" alt=\"Third screenshot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BjCJw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BjCJw.png\" alt=\"Fourth screenshot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/u9qOI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u9qOI.png\" alt=\"Fifth screenshot\"></a></p>\n"}], "owner": {"reputation": 1313, "user_id": 8538074, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e6232149945927ce05412641c7b87c24?s=128&d=identicon&r=PG&f=1", "display_name": "Tlatwork", "link": "https://stackoverflow.com/users/8538074/tlatwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511265088, "creation_date": 1510787365, "last_edit_date": 1510835328, "question_id": 47318866, "link": "https://stackoverflow.com/questions/47318866/automatic-draft-when-hitting-reply-button", "title": "Automatic draft when hitting reply button", "body": "<p>Suppose I get a mail from \"Lastname, Firstname\" Content: \"Hi, we wait for your answer\" and i want to reply to it.\nIs there a way that as soon as i hit the Reply button, instead of</p>\n\n<hr>\n\n<pre><code>From: \"Lastname, Firstname\" firstname.lastname@mail.com\nSent: Monday, 14. November 2017 12:23\nTo: sample@mailc.com\nSubject: Draft\n\nHi, we wait for you\n</code></pre>\n\n<hr>\n\n<p><strong>I would get instead a draft, that i could edit.</strong></p>\n\n<hr>\n\n<pre><code>Hi firstname,\n\nthank you for your message!\n\nKind regards\n\n\nFrom: me@mail.com \nSent: Monday, 14. November 2017 12:23\nTo: sample@mailc.com\nSubject: Draft\n\nHi, we wait for you\n</code></pre>\n\n<hr>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "edited": false, "score": 0, "creation_date": 1510786705, "post_id": 47318716, "comment_id": 81588664, "body": "will you be adding the blank row after the one containing 1?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510786859, "post_id": 47318716, "comment_id": 81588723, "body": "That <b>shouldn&#39;t</b> give a &quot;subscript out of range&quot; error, but it also won&#39;t do what you want.  (You probably want <code>For R = LastRow To StartRow Step -1</code>, and possibly <code>Cells(R+1, Col).EntireRow.Insert Shift:=xlDown</code>)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1510787216, "post_id": 47318716, "comment_id": 81588842, "body": "What line gives the &quot;subscript out of range&quot; error?  I was assuming it was something to do with the loop - but is it actually on your <code>Worksheets(&quot;Sheet1&quot;).Activate</code> statement?  That would imply you don&#39;t have a sheet called &quot;Sheet1&quot;."}, {"owner": {"reputation": 31, "user_id": 6762861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02efb0be1eb082c6a7147b621522a92c?s=128&d=identicon&r=PG&f=1", "display_name": "goog", "link": "https://stackoverflow.com/users/6762861/goog"}, "reply_to_user": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "edited": false, "score": 0, "creation_date": 1510787310, "post_id": 47318716, "comment_id": 81588869, "body": "@SEarle1986  : I have sheet with numbers in column A and some other values in the remaining columns, if the number in col A is 1 then I have insert a row above that"}, {"owner": {"reputation": 31, "user_id": 6762861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02efb0be1eb082c6a7147b621522a92c?s=128&d=identicon&r=PG&f=1", "display_name": "goog", "link": "https://stackoverflow.com/users/6762861/goog"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510787708, "post_id": 47318716, "comment_id": 81589008, "body": "@YowE3K : My bad, you are right. I thought internally all the sheets would be named as Sheet1 et. Any ways thanks a bunch"}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 31, "user_id": 6762861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02efb0be1eb082c6a7147b621522a92c?s=128&d=identicon&r=PG&f=1", "display_name": "goog", "link": "https://stackoverflow.com/users/6762861/goog"}, "edited": false, "score": 0, "creation_date": 1510787184, "post_id": 47318769, "comment_id": 81588823, "body": "Which line @goog?. Do you have  worksheet called <code>Sheet1</code>? If not, modified that name to fit your actual tab in Excel."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1510786929, "last_edit_date": 1510786929, "creation_date": 1510786849, "answer_id": 47318769, "question_id": 47318716, "link": "https://stackoverflow.com/questions/47318716/excel-vba-macro-to-add-a-blank-row-when-the-value-in-column-a-is-1/47318769#47318769", "title": "Excel VBA Macro to add a blank row when the value in column A is 1", "body": "<p>Code below tested and works.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n\n    Dim cntr as Long\n    For cntr = 20 to 5 Step - 1\n          If .Cells(cntr, 1) = 1 Then .cells(cntr,1).EntireRow.Insert Shift:=xlDown\n    Next\n\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510787325, "post_id": 47318839, "comment_id": 81588874, "body": "You would also need to extend the loop a few more iterations.  E.g. If every second row had 1, you would only insert 5 new rows."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1510787543, "post_id": 47318839, "comment_id": 81588941, "body": "Note: It&#39;s much easier just to use <code>For R = LastRow To StartRow Step -1</code> ;)"}], "tags": [], "owner": {"reputation": 2103, "user_id": 7031900, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/l5j98.png?s=128&g=1", "display_name": "SEarle1986", "link": "https://stackoverflow.com/users/7031900/searle1986"}, "is_accepted": false, "score": 0, "last_activity_date": 1510788338, "last_edit_date": 1510788338, "creation_date": 1510787172, "answer_id": 47318839, "question_id": 47318716, "link": "https://stackoverflow.com/questions/47318716/excel-vba-macro-to-add-a-blank-row-when-the-value-in-column-a-is-1/47318839#47318839", "title": "Excel VBA Macro to add a blank row when the value in column A is 1", "body": "<pre><code>Sub InsertRow()\n\n    Dim Col As Variant\n    Dim BlankRows As Long\n    Dim LastRow As Long\n    Dim R As Long\n    Dim StartRow As Long\n    Application.ScreenUpdating = False\n    Col = \"A\"\n    StartRow = 1\n    LastRow = 20\n    Worksheets(\"Sheet1\").Activate\n    R = StartRow\n    Do While R &lt;= LastRow\n        If Cells(R, Col) = 1 Then\n            Cells(R, Col).EntireRow.Insert Shift:=xlDown\n            R = R + 1\n            LastRow = LastRow + 1\n        End If\n        R = R + 1\n    Loop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Note the setting of the value of R in the loop, as you are shifting the rows down, you are continually checking the same value and therefore adding a row each time so we need to increment R by 1 to skip past the 1 we just checked.</p>\n\n<p>We also need to change the endpoint as we are pushing values past Row 20 by inserting so we also increment the LastRow variable. We cannot do this in a for loop in VBA, the for loop will terminate at 20 so I have changed to a while loop</p>\n\n<p>As per the comment below, working backwards from 20 is far more elequent but since I didn't think of that I haven't put it in here :)</p>\n"}], "owner": {"reputation": 31, "user_id": 6762861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02efb0be1eb082c6a7147b621522a92c?s=128&d=identicon&r=PG&f=1", "display_name": "goog", "link": "https://stackoverflow.com/users/6762861/goog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510788338, "creation_date": 1510786486, "last_edit_date": 1510786648, "question_id": 47318716, "link": "https://stackoverflow.com/questions/47318716/excel-vba-macro-to-add-a-blank-row-when-the-value-in-column-a-is-1", "title": "Excel VBA Macro to add a blank row when the value in column A is 1", "body": "<p>I wanted to add a row in excel vba when ever the value in column A is 1, here is the code I wrote, but this returns a \"subscript out of range error\". What am I doing wrong? </p>\n\n<pre><code>Sub InsertRow()\n\n    Dim Col As Variant\n    Dim BlankRows As Long\n    Dim LastRow As Long\n    Dim R As Long\n    Dim StartRow As Long\n    Application.ScreenUpdating = False\n        Col = \"A\"\n        StartRow = 1\n        LastRow = 20\n        Worksheets(\"Sheet1\").Activate\n            For R = StartRow To LastRow\n                If Cells(R, Col) = 1 Then\n                Cells(R, Col).EntireRow.Insert Shift:=xlDown\n                End If\n            Next R\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510786017, "post_id": 47318457, "comment_id": 81588430, "body": "<i>I cannot figure out why the borders are doing this?</i> - because that&#39;s just what Excel does: if your pivot table layout isn&#39;t final, you&#39;ll lose any fancypants borders if you tweak it. It does that when you use Excel manually; there&#39;s no reason for VBA code to do anything different. Finalize your layout, <i>then</i> set the borders. FWIW there&#39;s literally 20-some built-in formats with fancy borders and shadings, built-in, that <i>do</i> preserve with layout modifications. Why not use that instead of manually drawn borders?"}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510854971, "post_id": 47318457, "comment_id": 81624044, "body": "When I make the pivot table manually and then put the borders in, it works. I am not sure why this is the case."}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510856042, "post_id": 47318457, "comment_id": 81624687, "body": "How do I finalize my layout?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510856685, "post_id": 47318854, "comment_id": 81625080, "body": "<i>This</i> is how you format a pivot table. Anything else leads to madness. +1\\"}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1510788177, "last_edit_date": 1510788177, "creation_date": 1510787267, "answer_id": 47318854, "question_id": 47318457, "link": "https://stackoverflow.com/questions/47318457/pivot-table-borders-fail-when-expanding-table-in-vba/47318854#47318854", "title": "Pivot table borders fail when expanding table in VBA", "body": "<p>PivotTables have 'Styles' that you can copy and amend. So you don't need to do this with VBA, but rather duplicate a style that looks something like you want, and make any changes you want, and it will be reapplied automatically. </p>\n\n<p>To do this, right-click over a style in the Styles gallery and select <em>Duplicate...</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yRgNC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yRgNC.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>...and then give it a name, and then click on any of the areas that you want to format differently:</p>\n\n<p><a href=\"https://i.stack.imgur.com/7pOBB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7pOBB.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For instance, if you want a border around the entire PivotTable, select <em>Whole Table</em> and then click the Format button, and select <em>Border</em> from the tab at the top of the dialog and then apply the formatting you want:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mseIh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mseIh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Then click OK to close the dialogs. The PivotTable will still look the same at this stage, because while you have set up a new Style, you haven't yet applied it to this PivotTable. So go back to the Styles gallery, click on the down arrow, and select your new PivotTable stlye from the <em>Custom</em> area:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9RR6Y.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9RR6Y.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510788177, "creation_date": 1510785122, "question_id": 47318457, "link": "https://stackoverflow.com/questions/47318457/pivot-table-borders-fail-when-expanding-table-in-vba", "title": "Pivot table borders fail when expanding table in VBA", "body": "<p>I have made a pivot table using VBA. Here is my code.</p>\n\n<pre><code> .PivotTables(1).PivotFields(\"Fineline\").ShowDetail = False\n\n 'Create Borders\n\nRange(\"A2:K2\").BorderAround Weight:=xlMedium\nRange(.Range(\"A1\"), .Range(\"K\" &amp; .Range(\"K\" &amp; Rows.Count).End(xlUp).Row)).BorderAround Weight:=xlMedium\nRange(.Range(\"B1\"), .Range(\"B\" &amp; .Range(\"B\" &amp; Rows.Count).End(xlUp).Row)).BorderAround Weight:=xlMedium\nRange(.Range(\"C1\"), .Range(\"E\" &amp; .Range(\"E\" &amp; Rows.Count).End(xlUp).Row)).BorderAround Weight:=xlMedium\nRange(.Range(\"F1\"), .Range(\"H\" &amp; .Range(\"H\" &amp; Rows.Count).End(xlUp).Row)).BorderAround Weight:=xlMedium\nRange(.Range(\"I1\"), .Range(\"K\" &amp; .Range(\"K\" &amp; Rows.Count).End(xlUp).Row)).BorderAround Weight:=xlMedium\n</code></pre>\n\n<p>My pivot table is in tabular form so I am able to open and close certain tabs hence the first line of code to not show the detail. As you can see, I want to create a border around column C to E, F to H, and I to J). When I run the code, the table looks how it is supposed to. However, when I open a tab in the pivot table, all of my columns now have a border around it. I cannot figure out why the borders are doing this?</p>\n\n<p>Thanks,</p>\n\n<p>G</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 1, "creation_date": 1510785243, "post_id": 47318207, "comment_id": 81588119, "body": "If you put a break point in the code on the last line, what does it show the value of NewRange as?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "edited": false, "score": 0, "creation_date": 1510785492, "post_id": 47318207, "comment_id": 81588228, "body": "Also, your loop is a really funny way to find the last cell in the column. You should just use the .end (xlToRight) method, which will take you to the last non empty cell on the right. In fact I probably wouldn&#39;t use VBA to adjust the chart series at all, but just set up some dynamic ranges in the sheet that reference what you need, and use those in the Chart. Google &quot;Peltier&quot; &quot;Dynamic Range&quot; and you&#39;ll go straight to the patron saint of Excel Charts, Jon Peltier."}], "owner": {"reputation": 13, "user_id": 8761766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ec428855c1a56174cf016ad068c2c8?s=128&d=identicon&r=PG&f=1", "display_name": "toupenator", "link": "https://stackoverflow.com/users/8761766/toupenator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510783971, "creation_date": 1510783971, "question_id": 47318207, "link": "https://stackoverflow.com/questions/47318207/having-trouble-editting-a-series-data-range-using-vba-in-excel", "title": "Having trouble editting a series data range using VBA in Excel", "body": "<p>So my macro is meant to go fetch latest data from separate files and paste them into the next empty cell in the correct row. After that it`s supposed edit a chart so that it graphs the newest 6 data points. So far I have this:</p>\n\n<pre><code>Sub Update(startCell, data, sht, cht, sers)\n    ActiveWorkbook.Sheets(sht).Activate\n    Range(startCell).Select\n    Do While (Not IsEmpty(ActiveCell))\n        ActiveCell.Offset(0, 1).Select\n    Loop\n    Dim x As Range\n    Dim y As Range\n    Dim NewRng As String\n    Dim ChrtNm As String\n    Dim temp As Variant\n\n\n    Set temp = Worksheets(sht).ChartObjects(cht).chart.SeriesCollection(sers)\n    ChrtNm = temp.Name\n\n    Set x = ActiveCell\n    Set y = ActiveCell.Offset(0, -5)\n    NewRng = x.Address &amp; \":\" &amp; y.Address\n    NewRng = \"='\" &amp; ChrtNm &amp; \"'!\" &amp; NewRng\n\n    ActiveCell.Value() = data\n    ActiveSheet.ChartObjects(cht).Activate\n    ActiveChart.PlotArea.Select\n    ActiveChart.SeriesCollection(sers).Values = NewRng\n\nEnd Sub\n</code></pre>\n\n<p>Everything works up until the very end instead of passing SeriesCollection(sers).Values the info it needs to pick up the information it is passing it the literal string created up top as the value. I'm using this sort of convoluted method because else seems to work and when i tried recording a marco just to learn how to edit series this is what I got:</p>\n\n<pre><code>Sub ChangeRange()\n'\n' ChangeRange Macro\n'\n\n'\n    ActiveSheet.ChartObjects(\"Graphique 3\").Activate\n    ActiveChart.PlotArea.Select\n    ActiveChart.SeriesCollection(1).Values = \"='Stewardship-Online'!$AP$29:$AU$29\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1510790692, "post_id": 47318147, "comment_id": 81589973, "body": "Have you put a break point on the spot that it&#39;s having an issue to see if <code>rangoCargo</code> has a string in it for the left function to check?"}, {"owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "reply_to_user": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1510794870, "post_id": 47318147, "comment_id": 81591116, "body": "Yes, i&#39;ve already test it, it have &quot;E-0001&quot; without all the other numbers."}, {"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1510843599, "post_id": 47318147, "comment_id": 81616041, "body": "Where exactly is it breaking or having the issue?  Is it at the left function or somewhere else? OH sorry i found your comment where you said you are having the issue."}, {"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "edited": false, "score": 0, "creation_date": 1510844669, "post_id": 47318147, "comment_id": 81616887, "body": "try setting <code>rangoCargo</code> to <code>Range(&quot;C3&quot;)</code> to see if it&#39;s the cell that&#39;s having the problem.  I&#39;m not able to duplicate the issue.  Either somehow <code>rangoCargo</code> is loosing it&#39;s reference to the range by the time it gets to the end, or there is something wrong with <code>C3</code>.  You could also try passing the <code>rangoCargo.Adress</code> to a variable before setting it to the next cell down to see if it still hold the reverenced <code>C2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1510885898, "post_id": 47333337, "comment_id": 81636923, "body": "Man, thank you so much! I never thought the answer could be so easy. I&#39;ve done that kind of declaration in all the rest of my codes without any trouble. If you can (and only if you want to) i would like to explain why that kind of things happens. And again, R. Roe, thank you for your time !"}, {"owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "reply_to_user": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "edited": false, "score": 0, "creation_date": 1510931686, "post_id": 47333337, "comment_id": 81659858, "body": "I thought I did explain it because the variable didn&#39;t have an explicit declaration it assigns it the <code>variant</code> object type.  <a href=\"http://www.informit.com/articles/article.aspx?p=339929&amp;seqNum=2\" rel=\"nofollow noreferrer\">informit.com/articles/article.aspx?p=339929&amp;seqNum=2</a> has a very good definition of the variant type at the bottom of the web page.  Also, please remember to mark as answer."}], "tags": [], "owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "is_accepted": true, "score": 0, "last_activity_date": 1510845789, "creation_date": 1510845789, "answer_id": 47333337, "question_id": 47318147, "link": "https://stackoverflow.com/questions/47318147/issue-with-offset-in-loop-cycle-object-required/47333337#47333337", "title": "Issue with offset in loop cycle.Object required", "body": "<p>Ok, I think I've found your issue. </p>\n\n<p>When you dimension variables like this;</p>\n\n<pre><code>Dim rangoCargo, rangoTAG, rangoTipo As Range\n</code></pre>\n\n<p>you would think that they are all of type <code>Range</code>, but this is false.  the first two will be of type <code>variant</code> because they are not declared as any type and the last will be the only variable declared as a <code>Range</code> type. </p>\n\n<p>You should change your declarations to either of the following and then your code should work.</p>\n\n<pre><code>Dim rangoCargo As Range, rangoTAG As Range, rangoTipo As Range\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Dim rangoCargo As Range\nDim rangoTAG As Range\nDim rangoTipo As Range\n</code></pre>\n\n<p>since rangoCargo was declared as a variant it doesn't know that it's a <code>Range</code> object hence the reason why you're getting the error.  The first time you set the variable to <code>Range(\"C2\")</code> it is not actually setting the range but the value its self.  To test, immediately after the first time you set <code>rangoCargo</code> add this code and it should fail;</p>\n\n<pre><code>p = rangoCargo.Value\n</code></pre>\n\n<p>It will give you the same error. <code>Run-time error '424': Object required</code></p>\n\n<p>Hope that helps.  Remember if this fixes your issue to mark as answer. So others can see what to do to fix the issue if they come across it too.</p>\n"}], "owner": {"reputation": 7, "user_id": 7712262, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/G078H.jpg?s=128&g=1", "display_name": "Matto", "link": "https://stackoverflow.com/users/7712262/matto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 47333337, "answer_count": 1, "score": 0, "last_activity_date": 1510845789, "creation_date": 1510783718, "last_edit_date": 1510844086, "question_id": 47318147, "link": "https://stackoverflow.com/questions/47318147/issue-with-offset-in-loop-cycle-object-required", "title": "Issue with offset in loop cycle.Object required", "body": "<p>i'm having an issue in my While cycle with an offset.</p>\n\n<p>There's the code:</p>\n\n<pre><code>    Sub Voucher()\n\n            Dim rangoCargo, rangoTAG, rangoTipo As Range\n            Dim archivo As String\n            Dim vFound As Boolean\n\n            Dim subFldr As Object\n            Dim subsubFldr As Object\n\n            Worksheets(\"OC\").Visible = True\n            Worksheets(\"OC\").Select\n\n            Set rangoTAG = Range(\"B2\")\n            Set rangoCargo = Range(\"C2\")\n            Set rangoTipo = Range(\"E2\")\n\n            Dim fso As Object\n            Set fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\n            rutaA\u00f1o = ActiveWorkbook.Path &amp; \"\\2017\"\n            rutaFARFI = rutaA\u00f1o &amp; \"\\FAR_FI\"\n            rutaFARTA = rutaA\u00f1o &amp; \"\\FAR_TA\"\n            rutaFARTN = rutaA\u00f1o &amp; \"\\FAR_TN\"\n            rutaGOPMTI = rutaA\u00f1o &amp; \"\\GOPM_TI\"\n\n            rutaDocumentos = ActiveWorkbook.Path &amp; \"\\SGSCM\\02_ORDENES_DE_COMPRA\\\"                                                             \n\n            If Dir(ActiveWorkbook.Path &amp; \"\\2017\", vbDirectory) = \"\" Then 'This checks if a main folder exist, do the procedure, nothing special\n\n                MsgBox \"Please, Check if the [2017] Folder Exists\"\n\n            Else 'if it exists:\n\n                Do While Not IsEmpty(rangoCargo) 'Starts the cycle\n\n                    If rangoTipo = \"C\" Then 'If Letter Type is C it loops through a folder until it finds the \"C\" Like one.\n\n                        rangoCargo = Left(rangoCargo, 6) \n\n                        For Each subFldr In CreateObject(\"Scripting.FileSystemobject\").GetFolder(rutaFARFI).Subfolders\n                            For Each subsubFldr In CreateObject(\"Scripting.FileSystemobject\").GetFolder(subFldr).Subfolders\n                                Debug.Print subsubFldr\n\n                                vFound = False\n\n                                If subsubFldr Like \"*\\\" &amp; rangoTipo &amp; rangoTAG Then 'If it finds it, copy and move the file from another folder to it.\n\n                                    vFound = True\n                                    cFolder = subsubFldr.Path\n\n                                    archivo = Dir(rutaDocumentos &amp; \"\\\" &amp; rangoCargo &amp; \"\\*.*\")\n                                    Do Until archivo = \"\"\n\n                                        Call fso.copyFile(rutaDocumentos &amp; \"\\\" &amp; rangoCargo &amp; \"\\\" &amp; archivo, cFolder &amp; \"\\\" &amp; archivo)\n                                        archivo = Dir\n\n                                    Loop\n\n                                End If 'ends subsubFldr\n\n                                If vFound = True Then\n                                    Exit For\n                                End If\n\n                            Next subsubFldr\n\n                            If vFound = True Then\n                                Exit For\n                            End If\n                        Next subFldr\n\n                    ElseIf rangoTipo = \"P\" Then\n\n                        archivo = Dir(rutaDocumentos &amp; \"\\\" &amp; rangoCargo &amp; \"\\*.*\")\n                        Do Until archivo = \"\"\n\n                            Call fso.copyFile(rutaDocumentos &amp; \"\\\" &amp; rangoCargo &amp; \"\\\" &amp; archivo, rutaFARFI &amp; \"\\\" &amp; rangoTipo &amp; \"\\\" &amp; rangoTAG &amp; \"\\\" &amp; archivo)\n                            archivo = Dir\n                        Loop\n\n                    End If\n\n                    Set rangoTAG = rangoTAG.Offset(1, 0)\n                    Set rangoTipo = rangoTipo.Offset(1, 0)\n                    Set rangoCargo = rangoCargo.Offset(1, 0) 'THIS OFFSET HAS THE PROBLEM\n                'When the command Set rangoCargo = rangoCargo.Offset(1, 0) executes it throws the next message: Run Time Error '424' object required\n\n                Loop 'The cycle end when it founds \"\"\n\n            End If 'End if the folder [2017] doesn't exists\n\n        End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/PFjDN.png\" rel=\"nofollow noreferrer\">Excel Worksheet (OC)</a></p>\n\n<p>Ok, here goes the problem:</p>\n\n<p>I'm using a Cycle to loop between a Sheet that contains a string of a \"Folder\" in his cellValue, in this case <strong>Document Like</strong>. I've done a Left(rangoCargo, 6) to catch the exact number of chars equals to the folder that contains the files to copy them and later move them to the new folder.</p>\n\n<p>As you can see in the Document Like Column the first value is \"E-0001-997818\". Theres a main folder that contains another sub folders, we will call the Main folder <strong>OC</strong>. From OC i must get a document and move it to the searched folder (I.E E-001), so, E-001 contains the documents that must be moved to a new folder but, the E-001 is called like that, and in the \"Document Like\" column they're called like that but a lot of extra numbers (i don't know why, the corporation give the excel file to me and i must work with it without modificating it). \nSo i did a Left() to get the exactly string of the folder to locate them, and there's is the problem, i don't know how to fix the \"It Requires an Object\" error.\nI'm almost sure that is because of the Offset, but i don't know how to fix it.</p>\n\n<p>So, any help could be very useful.Thank you for your time guys.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510783513, "post_id": 47318048, "comment_id": 81587257, "body": "Thank you for your input. However, I am getting the same error at the second line of codes you posted."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510783993, "post_id": 47318048, "comment_id": 81587505, "body": "I have modified my codes based on yours so let me know if I did something wrong."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510841252, "post_id": 47318048, "comment_id": 81614271, "body": "I am trying to add blank row and start a new line but when I add .typetext after insertafter &quot; &quot;, it&#39;s still populating in the table cell(1,1) anyway to fix that? i can&#39;t seem to use typeparagraph or typetext."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510841596, "post_id": 47318048, "comment_id": 81614531, "body": "I posted my desire results and modified my currents and I can&#39;t seem to modify your codes to suit my needs. I put (blank row) so you know there is a space and I m hoping to use .typeparagraph or typetext since that how I am inputting my texts afterwards."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510842986, "post_id": 47318048, "comment_id": 81615564, "body": "The image help me to understand what you was trying to do. Edited again. Try the code, it should work now."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510843304, "post_id": 47318048, "comment_id": 81615824, "body": "Thank you for your input, now I get blank row but &quot;Hello&quot; is still in cell(1,1) of the table. I think the issue is the cursor is in the table or the way I use with range."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510843504, "post_id": 47318048, "comment_id": 81615968, "body": "Hi, I did but I can&#39;t seem to incorporate yours with .typeparagraph, .boldrun or .typetext can you try?"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510843704, "post_id": 47318048, "comment_id": 81616110, "body": "Everything after insert after that line of code will be bounced back to cell(1,1) of the table for some reason and I am thinking it&#39;s because the cursor is pointing that and I tried to add page break after the table and it&#39;s just moves the whole table to next page."}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1510843819, "post_id": 47318048, "comment_id": 81616187, "body": "I will start a new question since you answer partial of my answers. Thanks"}, {"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 1, "creation_date": 1510847112, "post_id": 47318048, "comment_id": 81618704, "body": "Thanks David, I found something that works online. Thanks again."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 1, "last_activity_date": 1510843358, "last_edit_date": 1510843358, "creation_date": 1510783367, "answer_id": 47318048, "question_id": 47317975, "link": "https://stackoverflow.com/questions/47317975/text-after-table-in-word-using-vba-codes/47318048#47318048", "title": "Text after table in Word using VBA codes", "body": "<blockquote>\n  <p>Edited</p>\n</blockquote>\n\n<p>Try the following:</p>\n\n<pre><code>   Sub Word_Report()\n    Dim objWord As Object\n    Dim objDoc As Object\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = True\n    Set objDoc = objWord.Documents.Add()\n\n\n\n\n     With objWord.Selection\n    Set myTable = objDoc.Tables.Add(Range:=objWord.Selection.Range, NumRows:=7, NumColumns:=3)\n      myTable.Borders.Enable = True\n\n    ''' my table contents'''\n    End With\n\n    'start new line after table\n    objDoc.Range.InsertAfter Chr(13) &amp; \"Hello\"\n\n    End Sub\n</code></pre>\n\n<p>Use <code>.Range</code> instead of <code>Selection</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11465794, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9a3d6d6acfffa12980166d0a98b52c16?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11465794/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1557250538, "last_edit_date": 1557250538, "creation_date": 1557245696, "answer_id": 56026666, "question_id": 47317975, "link": "https://stackoverflow.com/questions/47317975/text-after-table-in-word-using-vba-codes/56026666#56026666", "title": "Text after table in Word using VBA codes", "body": "<p>To insert text immediately following at table, you have to <strong>set the range</strong> to the table then <strong>collapse the range</strong>.  Insert your table, flow all your data into it, format the table. </p>\n\n<p>When you've got it how you want it, use code like this where <code>h1</code> is a <code>Word.Range</code> and <code>objTemplate</code> is a <code>Word.Document</code> object:</p>\n\n<pre><code>Set h1 = objTemplate.Tables(TableNum).Range\n\nh1.Collapse Direction:=wdCollapseEnd\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3705, "favorite_count": 2, "accepted_answer_id": 47318048, "answer_count": 2, "score": 1, "last_activity_date": 1559881782, "creation_date": 1510783058, "last_edit_date": 1559881782, "question_id": 47317975, "link": "https://stackoverflow.com/questions/47317975/text-after-table-in-word-using-vba-codes", "title": "Text after table in Word using VBA codes", "body": "<p>I create a Word document using VBA codes and transfer data from Excel to a table I create in the Word document.</p>\n\n<p>I get an error starting a new line/paragraph after the table.</p>\n\n<p>My code selects the whole table but does not start new text after the table, so later content is being added to cell(1,1) in the table. </p>\n\n<p>I am just showing you the structure of my codes and I get an error at the <code>Selection.Collapse</code> line of code. </p>\n\n<blockquote>\n  <p>run time error 438, object doesn't support this property or method.</p>\n</blockquote>\n\n<pre><code>Sub Word_Report()\n    Dim objWord As Object\n    Dim objDoc As Object\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = True\n    Set objDoc = objWord.Documents.Add()\n    With objWord.Selection\n        Set myTable = objDoc.Tables.Add(Range:=objWord.Selection.Range, NumRows:=7, NumColumns:=3)\n        myTable.Borders.Enable = True\n\n        ''' my table contents'''\n    end with\n\n    'start new line after table\n    objDoc.Range.InsertAfter Chr(13) &amp; \"Hello\"\n    .Font.Size = 11\n    .BoldRun\n\nEnd sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uAeCg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uAeCg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "drop-down-menu", "colors", "ms-word"], "comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510807995, "post_id": 47317963, "comment_id": 81594566, "body": "Dave, it&#39;s not very clear what you&#39;re asking... but it sounds like you could use VBA for this OR you could use quick parts depending on where the dropdown is and where the identifying color / shapes needs to be"}, {"owner": {"reputation": 1147, "user_id": 570613, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/316d575457b7acb0654c39fbabf9663c?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/570613/dave"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510820648, "post_id": 47317963, "comment_id": 81600036, "body": "Thanks for the response I&#39;ve edited my question."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510821378, "post_id": 47317963, "comment_id": 81600461, "body": "Can I assume that since you have added the word-vba tag that you are planning on (or at least considering) using VBA?  Have you some code to share?"}, {"owner": {"reputation": 1147, "user_id": 570613, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/316d575457b7acb0654c39fbabf9663c?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/570613/dave"}, "reply_to_user": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510822158, "post_id": 47317963, "comment_id": 81600930, "body": "I was thinking vba would be the only way to manage it, but have struggled to find anything to help me get it started."}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510823263, "post_id": 47317963, "comment_id": 81601648, "body": "Depending on the layout of your document you could use a &quot;Building Block Gallery Content Control&quot;. This would insert a pre-formatted block into your document.... but if you wanted to change the color you&#39;d lose any subsequent edits in the &quot;block&quot; i.e. if you add text... so not super flexible. But if you&#39;re just adding a bar of color... well it could work"}], "answers": [{"comments": [{"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "edited": false, "score": 0, "creation_date": 1510830766, "post_id": 47325728, "comment_id": 81606977, "body": "lol: Statistics: 32 lines of supporting code so that one lone line can do all the work."}, {"owner": {"reputation": 1147, "user_id": 570613, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/316d575457b7acb0654c39fbabf9663c?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/570613/dave"}, "edited": false, "score": 0, "creation_date": 1510866544, "post_id": 47325728, "comment_id": 81630361, "body": "Thats great thanks! It wont work in the header though, would there be a simple fix for that?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1510885615, "post_id": 47325728, "comment_id": 81636847, "body": "Actually, there are quite a number of headers in a document. The new code above expects a &quot;Rectangle 1&quot; in all of them. It&#39;s possible to have the same name, and if you copy/paste this will be correct automatically, as will be the case if you let Word manage your headers."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1510885464, "last_edit_date": 1510885464, "creation_date": 1510823932, "answer_id": 47325728, "question_id": 47317963, "link": "https://stackoverflow.com/questions/47317963/ms-word-colour-change-linked-to-dropdown-menu/47325728#47325728", "title": "MS Word, Colour change linked to dropdown menu", "body": "<p>Please paste the code below in the <code>ThisDocument</code> code sheet of your template and save it as macro enabled, in DOTM or DOCM format.</p>\n\n<p>Add an ActiveX combobox to your template. By default it has the name \"ComboBox1\". You will find that the code refers to it by this name.</p>\n\n<p>Add a rectangular shape to your template. I made this more like a bar, about 5mm high and across the entire page width. By default, Word will call it \"Rectangle 1\". Note that the code refers to it by this name.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Document_Open()\n    ' 16 Nov 2017\n\n    Dim iShp As InlineShape\n    Dim Shp As Shape\n    Dim ShapesCount As Integer\n\n    For Each iShp In ActiveDocument.InlineShapes\n        With iShp\n            If .Type = wdInlineShapeOLEControlObject Then\n                If StrComp(.OLEFormat.Object.Name, \"ComboBox1\", vbTextCompare) _\n                           = 0 Then ShapesCount = ShapesCount + 1\n            End If\n        End With\n    Next iShp\n\n    For Each Shp In ActiveDocument.Shapes\n        With Shp\n            If .Type = msoAutoShape Then\n                If StrComp(.Name, \"Rectangle 1\", vbTextCompare) _\n                           = 0 Then ShapesCount = ShapesCount + 1\n            End If\n        End With\n    Next Shp\n\n   If ShapesCount &lt; 2 Then\n        MsgBox \"One of the required shapes is missing.\", _\n               vbInformation, \"Corrupted document\"\n        Exit Sub\n    Else\n        With ActiveDocument\n            With .ComboBox1\n                .List = Array(\"Cycotoxic\", \"Monoclonic\")\n                If .ListIndex &lt; 0 Then .ListIndex = 0\n            End With\n        End With\n    End If\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    ' 16 Nov 2017\n    Shapes(\"Rectangle 1\").Fill.ForeColor = Array(vbYellow, 15773696)(ComboBox1.ListIndex)\nEnd Sub\n</code></pre>\n\n<p>When you open the document the <code>Document_Open</code> event procedure will run (for testing, you can also run it manually). It checks if the two shapes are present - one an Inlineshape, the other a normal shape - and gives an error message if one of them is missing. It will also add the two choices to the Combobox. You will find the names in the code (in case I misspelled them).</p>\n\n<p>Now, when you change the selection the colour of the bar will toggle between yellow and blue.</p>\n\n<p>Statistics: 32 lines of supporting code so that one lone line can do all the work.</p>\n\n<p>The following code will have the rectangle in the header. Unfortunately, it isn't possible to have an ActiveX control in the header, but you might format the ComboBox to have no frame and let the dropdown arrow only appear when you hover the mouse over it so that the selected word appears as part of the document's text, perhaps even its title.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Document_Open()\n    ' 17 Nov 2017\n\n    Dim iShp As InlineShape\n\n    For Each iShp In ActiveDocument.InlineShapes\n        With iShp\n            If .Type = wdInlineShapeOLEControlObject Then\n                If StrComp(.OLEFormat.Object.Name, \"ComboBox1\", vbTextCompare) = 0 Then\n                    With .OLEFormat.Object\n                        .List = Array(\"Cycotoxic\", \"Monoclonic\")\n                        If .ListIndex &lt; 0 Then .ListIndex = 0\n                    End With\n                End If\n            End If\n        End With\n    Next iShp\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    ' 17 Nov 2017\n\n    Dim Sect As Object, Story As Object\n    Dim Shp As Shape\n\n    With ActiveDocument\n        For Each Sect In .Sections\n            For Each Story In Sect.Headers\n                For Each Shp In Story.Shapes\n                    With Shp\n                        If .Type = msoAutoShape Then\n                            If StrComp(.Name, \"Rectangle 1\", vbTextCompare) = 0 Then\n                                Shap.Fill.ForeColor = Array(vbYellow, 15773696)(ComboBox1.ListIndex)\n                            End If\n                        End If\n                    End With\n                Next Shp\n            Next Story\n        Next Sect\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that this version doesn't inspect the document for the presence of either ComboBox or Rectangle. Instead, if the ComboBox is found its dropdown list is set. If it isn't found nothing will happen. And if there is no ComboBox  to call its change event the colour in the rectangle won't change, especially if it doesn't exist.</p>\n"}], "owner": {"reputation": 1147, "user_id": 570613, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/316d575457b7acb0654c39fbabf9663c?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/570613/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1578, "favorite_count": 0, "accepted_answer_id": 47325728, "answer_count": 1, "score": 0, "last_activity_date": 1593889269, "creation_date": 1510782977, "last_edit_date": 1593889269, "question_id": 47317963, "link": "https://stackoverflow.com/questions/47317963/ms-word-colour-change-linked-to-dropdown-menu", "title": "MS Word, Colour change linked to dropdown menu", "body": "<p>I have a Word template with options within the header, one of which is the type of document it relates to. I have cytotoxic and monoclonal options to be selected from a drop down menu.</p>\n\n<p>I need to have some identifier colours displayed on the document, Yellow for cytotoxic and Blue for monoclonal. To help with quick recognition for better usability.</p>\n\n<p>Is there a way to alter a shape or text box colour depending on which option is selected? </p>\n\n<p><strong>edit</strong>\nThe template is a work in progress so not 100% sure where the colour will be added, would just like it automated for uniformity as it will be applied to many documents. And worked on by different people. </p>\n\n<p>I'm after an excel conditional formatting type effect where if the drop down shows cytotoxic colour gets applied. It could be a shape, textbox, cell or font, I could work with whichever is possible to be linked. </p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510782711, "post_id": 47317831, "comment_id": 81586865, "body": "You are setting your worksheet object <code>HeaderWrite</code> outside the loop, then closing the workbook it is in within the loop (<code>xlWb.Close SaveChanges:=True</code>), so when you go to use the worksheet object again it is no longer available."}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510782814, "post_id": 47317831, "comment_id": 81586928, "body": "@YowE3K - ah that explains it.  But I only want to write the header info one time, if I place that inside of my loop it would write the headers each time the loop iterates.  Thoughts on avoiding that?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510783070, "post_id": 47317831, "comment_id": 81587072, "body": "Without knowing where you are initially setting <code>xlWb</code> and where you are initially setting <code>i</code>, I can&#39;t be sure what the easiest solution would be.  It may be as simple as having an <code>If i = 0 Then</code> statement just inside the loop which creates the workbook, sets the <code>HeaderWrite</code> object, writes the headers and whatever other workbook initialisation is needed, and then changing your <code>If i = 50 Then</code> block to simply close the workbook and set <code>i = 0</code>.  (But that&#39;s just an &quot;off the top of my head&quot; suggestion.)"}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510783205, "post_id": 47317831, "comment_id": 81587127, "body": "@YowE3K - see my edit - I think that answers your ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510783225, "post_id": 47317831, "comment_id": 81587135, "body": "The less &quot;efficient&quot; solution would be to replicate your header writing code just after you create the new workbook within the <code>If i=50 Then</code> block."}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510783411, "post_id": 47317831, "comment_id": 81587218, "body": "@YowE3K - yes duplicating the code inside the if i = 50 block would remedy - but will be pretty invasive on system resources.  If possible, I would like a &quot;cleaner&quot; solution"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510784068, "post_id": 47317831, "comment_id": 81587551, "body": "In your first file, you appear to be writing retrieved data to cells N2:P2, then Q2:S2, then T2:V2, etc.  But in your second file, you seem to be setting it up to write to Q2:S2 as the first location.  Is that deliberate?  And you write <code>name</code> to A2 in the first file, but to C2 in the second file?"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1510784449, "creation_date": 1510784449, "answer_id": 47318299, "question_id": 47317831, "link": "https://stackoverflow.com/questions/47317831/write-a-header-to-multiple-workbos/47318299#47318299", "title": "Write A Header To Multiple WOrkbos", "body": "<p>This is completely untested, but hopefully I have moved things to the correct spots:</p>\n\n<pre><code>Set xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = True\nDo While Not rs1.EOF\n  i = 0\n  x = 0  ' was 1 ??\n  name = rs1.Fields(0).Value\n  Set rs2 = Db.OpenRecordset(\"SELECT * FROM MasterDB\", dbOpenDynaset)\n  With rs2\n     .MoveLast\n     .MoveFirst\n     Do While Not .EOF\n        If i = 0 Then\n           Set xlWb = xlApp.Workbooks.Add\n           row = 1  ' This always stays as 1 ?!?!\n           xyz = 0      \n           Set HeaderWrite = xlWb.Worksheets(1)      \n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 1\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 2\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 3\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 4\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 5\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 6\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 7\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 8\"\n           xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Header 9\"\n           If x = 0 Then\n               HeaderWrite.Range(\"$A$2\") = name\n               Set xlR = HeaderWrite.Range(\"$N$2\")\n           Else\n               HeaderWrite.Range(\"$C$2\") = name\n               Set xlR = HeaderWrite.Range(\"$Q$2\")\n           End If\n        End If\n        xlR.Value = .Fields(0).Value\n        xlR.Offset(ColumnOffset:=1).Value = .Fields(2).Value\n        xlR.Offset(ColumnOffset:=2).Value = \"Mainstreem\"\n        xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Dept_\" &amp; i\n        xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"Item\" &amp; i\n        xyz = xyz + 1 : HeaderWrite.Cells(row, xyz).Value = \"CRN\" &amp; i\n        Set xlR = xlR.Offset(ColumnOffset:=3)\n        i = i + 1\n        Debug.Print i\n        If i = 50 Then\n           i = 0\n           x = x + 1\n           'I moved this up - otherwise I don't think you have a filename\n           sFile = name &amp; \"_\" &amp; \"SalesLog\" &amp; x &amp; \".xlsx\"\n           xlWb.SaveAs FileName:=sPath &amp; sFile, FileFormat:=xlOpenXMLWorkbook\n           xlWb.Close SaveChanges:=True\n        End If\n        .MoveNext\n     Loop\n     .Close\n  End With\n</code></pre>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 47318299, "answer_count": 1, "score": 0, "last_activity_date": 1510784449, "creation_date": 1510782403, "last_edit_date": 1510783191, "question_id": 47317831, "link": "https://stackoverflow.com/questions/47317831/write-a-header-to-multiple-workbos", "title": "Write A Header To Multiple WOrkbos", "body": "<p>I am dynamically creating an Excel workbook based off an item count - and I want to write esssentially teh same header to each workbook.  My below syntax works for the first workbook, but the second a new workbook is created the error is thrown</p>\n\n<p>This is my syntax - what do I need to do so that the header row is written to each workbook that is created?</p>\n\n<pre><code>Set xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = True\nDo While Not rs1.EOF\n  i = 0\n  x = 1\n  name = rs1.Fields(0).Value\n  Set xlWb = xlApp.Workbooks.Add\n  row = 1\n  xyz = 0      \n  Set HeaderWrite = xlWb.Worksheets(1)      \n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 1\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 2\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 3\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 4\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 5\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 6\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 7\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 8\"\n  xyz = xyz + 1\n  HeaderWrite.Cells(row, xyz + 1).Value = \"Header 9\"\n  xyz = xyz + 1      \n  xlWb.Worksheets(1).Range(\"$A$2\") = name\n  Set xlR = xlWb.Worksheets(1).Range(\"$N$2\")\n  Set rs2 = Db.OpenRecordset(\"SELECT * FROM MasterDB\", dbOpenDynaset)\n  With rs2\n     .MoveLast\n     .MoveFirst\n     Do While Not .EOF\n        xlR.Value = .Fields(0).Value\n        xlR.Offset(ColumnOffset:=1).Value = .Fields(2).Value\n        xlR.Offset(ColumnOffset:=2).Value = \"Mainstreem\"\n        HeaderWrite.Cells(row, xyz + 1).Value = \"Dept_\" &amp; i\n        xyz = xyz + 1\n        HeaderWrite.Cells(row, xyz + 1).Value = \"Item\" &amp; i\n        xyz = xyz + 1\n        HeaderWrite.Cells(row, xyz + 1).Value = \"CRN\" &amp; i\n        xyz = xyz + 1\n        i = i + 1\n        Debug.Print i\n        If i = 50 Then\n           i = 0\n           x = x + 1\n           xlWb.SaveAs FileName:=sPath &amp; sFile, FileFormat:=xlOpenXMLWorkbook\n           xlWb.Close SaveChanges:=True\n           Set xlWb = xlApp.Workbooks.Add\n           sFile = name &amp; \"_\" &amp; \"SalesLog\" &amp; x &amp; \".xlsx\"\n           xlWb.Worksheets(1).Range(\"$C$2\") = name\n           Set xlR = xlWb.Worksheets(1).Range(\"$Q$2\")\n        Else\n           Set xlR = xlR.Offset(ColumnOffset:=3)\n        End If\n        .MoveNext\n     Loop\n     .Close\n  End With\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1510819117, "post_id": 47317631, "comment_id": 81599269, "body": "Create a normal form, set its popup and modal properties to yes, move it when loads with <code>DoCmd.MoveSize</code> and handle the OK - Cancel button events. Plenty of examples on the internet to get you started."}], "answers": [{"tags": [], "owner": {"reputation": 726, "user_id": 8786602, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VvBoB.jpg?s=128&g=1", "display_name": "Wellspring", "link": "https://stackoverflow.com/users/8786602/wellspring"}, "is_accepted": false, "score": 0, "last_activity_date": 1510781902, "creation_date": 1510781902, "answer_id": 47317707, "question_id": 47317631, "link": "https://stackoverflow.com/questions/47317631/access-vba-pop-up-sub-form-for-submission-of-entries/47317707#47317707", "title": "Access VBA Pop Up Sub Form for Submission of Entries", "body": "<p>I would strongly recommend, if you feel it necessary to go this route, that you employ the use of a modal pop-up form, whose coordinates I believe you can specify, so that it opens in a particular area. There may be nuances depending upon user screen resolution, but I'm pretty sure this will solve your problem. The subform solution you propose sounds very rickety.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1510782201, "creation_date": 1510782201, "answer_id": 47317778, "question_id": 47317631, "link": "https://stackoverflow.com/questions/47317631/access-vba-pop-up-sub-form-for-submission-of-entries/47317778#47317778", "title": "Access VBA Pop Up Sub Form for Submission of Entries", "body": "<p>Try this function found in: </p>\n\n<blockquote>\n  <p><a href=\"http://www.excely.com/excel-vba/define-a-position-of-messagebox.shtml\" rel=\"nofollow noreferrer\">http://www.excely.com/excel-vba/define-a-position-of-messagebox.shtml</a></p>\n</blockquote>\n\n<pre><code>Option Explicit\n\n' Import\nPrivate Declare Function UnhookWindowsHookEx Lib \"user32\" _\n    (ByVal hHook As Long) As Long\n\nPrivate Declare Function GetCurrentThreadId Lib \"kernel32\" () As Long\n\nPrivate Declare Function SetWindowsHookEx Lib \"user32\" _\n    Alias \"SetWindowsHookExA\" _\n    (ByVal idHook As Long, _\n     ByVal lpfn As Long, _\n     ByVal hmod As Long, _\n     ByVal dwThreadId As Long) As Long\n\nPrivate Declare Function SetWindowPos Lib \"user32\" _\n    (ByVal hwnd As Long, _\n     ByVal hWndInsertAfter As Long, _\n     ByVal x As Long, _\n     ByVal y As Long, _\n     ByVal cx As Long, _\n     ByVal cy As Long, _\n     ByVal wFlags As Long) As Long\n\n' Handle to the Hook procedure\nPrivate hHook As Long\n\n' Position\nPrivate msgbox_x As Long\nPrivate msgbox_y As Long\n\n' Hook type\nPrivate Const WH_CBT = 5\nPrivate Const HCBT_ACTIVATE = 5\n\n' SetWindowPos Flags\nPrivate Const SWP_NOSIZE = &amp;H1      ' Retains the current size\nPrivate Const SWP_NOZORDER = &amp;H4    ' Retains the current Z order\n\nSub TestMsgBox()\n    MsgBoxPos \"Set non-Center Position\", _\n              vbOKOnly, _\n              \"Message Box Hooking\", _\n              400, 300\nEnd Sub\n\nPublic Sub MsgBoxPos(strPromt As String, _\n              vbButtons As VbMsgBoxStyle, _\n              strTitle As String, _\n              xPos As Long, _\n              yPos As Long)\n\n    ' Store position\n    msgbox_x = xPos\n    msgbox_y = yPos\n\n    ' Set Hook\n    hHook = SetWindowsHookEx(WH_CBT, _\n                              AddressOf MsgBoxHookProc, _\n                              0, _\n                              GetCurrentThreadId)\n\n    ' Run MessageBox\n    MsgBox strPromt, vbButtons, strTitle\nEnd Sub\n\nPrivate Function MsgBoxHookProc(ByVal lMsg As Long, _\n                                ByVal wParam As Long, _\n                                ByVal lParam As Long) As Long\n    If lMsg = HCBT_ACTIVATE Then\n        ' Change position\n        SetWindowPos wParam, 0, msgbox_x, msgbox_y, _\n                     0, 0, SWP_NOSIZE + SWP_NOZORDER\n\n        ' Release the Hook\n        UnhookWindowsHookEx hHook\n    End If\n\n    MsgBoxHookProc = False\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 8936435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16371e1c3266b8798e1cea03dd0f1a0?s=128&d=identicon&r=PG&f=1", "display_name": "DanJ", "link": "https://stackoverflow.com/users/8936435/danj"}, "edited": false, "score": 0, "creation_date": 1510929739, "post_id": 47317988, "comment_id": 81658468, "body": "This seems to be the way to go.  Atypical, as you said, yes.  But if it&#39;s effective, I&#39;m good.  Thanks!"}], "tags": [], "owner": {"reputation": 1253, "user_id": 4036218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5a98b5cd8145186c7adb64f0a87c9769?s=128&d=identicon&r=PG&f=1", "display_name": "DanielG", "link": "https://stackoverflow.com/users/4036218/danielg"}, "is_accepted": true, "score": 0, "last_activity_date": 1510785243, "last_edit_date": 1510785243, "creation_date": 1510783115, "answer_id": 47317988, "question_id": 47317631, "link": "https://stackoverflow.com/questions/47317631/access-vba-pop-up-sub-form-for-submission-of-entries/47317988#47317988", "title": "Access VBA Pop Up Sub Form for Submission of Entries", "body": "<p>This is an atypical approach, but not necessarily a wrong one. I don't see  why you would need the overhead of a sub_form though. Maybe just create a normal form (modal, no menu controls, no borders, etc., whatever looks pleasing to you) to serve as your Confirm Dialog, use a DoCmd.OpenForm from your Save button to open in (with modal attribute set), and then a DoCmd.MoveSize to move it, with parameters that are derived from the position of your button. </p>\n\n<pre><code>DoCmd.MoveSize cmdSaveButton.Left + cmdSaveButton.Height + 10, etc.\n</code></pre>\n\n<p>The Primary Save can happen from the Popup form calling a method in the originating form, and then closing itself.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-movesize-method-access\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-movesize-method-access</a></p>\n\n<p>Or use the form itself:</p>\n\n<pre><code>Form.Move Left:=11500, Top:=6500, Width:=7000, Height:=6000\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 8936435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d16371e1c3266b8798e1cea03dd0f1a0?s=128&d=identicon&r=PG&f=1", "display_name": "DanJ", "link": "https://stackoverflow.com/users/8936435/danj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 47317988, "answer_count": 3, "score": 0, "last_activity_date": 1510785243, "creation_date": 1510781662, "question_id": 47317631, "link": "https://stackoverflow.com/questions/47317631/access-vba-pop-up-sub-form-for-submission-of-entries", "title": "Access VBA Pop Up Sub Form for Submission of Entries", "body": "<p>Here's what I've got:\nI have an Access form that accepts entries, and places them into a table when the ENTER button is clicked.  At the moment, I have a popup message box that comes up when the button is clicked, asking them to confirm that their entries are ok (your standard pop up box, with OK and CANCEL options).  This popup box comes up right in the middle of the data that the user has entered, and is pretty inconvenient for the user to deal with.  </p>\n\n<p>Instead of this popup message box, I came up with the idea of using a pop-up SUB-FORM, that would lie invisible just under the ENTER button, and would come up visible when ENTER is clicked. (Same options as the message box, etc, just different placement.  Making the \"physical\" subform design was a no brainer).  Since this is a new form/subform, how would I code this in order to make it work like the message box did?  The old code won't work.  This is the best idea I could come up with.  If there's an even better way to accomplish this, I'm open to suggestions...</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "edited": false, "score": 0, "creation_date": 1510782568, "post_id": 47317637, "comment_id": 81586788, "body": "Thanks @tigervatar - that fixes my issue with the columns not hiding as required."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1510781698, "creation_date": 1510781698, "answer_id": 47317637, "question_id": 47317575, "link": "https://stackoverflow.com/questions/47317575/use-vba-to-hide-unhide-columns-named-ranges-in-a-table-based-on-selection-made/47317637#47317637", "title": "Use VBA to hide/unhide columns (named ranges) in a table based on selection made in a separate cell on a different sheet", "body": "<p>Your range selection is incorrect.  Instead of <code>Range(\"Fruits\", \"Months\").Select</code> you need to instead do <code>Range(\"Fruits, Months\").Select</code></p>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "edited": false, "score": 0, "creation_date": 1510784830, "post_id": 47318127, "comment_id": 81587927, "body": "Thanks @Scott Holtzman, the code is much cleaner and intuitive as well now. One issue i was still facing was being able to make the code work by having the target.address cell on a separate sheet. is this possible?Not sure if i should be creating a seperate question - but basically i need the dropdown cells (currently in B3) to be on a different sheet and/or associated to a command button or checkbox as there are multiple different views to select from"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "edited": false, "score": 0, "creation_date": 1510785434, "post_id": 47318127, "comment_id": 81588202, "body": "@ThomasTcred - to move it on another sheet, you&#39;d have to place the change code in that sheet and tie the ranges to hide to the sheet they are on. So, <code>Worksheets(&quot;Sheet1&quot;).Range(&quot;Fruits,Months&quot;).EntireColumn...</code>"}, {"owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "edited": false, "score": 0, "creation_date": 1510848881, "post_id": 47318127, "comment_id": 81620018, "body": "Thanks @Scott that worked for me as well. appreciate your help!"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510783640, "creation_date": 1510783640, "answer_id": 47318127, "question_id": 47317575, "link": "https://stackoverflow.com/questions/47317575/use-vba-to-hide-unhide-columns-named-ranges-in-a-table-based-on-selection-made/47318127#47318127", "title": "Use VBA to hide/unhide columns (named ranges) in a table based on selection made in a separate cell on a different sheet", "body": "<p>I would like to propose a re-write that will help you simplify the readability and maintainability of this code moving forward.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Address = \"$B$3\" Then \n        Range(\"Fruits,Months\").EntireColumn.Hidden = Target.Value = \"CustomView\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>To be clear, this should not be marked as answer, because tigeravatar already fixed your issue.</p>\n"}], "owner": {"reputation": 39, "user_id": 5004848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6144bf68b0253b3d68c57dcf540562b1?s=128&d=identicon&r=PG&f=1", "display_name": "ThomasTcred", "link": "https://stackoverflow.com/users/5004848/thomastcred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2336, "favorite_count": 0, "accepted_answer_id": 47317637, "answer_count": 2, "score": 0, "last_activity_date": 1510783640, "creation_date": 1510781399, "question_id": 47317575, "link": "https://stackoverflow.com/questions/47317575/use-vba-to-hide-unhide-columns-named-ranges-in-a-table-based-on-selection-made", "title": "Use VBA to hide/unhide columns (named ranges) in a table based on selection made in a separate cell on a different sheet", "body": "<p>I have a selection criteria cell on Sheet1 and have a table on Sheet 2. Sheet 1 Cell B3 will have a dropdown with different options. I want to be able to make a selection in this dropdown which will accordingly hide/unhide certain columns in the table on Sheet2. So far the code i have below is based on selections being made on the same sheet as the table and i'm stuck as the code isnt working as i expect it to.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Column = 2 And Target.Row = 3 And Target.Value = \"CustomView\" Then\n\nRange(\"Fruits\", \"Months\").Select\n\nApplication.Selection.EntireColumn.Hidden = True\n\nElse\n\nRange(\"Fruits\", \"Months\").Select\n\n\nApplication.Selection.EntireColumn.Hidden = False\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The named ranges i specified using the formulas section. \"Months\" is in column G, and \"Fruits\" is in column I, yet the code currently hides columns G, H and I, instead of just column G and column I. Furthermore, everytime i try to move the selection criteria to a separate sheet, i get errors. Any help or suggestions would be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1510781198, "post_id": 47317496, "comment_id": 81586103, "body": "That&#39;s a <b>Sub</b> not a <b>Function</b> that would return the <code>#name!</code> ERROR."}, {"owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1510781526, "post_id": 47317496, "comment_id": 81586264, "body": "So if I change it to a function it should work correctly? or will that ruin the rest of the code? Sorry I am a bit new to VBA."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1510781759, "post_id": 47317496, "comment_id": 81586375, "body": "There are a number of things wrong here not the least of which is that you have to open a worksheet before retrieving any information. However, some native worksheet functions will do that (by opening, retrieving and closing the worksheet for you)."}, {"owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1510781945, "post_id": 47317496, "comment_id": 81586474, "body": "At the moment this code takes the information from the worksheets on its own, all I have to do is run the macro from the developer tab. I dont actually have to open the worksheets, they just need to be saved in that folder referenced in the path. Any tips on how to make it work so that they stay blank when the file does not exist?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1510782188, "post_id": 47317496, "comment_id": 81586608, "body": "If you think you are taking information from a closed workbook then you are wrong. It is only at the level of overhead the opening and closing of the workbook this occurs."}, {"owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "edited": false, "score": 0, "creation_date": 1510782520, "post_id": 47317496, "comment_id": 81586766, "body": "Is it possible to do what I want with basic VBA knowledge? Or is it too complicated? Would you then recommend to just use a different type of table than a Pivot and filter the results so it does not show the error?"}], "answers": [{"tags": [], "owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "is_accepted": true, "score": 0, "last_activity_date": 1510783818, "creation_date": 1510783818, "answer_id": 47318170, "question_id": 47317496, "link": "https://stackoverflow.com/questions/47317496/no-value-when-document-isnt-found-in-vba-excel/47318170#47318170", "title": "No value when document isn&#39;t found in VBA excel", "body": "<p>Do this:</p>\n\n<pre><code>Range(\"D\" &amp; id).Value = \"=IFERROR('Y:\\Public\\QA Other\\Scorecards\\Scorecard \" &amp; JobNumber &amp; \".xlsm'!Total, '')\"\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8865215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c0470cf490976b7db6f93ad191d444ec?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/8865215/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 47318170, "answer_count": 1, "score": 0, "last_activity_date": 1510783818, "creation_date": 1510781070, "question_id": 47317496, "link": "https://stackoverflow.com/questions/47317496/no-value-when-document-isnt-found-in-vba-excel", "title": "No value when document isn&#39;t found in VBA excel", "body": "<p>right now I have code that works to get information from different workbooks into one master excel. However, when the document is not found it gives a #NAME error which is affecting a table that I need to present that data. I was trying to write if statements to fix this but have not been successful, I also tried to not make it by cell name but just the cell itself but got a #VALUE error. Is there a way to make that value blank if the document is not found? \nThanks for the help. \nThis is the code I have: </p>\n\n<pre><code>Sub ROI()\n\n Dim JobNumber As String\n Dim srcCell As String\n\n Dim id As Integer\n\n   For id = 4 To 156\n       srcCell = \"C\" &amp; id\n\n       JobNumber = Range(srcCell).Value\n\n       Range(\"D\" &amp; id).Value = \"='Y:\\Public\\QA Other\\Scorecards\\Scorecard \" &amp; JobNumber &amp; \".xlsm'!Total\"\n   Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510779270, "post_id": 47317024, "comment_id": 81585082, "body": "It&#39;s because you are going from top down instead from bottom up -- or your code needs to not increment the paragraph if a delete occurs. Imagine ten blank paragraphs at the top. First gets deleted, making #2 now #1. But your pointer now says #2... see the problem?"}, {"owner": {"reputation": 145, "user_id": 6267463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1916a1a8710ed9e53bc4e0d094a2cd?s=128&d=identicon&r=PG&f=1", "display_name": "JoshG", "link": "https://stackoverflow.com/users/6267463/joshg"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510779604, "post_id": 47317024, "comment_id": 81585278, "body": "I&#39;ve already accounted for the need to not increment, by using the num_of_deleted_paras variable. Also, if there&#39;s a string of empty paragraphs in the middle of the document, there doesn&#39;t seem to be a problem; it&#39;s specifically at the end that poses the problem--and some of them actually get deleted!"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510780208, "post_id": 47317024, "comment_id": 81585598, "body": "You can take a look at similar code I wrote that would delete blank paragraphs at the TOP of pages. All you would need to do is remove the &#39;Else Exit For&#39; and that should work -- assuming the other items are ok (blank pages, etc): See:  <a href=\"https://stackoverflow.com/questions/42659628/how-to-remove-top-blank-lines-in-vba-office-word\" title=\"how to remove top blank lines in vba office word\">stackoverflow.com/questions/42659628/&hellip;</a>"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510780432, "post_id": 47317024, "comment_id": 81585717, "body": "If your first para is blank, then second iteration of your for loop is 3 &gt; no_of _total paras. You are skipping para 2 from processing."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510780492, "post_id": 47317024, "comment_id": 81585747, "body": "By the way use <code>Find</code> to delete paras, its way faster than looping into paragraphs."}, {"owner": {"reputation": 145, "user_id": 6267463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1916a1a8710ed9e53bc4e0d094a2cd?s=128&d=identicon&r=PG&f=1", "display_name": "JoshG", "link": "https://stackoverflow.com/users/6267463/joshg"}, "edited": false, "score": 0, "creation_date": 1510781188, "post_id": 47317024, "comment_id": 81586098, "body": "The macro deletes the first paragraph on the page if it&#39;s empty. That is not a problem."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510784501, "post_id": 47317024, "comment_id": 81587771, "body": "Your code bails out early due to this line: &quot;If current_para_number + num_of_deleted_paras &gt; original_num_of_paras_in_doc Then&quot;  Also, you reset your &#39;paraRange&#39; for every paragraph..."}, {"owner": {"reputation": 145, "user_id": 6267463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1916a1a8710ed9e53bc4e0d094a2cd?s=128&d=identicon&r=PG&f=1", "display_name": "JoshG", "link": "https://stackoverflow.com/users/6267463/joshg"}, "edited": false, "score": 0, "creation_date": 1510786035, "post_id": 47317024, "comment_id": 81588435, "body": "The first line you mentioned checks to see if I&#39;ve processed every paragraph in the document. And the paraRange variable <i>needs</i> to be reset for each paragraph; that&#39;s how I check whether a given paragraph is empty or not."}], "answers": [{"comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 1, "creation_date": 1510826268, "post_id": 47318849, "comment_id": 81603808, "body": "Perhaps the OP&#39;s problem is related to paragraphs containing only blank spaces. If you LTrim the <code>Text</code> before checking its length your code would delete them, too."}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 4, "last_activity_date": 1510787252, "creation_date": 1510787252, "answer_id": 47318849, "question_id": 47317024, "link": "https://stackoverflow.com/questions/47317024/deleting-empty-paragraphs-in-word-using-vba-not-all-empty-paragraphs-deleted/47318849#47318849", "title": "Deleting Empty Paragraphs in Word Using VBA: Not All Empty Paragraphs Deleted", "body": "<p>This code will delete all blank paragraphs...</p>\n\n<pre><code>Sub RemoveBlankParas()\n    Dim oDoc        As Word.Document\n    Dim i           As Long\n    Dim oRng        As Range\n    Dim lParas      As Long\n\n    Set oDoc = ActiveDocument\n    lParas = oDoc.Paragraphs.Count          ' Total paragraph count\n    Set oRng = ActiveDocument.Range\n\n    For i = lParas To 1 Step -1\n        oRng.Select\n        lEnd = lEnd + oRng.Paragraphs.Count                         ' Keep track of how many processed\n        If Len(ActiveDocument.Paragraphs(i).Range.Text) = 1 Then\n            ActiveDocument.Paragraphs(i).Range.Delete\n        End If\n    Next i\n\n    Set para = Nothing\n    Set oDoc = Nothing\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 1, "last_activity_date": 1510926213, "creation_date": 1510926213, "answer_id": 47352032, "question_id": 47317024, "link": "https://stackoverflow.com/questions/47317024/deleting-empty-paragraphs-in-word-using-vba-not-all-empty-paragraphs-deleted/47352032#47352032", "title": "Deleting Empty Paragraphs in Word Using VBA: Not All Empty Paragraphs Deleted", "body": "<p>You can replace the paragraph marks:</p>\n\n<pre><code>ActiveDocument.Range.Find.Execute FindText:=\"^p^p\", ReplaceWith:=\"^p\", Replace:=wdReplaceAll\n\nActiveDocument.Range.Find.Execute \"^p^p\", , , , , , , , , \"^p\", wdReplaceAll ' might be needed more than once \n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6267463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1916a1a8710ed9e53bc4e0d094a2cd?s=128&d=identicon&r=PG&f=1", "display_name": "JoshG", "link": "https://stackoverflow.com/users/6267463/joshg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3593, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1510926213, "creation_date": 1510779130, "question_id": 47317024, "link": "https://stackoverflow.com/questions/47317024/deleting-empty-paragraphs-in-word-using-vba-not-all-empty-paragraphs-deleted", "title": "Deleting Empty Paragraphs in Word Using VBA: Not All Empty Paragraphs Deleted", "body": "<p>I wrote a macro to delete all the empty paragraphs in my document, but it exhibits weird behavior: If there are a number of empty paragraphs at the very end of the document, about half of them are deleted. Repeatedly running the macro gradually eliminates the empty paragraphs until only one empty paragraph remains. Even if there is a boundary condition so that I need a line of code to delete the last paragraph, but I still don't understand why only half of the empty paragraphs at the end are deleted. Can anyone explain why this is happening and how to correct this behavior? As an aside, I searched online and saw numerous posts about detecting paragraph markers (^p, ^13, and others, but only searching vbCr worked, which is another minor puzzle.)</p>\n\n<pre><code>Sub Delete_Empty__Paras_2() 'This macro looks for empty paragraphs and deletes them.\nDim original_num_of_paras_in_doc As Integer\nDim num_of_deleted_paras As Integer\n\noriginal_num_of_paras_in_doc = ActiveDocument.Paragraphs.Count 'Count the number of paragraphs in the document to start\nnum_of_deleted_paras = 0 'In the beginning, no paragraphs have been deleted\n\nSelection.HomeKey Unit:=wdStory 'Go to the beginning of the document.\nFor current_para_number = 1 To original_num_of_paras_in_doc 'Process each paragraph in the document, one by one.\n    If current_para_number + num_of_deleted_paras &gt; original_num_of_paras_in_doc Then 'Stop processing paragraphs when the loop has processed every paragraph.\n        Exit For\n    Else 'If the system just deleted the 3rd paragraph of the document because\n        ' it's empty, the next paragraph processed is the 3rd one again,\n        'so when we iterate the counter, we have to subtract the number of deleted paragraphs to account for this.\n        Set paraRange = ActiveDocument.Paragraphs(current_para_number - num_of_deleted_paras).Range\n        paratext = paraRange.Text\n        If paratext = vbCr Then 'Is the paragraph empty? (By the way, checking for vbCr is the only method that worked for checking for empty paras.)\n            paratext = \"\" 'Delete the paragraph.\n            ActiveDocument.Paragraphs(current_para_number - num_of_deleted_paras).Range.Text = paratext\n            num_of_deleted_paras = num_of_deleted_paras + 1 'Iterate the count of deleted paras.\n        End If\n    End If\nNext current_para_number\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1510781425, "post_id": 47316947, "comment_id": 81586219, "body": "Why don&#39;t you create a new worksheet based on the template and fill that out?"}, {"owner": {"reputation": 711, "user_id": 1922959, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7c568527a3fe1c7c82a7332a206c6ada?s=128&d=identicon&r=PG", "display_name": "jerH", "link": "https://stackoverflow.com/users/1922959/jerh"}, "edited": false, "score": 0, "creation_date": 1510856542, "post_id": 47316947, "comment_id": 81624994, "body": "That&#39;s exactly what I do...I copy the template worksheet, which has the protections I want set. I unprotect the new copy for a second to populate some title fields and add the &quot;done editing&quot; button, then re-protect it.  The weird behavior is the way it tells me the cell is locked when it isn&#39;t, but if i click on another sheet and then come back, it works properly"}, {"owner": {"reputation": 711, "user_id": 1922959, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7c568527a3fe1c7c82a7332a206c6ada?s=128&d=identicon&r=PG", "display_name": "jerH", "link": "https://stackoverflow.com/users/1922959/jerh"}, "edited": false, "score": 0, "creation_date": 1510933453, "post_id": 47316947, "comment_id": 81660996, "body": "Further update.  This issue only appears to happen at work where we have Excel 2013.  I have anewer version at home and everything works as it should.  Any ideas as to how to get around this? I have tried having the code activate other sheets and then come back to the newly copied sheet (trying to mimic the click over/click back solution in code) but that doesn&#39;t seem to do it.  It&#39;s looks pretty Mickey Mouse if I have to tell my users to do that manually..."}], "owner": {"reputation": 711, "user_id": 1922959, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7c568527a3fe1c7c82a7332a206c6ada?s=128&d=identicon&r=PG", "display_name": "jerH", "link": "https://stackoverflow.com/users/1922959/jerh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1510778824, "creation_date": 1510778824, "question_id": 47316947, "link": "https://stackoverflow.com/questions/47316947/issue-with-sheet-protection", "title": "Issue with sheet protection", "body": "<p>I am building a tool where users can create sheets for their individual projects that will later be used to automatically generate powerpoint slides. Everything worked great until I tried to add sheet protection to limit their editing to only the input cells required...</p>\n\n<p>Here is the template sheet that gets copied with a new name whenever they add a new project</p>\n\n<p><a href=\"https://i.stack.imgur.com/XL6rc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XL6rc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see the sheet is protected, but I can edit the cells I need (D2 for example) because they're not locked</p>\n\n<p><a href=\"https://i.stack.imgur.com/NRhat.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NRhat.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After I gather some user inputs via a form, I copy the template sheet to a new sheet in the same workbook with this code...wsShortBlank is the template sheet</p>\n\n<pre><code>wsShortBlank.Visible = xlSheetVisible\n    With ThisWorkbook\n        wsShortBlank.Copy After:=.Sheets(.Sheets.Count)\n        Set sh = ActiveSheet        'the copied sheet should be the active one, so grab a handle to it\n    End With\n    wsShortBlank.Visible = xlSheetVeryHidden\n\n    sh.Name = txtPE.Value &amp; \" \" &amp; txtPEC.Value\n\n    Unload Me\n\n    With sh\n        .Activate\n\n        .Unprotect password:=myPassword\n\n        'add done editing button\n        .Buttons.Add(468.75, 30, 210.75, 60.75).Select\n        Selection.OnAction = \"doneEditing\"\n        Selection.Characters.Text = \"Done Editing\"\n\n        'populate the data we know\n        .Range(\"B33\").Value = comboClass.Value\n        .Range(\"B34\").Value = txtPE.Value\n        .Range(\"B35\").Value = txtPEC.Value\n        .Range(\"B36\").Value = txtTask.Value\n\n        .Protect password:=myPassword\n\n        .Range(\"D2\").Select   'stick the cursor in the first input field\n    End With\n\n    Application.ScreenUpdating = True\n</code></pre>\n\n<p>I now have this sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/uWBFP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uWBFP.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The Done Editing button links to a sub that hides the current sheet and reshows the main menu form</p>\n\n<p>But if I attempt to edit cell D2, I get this</p>\n\n<p><a href=\"https://i.stack.imgur.com/XcZtv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XcZtv.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As if the cell is locked. BUT, if I click over to another sheet and then click back to this sheet, I can edit cell D2 just fine.</p>\n\n<p>What gives?</p>\n\n<p>As an update, I also modified the code so that after copying the sheet it went through and individually set the locked properties of the cells..so this was added toward the end of the above code block</p>\n\n<pre><code>        .Range(\"D2:D7\").Locked = False\n        .Range(\"D11:D12\").Locked = False\n        .Range(\"C17:J19\").Locked = False\n        .Range(\"C23:G23\").Locked = False\n        .Range(\"D24:H24\").Locked = False\n        .Range(\"E25:I25\").Locked = False\n        .Range(\"F26:J26\").Locked = False\n        .Range(\"B30:G30\").Locked = False\n\n\n        .Protect password:=myPassword\n</code></pre>\n\n<p>But it made no difference.</p>\n"}, {"tags": ["excel", "vba", "indexing", "match"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510778543, "post_id": 47316743, "comment_id": 81584643, "body": "So all this code, for what essentially boils down to &quot;Why does <code>=IFERROR(INDEX(Sheet1!RC[-3],(MATCH(RC[1],Sheet1!C[-1],0))),&zwnj;&#8203;&quot;False&quot;)</code> return FALSE?&quot; ...try evaluating the function in Excel, your <code>Index&#47;Match</code> is throwing an error. FWIW I would avoid R1C1 notation."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1510778549, "post_id": 47316743, "comment_id": 81584647, "body": "&quot;It searches for the values in Column C on the first worksheet on the second sheet (always called Sheet1)&quot;.  Unless I am reading your code wrong, your <code>MATCH(RC[1],Sheet1!C[-1],0)</code> is trying to match the value in column E of the active sheet, with the values in column C of Sheet1.  Is that what your sentence is saying?"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510780717, "post_id": 47316743, "comment_id": 81585866, "body": "Why are you selecting ranges that you can directly call? Or making a cell formula equal ro a string? Range(&quot;D1&quot;).Select ActiveCell.FormulaR1C1 = &quot;GroupFileName&quot;   Should be  Range(&quot;D1&quot;).value = &quot;GroupFileName&quot;"}, {"owner": {"reputation": 1, "user_id": 4996233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cddc58254edfa7ec41abd3c6dbe6320f?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gerard-Little", "link": "https://stackoverflow.com/users/4996233/cory-gerard-little"}, "edited": false, "score": 0, "creation_date": 1510781118, "post_id": 47316743, "comment_id": 81586063, "body": "mooseman - Thank you, I&#39;ve made that change.  YowE3K - Good catch. Changing that &quot;RC[1]&quot; to &quot;RC[-1]&quot; (now referencing the intended cell in Column C) doesn&#39;t have any effect on the result however."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4996233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cddc58254edfa7ec41abd3c6dbe6320f?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gerard-Little", "link": "https://stackoverflow.com/users/4996233/cory-gerard-little"}, "edited": false, "score": 0, "creation_date": 1510782852, "post_id": 47317869, "comment_id": 81586949, "body": "I decided to strip this down to just the formula and work backwards from that simpler starting point.   This is a ridiculously simple question, I realize, but I can&#39;t figure out how to get this formula to reference the cell two columns to the left of the result it finds. In the formula below, it&#39;s returning the value two rows above the result. I understand that &quot;-2&quot; in this context means two rows above, but what would be the syntax for two columns to the left in this formula?      =IFERROR(INDEX(Sheet1!C$2:C$2000, MATCH($C2,Sheet1!C$2:C$2000,0))-2),&quot;False&quot;)"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510782542, "creation_date": 1510782542, "answer_id": 47317869, "question_id": 47316743, "link": "https://stackoverflow.com/questions/47316743/iferror-index-match-formula-that-was-formerly-working-now-returns-all-false-resu/47317869#47317869", "title": "Iferror/Index/Match formula that was formerly working now returns all False results despite values existing on target sheet", "body": "<p>Based on your code, since you are always putting the formula in the same column, this worked for me. </p>\n\n<pre><code>With ActiveSheet\n strFormula = \"=IFERROR(INDEX(Sheet1!A2,(MATCH(E2,Sheet1!C:C,0))),\"\"False\"\")\"\n 'inserts column \"GroupFileName\" as column D\n Columns(\"D:D\").Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\n Range(\"D1\").Value = \"GroupFileName\"\n Columns(\"D:D\").EntireColumn.AutoFit\n ' Fills cell D2 and then autofills column D to end of spreadsheet\n .Range(\"D2\").Formula = strFormula\n .Range(\"D2:D\" &amp; LastRow).FillDown\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4996233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cddc58254edfa7ec41abd3c6dbe6320f?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gerard-Little", "link": "https://stackoverflow.com/users/4996233/cory-gerard-little"}, "is_accepted": false, "score": 0, "last_activity_date": 1510784857, "creation_date": 1510784857, "answer_id": 47318393, "question_id": 47316743, "link": "https://stackoverflow.com/questions/47316743/iferror-index-match-formula-that-was-formerly-working-now-returns-all-false-resu/47318393#47318393", "title": "Iferror/Index/Match formula that was formerly working now returns all False results despite values existing on target sheet", "body": "<p>Wow, so this ended up being a lot simpler than I was making it. I got caught up in trying to automate this with a macro, when a simple paste formula &amp; autofill workflow is just as easy. The formula below works perfectly. </p>\n\n<p>=IFERROR(INDEX(Sheet1!A$2:A$2000,(MATCH($C2,Sheet1!C$2:C$2000,0))),\"False\")</p>\n"}], "owner": {"reputation": 1, "user_id": 4996233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cddc58254edfa7ec41abd3c6dbe6320f?s=128&d=identicon&r=PG&f=1", "display_name": "Cory Gerard-Little", "link": "https://stackoverflow.com/users/4996233/cory-gerard-little"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510784857, "creation_date": 1510778005, "question_id": 47316743, "link": "https://stackoverflow.com/questions/47316743/iferror-index-match-formula-that-was-formerly-working-now-returns-all-false-resu", "title": "Iferror/Index/Match formula that was formerly working now returns all False results despite values existing on target sheet", "body": "<p>I wrote a macro some time ago to search for values from one spreadsheet (Data) on another spreadsheet (Sheet1), then pull the value from the cell 2 columns to the left of where the result was found on Sheet1. It was working great, but something seems to have changed(???) and it's now returning all \"False\" results, despite the fact that the values certainly exist in both spreadsheets. </p>\n\n<p>It searches for the values in Column C on the first worksheet on the second sheet (always called Sheet1)</p>\n\n<p>I can provide the spreadsheets in question for any testing.\nMy annotated code is below, any help would be greatly appreciated: </p>\n\n<pre><code>Sub GroupFileNameFix()\n'\n' GroupFileNameFix Macro\n\n'define variable types\nDim strFormula As Variant\nDim LastRow As Long\n\n'on Data sheet\nWith ActiveSheet\n' determines last row on spreadsheet and saves value to variable \"LastRow\"\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n   'sets variable \"strFormula\" as what we want to autofill, grabbing group filenames\nstrFormula = \"=IFERROR(INDEX(Sheet1!RC[-3],(MATCH(RC[1],Sheet1!C[-1],0))),\"\"False\"\")\"\n'inserts column \"GroupFileName\" as column D\nColumns(\"D:D\").Select\nSelection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove\nRange(\"D1\").Select\nActiveCell.FormulaR1C1 = \"GroupFileName\"\nColumns(\"D:D\").EntireColumn.AutoFit\n' Fills cell D2 and then autofills column D to end of spreadsheet\nRange(\"D2:D2\").Select\n.Range(\"D2:D2\").Formula = strFormula\n.Range(\"D2:D\" &amp; LastRow).FillDown\nEnd With\n'Commit formula to text and replace \"png\" with \"jpg\"\nColumns(\"D:D\").Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSelection.Replace What:=\"png\", Replacement:=\"jpg\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "acrobat"], "comments": [{"owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "edited": false, "score": 2, "creation_date": 1510778117, "post_id": 47316486, "comment_id": 81584393, "body": "There is some documentation available here: <a href=\"http://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/VBJavaScript.pdf\" rel=\"nofollow noreferrer\">adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/&hellip;</a> I tried it in vba but got a 429 error which this: <a href=\"https://stackoverflow.com/questions/28677288/vba-acrobat-run-time-error-429-activex-component-cant-create-object\" title=\"vba acrobat run time error 429 activex component cant create object\">stackoverflow.com/questions/28677288/&hellip;</a> describes as being because I&#39;ve only got the free version of Acrobat installed. You may have more luck with Pro."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 3, "creation_date": 1510778343, "post_id": 47316486, "comment_id": 81584538, "body": "Here is a link to someone that seems to have solved your problem.  It requires Pro. <a href=\"http://www.myengineeringworld.net/2013/10/read-and-write-pdf-forms-from-excel-vba.html\" rel=\"nofollow noreferrer\">myengineeringworld.net/2013/10/&hellip;</a>"}, {"owner": {"reputation": 11, "user_id": 8616713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/830a133752ae1923809f1fbcb4343f41?s=128&d=identicon&r=PG&f=1", "display_name": "fogharty", "link": "https://stackoverflow.com/users/8616713/fogharty"}, "edited": false, "score": 0, "creation_date": 1511211207, "post_id": 47316486, "comment_id": 81755286, "body": "The page mooseman linked to was a big help; it&#39;ll take me some work to finesse the script, however. I&#39;m too new at this. :^)"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 11984156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e654793411a69c92d8674b34ca89ea67?s=128&d=identicon&r=PG&f=1", "display_name": "Johann", "link": "https://stackoverflow.com/users/11984156/johann"}, "is_accepted": false, "score": 0, "last_activity_date": 1606845220, "last_edit_date": 1606845220, "creation_date": 1594647647, "answer_id": 62877128, "question_id": 47316486, "link": "https://stackoverflow.com/questions/47316486/export-data-from-excel-to-pdf-form-without-saving-it-as-csv-or-other-file-first/62877128#62877128", "title": "Export data from Excel to pdf form without saving it as .csv or other file first", "body": "<p>You can create an UTF-8 XML text file and import it easily into the PDF.\nHere is a function I wrote to create the XML file.</p>\n<p>The function creates an XFDX, inside the header of the file, the PDF file is specified.</p>\n<p>You can just double click the XFDX file, and adobe reader will import the data.</p>\n<pre><code>Private Function CreatePDFFile(PDFileID As Integer) As Boolean\nDim sFileHeader As String\nDim sFileFooter As String\nDim sFileFields As String\nDim sTmp As String\nDim sFileName As String\nDim lngFileNum As Long\nDim FieldName, FieldValue As String\nDim row, PDFRowStart, PDFRowEnd, PDFNumberOfRows, RetVal As Integer\nDim doc As New MSXML2.DOMDocument60\nOn Error GoTo ErrorHandler_CreatePDFFile\n    \n    'If errors then Use late binding to avoid error user-defined type not defined (References)\n    'Dim doc As Variant\n    'Set doc = CreateObject(&quot;MSXML2.DOMDocument&quot;)\n    \n    If Len(PDFFilePath(PDFileID)) &lt; 1 Then\n       ' MsgBox &quot;W\u00e4hlen Sie zuerst eine Datei aus. F\u00fcr diese  PDF-Datei-ID: &quot; &amp; PDFileID\n       'If no file selected for this PDFFile ID then do nothing...\n       CreatePDFFile = False\n        Exit Function\n    Else\n        'Continue to create list of selected PDF docs further here in this sub.\n        CreatePDFFile = True\n    End If\n    \n    'Locaion of PDF File\n    'PDFFile1Path\n    'sFileName = &quot;D:\\OneDrive\\PDF\\Try6\\&quot; &amp; &quot;NameOfPDFFile.pdf&quot;\n    'Adobe, use this path to open the correct PDF to import the data into.\n    Dim temp As String\n    temp = PDFFilePath(PDFileID) '&amp; &quot;\\&quot; &amp; PDFFileName(PDFileID)\n    \n    sFileHeader = &quot;&lt;?xml version=&quot;&quot;1.0&quot;&quot; encoding=&quot;&quot;UTF-8&quot;&quot;?&gt;&quot; &amp; vbCrLf &amp; _\n                  &quot;&lt;xfdf xmlns=&quot;&quot;http://ns.adobe.com/xfdf/&quot;&quot; xml:space=&quot;&quot;preserve&quot;&quot;&gt;&quot; &amp; vbCrLf &amp; _\n                  &quot;     &lt;f href=&quot;&quot;&quot; &amp; temp &amp; &quot;&quot;&quot;/&gt;&quot; &amp; vbCrLf &amp; _\n                  &quot;     &lt;fields&gt;&quot; &amp; vbCrLf\n\n    sFileFooter = &quot;    &lt;/fields&gt;&quot; &amp; vbCrLf &amp; _\n                  &quot;    &lt;ids original=&quot;&quot;31686985C2863CD11CFF58ED2604C831&quot;&quot; modified=&quot;&quot;6592384A5ED5A44484C99A887E1D71CE&quot;&quot;/&gt;&quot; &amp; vbCrLf &amp; _\n                  &quot;&lt;/xfdf&gt;&quot;\n    \n    'Example XML field value pair\n    ' sFileFields = &quot;     &lt;field name=&quot;&quot;ClientName&quot;&quot;&gt;&quot; &amp; vbCrLf &amp; _\n    '               &quot;         &lt;value&gt;Firstname Lastname&lt;/value&gt;&quot; &amp; vbCrLf &amp; _\n    '               &quot;     &lt;/field&gt;&quot; &amp; vbCrLf\n    \n\n    'Determine the start for of data in Excel for this file\n    'Start row is marked with a nammed called cell PDFFile1StartRow\n    If Not NamedRangeExists(ActiveWorkbook.Names, &quot;PDFFile&quot; &amp; PDFileID &amp; &quot;StartRow&quot;) Then\n        MsgBox &quot;Remember to define the start row named cell! &quot; &amp; &quot;PDFFile&quot; &amp; PDFileID &amp; &quot;StartRow&quot;\n        Exit Function\n    Else\n        'Set the PDFRowStart to the row number of the named field found\n        PDFRowStart = Range(&quot;PDFFile&quot; &amp; PDFileID &amp; &quot;StartRow&quot;).row\n    End If\n    \n    'Determine the end row for of data in Excel for this file\n    'Strat end is marked with a nammed cell called PDFFile1EndRow\n    If Not NamedRangeExists(ActiveWorkbook.Names, &quot;PDFFile&quot; &amp; PDFileID &amp; &quot;EndRow&quot;) Then\n        MsgBox &quot;Remember to define the end row named cell! &quot; &amp; &quot;PDFFile&quot; &amp; PDFileID &amp; &quot;EndRow&quot;\n        Exit Function\n    Else\n        'Set the PDFRowEnd to the row number of the named field found\n        PDFRowEnd = Range(&quot;PDFFile&quot; &amp; PDFileID &amp; &quot;EndRow&quot;).row\n    End If\n    \n    'How many rows of data are there for this file to loop through?\n    PDFNumberOfRows = PDFRowEnd - PDFRowStart\n        \n    'Loop through all the rows of data for this specific PDF file, and create a new xml field for each row.\n    For row = PDFRowStart To PDFRowStart + PDFNumberOfRows\n        \n        On Error GoTo ErrorHandler_CreatePDFFile\n        'The first column contains the name of the field in the PDF document, the second column the value\n        FieldName = Worksheets(&quot;PDF&quot;).Cells(row, 1).value\n        FieldValue = Worksheets(&quot;PDF&quot;).Cells(row, 2).value\n\n        'Encode text to xml, encode special characters like ampersands.\n        FieldName = doc.createTextNode(FieldName).XML\n        FieldValue = doc.createTextNode(FieldValue).XML\n\n        'Add a new field node in the xml document.\n        sFileFields = sFileFields &amp; &quot;     &lt;field name=&quot;&quot;&quot; &amp; FieldName &amp; &quot;&quot;&quot;&gt;&quot; &amp; vbCrLf &amp; _\n                        &quot;         &lt;value&gt;&quot; &amp; FieldValue &amp; &quot;&lt;/value&gt;&quot; &amp; vbCrLf &amp; _\n                        &quot;     &lt;/field&gt;&quot; &amp; vbCrLf\n    Next row\n    \n    'Combine the header content and footer to create the complete XML File\n    sTmp = sFileHeader &amp; sFileFields &amp; sFileFooter\n    'Debug.Print sTmp\n    \n    ' Set the path of the XML file to be written disk\n    'sFileName = ActiveWorkbook.Path &amp; &quot;\\&quot; &amp; PDFFileName(PDFileID) &amp; &quot;.xfdf&quot;\n    'save it to the same path as the PDF file,just change the extension to . xfdf\n    sFileName = PDFFilePath(PDFileID) &amp; &quot;.xfdf&quot;\n    \n    'Load the xml text into the MSXML2.DOMDocument60, and parse it to see if valid\n    doc.LoadXML (sTmp)\n    \n    If doc.parseError &lt;&gt; 0 Then\n        MsgBox &quot;0x&quot; &amp; Hex(doc.parseError) &amp; &quot;: &quot; &amp; doc.parseError.reason\n        Exit Function\n    End If\n\n    'Save the XML file to disk in utf-8 file format\n    doc.Save (sFileName)\n    \n    'Destroy the object, release the file to be deleted.\n    Set doc = Nothing\n    \n    DoEvents\n        \n    'Wait one second to give it time to save the file completely\n    Application.Wait Now + #12:00:03 AM#\n       \n    ' Open XFDX file as PDF\n    OpenXMLFile (sFileName)\n    \n    DoEvents\n    \n    Exit Function\n\nErrorHandler_CreatePDFFile:\n    \n    If Err.Number = 13 Then\n            MsgBox &quot;Error number: &quot; &amp; Err.Number &amp; &quot; Description: &quot; &amp; Err.Description &amp; &quot; Error in data in row: &quot; &amp; row\n        Exit Function\n    End If\n    MsgBox &quot;Make xfdf Error: &quot; + Str(Err.Number) + &quot; &quot; + Err.Description + &quot; &quot; + Err.Source\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8616713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/830a133752ae1923809f1fbcb4343f41?s=128&d=identicon&r=PG&f=1", "display_name": "fogharty", "link": "https://stackoverflow.com/users/8616713/fogharty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 716, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1606845220, "creation_date": 1510776995, "last_edit_date": 1592644375, "question_id": 47316486, "link": "https://stackoverflow.com/questions/47316486/export-data-from-excel-to-pdf-form-without-saving-it-as-csv-or-other-file-first", "title": "Export data from Excel to pdf form without saving it as .csv or other file first", "body": "<p>I have a very complicated Excel workbook, and on one of the worksheets my boss would like some values placed in an Acrobat form.</p>\n<p>I was able to find and edit a macro (I found <a href=\"https://stackoverflow.com/questions/19185260/open-a-pdf-using-vba-in-excel\">here</a>) that would open a blank version of the form.</p>\n<p>I've been asked to find a way to then have form fields in the Acrobat template auto fill from matching headers in the Excel worksheet (provided one field was filled out as a starting point) but <strong>without</strong> saving the Excel sheet to .csv to tab-delineated or whatever as an intermittent step.</p>\n<p>Or, conversely, make a macro in the Excel sheet that will take the values from, say,  the current row and open then fill the Acrobat form.</p>\n<p>Is this do-able from within either Excel or Acrobat Pro?</p>\n<p>I do not know java or Visual Basic very well, so please be patient.</p>\n<p>Any help you can offer will be greatly appreciated.</p>\n<p>Thank you.</p>\n"}, {"tags": ["vba", "ms-access", "for-loop", "pdf-generation", "ms-access-2013"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510776706, "post_id": 47316375, "comment_id": 81583639, "body": "Did you already tried in a different machine?"}, {"owner": {"reputation": 11, "user_id": 8947487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2599110474b9e7417fdb532cfd00c5a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jafar", "link": "https://stackoverflow.com/users/8947487/jafar"}, "edited": false, "score": 0, "creation_date": 1510776869, "post_id": 47316375, "comment_id": 81583720, "body": "Yes, I have tried on 2 machines and am getting the same error."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510777786, "post_id": 47316375, "comment_id": 81584206, "body": "I notice you don&#39;t have any error traps -- which may be useful to log what report it fails on. I would: (a) add an error trap and capture to a file; (b) add a timer delay of .2 seconds before and after your &quot;DoCmd.OpenReport&quot;. If that helps, then you can remove the full-time timer, trap the error in the error trap and issue a timer wait when it fails. Do you need to view each of these reports while running?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1510779004, "post_id": 47316375, "comment_id": 81584924, "body": "I had this same requirement, only for thousands of outputs. I couldn&#39;t do more than 5,000 per batch and I had 60,000+ records to run through (20 years worth of data). Never did figure out why and can only guess somehow memory was being occupied with something. This was a one-time process so did my dozen batch runs and done. Your code looks very much like mine and cannot see any cause for issue. I did not use a timer delay."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1510779680, "post_id": 47316375, "comment_id": 81585314, "body": "@June7  I&#39;m curious - yours ran to 5,000 without fail, while the OP&#39;s code randomly fails. You say your code is similar, but do you issue the &#39;OpenReport&#39; and no &#39;.Close&#39; for each of your 5,000?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1510779769, "post_id": 47316375, "comment_id": 81585369, "body": "I did close each report. I do wonder why OP shows that commented out."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1510781525, "post_id": 47316375, "comment_id": 81586263, "body": "Now is see the .Close outside the loop. Should be within the loop."}, {"owner": {"reputation": 11, "user_id": 8947487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2599110474b9e7417fdb532cfd00c5a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jafar", "link": "https://stackoverflow.com/users/8947487/jafar"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510845729, "post_id": 47316375, "comment_id": 81617684, "body": "@Wayne G. Dunn There is no need to view them at all. Opening the report was just the method I used to apply a parameter via VBA."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510847206, "post_id": 47316375, "comment_id": 81618771, "body": "I see you updated your post to say you added a timer and a close, but your posted code does not reflect that. Do you have any VBA code ANYWHERE in your report?  Does this issue happen with all three of the reports you could run?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1510850200, "post_id": 47316375, "comment_id": 81620977, "body": "You could try <a href=\"https://stackoverflow.com/a/47306097/3820271\">this method</a> for running <code>DoCmd.OutputTo acOutputReport</code> on a single-record report without using <code>DoCmd.OpenReport</code> before. But I have no idea if it will help."}, {"owner": {"reputation": 11, "user_id": 8947487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2599110474b9e7417fdb532cfd00c5a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jafar", "link": "https://stackoverflow.com/users/8947487/jafar"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510937288, "post_id": 47316375, "comment_id": 81663453, "body": "@WayneG.Dunn Timer and close were steps tried before I got frustrated enough to post this code. I have updated to include them commented out.  This issue only happens on reports 1 and 2, but given that report 3 is always run after the first two and is usually &lt;5 of the 100 reports run at the same time the sample size is pretty small. No reports have any VBA code."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1510939065, "post_id": 47316375, "comment_id": 81664505, "body": "One reason I suggested a timer BEFORE the &#39;OutputTo&#39; was just in case there was some background delay after the &#39;OpenReport&#39;, the wait may correct that. Hopefully your timer wasn&#39;t just something like &#39;Do until Timer &gt; PriorTime + nnn&#39;. I echo what @Andre posted about how to avoid opening the report by using a function. Personally, I would: (1) Close each report; (2) Put the delay after the &#39;OpenReport&#39;; and if those don&#39;t fix, then include Andre&#39;s suggestion."}, {"owner": {"reputation": 11, "user_id": 8947487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2599110474b9e7417fdb532cfd00c5a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jafar", "link": "https://stackoverflow.com/users/8947487/jafar"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1511186622, "post_id": 47316375, "comment_id": 81740654, "body": "@WayneG.Dunn Adding timer Before the &quot;OutputTo&#39; has removed any instance of the error. Now I am just getting an error for it being unable to open any more tables after running ~250. However, that is not the original question. Thank you."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1511187233, "post_id": 47316375, "comment_id": 81741041, "body": "Great. Now you can either play with decreasing the timer as small as possible or trap the error and then delay and resume. Re error opening 250 tables ( I think you mean reports?), did you already reinstate the CLOSE after EVERY output?"}], "owner": {"reputation": 11, "user_id": 8947487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2599110474b9e7417fdb532cfd00c5a9?s=128&d=identicon&r=PG&f=1", "display_name": "Jafar", "link": "https://stackoverflow.com/users/8947487/jafar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510936840, "creation_date": 1510776540, "last_edit_date": 1510936840, "question_id": 47316375, "link": "https://stackoverflow.com/questions/47316375/ms-access-2013-vba-auto-cancels-outputto-error-2501", "title": "MS Access 2013 VBA auto cancels OutputTo (Error 2501)", "body": "<p>I am trying to configure a function that will automatically generate a folder of pdfs for a user based on the user inputting the report type they want and a file path they want to save. \nSome notes:</p>\n\n<ul>\n<li>It is generally used to generate ~100 pdf reports based on a query\npulling data from a linked backend database table.</li>\n<li>CReport is a report name in the database programmatically assigned </li>\n<li>CPath is a folder selected using the file dialog </li>\n<li>Code runs perfectly fine multiple executions in a row if OutputTo line in code loop is commented out (unfortunately that is the whole point of this) </li>\n</ul>\n\n<blockquote>\n  <p>Error 2501\n  appears between 2-76 loop repetitions in, rarely at the same point\n     twice. Occasionally, the entire things runs, but I cannot hand off\n     something that runs only occasionally. \n   -</p>\n</blockquote>\n\n<ul>\n<li>Using Access 2013 on Windows 7.</li>\n<li>I have tried rebuilding the function, rebuilding the forms, decompiling, compact and repairing, adding a 2 second delay after outputting the report and changing where I put the close report command.</li>\n</ul>\n\n<p>Current code:</p>\n\n<pre><code>Sub RunThatReport(CReport As String, CPath As String)\n    'dimension variables\n    Dim dbs1 As Database, rst As Recordset\n    Dim Can8 As Double, vend As String\n    Dim Location As String, CFilePath As String\n    'create a filename\n    Select Case CReport\n        Case \"rpt_Form-1\"\n            Location = \"_Form-1.pdf\"\n            DoCmd.OutputTo acOutputReport, \"rpt_all_lines\", acFormatPDF, CPath &amp; \"\\Lines Required.pdf\", False\n        Case \"rpt_Form-2\"\n            Location = \"_Form-2.pdf\"\n        Case \"rpt_Form-3\"\n            Location = \"_Form-3.pdf\"\n        Case Else\n            Exit Sub\n    End Select\n    'Get the AN8 of all lines\n    Set dbs1 = CurrentDb\n    Set rst = dbs1.OpenRecordset(\"tbl_all_lines_to_run\", dbOpenDynaset)\n    rst.MoveFirst\n    'loop through the lines\n    Do While Not rst.EOF\n        If Not IsNull(rst!AN8) Then\n            Can8 = rst!AN8 'I know this assignment is not actually necessary\n            vend = Replace(Replace(Replace(Trim(rst!Name), \"/\", \"-\"), \"\\\", \"-\"), \".\", \"\")\n            'CFilePath = CPath &amp; \"\\\" &amp; vend &amp; Location\n            CFilePath = CPath &amp; \"\\\" &amp; Can8 &amp; Location\n            Debug.Print vend &amp; \": \" &amp; Can8 &amp; \" \" &amp; CFilePath 'This is my check to look at what was getting hung up\n            DoCmd.OpenReport CReport, acViewReport, , \"ABAN8 =\" &amp; rst!AN8 'open report only for that line type\n            DoCmd.OutputTo acOutputReport, CReport, acFormatPDF, CFilePath, False\n            'DoCmd.Close acReport, CReport, acSaveNo\n            'waiting (2) 'This was my delay function\n        End If\n        rst.MoveNext\n    Loop\n    rst.Close\n    Set rst = Nothing\n    dbs1.Close\n    DoCmd.Close acReport, CReport, acSaveNo\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1510774503, "post_id": 47315775, "comment_id": 81582499, "body": "Read this : <a href=\"http://www.cpearson.com/excel/byrefbyval.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/byrefbyval.aspx</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510776455, "post_id": 47315775, "comment_id": 81583536, "body": "@cyboashu OP&#39;s question seems to be more about <code>Test = Output1 + Output2</code>, which assigns the function&#39;s return value, which is assigned to <code>Ret</code> at the call site. Basically, &quot;function calls 101&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510776319, "post_id": 47315889, "comment_id": 81583453, "body": "Note that unlike (most?) other languages, in VB6/VBA the implicit default is <code>ByRef</code>, which means everything is passed by reference unless specified otherwise: unless you&#39;re purposely assigning to a parameter, you normally want them passed <code>ByVal</code>, by value."}, {"owner": {"reputation": 9, "user_id": 8251764, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c005033dcf27c51baac868ff36753ce?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/8251764/rick"}, "edited": false, "score": 1, "creation_date": 1510779257, "post_id": 47315889, "comment_id": 81585075, "body": "Could you please give little more information about ByRef that how it works."}], "tags": [], "owner": {"reputation": 829, "user_id": 8874545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c12a02d9db7220f4706846d46e9f36?s=128&d=identicon&r=PG&f=1", "display_name": "E. Villiger", "link": "https://stackoverflow.com/users/8874545/e-villiger"}, "is_accepted": true, "score": 1, "last_activity_date": 1510816158, "last_edit_date": 1510816158, "creation_date": 1510774738, "answer_id": 47315889, "question_id": 47315775, "link": "https://stackoverflow.com/questions/47315775/about-vba-code-returns-multiple-values/47315889#47315889", "title": "About VBA Code returns multiple values", "body": "<p><strong>Return value</strong></p>\n\n<p>Return values in VBA are done by setting the name of the function equal to a value. Example:</p>\n\n<pre><code>Function myFunction()\n    myFunction = 123\nEnd Function\n</code></pre>\n\n<p>When I call <code>myFunction</code>, I can assign the function's return value to a variable, e.g. like:</p>\n\n<pre><code>returnValue = myFunction\n</code></pre>\n\n<p><code>returnValue</code> will now have the value 123</p>\n\n<p>In your example, the function Test returns the result of <code>Output1 + Output2</code>:</p>\n\n<pre><code>Output1 + Output2 = 3 + (-1) = 2\n</code></pre>\n\n<p>Therefore, the function Test returns the value 2</p>\n\n<p><strong>ByRef/ByVal Parameters</strong></p>\n\n<p>The other thing that's going on here, are the two different types of parameters. </p>\n\n<p>Passing a parameter <strong><code>ByVal</code></strong> (by value) creates a copy of the variable and passes that copy into the function. Therefore, if I adjust the variable inside the function, its value in the caller function doesn't change. Example:</p>\n\n<pre><code>Function MyFunction(ByVal num)\n    num = 2\nEnd Function\n</code></pre>\n\n<p>and then I call the function like so:</p>\n\n<pre><code>count = 1\nCall MyFunction(count)\nMsgBox count\n</code></pre>\n\n<p>The MsgBox will display the number 1. The variable <code>count</code> was copied to a different variable (<code>num</code> inside MyFunction) and when <code>num</code> was assigned the value 2, <code>count</code> remained unchanged.</p>\n\n<p>Passing a parameter <strong><code>ByRef</code></strong> is the opposite: The parameter isn't copied, but passed directly (as a reference ~ as a \"link\") to the function.</p>\n\n<p>Let's look at the above MyFunction again, but imagine changing the parameter to ByRef instead of ByVal. In that case, <code>MsgBox count</code> will display the value 2. When we pass <code>count</code> ByRef to MyFunction, <code>num</code> becomes an alias of the same variable as <code>count</code> and when <code>num</code> is assigned the value 2, <code>count</code> is the same variable, so it also now has the value 2.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1510774798, "creation_date": 1510774798, "answer_id": 47315906, "question_id": 47315775, "link": "https://stackoverflow.com/questions/47315775/about-vba-code-returns-multiple-values/47315906#47315906", "title": "About VBA Code returns multiple values", "body": "<p><code>Ret</code> gets the value of the result of the <code>Test</code> Function</p>\n\n<pre><code>Ret = Test(Input1, Input2, Output1, Output2)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8251764, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8c005033dcf27c51baac868ff36753ce?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/8251764/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1495, "favorite_count": 0, "accepted_answer_id": 47315889, "answer_count": 2, "score": -2, "last_activity_date": 1510816158, "creation_date": 1510774282, "last_edit_date": 1531164843, "question_id": 47315775, "link": "https://stackoverflow.com/questions/47315775/about-vba-code-returns-multiple-values", "title": "About VBA Code returns multiple values", "body": "<p>I need help here to understand how and from where the variable Ret has the value \"2\".</p>\n\n<p>I am not able to understand this code, can someone help me please.</p>\n\n<pre><code>Function Test(ByVal Input1 As Integer, ByVal Input2 As Integer, _\n    ByRef Output1 As Integer, ByRef Output2 As Integer) As Integer\n\n      Output1 = Input1 + Input2\n      Output2 = Input1 - Input2\n      Test = Output1 + Output2\n\nEnd Function\n\nSub Test2()\n\n    Dim Ret As Integer, Input1 As Integer, Input2 As Integer, _\n    Output1 As Integer, Output2 As Integer\n    Input1 = 1\n    Input2 = 2\n    Ret = Test(Input1, Input2, Output1, Output2)\n    Sheet1.Range(\"A1\") = Ret     ' 2\n    Sheet1.Range(\"A2\") = Output1 ' 3\n    Sheet1.Range(\"A3\") = Output2 '-1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1510774335, "post_id": 47315364, "comment_id": 81582410, "body": "You should scrap the validation on Exit and validate any required field(s) just before the new records is inserted. See the answer in this post, it might help: <a href=\"https://stackoverflow.com/questions/43831524/access-code-mantantory-fields-in-a-form/43846842#43846842\" title=\"access code mantantory fields in a form\">stackoverflow.com/questions/43831524/&hellip;</a>"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1510778909, "post_id": 47315364, "comment_id": 81584872, "body": "You should put your combo box in the <b>header</b> of your form. Add an After Update event to your combo box in order to retrieve the data you&#39;re looking for."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1511048520, "post_id": 47315364, "comment_id": 81697191, "body": "I use AfterUpdate event of controls to validate input. Controls used to input search/filter criteria should be UNBOUND. And I agree it should be in header."}], "owner": {"reputation": 1, "user_id": 6575525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeb8ed2d29efe32c559f45ae3f1e1627?s=128&d=identicon&r=PG&f=1", "display_name": "ann v", "link": "https://stackoverflow.com/users/6575525/ann-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510778166, "creation_date": 1510772741, "last_edit_date": 1510778166, "question_id": 47315364, "link": "https://stackoverflow.com/questions/47315364/two-mandatory-fields-on-a-new-record-but-want-to-search-from-combobox", "title": "Two Mandatory Fields on a new record but want to search from combobox", "body": "<p>I'm relatively new to this and can't figure out how to fix this problem.</p>\n\n<p>I have a form that opens to a new record with two mandatory fields (txtIDNumber and txtDependentCode) and the cursor is in txtIDNumber.  On Exit for this field there is code in case data has not been entered:</p>\n\n<pre><code>Private Sub txtIDNumber_Exit(Cancel As Integer)\n\nIf IsNull(Me.txtIDNumber) Then\n    MsgBox \"This is a mandatory field.\"\n    DoCmd.CancelEvent\nEnd If\n\nMe.txtIDNumber.SetFocus\n\nEnd Sub\n</code></pre>\n\n<p>I also have a combobox that allows searching for records on this form.  That is where the problem is.  If I want to search and not enter a new record I can't because the mandatory field message appears when I try to click the combobox because I have a new record open and didn\u2019t enter the mandatory fields.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1510772165, "post_id": 47315137, "comment_id": 81581162, "body": "Well, you are missing the second half of the statement. <a href=\"https://msdn.microsoft.com/en-us/library/bb208861(v=office.12).aspx\" rel=\"nofollow noreferrer\">See here</a>"}, {"owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "edited": false, "score": 3, "creation_date": 1510772171, "post_id": 47315137, "comment_id": 81581166, "body": "I think you need a values statement after the insert, like here: <a href=\"https://stackoverflow.com/questions/1783486/ms-access-insert-into-statement\" title=\"ms access insert into statement\">stackoverflow.com/questions/1783486/&hellip;</a>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "edited": false, "score": 0, "creation_date": 1510772514, "post_id": 47315137, "comment_id": 81581371, "body": "@majjam feel free to write that as an answer, so we can see the question has been answered."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510772575, "post_id": 47315137, "comment_id": 81581414, "body": "updated the question. Adding values to that throws up another error on the next line. Saying Too few Parameters. Expected 12."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1510772702, "post_id": 47315137, "comment_id": 81581490, "body": "Those parameters don&#39;t correspond to the values you&#39;re setting. Take a minute, and use the parameters you are setting as values for your insert."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1510772808, "post_id": 47315137, "comment_id": 81581559, "body": "@ErikvonAsmuth I am sorry. I am a beginner to this. learning and working along. Could you please explain it in the answer section. Thanks"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1510772976, "post_id": 47315137, "comment_id": 81581670, "body": "No. You haven&#39;t supplied sufficient information for me to be sure I can answer it right (I don&#39;t have the table structure), and you&#39;ve only tried for two minutes after my last comment. Provide the table structure if you want me to answer."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1510773154, "post_id": 47315137, "comment_id": 81581784, "body": "@ErikvonAsmuth I am sorry. I am trying to solve this problem for the last 4 hours. I have added the table structure to the question"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510773200, "post_id": 47315137, "comment_id": 81581821, "body": "All text fields should be &quot;Short Text&quot;."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510773354, "post_id": 47315137, "comment_id": 81581897, "body": "@Gustav I tried short text in the table. But didn&#39;t help. Do I need to change the query in vba accordingly?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1510785283, "post_id": 47315137, "comment_id": 81588134, "body": "No, it was a general advice - or your parameter declarations don&#39;t make sense. Long Text should be avoided if not strictly needed."}], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510774228, "post_id": 47315738, "comment_id": 81582363, "body": "But I am not feeding the values from a table. I am feeding it from a variable. That&#39;s where I am struck."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510774616, "post_id": 47315738, "comment_id": 81582566, "body": "modified.  btw if you want to pass numbers in then eliminate the single quotes.  like if HeadRow is to be handled as an integer, is should be <code>&quot; + HeadRow + &quot;</code> instead of <code>&#39;&quot; + HeadRow + &quot;&#39;</code>."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510774975, "post_id": 47315738, "comment_id": 81582731, "body": "I see that it&#39;s an integer, I went ahead and removed the single quotes."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510776424, "post_id": 47315738, "comment_id": 81583522, "body": "It says Syntax error on the code tried both the cases of HeadRow as well !"}], "tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 0, "last_activity_date": 1510774945, "last_edit_date": 1510774945, "creation_date": 1510774149, "answer_id": 47315738, "question_id": 47315137, "link": "https://stackoverflow.com/questions/47315137/strsql-insert-into-throwing-an-error-in-vba/47315738#47315738", "title": "StrSQL Insert into throwing an error in VBA", "body": "<p>Your query is bad.</p>\n\n<p>This:</p>\n\n<pre><code>INSERT INTO ReportTypes ([BusinessUnit], \n                         [ReportName], \n                         [SheetName], \n                         [HeaderRow], \n                         [AdditionalInfo], \n                         [DateRequiredinfo]) \nVALUES (BuName, \n        RepName,  \n        ShtNamedec,  \n        HeadRow,  \n        AddInfo,  \n        DateInfo)\n</code></pre>\n\n<p>Will not work.</p>\n\n<p>Although this might:</p>\n\n<pre><code>\"INSERT INTO ReportTypes ([BusinessUnit], \n                         [ReportName], \n                         [SheetName], \n                         [HeaderRow], \n                         [AdditionalInfo], \n                         [DateRequiredinfo]) \nVALUES ('\" + BuName + \"', \n        '\" + RepName + \"',  \n        '\" + ShtNamedec + \"',  \n        \" + HeadRow + \",\n        '\" + AddInfo + \"',  \n        '\" + DateInfo + \"')\"\n</code></pre>\n\n<p>You can probably eliminate all that parameters assignment stuff.  I don't see it adding value here.</p>\n"}, {"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510776078, "post_id": 47315824, "comment_id": 81583315, "body": "It says syntax error missing operator in query expression on the select part. It happens on &#39; BUILD TEMP QUERYDEF &#39; line"}, {"owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510776732, "post_id": 47315824, "comment_id": 81583655, "body": "I think you may have added an extra semicolon after the INSERT INTO line. I&#39;ve updated my answer with a more complete example."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1510777005, "post_id": 47315824, "comment_id": 81583791, "body": "Finally ! Thanks a lot. I spent a day on this."}], "tags": [], "owner": {"reputation": 1141, "user_id": 945721, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6849e039022068a5d77d28215c49f2bb?s=128&d=identicon&r=PG", "display_name": "majjam", "link": "https://stackoverflow.com/users/945721/majjam"}, "is_accepted": true, "score": 1, "last_activity_date": 1510776762, "last_edit_date": 1510776762, "creation_date": 1510774446, "answer_id": 47315824, "question_id": 47315137, "link": "https://stackoverflow.com/questions/47315137/strsql-insert-into-throwing-an-error-in-vba/47315824#47315824", "title": "StrSQL Insert into throwing an error in VBA", "body": "<p>This query works with parameters for your data table design:</p>\n\n<pre><code>strSQL = \"PARAMETERS [BusinessUnitparam] TEXT(255), [ReportNameparam] TEXT(255),[SheetNameparam] TEXT(255), [HeaderRowparam] INTEGER, [AdditionalInfoparam] TEXT(255), [DateRequiredinfoparam] TEXT(255);\" _\n           &amp; \"INSERT INTO ReportTypes ([BusinessUnit], [ReportName], [SheetName], [HeaderRow], [AdditionalInfo], [DateRequiredinfo])\" _\n           &amp; \"SELECT BusinessUnitparam AS Expr1, ReportNameparam AS Expr2, SheetNameparam AS Expr3, HeaderRowparam AS Expr4, AdditionalInfoparam AS Expr5, DateRequiredInfoparam as Expr6;\"\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 47315824, "answer_count": 2, "score": 0, "last_activity_date": 1510776762, "creation_date": 1510771982, "last_edit_date": 1592644375, "question_id": 47315137, "link": "https://stackoverflow.com/questions/47315137/strsql-insert-into-throwing-an-error-in-vba", "title": "StrSQL Insert into throwing an error in VBA", "body": "<p>I am trying to Insert some new records in to an access database.</p>\n<p>Here is my code,</p>\n<pre><code>' OPEN ACCESS APPLICATION\n    Set objAccess = CreateObject(&quot;Access.Application&quot;)\n    objAccess.OpenCurrentDatabase DatabasePath\n\n ' OPEN INTERNAL DATABASE\n    Set db = objAccess.CurrentDb\n\n\nBuName = Ws.Sheets(&quot;Config&quot;).Range(&quot;T1&quot;).Value\nRepName = Ws.Sheets(&quot;Config&quot;).Range(&quot;T2&quot;).Value\nNumberofUniqueSheets = Ws.Sheets(&quot;Config&quot;).Range(&quot;T3&quot;).Value\n\nFor i = 1 To NumberofUniqueSheets\n\n    CmpValue = Ws.Sheets(&quot;Config&quot;).Range(&quot;U1&quot;).Value\n    ShtNamedec = Split(CmpValue, &quot;$&quot;)(0)\n    HeadRow = Split(CmpValue, &quot;$&quot;)(1)\n    AddInfo = Split(CmpValue, &quot;$&quot;)(2)\n    DateInfo = Split(CmpValue, &quot;$&quot;)(3)\n    \n    ' PREPARE STATEMENT\n    strSQL = &quot;PARAMETERS [BusinessUnitparam] TEXT(255), [ReportNameparam] TEXT(255),[SheetNameparam] TEXT(255), [HeaderRowparam] INTEGER, [AdditionalInfoparam] TEXT(255), [DateRequiredinfoparam] TEXT(255);&quot; _\n               &amp; &quot;INSERT INTO ReportTypes ([BusinessUnit], [ReportName], [SheetName], [HeaderRow], [AdditionalInfo], [DateRequiredinfo]);&quot;\n\n    ' BUILD TEMP QUERYDEF\n    Set qdef = db.CreateQueryDef(&quot;&quot;, strSQL)\n\n    ' BIND PARAMS TO VARIABLES\n    qdef!BusinessUnitparam = BuName\n    qdef!ReportNameparam = RepName\n    qdef!SheetNameparam = ShtNamedec\n    qdef!HeaderRowparam = HeadRow\n    qdef!AdditionalInfoparam = AddInfo\n    qdef!DateRequiredinfoparam = DateInfo\n\n    ' EXECUTE ACTION QUERY\n    qdef.Execute\n    \nNext\n\n    Set qdef = Nothing\n    Set db = Nothing\n    Set objAccess = Nothing\n</code></pre>\n<p>I am facing an error in the Build Temp QueryDef Statement and the error says `</p>\n<blockquote>\n<p>Syntax error in Insert into Statement.</p>\n</blockquote>\n<p>`\nI added the Values into the Insert Into the statement like below</p>\n<pre><code>strSQL = &quot;PARAMETERS [BusinessUnitparam] TEXT(255), [ReportNameparam] TEXT(255),[SheetNameparam] TEXT(255), [HeaderRowparam] INTEGER, [AdditionalInfoparam] TEXT(255), [DateRequiredinfoparam] TEXT(255);&quot; _\n               &amp; &quot;INSERT INTO ReportTypes ([BusinessUnit], [ReportName], [SheetName], [HeaderRow], [AdditionalInfo], [DateRequiredinfo]) VALUES (BuName, RepName, ShtNamedec, HeadRow, AddInfo, DateInfo);&quot;\n</code></pre>\n<p>But it gives another on Execute Action Query statement saying too few parameters expected 12. Here is the Table structure for reference -</p>\n<p><a href=\"https://i.stack.imgur.com/19jmb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/19jmb.jpg\" alt=\"ReportTypes\" /></a></p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510776912, "post_id": 47314818, "comment_id": 81583736, "body": "Why you answer your own question?"}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 0, "creation_date": 1510777800, "post_id": 47314818, "comment_id": 81584216, "body": "@DavidG. Answering your own question is completely acceptable on SO.  See this <a href=\"https://stackoverflow.com/help/self-answer\">link</a> However, I&#39;d suggest the OP change the question to not include the answer."}], "tags": [], "owner": {"reputation": 85, "user_id": 1899231, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/128a989a88b5e1bc95379365b24b12db?s=128&d=identicon&r=PG", "display_name": "user1899231", "link": "https://stackoverflow.com/users/1899231/user1899231"}, "is_accepted": false, "score": 1, "last_activity_date": 1510770813, "creation_date": 1510770813, "answer_id": 47314818, "question_id": 47314795, "link": "https://stackoverflow.com/questions/47314795/vba-select-specific-cell-in-powerpoint-table/47314818#47314818", "title": "VBA Select specific cell in PowerPoint table", "body": "<p>This is how you select a specific cell:</p>\n\n<p><code>PPSlide.Shapes(\"Table 4\").Table.Rows(2).Cells.Item(1).Select</code></p>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 0, "last_activity_date": 1519672951, "creation_date": 1519672951, "answer_id": 48995650, "question_id": 47314795, "link": "https://stackoverflow.com/questions/47314795/vba-select-specific-cell-in-powerpoint-table/48995650#48995650", "title": "VBA Select specific cell in PowerPoint table", "body": "<p>This is the correct way to select a single cell using its row and column properties:</p>\n\n<pre><code>PPSlide.Shapes(\"Table 4\").Table.Cell(Row:=2,Column:=1).Select\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 1899231, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/128a989a88b5e1bc95379365b24b12db?s=128&d=identicon&r=PG", "display_name": "user1899231", "link": "https://stackoverflow.com/users/1899231/user1899231"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3256, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1519672951, "creation_date": 1510770759, "last_edit_date": 1531164843, "question_id": 47314795, "link": "https://stackoverflow.com/questions/47314795/vba-select-specific-cell-in-powerpoint-table", "title": "VBA Select specific cell in PowerPoint table", "body": "<p>How do you select a specific cell in a PowerPoint table ?</p>\n\n<p>I need to paste into a PowerPoint table, including my Excel formatting, to a specific cell.</p>\n\n<p>Code is situated in Excel!</p>\n\n<p>Specifically, this is how you select a specific cell!</p>\n\n<pre><code>    PPSlide.Shapes(\"Table 4\").Table.Rows(2).Cells.Item(1).Select\n</code></pre>\n\n<p>This is an informational post, I couldn't figure out how to do it for a while, so I thought I'd add.t</p>\n\n<pre><code>Dim PPApp As PowerPoint.Application\nDim PPPres As PowerPoint.Presentation\nDim PPSlide As PowerPoint.Slide\n\nSet PPApp = GetObject(, \"Powerpoint.Application\")\nSet PPPres = PPApp.ActivePresentation\nDim sht as Worksheet\nSet sht = ThisWorkbook.Sheets(\"Local Channels National View\")\n\n   ''''''''COPY TEMPLATE SLIDE''''''''\n    ''duplicate template slide, move to end of presentation\n    Set slideR = PPPres.Slides(3).Duplicate\n    slideR.MoveTo (PPPres.Slides.Count)\n    Set PPSlide = PPPres.Slides(PPPres.Slides.Count)\n\n\n\n\n    sht.Range(\"B10:F14\").Copy\n\n    ''''select rows 2, column 1 cell\n    PPSlide.Shapes(\"Table 4\").Table.Rows(2).Cells.Item(1).Select\n\n    '''paste\n    PPApp.CommandBars.ExecuteMso (\"Paste\")\n</code></pre>\n\n<p>Resources:\nCellRange object - collection of cells, row or column\n<a href=\"https://msdn.microsoft.com/en-us/VBA/PowerPoint-VBA/articles/cellrange-object-powerpoint\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/VBA/PowerPoint-VBA/articles/cellrange-object-powerpoint</a></p>\n\n<p>Cell Object\n<a href=\"https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/cell-object-powerpoint\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/cell-object-powerpoint</a></p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510774141, "post_id": 47314492, "comment_id": 81582322, "body": "Is it throwing an error? What error, specifically?"}, {"owner": {"reputation": 1, "user_id": 8928547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427bb97fec94b50ffea1b4b0c4dc9c1d?s=128&d=identicon&r=PG&f=1", "display_name": "ASHISH GARG", "link": "https://stackoverflow.com/users/8928547/ashish-garg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510804442, "post_id": 47314492, "comment_id": 81593539, "body": "Its not throwing any error but navigating to only fist page when i am checking non stop option for second page."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1510804807, "post_id": 47314492, "comment_id": 81593632, "body": "Your code doesn&#39;t make any sense. <code>Next one</code> has no corresponding <code>For</code> block, it doesn&#39;t compile. I didn&#39;t spot it right away because of the broken <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indentation</a>, but you definitely removed something you thought was irrelevant, and it probably isn&#39;t. Did you also remove an <code>On Error Resume Next</code> statement by any chance?"}, {"owner": {"reputation": 1, "user_id": 8928547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427bb97fec94b50ffea1b4b0c4dc9c1d?s=128&d=identicon&r=PG&f=1", "display_name": "ASHISH GARG", "link": "https://stackoverflow.com/users/8928547/ashish-garg"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510816903, "post_id": 47314492, "comment_id": 81598212, "body": "Yes Next one is of no use  and there is no need of On error resume next."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8928547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427bb97fec94b50ffea1b4b0c4dc9c1d?s=128&d=identicon&r=PG&f=1", "display_name": "ASHISH GARG", "link": "https://stackoverflow.com/users/8928547/ashish-garg"}, "edited": false, "score": 0, "creation_date": 1510805200, "post_id": 47315666, "comment_id": 81593737, "body": "Using that the second link opening in the same tab but i need to be open at another tab and want to navigate first page, open second page and navigate on it."}], "tags": [], "owner": {"reputation": 130, "user_id": 8715626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TrjPp.png?s=128&g=1", "display_name": "Nahuatl_C137", "link": "https://stackoverflow.com/users/8715626/nahuatl-c137"}, "is_accepted": false, "score": 0, "last_activity_date": 1510774093, "last_edit_date": 1510774093, "creation_date": 1510773834, "answer_id": 47315666, "question_id": 47314492, "link": "https://stackoverflow.com/questions/47314492/how-to-navigate-through-multiple-links-on-website-using-vba-internet-explorer/47315666#47315666", "title": "How to navigate through multiple links on website using vba internet explorer", "body": "<p>Correct your syntax within the Else Statement:</p>\n\n<pre><code>Else\n    IE.Navigate url, 2048\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>Else\n    IE.Navigate2 url, 2048\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8928547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/427bb97fec94b50ffea1b4b0c4dc9c1d?s=128&d=identicon&r=PG&f=1", "display_name": "ASHISH GARG", "link": "https://stackoverflow.com/users/8928547/ashish-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1511008489, "creation_date": 1510769510, "last_edit_date": 1511008489, "question_id": 47314492, "link": "https://stackoverflow.com/questions/47314492/how-to-navigate-through-multiple-links-on-website-using-vba-internet-explorer", "title": "How to navigate through multiple links on website using vba internet explorer", "body": "<p>I want to select options on multiple pages using vba internet explorer and i am able to open multiple tabs and multiple links using vba but only able to navigate on first page. Please check the coding given below for your reference:-</p>\n\n<pre><code>Sub mmtlink2()\n\nDim IE As New SHDocVw.InternetExplorer\nDim st As String\nDim htmldoc As MSHTML.HTMLDocument\n\n\nDim i As Long, d As Long, b As Long\n\n'Set IE = CreateObject(\"InternetExplorer.Application\")\n\nIE.Visible = True\n\nd = 2\n\nFor i = 1 To d\n\nIf i = 1 Then\n    IE.navigate \"https://www.makemytrip.com/air/search?tripType=O&amp;itinerary=BOM-DXB-D-02Dec2017&amp;paxType=A-1&amp;cabinClass=E\"\n\nElse\n    IE.Navigate2 \"https://www.makemytrip.com/air/search?tripType=O&amp;itinerary=BOM-DXB-D-03Dec2017&amp;paxType=A-1&amp;cabinClass=E\", 2048\nEnd If\n\n Do While IE.Busy = True Or IE.readyState &lt;&gt; 4\n Loop\n\n    Set htmldoc = IE.document\n\n    htmldoc.getElementById(\"Non stop\").Click\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Please provide any solution to navigate on second page as well.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510768007, "post_id": 47313963, "comment_id": 81578858, "body": "Are you searching the4 selected cell from the list of ID&#39;s and names?"}, {"owner": {"reputation": 3, "user_id": 8946844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40d9148777a8826d49b56b700dcfd85d?s=128&d=identicon&r=PG&f=1", "display_name": "accusync70", "link": "https://stackoverflow.com/users/8946844/accusync70"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510768413, "post_id": 47313963, "comment_id": 81579071, "body": "No. For example, if in my Excel I have 4 ID&#39;s, I want to search the name of this ID&#39;s on the other Excel."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510769878, "post_id": 47313963, "comment_id": 81579880, "body": "In your code you are selecting the entire sheet &quot;Hoja1&quot; and then using find to search for activecell, what is activecell.  I am just trying to understand your question."}, {"owner": {"reputation": 3, "user_id": 8946844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40d9148777a8826d49b56b700dcfd85d?s=128&d=identicon&r=PG&f=1", "display_name": "accusync70", "link": "https://stackoverflow.com/users/8946844/accusync70"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510770351, "post_id": 47313963, "comment_id": 81580163, "body": "My mistake. Sorry.  I have a list of ID&#180;s and Name on other Excel&#180;s book.  I  have a principal Excel, who is taken  ID&#180;s on one column named ID&#180;s, A1, A2, A3, etc. I need to select all this ID&#180;s, search on the other Excel and bring all its name to the column &quot;I&quot;.  ID (A)                                                 Name (I) 101                                                    John Mary"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1510774200, "post_id": 47313963, "comment_id": 81582350, "body": "Perhaps images of your data and desired outcome would help?"}], "owner": {"reputation": 3, "user_id": 8946844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40d9148777a8826d49b56b700dcfd85d?s=128&d=identicon&r=PG&f=1", "display_name": "accusync70", "link": "https://stackoverflow.com/users/8946844/accusync70"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510769883, "creation_date": 1510767577, "question_id": 47313963, "link": "https://stackoverflow.com/questions/47313963/search-in-another-book-vba-excel", "title": "Search in another book VBA Excel", "body": "<p>I want to search a range of cells previously selected on Excel in another book.</p>\n\n<p>I have a list of ID's and Name on other book of Excel. I want to select a list o cells, search on the other excel and paste de cells searched in a range of cells on the columns I. </p>\n\n<p>Example: </p>\n\n<p>Search A1,A2, A3 and paste on I1,I2, I3.</p>\n\n<pre><code>     Sub Macro1()\nWorkbooks.Open Filename:=\"root....Libro3.xlsx\"\nSheets(\"Hoja1\").Select\nCells.Find(What:=ActiveCell, After:=ActiveCell, LookIn:=xlValues, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=False).Activate\nRange(Selection.Offset(0, 1), Selection.Offset(0, 1)).Copy\nActiveWindow.Close SaveChanges:=False\nActiveSheet.Paste Destination:=[A5]\n End Sub\n</code></pre>\n\n<p>I tried with this, but just work for a column. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1510766951, "post_id": 47313619, "comment_id": 81578254, "body": "Not sure what are you trying to achieve. Try using <code>Age_rng,Range(&quot;A2&quot;).Value</code> but I&#39;m just guessing."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1510767079, "post_id": 47313619, "comment_id": 81578326, "body": "you cannot test a multi-cell range to one value <code>Total.Sheets(&quot;Counts&quot;).Range(&quot;G:G&quot;).Value = &quot;NEWV&quot;</code> will cause an error.  You will need to loop through the range and test each cell separately."}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 1, "creation_date": 1510767230, "post_id": 47313619, "comment_id": 81578419, "body": "@DavidG. I have to count number of rows which has NEWV string in G column"}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1510767291, "post_id": 47313619, "comment_id": 81578453, "body": "@ScottCraner How do I do that ? and the last row number  is not the same all  the time, It keeps changing"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1510767327, "post_id": 47313619, "comment_id": 81578482, "body": "You need to use the countif function.  Is the &quot;NEWV&quot; the whole string in the cell or just part of the string in the cell?"}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 1, "creation_date": 1510767399, "post_id": 47313619, "comment_id": 81578527, "body": "Yes NEWV is the entire string and I am using Countif but it doesnt seem to work with the range am specifying,can you check my code?"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1510767592, "post_id": 47313619, "comment_id": 81578625, "body": "Why are you counting Age_rng equal to A2?  Your explanation doesn&#39;t match your code.  Are you counting NEWV in column G or A2 in named range Age_rng?"}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1510768789, "post_id": 47313619, "comment_id": 81579279, "body": "@mooseman I am first filtering the column G for NEWV string and count the COLUMN A after filtering and putting that count value in L27.On top of this all this is being filtered for each buyer for which am using Lookfor = Byrnbr"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1510769417, "post_id": 47313619, "comment_id": 81579601, "body": "no where in your code are you filtering."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1510769452, "post_id": 47313619, "comment_id": 81579628, "body": "But it sounds like you want COUNTIFS with multiple conditions."}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1510769891, "post_id": 47313619, "comment_id": 81579892, "body": "@mooseman Sorry it is a entire page coding which I have written and facing problems in this area,I just picked the area where I was having problems.I have now edited the code which I posted to include few more lines where am filtering for ByrNbr"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1510770190, "post_id": 47313619, "comment_id": 81580076, "body": "So you want a count of rows if Column B = ByrNbr and Column G = NEWV.  Is that correct?"}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510770845, "post_id": 47313619, "comment_id": 81580439, "body": "Yes, that is what am trying to achieve @mooseman"}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510861008, "post_id": 47313619, "comment_id": 81627565, "body": "@mooseman I have another question,If I have to add another condition say,I have to subtract (today&#39;s date - Column(I:I) ) &lt; 91 on top of those 2 conditions how do I do that? Now I have 3 conditions and have to count number of rows"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 1, "creation_date": 1510768538, "post_id": 47313927, "comment_id": 81579146, "body": "This works if I just want to count NEWV string, but I have to match that with Buyer nbr where am giving Lookfor = Byrnbr"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 1, "creation_date": 1510768604, "post_id": 47313927, "comment_id": 81579181, "body": "Then, your question and goal is still not clear. There are several attempts to help you, but you are not providing enough information."}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 1, "creation_date": 1510769446, "post_id": 47313927, "comment_id": 81579617, "body": "This is how the code of mine goes,ByrNbr = Watchlist.Range(&quot;B&quot; &amp; i).Value  LookFor = ByrNbr  Set Age_rng = Total.Sheets(&quot;Counts&quot;).Range(&quot;A:S&quot;)  If Total.Sheets(&quot;Counts&quot;).Range(&quot;G:G&quot;).Value = &quot;NEWV&quot; Then           .Range(&quot;L27&quot;).Value = Application.WorksheetFunction.CountIf(Age_rng, Range(&quot;A:A&quot;))          End If"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1510767453, "creation_date": 1510767453, "answer_id": 47313927, "question_id": 47313619, "link": "https://stackoverflow.com/questions/47313619/filter-based-on-a-string-and-count-number-of-rows/47313927#47313927", "title": "Filter based on a string and count number of rows", "body": "<p>Try testing this line without the <code>If</code> statement</p>\n\n<pre><code>Range(\"L27\").Value = Application.WorksheetFunction.COUNTIF(Age_rng,\"NEWV\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 0, "creation_date": 1510859145, "post_id": 47314974, "comment_id": 81626484, "body": "I have another question,If I have to add another condition say,I have to subtract (today&#39;s date - Column(I:I) ) &lt; 91 on top of those 2 conditions how do I do that? Now I have 3 conditions and have to count number of rows."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 0, "creation_date": 1510863295, "post_id": 47314974, "comment_id": 81628704, "body": "Add another criteria like watchlist.range(I:I),&quot;&lt;Date -91&quot;"}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 0, "creation_date": 1510866610, "post_id": 47314974, "comment_id": 81630397, "body": "No, (Date - I:I )should be less than or equal to 91"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 0, "creation_date": 1510866900, "post_id": 47314974, "comment_id": 81630553, "body": "watchlist.range(I:I),&quot;&lt;=Date -91&quot;, should be the same thing mathematically."}, {"owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 0, "creation_date": 1510952654, "post_id": 47314974, "comment_id": 81671221, "body": "It works! Thank you! I have another question. I have 2 workbooks A &amp; B.The workbooks are already defined.I have an issue with part of my code where I am trying to compare column A from workbook A and Column D from Workbook B. If it matches then I want to copy corresponding column B to Workbook column E."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "edited": false, "score": 0, "creation_date": 1510953065, "post_id": 47314974, "comment_id": 81671414, "body": "That&#39;s a different question and one that has been asked here already.  Search for that for some answers"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1510771406, "creation_date": 1510771406, "answer_id": 47314974, "question_id": 47313619, "link": "https://stackoverflow.com/questions/47313619/filter-based-on-a-string-and-count-number-of-rows/47314974#47314974", "title": "Filter based on a string and count number of rows", "body": "<p>Not sure what workbook and worksheet these ranges are on, but you could use something like this, just have to clarify where each range resides.</p>\n\n<pre><code>ByrNbr = Watchlist.Range(\"B\" &amp; i).Value\n     Worksheets(???).Range(\"L27\").Value =WorksheetFunction.CountIfs(Watchlist.Range(\"B:B\" ), ByrNbr, \n    Watchlist.Range(\"G:G\"), \"NEWV\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 382, "user_id": 6697723, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dc05443c714c0d271e7791db5c08829b?s=128&d=identicon&r=PG&f=1", "display_name": "teddy2", "link": "https://stackoverflow.com/users/6697723/teddy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1510771568, "creation_date": 1510771568, "answer_id": 47315017, "question_id": 47313619, "link": "https://stackoverflow.com/questions/47313619/filter-based-on-a-string-and-count-number-of-rows/47315017#47315017", "title": "Filter based on a string and count number of rows", "body": "<p><a href=\"https://i.stack.imgur.com/p6Psk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p6Psk.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub formulatest()\n\nMsgBox Application.WorksheetFunction.CountIfs(Sheet1.Range(\"B13:B16\"), Sheet1.Range(\"C12\").Value, Sheet1.Range(\"G13:G16\"), Sheet1.Range(\"D12\").Value)\n'~~Returns 2\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4490346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UoCexYfhh0A/AAAAAAAAAAI/AAAAAAAAAgM/uCf78ohqkHg/photo.jpg?sz=128", "display_name": "Abinaya Mohan", "link": "https://stackoverflow.com/users/4490346/abinaya-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 47314974, "answer_count": 3, "score": -1, "last_activity_date": 1510771568, "creation_date": 1510766436, "last_edit_date": 1531164843, "question_id": 47313619, "link": "https://stackoverflow.com/questions/47313619/filter-based-on-a-string-and-count-number-of-rows", "title": "Filter based on a string and count number of rows", "body": "<p>I have recently started working with VBA and I have to filter a column with string 'NEWV' and to count number of rows that end after that filtering,Currently am using the below code but that doesnt seem to work,</p>\n\n<pre><code>ByrNbr = Watchlist.Range(\"B\" &amp; i).Value\n\nLookFor = ByrNbr\n\nSet Age_rng = Total.Sheets(\"Counts\").Range(\"A:S\")\n\nIf Total.Sheets(\"Counts\").Range(\"G:G\").Value = \"NEWV\" Then\n\n .Range(\"L27\").Value = Application.WorksheetFunction.CountIf(Age_rng, Range(\"A:A\"))\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "block", "userform", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1510766276, "post_id": 47313541, "comment_id": 81577867, "body": "Why are you using a textbox (designed for user input) if you don&#39;t want to allow input? Use a label instead."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 8700030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19981305fd003ae6ea904507e2bb621c?s=128&d=identicon&r=PG&f=1", "display_name": "Chielmos", "link": "https://stackoverflow.com/users/8700030/chielmos"}, "edited": false, "score": 0, "creation_date": 1510776298, "post_id": 47314180, "comment_id": 81583442, "body": "I did that, and now when I try to type something, it jumps direct to the next textbox, and the character I typed in the textbox is grey."}, {"owner": {"reputation": 65, "user_id": 8700030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19981305fd003ae6ea904507e2bb621c?s=128&d=identicon&r=PG&f=1", "display_name": "Chielmos", "link": "https://stackoverflow.com/users/8700030/chielmos"}, "edited": false, "score": 0, "creation_date": 1510776362, "post_id": 47314180, "comment_id": 81583488, "body": "Private Sub Achternaam_Change() Me.Achternaam.Enabled = False End Sub"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 65, "user_id": 8700030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19981305fd003ae6ea904507e2bb621c?s=128&d=identicon&r=PG&f=1", "display_name": "Chielmos", "link": "https://stackoverflow.com/users/8700030/chielmos"}, "edited": false, "score": 0, "creation_date": 1510926274, "post_id": 47314180, "comment_id": 81656042, "body": "@Chielmos: <i>I did that, and now when I try to type something</i> makes no sense when you&#39;ve said <i>I want a textbox to be blocked for input</i>. Make up your mind. You <b>either</b> want it blocked for input or you want it to be able to be typed in (which is the <b>exact opposite</b> of <i>blocked for input</i>). What <b>exactly</b> are you asking here?"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1510926344, "post_id": 47314180, "comment_id": 81656094, "body": "Robby, rather than answering very low quality, unclear questions it&#39;s better to just wait until the poster has made it more clear. It wastes less of your time, and provides incentive for the poster to make the edit."}, {"owner": {"reputation": 65, "user_id": 8700030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19981305fd003ae6ea904507e2bb621c?s=128&d=identicon&r=PG&f=1", "display_name": "Chielmos", "link": "https://stackoverflow.com/users/8700030/chielmos"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1511095967, "post_id": 47314180, "comment_id": 81706181, "body": "@Ken White: I will try to make it more clear what I want to achieve. I have made a userForm with 20 different textboxes. I want to show the information in these textboxes, but it should not be possible for a user to change the values in some of these textboxes. In that case the displayed information has to be grey. I hope I explained my question a little bit better now."}], "tags": [], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "is_accepted": true, "score": 0, "last_activity_date": 1510768365, "creation_date": 1510768365, "answer_id": 47314180, "question_id": 47313541, "link": "https://stackoverflow.com/questions/47313541/block-textbox-for-input-in-userform/47314180#47314180", "title": "Block textbox for input in userform", "body": "<p>Change the Enabled property to False for the textbox.</p>\n"}, {"comments": [{"owner": {"reputation": 65, "user_id": 8700030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19981305fd003ae6ea904507e2bb621c?s=128&d=identicon&r=PG&f=1", "display_name": "Chielmos", "link": "https://stackoverflow.com/users/8700030/chielmos"}, "edited": false, "score": 0, "creation_date": 1511612736, "post_id": 47360935, "comment_id": 81926655, "body": "Thank you funnyjugler, this for me the right solution"}], "tags": [], "owner": {"reputation": 11, "user_id": 8960328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H7EPW.jpg?s=128&g=1", "display_name": "funnyjuggler", "link": "https://stackoverflow.com/users/8960328/funnyjuggler"}, "is_accepted": false, "score": 0, "last_activity_date": 1510962587, "creation_date": 1510962587, "answer_id": 47360935, "question_id": 47313541, "link": "https://stackoverflow.com/questions/47313541/block-textbox-for-input-in-userform/47360935#47360935", "title": "Block textbox for input in userform", "body": "<p>if you don't want the user to be able to change or select the text in the textbox, Change the enabled Property to False.  This will grey out the textbox and make the text un-editable.</p>\n\n<p>If you don't want it greyed out, try setting the focus on another control as soon as a user enters your textbox</p>\n\n<pre><code>Private Sub TextBox1_Enter()\n    TextBox2.SetFocus\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 8700030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/19981305fd003ae6ea904507e2bb621c?s=128&d=identicon&r=PG&f=1", "display_name": "Chielmos", "link": "https://stackoverflow.com/users/8700030/chielmos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5773, "favorite_count": 0, "accepted_answer_id": 47314180, "answer_count": 2, "score": -3, "last_activity_date": 1510962587, "creation_date": 1510766165, "last_edit_date": 1531164843, "question_id": 47313541, "link": "https://stackoverflow.com/questions/47313541/block-textbox-for-input-in-userform", "title": "Block textbox for input in userform", "body": "<p>I am using a userform for the first time and I want a textbox to be blocked for input. I have tried a lot of different things, but still without a proper result.\nCan anybody help me with this matter ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "edited": false, "score": 1, "creation_date": 1510766385, "post_id": 47313492, "comment_id": 81577925, "body": "Is your worksheet named <code>sheet 2</code> or <code>sheet2</code>? My first guess is the sheet name is incorrect."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1510766601, "creation_date": 1510766601, "answer_id": 47313668, "question_id": 47313492, "link": "https://stackoverflow.com/questions/47313492/pdf-print-to-file-path-vba/47313668#47313668", "title": "PDF print to file path VBA", "body": "<p>Try it like this: (without <code>Array</code>)</p>\n\n<pre><code>sub PrintPDFRT()\n\nWorkSheets(\"test\").Activate\nActiveSheet.UsedRange.Select\nWorkSheets(\"malbru1\").Activate\nActiveSheet.UsedRange.Select\nWorkSheets(\"sheet 2\").Activate\nRange(\"A1:j137\").Select\n\nThisWorkbook.WorkSheets(\"sheet 2\").ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=\"FIle path\\\" &amp; Range(\"L7\").Value, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8881136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06f7c66d058c434febd5491431791cea?s=128&d=identicon&r=PG&f=1", "display_name": "R Tomble", "link": "https://stackoverflow.com/users/8881136/r-tomble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2983, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1510766601, "creation_date": 1510766061, "last_edit_date": 1510766438, "question_id": 47313492, "link": "https://stackoverflow.com/questions/47313492/pdf-print-to-file-path-vba", "title": "PDF print to file path VBA", "body": "<p>I have the below code I have researched and got to work in one of my workbooks. The idea of the code is to automatically print a sheet to PDF and save down in a directory of my choosing naming it the contents of a specific cell.</p>\n\n<p>All works fine until I try to copy into a new workbook (I designed in a test workbook as not to corrupt the original)  then I get a </p>\n\n<blockquote>\n  <p>run time error 1004</p>\n</blockquote>\n\n<p>and the <code>ThisWorkbook.Sheets(Array(\"sheet 2\")).Select</code> is highlighted when I debug. Am I missing something simple? as the code works in the original workbook but not in if I paste into a new module in a new workbook?  Sorry i'm quite new to this!</p>\n\n<pre><code>sub PrintPDFRT()\n\nSheets(\"test\").Activate\nActiveSheet.UsedRange.Select\nSheets(\"malbru1\").Activate\nActiveSheet.UsedRange.Select\nSheets(\"sheet 2\").Activate\nRange(\"A1:j137\").Select\n\nThisWorkbook.Sheets(Array(\"sheet 2\")).Select\nSelection.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=\"FIle path\\\" &amp; Range(\"L7\").Value, _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook", "email-attachments"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 2, "creation_date": 1510768484, "post_id": 47313337, "comment_id": 81579114, "body": "Please define &#39;protected&#39;... i.e. For a Word document, do you mean &#39;protected with a password&#39; or &#39;protected for form filling&#39;, or some other definition. Then you need to identify all of the types of files that you need to check because each may require a different approach."}, {"owner": {"reputation": 13, "user_id": 6436228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b34eeb193bc16b05765a219c3775eca?s=128&d=identicon&r=PG&f=1", "display_name": "Gibby123", "link": "https://stackoverflow.com/users/6436228/gibby123"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510829436, "post_id": 47313337, "comment_id": 81606067, "body": "Sorry - they&#39;re password protected, so you can&#39;t view the contents of the file without the right password first."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510848680, "post_id": 47313337, "comment_id": 81619873, "body": "Is there more to your question than just &#39;see if password protected&#39;? I can understand if you either want every attachment password protected, or want to make sure none are protected, then either allow or prevent sending.   Is the fact the file is password protected enough, or do you need to know the password? Your code can attempt to open each file, but more info is needed."}, {"owner": {"reputation": 13, "user_id": 6436228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b34eeb193bc16b05765a219c3775eca?s=128&d=identicon&r=PG&f=1", "display_name": "Gibby123", "link": "https://stackoverflow.com/users/6436228/gibby123"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510849117, "post_id": 47313337, "comment_id": 81620209, "body": "I&#39;d just like the code to check the email for attachements and if there are -  to see if they&#39;re password protected, and if there&#39;s any that aren&#39;t to flag a warning that the email is about to send and give the option to cancel it being sent.  What I don&#39;t know how to VB code is how to check each attachment to see if they&#39;re password protected, grateful for any help here thanks."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510855848, "post_id": 47313337, "comment_id": 81624556, "body": "I will submit some very raw code of how to check for passwords as an answer. In real life, I would call that Function, passing the path &amp; filename, then have it determine the type of file and if it has a password. You could call it from your module. However, I have been unable to find out how to get the path name to the file in either where you have your code, or when the user attaches the file (that&#39;s where I believe the code should go). If you can get the path, great. Other file types could be added to check for passwords."}], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1510866145, "post_id": 47336524, "comment_id": 81630172, "body": "For future searchers who find this answer. I suggest you save the attachments in a designated folder so you know the path. Open the application based on the file extension, then once done with the password check kill the temporarily saved file."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1510873915, "post_id": 47336524, "comment_id": 81633686, "body": "@niton, I liked your idea so did some more searching and found a variation like you suggest. It involves saving the attachments to your temp folder, the deleting when finished. Since no changes are made, that will work just fine.  I added more info in the answer above.Thanks!"}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1510873746, "last_edit_date": 1510873746, "creation_date": 1510856056, "answer_id": 47336524, "question_id": 47313337, "link": "https://stackoverflow.com/questions/47313337/check-if-email-attachment-is-password-protected-before-sending/47336524#47336524", "title": "Check if email attachment is password protected before sending", "body": "<p>The code below does not solve your issue, but does show how to check documents and databases to see if password protected. If you are able to obtain the file path, then this code could be modified to pass the path and filename, then return a flag to indicate PW status. Or just modify and embed this code in your module.</p>\n\n<p>Revision 1:  Instead of trying to find the path of the file to check for a password, an alternate solution would be for your code to save the file to a temp folder, then delete when finished. The following line of code will give you a temp folder (i.e. C:\\Users\\MyName\\AppData\\Local\\Temp)</p>\n\n<pre><code>strFolder = objFSO.GetSpecialFolder(2)\n</code></pre>\n\n<p>This idea was obtained from a post that allows you to rename attachments: <a href=\"http://www.flobee.net/rename-outlook-attachments-before-you-send-them/\" rel=\"nofollow noreferrer\">http://www.flobee.net/rename-outlook-attachments-before-you-send-them/</a></p>\n\n<p>Also, the OP need to consider how to implement/perform the password check. If the code is called 'automatically', then unless you have some rule to only check certain files, then your code will always check ALL attachments for ALL emails! I doubt that's what you want to happen. Perhaps a user button on the tool bar?</p>\n\n<p>Original Code:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPublic Function Check_For_Passwords()\nDim objWord     As Word.Application\nDim objWordDoc  As Word.Document\nDim sPath       As String\nDim sFileName   As String\nDim oAccess     As Access.Application\n\n    On Error GoTo Error_Trap\n\n    ' Set the following string to the path of your Word Document\n    sPath = \"C:\\data\\WP\\\"                   ' &lt;&lt;&lt; CHANGE THIS!!\n    sFileName = \"Access.doc\"                ' &lt;&lt;&lt; CHANGE THIS!!\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = False\n    ' Use a fake password - if no password on doc, OK; If password protected will fail\n    Set objWordDoc = objWord.Documents.Open(sPath &amp; sFileName, , True, , \"*****\")\n    'Err: 5408    The password is incorrect. Word cannot open the document.\n\n    Set oAccess = CreateObject(\"Access.Application\")\n    oAccess.Visible = False\n    sPath = \"C:\\data\\Access\\\"                   ' &lt;&lt;&lt; CHANGE THIS!!\n    sFileName = \"PWD_DB.mdb\"                    ' &lt;&lt;&lt; CHANGE THIS!!\n\n    'If error, then database has password\n    oAccess.DBEngine.OpenDatabase sPath &amp; sFileName, False\n    'Err: 3031    Not a valid password.\n\n    Exit Function\n\nError_Trap:\n    If Err.Number = 5408 Then\n        MsgBox \"Document has a password! Do whatever...  \" &amp; sPath &amp; sFileName\n    ElseIf Err.Number = 3031 Then\n        MsgBox \"Access DB has a password! Do whatever...  \" &amp; sPath &amp; sFileName\n    Else\n        MsgBox \"Unexpected error: \" * Err.Number &amp; vbTab &amp; Err.Description\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6436228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b34eeb193bc16b05765a219c3775eca?s=128&d=identicon&r=PG&f=1", "display_name": "Gibby123", "link": "https://stackoverflow.com/users/6436228/gibby123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1066, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593325859, "creation_date": 1510765610, "last_edit_date": 1593325859, "question_id": 47313337, "link": "https://stackoverflow.com/questions/47313337/check-if-email-attachment-is-password-protected-before-sending", "title": "Check if email attachment is password protected before sending", "body": "<p>I'm trying to check all my attachments before sending an email to see if they are password protected. Typically these will be Word, Excel or PowerPoint files.</p>\n\n<p>I've got as far as seeing if there are attachments.</p>\n\n<p>I don't know how to loop through each attachment in the mail file to see if each one is password protected.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\n\nDim attachments2 As Outlook.attachments\nDim attachm As Outlook.Attachment\n\nIf Item.attachments.Count &gt; 0 Then\n\n    Set attachments2 = Item.attachments\n\n    Set attachm = Item.Attachment\n\n    For Each attachm In attachments2\n\n    ' ***IM GUESSING CODE TO CHECK IF ATTACHMENTS ARE PROTECTED WOULD GO IN HERE?***\n\n    Next\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "object", "events"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510765484, "post_id": 47313257, "comment_id": 81577409, "body": "AppDate = new Target.Value"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510765626, "post_id": 47313257, "comment_id": 81577498, "body": "you can try <code>Set AppDate = Target.Value</code> (not tested)"}, {"owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "edited": false, "score": 0, "creation_date": 1510765761, "post_id": 47313257, "comment_id": 81577580, "body": "@peakpeak I&#39;m getting &quot;User-defined type not defined&quot; error..."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1510766327, "post_id": 47313257, "comment_id": 81577898, "body": "@David -- a tutorial about <code>Set</code>. :-)   I have a terriible memory and constantly make mistakes on my <i>Nothings</i>  and <i>Sets</i> and such, so I end up cycling through the different syntaxes until it&#39;s right.  Then it makes perfect sense... until the next time."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "edited": false, "score": 0, "creation_date": 1510767235, "post_id": 47313409, "comment_id": 81578423, "body": "You&#39;re welcome.  This is reminding me of a Seinfeld episode...  :)"}, {"owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "edited": false, "score": 0, "creation_date": 1510770332, "post_id": 47313409, "comment_id": 81580150, "body": "Yep, writing something about nothing for so many pages requires some talent :)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 4, "last_activity_date": 1510765808, "creation_date": 1510765808, "answer_id": 47313409, "question_id": 47313257, "link": "https://stackoverflow.com/questions/47313257/event-macro-throws-an-error-object-required/47313409#47313409", "title": "Event Macro Throws an Error &quot;Object Required&quot;", "body": "<p>Use:</p>\n\n<pre><code>\u2026\nIf Not IsEmpty(AppDate) \n\u2026\n</code></pre>\n\n<p>To help clarify, <a href=\"https://www.experts-exchange.com/articles/1910/Understanding-Null-Empty-Blank-N-A-ZLS-Nothing-Missing.html\" rel=\"noreferrer\">here is a lengthy tutorial</a> <strong>about Nothing</strong>.  <sub>lol</sub></p>\n"}, {"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 7, "last_activity_date": 1510766028, "creation_date": 1510766028, "answer_id": 47313474, "question_id": 47313257, "link": "https://stackoverflow.com/questions/47313257/event-macro-throws-an-error-object-required/47313474#47313474", "title": "Event Macro Throws an Error &quot;Object Required&quot;", "body": "<p><code>Is</code> operator works with objects and not values. </p>\n\n<hr>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim x As Variant\n    Dim y As New Collection\n    Dim z As Object\n\n    x = Target.Value\n\n    If IsEmpty(x) Then\n        MsgBox \"may be use this.\"\n    End If\n\n    MsgBox TypeName(x)\n\n    If y Is Nothing Then\n     MsgBox \"Works\"\n    End If\n\n    If z Is Nothing Then\n     MsgBox \"Works\"\n    End If\n\n    If x Is Nothing Then '/This won't work\n\n    End If\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 47313409, "answer_count": 2, "score": 1, "last_activity_date": 1537113644, "creation_date": 1510765392, "last_edit_date": 1537113644, "question_id": 47313257, "link": "https://stackoverflow.com/questions/47313257/event-macro-throws-an-error-object-required", "title": "Event Macro Throws an Error &quot;Object Required&quot;", "body": "<p>I have this simple Event Macro, which for some reason throws me an </p>\n\n<blockquote>\n  <p>Object Required</p>\n</blockquote>\n\n<p>error on this line <code>If Not AppDate Is Nothing Then</code>. Any idea what might be causing this?</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim LastRow As Integer\n    Dim ThisRow As String\n    Dim AppDate As Variant\n    Application.EnableEvents = False\n\n    LastRow = Cells(Rows.Count, \"C\").End(xlUp).Row\n    If Target.Column = 3 Then\n        ThisRow = Target.Row\n        AppDate = Target.Value\n        If Not AppDate Is Nothing Then\n            (...) Recalculate Date in Column F\n        Else\n        End If\n    End If\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Any suggestions would be greatly appreciated. Thank you!</p>\n"}, {"tags": ["xml", "excel", "vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1510765183, "post_id": 47313142, "comment_id": 81577216, "body": "As you are using VBA , use <code>Instr</code> . <code>Find</code> can be used as <code>Application.WorksheetFunction.Find</code> Read this : <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-object-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "edited": false, "score": 0, "creation_date": 1510765688, "post_id": 47313142, "comment_id": 81577534, "body": "@asenav Be very careful, in the XML that you posted you close the <code>&lt;bla&gt;</code> before closing the <code>&lt;blabla&gt;</code> and the <code>&lt;moreblabla&gt;</code>. The last &lt;&gt; opened have to be the next closed one (I corrected in your post)."}, {"owner": {"reputation": 1, "user_id": 5745386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EOQFXoNs6eE/AAAAAAAAAAI/AAAAAAAAgjk/OSQbW8adgsg/photo.jpg?sz=128", "display_name": "asenav", "link": "https://stackoverflow.com/users/5745386/asenav"}, "edited": false, "score": 0, "creation_date": 1510766800, "post_id": 47313142, "comment_id": 81578163, "body": "Thanks!  I have updated the part with the instr and I got no error there"}, {"owner": {"reputation": 1, "user_id": 5745386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EOQFXoNs6eE/AAAAAAAAAAI/AAAAAAAAgjk/OSQbW8adgsg/photo.jpg?sz=128", "display_name": "asenav", "link": "https://stackoverflow.com/users/5745386/asenav"}, "edited": false, "score": 0, "creation_date": 1510770935, "post_id": 47313142, "comment_id": 81580482, "body": "I still have the issue of the Mid, the thing is that is failing but cant figure out why."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1510776910, "post_id": 47313142, "comment_id": 81583734, "body": "What is your end goal? Do you need to extract a value from XML? Create a smaller XML as a subset of this one based on a value? Please post desired result. You should not be using string finds on XML but XPath expressions."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5745386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EOQFXoNs6eE/AAAAAAAAAAI/AAAAAAAAgjk/OSQbW8adgsg/photo.jpg?sz=128", "display_name": "asenav", "link": "https://stackoverflow.com/users/5745386/asenav"}, "edited": false, "score": 0, "creation_date": 1510770986, "post_id": 47313301, "comment_id": 81580506, "body": "yes it help me!, now I am stuck with the Mid function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 1, "user_id": 5745386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EOQFXoNs6eE/AAAAAAAAAAI/AAAAAAAAgjk/OSQbW8adgsg/photo.jpg?sz=128", "display_name": "asenav", "link": "https://stackoverflow.com/users/5745386/asenav"}, "edited": false, "score": 0, "creation_date": 1510774526, "post_id": 47313301, "comment_id": 81582515, "body": "Edited my answer... But not sure what &quot;I am stuck&quot; means."}, {"owner": {"reputation": 1, "user_id": 5745386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EOQFXoNs6eE/AAAAAAAAAAI/AAAAAAAAgjk/OSQbW8adgsg/photo.jpg?sz=128", "display_name": "asenav", "link": "https://stackoverflow.com/users/5745386/asenav"}, "edited": false, "score": 0, "creation_date": 1510776098, "post_id": 47313301, "comment_id": 81583329, "body": "the instr is giving me the right position inside the text string. But now the error is in the Mid function section, I have checked the syntaxis, but I have no idea why it stop there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 1, "user_id": 5745386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EOQFXoNs6eE/AAAAAAAAAAI/AAAAAAAAgjk/OSQbW8adgsg/photo.jpg?sz=128", "display_name": "asenav", "link": "https://stackoverflow.com/users/5745386/asenav"}, "edited": false, "score": 0, "creation_date": 1510776340, "post_id": 47313301, "comment_id": 81583473, "body": "do you know how to debug your code to see the value of the variables?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1510774313, "last_edit_date": 1510774313, "creation_date": 1510765496, "answer_id": 47313301, "question_id": 47313142, "link": "https://stackoverflow.com/questions/47313142/find-function-inside-vba-code-in-excel/47313301#47313301", "title": "find function inside vba code in excel", "body": "<p>If you are trying to find some text in a String, you can use <code>Instr</code>.</p>\n\n<blockquote>\n  <p><a href=\"https://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow noreferrer\">https://www.techonthenet.com/excel/formulas/instr.php</a></p>\n</blockquote>\n\n<p>Syntax</p>\n\n<pre><code>InStr( [start], string, substring, [compare] )\n</code></pre>\n\n<p>Hope it helps.</p>\n\n<p>For <code>MID</code> function:</p>\n\n<blockquote>\n  <p><a href=\"https://www.techonthenet.com/excel/formulas/mid.php\" rel=\"nofollow noreferrer\">https://www.techonthenet.com/excel/formulas/mid.php</a>\n  Syntax</p>\n</blockquote>\n\n<pre><code>MID( text, start_position, number_of_characters)\n</code></pre>\n\n<p>You should define the start position and the number of characters, both should be numbers.</p>\n"}], "owner": {"reputation": 1, "user_id": 5745386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EOQFXoNs6eE/AAAAAAAAAAI/AAAAAAAAgjk/OSQbW8adgsg/photo.jpg?sz=128", "display_name": "asenav", "link": "https://stackoverflow.com/users/5745386/asenav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510775955, "creation_date": 1510764998, "last_edit_date": 1510775955, "question_id": 47313142, "link": "https://stackoverflow.com/questions/47313142/find-function-inside-vba-code-in-excel", "title": "find function inside vba code in excel", "body": "<p>I got the following xml file that is all in one row of text (multiple rows here to make it more readable):</p>\n\n<pre><code>&lt;bla&gt;\n    &lt;blabla&gt;\n        &lt;moreblabla&gt;\n            &lt;colheader&gt;item1&lt;/colheader&gt;\n            &lt;colheader&gt;item2&lt;/colheader&gt;\n            &lt;row&gt;\n                &lt;col&gt;apple1&lt;/col&gt;\n                &lt;col&gt;apple2&lt;/col&gt;\n            &lt;/row&gt;\n            &lt;row&gt;\n                &lt;col&gt;pear1&lt;/col&gt;\n                &lt;col&gt;pear2&lt;/col&gt;\n            &lt;/row&gt;\n            &lt;row&gt;\n                &lt;col&gt;grape1&lt;/col&gt;\n                &lt;col&gt;grape2&lt;/col&gt;\n            &lt;/row&gt;\n        &lt;/moreblabla&gt;\n    &lt;/blabla&gt;\n&lt;/bla&gt;\n</code></pre>\n\n<p>I wanted to do the following, since I have no idea of the lenght of the blabla before the <code>&lt;colheader&gt;</code> I want to use the excel function find, in order to have the start character of the part that I am interested: the row col part of the xml file. </p>\n\n<p>This is my preliminary script:</p>\n\n<pre><code>Sub replacexml()\nDim objFSO\nConst ForReading = 1\nConst ForWriting = 2\nDim objTS\nDim strContents As String\nDim fileSpec As String\nDim start As Long\nDim finish As Long\nDim lenght As Long\n\nfileSpec = \"C:\\path\\out.xml\"\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objTS = objFSO.OpenTextFile(fileSpec, ForReading)\nstrContents = objTS.ReadAll\n\nstart = InStr(strContents, \"&lt;colheader&gt;\")\nfinish = InStr(strContents, \"&lt;/moreblabla&gt;\")\nlenght = finsh - start\nstrContent = Mid(strContents, start, lenght)\n\nobjTS.Close\n\nSet objTS = objFSO.OpenTextFile(fileSpec, ForWriting)\nobjTS.Write strContents\nobjTS.Close\n\nEnd Sub\n</code></pre>\n\n<p>But I got an error, I guess is not recognizing the Find function. How I get the find function to work?</p>\n\n<p>UPDATE: now the mid function is having an issue:</p>\n\n<pre><code>  strContent = Mid(strContents, start, lenght)\n</code></pre>\n"}, {"tags": ["vba", "excel", "aspect-ratio"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510765490, "post_id": 47312949, "comment_id": 81577411, "body": "<a href=\"https://stackoverflow.com/questions/47187148/resizing-image-in-vba-maintaining-aspect-ratio/47187290#47187290\" title=\"resizing image in vba maintaining aspect ratio\">stackoverflow.com/questions/47187148/&hellip;</a>"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510772874, "post_id": 47312949, "comment_id": 81581594, "body": "@braX Thanks for the suggestion but this didn&#39;t really help my issue, as I was declaring it as <code>Object</code> when it should have been a <code>Picture</code> as cyboashu has correctly answered it for me"}], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": true, "score": 1, "last_activity_date": 1510765051, "creation_date": 1510765051, "answer_id": 47313161, "question_id": 47312949, "link": "https://stackoverflow.com/questions/47312949/unlock-aspect-ratio-from-prompted-input/47313161#47313161", "title": "Unlock Aspect Ratio from Prompted Input", "body": "<p>As you are trying to insert picture, declare the type as <code>Picture</code> and not as <code>Object</code>. Use LockAspectRatio is available under the <code>ShapeRange</code> property.</p>\n\n<pre><code>Sub ChangeImage()\n        With Application.FileDialog(msoFileDialogFilePicker)\n            .AllowMultiSelect = False\n            .ButtonName = \"Submit\"\n            .Title = \"Select an image file\"\n            .Filters.Clear\n            .Filters.Add \"All Pictures\", \"*.*\"\n\n            If .Show = -1 Then\n                Dim img As Picture '/ Declare as Picture\n                Set img = ActiveSheet.Pictures.Insert(.SelectedItems(1))\n\n\n               '/ Use ShapeRange to toogle aspect ratio\n               img.ShapeRange.LockAspectRatio = msoFalse\n\n\n                img.Left = 141\n                img.Top = 925\n\n                img.Width = 600\n                img.Height = 251\n            Else\n                Debug.Print \"Prompt closed\"\n            End If\n        End With\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47313161, "answer_count": 1, "score": 0, "last_activity_date": 1510765051, "creation_date": 1510764430, "last_edit_date": 1531164843, "question_id": 47312949, "link": "https://stackoverflow.com/questions/47312949/unlock-aspect-ratio-from-prompted-input", "title": "Unlock Aspect Ratio from Prompted Input", "body": "<p>I'm getting a compile error on <code>img.LockAspectRatio = msoFalse</code>. All I'm trying to do is unlock the aspect ratio of the image that is being imported from the user. I would assume I'm not using the proper syntax, any help would be great</p>\n\n<pre><code>Sub ChangeImage()\n    With Application.FileDialog(msoFileDialogFilePicker)\n        .AllowMultiSelect = False\n        .ButtonName = \"Submit\"\n        .Title = \"Select an image file\"\n        .Filters.Clear\n        .Filters.Add \"All Pictures\", \"*.*\"\n\n        If .Show = -1 Then\n            Dim img As Object\n            Set img = ActiveSheet.Pictures.Insert(.SelectedItems(1))\n\n            img.LockAspectRatio = msoFalse\n\n            img.Left = 141\n            img.Top = 925\n\n            img.Width = 600\n            img.Height = 251\n        Else\n            Debug.Print \"Prompt closed\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510764024, "post_id": 47312687, "comment_id": 81576370, "body": "You use Active and Select. Do not!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1510764096, "post_id": 47312687, "comment_id": 81576418, "body": "Look around at &quot;VBA For loops&quot; which should pretty quickly show you the way to do this.  Basically, declare a range (<code>set myRng = Range(&quot;A1:A10&quot;)</code> then a <code>For</code> loop: <code>For each cel in myRng &#47;&#47; cel.value = &quot;123&quot; (do whatever) &#47;&#47; next cel</code>."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1510827053, "post_id": 47313077, "comment_id": 81604388, "body": "Thanks for the complete code, as I mentioned in the above comment, it doesn&#39;t really make sense to me so I have to do some google searches to understand it and make it work :)."}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "reply_to_user": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1510844905, "post_id": 47313077, "comment_id": 81617083, "body": "myRng is the range you want to look ie the one you &quot;set&quot;, what the above code is saying is look for each cell in the range starting in this case at A1 check if the value of it meets your condition . The next line is what you want to do with it if it does match the condition. It will now look at the next cell and check that and so on. it will keep going until it gets to the last cell you declared in this case A20."}], "tags": [], "owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "is_accepted": false, "score": 0, "last_activity_date": 1510765221, "last_edit_date": 1510765221, "creation_date": 1510764810, "answer_id": 47313077, "question_id": 47312687, "link": "https://stackoverflow.com/questions/47312687/how-to-make-vba-do-the-same-actions-while-changing-criteria-until-it-hits-an-emp/47313077#47313077", "title": "How to make VBA do the same actions while changing criteria until it hits an empty cell?", "body": "<p>as and example </p>\n\n<pre><code>dim myRng as range, cell as range\n\nset myRng = ThisWorkbook.Sheets(\"Sheet4\").Range(\"Your Range here\" eg \"A1:A20\")\n\n\nFor each cell in myRng\n      if \"//your condition\" eg cell.value = \"1\" Then\n         \"What you want to do with it here\"\n               \"you can also nest another for each loop here to copy to your destination\"\n      End If\nNext Cell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1510826963, "post_id": 47313187, "comment_id": 81604312, "body": "Thanks. The code was originally recorded but it didn&#39;t do the work so I have manually edited it so it does the job. It looks like I have a lot to learn though because your code is much easier, it just doesn&#39;t make sense to me :)."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1510765116, "creation_date": 1510765116, "answer_id": 47313187, "question_id": 47312687, "link": "https://stackoverflow.com/questions/47312687/how-to-make-vba-do-the-same-actions-while-changing-criteria-until-it-hits-an-emp/47313187#47313187", "title": "How to make VBA do the same actions while changing criteria until it hits an empty cell?", "body": "<p>Your recorded code  can be replaced with</p>\n\n<pre><code> Dim source as range\n Set source = Sheets(\"Sheet4\").Range(\"$A$1:$R$25239\")\n dim crit as range\n set crit = Sheets(\"Sheet3\").Range(\"A3\")\n Dim dest as range\n\n source.AutoFilter Field:=5, Criteria1:= crit.Value\n set dest = sheets(\"Sheet5\").range(\"a1\").end(xldown).offset(1,0)\n Sheets(\"Sheet4\").range(\"a1\").currentregion.copy dest\n dest.offset(1,0) = \"+\"\n</code></pre>\n\n<p>Now add a loop to achieve what you want</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1510912314, "post_id": 47334884, "comment_id": 81647213, "body": "Almost, let&#39;s say on Sheet1 there is my list that I need to go through every day and in column A there is information that I need to find out some details about it so on Sheet2 that will be my filter criteria. After found all the information I want the whole table to be selected and copied to another sheet then go to the very bottom of it and put a &quot;+&quot; between each entry for formatting. The problem is that the list could be as short as 20 lines or as long as 200 and if I copy blank data to sheet3 (because that&#39;s what I&#39;ve filtered on) it will screw it."}, {"owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "reply_to_user": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "edited": false, "score": 0, "creation_date": 1510922316, "post_id": 47334884, "comment_id": 81653689, "body": "edited the code so that it will look for the criteria stored in Cell A1 on sheet 3 ignore any blank cells and will copy any data that matches the criteria and put it into sheet2 with a &quot;+&quot; between each entry"}], "tags": [], "owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "is_accepted": true, "score": 0, "last_activity_date": 1511169511, "last_edit_date": 1511169511, "creation_date": 1510850278, "answer_id": 47334884, "question_id": 47312687, "link": "https://stackoverflow.com/questions/47312687/how-to-make-vba-do-the-same-actions-while-changing-criteria-until-it-hits-an-emp/47334884#47334884", "title": "How to make VBA do the same actions while changing criteria until it hits an empty cell?", "body": "<p>Tried to understand what you were wanting to do but this will copy any thing from sheet one A1 to A100 that contains \"_\" which you can change to match your filter, if you can clear this up what your filtering by ill amend. it then puts it in sheet2 and puts a \"+\" between each entry  </p>\n\n<pre><code>Sub test()\nDim myArray(1 To 1000) As Variant, cell As Range, myRng As Range, myRng2 As Range, cell2 As Range, Pos As Long, criteria As Variant\n\n\nSet myRng = ThisWorkbook.Sheets(\"Sheet1\").Range(\"A1:A1000\") 'You can change this to be your correct source sheet, and range\n\nSet myRng2 = ThisWorkbook.Sheets(\"Sheet2\").Range(\"A1:A1000\") 'You can change this to be your correct destination sheet, and range\n\ncriteria = ThisWorkbook.Sheets(\"Sheet3\").Range(\"A1\").Value 'Your search criteria lives here\n\n\nPos = 1\n\n    For Each cell In myRng\n        If cell.Value &lt;&gt; \"\" And InStr(cell.Value, criteria) &gt; 0 Then 'you can change the criteria to anything you want.\n             myArray(Pos) = cell.Value\n             Pos = Pos + 1\n        End If\n    Next cell\n\nPos = 1\n\n    For Each cell2 In myRng2\n        If cell2.Value = \"\" Then\n            cell2.Value = myArray(Pos)\n\n            If cell2.Value &lt;&gt; \"\" Then\n               cell2.Offset(1, 0).Value = \"+\"\n            End If\n\n            Pos = Pos + 1\n        End If\n    Next cell2\n\n\nSet myRng = Nothing\nSet myRng2 = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8946456, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f8a702ef9803d27250d7d35b28d766ba?s=128&d=identicon&r=PG&f=1", "display_name": "K. Robert", "link": "https://stackoverflow.com/users/8946456/k-robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 47334884, "answer_count": 3, "score": 0, "last_activity_date": 1511169511, "creation_date": 1510763655, "question_id": 47312687, "link": "https://stackoverflow.com/questions/47312687/how-to-make-vba-do-the-same-actions-while-changing-criteria-until-it-hits-an-emp", "title": "How to make VBA do the same actions while changing criteria until it hits an empty cell?", "body": "<p>I am trying to create a simple VBA macro that would help me with some work that I am currently doing manually.</p>\n\n<p>The idea is that there is a given list, of that list column \"A\" will contain data that I will need to filter on on another sheet, copy the result to another sheet and move on with the next cell below.</p>\n\n<pre><code>Sheets(\"Sheet4\").Select\nActiveSheet.Range(\"$A$1:$R$25239\").AutoFilter Field:=5, Criteria1:= _\n    Sheets(\"Sheet3\").Range(\"A3\").Value\nRange(\"A1\").Select\nActiveCell.CurrentRegion.Select\nSelection.Copy\nSheets(\"Sheet5\").Select\nRange(\"A1\").Select\nActiveCell.End(xlDown).Select\nSelection.Offset(1, 0).Select\nActiveSheet.Paste\nRange(\"A1\").Select\nActiveCell.End(xlDown).Select\nSelection.Offset(1, 0).Select\nActiveCell.FormulaR1C1 = \"+\"\n</code></pre>\n\n<p>I need VBA to repeat this step until the it hits the bottom of the list, however I also need the range to change to the cell one below at the Filter criteria.</p>\n\n<p>I would really appreciate some help as I am a beginner.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510763584, "post_id": 47312604, "comment_id": 81576085, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27385245/using-excel-vba-to-run-sql-query\">Using Excel VBA to run SQL query</a>"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510763815, "post_id": 47312604, "comment_id": 81576232, "body": "@VictorK But my problem is how would you make the record set to copy them into database table."}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510764228, "post_id": 47312604, "comment_id": 81576507, "body": "You have to look into <code>ADODB.Connection</code> and <code>Insert Into</code> statement both of which has a plethora of questions here: <a href=\"https://stackoverflow.com/q/40127962/8597922\">1</a>,<a href=\"https://stackoverflow.com/q/1802120/8597922\">2</a>,<a href=\"https://stackoverflow.com/q/25226635/8597922\">3</a>. As you go you should also check how to use parametrized queries."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510766563, "post_id": 47312604, "comment_id": 81578017, "body": "@VictorK Thanks. I followed your links. I am getting an error in the Insert into statement. I have updated the question, Any Idea where it is going wrong ?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510766973, "post_id": 47312604, "comment_id": 81578267, "body": "Actually <a href=\"https://stackoverflow.com/a/46835253/8597922\">here is my answer</a> to a very similar question for <code>Insert</code>. And <a href=\"https://stackoverflow.com/a/43522802/8597922\">this is an answer</a> that explains parameters."}], "answers": [{"comments": [{"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510764450, "post_id": 47312883, "comment_id": 81576663, "body": "Last time I suggested an unparametrized query here on SO I got <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">this</a> as a reply. I guess reasonably so."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510765349, "post_id": 47312883, "comment_id": 81577326, "body": "If little bobby tables does that in a work environment he won&#39;t be in that environment soon. This is excel and access in an office - not wikileaks&#39;s russian database of fake news"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1510765844, "post_id": 47312883, "comment_id": 81577627, "body": "That&#39;s not the point. For example a name such as &quot;Sarah O&#39;Connor&quot; which is realistic will not work if either it is not sanitized or parametrized as <code>&#39;</code> will blow up the string ."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": -1, "last_activity_date": 1510764199, "creation_date": 1510764199, "answer_id": 47312883, "question_id": 47312604, "link": "https://stackoverflow.com/questions/47312604/how-to-write-a-value-into-access-database-faster-vba-excel/47312883#47312883", "title": "How to write a value into access database faster - VBA (excel)", "body": "<p>Create a reference to the ADO recordset library</p>\n\n<p>create and open a Connection object to the access database</p>\n\n<pre><code> Dim Conn as new adodb.connection\n  conn.connectionstring = \"google for connection string here\"\n  conn.open\n</code></pre>\n\n<p>create a string holding an append query (watch out: you need commas between fields and ' around strings)</p>\n\n<pre><code>Dim strSQL as string\nStrSql = \"INSERT INTO [Usertable] ( Name, Age, Occupation ) \"\nstrsql = strsql &amp; \"Values('\" &amp; me.Name &amp; \"',\" &amp; me.age &amp; \",'\" &amp; me.occupation &amp; \"')\"\n</code></pre>\n\n<p>Use EXECUTE to run this string</p>\n\n<pre><code>conn.execute  strsql\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 47312883, "answer_count": 1, "score": -1, "last_activity_date": 1510766515, "creation_date": 1510763391, "last_edit_date": 1510766515, "question_id": 47312604, "link": "https://stackoverflow.com/questions/47312604/how-to-write-a-value-into-access-database-faster-vba-excel", "title": "How to write a value into access database faster - VBA (excel)", "body": "<p>I am trying to store the values inside an access database from excel using vba.</p>\n\n<p>I have a form in Excel where I get the Inputs from the User.</p>\n\n<p>On VBA, In the Locals window, I could see the values assigned to the object as below,</p>\n\n<pre><code>Name = Mike\nAge = 23\nOccupation = Student\n</code></pre>\n\n<p>On the Access database, I have a table called as <code>UserTable</code> which has columns called as <code>ID, Name, Age, Occupation</code> and now how do I pass the values from VBA to Access database.</p>\n\n<p>I would want to add the value record by record and faster at the same time.</p>\n\n<p>Here is where I am getting the error </p>\n\n<pre><code>strSQL = \"PARAMETERS [Name] TEXT(255), [Age] INTEGER, [Occupation] TEXT(255);\" _\n               &amp; \" INSERT INTO UserTable([User Name], [User Age], [User Occupation]);\"\n</code></pre>\n\n<p>Please help me with this on my learning.</p>\n"}, {"tags": ["excel", "vba", "userform", "setfocus"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510770926, "post_id": 47312397, "comment_id": 81580478, "body": "Please supply enough of your code so that we can try to replicate your issue.  (I noticed in a comment to an answer you mention a <code>keyDown</code> event, but nothing in your question mentions that.  So is this code in the <code>txtbox_add_folder_KeyDown</code> event?  Or is it in the <code>txtbox_add_folder_Change</code> event? Or is it in the <code>txtbox_add_folder_Exit</code> event?  Or where?)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510771454, "post_id": 47312397, "comment_id": 81580770, "body": "TBH it sounds like you just want to use your code in the <code>Enter</code> event. That would seem to satisfy your &quot;I have an excel UserForm with a textbox and I want to select the text within (highlight) so that the end user can see what to fill.&quot; requirement.  (And, of course, you wouldn&#39;t need the <code>SetFocus</code> statement.)"}, {"owner": {"reputation": 145, "user_id": 7923970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a26e4779fea3eb0e24a0acf9f0ea73d1?s=128&d=identicon&r=PG&f=1", "display_name": "GigaByte123", "link": "https://stackoverflow.com/users/7923970/gigabyte123"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510822231, "post_id": 47312397, "comment_id": 81600978, "body": "I have added some details. In fact this code is within the <code>keyDown</code> event, and at the end of this event the focus is always lost and transferred to another control."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510898480, "post_id": 47312397, "comment_id": 81640276, "body": "If you really don&#39;t want the user to ever be able to exit the textbox, just add <code>Cancel = True</code> in the <code>Exit</code> event."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1572026857, "post_id": 47312397, "comment_id": 103445868, "body": "A further solution to actually activate SetFocus might consist in 1.switching and reswitching the .Enabled property or alternatively  2.explicitly losing focus via any other control accepting focus (including also commandbuttons or frames) and eventually resetting focus again. See <a href=\"https://stackoverflow.com/questions/55011102/vba-userform-unexpected-behaviour-after-using-setfocus-on-a-textbox?noredirect=1&amp;lq=1\">Unexpected behaviour after using SetFocus on a text box</a>"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 7923970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a26e4779fea3eb0e24a0acf9f0ea73d1?s=128&d=identicon&r=PG&f=1", "display_name": "GigaByte123", "link": "https://stackoverflow.com/users/7923970/gigabyte123"}, "edited": false, "score": 0, "creation_date": 1510766990, "post_id": 47312607, "comment_id": 81578275, "body": "Well I tried your solution but the focus was again lost and transferred to another control. It seems that the <code>keyDown</code> event ultimately transfers the focus to another control"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1510763408, "creation_date": 1510763408, "answer_id": 47312607, "question_id": 47312397, "link": "https://stackoverflow.com/questions/47312397/how-to-select-text-in-a-textbox/47312607#47312607", "title": "How to select text in a textbox?", "body": "<pre><code> Application.enableevents = false\n Me.txtbox_add_folder.SetFocus\n Me.txtbox_add_folder.SelStart = 0\n Me.txtbox_add_folder.SelLength = Len(Me.txtbox_add_folder.Text)\n Application.enableevents = true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "is_accepted": false, "score": 0, "last_activity_date": 1510769385, "creation_date": 1510769385, "answer_id": 47314458, "question_id": 47312397, "link": "https://stackoverflow.com/questions/47312397/how-to-select-text-in-a-textbox/47314458#47314458", "title": "How to select text in a textbox?", "body": "<p>This technique is a little hacky, but it has worked for me before. It puts the cursor in the textbox and performs a Ctrl+A command (select all), which would highlight the text in that textbox.</p>\n\n<pre><code>Me.txtbox_add_folder.SetFocus\nSendKeys \"^A\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 7923970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a26e4779fea3eb0e24a0acf9f0ea73d1?s=128&d=identicon&r=PG&f=1", "display_name": "GigaByte123", "link": "https://stackoverflow.com/users/7923970/gigabyte123"}, "is_accepted": true, "score": 0, "last_activity_date": 1511359073, "creation_date": 1511359073, "answer_id": 47436544, "question_id": 47312397, "link": "https://stackoverflow.com/questions/47312397/how-to-select-text-in-a-textbox/47436544#47436544", "title": "How to select text in a textbox?", "body": "<p>I found a solution finally. Actually the focus was lost automatically after the event, so to avoid that, one should turn off the <code>TabStop</code> parameter in properties.</p>\n"}, {"tags": [], "owner": {"reputation": 441, "user_id": 3279899, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/cb89733ee4f3dda4f13415380f54ccec?s=128&d=identicon&r=PG&f=1", "display_name": "user3279899", "link": "https://stackoverflow.com/users/3279899/user3279899"}, "is_accepted": false, "score": 0, "last_activity_date": 1568218037, "creation_date": 1568218037, "answer_id": 57893035, "question_id": 47312397, "link": "https://stackoverflow.com/questions/47312397/how-to-select-text-in-a-textbox/57893035#57893035", "title": "How to select text in a textbox?", "body": "<p>My solution was to turn Tab Stop on <strong>ALL</strong> items that have Tab Stop except the textbox in question</p>\n\n<p>Then, after the application does whatever I've asked it to do with the textbox entry, used Application.SendKeys \"{TAB\"}</p>\n\n<p>I know it's crude, but when you want to use the textbox as a bar code scanner entry from across the room.</p>\n\n<p>Worked for me, but it is a very simple user form.</p>\n"}], "owner": {"reputation": 145, "user_id": 7923970, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a26e4779fea3eb0e24a0acf9f0ea73d1?s=128&d=identicon&r=PG&f=1", "display_name": "GigaByte123", "link": "https://stackoverflow.com/users/7923970/gigabyte123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3404, "favorite_count": 1, "accepted_answer_id": 47436544, "answer_count": 4, "score": 0, "last_activity_date": 1571403486, "creation_date": 1510762837, "last_edit_date": 1571403486, "question_id": 47312397, "link": "https://stackoverflow.com/questions/47312397/how-to-select-text-in-a-textbox", "title": "How to select text in a textbox?", "body": "<p>I have a userform with a textbox. I want to select the text within (highlight) after the keyDown event.</p>\n\n<p>There are some restrictions to what the end user can enter. In case of wrong entry, a message would pop up, and the text in the textbox inviting the user to enter something should be selected.</p>\n\n<p>I use the following code: </p>\n\n<pre><code>Me.txtbox_add_folder.SetFocus\nMe.txtbox_add_folder.SelStart = 0\nMe.txtbox_add_folder.SelLength = Len(Me.txtbox_add_folder.Text)\n</code></pre>\n\n<p>The <code>setFocus</code> doesn't work. It seems that it's because <code>setFocus</code> triggers a series of other events <a href=\"https://stackoverflow.com/questions/18990437/why-is-my-setfocus-ignored\">see this discussion</a>.</p>\n\n<p>The solution proposed in a different discussion is to include a <code>DoCmd.CancelEvent</code> or <code>Cancel = True</code>, so that the focus doesn't go to another control, but these commands don't work on Excel.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 5, "creation_date": 1510762734, "post_id": 47312317, "comment_id": 81575449, "body": "You are overwriting your password with MyPassword = &quot;Amanda&quot;     MyPassword = &quot;Chris&quot;     MyPassword = &quot;Laura&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1510762754, "post_id": 47312317, "comment_id": 81575466, "body": "So the only password is actually Laura. You will need perhaps a pass word array that you check the given password against."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1510762770, "post_id": 47312317, "comment_id": 81575477, "body": "That&#39;s because the  assignation operator (<code>=</code>) overwrite the value of <code>MyPassword</code>. So when you are at the <code>Select Case</code> the value will always be &quot;Laura&quot;. Try stepping through that code with the debugger and inspect the value of <code>MyPassword</code> at every line and you should understand."}, {"owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "edited": false, "score": 0, "creation_date": 1510762884, "post_id": 47312317, "comment_id": 81575547, "body": "Oh! This is great information. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "is_accepted": true, "score": 0, "last_activity_date": 1510765003, "creation_date": 1510765003, "answer_id": 47313144, "question_id": 47312317, "link": "https://stackoverflow.com/questions/47312317/vba-excel-password-will-always-accept-last-item-in-string-using-case/47313144#47313144", "title": "VBA Excel Password will always accept last item in string (using Case)", "body": "<p>Someone posted a corrected code and removed it for some reason. Here is the proper and working way they offered. (Please note the passwords are just placeholders. The passwords we use will not be like this.</p>\n\n<pre><code>Sub Pass()\n\nDim MyPassword As String\n\nMyPassword = InputBox(\"Please enter password to continue.\", \"Enter Password\")\n\nSelect Case MyPassword\n   Case \"Amanda\"\n      Sheets(\"Amanda\").Visible = True\n   Case \"Chris\"\n      Sheets(\"Chris\").Visible = True\n   Case \"Laura\"\n      Sheets(\"Laura\").Visible = True\n   Case \"\"\n      MsgBox \"Password can not be empty.\"\n   Case Else\n      MsgBox \"Wrong password. Please contact the Outcomes Department if you do not have a password.\"\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 7322437, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ea623e19c1c869a4eddcac16c673976?s=128&d=identicon&r=PG&f=1", "display_name": "jallington", "link": "https://stackoverflow.com/users/7322437/jallington"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 47313144, "answer_count": 1, "score": 0, "last_activity_date": 1510765128, "creation_date": 1510762597, "last_edit_date": 1510765128, "question_id": 47312317, "link": "https://stackoverflow.com/questions/47312317/vba-excel-password-will-always-accept-last-item-in-string-using-case", "title": "VBA Excel Password will always accept last item in string (using Case)", "body": "<p>This has been solved. Posted the proper code myself below. Someone shared and then removed it for an unknown reason so I duplicated it below. I am not allowed to answer my own question for 2 days however so I apologize if you came here to help. I am all set but our process is listed below.</p>\n\n<p>I am currently having an issue with my code shown below. When I complete this action, it will only unlock whomever's name is listed last in the MyPassword section. For example, no matter <em>what</em> I type, Laura's sheet is ALWAYS executed and will make the sheet visible. I tested this by switching Chris to the third slot in just the MyPassword section and it then would make only his sheet visible even if a wrong password was entered. </p>\n\n<p>Objective: They click a button and a box appears for a password. They enter their password and see only their sheet as listed in the row \"Case is\".</p>\n\n<p>What happens: No matter what is entered, whomever's name is listed last in this section: </p>\n\n<pre><code>Dim MyPassword As String\n    MyPassword = \"Amanda\"\n    MyPassword = \"Chris\"\n    MyPassword = \"Laura\"\n    If InputBox(\"Please enter password to continue.\", \"Enter Password\") &lt;&gt; MyPassword Then\n</code></pre>\n\n<p>Then they will have their page show. In this case it is Laura.</p>\n\n<p>I am self taught. What am I doing wrong?</p>\n\n<pre><code>Sub Pass()\n\n\nDim MyPassword As String\n    MyPassword = \"Amanda\"\n    MyPassword = \"Chris\"\n    MyPassword = \"Laura\"\n    If InputBox(\"Please enter password to continue.\", \"Enter Password\") &lt;&gt; MyPassword Then\n\nSelect Case MyPassword\n   Case Is = \"Amanda\"\n      Sheets(\"Amanda\").Visible = True\n   Case Is = \"Chris\"\n      Sheets(\"Chris\").Visible = True\n   Case Is = \"Laura\"\n      Sheets(\"Laura\").Visible = True\n   Case \"\"\n      MsgBox \"Password can not be empty.\"\n   Case Else\n      MsgBox \"Wrong password. Please contact the Compliance Department if you do not have a password.\"\nEnd Select\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Note: Please stop telling me this is not the way to do this because there are back doors around this where they can still see xlVeryHidden sheets. The audience is not proficient in excel.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510762634, "post_id": 47312108, "comment_id": 81575377, "body": "You need to seach for each entity and establish it&#39;s row, column etc.  It&#39;s possible, I&#39;ve done it. You need to define your own structure to search though."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1510763114, "post_id": 47312108, "comment_id": 81575698, "body": "Also, it&#39;s best to <a href=\"https://stackoverflow.com/questions/10714251/\">avoid using <code>.Select</code>/<code>.Activate</code></a>, which also will help cut down the code length.  Also, it looks like mainly you just need to get your headers set up, and you could use <code>Index&#47;Match()</code>, no? (Perhaps with multiple criteria)"}, {"owner": {"reputation": 2912, "user_id": 4508605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09c117a19673dd3634a08022c8f75fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4508605/andrew"}, "edited": false, "score": 0, "creation_date": 1510763163, "post_id": 47312108, "comment_id": 81575739, "body": "yes but i am quiet new to vba coding ang getting idea about the same"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1510763686, "post_id": 47312108, "comment_id": 81576139, "body": "You can do all this without VBA. Have a look at Get &amp; Transform on the Data tab"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510763703, "post_id": 47312108, "comment_id": 81576155, "body": "... with all respect Andrew!"}, {"owner": {"reputation": 2912, "user_id": 4508605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09c117a19673dd3634a08022c8f75fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4508605/andrew"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1510764152, "post_id": 47312108, "comment_id": 81576456, "body": "@Sam without VBA how can we dont ?thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510764781, "post_id": 47312108, "comment_id": 81576908, "body": "I repeat: You cannot do this unless you are fluent in VBA. Now you are way out your league. Sorry"}, {"owner": {"reputation": 2912, "user_id": 4508605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09c117a19673dd3634a08022c8f75fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4508605/andrew"}, "edited": false, "score": 0, "creation_date": 1510764874, "post_id": 47312108, "comment_id": 81576989, "body": "@peakpeak if you can do this please help me"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510765120, "post_id": 47312108, "comment_id": 81577168, "body": "When I started programming in 1980 there was noone to ask. Today we have Google. Learn from it!"}], "answers": [{"comments": [{"owner": {"reputation": 2912, "user_id": 4508605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09c117a19673dd3634a08022c8f75fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4508605/andrew"}, "edited": false, "score": 0, "creation_date": 1510775375, "post_id": 47315829, "comment_id": 81582957, "body": "thanks for your information i am just going through get and transform functionality. Just wanted to know for my example do you suggest any specific tutorial which i look into. Otherwiese i have to spend lot of time by learning through all the functionality of get and transform ?"}, {"owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "reply_to_user": {"reputation": 2912, "user_id": 4508605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09c117a19673dd3634a08022c8f75fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4508605/andrew"}, "edited": false, "score": 0, "creation_date": 1510775857, "post_id": 47315829, "comment_id": 81583222, "body": "It won&#39;t take you too long to find something similar, using those names I gave you as google filters. And then you&#39;ll quickly see just how easy it is to muddle through using this tool. I use it all the time to do stuff that I have no idea how to do, and I&#39;ve found time and time again that the tool is very forgiving to lack of knowledge."}], "tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1510774457, "creation_date": 1510774457, "answer_id": 47315829, "question_id": 47312108, "link": "https://stackoverflow.com/questions/47312108/create-new-sheet-and-organize-result/47315829#47315829", "title": "Create new sheet and organize result", "body": "<p>Andrew: What version of Excel do you have? If you have Excel 2013 or later, you can use the new functionality under the 'Get and Transform' tab to do this really easily. It was previously a separate add-in called PowerQuery, and is now bulk standard in Excel. </p>\n\n<p>There's many excellent walkthroughs on the internet showing this exact type of activity. Google \"PowerQuery\"  and put a date filter on your results to show just the last year, as the functionality is constantly being updated. Add \"Ken Puls\" to your search term, and see what bubbles to the top. Then replace Ken \"Mike Girvin\" or \"ExcelIsFun\" and you should see like a zillion excellent tutorials on PowerQuery. Try \"ExcelCampus\" too, as Jon has great tutorials, as does \"Chandoo\". Also replace PowerQuery with \"Get and Transform\" and repeat those same searches.</p>\n\n<p>PowerQuery is simple to learn, and lets you do stuff just by \"muddling through\" that would otherwise take a year or more to learn if you wanted to pick up VBA.</p>\n\n<p>It acts like a user-friendly macro recorder, only unlike the macro recorder it spits out reusable code that doesn't have hard coded references in it. </p>\n"}], "owner": {"reputation": 2912, "user_id": 4508605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/09c117a19673dd3634a08022c8f75fd0?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew", "link": "https://stackoverflow.com/users/4508605/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510843073, "creation_date": 1510761979, "last_edit_date": 1510843073, "question_id": 47312108, "link": "https://stackoverflow.com/questions/47312108/create-new-sheet-and-organize-result", "title": "Create new sheet and organize result", "body": "<p>I am creating a report from Cognos which is generating the result below in Excel format:</p>\n\n<p>The problem with the code is everything I have hardcoded the values based on line numbers and which I want to make dynamic, so that if I have to generate a report for the previous 2 weeks, then I won't have to change my macro code every time.</p>\n\n<p>Currently I am showing the value for <code>name</code> = \"PO\" and <code>id</code> = 28. But there will be other <code>name</code> and <code>id</code> also. For every <code>name</code> and <code>id</code> there will be 4 column values as for <code>RR</code>, <code>DD</code>, <code>EE</code> and <code>FF</code>. I have to group them based on <code>name</code> and <code>id</code> and create new sheet which will have results like below:</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1510761720, "post_id": 47311912, "comment_id": 81574723, "body": "if you enter =SUM(IF((master_PayDate&gt;=R14C),master_TotalCost)) as an array formula in the spreadsheet does it return a value? Or an error."}, {"owner": {"reputation": 11, "user_id": 8308945, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-34wayVGEpxk/AAAAAAAAAAI/AAAAAAAAAAA/j4cEEnw82Yk/photo.jpg?sz=128", "display_name": "Ken Kolb", "link": "https://stackoverflow.com/users/8308945/ken-kolb"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1510763197, "post_id": 47311912, "comment_id": 81575763, "body": "It errors. Excel suggested a fix &amp; when I accept, it works. Funny thing, both formulas look exactly alike. Non-printing characters?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1510763528, "post_id": 47311912, "comment_id": 81576053, "body": "Probably a space where it shouldn&#39;t be. If you copy the correct formula back into your code does it now replace correctly?"}, {"owner": {"reputation": 11, "user_id": 8308945, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-34wayVGEpxk/AAAAAAAAAAI/AAAAAAAAAAA/j4cEEnw82Yk/photo.jpg?sz=128", "display_name": "Ken Kolb", "link": "https://stackoverflow.com/users/8308945/ken-kolb"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1510763565, "post_id": 47311912, "comment_id": 81576072, "body": "Recorded a macro with the corrected formula &amp; added that string as arrayTxt2 - still no error &amp; no replacement"}, {"owner": {"reputation": 11, "user_id": 8308945, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-34wayVGEpxk/AAAAAAAAAAI/AAAAAAAAAAA/j4cEEnw82Yk/photo.jpg?sz=128", "display_name": "Ken Kolb", "link": "https://stackoverflow.com/users/8308945/ken-kolb"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1510763837, "post_id": 47311912, "comment_id": 81576247, "body": "Just copied the string directly from the cell &amp; pasted it into my code &amp; it works! I&#39;ll try the whole string now"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1510764261, "post_id": 47311912, "comment_id": 81576537, "body": "do you have <code>On Error Resume Next</code> anywhere in the code?"}, {"owner": {"reputation": 11, "user_id": 8308945, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-34wayVGEpxk/AAAAAAAAAAI/AAAAAAAAAAA/j4cEEnw82Yk/photo.jpg?sz=128", "display_name": "Ken Kolb", "link": "https://stackoverflow.com/users/8308945/ken-kolb"}, "edited": false, "score": 0, "creation_date": 1510764603, "post_id": 47311912, "comment_id": 81576777, "body": "&quot;Cleansed&quot; the whole string &amp; it works fine now. Thanks for the tip!"}, {"owner": {"reputation": 11, "user_id": 8308945, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-34wayVGEpxk/AAAAAAAAAAI/AAAAAAAAAAA/j4cEEnw82Yk/photo.jpg?sz=128", "display_name": "Ken Kolb", "link": "https://stackoverflow.com/users/8308945/ken-kolb"}, "edited": false, "score": 0, "creation_date": 1510764790, "post_id": 47311912, "comment_id": 81576921, "body": "Scott - just checked, no on error in this macro"}], "owner": {"reputation": 11, "user_id": 8308945, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-34wayVGEpxk/AAAAAAAAAAI/AAAAAAAAAAA/j4cEEnw82Yk/photo.jpg?sz=128", "display_name": "Ken Kolb", "link": "https://stackoverflow.com/users/8308945/ken-kolb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510761431, "creation_date": 1510761431, "last_edit_date": 1531164843, "question_id": 47311912, "link": "https://stackoverflow.com/questions/47311912/breaking-up-a-array-formula-that-is-too-long-using-replace", "title": "Breaking up a array formula that is too long using REPLACE", "body": "<p>I am trying to break up a array formula that is too long. Found an answer using REPLACE (thanks group!) but cannot get an a replacement using an already tested array formula. Replace solution works fine if I don't use an array formula as the replacement string. If  using an string representing an array formula, code does not error, but does not replace.</p>\n\n<p>Basically, I am calculating a cost/lb where arrayTxt1 = cost &amp; arrayTxt2 = pounds &amp; arrayTxt1 / arrayTxt2 is cost/lb. Both array formulas work fine on their own. I have tried shortening the second array string w/o any luck.</p>\n\n<pre><code>arrayTxt1 = \"=SUM(IF((master_PayDate&gt;=R14C)*(master_PayDate&lt;EDATE(R14C,1))*\n(master_Supplier=\"\"\" &amp; selValue &amp; \"\"\"),\" &amp; sumMetric1 &amp; \"))/1\"\n\n'this works\narrayTxt2 = \"/CountA(master_Supplier)\"\n\n'no error but does not replace\narrayTxt2 = \"/SUM(IF((master_PayDate&gt;=R14C),master_TotalCost))\"\n\n'actual string I want to use\n'arrayTxt2 = \"SUM(IF((master_PayDate&gt;=R14C)*(master_PayDate&lt;EDATE(R14C,1))*\n'(master_Supplier=\"\"\" &amp; selValue &amp; \"\"\"),\" &amp; sumMetric2 &amp; \"))\" \n\nSet selRng = .Cells(sumRow + 1, firstCol + 2)\nWith selRng\n                 .FormulaArray = arrayTxt1\n                 .Replace \"/1\", arrayTxt2, xlPart\nEnd With\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "lookup"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510761591, "post_id": 47311843, "comment_id": 81574619, "body": "Nice illustration. From that I can easily write code that do what you want.  I have no idea what your massive code is trying to do. You complicate things."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1510761886, "post_id": 47311843, "comment_id": 81574853, "body": "wouldn&#39;t a function based index/match solution be easier?"}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1510762111, "post_id": 47311843, "comment_id": 81575021, "body": "i&#39;d recommend reading this article <a href=\"https://www.soa.org/News-and-Publications/Newsletters/Compact/2012/january/com-2012-iss42-roper.aspx\" rel=\"nofollow noreferrer\">soa.org/News-and-Publications/Newsletters/Compact/2012/janua&zwnj;&#8203;ry/&hellip;</a> and storing your spreadsheet data in arrays"}, {"owner": {"reputation": 1, "user_id": 8946201, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155202979322756/picture?type=large", "display_name": "McManus", "link": "https://stackoverflow.com/users/8946201/mcmanus"}, "edited": false, "score": 0, "creation_date": 1510762397, "post_id": 47311843, "comment_id": 81575232, "body": "@Peakpeak: At the moment, it compares the 2 values. When it matches on an autofilter it copies through the values from table 2 and then proceeds to the next key.  HarassedDad - this is part of a larger VBA where I have automated a sequence of tasks. This is one part of it that takes time which can be sped up. The aim is to a) reduce time even further and b) to keep it down to a 1 button press and boom - done.  MiguelH - thanks, I&#39;ll read now. I&#39;ve read a few ways to approach my problem and my head just ends up hurting; ideally, I want the solution that is automated and fastest"}, {"owner": {"reputation": 1, "user_id": 8946201, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155202979322756/picture?type=large", "display_name": "McManus", "link": "https://stackoverflow.com/users/8946201/mcmanus"}, "edited": false, "score": 0, "creation_date": 1510763183, "post_id": 47311843, "comment_id": 81575753, "body": "Edited to show whole code"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1510763504, "post_id": 47311843, "comment_id": 81576030, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/47292528/compare-2-sets-of-data-and-paste-any-missing-values-on-another-sheet/47293057#47293057\">Compare 2 sets of data and paste any missing values on another sheet</a>."}, {"owner": {"reputation": 1, "user_id": 8946201, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155202979322756/picture?type=large", "display_name": "McManus", "link": "https://stackoverflow.com/users/8946201/mcmanus"}, "edited": false, "score": 0, "creation_date": 1511271394, "post_id": 47311843, "comment_id": 81782293, "body": "Thank you all for your responses  - apologies for taking a while to get back. Instead of passing through the values to a 3rd sheet. How do I pass them back to overwrite the 1st?"}], "answers": [{"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 2, "last_activity_date": 1510763692, "last_edit_date": 1510763692, "creation_date": 1510763280, "answer_id": 47312571, "question_id": 47311843, "link": "https://stackoverflow.com/questions/47311843/comparing-a-value-between-two-arrays-and-passing-back/47312571#47312571", "title": "Comparing a value between two arrays and passing back", "body": "<p>You can use <code>Find</code> function to find the row number you are looking for. Then using this row number, you can have the data from that row.</p>\n\n<p>I didn't dig into your code too much, because it is a bit messy. So considering that:</p>\n\n<ul>\n<li>Blank Lookup sheet name is \"TABLE 1 SHEET\", </li>\n<li>Master Lookup sheet name is \"TABLE 2 SHEET\",</li>\n<li>Results sheet name is \"TABLE 3 SHEET\",</li>\n</ul>\n\n<p>then you can try the following:</p>\n\n<pre><code>Sub findmydata()\nDim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet\nDim i As Long, j As Long, foundrow As Long, lastrow1 As Long, lastrow2 As Long\n\nSet ws1 = Sheets(\"TABLE 1 SHEET\")\nSet ws2 = Sheets(\"TABLE 2 SHEET\")\nSet ws3 = Sheets(\"TABLE 3 SHEET\")\n\nlastrow1 = ws1.Cells(ws1.Rows.Count, \"A\").End(xlUp).Row\nlastrow2 = ws2.Cells(ws2.Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 1 To lastrow1\n    On Error Resume Next\n    foundrow = ws2.Range(\"A1:A\" &amp; lastrow2).Find(ws1.Cells(i, 1).Value).Row\n    If Err.Number = 91 Then\n        ws3.Cells(i, 1) = ws1.Cells(i, 1)\n    Else\n        For j = 1 To 4\n            ws3.Cells(i, j) = ws2.Cells(foundrow, j)\n        Next j\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8946201, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155202979322756/picture?type=large", "display_name": "McManus", "link": "https://stackoverflow.com/users/8946201/mcmanus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612318870, "creation_date": 1510761274, "last_edit_date": 1612318870, "question_id": 47311843, "link": "https://stackoverflow.com/questions/47311843/comparing-a-value-between-two-arrays-and-passing-back", "title": "Comparing a value between two arrays and passing back", "body": "<p>I have two tables that have an identical column structure where the information passed from a different department is put into the first template.</p>\n<p>I want to look at the SKU from Table 1 and pass back everything that matches on that row in Table 2 - whilst ignoring any SKU code that is not on Table 1.</p>\n<p>Graphical illustration of problem<br />\n<a href=\"https://i.stack.imgur.com/jET2j.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jET2j.png\" alt=\"enter image description here\" /></a></p>\n<p>The code is part of a larger sub (variables are declared prior etc.) which uses a scripting dictionary and then goes through a For loop - but this is not efficient:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    Set dlCD1 = CreateObject(&quot;Scripting.Dictionary&quot;)\n    Row = 1\n    On Error GoTo Error\n    For Each cCD1 In Sheets(&quot;TABLE 2 SHEET&quot;).Range(&quot;c1:c&quot; &amp; MaxLineMPS)\n        tmpCD1 = Trim(cCD1.Value)\n        If Len(tmpCD1) &lt; 10 Then tmpCD1 = &quot;0&quot; &amp; tmpCD1\n        If Len(tmpCD1) &gt; 0 Then dlCD1(tmpCD1) = dlCD1(tmpCD1) + 1\n    Next cCD1\n    \n    For Each kCD1 In dlCD1.keys\n    \n        With Sheets(&quot;TABLE 1 SHEET&quot;).Range(&quot;a2:x&quot; &amp; MaxLineMatrice)\n            .AutoFilter Field:=3, Criteria1:=kCD1\n        End With\n    \n        If Sheets(&quot;TABLE 1 SHEET&quot;).Range(&quot;A2:A&quot; &amp; MaxLineMatrice).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n            With Sheets(&quot;TABLE 1 SHEET&quot;).Range(&quot;d$3:x&quot; &amp; &quot;$&quot; &amp; MaxLineMatrice).SpecialCells(xlCellTypeVisible)\n                .Value = Sheets(&quot;TABLE 2 SHEET&quot;).Range(&quot;$d&quot; &amp; &quot;$&quot; &amp; Row &amp; &quot;:$x&quot; &amp; &quot;$&quot; &amp; Row).Value\n            End With\n        Else: End If\n    \n        Row = Row + 1\n        Debug.Print kCD1, dlCD1(kCD1)\n    Next kCD1\n    \n    Worksheets(&quot;TABLE 1 SHEET&quot;).AutoFilterMode = False\n    dlCD1.RemoveAll\n</code></pre>\n<p>I have thousands of SKU codes and this takes time to loop through. I am told that by doing this outside of the sheet I can do the job faster.</p>\n<p>Here's my whole code:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Month_RiempiFuturo()\n    Dim MinLineMatrice As Integer, MaxLineMatrice As Integer, MinLineMPS As Integer, MaxLineMPS As Integer, row As Integer\n    Dim dlCD1 As Object, cCD1 As Range, kCD1, tmpCD1 As String, dlCD2 As Object, cCD2 As Range, kCD2, tmpCD2 As String\n    Dim StartTime As Double, SecondsElapsed As Double\n    Dim PT1 As PivotTable\n    Application.EnableEvents = False\n    Application.DisplayStatusBar = False\n    Application.ScreenUpdating = False\n    ActiveSheet.DisplayPageBreaks = False\n    Application.Calculation = xlCalculationManual\n    Worksheets(&quot;TABLE SHEET 1&quot;).AutoFilterMode = False\n    Worksheets(&quot;TABLE SHEET 2&quot;).AutoFilterMode = False\n    StartTime = Timer\n    MinLineMatrice = 3\n    MaxLineMatrice = Sheets(&quot;TABLE SHEET 1&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\n    MinLineMPS = 1\n    MaxLineMPS = Sheets(&quot;TABLE SHEET 2&quot;).Range(&quot;C&quot; &amp; Rows.Count).End(xlUp).Row\n    LastLineFINITY = Sheets(&quot;FINITY CAPACITY PLANNED&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\n    Set PT1 = Worksheets(&quot;shift&quot;).PivotTables(&quot;Tabella_pivot1&quot;)\n    Worksheets(&quot;TABLE SHEET 1&quot;).Range(&quot;d3:x&quot; &amp; MaxLineMatrice).ClearContents\n    Set dlCD1 = CreateObject(&quot;Scripting.Dictionary&quot;)\n    Row = 1\n    On Error GoTo Error\n    For Each cCD1 In Sheets(&quot;TABLE SHEET 2&quot;).Range(&quot;c1:c&quot; &amp; MaxLineMPS)\n        tmpCD1 = Trim(cCD1.Value)\n        If Len(tmpCD1) &lt; 10 Then tmpCD1 = &quot;0&quot; &amp; tmpCD1\n        If Len(tmpCD1) &gt; 0 Then dlCD1(tmpCD1) = dlCD1(tmpCD1) + 1\n    Next cCD1\n    For Each kCD1 In dlCD1.keys\n        With Worksheets(&quot;TABLE SHEET 1&quot;).Range(&quot;a2:x&quot; &amp; MaxLineMatrice)\n            .AutoFilter Field:=3, Criteria1:=kCD1\n        End With\n        If Sheets(&quot;TABLE SHEET 1&quot;).Range(&quot;A2:A&quot; &amp; MaxLineMatrice).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n            With Sheets(&quot;TABLE SHEET 1&quot;).Range(&quot;d$3:x&quot; &amp; &quot;$&quot; &amp; MaxLineMatrice).SpecialCells(xlCellTypeVisible)\n                .Value = Sheets(&quot;TABLE SHEET 2&quot;).Range(&quot;$d&quot; &amp; &quot;$&quot; &amp; Row &amp; &quot;:$x&quot; &amp; &quot;$&quot; &amp; Row).Value\n            End With\n        Else: End If\n        Row = Row + 1\n        Debug.Print kCD1, dlCD1(kCD1)\n    Next kCD1\n    Worksheets(&quot;TABLE SHEET 1&quot;).AutoFilterMode = False\n    dlCD1.RemoveAll\n    Set dlCD1 = CreateObject(&quot;Scripting.Dictionary&quot;)\n    For Each cCD1 In Sheets(&quot;Finity capacity planned&quot;).Range(&quot;a2:a&quot; &amp; LastLineFINITY)\n        tmpCD1 = Trim(cCD1.Value)\n        If Len(tmpCD1) &gt; 0 Then dlCD1(tmpCD1) = dlCD1(tmpCD1) + 1\n    Next cCD1\n    Set dlCD2 = CreateObject(&quot;Scripting.Dictionary&quot;)\n    For Each cCD2 In Sheets(&quot;Finity capacity planned&quot;).Range(&quot;b2:b&quot; &amp; LastLineFINITY)\n        tmpCD2 = Trim(cCD2.Value)\n        If Len(tmpCD2) &gt; 0 Then dlCD2(tmpCD2) = dlCD2(tmpCD2) + 1\n    Next cCD2\n    For Each kCD1 In dlCD1.keys\n        With Sheets(&quot;Finity capacity planned&quot;).Range(&quot;A1:Ak&quot; &amp; LastLineFINITY)\n            .AutoFilter Field:=1, Criteria1:=kCD1\n            .AutoFilter Field:=2, Criteria1:=Array( _\n              dlCD2.keys()(0), dlCD2.keys()(2), dlCD2.keys()(4), dlCD2.keys()(6), dlCD2.keys()(8), dlCD2.keys()(10)), Operator:=xlFilterValues\n        End With\n        With Sheets(&quot;Finity capacity planned&quot;).Range(&quot;A2:Ak&quot; &amp; LastLineFINITY).SpecialCells(xlCellTypeVisible)\n            .Interior.ColorIndex = 15\n        End With\n        With Sheets(&quot;Finity capacity planned&quot;).Range(&quot;A1:Ak&quot; &amp; LastLineFINITY)\n            .AutoFilter Field:=1, Criteria1:=kCD1\n            .AutoFilter Field:=2, Criteria1:=Array( _\n              dlCD2.keys()(1), dlCD2.keys()(3), dlCD2.keys()(5), dlCD2.keys()(7), dlCD2.keys()(9), dlCD2.keys()(11)), Operator:=xlFilterValues\n        End With\n        With Sheets(&quot;Finity capacity planned&quot;).Range(&quot;A2:Ak&quot; &amp; LastLineFINITY).SpecialCells(xlCellTypeVisible)\n            .Interior.ColorIndex = 19\n        End With\n        Debug.Print kCD1, dlCD1(kCD1)\n    Next kCD1\n    Worksheets(&quot;Finity capacity planned&quot;).AutoFilterMode = False\n    dlCD1.RemoveAll\n    dlCD2.RemoveAll\n    With PT1\n        .RefreshTable\n    End With\n    Application.EnableEvents = True\n    Application.DisplayStatusBar = True\n    Application.ScreenUpdating = True\n    ActiveSheet.DisplayPageBreaks = True\n    Application.Calculation = xlCalculationAutomatic\n    SecondsElapsed = Round(Timer - StartTime, 2)\n    MsgBox &quot;This code including the time for user prompts to be acknowledged took &quot; &amp; SecondsElapsed &amp; &quot; Seconds&quot;, vbInformation, &quot;McManus automation speed testing&quot;\n    Exit Sub\nError:\n    Application.EnableEvents = True\n    Application.DisplayStatusBar = True\n    Application.ScreenUpdating = True\n    ActiveSheet.DisplayPageBreaks = True\n    Application.Calculation = xlCalculationAutomatic\n    MsgBox &quot;Something went wrong&quot;\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "edited": false, "score": 0, "creation_date": 1510762417, "post_id": 47311937, "comment_id": 81575252, "body": "Thanks again Scott. Much appreciated"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 2, "last_activity_date": 1510761498, "creation_date": 1510761498, "answer_id": 47311937, "question_id": 47311820, "link": "https://stackoverflow.com/questions/47311820/how-to-name-your-tables-after-the-sheet-names/47311937#47311937", "title": "How to Name your Tables after the Sheet Names", "body": "<p>Use the <code>Parent</code> property to get the name of the worksheet (the parent object of a table).</p>\n\n<pre><code>With myTable\n    .Name = .Parent.Name\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6932758, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4bca369fc49e280e4e4510f2a34da53e?s=128&d=identicon&r=PG&f=1", "display_name": "jules325", "link": "https://stackoverflow.com/users/6932758/jules325"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 47311937, "answer_count": 1, "score": 1, "last_activity_date": 1510761498, "creation_date": 1510761204, "last_edit_date": 1531164843, "question_id": 47311820, "link": "https://stackoverflow.com/questions/47311820/how-to-name-your-tables-after-the-sheet-names", "title": "How to Name your Tables after the Sheet Names", "body": "<p>I want to name my tables I'm creating in VBA according to the worksheet name they're on. </p>\n\n\n\n<pre><code>   With myTable\n                .Name = Application.Caller.Worksheet.Name\n                .TableStyle = \"TableStyleLight1\"\n            End With\n</code></pre>\n\n<p>I get a run time error '424' which says \"Object Required\" </p>\n\n<p>How do I have the tables I'm creating via previous code name the tables the same as the worksheet names? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1510761541, "last_edit_date": 1510761541, "creation_date": 1510761229, "answer_id": 47311827, "question_id": 47311785, "link": "https://stackoverflow.com/questions/47311785/split-a-string-vba-based-on-symbols/47311827#47311827", "title": "Split a String - Vba based on symbols", "body": "<pre><code>Split(String1,\"$\")\n</code></pre>\n\n<p>Quite enough. Returns a zero-based, one-dimensional array containing a specified number of substrings. </p>\n\n<p>If you want to look through the splitted string, this is a possible solution:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim str     As String\n    Dim cnt     As Long\n\n    str = \"ABC$3$FG$H\"\n    For cnt = LBound(Split(str, \"$\")) To UBound(Split(str, \"$\"))\n        Debug.Print Split(str, \"$\")(cnt)\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/split-function\" rel=\"nofollow noreferrer\">The MSDN documentation for Split</a>.</p>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 47311827, "answer_count": 1, "score": 1, "last_activity_date": 1518630511, "creation_date": 1510761128, "last_edit_date": 1518630511, "question_id": 47311785, "link": "https://stackoverflow.com/questions/47311785/split-a-string-vba-based-on-symbols", "title": "Split a String - Vba based on symbols", "body": "<p>I have a string like this <code>ABC$3$FG$H</code>and I want to split them into 4 different strings. </p>\n\n<pre><code>string1 - ABC, Number-3, string3-FG, String4 - H.\n</code></pre>\n\n<p>I am splitting the string with $ sign in the actual string.</p>\n"}, {"tags": ["vba", "charts"], "owner": {"reputation": 11, "user_id": 847090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/372ac214cbd73761a570d5a313047efb?s=128&d=identicon&r=PG", "display_name": "Katto Ishimura", "link": "https://stackoverflow.com/users/847090/katto-ishimura"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510760768, "creation_date": 1510760285, "last_edit_date": 1510760768, "question_id": 47311461, "link": "https://stackoverflow.com/questions/47311461/vba-how-to-create-chart-with-multiple-collections-definde-by-cells", "title": "VBA - How to create Chart with multiple collections definde by cells", "body": "<p>I am trying to create a chart with many plots and would like to do something similar to the code below.</p>\n\n<pre><code>Sub Macro1()\n'\nDim R1, R2, R3, R4, R5, R6, R7 As Range\nDim RR(11) As Range\nSheet2.Select\nFor i = 0 To 11\n    Set RR(i) = Range(Cells(9, 2 + 9 * i), Cells(209, 2 + 9 * i))\nNext i\n'\n    Range(RR(0),RR(1),RR(2),RR(3),RR(4),RR(5),RR(6),RR(7),RR(8),RR(9),RR(10),RR(11)).Select\n\n    ActiveSheet.Shapes.AddChart2(240, xlXYScatterLinesNoMarkers).Select\n    ActiveChart.SetSourceData Source:=Range(RR(0),RR(1),RR(2))\n    ActiveChart.SeriesCollection.NewSeries\n    ActiveChart.FullSeriesCollection(1).Name = CELLS(8,2)\n    ActiveChart.FullSeriesCollection(1).XValues = RR(0)\n    ActiveChart.FullSeriesCollection(1).Values =RR(1)\n    FOR I=2 TO 11\n       ActiveChart.FullSeriesCollection(I).Name = CELLS(8,2 + 9 * i)\n       ActiveChart.FullSeriesCollection(I).XValues = RR(0)\n       ActiveChart.FullSeriesCollection(I).Values =RR(I)\n    NEXT I\nEnd Sub\n</code></pre>\n\n<p>Please advise</p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1510760162, "post_id": 47311350, "comment_id": 81573455, "body": "Welcome to SO, I could not find a clear question, can you modify your post and define a question to solve? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1510760636, "post_id": 47311350, "comment_id": 81573859, "body": "&quot;<i>I want it to compare and paste the data in the next empty column</i>&quot; &quot;<i>I want &quot;B&quot; to be emptyColumn but I am not able to do that</i>&quot;. Are you trying to paste in the next empty column? Or the column B, not sure what you want here"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1510760756, "post_id": 47311350, "comment_id": 81573947, "body": "Also, I noticed in your code on the line your questioning, it&#39;s missing an <code>End If</code> statement. Maybe that&#39;s the issue to your problem here?"}, {"owner": {"reputation": 3, "user_id": 8904016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-96_AWjB2k8c/AAAAAAAAAAI/AAAAAAAAK98/CqLSjU5Ko70/photo.jpg?sz=128", "display_name": "Anish Jal", "link": "https://stackoverflow.com/users/8904016/anish-jal"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1510760805, "post_id": 47311350, "comment_id": 81573989, "body": "@Maldred I want it to paste it in the next empty column."}, {"owner": {"reputation": 3, "user_id": 8904016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-96_AWjB2k8c/AAAAAAAAAAI/AAAAAAAAK98/CqLSjU5Ko70/photo.jpg?sz=128", "display_name": "Anish Jal", "link": "https://stackoverflow.com/users/8904016/anish-jal"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1510761088, "post_id": 47311350, "comment_id": 81574224, "body": "@Maldred My problem lies in the line &quot;If FR &lt;&gt; 0 Then w2.Range(&quot;B&quot; &amp; FR).Value = c.Offset(0, 1)&quot;. I want &quot;B&quot; to be written as emptyColumn"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1510761091, "post_id": 47311350, "comment_id": 81574227, "body": "Please be more specific"}, {"owner": {"reputation": 3, "user_id": 8904016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-96_AWjB2k8c/AAAAAAAAAAI/AAAAAAAAK98/CqLSjU5Ko70/photo.jpg?sz=128", "display_name": "Anish Jal", "link": "https://stackoverflow.com/users/8904016/anish-jal"}, "edited": false, "score": 0, "creation_date": 1510761466, "post_id": 47311350, "comment_id": 81574523, "body": "@peakpeak I added images. If you could help me now I would be grateful"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8904016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-96_AWjB2k8c/AAAAAAAAAAI/AAAAAAAAK98/CqLSjU5Ko70/photo.jpg?sz=128", "display_name": "Anish Jal", "link": "https://stackoverflow.com/users/8904016/anish-jal"}, "edited": false, "score": 0, "creation_date": 1510760971, "post_id": 47311668, "comment_id": 81574119, "body": "My problem lies in the line &quot;If FR &lt;&gt; 0 Then w2.Range(&quot;B&quot; &amp; FR).Value = c.Offset(0, 1)&quot;. I want &quot;B&quot; to be written as emptyColumn"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 3, "user_id": 8904016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-96_AWjB2k8c/AAAAAAAAAAI/AAAAAAAAK98/CqLSjU5Ko70/photo.jpg?sz=128", "display_name": "Anish Jal", "link": "https://stackoverflow.com/users/8904016/anish-jal"}, "edited": false, "score": 0, "creation_date": 1510761485, "post_id": 47311668, "comment_id": 81574541, "body": "&quot;If FR &lt;&gt; 0 Then w2.cells( FR,emptycolumn).Value = c.Offset(0, 1)&quot;"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1510764542, "post_id": 47311668, "comment_id": 81576736, "body": "If this solved your issue, please mark it as answered"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": true, "score": 0, "last_activity_date": 1510760816, "creation_date": 1510760816, "answer_id": 47311668, "question_id": 47311350, "link": "https://stackoverflow.com/questions/47311350/my-macro-compares-and-pastes-data-to-the-specified-column-i-want-it-to-compare/47311668#47311668", "title": "My macro compares and pastes data to the specified column. I want it to compare and paste the data in the next empty column", "body": "<pre><code> emptyColumn = w2.Cells(2, w2.Columns.Count).End(xlToLeft).Column\n If emptyColumn &gt; 1 Then\n       emptyColumn = emptyColumn + 1\n End If\n</code></pre>\n\n<p>This returns the  column in row 2 for which there are no entries to the right. What you want (I think) is the first column to not hold any data at all)</p>\n\n<pre><code> emptycolumn = w2.usedrange.columns.count +1\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8904016, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-96_AWjB2k8c/AAAAAAAAAAI/AAAAAAAAK98/CqLSjU5Ko70/photo.jpg?sz=128", "display_name": "Anish Jal", "link": "https://stackoverflow.com/users/8904016/anish-jal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 47311668, "answer_count": 1, "score": 0, "last_activity_date": 1510761387, "creation_date": 1510759947, "last_edit_date": 1531164843, "question_id": 47311350, "link": "https://stackoverflow.com/questions/47311350/my-macro-compares-and-pastes-data-to-the-specified-column-i-want-it-to-compare", "title": "My macro compares and pastes data to the specified column. I want it to compare and paste the data in the next empty column", "body": "<p><a href=\"https://i.stack.imgur.com/S0Fyy.jpg\" rel=\"nofollow noreferrer\">[The sheet from where the data is to be copied, columnB2:B]</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/faxDC.jpg\" rel=\"nofollow noreferrer\">As columnB is filled I want the data in Sheet1 ColumnB to be copied to the next empty column in Sheet</a><a href=\"https://i.stack.imgur.com/SLM6b.jpg\" rel=\"nofollow noreferrer\">3</a></p>\n\n<p>My macro compares and pastes data to the specified column. I want it to compare and paste the data in the next empty column.In the line \"If FR &lt;> 0 Then w2.Range(\"B\" &amp; FR).Value = c.Offset(0, 1)\" I want \"B\" to be emptyColumn but I am not able to do that.</p>\n\n<pre><code>Sub UpdateW2()\n\n    Dim w1 As Worksheet, w2 As Worksheet\n    Dim c As Range, FR As Long\n    Dim emptyColumn As Long\n\n    Application.ScreenUpdating = False\n\n    Set w1 = Sheet1\n    Set w2 = Sheet2\n\n    emptyColumn = w2.Cells(2, w2.Columns.Count).End(xlToLeft).Column\n    If emptyColumn &gt; 1 Then\n        emptyColumn = emptyColumn + 1\n    End If\n\n    For Each c In w1.Range(\"B2\", w1.Range(\"A\" &amp; Rows.Count).End(xlUp))\n        FR = 0\n        On Error Resume Next\n        FR = Application.Match(c, w2.Columns(\"A\"), 0)\n        On Error GoTo 0\n        If FR &lt;&gt; 0 Then w2.Range(\"B\" &amp; FR).Value = c.Offset(0, 1)\n    Next c\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "listbox", "event-handling", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1510759930, "post_id": 47310890, "comment_id": 81573280, "body": "What about disable the Listbox? <code>Listbox.Enabled = False</code>"}, {"owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "edited": false, "score": 0, "creation_date": 1510787202, "post_id": 47310890, "comment_id": 81588833, "body": "No. I need the Click event to dispatch the column values in different textboxes..."}], "owner": {"reputation": 53, "user_id": 3493112, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cNhpu.jpg?s=128&g=1", "display_name": "botakelymg", "link": "https://stackoverflow.com/users/3493112/botakelymg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510758725, "creation_date": 1510758725, "last_edit_date": 1531164843, "question_id": 47310890, "link": "https://stackoverflow.com/questions/47310890/excel-vba-2013-how-to-disable-event-click-on-listbox-when-11th-column-reached", "title": "Excel VBA 2013 - How to disable Event Click on Listbox when 11th column reached.", "body": "<p>I'm using ListBox on UserForm to list Lines of Order my application XLSM.\nI understood that there is a limit of column number for a ListBox when AddItem VBA statement used but it can be worked around by using Array. And it works fine.</p>\n\n<p>The problem is when I try to update LisBox with a value for precisely the 11th column, it triggers again the ListBox click event. For the others columns, before and after, there is no firing of that event.</p>\n\n<p>Is that observation exact ? If true, how to disable this firing of ListBox Click because it creates a kind of unrequired side effects.</p>\n\n<p>Thanks for your tips.</p>\n\n<p>Regards.</p>\n"}, {"tags": ["excel", "vba", "delphi", "com"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1510758544, "post_id": 47310817, "comment_id": 81572151, "body": "You may want to include your code in your question."}, {"owner": {"reputation": 2890, "user_id": 1009073, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17e26c540ff4f61bf2303aa3004c5bf7?s=128&d=identicon&r=PG", "display_name": "user1009073", "link": "https://stackoverflow.com/users/1009073/user1009073"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510759045, "post_id": 47310817, "comment_id": 81572527, "body": "Done...  Added code fragment."}, {"owner": {"reputation": 1041, "user_id": 2128279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f4fba99460bd590436cb0b9108b6158?s=128&d=identicon&r=PG", "display_name": "alcalde", "link": "https://stackoverflow.com/users/2128279/alcalde"}, "edited": false, "score": 0, "creation_date": 1510791745, "post_id": 47310817, "comment_id": 81590222, "body": "@user1009073 You don&#39;t mention what you&#39;re actually using to write to the spreadsheet."}, {"owner": {"reputation": 2890, "user_id": 1009073, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17e26c540ff4f61bf2303aa3004c5bf7?s=128&d=identicon&r=PG", "display_name": "user1009073", "link": "https://stackoverflow.com/users/1009073/user1009073"}, "edited": false, "score": 0, "creation_date": 1510851224, "post_id": 47310817, "comment_id": 81621685, "body": "The program is written in Delphi (Seattle), which makes COM calls to Excel 2013"}], "owner": {"reputation": 2890, "user_id": 1009073, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/17e26c540ff4f61bf2303aa3004c5bf7?s=128&d=identicon&r=PG", "display_name": "user1009073", "link": "https://stackoverflow.com/users/1009073/user1009073"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510758976, "creation_date": 1510758494, "last_edit_date": 1510758976, "question_id": 47310817, "link": "https://stackoverflow.com/questions/47310817/delphi-excel-pivot-identifying-row-level", "title": "Delphi-Excel-Pivot - Identifying Row Level", "body": "<p>I am using a Delphi App to build an Excel (2013) spreadsheet.  As part of this spreadsheet, I am building a Pivot Table. The rows in this Pivot table have a multi-level hierarchy.  For example, State -> City.  So for each state, multiple cities are listed, and I can collapse on state.  This is not the exact data that is used, but it is easiest to explain.  Elsewhere in my code, I am looping through all the rows in the Pivot table, reading the value in Column 'A', which would be either a state or a city.  How can I ask the Pivot table if a given row is a top level row (aka State) or a level 2 row (aka City)?  I CANNOT use the data, I have to ask the Pivot table itself, but I can't find any applicable properties.</p>\n\n<p>In Delphi, I have a handle to my Pivot Table, and I can determine top and bottom rows, and loop through that.  I just can't determine how to identify is this a top level row or not...</p>\n\n<pre><code>    CODE FRAGMENT:\n    // Get a handle to the PivotTable, then get the address of the Pivot Table\n       TerritoryPivot := TerritoryAnalysisSheet.PivotTables(1, LOCALE_USER_DEFAULT) as PivotTable;\n       PivotAddress := TerritoryPivot.TableRange1.Address[True, True, xlR1C1, EmptyParam, EmptyParam];\n       PivotAddressElements := ParseR1C1Range(PivotAddress);\n\n       // Now build a stringlist containing all the Names in Order.\n       for j := PivotAddressElements.FirstRow +2 to PivotAddressElements.LastRow -1 do\nbegin\nif TerritoryAnalysisSheet.Range['A' + IntToStr(J), EmptyParam].IS_THIS_LEVEL_1) == true then\n...       \nend;\n</code></pre>\n\n<p>What I need is a real property/method, instead of the 'IS_THIS_LEVEL_1' pseudo property.</p>\n"}, {"tags": ["excel", "vba", "ibm-midrange"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1510760400, "post_id": 47310649, "comment_id": 81573668, "body": "There&#39;s certainly an ODBC provider for it. Use that through ADODB and send a parameterized query to the server. Your question is way too broad to be answerable in any more specific way."}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 4302137, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2HtHMTMcNU/AAAAAAAAAAI/AAAAAAAAFZc/NW6Cmv6BO5U/photo.jpg?sz=128", "display_name": "Mudzaffar Mansor", "link": "https://stackoverflow.com/users/4302137/mudzaffar-mansor"}, "is_accepted": false, "score": 0, "last_activity_date": 1511339234, "creation_date": 1511339234, "answer_id": 47429919, "question_id": 47310649, "link": "https://stackoverflow.com/questions/47310649/excel-macro-to-run-the-output-of-an-as400-query/47429919#47429919", "title": "Excel Macro to run the output of an AS400 query", "body": "<p>change your query using WRKQRY and define the date as CURRENT(DATE)</p>\n"}], "owner": {"reputation": 15, "user_id": 8682044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f414b42e9883ffb38677e91b19a15a?s=128&d=identicon&r=PG&f=1", "display_name": "GrayC", "link": "https://stackoverflow.com/users/8682044/grayc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1511339234, "creation_date": 1510758006, "question_id": 47310649, "link": "https://stackoverflow.com/questions/47310649/excel-macro-to-run-the-output-of-an-as400-query", "title": "Excel Macro to run the output of an AS400 query", "body": "<p>I have a spreadsheet that requires an output from an AS400 query with the updates details.  The only change to the query that is run is the specified date range (which is typically the current date).</p>\n\n<p>I am happy to update and refresh the query each time on AS400 to ensure the date is up to date, however i was hoping it would be possible to tie in a macro on Excel that would run through the data import method (e.g. select the query, log in with username/password).  This would allow a press of a button for the data to refresh on the specified tab.</p>\n\n<p>Would this be possible, or is it better to be left as a manual task?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3924, "user_id": 6722100, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f1c741df6363ff4fe3e32eee854821c3?s=128&d=identicon&r=PG&f=1", "display_name": "achAmh&#225;in", "link": "https://stackoverflow.com/users/6722100/achamh%c3%a1in"}, "edited": false, "score": 1, "creation_date": 1510757926, "post_id": 47310592, "comment_id": 81571682, "body": "Your question contradicts itself."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1510757947, "post_id": 47310592, "comment_id": 81571701, "body": "What did you try?"}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "edited": false, "score": 0, "creation_date": 1510758080, "post_id": 47310592, "comment_id": 81571798, "body": "word-vba ??? Ranges???"}, {"owner": {"reputation": 69, "user_id": 7624832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e12d7f7166aab611dd7410ffa0ee73?s=128&d=identicon&r=PG&f=1", "display_name": "jonty", "link": "https://stackoverflow.com/users/7624832/jonty"}, "edited": false, "score": 0, "creation_date": 1510758329, "post_id": 47310592, "comment_id": 81571984, "body": "sorry it should be exel vba"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1510758710, "creation_date": 1510758710, "answer_id": 47310886, "question_id": 47310592, "link": "https://stackoverflow.com/questions/47310592/in-cell-range-if-any-of-the-cell-is-empty-than-show-that-cell-reference-in-the/47310886#47310886", "title": "In cell range, if any of the cell is empty than show that cell reference in the msg box", "body": "<p>I'd recommend updating <code>ActiveSheet</code> to your sheet name</p>\n\n<pre><code>Sub findEmptyCells()\n    Dim c\n\n    For Each c In ActiveSheet.Range(\"C5:J30\")\n        If IsEmpty(c) Then MsgBox c.Address\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7624832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e12d7f7166aab611dd7410ffa0ee73?s=128&d=identicon&r=PG&f=1", "display_name": "jonty", "link": "https://stackoverflow.com/users/7624832/jonty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "closed_date": 1510762294, "answer_count": 1, "score": -2, "last_activity_date": 1510758710, "creation_date": 1510757834, "last_edit_date": 1531164843, "question_id": 47310592, "link": "https://stackoverflow.com/questions/47310592/in-cell-range-if-any-of-the-cell-is-empty-than-show-that-cell-reference-in-the", "closed_reason": "Needs details or clarity", "title": "In cell range, if any of the cell is empty than show that cell reference in the msg box", "body": "<p>Iam very new to this vba exel, I have a table ranging (C5:J30).so in this range if any of the cell is empty, then I should get a msgbox \u201cshowing the cell reference of that empty cell\u201d since I very new to the exel vba so I couldn\u2019t write any code,as usual the stackoverflow  demands code attempt, so please anybody can help me in this regard</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1510758791, "post_id": 47310554, "comment_id": 81572331, "body": "Excel charts are objects, they are not the contents of cells. Delete them from the <code>.Charts</code> collection."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510760562, "post_id": 47310554, "comment_id": 81573802, "body": "Do the charts appear intact, like nothing happened, or do they move / resize? If they remain intact, they have the &quot;Don&#39;t  move or size with cells&quot; option. If they move and become ridiculously small, they just are larger than the columns you delete."}, {"owner": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "reply_to_user": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 0, "creation_date": 1510774570, "post_id": 47310554, "comment_id": 81582541, "body": "@AlexP Yes they can be deleted from .charts but in my case i want them to move with the table above them after the deletion of other ranges. Also i wonder why everything is working fine when i run it line by line."}, {"owner": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1510775469, "post_id": 47310554, "comment_id": 81583007, "body": "@Excelosaurus Yes, the charts are intact...no movement and no size change. I checked the chart properties and it is checked as &quot;Move and size with cells&quot;. Also when i run the code in steps, i get the required result, the tables along with the charts moves to the initial point after deletion of other columns but it&#39;s not the same when i run the complete code."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "edited": false, "score": 0, "creation_date": 1510812443, "post_id": 47317236, "comment_id": 81596202, "body": "Thank you for looking into this and providing solution but even after using thia code the charts are intact with no moment at all. After the final run, i am getting the correct result for tables but no any help with the graphs."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "edited": false, "score": 0, "creation_date": 1510844081, "post_id": 47317236, "comment_id": 81616375, "body": "I can&#39;t think of a way to reproduce your issue without involving the <code>Placement</code> property. You&#39;ve mentioned that stepping through the code works whereas it doesn&#39;t otherwise; this makes me wonder whether a call to <code>DoEvents</code> after column deletion would help (are you deleting in a loop?)."}, {"owner": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "edited": false, "score": 0, "creation_date": 1510856138, "post_id": 47317236, "comment_id": 81624749, "body": "Yes, i am making this deletion inside a outer &quot;for each&quot; and an inner &quot;for&quot; loop....i also tried to use DoEvents as it is working fine while stepping through the code but that also didn&#39;t work out."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "edited": false, "score": 0, "creation_date": 1510856527, "post_id": 47317236, "comment_id": 81624984, "body": "If you can make a skeleton workbook where the problem occurs, share it and I&#39;ll take a look at it."}, {"owner": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "edited": false, "score": 0, "creation_date": 1510860223, "post_id": 47317236, "comment_id": 81627124, "body": "You can get the file through <a href=\"https://ufile.io/d1wt0\" rel=\"nofollow noreferrer\">ufile.io/d1wt0</a>. I am having 4 similar files in one folder and for each file i need to delete the unnecessary column ranges one by one and save them. Just for example: The file i shared has name &quot;Hygiene_ABC_go&quot;, so only the column with name ABC needs to be present in that file and saved after deletion of other columns."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "reply_to_user": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "edited": false, "score": 0, "creation_date": 1510862289, "post_id": 47317236, "comment_id": 81628188, "body": "Got your file, put the code in it, and called <code>DeleteColumnsAndCharts Sheet1.Range(&quot;R:AF&quot;):DeleteColumnsAndCharts Sheet1.Range(&quot;B:H&quot;):?Sheet1.ChartObjects.Count</code> from the Immediate Window. Works as expected; 3 charts are left under the ABC header. That&#39;s on Excel 2016."}, {"owner": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "edited": false, "score": 0, "creation_date": 1511114664, "post_id": 47317236, "comment_id": 81712626, "body": "I too get the code running perfectly for this dummy sheet but when i insert this in my main code where it runs under a loop then the things don&#39;t work out. I am having four similar files in a folder and had to do the same thing on these four files with respective column headers. I think there might be some problem in running this code under the For Each Loop."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 0, "last_activity_date": 1510779973, "creation_date": 1510779973, "answer_id": 47317236, "question_id": 47310554, "link": "https://stackoverflow.com/questions/47310554/unable-to-delete-charts-while-deleting-specific-columns-in-vba-for-excel/47317236#47317236", "title": "Unable to delete Charts while deleting specific columns in VBA for Excel", "body": "<p>A <code>ChartObject</code>'s <code>Placement</code> property controls the way it is attached to its underlying cells; see <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlplacement-enumeration-excel\" rel=\"nofollow noreferrer\">XlPlacement Enumeration</a>. The chart objects that remain (after columns completely covering them are deleted) most probably have <code>Placement = xlFreeFloating</code>.</p>\n\n<p>Here's a sub to handle this situation. It first buffers the <code>Placement</code> values, then performs the column deletion, and re-establishes the original <code>Placement</code> values.</p>\n\n<pre><code>Public Sub DeleteColumnsAndCharts(ByVal pColumnsToDelete As Excel.Range)\n    On Error GoTo errHandler\n\n    Dim PlacementByChartName As Object 'Scripting.Dictionary\n    Dim chartsWorksheet As Excel.Worksheet\n    Dim chart As Excel.ChartObject\n\n    Set PlacementByChartName = CreateObject(\"Scripting.Dictionary\")\n    Set chartsWorksheet = pColumnsToDelete.Worksheet\n\n    'Keep the original Placement values before changing them.\n    For Each chart In chartsWorksheet.ChartObjects\n        PlacementByChartName(chart.Name) = chart.Placement\n        chart.Placement = xlMoveAndSize\n    Next\n\n    'Should the Delete method below fail, the Recover section will leave the worksheet intact.\n    pColumnsToDelete.EntireColumn.Delete\n\nRecover:\n    On Error Resume Next\n    'Restore the original Placement values on the remaining chart objects.\n    For Each chart In chartsWorksheet.ChartObjects\n        chart.Placement = PlacementByChartName(chart.Name)\n    Next\n    Set chart = Nothing\n    Set chartsWorksheet = Nothing\n    Set PlacementByChartName = Nothing\n    Exit Sub\n\nerrHandler:\n    MsgBox Err.Description, vbExclamation + vbOKOnly, \"Error\"\n    Resume Recover\nEnd Sub\n</code></pre>\n\n<p>You can call it like this:</p>\n\n<pre><code>DeleteColumnsAndCharts wtemp.Sheets(\"Graphs\").Range(\"A:X\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8945862, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JN0hi4OGXgE/AAAAAAAAAAI/AAAAAAAAHHc/BR2yrmDs8Qo/photo.jpg?sz=128", "display_name": "Deepak Pandey", "link": "https://stackoverflow.com/users/8945862/deepak-pandey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510779973, "creation_date": 1510757738, "last_edit_date": 1531164843, "question_id": 47310554, "link": "https://stackoverflow.com/questions/47310554/unable-to-delete-charts-while-deleting-specific-columns-in-vba-for-excel", "title": "Unable to delete Charts while deleting specific columns in VBA for Excel", "body": "<p>I am trying to remove some columns based on different conditions. These column sets are having tables along with their respective charts below them. When i run the code line by line, it works perfect but when i run the complete code then it works well on the tables but the charts below them doesn't delete at all.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aoSuz.jpg\" rel=\"nofollow noreferrer\">source file</a></p>\n\n<pre><code>If oper(j) = \"ABC\" Then\n\n   wtemp.Sheets(\"Graphs\").Range(\"A:H, Q:AF\").Delete\n\n         ElseIf oper(j) = \"XYZ\" Then\n\n               wtemp.Sheets(\"Graphs\").Range(\"A:P, Y:AF\").Delete\n\n                    ElseIf oper(j) = \"KHG\" Then\n\n                          wtemp.Sheets(\"Graphs\").Range(\"A:X\").Delete\n\n                    Else\n\n                    wtemp.Sheets(\"Graphs\").Range(\"I:AF\").Delete\n\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8945814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9772409005467fef268d9f039f4111b?s=128&d=identicon&r=PG&f=1", "display_name": "Antti Manninen", "link": "https://stackoverflow.com/users/8945814/antti-manninen"}, "edited": false, "score": 0, "creation_date": 1510758707, "post_id": 47310594, "comment_id": 81572260, "body": "I assume you mean <code>excelapp.Quit</code> and <code>excelapp.DisplayAlerts = False</code> instead of <code>Application.Quit</code> and <code>Application.DisplayAlerts = False</code>? Since it&#39;s not the same Excel application I&#39;m trying to close that I&#39;m using to run the code with, but rather the one I created earlier in the code.   Nevertheless, that didn&#39;t unfortunately help - the Excel process still stays alive when the file is loaded from SharePoint and is killed if the file is loaded locally."}], "tags": [], "owner": {"reputation": 58, "user_id": 8482598, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5133b545defe9913bfafc13de45673c1?s=128&d=identicon&r=PG&f=1", "display_name": "Leighholling", "link": "https://stackoverflow.com/users/8482598/leighholling"}, "is_accepted": false, "score": 0, "last_activity_date": 1510757838, "creation_date": 1510757838, "answer_id": 47310594, "question_id": 47310389, "link": "https://stackoverflow.com/questions/47310389/excel-2016-open-and-close-an-excel-file-programmatically-from-sharepoint/47310594#47310594", "title": "Excel 2016: open and close an Excel file programmatically from sharepoint", "body": "<p>Try changing the </p>\n\n<pre><code>wbk.Close SaveChanges:=False\n    excelapp.Quit\n    Set excelapp = Nothing\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>    wbk.Close SaveChanges:=False\n    Application.Quit\n    Application.DisplayAlerts = False\n    Set excelapp = Nothing\n</code></pre>\n\n<p>and the</p>\n\n<pre><code>    error_handler:\n    MsgBox \"A problem occurred\", vbOKOnly, \"Error\"\n    excelapp.Quit\n    Set excelapp = Nothing\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>    error_handler:\n    MsgBox \"A problem occurred\", vbOKOnly, \"Error\"\n    Application.Quit\n    Application.DisplayAlerts = False\n    Set excelapp = Nothing\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8945814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9772409005467fef268d9f039f4111b?s=128&d=identicon&r=PG&f=1", "display_name": "Antti Manninen", "link": "https://stackoverflow.com/users/8945814/antti-manninen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510757838, "creation_date": 1510757240, "last_edit_date": 1531164843, "question_id": 47310389, "link": "https://stackoverflow.com/questions/47310389/excel-2016-open-and-close-an-excel-file-programmatically-from-sharepoint", "title": "Excel 2016: open and close an Excel file programmatically from sharepoint", "body": "<p>I have this test code that attempts to start a hidden Excel process, load an Excel file from a location (\"fileToOpen\"), do something with the file and then close the file and finally close the Excel process. I'm performing my test in Excel 2016.</p>\n\n<pre><code>Sub test()\n    Dim excelapp As Object\n    Dim wbk As Workbook\n\n    Set excelapp = CreateObject(\"excel.Application\")\n    excelapp.Visible = True\n\n    On Error GoTo error_handler\n\n    Set wbk = excelapp.Workbooks.Open(filename:=fileToOpen, ReadOnly:=True)\n\n    ' Do something\n\n    wbk.Close SaveChanges:=False\n    excelapp.Quit\n    Set excelapp = Nothing\n\n    Exit Sub\n\nerror_handler:\n    MsgBox \"A problem occurred\", vbOKOnly, \"Error\"\n    excelapp.Quit\n    Set excelapp = Nothing\nEnd Sub\n</code></pre>\n\n<p>For some reason the Excel process stays alive after the <code>excelapp.Quit</code> when the file is loaded from SharePoint, but is killed when the file is loaded from a local drive. This also worked fine in Excel 2010, i.e. the Excel process was properly terminated.</p>\n\n<p>Any help is appreciated on how to properly close the file after reading it.</p>\n"}, {"tags": ["vba", "duplicates"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1510757336, "post_id": 47310361, "comment_id": 81571204, "body": "The bottom output is correct...those are all unique."}, {"owner": {"reputation": 15, "user_id": 8833516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145323fb4a4cc2fdee62f533c7b5112c?s=128&d=identicon&r=PG&f=1", "display_name": "Jojo", "link": "https://stackoverflow.com/users/8833516/jojo"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1510757463, "post_id": 47310361, "comment_id": 81571309, "body": "yes but i wanted to make a macro to return something like this:   Name | IP | OS  host1 | 1.1.1.1 | Windows"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1510757778, "post_id": 47310361, "comment_id": 81571575, "body": "Can you just delete the rows with N/As?  Will that work?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1510760736, "post_id": 47310361, "comment_id": 81573933, "body": "It is quite easy, follow these steps. 1)Replace all N/A with empty string 2)Custom sort your table by Name, IP, OS in A to Z order. 3)Starting from bottom to top, delete the row if the value of the cell in Column A is the same with the upper cell. Let me know if you are stuck somewhere."}, {"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1510762050, "post_id": 47310361, "comment_id": 81574968, "body": "What if there are only two lines, one is <code>N&#47;A,Windows</code>, another is <code>1.1.1.1,N&#47;A</code>. What should be done in this case?"}], "answers": [{"tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": true, "score": 0, "last_activity_date": 1510763574, "last_edit_date": 1592644375, "creation_date": 1510763574, "answer_id": 47312661, "question_id": 47310361, "link": "https://stackoverflow.com/questions/47310361/how-to-decide-with-duplicate-values-on-column-vba/47312661#47312661", "title": "How to decide with duplicate values on column VBA", "body": "<p>This is what I've got so far. Assuming your data is like</p>\n<h2>Origin Data</h2>\n<pre><code>Name    IP      OS      Country\nhost1   1.1.1.1 Windows N/A\nhost1   1.1.1.1 Windows Taiwan\nhost1   1.1.1.1 N/A     N/A\nhost1   N/A     N/A     Taiwan\nhost2   N/A     Apple   N/A\nhost2   N/A     Apple   Taiwan\nhost2   N/A     N/A     Taiwan\nhost2   1.1.1.1 N/A     N/A\nhost2   1.1.1.1 Apple   Taiwan\n</code></pre>\n<h2>Output</h2>\n<pre><code>Name    IP      OS      Country\nhost1   1.1.1.1 Windows Taiwan\nhost2   1.1.1.1 Apple   Taiwan\n</code></pre>\n<h2>Code</h2>\n<pre><code>Private Sub test()\n    With ActiveSheet\n        Dim i, startRow, endRow As Long\n        Dim NACount, LessNACount As Integer\n        'Set a large enough number\n        LessNACount = 1000\n        Dim cell As Range\n        \n        'Assuming Row 1 is title\n        startRow = 2\n        \n        Dim DeleteRange, SameNARange As Range\n        'Setting it a dummy range\n        Set DeleteRange = .Rows(.Rows.Count)\n        \n        For i = 2 To .Range(&quot;A&quot; &amp; .Rows.Count).End(xlUp).Row\n            NACount = WorksheetFunction.CountIf(.Rows(i), &quot;N/A&quot;)\n            'Cells with N/A are more than the least row\n            If NACount &gt; LessNACount Then\n                Set DeleteRange = Union(DeleteRange, .Rows(i))\n            'Cells with N/A are equal than the least row\n            ElseIf NACount = LessNACount Then\n                Set SameNARange = Union(SameNARange, .Rows(i))\n            'Cells with N/A are less than the least row, so it becomes the new least row\n            Else\n                'We have found at least a row, abandon them\n                If Not SameNARange Is Nothing Then\n                    Set DeleteRange = Union(DeleteRange, SameNARange)\n                End If\n                Set SameNARange = .Rows(i)\n                LessNACount = NACount\n            End If\n            \n            'host1 is done, goes into host2\n            If .Range(&quot;A&quot; &amp; i).Value &lt;&gt; .Range(&quot;A&quot; &amp; i + 1).Value Then\n                LessNACount = 1000\n                Set SameNARange = Nothing\n            End If\n        Next i\n        \n        DeleteRange.Delete\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 4225297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vVOhmxwSR7E/AAAAAAAAAAI/AAAAAAAAAS4/kItxZ-QFCos/photo.jpg?sz=128", "display_name": "John Ink", "link": "https://stackoverflow.com/users/4225297/john-ink"}, "is_accepted": false, "score": 0, "last_activity_date": 1510763759, "creation_date": 1510763759, "answer_id": 47312725, "question_id": 47310361, "link": "https://stackoverflow.com/questions/47310361/how-to-decide-with-duplicate-values-on-column-vba/47312725#47312725", "title": "How to decide with duplicate values on column VBA", "body": "<p>In the SQL for the datapull, you could do something like this:</p>\n\n<pre><code>SELECT Name, MAX(IIF( ip &lt;&gt; \"N/A\", ip)) AS ip, MAX(IIF( os &lt;&gt; \"N/A\", os)) AS os\nFROM table\nGROUP BY Name\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8833516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/145323fb4a4cc2fdee62f533c7b5112c?s=128&d=identicon&r=PG&f=1", "display_name": "Jojo", "link": "https://stackoverflow.com/users/8833516/jojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 47312661, "answer_count": 2, "score": 1, "last_activity_date": 1510763759, "creation_date": 1510757161, "last_edit_date": 1510757557, "question_id": 47310361, "link": "https://stackoverflow.com/questions/47310361/how-to-decide-with-duplicate-values-on-column-vba", "title": "How to decide with duplicate values on column VBA", "body": "<p>If I have the following table:</p>\n\n<pre><code>Name  | IP      | OS\n------+---------+---------\nhost1 | 1.1.1.1 | Windows\nhost1 | N/A     | N/A\nhost1 | 1.1.1.1 | N/A\nhost1 | N/A     | Windows\n</code></pre>\n\n<p>How can I remove duplicates, and just keep the row with more values?</p>\n\n<p>Output should be like this:</p>\n\n<pre><code>Name  | IP      | OS\n------+---------+---------\nhost1 | 1.1.1.1 | Windows\n</code></pre>\n\n<p>I tried <code>ActiveSheet.Range(\"A:A\").RemoveDuplicates Columns:=1</code> but it removes all duplicates host1 i.e the result is this</p>\n\n<pre><code>Name  | IP      | OS\n------+---------+---------\nhost1 | 1.1.1.1 | Windows\n      | N/A     | N/A\n      | 1.1.1.1 | N/A\n      | N/A     | Windows\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1510757264, "post_id": 47310293, "comment_id": 81571148, "body": "Please edit your question and include the code you&#39;re having trouble with."}, {"owner": {"reputation": 27, "user_id": 4928758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b7d0977e1134d7bc753f5825bec2a10?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/4928758/aditya"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1510757715, "post_id": 47310293, "comment_id": 81571529, "body": "Edited now with my code also."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1510766147, "post_id": 47310293, "comment_id": 81577807, "body": "Oh that page, will you want to return <i>*all</i> the people and descriptions, or just the first one in the results?"}, {"owner": {"reputation": 27, "user_id": 4928758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b7d0977e1134d7bc753f5825bec2a10?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/4928758/aditya"}, "edited": false, "score": 0, "creation_date": 1510769020, "post_id": 47310293, "comment_id": 81579410, "body": "All the results Bruce"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4928758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b7d0977e1134d7bc753f5825bec2a10?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/4928758/aditya"}, "edited": false, "score": 1, "creation_date": 1511282402, "post_id": 47314626, "comment_id": 81790340, "body": "Thanks a Ton Bruce."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1510770087, "creation_date": 1510770087, "answer_id": 47314626, "question_id": 47310293, "link": "https://stackoverflow.com/questions/47310293/vba-extracting-text-from-div-where-no-class-id-tag/47314626#47314626", "title": "VBA- Extracting Text from DIV where no CLASS, ID, TAG", "body": "<p>It took a little tweaking, and assuming the HTML doesn't really change, but this should help you out.</p>\n\n<p>It will return an array at the end that has the \"link\" text and the \"body\" text that describes the link.  </p>\n\n<p>Remove <code>Set divElem</code> and after...and replace with this:</p>\n\n<pre><code>Dim i As Long\nDim title() As Variant\nReDim title(0)\n\nDim ele As Object\n\nSet aElem = oHtml.getElementsByTagName(\"a\")\nFor Each ele In aElem\n    If ele.Style = \"FONT-SIZE\" Then ' Will return each of the search findings main info\n        title(UBound(title)) = ele.innerText\n        ReDim Preserve title(LBound(title) To UBound(title) + 1)\n    End If\nNext ele\n\nDim text() As Variant\nReDim text(0)\n\nSet divElem = oHtml.getElementsByTagName(\"div\")\nFor Each ele In divElem\n    If ele.getAttribute(\"style\").cssText = \"WORD-WRAP: break-word; MARGIN-BOTTOM: 2px; COLOR: #545454; LINE-HEIGHT: 1.3em\" Then\n        text(UBound(text)) = ele.innerText\n        ReDim Preserve text(LBound(text) To UBound(text) + 1)\n    End If\nNext ele\n\nDim combinedInfo() As Variant\nReDim combinedInfo(UBound(title), 1)\nFor i = LBound(title) To UBound(title)\n    combinedInfo(i, 0) = title(i)\n    combinedInfo(i, 1) = text(i)\nNext i\n\nFor i = LBound(title) To UBound(title) - 1\n    Debug.Print combinedInfo(i, 0) &amp; \" ::: \" &amp; combinedInfo(i, 1)\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>The <code>combinedInfo</code> array has the Link Text as the <code>(i,0)</code>  index, and the Link description is the <code>(i,1)</code> index.</p>\n\n<p>It's a little clunky, but if it works, you can just refactor into separate functions (one for the <code>a</code> tags and one for the <code>div</code> tags perhaps), but it worked for me with what you gave.</p>\n"}], "owner": {"reputation": 27, "user_id": 4928758, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b7d0977e1134d7bc753f5825bec2a10?s=128&d=identicon&r=PG&f=1", "display_name": "Aditya", "link": "https://stackoverflow.com/users/4928758/aditya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 47314626, "answer_count": 1, "score": 0, "last_activity_date": 1510770087, "creation_date": 1510756975, "last_edit_date": 1510761415, "question_id": 47310293, "link": "https://stackoverflow.com/questions/47310293/vba-extracting-text-from-div-where-no-class-id-tag", "title": "VBA- Extracting Text from DIV where no CLASS, ID, TAG", "body": "<p>Here is the Script </p>\n\n<pre><code>&lt;div style=\"padding-left:0em; margin:10px 25px 24px 0px;\"&gt;\n  &lt;div style='word-wrap:break-word; max-height:50px; overflow:hidden;'&gt;                 \n    &lt;a style=\"display:unset; font-size:1.25em;\" href=\"http://www.aptcenter.research.va.gov/staff/investigators/zhu/\"&gt;Hui Zhu, MD, ScD - Advanced Platform Technology &lt;b&gt;Center&lt;/b&gt;&lt;/a&gt;\n  &lt;/div&gt;\n\n  &lt;div class=\"url\" style='word-spacing:normal; word-wrap:break-word; color:#008933; margin-bottom:2px; margin-top:2px'&gt;\n        www.aptcenter.research.va.gov/&amp;#8203;staff/&amp;#8203;investigators/&amp;#8203;zhu\n  &lt;/div&gt;\n  &lt;div style='color:#545454; line-height:1.3em; word-wrap:break-word; margin-bottom:2px;'&gt;Jewish Hospital. Fellowship training took place in Urological Oncology at the &lt;b&gt;Memorial&lt;/b&gt; &lt;b&gt;Sloan&lt;/b&gt;-&lt;b&gt;Kettering&lt;/b&gt; &lt;b&gt;Cancer&lt;/b&gt; &lt;b&gt;Center&lt;/b&gt; in New York &lt;b&gt;Center&lt;/b&gt;. Dr. Zhu&lt;/div&gt;\n    &lt;div class='no-print' style='margin-bottom:10px; margin-top:4px; color:#010101;'&gt;                   \n        View results from &lt;a href=\"/search/va/va_search.jsp?QT=Memorial+Sloan+Kettering+Cancer+Center&amp;amp;SQ=www.aptcenter.research.va.gov&amp;amp;DB=3\"&gt;APTCENTER RESEARCH&lt;/a&gt;         \n        or related &lt;a href=\"/search/va/va_search.jsp?QT=Memorial+Sloan+Kettering+Cancer+Center&amp;amp;DB=3\"&gt;Health Research&lt;/a&gt; sites\n    &lt;/div&gt;                  \n  &lt;/div&gt; \n</code></pre>\n\n<p>I want to get Title i.e. \"Hui Zhu, MD, ScD - Advanced Platform Technology Center\" and then Text below link i.e. \"Jewish Hospital. Fellowship training took place in Urological Oncology at the Memorial Sloan-Kettering Cancer Center in New York Center. Dr. Zhu\"</p>\n\n<p>Here is my current code</p>\n\n<pre><code>Dim objIE As Object, Slink As String\nDim hUls As MSHTML.IHTMLElementCollection\nDim httpRequest As XMLHTTP\nDim divElem As HTMLDivElement\n\nSet httpRequest = New XMLHTTP\n\nSlink = \"https://www.index.va.gov/search/va/va_search.jsp?QT=Memorial+Sloan+Kettering+Cancer+Center&amp;RS=1\"\n\nWith httpRequest\n    .Open \"GET\", Slink, False\n    .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n    .send\nEnd With\nWith httpRequest\n    While Not .readyState = 4\n        Application.Wait Now + TimeValue(\"0:00:01\")\n    Wend\n    If .Status = 200 Then\n        While InStr(1, .responseText, \"Updating\", 0) &gt; 0\n            Application.Wait Now + TimeValue(\"0:00:01\")\n        Wend\n        Set oHtml = New HTMLDocument\n        oHtml.body.innerHTML = .responseText\n    End If\nEnd With\n\nSet divElem = oHtml.getElementById(\"innerContent\")\nMsgBox divElem.getAttribute(\"padding-left:0em; margin:10px 25px 24px 0px;\").cssText\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7908059, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztpoh8-rJ8s/AAAAAAAAAAI/AAAAAAAAAFk/r_gYBeMgSZM/photo.jpg?sz=128", "display_name": "Ros Vergel", "link": "https://stackoverflow.com/users/7908059/ros-vergel"}, "edited": false, "score": 0, "creation_date": 1510768526, "post_id": 47311357, "comment_id": 81579135, "body": "This would have a problem if the source data is between more than a day (e.g 3 days)"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 11, "user_id": 7908059, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztpoh8-rJ8s/AAAAAAAAAAI/AAAAAAAAAFk/r_gYBeMgSZM/photo.jpg?sz=128", "display_name": "Ros Vergel", "link": "https://stackoverflow.com/users/7908059/ros-vergel"}, "edited": false, "score": 0, "creation_date": 1510770026, "post_id": 47311357, "comment_id": 81579979, "body": "Are you saying there is a date to the criteria?  What date are you checking?"}, {"owner": {"reputation": 11, "user_id": 7908059, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztpoh8-rJ8s/AAAAAAAAAAI/AAAAAAAAAFk/r_gYBeMgSZM/photo.jpg?sz=128", "display_name": "Ros Vergel", "link": "https://stackoverflow.com/users/7908059/ros-vergel"}, "edited": false, "score": 0, "creation_date": 1510811286, "post_id": 47311357, "comment_id": 81595789, "body": "Yes. I only wanted to get the data between 14:00 - 22:00 of the date today."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510844151, "last_edit_date": 1510844151, "creation_date": 1510759962, "answer_id": 47311357, "question_id": 47310239, "link": "https://stackoverflow.com/questions/47310239/delete-entire-row-if-cell-date-value-is-within-the-time-range/47311357#47311357", "title": "Delete entire row if cell (date) value is within the time range", "body": "<p>This will correctly evaluate your time values.  Can't you just not COPY DATA FROM SOURCE (CLOSE WORKGROUP) TO THE DESTINATION WORKBOOK?</p>\n\n<p>For it to be today's date, just check that too</p>\n\n<pre><code>If TimeValue(src_im.Worksheets(\"incident_sla\").Range(\"G\" &amp; iCnt_im).Value) &gt; TimeValue(\"13:59:59\") And TimeValue(src_im.Worksheets(\"incident_sla\").Range(\"G\" &amp; iCnt_im).Value) &lt; TimeValue(\"22:00:01\")  and Int(src_im.Worksheets(\"incident_sla\").Range(\"G\" &amp; iCnt_im).Value) = Date Then\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7908059, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ztpoh8-rJ8s/AAAAAAAAAAI/AAAAAAAAAFk/r_gYBeMgSZM/photo.jpg?sz=128", "display_name": "Ros Vergel", "link": "https://stackoverflow.com/users/7908059/ros-vergel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1510844151, "creation_date": 1510756813, "last_edit_date": 1510757036, "question_id": 47310239, "link": "https://stackoverflow.com/questions/47310239/delete-entire-row-if-cell-date-value-is-within-the-time-range", "title": "Delete entire row if cell (date) value is within the time range", "body": "<p>I need help on my coding. So basically the codes below will get the data from another sheet and close it automatically. What I wanted to output is just the rows that will fall between 14:00 and 22:00 of the day. So if the SLA target date would be beyond that range, I'l like to delete that row and shift up so that the output will have no spaces in between. I'm not sure how to do it. </p>\n\n<p>below is my code:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    Call ClearData\n    Call ReadDataFromCloseFile\nEnd Sub\n\n\nSub ReadDataFromCloseFile()\n    On Error GoTo ErrHandler\n    Application.ScreenUpdating = False\n\n    Dim src_im As Workbook\n    Dim src_fr As Workbook\n    Dim src_chm As Workbook\n    ' OPEN THE SOURCE EXCEL WORKBOOK IN \"READ ONLY MODE\".\n    Set src_im = Workbooks.Open(ThisWorkbook.Path &amp; \"\\incident_sla.csv\", True, True)\n    ' GET THE TOTAL ROWS FROM THE SOURCE WORKBOOK.\n    Dim iTotalRows_im As Integer\n    iTotalRows_im = src_im.Worksheets(\"incident_sla\").UsedRange.Rows.Count\n    Set src_fr = Workbooks.Open(ThisWorkbook.Path &amp; \"\\sc_req_item_sla.csv\", True, True)\n    Dim iTotalRows_fr As Integer\n    iTotalRows_fr = src_fr.Worksheets(\"sc_req_item_sla\").UsedRange.Rows.Count\n    Set src_chm = Workbooks.Open(ThisWorkbook.Path &amp; \"\\change_task.csv\", True, True)\n    Dim iTotalRows_chm As Integer\n    iTotalRows_chm = src_chm.Worksheets(\"change_task\").UsedRange.Rows.Count\n\n    ' COPY DATA FROM SOURCE (CLOSE WORKGROUP) TO THE DESTINATION WORKBOOK.\n    Dim iCnt_im As Integer         ' COUNTER.\n    For iCnt_im = 2 To iTotalRows_im\n    If Format(src_im.Worksheets(\"incident_sla\").Range(\"G\" &amp; iCnt_im).Value, \"mm/dd/yyyy hh:mm\") &lt; Format(Date + TimeValue(\"22:00:00\"), \"mm/dd/yyyy hh:mm\") Then\n        Worksheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 2).Formula = src_im.Worksheets(\"incident_sla\").Range(\"A\" &amp; iCnt_im).Formula\n        Worksheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_im + 2).Formula = src_im.Worksheets(\"incident_sla\").Range(\"B\" &amp; iCnt_im).Formula\n        Worksheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_im + 2).WrapText = False\n        Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_im + 2).Formula = src_im.Worksheets(\"incident_sla\").Range(\"C\" &amp; iCnt_im).Formula\n        Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_im + 2).Borders.LineStyle = xlContinuous\n        Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_im + 2).Borders.Color = RGB(0, 0, 0)\n        Worksheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_im + 2).Formula = src_im.Worksheets(\"incident_sla\").Range(\"D\" &amp; iCnt_im).Formula\n        Worksheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_im + 2).Formula = src_im.Worksheets(\"incident_sla\").Range(\"E\" &amp; iCnt_im).Formula\n        Worksheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_im + 2).Formula = src_im.Worksheets(\"incident_sla\").Range(\"F\" &amp; iCnt_im).Formula\n        Worksheets(\"Pre-shift\").Range(\"G\" &amp; iCnt_im + 2).Value = Format(src_im.Worksheets(\"incident_sla\").Range(\"G\" &amp; iCnt_im).Value, \"mm/dd/yyyy hh:mm\")\n        Worksheets(\"Pre-shift\").Range(\"H\" &amp; iCnt_im + 2).Formula = src_im.Worksheets(\"incident_sla\").Range(\"H\" &amp; iCnt_im).Formula\n        Worksheets(\"Pre-shift\").Range(\"H\" &amp; iCnt_im + 2).Borders.LineStyle = xlContinuous\n        Worksheets(\"Pre-shift\").Range(\"H\" &amp; iCnt_im + 2).Borders.Color = RGB(0, 0, 0)\n        Worksheets(\"Pre-shift\").Range(\"I\" &amp; iCnt_im + 2).Value = Format(Date + TimeValue(\"22:00:00\"), \"mm/dd/yyyy hh:mm\")\n        Worksheets(\"Pre-shift\").Range(\"J\" &amp; iCnt_im + 2).Formula = Worksheets(\"Pre-shift\").Range(\"I\" &amp; iCnt_im + 2).Value &lt;= Worksheets(\"Pre-shift\").Range(\"G\" &amp; iCnt_im + 2).Value\n    Else\n            Worksheets(\"Pre-shift\").Rows(iCnt_im + 2).EntireRow.Delete shift:=xlUp\n    End If\n    Next iCnt_im\n\n    Sheets(\"Pre-shift\").Range(\"A3\") = \"Incident ID\"\n    Sheets(\"Pre-shift\").Range(\"A3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"A3\").Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"B3\") = \"Title\"\n    Sheets(\"Pre-shift\").Range(\"B3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"B3\").Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"C3\") = \"Assignee Name\"\n    Sheets(\"Pre-shift\").Range(\"C3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"C3\").Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"D3\") = \"Status\"\n    Sheets(\"Pre-shift\").Range(\"D3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"D3\").Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"E3\") = \"Service Type\"\n    Sheets(\"Pre-shift\").Range(\"E3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"E3\").Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"F3\") = \"Priority\"\n    Sheets(\"Pre-shift\").Range(\"F3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"F3\").Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"G3\") = \"SLA Target Date\"\n    Sheets(\"Pre-shift\").Range(\"G3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"G3\").Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"H3\") = iCnt_im\n    Sheets(\"Pre-shift\").Range(\"H3\").Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"H3\").Font.Color = RGB(255, 255, 255)\n'\n'    Dim after As Integer\n'\n'    For after = 2 To iCnt_im\n'    If Worksheets(\"Pre-shift\").Range(\"J\" &amp; after + 2).Value = False Then\n'    Else\n'            Worksheets(\"Pre-shift\").Rows(after + 2).EntireRow.Delete shift:=xlUp\n'    End If\n'    Next after\n\n'    If iCnt_im = 2 Then\n'    Sheets(\"Pre-shift\").Range(\"A4\").Interior.Color = RGB(191, 191, 191)\n'    End If\n    Dim iCnt_fr As Integer\n    For iCnt_fr = 2 To iTotalRows_fr\n'        If CDate(src_fr.Worksheets(\"sc_req_item_sla\").Range(\"E\" &amp; iCnt_fr).Formula) &gt; Now() Then\n        Worksheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_fr + iCnt_im + 2).Formula = src_fr.Worksheets(\"sc_req_item_sla\").Range(\"A\" &amp; iCnt_fr).Formula\n        Worksheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_fr + iCnt_im + 2).Formula = src_fr.Worksheets(\"sc_req_item_sla\").Range(\"B\" &amp; iCnt_fr).Formula\n        Worksheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_fr + iCnt_im + 2).WrapText = False\n        Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_fr + iCnt_im + 2).Formula = src_fr.Worksheets(\"sc_req_item_sla\").Range(\"C\" &amp; iCnt_fr).Formula\n        Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_fr + iCnt_im + 2).Borders.LineStyle = xlContinuous\n        Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_fr + iCnt_im + 2).Borders.Color = RGB(0, 0, 0)\n        Worksheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_fr + iCnt_im + 2).Formula = src_fr.Worksheets(\"sc_req_item_sla\").Range(\"D\" &amp; iCnt_fr).Formula\n        Worksheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_fr + iCnt_im + 2).Formula = src_fr.Worksheets(\"sc_req_item_sla\").Range(\"E\" &amp; iCnt_fr).Formula\n        Worksheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_fr + iCnt_im + 2).Formula = src_fr.Worksheets(\"sc_req_item_sla\").Range(\"F\" &amp; iCnt_fr).Formula\n        Worksheets(\"Pre-shift\").Range(\"G\" &amp; iCnt_fr + iCnt_im + 2).Formula = src_fr.Worksheets(\"sc_req_item_sla\").Range(\"G\" &amp; iCnt_im).Formula\n'        Else: .EntireRow.Delete\n'        End If\n    Next iCnt_fr\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 3).Formula = \"Fulfillment ID\"\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_im + 3).Formula = \"Title\"\n    Sheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_im + 3).Formula = \"Assignee Name\"\n    Sheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_im + 3).Formula = \"Status\"\n    Sheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_im + 3).Formula = \"SLA Target Date\"\n    Sheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_im + 3).Formula = \"Assignment\"\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n\n    Dim iCnt_chm As Integer\n    For iCnt_chm = 2 To iTotalRows_chm\n    Worksheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Formula = src_chm.Worksheets(\"change_task\").Range(\"A\" &amp; iCnt_chm).Formula\n    Worksheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Formula = src_chm.Worksheets(\"change_task\").Range(\"B\" &amp; iCnt_chm).Formula\n    Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Formula = src_chm.Worksheets(\"change_task\").Range(\"C\" &amp; iCnt_chm).Formula\n    Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).HorizontalAlignment = xlLeft\n    'Worksheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).WrapText = True\n    Worksheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Formula = src_chm.Worksheets(\"change_task\").Range(\"D\" &amp; iCnt_chm).Formula\n    Worksheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Formula = src_chm.Worksheets(\"change_task\").Range(\"E\" &amp; iCnt_chm).Formula\n    Worksheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Formula = src_chm.Worksheets(\"change_task\").Range(\"F\" &amp; iCnt_chm).Formula\n    Worksheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Borders.LineStyle = xlContinuous\n    Worksheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Borders.Color = RGB(0, 0, 0)\n    Worksheets(\"Pre-shift\").Range(\"G\" &amp; iCnt_chm + iCnt_fr + iCnt_im + 2).Formula = src_chm.Worksheets(\"change_task\").Range(\"G\" &amp; iCnt_chm).Formula\n\n    Next iCnt_chm\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_fr + iCnt_im + 3).Formula = \"Parent Change\"\n    Sheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_fr + iCnt_im + 3).Formula = \"Task ID\"\n    Sheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_fr + iCnt_im + 3).Formula = \"Title\"\n    Sheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_fr + iCnt_im + 3).Formula = \"Assignee\"\n    Sheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_fr + iCnt_im + 3).Formula = \"Status\"\n    Sheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_fr + iCnt_im + 3).Formula = \"Planned Start\"\n    Sheets(\"Pre-shift\").Range(\"G\" &amp; iCnt_fr + iCnt_im + 3).Formula = \"Planned End\"\n\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_fr + iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"A\" &amp; iCnt_fr + iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_fr + iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"B\" &amp; iCnt_fr + iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_fr + iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"C\" &amp; iCnt_fr + iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_fr + iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"D\" &amp; iCnt_fr + iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_fr + iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"E\" &amp; iCnt_fr + iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_fr + iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"F\" &amp; iCnt_fr + iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n    Sheets(\"Pre-shift\").Range(\"G\" &amp; iCnt_fr + iCnt_im + 3).Interior.Color = RGB(0, 0, 0)\n    Sheets(\"Pre-shift\").Range(\"G\" &amp; iCnt_fr + iCnt_im + 3).Font.Color = RGB(255, 255, 255)\n\n    ' CLOSE THE SOURCE FILE.\n    src_im.Close False             ' FALSE - DON'T SAVE THE SOURCE FILE.\n    Set src_im = Nothing\n    src_fr.Close False             ' FALSE - DON'T SAVE THE SOURCE FILE.\n    Set src_fr = Nothing\n    src_chm.Close False             ' FALSE - DON'T SAVE THE SOURCE FILE.\n    Set src_chm = Nothing\n\nErrHandler:\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8945622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6b57a5dc94005eb630aec52dd0ead6?s=128&d=identicon&r=PG&f=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/8945622/rahul"}, "is_accepted": false, "score": 0, "last_activity_date": 1510844372, "creation_date": 1510844372, "answer_id": 47332850, "question_id": 47309953, "link": "https://stackoverflow.com/questions/47309953/how-to-add-tag-value-to-elements-entities-in-spark-ea-using-vba/47332850#47332850", "title": "How to add Tag Value to Elements/ Entities in Spark EA using VBA?", "body": "<p>I have now managed to write code for this.</p>\n\n<p>Public Function addOrUpdateElementTag(anElement As EA.element, Tagname As String, tagValue As String) As EA.taggedvalue\n    Dim currentElementTag As EA.taggedvalue\n    'update all tagged values with the given name\n    'Dim parentPackage As EA.package\n    'get the selected package\n    'Set parentPackage = eaConn.getSelectedPackage()</p>\n\n<pre><code>For Each currentElementTag In anElement.TaggedValues\n    If currentElementTag.name = Tagname Then\n        currentElementTag.Value = tagValue\n        Set addOrUpdateElementTag = currentElementTag\n        currentElementTag.Update\n    End If\nNext\n'no tagged value found, so create it\nIf addOrUpdateElementTag Is Nothing Then\n    Set addOrUpdateElementTag = anElement.TaggedValues.AddNew(Tagname, \"ElementTag\")\n    addOrUpdateElementTag.Value = tagValue\n    addOrUpdateElementTag.Update\nEnd If\n</code></pre>\n\n<p>End Function</p>\n\n<p>Hope this will be helpful to someone in future.</p>\n\n<p>Thanks,\nRahul.</p>\n"}], "owner": {"reputation": 1, "user_id": 8945622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab6b57a5dc94005eb630aec52dd0ead6?s=128&d=identicon&r=PG&f=1", "display_name": "rahul", "link": "https://stackoverflow.com/users/8945622/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510844372, "creation_date": 1510756011, "last_edit_date": 1531164843, "question_id": 47309953, "link": "https://stackoverflow.com/questions/47309953/how-to-add-tag-value-to-elements-entities-in-spark-ea-using-vba", "title": "How to add Tag Value to Elements/ Entities in Spark EA using VBA?", "body": "<p>I am trying to port some data from Excel sheet into EA model. I have managed to build a model, However I want to add some tag values to the elements/entities I have created through VBA. I have used Geert Bellekens EAExcelimporter utility and modified/amended it to suit my requirements.I am however not able to extend it to add tagged values to Entities. Anyhelp in this regards shall be greatly appreciated. </p>\n\n<p>Thanks,\nRahul.</p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 2, "creation_date": 1510755568, "post_id": 47309751, "comment_id": 81569760, "body": "Welcome to SO. I could not find a question, can you please clarify what kind of help are you looking for? Please read&gt; <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 13, "user_id": 8945477, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2Hyzp4MshuA/AAAAAAAAAAI/AAAAAAAAD5s/Vr_K8Hut-Jw/photo.jpg?sz=128", "display_name": "Michael Coburn", "link": "https://stackoverflow.com/users/8945477/michael-coburn"}, "edited": false, "score": 1, "creation_date": 1510760251, "post_id": 47309751, "comment_id": 81573537, "body": "Silly me, I edited the post with clarification. Thanks for pointing that out David!"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1510767019, "post_id": 47309751, "comment_id": 81578292, "body": "Please make sure to upvote helpful answers and mark the best answer.  This is our currency!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8945477, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2Hyzp4MshuA/AAAAAAAAAAI/AAAAAAAAD5s/Vr_K8Hut-Jw/photo.jpg?sz=128", "display_name": "Michael Coburn", "link": "https://stackoverflow.com/users/8945477/michael-coburn"}, "edited": false, "score": 0, "creation_date": 1510775784, "post_id": 47313689, "comment_id": 81583180, "body": "That worked perfectly. The crucial bit was:       sSel.Add obj"}], "tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": true, "score": 3, "last_activity_date": 1510766668, "creation_date": 1510766668, "answer_id": 47313689, "question_id": 47309751, "link": "https://stackoverflow.com/questions/47309751/cant-export-symbol-and-color-of-catia-points/47313689#47313689", "title": "Can&#39;t Export Symbol and Color of CATIA points", "body": "<p>VisProperties is a property of the Selection object. </p>\n\n<p>So what you need to do is after your initial selection, put all the point objects into selection one by one to get the information.</p>\n\n<p>So, taking up from after you select the geometrical set, something like this:</p>\n\n<pre><code>Set ohybridbody = sSEL.Item(1).Value\n\n'clear the selection  \nsSel.Clear\n\nfor i = 1 to oHybridBody.HybridShapes.Count\n    Set obj = oHybridBody.HybridShapes.Item(i)\n    obj.GetCoordiates coords\n    sSel.Add obj\n    sSel.VisProperties.GetSymbolType symbol\n    sSel.VisProperties.GetRealColor r, g, b\n    ....  output your results....\n    sSel.Clear \nNext\n</code></pre>\n\n<p>This assumes that all you have are points in your geometrical set. If not you have to filter each object in the HybridShapes collection for points only.</p>\n"}], "owner": {"reputation": 13, "user_id": 8945477, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2Hyzp4MshuA/AAAAAAAAAAI/AAAAAAAAD5s/Vr_K8Hut-Jw/photo.jpg?sz=128", "display_name": "Michael Coburn", "link": "https://stackoverflow.com/users/8945477/michael-coburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 47313689, "answer_count": 1, "score": -1, "last_activity_date": 1601367903, "creation_date": 1510755425, "last_edit_date": 1510760614, "question_id": 47309751, "link": "https://stackoverflow.com/questions/47309751/cant-export-symbol-and-color-of-catia-points", "title": "Can&#39;t Export Symbol and Color of CATIA points", "body": "<p>This is my first post asking for help with code I've written, please ask for clarification if you need it!\n   I am trying to export point data from CATIA V5. Currently I have a macro which takes user selection of a Geometric Set of points and exports position but I also want to export the symbol type and color.\n   The CATIA given example code shows how to access visual properties as VisProperties with one item selected and I've tried to adapt that to take my automation bodies. <strong>My question is, how do I export color and symbol type from automation bodies?</strong> Here is what I have so far:</p>\n\n<pre><code>Language=\"VBSCRIPT\"\n\nSub CATMain()\n\nDim oPartDoc As Part\nOn Error Resume Next\nSet oPartDoc = CATIA.ActiveDocument.Part    \nIf Err.Number &lt;&gt; 0 Then                   \nMessage = MsgBox(\"Sorry, This script works with a CATPart as Active \ndocument\", vbCritical, \"Error\")\nExit Sub\nEnd If\n\n    ' What do want to select\n\n    Dim EnableSelectionFor(0)\n    EnableSelectionFor(0) = \"HybridBody\"\n\n    ' Reset the Selection\n\n    Set sSEL = CATIA.ActiveDocument.Selection\n    sSEL.Clear\n\n ' Define Selection\n\n    MsgBox \"Please Select the Geometrical Set that contains Points\"\n\n    UserSelection = sSEL.SelectElement2(EnableSelectionFor,  \"Please select \nanother Geometrical Set\", False)\n    ' Evaluation if the selectio is correct or not\n    If UserSelection &lt;&gt; \"Normal\" Then\n        MsgBox \"Error with the selection\"\n        Exit Sub\nElse\nSet ohybridbody = sSEL.Item(1).Value\n\n    MsgBox \"The Geometrical Set selected is : \" &amp; ohybridbody.Name \n\n    End If\n'//Defining collection arrays\n\nReDim acoord(2)\nDim symbol\nDim r, g, b\n\n'//initializing symbol and color collection arrays, may be wrong?\n\nsymbol=CLng(0)\nr=CLng(0)\ng=CLng(0)\nb=CLng(0)\n\n\n\n'---------------------------------------------------------------------------\n-----\n'   The location of the result file\n'---------------------------------------------------------------------------\n-----\nDim filename As String\n\nfilename = CATIA.FileSelectionBox(\"Where do you want to save the result \nfile\", \"*.txt\", CatFileSelectionModeSave)\n\nSet Datos = CATIA.FileSystem.CreateFile(filename &amp; \".txt\" , True)\n\nSet ostream = Datos.OpenAsTextStream(\"ForAppending\")\n\nostream.Write (\"Points Extraction from \" &amp; oPartDoc.Name &amp; \".CATPart\" &amp; \nChr(10))\nostream.Write (\" \"&amp; Chr(10))\nostream.Write (\"The selected Geometrical Set was : \" &amp; ohybridbody.Name &amp; \nChr(10))\nostream.Write (\" \"&amp; Chr(10))\n\n'////Selection of points within geometrical set\nSet oshapes = ohybridbody.HybridShapes\n\n'///this part may be wrong\nSet visproperties1=oshapes.VisProperties\n\n'///Loop to run on each point in geometrical set\nFor i = 1 To oshapes.Count\noshapes.Item(i).GetCoordinates acoord\n\n'////Trying to access visual properties , def wrong here\nvisproperties1.Item(i).GetSymbolType symbol\nvisproperties1.Item(i).GetRealColor r, g, b\n\n'/////Writing to file\n\nSet reference1 = oshapes.Item(i)\n\nostream.Write (reference1.Name &amp; Chr(0009) &amp; acoord(0) &amp; Chr(0009) &amp; \nacoord(1) &amp; Chr(0009) &amp; acoord(2) &amp; Chr(0009) &amp; symbol &amp; Chr(0009) &amp; r &amp; \nChr(0009) &amp; g &amp; Chr(0009) &amp; b &amp; Chr(0009) &amp; Chr(10))\n\nNext\n\nostream.Close\n\nMsgBox  \"Points Exported :\" &amp; (i-1) &amp; \"x\" &amp; Chr(10) &amp; Chr(10) &amp; \"Please \nCheck the following file for result : \" &amp;  chr(10) &amp;  chr(10) &amp; filename &amp;  \nchr(10)&amp;  chr(10) &amp; \"Process finished\" \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1510757529, "post_id": 47309660, "comment_id": 81571369, "body": "Are you trying to comment my answer or Vityata ?"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1510757623, "post_id": 47309660, "comment_id": 81571444, "body": "Tried to comment yours haha."}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1510755949, "post_id": 47309842, "comment_id": 81570064, "body": "<code>If ws.Range(&quot;E18&quot;).Value=&quot;N&#47;A&quot; then</code> won&#39;t find cells with <code>#N&#47;A</code>, you need to use <code>CVErr(xlErrNA)</code>"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1510756030, "post_id": 47309842, "comment_id": 81570136, "body": "LastRow is only relevant for the &quot;Summary&quot; sheet, all the other worksheets are newly generated and they are standardized forms (meaning that cell E18 will always contain a value that is Pass/Fail or N/A). Now that you say it I am not even sure if LastRow is necessary as all, I am just trying to make it so that the values found on the worksheets will change always the next row for each sheet to N/A on &quot;Summary&quot; sheet. It&#39;s a bit hard to explain haha"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1510756950, "post_id": 47309842, "comment_id": 81570872, "body": "@ShaiRado - true, still I was thinking about a string."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510857616, "post_id": 47309842, "comment_id": 81625615, "body": "FWIW - the <code>For X = 22 To LastRow</code> loop is just doing the same thing <code>LastRow - 21</code> times.  (The inside of the loop isn&#39;t dependent on <code>X</code>.)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1510756875, "last_edit_date": 1525816189, "creation_date": 1510755655, "answer_id": 47309842, "question_id": 47309660, "link": "https://stackoverflow.com/questions/47309660/looping-through-worksheets-and-check-cell-value/47309842#47309842", "title": "Looping through worksheets and check cell value", "body": "<p>Try to reverse the nested loops. Something like this should be working:</p>\n\n<pre><code>Sub MyTestSub()\n    Dim ws As Worksheet\n    For Each ws In Worksheets\n        LastRow = ws.Cells(ws.Rows.Count, \"G\").End(xlUp).Row            \n        If IsError(ws.Range(\"E18\")) then \n            For X = 22 To LastRow\n                Sheets(\"Summary\").Range(\"G\" &amp; LastRow) = ws.Range(\"E18\")\n            next x\n        end if\n    Next ws                 \nEnd Sub\n</code></pre>\n\n<p>Furthermore, I assume that the <code>LastRow</code> is different per worksheet, thus you have to reset it quite often - every time there is a new worksheet.\nLast but not least - make sure that you refer the worksheet, when you are refering to <code>Cells</code>, like this:</p>\n\n<pre><code>LastRow = ws.Cells(ws.Rows.Count, \"G\").End(xlUp).Row            \n</code></pre>\n\n<p>If you do not do it you will be taking into account the <code>ActiveSheet</code>.</p>\n\n<p>Here is more about the errors in Excel and returning them - <a href=\"http://www.cpearson.com/excel/ReturningErrors.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/ReturningErrors.aspx</a></p>\n\n<p>The solution will work with any error, not only with <em>#N/A</em></p>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1510757518, "post_id": 47310295, "comment_id": 81571357, "body": "how would I go about using this method to loop through all the worksheets though?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1510757588, "post_id": 47310295, "comment_id": 81571409, "body": "@Rhyfelwr is <code>LastRow</code> looked in every sheet ? or just &quot;Master&quot; ?"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1510757722, "post_id": 47310295, "comment_id": 81571534, "body": "Basically E18 is a constant, it always contains a value (Pass/Fail or N/A) on all worksheets except Summary I&#39;d only check what value E18 contains, and if it contains N/A then I&#39;d also want to change the value of G23 to N/A for the first sheet examined, then G24 for the second and so on, hence the need for LastRow."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1510757873, "post_id": 47310295, "comment_id": 81571644, "body": "@Rhyfelwr try edited code, see if this what you wanted"}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1510758255, "post_id": 47310295, "comment_id": 81571937, "body": "sadly it still doesn&#39;t do it. I mean that E18 contains the string N/A as is, I see that xlErrNa is different in your code."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1510758535, "last_edit_date": 1510758535, "creation_date": 1510756980, "answer_id": 47310295, "question_id": 47309660, "link": "https://stackoverflow.com/questions/47309660/looping-through-worksheets-and-check-cell-value/47310295#47310295", "title": "Looping through worksheets and check cell value", "body": "<p>It needs to be a 2-Step procedure:</p>\n\n<ol>\n<li>Check if <code>IsError</code> in the cell.</li>\n<li>Check if the type of error is <code>#N/A</code>, with <code>If .Range(\"E18\").Value = CVErr(xlErrNA) Then</code>.</li>\n</ol>\n\n<p>Otherwise, if you have a regular <code>String</code>, like \"Pass\" you will get an error.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Dim lRow As Long\n\nLastRow = Sheets(\"Summary\").Cells(Sheets(\"Summary\").Rows.Count, \"G\").End(xlUp).Row\nlRow = 23 ' start from row 23\n\nFor Each ws In Worksheets\n    With ws\n        If .Name &lt;&gt; \"Summary\" Then\n            If IsError(.Range(\"E18\").Value) Then\n                If .Range(\"E18\").Value = CVErr(xlErrNA) Then\n                    Sheets(\"Summary\").Range(\"G\" &amp; lRow).Value = CVErr(xlErrNA)\n                End If\n            End If\n        End If\n    End With\n    lRow = lRow + 1\nNext ws   \n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "accepted_answer_id": 47310295, "answer_count": 2, "score": 0, "last_activity_date": 1510758535, "creation_date": 1510755186, "last_edit_date": 1510755260, "question_id": 47309660, "link": "https://stackoverflow.com/questions/47309660/looping-through-worksheets-and-check-cell-value", "title": "Looping through worksheets and check cell value", "body": "<p>I am trying to loop through all sheets and check them one by one and do the following: If in the checked cell the value of E18 = N/A then on the first sheet (named Summary) I'd change the value of G23 to N/A as well (and then do that for each cell, and on Summary change G23 then G24 then G25 and so forth) I wrote the following loop, it runs but it doesn't do anything whatsoever</p>\n\n<pre><code>Sub MyTestSub()\n\nDim ws As Worksheet\n\nLastRow = Cells(Rows.Count, \"G\").End(xlUp).Row\nFor X = 22 To LastRow\n    For Each ws In Worksheets\n        If ws.Range(\"E18\").Value=\"N/A\" then ThisWorkbook.Sheets(\"Summary\").Range(\"G\"&amp;x).Value=\"N/A\"\n    Next ws                 \nNext x\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 0, "creation_date": 1510755602, "post_id": 47309593, "comment_id": 81569787, "body": "the need is pretty much a fail safe so that the sheet copied is not accidently pasted over crucial data/formulas that are found in row 200 and below on sheet6. side note: I cannot move this table without completely reworking 9 modules worth of code."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 0, "creation_date": 1510755695, "post_id": 47309810, "comment_id": 81569855, "body": "well the data is pasted starting in cell A12. so 200 rows - the 12 it doesn&#39;t use = 188...a 1 row cushion would be 187 rows...I should have explained that first sorry"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1510755598, "creation_date": 1510755598, "answer_id": 47309810, "question_id": 47309593, "link": "https://stackoverflow.com/questions/47309593/currentregion-copy-and-destination-stopper/47309810#47309810", "title": "currentregion.copy and destination stopper", "body": "<p>You can simplify the code to what is below. Your post is a bit confusing because first you say below 200, then 187. Whatever you need can be placed in the rows argument of the <code>Resize</code> method.</p>\n\n<pre><code>Dim CopySheet as Worksheet\nCopySheet = Worksheets(Sheet6.Range(\"E3\").Value))\n\nWith CopySheet.Range(\"A1\").CurrentRegion\n    .Resize(186,.Columns.Count).Copy Destination:=Sheet6.Range(\"A12\")\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1977, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510755598, "creation_date": 1510755045, "last_edit_date": 1531164843, "question_id": 47309593, "link": "https://stackoverflow.com/questions/47309593/currentregion-copy-and-destination-stopper", "title": "currentregion.copy and destination stopper", "body": "<p>I have a snippet of code</p>\n\n<pre><code>For Each wkSht In Sheets\n\n    If Sheet6.Range(\"E3\").Value = wkSht.Name Then\n    wkSht.Range(\"A1\").CurrentRegion.Copy Destination:=Sheet6.Range(\"A12\")\n    End If    \nNext\n</code></pre>\n\n<p>need to modify this so that when copied to sheet6, it will not copy anything over row 200 and below. so in the event the currentregion is >= 187 rows, it will not copy/paste anything past that. Done some googling and can't find any solution to this</p>\n"}, {"tags": ["html", "vba", "excel"], "comments": [{"owner": {"reputation": 11828, "user_id": 4420967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6pYX.png?s=128&g=1", "display_name": "James Z", "link": "https://stackoverflow.com/users/4420967/james-z"}, "edited": false, "score": 0, "creation_date": 1510758702, "post_id": 47309038, "comment_id": 81572256, "body": "Oh my... posting errors as pictures is already wrong way of doing it, but taking a picture of your screen... Try to find snipping tool in your windows, or install for example GreenShot"}, {"owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "reply_to_user": {"reputation": 11828, "user_id": 4420967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6pYX.png?s=128&g=1", "display_name": "James Z", "link": "https://stackoverflow.com/users/4420967/james-z"}, "edited": false, "score": 0, "creation_date": 1510758938, "post_id": 47309038, "comment_id": 81572457, "body": "code is already there in my post, and i put this screenshot to describe/show that the code just jump from yellow line to END SUB with out executing or touching other line...wondering why this is happening  any way thanks @James Z"}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1510756015, "post_id": 47309491, "comment_id": 81570123, "body": "Thanks @MarcinSzaleniec I tried   <code>For Each MyHTML_Element In HTMLDoc.getElementsByClassName (&quot;childmenu&quot;) debug.print MyHTML_Element.href  If Instr(MyHTML_Element.href, &quot;1713363899&#47;ViewLogsPage&quot;) Then MyHTML_Element.Click</code>  but they are not working"}, {"owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1510756900, "post_id": 47309491, "comment_id": 81570844, "body": "i tried both the code as u mentioned with and with out Debug print (i dont used it before). But I can see the code is not even executing any comments after 1st line <code>For Each MyHTML_Element In HTMLDoc.getElementsByClassName (&quot;childmenu&quot;)</code>, it just jump to End sub"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1510757285, "post_id": 47309491, "comment_id": 81571167, "body": "Debug.Print prints value of its argument in the Immediate Window. You can show Immediate Window by shortctu ctrl+G, it is very useful. I suspect that your for each loops through 0 elements. To check it you may add &#39;debug.print Ubound(HTMLDoc.getElementsByClassName (&quot;childmenu&quot;) )&#39;."}, {"owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1510758060, "post_id": 47309491, "comment_id": 81571786, "body": "it says expected array"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1510758250, "post_id": 47309491, "comment_id": 81571928, "body": "I expected it too. HTMLDoc.getElementsByClassName (&quot;childmenu&quot;) should be an array of HTML elements, shouldn&#39;t it? Now I think that something wrong must in in your earlier code."}, {"owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "edited": false, "score": 0, "creation_date": 1510758430, "post_id": 47309491, "comment_id": 81572063, "body": "My code have only 2 part, Part 1: login to a webpage (completely operates in a secured server and a intranet). And the Part 2: is to Navigate to a dropdown page by clicking the tab from the Menu bar. Where My 1st part is working perfectly fine which means I can login to the web using my VBA code, now the very beginning of  part2 is getting failed its like after login the desired tab is not getting clicked...   and the code gets ended"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 1, "last_activity_date": 1510754741, "creation_date": 1510754741, "answer_id": 47309491, "question_id": 47309038, "link": "https://stackoverflow.com/questions/47309038/vba-how-to-click-a-drop-down-in-a-web-page-with-the-help-of-href-and-class-html/47309491#47309491", "title": "VBA: How to click a drop down in a web page with the help of HREF and CLASS HTML tag avilable", "body": "<p>Try </p>\n\n<pre><code>If Instr(MyHTML_Element.href, \"1713363899/ViewLogsPage\") Then MyHTML_Element.Click\n</code></pre>\n\n<p>If not works, add debug.print MyHTML_Element.href before line with If. It is possible that link is generated while page is being download. </p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1529600837, "creation_date": 1529600837, "answer_id": 50974061, "question_id": 47309038, "link": "https://stackoverflow.com/questions/47309038/vba-how-to-click-a-drop-down-in-a-web-page-with-the-help-of-href-and-class-html/50974061#50974061", "title": "VBA: How to click a drop down in a web page with the help of HREF and CLASS HTML tag avilable", "body": "<p>Use a CSS selector of <code>.childmenu[href='./1713363899/ViewLogsPage']</code>. Which reads as the elements with classname <code>childmenu</code> having attribute <code>href</code> with value <code>'./1713363899/ViewLogsPage'</code> </p>\n\n<hr>\n\n<p><strong>CSS selector in action:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/raqEU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/raqEU.png\" alt=\"css query\"></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<p>You apply the CSS selector with the <code>.querySelector</code> method of the <code>.document</code></p>\n\n<pre><code>MyBrowser.document.querySelector(\".childmenu[href='./1713363899/ViewLogsPage']\").Click\n</code></pre>\n\n<hr>\n\n<p><strong>Info on:</strong></p>\n\n<ol>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selectors</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\"><code>.querySelector</code> method</a></li>\n</ol>\n\n<p>Bonus track:</p>\n\n<p><a href=\"https://flukeout.github.io/\" rel=\"nofollow noreferrer\">Feast on CSS selectors</a> to home your CSS ninja skills - I have no affiliation with this. Found it today and it was fun.</p>\n\n<p>Or try the tester via this: <a href=\"https://www.w3schools.com/cssref/css_selectors.asp\" rel=\"nofollow noreferrer\">CSS Selector Reference</a></p>\n"}], "owner": {"reputation": 106, "user_id": 8409084, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0b243d25c4f5fa36b3075c79a5b9f81e?s=128&d=identicon&r=PG&f=1", "display_name": "mithun nair", "link": "https://stackoverflow.com/users/8409084/mithun-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 1, "accepted_answer_id": 47309491, "answer_count": 2, "score": 0, "last_activity_date": 1529600837, "creation_date": 1510753500, "last_edit_date": 1510758597, "question_id": 47309038, "link": "https://stackoverflow.com/questions/47309038/vba-how-to-click-a-drop-down-in-a-web-page-with-the-help-of-href-and-class-html", "title": "VBA: How to click a drop down in a web page with the help of HREF and CLASS HTML tag avilable", "body": "<p>I am trying to automate one of my website working on a secured server, the code which help me to log into the web page but after that I have to click a dropdown from a menu bar where the HTML tag available is CLASS and HREF only. </p>\n\n<p><strong>HTML</strong></p>\n\n<pre><code>&lt;li&gt;  \n&lt;a Class = \"childmenu\" href=\"./1713363899/ViewLogsPage\"&gt;  \n&lt;span&gt;Logs&lt;/Span&gt;  \n&lt;/a&gt;  \n&lt;/li&gt;\n</code></pre>\n\n<p><strong>A part of my VBA code is</strong>  </p>\n\n<pre><code>Dim MyHTML_Element as IHTMLElement \nSet HTMLDoc = MyBrowser.document\n\n\nFor Each MyHTML_Element In HTMLDoc.getElementsByClassName (\"childmenu\") \nIf MyHTML_Element.href = \"./1713363899/ViewLogsPage\" Then MyHTML_Element.Click:  \nExit For  \nNext  \n</code></pre>\n\n<p>but this code not working and Skip after executing this line \".....ClassName (\"childmenu\")\" and jump to END sub, when i run my code in Debug mode.</p>\n\n<p><a href=\"https://i.stack.imgur.com/STGDD.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/STGDD.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "sharepoint"], "comments": [{"owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "edited": false, "score": 0, "creation_date": 1510834210, "post_id": 47308343, "comment_id": 81609209, "body": "Really? No one is using VBA to update Excel file in Sharepoint? :)"}, {"owner": {"reputation": 101, "user_id": 9203029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a8d240a957d9c6b64ae7c3e3c54e810?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/9203029/rob"}, "edited": false, "score": 0, "creation_date": 1597672699, "post_id": 47308343, "comment_id": 112202082, "body": "I&#39;m stuck with the same issue and the LockServerFile is ignoring the Application.DisplayAlerts = false directive. In my opinion this function is badly implemented. I was also not able to find another function to check lock status upfront."}], "owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 845, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1565332866, "creation_date": 1510751595, "last_edit_date": 1558272843, "question_id": 47308343, "link": "https://stackoverflow.com/questions/47308343/handle-file-in-use-dialog-box-in-the-code-when-updatinf-files-on-sharepoint", "title": "Handle &quot;File In Use&quot; dialog box in the code when updatinf files on SharePoint", "body": "<p>I need to edit macro enabled Excel workbooks in SharePoint from Excel files stored locally.</p>\n\n<p>Many users can try to update a SharePoint file at the same time. A yellow belt pops-up with information: READ ONLY We opened this workbook read-only from the server (see screen below).</p>\n\n<p>I've a solution to skip that notification:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    ActiveWorkbook.LockServerFile  \nEnd Sub\n</code></pre>\n\n<p>The problem is when one user has .LockServerFile enabled, another notification window shows for other users, notifying that the file is in use (see screen below).</p>\n\n<p>Is it possible to avoid showing this window? Then ActiveWorkbook.LockServerFile will raise an exception, so I could handle it.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    'Excel.Application.DisplayAlerts = False 'does not work\n    'ActiveWorkbook.ReadOnly = True 'always is read only before .LockServerFile\n    ActiveWorkbook.LockServerFile\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/2KEE6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2KEE6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Or maybe there's some other way to update Excel files on Sharepoint, using Excel 2016?</p>\n"}, {"tags": ["vba", "excel", "pause"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 6, "creation_date": 1510752265, "post_id": 47308165, "comment_id": 81567431, "body": "Google is a marvelous tool...search for:  vba check if windows is locked   and you get:  <a href=\"https://www.mrexcel.com/forum/microsoft-access/646623-check-if-system-locked-unlocked-using-vba.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/microsoft-access/&hellip;</a>"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1510752582, "post_id": 47308165, "comment_id": 81567669, "body": "One day I found something like that: <a href=\"http://www.cpearson.com/excel/ShellAndWait.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/ShellAndWait.aspx</a>"}, {"owner": {"reputation": 3, "user_id": 8945211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6124c0259f344df322e6a61bb8f371f?s=128&d=identicon&r=PG&f=1", "display_name": "Turkeyplucker", "link": "https://stackoverflow.com/users/8945211/turkeyplucker"}, "edited": false, "score": 0, "creation_date": 1510754927, "post_id": 47308165, "comment_id": 81569322, "body": "Thanks. Ran that in a new blank worksheet: no problem. Added it to my existing sheet: &quot;Compile error: Variable not defined&quot; for &quot;system&quot;. Why the difference?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1510755960, "post_id": 47308165, "comment_id": 81570072, "body": "Assuming you mean the code found at the link I provided, I can&#39;t explain &#39;difference&#39; without knowing exactly all the steps you took for each test. I do know why you get the compile error: &#39;System&#39; is not defined. I simply defined a string variable named System and then ran the code. You would need to place a call to &#39;Check_If_Locked&#39; just before you want to alert the user, and if locked, go into a wait-state (i.e. use the timer)."}, {"owner": {"reputation": 3, "user_id": 8945211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6124c0259f344df322e6a61bb8f371f?s=128&d=identicon&r=PG&f=1", "display_name": "Turkeyplucker", "link": "https://stackoverflow.com/users/8945211/turkeyplucker"}, "edited": false, "score": 0, "creation_date": 1510757332, "post_id": 47308165, "comment_id": 81571202, "body": "Yes, that code. Defined the variable and all was well. So how, when I tried it first as the only code in a new, blank workbook, did it run without?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1510761184, "post_id": 47308165, "comment_id": 81574298, "body": "The short answer is Option Explicit. Your program I suspect has it - and so objected to an undeclared variable. The blank workbook didn&#39;t and so wouldn&#39;t object to the error"}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1510757197, "creation_date": 1510757197, "answer_id": 47310375, "question_id": 47308165, "link": "https://stackoverflow.com/questions/47308165/pause-excel-macro-while-windows-is-locked/47310375#47310375", "title": "Pause Excel macro while Windows is locked", "body": "<p>Before you call Application.speech you could check if the system is locked and if it is locked you repeat the check every minute until it is unlocked.\nCode if a system is locked </p>\n\n<pre><code>Sub SystemLocked()\n\n    Do While Check_If_Locked = \"Locked\"\n        Application.Wait TimeValue(\"00:00:01\")\n    Loop\n\n    MsgBox \"Done\"\n\nEnd Sub\n</code></pre>\n\n<p>Code for Check_If_Locked can be found here\n<a href=\"https://www.mrexcel.com/forum/microsoft-access/646623-check-if-system-locked-unlocked-using-vba.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/microsoft-access/646623-check-if-system-locked-unlocked-using-vba.html</a></p>\n"}], "owner": {"reputation": 3, "user_id": 8945211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6124c0259f344df322e6a61bb8f371f?s=128&d=identicon&r=PG&f=1", "display_name": "Turkeyplucker", "link": "https://stackoverflow.com/users/8945211/turkeyplucker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 892, "favorite_count": 0, "accepted_answer_id": 47310375, "answer_count": 1, "score": 0, "last_activity_date": 1510757197, "creation_date": 1510751057, "last_edit_date": 1510752938, "question_id": 47308165, "link": "https://stackoverflow.com/questions/47308165/pause-excel-macro-while-windows-is-locked", "title": "Pause Excel macro while Windows is locked", "body": "<p>I have a macro which runs an SQL query, which triggers a long slow recalculation of the spreadsheet based on the new data. When it finishes I've used <code>application.speech</code> to alert me if certain conditions have been met; all this works fine. But:</p>\n\n<p>As I said, the recalculation can take quite a while, so I sometimes lock Windows and go do something else while I wait. Does anyone know of a way to pause the macro so that it doesn't run the last few lines (i.e. the audio alerts) until Windows is unlocked?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 3, "creation_date": 1510752321, "post_id": 47308114, "comment_id": 81567472, "body": "Show us what you have tried to accomplish your stated task.  What has gone wrong?  I would also suggest you indent your code so it will be more readable.  In the long run, this will make debugging much simpler."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510757592, "post_id": 47308114, "comment_id": 81571414, "body": "Just save the new worksheet (sheets.add) to a new workbook.  Why do you name the sheet myarr(i) &amp; &quot;&quot;?  What is the &amp; &quot;&quot; for?"}, {"owner": {"reputation": 11, "user_id": 7307181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3eea98dbff4bdd757635e7520784fc7?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Sahu", "link": "https://stackoverflow.com/users/7307181/vipin-sahu"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1510811437, "post_id": 47308114, "comment_id": 81595844, "body": "@mooseman I tried to run the above macro and it is throwing an error &#39;runtime error 13 type mismatch&#39;  for &#39;For i = 2 To UBound(myarr)&#39;. Please help me in error to be fixed."}, {"owner": {"reputation": 11, "user_id": 7307181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3eea98dbff4bdd757635e7520784fc7?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Sahu", "link": "https://stackoverflow.com/users/7307181/vipin-sahu"}, "edited": false, "score": 0, "creation_date": 1510811671, "post_id": 47308114, "comment_id": 81595912, "body": "Also, I can correlate my problem with one of the questions that have been asked earlier in stack overflow."}, {"owner": {"reputation": 11, "user_id": 7307181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3eea98dbff4bdd757635e7520784fc7?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Sahu", "link": "https://stackoverflow.com/users/7307181/vipin-sahu"}, "edited": false, "score": 0, "creation_date": 1510812178, "post_id": 47308114, "comment_id": 81596091, "body": "Also, I can correlate my problem with one of the questions that have been asked earlier in stack overflow. <a href=\"https://stackoverflow.com/questions/26144525/splitting-data-from-excel-worksheet-into-multiple-workbooks\" title=\"splitting data from excel worksheet into multiple workbooks\">stackoverflow.com/questions/26144525/&hellip;</a>. But the problem is, the macro is saving the code itself in spite of saving the data in multiple excel file with name Book 1, Book 2 ..etc."}, {"owner": {"reputation": 11, "user_id": 7307181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3eea98dbff4bdd757635e7520784fc7?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Sahu", "link": "https://stackoverflow.com/users/7307181/vipin-sahu"}, "edited": false, "score": 0, "creation_date": 1510903901, "post_id": 47308114, "comment_id": 81642568, "body": "Please help me with this problem."}], "answers": [{"tags": [], "owner": {"reputation": 4296, "user_id": 2507160, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/06be8766cbeac85ccf17f646e4aaa142?s=128&d=identicon&r=PG", "display_name": "jeffreyweir", "link": "https://stackoverflow.com/users/2507160/jeffreyweir"}, "is_accepted": false, "score": 1, "last_activity_date": 1510775057, "creation_date": 1510775057, "answer_id": 47315974, "question_id": 47308114, "link": "https://stackoverflow.com/questions/47308114/split-data-into-multiple-workbooks-based-on-column/47315974#47315974", "title": "Split data into multiple Workbooks based on column", "body": "<p>It looks like your posted code above came from www.extendoffice.com </p>\n\n<p>A simple google search turned up more code on that site that does what you ask for:</p>\n\n<p><a href=\"https://www.extendoffice.com/documents/excel/1174-excel-split-data-into-multiple-worksheets-based-on-column.html#a1\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/excel/1174-excel-split-data-into-multiple-worksheets-based-on-column.html#a1</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7307181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3eea98dbff4bdd757635e7520784fc7?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Sahu", "link": "https://stackoverflow.com/users/7307181/vipin-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4622, "favorite_count": 0, "closed_date": 1510778985, "answer_count": 1, "score": -1, "last_activity_date": 1510775057, "creation_date": 1510750912, "last_edit_date": 1510752792, "question_id": 47308114, "link": "https://stackoverflow.com/questions/47308114/split-data-into-multiple-workbooks-based-on-column", "closed_reason": "Needs more focus", "title": "Split data into multiple Workbooks based on column", "body": "<p>I am trying to split my data into multiple excel files that will carry the name of my \"unique value\". I usually perform this task every day.</p>\n\n<p>I have about 50 columns, column A contains the unique value, which can be repeated several times. The other columns carry information regarding the unique value. I would also prefer if the original formatting of the file remains.</p>\n\n<p>I have the macro which is splitting the data within workbook (multiple worksheets). But I want to split the data into different workbooks. If possible, save the different workbooks with unique value name.</p>\n\n<p>Code: `</p>\n\n<pre><code>Sub parse_data()\nDim lr As Long\nDim ws As Worksheet\nDim vcol, i As Integer\nDim icol As Long\nDim myarr As Variant\nDim title As String\nDim titlerow As Integer\nvcol = 1        \nSet ws = Sheets(\"Sheet1\")        \nlr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\ntitle = \"A1:C1\"            \ntitlerow = ws.Range(title).Cells(1).Row\nicol = ws.Columns.Count\nws.Cells(1, icol) = \"Unique\"\nFor i = 2 To lr\nOn Error Resume Next\nIf ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\nws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\nEnd If\nNext\nmyarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\nws.Columns(icol).Clear\nFor i = 2 To UBound(myarr)\nws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\nIf Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\nSheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\nElse\nSheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count)\nEnd If\nws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\nSheets(myarr(i) &amp; \"\").Columns.AutoFit\nNext\nws.AutoFilterMode = False\nws.Activate\nEnd Sub`\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 9, "last_activity_date": 1510750951, "creation_date": 1510750951, "answer_id": 47308126, "question_id": 47308051, "link": "https://stackoverflow.com/questions/47308051/vba-create-a-new-workbook-with-a-button-click/47308126#47308126", "title": "VBA Create a new workbook with a button click", "body": "<p>Try the following code from:</p>\n\n<blockquote>\n  <p><a href=\"https://msdn.microsoft.com/en-us/library/office/aa221273(v=office.11).aspx\" rel=\"noreferrer\">https://msdn.microsoft.com/en-us/library/office/aa221273(v=office.11).aspx</a></p>\n</blockquote>\n\n<pre><code>Sub AddNew()\nSet NewBook = Workbooks.Add\n    With NewBook\n        .Title = \"All Sales\" 'You can modify this value.\n        .Subject = \"Sales\" 'You can modify this value.\n        .SaveAs Filename:=\"Allsales.xls\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>To get the path of the file there is already a question about that:</p>\n\n<blockquote>\n  <p><a href=\"https://stackoverflow.com/questions/2813925/how-to-get-the-path-of-current-worksheet-in-vba\">How to get the path of current worksheet in VBA?</a></p>\n</blockquote>\n"}], "owner": {"reputation": 323, "user_id": 6239914, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/295b536e2a78883107ce063e2013d787?s=128&d=identicon&r=PG&f=1", "display_name": "Rulli Smith", "link": "https://stackoverflow.com/users/6239914/rulli-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38984, "favorite_count": 2, "accepted_answer_id": 47308126, "answer_count": 1, "score": 7, "last_activity_date": 1510752180, "creation_date": 1510750692, "question_id": 47308051, "link": "https://stackoverflow.com/questions/47308051/vba-create-a-new-workbook-with-a-button-click", "title": "VBA Create a new workbook with a button click", "body": "<p>I'm trying to create a macro that creates a new workbook when pressing a button on the already existing workbook. I would like to save the newly created workbook in the same folder as the exiting workbook and give it a new name? Could somebody help me please?</p>\n\n<p>Thank you very much in advance!</p>\n\n<p>That's the code I have until now but it doesn't work as I want it (object not found and doesn't save it in the same folder):</p>\n\n<pre><code>Sub CreateNewWorkBook()\n\n'Adding New Workbook\nWorkbooks.Add\n'Saving the Workbook\n ActiveWorkbook.SaveAs Filename:=thisWb.Path &amp; \"\\Test.xls\"\n ActiveWorkbook.Close savechanges:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1510751496, "post_id": 47308028, "comment_id": 81566866, "body": "you need to loop through <code>Workbooks</code>, then loop through <code>Worksheets</code>, and then you can use this code."}, {"owner": {"reputation": 65, "user_id": 5372552, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-B5CGu_S3PMw/AAAAAAAAAAI/AAAAAAAAFGA/dPuhgwGUyog/photo.jpg?sz=128", "display_name": "Suneel V", "link": "https://stackoverflow.com/users/5372552/suneel-v"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1510752073, "post_id": 47308028, "comment_id": 81567273, "body": "Yes, I have done that too"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1510752169, "post_id": 47308028, "comment_id": 81567359, "body": "So share with us your full code, as this one is missing some crucial parts"}, {"owner": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1510757405, "post_id": 47308028, "comment_id": 81571252, "body": "Tried your code with multiple .xls in a folder using Excel 2013, works for me. If the compatibility checker annoys (in my case I just had to press OK for each workbook with your macro, it still worked) you just search for a solution on the web, there are a few sites showing up."}], "owner": {"reputation": 65, "user_id": 5372552, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-B5CGu_S3PMw/AAAAAAAAAAI/AAAAAAAAFGA/dPuhgwGUyog/photo.jpg?sz=128", "display_name": "Suneel V", "link": "https://stackoverflow.com/users/5372552/suneel-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1440, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510752451, "creation_date": 1510750603, "last_edit_date": 1510752451, "question_id": 47308028, "link": "https://stackoverflow.com/questions/47308028/delete-multiple-columns-in-multiple-excel-files-present-in-a-folder", "title": "Delete multiple columns in multiple Excel files present in a folder", "body": "<p>I had tried this code for one excel sheet.</p>\n\n<pre><code>Sub sbVBS_To_Delete_Multiple_Columns ()\nColumns(\"A:C\").EntireColumn.Delete\nEnd Sub\n</code></pre>\n\n<p>This worked well for one excel sheet in the folder, I want to loop through all the excel files in that folder and do it in one go, any help is appreciated. </p>\n\n<p>After adding the logic of traversing through all the files in the folder</p>\n\n<pre><code>\u200bSub LoopAllExcelFilesInFolder()\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim myExtension As String\nDim FldrPicker As FileDialog\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n\nSet FldrPicker = Application.FileDialog(msoFileDialogFolderPicker)\n\nWith FldrPicker\n  .Title = \"Select A Target Folder\"\n  .AllowMultiSelect = False\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    myPath = .SelectedItems(1) &amp; \"\\\"\nEnd With\nNextCode:\nmyPath = myPath\nIf myPath = \"\" Then GoTo ResetSettings\n'Target File Extension (must include wildcard \"*\")\nmyExtension = \"*.xls*\"\n'Target Path with Ending Extention\nmyFile = Dir(myPath &amp; myExtension)\n'Loop through each Excel file in folder\n Do While myFile &lt;&gt; \"\"\n 'Set variable equal to opened workbook\n  Set wb = Workbooks.Open(Filename:=myPath &amp; myFile)    \n 'Ensure Workbook has opened before moving on to next line of code\n  DoEvents\n\n 'Change First Worksheet's Background Fill Blue\n  wb.Worksheets(1).Range(\"A1:Z1\").Interior.Color = RGB(51, 98, 174)\n  wb.Worksheets(1).Columns(\"A:B\").EntireColumn.Delete\n 'Save and Close Workbook\n  wb.Close SaveChanges:=True      \n 'Ensure Workbook has closed before moving on to next line of code\n  DoEvents\n 'Get next file name\n  myFile = Dir\nLoop\nResetSettings:\n'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>Problem is Compatibility checker, have to disable that.</p>\n"}, {"tags": ["excel", "vba", "date", "filter"], "comments": [{"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "edited": false, "score": 0, "creation_date": 1510748976, "post_id": 47307140, "comment_id": 81565049, "body": "Have you had a look in to the <code>=NetworkDays()</code> worksheet function? This will calculate the number of working days between two dates, and may help you achieve what you need."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1510750728, "post_id": 47307140, "comment_id": 81566332, "body": "You can use the Excel function <code>WORKDAY</code> if your weekend is <code>Sat, Sun</code>.  If it is other than that, use <code>WORKDAY.INTL</code> to define the weekend days.  Both are available in VBA as members of the <code>WorksheetFunction</code> object."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1510748941, "creation_date": 1510748941, "answer_id": 47307450, "question_id": 47307140, "link": "https://stackoverflow.com/questions/47307140/exclude-weekend-days-when-adding-to-current-date-vba/47307450#47307450", "title": "Exclude weekend days when adding to current date VBA", "body": "<p>This function should do what you want:</p>\n\n<pre><code>Function GetNextWorkingDay(dt As Date) As Date\n  Select Case Weekday(dt)\n    Case 1\n      GetNextWorkingDay = DateAdd(\"d\", 1, dt)\n    Case 7\n      GetNextWorkingDay = DateAdd(\"d\", 2, dt)\n    Case Else\n      GetNextWorkingDay = dt\n  End Select\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1510748950, "creation_date": 1510748950, "answer_id": 47307458, "question_id": 47307140, "link": "https://stackoverflow.com/questions/47307140/exclude-weekend-days-when-adding-to-current-date-vba/47307458#47307458", "title": "Exclude weekend days when adding to current date VBA", "body": "<p>The function <code>weekDay</code> can hep you. The second parameter defines what day return 1, <code>vbMonday</code> would say that Mondays are 1, Saturday = 6, Sunday = 7</p>\n\n<p>So, one way would be:</p>\n\n<pre><code>deldate = DateSerial(Year(Date + 3), Month(Date + 3), Day(Date + 3) + 6)\nDo While (Weekday(deldate, vbMonday) &gt;= 6)\n    deldate = deldate + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8511033, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l9YivFD19Xk/AAAAAAAAAAI/AAAAAAAAXBs/-s5mET9JTiA/photo.jpg?sz=128", "display_name": "Asen Panayotov", "link": "https://stackoverflow.com/users/8511033/asen-panayotov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3727, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1510748950, "creation_date": 1510748039, "question_id": 47307140, "link": "https://stackoverflow.com/questions/47307140/exclude-weekend-days-when-adding-to-current-date-vba", "title": "Exclude weekend days when adding to current date VBA", "body": "<p>I have the following piece of code, which is excluding all results in excel sheet that have date different than today + 6 days.\nThe problem is that when I execute that on Monday I hit Sunday. \nI need to change it in a way that it will add always 6 days to my current date unless the result is Saturday or Sunday, then I would like to take the first working day after that, meaning - Monday. </p>\n\n<pre><code>    Public Sub GRP_SC_Filter1()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n\n    Dim DelDate As Long\n\n\n    DelDate = DateSerial(Year(Date), Month(Date), Day(Date) + 6)\n\n\n    LR = Sheets(\"Goods Receivable Planning\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Cells.AutoFilter Field:=13, Criteria1:=\"&lt;&gt;\" &amp; DelDate\n\n    ALR = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    If ALR &gt; 2 Then\n        Range(\"A2:A\" &amp; LR).SpecialCells(xlCellTypeVisible).Select\n        Range(\"A2:A\" &amp; LR).Delete\n        Range(\"A1\").Activate\n    End If\n    Cells.AutoFilter\n '  MsgBox \"Finished deleting rows\"\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I would be really thankful if somebody could help me transforming this into what I need. I am honestly stuck. Thank you in advance! </p>\n"}, {"tags": ["excel", "vba", "autocad"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510748453, "post_id": 47307064, "comment_id": 81564690, "body": "You <code>Dim EXCELApplication</code>  but you never SET it to anything."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510748916, "post_id": 47307064, "comment_id": 81564999, "body": "I edited that but it still does not return a value"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510749046, "post_id": 47307064, "comment_id": 81565100, "body": "What is the value of <code>AcadToExcel</code> ? Where are you learning how to do this? Your code is very incomplete."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510749259, "post_id": 47307064, "comment_id": 81565263, "body": "The value is dynamic, It changes .. this is not all the code but this is the part of the code that is supposed to give me the value"}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1510749508, "post_id": 47307064, "comment_id": 81565474, "body": "okay, how do i do this?"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510751629, "post_id": 47307750, "comment_id": 81566959, "body": "This works but the problem is that the spreadsheet I want it to take the value from is open already, now what the code does is to open a new spreadsheet and it doesn&#39;t have the value, how can I go about this?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510752096, "post_id": 47307750, "comment_id": 81567296, "body": "Look into <code>GetObject(,&quot;Excel.Application&quot;)</code> instead."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510752200, "post_id": 47307750, "comment_id": 81567383, "body": "I&#39;m not sure if I understand, should I specify my specific spreadsheet there or what? How can I write a &quot;ActiveWorkbook&quot; syntax that works"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510752532, "post_id": 47307750, "comment_id": 81567632, "body": "Dont use <code>ActiveWorkbook</code> - Once you have your <code>Application</code> object, parse the <code>WorkBooks</code> collection for name of the WorkBook you are looking for."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510753460, "post_id": 47307750, "comment_id": 81568306, "body": "It just opens another workbook and names it &quot;AcadToExcel1&quot;, when I run it again it opens and names as &quot;AcadToExcel2&quot; etc...I do not know how to remedy this"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510753684, "post_id": 47307750, "comment_id": 81568456, "body": "Use <code>Open</code> instead of <code>Add</code> then, or you could use <code>Instr</code> to check for &quot;AcadToExcel&quot; existing in the Workbook name."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510823068, "post_id": 47307750, "comment_id": 81601510, "body": "How do I close the workbook using AutoCAD <code>EXCELApplication.workbooks.Close sFile</code> gives me an error"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "edited": false, "score": 0, "creation_date": 1510833841, "post_id": 47307750, "comment_id": 81608950, "body": "You dont close the <code>Workbooks</code> collection, you close the <code>Workbook</code>."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 2, "last_activity_date": 1510749810, "creation_date": 1510749810, "answer_id": 47307750, "question_id": 47307064, "link": "https://stackoverflow.com/questions/47307064/autocad-to-excel/47307750#47307750", "title": "AutoCAD to Excel", "body": "<p>I just tested this and it works just fine for me:</p>\n\n<pre><code>Public Sub GetFromExcel()\n  Dim sFile As String\n  sFile = \"C:\\Users\\\" &amp; Environ$(\"Username\") &amp; \"\\Desktop\\Test2.xlsx\"\n  Dim EXCELApplication As Object\n  Dim ExcelWorksheet As Object\n  Dim sValue As String\n\n  Set EXCELApplication = CreateObject(\"Excel.Application\")\n  EXCELApplication.workbooks.Add sFile\n  EXCELApplication.Visible = True\n  Set ExcelWorksheet = EXCELApplication.ActiveWorkbook.Sheets(\"Sheet1\")\n\n  sValue = ExcelWorksheet.Range(\"A1\").Value\n\n  MsgBox sValue\n\nEnd Sub\n</code></pre>\n\n<p>If it doesnt work for you, then the problem is your filename.</p>\n"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 47307750, "answer_count": 1, "score": 0, "last_activity_date": 1510749810, "creation_date": 1510747817, "last_edit_date": 1510748893, "question_id": 47307064, "link": "https://stackoverflow.com/questions/47307064/autocad-to-excel", "title": "AutoCAD to Excel", "body": "<p>Hi How can I access a spreadsheet from AutoCad and take a value from there and use it on AutoCAd\nHere is my code but it does not get the value , it's always empty. Don't know what's wrong</p>\n\n<pre><code>Sub move()\nDim EXCELApplication As Object\nDim ExcelWorksheet As Object\n\nSet EXCELApplication = CreateObject(\"Excel.Application\")\nEXCELApplication.workbooks.Open AcadToExcel\nEXCELApplication.Visible = True\nSet ExcelWorksheet = EXCELApplication.ActiveWorkbook.Sheets(\"Sheet1\")\n\nmodelsize = ExcelWorksheet.Cells(21, 3).Value\n\nSize = modelsize\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510747708, "post_id": 47306987, "comment_id": 81564206, "body": "<code>Dim Fail as Integer</code> should be <code>Dim Fail as String</code>, you can&#39;t use an Integer to display a character like %."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "reply_to_user": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510747902, "post_id": 47306987, "comment_id": 81564313, "body": "Hi thanks for the answer, I tested it now but when running the code with String declaration nothing happens, no values changed."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "reply_to_user": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510748139, "post_id": 47306987, "comment_id": 81564480, "body": "Ah nevermind, I took out the quotation marks from the declaration and typed just 0 and now it works like a charm. Thanks for the answer!"}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510748243, "post_id": 47306987, "comment_id": 81564555, "body": "Alright, I think I know where the problem lies, the formatting is automatically changed to Percentage. So remove &quot;%&quot; from <code>Fail = &quot;0%&quot;</code> so it becomes <code>Fail = &quot;0&quot;</code>, you can also change the <code>Dim Fail As String</code> back to <code>Dim Fail As Integer</code>"}], "answers": [{"tags": [], "owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "is_accepted": true, "score": 1, "last_activity_date": 1510748442, "last_edit_date": 1510748442, "creation_date": 1510747925, "answer_id": 47307096, "question_id": 47306987, "link": "https://stackoverflow.com/questions/47306987/trying-to-use-a-number-with-percentage-as-value/47307096#47307096", "title": "Trying to use a number with percentage as value", "body": "<p>The character \"%\" can't exist within an integer. You can only use whole numbers when dimming an integer. <a href=\"https://en.wikipedia.org/wiki/Integer\" rel=\"nofollow noreferrer\">Source</a></p>\n\n<p>Your problem lies within <code>Fail = \"0%\"</code>, excel automatically changes the formatting of all cells containing % to percentage. So what you need to do is to change <code>Fail = \"0%\"</code> to <code>Fail = \"0\"</code>.</p>\n\n<p>See the final code below:</p>\n\n<pre><code>Dim Fail As Integer\nFail = \"0\"\nThisWorkbook.Sheets(\"Summary\").Activate\nLastRow = Cells(Rows.Count, \"G\").End(xlUp).Row\n    For X = 22 To LastRow\n\n    If Range(\"G\" &amp; X).Value = Fail Then Range(\"G\" &amp; X).Value = \"N/A\"\nNext X\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510748645, "post_id": 47307265, "comment_id": 81564817, "body": "This is by far the best solution to the problem. Funnily enough after 1 year of VBA experience,  I didn&#39;t know about this. Thank you!"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510749199, "post_id": 47307265, "comment_id": 81565215, "body": "@EliasWick Thanks for the comment."}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 2, "last_activity_date": 1510748420, "creation_date": 1510748420, "answer_id": 47307265, "question_id": 47306987, "link": "https://stackoverflow.com/questions/47306987/trying-to-use-a-number-with-percentage-as-value/47307265#47307265", "title": "Trying to use a number with percentage as value", "body": "<p>Use simple replace statement on your range.</p>\n\n<pre><code>Worksheets(\"Summary\").Range(\"G22:G1000\").Replace What:=\"0%\", Replacement:=\"NA\"\n</code></pre>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 47307096, "answer_count": 2, "score": 0, "last_activity_date": 1510748442, "creation_date": 1510747574, "question_id": 47306987, "link": "https://stackoverflow.com/questions/47306987/trying-to-use-a-number-with-percentage-as-value", "title": "Trying to use a number with percentage as value", "body": "<p>Hi there I am trying to run a loop that changes the value of all cells containing 0% to value \"N/A\". I wrote the following code: </p>\n\n<pre><code>Dim Fail As Integer\nFail = \"0%\"\nThisWorkbook.Sheets(\"Summary\").Activate\nLastRow = Cells(Rows.Count, \"G\").End(xlUp).Row\n    For X = 22 To LastRow\n\n    If Range(\"G\" &amp; X).Value = Fail Then Range(\"G\" &amp; X).Value = \"N/A\"\nNext X\n</code></pre>\n\n<p>but all it does is that it replaces all the values in column G with \"N/A\". Where did I go wrong? </p>\n"}, {"tags": ["vba", "excel", "checkbox"], "comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510748004, "post_id": 47306930, "comment_id": 81564392, "body": "Have you tried <code>msgbox (ThisWorkbook.Worksheets(2).Shapes(&quot;cBox1&quot;).OLEFormat.Object&zwnj;&#8203;.Value)</code> to verify it&#39;s definitely changing, worksheets &quot;Images&quot; is definitely worksheets(2)? I am trying to reproduce an error but it&#39;s working successfully for me :/"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510748194, "post_id": 47306930, "comment_id": 81564520, "body": "What I mean is, I am using <code>MsgBox (ActiveSheet.Shapes(&quot;Check Box 1&quot;).OLEFormat.Object.Value)</code> and depending on whether it&#39;s checked or not, I get either a 1 or a -4146. An IF condition works fine for this so I assume your problem is finding the checkbox, on a different worksheet or called something else maybe."}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510750701, "post_id": 47306930, "comment_id": 81566313, "body": "Try changing <code>Worksheets(2)</code> to <code>Worksheets(&quot;Images&quot;)</code>"}, {"owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510750814, "post_id": 47306930, "comment_id": 81566397, "body": "@jamheadart changing to Worksheets(&quot;Images&quot;) produces an error"}, {"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510751795, "post_id": 47306930, "comment_id": 81567074, "body": "Is it a &quot;Subscript out of range&quot; or <code>Run Time Error 9</code> ? I supsect you&#39;re not actually checking the right sheet here."}, {"owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510829479, "post_id": 47306930, "comment_id": 81606101, "body": "@jamheadart The error on <code>msgbox (ThisWorkbook.Worksheets(2).Shapes(&quot;cBox1&quot;).OLEFormat.Object&zwnj;&#8203;\u200c\u200b.Value)</code> is <code>Object doesn&#39;t support this property or method (Run-time error 428)</code>"}, {"owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510829801, "post_id": 47306930, "comment_id": 81606314, "body": "@jamheadart when I try <code>MsgBox (ActiveSheet.Shapes(&quot;Check Box 1&quot;).OLEFormat.Object.Value)</code> I get the error: <code>The item with the specified name wasn&#39;t found (Run-time error: -2147024809)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510749069, "post_id": 47307321, "comment_id": 81565119, "body": "There&#39;s a screen-extension size issue with using ActiveX components on worksheets however, be aware if you&#39;re going to be sending these code books out to people with laptops who dock and extend their screens a lot."}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "reply_to_user": {"reputation": 4239, "user_id": 6480658, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/79a2edab9dc17e4c66e1d91ebe7a40f7?s=128&d=identicon&r=PG&f=1", "display_name": "jamheadart", "link": "https://stackoverflow.com/users/6480658/jamheadart"}, "edited": false, "score": 0, "creation_date": 1510749506, "post_id": 47307321, "comment_id": 81565472, "body": "@jamheadart nice to know! Didn&#39;t know that. Is there a was this?"}, {"owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "edited": false, "score": 0, "creation_date": 1510750523, "post_id": 47307321, "comment_id": 81566181, "body": "@LucasRaphaelPianegonda I have tried changing one of them but I receive an error message. See updated question at the bottomn"}], "tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": false, "score": 2, "last_activity_date": 1510748580, "creation_date": 1510748580, "answer_id": 47307321, "question_id": 47306930, "link": "https://stackoverflow.com/questions/47306930/how-do-i-get-checkbox-value-in-a-sheet/47307321#47307321", "title": "How do I get checkbox value in a sheet?", "body": "<p>There is a simple solution to your problem:</p>\n\n<p><strong>Use an Active-X Checkbox</strong>. Under Developmenttools tab in the menu bar there is: \"Insert\" it lets you insert two kinds of checkboxes, two kinds of every control strucutre infact. One is an active-x component which is more recent and the other ones are just for backwards compatibility reasons. So never use anything else then Active-X components. Then the code can be used as followed: </p>\n\n<pre><code>If ThisWorkbook.Worksheets(2).Checkbox1.Value = False Then\n    totalOfWeldsInOrder = totalOfWeldsInOrder + 1\n    s1 = 0\n    notInOrder = True\nEnd If\n</code></pre>\n\n<p>The Checkbox name \"CheckBox1\" can be changed by showing and editing it's properties so it might also be called \"okbox\" this name will then replace CheckBox1 in your code. </p>\n"}], "owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2945, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510829624, "creation_date": 1510747424, "last_edit_date": 1510829624, "question_id": 47306930, "link": "https://stackoverflow.com/questions/47306930/how-do-i-get-checkbox-value-in-a-sheet", "title": "How do I get checkbox value in a sheet?", "body": "<p>I have multiple checkboxes called cBox1, cBox2 etc in a sheet called 'Images'.</p>\n\n<p><a href=\"https://i.stack.imgur.com/K6Z7m.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K6Z7m.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have three sheets: Data Table, Images, Data (respectively). <code>Images</code> contains two images with various checkboxes, a textbox and a button. When I click the button, the code gets value from the textbox and checkboxes and insert values into a table in the <code>Data</code> sheet.</p>\n\n<p>I am trying to get whether a checkbox is checked or not with the below code:</p>\n\n<pre><code>If ThisWorkbook.Worksheets(2).Shapes(\"cBox1\").OLEFormat.Object.Value = 0 Then\n    totalOfWeldsInOrder = totalOfWeldsInOrder + 1\n    s1 = 0\n    notInOrder = True\nEnd If\n</code></pre>\n\n<p>However, the value never changes.</p>\n\n<p>How can I get the checked value of the checkboxes?</p>\n\n<p>I have also tried the below, with no success:</p>\n\n<pre><code>If ThisWorkbook.Worksheets(2).Shapes(\"cBox1\").OLEFormat.Object.Value = -4146 Then\n    totalOfWeldsInOrder = totalOfWeldsInOrder + 1\n    s1 = 0\n    notInOrder = True\nEnd If\n</code></pre>\n\n<p>And Also</p>\n\n<pre><code>If Sheet2.Shapes(\"cBox1\").ControlFormat.Value = xlOff Then\n   ......\nEnd If\n</code></pre>\n\n<p>EDIT:</p>\n\n<pre><code>If ThisWorkbook.Worksheets(2).cBox1.Value = 0 Then\n    totalOfWeldsInOrder = totalOfWeldsInOrder + 1\n    s1 = 0\n    notInOrder = True\nEnd If\n</code></pre>\n\n<p>returns:</p>\n\n<p><a href=\"https://i.stack.imgur.com/e70cu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e70cu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510748186, "post_id": 47306918, "comment_id": 81564512, "body": "Check that <code>rgFound</code> is actually finding a value in column 13 or higher."}, {"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510750145, "post_id": 47306918, "comment_id": 81565910, "body": "rgFound = nothing, but when I go through each line (comment out the one below), and call .select on rgFound, newRange and newRange1, it all works... Do you know why this is?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510750318, "post_id": 47306918, "comment_id": 81566038, "body": "If you don&#39;t find <code>stringToFind</code> then <code>rgFound</code> is nothing and the <code>newRange</code> and <code>newRange1</code> lines will error."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510750444, "post_id": 47306918, "comment_id": 81566122, "body": "Do you have an <code>On Error</code> statement anywhere?"}, {"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510751256, "post_id": 47306918, "comment_id": 81566708, "body": "stringToFind finds the correct date, and my range is selected. And no, no On Error anywhere - Is it because the range is a variable? The error I get is that subscript is out of range"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1510751655, "post_id": 47306918, "comment_id": 81566980, "body": "Try <code>Debug</code>, add at the end of the code <code>Debug.Print rgFound.Address</code> and <code>Debug.Print newRange1.Address</code> , and see what strings are you getting"}, {"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "edited": false, "score": 0, "creation_date": 1510752156, "post_id": 47306918, "comment_id": 81567344, "body": "Debug.print for both variables = rgFound is $Q&amp;16, which on sheet1 is where today&#39;s date is, and newRange1 is $E$16:$P$17 on the same sheet, which are the dates and values for the last 12 months"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510755275, "post_id": 47306918, "comment_id": 81569550, "body": "Does this work? <code>Charts(&quot;Chart1&quot;).SetSourceData Source:=Sheets(&quot;Sheet1&quot;).range(newRange1.address)</code>"}, {"owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "edited": false, "score": 0, "creation_date": 1510756146, "post_id": 47306918, "comment_id": 81570250, "body": "Afraid not, it still errors and says subscript out of range"}], "owner": {"reputation": 197, "user_id": 7425684, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13ac0f69964f1050cdb2b48cc4154181?s=128&d=identicon&r=PG&f=1", "display_name": "Gandalfrandalf", "link": "https://stackoverflow.com/users/7425684/gandalfrandalf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510767811, "creation_date": 1510747383, "last_edit_date": 1531164843, "question_id": 47306918, "link": "https://stackoverflow.com/questions/47306918/set-source-data-of-chart-to-equal-a-range-defined-by-a-variable", "title": "Set source data of chart to equal a range defined by a variable", "body": "<p>For anybody that is interested, this now works for me. I think the problem I had earlier was that I was using .select and this was causing issues</p>\n\n<pre><code>Public Sub updateChart()\n</code></pre>\n\n<p>'Searches for today's date and selects everything for the last 12 months</p>\n\n<pre><code>Dim month\nDim year\nDim stringToFind\nDim newRange\nDim foundString\nDim newRange1\nDim newrange2\n</code></pre>\n\n<p>'Assign a value to the month and the year</p>\n\n<pre><code>month = VBA.DateTime.month(Date)\nyear = VBA.DateTime.year(Date)\n</code></pre>\n\n<p>'Make the search for string equal to the month + year variables</p>\n\n<pre><code>stringToFind = month &amp; \"/\" &amp; year\n</code></pre>\n\n<p>'Declare a range where you will look for the month and year</p>\n\n<pre><code>Set newRange = Worksheets(\"Sheet1\").Range(\"C16:Z16\")\n</code></pre>\n\n<p>'Search for the month and year</p>\n\n<pre><code>Set foundString = newRange.Find(stringToFind)\n</code></pre>\n\n<p>'Once the correct date has been found, resize the range to be the new data source - had to do this in two stages because could not use a - col number on the resize</p>\n\n<pre><code>Set newRange1 = foundString.Offset(0, -12)\n\nSet newrange2 = newRange1.Resize(2, 12)\n</code></pre>\n\n<p>'Update the chart with the new data source</p>\n\n<pre><code>Worksheets(\"Sheet2\").ChartObjects(\"chartName\").Chart.SetSourceData \nSource:=newrange2\n\n\nEnd Sub\n</code></pre>\n\n<p>Public Sub updateChart()</p>\n\n<pre><code>' Searches for today's date and selects everything for the last 12 months\n\nDim rgFound As Range\nDim month\nDim year\nDim stringToFind\nDim newRange\nDim newRange1\nDim newRange2\n\nmonth = VBA.DateTime.month(Date)\nyear = VBA.DateTime.year(Date)\n\nstringToFind = month &amp; \"/\" &amp; year\n\n\nWorksheets(\"Sheet1\").Activate\n\nSet rgFound = Worksheets(\"Sheet1\").Range(\"C16:z17\").Find(stringToFind)\n\nSet newRange = rgFound.Offset(0, -12)\n\nSet newRange1 = newRange.Resize(2, 12)\n</code></pre>\n\n<p>newRange1 now holds a series of dates in row 16 (as text so my find worked) and corresponding values in row 17</p>\n\n<pre><code>Charts(\"Chart1\").SetSourceData Source:=newRange1\n</code></pre>\n\n<p>I am trying to set the source data to newRange1 for chart1, but it returns an error: subscript out of range. The chart is on a different sheet to the information stored in newRange1. I am not sure how to set newRange1 to be the new source data for chart1 - any help would be much appreciated!</p>\n\n<pre><code>End Sub\n</code></pre>\n"}, {"tags": ["excel", "date", "vba"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1510755507, "post_id": 47307138, "comment_id": 81569717, "body": "Perfect I have amended the code that inputs dates to have CDate and it seems to be working. Thank you."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1510748034, "creation_date": 1510748034, "answer_id": 47307138, "question_id": 47306816, "link": "https://stackoverflow.com/questions/47306816/date-formats-in-vba-from-text-string/47307138#47307138", "title": "Date formats in VBA from Text String", "body": "<p>Is this what you're looking for?</p>\n\n<p>Dim podRNG As String, n1 As Integer, n2 As Integer, yourDate As Date</p>\n\n<pre><code>podRNG = \"PPP@11/15\"\n\nn1 = InStr(podRNG, \"@\") + 1\nn2 = InStr(podRNG, \"/\") + 1\n\nPPPTim = CDate(Mid(podRNG, n1, n2 - n1 - 1) &amp; \"/\" &amp; Mid(podRNG, n2) &amp; _\n    \"/\" &amp; Format(Now(), \"YYYY\"))\n</code></pre>\n\n<p>Returns (on my system):</p>\n\n<blockquote>\n  <p>2017-11-15</p>\n</blockquote>\n\n<p>...since the data type is <code>Date</code>, the <em>date format will vary</em> based on your Regional Settings.  </p>\n"}], "owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510748034, "creation_date": 1510747083, "last_edit_date": 1531161705, "question_id": 47306816, "link": "https://stackoverflow.com/questions/47306816/date-formats-in-vba-from-text-string", "title": "Date formats in VBA from Text String", "body": "<p>I have an issue with date formats that I cannot get my head around.</p>\n\n<p>I have 2 dates a reporting date which the user inputs Format is MM/DD/YYYY Showing as (11/15/2017) on the speadsheet. This is input from a Userform asking just for the Month and Date but uses the current year.</p>\n\n<p>I then have a series of codes which validates the Data Line matches the ReportDate and produces information. To get Data date I need to look in a text string find a the word PPP and get the numbers proceeding the @ symbol.</p>\n\n<p>I get the day and month value separately as only the day/month is visible in this string and appears like this <code>PPP@11/15</code></p>\n\n<p>Below is an extract of my code but it is not the full script.</p>\n\n<pre><code>Dim Year1 As Variant\nDim Month1 As Variant\nDim Day1 As Variant\n\nIf Not IsError(Mid(PODRng, InStr(1, PODRng, \"PPP\", vbTextCompare) + 4, 5)) Then                                                                                                        \nYear1 = Format(Now(), \"YYYY\")\nMonth1 = Mid(PPPRng, InStr(1, PPPRng, \"PPP\", vbTextCompare) + 4, 2)\nDay1 = Mid(PPPRng, InStr(1, PPPRng, \"PPP\", vbTextCompare) + 7, 2)\nPPPTim = Day1 &amp; \"/\" &amp; Month1 &amp; \"/\" &amp; Year1\n 'PPPTim.NumberFormat = \"MM/DD/YYYY\"\n\n    If PPPTim = ReportDate Then\n\n\n        Cell.Offset(0, 49).Value = PPPTim ' \n    ElseIf InStr(1, PODRng, \"PPP\", vbTextCompare) &gt; 0 Then\n        Cell.Offset(0, 49).Value = \"Other Date\"\n    End If\n</code></pre>\n\n<p>End If</p>\n\n<p>The data source is roughly 3k-5k lines and I have gone through the code and breaking when it gets to this code. I can confirm when checking the Locals both PPPTim and ReportDate are showing as 15/11/2017 but the match is coming through as False.</p>\n\n<p>Hopefully someone can help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510746965, "post_id": 47306394, "comment_id": 81563739, "body": "It seems like this belongs in Code Review, since your code is working (Very slowly) Here is the website explanation for Code Review: (Your question must contain code that is already working correctly, and the relevant code sections must be embedded in the question. Please avoid stripping out key details that may be relevant to the review. If your code is incomplete or not working, you should ask for help on another site.)  My suggestion would be: Try testing the code with a Do Loop (If possible) and see if that is faster than the For Next."}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510747369, "post_id": 47306394, "comment_id": 81564000, "body": "I modified the original code formatting to make it more readable, I hope you don&#39;t mind."}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 23, "user_id": 8855084, "user_type": "registered", "profile_image": "https://graph.facebook.com/896448543854925/picture?type=large", "display_name": "Sankar Narayanan", "link": "https://stackoverflow.com/users/8855084/sankar-narayanan"}, "edited": false, "score": 0, "creation_date": 1510748471, "post_id": 47306851, "comment_id": 81564705, "body": "on which line??"}, {"owner": {"reputation": 23, "user_id": 8855084, "user_type": "registered", "profile_image": "https://graph.facebook.com/896448543854925/picture?type=large", "display_name": "Sankar Narayanan", "link": "https://stackoverflow.com/users/8855084/sankar-narayanan"}, "edited": false, "score": 0, "creation_date": 1511326200, "post_id": 47306851, "comment_id": 81808576, "body": "It doesn&#39;t stop at any particular line."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 23, "user_id": 8855084, "user_type": "registered", "profile_image": "https://graph.facebook.com/896448543854925/picture?type=large", "display_name": "Sankar Narayanan", "link": "https://stackoverflow.com/users/8855084/sankar-narayanan"}, "edited": false, "score": 0, "creation_date": 1511344151, "post_id": 47306851, "comment_id": 81817253, "body": "If it doesn&#39;t stop at any line then how does it give a Run time error?"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 1, "last_activity_date": 1510747182, "creation_date": 1510747182, "answer_id": 47306851, "question_id": 47306394, "link": "https://stackoverflow.com/questions/47306394/array-in-vba-excel/47306851#47306851", "title": "Array in VBA + Excel", "body": "<p>I'm not sure how arrays would speed this up as really it is the locking/unlocking of cells which is causing the main speed issue (Although arrays could improve the read time). Anyway, I'd suggest setting the values you wish to lock/unlock to a range and then doing them all in one go instead of individually as that will be where your main performance impact is.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim sh As Object\n    Dim sheetnames As String\n    Dim i As Integer\n    Dim col As Range, LockRng As Range, UnLockRng As Range\n    Dim rng As Variant: Set rng = Application.Range(\"I16:BI300\") 'Value Lock &amp; Unlock is in Column Range I16 to BI16 and Row Range B16 to B300\n    Dim rngCell     As Variant\n    Application.ScreenUpdating = False\n        For Each sh In Sheets   'First Each\n            ' Reset Ranges for each sheet\n            Set LockRng = Nothing\n            Set UnLockRng = Nothing\n\n            If sh.Name &lt;&gt; \"Configuration\" Then      'Configuration If\n                sheetnames = sh.Name\n                Worksheets(sheetnames).Activate\n                ActiveSheet.Unprotect Password:=\"sos\"\n                For Each rngCell In Range(\"I22:BI300\")\n                    If (Cells(1, rngCell.Column) = \"Lock\" And Cells(rngCell.Row, 1) = \"Lock\") _\n                        Or (Cells(1, rngCell.Column) = \"UnLock\" And Cells(rngCell.Row, 1) = \"Lock\") _\n                        Or (Cells(1, rngCell.Column) = \"Lock\" And Cells(rngCell.Row, 1) = \"Unlock\") Then\n                            ' Create LockRng\n                            If LockRng Is Nothing Then\n                                Set LockRng = rngCell\n                            Else\n                                Set LockRng = Union(LockRng, rngCell)\n                            End If\n                    Else\n                        ' Create UnLockRng\n                        If UnLockRng Is Nothing Then\n                            Set UnLockRng = rngCell\n                        Else\n                            Set UnLockRng = Union(UnLockRng, rngCell)\n                        End If\n                    End If\n                Next rngCell\n                ActiveSheet.Protect Password:=\"sos\"\n            End If                      'End of Configuration If\n            ' Lock all cells in LockRng\n            If Not LockRng Is Nothing Then\n                LockRng.Locked = True\n                LockRng.Font.Color = -16776961\n            End If\n            ' Unlock all cells in UnLockRng\n            If Not UnLockRng Is Nothing Then\n                UnLockRng.Locked = False\n                UnLockRng.Font.ColorIndex = xlAutomatic\n            End If\n        Next sh     'End of First Each\n    Sheets(1).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8855084, "user_type": "registered", "profile_image": "https://graph.facebook.com/896448543854925/picture?type=large", "display_name": "Sankar Narayanan", "link": "https://stackoverflow.com/users/8855084/sankar-narayanan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510750709, "creation_date": 1510745807, "last_edit_date": 1510750709, "question_id": 47306394, "link": "https://stackoverflow.com/questions/47306394/array-in-vba-excel", "title": "Array in VBA + Excel", "body": "<p>I have written a macro, which should read the value in every sheet (Row and Column) based on the value given it should Lock the cell or leave it unlocked. The way the code is written right now it takes forever to compute. I was suggested it be done using arrays. However the array are also not working</p>\n\n<p>My excel file has got 15 sheets.\nMy Code is below.</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Dim sh As Object\n    Dim sheetnames As String\n    Dim i As Integer\n    Dim col As Range\n    Dim rng As Variant: Set rng = Application.Range(\"I16:BI300\") 'Value Lock &amp; Unlock is in Column Range I16 to BI16 and Row Range B16 to B300\n    Dim rngCell As Variant\n\n    Application.ScreenUpdating = False\n\n        For Each sh In Sheets 'First Each\n\n            If sh.Name &lt;&gt; \"Configuration\" Then 'Configuration If\n                sheetnames = sh.Name\n                Worksheets(sheetnames).Activate\n                ActiveSheet.Unprotect Password:=\"sos\"\n\n                For Each rngCell In Range(\"I22:BI300\")\n\n                    If (Cells(1, rngCell.Column) = \"Lock\" And Cells(rngCell.Row, 1) = \"Lock\") Or (Cells(1, rngCell.Column) = \"UnLock\" And Cells(rngCell.Row, 1) = \"Lock\") Or (Cells(1, rngCell.Column) = \"Lock\" And Cells(rngCell.Row, 1) = \"Unlock\") Then\n                        rngCell.Locked = True\n                        rngCell.Font.Color = -16776961\n                    Else\n                        rngCell.Locked = False\n                        rngCell.Font.ColorIndex = xlAutomatic\n                    End If\n\n                Next rngCell\n\n                ActiveSheet.Protect Password:=\"sos\"\n            End If 'End of Configuration If\n\n        Next sh 'End of First Each\n\n    Sheets(1).Select\n\nEnd Sub\n</code></pre>\n\n<p>Based on a combination of values in Column and Rows the result should produce values.</p>\n\n<pre><code>Column  Row Value\nLock    Lock    Lock\nUnlock  Lock    Lock\nLock    Unlock  Lock\nUnlock  Unlock  Unlock\n</code></pre>\n"}, {"tags": ["vba", "loops", "date", "range"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1510745699, "creation_date": 1510745699, "answer_id": 47306365, "question_id": 47306202, "link": "https://stackoverflow.com/questions/47306202/excel-vba-loop-if-statement-through-two-columns/47306365#47306365", "title": "Excel VBA: Loop IF statement through two columns", "body": "<p>This is a basic loop with condition, looping through two columns - column <code>A</code> and column <code>B</code>. Try it step by step on an empty Excel file and you will easily adjust yours to it:</p>\n\n<pre><code>Public Sub BasicLoop()\n\n    Dim i As Long\n\n    For i = 1 To 100\n        ActiveSheet.Cells(i, 1) = i * 2\n        If i * 2 / 4 Mod 2 = 0 Then\n            ActiveSheet.Cells(i, 2) = i * 4\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 8404996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0303a55cd00c03d6cc29625638cb2244?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowNoob", "link": "https://stackoverflow.com/users/8404996/overflownoob"}, "edited": false, "score": 0, "creation_date": 1510747484, "post_id": 47306508, "comment_id": 81564064, "body": "Thank you! I guess &quot;ID=date&quot; was missing, but now it works like a charm. Good day to you sir."}, {"owner": {"reputation": 41, "user_id": 8404996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0303a55cd00c03d6cc29625638cb2244?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowNoob", "link": "https://stackoverflow.com/users/8404996/overflownoob"}, "edited": false, "score": 0, "creation_date": 1510747701, "post_id": 47306508, "comment_id": 81564200, "body": "In terms of the Leap year do you think adding 365,25 days would work?"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 41, "user_id": 8404996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0303a55cd00c03d6cc29625638cb2244?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowNoob", "link": "https://stackoverflow.com/users/8404996/overflownoob"}, "edited": false, "score": 0, "creation_date": 1510748009, "post_id": 47306508, "comment_id": 81564398, "body": "I don&#39;t think so. I mean, this code will work good in 2017, but if you need it working in 2019 you shall update the macro. If you think that you will not remember about this or you will leave your work earlier, you can add variable that is 366 in leap and 365 in normal year. Just for the record."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": true, "score": 1, "last_activity_date": 1510746110, "creation_date": 1510746110, "answer_id": 47306508, "question_id": 47306202, "link": "https://stackoverflow.com/questions/47306202/excel-vba-loop-if-statement-through-two-columns/47306508#47306508", "title": "Excel VBA: Loop IF statement through two columns", "body": "<p>Date in excel is just number. So, </p>\n\n<pre><code>Dim ID as Double\n</code></pre>\n\n<p>To loop through all cell in column C</p>\n\n<pre><code>Dim cl As Range\n\nWith Sheets(\"Kunder\")\n    For Each cl In Intersect(.Range(\"C:C\"), .UsedRange)\n        If cl.Value = ID And cl.Offset(, 14).Value = 1 Then\n             cl.Value = cl.Value + 365\n        End If\n    Next cl\nEnd With\n</code></pre>\n\n<p>But, remember about leap years, they have 366 days. \n cl.Offset(, 14) is Q column, remember about it when inserting/deleting columns. </p>\n"}], "owner": {"reputation": 41, "user_id": 8404996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0303a55cd00c03d6cc29625638cb2244?s=128&d=identicon&r=PG&f=1", "display_name": "OverflowNoob", "link": "https://stackoverflow.com/users/8404996/overflownoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "accepted_answer_id": 47306508, "answer_count": 2, "score": -1, "last_activity_date": 1510746110, "creation_date": 1510745189, "question_id": 47306202, "link": "https://stackoverflow.com/questions/47306202/excel-vba-loop-if-statement-through-two-columns", "title": "Excel VBA: Loop IF statement through two columns", "body": "<p>I have a client list with various information. Column C shows inception date, Column Q shows Status.</p>\n\n<p>I need to loop an IF statement through Column C that checks todays date() and if the clients corresponding status is 100%. Then adds 1 year to the date in column C if true.</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim ID As Date\n    Dim Status As Long\n\n    ID = Sheets(\"Kunder\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\n\n    If ID&gt;= Date And Status = 1 Then\n    ID.Value = ID.Value + 365\n    End If\n\n\n    End Sub\n</code></pre>\n\n<p>Thank you very much :-)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8210756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31157426ae60874350def81eca26688e?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath Kumar T", "link": "https://stackoverflow.com/users/8210756/bharath-kumar-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1510742608, "last_edit_date": 1510742608, "creation_date": 1510742288, "answer_id": 47305192, "question_id": 47305081, "link": "https://stackoverflow.com/questions/47305081/excel-vba-code-to-copy-and-paste-rows-to-new-sheet-failing/47305192#47305192", "title": "Excel VBA code to copy and paste rows to new sheet failing", "body": "<pre><code>Sub Copy_Filtered_Sections()\n\nDim Section As Long, NextRow As Long\n\nFor Section = 1 To 32\n\n    NextRow = Sheets(\"Results\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1 'Next empty row\n\n    Sheets(\"Function Test Procedure\").Select\n\n    Range(\"FTPSec\" &amp; Section).Columns(\"A:H\").SpecialCells(xlCellTypeVisible).Copy _\n    Destination:=Sheets(\"Results\").Range(\"A\" &amp; NextRow)\n\n'        Range(\"FTPSec\" &amp; Section).Columns(\"G:H\").SpecialCells(xlCellTypeVisible).Copy _\n'            Destination:=Sheets(\"Results\").Range(\"N\" &amp; NextRow)\n\nNext Section\n\nEnd Sub\n</code></pre>\n\n<p>Acceptance Test Procedure Script</p>\n\n<pre><code>Sub Copy_ATP_Tables()\n\nDim SectionATP As Long, NextRow As Long\n\nFor SectionATP = 1 To 32\n\n    NextRow = Sheets(\"Results\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1 'Next empty row\n\n    Sheets(\"Acceptance Test Procedure\").Select\n\n    Range(\"ATPSec\" &amp; SectionATP).Columns(\"A:H\").SpecialCells(xlCellTypeVisible).Copy _\n    Destination:=Sheets(\"Results\").Range(\"A\" &amp; NextRow)\n\n'           Range(\"FTPSec\" &amp; Section).Columns(\"G:H\").SpecialCells(xlCellTypeVisible).Copy _\n'                Destination:=Sheets(\"Results\").Range(\"N\" &amp; NextRow)\n\nNext SectionATP\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 1, "creation_date": 1510742944, "post_id": 47305260, "comment_id": 81561132, "body": "Thanks for this solution it worked just how I wanted. If I also have the data occurring in the same column as &quot;defect resolution, 13/10/2017&quot; and &quot;defect resolution, 21/11/2018&quot; for example, all as text format. Is there a way to rip the date on the new sheet, create a new column and have those text dates inserted in to the column as date formatted?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510743196, "post_id": 47305260, "comment_id": 81561276, "body": "Not sure I follow. Do you mean the same row? &quot;defect resolution&quot; is in column E."}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510743394, "post_id": 47305260, "comment_id": 81561434, "body": "Sorry I meant the same fields, most fields would have the date, so after it is copied to a new sheet I need these actions to take the date, put in to a new column and format to be performed if possible"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510743858, "post_id": 47305260, "comment_id": 81561779, "body": "Sorry but still not sure what you are asking. Can you attach a screenshot or describe a specific example - where is the date, where should it go?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510745367, "post_id": 47305260, "comment_id": 81562715, "body": "Hi I added two images to original question, the first is how the data appears on sheet1 and the second is how it should appear on sheet2. Please note that column F on the second sheet (containing the dates) would need to be a new column and short date formatted"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510745627, "post_id": 47305260, "comment_id": 81562867, "body": "Thanks, I see now. Do you have values in other columns which is why you want the new column F inserted? I might suggest you post this as a new question as it may require a different approach."}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510746042, "post_id": 47305260, "comment_id": 81563138, "body": "Yes need a new column on the second sheet, I presumed it would just be a new function that would fall outside of the loop. I&#39;ll post a new question, thanks for the help."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510746125, "post_id": 47305260, "comment_id": 81563199, "body": "Don&#39;t worry, I&#39;ll amend the code above and let me know how it goes."}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510753135, "post_id": 47305260, "comment_id": 81568078, "body": "It is copying correct rows to sheet2 and is also creating new column, but the dates remain in column E the same as in Sheet1, and I get an error 400 pop-up box. Any ideas?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510755439, "post_id": 47305260, "comment_id": 81569660, "body": "Do you know how to step through code using F8? Insert some breakpoints and find out where it breaks. It worked for me on a small test."}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510756998, "post_id": 47305260, "comment_id": 81570921, "body": "It is delivering the details to Sheet2 and inserting new column, just is not splitting date in to the new column. Unfortunately I cannot find the resolution in the code to assign output to the new column created in Sheet2"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510763750, "post_id": 47305260, "comment_id": 81576196, "body": "(1) Did you try what I suggested in my previous comment? Learning how to debug code is crucial. (2) Can you try with a sample as shown in your picture - that worked for me. Are you 100% sure it inserts a column?"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510769664, "post_id": 47305260, "comment_id": 81579750, "body": "(1) I did try to debug and I watched it step by step as it adds the rows to new sheet and then inserts the column. It is this line of code     .Cells(v(i), &quot;E&quot;) = Split(.Cells(v(i), &quot;E&quot;), &quot;,&quot;)(0)     that creates the 400 error. (2) 100% a new column is added jus the dates aren&#39;t added to the column"}, {"owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510828176, "post_id": 47305260, "comment_id": 81605164, "body": "can you share your output?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "edited": false, "score": 0, "creation_date": 1510845136, "post_id": 47305260, "comment_id": 81617242, "body": "It&#39;s literally the same as in your screenshots. What I don&#39;t understand is that if it inserts a column then it means it has found at least entry with defect resolution followed by a comma. When you look in the Locals Window what is in <code>v</code>?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 2, "last_activity_date": 1510746141, "last_edit_date": 1510746141, "creation_date": 1510742487, "answer_id": 47305260, "question_id": 47305081, "link": "https://stackoverflow.com/questions/47305081/excel-vba-code-to-copy-and-paste-rows-to-new-sheet-failing/47305260#47305260", "title": "Excel VBA code to copy and paste rows to new sheet failing", "body": "<p>It might be enough to get rid of all those Selects which usually cause problems and are rarely needed (just need to add sheet references). However, AutoFilter or Find would be quicker methods.</p>\n\n<pre><code>Sub mileStone()\n\nDim r As Long, pasteRowIndex As Long, v() As Long, i As Long\n\nDim lastRow As Long\n'lastRow = sht.Range(\"A1\").CurrentRegion.Rows.Count\n\nlastRow = 13 '24 ' need to include function to retrieve the last used row number\n\npasteRowIndex = 1\n\nWith Sheets(\"Sheet1\")\n    For r = 11 To lastRow\n        If .Cells(r, \"E\").Value Like \"defect resolution*\" Then\n            If UBound(Split(.Cells(r, \"E\"), \",\")) &gt; 0 Then\n                i = i + 1\n                ReDim v(1 To i)\n                v(i) = pasteRowIndex\n            End If\n            Sheets(\"Sheet1\").Rows(r).Copy Sheets(\"Sheet2\").Rows(pasteRowIndex)\n            pasteRowIndex = pasteRowIndex + 1\n        End If\n    Next r\nEnd With\n\nWith Sheets(\"Sheet2\")\n    If IsArray(v) Then\n        .Columns(6).Insert shift:=xlToRight\n        For i = LBound(v) To UBound(v)\n            .Cells(v(i), \"F\") = Split(.Cells(v(i), \"E\"), \",\")(1)\n            .Cells(v(i), \"E\") = Split(.Cells(v(i), \"E\"), \",\")(0)\n        Next i\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 4278999, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/506072398/picture?type=large", "display_name": "SDROB", "link": "https://stackoverflow.com/users/4278999/sdrob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 47305260, "answer_count": 2, "score": 1, "last_activity_date": 1510752539, "creation_date": 1510742000, "last_edit_date": 1510752539, "question_id": 47305081, "link": "https://stackoverflow.com/questions/47305081/excel-vba-code-to-copy-and-paste-rows-to-new-sheet-failing", "title": "Excel VBA code to copy and paste rows to new sheet failing", "body": "<p>Hi I have the following VBA code that I am trying to use for excel to copy and paste rows that meet a certain criteria to a new sheet.</p>\n\n<p>The code runs to the point of copying the first match in the sheet but fails pasting on the second sheet with the error </p>\n\n<blockquote>\n  <p>Run-time error '14004': Application-defined or object-defined error</p>\n</blockquote>\n\n<p>Can anyone help here? </p>\n\n<pre><code>Sub mileStone()\n    Dim r As Long, pasteRowIndex As Long\n    Dim lastRow As Long\n    'lastRow = sht.Range(\"A1\").CurrentRegion.Rows.Count\n\n    lastRow = 24 ' need to include function to retrieve the last used row number \n\n    pasteRowIndex = 1\n\n    For r = 11 To lastRow 'Loop through sheet1 and search for your criteria\n\n        If Cells(r, Columns(\"E\").Column).Value = \"defect resolution\" Then 'Found\n\n            'Copy the current row\n            Rows(r).Select\n            Selection.Copy\n\n            'Switch to the sheet where you want to paste it &amp; paste\n            Sheets(\"Sheet2\").Select\n            Rows(pasteRowIndex).Select\n            ActiveSheet.Paste\n\n            'Next time you find a match, it will be pasted in a new row\n            pasteRowIndex = pasteRowIndex + 1\n\n            'Switch back to your table &amp; continue to search for your criteria\n            Sheets(\"Sheet1\").Select\n        End If\n    Next r\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/D1bAJ.png\" alt=\"Image as is\">\n<img src=\"https://i.stack.imgur.com/h2Ebn.png\" alt=\"Image required\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510741678, "post_id": 47304724, "comment_id": 81560301, "body": "Do you mean all worksheets in the workbook, or a selection?"}, {"owner": {"reputation": 35, "user_id": 7708346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cc844b537ce9edde62bc8f29f009f73?s=128&d=identicon&r=PG&f=1", "display_name": "TurboTemple", "link": "https://stackoverflow.com/users/7708346/turbotemple"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510742138, "post_id": 47304724, "comment_id": 81560617, "body": "@sjr All of the worksheets."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 7708346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cc844b537ce9edde62bc8f29f009f73?s=128&d=identicon&r=PG&f=1", "display_name": "TurboTemple", "link": "https://stackoverflow.com/users/7708346/turbotemple"}, "edited": false, "score": 0, "creation_date": 1510742874, "post_id": 47305068, "comment_id": 81561099, "body": "Thanks for the answer, I&#39;ve picked the other one as its a little simpler and I have to explain this to people who know even less about VBA than me."}], "tags": [], "owner": {"reputation": 683, "user_id": 7047935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wCtAP.jpg?s=128&g=1", "display_name": "smartobelix", "link": "https://stackoverflow.com/users/7047935/smartobelix"}, "is_accepted": false, "score": 0, "last_activity_date": 1510742271, "last_edit_date": 1510742271, "creation_date": 1510741966, "answer_id": 47305068, "question_id": 47304724, "link": "https://stackoverflow.com/questions/47304724/excel-vba-run-macro-across-dynamic-range-of-sheets/47305068#47305068", "title": "Excel VBA run macro across dynamic range of sheets", "body": "<pre><code>Public Function GetSheetNames(ByVal wbk As workbook) As String()\n    Dim names() As String\n    Dim count As Integer\n    Dim i As Integer\n\n        count = wbk.Worksheets.count\n\n        ReDim names(count - 1)\n        For i = 1 To wbk.Worksheets.count\n            names(i - 1) = wbk.Worksheets(i).Name\n        Next\n\n        GetSheetNames = names\n\n    End Function\n</code></pre>\n\n<p>Usage: <code>GetSheetNames(Application.ActiveWorkbook)</code></p>\n\n<p>UPDATE: For selected sheets only:</p>\n\n<pre><code>Public Function GetActiveSheetNames(ByVal wbk As workbook) As String()\nDim names() As String\nDim count As Integer\nDim i As Integer\n\n    count = wbk.Windows(1).SelectedSheets.count\n\n    ReDim names(count - 1)\n    For i = 1 To wbk.Windows(1).SelectedSheets.count\n        names(i - 1) = wbk.Windows(1).SelectedSheets(i).Name\n    Next\n\n    GetActiveSheetNames = names\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 3, "last_activity_date": 1510742264, "creation_date": 1510742264, "answer_id": 47305182, "question_id": 47304724, "link": "https://stackoverflow.com/questions/47304724/excel-vba-run-macro-across-dynamic-range-of-sheets/47305182#47305182", "title": "Excel VBA run macro across dynamic range of sheets", "body": "<p>You can do it like this (or could use the index along the lines of your original code).</p>\n\n<pre><code>Sub RemoveCarriageReturns()\n\nDim MyRange As Range\nDim ws As Worksheet\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nFor Each ws In Worksheets\n    With ws\n        For Each MyRange In .UsedRange\n            If 0 &lt; InStr(MyRange, Chr(10)) Then\n                MyRange = Replace(MyRange, Chr(10), \"\")\n            End If\n        Next MyRange\n    End With\nNext ws\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7708346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cc844b537ce9edde62bc8f29f009f73?s=128&d=identicon&r=PG&f=1", "display_name": "TurboTemple", "link": "https://stackoverflow.com/users/7708346/turbotemple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 47305182, "answer_count": 2, "score": 0, "last_activity_date": 1510743379, "creation_date": 1510740992, "last_edit_date": 1510743379, "question_id": 47304724, "link": "https://stackoverflow.com/questions/47304724/excel-vba-run-macro-across-dynamic-range-of-sheets", "title": "Excel VBA run macro across dynamic range of sheets", "body": "<p>As an extension from the last question I asked, I'm trying to run a macro across all worksheets, which you guys successfully helped me to do.\nI've been told that the worksheet names can't be hardcoded, so I'm going to have to modify my current solution.</p>\n\n<pre><code>Sub RemoveCarriageReturns()\nDim MyRange As Range\nDim NameList() As Variant\nNameList = Array(\"OTCUEXTR\", \"OTFBCUDS\", \"OTFBCUEL\")\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nFor i = 0 To 2\n    With Worksheets(NameList(i))\n        For Each MyRange In .UsedRange\n            If 0 &lt; InStr(MyRange, Chr(10)) Then\n                MyRange = Replace(MyRange, Chr(10), \"\")\n            End If\n        Next MyRange\n    End With\nNext i\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p>I've tried to populate the array with a For loop that gathers names of each worksheet however I feel after 2 days blankly staring at this,  my limited VBA knowledge has run out and I'm stuck, I would really appreciate some pointers on how to get this macro to work across an range of sheets that can change in quantity and names.</p>\n\n<p>Happy to provide any more information you need in a comment</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510741789, "post_id": 47304694, "comment_id": 81560378, "body": "On which line ?"}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510741939, "post_id": 47304694, "comment_id": 81560487, "body": "@SJR Can you expand please. Not sure what you&#39;re referring to."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510741957, "post_id": 47304694, "comment_id": 81560502, "body": "Which line produces the error?"}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510742035, "post_id": 47304694, "comment_id": 81560551, "body": "@SJR the <code>Application.Run MethodCallback, user_param_replace(Dictionary(Key), Params)</code> line. Will update the question."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510744058, "post_id": 47304694, "comment_id": 81561898, "body": "In that line are you intending to pass <code>user_param_replace(Dictionary(Key), Params)</code> as an argument of <code>MethodCallback</code>?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1510744291, "post_id": 47304694, "comment_id": 81562036, "body": "<code>Dim S() As String</code>, <code>S = Split(&quot;One,Two,Three&quot;,&quot;,&quot;)</code> and <code>Join(S, &quot;|&quot;)</code> will give a string &quot;One|Two|Three&quot; which can be split into an array with `S=Split(String, &quot;|&quot;). Is that what you are looking for?"}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510755534, "post_id": 47304694, "comment_id": 81569735, "body": "@SJR yes you&#39;re exactly right. I&#39;m trying to pass <code>user_param_replace(Dictionary(Key), Params)</code> to <code>MethodCallback</code> as a chain of parameters"}], "answers": [{"comments": [{"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1510757586, "post_id": 47308074, "comment_id": 81571407, "body": "When I run the code through a fresh Excel workbook I do not get an error on the <code>IsMissing(Params)</code> line - I get the error as reported in my question (Ensuring Microsoft Scripting Runtime is enabled!). Using the watch window I see that the outputs of the <code>user_param_replace</code> method is <code>1 - Foo,Bar</code> however it fails when that is passed as a parameter to the <code>custom_debug_print_multiple_params</code> method - even if the params are variants or ByVals."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1510798292, "post_id": 47308074, "comment_id": 81591963, "body": "The <code>IsMissing</code> line MUST throw an error if Param is missing. If it doesn&#39;t, search for the reason. I have added two sets of procedures to my answer above. Both of them work. You can&#39;t pass an array to a function that is expecting two strings."}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1510841345, "post_id": 47308074, "comment_id": 81614333, "body": "The <code>IsMissing</code> line is not throwing the error. I agree with your point about passing an array to a function expecting strings but I&#39;m trying to use the <code>Join(Output, &quot;,&quot;)</code> line to split the array into component strings  and to then stitch it together with a comma. So the array becomes <code>&quot;Foo&quot;, &quot;Bar&quot;</code> (two separate parameters) which I then try to pass, dynamically, to the <code>custom_debug_print_multiple_params</code>"}, {"owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1510841808, "post_id": 47308074, "comment_id": 81614691, "body": "Would the <code>ParamsArray</code> function be a better alternative than just passing in Optional Params?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "edited": false, "score": 0, "creation_date": 1510881253, "post_id": 47308074, "comment_id": 81635745, "body": "The receiving function would still have to decipher the paramarray. Therefore the paramarray should be preferable only if you have individual strings in the calling procedure. Since you have an array at that point you should teach the function to handle the array it receives. Incidentally, just because <code>IsMissing</code> doesn&#39;t throw an error doesn&#39;t mean it works as expected. It seems to me that you expect &quot;{D:Value}&quot; to be replaced with an item from the dictionary. Since there can&#39;t be any &quot;{D:Value}&quot; no replacement takes place. So, the function returns a null string as variant."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 1, "last_activity_date": 1510798665, "last_edit_date": 1510798665, "creation_date": 1510750758, "answer_id": 47308074, "question_id": 47304694, "link": "https://stackoverflow.com/questions/47304694/vba-join-array-elements-to-then-pass-as-multiple-parameters-to-function/47308074#47308074", "title": "VBA join array elements to then pass as multiple parameters to function", "body": "<p>There is a problem with this line of code.</p>\n\n<pre><code>replace_dictionary_values = Replace$(Params, \"{D:Value}\", Item)\n</code></pre>\n\n<p>This line is called when IsMissing(Params) = True and, predictably, returns an error.</p>\n\n<p>I also found that your test procedure can't work.</p>\n\n<pre><code>Function custom_debug_print_multiple_params(strPrint As String, strPrint2 As String) As String\n\n    Debug.Print strPrint &amp; strPrint2\n\nEnd Function\n</code></pre>\n\n<p>All your variables are variants but the two parameters of the above function are of string type. The arguments should be declared ByVal if variants of string type are to be passed. I recommend to test each function individually and make sure that it works before using its return value as parameters for other functions.</p>\n\n<p>I suspect that part of your problem may be caused by your rather indiscriminate use of variants. For example, the <code>Replace</code> function you invoke in the faulty line quoted above requires 3 strings as arguments. In your code, both <code>Item</code> and <code>Params</code> (if it would exist) are variants. There is a good chance that your plan could actually work, but when something doesn't quite work, as is the case here, all those corners that were cut will have to be checked, adding more time to the debugging effort than could be saved during coding.</p>\n\n<p>In the first example below the calling procedure supplies the two strings required by the called procedure. Variants of string type are passed which are converted to strings by the ByVal argument.</p>\n\n<pre><code>Function Test_TestPrint() As Boolean\n\n    Dim dictTest As New Scripting.Dictionary\n    Dim MyArray(0 To 1) As Variant\n\n    dictTest.Add 1, \"1 - Foo\"\n    dictTest.Add 2, \"2 - Foo\"\n    dictTest.Add 3, \"3 - Foo\"\n    MyArray(0) = \"{D:Value}\"\n    MyArray(1) = \"Bar\"\n\n    TestPrint MyArray(0), MyArray(1)\n'    user_func_dictionary_loop dictTest, \"TestPrint\", MyArray\n    Test_TestPrint = True\nEnd Function\n\nSub TestPrint(ByVal strPrint As String, ByVal strPrint2 As String)\n    Debug.Print strPrint &amp; strPrint2\nEnd Sub\n</code></pre>\n\n<p>In the code below the array is passed to the executing procedure which expects such an array and prints out its elements.</p>\n\n<pre><code>Function Test_TestPrint2() As Boolean\n\n    Dim dictTest As New Scripting.Dictionary\n    Dim MyArray(0 To 1) As Variant\n\n    dictTest.Add 1, \"1 - Foo\"\n    dictTest.Add 2, \"2 - Foo\"\n    dictTest.Add 3, \"3 - Foo\"\n    MyArray(0) = \"{D:Value}\"\n    MyArray(1) = \"Bar\"\n\nSub TestPrint2 MyArray\n'    user_func_dictionary_loop dictTest, \"TestPrint\", MyArray\n    Test_TestPrint2 = True\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2521, "user_id": 3250992, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/625932982113d9c5a46e88f442501cf3?s=128&d=identicon&r=PG&f=1", "display_name": "noobmaster69", "link": "https://stackoverflow.com/users/3250992/noobmaster69"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 637, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510798665, "creation_date": 1510740920, "last_edit_date": 1531164843, "question_id": 47304694, "link": "https://stackoverflow.com/questions/47304694/vba-join-array-elements-to-then-pass-as-multiple-parameters-to-function", "title": "VBA join array elements to then pass as multiple parameters to function", "body": "<p><strong>[Update: The question has been formed so that the functions can be copied directly into a VBA module and tested by running the <code>test_callback_loop_function_works_with_multiple_parameters</code> method]</strong></p>\n\n<p>I am using the <code>Application.Run</code> function to dynamically call methods within my VBA. The idea is that this helper will save me looping through dictionaries throughout various functions/subs within my VBA. Instead I can just call the following helper which will do the looping for me:</p>\n\n<pre><code>Public Function user_func_dictionary_loop(Dictionary As Dictionary, _\n                 MethodCallback As String, _\n                 Optional Params As Variant) As Boolean\n\n    Dim Key As Variant\n\n    For Each Key In Dictionary\n\n        If IsMissing(Params) Then\n            Application.Run MethodCallback, Dictionary(Key)\n        Else\n            Application.Run MethodCallback, user_param_replace(Dictionary(Key), Params)\n        End If\n\n    Next Key\n\nEnd Function\n</code></pre>\n\n<p>If no Parameters are supplied to the function then it simply runs the <code>MethodCallback</code> with the Dictionary's key value. If there are parameters then an additional step is triggered below:</p>\n\n<pre><code>Private Function user_param_replace(Item As Variant, Optional Params As Variant) As Variant\n\n    Dim i As Long\n    Dim strTest As String\n    Dim Output As Variant\n\n    Output = replace_dictionary_values(Item, Params)\n\n    If IsArray(Output) Then\n        ReDim Preserve Output(0 To UBound(Output))\n\n        user_param_replace = Join(Output, \",\")\n        Exit Function\n\n    End If\n\n    user_param_replace = Output\n\nEnd Function\n\nPrivate Function replace_dictionary_values(Item As Variant, Optional Params As Variant) As Variant\n\n    Dim l As Long\n    Dim varTemp() As Variant\n    Dim Param_Item As Variant\n\n    l = 0\n    If IsMissing(Params) Or Not IsArray(Params) Then\n        replace_dictionary_values = Replace$(Params, \"{D:Value}\", Item)\n        Exit Function\n    Else\n\n        ReDim varTemp(0 To UBound(Params))\n\n        For Each Param_Item In Params\n            varTemp(l) = Replace$(Param_Item, \"{D:Value}\", Item)\n            l = l + 1\n        Next Param_Item\n\n    End If\n\n    replace_dictionary_values = varTemp\n\nEnd Function\n</code></pre>\n\n<p>The steps above allow a user to pass in parameters which contain <code>{D:Value}</code> which will then be replaced with the Dictionary's key value.</p>\n\n<p>I've made a small unit test below with the idea that it should test the functionality of my method. At present I'm getting an \"Argument not optional\" error:</p>\n\n<pre><code>Function test_callback_loop_function_works_with_multiple_parameters() As Boolean\n\n    Dim dictTest As New Dictionary\n\n    dictTest.Add 1, \"1 - Foo\"\n    dictTest.Add 2, \"2 - Foo\"\n    dictTest.Add 3, \"3 - Foo\"\n\n    Dim MyArray(0 To 1) As Variant\n\n    MyArray(0) = \"{D:Value}\"\n    MyArray(1) = \"Bar\"\n\n    user_func_dictionary_loop dictTest, \"custom_debug_print_multiple_params\", MyArray\n\n    test_callback_loop_function_works_with_multiple_parameters = True\n\nEnd Function\n\nFunction custom_debug_print_multiple_params(strPrint As String, strPrint2 As String) As String\n\n    Debug.Print strPrint &amp; strPrint2\n\nEnd Function\n</code></pre>\n\n<p>The output should be:</p>\n\n<pre><code>1 - FooBar\n2 - FooBar\n3 - FooBar\n</code></pre>\n\n<p>But I'm getting an </p>\n\n<blockquote>\n  <p>Run-time error '449' - Argument not optional</p>\n</blockquote>\n\n<p>error on the <code>Application.Run MethodCallback, user_param_replace(Dictionary(Key), Params)</code> line.</p>\n\n<p>My hunch is that because I'm trying to join array elements together with a \",\" to then pass through as parameters (in the <code>Join(Output, \",\")</code> line) to the method, it's causing the test to fail.</p>\n\n<p>So my question is, within VBA, is it possible to join the elements of an array together so they can then be passed, dynamically, to another method/function?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1510748388, "post_id": 47306097, "comment_id": 81564649, "body": "it&#39;s not filtering yet, output all pages in the report."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1510749329, "post_id": 47306097, "comment_id": 81565325, "body": "Have you adapted the <code>Record source</code> of your report &quot;Invoice&quot;? If yes, please add it to your question."}, {"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1510753156, "post_id": 47306097, "comment_id": 81568083, "body": "Yes I added <code>Record source</code>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1510758375, "post_id": 47306097, "comment_id": 81572023, "body": "And have you also removed <code>DoCmd.OpenReport &quot;Invoice&quot;, acPreview, , , acHidden</code> ? What happens if you open the report manually (after calling <code>CurTenantID(&lt;an existing ID&gt;)</code> ) ? @MirAbzalAli"}, {"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1510759244, "post_id": 47306097, "comment_id": 81572711, "body": "Oh! I&#39;m sorry I forgot to remove that, It fantastic treatment and perfect. Thank you so much."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1510744915, "creation_date": 1510744915, "answer_id": 47306097, "question_id": 47304589, "link": "https://stackoverflow.com/questions/47304589/looping-through-a-recordset-to-output-ms-access-report-to-a-pdf-file/47306097#47306097", "title": "Looping through a recordset to output Ms-Access report to a pdf file", "body": "<p>Since <code>DoCmd.OutputTo</code> lacks parameters for filtering, the best option is to base the report on a public function to get the current ID.</p>\n\n<p>E.g.</p>\n\n<pre><code>' Function to both set and retrieve the current Tenant ID\nPublic Function CurTenantID(Optional SetTenantID As Long = 0) As Long\n\n    Static TenantID As Long\n\n    If SetTenantID &gt; 0 Then\n        TenantID = SetTenantID\n    End If\n\n    CurTenantID = TenantID\n\nEnd Function\n</code></pre>\n\n<p>Your report uses this function in its record source, e.g.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT * FROM tblInvoice WHERE tenant_id = CurTenantID()\n</code></pre>\n\n<p>And when generating the PDF reports in the loop, you use the <code>SetTenantID</code> parameter:</p>\n\n<pre><code>Public Sub Output()\n\n    Dim MyRs As DAO.Recordset\n    Dim fileName As String, pathName As String, todayDate As String\n\n    pathName = \"C:\\Users\\abzalali\\Dropbox\\tenant_db\\Invoice\\\"\n    todayDate = Format(Date, \"MMDDYYYY\")\n    Set MyRs = CurrentDb.OpenRecordset(\"SELECT tenant_id, name, company, email FROM qryEmailClientList\")\n\n    With MyRs\n        ' .MoveFirst -- unneeded after OpenRecordset()\n        Do While Not .EOF\n            fileName = \"Invoice_\" &amp; todayDate &amp; !tenant_id &amp; \".pdf\"\n            Call CurTenantID(!tenant_id)\n            DoCmd.OutputTo acOutputReport, \"Invoice\", acFormatPDF, pathName &amp; fileName\n            .MoveNext\n        Loop\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1510759376, "post_id": 47310539, "comment_id": 81572814, "body": "With this way it also works but report view showing during execution, I wanted to hide report view."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "edited": false, "score": 0, "creation_date": 1510759608, "post_id": 47310539, "comment_id": 81572995, "body": "Go ahead and add <i>acHidden</i> for its <i>WindowMode</i> argument."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1510759606, "last_edit_date": 1510759606, "creation_date": 1510757694, "answer_id": 47310539, "question_id": 47304589, "link": "https://stackoverflow.com/questions/47304589/looping-through-a-recordset-to-output-ms-access-report-to-a-pdf-file/47310539#47310539", "title": "Looping through a recordset to output Ms-Access report to a pdf file", "body": "<p>Simply use the <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-openreport-method-access\" rel=\"nofollow noreferrer\">DoCmd.OpenReport</a> method to filter report and then leave the report name blank in <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-outputto-method-access\" rel=\"nofollow noreferrer\">DoCmd.OutputTo</a> as per the docs:</p>\n\n<blockquote>\n  <p>ObjectName > Optional > Variant: If you want to output the active object, specify the object's type for the ObjectType argument and leave this argument blank.</p>\n</blockquote>\n\n<pre><code>With MyRs\n    .MoveFirst\n    Do While Not .EOF\n        fileName = \"Invoice_\" &amp; todayDate &amp; !tenant_id &amp; \".pdf\"\n\n        DoCmd.OpenReport \"Invoice\", acViewReport, , \"[tenant_id] = \" &amp; !tenant_id, acHidden\n        DoCmd.OutputTo acOutputReport, , acFormatPDF, pathName &amp; fileName\n        .MoveNext\n    Loop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 4995877, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/10206888447510875/picture?type=large", "display_name": "Mir Abzal Ali", "link": "https://stackoverflow.com/users/4995877/mir-abzal-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 47306097, "answer_count": 2, "score": 4, "last_activity_date": 1510759606, "creation_date": 1510740686, "last_edit_date": 1510753292, "question_id": 47304589, "link": "https://stackoverflow.com/questions/47304589/looping-through-a-recordset-to-output-ms-access-report-to-a-pdf-file", "title": "Looping through a recordset to output Ms-Access report to a pdf file", "body": "<p>I'm trying to get pdf file by <code>tenant_id</code> using <code>docmd.outputTo</code>. Unfortunately this routine produce output pdf file that all are in a same single <code>tenant_id</code>. If I remove <code>docmd.outputTo</code> last parameter <code>pathName &amp; fileName</code> then it's require file name through dialogue and output file nicely filtered by <code>tenant_id</code>. Any help would be appreciated. </p>\n\n<p>Here's the query of invoice: <code>SELECT * FROM tblInvoice WHERE tenant_id = CurTenantID()</code></p>\n\n<pre><code>Public Sub Output()\n    Dim MyRs As DAO.Recordset\n    Dim rpt As Report\n    Dim fileName As String, pathName As String, todayDate As String\n\n    pathName = \"C:\\Users\\abzalali\\Dropbox\\tenant_db\\Invoice\\\"\n    todayDate = Format(Date, \"MMDDYYYY\")\n    Set MyRs = CurrentDb.OpenRecordset(\"SELECT tenant_id, name, company, email FROM qryEmailClientList\")\n\n    DoCmd.OpenReport \"Invoice\", acPreview, , , acHidden\n    Set rpt = Reports(\"Invoice\")\n\n    With MyRs\n        .MoveFirst\n            Do While Not .EOF\n                fileName = \"Invoice_\" &amp; todayDate &amp; !tenant_id &amp; \".pdf\"\n                rpt.Filter = \"[tenant_id] = \" &amp; !tenant_id\n                rpt.FilterOn = True\n                DoCmd.OutputTo acOutputReport, \"Invoice\", acFormatPDF, pathName &amp; fileName\n               .MoveNext\n            Loop\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba"], "owner": {"reputation": 501, "user_id": 1686625, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538d19c6f49214b42d2cb9da7f06b96e?s=128&d=identicon&r=PG", "display_name": "dazzathedrummer", "link": "https://stackoverflow.com/users/1686625/dazzathedrummer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1510740623, "creation_date": 1510740623, "question_id": 47304567, "link": "https://stackoverflow.com/questions/47304567/excel-sql-query-parameter-behaviour", "title": "Excel SQL query parameter behaviour", "body": "<p>I've created a spreadsheet that simply allows the user to enter a parameter in a cell and a list is shown as a table based on a SQL query with a the parameter.</p>\n\n<p>I have a stored procedure that does a basic select query and has a variable that is set in the where clause like this (I want to be able to do wildcard lookups)...</p>\n\n<pre><code>where @FileID like Data_fileID\n</code></pre>\n\n<p>I then pass the parameter to the variable by setting the SQL Command text on a button click in VBA...</p>\n\n<pre><code>Private Sub UpdateButton_Click()\n    With ActiveWorkbook.Connections(\"FileID_LU\").OLEDBConnection\n    .CommandText = \"EXEC SP_DB_FileLU '\" &amp; Range(\"FileID\").Value &amp; \"'\"\nEnd With\nSheet1.Range(\"UpdateMsg\").Value = \"Getting data...\"\nActiveWorkbook.Connections(\"FileID_LU\").Refresh\nSheet1.Range(\"UpdateMsg\").Value = \"Here you go...\"\nEnd Sub\n</code></pre>\n\n<p>So the user enters a file ID into a cell that I've named <code>FileID</code>, hits the update button, the connection properties command text box is updated with a new query and then the connection is refreshed.</p>\n\n<p>This seems to work fine with individual file IDs that are definitely in the database, but if I enter <code>5%</code> and hit the update button, I get a list of everything beginning with <code>5</code>, but the query doesn't update after any subsequent updates with different parameters.</p>\n\n<p>If I go to the connection properties, the last query (after the <code>5%</code>)is displayed in the text box, but it hasn't refreshed - if I click refresh the table by right clicking and selecting refresh, I get the results of the last query, but not with the button click.\nMy message cell reads 'Here you go...' but the data connection hasn't refreshed.</p>\n\n<p>Why wont it refresh after a wildcard lookup?  </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1510740452, "post_id": 47304432, "comment_id": 81559520, "body": "What do you mean with <i>see the item of form in my windows&#39;s taskbar.</i>?"}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510740518, "post_id": 47304432, "comment_id": 81559556, "body": "I am having a bit of trouble to understand what you are trying to achieve. <b>1. You want to hide the Windows Access Application from the windows task bar. 2. You want to bring the Access Application back by pressing your Windows Application Form?</b>"}, {"owner": {"reputation": 27, "user_id": 2995043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1d1aef5bae9a89125ee1c147a83b5?s=128&d=identicon&r=PG&f=1", "display_name": "M.iaou", "link": "https://stackoverflow.com/users/2995043/m-iaou"}, "edited": false, "score": 0, "creation_date": 1510742915, "post_id": 47304432, "comment_id": 81561113, "body": "No, i already hide the Windows Access Application but i would like to have item for my form (who is modal and pop-up to yes) in my windows task bar, because when the Windows Access Application is hide we see nothing in windows task bar. Am I clear? :)"}, {"owner": {"reputation": 27, "user_id": 2995043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1d1aef5bae9a89125ee1c147a83b5?s=128&d=identicon&r=PG&f=1", "display_name": "M.iaou", "link": "https://stackoverflow.com/users/2995043/m-iaou"}, "edited": false, "score": 0, "creation_date": 1510743000, "post_id": 47304432, "comment_id": 81561165, "body": "I find the code on <a href=\"https://stackoverflow.com/questions/26594043/access-application-hidden-application-window-with-form-taskbar-icon\" title=\"access application hidden application window with form taskbar icon\">stackoverflow.com/questions/26594043/&hellip;</a>    it is what i want but it&#39;s doesn&#39;t work or i don&#39;t know how to make it work (more probably)"}, {"owner": {"reputation": 27, "user_id": 2995043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1d1aef5bae9a89125ee1c147a83b5?s=128&d=identicon&r=PG&f=1", "display_name": "M.iaou", "link": "https://stackoverflow.com/users/2995043/m-iaou"}, "edited": false, "score": 0, "creation_date": 1510753497, "post_id": 47304432, "comment_id": 81568327, "body": "Anyone can help me with this?"}, {"owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "edited": false, "score": 0, "creation_date": 1510753695, "post_id": 47304432, "comment_id": 81568468, "body": "What version of Access are you using?"}, {"owner": {"reputation": 27, "user_id": 2995043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1d1aef5bae9a89125ee1c147a83b5?s=128&d=identicon&r=PG&f=1", "display_name": "M.iaou", "link": "https://stackoverflow.com/users/2995043/m-iaou"}, "edited": false, "score": 0, "creation_date": 1510754384, "post_id": 47304432, "comment_id": 81568952, "body": "2010 and 2013 too"}, {"owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "edited": false, "score": 0, "creation_date": 1510754659, "post_id": 47304432, "comment_id": 81569131, "body": "I think you may be out of luck. There was an Access application option in earlier versions to display forms as separate items on the Windows taskbar, but it was removed starting, I think, with the 2010 version."}, {"owner": {"reputation": 27, "user_id": 2995043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1d1aef5bae9a89125ee1c147a83b5?s=128&d=identicon&r=PG&f=1", "display_name": "M.iaou", "link": "https://stackoverflow.com/users/2995043/m-iaou"}, "edited": false, "score": 0, "creation_date": 1510755009, "post_id": 47304432, "comment_id": 81569390, "body": "da**it, the code above apparently works but I can not make it work!"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1511049039, "post_id": 47304432, "comment_id": 81697300, "body": "Where is the procedure that declares and sets frmHwnd?"}], "owner": {"reputation": 27, "user_id": 2995043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e1d1aef5bae9a89125ee1c147a83b5?s=128&d=identicon&r=PG&f=1", "display_name": "M.iaou", "link": "https://stackoverflow.com/users/2995043/m-iaou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510753445, "creation_date": 1510740278, "last_edit_date": 1510753445, "question_id": 47304432, "link": "https://stackoverflow.com/questions/47304432/access-hide-windows-but-form-in-windows-taskbar", "title": "Access Hide Windows, but form in window&#39;s taskbar", "body": "<p>like the title said, i would like to hide access's windows application but see the item of form in my windows's taskbar.</p>\n\n<p>I already find to hide the access windows with this API:</p>\n\n<pre><code>Const SW_HIDE = 0\nConst SW_NORMAL = 1\n\nPrivate Declare PtrSafe Function ShowWindow Lib \"user32\" _\n(ByVal hwnd As Long, ByVal FHCmdShow As Long) As Long\n</code></pre>\n\n<p>And: <code>ShowWindow Application.hWndAccessApp, 0</code>  for hiding the windows.</p>\n\n<p>And i find this for the item in taskbar:</p>\n\n<pre><code>Public Declare Function GetWindowLong Lib \"user32\" _\nAlias \"GetWindowLongA\" _\n(ByVal hWnd As Long, _\n ByVal nIndex As Long) As Long\n\nPublic Declare Function SetWindowLong Lib \"user32\" _\nAlias \"SetWindowLongA\" _\n(ByVal hWnd As Long, _\n ByVal nIndex As Long, _\n ByVal dwNewLong As Long) As Long\n\nPublic Declare Function SetWindowPos Lib \"user32\" _\n(ByVal hWnd As Long, _\n ByVal hWndInsertAfter As Long, _\n ByVal X As Long, _\n ByVal Y As Long, _\n ByVal cx As Long, _\n ByVal cy As Long, _\n ByVal wFlags As Long) As Long\n\nPublic Sub AppTasklist(frmHwnd)\nDim WStyle  As Long\nDim Result  As Long\n\nWStyle = GetWindowLong(frmHwnd, GWL_EXSTYLE)\n\nWStyle = WStyle Or WS_EX_APPWINDOW\n\nResult = SetWindowPos(frmHwnd, HWND_TOP, 0, 0, 0, 0, _\n                      SWP_NOMOVE Or _\n                      SWP_NOSIZE Or _\n                      SWP_NOACTIVATE Or _\n                      SWP_HIDEWINDOW)\n\nResult = SetWindowLong(frmHwnd, GWL_EXSTYLE, WStyle)\nDebug.Print Result\n\nResult = SetWindowPos(frmHwnd, HWND_TOP, 0, 0, 0, 0, _\n                      SWP_NOMOVE Or _\n                      SWP_NOSIZE Or _\n                      SWP_NOACTIVATE Or _\n                      SWP_SHOWWINDOW)\n\n\nEnd Sub\n</code></pre>\n\n<p>But i don't know how to make this work, i've tried fews things but nothing work.\nAnyone have already use it or can help me?</p>\n"}, {"tags": ["string", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1510743102, "creation_date": 1510743102, "answer_id": 47305482, "question_id": 47304272, "link": "https://stackoverflow.com/questions/47304272/vba-code-for-how-to-group-together-numbers-which-are-the-31st-character-in-a-str/47305482#47305482", "title": "Vba code for how to group together numbers which are the 31st character in a string with a row break between consecutive numbers", "body": "<pre><code> Function ChopOutChar(s as string)\n\n Dim thirtyfirst as string\n thirtyFirst = mid(s,31,1)\n thirtyfirst = thirtyfirst &amp;  vbcrlf ' \"Carriage Return/LineFeed\"\n ChopOUtChar = thirtyfirst\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8938557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a680dba552c285e931bd1ce480d9219d?s=128&d=identicon&r=PG&f=1", "display_name": "J. Thomas", "link": "https://stackoverflow.com/users/8938557/j-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510743102, "creation_date": 1510739813, "last_edit_date": 1531161705, "question_id": 47304272, "link": "https://stackoverflow.com/questions/47304272/vba-code-for-how-to-group-together-numbers-which-are-the-31st-character-in-a-str", "title": "Vba code for how to group together numbers which are the 31st character in a string with a row break between consecutive numbers", "body": "<p>I'm trying to edit my code so that it groups all of the same numbers in a string together and adds a row break between it and the consecutive number so that it is easier to read. </p>\n\n<p>The number I want is always the 31st character in a string and I want the data to display so that this 31st character is grouped together. Any help would be appreciated, my current code is: </p>\n\n<pre><code>Sub CopyMatchedValuesToSheet()\n\nDim ws1 As Worksheet, ws2 As Worksheet\nDim LastRowSource As Long, i As Long\nDim SearchString As String\nDim cell As Range\n\nSet ws1 = Worksheets(\"effect00001\")\nSet ws2 = Worksheets(\"Sheet2\")\n\nSearchString = \"(9)\" ' Set SearchString value or use the one below if you want to change it each time\n\n'SearchString = Application.InputBox(\"Give a string\", \"SearchString\", Type:=2)\n\ni = 1\n\nWith ws1\n    LastRowSource = .Cells.find(\"(9)\", [A1], , , xlByRows, xlPrevious).Row\n\n    For Each cell In .Range(\"A1:A\" &amp; LastRowSource) ' Change to A2 if it has header\n        If InStr(cell.Value, SearchString) &gt; 0 Then\n            ws2.Cells(i + 1, 1).Value = cell.Value\n            i = i + 1\n        End If\n    Next cell\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "ms-office", "excel-2007"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510741916, "post_id": 47304148, "comment_id": 81560464, "body": "Your function doesn&#39;t return anything - that is probably an issue. Btw your code could be appreciably shortened if you used arrays and a loop."}, {"owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1510742102, "post_id": 47304148, "comment_id": 81560593, "body": "The function is not supposed to return anything, it just insert rows with values given in the parameters. Yeah, I will shorten code once I have a finishid working script."}], "answers": [{"tags": [], "owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1510742984, "creation_date": 1510742984, "answer_id": 47305448, "question_id": 47304148, "link": "https://stackoverflow.com/questions/47304148/vba-excel-array-writing-all-values-as-0-in-cells/47305448#47305448", "title": "VBA Excel array writing all values as 0 in cells", "body": "<p>Fixed it. I wanted to write an array to a range. The below is what worked:</p>\n\n<pre><code>Function InsertRow(lastRow As Long, List() As String)\n\n    Dim newRow As Range\n    Dim rowArray As Variant\n    Dim i As Long\n\n    Dim wsData As Worksheet\n    Set wsData = Sheets(\"Data\")\n\n    rowArray = List()\n\n    lastRow = lastRow + 1\n\n\n    wsData.Range(\"A\" &amp; lastRow &amp; \":AI\" &amp; lastRow) = rowArray\n\n    Debug.Print \"New Row: \", lastRow\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1751, "user_id": 880549, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cb290ff867d63b8b6336d642446c27d6?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/880549/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 832, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510742984, "creation_date": 1510739437, "question_id": 47304148, "link": "https://stackoverflow.com/questions/47304148/vba-excel-array-writing-all-values-as-0-in-cells", "title": "VBA Excel array writing all values as 0 in cells", "body": "<p>I have the below code:</p>\n\n<pre><code>Private Sub UpdateButton_Click()    \n\n    Dim uniqueID As Integer\n    uniqueID = 0\n\n    Dim notInOrder As Boolean\n    notInOrder = False\n\n    Dim inOrder As Boolean\n    inOrder = False\n\n    Dim employeeNumber As String\n\n    Dim week As Integer\n\n    Dim tdate As Date\n    tdate = Now\n\n    Dim qtyWelds As Integer\n    qtyWelds = 26\n\n\n    Dim totalOfWeldsInOrder As Integer\n    totalOfWeldsInOrder = 0\n\n\n    Dim qtyGridsInspected As Integer\n    qtyGridsInspected = 1\n\n    Dim s1 As Integer\n    Dim s2 As Integer\n    Dim s3 As Integer\n    Dim s4 As Integer\n    Dim s5 As Integer\n    Dim s6 As Integer\n    Dim s7 As Integer\n    Dim s8 As Integer\n    Dim s9 As Integer\n    Dim s10 As Integer\n    Dim s11 As Integer\n    Dim s12 As Integer\n    Dim s13 As Integer\n    Dim s14 As Integer\n    Dim s15 As Integer\n    Dim s16 As Integer\n    Dim s17 As Integer\n    Dim s18 As Integer\n    Dim s19 As Integer\n    Dim s20 As Integer\n    Dim s21 As Integer\n    Dim s22 As Integer\n    Dim s23 As Integer\n    Dim s24 As Integer\n    Dim s25 As Integer\n    Dim s26 As Integer\n\n    If ThisWorkbook.Worksheets(2).Shapes(\"cBox1\").OLEFormat.Object.Value = 0 Then\n        totalOfWeldsInOrder = totalOfWeldsInOrder + 1\n        s1 = 0\n        notInOrder = True\n    End If\n\n        .....\n\n\n    If ThisWorkbook.Worksheets(2).Shapes(\"cBox26\").OLEFormat.Object.Value = 0 Then\n        totalOfWeldsInOrder = totalOfWeldsInOrder + 1\n        s26 = 0\n        notInOrder = True\n    End If\n\n    Dim sInOrder As Integer\n\n    If inOrder = True Then\n        sInOrder = 1\n    Else\n        sInOder = 0\n    End If\n\n\n    Dim snotInOrder As Integer\n\n    If notInOrder = True Then\n        snotInOrder = 1\n    Else\n        snotInOrder = 0\n    End If\n\n    Dim rowArray(1 To 35) As String\n\n\n    uniqueID = GetLastRow() - 1\n\n\n    rowArray(1) = uniqueID\n\n        .....\n\n    rowArray(35) = s26\n\n\n    Dim lastRow As Long\n\n    lastRow = GetLastRow()\n\n    Debug.Print \"Last Row: \", lastRow\n\n    InsertRow lastRow, rowArray\n\n\nEnd Sub\nPublic Function GetLastRow() As Long\n\n    Dim wbshtSelect         As Worksheet\n    Dim LR_wbSelectNew      As Long\n\n    Set wbshtSelect = Sheets(\"Data\")\n\n    ' find last row with data in Column AI9 at current regioun starting at cell AI9\n    With wbshtSelect.Range(\"AI9\").CurrentRegion\n        LR_wbSelectNew = .Rows(.Rows.Count).Row\n    End With\n\n    Dim rng         As Range\n    Set rng = wbshtSelect.Range(\"AI9:AI\" &amp; LR_wbSelectNew)\n\n    ' find last row inside the range, ignore values inside formulas\n    LR_wbSelectNew = rng.Find(What:=\"*\", _\n                        After:=Range(\"AI9\"), _\n                        LookAt:=xlPart, _\n                        LookIn:=xlValues, _\n                        SearchOrder:=xlByRows, _\n                        SearchDirection:=xlPrevious, _\n                        MatchCase:=False).Row\n\n    GetLastRow = LR_wbSelectNew\n\nEnd Function\n\nFunction InsertRow(lastRow As Long, List() As String)\n\n    Dim newRow As Range\n    Dim rowArray As Variant\n\n    Dim wsData As Worksheet\n    Set wsData = Sheets(\"Data\")\n\n\n    rowArray = List()\n\n    lastRow = lastRow + 1\n\n        For Each c In wsData.Range(\"A\" &amp; lastRow &amp; \":AI\" &amp; lastRow)\n                For Each s In rowArray\n                    c.Value = s\n                Next s\n        Next c\n\n    Debug.Print \"New Row: \", lastRow\n\nEnd Function\n</code></pre>\n\n<p>I have a button and when I click the Button the macro runs the above code. The code will get the last filled row, and insert data from an array (in code) in the next row. The array is getting populated correctly, however when it comes to writing it to cell all values are returned as 0.</p>\n\n<p>I tried converting the values using <code>CStr(variable)</code> with no success (still saved as 0).</p>\n\n<p>The function that writes values to row:</p>\n\n<pre><code>Function InsertRow(lastRow As Long, List() As String)\n\n    Dim newRow As Range\n    Dim rowArray As Variant\n\n    Dim wsData As Worksheet\n    Set wsData = Sheets(\"Data\")\n\n\n    rowArray = List()\n\n    lastRow = lastRow + 1\n\n        For Each c In wsData.Range(\"A\" &amp; lastRow &amp; \":AI\" &amp; lastRow)\n                For Each s In rowArray\n                    c.Value = s\n                Next s\n        Next c\n\n    Debug.Print \"New Row: \", lastRow\n\nEnd Function\n</code></pre>\n\n<p>Any idea what I am doing wrong?</p>\n\n<p><strong><em>NOTE1: I am using Office 2007 (Excel)</em></strong></p>\n\n<p><strong><em>NOTE2: I have removed some of the repetitive code.</em></strong> (denoted as .... in code)</p>\n"}, {"tags": ["string", "vba", "integer", "decimal"], "answers": [{"tags": [], "owner": {"reputation": 178, "user_id": 8161411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce3249d6b867258af6992c7db4c7cef?s=128&d=identicon&r=PG&f=1", "display_name": "donCalculator", "link": "https://stackoverflow.com/users/8161411/doncalculator"}, "is_accepted": true, "score": 2, "last_activity_date": 1510738985, "creation_date": 1510738985, "answer_id": 47303973, "question_id": 47303936, "link": "https://stackoverflow.com/questions/47303936/vba-string-to-integer-without-rounding/47303973#47303973", "title": "VBA String to Integer without rounding", "body": "<p>Integer is a whole number variable. Use double instead.</p>\n"}, {"comments": [{"owner": {"reputation": 198, "user_id": 8857606, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bbe2434d3a44dc131ce7ed3f791ad25?s=128&d=identicon&r=PG&f=1", "display_name": "rosi97", "link": "https://stackoverflow.com/users/8857606/rosi97"}, "edited": false, "score": 0, "creation_date": 1510739901, "post_id": 47304120, "comment_id": 81559171, "body": "The inputs are with &quot;dot&quot;.  System is set up on english but thanks for the idea!"}, {"owner": {"reputation": 198, "user_id": 8857606, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bbe2434d3a44dc131ce7ed3f791ad25?s=128&d=identicon&r=PG&f=1", "display_name": "rosi97", "link": "https://stackoverflow.com/users/8857606/rosi97"}, "edited": false, "score": 0, "creation_date": 1510740158, "post_id": 47304120, "comment_id": 81559350, "body": "I get &quot;0.085&quot; and &quot;85&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 198, "user_id": 8857606, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bbe2434d3a44dc131ce7ed3f791ad25?s=128&d=identicon&r=PG&f=1", "display_name": "rosi97", "link": "https://stackoverflow.com/users/8857606/rosi97"}, "edited": false, "score": 0, "creation_date": 1510740262, "post_id": 47304120, "comment_id": 81559423, "body": "@rosi97 - if you ask an American person what do you think he/she would get?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 198, "user_id": 8857606, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bbe2434d3a44dc131ce7ed3f791ad25?s=128&d=identicon&r=PG&f=1", "display_name": "rosi97", "link": "https://stackoverflow.com/users/8857606/rosi97"}, "edited": false, "score": 0, "creation_date": 1510741291, "post_id": 47304120, "comment_id": 81560058, "body": "@rosi97 - Your system is not on English setup, if you are getting two different values from the code aboive. The VBEditor is on English setup, but your Windows uses comma with a decimal separator. This may be a problem, if you are reading from external file or if you are writing VBA formulas in Excel."}, {"owner": {"reputation": 198, "user_id": 8857606, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bbe2434d3a44dc131ce7ed3f791ad25?s=128&d=identicon&r=PG&f=1", "display_name": "rosi97", "link": "https://stackoverflow.com/users/8857606/rosi97"}, "edited": false, "score": 0, "creation_date": 1510741876, "post_id": 47304120, "comment_id": 81560438, "body": "Okay, then I don&#39;t know where this is coming from. Keyboard Input language is &quot;English (United States)&quot;. Anyways the code works fine for me now. Thanks for the info."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1510739376, "creation_date": 1510739376, "answer_id": 47304120, "question_id": 47303936, "link": "https://stackoverflow.com/questions/47303936/vba-string-to-integer-without-rounding/47304120#47304120", "title": "VBA String to Integer without rounding", "body": "<p>\"<em>I want to convert a String into Integer and keep the decimal places.</em>\" - not possible, Integer is \"Ganz Zahl\". </p>\n\n<p>However, I think that this is not your problem. I notice that you are from Germany, thus you are obviously experiencing a problem with the comma separator, which is a comma in Germany. In USA and the VBEditor it is a dot. Thus, you have to convert a bit your input to what is expected. <code>Replace()</code> is the way to do it.</p>\n\n<p>See for yourself:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim inputA          As String\n    Dim convertedNumber As Double\n\n    inputA = \"0.085\"\n    convertedNumber = CDbl(inputA)\n    Debug.Print convertedNumber\n\n    inputA = Replace(inputA, \".\", \",\")\n    convertedNumber = CDbl(inputA)\n    Debug.Print convertedNumber\n\nEnd Sub\n</code></pre>\n\n<p>The first time you print you would get <code>85</code> and the second time, you would get <code>0,085</code>, as expected.</p>\n"}], "owner": {"reputation": 198, "user_id": 8857606, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6bbe2434d3a44dc131ce7ed3f791ad25?s=128&d=identicon&r=PG&f=1", "display_name": "rosi97", "link": "https://stackoverflow.com/users/8857606/rosi97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 0, "accepted_answer_id": 47303973, "answer_count": 2, "score": 0, "last_activity_date": 1510739376, "creation_date": 1510738862, "question_id": 47303936, "link": "https://stackoverflow.com/questions/47303936/vba-string-to-integer-without-rounding", "title": "VBA String to Integer without rounding", "body": "<p>I want to convert a <code>String</code> into <code>Integer</code> and keep the decimal places.<br>\nI tried multiple things like <code>Foramat</code> and <code>CInt</code> but all of them end up rounding my value.</p>\n\n<p>My Code is:</p>\n\n<pre><code>Dim posZ As Integer\nDim TestZ As Integer\nDim strTestZ As String\nDim TestZold As Integer\n\nFor i = 1 To tllength\n  posZ = InStr(tlmold(i), \"Z=\")\n  strTestZ = Mid(tlmold(i), posZ + 2, 5)\n\n  TestZ = Format(strTestZ, \"0.0000\")\n\n   If TestZold = TestZ Or (TestZold - TestZ) &gt; 0.02 Or (TestZ - TestZold) &gt; 0.02 Then\n   countLip = countLip + 1\n   End If\n TestZold = TestZ\nNext I\n</code></pre>\n\n<p>e.g. the first value of <code>strTestZ</code> in the array <code>tlmold()</code> would be <strong>0.085</strong>, 2nd would be <strong>0.097</strong>.<br>\nAnd I want to compare them..</p>\n\n<p>Thanks in Advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1510739010, "post_id": 47303552, "comment_id": 81558619, "body": "How big are the pictures (in MB or resolution)?  Are you able to post a link to a sample picture? (It doesn&#39;t need to be of the actual site if that&#39;s an issue)  Is that the entire code? (or are you by chance opening/closing/manipulating Excel or any other applications programmatically?)"}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1510739217, "post_id": 47303552, "comment_id": 81558727, "body": "I added an example image I do not think they are large as my entire workbook with the 322 images is only 20mb large. and the images are 400 x 400"}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1510739323, "post_id": 47303552, "comment_id": 81558800, "body": "I am also not manipulating any programs. The excel sheet is opened fresh and is only using 70mb of ram before this code is run."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1510741019, "post_id": 47303552, "comment_id": 81559902, "body": "<code>PictureEffects.Insert</code> is basically adding layers on top of each image (as opposed to modifying the image) in such a way that each change is stored as a separate picture, that can later be &quot;undone&quot;.  I assume your goal is to modify the image permanently?  Will these images be changing regularly or is this a one-off?"}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1510741271, "post_id": 47303552, "comment_id": 81560047, "body": "They don&#39;t change that often but I just figured out that I change the road map in the google api call for a night map that will work so that should reduce the modifications significantly"}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1510741778, "post_id": 47303552, "comment_id": 81560366, "body": "But once they are changed I shouldn&#39;t need to change them again unless we are redownloading the images"}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "edited": false, "score": 0, "creation_date": 1510746264, "post_id": 47305431, "comment_id": 81563283, "body": "I was able to adjust the static map api call with some from the google map designer which worked well but I could not get the ShapeRange.PictureFormat Property to change the picture"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "edited": false, "score": 1, "creation_date": 1510747077, "post_id": 47305431, "comment_id": 81563813, "body": "I added to my Answer above."}, {"owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "edited": false, "score": 1, "creation_date": 1510752366, "post_id": 47305431, "comment_id": 81567508, "body": "I ended up using the picture.format as the night map did not have building outlines :/ Picture.Format barely increases the memory usage from baseline so that is the correct method :)"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 2, "last_activity_date": 1511947995, "last_edit_date": 1511947995, "creation_date": 1510742950, "answer_id": 47305431, "question_id": 47303552, "link": "https://stackoverflow.com/questions/47303552/reducing-memory-when-manipulating-images-excel-vba/47305431#47305431", "title": "Reducing memory when manipulating images Excel VBA", "body": "<p>Downloading the images as a Night Map will help, as will saving as JPG instead of PNG.  I think Excel just isn't meant to handle image manipulation on this scale, although saving, closing &amp; re-opening partway through the process will free up some memory.</p>\n\n<p>There are a number of free options (online or downloadable) for batch photo editing in this way, such as <a href=\"http://www.highmotionsoftware.com/products/imbatch\" rel=\"nofollow noreferrer\">ImBatch</a> or <a href=\"https://www.batchphoto.com/espresso/\" rel=\"nofollow noreferrer\">BatchPhoto</a>, which will do the job in no time.</p>\n\n<p>Note that PictureEffects is basically saving a new \"layer\" with each manipulation, sucking up memory along with it. (In my case, about 2000kb per change.)</p>\n\n<p>If you do choose to stick with Excel, use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/shaperange-pictureformat-property-excel\" rel=\"nofollow noreferrer\">ShapeRange.PictureFormat Property</a> instead of the <a href=\"https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/pictureeffects-object-office\" rel=\"nofollow noreferrer\">PictureEffects Object</a>.</p>\n\n<hr>\n\n<p>Also if you're using the API, note that Stack Overflow has a tag <em>just</em> for you!  <a href=\"/questions/tagged/google-static-maps\" class=\"post-tag\" title=\"show questions tagged &#39;google-static-maps&#39;\" rel=\"tag\"><img src=\"https://i.stack.imgur.com/iqXVs.png\" height=\"16\" width=\"18\" alt=\"\" class=\"sponsor-tag-img\">google-static-maps</a>  If you add that tag to your question, you might get further help from people more familiar with that API than I.</p>\n\n<p>Check out this link (note the adjustments than can be handled directly in the URL):</p>\n\n<blockquote>\n  <p><sub><a href=\"http://maps.googleapis.com/maps/api/staticmap?key=AIzaSyADV4Wfi9-4ET5GG52Cw_l0_Bkt8W5vwvM&amp;center=43.597586,-79.746689&amp;zoom=14&amp;markers=icon:http://www.xmeasures.com/images/planMapPin.png|43.597586,-79.746689&amp;format=png32&amp;sensor=false&amp;size=480x480&amp;scale=4&amp;markers=color:black|&amp;maptype=roadmap&amp;style=feature|element:geometry|hue:0xwhite|saturation:-100%|lightness:100|visibility:off&amp;style=feature:road|element:geometry|hue:0xblack|saturation:-100%|lightness:-20|visibility:on&amp;style=feature:road.path|element:labels|hue:0xblack|saturation:-100%|lightness:-20|visibility:off&amp;style=feature:labels|element:geometry|hue:0xblack|saturation:-100%|lightness:-20|visibility:off&amp;style=feature:water|element:geometry|hue:0xblack|saturation:-100%|lightness:-40|visibility:on&amp;style=element:labels.text.stroke|visibility:off&amp;style=element:labels.text.fill|visibility:off&amp;style=feature:road|hue:0xblack|saturation:-100%|lightness:-100|element:labels.text.fill|visibility:on&amp;style=feature:transit|visibility:off&amp;style=feature:poi|visibility:off&amp;style=feature:landscape|visibility:off&amp;key=AIzaSyADV4Wfi9-4ET5GG52Cw_l0_Bkt8W5vwvM|\" rel=\"nofollow noreferrer\">http://maps.googleapis.com/maps/api/staticmap?key=AIzaSyADV4Wfi9-4ET5GG52Cw_l0_Bkt8W5vwvM&amp;center=43.597586,-79.746689&amp;zoom=14&amp;markers=icon:http://www.xmeasures.com/images/planMapPin.png|43.597586,-79.746689&amp;format=png32&amp;sensor=false&amp;size=480x480&amp;scale=4&amp;markers=color:black|&amp;maptype=roadmap&amp;style=feature|element:geometry|hue:0xwhite|saturation:-100%|lightness:100|visibility:off&amp;style=feature:road|element:geometry|hue:0xblack|saturation:-100%|lightness:-20|visibility:on&amp;style=feature:road.path|element:labels|hue:0xblack|saturation:-100%|lightness:-20|visibility:off&amp;style=feature:labels|element:geometry|hue:0xblack|saturation:-100%|lightness:-20|visibility:off&amp;style=feature:water|element:geometry|hue:0xblack|saturation:-100%|lightness:-40|visibility:on&amp;style=element:labels.text.stroke|visibility:off&amp;style=element:labels.text.fill|visibility:off&amp;style=feature:road|hue:0xblack|saturation:-100%|lightness:-100|element:labels.text.fill|visibility:on&amp;style=feature:transit|visibility:off&amp;style=feature:poi|visibility:off&amp;style=feature:landscape|visibility:off&amp;key=AIzaSyADV4Wfi9-4ET5GG52Cw_l0_Bkt8W5vwvM|</a></sub>\n  <strong><em>(<a href=\"https://stackoverflow.com/questions/31434551/static-maps-list-of-features\">Source</a>)</em></strong></p>\n</blockquote>\n\n<hr>\n\n<p>Try something like:</p>\n\n<pre><code>    Dim oWS As Worksheet, sh As Shape\n</code></pre>\n\n<p>\u2026</p>\n\n<pre><code>    Set oWS = ThisWorkbook.Sheets(I)\n    Set sh = oWS.Shapes(\"GoogleMap1\")\n    With sh\n        .PictureFormat.Brightness = -0.35\n        .PictureFormat.Contrast = 0.75\n\n        With sh.Fill.PictureEffects\n            .Delete (1)\n            .Insert(msoEffectSaturation).EffectParameters(1).Value = 0\n        End With\n    End With\n    Set sh = Nothing\n    Set oWS = Nothing\n</code></pre>\n\n<p>\u2026</p>\n\n<p>I didn't test this but there are examples <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/shaperange-pictureformat-property-excel\" rel=\"nofollow noreferrer\">here</a> and <a href=\"http://www.vbaexpress.com/forum/showthread.php?45621-set-color-saturation-of-image-with-vba&amp;p=290984&amp;viewfull=1#post290984\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 433, "user_id": 4864284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TZHRK.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/4864284/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 1, "accepted_answer_id": 47305431, "answer_count": 1, "score": 2, "last_activity_date": 1511947995, "creation_date": 1510737763, "last_edit_date": 1531161705, "question_id": 47303552, "link": "https://stackoverflow.com/questions/47303552/reducing-memory-when-manipulating-images-excel-vba", "title": "Reducing memory when manipulating images Excel VBA", "body": "<p>I have an Excel sheet that downloads satellite imagery for helicopter landing sites and places them in to tabs with the site code. There are 166 to be exact each of those has 2 static map images for a total of 332 images and I need to manipulate them in several ways.</p>\n\n<p>I have no issue downloading them and placing them but when I am manipulating them I run out of memory. The manipulations are to help our pilots see better at night when looking at the maps since they are displayed on a screen.</p>\n\n<p>I typed out the following code and it works until about sheet 100 and then I run out of ram due to being restricted to a 32 bit Excel. is there a way to reduce the amount of memory being used?</p>\n\n<pre><code>Public Sub SwitchtoNight()\n    Dim oWS As Worksheet\n    For i = 5 To ThisWorkbook.Sheets.Count\n        Set oWS = ThisWorkbook.Sheets(i)\n        With oWS\n            .Shapes(\"GoogleMap1\").Fill.PictureEffects.Insert(msoEffectSaturation).EffectParameters(1).Value = 0 'Saturation\n            .Shapes(\"GoogleMap1\").Fill.PictureEffects.Insert(msoEffectBrightnessContrast).EffectParameters(1).Value = -0.35  'Brightness\n            .Shapes(\"GoogleMap1\").Fill.PictureEffects.Insert(msoEffectBrightnessContrast).EffectParameters(2).Value = 0.75  'Contrast\n\n            .Shapes(\"GoogleMap2\").Fill.PictureEffects.Insert(msoEffectSaturation).EffectParameters(1).Value = 0 'Saturation\n            .Shapes(\"GoogleMap2\").Fill.PictureEffects.Insert(msoEffectBrightnessContrast).EffectParameters(2).Value = 0.35  'Contrast\n        End With\n        Set oWS = Nothing\n    Next i\nEnd Sub\n</code></pre>\n\n<p>The images are about 400px X 400px here is an example\n<a href=\"https://i.stack.imgur.com/EXfFt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EXfFt.png\" alt=\"enter image description here\"></a> </p>\n\n<p>With the following code I get to sheet 140 before I run out of ram</p>\n\n<pre><code>Public Sub SwitchtoNight()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n\n    Dim oWS As Worksheet\n    For i = 5 To ThisWorkbook.Sheets.Count\n        Set oWS = ThisWorkbook.Sheets(i)\n        oWS.DisplayPageBreaks = False\n        With oWS\n            .Shapes(\"GoogleMap1\").Fill.PictureEffects.Insert(msoEffectSaturation).EffectParameters(1).Value = 0: .Shapes(\"GoogleMap1\").Fill.PictureEffects.Insert(msoEffectBrightnessContrast).EffectParameters(1).Value = -0.35: .Shapes(\"GoogleMap1\").Fill.PictureEffects.Insert(msoEffectBrightnessContrast).EffectParameters(2).Value = 0.75\n            .Shapes(\"GoogleMap2\").Fill.PictureEffects.Insert(msoEffectSaturation).EffectParameters(1).Value = 0: .Shapes(\"GoogleMap2\").Fill.PictureEffects.Insert(msoEffectBrightnessContrast).EffectParameters(2).Value = 0.35\n        End With\n        Set oWS = Nothing\n    Next I\n\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "adodb"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 0, "last_activity_date": 1510750499, "creation_date": 1510750499, "answer_id": 47307999, "question_id": 47303208, "link": "https://stackoverflow.com/questions/47303208/how-to-insert-data-of-sql-server-database-table-columns-into-excel-using-vba/47307999#47307999", "title": "How to insert data of sql server database table columns into excel using vba", "body": "<p>You have an issue with what is called \"<em>early binding</em>\" vs \"<em>late binding</em>\". There are advantages for both methods.<br>\nIf you want to use \"<em>early binding</em>\", you have to tell the VBA compiler what things like <code>ADODB.Connection</code> are by adding a reference: In the VBA-Editor, choose <code>Tools-&gt;References</code> and set a checkmark on one of the listed Active X DataObject libraries. Probably you are missing this reference, causing the compiler error.</p>\n\n<p>I give an example for both ways that should work for you - read about binding and decide which fits you better.<br>\nNote that the Connection and Command object needs to be created by you (thus the <code>new</code> in the var declaration resp the <code>CreateObject</code>), while the RecordSet object is created by the Execute method.</p>\n\n<p>To get the data from the recordSet into your worksheet, the easiest way is the <code>Range.CopyFromRecordSet</code> method. As an alternative, you can loop over the recordset and do the writing manually - you can find enough examples on the internet.</p>\n\n<pre><code>Sub EarlyBinding()\n    Const DB_CONNECT_STRING = \"Provider=SQLOLEDB.1;Data Source=P3A-B1YH882\\SQLOPER;Initial Catalog=master;Integrated Security=SSPI\"\n\n    Dim myConn As New ADODB.Connection\n    Dim myCommand As New ADODB.Command\n    Dim myRs As ADODB.Recordset\n\n    myConn.Open DB_CONNECT_STRING\n    Set myCommand.ActiveConnection = myConn\n    myCommand.CommandText = \"SELECT * FROM Table_1\"\n    Set myRs = myCommand.Execute\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset myRs \n\n    myConn.Close    \nEnd Sub\n\nSub LateBinding()\n    Const DB_CONNECT_STRING = \"Provider=SQLOLEDB.1;Data Source=P3A-B1YH882\\SQLOPER;Initial Catalog=master;Integrated Security=SSPI\"\n\n    Dim myConn As Object\n    Dim myCommand As Object\n    Dim myRs As Object\n\n    Set myConn = CreateObject(\"ADODB.Connection\")\n    myConn.Open DB_CONNECT_STRING\n    Set myCommand = CreateObject(\"ADODB.Command\")\n    Set myCommand.ActiveConnection = myConn\n\n    myCommand.CommandText = \"SELECT * FROM Table_1\"\n    Set myRs = myCommand.Execute\n\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").CopyFromRecordset myRs \n\n    myConn.Close\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8674336, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e98e54e12ecc096c09664a2785312cfc?s=128&d=identicon&r=PG&f=1", "display_name": "saurabh255", "link": "https://stackoverflow.com/users/8674336/saurabh255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 47307999, "answer_count": 1, "score": 0, "last_activity_date": 1510750499, "creation_date": 1510736648, "last_edit_date": 1510737722, "question_id": 47303208, "link": "https://stackoverflow.com/questions/47303208/how-to-insert-data-of-sql-server-database-table-columns-into-excel-using-vba", "title": "How to insert data of sql server database table columns into excel using vba", "body": "<p>I am trying to insert all data from sql server database table into excel macros by the help of vba coding </p>\n\n<p>here is my code-</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim myConn As ADODB.Connection\n    Dim myCommand As ADODB.Command\n    Dim DB_CONNECT_STRING As String\n    Const DB_CONNECT_STRING = \"Provider=SQLOLEDB.1;Data Source=P3A-B1YH882\\SQLOPER;Initial Catalog=master;Integrated Security=SSPI\"\n    Set myConn = CreateObject(\"ADODB.Connection\")\n    Set myCommand = CreateObject(\"ADODB.Command\")\n    myConn.Open DB_CONNECT_STRING\n    Set myCommand.ActiveConnection = myConn\n    myCommand.CommandText = \"SELECT *FROM Table_1\"\n    myCommand.Execute\n    myConn.Close\n\nEnd Sub\n</code></pre>\n\n<p>my code is not running successfully, it is showing me some compile error user-defined type not defined .</p>\n\n<p>plus i also don't know what to write in code to assign the macros value .\ni am not sure what to do any help is appreciated</p>\n"}, {"tags": ["excel", "vba", "userform", "commandbutton"], "comments": [{"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1510734304, "post_id": 47302040, "comment_id": 81555825, "body": "You want to say that worksheet is hidden, not a workbook, am I right? And what you mean saying &quot;When i press send&quot;, &quot;Send&quot; on outlook menu or some of your buttons?"}, {"owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "edited": false, "score": 0, "creation_date": 1510735321, "post_id": 47302040, "comment_id": 81556425, "body": "Which button sends the email, command button 1,2 or 4? Also what happens if you place <code>Application.Visible = False</code> after the email is sent?"}, {"owner": {"reputation": 23, "user_id": 4261942, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BpbTmpbMOUE/AAAAAAAAAAI/AAAAAAAADkg/B3mOMtppGk4/photo.jpg?sz=128", "display_name": "Muhammad Qahar", "link": "https://stackoverflow.com/users/4261942/muhammad-qahar"}, "edited": false, "score": 0, "creation_date": 1510736359, "post_id": 47302040, "comment_id": 81557020, "body": "Apologies for the confusion. so I have a send button on the userform. When i press that it drafts the email up no problem. however it also makes the entire application visible again. In regards to worksheet, i would like the entire workbook to be hidden as this will be used for my customers but i dont them to have visibility of that. CommandButton3 is the email send"}, {"owner": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1510758441, "post_id": 47302040, "comment_id": 81572068, "body": "Well this could help <a href=\"https://stackoverflow.com/a/20603619/1365754\">stackoverflow.com/a/20603619/1365754</a>"}, {"owner": {"reputation": 23, "user_id": 4261942, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BpbTmpbMOUE/AAAAAAAAAAI/AAAAAAAADkg/B3mOMtppGk4/photo.jpg?sz=128", "display_name": "Muhammad Qahar", "link": "https://stackoverflow.com/users/4261942/muhammad-qahar"}, "edited": false, "score": 0, "creation_date": 1510771070, "post_id": 47302040, "comment_id": 81580555, "body": "What about the second part guys any idea? I have an exact copy of the form on a spreadsheet and ive used a index formula to show list of items based on selection of combobox selection. However i dont know how to translate that to a userform :/"}], "owner": {"reputation": 23, "user_id": 4261942, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BpbTmpbMOUE/AAAAAAAAAAI/AAAAAAAADkg/B3mOMtppGk4/photo.jpg?sz=128", "display_name": "Muhammad Qahar", "link": "https://stackoverflow.com/users/4261942/muhammad-qahar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1008, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510877350, "creation_date": 1510732407, "last_edit_date": 1510739960, "question_id": 47302040, "link": "https://stackoverflow.com/questions/47302040/excel-to-only-show-userform-never-show-workbook", "title": "Excel to only show userform, never show workbook", "body": "<p>I have currently got a workbook which is hidden when it is opened and my userform shows. I have a button which sends emails after storing it on the workbook. When i press send it unhides the workbook. how can i stop this from happening. I also have a combobox which shows a list of items. I am still struggling on how to dynamically show labels and text boxes based on the selection.</p>\n\n<pre><code>Private Sub Workbook_Open()\nApplication.Visible = False\nvoneServiceRequest.Show\nEnd Sub\n\n\nPrivate Sub CommandButton2_Click()\n'Copy Data Into Worksheet'\nWorksheets(\"Order\").Range(\"A1\").Value = TextBox1.Value\nWorksheets(\"Order\").Range(\"A3\").Value = TextBox2.Value\nWorksheets(\"Order\").Range(\"B4\").Value = TextBox3.Value\nWorksheets(\"Order\").Range(\"B5\").Value = SiteList.Text\nWorksheets(\"Order\").Range(\"B6\").Value = TextBox4.Value\nWorksheets(\"Order\").Range(\"B7\").Value = TextBox5.Value\nWorksheets(\"Order\").Range(\"B8\").Value = TextBox6.Value\nWorksheets(\"Order\").Range(\"A10\").Value = TextBox7.Value\nWorksheets(\"Order\").Range(\"B11\").Value = RequestList.Text\nWorksheets(\"Order\").Range(\"A13\").Value = TextBox8.Value\nEnd Sub\n\nSub CommandButton3_Click()\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim Sourcewb As Workbook\n    Dim Destwb As Workbook\n    Dim TempFilePath As String\n    Dim TempFileName As String\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Set Sourcewb = ActiveWorkbook\n\n    'Copy the ActiveSheet to a new workbook\n    ActiveSheet.Copy\n    Set Destwb = ActiveWorkbook\n\n    'Determine the Excel version and file extension/format\n    With Destwb\n        If Val(Application.Version) &lt; 12 Then\n            'You use Excel 97-2003\n            FileExtStr = \".xls\": FileFormatNum = -4143\n        Else\n            'You use Excel 2007-2013\n            Select Case Sourcewb.FileFormat\n            Case 51: FileExtStr = \".xlsx\": FileFormatNum = 51\n            Case 52:\n                If .HasVBProject Then\n                    FileExtStr = \".xlsm\": FileFormatNum = 52\n                Else\n                    FileExtStr = \".xlsx\": FileFormatNum = 51\n                End If\n            Case 56: FileExtStr = \".xls\": FileFormatNum = 56\n            Case Else: FileExtStr = \".xlsb\": FileFormatNum = 50\n            End Select\n        End If\n    End With\n\n    'Save the new workbook/Mail it/Delete it\n    TempFilePath = Environ$(\"temp\") &amp; \"\\\"\n    TempFileName = ActiveSheet.Name &amp; \" \" &amp; Format(Now, \"dd-mmm-yy\")\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    With Destwb\n        .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, FileFormat:=FileFormatNum\n        On Error Resume Next\n        With OutMail\n            .to = \"muhammad.qahar@vodafone.com\"\n            .CC = \"\"\n            .BCC = \"\"\n            .Subject = \"RFS ORDER FORM [Insert Ref Here]\"\n            .BodyFormat = olFormatHTML\n            .Body = \"Hi, Please find attached the order form\"\n\n\n\n\n            .Attachments.Add Destwb.FullName\n\n            .Display   ' .Send or use .Display\n        End With\n        On Error GoTo 0\n        .Close savechanges:=False\n    End With\n\n    'Delete the file you have send\n    Kill TempFilePath &amp; TempFileName &amp; FileExtStr\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = True\n    End With\n\nEnd Sub\n\n\n\nPrivate Sub CommandButton4_Click()\nWorksheets(\"Order\").Range(\"B4:B8\").ClearContents\nWorksheets(\"Order\").Range(\"B11\").ClearContents\nEnd Sub\n\nSub UserForm_Initialize()\n\n'Lock Labels on Worksheet'\n\n\n'Add site list upon opening form'\n\nWith SiteList\n    .AddItem \"Birmingham\"\n    .AddItem \"Bristol\"\n    .AddItem \"Cardiff\"\n    .AddItem \"Chelmsford\"\n    .AddItem \"Edinburgh\"\n    .AddItem \"Fenchurch Street\"\n    .AddItem \"Glasgow\"\n    .AddItem \"Guernsey\"\n    .AddItem \"Halifax\"\n    .AddItem \"Homeworker\"\n    .AddItem \"Horsham\"\n    .AddItem \"Ipswich\"\n    .AddItem \"Jersey\"\n    .AddItem \"Leeds\"\n    .AddItem \"Leicester\"\n    .AddItem \"Lennox Wood\"\n    .AddItem \"Liverpool\"\n    .AddItem \"Manchester\"\n    .AddItem \"Peterborough\"\n    .AddItem \"Redhill\"\n    .AddItem \"Sunderland\"\n    .AddItem \"Madrid\"\nEnd With\n\n'Add list of requests upon opening form'\n\nWith RequestList\n    .AddItem \"Add Phone To VONE C\", 0\n    .AddItem \"Add FMC\", 1\n    .AddItem \"Add Voicemail\", 2\n    .AddItem \"Create New Pickup Group\", 3\n    .AddItem \"Create New Hunt Group\", 4\n    .AddItem \"Dialling Permissions (Class of Service)\", 5\n    .AddItem \"MMR\", 6\n    .AddItem \"Name Change\", 7\n    .AddItem \"New User\", 8\n    .AddItem \"Pick Up Group Changes i.e Add/Remove User\", 9\n    .AddItem \"Hunt Group Changes i.e. Add/Remove User\", 10\n    .AddItem \"Remove Phone From VONE C\", 11\n    .AddItem \"Remove User From VONE C\", 12\n    .AddItem \"Remove FMC Capability\", 13\n    .AddItem \"Remove Voicemail Capability\", 14\nEnd With\n\n'Hide information required'\n\nRequestList.Style = fmStyleDropDownList\nfrAddPhone.Visible = False\n\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nWindows(\"RFS User Form Mock.xlsm\").Visible = True\nEnd Sub\n\nPrivate Sub LegendDefinition_Change()\n'Locks box from being edited by users'\n\nLegendDefinition.Locked = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "edited": false, "score": 0, "creation_date": 1510731177, "post_id": 47301677, "comment_id": 81554177, "body": "You haven&#39;t set TB to be anything before trying to use it"}, {"owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "reply_to_user": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "edited": false, "score": 0, "creation_date": 1510731227, "post_id": 47301677, "comment_id": 81554207, "body": "Have tried this Set TB = Shapes.Range(Array(&quot;TextBox 1&quot;))"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1510737088, "post_id": 47301677, "comment_id": 81557448, "body": "@tj123 what type of text box are you using in your file  ?"}, {"owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "edited": false, "score": 0, "creation_date": 1510737954, "post_id": 47301677, "comment_id": 81557944, "body": "Its the drawing version ..."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1510739854, "post_id": 47301677, "comment_id": 81559147, "body": "ActiveX controls are of type msoOLEControlObject (12), not msoTextBox (17). Are you sure that ` If shp.Type = msoTextBox Then` actually recognises the textbox?"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "edited": false, "score": 0, "creation_date": 1510739960, "post_id": 47304009, "comment_id": 81559213, "body": "This does work in that it shrinks the text massively, but is there anyway to add calibri 18 font as default?"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "edited": false, "score": 0, "creation_date": 1510745582, "post_id": 47304009, "comment_id": 81562847, "body": "@tj123 Try now."}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": true, "score": 0, "last_activity_date": 1510745531, "last_edit_date": 1510745531, "creation_date": 1510739084, "answer_id": 47304009, "question_id": 47301677, "link": "https://stackoverflow.com/questions/47301677/excel-autosize-text-to-fit-shape/47304009#47304009", "title": "Excel autosize text to fit shape", "body": "<p>You are looping through the all the textbox in the sheets but if your textbox is on chartobject you need to handle it in a slightly different.</p>\n\n<pre><code>Sub TextBox()\n\n    Dim w As Worksheet\n    Dim c As ChartObject\n    Dim s As Shape\n\n    For Each w In ActiveWorkbook.Worksheets\n        For Each c In w.ChartObjects\n            For Each s In c.Chart.Shapes\n                If s.Type = msoTextBox Then\n                    With s.TextFrame2\n                        strTxt = .TextRange\n                        .DeleteText\n                        .WarpFormat = msoWarpFormat1\n                        .WordWrap = True\n                        .AutoSize = msoAutoSizeTextToFitShape\n                        .TextRange = strTxt\n                        .TextRange.Font.Name = \"Calibri\"\n                        .TextRange.Font.Size = \"8\"\n                    End With\n                End If\n            Next s\n        Next c\n    Next w\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2354, "favorite_count": 0, "accepted_answer_id": 47304009, "answer_count": 1, "score": 0, "last_activity_date": 1510745531, "creation_date": 1510730922, "last_edit_date": 1510735216, "question_id": 47301677, "link": "https://stackoverflow.com/questions/47301677/excel-autosize-text-to-fit-shape", "title": "Excel autosize text to fit shape", "body": "<p>I want to add some VBA to a multiple chart template to autosize  title text to fit textbox. This now runs, but doesn't make any changes to text box ...</p>\n\n<pre><code>Sub TextBox()\n\nDim ws As Worksheet\nDim shp As Shape\n\n' loop through sheets in this workbook\n For Each ws In ThisWorkbook.Worksheets\n ' loop through Chartobjects in sheet\n   For Each shp In ws.Shapes\n\n    If shp.Type = msoTextBox Then\n        With shp.TextFrame2\n            strTxt = .TextRange\n            .DeleteText\n            .WarpFormat = msoWarpFormat1\n            .WordWrap = True\n            .AutoSize = msoAutoSizeTextToFitShape\n            .TextRange = strTxt\n        End With\n    End If\n   Next shp\n  Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16336, "user_id": 6356278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cb6527e3af8a89177b809385400437b?s=128&d=identicon&r=PG&f=1", "display_name": "Wimpel", "link": "https://stackoverflow.com/users/6356278/wimpel"}, "edited": false, "score": 0, "creation_date": 1510731383, "post_id": 47301621, "comment_id": 81554283, "body": "Please provide the code you have come up with so far."}, {"owner": {"reputation": 11, "user_id": 8943521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a766c21efc6ea75a9bc0b0865d08e592?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag Keswani", "link": "https://stackoverflow.com/users/8943521/chirag-keswani"}, "reply_to_user": {"reputation": 16336, "user_id": 6356278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cb6527e3af8a89177b809385400437b?s=128&d=identicon&r=PG&f=1", "display_name": "Wimpel", "link": "https://stackoverflow.com/users/6356278/wimpel"}, "edited": false, "score": 0, "creation_date": 1510731520, "post_id": 47301621, "comment_id": 81554351, "body": "I tried using the following options:  -ThisWorkbook.Sheets(&quot;Details&quot;).Cells(2, 26).Value = &lt;value&gt;  -Calling a subroutine inside the function  But both these option give #NAME error"}, {"owner": {"reputation": 11, "user_id": 8943521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a766c21efc6ea75a9bc0b0865d08e592?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag Keswani", "link": "https://stackoverflow.com/users/8943521/chirag-keswani"}, "reply_to_user": {"reputation": 16336, "user_id": 6356278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cb6527e3af8a89177b809385400437b?s=128&d=identicon&r=PG&f=1", "display_name": "Wimpel", "link": "https://stackoverflow.com/users/6356278/wimpel"}, "edited": false, "score": 0, "creation_date": 1510731758, "post_id": 47301621, "comment_id": 81554469, "body": "This is my function code: Public Function GetRTD(Exch As String, TrdSymbol As String, Field As String) On Error Resume Next If Exch = &quot;&quot; Then GetRTD = &quot;&quot; Exit Function End If  If TrdSymbol = &quot;&quot; Then GetRTD = &quot;&quot; Exit Function End If  Application.Calculation = xlCalculationAutomatic  Application.ScreenUpdating = False Dim Prfx As String Prfx = TrdSymbol &amp; &quot;.&quot; &amp; Exch  GetRTD = WorksheetFunction.RTD(&quot;Kite.RtdServer&quot;, &quot;&quot;, Prfx, Field) Exit Function  End Function"}, {"owner": {"reputation": 1002, "user_id": 1365754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4ygw.png?s=128&g=1", "display_name": "Hubisan", "link": "https://stackoverflow.com/users/1365754/hubisan"}, "edited": false, "score": 0, "creation_date": 1510760039, "post_id": 47301621, "comment_id": 81573361, "body": "If I really understand your question you are using this function on a worksheet as a formula (UDF) then you need to: 1. Add another parameter to your function to a dummy cell and use it in your formula | 2. Make a subroutine that calls another subroutine at 09:15 with Application.OnTime TimeValue(&quot;09:15:00&quot;), &quot;my_subroutine&quot; ([Application.OnTime ](<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-ontime-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>)) | 3. The called subroutine changes the dummy cell to make your function update (an UDF) as a formula only updates if a value changes"}, {"owner": {"reputation": 11, "user_id": 8943521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a766c21efc6ea75a9bc0b0865d08e592?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag Keswani", "link": "https://stackoverflow.com/users/8943521/chirag-keswani"}, "edited": false, "score": 0, "creation_date": 1511280919, "post_id": 47301621, "comment_id": 81789274, "body": "I tried to call a subroutine in the function. But as the function is called frequently to fetch live ticks. Hence the excel crashes. Is there any other approach? Can we use concept like DictKeys here?"}], "owner": {"reputation": 11, "user_id": 8943521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a766c21efc6ea75a9bc0b0865d08e592?s=128&d=identicon&r=PG&f=1", "display_name": "Chirag Keswani", "link": "https://stackoverflow.com/users/8943521/chirag-keswani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511339600, "creation_date": 1510730722, "last_edit_date": 1511339600, "question_id": 47301621, "link": "https://stackoverflow.com/questions/47301621/fetch-a-particular-value-from-live-updating-cell-values-in-excel", "title": "Fetch a particular value from live updating cell values in excel", "body": "<p>I have API functions in my excel that fetch live stock prices. I want to save the first live price at 9:15 am in a column, but as this value is fetched through a function, I am unable to modify another cell value. I tried calling subroutine inside the function, but it crashes the excel. </p>\n\n<p>How can this be achieved?</p>\n\n<p>I want the value exactly at 9:15 and not the values before or after that.</p>\n\n<p>Can something like DictKeys be used?</p>\n\n<p><strong>My Code</strong></p>\n\n<pre><code>Public Function GetRTD(Exch As String, TrdSymbol As String, Field As String)\n    On Error Resume Next\n    If Exch = \"\" Then\n        GetRTD = \"\"\n        Exit Function\n    End If\n    If TrdSymbol = \"\" Then\n        GetRTD = \"\"\n        Exit Function\n    End If\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = False\n\n    Dim Prfx As String\n    Prfx = TrdSymbol &amp; \".\" &amp; Exch\n\n    GetRTD = WorksheetFunction.RTD(\"Kite.RtdServer\", \"\", Prfx, Field)\n    Exit Function\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 137, "user_id": 8621585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d7a1b9ffe23ed538cbb4d4fd9114e?s=128&d=identicon&r=PG&f=1", "display_name": "rajeev", "link": "https://stackoverflow.com/users/8621585/rajeev"}, "edited": false, "score": 0, "creation_date": 1510732140, "post_id": 47301629, "comment_id": 81554652, "body": "Thanks for catching that @rajeev."}, {"owner": {"reputation": 137, "user_id": 8621585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d7a1b9ffe23ed538cbb4d4fd9114e?s=128&d=identicon&r=PG&f=1", "display_name": "rajeev", "link": "https://stackoverflow.com/users/8621585/rajeev"}, "edited": false, "score": 0, "creation_date": 1510732702, "post_id": 47301629, "comment_id": 81554933, "body": "Thanks @Jeeped for the answer. Learnt something new today!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1510732021, "last_edit_date": 1510732021, "creation_date": 1510730757, "answer_id": 47301629, "question_id": 47301493, "link": "https://stackoverflow.com/questions/47301493/excel-vba-how-to-compare-two-ranges-at-1-to-1-level-in-for-loop/47301629#47301629", "title": "Excel VBA - How to compare two ranges at 1 to 1 level in For Loop?", "body": "<p>Change to a numbered loop.</p>\n\n<pre><code>Public Function compare(r1 As Range, r2 As Range) As long\n    Dim i as long, r as long\n    For r=1 to r1.cells.count\n         if r1.cells(r).Value = r2.cells(r).Value Then\n            i = i + 1\n         End If\n    Next r\n    compare = i    \nEnd Function \n</code></pre>\n\n<p>There may other benefits from variant arrays, resizing r2 to always be the same rows x columns as r1 and restricting r1 and r2 to the .UsedRange.</p>\n\n<pre><code>Public Function compare(r1 As Range, r2 As Range) As long\n    Dim i as long, r as long\n\n    'restrict to .usedrange so full columns can be input\n    set r1 = intersect(r1, r1.parent.usedrange)\n    'make sure r2 is same dimensions as r1\n    set r2 = r2.cells(1).resize(r1.rows.count, r1.columns.count)\n\n    For r=1 to r1.cells.count\n         if r1.cells(r).Value = r2.cells(r).Value Then\n            i = i + 1\n         End If\n    Next r\n    compare = i    \nEnd Function \n</code></pre>\n"}], "owner": {"reputation": 137, "user_id": 8621585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664d7a1b9ffe23ed538cbb4d4fd9114e?s=128&d=identicon&r=PG&f=1", "display_name": "rajeev", "link": "https://stackoverflow.com/users/8621585/rajeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 755, "favorite_count": 0, "accepted_answer_id": 47301629, "answer_count": 1, "score": 2, "last_activity_date": 1510732021, "creation_date": 1510730262, "last_edit_date": 1531161705, "question_id": 47301493, "link": "https://stackoverflow.com/questions/47301493/excel-vba-how-to-compare-two-ranges-at-1-to-1-level-in-for-loop", "title": "Excel VBA - How to compare two ranges at 1 to 1 level in For Loop?", "body": "<p>This question is slightly different from the existing questions on this site listed <a href=\"https://stackoverflow.com/questions/44574598/compare-two-ranges-vba\">here</a>, <a href=\"https://stackoverflow.com/questions/34453313/compare-two-ranges-in-excel-not-to-be-compared-linearly\">here</a> &amp; <a href=\"https://stackoverflow.com/questions/22270693/fastest-way-to-check-if-two-ranges-are-equal-in-excel-vba\">here</a>.</p>\n\n<p>I want to write a UDF in Excel VBA (and not use any existing VBA Functions) to loop thru two ranges simultaneously at same level (1 to 1) and check if the two values match. </p>\n\n<p><a href=\"https://i.stack.imgur.com/k9v0W.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<pre><code>Public Function compare(r1 As Range, r2 As Range) As Integer\nDim i\nFor Each cell In r1\n     if cell.Value = 'value from r2 at same range level,  1 to 1 compare\n        i = i + 1\n     End If\nNext cell\ncompare = i\nEnd Function \n</code></pre>\n\n<p>In this UDF it takes in two ranges as input. Assume they are single column and equal rows for simplicity. Now using a <code>For Each cell in Range</code> loop I wish to compare the two ranges at same cell level. Is this possible?</p>\n\n<p>Would I need to create a Nested For and in every inner For, skips those many cells to match the cells of Outer For?</p>\n"}, {"tags": ["vba", "dynamic", "radio"], "comments": [{"owner": {"reputation": 1014, "user_id": 1723335, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lxYwM.jpg?s=128&g=1", "display_name": "A Khudairy", "link": "https://stackoverflow.com/users/1723335/a-khudairy"}, "edited": false, "score": 0, "creation_date": 1510731930, "post_id": 47300933, "comment_id": 81554565, "body": "So you have a visual basic application that has a browser in it? I think it is better to add more details to the question."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6908730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0efa0781c66e544acbb5a1d30bd5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/6908730/dnguyen"}, "edited": false, "score": 0, "creation_date": 1510785393, "post_id": 47301336, "comment_id": 81588185, "body": "Thanks, it worked.  Thanks for showing me trapping the error feature."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1510729716, "creation_date": 1510729716, "answer_id": 47301336, "question_id": 47300933, "link": "https://stackoverflow.com/questions/47300933/dynamic-radio-vba/47301336#47301336", "title": "Dynamic radio VBA", "body": "<p>Reference:<a href=\"https://www.w3schools.com/tags/att_option_disabled.asp\" rel=\"nofollow noreferrer\">HTML  disabled Attribute</a></p>\n\n<p>Disabled is a boolean attribute. This means that is value should not be set (e.g. disabled=\"disabled\").  If <code>disabled</code> is present then the option is disabled.</p>\n\n<pre><code>&lt;option value=\"volvo\" disabled&gt;Volvo&lt;/option&gt;\n</code></pre>\n\n<p>You should be able to use <code>msgbox ie.document.all(\"Answer1\").disabled</code>.  If this doesn't work trap the error</p>\n\n<pre><code>Function isDisabled(ele As Object) As Boolean\n    On Error Resume Next\n       isDisabled = ele.getAttribute(\"disabled\")\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 6908730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0efa0781c66e544acbb5a1d30bd5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/6908730/dnguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1510788841, "creation_date": 1510788841, "answer_id": 47319129, "question_id": 47300933, "link": "https://stackoverflow.com/questions/47300933/dynamic-radio-vba/47319129#47319129", "title": "Dynamic radio VBA", "body": "<p>I also find this worked too in if statement</p>\n\n<p><code>if isnull(ie.document.all(\"Answer1\").disabled) then\n msgbox \"Radio box disabled\"\nelse\nmsgbox \"Radio box enabled\"\nend if</code></p>\n"}], "owner": {"reputation": 7, "user_id": 6908730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0efa0781c66e544acbb5a1d30bd5bbb?s=128&d=identicon&r=PG&f=1", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/6908730/dnguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 47301336, "answer_count": 2, "score": 0, "last_activity_date": 1510788841, "creation_date": 1510728041, "last_edit_date": 1510753824, "question_id": 47300933, "link": "https://stackoverflow.com/questions/47300933/dynamic-radio-vba", "title": "Dynamic radio VBA", "body": "<p>On this internal website it allow me enter a  data and depending on the data the radio box will be enable. How do I know when the radio box is enabled.</p>\n\n<p>Enabled</p>\n\n<pre><code>input id=\"Answer1\" name=\"Answer\" type=\"radio\" value=\"C\"\n</code></pre>\n\n<p>Disabled</p>\n\n<pre><code>input id=\"Answer1\" name=\"Answer\" disabled=\"disabled\" type=\"radio\" value=\"C\"\n</code></pre>\n\n<p>When it is disabled the getAttribute will return \"disabled\" but when it is enabled it will return run time error </p>\n\n<blockquote>\n  <p>Invalid use of Null (Error 94)</p>\n</blockquote>\n\n<p>if I used </p>\n\n<pre><code>msgbox ie.document.all(\"Answer1\").getAttribute(\"disabled\")\n</code></pre>\n\n<p>I tried the following if statement and none will caught it when it is enabled</p>\n\n<pre><code>ie.document.all(\"Answer1\").getAttribute(\"disabled\")  = \"\"\nie.document.all(\"Answer1\").getAttribute(\"disabled\")  = Null\nie.document.all(\"Answer1\").getAttribute(\"disabled\")  &lt;&gt; \"disabled\"\nie.document.all(\"Answer1\").getAttribute(\"disabled\")  = \"disabled\"  \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1510725859, "post_id": 47300175, "comment_id": 81551773, "body": "Have you written any code to extract the data? Kindly provide that as well."}, {"owner": {"reputation": 16336, "user_id": 6356278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cb6527e3af8a89177b809385400437b?s=128&d=identicon&r=PG&f=1", "display_name": "Wimpel", "link": "https://stackoverflow.com/users/6356278/wimpel"}, "edited": false, "score": 0, "creation_date": 1510729085, "post_id": 47300175, "comment_id": 81553200, "body": "Sidenote: You really should try to avoid using &#39;ActiveSheet&#39;. It makes it hard to read what your code is doing on which sheet, and (becasuse of this?) is often a source for errors. Instead, refer to sheets using their names or numbers."}], "owner": {"reputation": 21, "user_id": 5998070, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vnO1tLfgGcU/AAAAAAAAAAI/AAAAAAAAEHw/udW_LexY0M8/photo.jpg?sz=128", "display_name": "Jack Wong", "link": "https://stackoverflow.com/users/5998070/jack-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510728688, "creation_date": 1510724547, "last_edit_date": 1510728688, "question_id": 47300175, "link": "https://stackoverflow.com/questions/47300175/vba-would-like-to-extract-certain-month-data-with-certain-year-into-the-corresp", "title": "VBA: Would like to extract certain month data with certain year into the corresponding worksheet", "body": "<p>I am using this code to create the new sheets with different years (2017, 2016, 2015...). But I still need to extract the data from \"Data\" sheet for certain month into corresponding \"Year\" sheet</p>\n\n<p>My data will like, where the Date is in DMYYYY format. \nDate Record</p>\n\n<p>2/1/1997 XXX -> goes to \"1997\"</p>\n\n<p>23/12//2017 xxxx -> goes to \"2017\"</p>\n\n<p>Code:</p>\n\n<pre><code>Sub Select_Month_Year_Data()\n\n    Dim cell As Excel.Range\n    Dim wsWithSheetNames As Excel.Worksheet\n    Dim wbToAddSheetsTo As Excel.Workbook\n\n    Worksheets(\"Ref\").Select\n    Set wsWithSheetNames = ActiveSheet\n    Set wbToAddSheetsTo = ActiveWorkbook\n\n    For Each cell In wsWithSheetNames.Range(\"A2:A32\")\n\n        With wbToAddSheetsTo\n\n            .Sheets.Add after:=.Sheets(.Sheets.Count)\n            On Error Resume Next\n            ActiveSheet.Name = cell.Value\n\n            If Err.Number = 1004 Then\n                Debug.Print cell.Value &amp; \" already used as a sheet name\"\n            End If\n\n            On Error GoTo 0\n\n       End With\n\n   Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1510723166, "post_id": 47299523, "comment_id": 81550904, "body": "Needs more code.  You may be missing a <code>Set</code> but it&#39;s difficult to say for sure."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1510725931, "post_id": 47299523, "comment_id": 81551799, "body": "By the sound of your variable name, if you used <code>.Find(...)</code> for rngfound, only proceed <code>If Not rngfound Is Nothing Then</code>."}], "answers": [{"tags": [], "owner": {"reputation": 322, "user_id": 4413195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1rFPO.jpg?s=128&g=1", "display_name": "Jpad Solutions", "link": "https://stackoverflow.com/users/4413195/jpad-solutions"}, "is_accepted": true, "score": 0, "last_activity_date": 1510730451, "creation_date": 1510730451, "answer_id": 47301545, "question_id": 47299523, "link": "https://stackoverflow.com/questions/47299523/conversion-required-from-general-in-to-text-format-in-vba/47301545#47301545", "title": "Conversion required from general in to text format in vba", "body": "<p>As the comments above say, hard to know without seeing your declarations.</p>\n\n<p>But the correct syntax would be:</p>\n\n<p>Set rngFound = Range(x:y)</p>\n\n<p>rngFound.Numberformat = \"@\"</p>\n"}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1510735594, "accepted_answer_id": 47301545, "answer_count": 1, "score": 0, "last_activity_date": 1510730451, "creation_date": 1510721217, "last_edit_date": 1510722359, "question_id": 47299523, "link": "https://stackoverflow.com/questions/47299523/conversion-required-from-general-in-to-text-format-in-vba", "closed_reason": "Not suitable for this site", "title": "Conversion required from general in to text format in vba", "body": "<p>I want to convert the value of my variable valueTofind from the general into text format but below the line of code gives me an error, Kindly help me with the updated version of the code.</p>\n\n<pre><code> valuetoFind=rngfound\n    valuetoFind.numberformat=\"@\"\n</code></pre>\n\n<p>This variable value changes everytime with the new set of data.\nThanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7795743, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DpcMaz30Ja8/AAAAAAAAAAI/AAAAAAAAAmY/Hx7sLMQ-3Ks/photo.jpg?sz=128", "display_name": "pramod karna", "link": "https://stackoverflow.com/users/7795743/pramod-karna"}, "edited": false, "score": 0, "creation_date": 1510719207, "post_id": 47299230, "comment_id": 81549705, "body": "Superb dude.. it worked"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1510718966, "creation_date": 1510718966, "answer_id": 47299230, "question_id": 47299151, "link": "https://stackoverflow.com/questions/47299151/how-to-find-the-row-number-of-a-value-in-filtered-sheet-in-only-visible-cells/47299230#47299230", "title": "How to find the row number of a value in filtered sheet in only visible cells?", "body": "<p>Try this:</p>\n\n<pre><code>On Error Resume Next\nDim SearchRange as Range\nSet SearchRange = Sheets(\"Inventory\").Range(\"G2:G1000\").SpecialCells(xlCellTypeVisible)\nOn Error GoTo 0\n\nIf Not SearchRange is Nothing Then\n\n    Dim FoundCell as Range\n    Set FoundCell = SearchRange.Find(mindat, lookat:=xlWhole)\n\n    If Not FoundCell is Nothing Then \n        minrow = FoundCell.Row\n    End If\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 7795743, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DpcMaz30Ja8/AAAAAAAAAAI/AAAAAAAAAmY/Hx7sLMQ-3Ks/photo.jpg?sz=128", "display_name": "pramod karna", "link": "https://stackoverflow.com/users/7795743/pramod-karna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "closed_date": 1510718979, "accepted_answer_id": 47299230, "answer_count": 1, "score": 0, "last_activity_date": 1510718966, "creation_date": 1510718455, "last_edit_date": 1531164843, "question_id": 47299151, "link": "https://stackoverflow.com/questions/47299151/how-to-find-the-row-number-of-a-value-in-filtered-sheet-in-only-visible-cells", "closed_reason": "Duplicate", "title": "How to find the row number of a value in filtered sheet in only visible cells?", "body": "<p>I used following syntax, but its not working. Please any one help on this.</p>\n\n<pre><code>minrow = Application.WorksheetFunction.Match(mindat, Sheets(\"Inventory\").Range(\"G2:G1000\").SpecialCells(xlCellTypeVisible), 0)\n</code></pre>\n"}, {"tags": ["excel", "vba", "colors"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1510717382, "post_id": 47298821, "comment_id": 81549262, "body": "Try matching on <code>Interior.Color</code> instead of <code>ColorIndex</code>"}, {"owner": {"reputation": 31, "user_id": 8606962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8057a0a98eeaaf2f06086d75353a7ad?s=128&d=identicon&r=PG", "display_name": "Duerna", "link": "https://stackoverflow.com/users/8606962/duerna"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510718237, "post_id": 47298821, "comment_id": 81549436, "body": "@Tim Williams, thank you, I changed <b>xcolor = criteria.Interior.ColorIndex</b>, to <b>xcolor = criteria.Interior.Color</b>, and excel show wrong message."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510718771, "post_id": 47298821, "comment_id": 81549586, "body": "What does &quot;wrong message&quot; mean exactly"}, {"owner": {"reputation": 31, "user_id": 8606962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8057a0a98eeaaf2f06086d75353a7ad?s=128&d=identicon&r=PG", "display_name": "Duerna", "link": "https://stackoverflow.com/users/8606962/duerna"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510719338, "post_id": 47298821, "comment_id": 81549745, "body": "@Tim Williams, the message is :Ambiguous name detected:CountCcolor."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 1, "creation_date": 1510720137, "post_id": 47298821, "comment_id": 81549972, "body": "That error means you have two Functions or Sub-routines with the same name on the Module."}, {"owner": {"reputation": 31, "user_id": 8606962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8057a0a98eeaaf2f06086d75353a7ad?s=128&d=identicon&r=PG", "display_name": "Duerna", "link": "https://stackoverflow.com/users/8606962/duerna"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1510727250, "post_id": 47298821, "comment_id": 81552360, "body": "@sktneer, thank you, I search the code from website, and I have no idear what is the functions or sub-routines in my code.  I try to instead all <i>Interior.ColorIndex</i> to <i>Interior.Color</i>, but it not works, all color count result show 0."}, {"owner": {"reputation": 31, "user_id": 8606962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8057a0a98eeaaf2f06086d75353a7ad?s=128&d=identicon&r=PG", "display_name": "Duerna", "link": "https://stackoverflow.com/users/8606962/duerna"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1510729675, "post_id": 47298821, "comment_id": 81553473, "body": "@ Tim Williams @sktneer   Thank you, I deleted all the unnessary module in my VBA (sktneer), and replace all coloriIndex, and it works, thank you for helping."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1510730547, "post_id": 47298821, "comment_id": 81553857, "body": "@user8606962 You&#39;re welcome! Glad we could help."}], "owner": {"reputation": 31, "user_id": 8606962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8057a0a98eeaaf2f06086d75353a7ad?s=128&d=identicon&r=PG", "display_name": "Duerna", "link": "https://stackoverflow.com/users/8606962/duerna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510716179, "creation_date": 1510716179, "question_id": 47298821, "link": "https://stackoverflow.com/questions/47298821/excel-count-based-on-cell-color-while-colors-were-very-similai", "title": "Excel count based on cell color, while colors were very similai", "body": "<p>I used VBA to count the cells numbers based on the cells color,\nhere are the VBA code:</p>\n\n<pre><code>Function CountCcolor(range_data As range, criteria As range) As Long\nDim datax As range\nDim xcolor As Long\nxcolor = criteria.Interior.ColorIndex\nFor Each datax In range_data\nIf datax.Interior.ColorIndex = xcolor Then\n    CountCcolor = CountCcolor + 1\nEnd If\nNext datax\nEnd Function\n</code></pre>\n\n<p>and I filled the cells with a seriers color, like the picture show.</p>\n\n<p><a href=\"https://i.stack.imgur.com/GmagS.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>the wrong count result between color 1 and color 2, color 3 and color 4 were same; I have another color count data with big difference filled cell color,\nand that's were right.</p>\n\n<p>I think the wrong data may caused by similar color, I know the similar color (color 1 to color 6)were different, but it seems the VBA code did not konw.</p>\n\n<p>How can I get right data without manual change the similar cells color?</p>\n\n<p>Thanks in advance.\nDUERNA</p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510713469, "post_id": 47298439, "comment_id": 81548405, "body": "there was another posting a few months back. there was a mention that some websites require an actual keypress in the input field ... that may be the reason that TAB makes it work.  i will try to find the posting."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510714558, "post_id": 47298439, "comment_id": 81548653, "body": "note: use <code>elseif ...</code> instead of <code>end if</code> <code>if ...</code>   ...... looks neater"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510714939, "post_id": 47298439, "comment_id": 81548746, "body": "try <code>aEle.focus</code> <code>aEle.value = branch</code>"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1510738148, "post_id": 47298439, "comment_id": 81558072, "body": "You neither post here a link to that webpage nor the portion of html elements you are hurdling with. That means, you are expecting us to provide you with a solution by making a good guess, ain&#39;t it? However, try to search out how <code>keyboard events</code> work in vba which in my guess will take care of your issue. Thanks."}], "owner": {"reputation": 3, "user_id": 8672417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb99218f14f5e7998168ab756b75dddc?s=128&d=identicon&r=PG&f=1", "display_name": "mag776", "link": "https://stackoverflow.com/users/8672417/mag776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1510713118, "creation_date": 1510713118, "question_id": 47298439, "link": "https://stackoverflow.com/questions/47298439/filling-in-html-inputs-with-vba-result-has-inputs-filled-in-but-treats-it-like", "title": "Filling in HTML inputs with VBA. result has inputs filled in but treats it like its empty", "body": "<p>Bit of an odd problem I have encountered. I am filling in a website for my work (cannot share) in order to speed up some searches for accounts. I have managed to fill in what I need but it still treats it as if the boxes are empty even though they are now filled with the data I selected. </p>\n\n<p>One workaround I am currently using is tabbing through everything, for some reason that works but I really do not want to resort to using sendkeys.</p>\n\n<p>I have tried changing the aEle.innerText to value and placeholder but not have worked.</p>\n\n<p>Here is the code I am using, it's pretty messy right now, the html I am using does not use any IDs so i had to loop through each tag. any input would be appreciated. Thanks</p>\n\n<pre><code>Dim fullAcct, acct, branch, daterange1, daterange2 As String\nDim objIE As InternetExplorer\nDim aEle As HTMLLinkElement\nDim y, branchInput, accountInput, dateInput As Integer 'integer variables used as counters\n\n'split selected account# into strings\nfullAcct = selection\nbranch = Left(fullAcct, 3)\nacct = Mid(fullAcct, 5, 6)\ndaterange1 = Date\ndaterange2 = DateAdd(\"yyyy\", -25, daterange1) 'max date range\n\nSet objIE = New InternetExplorer\nobjIE.Visible = True\n'navigate IE to this web page\nobjIE.Navigate \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX.com\"\n\nDo While objIE.Busy = True Or objIE.ReadyState &lt;&gt; 4: DoEvents: Loop\n\n'set the counter for the for each loop and indicators of what to update\ny = 1\nbranchInput = 2 'brach input\naccountInput = 3\ndateInput = 5\n'for each &lt;a&gt; element in the collection of objects with a tag name \"input\"\nFor Each aEle In objIE.Document.getElementsByTagName(\"input\")\n\n    '**tried using .value and .placerholder but innerText seemed to work the best\n    If y = branchInput Then 'check for second input (branch)\n        aEle.innerText = branch\n     End If\n    If y = accountInput Then 'check for third input (account#)\n        aEle.innerText = acct\n    End If\n    If y = dateInput Then 'check for date input\n        aEle.innerText = daterange2\n    End If\n   y = y + 1\nNext\n\nSendKeys \"{TAB 10}\" 'must be tabbed through for some reason or the data isnt read\n\nApplication.Wait (Now + TimeValue(\"0:00:01\"))\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510713742, "post_id": 47298397, "comment_id": 81548465, "body": "i do not think that the compiler proceeds after it finds an error.  it would be pointless .... there may be a plugin that does the checking .... there has been a lot of mentions of <code>rubberduck</code> ... it may or may  not have that ability ....  supported by Mat&#39;s Mug    <a href=\"https://github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">github.com/rubberduck-vba/Rubberduck</a>"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 3, "creation_date": 1510713832, "post_id": 47298397, "comment_id": 81548487, "body": "Nope. Maybe the <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">rubberduckvba.com</a> Code Inspections can help a bit"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1510713832, "post_id": 47298397, "comment_id": 81548488, "body": "The VBA compiler stops at the first error it encounters, so there isn&#39;t more than one error at a time. You can&#39;t ask about possible third-party solutions here, because it violates the site guidelines according to the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1510715821, "post_id": 47298397, "comment_id": 81548937, "body": "@Ken -- is a 3rd Party Solution allowed in an <i>Answer</i>?  I couldn&#39;t see any rules against it.  I figure this is a very interesting question, and rubberduckvba.com looks like an excellent (free) solution..."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1510715964, "post_id": 47298397, "comment_id": 81548975, "body": "@ashleedawg: No, answers consisting of nothing but a link off-site are not appropriate here. This is covered in the <a href=\"https://stackoverflow.com/help\">help center</a> pages. Answers should contain enough content to be self-sustaining, with external links only used for additional reference material. If the link is unavailable in the future, the answer should stand on its own. That clearly wouldn&#39;t be the case with the URL referenced in your comment; a comment is the appropriate place to provide it, not an answer."}], "owner": {"reputation": 371, "user_id": 2155646, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b22dc04013bb21de9ef5c1438b94a532?s=128&d=identicon&r=PG", "display_name": "Spacko", "link": "https://stackoverflow.com/users/2155646/spacko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1510713125, "creation_date": 1510712774, "last_edit_date": 1510713125, "question_id": 47298397, "link": "https://stackoverflow.com/questions/47298397/check-all-compile-errors", "title": "Check all compile errors", "body": "<p>I have inherited a fairly large vba program that was built without <em>Option Explicit</em> turned on.</p>\n\n<p>I've added this to the code and am working through the compile errors (Debug > Compile ...)\nAll issues I've come across so far are variables that are not declared</p>\n\n<pre><code>Compile error:\nVariable not defined\n</code></pre>\n\n<p>My issue is that the compiler only displays one error at at time.\nIs there a way to display all compile errors in a single view?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "is_accepted": false, "score": 2, "last_activity_date": 1510719362, "last_edit_date": 1510719362, "creation_date": 1510716925, "answer_id": 47298915, "question_id": 47298349, "link": "https://stackoverflow.com/questions/47298349/making-modular-vba-function-ms-access/47298915#47298915", "title": "Making modular VBA function (MS Access)", "body": "<p>Create another sub and send the clicked button to it. Similar to this:</p>\n\n<pre><code>Private Sub cmdTest01_Click()\n    SetCaption cmdTest01\nEnd Sub\n\nPrivate Sub cmdTest02_Click()\n    SetCaption cmdTest02\nEnd Sub\n\nPrivate Sub SetCaption(clickedButton As CommandButton)\n    Dim CondQ1 As String\n\n    Select Case clickedButton.Caption\n        Case \"Test01\"\n            CondQ1 = \"AND\"\n            clickedButton.Caption = CondQ1\n        Case \"Test02\"\n            CondQ1 = \"OR\"\n            clickedButton.Caption = CondQ1\n     End Select\nEnd Sub\n</code></pre>\n\n<p>Case blocks can be simplified to </p>\n\n<pre><code>Case \"Test01\"\n    clickedButton.Caption = \"AND\"\nCase \"Test02\"\n    clickedButton.Caption = \"OR\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 3, "last_activity_date": 1510742878, "last_edit_date": 1510742878, "creation_date": 1510728037, "answer_id": 47300931, "question_id": 47298349, "link": "https://stackoverflow.com/questions/47298349/making-modular-vba-function-ms-access/47300931#47300931", "title": "Making modular VBA function (MS Access)", "body": "<p>In the form's module create a function (not sub) like this:</p>\n\n<pre><code>Private Function SetCaption()\n    Dim clickedButton As Control\n    Dim CondQ1 As String\n\n    Set clickedButton = Me.ActiveControl\n    Select Case clickedButton.Value\n        Case True\n            CondQ1 = \"AND\"\n            clickedButton.Caption = CondQ1\n        Case False\n            CondQ1 = \"OR\"\n            clickedButton.Caption = CondQ1\n    End Select\nEnd Function\n</code></pre>\n\n<p>In form designer select all 50 buttons and type in property <code>On Click</code></p>\n\n<pre><code>=SetCaption()\n</code></pre>\n\n<p>So, you won't need to create event handler for each button.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1510847408, "last_edit_date": 1510847408, "creation_date": 1510742021, "answer_id": 47305088, "question_id": 47298349, "link": "https://stackoverflow.com/questions/47298349/making-modular-vba-function-ms-access/47305088#47305088", "title": "Making modular VBA function (MS Access)", "body": "<p>Use <em>WithEvents</em>. That takes a little code when loading and unloading the form, but zero code for each button.</p>\n\n<p>A similar example with full code, which you should be able to adapt, can be found here:</p>\n\n<p><a href=\"https://www.experts-exchange.com/articles/29554/Create-Windows-Phone-Colour-Palette-and-Selector-using-WithEvents.html\" rel=\"nofollow noreferrer\">Create Windows Phone Colour Palette and Selector using WithEvents</a></p>\n\n<p>and at <em>GitHub</em>:\n<a href=\"https://github.com/GustavBrock/VBA.ModernTheme\" rel=\"nofollow noreferrer\">VBA.ModernTheme</a></p>\n\n<p>Code snippet:</p>\n\n<pre><code>Private ControlCollection   As Collection\n\nPrivate Sub Form_Load()\n\n    ' Load events for all colour value textboxes.\n\n    Dim EventProcedure  As ClassTextboxSelect\n    Dim Control         As Access.Control\n\n    Set ControlCollection = New Collection\n\n    For Each Control In Me.Controls\n        If Control.ControlType = acTextBox Then\n            Set EventProcedure = New ClassTextboxSelect\n            EventProcedure.Initialize Control\n            ControlCollection.Add EventProcedure, Control.Name\n        End If\n    Next\n\n    Set EventProcedure = Nothing\n    Set Control = Nothing\n\nEnd Sub\n\nPrivate Sub Form_Open(Cancel As Integer)\n\n    Dim Index   As Integer\n\n    ' Set colour palette.\n    For Index = 0 To 20\n        Me(\"Box\" &amp; CStr(Index + 1)).BackColor = PaletteColor(Index)\n        Me(\"Name\" &amp; CStr(Index + 1)).Value = LiteralWpThemeColor(PaletteColor(Index))\n        Me(\"Css\" &amp; CStr(Index + 1)).Value = RGBHex(PaletteColor(Index))\n        Me(\"Vba\" &amp; CStr(Index + 1)).Value = PaletteColor(Index)\n        Me(\"Hex\" &amp; CStr(Index + 1)).Value = \"&amp;H\" &amp; Hex(PaletteColor(Index))\n    Next\n\nEnd Sub\n\nPrivate Sub Form_Unload(Cancel As Integer)\n\n    ' Unload events for all colour value textboxes.\n\n    Dim EventProcedure  As ClassTextboxSelect\n\n    For Each EventProcedure In ControlCollection\n        EventProcedure.Terminate\n    Next\n\n    Set EventProcedure = Nothing\n    Set ControlCollection = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5208254, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kDs08.jpg?s=128&g=1", "display_name": "Nocab_Evol_1", "link": "https://stackoverflow.com/users/5208254/nocab-evol-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1510847408, "creation_date": 1510712392, "question_id": 47298349, "link": "https://stackoverflow.com/questions/47298349/making-modular-vba-function-ms-access", "title": "Making modular VBA function (MS Access)", "body": "<p>I am writing up a simple multi-condition search form.\nThe Access VBA function set for the first toggle button looks like this:</p>\n\n<pre><code>Private Sub ToggleQ1_Click()\nSelect Case ToggleQ1.Value\n    Case True\n        CondQ1 = \"AND\"\n        ToggleQ1.Caption = CondQ1\n    Case False\n        CondQ1 = \"OR\"\n        ToggleQ1.Caption = CondQ1\nEnd Select\nEnd Sub\n</code></pre>\n\n<p>ToggleQ1 = button's name</p>\n\n<p>CondQ1 = variable to be used with a string to create conditional search.</p>\n\n<p>It would likely be absurd to create 50 more of the same button code, differ only in its name (ex. \"ToggleQ50\" and \"CondQ50\")</p>\n\n<p>Is there any way to make it modular and reusable?\nThank you very much in advance.</p>\n"}, {"tags": ["sql-server", "vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510710743, "post_id": 47298113, "comment_id": 81547762, "body": "<code>.List(i, 1) = rs!Suburb &amp; &quot;&quot;</code> is kind of hacky, but typically works."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510710872, "post_id": 47298113, "comment_id": 81547794, "body": "<code>SELECT [Name], NVL([Suburb], &#39;&#39;) as Suburb, NVL([State], &#39;&#39;) as State FROM Salon WHERE...</code> should also work"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510710926, "post_id": 47298155, "comment_id": 81547813, "body": "Isn&#39;t <code>nz</code> an Access function?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510711431, "post_id": 47298155, "comment_id": 81547944, "body": "@Tim -- oops - I misread (and always forget <code>nz</code> is annoyingly not-available in Excel!)  I&#39;ve corrected my answer to apply to Excel VBA, thanks!"}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1510711615, "last_edit_date": 1510711615, "creation_date": 1510710871, "answer_id": 47298155, "question_id": 47298113, "link": "https://stackoverflow.com/questions/47298113/excel-vba-ado-recordset-issue-with-null-values/47298155#47298155", "title": "Excel VBA ADO recordset issue with Null values", "body": "<p><code>Iif</code> can return an alternate for Null Values.</p>\n\n<p>For example:</p>\n\n<pre><code>.List(i, 0) = IIf(IsNull(a), \"(not found)\", rs!Name)\n</code></pre>\n\n<p>will return \"(not found)\" if the value is null.</p>\n\n<p>More info <a href=\"https://support.office.com/en-us/article/IIf-Function-32436ecf-c629-48a3-9900-647539c764e3\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://www.access-programmers.co.uk/forums/showthread.php?t=139335\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 8050236, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PFgce.jpg?s=128&g=1", "display_name": "trhoades", "link": "https://stackoverflow.com/users/8050236/trhoades"}, "edited": false, "score": 0, "creation_date": 1590167671, "post_id": 47305668, "comment_id": 109588098, "body": "Of all the websites I have looked at over several hours, this is the cleanest and most simple solution.  The hours of searching will etch one thing clearly in my mind.  Even if Excel developers didn&#39;t see fit to include a function, I must REMEMBER that I can create my own.  Thanks @Harassed Dad."}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1510743618, "creation_date": 1510743618, "answer_id": 47305668, "question_id": 47298113, "link": "https://stackoverflow.com/questions/47298113/excel-vba-ado-recordset-issue-with-null-values/47305668#47305668", "title": "Excel VBA ADO recordset issue with Null values", "body": "<p><em>nz is annoyingly not-available in Excel</em>\nOh yes it is :-) </p>\n\n<pre><code>Public Function NZ(v As Variant, Optional valueifnull As Variant = 0) As Variant\nIf IsNull(v) Then\n      NZ = valueifnull\nElse\n    NZ = v\nEnd If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2388488, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/12144f010be9289d3d03e892e0eee6a0?s=128&d=identicon&r=PG", "display_name": "Sean McQuarrie", "link": "https://stackoverflow.com/users/2388488/sean-mcquarrie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2831, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528796438, "creation_date": 1510710450, "last_edit_date": 1528796438, "question_id": 47298113, "link": "https://stackoverflow.com/questions/47298113/excel-vba-ado-recordset-issue-with-null-values", "title": "Excel VBA ADO recordset issue with Null values", "body": "<p>I'm pretty new at VBA and having an issue with ADO.<br> \nCurrently the code im using returns fields (<strong>Name</strong>, <strong>Suburb</strong>, <strong>State</strong>) from a SQL database into a ListBox.\nThe code works fine as long as there are there all fields have a value, if there is a Null value it returns the error </p>\n\n<blockquote>\n  <p>Could not set the List property. Type mismatch</p>\n</blockquote>\n\n<p>I need to find a way so if the Suburb and/or State fields return a Null value that it still populates the Listbox.<br>\nAny info would be greatly appreciated, thanks in advance!<br></p>\n\n<h3>Database entries</h3>\n\n<p><img src=\"https://i.stack.imgur.com/AMYlj.png\" alt=\"Database entries\"></p>\n\n<h3>Screenshot of error</h3>\n\n<p><img src=\"https://i.stack.imgur.com/wHkh4.png\" alt=\"Screenshot of error\">\n<code></p>\n\n<pre><code>Dim cnn As ADODB.Connection\nDim rs As New ADODB.Recordset\nDim SQLquery As String\nDim cnnstr As String\nDim SQLName As String\nDim i As Integer\n\nSQLName = \"Salon\"\nSQLquery = \"SELECT [Name], [Suburb], [State] FROM Salon WHERE Name like '\" &amp; SQLName &amp; \"%'\"\n\nSet cnn = New Connection\ncnnstr = \"Provider=SQLOLEDB; \" &amp; _\n                \"Data Source=localhost; \" &amp; _\n                \"Initial Catalog=MyDatabase;\" &amp; _\n                \"User ID=sa;\" &amp; _\n                \"Password=Password;\" &amp; _\n                \"Trusted_Connection=Yes;\"\n\ncnn.Open cnnstr  \ncnn.Execute SQLquery\nrs.Open SQLquery, cnn, adOpenStatic\n\n    rs.MoveFirst\n    i = 0\n    With Me.lb_search\n        .Clear\n        Do\n            .AddItem\n            .List(i, 0) = rs!Name\n            .List(i, 1) = rs!Suburb\n            .List(i, 2) = rs!State\n            i = i + 1\n            rs.MoveNext\n        Loop Until rs.EOF\n    End With\n\nbtn_search_test_Exit:\nOn Error Resume Next\nrs.Close\ncnn.Close\nSet rs = Nothing\nSet cnn = Nothing\n</code></pre>\n\n<p></code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510712109, "post_id": 47298108, "comment_id": 81548091, "body": "<code>Set</code>!!  You have to <code>Set</code> objects.  So <code>Set y = Workbooks.Open(source)</code>, just like the line before (<code>Set x = ActiveWorkbook</code>)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510712307, "post_id": 47298108, "comment_id": 81548124, "body": "And then you will have problems because (a) you don&#39;t have a line continuation after the <code>Copy</code>, so it won&#39;t think that the <code>Destination...</code> is part of the same statement, and (b) you are missing the colon in <code>y.Close savechanges:=False</code>.  (And, I guess, (c) you forgot to re-enable <code>ScreenUpdating</code>.)"}, {"owner": {"reputation": 9, "user_id": 8438379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2eed510fe9e94a6727b2f44fd3108ef?s=128&d=identicon&r=PG&f=1", "display_name": "terry", "link": "https://stackoverflow.com/users/8438379/terry"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510712329, "post_id": 47298108, "comment_id": 81548130, "body": "Thanks for your help. It is working currrently."}, {"owner": {"reputation": 9, "user_id": 8438379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2eed510fe9e94a6727b2f44fd3108ef?s=128&d=identicon&r=PG&f=1", "display_name": "terry", "link": "https://stackoverflow.com/users/8438379/terry"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510712417, "post_id": 47298108, "comment_id": 81548159, "body": "Is the colon in savechanges important?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510713014, "post_id": 47298108, "comment_id": 81548296, "body": "I added a bit to my answer to explain why that colon is <b>very</b> important."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8438379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2eed510fe9e94a6727b2f44fd3108ef?s=128&d=identicon&r=PG&f=1", "display_name": "terry", "link": "https://stackoverflow.com/users/8438379/terry"}, "edited": false, "score": 0, "creation_date": 1510713752, "post_id": 47298383, "comment_id": 81548469, "body": "Dear YowE3K. Thanks for your explanation. I will take note of the colon and make sure it is working."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1510712989, "last_edit_date": 1510712989, "creation_date": 1510712656, "answer_id": 47298383, "question_id": 47298108, "link": "https://stackoverflow.com/questions/47298108/get-data-from-a-directory-in-worksheet-cell/47298383#47298383", "title": "Get data from a directory in worksheet cell", "body": "<p>You are missing the all-important <code>Set</code> keyword, which is required to set references to objects.  So</p>\n\n<pre><code>y = Workbooks.Open(source)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Set y = Workbooks.Open(source)\n</code></pre>\n\n<hr>\n\n<p>You also have a few other issues with your code, which should probably look like:</p>\n\n<pre><code>Sub Button4_Click()\n    Application.ScreenUpdating = False\n\n    Dim x As Workbook\n    Dim y As Workbook\n    Dim source As String\n\n    'Note - this next line is using whatever worksheet is active in whichever\n    ' workbook is active.  This is potentially dangerous.\n    source = Cells(14, 6)\n    Set x = ActiveWorkbook\n    Set y = Workbooks.Open(source)\n    'You were missing a line continuation character on this statement\n    y.Sheets(\"Sheet1\").Range(\"A:Z\").Copy _\n           Destination:=x.Sheets(\"Sheet3\").Range(\"A:Z\")\n    'You were missing a colon in the named parameter of this statement\n    y.Close savechanges:= False\n\n    'You should reset ScreenUpdating\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Is the <code>:</code> in <code>savechanges:=False</code> important?  <strong>Yes</strong>.</p>\n\n<p>Your current code <code>y.Close savechanges = False</code> is firstly comparing the value of a variable called <code>savechanges</code> to the constant <code>False</code>.  As you have not declared that variable, nor assigned a value to it, <code>savechanges</code> will be assumed to be a numeric zero. Thus you are performing the test <code>0 = False</code>. Because VBA treats zero as <code>False</code> and -1 as <code>True</code>, <code>savechanges = False</code> will return <code>True</code>.  So that means you are doing the equivalent of <code>y.Close True</code> - which is almost certainly the exact opposite of what you intended.</p>\n\n<p>With the <code>:</code> included, the syntax is treating <code>SaveChanges:=False</code> to be setting the <code>Close</code> method's named parameter <code>SaveChanges</code> to a value of <code>False</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 8438379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2eed510fe9e94a6727b2f44fd3108ef?s=128&d=identicon&r=PG&f=1", "display_name": "terry", "link": "https://stackoverflow.com/users/8438379/terry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 12, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510712989, "creation_date": 1510710391, "last_edit_date": 1531164843, "question_id": 47298108, "link": "https://stackoverflow.com/questions/47298108/get-data-from-a-directory-in-worksheet-cell", "title": "Get data from a directory in worksheet cell", "body": "<p>I have question that my code cant run from the y = Workbooks.Open(source). I want to read the directory from a cell but it does not works. Why?</p>\n\n<pre><code>Sub Button4_Click()\nApplication.ScreenUpdating = False\n\nDim x As Workbook\nDim y As Workbook\nDim source As String\n\nsource = Cells(14, 6)\nSet x = ActiveWorkbook\ny = Workbooks.Open(source)\n\ny.Sheets(\"Sheet1\").Range(\"A:Z\").Copy \nDestination:=x.Sheets(\"Sheet3\").Range(\"A:Z\")\ny.Close savechanges = False\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1510709051, "post_id": 47297853, "comment_id": 81547340, "body": "VBA code is an excelent way to solve what you are thinking. That was your question?"}, {"owner": {"reputation": 9, "user_id": 8475244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da05294611ca50a16b05540f5ca77dfb?s=128&d=identicon&r=PG&f=1", "display_name": "C. Kyle", "link": "https://stackoverflow.com/users/8475244/c-kyle"}, "edited": false, "score": 0, "creation_date": 1510709578, "post_id": 47297853, "comment_id": 81547454, "body": "Thanks David, that confirms my train of thought but I am after some code to help me with this. I have edited my question to clear things up."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1510710646, "post_id": 47297853, "comment_id": 81547732, "body": "That looks like &quot;work&quot;, so you could consider hiring someone to do this.  If you know some VBA but are having problems implementing a solution, then posting some code along with as specific problem or error message will likely get you useful responses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 1, "creation_date": 1510710722, "post_id": 47297853, "comment_id": 81547757, "body": "@C. Kyle are you offering a job? This is not a &quot;code for me&quot; or &quot;free developers to make my job&quot; site. Please don&#39;t insult us."}, {"owner": {"reputation": 9, "user_id": 8475244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da05294611ca50a16b05540f5ca77dfb?s=128&d=identicon&r=PG&f=1", "display_name": "C. Kyle", "link": "https://stackoverflow.com/users/8475244/c-kyle"}, "edited": false, "score": 0, "creation_date": 1510712398, "post_id": 47297853, "comment_id": 81548152, "body": "Very sorry @DavidG., I didn&#39;t mean to insult anyone. I suppose you could say this is for &#39;work&#39;, I&#39;m a student and my assessment is looking at methods of job costing and tracking. The workbook is completely functional, this just an &#39;extra feature&#39; i was looking into. I have little experience with VBA so I&#39;m not sure how to apply anything that I know to this situation. The most I can think of some kind of for loop that will loop through the range of categories, and if the cell is colored, add a column to the table. I don&#39;t feel like I know where to start with adding columns to a named table."}, {"owner": {"reputation": 9, "user_id": 8475244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da05294611ca50a16b05540f5ca77dfb?s=128&d=identicon&r=PG&f=1", "display_name": "C. Kyle", "link": "https://stackoverflow.com/users/8475244/c-kyle"}, "edited": false, "score": 0, "creation_date": 1510712882, "post_id": 47297853, "comment_id": 81548258, "body": "Genuinely just trying to ask for some help here. Even if it is just small functions I could consider using or where I would put the code (Sheet_Activate etc.) or similar pieces of code that I could work out how to adapt. Not trying to use anyones code for personal credit or anything, there&#39;s a lot more i&#39;d like to do based on this function so I thought this might be a good place to start."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 0, "last_activity_date": 1510750435, "creation_date": 1510750435, "answer_id": 47307974, "question_id": 47297853, "link": "https://stackoverflow.com/questions/47297853/excel-increasing-decreasing-number-of-columns-in-table-based-on-number-of-colou/47307974#47307974", "title": "Excel: Increasing/Decreasing number of columns in table based on number of coloured rows from different sheet", "body": "<p>Kyle, you can visit the following sites with a lot of vba beginners information.</p>\n\n<blockquote>\n  <p><a href=\"http://www.excel-easy.com/vba.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/vba.html</a>\n  <a href=\"http://www.homeandlearn.org/\" rel=\"nofollow noreferrer\">http://www.homeandlearn.org/</a></p>\n  \n  <p><a href=\"https://www.tutorialspoint.com/vba/\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/vba/</a></p>\n</blockquote>\n\n<p>Try implementing your idea using pseudo-code.</p>\n\n<blockquote>\n  <p><a href=\"http://www.vikingcodeschool.com/software-engineering-basics/what-is-pseudo-coding\" rel=\"nofollow noreferrer\">http://www.vikingcodeschool.com/software-engineering-basics/what-is-pseudo-coding</a></p>\n  \n  <p><a href=\"https://www.youtube.com/watch?v=4G0EYfrrDT8\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=4G0EYfrrDT8</a></p>\n  \n  <p><a href=\"https://www.khanacademy.org/computing/computer-programming/programming/good-practices/p/planning-with-pseudo-code\" rel=\"nofollow noreferrer\">https://www.khanacademy.org/computing/computer-programming/programming/good-practices/p/planning-with-pseudo-code</a></p>\n</blockquote>\n\n<p>Once you be able to write your code and you are having some code error or problem you cannot find a solution in the web, come again and ask specific questions, there are a lot of experienced programmers that will be happy to help you to solve your coding problems.</p>\n"}], "owner": {"reputation": 9, "user_id": 8475244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da05294611ca50a16b05540f5ca77dfb?s=128&d=identicon&r=PG&f=1", "display_name": "C. Kyle", "link": "https://stackoverflow.com/users/8475244/c-kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 47307974, "answer_count": 1, "score": -2, "last_activity_date": 1510750435, "creation_date": 1510708314, "last_edit_date": 1510713056, "question_id": 47297853, "link": "https://stackoverflow.com/questions/47297853/excel-increasing-decreasing-number-of-columns-in-table-based-on-number-of-colou", "title": "Excel: Increasing/Decreasing number of columns in table based on number of coloured rows from different sheet", "body": "<p>I am in the process of creating a costing summary workbook. My main summary sheet lists a job category and then 4 rows of cost breakdown before the next category is listed. On another sheet, I have a template that the user will make a copy of for each month, which breaks down weekly work hours and then allocates hours from each employee/plant to against a job category. Please see attached pictures.</p>\n\n<p><a href=\"https://i.stack.imgur.com/TxQzW.png\" rel=\"nofollow noreferrer\">Summary Sheet</a> - \n <a href=\"https://i.stack.imgur.com/px2K5.png\" rel=\"nofollow noreferrer\">Template Sheet</a></p>\n\n<p>My goal is to have the number of columns on the template increase/decrease as categories are added to or removed from the summary sheet. I already have a cell that contains a count of coloured rows (category titles), and  i figure i should be able to use this to determine the amount of rows that need to be added to or removed from a table. I can't think of any ways for this to be done without macros or VBA code of some kind, which I am open to but I would like to minimise the use of. \nCan anyone provide me with some code or a push in the right direction for this kind of function? Category names will be stored in column A, or my count is stored in B84. Columns for each category start from column S in the template sheet.</p>\n"}, {"tags": ["vba", "excel", "comments"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1510706339, "post_id": 47297512, "comment_id": 81546620, "body": "What&#39;s <code>.Value(10)</code>?"}, {"owner": {"reputation": 21, "user_id": 8942148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/102d7be977dfd0e944a267773b030683?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper", "link": "https://stackoverflow.com/users/8942148/cooper"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1510706547, "post_id": 47297512, "comment_id": 81546672, "body": "Its the Range value Default, you dont really need to put it in there but thats how I learned so I normally do. I also just realized it is because what I am trying to add is a number as when I adjust the reference to a cell with Text it puts the comments in, any reason why it wouldn&#39;t let me comment a number?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 2, "creation_date": 1510707121, "post_id": 47297512, "comment_id": 81546843, "body": "Thought me something that&#39;s pretty much useless to getting the DefaultValue. If the <code>rcell</code> already has a comment, it fails. Are you sure <code>&quot;U&quot; &amp; rcell.Row</code> is inside the clear comments range (&quot;C6:AR17&quot;)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1510707218, "post_id": 47297512, "comment_id": 81546862, "body": "@PatricK - To get a better idea of what .Value(10) is, try ?activecell.Value(11) in the VBE&#39;s Immediate window."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1510708593, "post_id": 47297512, "comment_id": 81547228, "body": "@PatricK search for &quot;RangeValueDataType&quot; in object browser"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1510707051, "post_id": 47297588, "comment_id": 81546824, "body": "... or you could append the existing comment delimited with Chr(10)."}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 1, "creation_date": 1510707575, "post_id": 47297588, "comment_id": 81546963, "body": "@Jeeped Sure... depends whether OP wants to cumulate or obliterate."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 1, "last_activity_date": 1510708354, "last_edit_date": 1510708354, "creation_date": 1510706211, "answer_id": 47297588, "question_id": 47297512, "link": "https://stackoverflow.com/questions/47297512/add-comments-to-specific-cells-in-range-excel-vba/47297588#47297588", "title": "Add Comments to Specific cells in Range. Excel VBA", "body": "<p>The <code>AddComment</code> method fails if there's already a comment on a cell. Do it like this:</p>\n\n<pre><code>Sub Comments()\n    Dim rcell As Range\n    Dim commentvalue As String\n\n    Sheet16.Range(\"C6:AR17\").ClearComments\n\n    For Each rcell In Sheet1.Range(\"A2:A\" &amp; Sheet1.Range(\"A\" &amp; Sheet1.Rows.CountLarge).End(xlUp).row)\n        If rcell.Offset(0, 1).Value = Sheet7.Range(\"G1\").Value Then\n            commentvalue = CStr(rcell.Offset(0, 4).Value)\n\n            With Sheet16.Range(\"U\" &amp; rcell.row)\n                .ClearComments '&lt;=== :-)\n                .AddComment commentvalue\n            End With\n        End If\n    Next rcell\nEnd Sub\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>As per @Jeeped's comment, you could want to \"cumulate\" comments. My assumption was that you ran the code once, then ran it again and hit the error because the first run had created the comments. Depending on what you try to achieve, you may want to systematically clear the comments in column U from rows 2 to your last row, outside of the loop, and remove the <code>.ClearComments</code> in the loop, in order to start clean each time. That's the simplest case. I'll let you work out the details if it's anything more complicated.</p>\n"}], "owner": {"reputation": 21, "user_id": 8942148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/102d7be977dfd0e944a267773b030683?s=128&d=identicon&r=PG&f=1", "display_name": "Cooper", "link": "https://stackoverflow.com/users/8942148/cooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1510754320, "creation_date": 1510705694, "last_edit_date": 1510754320, "question_id": 47297512, "link": "https://stackoverflow.com/questions/47297512/add-comments-to-specific-cells-in-range-excel-vba", "title": "Add Comments to Specific cells in Range. Excel VBA", "body": "<p>I am trying to add comments to specific cells in a range if they meet criteria. So I have a list in Sheet1 where the information is housed. I also have the cell value on sheet16 where I want the comment in column U, so it will say F6 in row U. I keep getting </p>\n\n<blockquote>\n  <p>Application-Defined or object-defined error</p>\n</blockquote>\n\n<p>Any thoughts?</p>\n\n<p>Thanks in Advance.</p>\n\n<pre><code>Sub Comments()\n\n    Dim rcell As Range\n\n    Sheet16.Range(\"C6:AR17\").ClearComments\n\n    For Each rcell In Sheet1.Range(\"A2:A\" &amp; Sheet1.Range(\"A\" &amp; Sheet1.Rows.CountLarge).End(xlUp).Row)\n        If rcell.Offset(0, 1).Value(10) = Sheet7.Range(\"G1\").Value(10) Then\n            commentvalue = rcell.Offset(0, 4).Value\n            Sheet16.Range(\"U\" &amp; rcell.Row).AddComment (commentvalue)\n        End If\n    Next rcell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510706090, "post_id": 47297260, "comment_id": 81546565, "body": "Is the value you are searching for stored in the cell as a constant, or is the cell calculating it by a formula?  (I&#39;m wondering whether you have manually used a &quot;Look in: Formulas&quot; just prior to it crashing, but at other times you have manually used a &quot;Look in: Values&quot; just prior to it working.)"}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510710618, "post_id": 47297260, "comment_id": 81547723, "body": "The value is always stored in the cell as a constant (there is no formulas in this sheet, because this file contents only raw data exported from other application). And the format of this cell is &#39;General&#39;."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510710648, "post_id": 47297260, "comment_id": 81547733, "body": "OK, that blows that theory out of the water,"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510711115, "post_id": 47297260, "comment_id": 81547863, "body": "I just noticed that your posted code doesn&#39;t include line continuation characters. (I tried to paste it into a macro to see whether I could break it and, of course, got a syntax error.)  That implies that you didn&#39;t copy/paste the code from VBE into the question, which means that there is potentially some difference between what is in the question and what you are actually running.  For the moment I will assume you had one long line and the line breaks are the <b>only</b> difference between this code and your code - but can you please verify that."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510711437, "post_id": 47297260, "comment_id": 81547945, "body": "put this line before the code that you posted  <code>debug.print CLng(strSheetName)</code> or just <code>debug.print strSheetName</code> .... when the code &quot;fails&quot;, check the <code>Immediate</code> window for the printed value"}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "edited": false, "score": 0, "creation_date": 1510711688, "post_id": 47297260, "comment_id": 81548004, "body": "Yeah, you&#39;re right. The only difference between this two codes are the line breaks. I&#39;ve changed it just after paste, to improve readability. Edit: I correct the code, now it should be OK."}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510712346, "post_id": 47297260, "comment_id": 81548133, "body": "@jsotola: The problem is that I&#39;ve tried to repeat this situation and I failed to :( It happened only 2 or 3 times and only on my customer&#39;s computer."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 2, "creation_date": 1510713173, "post_id": 47297260, "comment_id": 81548334, "body": "put in code <code>if rngDataStart  is nothing then</code> .... <code>msgbox &quot;an error has occured ..blah blah.</code>   ..... have it show the value of <code>strSheetName</code> and ask to call you to give you the &quot;errror code&quot; (sheetname)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1510714438, "post_id": 47297260, "comment_id": 81548630, "body": "Intermittent errors are the hardest to debug!  @jsotola&#39;s suggestion is probably the best you can do at the moment.  (The only things I can think of that might cause the problem is the user adding an extra sheet to the workbook before running the macro, so that the sheet you are meant to be searching is no longer <code>Worksheets(1)</code>, or something wrong in your code where it is setting <code>wbSourceFile</code>.)"}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510745514, "post_id": 47297260, "comment_id": 81562811, "body": "@YowE3K: I know that it is hard to help find something which isn&#39;t repeatable.. but I don&#39;t give up and will still try to discover the reason why the error occurrs, so for sure I will use your advices :) Thanks for all your suggestions."}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510755203, "post_id": 47297260, "comment_id": 81569512, "body": "@jsotola: The code you mentioned above (with MsgBox which displays the strSheetName in case when rngDataStart is &#39;Nothing&#39;) is already in my procedure a few lines below: <code>If rngDataStart Is Nothing Then</code> ... <code>MsgBox &quot;There is no data for project &quot; &amp; strSheetName &amp; &quot; in the source file!&quot;</code> and unfortunately when the error occured MsgBox displayed the correct name of the sheet."}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "edited": false, "score": 0, "creation_date": 1510755553, "post_id": 47297260, "comment_id": 81569749, "body": "I also checked it step by step in the debug mode and: the value of strSheetName was &quot;163020040&quot;, there was a sheet in the workbook named &quot;163020040&quot;, there was a cell with value &quot;163020040&quot; in the source file, and despite all this the result of the Range.Find method was: rngDataStart = &#39;Nothing&#39;. Any ideas how is it possible?"}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510756768, "post_id": 47297260, "comment_id": 81570754, "body": "@jsotola: Responding to your previous question: after removing the conversion function <code>CLng</code> from the code (searching for a String value instead of Long), everything still works fine."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510768312, "post_id": 47297260, "comment_id": 81579015, "body": "when it happens again check the value of the cell by looking at the formula bar.  ... maybe something will show up ... could it be a unicode issue?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510769938, "post_id": 47297260, "comment_id": 81579928, "body": "And was there definitely only one worksheet in the workbook referred to by <code>wbSourceFile</code>?  Perhaps another hidden sheet?"}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510781113, "post_id": 47297260, "comment_id": 81586061, "body": "@YowE3K: Yes, only one worksheet in the workbooks with source data, no Hidden or VeryHidden sheets."}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510781442, "post_id": 47297260, "comment_id": 81586233, "body": "@jsotola: What do you mean <i>could it be a unicode issue?</i> Can you explain it to me?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1510782030, "post_id": 47297260, "comment_id": 81586513, "body": "Some of the unicode characters look very similar to normal characters (although I&#39;m not sure whether any look like numbers) and some unicode characters aren&#39;t even visible.  Next time an error occurs, try typing a formula such as <code>=B30=&quot;163020040&quot;</code> (where <code>B30</code> is whatever cell you <b>think</b> should be matching, and <code>&quot;163020040&quot;</code> is whatever has been displayed as <code>strSheetName</code>) into a cell somewhere and see if it returns <code>TRUE</code>.  If not, <b>copy/paste</b> the value in the cell, and the value of <code>strSheetName</code> into the question and ping @jsotola or myself and we will be happy to investigate."}, {"owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1510783208, "post_id": 47297260, "comment_id": 81587129, "body": "@YowE3K: Ok. Now I understand :) It looks like I have no choice than to wait until the error reappears. Of course, I&#39;ll let you know when I get the error again or find the cause :) Thanks again for your feedback."}], "owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1539337850, "creation_date": 1510703886, "last_edit_date": 1539337850, "question_id": 47297260, "link": "https://stackoverflow.com/questions/47297260/range-find-method-not-always-works-properly", "title": "Range.Find method not always works properly", "body": "<p>Below is the fragment of my procedure which sometimes doesn't work and I don't have any idea why?</p>\n\n<pre><code>With wbSourceFile.Worksheets(1).Cells(1, 2).EntireColumn\n    Set rngDataStart = .Find(What:=CLng(strSheetName), _\n                             SearchOrder:=xlByColumns, _\n                             MatchCase:=True, _\n                             LookAt:=xlPart, _\n                             After:=.Cells(.Cells.Count))\nEnd With\n</code></pre>\n\n<p>This <code>Range.Find</code> method should look for a cell in <code>wbSourceFile</code> workbook (to be precise: in column B of the first worksheet of this workbook) which value is equal to a name of the sheet from the 2nd excel file (this name is previously stored in <code>strSheetName</code> string variable and complies with the mask \"1630?????\" where '?' stands for any digit).</p>\n\n<p>Generally it works. But the problem is that it doesn't work all the time. There were at least a few times when the <code>rngDataStart</code> variable was set to 'Nothing', although there was an appropriate value in the searched range! And what's even stranger: when I enter the debug mode and run the procedure step by step the problem disappears (<code>Range.Find</code> method starts to work correctly).</p>\n\n<p>Of course I have to ensure that <code>Range.Find</code> method will work properly every time. So I need any suggestion what could cause this situation or where should I look for a reason of that strange behavior?</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510703160, "post_id": 47297122, "comment_id": 81545643, "body": "Which line do you get the error? I&#39;m guessing Macro1 needs an argument provided."}, {"owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510703246, "post_id": 47297122, "comment_id": 81545670, "body": "Also your select case is based on lowercase listbox2.Text. One of your case statements is &quot;Analysis&quot; - this will never run because it is not lowercase."}, {"owner": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "reply_to_user": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510703261, "post_id": 47297122, "comment_id": 81545674, "body": "The second line is highlighted"}, {"owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510703301, "post_id": 47297122, "comment_id": 81545695, "body": "What is the code for Macro1?"}, {"owner": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "reply_to_user": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510703620, "post_id": 47297122, "comment_id": 81545811, "body": "Sub macro1() &#39; &#39; Macro1 Macro      Sheets.Add     ActiveSheet.Name = &quot;Analysis&quot;  Application.DisplayAlerts = False Application.ScreenUpdating = False &#39;     Range(&quot;A13&quot;).Select     ActiveCell.FormulaR1C1 = &quot;Year&quot;     Range(&quot;B13&quot;).Select     ActiveCell.FormulaR1C1 = &quot;0&quot;     Range(&quot;C13&quot;).Select     ActiveCell.FormulaR1C1 = &quot;=IFERROR(IF(RC[-1]+1&gt;R9C2,&quot;&quot;&quot;&quot;,RC[-1]+1),&quot;&quot;&quot;&quot;)&quot;     Range(&quot;C13&quot;).Select     Selection.AutoFill Destination:=Range(&quot;C13:HS13&quot;), Type:=xlFillDefault     Range(&quot;C13:HQ13&quot;).Select End Sub"}, {"owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510704210, "post_id": 47297122, "comment_id": 81545988, "body": "I&#39;m not too sure about that one, sorry. All I can think of is that LCase has been redefined somewhere. The error message you&#39;re getting means you are missing an argument in a function call somewhere. All the code you&#39;ve provided looks OK to me. You said the error occurs on line 2. Is that this line?: Private Sub CommandButton3_Click()"}, {"owner": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "reply_to_user": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510704475, "post_id": 47297122, "comment_id": 81546084, "body": "Yes. it is the Private Sub CommandButton3_Click(). I adjusted the LCase but I&#39;m still getting the same error."}, {"owner": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510704958, "post_id": 47297122, "comment_id": 81546238, "body": "Thanks. The LCase bit fixed an error you would have encountered later. Do you know if the button is part of an array?"}, {"owner": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "reply_to_user": {"reputation": 91, "user_id": 8896208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c657d25f70f2e9c4bff37dc59a4af68?s=128&d=identicon&r=PG", "display_name": "Eliot", "link": "https://stackoverflow.com/users/8896208/eliot"}, "edited": false, "score": 1, "creation_date": 1510705431, "post_id": 47297122, "comment_id": 81546376, "body": "Listbox1 is an array then I&#39;ve a button that moves selections from listbox1 to listbox2. That all works fine. Now, I want to call a macro when commandbutton3 is clicked and if  &quot;analysis&quot; is found in lisbox2"}], "answers": [{"comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "edited": false, "score": 1, "creation_date": 1510705925, "post_id": 47297383, "comment_id": 81546515, "body": "Please be more specific than &quot;The second line is highlighted&quot; ... why not post the actual line?"}, {"owner": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "edited": false, "score": 1, "creation_date": 1510706179, "post_id": 47297383, "comment_id": 81546583, "body": "the following line is highlighted when I get the error : Private Sub CommandButton3_Click()"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "edited": false, "score": 1, "creation_date": 1510706560, "post_id": 47297383, "comment_id": 81546678, "body": "Have you tried to step thru the code one line at a time? If not, then you should. Since you have no error traps, you can be misled as to the correct source of the error."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "reply_to_user": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "edited": false, "score": 1, "creation_date": 1510708358, "post_id": 47297383, "comment_id": 81547159, "body": "See updated answer - your issue is with reference to listbox."}], "tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 1, "last_activity_date": 1510708314, "last_edit_date": 1510708314, "creation_date": 1510704744, "answer_id": 47297383, "question_id": 47297122, "link": "https://stackoverflow.com/questions/47297122/vba-argument-not-optional-error-userfrom-listbox/47297383#47297383", "title": "VBA argument not optional error userfrom listbox", "body": "<p>First, your method of referencing the ListBox is a problem. See the code below Also, I had to add Sheet Name before Range and then this worked for me...</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton3_Click()\nDim i as Integer\nDim sValue as String\n   For i = 0 To Me.ListBox2.ListCount - 1\n       If Me.ListBox2.Selected(i) Then\n           sValue = ListBox2.List(i)\n       End If\n   Next i\n\n   Select Case LCase(sValue)\n      Case \"Analysis\": Call macro1\n      Case \"\" \n          MsgBox \"nothing selected\"\n      Case Else\n          MsgBox sValue.Text\n   End Select\nEnd Sub\n\nSub macro1()\n'\n' Macro1 Macro\nSheets.Add\nActiveSheet.Name = \"Analysis\"\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n'\nSheets(\"Analysis\").Range(\"A13\").Select\nActiveCell.FormulaR1C1 = \"Year\"\nSheets(\"Analysis\").Range(\"B13\").Select\nActiveCell.FormulaR1C1 = \"0\"\nSheets(\"Analysis\").Range(\"C13\").Select\nActiveCell.FormulaR1C1 = \"=IFERROR(IF(RC[-1]+1&gt;R9C2,\"\"\"\",RC[-1]+1),\"\"\"\")\"\nSheets(\"Analysis\").Range(\"C13\").Select\nSelection.AutoFill Destination:=Sheets(\"Analysis\").Range(\"C13:HS13\"), Type:=xlFillDefault\nSheets(\"Analysis\").Range(\"C13:HQ13\").Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8917097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67cd5db151f552bc0ac73eeba0858425?s=128&d=identicon&r=PG&f=1", "display_name": "AIS", "link": "https://stackoverflow.com/users/8917097/ais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510708314, "creation_date": 1510702862, "last_edit_date": 1510704082, "question_id": 47297122, "link": "https://stackoverflow.com/questions/47297122/vba-argument-not-optional-error-userfrom-listbox", "title": "VBA argument not optional error userfrom listbox", "body": "<p>I wrote the following code for a UserForm but I keep getting an <code>argument not optional</code> error.</p>\n\n<pre><code>Option Explicit\nPrivate Sub CommandButton3_Click()\n   Select Case LCase(Me.ListBox2.Text)\n   Case \"Analysis\": Call macro1\n   Case \"\" \n        MsgBox \"nothing selected\"\n   Case Else\n        MsgBox Me.ListBox2.Text\n   End Select\nEnd Sub\n</code></pre>\n\n<p>macro 1 code:</p>\n\n<pre><code>Sub macro1()\n'\n' Macro1 Macro\nSheets.Add\nActiveSheet.Name = \"Analysis\"\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n'\nRange(\"A13\").Select\nActiveCell.FormulaR1C1 = \"Year\"\nRange(\"B13\").Select\nActiveCell.FormulaR1C1 = \"0\"\nRange(\"C13\").Select\nActiveCell.FormulaR1C1 = \"=IFERROR(IF(RC[-1]+1&gt;R9C2,\"\"\"\",RC[-1]+1),\"\"\"\")\"\nRange(\"C13\").Select\nSelection.AutoFill Destination:=Range(\"C13:HS13\"), Type:=xlFillDefault \nRange(\"C13:HQ13\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1510703625, "creation_date": 1510703625, "answer_id": 47297232, "question_id": 47297074, "link": "https://stackoverflow.com/questions/47297074/excel-vba-condensing-multiple-ranges-with-a-sumif-formula-to-one-line/47297232#47297232", "title": "EXCEL VBA: Condensing multiple ranges with a SUMIF formula to one line", "body": "<p>Why not try it this way?</p>\n\n<pre><code>Dim Rng As Range\nSet Rng = Range(\"B7:B9,B12:B13,B17,B21:B25,B29:B33,B37\")\nRng.Formula = \"=SUMIF($M$2:$M$500,A7,$L$2:$L$500)\"\nRng.Value = Rng.Value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 609, "user_id": 8453036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/369b931407d4e81468045e4084aa357c?s=128&d=identicon&r=PG&f=1", "display_name": "R. Roe", "link": "https://stackoverflow.com/users/8453036/r-roe"}, "is_accepted": false, "score": 0, "last_activity_date": 1510704052, "creation_date": 1510704052, "answer_id": 47297287, "question_id": 47297074, "link": "https://stackoverflow.com/questions/47297074/excel-vba-condensing-multiple-ranges-with-a-sumif-formula-to-one-line/47297287#47297287", "title": "EXCEL VBA: Condensing multiple ranges with a SUMIF formula to one line", "body": "<p>To make it even shorter you could set the range values like so;</p>\n\n<pre><code>[B7:B9,B12:B13,B17,B21:B25,B29:B33,B37].Formula = \"=SUMIF($M$2:$M$500,A7,$L$2:$L$500)\"\n</code></pre>\n\n<p>The <code>[]</code> is a shortcut for the range object</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1510706393, "creation_date": 1510706393, "answer_id": 47297618, "question_id": 47297074, "link": "https://stackoverflow.com/questions/47297074/excel-vba-condensing-multiple-ranges-with-a-sumif-formula-to-one-line/47297618#47297618", "title": "EXCEL VBA: Condensing multiple ranges with a SUMIF formula to one line", "body": "<p>I was under the impression that you wanted to reduce the calculation to a single code line. You can with the SUM(SUMIF(..., ..., ...)) formula but the series of criteria values needs to be an array, not cells and it best to remove duplicates.</p>\n\n<pre><code>=sum(sumifs(L2:L500, M2:M500, {1, 2, 3, 4, 5}))\n</code></pre>\n\n<p>In code to collect the values from the discontiguous range into an array while removing duplicate values,</p>\n\n<pre><code>Dim a As Long, arr As Variant, rng As Range\nReDim arr(30)  'total 31 possible values before duplicate removal\n\nFor Each rng In Range(\"a7:a9,a12:a13,a17,a21:a25,a29:a33,a37\")\n    Debug.Print rng.Address\n    If IsError(Application.Match(rng.Value2, arr, 0)) Then\n        arr(a) = rng.Value2\n        a = a + 1\n    End If\nNext rng\nReDim Preserve arr(a - 1)\nDebug.Print Application.Sum(Application.SumIfs(Range(\"L2:L500\"), Range(\"M2:M500\"), arr))\n\nDim Sumact As Range\nSet Sumact = Sheets(\"IS Branch 12\").Range(\"B7\")\nSumact = Application.Sum(Application.SumIfs(Range(\"L2:L500\"), Range(\"M2:M500\"), arr))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7903900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10207331073394977/picture?type=large", "display_name": "n00b", "link": "https://stackoverflow.com/users/7903900/n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1510706393, "creation_date": 1510702581, "question_id": 47297074, "link": "https://stackoverflow.com/questions/47297074/excel-vba-condensing-multiple-ranges-with-a-sumif-formula-to-one-line", "title": "EXCEL VBA: Condensing multiple ranges with a SUMIF formula to one line", "body": "<p>I have the following lines of code to fill specific ranges with SUMIF formulas:</p>\n\n<pre><code>Range(\"B7\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B8\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B9\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B12\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B13\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B17\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B21\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B22\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B23\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B24\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B25\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B29\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B30\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B31\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B32\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B33\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\nRange(\"B37\").FormulaR1C1 = \"=SUMIF(R2C13:R500C13,RC[-1],R2C12:R500C12)\"\n</code></pre>\n\n<p>I'm having a hard time turning the above lines of code into something shorter like the code below. I receive the same answer but I am unsure how to code it with multiple ranges. </p>\n\n<pre><code>Dim Sumact As Range\n\nSet Sumact = Sheets(\"IS Branch 12\").Range(\"B7\")\n\nSumact = Application.sumif(Range(\"M2:M500\"),Range(\"A7\"),Range(\"L2:L500\"))\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1510720059, "post_id": 47296872, "comment_id": 81549950, "body": "For number field you can set limit. <code>Minimum</code> and <code>Maximum</code> limit can be entered in a numeric field."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8865077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01f791bd826ab49ed61960acec6f730?s=128&d=identicon&r=PG&f=1", "display_name": "Charles_D", "link": "https://stackoverflow.com/users/8865077/charles-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1510708969, "creation_date": 1510708969, "answer_id": 47297926, "question_id": 47296872, "link": "https://stackoverflow.com/questions/47296872/access-field-size-for-numerical-field/47297926#47297926", "title": "Access - Field size for numerical field?", "body": "<p>You could use the format property.  Another option would be to treat the field as a text box and the format property.  Then when you want to use the value numerically use the val function.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8673254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MGXu5.jpg?s=128&g=1", "display_name": "Chris.Le", "link": "https://stackoverflow.com/users/8673254/chris-le"}, "edited": false, "score": 0, "creation_date": 1510880265, "post_id": 47299645, "comment_id": 81635479, "body": "So I tried putting this &quot;Expected:Identified&quot; keeps occuring"}, {"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "reply_to_user": {"reputation": 15, "user_id": 8673254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MGXu5.jpg?s=128&g=1", "display_name": "Chris.Le", "link": "https://stackoverflow.com/users/8673254/chris-le"}, "edited": false, "score": 0, "creation_date": 1510880950, "post_id": 47299645, "comment_id": 81635671, "body": "Do you use a space in your column name? If so, put is between square brackets. Or you might be using a reserved word. Hard to tell without example ;)"}], "tags": [], "owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "is_accepted": true, "score": 0, "last_activity_date": 1510721897, "creation_date": 1510721897, "answer_id": 47299645, "question_id": 47296872, "link": "https://stackoverflow.com/questions/47296872/access-field-size-for-numerical-field/47299645#47299645", "title": "Access - Field size for numerical field?", "body": "<p>No.\nWhat you can do is to apply a validation rule to your number field in the table.\nLike:</p>\n\n<pre><code>Len([enter your field name here])&lt;=4\n</code></pre>\n\n<p>Plus a validation message:</p>\n\n<pre><code>Number should be 4 digits at most\n</code></pre>\n\n<p>There's other option too like applying a Before Update event in your form that you use to maintain the data.</p>\n\n<p>And another possible option might be to apply a data macro.\nCan't help you on that one as my Access version is pretty old.</p>\n"}], "owner": {"reputation": 15, "user_id": 8673254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/MGXu5.jpg?s=128&g=1", "display_name": "Chris.Le", "link": "https://stackoverflow.com/users/8673254/chris-le"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 47299645, "answer_count": 2, "score": 0, "last_activity_date": 1510721897, "creation_date": 1510701402, "question_id": 47296872, "link": "https://stackoverflow.com/questions/47296872/access-field-size-for-numerical-field", "title": "Access - Field size for numerical field?", "body": "<p>With text boxes, you can set field size on how many characters can be entered. \nIs it possible to do this to a numerical field?</p>\n"}]