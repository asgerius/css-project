[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1576709453, "post_id": 59401029, "comment_id": 104991198, "body": "move <code>Dim rs As New ADODB.Recordset</code> inside the loop"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1576709496, "post_id": 59401029, "comment_id": 104991216, "body": "You never clear <code>mailTo</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1576709546, "post_id": 59401029, "comment_id": 104991234, "body": "@alowflyingpig <code>Dim</code> statements aren&#39;t executable, that wouldn&#39;t make any difference."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1576709626, "post_id": 59401029, "comment_id": 104991258, "body": "yea, i know, meant to say split.. like my answer below."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576709713, "post_id": 59401029, "comment_id": 104991287, "body": "@MathieuGuindon I understand that <code>Dim</code> statements are only &quot;executed&quot; once when the macro is run"}, {"owner": {"reputation": 51, "user_id": 9997061, "user_type": "registered", "profile_image": "https://graph.facebook.com/479229482536030/picture?type=large", "display_name": "Alexa", "link": "https://stackoverflow.com/users/9997061/alexa"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576709764, "post_id": 59401029, "comment_id": 104991298, "body": "@TimWilliams Thanks! That might be it! I will try it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 1, "creation_date": 1576711441, "post_id": 59401029, "comment_id": 104991725, "body": "@alowflyingpig yep - as soon as the scope is entered; and <code>As New</code> auto-instantiated objects initialize on first reference, at the <code>.</code> dereferencing operator."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576725689, "post_id": 59401029, "comment_id": 104994496, "body": "@TimWilliams: You forgot to say &quot;<b>Hi Alexa</b>... You never clear <code>mailTo</code>&quot; :P"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576775521, "post_id": 59401029, "comment_id": 105015782, "body": "@SiddharthRout - not in that habit yet..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576775657, "post_id": 59401029, "comment_id": 105015845, "body": "@TimWilliams: My wife wants one... lets see"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1576709710, "post_id": 59401083, "comment_id": 104991285, "body": "I&#39;d also avoid the <code>As New</code> in the <code>connection</code> declaration. ADODB stuff is the last thing on Earth you want auto-instantiated."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576709866, "post_id": 59401083, "comment_id": 104991324, "body": "updatd answer to reflect advice from @MathieuGuindon above."}], "tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": false, "score": 1, "last_activity_date": 1576709841, "last_edit_date": 1576709841, "creation_date": 1576709602, "answer_id": 59401083, "question_id": 59401029, "link": "https://stackoverflow.com/questions/59401029/single-ado-connection-with-multiple-record-sets/59401083#59401083", "title": "Single ADO connection with multiple record sets", "body": "<p>Simply move the creation on the recordset within the loop so that when each iteration takes plac, the record set is created and removed when loop has finished.</p>\n\n<p>Like this:</p>\n\n<pre><code>Dim connection As New ADODB.connection\nDim rs As ADODB.Recordset\n\nstrPath = \"path\"\nstrConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strPath &amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;\"\";\"\nconnection.Open strConn\n\nDim tarArr As Variant, tarElm As Variant, recsetElm as Variant\ntarArr = Array(\"CW\", \"NW\")\n\nFor Each tarElm In tarArr\n\n    If tarElm = \"CW\" Then\n        distroSht = \"Capital Warfare\"\n    ElseIf tarElm = \"NW\" Then\n        distroSht = \"Northwest Pacific\"\n    End If\n\n    strQuery = \"SELECT Address FROM [\" &amp; distroSht &amp; \"$]\"\n\n    Set rs = ADODB.Recordset\n    rs.Open strQuery, connection\n    recset = rs.GetRows\n\n    For Each recsetElm In recset\n        mailTo = mailTo &amp; recsetElm &amp; \"; \"\n    Next recsetElm\n\n    Erase recset\n    rs.Close\n    Set rs = Nothing\n    mailTo = vbNullString\n\nNext tarElm\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 9997061, "user_type": "registered", "profile_image": "https://graph.facebook.com/479229482536030/picture?type=large", "display_name": "Alexa", "link": "https://stackoverflow.com/users/9997061/alexa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576709841, "creation_date": 1576709236, "question_id": 59401029, "link": "https://stackoverflow.com/questions/59401029/single-ado-connection-with-multiple-record-sets", "title": "Single ADO connection with multiple record sets", "body": "<p>I have been trying to loop though an array, opening multiple record sets in teh same connected workbook.</p>\n\n<p>The first iteration is fine, however up subsequent iterations, the record set is building upon the previous record sets.</p>\n\n<p>I have tried erasing the array of data, closing the record set, setting a new record set, setting the record set to nothing, and even closing the connection and opening a new one.</p>\n\n<p>It is still cumulative.</p>\n\n<pre><code>Dim connection As New ADODB.connection\nDim rs As New ADODB.Recordset\n\nstrPath = \"path\"\nstrConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strPath &amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;\"\";\"\nconnection.Open strConn\n\nDim tarArr As Variant, tarElm As Variant, recsetElm as Variant\ntarArr = Array(\"CW\", \"NW\")\n\nFor Each tarElm In tarArr\n    If tarElm = \"CW\" Then\n        distroSht = \"Capital Warfare\"\n    ElseIf tarElm = \"NW\" Then\n        distroSht = \"Northwest Pacific\"\n    End If\n\n    strQuery = \"SELECT Address FROM [\" &amp; distroSht &amp; \"$]\"\n\n    Set rs = New ADODB.Recordset\n    rs.Open strQuery, connection\n    recset = rs.GetRows\n\n    For Each recsetElm In recset\n        mailTo = mailTo &amp; recsetElm &amp; \"; \"\n    Next recsetElm\n\n    Erase recset\n    rs.Close\n    Set rs = Nothing\nNext tarElm\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5444457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979e1c12f6b7514def459615ad8bce55?s=128&d=identicon&r=PG&f=1", "display_name": "Alan001", "link": "https://stackoverflow.com/users/5444457/alan001"}, "edited": false, "score": 0, "creation_date": 1576719463, "post_id": 59401884, "comment_id": 104993407, "body": "Thank you! Could you please explain this part? I get Index out of bounds errors there:  <code>With Rng         .End = .End - 1         strFnd = Trim(Split(.Text, vbCr)(0))         BkMkNm = Replace(strFnd, &quot; &quot;, &quot;_&quot;)         .Bookmarks.Add BkMkNm, .Duplicate       End With</code>"}, {"owner": {"reputation": 13, "user_id": 5444457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979e1c12f6b7514def459615ad8bce55?s=128&d=identicon&r=PG&f=1", "display_name": "Alan001", "link": "https://stackoverflow.com/users/5444457/alan001"}, "edited": false, "score": 0, "creation_date": 1576721264, "post_id": 59401884, "comment_id": 104993707, "body": "If you have time to comment some more positions I would be happy. Especially the part mentioned above and this one:         <code>Set HLnk = .Hyperlinks.Add(.Duplicate, , BkMkNm, , .Text)         .End = HLnk.Range.End         .Collapse wdCollapseEnd         .Find.Execute</code>"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 13, "user_id": 5444457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979e1c12f6b7514def459615ad8bce55?s=128&d=identicon&r=PG&f=1", "display_name": "Alan001", "link": "https://stackoverflow.com/users/5444457/alan001"}, "edited": false, "score": 0, "creation_date": 1576721293, "post_id": 59401884, "comment_id": 104993717, "body": "The only way I can see an error occurring is if your reference cell contained an empty first paragraph or you had a character there that is illegal in a bookmark name. Which particular line was generating the error message?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 13, "user_id": 5444457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979e1c12f6b7514def459615ad8bce55?s=128&d=identicon&r=PG&f=1", "display_name": "Alan001", "link": "https://stackoverflow.com/users/5444457/alan001"}, "edited": false, "score": 0, "creation_date": 1576721370, "post_id": 59401884, "comment_id": 104993733, "body": "You can find a full explanation of the various methods in Word&#39;s VBA help file."}, {"owner": {"reputation": 13, "user_id": 5444457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979e1c12f6b7514def459615ad8bce55?s=128&d=identicon&r=PG&f=1", "display_name": "Alan001", "link": "https://stackoverflow.com/users/5444457/alan001"}, "edited": false, "score": 0, "creation_date": 1576788206, "post_id": 59401884, "comment_id": 105020672, "body": "Yes I had empty lines in the end and some strange characters but wrote a function that cleans the words. Thank you!"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1576715954, "creation_date": 1576715954, "answer_id": 59401884, "question_id": 59400811, "link": "https://stackoverflow.com/questions/59400811/how-can-i-convert-a-word-to-a-hyperlink-linking-to-a-bookmark-in-the-same-docume/59401884#59401884", "title": "How can I convert a word to a hyperlink linking to a Bookmark in the same document?", "body": "<p>Try:</p>\n\n<pre><code>Sub GlossaryLinker()\nApplication.ScreenUpdating = False\nDim Tbl As Table, Rng As Range, HLnk As Hyperlink\nDim strFnd As String, BkMkNm As String, r As Long\nWith ActiveDocument\n  Set Tbl = .Tables(.Tables.Count)\n  For r = 2 To Tbl.Rows.Count\n    With Tbl.Cell(r, 1)\n      Set Rng = .Range\n      With Rng\n        .End = .End - 1\n        strFnd = Trim(Split(.Text, vbCr)(0))\n        BkMkNm = Replace(strFnd, \" \", \"_\")\n        .Bookmarks.Add BkMkNm, .Duplicate\n      End With\n    End With\n    Set Rng = .Range(.Range.Start, Tbl.Range.Start)\n    With .Range\n      With .Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .Format = False\n        .Text = strFnd\n        .Wrap = wdFindStop\n        .MatchWholeWord = True\n        .MatchWildcards = False\n        .MatchCase = True\n        .Execute\n      End With\n      Do While .Find.Found\n        If .InRange(Rng) = False Then Exit Do\n        Set HLnk = .Hyperlinks.Add(.Duplicate, , BkMkNm, , .Text)\n        .End = HLnk.Range.End\n        .Collapse wdCollapseEnd\n        .Find.Execute\n      Loop\n    End With\n  Next\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5444457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/979e1c12f6b7514def459615ad8bce55?s=128&d=identicon&r=PG&f=1", "display_name": "Alan001", "link": "https://stackoverflow.com/users/5444457/alan001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 59401884, "answer_count": 1, "score": 0, "last_activity_date": 1576715954, "creation_date": 1576707912, "last_edit_date": 1576712236, "question_id": 59400811, "link": "https://stackoverflow.com/questions/59400811/how-can-i-convert-a-word-to-a-hyperlink-linking-to-a-bookmark-in-the-same-docume", "title": "How can I convert a word to a hyperlink linking to a Bookmark in the same document?", "body": "<p>I really have problems with this one. Imagine I have the word \u201estackoverflow\u201c. At the end of the document there is a glossary. Now I need a macro that searches for all occurences of stackoverflow and replaces them with a hyperlink to the bookmark in the table. A reader still sees \u201estackoverflow\u201c but can click on it to jump to the Glossary. I can insert online links in \u201eaddress\u201c field and think I need the subaddress field but do not know what to put there.. Thank you in advance!</p>\n\n<pre><code>Sub Convert_String()\nDim Word\nDim R As Range\nDim Tabellenanzahl\nDim T As Table\nDim Link As Hyperlink\n\nSet R = ActiveDocument.Range\nTabellenanzahl = ActiveDocument.Tables.Count\nSet T = ActiveDocument.Tables(Tabellenanzahl)\nActiveDocument.Bookmarks.Add \"Anker\", T.Range\n\nFor Z = 2 To T.Rows.Count\n    Set Wort = T.Cell(Z, 1)\n\n        With R.Find\n            .ClearFormatting\n            .Text = Word\n            .Forward = True\n            .Wrap = wdFindStop\n        End With\n\n    Do While R.Find.Execute\n        R.Hyperlinks.Add Anchor:=Selection, SubAddress:=\"Anker\", TextToDisplay:=\"GoToGlossaryTest\"\n    Loop\n\n  Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576705155, "post_id": 59400302, "comment_id": 104989734, "body": "1) You&#39;re not specifying a range in your <code>IF</code> statement: <code>Worksheets(&quot;Lettersent&quot;).Range.Value</code> should be something like <code>Worksheets(&quot;Lettersent&quot;).Range(&quot;A1&quot;).Value</code>. 2) Do you really want to change <i>all</i> the values in <code>A1:E14</code>?"}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576705272, "post_id": 59400302, "comment_id": 104989768, "body": "Well I was using a merged cell in order to make the number bigger. Should I use just a single cell enlarged to fit the number?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576705534, "post_id": 59400302, "comment_id": 104989859, "body": "Merged cells are a VBA nightmare. If you plan using them, know it&#39;s just the topleft cell displaying it&#39;s value"}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1576705652, "post_id": 59400302, "comment_id": 104989895, "body": "JvdV that was perfect, when I changed it to just A1 as the cell reference it works perfect, now I need to work on change the background color as they click."}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1576705753, "post_id": 59400302, "comment_id": 104989948, "body": "Cyber why did you delete. I was about to upvote you and say that your answer is perfect."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576768731, "post_id": 59400302, "comment_id": 105012187, "body": "Because @Tim Williams &#39; answer was more elegant than mine"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1576705567, "creation_date": 1576705567, "answer_id": 59400392, "question_id": 59400302, "link": "https://stackoverflow.com/questions/59400302/how-to-create-a-loop-using-a-button/59400392#59400392", "title": "How to create a loop using a button?", "body": "<p>If the top-left cell of your merged range is A1 then:</p>\n\n<pre><code>Sub OnClickLetterSent()\n    With Worksheets(\"Lettersent\").Range(\"A1\")\n        Select Case .Value \n            Case 802, 803: .Value = .Value + 1\n            Case 804: .Value = 802\n        End Select\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1576706980, "last_edit_date": 1576706980, "creation_date": 1576706188, "answer_id": 59400494, "question_id": 59400302, "link": "https://stackoverflow.com/questions/59400302/how-to-create-a-loop-using-a-button/59400494#59400494", "title": "How to create a loop using a button?", "body": "<p>Alternatively, you could try:</p>\n\n<pre><code>With Worksheets(\"Lettersent\").Range(\"A1\")\n    .Value = WorksheetFunction.Choose(.Value - 801, 803, 804, 802)\nEnd With\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>With Worksheets(\"Lettersent\")\n    .[A1] = .[A1+CHOOSE(A1-801,1,1,-2)]\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 59400392, "answer_count": 2, "score": 0, "last_activity_date": 1580534102, "creation_date": 1576704981, "last_edit_date": 1580534102, "question_id": 59400302, "link": "https://stackoverflow.com/questions/59400302/how-to-create-a-loop-using-a-button", "title": "How to create a loop using a button?", "body": "<p>I have a group of merged cells with a number.</p>\n\n<p>When a user clicks a button I want the number to increment by 1. On click again, increment by 1, then click again, decrease by 2 back to the original number.</p>\n\n<pre><code>Sub OnClickLetterSent()\nIf Worksheets(\"Lettersent\").Range.Value = 802 Then\n    Worksheets(\"Lettersent\").Range.Value = Worksheets(\"Lettersent\").Range(\"A1:E14\") + 1\nElseIf Worksheets(\"Lettersent\").Range.Value = 803 Then\n    Worksheets(\"Lettersent\").Range.Value = Worksheets(\"Lettersent\").Range(\"A1:E14\") + 1\nElseIf Worksheets(\"Lettersent\").Range.Value = 804 Then\n    Worksheets(\"Lettersent\").Range.Value = Worksheets(\"Lettersent\").Range(\"A1:E14\") - 2\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576706625, "post_id": 59400281, "comment_id": 104990249, "body": "Not my downvote, but rule of thumb, if you don&#39;t know where to start, Stack Overflow isn&#39;t a good place to do so - &quot;I need code that does XYZ&quot; usually isn&#39;t well received. Have you tried recording an actual paste-special/values operation?"}, {"owner": {"reputation": 11, "user_id": 12432344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eedf929d650b8f1d0fde92c09607dbfc?s=128&d=identicon&r=PG&f=1", "display_name": "GlenMoseley", "link": "https://stackoverflow.com/users/12432344/glenmoseley"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576706850, "post_id": 59400281, "comment_id": 104990333, "body": "I did try that but because I want to cut the active row using my userform, the record macro didn&#39;t work right. I can upload a sample workbook if that helps. Is that even allowed?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576706911, "post_id": 59400281, "comment_id": 104990349, "body": "I wouldn&#39;t download some random macro-enabled workbook, no. But if you included the actual non-working code you&#39;ve tried, it could go a long way."}, {"owner": {"reputation": 11, "user_id": 12432344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eedf929d650b8f1d0fde92c09607dbfc?s=128&d=identicon&r=PG&f=1", "display_name": "GlenMoseley", "link": "https://stackoverflow.com/users/12432344/glenmoseley"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576707443, "post_id": 59400281, "comment_id": 104990530, "body": "This is the code I am currently working with but it works off of cell value. It also just pastes it over, I want it to just paste the value of each cell.  &#39;CODE&#39; Private Sub CmdRecon_Click()     Dim i As Long     For i = Cells(Rows.Count, 25).End(xlUp).Row To 1 Step -1     If Cells(i, 25) = &quot;y&quot; Then    Range(&quot;a&quot; &amp; i &amp; &quot;:Y&quot; &amp; i).Copy Sheet3.Cells(Rows.Count,    1).End(xlUp).Offset(1)    Cells(i, 25).EntireRow.Delete     End If     Next        End Sub &#39;code&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12432344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eedf929d650b8f1d0fde92c09607dbfc?s=128&d=identicon&r=PG&f=1", "display_name": "GlenMoseley", "link": "https://stackoverflow.com/users/12432344/glenmoseley"}, "edited": false, "score": 0, "creation_date": 1576850176, "post_id": 59400863, "comment_id": 105038877, "body": "A couple things. Thanks to whomever fixed my post with the code. I couldn&#39;t get it to display right. Next thanks you for your response. That is very helpful. The code looks for a &quot;y&quot; in column 25. I would prefer it just use the active row from when I select it from my listbox."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 12432344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eedf929d650b8f1d0fde92c09607dbfc?s=128&d=identicon&r=PG&f=1", "display_name": "GlenMoseley", "link": "https://stackoverflow.com/users/12432344/glenmoseley"}, "edited": false, "score": 0, "creation_date": 1576850912, "post_id": 59400863, "comment_id": 105039234, "body": "Then don&#39;t use a loop and <code>i</code> with <code>ActiveCell.Row</code>"}, {"owner": {"reputation": 11, "user_id": 12432344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eedf929d650b8f1d0fde92c09607dbfc?s=128&d=identicon&r=PG&f=1", "display_name": "GlenMoseley", "link": "https://stackoverflow.com/users/12432344/glenmoseley"}, "edited": false, "score": 0, "creation_date": 1577123135, "post_id": 59400863, "comment_id": 105099939, "body": "Like This?: &#39;code&#39; Private Sub CmdRecon_Click()      Dim i As Long      i = ActiveCells.row.End(xlUp).Row To 1 Step -1      Range(&quot;a&quot; &amp; i ).Copy Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1)      activeCells.EntireRow.Delete  End Sub"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1576708217, "creation_date": 1576708217, "answer_id": 59400863, "question_id": 59400281, "link": "https://stackoverflow.com/questions/59400281/cut-and-paste-active-row-from-one-table-to-another-table-on-different-sheet/59400863#59400863", "title": "Cut and paste active row from one table to another table on different sheet", "body": "<blockquote>\n<pre><code>Range(\"a\" &amp; i &amp; \":Y\" &amp; i).Copy Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1)\n</code></pre>\n</blockquote>\n\n<p>You're using <code>Range.Copy</code>, which copies <em>everything</em> about that range.</p>\n\n<p>You want to copy the range to the clipboard, and then <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.pastespecial\" rel=\"nofollow noreferrer\"><code>PasteSpecial</code></a> on the target range:</p>\n\n<pre><code>Range(\"a\" &amp; i &amp; \":Y\" &amp; i).Copy\nSheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12432344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eedf929d650b8f1d0fde92c09607dbfc?s=128&d=identicon&r=PG&f=1", "display_name": "GlenMoseley", "link": "https://stackoverflow.com/users/12432344/glenmoseley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576708217, "creation_date": 1576704859, "last_edit_date": 1576707994, "question_id": 59400281, "link": "https://stackoverflow.com/questions/59400281/cut-and-paste-active-row-from-one-table-to-another-table-on-different-sheet", "title": "Cut and paste active row from one table to another table on different sheet", "body": "<p>Ok. This sounds simple enough but...I have a spreadsheet with a userform that tracks my Purchase orders. When I search the PO# from my userform the data is returned to a listbox. I click the listbox entry I want and the information populates the userform text boxes. I want to click a button called \"reconcile\" to cut that record from the current sheet \"Purchase Orders\" the table name is \"T-INV\") and paste it to Sheet \"Reconciled\" the table is \"Reconciled\" the tables are identical in columns. I would also like the row that was cut to be deleted from the \"Purchase order\" sheet.</p>\n\n<p>I know that sounds complicated but I just want to cut and paste the selected PO from one sheet/table to another using a command button. I can provide code if needed but there are a lot of buttons. Everything I need the form to do it does. I just need a macro or VBA code to cut the active row and paste it in the other table on the reconciled sheet. The Macro recorder doesn't work for this. I just want the values pasted not the formulas from the original table.</p>\n\n<pre><code>Private Sub CmdRecon_Click()\n    Dim i As Long\n    For i = Cells(Rows.Count, 25).End(xlUp).Row To 1 Step -1\n        If Cells(i, 25) = \"y\" Then\n            Range(\"a\" &amp; i &amp; \":Y\" &amp; i).Copy Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1)\n            Cells(i, 25).EntireRow.Delete\n        End If\n    Next\nEnd Sub    \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576702779, "post_id": 59399869, "comment_id": 104988892, "body": "<code>&quot;=SUMIF(V2:V&quot; &amp; N &amp; &quot;,&quot;&quot;&lt;0&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 12553273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55da3a37434b5d4e6dd6292c3ec98ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user12553273", "link": "https://stackoverflow.com/users/12553273/user12553273"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576703014, "post_id": 59399869, "comment_id": 104988966, "body": "thanks BigBen, I am making this entirely too difficult for myself."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1576703770, "creation_date": 1576703770, "answer_id": 59400084, "question_id": 59399869, "link": "https://stackoverflow.com/questions/59399869/excel-macro-sumif-why-is-this-returning-false/59400084#59400084", "title": "Excel Macro SUMIF Why is this returning False?", "body": "<p>You're over-complicating the concatenation and doubling up of quotes. If you look closely, the <code>&lt;</code> does not fall within quotes, hence the boolean <code>FALSE</code> result; you're comparing one string to another.</p>\n\n<pre><code>\"=SUMIF(V2:V\" &amp; N &amp; \",\"\"&lt;0\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12553273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55da3a37434b5d4e6dd6292c3ec98ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user12553273", "link": "https://stackoverflow.com/users/12553273/user12553273"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576703770, "creation_date": 1576702604, "question_id": 59399869, "link": "https://stackoverflow.com/questions/59399869/excel-macro-sumif-why-is-this-returning-false", "title": "Excel Macro SUMIF Why is this returning False?", "body": "<p>Sorry for all the noob questions.  In my macro I am expecting it to return a number from the given range, but all I am getting is FALSE. </p>\n\n<pre><code>Cells(N + 2, \"V\").Formula = \"=SUMIF(V2:V\" &amp; N &amp; \",\" &amp; \"\"\" &amp; \" &lt; \" &amp; 0 &amp; \"\"\" &amp; \")\"  \n</code></pre>\n\n<p>thanks1</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576702309, "post_id": 59399808, "comment_id": 104988705, "body": "Maybe take a look at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\"><code>Range.End</code></a>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576704508, "post_id": 59399808, "comment_id": 104989513, "body": "If you would use <code>SpecialCells(12)</code> you will end up with something called <code>Areas</code>. You can loop those and set a formula for them in one go."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576716799, "post_id": 59399808, "comment_id": 104992898, "body": "You can enter the formula in the entire range in one go. No need to autofill. For Example<code>Range(&quot;A1:A&quot; &amp; LastRow).Formula = YourFormula</code> You can find the last row as shown <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/11169920#11169920\">Here</a>"}], "owner": {"reputation": 13, "user_id": 12561085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c520d49ace8ffac8fca08da26ad7ed?s=128&d=identicon&r=PG&f=1", "display_name": "Finpat", "link": "https://stackoverflow.com/users/12561085/finpat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576702413, "creation_date": 1576702261, "last_edit_date": 1576702413, "question_id": 59399808, "link": "https://stackoverflow.com/questions/59399808/excel-vba-autofill-down-to-next-cell-with-data", "title": "Excel VBA: Autofill down to next cell with data", "body": "<p>Bit of context: I have a column which is mostly blank, but every now and then there will be a value in the cell (see attached). I start by entering a formula into the blank cell below the non-blank cell, and double clicking the bottom right corner does the trick easily. I can figure out how to loop this process in VBA, but how can I set the range in the autofill command to end at the next non-blank cell?</p>\n\n<p><a href=\"https://i.stack.imgur.com/Lj1QT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lj1QT.png\" alt=\"The column\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1576702127, "post_id": 59399729, "comment_id": 104988630, "body": "In general you want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using select</a> in your code. it would be useful to see sample data and expected outcome"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1576702156, "post_id": 59399729, "comment_id": 104988637, "body": "<code>ws.Range(&quot;N&quot; &amp; LastRow).Value = ws.Range(&quot;N&quot; &amp; LastRow).Value &amp;...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "edited": false, "score": 0, "creation_date": 1576702686, "post_id": 59399796, "comment_id": 104988856, "body": "YAAAAAAAAAAS Thanks so much!! Took a second but I got it!"}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 1, "last_activity_date": 1576702199, "creation_date": 1576702199, "answer_id": 59399796, "question_id": 59399729, "link": "https://stackoverflow.com/questions/59399729/how-to-add-text-to-end-of-cell-if-multiple-check-boxes-are-true/59399796#59399796", "title": "How to Add Text to end of cell if multiple check boxes are true?", "body": "<p>Create a Variable to store the string in and at the end of all the if statements stick that string in the cell.</p>\n\n<pre><code>dim notesval as string\nIf Not IsEmpty(Notes.Text) Then\n    notesval = Notes.Text\nEnd If\nif TubeAdd.Value = True Then\n    notesval = notesval &amp; \", Tubing\"\nend if\n'Finish the rest of the IFs\nws.Range(\"N\" &amp; LastRow).Value = notesval\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59399796, "answer_count": 1, "score": 0, "last_activity_date": 1576703789, "creation_date": 1576701866, "last_edit_date": 1576703789, "question_id": 59399729, "link": "https://stackoverflow.com/questions/59399729/how-to-add-text-to-end-of-cell-if-multiple-check-boxes-are-true", "title": "How to Add Text to end of cell if multiple check boxes are true?", "body": "<p>I've got a form that when I hit the submit button enters the Notes into a cell. As a part of the notes I have checkboxes for various options. What I'd like to do is add the checkbox values to the end of same cell as the Notes. This is what I have:</p>\n\n<pre><code>    If Not IsEmpty(Notes.Text) Then\n    ws.Range(\"N\" &amp; LastRow).Value = Notes.Text\n    End If\n\n    If TubeAdd.Value = True Then\n    ws.Range(\"N\" &amp; LastRow).Value = ActiveCell &amp; \", Tubing\"\n    End If\n\n    If Snowshoe.Value = True Then\n    ws.Range(\"N\" &amp; LastRow).Value = ActiveCell &amp; \", Snowshoeing\"\n    End If\n\n    If TubeExclusive.Value = True Then\n    ws.Range(\"N\" &amp; LastRow).Value = ActiveCell &amp; \", Tubing\"\n    End If\n\n    If Legacy.Value = True Then\n    ws.Range(\"N\" &amp; LastRow).Value = ActiveCell &amp; \", Legacy Room\"\n    End If\n\n    If NorthAxe.Value = True Then\n    ws.Range(\"N\" &amp; LastRow).Value = ActiveCell &amp; \", North Axe Room\"\n    End If\n\n    If MidMountainLodge.Value = True Then\n    ws.Range(\"N\" &amp; LastRow).Value = ActiveCell &amp; \", MidMountain Lodge\"\n    End If\n\n    If Catering.Value = True Then\n    ws.Range(\"N\" &amp; LastRow).Value = ActiveCell &amp; \", Catering\"\n    End If\n\n</code></pre>\n\n<p>The problem I'm running into is that if multiple checkboxes are selected it only shows the \", *****\" of the last selected option. I.E. If there are Notes and Tubing &amp; Catering are selected I only end up getting the result for catering (\", Catering\"). I need all the data to show up in the same cell.</p>\n\n<p>Help?</p>\n"}, {"tags": ["vba", "ms-access", "runtime"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576701234, "post_id": 59399533, "comment_id": 104988338, "body": "Make sure all modules say <code>Option Explicit</code> at the very top, then select &quot;Compile VBAProject&quot; from the &quot;Debug&quot; menu. Does it complain? If not, congratulations, you&#39;re all set. Note that <code>appWord.Visible = True</code> is conditional to there being an error with the <code>Set appWord = CreateObject(...)</code> statement, which is going to be a problem (unhandled error 91). Presumably you want <code>appWord.Visible = True</code> to be unconditional?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576701322, "post_id": 59399533, "comment_id": 104988368, "body": "Also <code>Error.Clear</code> is weird, expecting <code>Err.Clear</code>, and even then, that would be no-op after an <code>On Error Resume Next</code> statement that&#39;s the first executable thing in the procedure."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12560395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539bd5e12894c842de65a549a4b340df?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/12560395/sarah"}, "edited": false, "score": 0, "creation_date": 1576739560, "post_id": 59399704, "comment_id": 104997835, "body": "first of all thanks for your response, I am a beginner in programming so maybe my questions don&#39;t smart,  I edit my code as you said. without writing &quot;exit sub&quot; and without uninstall office applications, I just convert to .accdr and everything work well. when I am trying to add Word library, it displays to me there is &quot;Error in loading DDL&quot; so I can&#39;t make change in refrence, also what you mean by &quot;Option Explicit&quot; I didn&#39;t creat any module"}, {"owner": {"reputation": 21, "user_id": 12560395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539bd5e12894c842de65a549a4b340df?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/12560395/sarah"}, "edited": false, "score": 0, "creation_date": 1576739709, "post_id": 59399704, "comment_id": 104997892, "body": "after &quot;if appword Is Nothing Then&quot; statement I wrote a message and when I test my application on the machine doesn&#39;t have office application the message appears. I will edit my post with new changes."}, {"owner": {"reputation": 21, "user_id": 12560395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539bd5e12894c842de65a549a4b340df?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/12560395/sarah"}, "edited": false, "score": 0, "creation_date": 1576743454, "post_id": 59399704, "comment_id": 104999306, "body": "I think you mean Form by &quot;module&quot; word. by default &quot;Option Compare Database&quot; written at the top of every form code. after this line, I wrote &quot;Option Explicit&quot;. is that OK? or should I delete the first line?"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1576701713, "creation_date": 1576701713, "answer_id": 59399704, "question_id": 59399533, "link": "https://stackoverflow.com/questions/59399533/convert-access-database-to-late-binding-to-work-with-access-runtime/59399704#59399704", "title": "Convert Access database to late binding to work with Access runtime", "body": "<blockquote>\n<pre><code>'Set appWord = CreateObject(\"word.application\")\nSet appWord = CreateObject(Word.Application)\nIf Err.Number &lt;&gt; 0 Then\n'Set appWord = New Word.Application\n'Set appWord = CreateObject(Word.Application)\nappWord.Visible = True\nEnd If\n</code></pre>\n</blockquote>\n\n<p>Several things are wrong with this code. <code>CreateObject</code> wants a ProgID string, and you're giving it <code>Word.Application</code>, which shouldn't even compile (expecting \"Object Required\" error on the <code>.Application</code> member call, and \"Variable not declared\"<sup>1</sup> on <code>Word</code>). If it compiles, you've referenced the Word object library and need to remove it. The commented-out statement is well-formed.</p>\n\n<p>Now <code>If Err.Number &lt;&gt; 0</code>, then <code>appWord</code> wasn't <code>Set</code>, and its reference is <code>Nothing</code>. That means if <code>CreateObject</code> fails, the code enters an error state <em>and remains in an error state for the remainder of the procedure</em>, because the error is never cleared, and error handling is never restored.</p>\n\n<p>Take the error stuff into its own limited scope:</p>\n\n<pre><code>Private Function GetWordApp() As Object\n    On Error Resume Next\n    Set GetWordApp = CreateObject(\"Word.Application\")\nEnd Function\n</code></pre>\n\n<p>Now your procedure only needs to check if the function returned a valid object reference:</p>\n\n<pre><code>Set appWord = GetWordApp\nIf appWord Is Nothing Then\n    'can't get ahold of Word.Application... now what?\n    Exit Sub\nEnd if\n\nappWord.Visible = True '&lt;~ unconditional\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> assuming <code>Option Explicit</code> is at the top of the module, as it should be.</p>\n"}], "owner": {"reputation": 21, "user_id": 12560395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/539bd5e12894c842de65a549a4b340df?s=128&d=identicon&r=PG&f=1", "display_name": "Sarah", "link": "https://stackoverflow.com/users/12560395/sarah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576739937, "creation_date": 1576700810, "last_edit_date": 1576739937, "question_id": 59399533, "link": "https://stackoverflow.com/questions/59399533/convert-access-database-to-late-binding-to-work-with-access-runtime", "title": "Convert Access database to late binding to work with Access runtime", "body": "<p>I wrote code in Access database 2016 contains functions and macros, then I move this file to share with some users that don't have Access Application so, I install Access runtime it works well but I face many problems with reference libraries. \nI decided to use late binding (by writing EarlyBinding = 0 in a database property of VBA editor)\nand uncheck all references except two (I can't uncheck) and covert  </p>\n\n<pre><code>Set appWord = New Word.Application\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Set appWord = CreateObject(Word.Application)\n</code></pre>\n\n<p>note 1: I have a function to open Word document from Access form. \nnote 2: I convert the database extension from .accdb to .accdr \nafter I made changes in late binding and convert the previous statement no message error (for reference) appears but the function of open Word doesn't work.\nis there a tool like Access runtime for Word? so I can't open for this reason?\nbelow the code of this function:</p>\n\n<pre><code>Function fillWordForm()\n\nDim appWord As Object\nDim doc As Object\nDim path As String\nDim myID As String\n\nOn Error Resume Next\nError.Clear\n\n'Set appWord = CreateObject(\"word.application\")\nSet appWord = CreateObject(Word.Application)\nIf Err.Number &lt;&gt; 0 Then\n'Set appWord = New Word.Application\n'Set appWord = CreateObject(Word.Application)\nappWord.Visible = True\nEnd If\n\n'path = Application.CurrentProject.path &amp; \"\\H_F.docx\"\n\n'path = \"\\\\ubcdatacenter\\Public\\UBCIEDatabase\\DOC\\H_F.docx\"\npath = \"C:\\Users\\LENOVO\\Desktop\\UBC Database\\H_F.docx\"\nIf FileExists(path) = False Then\nMsgBox \"Template File Not Found\", vbExclamation, \"File Not Found\"\nElse\nSet doc = appWord.Documents.Add(path, , True)\nmyID = DLookup(\"ID\", \"Exports_imports_Table\", \"[ID] = \" &amp; Me.ID)\nWith doc\n.FormFields(\"BookID\").Result = [ID]\n.FormFields(\"Book_BC_date\").Result = Me.date_BC\n.FormFields(\"Book_AH_date\").Result = Me.date_AH\n.FormFields(\"Book_AH_date\").Result = Me.date_AH\n.FormFields(\"BookTopic\").Result = Me.topic\n.FormFields(\"BookProjectName\").Result = Me.projectName\n.FormFields(\"BookCompanyName\").Result = Me.companyName\n.FormFields(\"BookContent\").Range.Text = Me.content\n\n'Result = Me.content\n\nappWord.Visible = True\nappWord.Active\nEnd With\nSet doc = Nothing\nSet appWord = Nothing\n\nEnd If\nEnd Function\n</code></pre>\n\n<p>this code to ensure that file is excite</p>\n\n<pre><code>Function FileExists(ByVal strFile As String, Optional bFindFolders As Boolean) As Boolean\n    'Purpose:   Return True if the file exists, even if it is hidden.\n    'Arguments: strFile: File name to look for. Current directory searched if no path included.\n    '           bFindFolders. If strFile is a folder, FileExists() returns False unless this argument is True.\n    'Note:      Does not look inside subdirectories for the file.\n    'Author:    Allen Browne. http://allenbrowne.com June, 2006.\n    Dim lngAttributes As Long\n\n    'Include read-only files, hidden files, system files.\n    lngAttributes = (vbReadOnly Or vbHidden Or vbSystem)\n\n    If bFindFolders Then\n        lngAttributes = (lngAttributes Or vbDirectory) 'Include folders as well.\n    Else\n        'Strip any trailing slash, so Dir does not look inside the folder.\n        Do While Right$(strFile, 1) = \"\\\"\n            strFile = Left$(strFile, Len(strFile) - 1)\n        Loop\n    End If\n\n    'If Dir() returns something, the file exists.\n    On Error Resume Next\n    FileExists = (Len(Dir(strFile, lngAttributes)) &gt; 0)\nEnd Function\n</code></pre>\n\n<p>what should also convert to make all code late binding?\n<strong>Editing</strong>\n<strong>after Mathieu's changes</strong></p>\n\n<p>Function fillWordForm()</p>\n\n<pre><code>Dim appWord As Object\nDim doc As Object\nDim path As String\nDim myID As String\n\nOn Error Resume Next\nError.Clear\n\nSet appWord = GetWordApp\nIf appWord Is Nothing Then\n    'can't get ahold of Word.Application... now what?\n    MsgBox \"No thing :((((((((((((((\"\n    'Exit Sub\nEnd If\n\nappWord.Visible = True '&lt;~ unconditional\n\n\n\n'Set appWord = CreateObject(\"word.application\")\n'Set appWord = CreateObject(Word.Application)\n'If Err.Number &lt;&gt; 0 Then\n'Set appWord = New Word.Application\n'Set appWord = CreateObject(Word.Application)\n'appWord.Visible = True\n'End If\n\n'path = Application.CurrentProject.path &amp; \"\\H_F.docx\"\n\npath = \"\\\\ubcdatacenter\\Public\\UBCIEDatabase\\DOC\\H_F.docx\"\n'path = \"C:\\Users\\LENOVO\\Desktop\\UBC Database\\H_F.docx\"\nIf FileExists(path) = False Then\nMsgBox \"Template File Not Found\", vbExclamation, \"File Not Found\"\nElse\nSet doc = appWord.Documents.Add(path, , True)\nmyID = DLookup(\"ID\", \"Exports_imports_Table\", \"[ID] = \" &amp; Me.ID)\nWith doc\n.FormFields(\"BookID\").Result = [ID]\n.FormFields(\"Book_BC_date\").Result = Me.date_BC\n.FormFields(\"Book_AH_date\").Result = Me.date_AH\n.FormFields(\"Book_AH_date\").Result = Me.date_AH\n.FormFields(\"BookTopic\").Result = Me.topic\n.FormFields(\"BookProjectName\").Result = Me.projectName\n.FormFields(\"BookCompanyName\").Result = Me.companyName\n.FormFields(\"BookContent\").Range.Text = Me.content\n\n'Result = Me.content\n\nappWord.Visible = True\nappWord.Active\nEnd With\nSet doc = Nothing\nSet appWord = Nothing\n\nEnd If\nEnd Function\n</code></pre>\n\n<hr>\n\n<pre><code>Private Function GetWordApp() As Object\n    On Error Resume Next\n    Set GetWordApp = CreateObject(\"Word.Application\")\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1576700949, "post_id": 59399459, "comment_id": 104988244, "body": "<code>Range(&quot;A2:A779&quot; &amp; Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row)</code> - if you have 779 rows this equates to <code>Range(&quot;A2:A779779&quot;)</code> Plus you are missing a sheet reference."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 2, "creation_date": 1576701745, "post_id": 59399459, "comment_id": 104988502, "body": "ColorIndex only goes to 56, once <code>colour</code> gets to 57 it will give runtime error 9. You will need to either reset it and reuse colors or use <code>rgb()</code>, though either way you are going to run out of colors different enough to tell at a glance."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 2, "creation_date": 1576704775, "post_id": 59399459, "comment_id": 104989614, "body": "Once you&#39;ve colour coded the duplicates, what is it you want to do with them? There may be another way to accomplish your final goal."}, {"owner": {"reputation": 1, "user_id": 12560804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExYwG.png?s=128&g=1", "display_name": "ItsDoubloon", "link": "https://stackoverflow.com/users/12560804/itsdoubloon"}, "edited": false, "score": 0, "creation_date": 1576789984, "post_id": 59399459, "comment_id": 105021193, "body": "I would eventually be adding the amounts owed for each duplicate package."}], "owner": {"reputation": 1, "user_id": 12560804, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExYwG.png?s=128&g=1", "display_name": "ItsDoubloon", "link": "https://stackoverflow.com/users/12560804/itsdoubloon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576700940, "creation_date": 1576700424, "last_edit_date": 1576700940, "question_id": 59399459, "link": "https://stackoverflow.com/questions/59399459/identifying-coloring-in-lists-of-duplicates-in-excel-vba", "title": "Identifying/Coloring-in Lists of Duplicates in Excel VBA", "body": "<p>Need some help with the below code. Currently trying to highlight duplicated tracking numbers with the same color, then move on to the next set and use a different color. It keeps getting an error (Error 9, subscript exceeded) or doesn't run. </p>\n\n<p>I have a LOT of tracking numbers that are duplicated, and I want to try to color each duplicate. Currently, when it does run it only goes to record # 107-109. I have 779 records with the possibility of more.</p>\n\n<p>Is there a better way to identify duplicates without Conditional Formatting? I don't want to key 800+ entries and Google keeps telling me that's the way to go.  </p>\n\n<p>IE </p>\n\n<pre><code>1Z*5952 Red\n1Z*5952 Red\n1Z*5961 Blue\n1Z*5961 Blue\n1Z*5970 Green\n1Z*5970 Green\n1Z*5989 etc\n</code></pre>\n\n<p>Asterisk is omitting sensitive data, tracking numbers are 13 characters in length. </p>\n\n<pre><code>Sub ColourDuplicates()\nDim Rng As Range\nDim Cel As Range\nDim Cel2 As Range\nDim Colour As Long\n\n\n\n\nSet Rng = Worksheets(\"Adj\").Range(\"A2:A779\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\nRng.Interior.ColorIndex = xlNone\nColour = 1\nFor Each Cel In Rng\n\n\nIf WorksheetFunction.CountIf(Rng, Cel) &gt; 1 And Cel.Interior.ColorIndex = xlNone Then\nSet Cel2 = Rng.Find(Cel.Value, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, SearchDirection:=xlNext)\n    If Not Cel2 Is Nothing Then\n        Firstaddress = Cel2.Address\n        Do\n        Cel.Interior.Color = Colour\n        Cel2.Interior.Color = Colour\n            Set Cel2 = Rng.FindNext(Cel2)\n\n        Loop While Firstaddress &lt;&gt; Cel2.Address\n    End If\n\n\n\n\nColour = Colour + 1\n\n\nEnd If\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1576699935, "post_id": 59399369, "comment_id": 104987847, "body": "Look into <code>For Loop VBA</code>"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 4, "creation_date": 1576699954, "post_id": 59399369, "comment_id": 104987861, "body": "^^^ And take the time to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">read this</a>"}, {"owner": {"reputation": 11, "user_id": 11678721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b5b4c23da9e30db3e5210449a73ee78?s=128&d=identicon&r=PG&f=1", "display_name": "CP22222", "link": "https://stackoverflow.com/users/11678721/cp22222"}, "edited": false, "score": 0, "creation_date": 1576701867, "post_id": 59399369, "comment_id": 104988543, "body": "Thanks for the quick responses. To elaborate I want to use the same macro and just have a range that can change based on the cell I originally click. For example if I have another worksheet that is the same format but the values change each day, I want to be able (each day) to copy those values and paste them into the correct row. Now my macro copies them and always pastes them to that one row 1359. I want to be able to paste the new data into 1360. Thanks!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576701960, "post_id": 59399369, "comment_id": 104988577, "body": "The cell you originally clicked will be <code>ActiveCell</code>, but only until you <code>.Activate</code> another sheet (or ...window.. why are you working with a window anyway?)"}], "owner": {"reputation": 11, "user_id": 11678721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b5b4c23da9e30db3e5210449a73ee78?s=128&d=identicon&r=PG&f=1", "display_name": "CP22222", "link": "https://stackoverflow.com/users/11678721/cp22222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576699889, "creation_date": 1576699889, "question_id": 59399369, "link": "https://stackoverflow.com/questions/59399369/how-to-use-the-same-macro-for-a-new-row", "title": "How to use the same macro for a new row", "body": "<p>How do I change the following code to use the same macro for the next row in my spreadsheet: i.e. range(\"C1360\") then \"C1361\" etc.</p>\n\n<pre><code>ActiveWindow.ActivateNext\nRange(\"C1359\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1576697230, "post_id": 59398819, "comment_id": 104986737, "body": "<code>Cells(N + 1, &quot;V&quot;).Formula = &quot;=SUM(V2:&quot; &amp; Cells(N, &quot;V&quot;).address &amp; &quot;)&quot;</code>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576697692, "post_id": 59398819, "comment_id": 104986929, "body": "Would you need a formula or its outcome?"}, {"owner": {"reputation": 1, "user_id": 12553273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55da3a37434b5d4e6dd6292c3ec98ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user12553273", "link": "https://stackoverflow.com/users/12553273/user12553273"}, "edited": false, "score": 0, "creation_date": 1576697706, "post_id": 59398819, "comment_id": 104986933, "body": "Thanks! that worked, what does the .address &amp; do to the equation?"}, {"owner": {"reputation": 1, "user_id": 12553273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55da3a37434b5d4e6dd6292c3ec98ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user12553273", "link": "https://stackoverflow.com/users/12553273/user12553273"}, "edited": false, "score": 0, "creation_date": 1576697763, "post_id": 59398819, "comment_id": 104986962, "body": "JvdV either or would work.  Thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1576697834, "post_id": 59398819, "comment_id": 104986992, "body": "Or <code>Cells(N + 1, &quot;V&quot;).Formula = &quot;=SUM(V2:V&quot; &amp; N &amp; &quot;)&quot;</code>. <code>Address</code> is the long way to the same result."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576697924, "post_id": 59398819, "comment_id": 104987022, "body": "@BigBen - yes, well if you want to make life simple..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576698166, "post_id": 59398819, "comment_id": 104987133, "body": "If you just need the sum result then you can do <code>.Value = Application.WorksheetFunction.Sum(Range(&quot;V2:V&quot; &amp; N))</code>"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576698237, "post_id": 59398819, "comment_id": 104987168, "body": "@user12553273 <code>.address</code> returns the address of the range, <code>&amp;</code> is the concatenation character. It combines strings together. Together they finish out the range used in <code>=SUM</code>"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 0, "last_activity_date": 1576698252, "creation_date": 1576698252, "answer_id": 59399074, "question_id": 59398819, "link": "https://stackoverflow.com/questions/59398819/easiest-way-to-sum-a-column/59399074#59399074", "title": "Easiest way to Sum a Column", "body": "<p>If you just need the <code>SUM</code> and not a formula that calculates it, then you can use <code>WorksheetFunction.Sum</code> here and assign to the cell's <code>Value</code>:</p>\n\n<pre><code>Cells(N + 1, \"V\").Value = Application.WorksheetFunction.Sum(Range(\"V2:V\" &amp; N))\n</code></pre>\n\n<p>Or you can assign to the cell's <code>Formula</code>:</p>\n\n<pre><code>Cells(N + 1, \"V\").Value = \"=SUM(V2:V\" &amp; N)\"\n</code></pre>\n\n<p>A <code>SUBTOTAL</code> formula might be more semantically accurate for your purpose though, depending on what else is on that sheet and how it's laid out:</p>\n\n<pre><code>Cells(N + 1, \"V\").Value = \"=SUBTOTAL(9,V2:V\" &amp; N)\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12553273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55da3a37434b5d4e6dd6292c3ec98ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user12553273", "link": "https://stackoverflow.com/users/12553273/user12553273"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576698252, "creation_date": 1576697014, "question_id": 59398819, "link": "https://stackoverflow.com/questions/59398819/easiest-way-to-sum-a-column", "title": "Easiest way to Sum a Column", "body": "<p>Every month I do a pull of 100k+ lines from SAP.  At the bottom of the sheet I create Totals and Subtotals.  Is it possible to create a sum function using the Cells and Rows.Count function or is there an easier way to do this?  This is my code so far</p>\n\n<pre><code>    N = Cells(Rows.Count, \"U\").End(xlUp).Row\n    Cells(N + 2, \"U\") = \"Total\"\n    Cells(N + 2, \"U\") = \"Negative Inventory\"\n    Cells(N + 2, \"U\") = \"Updated Total\"\n    Cells(N + 5, \"U\") = \"Prior Month Ending\"\n    Cells(N + 7, \"U\") = \"Difference\"\n    Cells(N + 1, \"V\").FormulaR1C1 = \"=SUM(Cells(2, \"V\"):Cells(N, \"V\"))\" (This is where I am stuck)\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "edited": false, "score": 4, "creation_date": 1576697174, "post_id": 59398802, "comment_id": 104986724, "body": "welcome to SO, in order to help you, you need to try at least some lines of code first because site focus it&#39;s not to make solutions from scratch. Post a try and we&#39;ll gladly help."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1576697768, "post_id": 59398802, "comment_id": 104986965, "body": "This can also be done with a formula"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576698573, "post_id": 59398802, "comment_id": 104987322, "body": "Excel is not a relational database engine. What happens to the related records when a row is deleted with its ID? Use Access, or SQL Server. Doing this in Excel is doomed."}, {"owner": {"reputation": 1, "user_id": 12560764, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mATDYMOgDjKQ6VLeoVLR2BBQWSqNfjHswzBxJt15Q=k-s128", "display_name": "Seingo", "link": "https://stackoverflow.com/users/12560764/seingo"}, "edited": false, "score": 0, "creation_date": 1576698776, "post_id": 59398802, "comment_id": 104987399, "body": "I have to do it on Excel because the data is located on an Excel sheet, but thanks for the tip, I will explore the opton :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576698777, "post_id": 59398802, "comment_id": 104987400, "body": "Start by copying the data and eliminating the duplicates in the copy (&quot;person A appears 3 times&quot; - make that 1), then assign each a unique numeric ID; go back to your with-dupes list, and lookup the ID based on whatever criteria you came up with (DoB+Name) to determine whether a &quot;person&quot; is actually unique."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1576699036, "post_id": 59398802, "comment_id": 104987512, "body": "<code>Id = Name &amp; &quot;_&quot; &amp; birthdate</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576700883, "post_id": 59398802, "comment_id": 104988218, "body": "@TimWilliams that&#39;s actually the single best way to do this. If the ID absolutely must be a numeric value, then computing a hash of this concatenation would work too."}], "owner": {"reputation": 1, "user_id": 12560764, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mATDYMOgDjKQ6VLeoVLR2BBQWSqNfjHswzBxJt15Q=k-s128", "display_name": "Seingo", "link": "https://stackoverflow.com/users/12560764/seingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576696916, "creation_date": 1576696916, "question_id": 59398802, "link": "https://stackoverflow.com/questions/59398802/vba-assigning-unique-ids-to-sheet-rows-based-on-several-criteria", "title": "VBA - Assigning Unique IDs to Sheet Rows Based on Several Criteria", "body": "<p>I'm currently trying to solve the following problem: </p>\n\n<p>I have an Excel Spreadsheet containing names and birthdates from several people. I would like to assign a unique ID to every unique person in a new column. (Person A gets 1, Person B gets 2...)\nGiving out an ID only based on birthdate would lead to people with the same date getting the same ID; same thing for names. </p>\n\n<p><strong>A person can appear more than once on the list.</strong></p>\n\n<p>So, I want to assign the ID based on both the name <strong>AND</strong> the birthdate to avoid confusion, and if person A appears 3 times for example, have the ID be the same every time.</p>\n\n<p>Does anyone know how to solve this using VBA code?</p>\n\n<p>I would very much appreciate any input. <strong>:)</strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1576696762, "post_id": 59398720, "comment_id": 104986548, "body": "<code>Set rg = Range(&quot;H1:H&quot; &amp; last_row  )</code>"}, {"owner": {"reputation": 1, "user_id": 9871127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rMUTt.jpg?s=128&g=1", "display_name": "Pablo Beitman", "link": "https://stackoverflow.com/users/9871127/pablo-beitman"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1576699936, "post_id": 59398720, "comment_id": 104987848, "body": "Hi Scott, I already changed it and it keeps showing me the error, do you know what else can I change?"}], "owner": {"reputation": 1, "user_id": 9871127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rMUTt.jpg?s=128&g=1", "display_name": "Pablo Beitman", "link": "https://stackoverflow.com/users/9871127/pablo-beitman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576703736, "creation_date": 1576696541, "last_edit_date": 1576703736, "question_id": 59398720, "link": "https://stackoverflow.com/questions/59398720/split-text-to-columns-error-vba-1004-erorr", "title": "Split text to columns error VBA 1004 erorr", "body": "<p>I want to split text to columns (column H) but it shows me an error, can someone help me solving it?</p>\n\n<pre><code>Sub Prueba():\n\n'Define all variables\n\nDim i As Double\n\nDim rg As Range\n\nDim strDataRange As Range\n\nDim keyRange_d As Range\n\nDim keyRange_z As Range\n\ni = 2\n\n'Define last row count\nlast_row = Cells(Rows.Count, 1).End(xlUp).Row\n\n'Insert columns and divide date and hour\n\n'Range(\"I:I\").Insert\nSet rg = Range(\"H1\").CurrentRegion\n\nrg.TextToColumns Destination:=Range(\"H1\"), DataType:=xlDelimited, Space:=True\n\n\n\n\nEnd Sub\n</code></pre>\n\n<p>\u2022\u2022\u2022\u2022\u02c7\u02c7\u02c7\u02c7</p>\n\n<p>Thanks</p>\n\n<p><a href=\"https://i.stack.imgur.com/dCidk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dCidk.png\" alt=\"Code\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/wnwoc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wnwoc.png\" alt=\"Error\"></a></p>\n"}, {"tags": ["excel", "xml", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576697399, "post_id": 59398142, "comment_id": 104986808, "body": "What&#39;s the result of that VBA code?"}, {"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576701489, "post_id": 59398142, "comment_id": 104988421, "body": "Hi @JSR. It shows me a popup saying the &quot;Value of val is found at at cell A2&quot; .. and in cell &quot;A7&quot;. I understand this code is correctly identifying the cell in which the parameter is placed, but it is not helping me in analysing the content of that cell (I could have more than one parameter and the relative value in one cell) and in extracting the value i&#39;m looking for. Would you have any suggestion on how to perform this task? Thank you"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1576701647, "post_id": 59398142, "comment_id": 104988474, "body": "Have you considered using Text to Columns with &quot;=&quot; as delimiter? It wouldn&#39;t get you all the way there but would get you part of the way. Or regular expressions. Or if the text entries are always the same length you could use formulas - MID, FIND etc."}, {"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576701879, "post_id": 59398142, "comment_id": 104988552, "body": "Imagine this as a long xml file (200,000+ rows), which i converted into a .txt file (because Mac does not offer the same XML parser capabilities as Windows). Text entries unfortunately won&#39;t be the same length, so I could try regular expression... even though I&#39;m very new to them.. would you have any suggestion on how to capture only the data between double quotes using regular expression?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1576702037, "post_id": 59398142, "comment_id": 104988599, "body": "How about using <code>Find</code> and looking for the double quotes?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1576702405, "post_id": 59398142, "comment_id": 104988744, "body": "When I put your text into an xml validator, it shows as not valid xml.  Does VBA for the MAC have the dictionary object and class objects?"}, {"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1576702629, "post_id": 59398142, "comment_id": 104988825, "body": "Hi @Ron Rosenfeld. Unfortunately not.. I had found an incredibly useful snippet here (<a href=\"https://excel-macro.tutorialhorizon.com/vba-excel-read-data-from-xml-file/\" rel=\"nofollow noreferrer\">excel-macro.tutorialhorizon.com/&hellip;</a>), but unfortunately VBA for MAC does not have the dictionary object and class objects (and it is also missing ActiveX). For this reason I switched to .txt, rather than using XML Parse functions"}, {"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "edited": false, "score": 0, "creation_date": 1576702872, "post_id": 59398142, "comment_id": 104988925, "body": "@JSR. I could give it a try, but my fear is the following. Given a string in one cell like this one  <code>&lt;PurchaseSegment DayDateTime=&quot;2020-02-29T06:45:00&quot; ArrivalDateTime=&quot;2020-02-29T09:40:00&quot; StopQuantity=&quot;0&quot; PurchaseNumber=&quot;229&quot; ElapsedTime=&quot;115&quot;&gt;</code> , will <code>Find</code> be able to run inside the string and select each parameter and value or will it stop at the first one only?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1576703280, "post_id": 59398142, "comment_id": 104989059, "body": "Does it have the Collection object?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576703480, "post_id": 59398142, "comment_id": 104989125, "body": "<code>&lt;SequenceNumber=&quot;1&quot;&gt;</code> this isn&#39;t valid...."}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "edited": false, "score": 0, "creation_date": 1576705444, "post_id": 59400279, "comment_id": 104989833, "body": "Thank you so much. I tried to use it, but when I run it, a popup comes up saying &quot;Run-time error &#39;9&#39;: Subscript out of range&quot;. What am I doing wrong?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "edited": false, "score": 0, "creation_date": 1576705574, "post_id": 59400279, "comment_id": 104989870, "body": "@user3926863 At what line did the macro stop when you saw that?"}, {"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "edited": false, "score": 0, "creation_date": 1576705975, "post_id": 59400279, "comment_id": 104990020, "body": "It stops here:   With WB    Set wsSrc = .Worksheets(&quot;Sheet4&quot;) &#39;or wherever the data exists"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "edited": false, "score": 0, "creation_date": 1576706009, "post_id": 59400279, "comment_id": 104990028, "body": "@user3926863 And does your data exist on <code>Sheet4</code>?  Do you have a <code>Sheet4</code> in your workbook?"}, {"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "edited": false, "score": 0, "creation_date": 1576706112, "post_id": 59400279, "comment_id": 104990063, "body": "I&#39;m sorry. I was over-excited by the code you wrote and noticed it only when I wrote it in the comments. I replaced Sheet4 with Sheet1 and it works!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "edited": false, "score": 0, "creation_date": 1576706377, "post_id": 59400279, "comment_id": 104990153, "body": "@user3926863 Good to hear!! Since my answer seems to be what you require, kindly mark it as Accepted.  See <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question</a>. If you have any other questions about how the code works, post back here and I&#39;ll try to explain."}, {"owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1576706588, "post_id": 59400279, "comment_id": 104990229, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/204509/discussion-between-user3926863-and-ron-rosenfeld\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1576704850, "creation_date": 1576704850, "answer_id": 59400279, "question_id": 59398142, "link": "https://stackoverflow.com/questions/59398142/find-and-extract-data-from-excel-sheet-and-paste-it-into-related-columns-using-v/59400279#59400279", "title": "Find and extract data from Excel sheet and paste it into related columns using VBA", "body": "<p>You can parse your text using VBA text functions.</p>\n\n<p>As I mentioned in my comments, what you posted is <strong>NOT</strong> a valid XML document.</p>\n\n<p>I adapted what I would have done using a Dictionary and Classes, to using a Collection and Array. (Although there is a Mac add-in to enable use of dictionary object).</p>\n\n<p>After pre-processing the text lines to make it easier to parse, we loop through all the text lines and store the appropriate items in defined locations in the array.</p>\n\n<p>We collect each row of item into the collection object, and then output them onto a worksheet.</p>\n\n<p>It works for the sample data you posted, but if your data is, in addition to being invalid xml, also has irregularities in the naming and formatting of the different nodes, you'll need a more sophisticated parsing method.</p>\n\n<pre><code>Option Explicit\nOption Compare Text\n\nSub splitSeq()\n    Dim cS As Collection\n    Dim WB As Workbook, wsSrc As Worksheet, wsRes As Worksheet\n    Dim rRes As Range\n    Dim vSrc As Variant, vRes As Variant\n\n    Dim I As Long, v, w, x\n\n'Set workbook, worksheet and range parameters\nSet WB = ThisWorkbook\nWith WB\n    Set wsSrc = .Worksheets(\"Sheet4\") 'or wherever the data exists\n\n    On Error Resume Next 'add a sheet if not present\n    Set wsRes = Worksheets(\"Results\")\n    Select Case Err.Number\n        Case 9 'need to add a sheet\n            Set wsRes = WB.Worksheets.Add\n            wsRes.Name = \"Results\"\n        Case Is &lt;&gt; 0 'Something else went wrong\n            MsgBox \"Error number \" &amp; Err.Number &amp; vbLf &amp; Err.Description\n        Err.Clear\n    End Select\nEnd With\n\n'set results range\nSet rRes = wsRes.Cells(1, 1)\n\n'read data into array for processing speed\n'assuming all data is in column A\nWith wsSrc\n    vSrc = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\nEnd With\n\n'loop through data and save the Sequence objects\n'Each starts with &lt;sequence and ends with &lt;/sequence\n\nSet cS = New Collection\n\nFor I = 1 To UBound(vSrc, 1)\n    If vSrc(I, 1) Like \"&lt;Sequence*\" Then\n        ReDim vRes(1 To 8) 're-initialize array\n    Else\n            'Remove confusing spaces in node names and &lt;&gt; in attributes\n                vSrc(I, 1) = Replace(vSrc(I, 1), \"Segment DayDate\", \"SegmentDayDate\")\n                vSrc(I, 1) = Replace(vSrc(I, 1), \"Pos Location\", \"PosLocation\")\n                vSrc(I, 1) = Replace(vSrc(I, 1), \"&lt;\", \"\")\n                vSrc(I, 1) = Replace(vSrc(I, 1), \"&gt;\"\"\", \"\")\n                vSrc(I, 1) = Replace(vSrc(I, 1), \"&gt;\", \"\")\n\n            v = Split(vSrc(I, 1))\n            For Each w In v\n                x = Split(w, \"=\")\n\n                'Remove leading and trailing double quotes\n                    If Left(x(1), 1) = \"\"\"\" And Right(x(1), 1) = \"\"\"\" Then\n                        x(1) = Mid(x(1), 2)\n                        x(1) = Left(x(1), Len(x(1)) - 1)\n                    End If\n\n                Select Case x(0)\n                    Case \"PurchaseSegmentDayDateTime\"\n                        vRes(1) = x(1)\n                    Case \"ArrivalDateTime\"\n                        vRes(2) = x(1)\n                    Case \"StopQuantity\"\n                        vRes(3) = x(1)\n                    Case \"PurchaseNumber\"\n                        vRes(4) = x(1)\n                    Case \"ElapsedTime\"\n                        vRes(5) = x(1)\n                    Case \"DayPosLocationCode\"\n                        vRes(6) = x(1)\n                    Case \"ArrivalPosLocationCode\"\n                        vRes(8) = x(1)\n                    Case \"DockID\"\n                        vRes(7) = x(1)\n                    Case \"/SequenceNumber\"\n                        cS.Add vRes\n                End Select\n            Next w\n        End If\n    Next I\n\n'set up results array\nReDim vRes(0 To cS.Count, 1 To 8)\n\n'Headers\n    vRes(0, 1) = \"PurchaseSegment DayDateTime\"\n    vRes(0, 2) = \"ArrivalDateTime\"\n    vRes(0, 3) = \"StopQuantity\"\n    vRes(0, 4) = \"PurchaseNumber\"\n    vRes(0, 5) = \"ElapsedTime\"\n    vRes(0, 6) = \"DayPoS LocationCode\"\n    vRes(0, 7) = \"DockID\"\n    vRes(0, 8) = \"ArrivalPoS LocationCode\"\n\n'fill in the data\nI = 0\nFor Each v In cS\n    I = I + 1\n    With v\n        vRes(I, 1) = v(1)\n        vRes(I, 2) = v(2)\n        vRes(I, 3) = v(3)\n        vRes(I, 4) = v(4)\n        vRes(I, 5) = v(5)\n        vRes(I, 6) = v(6)\n        vRes(I, 7) = v(7)\n        vRes(I, 8) = v(8)\n    End With\nNext v\n\n'Set Results range\nSet rRes = rRes.Resize(UBound(vRes, 1) + 1, UBound(vRes, 2))\n\n'Write and format results\nWith rRes\n    .EntireColumn.Clear\n    .Value2 = vRes\n    .Style = \"Output\"\n    .EntireColumn.AutoFit\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 3926863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d91229b8ea17b4fd9a766555eeab2cb?s=128&d=identicon&r=PG&f=1", "display_name": "user3926863", "link": "https://stackoverflow.com/users/3926863/user3926863"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 59400279, "answer_count": 1, "score": -1, "last_activity_date": 1576704850, "creation_date": 1576693752, "question_id": 59398142, "link": "https://stackoverflow.com/questions/59398142/find-and-extract-data-from-excel-sheet-and-paste-it-into-related-columns-using-v", "title": "Find and extract data from Excel sheet and paste it into related columns using VBA", "body": "<p>I have the following objective: </p>\n\n<ol>\n<li>Loop through a huge excel sheet (200,000+ rows) </li>\n<li>Find some data based on matching parameters  (the original file is an xml file, so structured data... but I am using a Mac, where the XML parser is not supported) </li>\n<li>Copy the data between double quote related to each variable </li>\n<li>Paste the value in the relative column</li>\n</ol>\n\n<p>Additional constraints I have to face: </p>\n\n<ul>\n<li>Every value to copy is between double quotes (this is \"good news\", helping me to identify the right data to copy and paste)</li>\n<li>Imagine the txt. data as a list of data objects (=> it's sequence of purchases, with related info, made by customers). The macro should be able to loop through the list and copy paste the data, starting a new row every time a new ID purchase comes up. Good news is that every purchase is marked by a unique ID.</li>\n</ul>\n\n<p>I\u2019m providing below an example of input and output. I would really be grateful if someone could help me on this.</p>\n\n<pre><code>//INPUT\n\n&lt;SequenceNumber=\"1\"&gt;\n &lt;PurchaseSegment DayDateTime=\"2020-02-29T06:45:00\" ArrivalDateTime=\"2020-02-29T09:40:00\" StopQuantity=\"0\" PurchaseNumber=\"229\" ElapsedTime=\"115\"&gt;\"\n &lt;DayPoS LocationCode=\"AAA\" DockID=\"4\" /&gt;\"                                 \n &lt;ArrivalPoS LocationCode=\"CCC\" /&gt;\"\n&lt;/SequenceNumber&gt;\n\n&lt;SequenceNumber=\"2\"&gt;\n &lt;PurchaseSegment DayDateTime=\"2019-09-28T06:41:00\" ArrivalDateTime=\"2020-02-29T09:40:00\" StopQuantity=\"1\" PurchaseNumber=\"123\" ElapsedTime=\"115\"&gt;\"\n &lt;DayPoS LocationCode=\"AAA\" DockID=\"3\" /&gt;\"\n &lt;ArrivalPoS LocationCode=\"QQC\" /&gt;\"\n&lt;/SequenceNumber&gt;\n\n</code></pre>\n\n<p>//EXPECTED OUTPUT (by running the VBA macro)\n<a href=\"https://i.stack.imgur.com/0gsXg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0gsXg.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here you can find also my VBA attempt, I leveraged some VBA code I already found, but didn't succeed. </p>\n\n<pre><code>Public Sub TextDataToColumn() \nDim val As Variant val = \"PurchaseSegment DayDateTime\" // it would be great to have a list of paramaters here...\nSet c = Cells.Find(val, LookIn:=xlValues, MatchCase:=False) \nIf Not c Is Nothing Then \nDo \nMsgBox \"Value of val is found at \" &amp; c.Address &amp; vbCrLf &amp; c.Offset(0, 1).Value &amp; vbCrLf &amp; c.Offset(0, 2).Value \n Set c = Cells.FindNext(c) \n Loop While Not c Is Nothing And c.Address &lt;&gt; firstaddress \n End If \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1576693362, "post_id": 59398021, "comment_id": 104985156, "body": "Where is <code>PivotTable</code> defined? Add <code>Option Explicit</code> to the top of the module."}, {"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576693736, "post_id": 59398021, "comment_id": 104985307, "body": "Yes it is true. It tried it already but did not work."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576693837, "post_id": 59398021, "comment_id": 104985357, "body": "What did you try, because you seem to be using <code>pvt</code> everywhere else."}, {"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576693981, "post_id": 59398021, "comment_id": 104985412, "body": "I tried to add option explicit at the top of the module and in the function part I also did add the Dim pvt As PivotTable What I did not understand is that sometime I got the error 91 on the line :    ```` If pvt.PivotCache.SourceType = xlDatabase Then````"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576696579, "post_id": 59398021, "comment_id": 104986474, "body": "Error 91 means you&#39;re trying to make a member call against an object reference that&#39;s <code>Nothing</code>. Verify whether <code>Not pvt Is Nothing</code> before you invoke its <code>.PivotCache</code> property, and verify that the returned <code>PivotCache</code> object isn&#39;t <code>Nothing</code> either, before you invoke its <code>SourceType</code> property."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576702313, "post_id": 59398021, "comment_id": 104988708, "body": "FWIW <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> is finding 22 code quality issues in your code, including <code>Option Explicit</code> missing, <code>sFilter</code>, <code>sDataField</code>, ...and <code>PivotTable</code> being undeclared, <code>PivotTable</code> being used without being assigned, <code>Range.Find</code> results being used without being first checked for <code>Nothing</code>, and the <code>Err_Handler</code> label being unreferenced. Fixing these would fix your code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576702820, "post_id": 59398021, "comment_id": 104988905, "body": "*21, not 22. &quot;assignment not used&quot; inspection is issuing a false positive for the 1st <code>sFormulaPage</code> assignment (that&#39;s a known issue, it&#39;s not walking the syntax tree correctly here)."}, {"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 0, "creation_date": 1576750414, "post_id": 59398021, "comment_id": 105002719, "body": "Wow! Thanks a lot this is Christmas before time! Thanks to you, the code is running for pivot table based on a table as data source range but not on pivot table which using  cell ref range as data source.  This means the error is coming from ``` Set rSource = Application.Evaluate(Application.ConvertFormula(ActiveCell.P&zwnj;&#8203;ivotTable.SourceData&zwnj;&#8203;, fromReferenceStyle:=xlR1C1, toReferenceStyle:=xlA1))````  I have the error 424 again on that line  I have updated the first post with the up to date code"}, {"owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "edited": false, "score": 0, "creation_date": 1576776817, "post_id": 59398021, "comment_id": 105016306, "body": "Ok is did a stop at each part of the macro and the fact is on my vba editor, the application.convertFormula does not translate the R1C1 style to A1 which is the reason of the error. Perhaps a manual translation would work!"}], "owner": {"reputation": 41, "user_id": 11988887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB3ZLtMLxQM4CVhys_AW1ZiWxHw7vuO-wewCl4cVw=k-s128", "display_name": "Naxos", "link": "https://stackoverflow.com/users/11988887/naxos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576750460, "creation_date": 1576693232, "last_edit_date": 1576750460, "question_id": 59398021, "link": "https://stackoverflow.com/questions/59398021/convert-pivot-table-to-sumif-function-error-424-excel-vba", "title": "Convert pivot table to sumif function - Error 424 - Excel VBA", "body": "<p>I would like to convert a Pivot Table to a sum if statement using a VBA macro. \nI found one which used to work on Excel 2016 (<a href=\"https://www.excelcampus.com/vba/convert-pivot-table-to-sumifs-formulas-vba-macro/\" rel=\"nofollow noreferrer\">https://www.excelcampus.com/vba/convert-pivot-table-to-sumifs-formulas-vba-macro/</a>) since I went to 0365, the macro is not working. </p>\n\n<p>I tried to fix the code myself but got stuck on the line </p>\n\n<pre><code>                Set rSource = Application.Evaluate(Application.ConvertFormula(PivotTable.SourceData, xlR1C1, xlA1))\n</code></pre>\n\n<p>which led to a #424 error object needed. </p>\n\n<p>Any ideas would be gratefully accepted!</p>\n\n<p>The whole code is the following`and the error seems to come from the function part:</p>\n\n<pre><code>Option Explicit\nDim pvt As PivotTable\nDim rSource As Range\nDim wsSource As Worksheet\nDim bTable As Boolean\nDim pi As PivotItem\nDim pc As PivotCell\nDim pf As PivotField\nDim wsNew As Worksheet\nDim wsPivot As Worksheet\nDim c As Range\nDim lFunction As Long\nDim sSumRange As String\nDim sCritRange As String\nDim sCriteria As String\nDim sFormula As String\nDim sFormulaPage As String\nDim sSearchField As String\nDim sDataSheet As String\nDim lDataRows As Long\nDim sPageRange As String\nDim lCol As Long\nDim bArray As Boolean\nDim sTableName As String\nDim sFormulaArgs As String\nDim sFormulaCnt As String\nDim lLblRow As Long\nDim lLblCol As Long\nDim sFilter As String\nDim sDataField As String\nDim bReturn As Boolean\n\nSub Convert_Pivot_to_Formulas()\n'---------------------------------------------------------------------------------------\n' Procedure : Convert_Pivot_to_Formulas\n' Author    : Jon Acampora, Excel Campus LLC, www.excelcampus.com\n' Date      : 10/13/2014\n' Purpose   : Creates a copy of the selected pivot table on a new sheet and converts\n'               all cells in the values area to SUMIFS, COUNTIFS, or AVERAGEIFS formulas\n' Details   : The following is a list of features, requirement, and limitations of the macro.\n'             Features\n'               - Works with page fields with multiple items in filter of one page field.\n'                   Creates the page field criteria across columns and creates array formulas.\n'             Requirements\n'               - Fields in the pivot containing dates must be in the same format as the source data.\n'               - Source data must be in same workbook.  This can be expaned to ref source data in other workbooks.\n'             Limitations\n'               - Does not work with grouped date fields.  The criteria ranges do NOT exist in the source data.\n'                   Create the date group fields as columns in the source data to solve this issue.\n'---------------------------------------------------------------------------------------\n\n    'Set pivot table variables\n    On Error Resume Next\n    Set pvt = ActiveCell.PivotTable\n    Set wsPivot = ActiveSheet\n    On Error GoTo 0\n\n    If pvt Is Nothing Then\n        MsgBox \"Please select a Pivot Table first.\", vbOKOnly, \"Convert Pivot to Formula Error\"\n        Exit Sub\n    End If\n\n    'Check if source data is in the same workbook.\n    If Get_Pivot_Source Then\n\n        On Error GoTo Err_Handle\n\n'-------------------------------------------------------\n'1. Create new sheet with shell of pivot table - filter, rows, columns areas\n'-------------------------------------------------------\n        Set wsNew = Worksheets.Add(after:=ActiveSheet)\n        sDataSheet = wsSource.Name\n        lDataRows = rSource.Rows.Count\n        If bTable Then sTableName = pvt.SourceData\n\n        'Copy pivot table values to new sheet\n        wsPivot.Select\n        wsPivot.Range(pvt.TableRange1.Address).Copy\n        With wsNew.Range(pvt.TableRange1.Address)\n            .PasteSpecial Paste:=xlPasteValues\n            .PasteSpecial Paste:=xlPasteFormats\n            .PasteSpecial Paste:=xlPasteColumnWidths\n        End With\n\n        If pvt.PageFields.Count &gt; 0 Then\n            wsPivot.Range(pvt.PageRange.Address).Copy\n            With wsNew.Range(pvt.PageRange.Address)\n                .PasteSpecial Paste:=xlPasteValues\n                .PasteSpecial Paste:=xlPasteFormats\n                .PasteSpecial Paste:=xlPasteColumnWidths\n            End With\n        End If\n\n'-------------------------------------------------------\n'2. Add page field filters across columns in new sheet\n'-------------------------------------------------------\n        If pvt.PageFields.Count &gt; 0 Then\n            For Each pf In pvt.PageFields\n                sPageRange = pf.LabelRange.Offset(, 1).Resize(1, 1).Address\n                sFilter = pf.LabelRange.Offset(, 1).Resize(1, 1).Value\n                lCol = 0 'offset 1 col to the right\n                Select Case sFilter\n                    Case \"(All)\"\n                        'skip\n                    Case \"(Multiple Items)\"\n                        'Loop pivot items and add selected items to page range across columns\n                        For Each pi In pf.PivotItems\n                            If pi.Visible Then\n                                wsNew.Range(sPageRange).Offset(, lCol).Resize(1, 1).Value = pi.Name\n                                lCol = lCol + 1\n                            End If\n                        Next pi\n                    Case Else 'One item selected\n                        lCol = 1\n                        wsPivot.Range(sPageRange).Offset(, lCol).Resize(1, 1).Value = wsNew.Range(sPageRange).Offset(, lCol).Resize(1, 1).Value\n                End Select\n\n                'Create string for formula\n                If lCol &gt; 0 Then 'filters exist\n                    If bTable Then\n                        sCritRange = sTableName &amp; \"[\" &amp; pf.Name &amp; \"]\"\n                    Else\n                        sSearchField = pf.Name\n                        sCritRange = \"'\" &amp; sDataSheet &amp; \"'!\" &amp; rSource.Resize(1).Find(What:=sSearchField, LookAt:=xlWhole).Offset(1).Resize(lDataRows - 1, 1).Address\n                    End If\n\n                    sCriteria = wsNew.Range(sPageRange).Resize(1, lCol).Address\n\n                    sFormulaPage = sFormulaPage &amp; \",\" &amp; sCritRange\n                    sFormulaPage = sFormulaPage &amp; \",\" &amp; sCriteria\n                End If\n\n                'IFS formula will have to be an array if there are multiple critera (range) in criteria argument\n                If lCol &gt; 1 Then bArray = True\n\n            Next pf\n        End If\n\n'-------------------------------------------------------\n'3. Loop through each cell in values area to build formula.\n'-------------------------------------------------------\n        For Each c In pvt.DataBodyRange.Cells\n\n            Set pc = c.PivotCell\n            sFormula = \"\"\n            sFormulaArgs = \"\"\n\n'-------------------------------------------------------\n'4. Create SUM RANGE reference for formula\n'-------------------------------------------------------\n            'Check if function is sum, count, or average\n            If pc.PivotField.Function = xlSum Or pc.PivotField.Function = xlCount Or pc.PivotField.Function = xlAverage Then\n                'Count the criteria, if 0 then it's a total and no IFS needed\n                sCriteria = \"\"\n\n                'Add column items to filter array\n                If pc.PivotCellType = xlPivotCellValue Then\n\n                    sDataField = pc.PivotField.SourceName\n                    lFunction = pc.PivotField.Function\n\n                    'Add Sum Range\n                    lFunction = pc.PivotField.Function\n\n                    If bTable Then\n                        sSumRange = sTableName &amp; \"[\" &amp; pc.PivotField.SourceName &amp; \"]\"\n                    Else\n                        sSearchField = pc.PivotField.SourceName\n                        sSumRange = \"'\" &amp; sDataSheet &amp; \"'!\" &amp; rSource.Resize(1).Find(What:=sSearchField, LookAt:=xlWhole).Offset(1).Resize(lDataRows - 1, 1).Address\n                    End If\n\n'-------------------------------------------------------\n'5. Loop through ROW items of pivotcell and add row refs to formula\n'-------------------------------------------------------\n                    If pc.RowItems.Count Then\n                        For Each pi In pc.RowItems\n                            If bTable Then\n                                sCritRange = sTableName &amp; \"[\" &amp; pi.Parent.Name &amp; \"]\"\n                            Else\n                                sSearchField = pi.Parent.Name\n                                sCritRange = \"'\" &amp; sDataSheet &amp; \"'!\" &amp; rSource.Resize(1).Find(What:=sSearchField, LookAt:=xlWhole).Offset(1).Resize(lDataRows - 1, 1).Address\n                            End If\n\n                            'Find the address of the pivotcells labelrange for the criteria address\n                            'Start from the current row and loop up through the label range until the\n                            'pivotitem name is found. Required due to variety of pivot table layouts.\n                            lLblCol = pi.LabelRange.Column\n                            For lLblRow = c.Row To pi.Parent.LabelRange.Row + 1 Step -1\n                                If Cells(lLblRow, lLblCol).Value = pi.Name Then\n                                    sCriteria = Cells(lLblRow, pi.LabelRange.Column).Address\n                                    Exit For\n                                End If\n                            Next lLblRow\n\n                            If sCriteria &lt;&gt; \"\" Then\n                                sFormulaArgs = sFormulaArgs &amp; \",\" &amp; sCritRange\n                                sFormulaArgs = sFormulaArgs &amp; \",\" &amp; sCriteria\n                            End If\n\n                            sCriteria = \"\"\n\n                        Next pi\n                    End If\n\n'-------------------------------------------------------\n'6. Loop through COLUMN items of pivotcell and add row refs to formula\n'-------------------------------------------------------\n                    If pc.ColumnItems.Count Then\n                        For Each pi In pc.ColumnItems\n                            If bTable Then\n                                sCritRange = sTableName &amp; \"[\" &amp; pi.Parent.Name &amp; \"]\"\n                            Else\n                                sSearchField = pi.Parent.Name\n                                sCritRange = \"'\" &amp; sDataSheet &amp; \"'!\" &amp; rSource.Resize(1).Find(What:=sSearchField, LookAt:=xlWhole).Offset(1).Resize(lDataRows - 1, 1).Address\n'                                If sCritRange Is Nothing Then\n'                                On Error GoTo 0\n'                                Else\n'                            End If\n                            End If\n\n                            'Find the address of the pivotcells labelrange for the criteria address\n                            'Start from the current column and loop back left through the label range until the\n                            'pivotitem name is found. Required due to variety of pivot table layouts.\n                            lLblRow = pi.LabelRange.Row\n                            For lLblCol = c.Column To pi.LabelRange.Column Step -1\n                                If Cells(lLblRow, lLblCol).Value = pi.Name Then\n                                    sCriteria = Cells(pi.LabelRange.Row, lLblCol).Address\n                                    Exit For\n                                End If\n                            Next lLblCol\n\n                            If sCriteria &lt;&gt; \"\" Then\n                                sFormulaArgs = sFormulaArgs &amp; \",\" &amp; sCritRange\n                                sFormulaArgs = sFormulaArgs &amp; \",\" &amp; sCriteria\n                            End If\n\n                            sCriteria = \"\"\n                        Next pi\n                    End If\n\n'-------------------------------------------------------\n'7. Build Formula based on function type of pivotcell\n'-------------------------------------------------------\n                    Select Case pc.PivotField.Function\n                        Case xlSum\n                            If sFormulaArgs = \"\" And sFormulaPage = \"\" Then 'Don't need IFS when there are no criteria (total rows/columns)\n                                sFormula = \"=SUM(\" &amp; sSumRange &amp; \")\"\n                            Else\n                                If bArray Then\n                                    sFormula = \"=SUM(SUMIFS(\" &amp; sSumRange &amp; sFormulaPage &amp; sFormulaArgs &amp; \"))\"\n                                Else\n                                    sFormula = \"=SUMIFS(\" &amp; sSumRange &amp; sFormulaPage &amp; sFormulaArgs &amp; \")\"\n                                End If\n                            End If\n\n                        Case xlCount\n                            If sFormulaArgs = \"\" And sFormulaPage = \"\" Then 'Don't need IFS when there are no criteria (total rows/columns)\n                                sFormula = \"=COUNT(\" &amp; sSumRange &amp; \")\"\n                            Else\n                                sFormulaCnt = sFormulaPage &amp; sFormulaArgs 'Don't need sum range for countifs\n                                sFormulaCnt = Right(sFormulaCnt, Len(sFormulaCnt) - 1) 'trim preceding comma\n\n                                If bArray Then\n                                    sFormula = \"=SUM(COUNTIFS(\" &amp; sFormulaCnt &amp; \"))\"\n                                Else\n                                    sFormula = \"=COUNTIFS(\" &amp; sFormulaCnt &amp; \")\"\n                                End If\n                            End If\n\n                        Case xlAverage\n                            If sFormulaArgs = \"\" And sFormulaPage = \"\" Then 'Don't need IFS when there are no criteria (total rows/columns)\n                                sFormula = \"=AVERAGE(\" &amp; sSumRange &amp; \")\"\n                            Else\n                                sFormula = \"=AVERAGEIFS(\" &amp; sSumRange &amp; sFormulaPage &amp; sFormulaArgs &amp; \")\" 'AVERAGEIFS not working with array formula, returns errors\n                            End If\n\n                    End Select\n\n'-------------------------------------------------------\n'8. Add formula to new sheet\n'-------------------------------------------------------\n                    If bArray Then\n                        If Len(sFormula) &lt; 255 Then\n                            wsNew.Range(c.Address).FormulaArray = sFormula\n                        Else\n                            '.FormulaArray hits an error if formula string is &gt; 255 characters\n                            'Add error handling here\n                        End If\n                    Else\n                        wsNew.Range(c.Address).Formula = sFormula\n                    End If\n\n                End If\n            End If\n        Next c\n\n    End If\n\n    wsNew.Select\n\n    Exit Sub\n\nErr_Handle:\n    MsgBox Err.Description &amp; vbNewLine &amp; \"Current Cell: \" &amp; c.Address, _\n            vbCritical, \"Convert Pivot to Formulas Error\"\n\nEnd Sub\nFunction Get_Pivot_Source() As Boolean\n'Determine if source is a cell reference, named range, or Excel Table\n'Set source range variables\n\n'Consider using the PivotCache.SourceType property to check this.\n'http://msdn.microsoft.com/en-us/library/office/ff194557.aspx\n\n    'On Error GoTo Err_Handler\n\n    'Set variables for selected pivot table\n    bReturn = False\n    Set rSource = Nothing\n    Set wsSource = Nothing\n    Set pvt = ActiveCell.PivotTable\n    Set wsPivot = ActiveSheet\n    bTable = False\n\n    If ActiveCell.PivotTable.PivotCache.SourceType = xlDatabase Then\n        If InStr(ActiveCell.PivotTable.SourceData, \"[\") = 0 Then 'check if source data contains workbook name - bypass external source range - Temp TO DO\n            If InStr(ActiveCell.PivotTable.SourceData, \":\") &gt; 0 Then 'if data source range is a cell ref range\n                Set rSource = Application.Evaluate(Application.ConvertFormula(ActiveCell.PivotTable.SourceData, fromReferenceStyle:=xlR1C1, toReferenceStyle:=xlA1))\n            Else 'if Table or Named Range are used as data source range\n                Set rSource = Range(pvt.SourceData)\n                On Error GoTo SkipTable 'check if the data source name is a table\n                Set rSource = Range(pvt.SourceData &amp; \"[#All]\")\n                bTable = True\nSkipTable:\n                On Error GoTo 0\n            End If\n            Set wsSource = rSource.Parent\n            bReturn = True\n        End If\n    End If\n\n    Get_Pivot_Source = bReturn\n\n    Exit Function\n\nErr_Handler:\n\n    MsgBox \"Error in Get_Source_Range procedure.\"\n    Get_Pivot_Source = False\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576693105, "post_id": 59397965, "comment_id": 104985038, "body": "Is this  label a Form Control label, an ActiveX label, or a regular textbox (shape)?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576693137, "post_id": 59397965, "comment_id": 104985050, "body": "This may help <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/09e31365-2997-48ff-9e98-b01468ed805c/powershell-and-excels-form-controls?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1576694239, "post_id": 59397965, "comment_id": 104985534, "body": "So, you know how to handle the value stored in a cell, but you cannot handle the one stored in a label. Where this label is situated? On the page (Form or ActiveX control) or on a form? Please share the code dealing with the cell value, clarify the issue regarding the label type and maybe we can better help you adapting it according to the described need."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 2, "creation_date": 1576694749, "post_id": 59397965, "comment_id": 104985755, "body": "Do they really do not want VBA code changed? What&#39;s stopping you from making a new VBA module that provides the desired functionality and invoking it instead?"}, {"owner": {"reputation": 115, "user_id": 9841629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ae0e48eb00468feeabb0d134135bc3?s=128&d=identicon&r=PG&f=1", "display_name": "JR_M", "link": "https://stackoverflow.com/users/9841629/jr-m"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576696682, "post_id": 59397965, "comment_id": 104986515, "body": "@BigBen I have updated my question. It is a Form Control label."}, {"owner": {"reputation": 115, "user_id": 9841629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ae0e48eb00468feeabb0d134135bc3?s=128&d=identicon&r=PG&f=1", "display_name": "JR_M", "link": "https://stackoverflow.com/users/9841629/jr-m"}, "reply_to_user": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1576696956, "post_id": 59397965, "comment_id": 104986626, "body": "@FaneDuru I have updated my question, It is a Form Control label that exists on the sheet."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 2, "creation_date": 1576697080, "post_id": 59397965, "comment_id": 104986689, "body": "if ``$wB` would be the workbook object and the label is a shape of the worksheet &quot;testSheet&quot; you can try this in order to obtain the label value: <code>$wB.Worksheets.item(&quot;testSheet&quot;).Shapes.item(&quot;lblTest&quot;).Olef&zwnj;&#8203;ormat.Object.Object.&zwnj;&#8203;Caption</code>."}, {"owner": {"reputation": 115, "user_id": 9841629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ae0e48eb00468feeabb0d134135bc3?s=128&d=identicon&r=PG&f=1", "display_name": "JR_M", "link": "https://stackoverflow.com/users/9841629/jr-m"}, "reply_to_user": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1576698312, "post_id": 59397965, "comment_id": 104987203, "body": "@FaneDuru That worked perfectly. If you want to turn your comment into an answer then I&#39;ll mark it as the answer. Thank you for your help!"}], "answers": [{"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 2, "last_activity_date": 1576698683, "creation_date": 1576698683, "answer_id": 59399137, "question_id": 59397965, "link": "https://stackoverflow.com/questions/59397965/how-do-you-modify-excel-vba-labels-using-powershell/59399137#59399137", "title": "How do you modify Excel VBA labels using Powershell", "body": "<p>If <code>$wB</code> would be the workbook object and the label <code>\"lblTest\"</code> is a Form Control shape of the worksheet <code>\"testSheet\"</code> you can try this in order to obtain the label value: </p>\n\n<p><code>$wB.Worksheets.item(\"testSheet\").Shapes.item(\"lblTest\").Oleformat.Object.Object.Caption</code></p>\n"}], "owner": {"reputation": 115, "user_id": 9841629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52ae0e48eb00468feeabb0d134135bc3?s=128&d=identicon&r=PG&f=1", "display_name": "JR_M", "link": "https://stackoverflow.com/users/9841629/jr-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "accepted_answer_id": 59399137, "answer_count": 1, "score": -1, "last_activity_date": 1576698683, "creation_date": 1576692999, "last_edit_date": 1576697056, "question_id": 59397965, "link": "https://stackoverflow.com/questions/59397965/how-do-you-modify-excel-vba-labels-using-powershell", "title": "How do you modify Excel VBA labels using Powershell", "body": "<p>I'm working on automating a process with powershell for someone that is currently using an Excel sheet that utilizes macros and <strong>form control</strong> objects. I have the process mostly automated so far, but the sheet has a spot where the user has to click a button on the sheet which brings up a folder selection window where they select a folder for output files. The selection gets stored to a <strong>form control label</strong> object rather than in a cell. A macro then runs using the value stored in that label. I have been unable to track down any information on how I can modify the value for that label object through powershell.</p>\n\n<p>Here is the VBA code that assigns the value to the label:</p>\n\n<pre><code>Private Sub SelectFolderButton_Click()\n'Selects the folder (directory) for output files\nDim fd As FileDialog\n\n  Set fd = Application.FileDialog(msoFileDialogFolderPicker)\n  With fd\n    If (-1 = .Show) Then FolderLabel.Caption = .SelectedItems(1)\n  End With\n\nEnd Sub\n</code></pre>\n\n<p>Unfortunately the user doesn't want the vba code to be changed. So I can't modify it to store the value in a cell and then have the macro use the cell instead, which would make this a lot easier.</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "xmlhttprequest"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576698253, "post_id": 59397913, "comment_id": 104987175, "body": "The click won&#39;t do anything with xmlhttp. What is the final result you are after? Do you wish to get the results for a particular store/stores?"}, {"owner": {"reputation": 43, "user_id": 12460530, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ZgxaaY3yls/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXajrrRijaGwiZHM_jm30f8fOE5w/photo.jpg?sz=128", "display_name": "Serge Atareev", "link": "https://stackoverflow.com/users/12460530/serge-atareev"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576705597, "post_id": 59397913, "comment_id": 104989876, "body": "Thank you very much for your patience, QHarr.   Yes, i wish to scrab data on store with id=48, but current code can only scrab result of default store (&quot;\u041c\u043e\u0441\u043a\u0432\u0430, \u041d\u043e\u0432\u043e\u0440\u044f\u0437\u0430\u043d\u0441\u043a\u043e\u0435 \u0448.&quot;)."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1576753419, "last_edit_date": 1576753419, "creation_date": 1576708636, "answer_id": 59400934, "question_id": 59397913, "link": "https://stackoverflow.com/questions/59397913/select-attribute-value-via-vba-xmlhttprequest/59400934#59400934", "title": "Select attribute value via VBA &amp; XMLHttpRequest", "body": "<p>You need to do a post request to the server with the data-id for the store then grab the appropriate cookie and pass that in a subsequent GET request to the original url. If the store is correctly updated the class name for the element with that data-id should be updated to include an <code>active</code> class. You could pull the data-id value out into a variable to make this more readily usable for other stores.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SetStore()\n    Dim html As MSHTML.HTMLDocument, re As Object, xhr As Object\n\n    Set html = New MSHTML.HTMLDocument\n    Set re = CreateObject(\"VBScript.RegExp\")\n    Set xhr = CreateObject(\"MSXML2.ServerXMLHTTP\")\n\n    With re\n        .Global = True\n        .MultiLine = True\n    End With\n\n    Dim cookie As String\n\n    With xhr\n        .Open \"POST\", \"https://www.castorama.ru/multishop/switch/ajax/shop_id/48/\", False\n        .setRequestHeader \"X-Requested-With\", \"XMLHttpRequest\"\n        .send\n        cookie = GetCookie(re, .getAllResponseHeaders, \"Set-Cookie: (castorama_current_shop=48.*)\") '\"Set-Cookie\", \"castorama_current_shop=48; expires=Fri, 17-Jan-2020 22:14:51 GMT; Max-Age=2592000; path=/; HttpOnly\"\n        .Open \"GET\", \"https://www.castorama.ru/building-materials/building-dry-materials-and-primers?limit=96\", False\n        .setRequestHeader \"Set-Cookie\", cookie\n        .send\n        html.body.innerHTML = .responseText\n    End With\n\n    MsgBox html.querySelector(\".shop__name[data-id='48']\").className\n    Stop\n\nEnd Sub\n\nPublic Function GetCookie(ByVal re As Object, ByVal s As String, ByVal p As String) As String\n    With re\n        .Pattern = p\n        GetCookie = .Execute(s)(0).submatches(0)\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 12460530, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ZgxaaY3yls/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXajrrRijaGwiZHM_jm30f8fOE5w/photo.jpg?sz=128", "display_name": "Serge Atareev", "link": "https://stackoverflow.com/users/12460530/serge-atareev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 59400934, "answer_count": 1, "score": 0, "last_activity_date": 1576753419, "creation_date": 1576692745, "question_id": 59397913, "link": "https://stackoverflow.com/questions/59397913/select-attribute-value-via-vba-xmlhttprequest", "title": "Select attribute value via VBA &amp; XMLHttpRequest", "body": "<p>My question is related to other question VBA - <a href=\"https://stackoverflow.com/questions/59117656/select-html-item-using-vba\">Select HTML item using VBA</a>. How can select and click <code>data-id</code> attribute value by using an XMLHttpRequest without Internet Explorer?\nSo far my code looks like this:</p>\n\n<pre><code>Sub Data_multi()\n    Dim http As New XMLHTTP60, html As New HTMLDocument\n    Dim topic As HTMLHtmlElement\n    Dim i As Integer\n    For i = 1 To 4 'last page\n    Application.ScreenUpdating = False\n    With http\n        .Open \"GET\", \"https://www.castorama.ru/building-materials/building-dry-materials-and-primers?limit=96&amp;p=\" &amp; i, False\n        .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        Do: DoEvents: Loop Until .readyState = 4\n        html.body.innerHTML = .responseText\n    End With\n\n    For Each topic In html.getElementsByClassName(\"product-info\")\n        With topic.getElementsByClassName(\"product-name\")\n            If .Length Then x = x + 1: Cells(x, 1) = .item(0).innerText\n        End With\n        With topic.getElementsByClassName(\"price\")\n            If .Length Then Cells(x, 2) = .item(0).innerText\n        End With\n    Next topic\n  Next i\n Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1576692138, "post_id": 59397442, "comment_id": 104984593, "body": "Using <code>Word</code> as the name of your <code>Word.Application</code> instance, makes things confusing. Consider renaming it <code>app</code>, or <code>wordApp</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12560352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48440fe0d059a662e455c92bab3083e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mavorike", "link": "https://stackoverflow.com/users/12560352/mavorike"}, "edited": false, "score": 0, "creation_date": 1576698588, "post_id": 59397576, "comment_id": 104987331, "body": "Thank you for the response.  I have been trying your method for about an hour now and I can&#39;t seem to get anywhere.  It is now making a table within a table on each iteration.   I am going to edit my post to show this."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 12560352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48440fe0d059a662e455c92bab3083e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mavorike", "link": "https://stackoverflow.com/users/12560352/mavorike"}, "edited": false, "score": 0, "creation_date": 1576705418, "post_id": 59397576, "comment_id": 104989823, "body": "@Mavorike What you&#39;re missing is that every cell in the table has a paragraph. So trying to tick up a counter to identify a particular paragraph is putting the &quot;target&quot; for the new table inside the other table. You need to work with a single <code>Range</code>. I&#39;ve modified the answer to address this."}, {"owner": {"reputation": 3, "user_id": 12560352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48440fe0d059a662e455c92bab3083e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mavorike", "link": "https://stackoverflow.com/users/12560352/mavorike"}, "edited": false, "score": 0, "creation_date": 1576761206, "post_id": 59397576, "comment_id": 105007997, "body": "Thank you so much!  This works like a charm!  I am having troubles understanding WHY it works, but it sure does.  I have a history with using Excel VBA, but Word is a little alien to me. So understanding exactly how the range property works and all the properties of each object is a little hard.  I will play with this some and see if I can use this to become more familiar with Word.  Thank you again for all your help!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 12560352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48440fe0d059a662e455c92bab3083e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mavorike", "link": "https://stackoverflow.com/users/12560352/mavorike"}, "edited": false, "score": 0, "creation_date": 1576761949, "post_id": 59397576, "comment_id": 105008353, "body": "@Mavorike Yes, Word Range&#39;s take some getting used to. Think of it like an invisible selection and how you&#39;d work with a selection in Word. Collapse is like pressing an arrow key, for example. Two big differences between a Range and a Selection: code can work with multiple Ranges (there can be only one Selection); it&#39;s usually clearer exactly <i>where the Range is</i> (working with a selection in code is a bit &quot;slippery&quot; - you also shouldn&#39;t use Select in Excel, for similar reasons :-)). Otherwise, ask more exactly what&#39;s not clear - I&#39;ll be happy to try to help further."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 2, "last_activity_date": 1576705397, "last_edit_date": 1576705397, "creation_date": 1576691303, "answer_id": 59397576, "question_id": 59397442, "link": "https://stackoverflow.com/questions/59397442/having-issues-exiting-table-in-word-when-referencing-it-from-excel-using-vba/59397576#59397576", "title": "Having issues exiting table in Word when referencing it from Excel using VBA", "body": "<p>It will help to work with a specific <code>Table</code> object, rather than using <code>Tables([index])</code> to refer to the table. Instantiate the object when creating the table, then use it for everything to do with that table. For example </p>\n\n<pre><code>Dim tbl As Word.Table\nSet tbl = WordDocumentToUpload.Tables.Add(Range:=WordDocumentToUpload.Paragraphs(lngWordCounter).Range, _\n                               NumRows:=2, NumColumns:=10)\n\nWith tbl\n</code></pre>\n\n<p>In order to move \"outside\" (below) the table, use a <code>Range</code> object and \"collapse\" it (think of it like pressing right-arrow when you have a selection, to move the focus to the right and get a blinking cursor):</p>\n\n<pre><code>Dim rngTable as Word.Range\nSet rngTable = tbl.Range\nrngTable.Collapse Word.WdCollapseDirection.wdCollapseEnd\n</code></pre>\n\n<p>At this point <code>rngTable</code> will be just beyond/outside the table, so anything added to it will be outside the table.</p>\n\n<p>The other reason the code in the question is not working is because <em>every</em> Word table cell contains at least one <code>Paragraph</code>. So incrementing a counter in order to identify a specific paragraph is not going to put the focus in the expected place.</p>\n\n<p>There are various ways to go about getting to the end of the document. My preference is below. I work solely with one (in this case, but it could be more) <code>Range</code> object(s) as the target, right from the start. <code>vbCr</code> is the character for a paragraph, so can be appended to text.</p>\n\n<p>Using a <code>Range</code> object is essentially:</p>\n\n<ul>\n<li>assign content</li>\n<li>format the content</li>\n<li>collapse the <code>Range</code></li>\n<li>repeat the steps</li>\n</ul>\n\n<p>The modified code, based on this principle:</p>\n\n<pre><code>Dim WordApp As Word.Application\nDim WordDocumentToUpload As Word.Document\nDim lngExcelCounter As Long\nDim lngWordCounter As Long\nDim WordTbl As Word.Table\nDim rngTable As Word.Range    \n\n'Build Word File\nSet WordApp = New Word.Application\nSet WordDocumentToUpload = Word.Documents.Add\nWordApp.Visible = True\n\n'Set my starting points for the counters\nlngWordCounter = 1\nlngExcelCounter = 1\n\nSet rngTable = WordDocumentToUpload.Content\nrngTable.InsertAfter vbCr\nrngTable.Collapse wdCollapseEnd\nWhile lngExcelCounter &lt; 4 'Loop until end of document\n    If Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter, 1).value &lt;&gt; \"\" Then 'Look for populated field\n        If Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter + 1, 2).value = \"Requirements\" Then 'Parse out record I want to add to Word\n            rngTable = \"Test \" &amp; lngExcelCounter &amp; vbCr\n            rngTable.Collapse wdCollapseEnd\n            'Create Table in Word\n            Set WordTbl = WordDocumentToUpload.Tables.Add(Range:=rngTable, _\n                               NumRows:=2, NumColumns:=10)\n            With WordTbl\n                If .Style &lt;&gt; \"Table Grid\" Then\n                    .Style = \"Table Grid\"\n               End If\n                .ApplyStyleHeadingRows = True\n                .ApplyStyleLastRow = False\n                .ApplyStyleFirstColumn = True\n                .ApplyStyleLastColumn = False\n                .ApplyStyleRowBands = True\n                .ApplyStyleColumnBands = False\n                .Cell(1, 1).Range.Text = \"Requirement Label\"\n                .Cell(1, 2).Range.Text = \"Customer Req?\"\n                .Cell(1, 3).Range.Text = \"Type\"\n                .Cell(1, 4).Range.Text = \"Circuit Parameter\"\n                .Cell(1, 5).Range.Text = \"Sym\"\n                .Cell(1, 6).Range.Text = \"Min\"\n                .Cell(1, 7).Range.Text = \"Typ\"\n                .Cell(1, 8).Range.Text = \"Max\"\n                .Cell(1, 9).Range.Text = \"Units\"\n                .Cell(1, 10).Range.Text = \"Comments and/Or Conditions\"\n'                .Cell(2, 10).Select    \n            End With\n\n            Set rngTable = WordTbl.Range\n            rngTable.Collapse Word.WdCollapseDirection.wdCollapseEnd\n\n        End If\n   End If\n\n   lngExcelCounter = lngExcelCounter + 1 'Increment through Excel\nWend\n\nWordDocumentToUpload.SaveAs2 fileName:=\"Brady Test.docx\", _\n    FileFormat:=wdFormatDocumentDefault\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12560352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48440fe0d059a662e455c92bab3083e4?s=128&d=identicon&r=PG&f=1", "display_name": "Mavorike", "link": "https://stackoverflow.com/users/12560352/mavorike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 59397576, "answer_count": 1, "score": 0, "last_activity_date": 1576705397, "creation_date": 1576690724, "last_edit_date": 1576698727, "question_id": 59397442, "link": "https://stackoverflow.com/questions/59397442/having-issues-exiting-table-in-word-when-referencing-it-from-excel-using-vba", "title": "Having issues exiting table in Word when referencing it from Excel using VBA", "body": "<p>I am trying to basically build a Word document from an Excel document.  The purpose of this is to load it up into another program that likes Word files.  </p>\n\n<p>My main issue is a real simple one.  I am having troubles exiting a table in Word, while running from my Excel Macro.  I get through my first loop, but on my second loop it wants to stay in the table and just add information to the table, then fails when it tries to add a table to a table.</p>\n\n<p>Here is some of my code\n'''</p>\n\n<pre><code>Sub GetSummaDatSweetDocumentToUpload()\n\n\n'Declarations\nDim Word As Word.Application\nDim WordDocumentToUpload As Word.Document\nDim lngExcelCounter As Long\nDim lngWordCounter As Long\n\n\n'Build Word File\nSet Word = New Word.Application\nSet WordDocumentToUpload = Word.Documents.Add\nWord.Visible = True\n\n'Set my starting points for the counters\nlngWordCounter = 1\nlngExcelCounter = 65\n\n\n\n\n\nWhile lngExcelCounter &lt; 500 'Loop until end of document\n    If Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter, 1).Value &lt;&gt; \"\" Then 'Look for populated field\n        If Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter + 1, 2).Value = \"Requirements\" Then 'Parse out record I want to add to Word\n            WordDocumentToUpload.Paragraphs(lngWordCounter).Range = Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter, 1).Value\n            'Create Table in Word\n            WordDocumentToUpload.Tables.Add Range:=WordDocumentToUpload.Paragraphs(lngWordCounter).Range, NumRows:=2, NumColumns:=10\n            With WordDocumentToUpload.Tables(lngWordCounter)\n                If .Style &lt;&gt; \"Table Grid\" Then\n                    .Style = \"Table Grid\"\n                End If\n                .ApplyStyleHeadingRows = True\n                .ApplyStyleLastRow = False\n                .ApplyStyleFirstColumn = True\n                .ApplyStyleLastColumn = False\n                .ApplyStyleRowBands = True\n                .ApplyStyleColumnBands = False\n            End With\n\n            'Format the table\n            WordDocumentToUpload.Tables(1).Cell(1, 1).Range.Text = \"Requirement Label\"\n            WordDocumentToUpload.Tables(1).Cell(1, 2).Range.Text = \"Customer Req?\"\n            WordDocumentToUpload.Tables(1).Cell(1, 3).Range.Text = \"Type\"\n            WordDocumentToUpload.Tables(1).Cell(1, 4).Range.Text = \"Circuit Parameter\"\n            WordDocumentToUpload.Tables(1).Cell(1, 5).Range.Text = \"Sym\"\n            WordDocumentToUpload.Tables(1).Cell(1, 6).Range.Text = \"Min\"\n            WordDocumentToUpload.Tables(1).Cell(1, 7).Range.Text = \"Typ\"\n            WordDocumentToUpload.Tables(1).Cell(1, 8).Range.Text = \"Max\"\n            WordDocumentToUpload.Tables(1).Cell(1, 9).Range.Text = \"Units\"\n            WordDocumentToUpload.Tables(1).Cell(1, 10).Range.Text = \"Comments and/Or Conditions\"\n            WordDocumentToUpload.Tables(1).Cell(2, 10).Select\n            Selection.MoveDown Unit:=wdScreen, Count:=1\n            lngWordCounter = lngWordCounter + 1 'Increment the counter that is used to track which paragraph is being used.  The purpose is to use paragraphs to work my way through Word\n        End If\n    End If\n\n\n\n\n\n    lngExcelCounter = lngExcelCounter + 1 'Increment through Excel\nWend\n\nWordDocumentToUpload.SaveAs2 Filename:=\"Brady Test.docx\", _\n    FileFormat:=wdFormatDocumentDefault\n\n\nEnd Sub\n</code></pre>\n\n<p>'''</p>\n\n<p>Its my first post, so I am sorry for formatting. </p>\n\n<p>======================================================================</p>\n\n<p>Edit one, adding Cindy Meister's fix</p>\n\n<pre><code>'Declarations\nDim WordApp As Word.Application\nDim WordDocumentToUpload As Word.Document\nDim lngExcelCounter As Long\nDim lngWordCounter As Long\nDim WordTbl As Word.Table\nDim rngTable As Word.Range\n\n\n'Build Word File\nSet WordApp = New Word.Application\nSet WordDocumentToUpload = WordApp.Documents.Add\nWordApp.Visible = True\n\n'Set my starting points for the counters\nlngWordCounter = 1\nlngExcelCounter = 65\n\n\n\n\nWordDocumentToUpload.Paragraphs.Add\nWhile lngExcelCounter &lt; 500 'Loop until end of document\n    If Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter, 1).Value &lt;&gt; \"\" Then 'Look for populated field\n        If Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter + 1, 2).Value = \"Requirements\" Then 'Parse out record I want to add to Word\n            WordDocumentToUpload.Paragraphs(lngWordCounter).Range = Worksheets(\"DocumentToUpload Main\").Cells(lngExcelCounter, 1).Value\n            'Create Table in Word\n            WordDocumentToUpload.Paragraphs.Add\n'           WordDocumentToUpload.Paragraphs (lngWordCounter)\n            lngWordCounter = lngWordCounter + 1\n            Set WordTbl = WordDocumentToUpload.Tables.Add(Range:=WordDocumentToUpload.Paragraphs(lngWordCounter).Range, _\n                               NumRows:=2, NumColumns:=10)\n            With WordTbl\n                If .Style &lt;&gt; \"Table Grid\" Then\n                    .Style = \"Table Grid\"\n               End If\n                .ApplyStyleHeadingRows = True\n                .ApplyStyleLastRow = False\n                .ApplyStyleFirstColumn = True\n                .ApplyStyleLastColumn = False\n                .ApplyStyleRowBands = True\n                .ApplyStyleColumnBands = False\n                .Cell(1, 1).Range.Text = \"Requirement Label\"\n                .Cell(1, 2).Range.Text = \"Customer Req?\"\n                .Cell(1, 3).Range.Text = \"Type\"\n                .Cell(1, 4).Range.Text = \"Circuit Parameter\"\n                .Cell(1, 5).Range.Text = \"Sym\"\n                .Cell(1, 6).Range.Text = \"Min\"\n                .Cell(1, 7).Range.Text = \"Typ\"\n                .Cell(1, 8).Range.Text = \"Max\"\n                .Cell(1, 9).Range.Text = \"Units\"\n                .Cell(1, 10).Range.Text = \"Comments and/Or Conditions\"\n'                .Cell(2, 10).Select\n\n            End With\n\n\n            Set rngTable = WordTbl.Range\n            rngTable.Collapse Word.WdCollapseDirection.wdCollapseEnd\n            WordDocumentToUpload.Paragraphs.Add\n            lngWordCounter = lngWordCounter + 1 'Increment the counter that is used to track which paragraph is being used.  The purpose is to use paragraphs to work my way through Word\n\n\n        End If\n    End If\n\n\n\n\n\n    lngExcelCounter = lngExcelCounter + 1 'Increment through Excel\nWend\n\nWordDocumentToUpload.SaveAs2 Filename:=\"Brady Test.docx\", _\n    FileFormat:=wdFormatDocumentDefault\n</code></pre>\n\n<p>The result is I am getting a table within a table. </p>\n\n<p><a href=\"https://i.stack.imgur.com/mMwA3.png\" rel=\"nofollow noreferrer\">Table within a table</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576690261, "post_id": 59397257, "comment_id": 104983755, "body": "Use <code>ActiveSheet</code>."}, {"owner": {"reputation": 381, "user_id": 10027577, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d5vJ9.jpg?s=128&g=1", "display_name": "KyleAure", "link": "https://stackoverflow.com/users/10027577/kyleaure"}, "edited": false, "score": 1, "creation_date": 1576690280, "post_id": 59397257, "comment_id": 104983762, "body": "I am pretty sure you could just use: <code>ActiveWorkbook.ActiveSheet ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1576700938, "creation_date": 1576700938, "answer_id": 59399558, "question_id": 59397257, "link": "https://stackoverflow.com/questions/59397257/how-to-write-code-for-a-sort-that-will-work-in-any-workbook/59399558#59399558", "title": "How to write code for a sort that will work in any workbook?", "body": "<p>Sort is a method that is accessible through worksheet objects.  However you choose to reference a worksheet object is up to you.</p>\n\n<p>The method that excel has transcribed for you in the macro recorder uses the worksheet's name as an index.</p>\n\n<pre><code>ActiveWorkbook.Worksheets(\"timesheet_report_2019-12-08_thr\").Sort...\n</code></pre>\n\n<p>Notice that the name is in quotes and is therefore a string.  You could create a string variable.  The following code does the same work as above.</p>\n\n<pre><code>Dim worksheetName as String\nworksheetName = \"timesheet_report_2019-12-08_thr\"\nActiveWorkbook.Worksheets(worksheetName).Sort...\n</code></pre>\n\n<p>But you can also use numeric indexes.  This would sort whatever sheet the workbook thinks is first in the collection.  (this can be a bit misleading so be careful doing it this way.  The first sheet in the collection isn't always the leftmost tab, or even the sheet named \"Sheet1\").</p>\n\n<pre><code>ActiveWorkbook.Worksheets(1).Sort...\n</code></pre>\n\n<p>You can also use certain keywords to reference a worksheet.  Some commenters have suggested ActiveSheet.  That works, because it references a worksheet object.</p>\n\n<pre><code>ActiveWorkbook.ActiveSheet.Sort...\n</code></pre>\n\n<p>And, you can get references out of an iterator, like in a \"for each\" loop.  The following code (complete with sort) will run the sort you've designed on every sheet in the workbook.</p>\n\n<pre><code>Sub SortAllSheets()\n\n    For Each s In ActiveWorkbook.Sheets\n\n        With s.Sort\n            .SortFields.Clear\n            .SortFields.Add2 Key:=s.Range(\"E2:E62\"), Order:=xlAscending\n            .SortFields.Add2 Key:=s.Range(\"B2:B62\"), Order:=xlAscending\n            .SortFields.Add2 Key:=s.Range(\"A2:A62\"), Order:=xlAscending\n            .SetRange s.Range(\"A1:I62\")\n            .Header = xlYes\n            .MatchCase = False\n            .Orientation = xlTopToBottom\n            .SortMethod = xlPinYin\n            .Apply\n        End With\n\n    Next s\n\nEnd Sub\n</code></pre>\n\n<p>So, there are lots of ways to run your sort \"in any workbook\".  Hope it helps.</p>\n"}], "owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576700938, "creation_date": 1576689961, "last_edit_date": 1576690031, "question_id": 59397257, "link": "https://stackoverflow.com/questions/59397257/how-to-write-code-for-a-sort-that-will-work-in-any-workbook", "title": "How to write code for a sort that will work in any workbook?", "body": "<pre><code>Sub test()\nActiveWorkbook.Worksheets(\"timesheet_report_2019-12-08_thr\").Sort.SortFields. _\n    Clear\nActiveWorkbook.Worksheets(\"timesheet_report_2019-12-08_thr\").Sort.SortFields. _\n    Add2 Key:=Range(\"E2:E62\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n    DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"timesheet_report_2019-12-08_thr\").Sort.SortFields. _\n    Add2 Key:=Range(\"B2:B62\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n    DataOption:=xlSortNormal\nActiveWorkbook.Worksheets(\"timesheet_report_2019-12-08_thr\").Sort.SortFields. _\n    Add2 Key:=Range(\"A2:A62\"), SortOn:=xlSortOnValues, Order:=xlAscending, _\n    DataOption:=xlSortNormal\nWith ActiveWorkbook.Worksheets(\"timesheet_report_2019-12-08_thr\").Sort\n    .SetRange Range(\"A1:I62\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This is a macro I recorded to sort data for me. Each week to active worksheet changes names. How do I get it to where it will work on any sheet?</p>\n"}, {"tags": ["excel", "vba", "outlook", "appointment"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1576692323, "post_id": 59397036, "comment_id": 104984688, "body": "FYI - <code>Dim RequiredAttendee, OptionalAttendee, ResourceAttendee As Outlook.Recipient</code>.  Only <code>ResourceAttendee</code> is necessarily an <code>Outlook.Recipient</code>.  The others are <code>Variant</code>...you need to explicitly declare all variable types, otherwise they default to <code>Variant</code>.  (This may not be the issue, just wanted to point it out.)"}], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": false, "score": 1, "last_activity_date": 1576695126, "last_edit_date": 1576695126, "creation_date": 1576693464, "answer_id": 59398073, "question_id": 59397036, "link": "https://stackoverflow.com/questions/59397036/vba-excel-appointment-staying-as-draft/59398073#59398073", "title": "VBA excel appointment staying as draft", "body": "<p>You're effectively creating a mail item to format text from the spreadsheet and copy/paste it into the appointment <strong><em>and then never closing that mail item.</em></strong>  See notated code below.</p>\n\n<p>Simplest solution is likely to add <code>m.Close olDiscard</code> to the end.  More \"effective\" solution would be to remove the logic requiring a mail created solely for formatting of text into an appointment.</p>\n\n<pre><code>Sub SVN()\n'Creates Outlook Calendar Site Visit Notification for one day onsite.'\n    Set olApp = New Outlook.Application\n    Set m = olApp.CreateItem(olMailItem) '&lt;--------------Make new mail item\n    Set appt = olApp.CreateItem(olAppointmentItem)\n\n    With ActiveSheet\n        Set rngTo = .Range(\"J3\")\n        Set rngCC = .Range(\"J4\")\n        Set rngCALloc = .Range(\"J5\")\n        Set rngCALstart = .Range(\"J7\")\n        Set rngCALend = .Range(\"J8\")\n        Set rngSUB = .Range(\"J14\")\n    End With\n\n    MsgBox \"Verify Attendees:  Customer, Sales, Service.\"\n\n        appt.MeetingStatus = olMeeting\n        appt.RequiredAttendees = rngTo.Value\n        appt.OptionalAttendees = rngCC.Value\n        appt.Subject = rngSUB.Value\n        appt.Location = rngCALloc.Value\n\n        appt.Start = rngCALstart.Value\n        appt.End = rngCALend.Value\n        appt.AllDayEvent = True\n\n        m.BodyFormat = olFormatHTML '&lt;-----------Adjust new mail item bodyformat to HTML\n        m.HTMLBody = Range(\"J16\").Value '&lt;-------Paste data from spreadsheet into mail item\n        m.GetInspector().WordEditor.Range.FormattedText.Copy '&lt;-----Copy the formatted text from mail item\n        appt.GetInspector().WordEditor.Range.FormattedText.Paste '&lt;----Paste into the appointment.\n        m.Close olDiscard '&lt;----This is new. Close the mail item and discard (no save)\n        appt.Display\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11206596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/339cdedbac50e9a81dfd09819bcf60ae?s=128&d=identicon&r=PG&f=1", "display_name": "Nordekai", "link": "https://stackoverflow.com/users/11206596/nordekai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576695126, "creation_date": 1576689040, "last_edit_date": 1576690518, "question_id": 59397036, "link": "https://stackoverflow.com/questions/59397036/vba-excel-appointment-staying-as-draft", "title": "VBA excel appointment staying as draft", "body": "<p>ok, so i'm no developer.  i know just enough to get myself in trouble.  i've got an excel vba that grabs data from the spread sheet, then sends an outlook calendar invite to team members and customers.  it's definitely working correctly (so to speak ...), but it's always keeping a draft with no contacts in the To: field or subject.  would this be an issue with my code, or would this be an outlook thing?</p>\n\n<p>... probably need to clean up the declarations, too ...</p>\n\n<pre><code>Dim olApp As Outlook.Application\nDim olEmail As Outlook.MailItem\nDim olCal As Outlook.AppointmentItem\nDim olFolder As Outlook.Folder\nDim RequiredAttendee, OptionalAttendee, ResourceAttendee As Outlook.Recipient\nDim rtf() As Byte\n\nDim objOutlook As Object, objnSpace As Object, objFolder As MAPIFolder\nDim rngTo As Range\nDim rngCC As Range\nDim rngSUB As Range\nDim rngCALloc As Range\nDim rngCALstart As Range\nDim rngCALend As Range\nDim rngBody As Range\nDim myItem As Object\n\nDim oApp As Object\nDim oNameSpace As Namespace\nDim oFolder As Object\n\nSub SVN()\n'Creates Outlook Calendar Site Visit Notification for one day onsite.'\n    Set olApp = New Outlook.Application\n    Set m = olApp.CreateItem(olMailItem)\n    Set appt = olApp.CreateItem(olAppointmentItem)\n\n    With ActiveSheet\n        Set rngTo = .Range(\"J3\")\n        Set rngCC = .Range(\"J4\")\n        Set rngCALloc = .Range(\"J5\")\n        Set rngCALstart = .Range(\"J7\")\n        Set rngCALend = .Range(\"J8\")\n        Set rngSUB = .Range(\"J14\")\n    End With\n\n    MsgBox \"Verify Attendees:  Customer, Sales, Service.\"\n\n        appt.MeetingStatus = olMeeting\n        appt.RequiredAttendees = rngTo.Value\n        appt.OptionalAttendees = rngCC.Value\n        appt.Subject = rngSUB.Value\n        appt.Location = rngCALloc.Value\n\n        appt.Start = rngCALstart.Value\n        appt.End = rngCALend.Value\n        appt.AllDayEvent = True\n\n        m.BodyFormat = olFormatHTML\n        m.HTMLBody = Range(\"J16\").Value\n        m.GetInspector().WordEditor.Range.FormattedText.Copy\n        appt.GetInspector().WordEditor.Range.FormattedText.Paste\n        appt.Display\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576689222, "post_id": 59396856, "comment_id": 104983258, "body": "Mods gave me a flag in another post - check out this link for a potentially relevant idea of how we are trying to accomplish the above - <a href=\"https://stackoverflow.com/questions/46548571/nested-for-each-to-loop-through-dropdown-and-copy-paste/59396476?noredirect=1#comment104982857_59396476\" title=\"nested for each to loop through dropdown and copy paste\">stackoverflow.com/questions/46548571/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1576689798, "post_id": 59396856, "comment_id": 104983526, "body": "What exactly doesn&#39;t work? Add sheet references to your code to avoid ambiguity."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1576690053, "post_id": 59396856, "comment_id": 104983658, "body": "And read this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576690205, "post_id": 59396856, "comment_id": 104983733, "body": "@SJR - It is very tedious to add and or delete assets to my current code. Felt like there might be a better way to reference and cycle the range of assets found in the dropdown list (cell D3 on the &quot;Live&quot; tab). In addition, I am receiving a #VALUE error in a formula when cycling through a certain type of asset... Would it help if I posted the formula?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576690291, "post_id": 59396856, "comment_id": 104983771, "body": "Yes, post the formula and values when it errors. So you want to insert a set of values into D3, take the answers from resultant calculations and copy to another sheet?"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576690340, "post_id": 59396856, "comment_id": 104983793, "body": "@braX - thank you for the formatting help. SJR - just saw your link - thank you for the advice! I will go ahead and add the formula trouble to my post."}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576690691, "post_id": 59396856, "comment_id": 104983961, "body": "@SJR - To give a more clear pic of what&#39;s happening, in the model - there&#39;s a tab with raw data that populates the &quot;Live&quot; tab whenever a specific asset is chosen from the dropdown list in D3... D3 is just a set of names that can be chosen to iterate the &quot;Live&quot; tab... Fortunately, the names are just numbers which fall anywhere between 300 and 450. E.g. I choose asset &quot;420&quot; from the list in cell D3, then the &quot;Live&quot; tab&#39;s formulas iterate based on the chosen asset by using the data dump tab and a series of other tabs to arrive at end numbers. I then copy/paste these values into a new worksheet"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576690823, "post_id": 59396856, "comment_id": 104984013, "body": "I think that&#39;s basically what I was saying. Your code appears to be inserting the values into D3 though rather than them being chosen from a dropdown. Why are you covering the range to column XFD?"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576691427, "post_id": 59396856, "comment_id": 104984315, "body": "@SJR - I would take this to chat but I&#39;m too new! Glad we&#39;re on the same page. I didn&#39;t know I could choose the assets from a dropdown. I was inserting the names into D3 because it still resulted in a given asset populating the &quot;Live&quot; tab correctly. Can you help me switch the code to pull from the dropdown list? My fear is that the code will populate worksheets with blank data if an asset is not listed in the range... And the range to column XFD is pointless...I just wanted to copy/paste values of the entire sheet to a new worksheet but thought it would possibly save time...macro runtime=40min"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576691497, "post_id": 59396856, "comment_id": 104984337, "body": "How many formulae do you have on your sheet? You can have a dropdown using data validation or a combobox."}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576692958, "post_id": 59396856, "comment_id": 104984967, "body": "@SJR - in cell D3, we have a Data Validation which states &quot;=&#39;Asset Dashboard&#39;!$C$6:$C$570&quot; so I guess the Asset Dashboard has a list of 564 potential assets. Fortunately, there are only 50-100 assets that populate the 564 rows."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576693451, "post_id": 59396856, "comment_id": 104985184, "body": "But do you want this code run just when D3 is changed or to run through the whole list of 564 items?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1576694831, "post_id": 59396856, "comment_id": 104985790, "body": "@MEDITATEDwelcome to SO, most of the time newcomers feel being treated tough, it happened to me too, but if you tough it out this forum can be very useful. You just need to learn the rules here. I had a quick look at your question, it is hard to understand what you really want to do, it is always better to listen to the comments of the more senior members and edit your post to increase your chance of getting an answer. If you are using VBA, there is no need to use formulas and slow down the workbook, does your sheet include formulas? in a simple word explain what is your final goal is?"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1576695948, "post_id": 59396856, "comment_id": 104986248, "body": "@SJR - I only want the code to iterate the assets that fall within the list of the 564 items, meaning there will be ~400 blanks and I want to be sure to exclude them. It would be ideal to have the code only iterate/create new worksheets whenever a value is found within the list. E.g. the list starts at asset &quot;309&quot; but jumps numbers, all the way up to an asset titled &quot;450&quot;. There are roughly 75 assets not listed between 309 and 450."}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "reply_to_user": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 0, "creation_date": 1576696152, "post_id": 59396856, "comment_id": 104986322, "body": "@Ibo - thanks for the big welcome! I appreciate tough words and want to quickly learn! I think my questions above are very confusing - to help clarify your comment, I do not want to add a formula to the code. I want the code to loop through all of the listed assets in cell D3, so that I do not have to list each individual asset in my code starting at asset &quot;309&quot;. Cell D3 uses a list via Data Validation, so I might as well use that list to automatically iterate instead of using the current insert method that I coded. Also, the formula that I put in the post is breaking when an asset triggers 1"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576696220, "post_id": 59396856, "comment_id": 104986345, "body": "the formula issue is separate from the long code issue - editing post now to make it more clear"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "edited": false, "score": 1, "creation_date": 1576696764, "post_id": 59396856, "comment_id": 104986551, "body": "Do you have a master list of the asset and you want to filter the assets based on the selection in a cell? one way to help us is to show us the input and the output, it takes time to build a good question, but it pays off quickly"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576698819, "post_id": 59396856, "comment_id": 104987416, "body": "@ lbo- yes, there is a master list of the assets, and I want to loop through all of the assets in order to eventually create new worksheets of all the assets. you have all been very helpful and i am incredibly grateful. i am running SJR&#39;s code at the moment and will report back once complete. let me know if the updated post is helpful!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576698364, "post_id": 59398824, "comment_id": 104987223, "body": "Thank you for providing your code! I just attempted to update my post with better talking points. Will try your code now!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576701219, "post_id": 59398824, "comment_id": 104988334, "body": "I forgot an end if - try it now."}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576702871, "post_id": 59398824, "comment_id": 104988924, "body": "New bug, shows a &quot;Worksheet&quot; used error for this line: Worksheets(&quot;Live&quot;).UsedRange.Copy... when running, the &quot;Live&quot; sheet is becoming titled asset &quot;309&quot; and the code is then unable to reference the correct sheet, if not mistaken"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576704445, "post_id": 59398824, "comment_id": 104989473, "body": "Somebody had added a macro to change the &quot;Live&quot; sheet name - just deleted it and am now running the code!"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576705263, "post_id": 59398824, "comment_id": 104989766, "body": "it worked!!!!!!! that is very impressive. Is there a way to keep the formatting from the &quot;Live&quot; tab? It populates all of the new sheets correctly, but my boss is a stickler for formatting... more importantly, is there a way to make the title of the newly calc&#39;d worksheet the same as the asset?"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576706980, "post_id": 59398824, "comment_id": 104990366, "body": "Private Sub Worksheet_Change(ByVal Target As Range)     If Not Intersect(Target, Range(&quot;D3&quot;)) Is Nothing Then         ActiveSheet.Name = ActiveSheet.Range(&quot;D3&quot;).Value     End If End Sub"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576714170, "post_id": 59398824, "comment_id": 104992391, "body": "Hey everyone, i managed to fix the formatting and other issues - cannot thank all of you enough!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1576753315, "post_id": 59398824, "comment_id": 105004144, "body": "I&#39;m a bit confused because nothing in my code changes the name of a worksheet. You could just add <code>ws.name=r.value</code> into the loop. There is also a pastespecial option to include formatting I think. If it&#39;s helped, please consider accepting the answer."}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 1, "creation_date": 1576856601, "post_id": 59398824, "comment_id": 105041756, "body": "I made a couple of additional changes to code, including formatting and naming conventions of ws. This has been a great learning experience - will gladly accept your answer!"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1580311671, "post_id": 59398824, "comment_id": 106057296, "body": "Hey everyone this code has been a life save, thank you all again for your input. Quick follow up question - is it possible to paste values for font colors in green and keep other font colors (e.g. black and white) as formulas?"}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1580312106, "post_id": 59398824, "comment_id": 106057525, "body": "I found color.index and some other helpful code. Yet, creating multiple IFS within the code has proven difficult. Example 1: if font color is green, then paste as values, if font color is green, change green font color to blue, if font color is white or black, then paste as formulas."}, {"owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "edited": false, "score": 0, "creation_date": 1580315765, "post_id": 59398824, "comment_id": 106059736, "body": "Posed font color question here: <a href=\"https://stackoverflow.com/questions/59971645/how-to-code-vba-to-paste-values-or-formulas-based-on-font-color\" title=\"how to code vba to paste values or formulas based on font color\">stackoverflow.com/questions/59971645/&hellip;</a>"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1576701052, "last_edit_date": 1576701052, "creation_date": 1576697057, "answer_id": 59398824, "question_id": 59396856, "link": "https://stackoverflow.com/questions/59396856/efficiently-iiterate-50-assets-then-create-worksheets-of-each-assets-values/59398824#59398824", "title": "Efficiently iIterate 50+ assets, then create worksheets of each asset&#39;s values, respectively", "body": "<p>Am tempted to suggest you close this question and start again as the comments are long. Read [ask] and [mcve] and perhaps post a screenshot as remember that none of us know anything about your set up.</p>\n\n<p>However, see if this code broadly does what you want - it's not entirely clear as Ibo says.</p>\n\n<pre><code>Sub x()\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nDim r As Range, ws As Worksheet\n\nFor Each r In Worksheets(\"Asset Dashboard\").Range(\"C6:C570\") 'go through each cell in DV list\n    If Len(r) &gt; 0 Then                                       'only do something if cell not empty\n       Worksheets(\"Live\").Range(\"D3\").Value = r.Value           'transfer value to D3 of Live\n       Application.Calculate\n       Set ws = Worksheets.Add                                  'add new sheet\n       Worksheets(\"Live\").UsedRange.Copy\n       ws.Range(\"A1\").PasteSpecial xlValues                     'copy values only from Live to new sheet\n    End if\nNext r\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12559939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eef3aaea4e473f1fabd597ab3041536d?s=128&d=identicon&r=PG&f=1", "display_name": "MEDITATED", "link": "https://stackoverflow.com/users/12559939/meditated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 59398824, "answer_count": 1, "score": 0, "last_activity_date": 1580070530, "creation_date": 1576688350, "last_edit_date": 1580070530, "question_id": 59396856, "link": "https://stackoverflow.com/questions/59396856/efficiently-iiterate-50-assets-then-create-worksheets-of-each-assets-values", "title": "Efficiently iIterate 50+ assets, then create worksheets of each asset&#39;s values, respectively", "body": "<p>I recorded a macro to better understand my process. This macro is shown below in the first part. The second part is my attempt to make this thing faster.</p>\n\n<p><strong>Current Sequence of Events</strong></p>\n\n<ol>\n<li>Insert asset name in cell D3, in a tab titled \"Live\" (cell D3 is a dropdown list with 50+ assets - more on this in next section titled \"Steps We Can Improve\")</li>\n<li>Calculate new asset by using Application.CalculateFull</li>\n<li>Wait until the \"Live\" tab is done calculating to move to next line of code</li>\n<li>Wait 15 seconds (more on this in next section)</li>\n<li>Copy the newly iterated data in the \"Live\" tab </li>\n<li>Create a new worksheet titled with the asset's name</li>\n<li>Paste the data from the \"Live\" tab as values into the newly created worksheet</li>\n<li>Repeat steps 1-7 until all assets have been calculated</li>\n</ol>\n\n<p><strong>Steps to Improve</strong></p>\n\n<ol>\n<li>instead of inserting an asset name in cell D3, which requires a lot of code, I would like to loop through the list found within cell D3 (a data validation list which sources asset names from a master list on another worksheet).</li>\n</ol>\n\n\n\n<ol start=\"4\">\n<li>I added time to the code because I thought the model was not fully iterating for certain assets. This was wrong - it never iterated correctly with the addition of time. So, it is likely a formula error? The formula is listed below, and it is showing a #VALUE error for roughly 20 assets - but only when I run the macro. Outside of the macro, this formula populates correctly.</li>\n</ol>\n\n\n\n<pre><code>Sub SlowMACROv3()\n\n  ' Turns off screen updating and auto calcs which helps to speed macro\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n  ' Turns off screen updating and auto calcs which helps to speed macro\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual    \n\n    Sheets(\"Live\").Select\n    Range(\"D3\").Select\n    ActiveCell.FormulaR1C1 = \"309\"\n    Application.Calculate\nIf Not Application.CalculationState = xlDone Then DoEvents\n    Application.Wait (Now + TimeValue(\"0:00:15\"))\n    Cells.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n\n    Sheets(\"Live\").Select\n    Sheets(\"Live\").Copy Before:=Sheets(1)\n    Range(\"D3\").Select\n    ActiveCell.FormulaR1C1 = \"310\"\n    Application.Calculate\nIf Not Application.CalculationState = xlDone Then DoEvents\n    Application.Wait (Now + TimeValue(\"0:00:15\"))\n    Cells.Select\n    Selection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Application.CutCopyMode = False\n\n  ' Turns on screen updating and auto calcs\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>My second attempt works, but the code is just as long. Also a formula throws an error for some assets and can be found at the very bottom. </p>\n\n<pre><code>Sub SlowishMACROv1()\n\n  ' Turns off screen updating and auto calcs which helps to speed macro\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n  ' Cycle all assets and create new worksheets as values macro\n    Sheets(\"Live\").Copy Before:=Sheets(1)\n    Range(\"D3\").FormulaR1C1 = \"309\"\n    Application.Calculate\n    If Not Application.CalculationState = xlDone Then DoEvents\n    Range(\"A1:XFD1000\").Value = Range(\"A1:XFD1000\").Value\n\n    Sheets(\"Live\").Copy Before:=Sheets(1)\n    Range(\"D3\").FormulaR1C1 = \"310\"\n    Application.Calculate\n    If Not Application.CalculationState = xlDone Then DoEvents\n    Range(\"A1:XFD1000\").Value = Range(\"A1:XFD1000\").Value\n\n  ' Turns on screen updating and auto calcs\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic     \n\nEnd Sub\n\nFormula: =+IF(INDEX('Reversion Dashboard'!$I:$I,MATCH($D$3,'Reversion Dashboard'!$C:$C,0))=1,I331*(1+(RATE($E$325,,$I331,-('Reversion Schedule'!$K$19)))),\"\")\n</code></pre>\n\n<p>This formula works in the \"Live\" tab except for assets that trigger the =1 portion within the IF True section, whenever the macro is run. Why does this formula work every time we switch to a different asset, but not when I run the macro?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1576687986, "post_id": 59396735, "comment_id": 104982647, "body": "When using a <code>.</code> - you are referring to a previous <code>With</code> statement (which you did not include in your example) - and without it, you are referencing the <code>ActiveSheet</code> - <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/with-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a> - your example is also a bad one, since you are mixing the two, which can cause all kinds of problems if you aren&#39;t careful."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 2, "creation_date": 1576688377, "post_id": 59396735, "comment_id": 104982827, "body": "Both are in pretty bad shape tbh. As mentioned above, the ranges prefixed with a dot are referring to a with block. Notice not all the ranges in bottom code don&#39;t actually have the with block. Depending on the rest of the code, it will not be intuitive what sheet the ranges in question actually exist on."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1576693463, "last_edit_date": 1576693463, "creation_date": 1576689864, "answer_id": 59397242, "question_id": 59396735, "link": "https://stackoverflow.com/questions/59396735/what-does-a-dot-before-range-mean/59397242#59397242", "title": "What does a dot before range() mean?", "body": "<p><code>Range</code> isn't a language-level keyword: it's a class defined in the <code>Excel</code> type library.</p>\n\n<p>But you don't invoke <em>classes</em> in VBA (or any language I know) - you invoke <em>members</em>, and members belong to <em>objects</em>.</p>\n\n<p><code>Range</code> is a <em>property</em> of the <code>Worksheet</code> class, that returns an object whose type is <code>Range</code>.</p>\n\n<p>When your host application is Excel, the <code>Excel</code> library is automatically referenced, and the global scope starts including hidden objects, like <code>[_Global]</code>, whose members include a <code>Range</code> property.</p>\n\n<p>If you're <strong>not</strong> in a worksheet module, then an unqualified <code>Range</code> is property of some hidden global-scope object that's implicitly working off whatever <code>Worksheet</code> happens to be the current <code>ActiveSheet</code>, itself implicitly belonging to whatever <code>Workbook</code> object happens to be the current <code>ActiveWorkbook</code>.</p>\n\n<p>If you <strong>are</strong> in a worksheet module, then an unqualified <code>Range</code>  member calls is implicily referring to <em>that sheet</em>'s <code>Range</code> property, and so the implicit qualifier is <code>Me</code>.</p>\n\n<p>That means exactly what an unqualified <code>Range</code> member call does, depends on  what module the code is written in. <strong>And that is terrible</strong>, because you want a VBA instruction to do what it says, and say what it does - an instruction that does this, will do exactly the same thing regardless of what module it's written in.</p>\n\n<p>So, consistently qualify all <code>Range</code> member calls. Always, all the time - just like you know to stick <code>Option Explicit</code> at the top of every single module, always, all the time.</p>\n\n<p>The <code>.Range</code> calls, as others mentioned in comments, <em>are</em> qualified: these are member calls made against a <code>With</code> block variable (assuming your code compiles):</p>\n\n<pre><code>With SomeSheet\n    .Range(\"A1\").Value = 42\nEnd With\n</code></pre>\n\n<p>Code that <em>sometimes</em> qualifies <code>Range</code> (and <code>Cells</code>, <code>Columns</code>, <code>Rows</code>, <code>Names</code>, ...and other <code>Worksheet</code> member calls), and <em>sometimes</em> don't, are extremely frail and bug-prone. <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">Rubberduck can help you locate implicit ActiveSheet references</a>.</p>\n\n<p>Also note the implicit member calls in both of your snippets: the <code>Range</code> object isn't \"equal to\" another <code>Range</code> object - what's actually going on, is implicit member calls to <code>Range.Value</code><sup>1</sup>, and it's the <code>.Value</code> of either <code>Range</code> object that's getting subtracted here:</p>\n\n<blockquote>\n<pre><code>If Range(\"BJ\" &amp; i) - Range(\"R\" &amp; i) = 0 Then\n</code></pre>\n</blockquote>\n\n<p>In other words:</p>\n\n<pre><code>If ActiveSheet.Range(\"BJ\" &amp; i).Value - ActiveSheet.Range(\"R\" &amp; i).Value = 0 Then\n</code></pre>\n\n<p>Note that <code>Range.Value</code> returns a <code>Variant</code> that will be a <code>Variant/Double</code> if the cell contains any numeric type... but will be a <code>Variant/Error</code> given any cell error value (e.g. <code>#N/A</code>) - and you can't do math on <code>Variant/Error</code>. Consider validating whether the values are error values, using the <code>IsError</code> function.</p>\n\n<hr>\n\n<p><sup>1</sup> actually the default member of <code>Range</code> is a hidden property aptly named <code>[_Default]</code>. Depending on how it's used and parameterized, it returns different things. In <em>this</em> case, that's <code>Range.Value</code>. Given arguments, it would be <code>Range.Item</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12276308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/325a769cb97d77e42abeb1a9ddbdb25b?s=128&d=identicon&r=PG&f=1", "display_name": "KarelMusa", "link": "https://stackoverflow.com/users/12276308/karelmusa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576694579, "creation_date": 1576687891, "last_edit_date": 1576694579, "question_id": 59396735, "link": "https://stackoverflow.com/questions/59396735/what-does-a-dot-before-range-mean", "title": "What does a dot before range() mean?", "body": "<p>Can someone explain me why is this</p>\n\n<pre><code>If Range(\"BJ\" &amp; i) - Range(\"R\" &amp; i) = 0 Then\n    Range(\"BJ\" &amp; i) = \"OK\"\nElse\n    Range(\"BJ\" &amp; i) = \"NOK\"\nEnd If\n</code></pre>\n\n<p>different from this? What do these dots mean?</p>\n\n<pre><code>If Range(\"BJ\" &amp; i) - Range(\"R\" &amp; i) = 0 Then\n    .Range(\"BJ\" &amp; i) = \"OK\"\nElse\n    .Range(\"BJ\" &amp; i) = \"NOK\"\nEnd If\n</code></pre>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 1842, "user_id": 1226436, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/abb50b705a430e14fd745bf6f3513249?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/1226436/miguel"}, "edited": false, "score": 2, "creation_date": 1576687245, "post_id": 59396450, "comment_id": 104982237, "body": "Have you tried recording an macro in excel and than connecting to your database while macro is recording?. If you are successful on doing that , you will be able to answer your own question."}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1576687629, "post_id": 59396450, "comment_id": 104982430, "body": "I would recommend trying these steps: <a href=\"https://social.technet.microsoft.com/wiki/contents/articles/1409.how-to-create-a-sql-connection-string-for-an-application-udl-file.aspx?Redirected=true\" rel=\"nofollow noreferrer\">social.technet.microsoft.com/wiki/contents/articles/&hellip;</a>"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 2, "creation_date": 1576689506, "post_id": 59396450, "comment_id": 104983375, "body": "Whenever I need to figure out a connection string I go <a href=\"https://www.connectionstrings.com/sql-server/\" rel=\"nofollow noreferrer\">to this site</a>."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1577062195, "creation_date": 1577062195, "answer_id": 59449180, "question_id": 59396450, "link": "https://stackoverflow.com/questions/59396450/connect-vba-excel-macro-to-sql-server-local-database/59449180#59449180", "title": "Connect VBA Excel Macro to SQL Server local database", "body": "<p>Ok, this should be pretty simple.  See the link below.</p>\n\n<p><a href=\"https://www.erpsoftwareblog.com/2017/01/microsoft-excel-connections-sql-databases/\" rel=\"nofollow noreferrer\">https://www.erpsoftwareblog.com/2017/01/microsoft-excel-connections-sql-databases/</a></p>\n\n<p>Also, check this out.</p>\n\n<p><a href=\"https://www.connectionstrings.com/sql-server/\" rel=\"nofollow noreferrer\">https://www.connectionstrings.com/sql-server/</a></p>\n\n<p>Finally, to update a SQL Server table with Excel/VBA code, do the following.</p>\n\n<pre><code>Sub UpdateMyTable()\nDim cnn As ADODB.Connection\nDim uSQL As String\nDim rngName As Range\nSet cnn = New Connection\ncnnstr = \"Provider=SQLOLEDB; \" &amp; _\n            \"Data Source=MyServer; \" &amp; _\n            \"Initial Catalog=MyDB;\" &amp; _\n            \"User ID=User;\" &amp; _\n            \"Password=Pwd;\" &amp; _\n            \"Trusted_Connection=No\"\n    Set rngName = ActiveCell\ncnn.Open cnnstr\nuSQL = \"UPDATE MyTable SET Field = 1 WHERE Field = ' \" &amp; rngName &amp; \" ' \"\n'Debug.Print (uSQL)\ncnn.Execute uSQL\ncnn.Close\nSet cnn = Nothing\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>Post back, with specific details, if you have issues with this code.  Thanks.</p>\n"}], "owner": {"reputation": 69, "user_id": 10572609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d5df52ec2f1a29826e4fab203f4070b?s=128&d=identicon&r=PG&f=1", "display_name": "Johnatan De Leon", "link": "https://stackoverflow.com/users/10572609/johnatan-de-leon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577062195, "creation_date": 1576686950, "last_edit_date": 1576689643, "question_id": 59396450, "link": "https://stackoverflow.com/questions/59396450/connect-vba-excel-macro-to-sql-server-local-database", "title": "Connect VBA Excel Macro to SQL Server local database", "body": "<p>I'm writing a macro in Microsoft Excel that make a update in a table of my local SQL Server database, but I'm having problems with my connection string:</p>\n\n<pre><code>sConnect = \"Driver={SQL Server};Data Source=(localdb)\\MSSQLLocalDB;Database=Scrap;\"\n</code></pre>\n\n<p>but when I run the macro I get this error:</p>\n\n<blockquote>\n  <p>Data source name not found and no default driver specific</p>\n</blockquote>\n\n<p>What is the correct way to write the connection string?</p>\n"}, {"tags": ["excel", "vba", "pdf"], "comments": [{"owner": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 1, "creation_date": 1576715182, "post_id": 59396381, "comment_id": 104992588, "body": "I have a worksheet that expands and shrinks as rows are added and deleted and in code have the print area set by <code>Worksheets(TargetTab).PageSetup.PrintArea = &quot;$A$&quot; &amp; FR &amp; &quot;:$R$&quot; &amp; LR</code> where FR and LR are the first and last row. Then, in the ribbon, Page Layout &gt; Width = 1 Page, and Height = Automatic. The &quot;Automatic&quot; is the essential setting that lets multiple pages happen. While my case applies to printing, I think it applies to exporting too."}, {"owner": {"reputation": 41, "user_id": 12095973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/738467fbbc1372d880fb9a00077dffcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrien", "link": "https://stackoverflow.com/users/12095973/adrien"}, "reply_to_user": {"reputation": 371, "user_id": 3654325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd52c1ed316019e2384605e1814a8f5?s=128&d=identicon&r=PG&f=1", "display_name": "Stax", "link": "https://stackoverflow.com/users/3654325/stax"}, "edited": false, "score": 0, "creation_date": 1576764790, "post_id": 59396381, "comment_id": 105009945, "body": "@Stax just tried putting Page Layout &gt; Width = 1 Page, and Height = Automatic. Works just fine! Thank you. For some reason though, the second page is offset so I don&#39;t have the first two lines that appear, but I&#39;ll find a way to fix this. It applies to exporting too!"}], "owner": {"reputation": 41, "user_id": 12095973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/738467fbbc1372d880fb9a00077dffcc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrien", "link": "https://stackoverflow.com/users/12095973/adrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576687284, "creation_date": 1576686728, "last_edit_date": 1576687284, "question_id": 59396381, "link": "https://stackoverflow.com/questions/59396381/insert-page-breaks-when-exporting-range-in-pdf", "title": "Insert page breaks when exporting range in .PDF", "body": "<p>I'm trying to export a dynamic excel range to .PDF through VBA. \nThe thing is, the PDF need to be printable after (letter format), and while it works just fine at the beginning, when too many rows are present (the number of columns is fixed), the whole range shrinks to stay on a single letter page. </p>\n\n<p>I'm trying to set page breaks, but I just cannot make it work. I already tried solutions described <a href=\"https://stackoverflow.com/questions/33673865/insert-page-breaks-in-excel-to-split-data-for-printing-pdf\">here</a>, but it does not seem to work either.</p>\n\n<p>There are other things aside the range I want to export, so exporting the whole sheet is not an option, and it's at work, so third-party dowloaded programs cannot make it either.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub saveAsPDF(targetWksht As Worksheet, fileName As String)\n\n    lastRow = getLastRow(targetWksht) 'gets last row of the desired range\n    lastCol = getLAstCol(targetWksht) 'gets last column of the desired range (always 8)\n    pageBreakIndex = 40\n\n    With targetWksht\n        .ResetAllPageBreaks\n        While pageBreakIndex &lt; lastRow\n            .Rows(pageBreakIndex).PageBreak = xlPageBreakManual\n            pageBreakIndex = pageBreakIndex + 50\n        Wend\n    End With\n\n    With targetWksht.Range(targetWksht.Cells(1,1), targetWksht.Cells(lastRow, lastCol))\n        .ExportAsFixedFormat Type:=xlTypePDF, _\n                             fileName:=Application.ActiveWorkbook.Path &amp; \"\\\" &amp; fileName, _\n                             Quality:=xlQualityStandard, _\n                             IncludeDocProperties:=True, _\n                             IgnorePrintAreas:=False, _\n                             OpenAfterPublish:=True\n    End With\nEnd Sub\n</code></pre>\n\n<p>I always get the same result: my range, properly formatted, but in one block fitted in a landscape-oriented letter sheet, that shrinks as the range expands vertically. Cannot find a way to break pages for it to appear in multiple sheets.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576686596, "post_id": 59396243, "comment_id": 104981877, "body": "Check whether <code>Selection.Information(wdWithinTable)</code> or <code>Range.Information(wdWithinTable) = True</code>. I&#39;m sure this is a duplicate - the information is certainly already on the site. Also, you should include the relevant code (a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in the question. That&#39;s why I&#39;m leaving this as a comment, not writing an answer."}, {"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576687036, "post_id": 59396243, "comment_id": 104982121, "body": "The code is in the link above, as an answer from another user to my previous question. It uses Range.Information(wdWithInTable) = True, however I think that checks if the entirely bold paragraph is in a table (it deletes the following character which includes text in tables), which isn&#39;t what I need. I need it to check if the <b>following</b> paragraph is in a table and then move on to the next entirely bold paragraph without deleting anything."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1576832719, "post_id": 59412019, "comment_id": 105031382, "body": "I get &quot;Run-time error &#39;91&#39;: Object variable or With block variable not set&quot; when I try that"}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1576848663, "post_id": 59412019, "comment_id": 105038159, "body": "That&#39;s because you need to restrict the search range to not include the last paragraph of the document. Add this before the For loop: searchRange.MoveEnd wdParagraph, -1"}, {"owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "edited": false, "score": 0, "creation_date": 1576850588, "post_id": 59412019, "comment_id": 105039087, "body": "Wonderful, that works, thank you very much! I&#39;ve also managed to sort out the bit about the following paragraph&#39;s style (List Bullet)."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1576766717, "creation_date": 1576766717, "answer_id": 59412019, "question_id": 59396243, "link": "https://stackoverflow.com/questions/59396243/how-to-ignore-the-text-in-a-table/59412019#59412019", "title": "How to ignore the text in a table?", "body": "<p>The answer is in the code you are already using. To work with the following paragraph use <code>para.Next</code>, as you are already doing for the deletion.</p>\n\n<p>Simply change:</p>\n\n<pre><code>And Not para.Range.Information(wdWithInTable)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>And Not para.Next.Range.Information(wdWithInTable)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8642714, "user_type": "registered", "profile_image": "https://graph.facebook.com/10158585000200402/picture?type=large", "display_name": "Cat J", "link": "https://stackoverflow.com/users/8642714/cat-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 59412019, "answer_count": 1, "score": -1, "last_activity_date": 1585898228, "creation_date": 1576686279, "last_edit_date": 1585898228, "question_id": 59396243, "link": "https://stackoverflow.com/questions/59396243/how-to-ignore-the-text-in-a-table", "title": "How to ignore the text in a table?", "body": "<p>I have code that searches for ^p and replaces with ^p^p to insert a blank line between every paragraph.</p>\n\n<p>I'd like this to not apply to paragraphs that are entirely bold (i.e. subheadings).</p>\n\n<p>So \"search for ^p and replace with ^p^p except for cases where the entire paragraph is bold\".</p>\n\n<p>I have a sort-of fix where I search for entirely bold paragraphs and delete the paragraph immediately following (which should just be a blank line after the search ^p and replace ^p^p.</p>\n\n<p>The code below deletes the character immediately following an entirely bold paragraph.</p>\n\n<pre><code>Dim para As Paragraph\nDim searchRange As Range\n\nSet searchRange = Selection.Range\nsearchRange.End = ActiveDocument.Content.End\n\nFor Each para In searchRange.Paragraphs\n    If para.Range.Font.Bold = True And Not para.Range.Information(wdWithInTable) Then para.Range.Next.Delete\nNext para\n</code></pre>\n\n<p>The problem is it does it in tables. So if I have a table header that is bold, it deletes the paragraph following, which will be the text in the next row of the table.</p>\n\n<p>How can I get this bit of code to effectively check if a paragraph is entirely bold, and then delete the paragraph following it, UNLESS it is in a table?</p>\n\n<p>Also if I could do the same but exempting if the following paragraph is a certain style, e.g. List Bullet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1576685165, "post_id": 59395895, "comment_id": 104981034, "body": "There are several question about <a href=\"https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row\">finding the last row of a range</a> that should prove useful. And I know the macro recorder does this all the time, but there are <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">good reasons to avoid using select</a> in your code."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1576685397, "post_id": 59395895, "comment_id": 104981174, "body": "You can enter the formula in the entire range in one go. No need to autofill. <code>Range(&quot;A1:A&quot; &amp; LastRow).Formula = YourFormula</code> You can find the last row as shown <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/11169920#11169920\">Here</a>"}], "owner": {"reputation": 1, "user_id": 7897282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1242ce461f490be738c10ffa1471e6c1?s=128&d=identicon&r=PG&f=1", "display_name": "Nickel17", "link": "https://stackoverflow.com/users/7897282/nickel17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1576687394, "creation_date": 1576685027, "last_edit_date": 1576687394, "question_id": 59395895, "link": "https://stackoverflow.com/questions/59395895/autofill-formula-with-vba", "title": "Autofill formula with vba", "body": "<p>I have recorded a macro to fill down a column of cells after running a proper formula, however, because the fill down each time is a different number of cells it either fills down to short or too long. I'm not sure how to set an open-ended range as you can see with my arbitrary \"A1:A200\" range. Can you please help me and explain the steps so that I can start to learn how to do these things on my own? Below is my macro code. Any help with this would be greatly appreciated.\nThank you.</p>\n\n<pre><code>Sub Proper()\n'\n' Proper Macro\n'\n\n'\nActiveCell.Select\nActiveCell.FormulaR1C1 = \"=PROPER(RC[-1])\"\nSelection.AutoFill Destination:=ActiveCell.Range(\"A1:A200\")\nActiveCell.Range(\"A1:A200\").Select\nSelection.Copy\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "sql", "vba", "sockets"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12559796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yi5-dcoxJRo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFtekBeTA5g2sdluK40riIG1aZgg/photo.jpg?sz=128", "display_name": "Gabriel &#193;lvarez Mart&#237;nez-Conde", "link": "https://stackoverflow.com/users/12559796/gabriel-%c3%81lvarez-mart%c3%adnez-conde"}, "edited": false, "score": 0, "creation_date": 1576689863, "post_id": 59396477, "comment_id": 104983555, "body": "That&#39;s very very helpful!! However, I can&#39;t find where its declarated the object in all the forms. I&#39;ve been looking everywhere, but somehow the declaration must be inherent in some package or some like that (that&#39;s kindof my conclusion). I think I will just declare it on the form that I&#39;m working on and that&#39;s it. EDIT: I&#39;m thinking on a declaration private on the class of the form. However, if I quit that form and enter on another: Would it be re-declarated? Like, I should un-declarate it or something if I quit the form or something? PS: Your answer is very very helpful, thank you so much!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3, "user_id": 12559796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yi5-dcoxJRo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFtekBeTA5g2sdluK40riIG1aZgg/photo.jpg?sz=128", "display_name": "Gabriel &#193;lvarez Mart&#237;nez-Conde", "link": "https://stackoverflow.com/users/12559796/gabriel-%c3%81lvarez-mart%c3%adnez-conde"}, "edited": false, "score": 0, "creation_date": 1576689908, "post_id": 59396477, "comment_id": 104983583, "body": "@Gabriel&#193;lvarezMart&#237;nez-Conde <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> can find it for you, if it exists."}, {"owner": {"reputation": 3, "user_id": 12559796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yi5-dcoxJRo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFtekBeTA5g2sdluK40riIG1aZgg/photo.jpg?sz=128", "display_name": "Gabriel &#193;lvarez Mart&#237;nez-Conde", "link": "https://stackoverflow.com/users/12559796/gabriel-%c3%81lvarez-mart%c3%adnez-conde"}, "edited": false, "score": 0, "creation_date": 1576692948, "post_id": 59396477, "comment_id": 104984963, "body": "UPDATE: I&#39;ve found the problem and UGH! it was a loooot simplier than I thought. The problem was on the interface of the form, where the only thing a had to do is put a WinSock icon and recall it with the name &quot;Socket&quot;. On that way, when the form is executed, it creates the Socket and etc.  Thank you very much anyway!!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1576687027, "creation_date": 1576687027, "answer_id": 59396477, "question_id": 59395893, "link": "https://stackoverflow.com/questions/59395893/variable-not-defined-on-vba-about-socket/59396477#59396477", "title": "Variable not defined on VBA about socket", "body": "\n\n<p>Sounds like your <code>Socket</code> variable is declared as a <code>Public</code> field in your form's code-behind.</p>\n\n<p>Forms are class modules with a visual designer. Being class modules, when you work with one you're working with an <em>instance</em> of the class.</p>\n\n<p>If you declare <code>Public Socked As Object</code> in any class module (i.e. any <code>ThisWorkbook</code>, <code>Sheet1</code>, <code>UserForm1</code>, or <code>Class1</code> module), then yes that object is <code>Public</code>, but that doesn't make it <em>global</em>: the public field <em>belongs</em> to the <em>instance</em> of the class it's declared in.</p>\n\n<p>That makes the <code>Socket</code> identifier <em>when used anywhere other than in the form's code-behind</em>, effectively an undeclared variable - kudos for using <code>Option Explicit</code> here to catch this mistake at compile-time, otherwise that would have very likely gone unnoticed until run-time, where the undeclared <code>Socket</code> local variable would have been some <code>Variant/Empty</code> value, and <em>something, somewhere</em> likely wouldn't have liked it and would have raised some error, potentially very far from the actual source of the problem!</p>\n\n<p>You have several options.</p>\n\n<h3>1. Make <code>Socket</code> an actual global variable</h3>\n\n<p><code>Socket</code> currently belongs to what I'll call <code>UserForm1</code>. Since other components need this piece of data, you could expand its scope by moving the declaration to a <em>standard module</em> (.bas):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Module1.bas\nOption Explicit\nPublic Socket As Object\n</code></pre>\n\n<p>Now just remove the declaration from <code>UserForm1</code> and everything should \"just work\".</p>\n\n<p>Except, it's a global variable: everyone everywhere can overwrite this object reference at any time.</p>\n\n<p>This isn't ideal.</p>\n\n<h3>2. Make the other code consume the <code>Socket</code> where it lives</h3>\n\n<p><code>Socket</code> belongs to <code>UserForm1</code>. Depending on how/whether you're instantiating that form, you might be able to treat it like global state, because all <code>UserForm</code> modules have a <code>VB_PredeclaredId</code> hidden attribute set to <code>True</code>, which is exactly how you're able to do this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>UserForm1.Show\n</code></pre>\n\n<p>When you do that, the <code>UserForm1</code> object instance gets created by VBA at the <code>.</code> dereferencing operator, and then the <code>Show</code> method is invoked. <strong>If the instance doesn't self-destruct</strong>, then when execution returns after the form is <em>hidden</em> (<strong>not</strong> unloaded), then you can access everything <code>Public</code> about it:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim theSocket As Object\nSet theSocket = UserForm1.Socket\n</code></pre>\n\n<p>Now this obviously comes with a major caveat: you need to take steps to ensure VBA isn't going to re-spawn a brand new instance (with a brand new <code>Socket</code> reference, set to <code>Nothing</code>) when the <code>.</code> dereferencing operator runs in that instruction.</p>\n\n<p>You can do this by handling the <code>QueryClose</code> event and explicitly cancelling the destruction of the instance:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        Cancel = True\n        Me.Hide\n    End If\nEnd Sub\n</code></pre>\n\n<p>If you have an <code>OkButton</code> doing something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub OkButton_Click()\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Or worse, something like this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub OkButton_Click()\n    Unload UserForm1\nEnd Sub\n</code></pre>\n\n<p>Then change it to this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private sub OkButton_Click()\n    Me.Hide\nEnd Sub\n</code></pre>\n\n<p>This is critical: you MUST <code>Hide</code> the form, not <code>Unload</code> it, and you can't let it be destroyed before execution returns - the calling code <em>needs</em> to be able to use exactly the same instance that the user has been interacting with.</p>\n\n<h3>3. Take the control yourself</h3>\n\n<p><code>UserForm1</code> is a class, like any other. <code>New</code> it up yourself instead of leaving VBA in charge: take the exact same precautions as described above, but now <strong>pretend there's no default instance</strong>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub DoSomething()\n    With New UserForm1\n        .Show\n\n        Dim theSocket As Object\n        Set theSocket = .Socket\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>See my <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a> article for more information &amp; details.</p>\n\n<hr>\n\n<h3>4. Use a separate <code>Socket</code> object</h3>\n\n<p>If the form's <code>Socket</code> object has no business being used outside that form, then maybe it would make more sense for the other code to also define and setup a <code>Socket</code> to play with?</p>\n\n<p>Variables should be as tightly-scoped as possible, <em>especially</em> when we're looking at shared resources like a socket connection: if different procedures <code>Set</code> this socket to different things, then the only purpose of that variable being <code>Public</code> is to avoid the keystrokes of declaring it everywhere you need a socket, and that is abusing global state and <em>will</em> bite you in the rear end, one day or another.</p>\n\n<p>Pragmatically speaking, a form has no business knowing how to wire-up a socket anyway: there should be a dedicated module for that, and everyone that needs to talk to a socket should go through that module.</p>\n"}], "owner": {"reputation": 3, "user_id": 12559796, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yi5-dcoxJRo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFtekBeTA5g2sdluK40riIG1aZgg/photo.jpg?sz=128", "display_name": "Gabriel &#193;lvarez Mart&#237;nez-Conde", "link": "https://stackoverflow.com/users/12559796/gabriel-%c3%81lvarez-mart%c3%adnez-conde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59396477, "answer_count": 1, "score": 0, "last_activity_date": 1582055927, "creation_date": 1576685023, "last_edit_date": 1582055927, "question_id": 59395893, "link": "https://stackoverflow.com/questions/59395893/variable-not-defined-on-vba-about-socket", "title": "Variable not defined on VBA about socket", "body": "<p>I'm making an edit to a project on VBA that uses a Socket to send information to a program on Netbeans on a specific server.</p>\n\n<p>I did not write the code. I'm trying to understand what the original programmer did.</p>\n\n<p>I have many forms, and a few send information with that socket. I'm trying to do the same with another form. </p>\n\n<p>The error is</p>\n\n<blockquote>\n  <p>\"Variable not defined\".</p>\n</blockquote>\n\n<p>In all the project in any moment there is a declaration of the object/variable named \"Socket\", but in the forms that originally runs the connection you can make any operations with it, like <code>Socket.Close</code>, <code>Socket.RemoteHost = \"xxx.xxx.xxx.xxx\"</code>, <code>Socket.RemotePort = \"xxxx\"</code> and <code>Socket.Connect</code> and there is no problem.</p>\n\n<p>I have <code>Option Explicit</code> on the beginning, but that same option is on the other forms.</p>\n\n<p>I've looked the flow of the execution with F8 to see if a method or something where the variable is declared, but, or I'm missing something or there is no definition.</p>\n"}, {"tags": ["vba", "outlook", "microsoft-teams"], "comments": [{"owner": {"reputation": 449, "user_id": 12318748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ba99e03314cdf154460e11a52ab04dd?s=128&d=identicon&r=PG&f=1", "display_name": "Subhasish", "link": "https://stackoverflow.com/users/12318748/subhasish"}, "edited": false, "score": 0, "creation_date": 1576823067, "post_id": 59395886, "comment_id": 105028113, "body": "Please take a look at <a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/overview\" rel=\"nofollow noreferrer\">What are Microsoft Teams apps?</a> to see what&#39;s possible to extend in MS Teams. And also you can explore <a href=\"https://docs.microsoft.com/en-us/microsoftteams/platform/overview\" rel=\"nofollow noreferrer\">Microsoft Graph API</a> for teams feature available as API"}, {"owner": {"reputation": 7540, "user_id": 1162102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9501eccc1c0e3e439ec50bce4b5ccafc?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Clear", "link": "https://stackoverflow.com/users/1162102/andrew-clear"}, "edited": false, "score": 0, "creation_date": 1577137378, "post_id": 59395886, "comment_id": 105104116, "body": "You&#39;ll also want to take a look at Outlook add-ins - <a href=\"https://docs.microsoft.com/en-us/outlook/add-ins/\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/outlook/add-ins</a>. However, I don&#39;t believe you can do exactly what you&#39;re looking for, as I believe it isn&#39;t possible to customize the behavior of that particular button. You&#39;ll need to take advantage of a different extension point, or potentially use Power Automation (Flow)."}], "owner": {"reputation": 1, "user_id": 10064812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04e74ce08014ed2b47f2ae77b54b828?s=128&d=identicon&r=PG&f=1", "display_name": "stevendavidson", "link": "https://stackoverflow.com/users/10064812/stevendavidson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1583231678, "creation_date": 1576684988, "last_edit_date": 1583231678, "question_id": 59395886, "link": "https://stackoverflow.com/questions/59395886/outlook-reply-with-im-and-send-email-letting-recipient-know", "title": "Outlook Reply with IM and send Email letting recipient know", "body": "<p>My school uses Microsoft Teams alongside emails. I want to move away from emails as they are slow at times and Microsoft Teams is just a lot nicer to use when sharing files and getting replies.</p>\n\n<p>I am looking at creating a VBA but have no idea of how to start it.</p>\n\n<p>My idea is: when I select \"reply with IM\" not only does it take me to teams (as it does not) but also sends the person, I'm replying to, an email letting them know their reply is in Teams and to check there.</p>\n\n<p>I only want it to happen when the \"Reply with IM\" is selected as some emails such as confidential/secure emails need a history.</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 2, "creation_date": 1576685026, "post_id": 59395695, "comment_id": 104980930, "body": "This is likely to get closed for being opinion based but I think your VBA code is fine. I would prefer to have my query as a stored procedure instead but that is preference."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1576685149, "post_id": 59395695, "comment_id": 104981014, "body": "This looks fine but I&#39;d do my best to construct a function which takes in a SQL string and returns an array of results: no need to repeat this logic multiple times.  Same goes for any DB operations - creating a class to manage the interfacing is a useful investment of time.  Since you&#39;re in Excel you could consider storing your SQL on a worksheet instead of in your VBA.  Also in your <code>With rst</code> block you still have a couple of unneeded <code>rst</code>"}, {"owner": {"reputation": 11, "user_id": 11735299, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wy0d3dCVhmc/AAAAAAAAAAI/AAAAAAAABAo/viVMF_U-vbs/photo.jpg?sz=128", "display_name": "Gustavo S&#225;nchez", "link": "https://stackoverflow.com/users/11735299/gustavo-s%c3%a1nchez"}, "edited": false, "score": 0, "creation_date": 1576690073, "post_id": 59395695, "comment_id": 104983666, "body": "Sean Lange .- Thx. Stored Precedures are on my mind. When I finish the APP will think about what to move to Stored Procedures. i.e. in my code the tables with <b>Q</b> in the name are Views at the server. Tim Williams .- Thx about rst repeated. Fixed it at code."}], "answers": [{"comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1576685074, "post_id": 59395894, "comment_id": 104980963, "body": "This is more than just a comment. And is a good improvement. +1 from me."}, {"owner": {"reputation": 113, "user_id": 2913389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16f1d78db81db81dd213e3c53f3f5834?s=128&d=identicon&r=PG&f=1", "display_name": "Yarner", "link": "https://stackoverflow.com/users/2913389/yarner"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1576685151, "post_id": 59395894, "comment_id": 104981016, "body": "Cheers @SeanLange !"}], "tags": [], "owner": {"reputation": 113, "user_id": 2913389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16f1d78db81db81dd213e3c53f3f5834?s=128&d=identicon&r=PG&f=1", "display_name": "Yarner", "link": "https://stackoverflow.com/users/2913389/yarner"}, "is_accepted": false, "score": 1, "last_activity_date": 1576685102, "last_edit_date": 1576685102, "creation_date": 1576685023, "answer_id": 59395894, "question_id": 59395695, "link": "https://stackoverflow.com/questions/59395695/what-is-the-most-elegant-way-to-do-an-excel-vba-sql-query/59395894#59395894", "title": "What is the most elegant way to do an Excel VBA SQL query?", "body": "<p>I can't comment due to lack of rep. </p>\n\n<p>Rather than loop your recordset at the 'With' Statement; I'd just add the recordset as a whole to the spreadsheet.</p>\n\n<pre><code>Set rst = Cnn.Execute(CnnQry)\nIf rst.EOF Then\n   'Catching empty recordsets\nElse\n   Worksheets(\"Today\").Range(\"A2\").CopyFromRecordset rst\nEnd If\nCnn.Close\n</code></pre>\n\n<p>To advise. We use an ADODB Connection and Recordset objects. Your code looks like you do this also. </p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1576685862, "last_edit_date": 1576685862, "creation_date": 1576685228, "answer_id": 59395952, "question_id": 59395695, "link": "https://stackoverflow.com/questions/59395695/what-is-the-most-elegant-way-to-do-an-excel-vba-sql-query/59395952#59395952", "title": "What is the most elegant way to do an Excel VBA SQL query?", "body": "<p>You could look at just using the array from <code>.GetRows</code> method of the recordset object</p>\n\n<p>see</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/getrows-method-ado?view=sql-server-ver15\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/getrows-method-ado?view=sql-server-ver15</a></p>\n\n<p>You can add the <code>where</code>s to your join also, like <code>customers join orders on (customers.id=orders.id AND order.value&gt;100)</code> </p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11735299, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wy0d3dCVhmc/AAAAAAAAAAI/AAAAAAAABAo/viVMF_U-vbs/photo.jpg?sz=128", "display_name": "Gustavo S&#225;nchez", "link": "https://stackoverflow.com/users/11735299/gustavo-s%c3%a1nchez"}, "edited": false, "score": 0, "creation_date": 1576753217, "post_id": 59396796, "comment_id": 105004084, "body": "What else I can say than &#39;I love you&#39;. Thank you very much for your time, I&#39;ll follow your recommendations. No rep. enough to vote this."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1576688115, "creation_date": 1576688115, "answer_id": 59396796, "question_id": 59395695, "link": "https://stackoverflow.com/questions/59395695/what-is-the-most-elegant-way-to-do-an-excel-vba-sql-query/59396796#59396796", "title": "What is the most elegant way to do an Excel VBA SQL query?", "body": "<pre class=\"lang-vb prettyprint-override\"><code>CnnQry = _\n    \"SELECT\" &amp; _\n    \"   APP_METERS_Q_Profiles.ProfileId, \" &amp; _\n    \"   Main_Profile_Info.FieldValue, \" &amp; _\n    \"   APP_METERS_T_Access.[Read], \" &amp; _\n    \"   APP_METERS_T_Access.Write \" &amp; _\n    \"FROM (APP_METERS_Q_Profiles \" &amp; _\n    \"   INNER JOIN Main_Profile_Info ON APP_METERS_Q_Profiles.ProfileId = Main_Profile_Info.ProfileId) \" &amp; _\n    \"   INNER JOIN APP_METERS_T_Access ON APP_METERS_Q_Profiles.ProfileId = APP_METERS_T_Access.APPMETERSQProfileId \" &amp; _\n    \"WHERE \" &amp; _\n    \"   (((Main_Profile_Info.FieldId)=1) AND \" &amp; _\n    \"   ((APP_METERS_T_Access.APPMETERSQUserId)=1) AND \" &amp; _\n    \"   ((APP_METERS_T_Access.APPMETERSTDataTypeId)=1) AND \" &amp; _\n    \"   ((APP_METERS_T_Access.[Read])=-1));\"\n</code></pre>\n\n<p>That doesn't belong in code. It's a gigantic string literal: you get no syntax highlighting, no validation, no intellisense; you need to track parentheses manually, and beyond 20 or so line continuations, it stops compiling and you start doing things like <code>CnnQry = CnnQty &amp; \"...some more inline SQL...\"</code></p>\n\n<p>If it needed parameter values, they'd probably be just concatenated in - and then you'd need to care for single quotes, and poof you have a <em>SQL Injection</em> vulnerability that's not only a serious security issue, but also a bug, no less.</p>\n\n<p>Inline SQL is an abomination, regardless of what language it's done in. The less you have, the better.</p>\n\n<p>For what it's worth I make a typo every single time I try to type <code>CnnQry</code>: vowels are permitted, and there's nothing wrong with using <code>sql</code> either.</p>\n\n<p>You want SQL queries on the SQL Server side, not in your code.</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>CREATE PROCEDURE dbo.GiveMeAGoodName\nAS BEGIN\n    SELECT\n       ...\n    FROM ...\n        INNER JOIN ...\n        INNER JOIN ...\n    WHERE ...\nEND\n</code></pre>\n\n<p>And now your inline SQL in VBA becomes:</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Const sql As String = \"dbo.GiveMeAGoodName\"\n</code></pre>\n\n<p>And the VBA code should use a <code>Command</code> to get the <code>Recordset</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim cmd As ADODB.Command\nSet cmd = New ADODB.Command\ncmd.ActiveConnection = Cnn\ncmd.CommandText = sql\ncmd.CommantType = adCmdStoredProc\n\n'add parameters if needed:\n'cmd.Parameters.Append cmd.CreateParameter(...)\n\nDim results As ADODB.Recordset\nSet results = cmd.Execute\n</code></pre>\n\n<p>Note that with proper parameterization as above, you're letting SQL Server do its job and deal with quoting, and <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">Little Bobby Tables</a> can't do any harm.</p>\n\n<p>Use <code>Range.CopyFromRecordset</code> to dump a recordset onto a <code>Range</code> without looping.</p>\n"}], "owner": {"reputation": 11, "user_id": 11735299, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wy0d3dCVhmc/AAAAAAAAAAI/AAAAAAAABAo/viVMF_U-vbs/photo.jpg?sz=128", "display_name": "Gustavo S&#225;nchez", "link": "https://stackoverflow.com/users/11735299/gustavo-s%c3%a1nchez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1576688115, "creation_date": 1576684343, "last_edit_date": 1576687408, "question_id": 59395695, "link": "https://stackoverflow.com/questions/59395695/what-is-the-most-elegant-way-to-do-an-excel-vba-sql-query", "title": "What is the most elegant way to do an Excel VBA SQL query?", "body": "<p>I'm using this code and very similar others that <strong>are working perfectly</strong> but I'm wondering if there is a more elegant way to do it:\n(Extract)</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Erase ArrUserMetRecCentros\nCnn.Open\nCnnQry = _\n    \"SELECT\" &amp; _\n    \"   APP_METERS_Q_Profiles.ProfileId, \" &amp; _\n    \"   Main_Profile_Info.FieldValue, \" &amp; _\n    \"   APP_METERS_T_Access.[Read], \" &amp; _\n    \"   APP_METERS_T_Access.Write \" &amp; _\n    \"FROM (APP_METERS_Q_Profiles \" &amp; _\n    \"   INNER JOIN Main_Profile_Info ON APP_METERS_Q_Profiles.ProfileId = Main_Profile_Info.ProfileId) \" &amp; _\n    \"   INNER JOIN APP_METERS_T_Access ON APP_METERS_Q_Profiles.ProfileId = APP_METERS_T_Access.APPMETERSQProfileId \" &amp; _\n    \"WHERE \" &amp; _\n    \"   (((Main_Profile_Info.FieldId)=1) AND \" &amp; _\n    \"   ((APP_METERS_T_Access.APPMETERSQUserId)=1) AND \" &amp; _\n    \"   ((APP_METERS_T_Access.APPMETERSTDataTypeId)=1) AND \" &amp; _\n    \"   ((APP_METERS_T_Access.[Read])=-1));\"\nSet rst = Cnn.Execute(CnnQry)\n    With rst\n        x = x + 1\n        Do Until rst.EOF\n            For i = 1 To 4\n                ArrUserMetRecCentros(x, i) = rst.Fields(i - 1).Value\n            Next i\n            .MoveNext\n            x = x + 1\n        Loop\n        ArrUserMetRecCentros(0, 0) = x - 1\n    End With\nCnn.Close\n</code></pre>\n\n<p>This connects to a MS SQL EXPRESS server and stores the requested data in an array that I'm going to use in EXCEL.\nI'm not looking for you to rewrite my code (it's my job ;)) just few tips if there's any. Things like \"Not to use 'Set rst= <em>blablabla</em>' better option is to do <em>'this'</em>. Or \"define all your queries in different public string variables to keep code cleaner\", etc.</p>\n\n<p>Thank you very much for any help received.\nGustavo.</p>\n"}, {"tags": ["vba", "internet-explorer", "web-scraping", "automation"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12559684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb68056f11dc63897eb6f93671a7d3af?s=128&d=identicon&r=PG&f=1", "display_name": "Dave_1234", "link": "https://stackoverflow.com/users/12559684/dave-1234"}, "edited": false, "score": 0, "creation_date": 1576759745, "post_id": 59399332, "comment_id": 105007255, "body": "QHarr, that worked a treat! Many thanks for your time on this! All the best, Dave."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1576699707, "creation_date": 1576699707, "answer_id": 59399332, "question_id": 59395660, "link": "https://stackoverflow.com/questions/59395660/excel-vba-click-website-button-with-no-name-or-id-that-uses-json/59399332#59399332", "title": "Excel VBA click website button with no name or ID that uses JSON", "body": "<p>If only interested in that one tab I would first grab the parent element (div), which houses all the tabs, by its classname using a css class selector. I would then use a child combinator in combination with nth-child() selector to grab the second child div by its classname:</p>\n\n<pre><code>.querySelector(\".table-view__tabs &gt; div:nth-child(2)\").Click 'Select tab direct\n</code></pre>\n\n<p>If potentially interested in all 3 tabs:</p>\n\n<p>I would first grab the parent element (div), which houses all the tabs, by its classname using a css class selector. I would then use a child combinator to grab the child divs (which are the tabs) by their classnames. I would index into the returned nodeList to click the required tab:</p>\n\n<pre><code>Set tabs = .querySelectorAll(\".table-view__tabs &gt; div\") 'select all tabs then index in for tab of choice\ntabs.Item(1).Click       \n</code></pre>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub ClickButton()\n\n    Dim ie As SHDocVw.InternetExplorer\n\n    Set ie = New SHDocVw.InternetExplorer\n\n    With ie\n        .Visible = True\n        .Navigate2 \"https://fundcentres.lgim.com/uk/workplace-employee/fund-centre/#Product=WorkSave-Pension-Plan-(generation-3)\"\n\n        While .Busy Or .ReadyState &lt;&gt; 4: DoEvents: Wend\n\n        With .Document\n\n            .querySelector(\".table-view__tabs &gt; div:nth-child(2)\").Click 'Select tab direct\n\n            Stop  'Delete me later\n\n            Dim tabs As Object\n\n            Set tabs = .querySelectorAll(\".table-view__tabs &gt; div\") 'select all tabs then index in for tab of choice\n            tabs.Item(1).Click                   '0 based so first tab is 0, second is 1 etc\n\n            Stop                                 'Delete me later\n\n        End With\n\n        Stop                                     '&lt;==Delete me later\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Reading:</strong></p>\n\n<ol>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selectors</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Child_combinator\" rel=\"nofollow noreferrer\">Child combinator</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Class_selectors\" rel=\"nofollow noreferrer\">Class selector</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/:nth-child\" rel=\"nofollow noreferrer\">:nth-child</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectoraLL\" rel=\"nofollow noreferrer\">document.querySelectorAll</a></li>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector\" rel=\"nofollow noreferrer\">document.querySelector</a></li>\n</ol>\n\n<hr>\n\n<p><strong>References (VBE>Tools>References):</strong></p>\n\n<ol>\n<li>Microsoft Internet Controls</li>\n</ol>\n"}], "owner": {"reputation": 3, "user_id": 12559684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb68056f11dc63897eb6f93671a7d3af?s=128&d=identicon&r=PG&f=1", "display_name": "Dave_1234", "link": "https://stackoverflow.com/users/12559684/dave-1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 59399332, "answer_count": 1, "score": 0, "last_activity_date": 1576700692, "creation_date": 1576684236, "last_edit_date": 1576700692, "question_id": 59395660, "link": "https://stackoverflow.com/questions/59395660/excel-vba-click-website-button-with-no-name-or-id-that-uses-json", "title": "Excel VBA click website button with no name or ID that uses JSON", "body": "<p>I am using excel VBA to open this website:\n<a href=\"https://fundcentres.lgim.com/uk/workplace-employee/fund-centre/#Product=WorkSave-Pension-Plan-(generation-3)\" rel=\"nofollow noreferrer\">Legal and General</a>, \nThen it needs to click the \"Fund prices and charges\" button.</p>\n\n<p>Inspecting the web page with chrome, I can see this button has the following code:</p>\n\n<p><code>&lt;div class=\" selected tab\" tabindex =\"0\" role=\"button\" aria-pressed=\"true\"&gt;...&lt;/div&gt;</code></p>\n\n<p>The HTML 'view source' suggests a script type=\"application/JSON\"</p>\n\n<p>I'm very confused by all of this. Does anyone know how I can select this button? I have this section of code so far:</p>\n\n<pre><code> Set HTMLDoc = .document\n\nSet objElement = HTMLDoc.getElementsByClassName(\"Select - Tab - Fund prices and charges\")(0)\n\n    objElement.Click\n\n.Quit\n</code></pre>\n\n<p>Any help will be much appreciated.</p>\n\n<p>Regards</p>\n\n<p>Dave</p>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 2760773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b87b1b18411f5c97707cde95f5cdb6d?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/2760773/max"}, "is_accepted": false, "score": 0, "last_activity_date": 1576682811, "creation_date": 1576682811, "answer_id": 59395216, "question_id": 59394673, "link": "https://stackoverflow.com/questions/59394673/skip-a-column-in-excel-when-pulling-from-sql/59395216#59395216", "title": "Skip a column in excel when pulling from SQL", "body": "<p>this inserts a empty column:</p>\n\n<pre><code>strSql = strSql &amp; \" COLCUDF.Revision#1Date, \" \nand strSql = strSql &amp; \"'', \"\nand strSql = strSql &amp; \" COLCUDF.FinalActDate, \" \n</code></pre>\n\n<p>I hope this helps!\nMax</p>\n"}], "owner": {"reputation": 1, "user_id": 11676202, "user_type": "registered", "profile_image": "https://graph.facebook.com/10219574184889695/picture?type=large", "display_name": "Bradley Schnell", "link": "https://stackoverflow.com/users/11676202/bradley-schnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576687421, "creation_date": 1576681063, "last_edit_date": 1576687421, "question_id": 59394673, "link": "https://stackoverflow.com/questions/59394673/skip-a-column-in-excel-when-pulling-from-sql", "title": "Skip a column in excel when pulling from SQL", "body": "<p>So I want to skip a column in excel when I am running a select statement in between:</p>\n\n<p>strSql = strSql &amp; \" COLCUDF.Revision#1Date, \"\nand \nstrSql = strSql &amp; \" COLCUDF.FinalActDate, \" </p>\n\n<p>since that column has a formula in it.</p>\n\n<pre><code>Dim rstProjRls As New ADODB.Recordset\nDim cmdProjRls As New ADODB.Command\n\nSet cnnSSVERP = New ADODB.Connection\ncnnSSVERP.Open \"Driver={SQL Server};Server=\" &amp; Range(\"dbServer\") &amp; \";Database=\" &amp; Range(\"dbName\") &amp; \";Uid=\" &amp; Range(\"dbUser\") &amp; \";Pwd=\" &amp; Range(\"dbPassword\") &amp; \";\"\ncnnSSVERP.CursorLocation = adUseClient\n\nIf cnnSSVERP.State Then\nElse\n    GoTo No_Connection\nEnd If\n\nstrSql = \"\"\nstrSql = strSql &amp; \"Select \"\nstrSql = strSql &amp; \" Coalesce(Year(PRI.ShipSchedDate), Year(PRI.PMReq),0) As ReportYearGroup, \"\nstrSql = strSql &amp; \" Coalesce(Month(PRI.ShipSchedDate), Month(PRI.PMReq),0) As ReportMonthGroup, \"\nstrSql = strSql &amp; \" CO.ID As SalesOrder, \"\nstrSql = strSql &amp; \" COLCUDF.ReleaseNo, \"\nstrSql = strSql &amp; \" PRI.ProjectName, \"\nstrSql = strSql &amp; \" LTrim(COL.MISC_REFERENCE) As Description, \"\nstrSql = strSql &amp; \" COCUDF.ProjectType, \"\nstrSql = strSql &amp; \" PRI.Plant, \"\nstrSql = strSql &amp; \" PRI.ReleaseStatus, \"\nstrSql = strSql &amp; \" COLCUDF.EngineerLead, \"\nstrSql = strSql &amp; \" COLCUDF.Engineer, \"\nstrSql = strSql &amp; \" COCUDF.Estimator, \"\nstrSql = strSql &amp; \" PRI.ProjectManager, \"\nstrSql = strSql &amp; \" COLCUDF.PostCheck, \"\nstrSql = strSql &amp; \" COLCUDF.ProjTODate, \"\nstrSql = strSql &amp; \" COLCUDF.CalcNumber, \"\nstrSql = strSql &amp; \" COLCUDF.StampDueDate, \"\nstrSql = strSql &amp; \" COLCUDF.StampActDate, \"\nstrSql = strSql &amp; \" COLCUDF.SubDueDate, \"\nstrSql = strSql &amp; \" COLCUDF.SubOutDate, \"\nstrSql = strSql &amp; \" COLCUDF.RevisionNumber, \"\nstrSql = strSql &amp; \" COLCUDF.InRevision#1Date, \"\nstrSql = strSql &amp; \" COLCUDF.Revision#1DueDate, \"\nstrSql = strSql &amp; \" COLCUDF.Revision#1Date, \"\n\nstrSql = strSql &amp; \" COLCUDF.FinalActDate, \"\nstrSql = strSql &amp; \" PRI.Installation, \"\nstrSql = strSql &amp; \" COLCUDF.TCODate, \"\nstrSql = strSql &amp; \" COLCUDF.Notes \"\n</code></pre>\n"}, {"tags": ["c#", "excel", "vba", "closedxml"], "comments": [{"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1576709188, "post_id": 59394283, "comment_id": 104991107, "body": "Have you tested this code? If what you have up there is being run in VBA, I don&#39;t see how it would not cause an error as <code>worksheet.cell(Row, 12).Value</code> is not syntactically correct. Should be something like <code>ActiveSheet.Cells(Row, 12).Value = (ds.Tables(0).Rows(i)(&quot;NET_AMOUNT&quot;)</code>...assuming you have a variable <code>Row</code> declared/assigned somewhere above in your routine."}, {"owner": {"reputation": 3389, "user_id": 179494, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/84a553e463bb05113eca2d351ba4929c?s=128&d=identicon&r=PG", "display_name": "Francois Botha", "link": "https://stackoverflow.com/users/179494/francois-botha"}, "edited": false, "score": 0, "creation_date": 1576758783, "post_id": 59394283, "comment_id": 105006743, "body": "Why are you setting the data type to <code>XLDataType.Text</code>? If you want to apply number formats, your data type should be <code>XLDataType.Number</code>, obviously."}], "owner": {"reputation": 41, "user_id": 3821160, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c5055c540458c78a6f247b31021f938f?s=128&d=identicon&r=PG&f=1", "display_name": "Deep", "link": "https://stackoverflow.com/users/3821160/deep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 397, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576715742, "creation_date": 1576679676, "last_edit_date": 1576715742, "question_id": 59394283, "link": "https://stackoverflow.com/questions/59394283/formatting-text-number-as-in-closedxml-c", "title": "Formatting text/number as in ClosedXML C#", "body": "<p>How to format Text/Number in ClosedXML?</p>\n\n<p>My value in the datatable column is '2,063.000' </p>\n\n<pre><code>workSheet.Cell(Row, 12).Value = (ds.Tables(0).Rows(i)(\"NET_AMOUNT\")\n'workSheet.Cell(Row, 12).Style.NumberFormat.Format = \"0.000\"\n'workSheet.Cell(Row, 12).Style.NumberFormat.Format = \"00,000.000\"\n'workSheet.Cell(Row, 12).Style.NumberFormat.Format = \"#,##0.000\"\nworkSheet.Cell(Row, 12).DataType = XLDataType.Text\n</code></pre>\n\n<p>The result comes as '2,063'</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 1, "creation_date": 1576681070, "post_id": 59394122, "comment_id": 104978611, "body": "are you working in access or in excel?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1576681626, "post_id": 59394122, "comment_id": 104978959, "body": "Do you need VBA or could you do this with a helper column?"}], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1576685587, "last_edit_date": 1576685587, "creation_date": 1576681711, "answer_id": 59394877, "question_id": 59394122, "link": "https://stackoverflow.com/questions/59394122/how-to-connect-one-name-tag-to-multiple-row-in-access-vba/59394877#59394877", "title": "How to connect one name tag to multiple row in Access VBA", "body": "<p>The main issue is that MS Access treats data as an unordered set unless otherwise specified using an <code>order by</code> clause within a query.</p>\n\n<p>As such, when importing data from an external file into an MS Access table, you cannot rely on the order of the records in the resulting table matching those in the source file.</p>\n\n<p>Therefore, as in your case, if your data is wholly dependent upon the sequence in which certain identifier rows are encountered in the dataset, I would suggest using VBA to iterate over each row in the Excel spreadsheet in sequence, test for the presence of the 'identifier' row and assign its value to a variable, and then add each individual record to your target table.</p>\n\n<p>Here is a draft outline of such a program:</p>\n\n<pre><code>Function ImportData(strXLS As String)\n\n    Dim dbsCdb As DAO.Database\n    Dim rstRs1 As DAO.Recordset\n\n    Dim xlsApp As Excel.Application\n    Dim lngRow As Long\n    Dim strTag As String\n    Dim strTmp As String\n\n    Set xlsApp = New Excel.Application\n    Set dbsCdb = CurrentDb\n    Set rstRs1 = dbsCdb.OpenRecordset(\"Table1\")\n\n    With xlsApp\n        With .Workbooks.Open(strXLS)\n            With .Worksheets(\"Sheet1\")\n                strTag = .Cells(1, 1)\n                lngRow = 2\n                Do Until strTag = vbNullString\n                    strTmp = .Cells(lngRow, 1)\n                    If strTmp = vbNullString Then\n                        lngRow = lngRow + 1\n                        strTag = .Cells(lngRow, 1)\n                    Else\n                        rstRs1.AddNew\n                        rstRs1(\"Tag\") = strTag\n                        rstRs1(\"Field1\") = .Cells(lngRow, 2)\n                        rstRs1(\"Field2\") = .Cells(lngRow, 3)\n                        rstRs1(\"Field3\") = .Cells(lngRow, 4)\n                        rstRs1.Update\n                    End If\n                    lngRow = lngRow + 1\n                Loop\n            End With\n            .Close\n        End With\n        .Quit\n    End With\n\n    rstRs1.Close\n    Set rstRs1 = Nothing\n    Set dbsCdb = Nothing\n    Set xlsApp = Nothing\nEnd Function\n</code></pre>\n\n<p>Some prerequisites:</p>\n\n<ul>\n<li>Add a reference to <code>Microsoft Excel ##.0 Object Library</code></li>\n<li>Excel data is held in a worksheet called <code>Sheet1</code></li>\n<li>First 'tag' appears in cell <code>A1</code></li>\n<li>Target Access table is call <code>Table1</code></li>\n<li>MS Access <code>Table1</code> contains 4 fields: <code>Tag</code>, <code>Field1</code>, <code>Field2</code>, <code>Field3</code>.</li>\n</ul>\n\n<p>Supply with path to the Excel workbook, e.g.:</p>\n\n<pre><code>ImportData \"C:\\YourExcelFile.xlsx\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576683544, "post_id": 59395369, "comment_id": 104980077, "body": "Unfortunately you cannot rely on the data being imported in the same order in which it appears in the spreadsheet."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576683756, "post_id": 59395369, "comment_id": 104980191, "body": "Use it from Access and how you are connecting to the excel workbook as the source then rather than import.  I&#39;ll add to answer"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576683882, "post_id": 59395369, "comment_id": 104980260, "body": "How is it getting imported?"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576684297, "post_id": 59395369, "comment_id": 104980499, "body": "Using the Excel ActiveX object model."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576684872, "post_id": 59395369, "comment_id": 104980840, "body": "Can you show that in your original post, so we can see."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576685998, "post_id": 59395369, "comment_id": 104981520, "body": "@LeeMac try using the <code>transferspreadsheet</code> method instead into a table already created to hold the data with an autonumber  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.docmd.transferspreadsheet\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/&hellip;</a>"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576686120, "post_id": 59395369, "comment_id": 104981582, "body": "As noted, you cannot rely on the order of the data being retained using this method - MS Access deals in unordered sets."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576687242, "post_id": 59395369, "comment_id": 104982236, "body": "If you import line by line to a table with an autonumber, this should be avoidable as it will occur in the Excel order and the autonumber will be applied, then the sql solution would apply.  Where the SQL could be the population of the final table."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576687730, "post_id": 59395369, "comment_id": 104982491, "body": "Where are you importing line by line?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1576688008, "post_id": 59395369, "comment_id": 104982659, "body": "Your code is, so you could add an autonumber to the table and then use SQL to manipulate it."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 1, "creation_date": 1576771833, "post_id": 59395369, "comment_id": 105013899, "body": "@LeeMac Apologies.  I misread your answer as the original post, hence yesterday&#39;s confusion :o)  It was a long day."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1576686218, "last_edit_date": 1576686218, "creation_date": 1576683284, "answer_id": 59395369, "question_id": 59394122, "link": "https://stackoverflow.com/questions/59394122/how-to-connect-one-name-tag-to-multiple-row-in-access-vba/59395369#59395369", "title": "How to connect one name tag to multiple row in Access VBA", "body": "<p>You could import them into a table with an autonumber <code>ID</code>, so you get something like so</p>\n\n<p><a href=\"https://i.stack.imgur.com/m9qcL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m9qcL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then you could use the following SQL to give the desired output</p>\n\n<pre><code>SELECT \np.new_category,\nz.txtField1,\nz.txtField2,\nz.ID,\np.new_id\nFROM tblSource as z\nleft join\n(\nSELECT \n(select x.txtField1 from tblSource as x where x.ID=y.id+1) as new_ID,\ny.txtField1 as new_category\nFROM tblSource as y\nWHERE (((y.[txtfield2]) Is Null))\n) as p\non \nz.txtfield1=p.new_ID\nwhere z.txtfield2 is not null\norder by z.id \n</code></pre>\n\n<p>this gives</p>\n\n<p><a href=\"https://i.stack.imgur.com/jvIXE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jvIXE.png\" alt=\"enter image description here\"></a></p>\n\n<p>I used the following in Access to import the data</p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, _\n             acSpreadsheetTypeExcel12, _\n             \"tblSource\", _\n             \"C:\\Databases\\excel_test.xlsx\", _\n             True\n</code></pre>\n\n<p>My table is designed as follows</p>\n\n<p><a href=\"https://i.stack.imgur.com/xAjSO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xAjSO.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 42, "user_id": 11074181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t4vrS.jpg?s=128&g=1", "display_name": "Danielz", "link": "https://stackoverflow.com/users/11074181/danielz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 59394877, "answer_count": 2, "score": 0, "last_activity_date": 1576686218, "creation_date": 1576679146, "last_edit_date": 1576680238, "question_id": 59394122, "link": "https://stackoverflow.com/questions/59394122/how-to-connect-one-name-tag-to-multiple-row-in-access-vba", "title": "How to connect one name tag to multiple row in Access VBA", "body": "<p>I'm reading an Excel file to an Access table but im stuck with normalizing the table \nfrom this: </p>\n\n<pre><code>ALPHA\n3110 JOT01E000004506 okt.\n3110 JOT01E000004506 nov.\n3110 JOT01E000004506 dec.\n---empty row --\nBETA\n3112 JOT01E000004506 okt.\n3112 JOT01E000004506 nov.\n3112 JOT01E000004506 dec.\n</code></pre>\n\n<p>To This:</p>\n\n<pre><code>ALPHA 3110 JOT01E000004506 okt.\nALPHA 3110 JOT01E000004506 nov.\nALPHA 3110 JOT01E000004506 dec.\nBETA  3112 JOT01E000004506 okt.\nBETA  3112 JOT01E000004506 nov.\nBETA  3112 JOT01E000004506 dec.\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "report"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1576678229, "post_id": 59393825, "comment_id": 104976971, "body": "Have you tried doing this without code? You should be able to feed this to a report with a page break and generate a multipage report"}, {"owner": {"reputation": 3, "user_id": 8077606, "user_type": "registered", "profile_image": "https://graph.facebook.com/1713371812021374/picture?type=large", "display_name": "Amro El Gherianii \u30c3", "link": "https://stackoverflow.com/users/8077606/amro-el-gherianii-%e3%83%83"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1576680012, "post_id": 59393825, "comment_id": 104977983, "body": "the reports have identical labels but ofcourse the values shuld be different, and ofcourse the number of reports is not fixed since there can be different number of students depending on conditions in the stored procedure. I have done a bit of searching on what you mentioned, but don&#39;t think it solves what I am asking for. of you&#39;re sure it does please elaborate because im kinda clueless and new to this."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 4, "creation_date": 1576681233, "post_id": 59393825, "comment_id": 104978731, "body": "If you have five records, you should be able to create one report that uses the dataset and generates one report with five pages, each page containing different information from the dataset. Please do some experimentation with MS Access reports. You shouldn&#39;t need to use any VBA for this."}, {"owner": {"reputation": 85575, "user_id": 880990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/123d02be3a4fb6074b72b7e28bc05bad?s=128&d=identicon&r=PG", "display_name": "Olivier Jacot-Descombes", "link": "https://stackoverflow.com/users/880990/olivier-jacot-descombes"}, "edited": false, "score": 0, "creation_date": 1576703996, "post_id": 59393825, "comment_id": 104989306, "body": "Use the table or query you used to create the recordset <code>rs</code> as data source of your report. Then you can set the control source of textboxes to the required fields. You can insert a page break or group by some field and insert group headers and footers. In the group header set &quot;Force New Page&quot; to &quot;Before Section&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1576702694, "last_edit_date": 1576702694, "creation_date": 1576695950, "answer_id": 59398594, "question_id": 59393825, "link": "https://stackoverflow.com/questions/59393825/populating-a-report-in-ms-access-via-vba/59398594#59398594", "title": "Populating a report in ms access via vba", "body": "<p>Cannot programmatically set Value property of controls on report. Use BOUND report and controls and ForceNewPage property of Detail section to force page break after each record. Use Page Header section for information that must repeat for each page, such as label with report title and textbox with =Date(), etc. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7560549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cbf5648a9ba8342ad2d5438acda49cf?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Beard", "link": "https://stackoverflow.com/users/7560549/jim-beard"}, "is_accepted": false, "score": 0, "last_activity_date": 1590559464, "creation_date": 1590559464, "answer_id": 62036462, "question_id": 59393825, "link": "https://stackoverflow.com/questions/59393825/populating-a-report-in-ms-access-via-vba/62036462#62036462", "title": "Populating a report in ms access via vba", "body": "<p>To expand slightly on June 7's answer, it is the \"Grouping\" property of the report that lets you make a multi-page report with a new page started for each student.  In the report properties, group on the student's (unique) ID.  Then, as suggested above, use the ForceNewPage property in the Group header or footer to put each new student on a new page.</p>\n"}], "owner": {"reputation": 3, "user_id": 8077606, "user_type": "registered", "profile_image": "https://graph.facebook.com/1713371812021374/picture?type=large", "display_name": "Amro El Gherianii \u30c3", "link": "https://stackoverflow.com/users/8077606/amro-el-gherianii-%e3%83%83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 721, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1590559464, "creation_date": 1576678112, "last_edit_date": 1576702575, "question_id": 59393825, "link": "https://stackoverflow.com/questions/59393825/populating-a-report-in-ms-access-via-vba", "title": "Populating a report in ms access via vba", "body": "<p>So I have a stored procedure in my database which I run from MS access using pass through query which returns a table. \nI access the table using a recordset \"rs\". I want to loop through recordset and for each row I want to create an instance of the report and populate textboxes.</p>\n\n<p>For example I want a report for each student that will have name, age, sex, etc. So it should be done by looping through recordset and creating a report for each student and filling in textboxes. I wrote this code to test for one textbox but have a strong feeling that I'm missing a lot. Any help would be very much appreciated </p>\n\n<pre><code>Dim i As Integer\ni = 0\n\nDo While Not rs.EOF\n    Dim rtp(i) As Report_DecemberProject\n    Set rpt(i) = New Report_DecemberProject\n    rpt(i).Text55.Value = rs.Fields(3)\n    rpt(i).Visible = True\n    i = i + 1\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1576703076, "post_id": 59399728, "comment_id": 104988993, "body": "Thanks, I have gone down this route and now have 5 functions to return the values however I was wondering is there a simple way to return the multiple values possibly as objects? I am able to return single strings and build the content required but as it is repeatedly checking the Exchange server it is low.   Also one additional error with this method if you know a way around this is I have a Alias as 12345 &amp; 123456 Whenever I try 12345 it fails to resolve? Any way to force this to pick the correct user? I will add a post with the new code..."}, {"owner": {"reputation": 66, "user_id": 3885588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10255d21459ebdce8647b949b5bc15a0?s=128&d=identicon&r=PG&f=1", "display_name": "baka_toroi", "link": "https://stackoverflow.com/users/3885588/baka-toroi"}, "reply_to_user": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "edited": false, "score": 0, "creation_date": 1576764945, "post_id": 59399728, "comment_id": 105010032, "body": "You&#39;re going about it the wrong way. You&#39;re running GetName every time you need the property of an object which calls CreateRecipient and Resolve on every item you want to retrieve.  Instead, try to create a function that returns a recipient object and then retrieve the desired properties from that object. Doing it that way you won&#39;t need to call resolve every single time which I&#39;m sure unnecessarily hammers the Exchange  server."}], "tags": [], "owner": {"reputation": 66, "user_id": 3885588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10255d21459ebdce8647b949b5bc15a0?s=128&d=identicon&r=PG&f=1", "display_name": "baka_toroi", "link": "https://stackoverflow.com/users/3885588/baka-toroi"}, "is_accepted": false, "score": 1, "last_activity_date": 1576701863, "creation_date": 1576701863, "answer_id": 59399728, "question_id": 59393607, "link": "https://stackoverflow.com/questions/59393607/lookup-gal-from-outlook/59399728#59399728", "title": "Lookup GAL from Outlook", "body": "<p>Have you checked the <code>CreateRecipient</code> namespace? <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.namespace.createrecipient\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/outlook.namespace.createrecipient</a></p>\n\n<p>You could try creating a <code>recipient</code> object passing the alias to the <code>CreateRecipient</code> method:</p>\n\n<pre><code>Set myNamespace = Application.GetNamespace(\"MAPI\")\nSet recip = myNamespace.CreateRecipient(\"YourAlias\")\nrecip.Resolve\n</code></pre>\n\n<p>You should of course check if your recipient was properly resolved by checking the <code>resolved</code> property:</p>\n\n<p><code>If recip.Resolved Then\n'Do something</code></p>\n\n<p>After you got your recipient you can create an Exchange User from it using the <code>GetExchangeUser</code> method from the <code>AdressEntry</code> property in your recipient object.</p>\n\n<pre><code>Set exchUser = recip.AddressEntry.GetExchangeUser\nDebug.Print exchUser.PrimarySmtpAddress\n</code></pre>\n\n<p>And I'm sure you can work it out from there!</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "is_accepted": false, "score": 0, "last_activity_date": 1576703442, "creation_date": 1576703442, "answer_id": 59400022, "question_id": 59393607, "link": "https://stackoverflow.com/questions/59393607/lookup-gal-from-outlook/59400022#59400022", "title": "Lookup GAL from Outlook", "body": "<p>I have been able to find a work around solution with the following function. </p>\n\n<pre><code>Function GetName(strAcc As String) As Variant\n\nDim lappOutlook As Outlook.Application\nDim lappNamespace As Outlook.Namespace\nDim lappRecipient As Outlook.Recipient\n\n'Dim strAcc As String\n\nDim maxTries As Long\nDim errCount As Long\n\nSet lappOutlook = CreateObject(\"Outlook.Application\")\nSet lappNamespace = lappOutlook.GetNamespace(\"MAPI\")\n\n\nSet lappRecipient = lappNamespace.CreateRecipient(strAcc)\n\nmaxTries = 2000\n\nOn Error GoTo errorResume\n\nRetry:\n\n    DoEvents\n\n    ' For testing error logic. No error with my Excel 2013 Outlook 2013 setup.\n    ' Should normally be commented out\n    'Err.Raise 287\n\n    lappRecipient.Resolve\n\nOn Error GoTo 0\n\n\nSet olAddrEntry = lappRecipient.AddressEntry\n\n\n\nIf lappRecipient.Resolved Then\n    Set olexchuser = olAddrEntry.GetExchangeUser\n\n    GetName = olexchuser.Name\nElse\n    GetName = \"Unable To Validate LDAP\"\nEnd If\n\nExitRoutine:\n\n    Set lappOutlook = Nothing\n    Set lappNamespace = Nothing\n    Set lappRecipient = Nothing\n\n    Exit Function\n\nerrorResume:\n\n    errCount = errCount + 1\n\n    ' Try until Outlook responds\n    If errCount &gt; maxTries Then\n\n        ' Check if Outlook is there and Resolve is the issue\n        lappNamespace.GetDefaultFolder(olFolderInbox).Display\n        GoTo ExitRoutine\n\n    End If\n\n    'Debug.Print errCount &amp; \" - \" &amp; Err.Number &amp; \": \" &amp; Err.Description\n    Resume Retry\n\nEnd Function\n</code></pre>\n\n<p>Is there a way to return the following Exchange Values to consolidate the function so it only looks in the exchange server once ?</p>\n\n<p>Obtain .Name\n.PrimarySmtpAddress\n.Manager\n.Manager.PrimarySmtpAddress\n.Manager.Alias</p>\n\n<p>I then loop through and Get Managers, Manager &amp; Email. </p>\n\n<p>I use the following SUB to be able to pull the information needed (Into a message box while building but the data will populate a table once finished).</p>\n\n<pre><code>Sub GetDetails()\nDim Name As String, Email As String, Manager As String, ManagersEmail As String, MD As String, MDEmail As String, Lookup As String\n\nLookup = GetManagerAlias(\"3511931\")    '(\"3359820\")\n\nName = GetName(Lookup)\nEmail = GetEmail(Lookup)\nManager = GetManager(Lookup)\nManagersEmail = GetManagersEmail(Lookup)\nMD = GetManager(GetManagerAlias(Lookup))\nMDEmail = GetManagersEmail(GetManagerAlias(Lookup))\n\nMsgBox Name &amp; vbNewLine &amp; Email &amp; vbNewLine &amp; Manager &amp; vbNewLine &amp; ManagersEmail &amp; vbNewLine &amp; MD &amp; vbNewLine &amp; MDEmail\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4021883, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/512303933/picture?type=large", "display_name": "Alan Treanor", "link": "https://stackoverflow.com/users/4021883/alan-treanor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576788844, "creation_date": 1576677482, "last_edit_date": 1576788844, "question_id": 59393607, "link": "https://stackoverflow.com/questions/59393607/lookup-gal-from-outlook", "title": "Lookup GAL from Outlook", "body": "<p>I am building a tool which is required to look up the GAL in Outlook to find a certain employee and return their email address, their manager &amp; manager's email address &amp; finally their manager &amp; manager's email address. </p>\n\n<p>I found code and adjusted it to search for a person's name; however, if you have two Bob Smiths I require this to be more specific in its search, either by email address or by alias. </p>\n\n<p>Any code I found creates an array with all users in the exchange server; however, with millions of employee records this takes a large amount of time and this would run once per week to update the information. </p>\n\n<p>Is there a way to search ideally by alias or secondly by SMTP email address? </p>\n\n<p>I found versions of the code and I modified them to suit my requirements but still unable to find by alias or email address. If I do this manually I can click on advance search and type the alias or I click on \"more columns\" and search the alias and the correct result appears. </p>\n\n<p>Can I define \"More Columns\" in the VBA code?</p>\n\n<pre><code>    Dim myolApp As Outlook.Application\n    Dim myNameSpace As Namespace\n    Dim myAddrList As AddressList\n    Dim myAddrEntry As AddressEntry\n    Dim AliasName As String\n    Dim i As Integer, r As Integer\n    Dim c As Range\n    Dim EndRow As Integer, n As Integer\n    Dim exchUser As Outlook.ExchangeUser\n\n    Set myolApp = CreateObject(\"Outlook.Application\")\n    Set myNameSpace = myolApp.GetNamespace(\"MAPI\")\n    Set myAddrList = myNameSpace.AddressLists(\"Global Address List\")\n    Dim FullName As String, LastName As String, FirstName As String\n    Dim LDAP As String, PhoneNum As String\n    Dim StartRow As Integer\n\n    EndRow = Cells(Rows.Count, 1).End(xlUp).Row\n\n    StartRow = 2\n\n    For Each c In Range(\"I\" &amp; StartRow &amp; \":I\" &amp; CStr(EndRow))\n        AliasName = LCase(Trim(c))\n        c = AliasName\n        Set myAddrEntry = myAddrList.AddressEntries(AliasName)\n        Set exchUser = myAddrEntry.GetExchangeUser\n\n        If Not exchUser Is Nothing Then\n            c.Offset(0, 1) = exchUser.FirstName\n            c.Offset(0, 2) = exchUser.LastName\n            c.Offset(0, 3) = exchUser.Alias\n            c.Offset(0, 4) = exchUser.PrimarySmtpAddress\n            c.Offset(0, 5) = exchUser.Manager\n           'etc...\n        End If\n    Next c\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1576679757, "post_id": 59393205, "comment_id": 104977828, "body": "You need to show more code in the question"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 2, "creation_date": 1576679849, "post_id": 59393205, "comment_id": 104977886, "body": "instead of looping a range try <code>Range.Find method</code>"}, {"owner": {"reputation": 5, "user_id": 12398800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b8fa6a9fc1943c087878ebdef24bb5e?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/12398800/dan"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576684876, "post_id": 59393205, "comment_id": 104980843, "body": "@Warcupine I added the references and it doesn&#39;t error now but it seems to just delete the table itself instead of copying it to the other page. Thats something else that i can trouble shoot but still its progress so thank you very much"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576685563, "post_id": 59393205, "comment_id": 104981264, "body": "Based on your snippet, your loop doesn&#39;t appear to be searching for anything, just copying a static range to the new rows. If <code>Range(&quot;M3:Y10&quot;).value</code> is blank then it will wipe out whatever was in the looped ranges. The right side of the <code>=</code> shouldn&#39;t be deleted though, if that is the tables."}, {"owner": {"reputation": 5, "user_id": 12398800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b8fa6a9fc1943c087878ebdef24bb5e?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/12398800/dan"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1576751254, "post_id": 59393205, "comment_id": 105003105, "body": "@Warcupine The code i posted is within another function that handles all the searching. The mistake i made was the values on either side of the equals sign, its all sorted now. Thank you a million times over for your help :). If you would like post an answer and i can tick it for you"}], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 0, "last_activity_date": 1576760358, "creation_date": 1576760358, "answer_id": 59410287, "question_id": 59393205, "link": "https://stackoverflow.com/questions/59393205/copy-multiple-rows-from-one-excel-file-to-another-using-vba/59410287#59410287", "title": "Copy multiple rows from one excel file to another using VBA", "body": "<p><code>Cells(Counter, \"A\")</code>, <code>Cells(Counter, \"M\")</code>, and <code>Range(\"M3:Y10\")</code> have no Workbook or Worksheet, so it is defaulting to the active one.</p>\n\n<pre><code>d = c + 7\nFor Counter = c To d\n    with objWorkbook.Sheets(\"Sheetname\")\n       'Not sure what the other workbook and sheet are called\n       OtherWorkbook.Sheets(\"SheetnameHere\").Range(\"M3:Y10\").Value = .Range(.Cells(Counter, \"A\"), .Cells(Counter, \"M\")).Value \n    end with\nNext\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12398800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b8fa6a9fc1943c087878ebdef24bb5e?s=128&d=identicon&r=PG&f=1", "display_name": "dan", "link": "https://stackoverflow.com/users/12398800/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 59410287, "answer_count": 1, "score": 0, "last_activity_date": 1576760358, "creation_date": 1576676146, "last_edit_date": 1576676584, "question_id": 59393205, "link": "https://stackoverflow.com/questions/59393205/copy-multiple-rows-from-one-excel-file-to-another-using-vba", "title": "Copy multiple rows from one excel file to another using VBA", "body": "<p>I have a large excel file (Around 10 MB) that is written out as a very long list of tables. I want to create a macro on a separate file that searches through the first file for a certain value and then returns the appropriate table. So far i have gotten the search functionality to work and i can return a single cell using offset, but when i go to return multiple records i receive a couple of different errors.</p>\n\n<p>The section of the code i am currently trying to use to copy the cells is:</p>\n\n<pre><code>d = c + 7\nFor Counter = c To d\n    objWorkbook.Sheets(\"Sheetname\").Range(Cells(Counter, \"A\"), Cells(Counter, \"M\")).Value = Range(\"M3:Y10\").Value\nNext\n</code></pre>\n\n<p>In this case it should take each row and copy it to the section specified ( c is the cell currently being checked and d is the row number of the bottom of each seperate table) but instead i get the following error:</p>\n\n<blockquote>\n  <p>Run-time error '1004'\n  Application-defined or object-defined error</p>\n</blockquote>\n\n<p>I am fairly new at using VBA so i'm not sure if the error is very simple and i'm just not seeing it properly.</p>\n"}, {"tags": ["excel", "vba", "user-defined-functions", "transpose", "type-mismatch"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576677780, "post_id": 59393198, "comment_id": 104976728, "body": "Is index a row,column argument, where you&#39;re passing an array?"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1576677864, "post_id": 59393198, "comment_id": 104976775, "body": "The Application.Index function is expecting an integer for arguments 2 and 3, not a string or variant. This is where the type mismatch is coming from rather than passing a string &gt;255 characters. <a href=\"https://usefulgyaan.wordpress.com/2013/06/12/vba-trick-of-the-week-slicing-an-array-without-loop-application-index/\" rel=\"nofollow noreferrer\">usefulgyaan.wordpress.com/2013/06/12/&hellip;</a> whereas if you are looking for the string within the array then an Index/Match function should probably be used instead"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576677954, "post_id": 59393198, "comment_id": 104976828, "body": "@Nathan_Sav Sorry i did not understand what you meant. Do you mean, whether i am passing 1 dimension or 2 dimensions of the array? I am just passing the array created from an Excel Range containing the data."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576677991, "post_id": 59393198, "comment_id": 104976843, "body": "You are passing an array into the argument that is for the column."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1576678068, "post_id": 59393198, "comment_id": 104976887, "body": "Yes, it works with most ranges where the text in certain cells in &lt;=255. If it exceeds this limit, i get the Type Mismatch error. So i am sure it has to do with the &gt;255 Character limit being hit."}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576684387, "post_id": 59393198, "comment_id": 104980548, "body": "@Nathan_Sav, i have shared a sample excel and ppt template for your perusal."}], "answers": [{"comments": [{"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "edited": false, "score": 0, "creation_date": 1576680966, "post_id": 59393787, "comment_id": 104978555, "body": "It still doesnt work for me. I am splitting an Array created from a range of rows into set of &lt;=10 rows each to dump into slide tables.If the text in the 2nd column of the range exceeds 255 characters, the code gives the <code>Type Mismatch error</code>. Otherwise works fine. Do you want me to share a sample workbook and ppt template for your perusal?"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1576678031, "creation_date": 1576678031, "answer_id": 59393787, "question_id": 59393198, "link": "https://stackoverflow.com/questions/59393198/custom-index-function-that-can-handle-greater-than-255-characters/59393787#59393787", "title": "Custom INDEX function that can handle greater than 255 Characters", "body": "<pre><code>Dim a(1 To 2, 1 To 2) As String\nDim o As String\n\na(1, 2) = \"testing \" &amp; String(255, \"x\")\n\no = Application.Index(a, 1, 2)\n\nDebug.Print Len(o)\n</code></pre>\n\n<p>To support my comment, you are not using <code>index</code> correctly.  I think you'll need to use your <code>Array(1, 2)(0)</code> and <code>Array(1, 2)(1)</code></p>\n"}, {"tags": [], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "is_accepted": true, "score": 0, "last_activity_date": 1576742784, "creation_date": 1576742784, "answer_id": 59405549, "question_id": 59393198, "link": "https://stackoverflow.com/questions/59393198/custom-index-function-that-can-handle-greater-than-255-characters/59405549#59405549", "title": "Custom INDEX function that can handle greater than 255 Characters", "body": "<p>Interestingly, though strange enough, i found that as the <code>Arr</code> is defined as a Variant and pulls in Range data .e.g.</p>\n\n<pre><code>Arr = Sheet1.Range(\"A3:B8\").Formula    ' a Variant/Variant array\n</code></pre>\n\n<p><code>INDEX</code>, <code>TRANSPOSE</code>, <code>MATCH</code> etc., will not work and result in <code>Type MisMatch Error</code> on hitting the >255 Characters limit. I think it internally uses an <code>Integer index</code> and therefore maintains a 255 character limit.</p>\n\n<p>However, if i defined the Array <code>Arr</code> as a <code>String</code>:</p>\n\n<pre><code>' Define Arr as a String\nReDim Arr(1 To UBound(VarRng.Formula, 1), 1 To UBound(VarRng.Formula, 2)) As String\n\nFor x = LBound(VarRng.Formula, 1) To UBound(VarRng.Formula, 1)\n     For y = LBound(VarRng.Formula, 2) To UBound(VarRng.Formula, 2)\n        Arr(x, y) = CStr(VarRng.Formula(x, y))\n    Next y\nNext x\n</code></pre>\n\n<p>'...then <code>INDEX</code>, <code>TRANSPOSE</code>, <code>MATCH</code> etc., will work properly, even though there are >255 Characters in the Array.</p>\n\n<pre><code>' Define Arr as a String\nReDim Arr(1 To UBound(VarRng.Formula, 1), 1 To UBound(VarRng.Formula, 2)) As String\n\nFor x = LBound(VarRng.Formula, 1) To UBound(VarRng.Formula, 1)\n     For y = LBound(VarRng.Formula, 2) To UBound(VarRng.Formula, 2)\n        Arr(x, y) = CStr(VarRng.Formula(x, y))\n    Next y\nNext x\n`Arr` is now a Variant/String\n'....\n'....\nFor j = 1 to NoOfSlides\n    A = (j - 1) * (nRw * 2) + 1\n    B = IIf(A &gt;= UBound(Arr, 1), UBound(Arr, 1), (A + (nRw * 2)) - 1)\n    If B &gt; UBound(Arr, 1) Then B = UBound(Arr, 1)\n    ab_Rng = Evaluate(\"row(\" &amp; A &amp; \":\" &amp; B &amp; \")\")\n\n    TmpArr(j) = Application.Index(Arr, ab_Rng, Array(1, 2))\n'....\nNext j\n</code></pre>\n\n<p><a href=\"https://drive.google.com/open?id=1dNPyGOzXDsKhjKKUvFJXOU4AShLuvfCvjC6Q0OQ_4_w\" rel=\"nofollow noreferrer\">Sample.xlsm</a> and <a href=\"https://drive.google.com/open?id=1szYmwAo7eHyEDLq6u3tEcWFK5iFKdJaH4Q6EV6Z6lO8\" rel=\"nofollow noreferrer\">PPT Sample Template.pptx</a></p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 1, "accepted_answer_id": 59405549, "answer_count": 2, "score": 0, "last_activity_date": 1576742784, "creation_date": 1576676117, "last_edit_date": 1576683638, "question_id": 59393198, "link": "https://stackoverflow.com/questions/59393198/custom-index-function-that-can-handle-greater-than-255-characters", "title": "Custom INDEX function that can handle greater than 255 Characters", "body": "<p>I am trying to use the <code>Application.Index</code> function with an variant 2D Array which contains some elements having >255 characters of text. This results in Variant/Integer Type <code>Type Mismatch</code> error. I am also unable to use <code>Application.Transpose</code> because of hitting this >255 characters limit.</p>\n\n<p>Has anyone made any <code>Custom INDEX UDFunction</code> that can handle >255 characters of text to overcome this limit?</p>\n\n<p>e.g. \n<a href=\"https://i.stack.imgur.com/oKn32.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oKn32.png\" alt=\"Type Mismatch Error\"></a></p>\n\n<p>The snippet code looks like this:</p>\n\n<pre><code>........\n........\nFor j = 1 to NoOfSlides\n    A = (j - 1) * (nRw * 2) + 1\n    B = IIf(A &gt;= UBound(Arr, 1), UBound(Arr, 1), (A + (nRw * 2)) - 1)\n    If B &gt; UBound(Arr, 1) Then B = UBound(Arr, 1)\n    ab_Rng = Evaluate(\"row(\" &amp; A &amp; \":\" &amp; B &amp; \")\")\n    TmpArr(j) = Application.Index(Arr, ab_Rng, Array(1, 2))  ' Type Mismatch Error\n    With oPres\n        Set oSlide = .slides(\"Slide0_ABC\").Duplicate\n        oSlide.moveto toPos:=.slides.Count\n        With oSlide\n        ....\n        End With\n\n        If getDimensions(TmpArr(j))&lt;2 Then \n            TmpArr(j) = Application.Transpose(TransposeDim(TmpArr(j)) )    ' Error\n        End If\n        For y = LBound(TmpArr(j), 1) To UBound(TmpArr(j), 1)\n        .....\n        Next y\n    End With\nNext j\n........\n........\n\nFunction getDimensions(var As Variant) As Long\n    On Error GoTo Err\n\n    Dim i As Long\n    Dim tmp As Long\n\n    i = 0\n    Do While True\n        i = i + 1\n        tmp = UBound(var, i)\n    Loop\n\nErr:\n    getDimensions = i - 1\n    On Error GoTo 0\n    Err.Clear\n\nEnd Function\n\n\nFunction TransposeDim(v As Variant) As Variant\n' Convert 1D Array to 2D Array (1 -Based)\n    Dim x As Long, y As Long, Xupper As Long, Yupper As Long\n    Dim tempArray As Variant\n\n    on error resume next\n    Xupper = UBound(v, 2)\n    if err.number &lt;&gt;0 then\n        Redim Preserve v(1 to ubound(v), 1 to 1)\n       Xupper = UBound(v, 2)   \n    endif\n    on error goto 0\n\n    Yupper = UBound(v, 1)\n\n    ReDim tempArray(1 To Xupper, 1 To Yupper)\n    For x = 1 To Xupper\n        For y = 1 To Yupper\n            tempArray(x, y) = v(y, x)\n        Next y\n    Next x\n\n    TransposeDim = tempArray\nEnd Function\n</code></pre>\n\n<p><strong>Edit:</strong>\nHere is a <a href=\"https://drive.google.com/open?id=14rTKm-25uWT1ZNm013iwzk8lf4hxINEJmvZzCRgxUp8\" rel=\"nofollow noreferrer\">Sample.xlsm file</a> and a <a href=\"https://drive.google.com/open?id=1szYmwAo7eHyEDLq6u3tEcWFK5iFKdJaH4Q6EV6Z6lO8\" rel=\"nofollow noreferrer\">Sample PPT Template</a> for anyone's perusal.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1576672972, "post_id": 59392267, "comment_id": 104974260, "body": "Loop over the array use a simple <code>For...</code> loop?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 2, "creation_date": 1576673581, "post_id": 59392267, "comment_id": 104974549, "body": "To find data in a range, use <code>Range.Find</code> method. That&#39;s what its designed for."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 6223875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1abbe3c654286ef64fff61e235ab5101?s=128&d=identicon&r=PG&f=1", "display_name": "Dames", "link": "https://stackoverflow.com/users/6223875/dames"}, "edited": false, "score": 1, "creation_date": 1576674032, "post_id": 59392348, "comment_id": 104974787, "body": "Thank you - this is exactly what I was looking for!"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 1, "creation_date": 1576679340, "post_id": 59392348, "comment_id": 104977580, "body": "@SJR, super useful method, especially in python! +1"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 5, "last_activity_date": 1576675945, "last_edit_date": 1576675945, "creation_date": 1576673046, "answer_id": 59392348, "question_id": 59392267, "link": "https://stackoverflow.com/questions/59392267/return-the-row-number-of-a-match-in-a-2d-array/59392348#59392348", "title": "Return the row number of a match in a 2d array", "body": "<p>If you want to avoid a loop, you can slice an array, thus:</p>\n\n<pre><code>Sub x()\n\n  Dim arr As Variant, v As Variant\n\n  arr = Range(\"A1\").CurrentRegion\n  v = Application.Match(\"Tomato\", Application.Index(arr, , 1), 0) 'look in first column\n  If IsNumeric(v) Then MsgBox v\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6223875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1abbe3c654286ef64fff61e235ab5101?s=128&d=identicon&r=PG&f=1", "display_name": "Dames", "link": "https://stackoverflow.com/users/6223875/dames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 59392348, "answer_count": 1, "score": 0, "last_activity_date": 1576676033, "creation_date": 1576672783, "last_edit_date": 1576676033, "question_id": 59392267, "link": "https://stackoverflow.com/questions/59392267/return-the-row-number-of-a-match-in-a-2d-array", "title": "Return the row number of a match in a 2d array", "body": "<p>I've tried to find a solution to this online and for whatever reason simply cannot locate anything (perhaps my search skills are lacking).  I have what I feel is a fairly simple query.</p>\n\n<p>I am declaring an array and assigning data to it using the following, which I have confirmed is working:</p>\n\n<pre><code>Dim arr As Variant\narr = Sheet.Range(\"A1\").CurrentRegion\n</code></pre>\n\n<p>Now, given that this is a 2-dimensional array (only 2 columns of data), I want to then use a match-type of function to return the row number associated with a value in column 1 of the array.  My end goal is to then use that to call the corresponding value in column 2 of the array - essentially building an index/match type of scenario but in VBA.  However, the Application.Match function fails as this isn't a 1-dimensional array.  See example below:</p>\n\n<pre><code>1|Apple   |Fruit\n2|Tomato  |Fruit\n3|Carrot  |Vegetable\n4|Zucchini|Vegetable\n</code></pre>\n\n<p>What I am trying to achieve is something like MATCH(\"Tomato\", arr(), 0) to get the result of \"2\" being the row number associate with Tomato.  I only need to do my search in column 1 of the array.  Does anyone perhaps have any suggestions on the easiest way to do this?</p>\n\n<p>Thanks a mil!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1576743704, "post_id": 59396586, "comment_id": 104999393, "body": "Is there a way to divide names in B &amp; C columns.ex: in B1 cell LUCY and M , then combine divided names in  B and C columns ex:LOUIS and MORRONE as LOUIS MORRONE and then compare with E1 value.Then we can find match.How to code it for whole range of B &amp; C columns and then compare with E1 value."}, {"owner": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1576743860, "post_id": 59396586, "comment_id": 104999444, "body": "Can anyone help me how to do it."}, {"owner": {"reputation": 176, "user_id": 12434668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCaEB8JukpYY97_kcyIjC0UBveeT9HIki4UgxD5=k-s128", "display_name": "rmbradburn", "link": "https://stackoverflow.com/users/12434668/rmbradburn"}, "reply_to_user": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1576775325, "post_id": 59396586, "comment_id": 105015701, "body": "You could use this formula in the column after the last name to create a column of full names: <code>=TEXTJOIN(&quot; &quot;,TRUE,IFERROR(LEFT(B1,SEARCH(&quot; &quot;,B1)-1),B1),C1)</code> Then this in F1 to search for your entry in E1: <code>=COUNTIF($D$1:$D$5,E3)</code>"}, {"owner": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1576784394, "post_id": 59396586, "comment_id": 105019255, "body": "Thanks rmbradburn.If possible can you implement the formula in code and provide full code for the process.I am new to vba and not aware much on coding part."}, {"owner": {"reputation": 176, "user_id": 12434668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCaEB8JukpYY97_kcyIjC0UBveeT9HIki4UgxD5=k-s128", "display_name": "rmbradburn", "link": "https://stackoverflow.com/users/12434668/rmbradburn"}, "reply_to_user": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1576797998, "post_id": 59396586, "comment_id": 105023527, "body": "I&#39;ve edited the VBA in my answer above to add this functionality."}, {"owner": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1576826422, "post_id": 59396586, "comment_id": 105029024, "body": "for some names in c column ex: we will get like lucy in b column and M MORRONE in c column in that case how to divide name in c column and then combine both b and c columns name and then compare with e column name.if  approach like these  how to solve  it."}, {"owner": {"reputation": 176, "user_id": 12434668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCaEB8JukpYY97_kcyIjC0UBveeT9HIki4UgxD5=k-s128", "display_name": "rmbradburn", "link": "https://stackoverflow.com/users/12434668/rmbradburn"}, "reply_to_user": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1577374748, "post_id": 59396586, "comment_id": 105155257, "body": "I&#39;ve edited the code above to accommodate the potential of an extra initial in Column C."}, {"owner": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "edited": false, "score": 0, "creation_date": 1577671444, "post_id": 59396586, "comment_id": 105220814, "body": "When i run the above code its showing no match found.when the names are exact matched .I am facing difficulty to understand the above logic."}], "tags": [], "owner": {"reputation": 176, "user_id": 12434668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCaEB8JukpYY97_kcyIjC0UBveeT9HIki4UgxD5=k-s128", "display_name": "rmbradburn", "link": "https://stackoverflow.com/users/12434668/rmbradburn"}, "is_accepted": false, "score": 0, "last_activity_date": 1577374692, "last_edit_date": 1577374692, "creation_date": 1576687350, "answer_id": 59396586, "question_id": 59391570, "link": "https://stackoverflow.com/questions/59391570/to-compare-names-in-two-cells-by-comparing-first-name-lastname-or-middlename-is/59396586#59396586", "title": "to compare names in two cells by comparing first name,lastname or middlename is matched or not.upto 70 % match using vba code", "body": "<p>I think this code will answer your specific question with the specific data you provided:</p>\n\n<pre><code>Sub CompareNames()\n\nDim FirstName, FullName, cell As Range\nDim i As Integer\nDim NameArray(4) As Variant\n\nSet FirstName = ActiveSheet.Range(\"B1:B5\")\nSet FullName = ActiveSheet.Range(\"E1\")\n\ni = 0\n\nFor Each cell In FirstName\n    If Len(cell) &gt; 0 Then\n        If InStr(cell, \" \") &gt; 0 And InStr(cell.Offset(0, 1), \" \") &gt; 0 Then\n            NameArray(i) = UCase(Left(cell.Value, InStr(cell.Value, \" \") - 1) &amp; \" \" &amp; Right(cell.Offset(0, 1).Value, Len(cell.Offset(0, 1)) - InStr(cell.Offset(0, 1).Value, \" \")))\n            i = i + 1\n        ElseIf InStr(cell, \" \") &gt; 0 Then\n            NameArray(i) = UCase(Left(cell.Value, InStr(cell.Value, \" \") - 1) &amp; \" \" &amp; cell.Offset(0, 1).Value)\n            i = i + 1\n        ElseIf InStr(cell.Offset(0, 1), \" \") &gt; 0 Then\n            NameArray(i) = UCase(cell.Value &amp; \" \" &amp; Right(cell.Offset(0, 1).Value, Len(cell.Offset(0, 1)) - InStr(cell.Offset(0, 1).Value, \" \")))\n            i = i + 1\n        Else\n            NameArray(i) = UCase(cell.Value &amp; \" \" &amp; cell.Offset(0, 1).Value)\n            i = i + 1\n        End If\n    End If\nNext\n\nIf UBound(Filter(NameArray, FullName)) &gt; -1 = True Then\n    MsgBox (\"Match Found\")\nElse\n    MsgBox (\"No Match Found\")\nEnd If\n</code></pre>\n\n<p>However, it sounds like you could more easily accomplish your task with a standard Excel function, albeit without the message box. For instance, you could enter the following in the cell adjacent to the full name:</p>\n\n<pre><code>=COUNTIFS($B$1:$B$5,LEFT(E1,SEARCH(\" \",E1)-1),$C$1:$C$5,RIGHT(E1,LEN(E1)-SEARCH(\" \",E1)))\n</code></pre>\n\n<p>Both of these assume that the list of first names is in B1:B5, last names are in C1:C5, and the full name you're testing is in E1. Also, notably, names must match exactly (i.e.: \"Lucy Morrone\" is not the same as \"Lucy M Morrone\", so no match will be detected.)</p>\n"}], "owner": {"reputation": 1, "user_id": 12550343, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Dfh1VF0rAcM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcBaJi4ijAHSsaSB-SLWfJ0XOCAGQ/photo.jpg?sz=128", "display_name": "prasad p", "link": "https://stackoverflow.com/users/12550343/prasad-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1577374692, "creation_date": 1576670328, "last_edit_date": 1576681480, "question_id": 59391570, "link": "https://stackoverflow.com/questions/59391570/to-compare-names-in-two-cells-by-comparing-first-name-lastname-or-middlename-is", "title": "to compare names in two cells by comparing first name,lastname or middlename is matched or not.upto 70 % match using vba code", "body": "<p><img src=\"https://i.stack.imgur.com/QjV2M.png\" alt=\"enter image description here\"></p>\n\n<p>in B&amp;c columns, we will first and last name, we need to match it with full name in E column if any match is found the need to popup message box as match found. I need it to be done using vba. As I am new to coding part I not aware much about it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1576670596, "post_id": 59391513, "comment_id": 104973027, "body": "Look at your function - you are missing an <code>end if</code>."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1576676597, "post_id": 59391513, "comment_id": 104976090, "body": "Quite some stuff to improve on in your code. One thing you might be interested in is <code>Range.Find</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 1, "last_activity_date": 1576670534, "creation_date": 1576670534, "answer_id": 59391625, "question_id": 59391513, "link": "https://stackoverflow.com/questions/59391513/vba-iterate-over-an-array-of-cells-to-get-an-password-depends-on-a-parameter/59391625#59391625", "title": "VBA- Iterate over an Array of Cells to get an Password depends on a parameter", "body": "<p>You are missing and end if here:</p>\n\n<pre><code>    For Each cell In pswarray\n        If cell = Merkmal Then\n            Password = (\"C\" &amp; zeile)\n            zeile = zeile + 1\n        End If '&lt;&lt;---- this was missing.\n    Next cell\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10755570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212746416445080/picture?type=large", "display_name": "Coliprii", "link": "https://stackoverflow.com/users/10755570/coliprii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 59391625, "answer_count": 1, "score": 0, "last_activity_date": 1576689734, "creation_date": 1576670169, "last_edit_date": 1576689734, "question_id": 59391513, "link": "https://stackoverflow.com/questions/59391513/vba-iterate-over-an-array-of-cells-to-get-an-password-depends-on-a-parameter", "title": "VBA- Iterate over an Array of Cells to get an Password depends on a parameter", "body": "<p>I want to iterate over a list filled with name (Merkmal) and Passwords.</p>\n\n<p>If I get the right name, the related password should be used to encode a new Excel  file.</p>\n\n<p>I got two kinds of errors:</p>\n\n<ol>\n<li>next without For</li>\n<li>If without ending if</li>\n</ol>\n\n<pre><code>Sub Copy2newfile()\n    zeile = 3\n    Dim aKopf As Range\n    Set aKopf = Range(\"A1:Y3\")\n    Dim Password As String\n\n    Do\n        ' Bereich kopieren\n        altezeile = zeile + 1\n        zeile = zeile + 1\n        Merkmal = Range(\"F\" &amp; zeile).Value\n        Do While Range(\"F\" &amp; zeile).Value = Merkmal\n            zeile = zeile + 1\n        Loop\n        zeile = zeile - 1\n        Range(\"A\" &amp; altezeile &amp; \":Y\" &amp; zeile).Copy\n\n        Password = generatePassword(Merkmal)\n\n\n        ' In neue Datei einf\u00fcgen\n        Workbooks.Add\n        ActiveSheet.Range(\"A4\").Select\n        ActiveSheet.Paste\n        ActiveSheet.Range(\"A1\").Select\n        aKopf.Copy\n        ActiveSheet.PasteSpecial\n\n\n        'Speichern und schlie\u00dfen\n        ActiveWorkbook.SaveAs \"C:\\Users\\1000len-4723\\Desktop\\Test_\" &amp; Merkmal &amp; \".xlsx\"\n        ActiveWindow.Close\n    Loop While Range(\"F\" &amp; zeile + 1).Value &lt;&gt; \"\"\n\nEnd Sub\n\nFunction generatePassword(Merkmal)\n    Dim zeile As Integer\n    Dim Password As String\n    Dim pswarray As Range\n    Dim cell As Range\n    Sheets(\"Tabelle2\").Select\n    zeile = 2\n    Set pswarray = Range(\"B\")\n\n    For Each cell In pswarray\n        If cell = Merkmal Then\n            Password = (\"C\" &amp; zeile)\n            zeile = zeile + 1\n    Next cell\n\nEnd Function\n</code></pre>\n\n<p>Can someone help me please?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1576669502, "post_id": 59391261, "comment_id": 104972519, "body": "When it faiils, what is the value of <code>selectionRangeAdress</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 1578360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f1a13ba8b64c26a00d0dd6707237583a?s=128&d=identicon&r=PG", "display_name": "JanZitniak", "link": "https://stackoverflow.com/users/1578360/janzitniak"}, "edited": false, "score": 0, "creation_date": 1576676782, "post_id": 59391536, "comment_id": 104976182, "body": "Thank you Plutian, now it works. I tried Application.EnableEvents = False and Application.EnableEvents = True before but Workbook_SheetSelectionChange stayed in previous infinite state so I had to restart Excel for working."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 1, "last_activity_date": 1576670231, "creation_date": 1576670231, "answer_id": 59391536, "question_id": 59391261, "link": "https://stackoverflow.com/questions/59391261/highlighting-rows-and-columns-by-activecell-in-excel-vba/59391536#59391536", "title": "Highlighting rows and columns by ActiveCell in Excel VBA", "body": "<p>Your issue is that you call this macro in a <code>SelectionChange</code> event. However this line:</p>\n\n<pre><code>Range(selectionRangeAdress).Select\n</code></pre>\n\n<p>Counts as a <code>SelectionChange</code> event, meaning it will call this macro. This means you call this macro within the macro, resulting in a recursive function until you run out of stack space and it errors out. To prevent this, add <code>Application.EnableEvents = False</code> at the start, and <code>True</code> at the end. This prevents any events firing while the macro runs, thus preventing the function to call itself in the middle of it.</p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\nApplication.EnableEvents = False\n    Call SetCellPosition\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 1578360, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f1a13ba8b64c26a00d0dd6707237583a?s=128&d=identicon&r=PG", "display_name": "JanZitniak", "link": "https://stackoverflow.com/users/1578360/janzitniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 59391536, "answer_count": 1, "score": 0, "last_activity_date": 1576719751, "creation_date": 1576669269, "last_edit_date": 1576719751, "question_id": 59391261, "link": "https://stackoverflow.com/questions/59391261/highlighting-rows-and-columns-by-activecell-in-excel-vba", "title": "Highlighting rows and columns by ActiveCell in Excel VBA", "body": "<p>My goal is create a VBA macro which highlights rows and columns by <code>ActiveCell</code>, so I programmed the following code:</p>\n\n<pre><code>Function Col_Letter(lngCol As Long) As String\n    Dim vArr\n    vArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\n    Col_Letter = vArr(0)\nEnd Function\n\nPublic Sub SetCellPosition()\n    Dim currentActiveCellAdress, columnLetter, rowRangeAddress, columnRangeAddress, selectionRangeAdress As String\n    Dim rowNumber As Long\n\n    columnLetter = Col_Letter(ActiveCell.Column)\n    rowNumber = ActiveCell.Row\n\n    rowRangeAddress = columnLetter &amp; \"1:\" &amp; columnLetter &amp; rowNumber\n    columnRangeAddress = \"A\" &amp; rowNumber &amp; \":\" &amp; columnLetter &amp; rowNumber\n    currentActiveCellAdress = ActiveCell.Address\n    selectionRangeAdress = rowRangeAddress &amp; \", \" &amp; columnRangeAddress\n\n    Debug.Print selectionRangeAdress\n    Debug.Print currentActiveCellAdress\n\n    Range(selectionRangeAdress).Select\n    Range(currentActiveCellAdress).Activate\n\nEnd Sub\n</code></pre>\n\n<p>That macro works well. But after calling that macro by <code>Workbook_SheetSelectionChange</code> </p>\n\n<pre><code>Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    Call SetCellPosition\nEnd Sub\n</code></pre>\n\n<p>it gives me an error, selection in sheet flashes between highlighting rows and columns by <code>ActiveCell</code> and first row, please see the pictures.</p>\n\n<p><a href=\"https://i.stack.imgur.com/tulRP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tulRP.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/Dg6ib.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dg6ib.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/7Qc4w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7Qc4w.png\" alt=\"enter image description here\"></a></p>\n\n<p>The macro can be downloaded <a href=\"https://www.janzitniak.info/subory/highlighting-rows-and-columns-by-activecell.xlsm\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Kind regards.</p>\n\n<p>Jan</p>\n"}, {"tags": ["vba", "internet-explorer", "webforms"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576701136, "post_id": 59391080, "comment_id": 104988309, "body": "Is this an internal /private url?"}], "answers": [{"comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1577435696, "post_id": 59392813, "comment_id": 105169018, "body": "@Ismail, can you please inform the status for this issue? If above answer solved the issue, then please try to accept the answer. If you found the solution by yourself then try to post your solution as an answer. If issue still persist then let us know about the current status for the issue. Thanks for your understanding."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1576674564, "creation_date": 1576674564, "answer_id": 59392813, "question_id": 59391080, "link": "https://stackoverflow.com/questions/59391080/vba-object-doesnt-support-property-or-method-when-filling-webform/59392813#59392813", "title": "VBA Object doesn&#39;t support property or method when filling webform", "body": "<p>Try to put '.' between class names like below is working on my side.</p>\n\n<pre><code> IE.Document.querySelector(\"input.ng-pristine.ng-valid.ng-touched\").Value = \"00000\"\n</code></pre>\n\n<p>Modified example:</p>\n\n<pre><code>Sub Macro1()\n\nDim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    Dim html As HTMLDocument\n\n\n    Set IE = New InternetExplorerMedium\n\n    'Set IE.Visible = True to make IE visible, or False for IE to run in the background\n    IE.Visible = True\n\n    'Define URL\n    URL = \"D:\\Backup20190913\\tests\\353.html\"\n\n    'Navigate to URL\n    IE.Navigate URL\n\n    ' Statusbar let's user know website is loading\n    Application.StatusBar = URL &amp; \" is loading. Please wait...\"\n\n    ' Wait while IE loading...\n    'IE ReadyState = 4 signifies the webpage has loaded (the first loop is set to avoid inadvertently skipping over the second loop)\n    Do While IE.ReadyState = 4: DoEvents: Loop   'Do While\n    Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n\n    Set html = IE.Document\n\n    IE.Document.querySelector(\"input.ng-pristine.ng-valid.ng-touched\").Value = \"00000\"\n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uYtbj.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uYtbj.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1576701592, "creation_date": 1576701592, "answer_id": 59399684, "question_id": 59391080, "link": "https://stackoverflow.com/questions/59391080/vba-object-doesnt-support-property-or-method-when-filling-webform/59399684#59399684", "title": "VBA Object doesn&#39;t support property or method when filling webform", "body": "<p>The error is as it says. The method you are trying does not exist for that node. You are fine using a multi-valued class  (more than one class name for the element; denoted by several strings separated by spaces within the class attribute of the element) inside of the correct method <code>getElementsByClassName</code>, rather than <code>getelemenetbyclassname</code> then you need to index into the returned collection in order to exercise the <code>.click</code> method.</p>\n\n<pre><code>IE.Document.getElementsByClassName(\"ng-pristine ng-valid ng-touched\")(0).Value = \"00000\" '0 for first node\n</code></pre>\n\n<p>However, as in other answer, if using <code>querySelector/querySelectorAll</code> to match by <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Class_selectors\" rel=\"nofollow noreferrer\">css class selector</a> then a multi-valued class must have the spaces between replaced with \".\". Better still, try to select as few of those class names inside the multi-value as possible and the most selective which still match on the required node(s)</p>\n\n<p>And please, I write this a lot on SO, use a proper page load wait:</p>\n\n<pre><code>While IE.busy Or IE.readystate &lt;&gt; 4: DoEvents: Wend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12558229, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156629259115778/picture?type=large", "display_name": "Ismail Kharmaj", "link": "https://stackoverflow.com/users/12558229/ismail-kharmaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576701592, "creation_date": 1576668546, "last_edit_date": 1576672078, "question_id": 59391080, "link": "https://stackoverflow.com/questions/59391080/vba-object-doesnt-support-property-or-method-when-filling-webform", "title": "VBA Object doesn&#39;t support property or method when filling webform", "body": "<p>I'm trying to use the <code>Excel VBA</code> to fill a <code>web form</code> and then scrape some data.</p>\n\n<p>I am stuck on how to put in the value that I want to search for.</p>\n\n<p>In the source code, there is no id or name that I can use.</p>\n\n<p>I tried with a class name but it is not working.</p>\n\n<pre><code>\n\" Source code:\n\n&lt;input type=\"text\" style=\"height: 28px; width: 170px; padding-left: 5px;\" ng-model=\"model.FieldValue\" placeholder=\"Enter a Value\" ng-show=\"model.searchOptions.length &amp;amp;&amp;amp; model.searchOptions != 'SQE Quote Id'\" class=\"ng-pristine ng-valid ng-touched\"&gt;\n\n\nSub Macro1()\n\nDim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    Dim html As HTMLDocument\n\n\n    Set IE = New InternetExplorerMedium\n\n    'Set IE.Visible = True to make IE visible, or False for IE to run in the background\n    IE.Visible = True\n\n    'Define URL\n    URL = \"xxxx\"\n\n    'Navigate to URL\n    IE.Navigate URL\n\n    ' Statusbar let's user know website is loading\n    Application.StatusBar = URL &amp; \" is loading. Please wait...\"\n\n    ' Wait while IE loading...\n    'IE ReadyState = 4 signifies the webpage has loaded (the first loop is set to avoid inadvertently skipping over the second loop)\n    Do While IE.ReadyState = 4: DoEvents: Loop   'Do While\n    Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n'\n    Set html = IE.Document\n    IE.Document.getElementById(\"searchOptions\").Click (2)\n    IE.Document.getElementById(\"searchOptions\").Value = \"Access Qref\"\n    IE.Document.getelemenetbyclassname(\"ng-pristine ng-valid ng-touched\").Value = \"00000\"\n\n\n'\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1576668422, "post_id": 59390872, "comment_id": 104971961, "body": "I have a feeling (at the risk of without seeing your data) that this could be achieved with formulas. Possible to see your data? Importantly, are you open to getting this solved with formulas?"}, {"owner": {"reputation": 11, "user_id": 12558162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ce9cccdb95261429733f0b028fd08f?s=128&d=identicon&r=PG&f=1", "display_name": "Tilak Dugar", "link": "https://stackoverflow.com/users/12558162/tilak-dugar"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576671618, "post_id": 59390872, "comment_id": 104973558, "body": "@SiddharthRout Yes, I was able to find the answer for a particular user, however I believe to be able to automate it to return answers for all the users, I&#39;ll have to use VBA macros. Happy to be corrected if not?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576674907, "post_id": 59390872, "comment_id": 104975223, "body": "So if I am not wrong this can be solved using a helper column. Also I am guessing the other set of data where the user makes choices are the headers like <code>Apartment, small house... etc</code>?if yes then the best way to do this and I might be wrong is to have only YES/NO values in the above table. In the helper column simply use a formula to match and count the characteristics and pull that formula down."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576675672, "post_id": 59390872, "comment_id": 104975586, "body": "Let me know if you are interested in an example using the above YES/NO method?"}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 12434668, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCaEB8JukpYY97_kcyIjC0UBveeT9HIki4UgxD5=k-s128", "display_name": "rmbradburn", "link": "https://stackoverflow.com/users/12434668/rmbradburn"}, "is_accepted": false, "score": 0, "last_activity_date": 1576693190, "creation_date": 1576693190, "answer_id": 59398014, "question_id": 59390872, "link": "https://stackoverflow.com/questions/59390872/how-to-count-matches-in-each-row-against-value-in-another-row/59398014#59398014", "title": "How to count matches in each row against value in another row?", "body": "<p>Tilak, consider this option in the vein of Siddharth's recommendation to use a helper column (or two) to solve this through functions rather than VBA:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SSNFJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SSNFJ.png\" alt=\"Image of spreadsheet\"></a></p>\n\n<p>I added a column to score how well each pet matches the potential home being evaluated (\"Overall Score\" in Column K), then a column to rank the scores (\"Rank\" in Column L).</p>\n\n<p>The basic formula in the \"Overall Score\" column just looks at each cell and compares it to the analogous cell in Sheet1. Since Excel sees TRUE as 1 and FALSE as 0, I just summed the results. Here's the basic formula:</p>\n\n<pre><code>=SUM(B3=$K$3,C3=$L$3,D3=$M$3,E3=$N$3,F3=$O$3,G3=$P$3)\n</code></pre>\n\n<p>I stepped it up a notch so that I could to make it look up whatever I typed in the cell directly under \"Overall Score\" (cell K2, in my case). It looks more complicated than it really is:</p>\n\n<pre><code>=SUM(B3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,2,FALSE),C3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,3,FALSE),D3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,4,FALSE),E3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,5,FALSE),F3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,6,FALSE),G3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,7,FALSE),H3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,8,FALSE),I3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,9,FALSE),J3=VLOOKUP($K$2,Sheet1!$A$3:$J$3,10,FALSE))\n</code></pre>\n\n<p>Regarding the VBA that you wrote, I was unable to get it to function in the way that you say you're getting it to function. But if you still want to go that route, the answer to running it for each row is to create a loop. Perhaps something like this:</p>\n\n<pre><code>Dim AvailCell, AvailRange As Range\n\nSet AvailRange = Sheet2.Range(\"AJ2:AJ10\")\n\nFor Each AvailCell In AvailRange\n    If AvailCell.Value = \"Yes\" Then\n        AvailCell.Offset(0, 1).Value = WorksheetFunction.Count(WorksheetFunction.Match(Sheet1.Range(\"a2:k2\"), Range(AvailCell.Offset(0, -29).Address &amp; \":\" &amp; AvailCell.Offset(0, -1).Address))) ' Sheet2.Range(\"b3:ai3\")))\n    Else\n        AvailCell.Offset(0, 1).Value = \"Not Compatible\"\n    End If\nNext\n</code></pre>\n\n<p>But again, the WorksheetFunctions you're using did not function for me in the way that I think you're wanting them to function.</p>\n"}], "owner": {"reputation": 11, "user_id": 12558162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ce9cccdb95261429733f0b028fd08f?s=128&d=identicon&r=PG&f=1", "display_name": "Tilak Dugar", "link": "https://stackoverflow.com/users/12558162/tilak-dugar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576693190, "creation_date": 1576667818, "last_edit_date": 1576688057, "question_id": 59390872, "link": "https://stackoverflow.com/questions/59390872/how-to-count-matches-in-each-row-against-value-in-another-row", "title": "How to count matches in each row against value in another row?", "body": "<p>I have two sets of data, one with each user's choice of characteristics for their perfect pet, and another with the complete list of characteristics matched to each pet.</p>\n\n<p>I want a code that uses the answers as reference, and goes through each pet (all characteristics in a row), and counts the matching characteristics from the answer. After it has counted this score for all the pets, it should return the pet with the highest score.</p>\n\n<p>Pet data is in this format, with various other characteristics mapped<br>\n<a href=\"https://i.stack.imgur.com/dx4SV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dx4SV.png\" alt=\"the pet data is in this format currently, with various other characteristics mapped\"></a></p>\n\n<p>I have this to count the matches:</p>\n\n<pre><code>If Sheet2.Range(\"aj3\").Value = \"yes\" Then\n    Sheet2.Range(\"ak3\").Value = WorksheetFunction.Count(WorksheetFunction.Match(Sheet1.Range(\"a2:k2\"), Sheet2.Range(\"b3:ai3\")))\nElse: Sheet2.Range(\"ak3\").Value = \"Not Compatible\n</code></pre>\n\n<p>Struggling with running this for each row and returning the corresponding value with the highest score.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1576667796, "post_id": 59390775, "comment_id": 104971693, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">Error in finding last used cell in Excel with VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12558089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165530ebb56453edb8a981732f89ae22?s=128&d=identicon&r=PG&f=1", "display_name": "Gregooz", "link": "https://stackoverflow.com/users/12558089/gregooz"}, "is_accepted": false, "score": 0, "last_activity_date": 1576754980, "creation_date": 1576754980, "answer_id": 59408872, "question_id": 59390775, "link": "https://stackoverflow.com/questions/59390775/select-last-row-of-an-excel-table-with-empty-value-in-specfic-column/59408872#59408872", "title": "Select last row of an Excel table with empty value in specfic column", "body": "<p>I have a solution for what I want to do :</p>\n\n<pre><code>With Sheets(sheet).Range(\"Table1\").Cells(1, 2).End(xlDown)\n  .Offset(1, 0).Value = value1 \n  .Offset(1, 1).Value = value2\n  ...\nEnd With\n</code></pre>\n\n<p>For some explication :</p>\n\n<p>Sheets(\"your_sheet_name\") \nRange(\"your_table_name\") \nCells(row number, column number) </p>\n\n<p>. Offset(row, column \"based on the column define on the cells parameter\") </p>\n\n<p>So for me :</p>\n\n<p>. Offset(1, 0).Value = value1 -> insert value1 in the first \n                                                       empty cell of B column\n. Offset(1, 1).Value = value2 -> insert value2 in the same \n                                                       row but in column C</p>\n\n<p>But that's don't work if the table is filtered. \nSo it's needed to make a ListObject.ShowAllData before use the \"with\" . </p>\n\n<p>Thank you for help, the links you share was very useful! </p>\n\n<p>Regards, </p>\n"}], "owner": {"reputation": 1, "user_id": 12558089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/165530ebb56453edb8a981732f89ae22?s=128&d=identicon&r=PG&f=1", "display_name": "Gregooz", "link": "https://stackoverflow.com/users/12558089/gregooz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1576754980, "creation_date": 1576667468, "last_edit_date": 1576744141, "question_id": 59390775, "link": "https://stackoverflow.com/questions/59390775/select-last-row-of-an-excel-table-with-empty-value-in-specfic-column", "title": "Select last row of an Excel table with empty value in specfic column", "body": "<p>I think my question will be easy for some of you. </p>\n\n<p>I have an Excel file for my task/activity tracking.</p>\n\n<p>Column <code>A</code> is an ID auto-increment from 1 to 1000.</p>\n\n<p>Column <code>B</code> is the taskname.</p>\n\n<p>But I have only 100 tasks, so column <code>B</code> is empty at cell <code>B101</code>. </p>\n\n<p>I want to select the first empty row without taskname (first row with column <code>B</code> being empty). \nBut column <code>A</code> is not empty and gives me an error (I select the last row after A column value). </p>\n\n<p>Thank you for reading this. </p>\n\n<p>Regards, </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1576676353, "post_id": 59391825, "comment_id": 104975952, "body": "shouldn&#39;t you declare <code>findrow</code>and <code>findrow2</code> outside of the loop?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 9, "user_id": 12558134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea097b9406f09fec8ecade8330a5c4fd?s=128&d=identicon&r=PG&f=1", "display_name": "A-S", "link": "https://stackoverflow.com/users/12558134/a-s"}, "edited": false, "score": 0, "creation_date": 1576683700, "post_id": 59391825, "comment_id": 104980164, "body": "@A-S - that&#39;s not a helpful response. What exactly happens?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1576683732, "post_id": 59391825, "comment_id": 104980179, "body": "@MG92 - makes no difference, they are not executable statements."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1576671289, "creation_date": 1576671289, "answer_id": 59391825, "question_id": 59390769, "link": "https://stackoverflow.com/questions/59390769/paste-method-of-worksheet-class-in-a-loop/59391825#59391825", "title": "Paste method of worksheet class in a loop", "body": "<p>Try this.</p>\n\n<p>Learn to avoid <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Select/Activate</a>.</p>\n\n<p>When using <code>Find</code> check the item is found before trying to access properties such as <code>Row</code> to avoid errors. And good practice to specify all its parameters.</p>\n\n<p>You can use a <code>For</code> loop here as you know the endpoint.</p>\n\n<pre><code>Sub SelectBetween()\n\nDim i As Long\n\nFor i = 1 To 63\n    Dim findrow As Range, findrow2 As Range\n    With Sheets(\"Sheet4\")\n        Set findrow = .Range(\"A:A\").Find(what:=\"Department\",after:=.Range(\"A1\"))\n        If Not findrow Is Nothing Then\n            Set findrow2 = .Range(\"A2:A3141\").Find(what:=\"Department\", after:=findrow)\n            If Not findrow2 Is Nothing Then\n                .Range(findrow, findrow2.Offset(-1)).Cut\n                Sheets(\"Sheet5\").Cells(2, Columns.Count).End(xlToLeft).Offset(, 1).PasteSpecial Link:=True\n            End If\n        End If\n    End With\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 12558134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea097b9406f09fec8ecade8330a5c4fd?s=128&d=identicon&r=PG&f=1", "display_name": "A-S", "link": "https://stackoverflow.com/users/12558134/a-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1576677072, "creation_date": 1576677072, "answer_id": 59393474, "question_id": 59390769, "link": "https://stackoverflow.com/questions/59390769/paste-method-of-worksheet-class-in-a-loop/59393474#59393474", "title": "Paste method of worksheet class in a loop", "body": "<p>It worked well by the below code.\nonly deleted the below lines from the previous code.</p>\n\n<p>ActiveSheet.PasteSpecial Link:=True\n     Application.CutCopyMode = False</p>\n\n<pre><code>Sub SelectBetween()\n\ni = 1\n\nSheets(\"Sheet4\").Activate\n\nDo Until i &gt; 63\n\n\n    Dim findrow As Long, findrow2 As Long\n\n\n    findrow = Range(\"A:A\").Find(\"Department\", Range(\"A1\")).Row\n    findrow2 = Range(\"A2:A3141\").Find(\"Department\", Range(\"A\" &amp; findrow)).Row\n    Range(\"A\" &amp; findrow &amp; \":A\" &amp; findrow2 - 1).Select\n\n    Selection.Cut Sheets(\"Sheet5\").Cells(2, Columns.Count).End(xlToLeft).Offset(, 1)\n\n\n     i = i + 1\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 12558134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea097b9406f09fec8ecade8330a5c4fd?s=128&d=identicon&r=PG&f=1", "display_name": "A-S", "link": "https://stackoverflow.com/users/12558134/a-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576679457, "creation_date": 1576667445, "last_edit_date": 1576679457, "question_id": 59390769, "link": "https://stackoverflow.com/questions/59390769/paste-method-of-worksheet-class-in-a-loop", "title": "Paste method of worksheet class in a loop", "body": "<p>I tried to select and copy from Sheet 4 to Sheet 5 till the end of the list on Sheet 4.</p>\n\n<p>It works one time only, not looping, and giving me an error message</p>\n\n<blockquote>\n  <p>\"pasteSpecial method of worksheet class failed\"</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SelectBetween()\n\ni = 1\n\nSheets(\"Sheet4\").Activate\n\nDo Until i &gt; 63\n\n    Dim findrow As Long, findrow2 As Long\n\n    findrow = Range(\"A:A\").Find(\"Department\", Range(\"A1\")).Row\n    findrow2 = Range(\"A2:A3141\").Find(\"Department\", Range(\"A\" &amp; findrow)).Row\n    Range(\"A\" &amp; findrow &amp; \":A\" &amp; findrow2 - 1).Select\n\n    Selection.Cut Sheets(\"Sheet5\").Cells(2, Columns.Count).End(xlToLeft).Offset(, 1)\n\n    ActiveSheet.PasteSpecial Link:=True\n    Application.CutCopyMode = False\n\n    i = i + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 10169933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PhrwCgSeF3E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ojDDgKcbMXoPT9gX8cJGsRnJFJRA/mo/photo.jpg?sz=128", "display_name": "Zahid Khan", "link": "https://stackoverflow.com/users/10169933/zahid-khan"}, "edited": false, "score": 0, "creation_date": 1576687939, "post_id": 59395579, "comment_id": 104982619, "body": "Is there any chance to import presentation from SharePoint folder ?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 69, "user_id": 10169933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PhrwCgSeF3E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ojDDgKcbMXoPT9gX8cJGsRnJFJRA/mo/photo.jpg?sz=128", "display_name": "Zahid Khan", "link": "https://stackoverflow.com/users/10169933/zahid-khan"}, "edited": false, "score": 1, "creation_date": 1576689470, "post_id": 59395579, "comment_id": 104983361, "body": "Sorry, I don&#39;t have a SharePoint setup on which to test."}, {"owner": {"reputation": 69, "user_id": 10169933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PhrwCgSeF3E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ojDDgKcbMXoPT9gX8cJGsRnJFJRA/mo/photo.jpg?sz=128", "display_name": "Zahid Khan", "link": "https://stackoverflow.com/users/10169933/zahid-khan"}, "edited": false, "score": 0, "creation_date": 1576750475, "post_id": 59395579, "comment_id": 105002759, "body": "Ok No problem, thanks for your quick reply If you find any reference for that, please do let me know."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 1, "last_activity_date": 1576683983, "creation_date": 1576683983, "answer_id": 59395579, "question_id": 59390405, "link": "https://stackoverflow.com/questions/59390405/how-to-import-selected-presentations-from-a-folder/59395579#59395579", "title": "How to import selected presentations from a folder?", "body": "<p>This should do it:</p>\n\n<pre><code>Sub Merge()\n    Dim sPath As String\n    Dim dlgOpen As FileDialog\n    Dim x As Integer\n    Dim vrtSelectedItem As Variant\n\n    'Set path to current dirrectory\n    sPath = CurDir\n    If Right$(sPath, 1) &lt;&gt; \"\\\" Then sPath = sPath &amp; \"\\\"\n\n    'Set File Picker dialog\n    Set dlgOpen = Application.FileDialog(Type:=msoFileDialogFilePicker)\n\n    'Set initial path and view, set multiselect capability\n    With dlgOpen\n        .InitialFileName = sPath\n        .InitialView = msoFileDialogViewList\n        .AllowMultiSelect = True\n\n        'If user click on OK, insert selected files after last slide of current presentation\n        If .Show = -1 And .SelectedItems.Count &gt; 0 Then\n            For x = 1 To .SelectedItems.Count\n                ActivePresentation.Slides.InsertFromFile .SelectedItems(x), ActivePresentation.Slides.Count\n            Next\n        Else\n            'User Cancelled\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 10169933, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-PhrwCgSeF3E/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7ojDDgKcbMXoPT9gX8cJGsRnJFJRA/mo/photo.jpg?sz=128", "display_name": "Zahid Khan", "link": "https://stackoverflow.com/users/10169933/zahid-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 59395579, "answer_count": 1, "score": 0, "last_activity_date": 1587827326, "creation_date": 1576666193, "last_edit_date": 1587827326, "question_id": 59390405, "link": "https://stackoverflow.com/questions/59390405/how-to-import-selected-presentations-from-a-folder", "title": "How to import selected presentations from a folder?", "body": "<p>How can I import a selected presentation from a particular folder?</p>\n\n<p>Below are the code which I tried but it is importing all the presentations which are stored in a particular folder.</p>\n\n<pre><code>Sub Merge()\n' After doing the merge, open presentation #1\n' Then run this code:\n\n    Dim sPath As String\n    Dim cFileNames As New Collection\n    Dim sTemp As String\n    Dim x As Long\n\n    sPath = CurDir  ' by default\n    If Right$(sPath, 1) &lt;&gt; \"\\\" Then sPath = sPath &amp; \"\\\"\n\n    sPath = InputBox(\"Path to PPT files (ex: c:\\my documents\\\", _\n        \"Where are the files?\", sPath)\n    If sPath = \"\" Then\n        Exit Sub\n    End If\n\n    sTemp = Dir(sPath &amp; \"*.pptx\")\n    While sTemp &lt;&gt; \"\"\n        With cFileNames\n            .Add (sPath &amp; sTemp)\n        End With\n        sTemp = Dir\n    Wend\n\n    If cFileNames.Count &gt; 1 Then\n        ' open the first file\n        Presentations.Open (cFileNames(1))\n\n        ' Insert the other files\n        For x = 2 To cFileNames.Count\n            Call ActivePresentation.Slides.InsertFromFile( _\n                cFileNames(x), _\n                ActivePresentation.Slides.Count)\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>For example. I have 10 presentations in <strong>XYZ folder</strong> but want to import only four selected presentations.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1576669068, "last_edit_date": 1576669068, "creation_date": 1576668163, "answer_id": 59390959, "question_id": 59390379, "link": "https://stackoverflow.com/questions/59390379/pivot-table-invalid-procedure-call-or-argument/59390959#59390959", "title": "Pivot table &quot;Invalid procedure call or argument&quot;", "body": "<p>You need to create the PivotCache and the PivotTable in the same workbook. Something like this. </p>\n\n<pre><code>Sub Sample()\n    Dim pc As PivotCache\n    Dim pt As PivotTable\n    Dim wbThis As Workbook, wbNew As Workbook\n\n    Set wbThis = ThisWorkbook\n    Set wb = Workbooks.Add\n\n    'SourceData:=PRange\n    Set pc = wb.PivotCaches.Create( _\n            SourceType:=xlDatabase, _\n            SourceData:=wbThis.Sheets(\"Sheet1\").Range(\"A1:B5\"), _\n            Version:=xlPivotTableVersion15)\n\n    '~~&gt; wb.Sheets(1).Range(\"A1\") Change to respective range\n    Set pt = wb.Sheets(1).PivotTables.Add( _\n             PivotCache:=pc, _\n             TableDestination:=wb.Sheets(1).Range(\"A1\"), _\n             TableName:=\"PIVOTO\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9343961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20c4a7f1b609df5ad0d9c5029d8336e1?s=128&d=identicon&r=PG&f=1", "display_name": "Imnoob", "link": "https://stackoverflow.com/users/9343961/imnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576669068, "creation_date": 1576666104, "last_edit_date": 1576666287, "question_id": 59390379, "link": "https://stackoverflow.com/questions/59390379/pivot-table-invalid-procedure-call-or-argument", "title": "Pivot table &quot;Invalid procedure call or argument&quot;", "body": "<p>So what i am doing now is that i have a VBA code that opens up a file and then reformats the excel file, i assigned the code to a button for this code. \nAfter reformatting the file, i need to create a pivot table based on the excel data that was reformatted. </p>\n\n<p>So i wrote a pivot table code in the module of the excel file that i opened up and ran it. The pivot table was created successfully. However when i copy the codes over to my main file that opens excel files and reformats them, i get an error </p>\n\n<blockquote>\n  <p>\"Invalid procedure call or argument\".</p>\n</blockquote>\n\n<p>I get the error when i try to add a pivot table. </p>\n\n<pre><code> Dim ws As Worksheet\n Dim pc As PivotCache\n Dim pt As PivotTable\n\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = Cells(1, Columns.Count).End(xlToLeft).Column\n\n    ' set the Pivot-Cache Source Range with the values found for LastRow and LastCol\n    Set PRange = Range(\"A1\", Cells(LastRow, LastCol))\n\n    If ThisWorkbook.PivotCaches.Count = 0 Then\n\n        Set pc = ThisWorkbook.PivotCaches.Create( _\n        SourceType:=xlDatabase, _\n        SourceData:=PRange, _\n        Version:=xlPivotTableVersion15)\n\n    Else\n        Set pc = ThisWorkbook.PivotCaches(1)\n    End If\n\n Set ws = Worksheets.Add\n Range(\"A3\").Select\n\n ' the next line is where the error happens\n Set pt = ws.PivotTables.Add( _\n PivotCache:=pc, _\n Tabledestination:=ActiveCell, _\n TableName:=\"PIVOTO\")\n\n Set Pf = pt.PivotFields(\"Driver Name\")\n Pf.Orientation = xlRowField\n\n Set Pf = pt.PivotFields(\"Over Speeding\")\n Pf.Orientation = xlDataField\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576668505, "post_id": 59390363, "comment_id": 104971995, "body": "it shouldn&#39;t be too dificult. which part are you stuck with? Show us the code that you have tried till now."}, {"owner": {"reputation": 23, "user_id": 8221744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fcbc42ae46a489ad09e550e9c66ecc?s=128&d=identicon&r=PG&f=1", "display_name": "electronduck", "link": "https://stackoverflow.com/users/8221744/electronduck"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576669463, "post_id": 59390363, "comment_id": 104972491, "body": "i have added that"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1576674013, "post_id": 59390363, "comment_id": 104974772, "body": "Remove <code>.value</code> as <code>Test</code> is an object and then use <code>Msgbox Test.Value</code>. Now you can use <code>Val(Test.Value)&gt;0</code> for the condition"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 8221744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fcbc42ae46a489ad09e550e9c66ecc?s=128&d=identicon&r=PG&f=1", "display_name": "electronduck", "link": "https://stackoverflow.com/users/8221744/electronduck"}, "is_accepted": true, "score": 0, "last_activity_date": 1578391400, "creation_date": 1578391400, "answer_id": 59626157, "question_id": 59390363, "link": "https://stackoverflow.com/questions/59390363/check-data-in-excel-using-powerpoint-vba/59626157#59626157", "title": "Check data in Excel using PowerPoint VBA", "body": "<p>Siddharth Rout \"Remove .value as Test is an object and then use Msgbox Test.Value . Now you can use Val(Test.Value)>0 for the condition\"</p>\n"}], "owner": {"reputation": 23, "user_id": 8221744, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fcbc42ae46a489ad09e550e9c66ecc?s=128&d=identicon&r=PG&f=1", "display_name": "electronduck", "link": "https://stackoverflow.com/users/8221744/electronduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59626157, "answer_count": 1, "score": 0, "last_activity_date": 1581626276, "creation_date": 1576666057, "last_edit_date": 1581626276, "question_id": 59390363, "link": "https://stackoverflow.com/questions/59390363/check-data-in-excel-using-powerpoint-vba", "title": "Check data in Excel using PowerPoint VBA", "body": "<p>I have a PowerPoint presentation that is has data links to an Excel file,</p>\n\n<p>I am attempting to create an endless PowerPoint loop that every slide change runs a macro. This macro needs to connect to the Excel file, and if cell B2 > 0 output an action that causes an animation on the screen.</p>\n\n<p>I have attempted to make PowerPoint open the Excel file but I have not been able to get further than this.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub OnSlideShowPageChange()\n    Dim i As Integer\n    Dim xlApp As Excel.Application\n    Dim xlWorkBook As Object\n    Dim Test As Object\n\n    'i = ActivePresentation.SlideShowWindow.View.CurrentShowPosition\n    'If i &lt;&gt; i Then Exit Sub\n\n    Test = 0\n    Set xlApp = New Excel.Application\n    Set xlWorkBook = xlApp.Workbooks.Open(\"C:\\Users\\Michael\\Documents\\Wallboard Test Data.xlsx\", True, False)\n    Set Test = xlWorkBook.sheets(\"Hall of Fame\").Select.Range(\"B2\").Value\n\n    MsgBox Test\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1576678304, "post_id": 59390356, "comment_id": 104977013, "body": "Use in conjuction with the range &#39;remove duplicates&#39;:  <a href=\"https://stackoverflow.com/questions/6773232/excel-vba-range-to-string-array-in-1-step\" title=\"excel vba range to string array in 1 step\">stackoverflow.com/questions/6773232/&hellip;</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1576679728, "post_id": 59390356, "comment_id": 104977812, "body": "@Tragamor, removing duplicates means altering and working through worksheet cells. I wanted to do this through memory for further usage. What does the link have to do with this btw (despite it being an interesting read)?"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1576690809, "post_id": 59390356, "comment_id": 104984008, "body": "Yeah - I was thinking about it afterwards and realised you would need to copy the range to a dummy worksheet and manipulate that. For reference; the link has an answer of mine where you populate a range into an array in one line avoiding loops which is why it is in there. The use of a dictionary is probably the better solution, but there are alternatives"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1576667136, "last_edit_date": 1576667136, "creation_date": 1576666037, "answer_id": 59390357, "question_id": 59390356, "link": "https://stackoverflow.com/questions/59390356/array-of-unique-values-from-range-without-any-loop/59390357#59390357", "title": "Array of unique values from range - Without any loop", "body": "<p><strong><em><sub>Uniques - Dictionary</sub></em></strong></p>\n\n<p>A very solid (and fast) way of returning a 1D-array of unique values would be to use a conventional <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dictionary-object\" rel=\"nofollow noreferrer\"><code>Dictionary</code></a> object as below:</p>\n\n<pre><code>Sub UniquesDictionary()\n\nDim lr As Long, x As Long\nDim arr As Variant\nDim dict As Object: Set dict = CreateObject(\"Scripting.Dictionary\")\n\nWith Sheet1\n\n    'Find the last used row\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr = .Range(\"A2:A\" &amp; lr).Value\n\nEnd With\n\n    'Loop through memory and fill dictionary\n    For x = LBound(arr) To UBound(arr)\n        dict(arr(x, 1)) = 1\n    Next x\n\n    'Pull unique items into a 1D-array\n    arr = dict.Keys\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em><sub>Uniques - Evaluate</sub></em></strong></p>\n\n<p>Whilst the above works. The wish was to avoid any loop. The way to do this is to use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.evaluate\" rel=\"nofollow noreferrer\"><code>.Evaluate</code></a>, see below:</p>\n\n<pre><code>Sub UniquesEvaluate()\n\nDim lr As Long\nDim arr As Variant\n\nWith Sheet1\n\n    'Find the last used row\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n\n    'Get array of unique values\n    arr = Filter(.Evaluate(\"TRANSPOSE(If(Row(A2:A\" &amp; lr &amp; \")&lt;&gt;MATCH(A2:A\" &amp; lr &amp; \",A2:A\" &amp; lr &amp; \",0)+1,\"\"|\"\",A2:A\" &amp; lr &amp; \"))\"), \"|\", False)\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>It might seem like a long formula but it really isn't that impressive and boils down to:</p>\n\n<pre><code>=IF(ROW(A2:A8)&lt;&gt;MATCH(A2:A8,A2:A8,0)+1,\"|\",A2:A8)\n</code></pre>\n\n<p>The <code>TRANSPOSE</code> is only there to return a 1D-array for <code>FILTER</code> to work with.</p>\n\n<ul>\n<li><p>The inital formula will only return those values that are sitting on the rows where they are first encountered through <code>MATCH</code>, otherwise it would return a pipe-symbol.</p></li>\n<li><p>Thus <code>TRANSPOSE(&lt;formula&gt;)</code> returns a 1D-array, e.g.: <code>{A,B,|,|,C,|,|}</code></p></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/filter-function\" rel=\"nofollow noreferrer\"><code>Filter</code></a> then uses this 1D-array as an input, returning an array filtering out those pipe-symbols using <code>FALSE</code> in the \"include\" parameter, e.g: <code>Filter(&lt;arr&gt;,\"|\",FALSE)</code> > <code>{A,B,C}</code>.</li>\n</ul>\n\n<hr>\n\n<p><strong><em><sub>Comparison</sub></em></strong></p>\n\n<p>This would only have real purpose if this method would be equally as fast as the more conventional <code>Dictionary</code> so I did a small comparison. As far as my testing goes, there was no really noticable timing difference (around 0 seconds), but since in essence the <code>Evaluate</code> is a <code>CSE</code> formula, larger datasets will get noticable timing differences above let's say 2000 rows of data.</p>\n\n<p>Hopefully this is usefull to those working with smaller datasets.</p>\n"}], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 59390357, "answer_count": 1, "score": 0, "last_activity_date": 1576667169, "creation_date": 1576666037, "last_edit_date": 1576667169, "question_id": 59390356, "link": "https://stackoverflow.com/questions/59390356/array-of-unique-values-from-range-without-any-loop", "title": "Array of unique values from range - Without any loop", "body": "<p>At risk of being of topic, I decided to share some code, <a href=\"https://stackoverflow.blog/2011/07/01/its-ok-to-ask-and-answer-your-own-questions/\">Q&amp;A-style</a>. If the general opinion is such that this would be off-topic I'll be happy to delete if need be.</p>\n\n<hr>\n\n<p><strong><em><sub>Background</sub></em></strong></p>\n\n<p>Having a <code>Range</code> object holding a certain amount of values I would want to pull those values into an array. The conventional way (at least to me) would be to use <code>\"\"scripting.dictionary\"</code>, loop through a <code>Range</code>, or rather an <code>Array</code> in memory, to add these values into a uniques list.</p>\n\n<p>While that works, I wanted to see if there is a method to pull an array of unique items without any loop.</p>\n\n<hr>\n\n<p><strong><em><sub>Sample</sub></em></strong></p>\n\n<p>Imagine the following data in <code>A1:A8</code>:</p>\n\n<pre><code>Vals\nA\nB\nA\nB\nC\nC\nB\n</code></pre>\n\n<hr>\n\n<p><strong><em><sub>Question</sub></em></strong></p>\n\n<p>To retrieve a 1D-array of unique items <code>{A,B,C}</code>, how would we go about doing this without a loop?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1576667629, "post_id": 59389639, "comment_id": 104971600, "body": "Code is working for me even with <code>If fso.FileExists(path &amp; Fname) = True Then</code> which could be shortened to <code>If fso.FileExists(path &amp; Fname) Then</code>. Maybe whitespaces in B3 cause the issue?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576668794, "post_id": 59389639, "comment_id": 104972151, "body": "what if there is already a file and you are not able to replace it because of say it is open then your if condition may not give you a correct picture?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1576668829, "post_id": 59389639, "comment_id": 104972167, "body": "Here is one way to do it <b>1.</b> Use <code>DIR</code> to check if the file exists. <b>2.</b> If file exists, check if the file if open/readonly <b>3.</b> if not read only use saveas and save <b>4.</b> Check the file modified date"}, {"owner": {"reputation": 70, "user_id": 9160429, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9526a011bd7f2900e60c5cefb2484be4?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ace", "link": "https://stackoverflow.com/users/9160429/d-ace"}, "edited": false, "score": 0, "creation_date": 1576670475, "post_id": 59389639, "comment_id": 104972957, "body": "@Siddarth Rout: In actual scenario file will be overwritten, so this is not a problem. And also lets take out the probability of it being open for now."}, {"owner": {"reputation": 70, "user_id": 9160429, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9526a011bd7f2900e60c5cefb2484be4?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ace", "link": "https://stackoverflow.com/users/9160429/d-ace"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1576670570, "post_id": 59389639, "comment_id": 104973009, "body": "@storax it still is not working for me i have modified to remove the space from file name but still code is hitting else statement despite file saving successfully at given location. Is there any other way ?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1576671166, "post_id": 59389639, "comment_id": 104973325, "body": "What do you mean by other way? You could follow Siddharth&#39;s suggestion but that is something you do not want to do. I am just saying code is working for me. My suggestion now would be to step through the code and check at every step what is happening. Maybe you also turn on <code>DisplayAlerts</code> to see what is happening when saving the file."}], "owner": {"reputation": 70, "user_id": 9160429, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9526a011bd7f2900e60c5cefb2484be4?s=128&d=identicon&r=PG&f=1", "display_name": "D. Ace", "link": "https://stackoverflow.com/users/9160429/d-ace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576667508, "creation_date": 1576663681, "last_edit_date": 1576667508, "question_id": 59389639, "link": "https://stackoverflow.com/questions/59389639/saveas-file-and-then-check-whether-it-exists-in-directory-or-not", "title": "SaveAs file and then check whether it exists in directory or not", "body": "<p>I have written below code to save a workbook and then to verify whether workbook saved successfully or not. To achieve this I want code to save file then go to its directory (where file is saved) and if file with same name exists (file save correctly in the desired directory) it displays message to confirm file saved successfully.\nAt presetting below code is saving the workbook successfully (any existing file gets overwritten(which the requirement) but it is not evaluating IF statement to true despite file saves correctly and exists in the directory it is going to else condition.</p>\n\n<p>Please help to modify it.... </p>\n\n<pre><code>Sub Submit()\n\nDim path As String\nDim filename1 As String\npath = \"C:\\REPORTS\\\"\nfilename1 = Range(\"B3\").Value\n\nApplication.DisplayAlerts = False\n   ActiveWorkbook.SaveAs Filename:=path &amp; filename1 &amp; \" \" &amp; Format(Now(), \"DD-MM-YYYY\") &amp; \".xlsx\", \n   FileFormat:=xlWorkbookNormal\n   Application.DisplayAlerts = True\n\nDim Fname As String\n  Fname = filename1 &amp; \" \" &amp; Format(Now(), \"DD-MM-YYYY\") &amp; \".xlsx\"\n  MsgBox Fname\n\nDim fso: Set fso = CreateObject(\"Scripting.FileSystemObject\")\n' If file save successfully IF will retrun true and message will be displayed\nIf fso.FileExists(path &amp; Fname) = True Then\n  MsgBox filename1 &amp; \" \" &amp; Format(Now(), \"DD-MM-YYYY\") &amp; \".xlsx\" &amp; \" Saved Successfully\"\n\nElse\nMsgBox \"I reached Else\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1576661315, "post_id": 59388959, "comment_id": 104968374, "body": "If it starts with a <code>.</code> that means it is referencing an above <code>With</code> statement. <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/with-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 81, "user_id": 10030257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ff038b5c9155d8ba6bb0ccfec8898a?s=128&d=identicon&r=PG&f=1", "display_name": "rs4", "link": "https://stackoverflow.com/users/10030257/rs4"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576661478, "post_id": 59388959, "comment_id": 104968465, "body": "So <code>With xyz .abc = t .pqr = o</code>is same as <code>xyz.abc = t xyz.pqr = o</code> ?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576661541, "post_id": 59388959, "comment_id": 104968493, "body": "yes. it is the same"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1576662647, "post_id": 59388959, "comment_id": 104969057, "body": "@rs4 don&#39;t forget you need to close your <code>With</code> statement with an <code>End With</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1976, "user_id": 441661, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/BOVlQ.jpg?s=128&g=1", "display_name": "Guillermo Phillips", "link": "https://stackoverflow.com/users/441661/guillermo-phillips"}, "is_accepted": true, "score": 2, "last_activity_date": 1576663638, "last_edit_date": 1576663638, "creation_date": 1576662724, "answer_id": 59389376, "question_id": 59388959, "link": "https://stackoverflow.com/questions/59388959/what-is-the-leading-used-for-before-method-or-variable/59389376#59389376", "title": "What is the leading &quot;.&quot; used for before method or variable?", "body": "<p>Your example <em>by itself</em> will cause an error.</p>\n\n<p>The dot syntax is used to access functions or members of objects or it is used to access members of user defined types or an enumeration.</p>\n\n<p>Here's an example in Excel VBA using the global <code>Application</code> object:</p>\n\n<pre><code>Application.ActiveSheet.Cells(1, 2).Value = 1234\n</code></pre>\n\n<p>Another example with user defined types:</p>\n\n<pre><code>Type coordinate\n    x As Double\n    y As Double\nEnd Type\n\nSub test()\n    Dim point1 As coordinate\n    Dim point2 As coordinate\n\n    point1.x = point2.y * 2\nEnd Sub\n</code></pre>\n\n<p>And lastly with enumerations. The following uses the inbuilt enumeration for days of the week:</p>\n\n<pre><code>Debug.Print VbDayOfWeek.vbWednesday\n</code></pre>\n\n<p>VBA supports a shorthand syntax where you need to use the same object repeatedly. For example:</p>\n\n<pre><code>Application.ActiveSheet.Cells(1, 1) = 1234\nApplication.ActiveSheet.Cells(1, 2) = 2345\nApplication.ActiveSheet.Cells(1, 3) = 3456\n</code></pre>\n\n<p>can be written shorthand as:</p>\n\n<pre><code>With Application.ActiveSheet\n    .Cells(1, 1) = 1234\n    .Cells(1, 2) = 2345\n    .Cells(1, 3) = 3456\nEnd With\n</code></pre>\n\n<p>if you want an easy way to remember it just think of it as \"<strong>With</strong> respect to object X\".</p>\n\n<p>You can also use the <code>With</code> syntax with user defined types. But you can't use it with enumerations.</p>\n"}], "owner": {"reputation": 81, "user_id": 10030257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0ff038b5c9155d8ba6bb0ccfec8898a?s=128&d=identicon&r=PG&f=1", "display_name": "rs4", "link": "https://stackoverflow.com/users/10030257/rs4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 59389376, "answer_count": 1, "score": 0, "last_activity_date": 1580448392, "creation_date": 1576661221, "last_edit_date": 1580448392, "question_id": 59388959, "link": "https://stackoverflow.com/questions/59388959/what-is-the-leading-used-for-before-method-or-variable", "title": "What is the leading &quot;.&quot; used for before method or variable?", "body": "<p>What does this line mean.</p>\n\n<pre><code>.Criteria.FilterTagSet = True\n</code></pre>\n\n<p>This <a href=\"https://docs.predix.io/en-US/content/historian/apis_and_sdk/historian_sdk/method-reference\" rel=\"nofollow noreferrer\">page</a> has code written in this way.</p>\n"}, {"tags": ["vba", "internet-explorer"], "comments": [{"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1576661675, "post_id": 59388907, "comment_id": 104968568, "body": "The line on which you are stuck is assigning the value to Range in Excel Sheet. Does your Excel file has that value from the web page? You said nothing is working after that line. we need that code which is not working to see whether there is anything which caused this issue. It can be possible that your code is not able to find the control in an Iframe. Try to print the value in console to check it."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "reply_to_user": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "edited": false, "score": 0, "creation_date": 1576722302, "post_id": 59388907, "comment_id": 104993876, "body": "@Deepak-MSFT - All the codes ran successfully except for the row that I highlighted. By the way, I have amended that row a bit as my intention is to update the field with the value indicated on my excel but it still doesn&#39;t work. I tried to print the value in console to check but it came back blank ( fac = doc.getElementsByTagName(&quot;iframe&quot;)(0).contentDocument.queryS&zwnj;&#8203;elector(&quot;input.right&zwnj;&#8203;JustifyStyle&quot; ).Item(2).Value  Debug.Print fac). Hope you could help caused I tried searching the codes for days but still no result."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576747023, "post_id": 59405800, "comment_id": 105001029, "body": "Yes, you are right but nothing happen after ran the code. In the same iframe there are other fields to update but all are having fixed elements value except for this particular field."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576747233, "post_id": 59405800, "comment_id": 105001151, "body": "Did you get similar result with above example?"}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576747671, "post_id": 59405800, "comment_id": 105001384, "body": "Yes, I have modified the code according to your sample by adding :nth-of-type(2) into the row that I am facing issue but nothing happen."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576747746, "post_id": 59405800, "comment_id": 105001422, "body": "Please also try to use  ie.Navigate2 ie.document.querySelector(&quot;iframe&quot;).src in your test."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576804835, "post_id": 59405800, "comment_id": 105024810, "body": "I have tried that yesterday but it still gave me the same result."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576829148, "post_id": 59405800, "comment_id": 105029963, "body": "Not sure, whether it is setting the value to any other control as it is not giving any error. Another thing you can try is to pass the full path of that control in query selector. If the site is not confidential then you can share the URL. We can try to test the example with that site. It can help to narrow down the issue."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576833642, "post_id": 59405800, "comment_id": 105031786, "body": "I wish I can share with you the URL just that it is id and password protected. By the way may I know what do you mean by pass the path of that control in query selector? Just for your info the reason I use the class name as it is the shortest and unchanged attribute Element for that textbox."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1576834247, "post_id": 59405800, "comment_id": 105032049, "body": "What I mean is try to locate the element like in this example. querySelector(&quot;div &gt; div &gt;p &gt;input&quot;) Test with it to check whether it helps or not.."}, {"owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1577946119, "post_id": 59405800, "comment_id": 105286237, "body": "I tried Debug.Print with querySelector(&quot;div &gt; div &gt;p &gt;input&quot;) yet it still give me empty result."}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "edited": false, "score": 0, "creation_date": 1577951557, "post_id": 59405800, "comment_id": 105287807, "body": "It looks like we need a site to test the issue. Without it, we are not able to give any solid suggestions. Thanks for your understanding."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1576743912, "creation_date": 1576743912, "answer_id": 59405800, "question_id": 59388907, "link": "https://stackoverflow.com/questions/59388907/how-to-update-a-field-of-dynamic-elements-input-id-name/59405800#59405800", "title": "How to update a field of dynamic Elements (Input ID &amp; Name)", "body": "<pre><code>doc.getElementsByTagName(\"iframe\")(0).contentDocument.querySelector(\"input.rightJustifyStyle\").Item(2).Value = Sheets(\"Case\").Range(\"k2\") \n</code></pre>\n\n<p>From your above sample code, it looks like you are trying to set the value of a second input element which has class name <strong>rightJustifyStyle</strong> in an iframe.</p>\n\n<p>You can refer an example below.</p>\n\n<pre><code>Public Sub demo()\n    Dim ie As Object\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Visible = True\n\n        ie.Navigate2 \"D:\\Backup20190913\\tests\\354.html\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        ie.Navigate2 ie.document.querySelector(\"iframe\").src\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        ie.document.querySelector(\"input.rightJustifyStyle:nth-of-type(2)\").Value = \"Test value...\"\n\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        Stop\n        ie.Quit\n\nEnd Sub\n</code></pre>\n\n<p>Output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/4LOwI.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4LOwI.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Let me know If I misunderstood anything. I will try to correct myself.</p>\n"}], "owner": {"reputation": 19, "user_id": 9750397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06e56be4688fb5cf00cf76f7d81472ec?s=128&d=identicon&r=PG&f=1", "display_name": "user9750397", "link": "https://stackoverflow.com/users/9750397/user9750397"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576743912, "creation_date": 1576661016, "last_edit_date": 1576719869, "question_id": 59388907, "link": "https://stackoverflow.com/questions/59388907/how-to-update-a-field-of-dynamic-elements-input-id-name", "title": "How to update a field of dynamic Elements (Input ID &amp; Name)", "body": "<p>I am trying to update an amount to a field which having the below elements. I am no sure what is the code to use as the input id and name are not fixed and it change every time i access it. It doesn't give me any error message but the field is not being updated after I ran the codes.</p>\n\n<pre><code>`&lt;div class=\"field-item dataValueWrite\"&gt;\n  &lt;table&gt;\n   &lt;tbody&gt;\n    &lt;tr&gt;\n     &lt;td nowrap=\"\" align=\"left\"&gt;\n      &lt;div id=\"93497ErrorCUSTOM\" class=\"\" style=\"display:none;\"&gt;&lt;span class=\"\" errid=\"\" title=\"Please enter a valid amount\" id=\"93497PegaRULESErrorFlag\"&gt;&lt;/span&gt;&lt;/div&gt;\n      &lt;input id=\"93497\" name=\"93497\" onchange=\"changedInputAmountInCurrencyDisplay(this , '2' , '.' , '.' , ',' , 'false' ); \" class=\"rightJustifyStyle\" type=\"text\" size=\"10\" value=\"\" data-changed=\"false\"&gt;&lt;script&gt; formatCurrencyBeforeLoad(document.getElementById('93497'),'2','.', 'false'); \n      &lt;/script&gt;&lt;input id=\"93497HIDDEN\" name=\"$PAcqCaseCreation$pMessageAmountUSD\" type=\"hidden\" value=\"0.00\"&gt;\n      &lt;script&gt; \n         formatCurrencyBeforeLoad(document.getElementById('93497HIDDEN'),'2', '.' , 'false'); \n      &lt;/script&gt; \n        &amp;nbsp;USD  \n     &lt;/td&gt;\n    &lt;/tr&gt;\n   &lt;/tbody&gt;\n  &lt;/table&gt;\n &lt;/div&gt;`\n</code></pre>\n\n<p>Below is the code that I created so far:</p>\n\n<pre><code>Sub Test()\nDim IE As Object\nSet IE = New InternetExplorerMedium\nDim doc As HTMLDocument\n\nIE.navigate \"intranet\"\nIE.Visible = True\n\nWhile IE.Busy Or IE.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n\nSet doc = IE.document\n\nDim i As Integer\nDim lastRow As Integer\nDim fileLink26 As String\nDim fileLink19 As String\n\nSheets(\"Case\").Select\nlastRow = Sheets(\"Case\").Cells(Rows.Count, \"A\").End(xlUp).Row\nFor i = 2 To lastRow\n\ndoc.contentDocument.querySelector(\"[onclick='CreateAcqCase();']\").Click\n\nApplication.Wait (Now + TimeValue(\"00:00:05\"))\n\nfileLink26 = Cells(i, 26)\nfileLink19 = Cells(i, 19)\n\n    If fileLink26 = \"\" And fileLink19 = \"CB\" And Cells(i, 10).Value = \"USD\" Then\n    On Error Resume Next\n    Dim DispStg2 As Object\n    Do While DispStg2 Is Nothing\n    Set DispStg2 = doc.getElementsByTagName(\"iframe\")(0).contentDocument.querySelector(\"input[value='FirstCB']\")\n    DoEvents\n    Loop\n    DispStg2.Click\n\nApplication.Wait (Now + TimeValue(\"00:00:03\"))\n\ndoc.getElementsByTagName(\"iframe\")(0).contentDocument.querySelector(\"input.rightJustifyStyle\").Item(2).Value = Sheets(\"Case\").Range(\"k2\") '&gt;&gt; This is where I stuck cause nothing happen after this code ran\n\nEnd If\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576660692, "post_id": 59388804, "comment_id": 104968073, "body": "Put a <code>DoEvents</code> between those lines."}, {"owner": {"reputation": 5, "user_id": 8431474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113f4a5677ec26d361316bb5cd9110b1?s=128&d=identicon&r=PG&f=1", "display_name": "Shampooooo", "link": "https://stackoverflow.com/users/8431474/shampooooo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576661814, "post_id": 59388804, "comment_id": 104968649, "body": "@braX Thanks for the quick reply. I tried this after seeing your comment but this doesn&#39;t seem to work."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576661946, "post_id": 59388804, "comment_id": 104968717, "body": "Then there must be some other issue in your other code you didnt include."}, {"owner": {"reputation": 5, "user_id": 8431474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113f4a5677ec26d361316bb5cd9110b1?s=128&d=identicon&r=PG&f=1", "display_name": "Shampooooo", "link": "https://stackoverflow.com/users/8431474/shampooooo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576665210, "post_id": 59388804, "comment_id": 104970388, "body": "@braX I just tried creating a new file and it still doesn&#39;t work somehow. All the code in this new file are in the update above."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1576665279, "post_id": 59388804, "comment_id": 104970435, "body": "Oh you are using WinAPI? There&#39;s no need for that... you just need a loop with a doevents in it."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8431474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113f4a5677ec26d361316bb5cd9110b1?s=128&d=identicon&r=PG&f=1", "display_name": "Shampooooo", "link": "https://stackoverflow.com/users/8431474/shampooooo"}, "edited": false, "score": 0, "creation_date": 1576671331, "post_id": 59390154, "comment_id": 104973411, "body": "Thank you very much, this works perfectly. However, when I am trying to test this with a small interval (replace 2 with 0.25, for example), it seems like the smallest actual interval as it runs is about 0.5 seconds. Are there any ways to further reduce this interval, or it&#39;s just a hardware issue?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 5, "user_id": 8431474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113f4a5677ec26d361316bb5cd9110b1?s=128&d=identicon&r=PG&f=1", "display_name": "Shampooooo", "link": "https://stackoverflow.com/users/8431474/shampooooo"}, "edited": false, "score": 0, "creation_date": 1576687241, "post_id": 59390154, "comment_id": 104982235, "body": "Possible, but a bit more complex - <a href=\"https://stackoverflow.com/questions/47951860/vba-string-with-milliseconds-to-date\" title=\"vba string with milliseconds to date\">stackoverflow.com/questions/47951860/&hellip;</a>"}, {"owner": {"reputation": 5, "user_id": 8431474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113f4a5677ec26d361316bb5cd9110b1?s=128&d=identicon&r=PG&f=1", "display_name": "Shampooooo", "link": "https://stackoverflow.com/users/8431474/shampooooo"}, "edited": false, "score": 0, "creation_date": 1576721524, "post_id": 59390154, "comment_id": 104993759, "body": "The link seems to be formatting and converting a string to a number instead of dealing with Date (or did I misunderstood?)......While I made another update using WinAPI GetTickCount to deal with DoEvent loop, and now it feels like working with smaller time interval."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1576665402, "creation_date": 1576665402, "answer_id": 59390154, "question_id": 59388804, "link": "https://stackoverflow.com/questions/59388804/how-to-update-the-image-before-sleep/59390154#59390154", "title": "How to update the image before sleep?", "body": "<p>Do it like this instead:</p>\n\n<pre><code>Sub Button1_Click()\n  Dim dt as Date\n\n  dt = DateAdd(\"s\", 2, Now) ' 2 seconds\n  Worksheets(\"Sheet1\").Shapes(\"Picture 2\").IncrementLeft 1000\n\n  Do Until Now &gt; dt\n    DoEvents\n  Loop\n\n  ' more stuff here after the waiting is done\n  Worksheets(\"Sheet1\").Shapes(\"Picture 2\").IncrementLeft 2000\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8431474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/113f4a5677ec26d361316bb5cd9110b1?s=128&d=identicon&r=PG&f=1", "display_name": "Shampooooo", "link": "https://stackoverflow.com/users/8431474/shampooooo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 59390154, "answer_count": 1, "score": 0, "last_activity_date": 1576720907, "creation_date": 1576660650, "last_edit_date": 1576720907, "question_id": 59388804, "link": "https://stackoverflow.com/questions/59388804/how-to-update-the-image-before-sleep", "title": "How to update the image before sleep?", "body": "<p>I am trying to move a picture and then make the code sleep for a while. The problem is, the position of the picture does not update before \"sleeping\". Here is the code:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Shapes(\"Picture1\").IncrementLeft 100\nSleep 500\n</code></pre>\n\n<p>When I execute this code(the sub is called by a button), the position of the picture does not change until the end of \"sleep 500\".</p>\n\n<p>How can I update the picture before sleep? I will be much appreciated if you can also explain this to me.</p>\n\n<hr>\n\n<p>Update using DoEvents:\nI created a new excel file, with only the picture and button in the sheet, and the following code(full code):</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As LongPtr)\nSub Button1_Click()\nWorksheets(\"Sheet1\").Shapes(\"Picture 2\").IncrementLeft 100\nDoEvents\nSleep 2000\nEnd Sub\n</code></pre>\n\n<p>and it still doesn't work. Or did I misunderstood the usage of \"DoEvents\"? I apologize if I am being stupid.</p>\n\n<hr>\n\n<p>Update using GetTickCount and suggestion from braX: I am using another WinAPI GetTickCount to serve as timer for DoEvent loop. Now it seems to work with smaller time interval?</p>\n\n<pre><code>Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal Milliseconds As LongPtr)\nPrivate Declare Function GetTickCount Lib \"kernel32\" () As Long\n\nSub Button1_Click()\nMove_Right_With_Time \"Sheet1\", \"Picture1\", 50, 100\nMove_Right_With_Time \"Sheet1\", \"Picture1\", 80, 200\nMove_Right_With_Time \"Sheet1\", \"Picture1\", 300, 300\nMove_Right_With_Time \"Sheet1\", \"Picture1\", 20, 400\nEnd Sub\n\n'time_gap represent the time slept after moving\nSub Move_Right_With_Time(worksheet As String, shape As String, time_gap As Long, distance As Double)\nDim start_timer As Long\n\nWorksheets(worksheet).Shapes(shape).IncrementLeft distance\n\nstart_timer = GetTickCount\nWhile GetTickCount &lt; start_timer + time_gap\nDoEvents\nWend\n\nSleep time_gap\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["json", "vba", "ms-access"], "comments": [{"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1576661449, "post_id": 59387964, "comment_id": 104968452, "body": "How far does your code work? Is the port initialization working? To me it can&#39;t, as you don&#39;t give a value to <code>intPortID</code> before calling <code>CommOpen(intPortID...)</code>"}, {"owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "reply_to_user": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1576665969, "post_id": 59387964, "comment_id": 104970760, "body": "its comopen out of range error no. 9"}, {"owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "reply_to_user": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1576667575, "post_id": 59387964, "comment_id": 104971568, "body": "Is it okay if I give it a value like this assuming this the port to opened (intPortID = 2)"}, {"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 1, "creation_date": 1576678274, "post_id": 59387964, "comment_id": 104976996, "body": "Well, you MUST give a value to <code>intPortID</code>, e.g. <code>intPortID = 2</code> before you call <code>CommOpen(intPortID...)</code>. A variable of type integer is initialized to 0 as default, and that is not a valid comm port number. And you must of course give the number of the comm port that you are using for your connection."}], "owner": {"reputation": 43, "user_id": 12165844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499ae927cb74ccd7be6a148316613863?s=128&d=identicon&r=PG&f=1", "display_name": "nector", "link": "https://stackoverflow.com/users/12165844/nector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576668749, "creation_date": 1576657150, "last_edit_date": 1576668749, "question_id": 59387964, "link": "https://stackoverflow.com/questions/59387964/failing-vba-with-rs-232-com-port", "title": "Failing VBA with Rs 232 com port", "body": "<p>I need your help to spot why the code below failed to run or connect to RS 232/VBA Ms Access. First and foremost, below is the specification of the machine provided by the Taxman:\n1.      Configuration for the serial port is as follows:</p>\n\n<pre><code>\"baud=115200\nparity=N\ndata=8\nstop=1\n</code></pre>\n\n<p>\"\nthere is no restriction on the write/read data rate\n2.      we leave the port open 24 hours service. We suggest you use this approach. Leave the port open.\n3.      Every information returned by the ESD during invoice signing request should be printed on the invoice.</p>\n\n<p>End of instruction guide by the Taxman</p>\n\n<p>The assembled code below is in 4 stages, I will explain all the stages in details below:</p>\n\n<p>(1)      </p>\n\n<pre><code>CommOpen(intPortID\n</code></pre>\n\n<p>:\nThis is the first stage of interaction with the machine, the code here is used to open the gadget or initialise if like it that way. I have no problem with this.</p>\n\n<p>(2)      </p>\n\n<pre><code>CommWrite(intPortID, strData)\n</code></pre>\n\n<p>:\nThe second stage is to now write the data into the port. What I have done here is to put the converted Json data into a string first as follows:</p>\n\n<pre><code>strData = JsonConverter.ConvertToJson(transaction, Whitespace:=3)\n</code></pre>\n\n<p>Then assign that Json data into string as below:</p>\n\n<pre><code>lngStatus = CommWrite(intPortID, strData)\n</code></pre>\n\n<p>(3)      Finally, I have now put an error handling code see below</p>\n\n<p><strong>END OF SENDING DATA WITH JSON FORMAT</strong></p>\n\n<p><strong>Full code below:</strong></p>\n\n<pre><code>Dim json As String\n    Dim intPortID As Integer ' Ex. 1, 2, 3, 4 for COM1 - COM4\n    Dim lngStatus As Long\n    Dim strError  As String\n    Dim strData   As String\n    Dim lngSize As Long\n    ' Initialize Communications\n    lngStatus = CommOpen(intPortID, \"COM\" &amp; CStr(intPortID), _\n        \"baud=115200 parity=N data=8 stop=1\")\n\n    If lngStatus &lt;&gt; 0 Then\n    ' Handle error.\n        lngStatus = CommGetError(strError)\n    MsgBox \"COM Error: \" &amp; strError\n    End If\n\n\n    ' Set modem control lines.\n    lngStatus = CommSetLine(intPortID, LINE_RTS, True)\n    lngStatus = CommSetLine(intPortID, LINE_DTR, True)\n\n    ' Write data to serial port.\n    strData = JsonConverter.ConvertToJson(transaction, Whitespace:=3)\n    lngSize = Len(strData)\n    lngStatus = CommWrite(intPortID, strData)\n    If lngStatus &lt;&gt; lngSize Then\n    ' Handle error.\n    End If\nCall CmdReadWrite_Click\nExit_CmdConertJson_Click:\nExit Sub\nErr_Handler:\nResume Exit_CmdConertJson_Click\nEnd Sub\n</code></pre>\n\n<p><strong>Reading Data Code</strong></p>\n\n<p>This where I have BIG problems, see issues below:\n(1)      I\u2019m required to leave the code open without limitation:</p>\n\n<pre><code>lngStatus = CommRead(intPortID, strData, 14400)\n</code></pre>\n\n<p>The above limitation is not required (14400) it must be open, but if do not put something it always gives an error request for a missing parameter.\n(2)      I\u2019m not very sure whether the code below functions properly, someone helped me here sometime back, but I cannot remember what was discussed about it I have a lot of ?????????? here:</p>\n\n<pre><code>ReadDataFromSerialDevice (DataRead, 4)\n</code></pre>\n\n<p>(3)      I want to now store the received data from the gadget into table called (\"tblEfdReceipts\"), but here, that is where another challenge is Im completely lost here, I have put a code below just on try and error basis, can someone help me here????????????</p>\n\n<pre><code>StoreData DataObject\n</code></pre>\n\n<p>(4)      Because the received data need to be attached with the sent invoice details and signed by the Taxman server, I have now attempted to attach the actual invoice, see below:</p>\n\n<pre><code>rs![INVID] = Me.InvoiceID\n</code></pre>\n\n<p>Summary</p>\n\n<p>The data cannot be sent and signed up from the Taxman server as long the above issues mentioned above cannot be resolved. I feel the major problem is on the receiving side and the parameter limitation. Kindly see how you can help on this.\nThe worst case scenario is that now we have to wait for another 90 days to have this software retested due to a huge number of people lining up for the same certification with taxman.</p>\n\n<p><strong>Full code for receiving</strong></p>\n\n<pre><code>Private Sub CmdReadWrite_Click()\nDim DataRead As String\n  Dim DataObject As Object\n\n  If ReadDataFromSerialDevice (DataRead, 4) Then\n    ' Call to your JSON library to parse it.\n    Set DataObject = ParseJson(DataRead)\n    StoreData DataObject\n    MsgBox \"Data have written in the contact table\", vbExclamation, \"Please proceed\"\n    Set DataObject = Nothing\n  End If\n\nEnd Sub\n\n\nPrivate Function ReadDataFromSerialDevice (ByRef ADataRead As String, APortID As Long) As Boolean\n\n  Dim lngStatus As Long\n  Dim strData As String\n  Dim intPortID As Integer\n\n  ReadDataFromSerialDevice = False\n   lngStatus = CommRead(intPortID, strData, 14400)\n    If lngStatus &gt; 0 Then\n    ADataRead = strData\n    ReadDataFromSerialDevice = True\n  End If\n\n  lngStatus = CommSetLine(intPortID, LINE_RTS, False)\n  lngStatus = CommSetLine(intPortID, LINE_DTR, False)\n  ' Close communications.\n    Call CommClose(intPortID)\nEnd Function\n\nPrivate Sub StoreData(ADataObject As Object)\n\n  Dim db As DAO.Database\n  Dim rs As DAO.Recordset\n  Dim item As Object\n\n  Set db = CurrentDb\n  Set rs = db.OpenRecordset(\"tblEfdReceipts\")\n  For Each item In ADataObject\n    rs.AddNew\n            rs![TPIN] = item(\"TPIN\")\n            rs![TaxpayerName] = item(\"TaxpayerName\")\n            rs![Address] = item(\"Address\")\n            rs![ESDTime] = item(\"ESDTime\")\n            rs![TerminalID] = item(\"TerminalID\")\n            rs![InvoiceCode] = item(\"InvoiceCode\")\n            rs![InvoiceNumber] = item(\"InvoiceCode\")\n            rs![FiscalCode] = item(\"FiscalCode\")\n            rs![TalkTime] = item(\"TalkTime\")\n            rs![Operator] = item(\"Operator\")\n            rs![Taxlabel] = item(\"TaxItems\")(\"TaxLabel\")\n            rs![CategoryName] = item(\"TaxItems\")(\"CategoryName\")\n            rs![Rate] = item(\"TaxItems\")(\"Rate\")\n            rs![TaxAmount] = item(\"TaxItems\")(\"TaxAmount\")\n            rs![VerificationUrl] = item(\"TaxItems\")(\"VerificationUrl\")\n            rs![INVID] = Me.InvoiceID\n            rs.Update\n  Next item\n\n  rs.Close\n  Set rs = Nothing\n  Set db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Dx8fD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Dx8fD.png\" alt=\"enter image description here\"></a></p>\n\n<p>This error messages come up after assigning intPortID to (intPortID = 2) and StoreData DataObject to StoreData (DataObject)</p>\n"}, {"tags": ["excel", "vba", "replace"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 4562254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd19025db428bd0a7429cff763aa7c95?s=128&d=identicon&r=PG&f=1", "display_name": "witchdoctor", "link": "https://stackoverflow.com/users/4562254/witchdoctor"}, "edited": false, "score": 0, "creation_date": 1576739664, "post_id": 59388388, "comment_id": 104997875, "body": "Hi Zev, thanks for the reply, certainly was a great improvement, and now generally works about 95% of the time.  I do have a small issue with the \\b function recognising words with a dash &quot;-&quot; in them at times, it seems to recognise this as a boundary also, although not sure why at this stage.     I also tried \\s which theoretically should do a break on &quot;space&quot;, but it went skewed, for some reason, so returned to \\b."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 0, "last_activity_date": 1576760355, "last_edit_date": 1576760355, "creation_date": 1576658937, "answer_id": 59388388, "question_id": 59387739, "link": "https://stackoverflow.com/questions/59387739/replace-whole-words-from-a-predefined-list/59388388#59388388", "title": "Replace Whole Words from a Predefined List", "body": "<p>NB: I would strongly recommend adding a reference to the <strong>Microsoft VBScript Regular Expressions 5.5</strong> library (via <strong>Tools -> References...</strong>). This will give you strong typing and Intellisense on the <code>RegExp</code> object.</p>\n\n<pre><code>Dim RgExp As New RegExp\n</code></pre>\n\n<hr>\n\n<p>If I understand correctly, you can find the entries that need to be replaced using a regular expression; the regular expression only matches entries where the value in <code>A</code> is a complete word.</p>\n\n<p>But when you try to replace with the VBA <code>Replace</code> function, it replaces even partial words in the text. And using the <code>RegExp.Replace</code> method has no effect -- the string always remains the same.</p>\n\n<p>This is a quirk of the regular expression engine used in VBA. You cannot replace a complete match; you can only replace something which has been captured in a group, using <code>(</code> <code>)</code>.</p>\n\n<pre><code>RgExp.Pattern = \"\\b(\" &amp; word &amp; \")\\b\"\n\n' ...\n\nnewString = RgExp.Replace(newString, cleanword)\n</code></pre>\n\n<hr>\n\n<p>If you want to exclude the hyphen from the boundary characters, you might be able to use a negative pattern which excludes any word characters or the hyphen:</p>\n\n<pre><code>RgExp.Pattern = \"[^\\w-](\" &amp; word &amp; \")[^w-]\"\n</code></pre>\n\n<hr>\n\n<p>Reference:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions//k9z80300%28v%3dvs.85%29\" rel=\"nofollow noreferrer\"><strong>Replace</strong> method</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions//6wzad2b2%28v%3dvs.85%29\" rel=\"nofollow noreferrer\">Introduction to the VBScript regular expression library</a></li>\n</ul>\n"}], "owner": {"reputation": 17, "user_id": 4562254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd19025db428bd0a7429cff763aa7c95?s=128&d=identicon&r=PG&f=1", "display_name": "witchdoctor", "link": "https://stackoverflow.com/users/4562254/witchdoctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1576760355, "creation_date": 1576656122, "last_edit_date": 1576659792, "question_id": 59387739, "link": "https://stackoverflow.com/questions/59387739/replace-whole-words-from-a-predefined-list", "title": "Replace Whole Words from a Predefined List", "body": "<p>I currently have coding which will review an equipment description field, the aim of which to standardize entries.  That is - whatever is found in COL A, replace with COL B\nI want to post the answer back to a new clean description column (that will work OK, no dramas on that section, but I don't need any messages etc, and this may be doing 100,000+ descriptions at a time, so looking for efficient coding).</p>\n\n<p>However when it applies the Replace function, it also replaces part words, instead of distinct whole words, no matter how I sort the words on the Dictionary tab.\n** 99 times out of a hundred there are no preceding or trailing spaces in Col A entries, but there are rare occasions...</p>\n\n<p>Description Examples:</p>\n\n<pre><code>AIR COMPRESSOR\n\nLEVEL GAUGE OIL SEPARATOR GAS COMPRESSOR\n\nPRESS CTRL VV\n\nPRESSURE GAUGE FLAME FRONT\n</code></pre>\n\n<p><code>PRESS</code> as part of word becomes <code>PRESSURE</code>, e.g.:</p>\n\n<pre><code>COL A:              COL B:                    \nCOMPRESSSOR              COMPRESSOR                \nPRESSURE                 PRESSURE                  \nPRESSURE   GAUGE         PRESSURE GAUGE\nPRESS                    PRESSURE\nAIR COMPRESSOR           AIR COMPRESSOR\n</code></pre>\n\n<p>I think I'm very close to getting this right, but I can't figure out how to adjust to make it run and replace whole words only - I think it is the order of where I have stuff, but not 100% sure, or if something is missing.<br>\nI would greatly appreciate your help with this.</p>\n\n<p>Thanks,  Wendy</p>\n\n<pre><code>Function CleanUntil(original As String, targetReduction As Integer)\n\nDim newString As String\nnewString = original\n\nDim targetLength As Integer\ntargetLength = Len(original) - targetReduction\n\nDim rowCounter As Integer\nrowCounter = 2\n\nDim CleanSheet As Worksheet\nSet CleanSheet = ActiveWorkbook.Sheets(\"Dictionary\")\n\nDim word As String\nDim cleanword As String\n\n' Coding for replacement of WHOLE words - with a regular expression using a pattern with the \\b marker (for the word boundary) before and after word\nDim RgExp As Object\nSet re = CreateObject(\"VBScript.RegExp\")\nWith RgExp\n    .Global = True\n        '.IgnoreCase = True     'True if search is case insensitive.  False otherwise\nEnd With\n\n'Loop through each word until we reach the target length (or other value noted), or run out of clean words to apply\n'While Len(newString) &gt; 1     (this line will do ALL descriptions - confirmed)\n'While Len(newString) &gt; targetLength   (this line will only do to target length)\n\nWhile Len(newString) &gt; 1\n\n    word = CleanSheet.Cells(rowCounter, 1).Value\n    cleanword = CleanSheet.Cells(rowCounter, 2).Value\n\n    RgExp.Pattern = \"\\b\" &amp; word &amp; \"\\b\"\n\n    If (word = \"\") Then\n        CleanUntil = newString\n        Exit Function\n    End If\n\n    ' TODO: Make sure it is replacing whole words and not just portions of words\n'    newString = Replace(newString, word, cleanword)     ' This line works if no RgExp applied, but finds part words.\n    newString = RgExp.Replace(newString, word, cleanword)\n\n    rowCounter = rowCounter + 1\nWend\n\n' Once word find/replace finished, set close out loop for RgExp Object with word boundaries.\nSet RgExp = Nothing\n\n' Finally return the cleaned string as clean as we could get it, based on dictionary\nCleanUntil = newString\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1576655233, "post_id": 59387518, "comment_id": 104965701, "body": "You used single quotes around your first <code>myMonth</code> variable, then you didn&#39;t use quotes at all on your second one. Also, you sure about the formula? Try to <code>Debug.Print</code> the line first and see what it returns =)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576655807, "post_id": 59387518, "comment_id": 104965936, "body": "ah yes! My formula was wrong, but I read on the net that if I give it: day, month and year, the formula recognize it, so I tried to give only month and year, but It doesn&#39;t seems to works..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576655865, "post_id": 59387518, "comment_id": 104965956, "body": "Can you help me out with the formula? Should I split <b>myMonth</b> into to string with only month and year?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576655938, "post_id": 59387518, "comment_id": 104965993, "body": "What is it you really want the formula to do in the end? Do you want to return the last day of &quot;January 2020&quot;? Notice your variable currently hold a month and a year in it&#39;s string!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1576656412, "post_id": 59387518, "comment_id": 104966164, "body": "No I would like the formula to return the number of days of the given month. Ex January 2020"}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1576660697, "post_id": 59387972, "comment_id": 104968074, "body": "i agree. nicely explained :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "edited": false, "score": 0, "creation_date": 1581514096, "post_id": 59387972, "comment_id": 106459268, "body": "If you could take a look: <a href=\"https://stackoverflow.com/questions/60189425/excel-vba-run-formula-via-macro\" title=\"excel vba run formula via macro\">stackoverflow.com/questions/60189425/&hellip;</a>"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 3, "last_activity_date": 1576657926, "last_edit_date": 1576657926, "creation_date": 1576657191, "answer_id": 59387972, "question_id": 59387518, "link": "https://stackoverflow.com/questions/59387518/vba-excel-formula-in-a-string/59387972#59387972", "title": "VBA EXCEL formula in a String", "body": "<p>Well, as per my comment, there are a few mistakes here:</p>\n\n<ul>\n<li>You have used single quotes instead of double quotes to seperate your variable from VBA formula syntax</li>\n<li>You have forgotten the quotes at all around your second <code>myMonth</code> variable</li>\n<li>You have created a formula that simply won't work</li>\n</ul>\n\n<p>Keep in mind, your variable is not just a month but a string holding a month and year > <code>\"January 2020\"</code>, therefor <code>DATEVALUE</code> won't need the <code>01-</code> and <code>YEAR(myMonth)</code> to work. Let me explain:</p>\n\n<pre><code>=DATEVALUE(\"January 2020\")\n</code></pre>\n\n<p>Will return <code>Integer</code> 43831, or in other words: <code>1-1-2020</code>. Then secondly, <code>EOMONTH</code> will return the end of that same month as an <code>Integer</code>, whereas <code>DAY</code> will return the number of that day. So your formula would read:</p>\n\n<pre><code>=DAY(EOMONTH(DATEVALUE(\"January 2020\"),0))\n</code></pre>\n\n<p>Now to write this in VBA:</p>\n\n<pre><code>Dim stringAppoggio As String\nDim myMonth As String\n\nmyMonth = \"January 2020\"\nstringAppoggio = \"=DAY(EOMONTH(DATEVALUE(\"\"\" &amp; myMonth &amp; \"\"\"),0))\"\n</code></pre>\n\n<p>You can check that it works:</p>\n\n<pre><code>Debug.Print Evaluate(\"=DAY(EOMONTH(DATEVALUE(\"\"\" &amp; myMonth &amp; \"\"\"),0))\")\n</code></pre>\n\n<p><sub><strong>Note:</strong> See the triple quotes? That's because we need to feed <code>DATEVALUE</code> a string within quotes to work, otherwise it wouldn't be a string and will return an error</sub></p>\n"}, {"tags": [], "owner": {"reputation": 902, "user_id": 4240030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/euQWb.png?s=128&g=1", "display_name": "Mesut Akcan", "link": "https://stackoverflow.com/users/4240030/mesut-akcan"}, "is_accepted": false, "score": 0, "last_activity_date": 1576658115, "last_edit_date": 1576658115, "creation_date": 1576657513, "answer_id": 59388050, "question_id": 59387518, "link": "https://stackoverflow.com/questions/59387518/vba-excel-formula-in-a-string/59388050#59388050", "title": "VBA EXCEL formula in a String", "body": "<pre><code>Dim stringAppoggio As String\nDim myMonth As String\n\nmyMonth = Chr(34) &amp; \"January 2020\" &amp; Chr(34)\n\nstringAppoggio = \"=DAY(EDATE(\" &amp; myMonth &amp; \",1)-DAY(\" &amp; myMonth &amp; \"))\"\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 59387972, "answer_count": 2, "score": 1, "last_activity_date": 1576658115, "creation_date": 1576655048, "question_id": 59387518, "link": "https://stackoverflow.com/questions/59387518/vba-excel-formula-in-a-string", "title": "VBA EXCEL formula in a String", "body": "<p>Hi I would like to put into a STRING the following formula</p>\n\n<pre><code>Dim stringAppoggio As String\nDim myMonth As String\n\nmyMonth = \"January 2020\"\n\nstringAppoggio=\"=DAY(EOMONTH(DATEVALUE(01-'&amp;myMonth&amp;'-&amp;YEAR(myMonth)),0))\"\n</code></pre>\n\n<p>It doesn't really give me a syntax error, but I don't see the result of the formula in the String</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "powerquery", "unpivot"], "comments": [{"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1576656880, "post_id": 59387008, "comment_id": 104966368, "body": "Power Query can easily cope with more than a million records. The question would be why you are materialising the output... I can&#39;t imagine a good reason. But it would be trivial to have a query to unpivot the data, then two (or more) queries to filter (split) the results of the first query, into batches of the required row count. Please <a href=\"https://stackoverflow.com/posts/59387008/edit\">edit</a> your question to provide the required clarity."}, {"owner": {"reputation": 1542, "user_id": 2007837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6i2b.jpg?s=128&g=1", "display_name": "hsan", "link": "https://stackoverflow.com/users/2007837/hsan"}, "edited": false, "score": 0, "creation_date": 1576664705, "post_id": 59387008, "comment_id": 104970115, "body": "If your software accepts CSV files you should be able to use <a href=\"https://daxstudio.org/\" rel=\"nofollow noreferrer\">DAX Studio</a> to create a CSV file directly from your data model (in DAX Studio click on the <i>Output</i> button in the ribbon and change it to <i>File</i> before running the query)."}, {"owner": {"reputation": 27, "user_id": 11313581, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rISSDqhwKUc/AAAAAAAAAAI/AAAAAAAAAms/lR3rZOoUIXs/photo.jpg?sz=128", "display_name": "Vito Piepoli", "link": "https://stackoverflow.com/users/11313581/vito-piepoli"}, "edited": false, "score": 0, "creation_date": 1576666070, "post_id": 59387008, "comment_id": 104970803, "body": "Hi Hsan, thank you for your reply but I can&#39;t install any software on my devices being the data GDPR sensitive and therefore I have to use my Office ones. I have Power BI though, may I do the trick with it?"}, {"owner": {"reputation": 1542, "user_id": 2007837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6i2b.jpg?s=128&g=1", "display_name": "hsan", "link": "https://stackoverflow.com/users/2007837/hsan"}, "edited": false, "score": 0, "creation_date": 1576669105, "post_id": 59387008, "comment_id": 104972302, "body": "I don&#39;t think PowerBI has a way to directly export the data model. However, you can create a visual (table or chart should both work) with all the columns you are interested in, then click on the <code>...</code> to open its menu and click on *Export data&quot; to create a CSV."}, {"owner": {"reputation": 27, "user_id": 11313581, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rISSDqhwKUc/AAAAAAAAAAI/AAAAAAAAAms/lR3rZOoUIXs/photo.jpg?sz=128", "display_name": "Vito Piepoli", "link": "https://stackoverflow.com/users/11313581/vito-piepoli"}, "edited": false, "score": 0, "creation_date": 1576670476, "post_id": 59387008, "comment_id": 104972958, "body": "I have imported the Power Pivot data model with all the databases successfully unpivoted, but for some reason, it does not show any of the data. All combined I have almost 9 millions rows. could be this the reason?"}, {"owner": {"reputation": 1542, "user_id": 2007837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v6i2b.jpg?s=128&g=1", "display_name": "hsan", "link": "https://stackoverflow.com/users/2007837/hsan"}, "edited": false, "score": 0, "creation_date": 1576671200, "post_id": 59387008, "comment_id": 104973347, "body": "9 million rows shouldn&#39;t be a problem for PowerBI. However, I just found out that an export limit was introduced with the November update limiting CSV exports to 30,000 rows... which makes this functionality useless anyways. Looks like there are workarounds: <a href=\"https://stackoverflow.com/a/51386029/2007837\">stackoverflow.com/a/51386029/2007837</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1913, "user_id": 12289098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0aa277ac2300dbb8c8bf979a88c03dd?s=128&d=identicon&r=PG", "display_name": "Kosuke Sakai", "link": "https://stackoverflow.com/users/12289098/kosuke-sakai"}, "is_accepted": true, "score": 0, "last_activity_date": 1577195735, "creation_date": 1577195735, "answer_id": 59469850, "question_id": 59387008, "link": "https://stackoverflow.com/questions/59387008/unpivot-file-with-power-query-results-in-file-with-more-than-1-million-records/59469850#59469850", "title": "Unpivot file with power query results in file with more than 1 million records", "body": "<p>There is a possible solution using VBA. In this approach you need to:</p>\n\n<ol>\n<li>Load the Power Query table into Power Pivot Workbook Data Model</li>\n<li>Fetch data from the Workbook Data Model using VBA</li>\n<li>Write the records into a CSV file</li>\n</ol>\n\n<p>Below is step by step how to.</p>\n\n<p>For proofing, I created a dummy table of 3 million rows inside Power Query using below code, naming it \"MyData\".</p>\n\n<pre><code>// MyData: A table of 3 million rows\n\nlet RowCount = 3000000\nin Table.FirstN(\n    Table.FromColumns({\n        List.Generate(() =&gt; 1, each true, each _ + 1),\n        List.Generate(() =&gt; Number.Random() * 1000, each true, each Number.Random() * 1000)\n    }, type table [ID = Int64.Type, RandomNumber = number]),\n    RowCount\n)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/sbOms.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sbOms.png\" alt=\"MyData\"></a></p>\n\n<p>I loaded this table into the Workbook Data Model by selecting <strong>Close &amp; Load To</strong>, then selecting <strong>Only Create Connection</strong> and checking <strong>Add this data to the Data Model</strong>.</p>\n\n<p>Then, using below VBA code, I was able to connect to the Data Model, fetch the records, and dump it to a CSV file.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Const OutFile As String = \"C:/path/to/MyData.csv\"\n\nDim Wb As Workbook\nSet Wb = Application.ActiveWorkbook\n\nWb.Model.Initialize\n\n'Connection to the Data Model\nDim Conn As Object 'ADODB.Connection\nSet Conn = Wb.Model.DataModelConnection.ModelConnection.ADOConnection\n\nDim Recordset As Object 'ADODB.Recordset\nSet Recordset = CreateObject(\"ADODB.Recordset\")\n\nDim Query As String\nQuery = \"EVALUATE MyData\" 'DAX query to return the entire table\n\nRecordset.Open Query, Conn\n\nDim FileNum: FileNum = FreeFile()\nOpen OutFile For Output As #FileNum\n\nDo While Not Recordset.EOF\n    Write #FileNum, Recordset(\"MyData[ID]\"), Recordset(\"MyData[RandomNumber]\")\n    Recordset.MoveNext\nLoop\n\nClose #FileNum\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11313581, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rISSDqhwKUc/AAAAAAAAAAI/AAAAAAAAAms/lR3rZOoUIXs/photo.jpg?sz=128", "display_name": "Vito Piepoli", "link": "https://stackoverflow.com/users/11313581/vito-piepoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 59469850, "answer_count": 1, "score": 0, "last_activity_date": 1577195735, "creation_date": 1576652844, "last_edit_date": 1576659471, "question_id": 59387008, "link": "https://stackoverflow.com/questions/59387008/unpivot-file-with-power-query-results-in-file-with-more-than-1-million-records", "title": "Unpivot file with power query results in file with more than 1 million records", "body": "<p>Is there any chance to get a file splitted before the unpivoting process is completed? I have tried to do the opposite, that is to split the file and then unpivot it, but it requires too much time due to the fact I have to deal with more than 20 files and I can't be able to write a functioning Macro to do the job.\nI have to materialise it because I have to load the files into another software that does not have the unpivoting function in it and I can't get direct access to their databases to run any queries.</p>\n"}, {"tags": ["vba", "ms-access", "winapi", "webcam"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1576655344, "post_id": 59386649, "comment_id": 104965738, "body": "Start by looking up the error you get: print <code>Err.LastDLLError</code> after <code>WM_CAP_DRIVERCONNECT</code> doesn&#39;t work and look it up in the <a href=\"https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes\" rel=\"nofollow noreferrer\">system error codes table</a>. Also, never change back from <code>LongPtr</code> to <code>Long</code>, you&#39;re only introducing errors, and the only advantage is you can use it in Office 2007 and earlier, which are all unsupported."}, {"owner": {"reputation": 1, "user_id": 12146167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bekJoLo77qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNXjR74TMiTDJXgyU-Gc5MYkgcYg/photo.jpg?sz=128", "display_name": "user0038478193", "link": "https://stackoverflow.com/users/12146167/user0038478193"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1576660210, "post_id": 59386649, "comment_id": 104967805, "body": "@ErikA Thanks, I&#39;ll do that and change to <code>LongPtr</code> again"}, {"owner": {"reputation": 1, "user_id": 12146167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bekJoLo77qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNXjR74TMiTDJXgyU-Gc5MYkgcYg/photo.jpg?sz=128", "display_name": "user0038478193", "link": "https://stackoverflow.com/users/12146167/user0038478193"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1576720888, "post_id": 59386649, "comment_id": 104993639, "body": "@ErikA I tested this part  <code>hCap = capCreateCaptureWindow(&quot;Take a Camera Shot&quot;, WS_CHILD Or WS_VISIBLE, 0, 0, PicWebCam.Width, PicWebCam.Height, PicWebCam.Form.hWnd, 0)</code> sSleep <code>2000</code>Print #1, <code>hCap</code>      If hCap &lt;&gt; 0 Then          bool1 = <code>CBool(SendMessage(hCap, WM_CAP_DRIVER_CONNECT, 0, 0))</code>         Print #1, <code>bool1</code>           If bool1 = <code>False</code> Then           Print #1, <code>Err.LastDllError</code> and my output was 329426, False, 0. Could I be getting 0 because it&#39;s Access Runtime or is there something else at work here?"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1576730768, "post_id": 59386649, "comment_id": 104995409, "body": "@ErikA you can&#39;t use <code>Err.LastDLLError</code> with <code>WM_CAP_DRIVER_CONNECT</code>, as avicap32 doesn&#39;t report error codes that way (or any way, for that matter). <code>Err.LastDLLError</code> is only meaningful for APIs that use <code>SetLastError()</code> to report error codes. If an API is not documented as supporting <code>GetLastError()</code> then you can&#39;t safely use it (or anything based on it)"}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1576737802, "post_id": 59386649, "comment_id": 104997273, "body": "Which you choose, UNICAM Rear or UNICAM Front? Both them result in black screen? You can check Event Viewer to see if there is any related event and show error information. Refer to <a href=\"https://answers.microsoft.com/en-us/windows/forum/all/random-black-screen-issue/4c0beeeb-a800-42bf-9d34-15a39e53c152\" rel=\"nofollow noreferrer\">here</a> for how to check event."}, {"owner": {"reputation": 1, "user_id": 12146167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bekJoLo77qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNXjR74TMiTDJXgyU-Gc5MYkgcYg/photo.jpg?sz=128", "display_name": "user0038478193", "link": "https://stackoverflow.com/users/12146167/user0038478193"}, "reply_to_user": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1576746277, "post_id": 59386649, "comment_id": 105000626, "body": "@RitaHan-MSFT I want to use UNICAM Rear, I&#39;ve tried both and both result in black screen. Will take a look at Event Viewer, thanks!"}, {"owner": {"reputation": 1, "user_id": 12146167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bekJoLo77qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNXjR74TMiTDJXgyU-Gc5MYkgcYg/photo.jpg?sz=128", "display_name": "user0038478193", "link": "https://stackoverflow.com/users/12146167/user0038478193"}, "reply_to_user": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1576810177, "post_id": 59386649, "comment_id": 105025704, "body": "@RitaHan-MSFT I&#39;ve checked all the tabs in Event Viewer except the expanded Microsoft&gt;Windows folders. There are no related events or error information at the time of occurrence, a black screen in the picture box probably wasn&#39;t major enough to warrant a log."}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1576825077, "post_id": 59386649, "comment_id": 105028642, "body": "This issue seems capture driver related. What you can do is trying to check the status of the capture window using <a href=\"https://docs.microsoft.com/en-us/windows/win32/multimedia/wm-cap-get-status\" rel=\"nofollow noreferrer\"><code>WM_CAP_GET_STATUS</code></a> message. And have multiple attempts for each index of the capture driver and insert a delay between two attempt-connect to see if it is possible connecting successfully."}, {"owner": {"reputation": 1, "user_id": 12146167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bekJoLo77qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNXjR74TMiTDJXgyU-Gc5MYkgcYg/photo.jpg?sz=128", "display_name": "user0038478193", "link": "https://stackoverflow.com/users/12146167/user0038478193"}, "reply_to_user": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1577148716, "post_id": 59386649, "comment_id": 105106233, "body": "@RitaHan-MSFT I&#39;ve now tried inserting 5 second sleep and 5 tries for each capture driver, what happens with index 0 is they prompt me to choose the camera each time and it fails, returning a false. Not sure if I&#39;m using GET_STATUS properly - I&#39;ll put my code in an edit above."}, {"owner": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1577171539, "post_id": 59386649, "comment_id": 105110303, "body": "@user0038478193 <code>wParam</code> for <code>WM_CAP_GET_STATUS</code> is &quot;Size, in bytes, of the structure referenced bys&quot;, in C++ it will be <code>sizeof(CAPSTATUS)</code>"}, {"owner": {"reputation": 1, "user_id": 12146167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bekJoLo77qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNXjR74TMiTDJXgyU-Gc5MYkgcYg/photo.jpg?sz=128", "display_name": "user0038478193", "link": "https://stackoverflow.com/users/12146167/user0038478193"}, "reply_to_user": {"reputation": 8787, "user_id": 6601582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd0a2f69702729da5aaa628bc58811a7?s=128&d=identicon&r=PG&f=1", "display_name": "Rita Han", "link": "https://stackoverflow.com/users/6601582/rita-han"}, "edited": false, "score": 0, "creation_date": 1577345722, "post_id": 59386649, "comment_id": 105145862, "body": "@RitaHan-MSFT I&#39;ve changed <code>wParam</code> to <code>LenB(s)</code> which should work for arguments that are not strings; got it to return true when I used it with my laptop but still fails on the tablet, it returns a false after each prompt of index 0. No prompts occur with the other indexes, they just return false."}], "owner": {"reputation": 1, "user_id": 12146167, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bekJoLo77qQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNXjR74TMiTDJXgyU-Gc5MYkgcYg/photo.jpg?sz=128", "display_name": "user0038478193", "link": "https://stackoverflow.com/users/12146167/user0038478193"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 616, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577344796, "creation_date": 1576651003, "last_edit_date": 1577344796, "question_id": 59386649, "link": "https://stackoverflow.com/questions/59386649/webcam-capture-using-avicap32-on-access-365-form-works-on-single-camera-laptops", "title": "Webcam capture using avicap32 on Access 365 form works on single camera laptops(64-bit), black screen in picture box on 2-camera tablet(32-bit)", "body": "<p>After consulting \n<a href=\"https://stackoverflow.com/questions/56757965/how-to-use-webcam-capture-on-a-microsoft-access-form\">How to use webcam capture on a Microsoft Access form</a>,\nI have a program where the user presses a button on an Excel form to open an Access form and take before &amp; after photos using built-in webcam then save them to a predetermined folder. This works fine on several laptops including mine but when I try to run it on a tablet with front and back camera, it prompts me to choose between UNICAM Rear and UNICAM Front, which I presume means the code works fine and is connecting to the driver. However, the chosen camera doesn't connect; WM_CAP_DRIVER_CONNECT returns False and I get a black screen in the picture frame.</p>\n\n<p>The tablet is an Acer One 10 running Win10 Home 32-bit and Access 365 Runtime. The I've tested the program using Access Runtime through Command Prompt on my laptop and it worked fine, I've checked that other apps are allowed to access the camera, nothing else is using the camera, tested 0 to 9 for WM_CAP_CONNECT parameters, changed LongPtr back to Long (which by the way still makes it work on win10 Pro 64-bit) and it still doesn't work.</p>\n\n<p>I suspect it's an issue with the tablet and not the code since it's a company tablet and there are two cameras, perhaps I may be missing some permissions to connect to the camera via Access or the code doesn't work with two cameras, but I have no idea where to begin checking these.</p>\n\n<p>I'm currently trying to find a laptop with two cameras to test the program on and in the meantime I'm totally lost and would appreciate suggestions for anything I could try to fix this problem, whether related to the code or not - though I would like to avoid running executables like CommandCam, seeing as I'm using company computers.</p>\n\n<p>This is the part of my Excel code that affects opening Access: </p>\n\n<pre><code>Private Sub mainBtn_Click()\n    Dim LCategoryID As Long\n    Dim ShellCmd, LPath As String\n\n    Dim wsMain, wsRec As Worksheet\n\n    Set wsMain = Sheets(\"Main\")\n    Set wsRec = Sheets(\"Records\")\n\n    mainBtn.Enabled = False\n\n    LPath = ThisWorkbook.Path + \"\\Database1.accdb\"        \n\n    If mainBtn.Caption &lt;&gt; \"Record\" Then\n    If Dir(PathToAccess) &lt;&gt; \"\" And oApp Is Nothing Then\n    ShellCmd = \"\"\"\" &amp; PathToAccess &amp; \"\"\" \"\"\" &amp; LPath &amp; \"\"\"\"\n    VBA.Shell ShellCmd\n    If oApp Is Nothing Then Set oApp = GetObject(LPath)\n'    Set oApp = CreateObject(\"Access.Application\")\n    End If\n    Application.Wait (Now + TimeValue(\"00:00:05\"))\n\n    On Error Resume Next\n    oApp.OpenCurrentDatabase LPath\n    oApp.Visible = False\n    On Error GoTo 0\n'passing a value through a sub on Access\n    oApp.Run \"getName\", wsMain.Range(\"F5\").Value\n    End If\n'before photo\n    If mainBtn.Caption = \"Before Photo\" Then\n    oApp.DoCmd.openform \"Before Photo\"\n    mainBtn.Caption = \"After Photo\"\n    mainBtn.Enabled = True\n</code></pre>\n\n<p>This is my code in Access:</p>\n\n<pre><code>Option Compare Database\n\nConst WS_CHILD As Long = &amp;H40000000\nConst WS_VISIBLE As Long = &amp;H10000000\n\nConst WM_USER As Long = &amp;H400\nConst WM_CAP_START As Long = WM_USER\n\nConst WM_CAP_DRIVER_CONNECT As Long = WM_CAP_START + 10\nConst WM_CAP_DRIVER_DISCONNECT As Long = WM_CAP_START + 11\nConst WM_CAP_SET_PREVIEW As Long = WM_CAP_START + 50\nConst WM_CAP_SET_PREVIEWRATE As Long = WM_CAP_START + 52\nConst WM_CAP_DLG_VIDEOFORMAT As Long = WM_CAP_START + 41\nConst WM_CAP_FILE_SAVEDIB As Long = WM_CAP_START + 25\n\nPrivate Declare PtrSafe Function capCreateCaptureWindow _\n    Lib \"avicap32.dll\" Alias \"capCreateCaptureWindowA\" _\n         (ByVal lpszWindowName As String, ByVal dwStyle As Long _\n        , ByVal X As Long, ByVal Y As Long, ByVal nWidth As Long _\n        , ByVal nHeight As Long, ByVal hwndParent As LongPtr _\n        , ByVal nID As Long) As Long\n\nPrivate Declare PtrSafe Function SendMessage Lib \"user32\" _\n    Alias \"SendMessageA\" (ByVal hWnd As LongPtr, ByVal wMsg As Long _\n        , ByVal wParam As Long, ByRef lParam As Any) As Long\n\nPrivate Declare Sub sapiSleep Lib \"kernel32\" _\n        Alias \"Sleep\" _\n        (ByVal dwMilliseconds As Long)\n\nDim hCap As LongPtr\nDim i As Integer\nPrivate Sub cmd4_click()\n' take picture\n    Dim sFileName, sFileNameSub, dateNow, timeNow As String\n\n    i = i + 1\n    Call SendMessage(hCap, WM_CAP_SET_PREVIEW, CLng(False), 0&amp;)\n\n    dateNow = DateValue(Now)\n    timeNow = TimeValue(Now)\n\n    sFileName = CurrentProject.Path + \"\\dbimages\\Before Change \" + CStr(Year(dateNow)) + \".\" + CStr(Month(dateNow)) + \".\" + CStr(Day(dateNow)) + \"  \" + CStr(Hour(timeNow)) + \"h\" + CStr(Minute(timeNow)) + \"m\" + CStr(Second(timeNow)) + \"s.jpg\"\n    Call SendMessage(hCap, WM_CAP_FILE_SAVEDIB, 0&amp;, ByVal CStr(sFileName))\nDoFinally:\n    Call SendMessage(hCap, WM_CAP_SET_PREVIEW, CLng(True), 0&amp;)\n\n    If i = 4 Then\n    MsgBox \"4 pictures taken. Exiting\"\n     DoCmd.Close\n    Else\n    MsgBox \"Picture \" + CStr(i) + \" Taken\"\n    End If\n\nEnd Sub\nPrivate Sub Cmd3_Click()\nDim temp As Long\ntemp = SendMessage(hCap, WM_CAP_DRIVER_DISCONNECT, 0&amp;, 0&amp;)\nEnd Sub\nPrivate Sub cmd1_click()\n'    Dim connectAttempts As Integer\n    Dim i As Integer\n    hCap = capCreateCaptureWindow(\"Take a Camera Shot\", WS_CHILD Or WS_VISIBLE, 0, 0, PicWebCam.Width, PicWebCam.Height, PicWebCam.Form.hWnd, 0)\n    If hCap &lt;&gt; 0 Then\n        'Call SendMessage(hCap, WM_CAP_DRIVER_CONNECT, 0, 0)\n\n'        For i = 0 To 9\n        If CBool(SendMessage(hCap, WM_CAP_DRIVER_CONNECT, 0, 0)) = False Then\n'            connectAttempts = connectAttempts + 1\n            MsgBox \"Failed to connect Camera\"\n        Else\n'        Exit For\n        End If\n'        Next i\n        Call SendMessage(hCap, WM_CAP_SET_PREVIEWRATE, 45, 0&amp;)\n        Call SendMessage(hCap, WM_CAP_SET_PREVIEW, CLng(True), 0&amp;)\n    End If\nEnd Sub\nPrivate Sub Cmd2_Click()\n'back to excel\n'Dim temp As Long\n'temp = SendMessage(hCap, WM_CAP_DLG_VIDEOFORMAT, 0&amp;, 0&amp;)\n    DoCmd.Close\nEnd Sub\nPrivate Sub Form_Close()\nDim temp As Long\ntemp = SendMessage(hCap, WM_CAP_DRIVER_DISCONNECT, 0&amp;, 0&amp;)\n'DoCmd.ShowToolbar \"Ribbon\", acToolbarYes\nEnd Sub\nPrivate Sub Form_Load()\n'DoCmd.ShowToolbar \"Ribbon\", acToolbarNo\ni = 0\ncmd1.Caption = \"Start Cam\"\ncmd2.Caption = \"Done\"\ncmd3.Caption = \"dummy\"\ncmd4.Caption = \"Tak&amp;e Picture\"\n    DoCmd.RunCommand acCmdAppMinimize\n    DoCmd.Maximize\n    If stnName = \"Head 1\" Or stnName = \"Head 2\" Then\n    Pic1.Picture = CurrentProject.Path + \"\\images\\head_s.jpeg\"\n    ElseIf stnName = \"Marriage Head\" Or stnName = \"Plus Clip Head\" Then\n    Pic1.Picture = CurrentProject.Path + \"\\images\\marriage_s.jpeg\"\n    Else\n    Pic1.Picture = CurrentProject.Path + \"\\images\\6pair_s.jpeg\"\n    End If\n    cmd1_click\n    On Error Resume Next\n    CurrentProject.Application.Visible = True\nEnd Sub\n\nPrivate Sub sSleep(lngMilliSec As Long)\n    If lngMilliSec &gt; 0 Then\n        Call sapiSleep(lngMilliSec)\n    End If\nEnd Sub\n</code></pre>\n\n<p>EDIT: Camera app works fine on tablet but I get a black screen in picture box when trying to use it through Access.</p>\n\n<p>EDIT2: Code for <code>WM_CAP_GET_STATUS</code></p>\n\n<p>Added the following line in main module:</p>\n\n<p><code>Const WM_CAP_GET_STATUS = WM_CAP_START + 54</code></p>\n\n<p>Added the following in another module:</p>\n\n<pre><code>Type CAPSTATUS\n  uiImageWidth As Long\n  uiImageHeight As Long\n  fLiveWindow As Long\n  fOverlayWindow As Long\n  fScale As Long\n  ptScroll As POINTAPI\n  fUsingDefaultPalette As Long\n  fAudioHardware As Long\n  fCapFileExists As Long\n  dwCurrentVideoFrame As Long\n  dwCurrentVideoFramesDropped As Long\n  dwCurrentWaveSamples As Long\n  dwCurrentTimeElapsedMS As Long\n  hPalCurrent As Long\n  fCapturingNow As Long\n  dwReturn As Long\n  wNumVideoAllocated As Long\n  wNumAudioAllocated As Long\nEnd Type\n</code></pre>\n\n<p>New code for starting camera:</p>\n\n<pre><code>Private Sub cmd1_click()\n    Dim bool1, bool2, bool3 As Boolean\n    Dim o As Integer\n    Dim u As Integer\n    Dim s As CAPSTATUS\n\n    Open CurrentProject.Path + \"\\output.txt\" For Output As #1\n\n    i = 0 'global variable\n    hCap = capCreateCaptureWindow(\"Take a Camera Shot\", ws_child Or ws_visible, 0, 0, PicWebCam.Width, PicWebCam.Height, PicWebCam.Form.hwnd, 0)\n    sSleep 5000\n    If hCap &lt;&gt; 0 Then\n\n        For i = 0 To 9\n        Print #1, hCap\n        bool1 = CBool(SendMessage(hCap, WM_CAP_DRIVER_CONNECT, i, 0))\n        Print #1, bool1\n        bool3 = SendMessage(hCap, WM_CAP_GET_STATUS, LenB(s), s)\n        Print #1, bool3\n\n            For u = 1 To 4\n            If bool1 = True Then\n            bool1 = SendMessage(hCap, WM_CAP_DRIVER_DISCONNECT, i, 0&amp;)\n            End If\n\n            o = u * 7\n            bool1 = CBool(SendMessage(hCap, WM_CAP_DRIVER_CONNECT, i, 0))\n            Print #1, Tab(o); bool1\n            bool3 = SendMessage(hCap, WM_CAP_GET_STATUS, LenB(s), s)\n            Print #1, Tab(o); bool3\n            Next u\n\n        Call SendMessage(hCap, WM_CAP_SET_PREVIEWRATE, 45, 0&amp;)\n        Call SendMessage(hCap, WM_CAP_SET_PREVIEW, CLng(True), 0&amp;)\n\n        Next i\n    End If\n    Close #1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "edited": false, "score": 0, "creation_date": 1576656625, "post_id": 59385503, "comment_id": 104966256, "body": "however after I filter &lt;&gt; then I want to copy visible cell to a specific column. I can do it using for loop but it takes times."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "edited": false, "score": 1, "creation_date": 1576658352, "post_id": 59385503, "comment_id": 104966965, "body": "That is your 2nd question? I do not see that in your main question above? Also if you search stackoverflow, you can get the answer to the 2nd question. Try and search google for <code>visible cells autofilter</code>"}, {"owner": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "edited": false, "score": 0, "creation_date": 1576658864, "post_id": 59385503, "comment_id": 104967201, "body": "yes i tried and i can autofilter &quot;&lt;&gt;&quot;, however I can&#39;t paste the value correctly as when I copy the visible data, actually it seperates into different pieces, and I can&#39;t paste it directly"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "edited": false, "score": 1, "creation_date": 1576659042, "post_id": 59385503, "comment_id": 104967272, "body": "Copy and Pasting filtered results should go as a different question."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "edited": false, "score": 1, "creation_date": 1576659777, "post_id": 59385503, "comment_id": 104967607, "body": "<a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a> @wingkithui"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1576643694, "creation_date": 1576643694, "answer_id": 59385503, "question_id": 59384887, "link": "https://stackoverflow.com/questions/59384887/filter-blank-cell-value/59385503#59385503", "title": "Filter blank cell value", "body": "<p>If the first 6 rows are blank then do not filter <code>A:FE</code>. Construct your range and then filter it. I guess you want to filter on Col L (Field:=12)?</p>\n\n<p>Try this</p>\n\n<pre><code>Option Explicit\n\nSub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long\n    Dim rng As Range\n\n    Set ws = Sheet1 '&lt;~~ Change this to the relevant sheet\n\n    With ws\n        .AutoFilterMode = False\n\n        '~~&gt; Assuming that Col A will have all cells filled up\n        '~~&gt; Else change this to the relevant column or use .Find\n        '~~&gt; to find the last row\n        lRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Construct your range\n        Set rng = Range(\"A7:FE\" &amp; lRow)\n\n        '~~&gt; Filter it\n        rng.AutoFilter Field:=12, Criteria1:=\"&lt;&gt;\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10287830, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XpTGuQBsEUw/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP-gXK33a9e_FB1aycIynwK0dng7Q/mo/photo.jpg?sz=128", "display_name": "wingkit hui", "link": "https://stackoverflow.com/users/10287830/wingkit-hui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 1, "accepted_answer_id": 59385503, "answer_count": 1, "score": 1, "last_activity_date": 1576643720, "creation_date": 1576638139, "last_edit_date": 1576643720, "question_id": 59384887, "link": "https://stackoverflow.com/questions/59384887/filter-blank-cell-value", "title": "Filter blank cell value", "body": "<p>I am trying to filter the columns which is not blank, however it doesn't work with following code:</p>\n\n<pre><code> ActiveSheet.Range(\"A:FE\").AutoFilter Field:=12, Criteria1:=\"&lt;&gt;\", Operator:=xlOr\n</code></pre>\n\n<p>Also please notice that there are 6 rows on top of the header and I can't delete it for other purpose</p>\n\n<p>I don't know will it affect the coding</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1576654527, "creation_date": 1576654527, "answer_id": 59387398, "question_id": 59384657, "link": "https://stackoverflow.com/questions/59384657/the-blank-column-of-the-particular-list-box-based-on-query-is-not-recognized-as/59387398#59387398", "title": "The blank column of the particular List Box based on query is not recognized as either empty or null", "body": "<p><em>IsEmpty</em> is not for this usage. Try:</p>\n\n<pre><code>If Not IsNull(Date_Value) Then\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>If Nz(Date_Value) &lt;&gt; \"\" Then\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12336258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bede50e0b67ae50bfe418950bfb37e6b?s=128&d=identicon&r=PG&f=1", "display_name": "CodingPastMidnight", "link": "https://stackoverflow.com/users/12336258/codingpastmidnight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 59387398, "answer_count": 1, "score": 1, "last_activity_date": 1593675547, "creation_date": 1576636154, "last_edit_date": 1593675547, "question_id": 59384657, "link": "https://stackoverflow.com/questions/59384657/the-blank-column-of-the-particular-list-box-based-on-query-is-not-recognized-as", "title": "The blank column of the particular List Box based on query is not recognized as either empty or null", "body": "<p>The Listbox: <code>SearchList</code> get data from the query: <code>Machine_Search</code>.So how it works is i input my <code>Serial Number</code> into the <code>Search textbox</code> and press the button search then select the record displayed on the <code>SearchList</code>. When the record is selected, i then press edit. The condition is that if the record that i search using <code>Serial Number</code> have empty field in the <code>End_Date</code> it will go on smoothly. However if the record that is search using <code>Serial Number</code> have a date in the <code>End_Date</code> it will prompt a msgbox and, close and open the form again. The issue lies at where it cannot detect if <code>End_Date</code> is null or empty and will prompt the msgbox regardless of the condition.</p>\n\n<p>Table: Machine</p>\n\n<p>Query: Machine_Search - It query the table:Machine where there is a form called: <code>Machine_Load</code> which fills half the field in the table and the other will be filled by <code>Machine_Unload</code>/</p>\n\n<p>Form:Machine_Unload</p>\n\n<p>Is there a way to solve this issue?</p>\n\n<p><a href=\"https://i.stack.imgur.com/IfsMx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IfsMx.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Private Sub cmdSearch_Click()\nDim check As String\n    DoCmd.OpenQuery \"Machine_Search\"\n    DoCmd.Close acQuery, \"Machine_Search\"\n    SearchList.Requery\n\n    If SearchList.ListCount = 0 Then\n        MsgBox (\"No records found.\")\n        DoCmd.Close\n        DoCmd.OpenForm \"Machine_Unload\"\n        Exit Sub\n    End If\n\n    Me.cmdEdit.Enabled = True\n    Me.cmdSearch.Enabled = False\n    Me.txtSN.Enabled = True\n    Me.txtDate.Enabled = True\n    Me.txtTime.Enabled = True\n    Me.CheckTime.Enabled = True\n    Me.ListSuccess.Enabled = True\n    Me.txtOperator.Enabled = True\n    Me.txtRemarks.Enabled = True\n    Me.txtSearch.Enabled = False\n    Me.txtSN.SetFocus\nEnd Sub\n</code></pre>\n\n<pre><code>Private Sub cmdEdit_Click()\n\nOn Error GoTo Err_cmdEdit_Click\nDim SN_Value As String\nDim Date_Value As String\n    If Me.SearchList.ListIndex &gt; -1 Then\n        SN_Value = Me.SearchList.Value\n        Date_Value = Me.SearchList.Column(5)\n\n        If Not IsEmpty(Date_Value) Then\n            MsgBox (\"The Unload data for this Serial Number have been filled, Please confirm with cell leader.\")\n            DoCmd.Close\n            DoCmd.OpenForm \"Esagon_Unload\"\n            Exit Sub\n        End If\n    End If\n\n    'check whether there exists data in list\n    If Not (Me.SearchList.Recordset.EOF And Me.SearchList.Recordset.BOF) Then\n        'get data to text box control\n        With Me.SearchList.Recordset\n            Me.txtSN = .Fields(\"Serial_Number\")\n            'store id of serial number in tag of txtSN in case id is modified\n            Me.txtSN.Tag = .Fields(\"Serial_Number\")\n            'Disable button edit\n            Me.cmdEdit.Enabled = False\n            Me.cmdUpdate.Enabled = True\n\n        End With\n    End If\n\nEnd_Err:\nExit Sub\n\n\nErr_cmdEdit_Click:\nMsgBox (\"Select the Serial Number.\" &amp; vbCrLf &amp; \"Please try again and click on the Serial Number below.\")\nDoCmd.Close\nDoCmd.OpenForm \"Machine_Unload\"\nResume End_Err\n\nEnd Sub\n</code></pre>\n\n<pre><code>SELECT Machine.Serial_Number, Machine.End_Date, Machine.End_Time, Machine.End_System_Time, Machine.End_Operator, Machine.Success, Machine.End_Remarks\nFROM Machine\nWHERE (((Machine.Serial_Number)=[Forms]![Machine_Unload]![txtSearch]));\n</code></pre>\n"}, {"tags": ["excel", "vba", "histogram"], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 11106493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/467b2ed419ae538a9068c066d83b01f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nuri", "link": "https://stackoverflow.com/users/11106493/nuri"}, "is_accepted": true, "score": 0, "last_activity_date": 1576667484, "last_edit_date": 1576667484, "creation_date": 1576663565, "answer_id": 59389599, "question_id": 59384453, "link": "https://stackoverflow.com/questions/59384453/how-to-set-the-maximum-and-minimum-scale-of-the-x-axis-of-a-histogram/59389599#59389599", "title": "How to set the maximum and minimum scale of the x-axis of a histogram?", "body": "<p>According to the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.axis.minimumscale\" rel=\"nofollow noreferrer\">Microsoft Docs</a> <code>MaximumScale</code> and <code>MinimumScale</code> are not available for x-axis (xlCategory) but only for y-axis (xlValue). So you need to change the range.</p>\n"}], "owner": {"reputation": 85, "user_id": 12471581, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ufVIhjs8SE0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeh6D00KKmX9RviY0VQIqKOOHwJQ/photo.jpg?sz=128", "display_name": "henry", "link": "https://stackoverflow.com/users/12471581/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 59389599, "answer_count": 1, "score": 2, "last_activity_date": 1576667484, "creation_date": 1576634022, "last_edit_date": 1576634921, "question_id": 59384453, "link": "https://stackoverflow.com/questions/59384453/how-to-set-the-maximum-and-minimum-scale-of-the-x-axis-of-a-histogram", "title": "How to set the maximum and minimum scale of the x-axis of a histogram?", "body": "<p>I am trying to set my histograms to have a maximum and minimum scale as they are many zeros at the start and the end for some of my histograms. I was using </p>\n\n<pre><code>    With Activechart.Axes(xlCategory)\n        .MaximumScale = Application.WorksheetFunction.RoundUp(Bnum, -1)\n        .MinimumScale = Application.WorksheetFunction.RoundDown(Snum, -1)\n    End With\n</code></pre>\n\n<p>to try and set it where <code>Snum</code> is the smallest number and <code>Bnum</code> is the largest in the selected range.\nHowever there was a </p>\n\n<blockquote>\n  <p>Run-time error '-2147467259 (80004005)': Method of 'MaximumScale' of object 'Axis' failed</p>\n</blockquote>\n\n<p>So i was thinking, is it possible to set the scale for a histogram or do i have to change the bin and range to solve this. Please advise, thank you.</p>\n\n<p>If it is helpful, here is my full code to plot my histograms</p>\n\n<pre><code>Sub MakeHistogram()\n\n    Dim src_sheet As Worksheet, Graph_sheet As Worksheet\n    Dim selected_range As Range\n    Dim title As String\n    Dim r As Integer\n    Dim percent_cell As Range\n    Dim num_percent As Integer\n    Dim count_range As Range, bin_range As Range\n    Dim new_chart As Chart\n    Dim lRow As Long, lCol As Long, glRow As Long\n    Dim xStr As String\n    Dim RngToCover As Range, Chtob As ChartObject\n    Dim Snum As Long, Bnum As Long\n\n    With Application\n        .ScreenUpdating = False\n        .Calculation = xlCalculationManual\n        .EnableEvents = False\n        .DisplayStatusBar = False\n    End With\n\n    With Sheets(\"Data\")\n        lRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        lCol = .Cells(2, .Columns.Count).End(xlToLeft).Column\n    End With\n\n    For i = 5 To lCol\n\n        With Sheets(\"Data\")\n            Set selected_range = .Range(.Cells(6, i), .Cells(lRow, i))\n        End With\n        Set src_sheet = Sheets(\"Data\")\n        Set Graph_sheet = Sheets(\"Graphs\")\n        title = src_sheet.Cells(2, i).Value\n\n        With Graph_sheet\n            glRow = .Cells(.Rows.Count, 1).End(xlUp).Row + 1\n            If glRow = 2 Then glRow = glRow - 1\n            .Cells(glRow + 1, 1) = title\n            .Cells(glRow + 1, 1).Font.Bold = True\n        End With\n        xStr = src_sheet.Cells(5, i).Value\n        If xStr = \"%\" Then xStr = \"Percentage %\"\n\n        num_percent = selected_range.Count\n\n        ' See how many bins we will have.\n        Const BIN_SIZE As Integer = 5\n        Dim num_bins As Integer\n        num_bins = 150 \\ BIN_SIZE\n\n        ' Make the bin separators.\n        Graph_sheet.Cells(1, 2) = \"Bins\"\n\n        For r = 1 To num_bins - 1\n            Graph_sheet.Cells(r + 2, 2) = r * BIN_SIZE - 1\n        Next r\n\n        ' Make the counts.\n        Graph_sheet.Cells(1, 1) = \"Counts\"\n        Set count_range = Graph_sheet.Range(\"A\" &amp; glRow + 2 &amp; \":A\" &amp; num_bins + glRow)\n        Set bin_range = Graph_sheet.Range(\"B\" &amp; 3 &amp; \":B\" &amp; num_bins)\n\n        count_range = WorksheetFunction.Frequency(selected_range, bin_range)\n\n        ' Make the range labels.\n\n        Graph_sheet.Cells(1, 3) = \"Ranges\"\n        For r = 1 To num_bins - 1\n            Graph_sheet.Cells(r + 2, 3) = \"'\" &amp; _\n                5 * (r - 1) &amp; \"-\" &amp; _\n                  5 * (r - 1) + 4\n            Graph_sheet.Cells(r + 2, 3).HorizontalAlignment = _\n                xlRight\n        Next r\n        r = num_bins\n        Graph_sheet.Cells(r + 1, 3) = \"'\" &amp; _\n            5 * (r - 1) &amp; \"-150\"\n        Graph_sheet.Cells(r + 1, 3).HorizontalAlignment = xlRight\n\n        ' Make the chart.\n        Set new_chart = Charts.Add()\n        With new_chart\n            .ChartType = xlColumnClustered\n            .SetSourceData Source:=Graph_sheet.Range(\"A\" &amp; glRow + 2 &amp; \":A\" &amp; _\n                num_bins + glRow + 1), _\n                PlotBy:=xlColumns\n            .Location where:=xlLocationAsObject, _\n                Name:=\"Graphs\"\n        End With\n\n        'Get the largest and smallest number\n        Snum = 100\n        Bnum = 0\n        For Each cell In selected_range\n            With cell\n                If .Value &lt; Snum Then Snum = .Value\n                If .Value &gt; Bnum Then Bnum = .Value\n            End With\n        Next cell\n\n        With Graph_sheet\n            Set RngToCover = .Range(.Cells(glRow + 5, 5), .Cells(glRow + 22, 11))\n        End With\n\n        With ActiveChart\n            .HasTitle = True\n            .ChartTitle.Characters.Text = title &amp; \" Histogram\"\n            With .Axes(xlCategory, xlPrimary)\n                .HasTitle = True\n                .AxisTitle.Characters.Text = xStr\n            End With\n            .Axes(xlValue, xlPrimary).HasTitle = True\n            .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Count\"\n\n            ' Display percentage ranges on the X axis.\n            .SeriesCollection(1).XValues = \"='\" &amp; _\n                \"Graphs\" &amp; \"'!R3C3:R\" &amp; _\n                num_bins + 1 &amp; \"C3\"\n\n            Set Chtob = .Parent\n            Chtob.Height = RngToCover.Height\n            Chtob.Width = RngToCover.Width\n            Chtob.Top = RngToCover.Top\n            Chtob.Left = RngToCover.Left\n            With .Axes(xlCategory)\n                'Error starts here\n                .MaximumScale = Application.WorksheetFunction.RoundUp(Bnum, -1) \n                .MinimumScale = Application.WorksheetFunction.RoundDown(Snum, -1)\n            End With\n        End With\n        ActiveChart.SeriesCollection(1).Select\n        With ActiveChart.ChartGroups(1)\n            .Overlap = 0\n            .GapWidth = 0\n            .HasSeriesLines = False\n            .VaryByCategories = False\n        End With\n    Next i\n    With Application\n        .ScreenUpdating = True\n        .Calculation = xlCalculationAutomatic\n        .EnableEvents = True\n        .DisplayStatusBar = True\n    End With\nEnd sub\n</code></pre>\n\n<p>This code loops through the columns of data in the data sheet and get the frequency of each columns, which consist of a few hundred data, and get the counts for it to make a histogram in the graph sheet for each columns of data. </p>\n\n<p>Do clarify with me if you need more details, thank you.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576632421, "post_id": 59384232, "comment_id": 104960321, "body": "<i>Where</i> is the error ?"}, {"owner": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576632906, "post_id": 59384232, "comment_id": 104960419, "body": "the error is at the &quot;wspaste.Cells.Select&quot; part"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576633040, "post_id": 59384232, "comment_id": 104960444, "body": "Which one?  It would help to remove the unneeded parts of your code (eg all of the ScrollColumn lines)"}, {"owner": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576633171, "post_id": 59384232, "comment_id": 104960473, "body": "the second code dont work, it doesnt work when i move the code to bdncasemacro.xlsm, the unmerging part is from macro recording."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576645023, "post_id": 59384232, "comment_id": 104962628, "body": "Are you sure you are getting the error on <code>wspaste.Cells.Select</code> and not on <code>Set wspaste = ThisWorkbook.Worksheets(&quot;Raw&quot;)</code>? Few tips. <b>1.</b> Avoid using <code>wspaste.Cells</code>. Identify your actual range and work with it. <b>2.</b> Get rid of all <code>ActiveWindow.ScrollColumn</code> code lines <b>3.</b> Avoid the use of <code>.Select&#47;.Activate</code> You may want to see <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">THIS</a>"}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 2113672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2uII.jpg?s=128&g=1", "display_name": "Noah Bridge", "link": "https://stackoverflow.com/users/2113672/noah-bridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1576683357, "last_edit_date": 1576683357, "creation_date": 1576639071, "answer_id": 59385008, "question_id": 59384232, "link": "https://stackoverflow.com/questions/59384232/code-works-on-other-workbook-but-not-this-workbook/59385008#59385008", "title": "Code works on other workbook but not this workbook", "body": "<p><strong>Short-term solution</strong></p>\n\n<p>I am not sure why you would be getting error 9, which is the \"Subscript out of range\" message in a call to <code>Select</code>. Therefore, I will assume for now that you are getting a different error.</p>\n\n<p>If so, it seems to be because a <code>Select</code> on a range fails if the workbook containing the range is not the active workbook. When you run the code from a different workbook, you are opening \"<strong><em>bdncasemacro.xlsm</em></strong>\" second, meaning that that becomes the active workbook (the workbook opened last remains active). Therefore, there is no problem selecting cells on it, since <code>wspaste</code> is in <strong><em>bdncasemacro.xlsm</em></strong>. However, when you execute the code from within <strong><em>bdncasemacro.xlsm</em></strong>, you only open the other workbook, which makes it the active workbook, and then you create <code>wspaste</code> using <code>ThisWorkbook</code>. Therefore, <code>wspaste</code> is a worksheet on the workbook that is not active. This will definitely cause <code>wspaste.Cells.Select</code> to fail.</p>\n\n<p>A quick solution would be to force <strong><em>bdncasemacro.xlsm</em></strong> to become the active workbook by inserting this statement <strong>after</strong> opening the first workbook is opened:</p>\n\n<pre><code>ThisWorkbook.Activate\n</code></pre>\n\n<p>This line would, in essence, be the replacement for the second <code>Workbooks.Open</code> when the code is run from another workbook. You must also make sure that the worksheet containing the cells is the active one; otherwise, the <code>Select</code> can fail even if the workbook is active. To ensure this, you must add the following line before the first <code>wspaste.Cells.Select</code>:</p>\n\n<pre><code>wspaste.Activate\n</code></pre>\n\n<hr>\n\n<p><strong>Long-term solution</strong></p>\n\n<p>Having said this, I believe that a more permanent solution is to avoid <code>.Select</code> and <code>.Activate</code> altogether. The macro recorder adds that code because it is mechanically recording every action you take, but, in the code, you generally do not need to select cells in order to perform actions on them, as is described in the following link, under the section \"<strong><em>Avoid Select and Activate Whenever Possible</em></strong>\" (you will have to scroll down to the middle of the long page to get to the section) ...</p>\n\n<p><a href=\"http://www.excelcampus.com/vba/select-vs-activate-method/\" rel=\"nofollow noreferrer\">http://www.excelcampus.com/vba/select-vs-activate-method/</a></p>\n\n<p>The code also has several <code>Select</code> and <code>Activate</code> statements that \"overwrite\" each other, so to speak, meaning that you can delete the intermediate <code>Select</code> and <code>Activate</code> statements and only leave the last <code>Select</code> and <code>Activate</code> statements before actual work is done on the worksheet.</p>\n\n<p>It also seems as if the <code>ScrollWindow</code> calls are not necessary to perform the required actions. Those calls must have been added by the macro recorder as you were scrolling along the worksheets to perform the actions.</p>\n\n<p>Also, it seems as if the procedure is not closing the workbooks after opening them. That could be playing a role in the error 9 that you may be seeing at some point.</p>\n\n<p>Taking all of this into account, the code could be reduced to this:</p>\n\n<pre><code>    Dim wbDownload As Workbook\n    Set wbDownload = Workbooks.Open(\"C:\\Users\\attkeej1\\Desktop\\testing\\jobsummarydownloadmacro.xls\")\n\n    Set wscopy = wbDownload.Worksheets(\"Report\")\n    Set wspaste = ThisWorkbook.Worksheets(\"Raw\")\n\n    wscopy.Range(\"A1:AZ1000\").Copy wspaste.Range(\"A1\")\n    With wspaste.Cells\n            .WrapText = False\n            .Orientation = 0\n            .AddIndent = False\n            .IndentLevel = 0\n            .ShrinkToFit = False\n            .ReadingOrder = xlContext\n            .MergeCells = False\n    End With\n    wspaste.Rows(\"1:5\").Delete Shift:=xlShiftUp\n\n    wspaste.Cells.ColumnWidth = 8.29\n\n    With wspaste.Range(\"C:C,E:F,H:H,J:M,O:R,T:T,V:W,Y:AA,AC:AD,AF:AH,AJ:AJ,AL:AM,AO:AO,AQ:AR,AT:AU,AW:AY\")\n        .Delete Shift:=xlToLeft\n    End With\n\n    With wspaste.Cells\n        .ColumnWidth = 9.71\n        .ColumnWidth = 13.71\n    End With\n\n    wbDownload.Close\n</code></pre>\n\n<p>I hope I did not overdelete from your original code. If so, I apologise, but I hope the above is of help in shortening the code.</p>\n"}], "owner": {"reputation": 5, "user_id": 12318219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9481e62604d3a4bb03ed95862417e19d?s=128&d=identicon&r=PG&f=1", "display_name": "mkj2000", "link": "https://stackoverflow.com/users/12318219/mkj2000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576683357, "creation_date": 1576631606, "last_edit_date": 1576631753, "question_id": 59384232, "link": "https://stackoverflow.com/questions/59384232/code-works-on-other-workbook-but-not-this-workbook", "title": "Code works on other workbook but not this workbook", "body": "<p>Hi i have this code that unmerges the cells, it runs when it is in another workbook but have an error when i run it in its orignal workbook bdncasemacro.xlsm, it gives the error code 9. is there anything i can do to resolve this as i cant figure out the error as it runs in the other workbook .</p>\n\n<pre><code>Dim wscopy As Worksheet\nDim wspaste As Worksheet\nWorkbooks.Open \"C:\\Users\\attkeej1\\Desktop\\testing\\jobsummarydownloadmacro.xls\"\nWorkbooks.Open \"C:\\Users\\attkeej1\\Desktop\\testing\\bdncasemacro.xlsm\"\n    Set wscopy = Workbooks(\"jobsummarydownloadmacro.xls\").Worksheets(\"Report\")\n    Set wspaste = Workbooks(\"bdncasemacro.xlsm\").Worksheets(\"Raw\")\n\n wscopy.Range(\"A1:AZ1000\").Copy _\n    wspaste.Range(\"A1\")\n\n    wspaste.Cells.Select\n        With Selection\n            .WrapText = False\n            .Orientation = 0\n            .AddIndent = False\n            .IndentLevel = 0\n            .ShrinkToFit = False\n            .ReadingOrder = xlContext\n            .MergeCells = False\n            End With\n    wspaste.Rows(\"1:5\").Delete Shift:=xlShiftUp\n    wspaste.Cells.Select\n    Selection.ColumnWidth = 8.29\n    wspaste.Range(\"C:C,E:F,H:H,J:M,O:R,T:T,V:W,Y:AA\").Select\n    wspaste.Range(\"Y1\").Activate\n    ActiveWindow.ScrollColumn = 2\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 4\n    ActiveWindow.ScrollColumn = 5\n    ActiveWindow.ScrollColumn = 6\n    ActiveWindow.ScrollColumn = 7\n    ActiveWindow.ScrollColumn = 8\n    ActiveWindow.ScrollColumn = 9\n    ActiveWindow.ScrollColumn = 10\n    ActiveWindow.ScrollColumn = 11\n    ActiveWindow.ScrollColumn = 12\n    ActiveWindow.ScrollColumn = 13\n    ActiveWindow.ScrollColumn = 14\n    ActiveWindow.ScrollColumn = 15\n    ActiveWindow.ScrollColumn = 16\n    ActiveWindow.ScrollColumn = 17\n    ActiveWindow.ScrollColumn = 18\n    ActiveWindow.ScrollColumn = 19\n    ActiveWindow.ScrollColumn = 20\n    wspaste.Range( _\n        \"C:C,E:F,H:H,J:M,O:R,T:T,V:W,Y:AA,AC:AD,AF:AH,AJ:AJ,AL:AM,AO:AO,AQ:AR,AT:AU\"). _\n        Select\n    wspaste.Range(\"AT1\").Activate\n    ActiveWindow.ScrollColumn = 21\n    ActiveWindow.ScrollColumn = 22\n    ActiveWindow.ScrollColumn = 23\n    wspaste.Range( _\n        \"C:C,E:F,H:H,J:M,O:R,T:T,V:W,Y:AA,AC:AD,AF:AH,AJ:AJ,AL:AM,AO:AO,AQ:AR,AT:AU,AW:AY\" _\n        ).Select\n   wspaste.Range(\"AW1\").Activate\n    Selection.Delete Shift:=xlToLeft\n    wspaste.Range(\"AG23\").Select\n    ActiveWindow.ScrollColumn = 22\n    ActiveWindow.ScrollColumn = 21\n    ActiveWindow.ScrollColumn = 20\n    ActiveWindow.ScrollColumn = 19\n    ActiveWindow.ScrollColumn = 18\n    ActiveWindow.ScrollColumn = 16\n    ActiveWindow.ScrollColumn = 14\n    ActiveWindow.ScrollColumn = 11\n    ActiveWindow.ScrollColumn = 9\n    ActiveWindow.ScrollColumn = 6\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 1\n    wspaste.Cells.Select\n    Selection.ColumnWidth = 9.71\n    Selection.ColumnWidth = 13.71\n    wspaste.Range(\"D14\").Select\n\nEnd Sub\n</code></pre>\n\n<p>however it doesnt work when i try to run it in the original workbook giving the error code 9</p>\n\n<pre><code>Workbooks.Open \"C:\\Users\\attkeej1\\Desktop\\testing\\jobsummarydownloadmacro.xls\"\n    Set wscopy = Workbooks(\"jobsummarydownloadmacro.xls\").Worksheets(\"Report\")\n    Set wspaste = ThisWorkbook.Worksheets(\"Raw\")\n wscopy.Range(\"A1:AZ1000\").Copy _\n    wspaste.Range(\"A1\")\n\n    wspaste.Cells.Select\n        With Selection\n            .WrapText = False\n            .Orientation = 0\n            .AddIndent = False\n            .IndentLevel = 0\n            .ShrinkToFit = False\n            .ReadingOrder = xlContext\n            .MergeCells = False\n            End With\n    wspaste.Rows(\"1:5\").Delete Shift:=xlShiftUp\n    wspaste.Cells.Select\n    Selection.ColumnWidth = 8.29\n    wspaste.Range(\"C:C,E:F,H:H,J:M,O:R,T:T,V:W,Y:AA\").Select\n    wspaste.Range(\"Y1\").Activate\n    ActiveWindow.ScrollColumn = 2\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 4\n    ActiveWindow.ScrollColumn = 5\n    ActiveWindow.ScrollColumn = 6\n    ActiveWindow.ScrollColumn = 7\n    ActiveWindow.ScrollColumn = 8\n    ActiveWindow.ScrollColumn = 9\n    ActiveWindow.ScrollColumn = 10\n    ActiveWindow.ScrollColumn = 11\n    ActiveWindow.ScrollColumn = 12\n    ActiveWindow.ScrollColumn = 13\n    ActiveWindow.ScrollColumn = 14\n    ActiveWindow.ScrollColumn = 15\n    ActiveWindow.ScrollColumn = 16\n    ActiveWindow.ScrollColumn = 17\n    ActiveWindow.ScrollColumn = 18\n    ActiveWindow.ScrollColumn = 19\n    ActiveWindow.ScrollColumn = 20\n    wspaste.Range( _\n        \"C:C,E:F,H:H,J:M,O:R,T:T,V:W,Y:AA,AC:AD,AF:AH,AJ:AJ,AL:AM,AO:AO,AQ:AR,AT:AU\"). _\n        Select\n    wspaste.Range(\"AT1\").Activate\n    ActiveWindow.ScrollColumn = 21\n    ActiveWindow.ScrollColumn = 22\n    ActiveWindow.ScrollColumn = 23\n    wspaste.Range( _\n        \"C:C,E:F,H:H,J:M,O:R,T:T,V:W,Y:AA,AC:AD,AF:AH,AJ:AJ,AL:AM,AO:AO,AQ:AR,AT:AU,AW:AY\" _\n        ).Select\n   wspaste.Range(\"AW1\").Activate\n    Selection.Delete Shift:=xlToLeft\n    wspaste.Range(\"AG23\").Select\n    ActiveWindow.ScrollColumn = 22\n    ActiveWindow.ScrollColumn = 21\n    ActiveWindow.ScrollColumn = 20\n    ActiveWindow.ScrollColumn = 19\n    ActiveWindow.ScrollColumn = 18\n    ActiveWindow.ScrollColumn = 16\n    ActiveWindow.ScrollColumn = 14\n    ActiveWindow.ScrollColumn = 11\n    ActiveWindow.ScrollColumn = 9\n    ActiveWindow.ScrollColumn = 6\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 1\n    wspaste.Cells.Select\n    Selection.ColumnWidth = 9.71\n    Selection.ColumnWidth = 13.71\n    wspaste.Range(\"D14\").Select\n\nEnd Sub\n</code></pre>\n\n<p>is there advice, thanks in advance</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 2, "creation_date": 1576625467, "post_id": 59383538, "comment_id": 104958917, "body": "Which statement gives the error?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 1, "creation_date": 1576625554, "post_id": 59383538, "comment_id": 104958934, "body": "Please delete <code>On Error GoTo ErrorHandler</code> which will conceal which statement is causing the error."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1576626234, "creation_date": 1576626234, "answer_id": 59383676, "question_id": 59383538, "link": "https://stackoverflow.com/questions/59383538/error-438-when-saving-attachments-using-outlook-vba/59383676#59383676", "title": "Error 438 When Saving Attachments using Outlook VBA", "body": "<p><code>MailItem</code> does not expose a property named <code>Recipient</code> (singular). It exposes a property named <code>Recipients</code> (plural), but is is not a string property - it is a collection of <code>Recipient</code> objects, which expose <code>Name</code> and <code>Address</code> properties among others. </p>\n\n<p>Did you mean to use the <code>SenderName</code> property instead?</p>\n"}], "owner": {"reputation": 1, "user_id": 12555151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a266cdd6330e3847f608796019e7a36d?s=128&d=identicon&r=PG&f=1", "display_name": "253datacruncher", "link": "https://stackoverflow.com/users/12555151/253datacruncher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1583568820, "creation_date": 1576625283, "last_edit_date": 1583568820, "question_id": 59383538, "link": "https://stackoverflow.com/questions/59383538/error-438-when-saving-attachments-using-outlook-vba", "title": "Error 438 When Saving Attachments using Outlook VBA", "body": "<p>I pieced this together for saving all Excel attachments from incoming mail to a local drive folder.</p>\n\n<p>It is in the ThisOutlookSession module and I restarted Outlook.</p>\n\n<p>When I send a test email meeting the criteria in the If statements, I receive >\"Error 438: Object doesn't support this property or method\".</p>\n\n<p>I can't figure out which object doesn't support which property or method.</p>\n\n<p>It is at least running up to my If statements because this only happens to emails that meet the criteria.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nPrivate WithEvents inboxItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n    Dim outlookApp As Outlook.Application\n    Dim objectNS As Outlook.NameSpace\n    Set outlookApp = Outlook.Application\n    Set objectNS = outlookApp.GetNamespace(\"MAPI\")\n    Set inboxItems = objectNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub inboxItems_ItemAdd(ByVal Item As Object)\nOn Error GoTo ErrorHandler\nDim Msg As Outlook.MailItem\n\nDim i As Integer\nDim strFolder As String\nDim mySaveName As String\nDim myExt As String\nDim OlMail As Outlook.MailItem\n\nstrFolder = \"D:\\Scripts\\VendorProductivity\\Daily files\"\n\nIf TypeName(Item) = \"MailItem\" Then\n    If Item.Subject Like \"*Report*\" Then\n        If Item.Recipient = \"Jane Doe\" Then\n            If Item.Attachments.Count &gt; 0 Then\n\n                'loop through all attachments\n                For i = 1 To Item.Attachments.Count\n\n                   mySaveName = Item.Attachments.Item(i).FileName\n                   myExt = Split(mySaveName, \".\")(1)\n\n                   'Only save files with named extensions\n                   Select Case myExt\n                       Case \"xls\", \"xlsm\", \"xlsx\"\n                           mySaveName = strFolder &amp; \"\\\" &amp; mySaveName\n                           Item.Attachments.Item(i).SaveAsFile mySaveName\n\n                       Case Else\n                           'do nothing\n                   End Select\n                Next\n                Item.Delete\n            End If\n        End If\n    End If\nEnd If\n\nExitNewItem:\n    Exit Sub\n\nErrorHandler:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    Resume ExitNewItem\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping", "automation"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576626898, "post_id": 59383517, "comment_id": 104959244, "body": "You can try the <code>.fireevent(&#39;eventname&#39;)</code> so you could use <code>click</code> as your event name.  Also, looking at the source, ` &lt;form action=&quot;/frontend/login/&quot;` would also mean you could try <code>IE.document.form(0).submit</code> i believe"}, {"owner": {"reputation": 6456, "user_id": 11490347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lFlKK.jpg?s=128&g=1", "display_name": "Yu Zhou", "link": "https://stackoverflow.com/users/11490347/yu-zhou"}, "edited": false, "score": 0, "creation_date": 1576648505, "post_id": 59383517, "comment_id": 104963442, "body": "I agree with QHarr&#39;s answer. The error occurs on this line: <code>IE.document.getElementbyClass(&quot;button&quot;).click</code>. The right format should be <code>IE.document.getElementsbyClassName(&quot;button&quot;)(0).Click</code>."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1576650734, "last_edit_date": 1576650734, "creation_date": 1576633819, "answer_id": 59384428, "question_id": 59383517, "link": "https://stackoverflow.com/questions/59383517/vba-to-click-on-a-button-on-an-ie-form-to-submit-it/59384428#59384428", "title": "VBA to click on a button on an IE form to submit it", "body": "<p>Nothing else happens? You should be getting an error message at the very least as you are trying to use a non existent method (<em>VBA Run-time error 438 Object doesn't support this property or method</em>) . The method is <code>getElementsByClassName</code> - note the <code>s</code> indicating it returns a collection and the ending is <code>ClassName</code>. You would then need to index into that collection before attempting to access the <code>Click</code> method</p>\n\n<p>As there is only a single element with classname <code>button</code> you can use a faster <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">css class selector</a> (this is also faster than using a type selector of <code>form</code>; likewise, you can use the faster css equivalent of <code>getElementById</code> for the other two DOM elements). <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectoraLL\" rel=\"nofollow noreferrer\">document.querySelector</a> stops at the first match so is also more efficient.</p>\n\n<p>Finally, rather than hard coded waits use proper page load waits as shown below:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub WorldCheck()\n    Dim ie As Object\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n\n        .Visible = True\n        .Navigate2 \"https://www.world-check.com/frontend/login/\"\n\n        While .busy Or .readystate &lt;&gt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#username\").Value = \"ABCDEF\" ' equivalent to .getElementbyID(\"username\").Value = \"ABCDEF\"\n            .querySelector(\"#password\").Value = \"GHIJKL\" '.getElementbyID(\"password\").Value = \"GHIJKL\"\n            .querySelector(\".button\").Click\n        End With\n\n        While .busy Or .readystate &lt;&gt; 4: DoEvents: Wend\n\n            Stop                                     '&lt;== delete me later\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12446634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9113ae6a7d5f7398977075dfc5df1e?s=128&d=identicon&r=PG&f=1", "display_name": "CheMBurN", "link": "https://stackoverflow.com/users/12446634/chemburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 59384428, "answer_count": 1, "score": 0, "last_activity_date": 1576650734, "creation_date": 1576625189, "last_edit_date": 1576633937, "question_id": 59383517, "link": "https://stackoverflow.com/questions/59383517/vba-to-click-on-a-button-on-an-ie-form-to-submit-it", "title": "VBA to click on a button on an IE form to submit it", "body": "<p>I'm quite new to VBA so please bear with me. I've been trying to create an automation to fill in username and password and login to a site (to start with) but I've been having trouble trying to click on the submit button. Scoured the internet and learnt a whole bunch of things but I didnt find anything that seems to work. The page loads and fills in the details and nothing happens when I run the code below.</p>\n\n<p>Would greatly appreciate some help with this. Thanks in advance as always!</p>\n\n<pre><code>Sub worldcheck()\n\nDim lastrow As Long\nDim IE As Object\nDim cel As Range\nDim post As Object\nDim ws As Worksheet\nDim element As Object\n\nSet ws = Sheets(\"sheet1\")\nSet IE = CreateObject(\"internetexplorer.application\")\nlastrow = ws.Range(\"B\" &amp; ws.Rows.Count).End(xlUp).Row\n\nIE.Visible = True\nIE.Navigate \"https://www.world-check.com/frontend/login/\"\n\nDo While IE.busy\n    DoEvents\nLoop\n\nApplication.Wait (Now + TimeValue(\"0:00:2\"))\n\nIE.document.getElementbyID(\"username\").Value = ws.Range(\"D2\")\nIE.document.getElementbyID(\"password\").Value = ws.Range(\"D3\")\nIE.document.getElementbyClass(\"button\").click\n\nDo While IE.busy\n    DoEvents\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "foreach"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1576630544, "post_id": 59383360, "comment_id": 104959984, "body": "The combination that works is <code>ActiveSheet.Range(&quot;A2:A1000&quot;)</code> and <code>myLoc.Offset(0,1).Value</code> / <code>myLoc.Offset(0,2).Value</code>, but <code>myRange</code> must be <code>As Range</code> and you must <a href=\"https://stackoverflow.com/a/17877644/11683\">use <code>Set</code></a> to assign it."}, {"owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1576632140, "post_id": 59383360, "comment_id": 104960270, "body": "@gserg Amazing - I can&#39;t believe it was that simple. Thank you so much!"}], "owner": {"reputation": 93, "user_id": 10129598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eIVSw.png?s=128&g=1", "display_name": "AKow", "link": "https://stackoverflow.com/users/10129598/akow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576629756, "creation_date": 1576623965, "last_edit_date": 1576629756, "question_id": 59383360, "link": "https://stackoverflow.com/questions/59383360/vba-for-each-loop-with-multiple-variables", "title": "VBA For Each Loop with Multiple Variables", "body": "<p><a href=\"https://i.stack.imgur.com/mk6ag.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mk6ag.png\" alt=\"enter image description here\"></a></p>\n\n<p>I need to update (X,Y) coordinates in a program called BlueZone using VBA based on a 6 digit location ID. </p>\n\n<p>The three variables (1) location (2) X (3) Y are all on an spreadsheet.</p>\n\n<p>I want my code to loop through each location ID (column A) and get the corresponding X and Y coordinates (columns B, C respectively). IOW, my cell A2 = location ID, B2 = X coordinate, C3 = Y coordinate.</p>\n\n<pre><code>Sub FiXY()\n\n'bzhao is the object declaration to manipulate emulation software by BlueZone\n\nDim bzhao As Object\nSet bzhao = CreateObject(\"BZWhll.WhllObj\")\nbzhao.Connect \"\"\n\nDim myLoc As Variant\n\n\nmyRange = ActiveSheet.Range(\"A2:C1000\") 'have also tried \"A2:A1000\"\n\nFor Each myLoc In myRange\n\n'end loop at blank cell\n    If myLoc = \"\" Then\n        Exit For\n            End If\n\n'Query location\n\nbzhao.SendKey \"Q\"\nbzhao.Wait 0.2\nbzhao.SendKey myLoc 'passes just fine\nbzhao.Wait 0.2\nbzhao.SendKey \"&lt;enter&gt;\"\nbzhao.Wait 0.2\n\n'does not work\nbzhao.SendKey myLoc.Offset(0,1).Value\nbzhao.SendKey myLoc.Offset(0,2).Value\n\n'does not work\nbzhao.SendKey myRange.Offset(0,1).Value\nbzhao.SendKey myRange.Offset(0,2).Value\n\nNext myLoc\n\nEnd Sub\n</code></pre>\n\n<p>I understand that SendKey is not ideal, but this loop has worked flawlessly for me with a static X or Y that I can call from a cell on the sheet, so I believe it the structure of my code is the issue. </p>\n\n<p>How do I get the three variables into my loop?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 3885588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10255d21459ebdce8647b949b5bc15a0?s=128&d=identicon&r=PG&f=1", "display_name": "baka_toroi", "link": "https://stackoverflow.com/users/3885588/baka-toroi"}, "is_accepted": false, "score": 0, "last_activity_date": 1576702719, "creation_date": 1576702719, "answer_id": 59399891, "question_id": 59383199, "link": "https://stackoverflow.com/questions/59383199/copy-a-range-found-by-a-for-loop-and-paste-on-another-sheet/59399891#59399891", "title": "Copy a range found by a for loop and paste on another sheet", "body": "<p>It's a common mistake but you shouldn't use copy/paste or <code>activate</code> or <code>activesheet</code>. This has been discussed thousands of times. Check this great answer on how to avoid it: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>The main reason is you never now what \"ActiveSheet\" is. Imagine if for some reason the sheet couldn't be activated. You'd be destroying the rest of the workbook by pasting something where it shouldn't go. Always create workbook and worksheets objects and work with them.</p>\n\n<p>Anyway, try assigning one range to the other. Just make sure both have the same dimensions (length, width). So instead of copy and then paste just do something like</p>\n\n<pre><code>Dim heatMap as Worksheet\n\nSet heatMap = ThisWorkbook.Worksheets(\"Heat Map\")\nSet otherSheet = ThisWorkbook.Worksheets(\"Your other sheet\")\n\notherSheet.Range(otherSheet.Cells(2, i), otherSheet.Cells(19, i))  = heatMap.Range(heatMap.Cells(2, i), heatMap.Cells(19, i))\n</code></pre>\n\n<p>I didn't test this code so if it fails try going slower by first attempting to copy ranges of single cells (with hard-coded rows and columns) and then working your way up from there.</p>\n"}], "owner": {"reputation": 37, "user_id": 12031639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/769a41272e5f6ed7d192401308a11388?s=128&d=identicon&r=PG&f=1", "display_name": "Liworker", "link": "https://stackoverflow.com/users/12031639/liworker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576791033, "creation_date": 1576622814, "last_edit_date": 1576791033, "question_id": 59383199, "link": "https://stackoverflow.com/questions/59383199/copy-a-range-found-by-a-for-loop-and-paste-on-another-sheet", "title": "Copy a range found by a for loop and paste on another sheet", "body": "<p>I have a macro that takes an input and finds a sheet with a matching name. From there it loops through the first row (headers) to find the column that matches a second input.</p>\n\n<p>I want to copy that entire column and paste it onto a different sheet.</p>\n\n<p>When I run the code, it works until the copy/ paste where I get</p>\n\n<blockquote>\n  <p>\"Run-time error '1004' Application-defined or object-defined error</p>\n</blockquote>\n\n<p>noted with a comment.</p>\n\n<pre><code>SDay = Sheets(\"Heat Map\").Range(\"C1\").Value\nSTime = Sheets(\"Heat Map\").Range(\"C2\").Value\n\nWorksheets(SDay).Activate\n\nFor i = 2 To 17\n    If ActiveSheet.Cells(1, i).Value = Sheets(\"Heat Map\").Range(\"C2\").Value Then\n        ActiveSheet.Range(Cells(2, i), Cells(19, i)).Select ' Error is here\n        Selection.Copy\n    End If\nNext i\n\nSheets(\"Heat Map\").Range(\"C4\").Select\nSelection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:= _\n  xlNone, SkipBlanks:=False, Transpose:=False\n\nSheets(\"Heat Map\").Activate\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 96, "user_id": 3324451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c23af08758326da94cfc4468be55aae?s=128&d=identicon&r=PG&f=1", "display_name": "amadbear", "link": "https://stackoverflow.com/users/3324451/amadbear"}, "edited": false, "score": 6, "creation_date": 1576621640, "post_id": 59382947, "comment_id": 104957926, "body": "since you&#39;re defining the string in code, why don&#39;t you use another character/delimter instead of the comma? Perhaps a &quot;|&quot;? That way, you can leave the &quot;needed&quot; commas in place and split by the &quot;|&quot; character."}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 96, "user_id": 3324451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c23af08758326da94cfc4468be55aae?s=128&d=identicon&r=PG&f=1", "display_name": "amadbear", "link": "https://stackoverflow.com/users/3324451/amadbear"}, "edited": false, "score": 0, "creation_date": 1576676218, "post_id": 59382947, "comment_id": 104975875, "body": "@amadbear It&#39;s working now. Thank you for your help!"}, {"owner": {"reputation": 96, "user_id": 3324451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c23af08758326da94cfc4468be55aae?s=128&d=identicon&r=PG&f=1", "display_name": "amadbear", "link": "https://stackoverflow.com/users/3324451/amadbear"}, "edited": false, "score": 0, "creation_date": 1576702809, "post_id": 59382947, "comment_id": 104988902, "body": "Glad it&#39;s working. I figured I&#39;d move comment/answer as answer."}], "answers": [{"tags": [], "owner": {"reputation": 96, "user_id": 3324451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c23af08758326da94cfc4468be55aae?s=128&d=identicon&r=PG&f=1", "display_name": "amadbear", "link": "https://stackoverflow.com/users/3324451/amadbear"}, "is_accepted": true, "score": 0, "last_activity_date": 1576702759, "creation_date": 1576702759, "answer_id": 59399899, "question_id": 59382947, "link": "https://stackoverflow.com/questions/59382947/how-to-ignore-commas-in-a-string-content/59399899#59399899", "title": "How to ignore commas in a string content?", "body": "<p>since you're defining the string in code, why don't you use another character/delimter instead of the comma? Perhaps a \"|\"? That way, you can leave the \"needed\" commas in place and split by the \"|\" character.</p>\n"}], "owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59399899, "answer_count": 1, "score": -1, "last_activity_date": 1576702759, "creation_date": 1576621323, "last_edit_date": 1576621582, "question_id": 59382947, "link": "https://stackoverflow.com/questions/59382947/how-to-ignore-commas-in-a-string-content", "title": "How to ignore commas in a string content?", "body": "<p>How do I make the value with commas as one value? Everytime I run my code, it will not be read as one.</p>\n\n<p>For example the values: \"Dry, Damp, or Wet Location Listed - CAN\" and the value \"Dry, Damp, or Wet Location Listed - USA\"</p>\n\n<pre><code>Sub Dosomething()\n  Dim xSh As Worksheet\n  Application.ScreenUpdating = False\n  For Each xSh In Worksheets\n      xSh.Select\n      Call DeleteColumns\n  Next\n  Application.ScreenUpdating = True\nEnd Sub\nSub DeleteColumns()\n  Dim ColumnsToDelete As String, V As Variant\n  ColumnsToDelete = \"cUPC Certified, Dark Sky Compliant, DECT 6.0 Compliant, DIN EN 12935 Certified, Dry, Damp, or Wet Location Listed - CAN, Dry, Damp, or Wet Location Listed - USA, EEP Compliant, EIA Compliant, EISA 2007 Compliant, EISA Compliant\"\n  On Error Resume Next\n  For Each V In Split(ColumnsToDelete, \",\")\n    Rows(1).Find(Trim(V), , , xlWhole, , , False).EntireColumn.Delete\n  Next\n  On Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 12555009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bd7293fdcbae4ac3bb336992ac51a6?s=128&d=identicon&r=PG&f=1", "display_name": "TFlemingX", "link": "https://stackoverflow.com/users/12555009/tflemingx"}, "edited": false, "score": 0, "creation_date": 1577115805, "post_id": 59382911, "comment_id": 105096999, "body": "I&#39;ve seen examples of people saying to load all the files into an array. But when trying to use the code examples it hasn&#39;t been successful on my end. Any help is appreciated."}, {"owner": {"reputation": 1, "user_id": 12555009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bd7293fdcbae4ac3bb336992ac51a6?s=128&d=identicon&r=PG&f=1", "display_name": "TFlemingX", "link": "https://stackoverflow.com/users/12555009/tflemingx"}, "edited": false, "score": 0, "creation_date": 1579740415, "post_id": 59382911, "comment_id": 105871353, "body": "I ended up going a different route. Decided to just open/close the main two files at the time my code exports the data. That way multi-users could use it at the same time but not cause a conflict. Seems to work like a charm"}], "owner": {"reputation": 1, "user_id": 12555009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bd7293fdcbae4ac3bb336992ac51a6?s=128&d=identicon&r=PG&f=1", "display_name": "TFlemingX", "link": "https://stackoverflow.com/users/12555009/tflemingx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576771553, "creation_date": 1576621079, "last_edit_date": 1576771553, "question_id": 59382911, "link": "https://stackoverflow.com/questions/59382911/merging-all-workbooks-in-folder-and-moving-to-sub-folder", "title": "Merging all workbooks in folder and moving to sub folder", "body": "<p>I've read multiple Subs on here but for some reason I can't get my code nailed down.\nI've got 3 folders with multiple workbooks in them.\nI need to open my default template workbook, and then copy the data from sheet one of each workbook in the current folder to sheet one of the template, then move those files to a sub-folder called \"archive\"\nAfter that I need to create one master workbook combining the data of those 3 sub-workbooks.</p>\n\n<p>I'm using Excel 2016. I'm using an array to specify the three main folders. Example</p>\n\n<p><code>MyTeam(1) = Alpha</code></p>\n\n<p><code>MyTeam(2) = Beta</code></p>\n\n<p>So the path would be something like <code>C:\\MyFolder\\\" &amp; MyTeam(i) &amp; \"\\*.xlxs</code></p>\n\n<p>I'd post my code but really it is totally borked.\nI'm Using a Userform/CommandButton to execute the code. Thanks in advance for any help.</p>\n"}, {"tags": ["arrays", "excel", "vba", "macos", "reference"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576621942, "post_id": 59382198, "comment_id": 104957994, "body": "Have you tried instead setting <code>cell.Formula = cell.Formula</code> or calling <code>cell.Calculate</code> ?"}, {"owner": {"reputation": 1, "user_id": 8554011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159352388430370/picture?type=large", "display_name": "Aaron Bell", "link": "https://stackoverflow.com/users/8554011/aaron-bell"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576625380, "post_id": 59382198, "comment_id": 104958890, "body": "not sure what this means, can you elaborate?"}], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 8554011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159352388430370/picture?type=large", "display_name": "Aaron Bell", "link": "https://stackoverflow.com/users/8554011/aaron-bell"}, "edited": false, "score": 0, "creation_date": 1576632284, "post_id": 59383672, "comment_id": 104960292, "body": "Doesn&#39;t do anything when you run it?"}, {"owner": {"reputation": 1, "user_id": 8554011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159352388430370/picture?type=large", "display_name": "Aaron Bell", "link": "https://stackoverflow.com/users/8554011/aaron-bell"}, "edited": false, "score": 0, "creation_date": 1576638176, "post_id": 59383672, "comment_id": 104961339, "body": "it clicks over each cell but does not update the values. The cells are currently worded as ex: &quot;=D1+D2&quot;. The only way for the cell to calculate is by clicking into the cell and press enter. this is an .xlsm workbook"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 1, "user_id": 8554011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159352388430370/picture?type=large", "display_name": "Aaron Bell", "link": "https://stackoverflow.com/users/8554011/aaron-bell"}, "edited": false, "score": 0, "creation_date": 1576641820, "post_id": 59383672, "comment_id": 104962003, "body": "OK that&#39;s weird - calling Calculate on a range should cause it to update"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1576650253, "last_edit_date": 1576650253, "creation_date": 1576626218, "answer_id": 59383672, "question_id": 59382198, "link": "https://stackoverflow.com/questions/59382198/send-keys-to-update-cells-referenced-in-array/59383672#59383672", "title": "Send Keys to update cells referenced in Array", "body": "<p>You could try this:</p>\n\n<pre><code>Private Sub All_Cells_Click()\n    Dim cell As Variant\n    For Each cell In ActiveSheet.Range(\"D3,D4,G5,Y6\").Cells\n        With cell\n            .Formula = .Formula\n            .Calculate\n        End With\n    Next cell\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8554011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159352388430370/picture?type=large", "display_name": "Aaron Bell", "link": "https://stackoverflow.com/users/8554011/aaron-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1576689460, "last_edit_date": 1576689460, "creation_date": 1576686899, "answer_id": 59396434, "question_id": 59382198, "link": "https://stackoverflow.com/questions/59382198/send-keys-to-update-cells-referenced-in-array/59396434#59396434", "title": "Send Keys to update cells referenced in Array", "body": "<p>This first section worked below, however I am trying to have multiple cells in different rows/columns be in the array. The second part will only run in the column that is referenced as the first value in the array. (If column A, it will only go down column A until I=4, not moving to different columns and rows).</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim cellUpdates(0 To 4) As Variant\nDim i As Integer\n\ncellUpdates(0) = \"$D$2\"\ncellUpdates(1) = \"$D$3\"\ncellUpdates(2) = \"$D$4\"\ncellUpdates(3) = \"$D$5\"\ncellUpdates(4) = \"$D$6\"\n\nFor i = 0 To UBound(cellUpdates)\n\nRange(cellUpdates(cell)).Select\nApplication.SendKeys \"{F2}\"\nApplication.SendKeys \"{ENTER}\"\nNext i\nEnd Sub\n</code></pre>\n\n<p>Not working part:</p>\n\n<pre><code>Private Sub All_Cells_Click()\nDim cellUpdates(0 To 4) As Variant\nDim i As Integer\n\ncellUpdates(0) = \"$A$2\"\ncellUpdates(1) = \"$B$3\"\ncellUpdates(2) = \"$C$4\"\ncellUpdates(3) = \"$D$5\"\ncellUpdates(4) = \"$E$6\"\n\nFor i = 0 To UBound(cellUpdates)\n\nRange(cellUpdates(cell)).Select\nApplication.SendKeys \"{F2}\"\nApplication.SendKeys \"{ENTER}\"\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8554011, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159352388430370/picture?type=large", "display_name": "Aaron Bell", "link": "https://stackoverflow.com/users/8554011/aaron-bell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1581926476, "creation_date": 1576617414, "last_edit_date": 1581926476, "question_id": 59382198, "link": "https://stackoverflow.com/questions/59382198/send-keys-to-update-cells-referenced-in-array", "title": "Send Keys to update cells referenced in Array", "body": "<p>I have a hard coded formula in some cells that are only updated upon pressing enter in the cells.</p>\n\n<p>I would like this macro to \"click into the cell and press enter\" to update the value and cause the formula to return a value.</p>\n\n<p>I have two macros, one that updates one specific cell, and another that I want to update an array of cell references. For some reason, only the one cell macro works. Does anyone know why? I would like this to be potentially used across multiple sheets and multiple rows/columns</p>\n\n<p>One Cell:</p>\n\n<pre><code>Private Sub One_Cell_Click()\n\nRange(\"$D$3\").Select\nApplication.SendKeys \"{F2}\"\nApplication.SendKeys \"{ENTER}\"\n\nEnd Sub\n</code></pre>\n\n<p>Multiple Cells</p>\n\n<pre><code>Private Sub All_Cells_Click()\nDim cellUpdates(0 To 3) As Variant\nDim cell As Variant\n\ncellUpdates(0) = \"$D$3\"\ncellUpdates(1) = \"$D$4\"\ncellUpdates(2) = \"$G$5\"\ncellUpdates(3) = \"$Y$6\"\n\nFor Each cell In cellUpdates\n\nRange(cellUpdates(cell)).Select\nApplication.SendKeys \"{F2}\"\nApplication.SendKeys \"{ENTER}\"\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576615142, "post_id": 59381622, "comment_id": 104955436, "body": "Why not just pass a <code>Worksheet</code> variable? You can pass <code>ActiveSheet</code> directly if you want."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 2368475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddbb2236568ed5c704292d368822d31?s=128&d=identicon&r=PG", "display_name": "ackshooairy", "link": "https://stackoverflow.com/users/2368475/ackshooairy"}, "edited": false, "score": 1, "creation_date": 1576616366, "post_id": 59381804, "comment_id": 104955933, "body": "This works exactly as I needed. Didn&#39;t cross my mind to not add a property to ActiveSheet..."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1576616248, "last_edit_date": 1576616248, "creation_date": 1576615412, "answer_id": 59381804, "question_id": 59381622, "link": "https://stackoverflow.com/questions/59381622/get-codename-from-property-and-pass-as-a-variable/59381804#59381804", "title": "Get Codename from property and pass as a variable", "body": "<p>The simpler solution is just to pass a <code>Worksheet</code> object:</p>\n\n<pre><code>Sub do_things(ByVal ws As Worksheet)\n      ws.Cells(1,1).Value = \"Hello\"\nEnd Sub\n</code></pre>\n\n<p>You can just pass the <code>ActiveSheet</code> directly if needed. Trying to use the <code>.CodeName</code> is unnecessary.</p>\n"}, {"comments": [{"owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576616121, "post_id": 59381822, "comment_id": 104955833, "body": "I agree with you that I would pass the worksheet (as stated in my first sentence). I was letting the OP know why it wasn&#39;t working also."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576618049, "post_id": 59381822, "comment_id": 104956611, "body": "Not my downvote, but I&#39;m guessing it&#39;s because a sheet code name is not always the same as the regular sheet name."}], "tags": [], "owner": {"reputation": 2238, "user_id": 2780300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf0f8fbffb43125296bc27d421fe383c?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2780300/kevin"}, "is_accepted": false, "score": -1, "last_activity_date": 1576615505, "creation_date": 1576615505, "answer_id": 59381822, "question_id": 59381622, "link": "https://stackoverflow.com/questions/59381622/get-codename-from-property-and-pass-as-a-variable/59381822#59381822", "title": "Get Codename from property and pass as a variable", "body": "<p>You could just pass the ActiveSheet, but if you can't do that for some reason you can change your sub:</p>\n\n<pre><code>Sub do_things(sheetCodeName as Variant)\n      Worksheets(sheetCodeName).Cells(1,1) = \"Hello\"\nEnd Sub\n</code></pre>\n\n<p>It doesn't work now because the string is not an object.</p>\n"}], "owner": {"reputation": 121, "user_id": 2368475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bddbb2236568ed5c704292d368822d31?s=128&d=identicon&r=PG", "display_name": "ackshooairy", "link": "https://stackoverflow.com/users/2368475/ackshooairy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59381804, "answer_count": 2, "score": 0, "last_activity_date": 1576616248, "creation_date": 1576614376, "last_edit_date": 1576615308, "question_id": 59381622, "link": "https://stackoverflow.com/questions/59381622/get-codename-from-property-and-pass-as-a-variable", "title": "Get Codename from property and pass as a variable", "body": "<p>I have a function that takes a sheetname as a parameter like</p>\n\n<pre><code>Sub do_things(sheetCodeName as Variant)\n      sheetCodeName.Cells(1,1) = \"Hello\"\nEnd Sub\n</code></pre>\n\n<p>I want to be able to get the codename of a given sheet using something like ActiveSheet.Codename and pass that as the codename parameter to my do_things subroutine. However, I get </p>\n\n<blockquote>\n  <p>Run-Time error '424' Object Required.</p>\n</blockquote>\n\n<p>This seems to be because ActiveSheet.Codename is a string while actually typing the codename in the subroutine call passes it as a worksheet.</p>\n\n<p>Is there a way for me to gather the codename of a sheet and pass it to my do_things sub without having to manually type it?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1576616235, "creation_date": 1576616235, "answer_id": 59381965, "question_id": 59381557, "link": "https://stackoverflow.com/questions/59381557/renaming-new-sheets/59381965#59381965", "title": "Renaming new sheets", "body": "<p>It would be easier to use a single loop:</p>\n\n<pre><code>Sub getdata()\n\n    Dim no_sheets As Long, sheet_index As Long\n\n    no_sheets = Sheets(\"Input\").Range(\"N2\").Value\n\n    For sheet_index = 1 To no_sheets\n        ThisWorkbook.Sheets(\"Template\").Copy _\n        After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n\n        'rename/populate the sheet you just created\n        With ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\n\n              .Name = Sheets(\"Input\").Range(\"B\" &amp; (sheet_index + 1)).Value\n\n              'etc etc\n\n        End With\n\n    Next sheet_index\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12554407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd488f9250881e1890276854e3f1df11?s=128&d=identicon&r=PG&f=1", "display_name": "JoDi2016", "link": "https://stackoverflow.com/users/12554407/jodi2016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1579816234, "creation_date": 1576614077, "last_edit_date": 1579816234, "question_id": 59381557, "link": "https://stackoverflow.com/questions/59381557/renaming-new-sheets", "title": "Renaming new sheets", "body": "<p>I'm trying to generate letters by automatically adding the letterhead information to a letter template.</p>\n\n<p>I managed to get the VBA working for copying a template for each record in input sheet and populating each newly generated mail with data from input sheet.</p>\n\n<p>I'm struggling with the task to rename the newly added sheets. New name should equal last name from input sheet.</p>\n\n<p>Similar threads regarding renaming sheets didn't point me into the right direction.</p>\n\n<pre><code>Sub getdata()\n\n' 1. Copy template for each record in input sheet\n\nDim no_sheets As Integer\n\nno_sheets = Sheets(\"Input\").Range(\"N2\").Value\n\nFor sheet_index = 1 To no_sheets\n    ThisWorkbook.Sheets(\"Template\").Copy _\n    After:=ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count)\nNext sheet_index\n\n' 2.  Rename copies of template\n\nDim sheet_name As String\nsheet_name = Sheets(\"Input\").Range(\"B\" &amp; (sheet_index + 1)).Value\n\n' 3. Populate each sheet with the data from the Input sheet\n\nFor sheet_index = 2 To no_sheets + 1\n\n    ' Letter head row 1\n    Sheets(\"Template (\" &amp; sheet_index &amp; \")\").Range(\"B8\") = Sheets(\"Input\").Range(\"H\" &amp; sheet_index)\n\n    ' ...\n\nNext sheet_index\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1576612392, "post_id": 59381143, "comment_id": 104954358, "body": "Just checking, but by <code>confirmed the read&#47;write settings</code> did you create a new txt file in the folder manually or just looked at the permissions?"}, {"owner": {"reputation": 1, "user_id": 12554397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fGe1uxXu9uY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRGx4ACAeF1vJTOISSXZbLZoV8HQ/photo.jpg?sz=128", "display_name": "Cindy Fallon", "link": "https://stackoverflow.com/users/12554397/cindy-fallon"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1576612559, "post_id": 59381143, "comment_id": 104954426, "body": "permissions, but the open statement actually created the file."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 2, "creation_date": 1576613077, "post_id": 59381143, "comment_id": 104954641, "body": "All documentation that I can find utilizes <code>#(number)</code> schemes for <code>OPEN</code> statements.  Update your <code>As logFile</code> to <code>As #1</code> and see if the error persists.  May need to update any references to <code>logFile</code> to #1."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 4, "creation_date": 1576613396, "post_id": 59381143, "comment_id": 104954758, "body": "@Mike don&#39;t hard-code file handles, but make sure it says <code>logFile = FreeFile</code> somewhere. Actually IIRC the <code>#</code> needs to remain in place - try <code>As #logFile</code>"}, {"owner": {"reputation": 1, "user_id": 12554397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fGe1uxXu9uY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRGx4ACAeF1vJTOISSXZbLZoV8HQ/photo.jpg?sz=128", "display_name": "Cindy Fallon", "link": "https://stackoverflow.com/users/12554397/cindy-fallon"}, "edited": false, "score": 0, "creation_date": 1576676871, "post_id": 59381143, "comment_id": 104976234, "body": "Ok.  I got the open file to work, but still have the openrecordset problem."}], "owner": {"reputation": 1, "user_id": 12554397, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fGe1uxXu9uY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRGx4ACAeF1vJTOISSXZbLZoV8HQ/photo.jpg?sz=128", "display_name": "Cindy Fallon", "link": "https://stackoverflow.com/users/12554397/cindy-fallon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576616070, "creation_date": 1576612100, "last_edit_date": 1576616070, "question_id": 59381143, "link": "https://stackoverflow.com/questions/59381143/errors-trying-to-execute-db-openrecordset-in-access", "title": "Errors trying to execute db.openrecordset in access", "body": "<p>I'm trying to run an Access program created in MS 2010 using MS 2016, both 32 bit.  I get errors when trying to execute the following lines.</p>\n\n<pre><code>Open CurrentProject.Path &amp; \"\\RGS_Isolation_Import.log\" For Output As logFile\n</code></pre>\n\n<blockquote>\n  <p>error 52 Bad filename</p>\n</blockquote>\n\n<p>the open statement does create the empty file</p>\n\n<pre><code>  Set rst = db.OpenRecordset(\"SELECT * FROM IOP_FSP_RGS_Refresh_Add_New_Cnt_qry \" &amp; _\n     \"ORDER BY [SW NAME (Fault_Id_T)]\", dbOpenDynaset)\n</code></pre>\n\n<blockquote>\n  <p>error 3436 Failure creating file</p>\n</blockquote>\n\n<p>I have confirmed the read/write settings on the PC (Windows 7), and that the db is set correctly.   This program hasn't been executed in about 6 years, but worked fine then.  </p>\n"}, {"tags": ["excel", "vba", "active-directory", "ado", "adodb"], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 6591146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1j9Ia.jpg?s=128&g=1", "display_name": "Wrotcod", "link": "https://stackoverflow.com/users/6591146/wrotcod"}, "edited": false, "score": 0, "creation_date": 1576619583, "post_id": 59381313, "comment_id": 104957201, "body": "Thanks but my question is also technical. How can I put the value of the AccountExpires date from my RecordSet to a cell? (Could you put a code snippet please?) Then, I know how to apply a formula :-)"}, {"owner": {"reputation": 50, "user_id": 6591146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1j9Ia.jpg?s=128&g=1", "display_name": "Wrotcod", "link": "https://stackoverflow.com/users/6591146/wrotcod"}, "edited": false, "score": 0, "creation_date": 1576788795, "post_id": 59381313, "comment_id": 105020853, "body": "Thanks, it works! Just a point: you forgot <code>adoRecordset.MoveNext</code> in the Do Until loop."}], "tags": [], "owner": {"reputation": 2503, "user_id": 158069, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9a038910634811c719f40ce89ae30c0b?s=128&d=identicon&r=PG", "display_name": "thepip3r", "link": "https://stackoverflow.com/users/158069/thepip3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1576699345, "last_edit_date": 1576699345, "creation_date": 1576612826, "answer_id": 59381313, "question_id": 59381108, "link": "https://stackoverflow.com/questions/59381108/how-to-manage-in-vba-date-objects-retrieved-from-adsdsoobject-provider/59381313#59381313", "title": "How to manage in VBA Date objects retrieved from ADsDSOObject provider?", "body": "<p>The datatype for accountexpires is a common one for ActiveDirectory:  Integer8 date represented by a 64-bit integer.  It stores a value that represents the 100s of nanoseconds that have occurred since Jan 1, 1601.  Why?  Great question that I don't know the answer to.  However, this standard is commonly referred to in Windows as FILETIME.  As such, in non-archaic languages (not VBS/VBA), there are very easy ways to handle this:</p>\n\n<p>PowerShell:</p>\n\n<pre><code>[datetime]::FromFileTimeUtc($Int64FromAD)\n</code></pre>\n\n<p>For VBA/VBS, it's more difficult.  Luckily for you, this was solved long ago:  <a href=\"https://social.technet.microsoft.com/wiki/contents/articles/12814.active-directory-lastlogontimestamp-conversion.aspx\" rel=\"nofollow noreferrer\">https://social.technet.microsoft.com/wiki/contents/articles/12814.active-directory-lastlogontimestamp-conversion.aspx</a>:</p>\n\n<ul>\n<li>Excel Forumla conversion:  <code>=IF(C2&gt;0,C2/(8.64*10^11) - 109205,\"\")</code></li>\n<li>Command-Line translation:  <code>w32tm.exe /ntte 128271382742968750</code></li>\n</ul>\n\n<p>...that is, IF you can't use PowerShell.  ;)</p>\n\n<p>Edit:</p>\n\n<p>My apologies for not completely reading what you requested.  This is Richard Mueller's code (he is one of the most prominent VBS scripters I followed years ago)(<a href=\"https://social.technet.microsoft.com/Forums/en-US/216fe6ec-84de-4516-9110-12cc0a7ea9b0/is-there-a-way-to-add-the-last-login-timedate-in-ad-to-an-excel-column?forum=ITCG\" rel=\"nofollow noreferrer\">https://social.technet.microsoft.com/Forums/en-US/216fe6ec-84de-4516-9110-12cc0a7ea9b0/is-there-a-way-to-add-the-last-login-timedate-in-ad-to-an-excel-column?forum=ITCG</a>):</p>\n\n<pre><code>' Obtain local Time Zone bias from machine registry.\n' This bias changes with Daylight Savings Time.\nSet objShell = CreateObject(\"Wscript.Shell\")\nlngBiasKey = objShell.RegRead(\"HKLM\\System\\CurrentControlSet\\Control\\\" _\n    &amp; \"TimeZoneInformation\\ActiveTimeBias\")\nIf (UCase(TypeName(lngBiasKey)) = \"LONG\") Then\n    lngBias = lngBiasKey\nElseIf (UCase(TypeName(lngBiasKey)) = \"VARIANT()\") Then\n    lngBias = 0\n    For k = 0 To UBound(lngBiasKey)\n        lngBias = lngBias + (lngBiasKey(k) * 256^k)\n    Next\nEnd If\n\n\n\nThen I add the following function at the end of the script:\n\nFunction Integer8Date(ByVal objDate, ByVal lngBias)\n    ' Function to convert Integer8 (64-bit) value to a date, adjusted for\n    ' local time zone bias.\n    Dim lngAdjust, lngDate, lngHigh, lngLow\n    lngAdjust = lngBias\n    lngHigh = objDate.HighPart\n    lngLow = objdate.LowPart\n    ' Account for error in IADsLargeInteger property methods.\n    If (lngLow &lt; 0) Then\n        lngHigh = lngHigh + 1\n    End If\n    If (lngHigh = 0) And (lngLow = 0) Then\n        lngAdjust = 0\n    End If\n    lngDate = #1/1/1601# + (((lngHigh * (2 ^ 32)) _\n        + lngLow) / 600000000 - lngAdjust) / 1440\n    ' Trap error if lngDate is ridiculously huge.\n    On Error Resume Next\n    Integer8Date = CDate(lngDate)\n    If (Err.Number &lt;&gt; 0) Then\n        On Error GoTo 0\n        Integer8Date = #1/1/1601#\n    End If\n    On Error GoTo 0\nEnd Function\n\n\nDo Until adoRecordset.EOF\n    ' Retrieve values and display.\n    strName = adoRecordset.Fields(\"sAMAccountName\").Value\n    objSheet.Cells(intRow, 1).Value = strName\n    strDN = adoRecordset.Fields(\"distinguishedName\").value\n    strDN = Replace(strDN, \"/\", \"\\/\")\n    objSheet.Cells(intRow, 2).Value = Mid(Split(strDN,\",\")(0),4)\n    ' Retrieve lastLogonTimeStamp using Set statement.\n    Set objDate = adoRecordset.Fields(\"lastLogonTimeStamp\").Value\n    ' Convert Integer8 value to date in local time zone.\n    dtmLastLogon = Integer8Date(objDate, lngBias)\n    objSheet.Cells(intRow, 3).Value = dtmLastLogon\n    ' .... other statements. Be sure to adjust the column numbers,\n    ' as I have inserted a column and those to the right of this one\n    ' must be incremented accordingly.\nLoop\n</code></pre>\n\n<p>He is showing this for lastlogontimestamp but again, the underlying datatype is the same (Integer8/64-bit Int) so just make the changes targeting the attribute name where necessary and update the objSheet.Cells() method to the row,column you want to write it to.</p>\n\n<p>If you must use VBA/VBS for some reason, by all means but to show you how insanely easy this is with PowerShell versus what you're trying to do:</p>\n\n<ol>\n<li>With Remote Server Administration Tools, Active Directory PowerShell tools:</li>\n</ol>\n\n<pre><code>    Get-ADUser -Filter * -Properties samaccountname,accountexpires,mail,distinguishedname | Export-Csv -NoTypeInformation AD_Export.csv\n</code></pre>\n\n<ol start=\"2\">\n<li>Without RSAT:</li>\n</ol>\n\n<pre><code>    $s = [adsisearcher]'(&amp;(objectClass=user)(objectCategory=person))'\n    $s.PropertiesToLoad.AddRange(@('samaccountname','accountexpires','mail','distinguishedname'))\n    $r = $s.FindAll() | foreach-object {\n       [pscustomobject]@{\n          'samaccountname' = $_.Properties['samaccountname']\n          'mail'           = $_.Properties['mail']\n          'accountexpires' = [datetime]::FromFileTimeUtc($_.Properties['accountexpires'])\n          'dn'             = $_.Properties['distinguishedname']\n       }\n    }\n\n    $r | Export-Csv -NoTypeinformation Ad_Export.csv\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 6591146, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1j9Ia.jpg?s=128&g=1", "display_name": "Wrotcod", "link": "https://stackoverflow.com/users/6591146/wrotcod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "accepted_answer_id": 59381313, "answer_count": 1, "score": 2, "last_activity_date": 1576699345, "creation_date": 1576611948, "question_id": 59381108, "link": "https://stackoverflow.com/questions/59381108/how-to-manage-in-vba-date-objects-retrieved-from-adsdsoobject-provider", "title": "How to manage in VBA Date objects retrieved from ADsDSOObject provider?", "body": "<p>I am retrieving a list of users with some of their attributes from an Active Directory using a VBA code snippet (see below). </p>\n\n<p>This works fine for string data, however, I need to retrieve the accountExpires attribute, which has another format [1]. When I try to get it, it is recognized as a raw <em>Object</em>, and thus it makes my <em>CopyFromRecordset</em> [2] method call fail. I also tried to use the <em>Recordset.GetRows</em> method, but to no avail.</p>\n\n<p>What I want to do is to write in a readable / usable format the accountExpires value of each user account in a cell of my Excel worksheet. How can I do that?</p>\n\n<pre><code>Set objRootDSE = GetObject(\"LDAP://RootDSE\")\n\nstrRoot = objRootDSE.GET(\"DefaultNamingContext\")\nstrFilter = \"(&amp;(objectCategory=Person)(objectClass=User))\"\nstrAttributes = \"mail,distinguishedName,accountExpires\"\nstrScope = \"subtree\"\n\nSet cn = CreateObject(\"ADODB.Connection\")\ncn.Provider = \"ADsDSOObject\"\ncn.Open \"Active Directory Provider\"\n\nSet cmd = CreateObject(\"ADODB.Command\")\ncmd.ActiveConnection = cn\ncmd.Properties(\"Page Size\") = 1000\n\ncmd.CommandText = \"&lt;LDAP://\" &amp; strRoot &amp; \"&gt;;\" &amp; strFilter &amp; \";\" &amp; _\n                                   strAttributes &amp; \";\" &amp; strScope\nSet rs = cmd.Execute\n\nSet objSheet = Sheets(\"AD Accounts\")\nobjSheet.Cells.Clear\n\nFor i = 0 To rs.Fields.Count - 1\n       objSheet.Cells(1, i + 1).Value = rs.Fields(i).Name\n       objSheet.Cells(1, i + 1).Font.Bold = True\nNext i\nobjSheet.Range(\"A2\").CopyFromRecordset rs\n\nrs.Close\ncn.Close\nSet objSheet = Nothing\n</code></pre>\n\n<p>Thanks a lot for your help!</p>\n\n<p>[1] <a href=\"https://docs.microsoft.com/en-us/windows/win32/adschema/a-accountexpires\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/windows/win32/adschema/a-accountexpires</a> </p>\n\n<p>[2] <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.copyfromrecordset\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.range.copyfromrecordset</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1576613109, "post_id": 59381042, "comment_id": 104954653, "body": "Have you ever used Power Query out of excel?  It would be a snap to do this there."}, {"owner": {"reputation": 47, "user_id": 6799132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c35d3f0655307a1b19871d3555801cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Ildon", "link": "https://stackoverflow.com/users/6799132/ildon"}, "reply_to_user": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1576652615, "post_id": 59381042, "comment_id": 104964697, "body": "Hey Ryan B. Thanks for the answer. Yeah I know about power query but I wanted to do it using macros :/"}], "owner": {"reputation": 47, "user_id": 6799132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c35d3f0655307a1b19871d3555801cdf?s=128&d=identicon&r=PG&f=1", "display_name": "Ildon", "link": "https://stackoverflow.com/users/6799132/ildon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1580452213, "creation_date": 1576611632, "last_edit_date": 1580452213, "question_id": 59381042, "link": "https://stackoverflow.com/questions/59381042/combine-multiple-tables-in-master-table-with-attributes-functions", "title": "Combine Multiple Tables in Master Table with Attributes (Functions)", "body": "<p>I am trying to combine multiple tables using objects and macros.</p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/47277206/combine-multiple-tables-rows-into-master-table\">Combine Multiple Tables Rows Into Master Table</a><br>\nHere a code snippet is proposed that works.</p>\n\n<p>My problem is that I have hyperlinks in the cells (functions). When I combine the tables using the macro, the hyperlinks are not transferred.</p>\n\n<p>How could I modify the code to also transfer the hyperlinks?</p>\n\n<p>I thought about something like:                   </p>\n\n<pre><code>Intersect(loDest.ListColumns(lc.Name).Range.EntireColumn, rDest).Hyperlinks = loDest.ListColumns(lc.Name).Range.EntireColumn.Hyperlinks(1).Address\n</code></pre>\n\n<p>Here is the code from jeffreyweir: </p>\n\n<pre><code>Sub CombineTables(loDest As ListObject, Optional lcSource As ListColumn)\n\nDim ws              As Worksheet\nDim lo              As ListObject\nDim lc              As ListColumn\nDim rDest           As Range\nDim lDestRows       As Long\nDim lSourceRows     As Long\n\nApplication.ScreenUpdating = False\n\nIf lcSource Is Nothing Then Set lcSource = loDest.ListColumns(1)\nIf loDest.ListRows.Count &gt; 0 Then loDest.DataBodyRange.Delete\n\nFor Each ws In ActiveWorkbook.Worksheets\n    For Each lo In ws.ListObjects\n        If lo &lt;&gt; loDest Then\n            With lo\n                If InStr(.Name, loDest.Name &amp; \"_\") &gt; 0 Then\n                    On Error Resume Next\n                    lDestRows = loDest.ListRows.Count\n                    On Error GoTo 0\n                    lSourceRows = .ListRows.Count\n                    If lSourceRows &gt; 0 Then\n\n                        'Work out where we want to paste the data to\n                        Set rDest = loDest.HeaderRowRange.Offset(1 + lDestRows).Resize(lSourceRows)\n\n                        'Resize the destination table\n                        loDest.Resize loDest.Range.Resize(1 + lSourceRows + lDestRows)       \n\n                        For Each lc In .ListColumns\n                         Intersect(loDest.ListColumns(lc.Name).Range.EntireColumn, rDest).Value2 = lc.DataBodyRange.Value\n                        Next lc\n                        Set lc = Nothing\n                        On Error Resume Next\n                        Set lc = .ListColumns(lcSource.Name)\n                        On Error GoTo 0\n                        If lc Is Nothing Then Intersect(lcSource.Range, rDest.EntireRow).Value2 = ws.Name\n                    End If\n                End If\n            End With\n        End If\n    Next lo\nNext ws\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>caller: </p>\n\n<pre><code>Sub CombineTables_Caller()\nCombineTables [SomeName].ListObject, [SomeName].ListObject.ListColumns(\"Source\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576615261, "post_id": 59380868, "comment_id": 104955494, "body": "Edit question to show sample data and desired result - as text tables, not image."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1576617601, "post_id": 59380868, "comment_id": 104956413, "body": "Aggregate functions First and Last are unreliable without defining sort order. Review <a href=\"https://support.office.com/en-us/article/First-Last-Functions-ACD76019-C37F-432D-9807-4FC63CAC1DB5\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576620214, "post_id": 59380868, "comment_id": 104957451, "body": "Date and Name are reserved words and really should not use reserved words as names for anything."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1576621607, "post_id": 59382967, "comment_id": 104957917, "body": "Thank you very much for getting back to me, I won&#39;t have a chance to try this out until tomorrow but I will let you know how it goes!"}, {"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1576695767, "post_id": 59382967, "comment_id": 104986180, "body": "The append query says &quot;The select statement includes a reserved word or an argument name that is misspelled or missing or the punctuation is incorrect&quot;, and the update query says &quot;Syntax error (missing operator) in query expression&quot;, any ideas?  Thank you again."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1576702844, "post_id": 59382967, "comment_id": 104988915, "body": "I edited the syntax issue and having tested now in Access, I reversed previous logic for <code>DMax</code> and flipped inequality sign without equals and added <code>NZ</code>."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 0, "last_activity_date": 1576702769, "last_edit_date": 1576702769, "creation_date": 1576621452, "answer_id": 59382967, "question_id": 59380868, "link": "https://stackoverflow.com/questions/59380868/assigning-a-missing-rating-to-a-date-based-on-a-rating-on-a-different-date/59382967#59382967", "title": "Assigning a missing rating to a date based on a rating on a different date", "body": "<p>Consider pure SQL without looping where you first populate your table with a cross join for all combinations of <code>ISIN</code>, <code>CoID</code>, <code>SnapDate</code>, <code>Rating</code>, <code>RatingDate</code>, then use nested domain aggregates:</p>\n\n<ol>\n<li><code>DMax</code> to find the latest <code>RatingDate</code> relative to <code>SnapDate</code> by <code>CoId</code></li>\n<li><code>DLookUp</code> to retrieve the specific <code>Rating</code> on the step 1 date by <code>CoId</code></li>\n</ol>\n\n<p>Both queries can be handled outside (via Access GUI Query Design > <code>! Run</code>) or inside VBA as shown below.</p>\n\n<p><strong>SQL</strong></p>\n\n<p>Append Query <em>(with cross join of comma separated tables)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO tblCoDtRtgs (ISIN, CoID, SnapDate, Rating, RatingDate ) \nSELECT r.ISIN, r.CoID, d.[Date], r.Rating, r.[Date]\nFROM (SELECT ISIN, CoID,  Rating, [Date], FROM RatingsBackDated) r, \n      Dates d;\n</code></pre>\n\n<p>Update Query <em>(with domain aggregates to be updateable)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE tblCoDtRtgs r\nSET r.Rating = DLookUp(\"Rating\", \"tblCoDtRtgs\", \n                       \"RatingDate = #\" &amp; NZ(DMax(\"RatingDate\", \"tblCoDtRtgs\", \n                                               \"[Date] &lt; #\" &amp; r.Date &amp; \"#\n                                                AND CoId = \" &amp; r.CoID),\n                                             CDate('1900-01-01')) &amp; \"#\n                        AND CoId = \" &amp; r.CoID);\n</code></pre>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>' WITH WARNINGS (NO NEED TO CLOSE ACTION QUERIES)\nDoCmd.OpenQuery myAppendQuery\nDoCmd.OpenQuery myUpdateQuery\n\n\n' WITHOUT WARNINGS\nCurrentDb.Execute myAppendQuery\nCurrentDb.Execute myUpdateQuery\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1576695358, "post_id": 59387554, "comment_id": 104986002, "body": "Thank you Gustav, this unfortunately resulted in the same result, it is returning the data with the new dates, but it is only also returning the oldest rating, and not updating it when it changes."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1576655198, "creation_date": 1576655198, "answer_id": 59387554, "question_id": 59380868, "link": "https://stackoverflow.com/questions/59380868/assigning-a-missing-rating-to-a-date-based-on-a-rating-on-a-different-date/59387554#59387554", "title": "Assigning a missing rating to a date based on a rating on a different date", "body": "<blockquote>\n  <p>.. doesn't change if the rating changes on a certain date.</p>\n</blockquote>\n\n<p>You probably need proper formatting of the expression for the date value - and you might wish to use <em>Max</em>, not <em>Last</em>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.RunSQL \"INSERT INTO tblCoDtRtgs (ISIN, CoID, SnapDate, Rating, RatingDate ) \" &amp; _\n            \"SELECT RatingsBackDated.ISIN, RatingsBackDated.CoID, #\" &amp; Format(dtDate, \"yyyy\\/mm\\/dd\") &amp; \"#, Max(RatingsBackDated.Rating) AS LastOfRating, Max(RatingsBackDated.Date) AS LastOfDate \" &amp; _\n            \"FROM RatingsBackDated \" &amp; _\n            \"WHERE (((RatingsBackDated.Date)&lt;= #\" &amp; Format(dtDate, \"yyyy\\/mm\\/dd\") &amp; \"#)) \" &amp; _\n            \"GROUP BY RatingsBackDated.name, RatingsBackDated.CoID, RatingsBackDated.ISIN;\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1576712029, "creation_date": 1576712029, "answer_id": 59401428, "question_id": 59380868, "link": "https://stackoverflow.com/questions/59380868/assigning-a-missing-rating-to-a-date-based-on-a-rating-on-a-different-date/59401428#59401428", "title": "Assigning a missing rating to a date based on a rating on a different date", "body": "<p>Solved the issue by changing:\nLast(RatingsBackDated.Rating) AS LastOfRating, Last(RatingsBackDated.Date) AS LastOfDate \" &amp; _</p>\n\n<p>to:\nMin(RatingsBackDated.Rating) AS MinOfRating, Max(RatingsBackDated.Date) AS MaxOfDate \" &amp; _</p>\n\n<p>Thank you to everyone for the help.</p>\n"}], "owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1611334145, "creation_date": 1576610852, "last_edit_date": 1611334145, "question_id": 59380868, "link": "https://stackoverflow.com/questions/59380868/assigning-a-missing-rating-to-a-date-based-on-a-rating-on-a-different-date", "title": "Assigning a missing rating to a date based on a rating on a different date", "body": "<p>I have a list of company (CoID) ratings (Rating) that were applied on a certain date (RatingDate).</p>\n<p>The rating dates are sporadic, and I am looking to fill in the blanks by assigning the given rating to a specific date from a list of dates.</p>\n<p>If the rating changes on a given RatingDate, the new rating is carried forward on the dates after the change.<br />\nMy code carries forward the oldest rating, and doesn't change if the rating changes on a certain date.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function PopulateTableOfRatingHistory()\n    \n    Dim dbs As DAO.Database\n    Set dbs = CurrentDb\n    \n    Dim dtDate As Date 'snapshot date\n    Dim sqlAppend As String\n    \n    Dim sqlQueryLastRating As String\n       \n    Dim qdf As DAO.QueryDef\n    Dim rs1 As DAO.Recordset\n    Set rs1 = dbs.OpenRecordset(&quot;DATES&quot;) 'check this to make sure it imports the table values\n    \n    DoCmd.SetWarnings False\n        \n    rs1.MoveFirst\n    Do While Not rs1.EOF\n        'get the date value to use as a parameter\n        dtDate = rs1.Fields(1).Value ' get the date value to lookup\n        \n        'use the date parameter to run the SQL for the last rating as of the given date and append the query result to a table\n            \n        DoCmd.RunSQL &quot;INSERT INTO tblCoDtRtgs (ISIN, CoID, SnapDate, Rating, RatingDate ) SELECT RatingsBackDated.ISIN, RatingsBackDated.CoID, #&quot; &amp; dtDate &amp; &quot;#, Last(RatingsBackDated.Rating) AS LastOfRating, Last(RatingsBackDated.Date) AS LastOfDate &quot; &amp; _\n          &quot;FROM RatingsBackDated &quot; &amp; _\n          &quot;WHERE (((RatingsBackDated.Date)&lt;= #&quot; &amp; dtDate &amp; &quot;#)) &quot; &amp; _\n          &quot;GROUP BY RatingsBackDated.name, RatingsBackDated.CoID, RatingsBackDated.ISIN;&quot;\n        \n        rs1.MoveNext\n    Loop\n        \n    rs1.Close\n    Set rs1 = Nothing\n    Set dbs = Nothing\n      \n    DoCmd.SetWarnings True\n      \nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1576614731, "post_id": 59380883, "comment_id": 104955258, "body": "You could also use <code>On Error Resume Next</code> then. At least you will get the same result. On the other hand I do not know what the OP really wants to learn by the code above,"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1576617412, "post_id": 59380883, "comment_id": 104956339, "body": "@Storax The result will not be the same. With <code>On Error Resume Next</code> you will see <code>&quot;END 1&quot;</code> and <code>&quot;END 2&quot;</code>. Here, you won&#39;t."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 4, "last_activity_date": 1576610927, "creation_date": 1576610927, "answer_id": 59380883, "question_id": 59380795, "link": "https://stackoverflow.com/questions/59380795/goto-function-is-corrupt-or-has-a-limit/59380883#59380883", "title": "GoTo function is corrupt or has a limit", "body": "<p>Once you've entered an error handler subroutine, you need to exit that subroutine with <code>Resume</code>. Because you never did, the second exception is treated as an exception inside an error handler, which means the error handler failed to handle the error, so the error is propagated up.</p>\n\n<p>If you insist on having the code laid out the way you sketched out, that would be</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GoTo_Test()\nDim X As Integer, Y As Integer\n\n1: On Error GoTo 2\n                                            MsgBox \"START 1\"\n    X = 1 / 0\n                                            MsgBox \"END 1\"\n\nhandled_2: On Error GoTo 3\n                                            MsgBox \"START 2\"\n    Y = 1 / 0\n                                            MsgBox \"END 2\"\n\nhandled_3:                                  MsgBox \"End Sub\"\n\nExit Sub\n\n\n2:\nResume handled_2\n\n3:\nResume handled_3\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1576611755, "creation_date": 1576611755, "answer_id": 59381071, "question_id": 59380795, "link": "https://stackoverflow.com/questions/59380795/goto-function-is-corrupt-or-has-a-limit/59381071#59381071", "title": "GoTo function is corrupt or has a limit", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nSub GoTo_Test()\n\nDim X, Y As Integer\n\n1: On Error GoTo 2\n                                            MsgBox \"START 1\"\n    X = 1 / 0\n                                            MsgBox \"END 1\"\n\n2: Resume Next\nOn Error GoTo 3\n                                            MsgBox \"START 2\"\n    Y = 1 / 0\n                                            MsgBox \"END 2\"\n\n3: Resume Next\n                                            MsgBox \"End Sub\"\n\nEnd Sub\n</code></pre>\n\n<p>You need to close (terminate) each active error handler else you'll have problems with errors within the active error handling routine.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12554308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD6_BwbRh5SPXCcvJns3EqnczNjwn3jeQ9GututIg=k-s128", "display_name": "William Miranda", "link": "https://stackoverflow.com/users/12554308/william-miranda"}, "edited": false, "score": 0, "creation_date": 1576614824, "post_id": 59381579, "comment_id": 104955298, "body": "Oh Thanks, I now understand the purpose of GoTo -1."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1576614166, "creation_date": 1576614166, "answer_id": 59381579, "question_id": 59380795, "link": "https://stackoverflow.com/questions/59380795/goto-function-is-corrupt-or-has-a-limit/59381579#59381579", "title": "GoTo function is corrupt or has a limit", "body": "<p>Another way is to reset the error handler.</p>\n\n<pre><code>Sub GoTo_Test()\n\n        Dim X, Y As Integer\n\n1:        On Error GoTo 2\n          MsgBox \"START 1\"\n          X = 1 / 0\n          MsgBox \"END 1\"\n\n2:        On Error GoTo -1\n          On Error GoTo 3\n          MsgBox \"START 2\"\n          Y = 1 / 0\n          MsgBox \"END 2\"\n\n3:        MsgBox \"End Sub\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12554308, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD6_BwbRh5SPXCcvJns3EqnczNjwn3jeQ9GututIg=k-s128", "display_name": "William Miranda", "link": "https://stackoverflow.com/users/12554308/william-miranda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 59380883, "answer_count": 3, "score": 0, "last_activity_date": 1576614166, "creation_date": 1576610533, "last_edit_date": 1576611497, "question_id": 59380795, "link": "https://stackoverflow.com/questions/59380795/goto-function-is-corrupt-or-has-a-limit", "title": "GoTo function is corrupt or has a limit", "body": "<p>I want to put two GoTo aligned after detecting an error. However, the second GoTo is ignored by VBA, and then a debug screen appears.</p>\n\n<pre><code>Sub GoTo_Test()\n\nDim X, Y As Integer\n\n1: On Error GoTo 2\n                                            MsgBox \"START 1\"\n    X = 1 / 0\n                                            MsgBox \"END 1\"\n\n2: On Error GoTo 3\n                                            MsgBox \"START 2\"\n    Y = 1 / 0\n                                            MsgBox \"END 2\"\n\n3:                                          MsgBox \"End Sub\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 1, "creation_date": 1576610347, "post_id": 59380608, "comment_id": 104953437, "body": "Can you provide an example string?  Are you converting strings that look like &quot;$1,500.99&quot;?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1576611979, "post_id": 59380608, "comment_id": 104954197, "body": "What does this have to do with Excel?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1576612395, "post_id": 59380608, "comment_id": 104954360, "body": "Your question is not very clear.  To format a numeric string as currency, all you need is the <code>Format</code> function in VBA:  <code>Format(&quot;123456.789&quot;, &quot;$#,##0.00&quot;)</code> --&gt; <code>123,456.79</code>"}, {"owner": {"reputation": 320, "user_id": 10893308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iPDNN.png?s=128&g=1", "display_name": "tytyf", "link": "https://stackoverflow.com/users/10893308/tytyf"}, "edited": false, "score": 0, "creation_date": 1576613036, "post_id": 59380608, "comment_id": 104954622, "body": "An example string would be a value received from mail merge it is &#171;Service Product View.Total&#187;. How do I call that format function on this specific string in a Microsoft word document? Did not mean to tag excel."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1576613056, "post_id": 59380608, "comment_id": 104954635, "body": "How to call the macro is your main question? You have to tell us more about how it&#39;s to be used. For example, does the user select the text then run the macro? Or is this part of another process?"}, {"owner": {"reputation": 320, "user_id": 10893308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iPDNN.png?s=128&g=1", "display_name": "tytyf", "link": "https://stackoverflow.com/users/10893308/tytyf"}, "edited": false, "score": 0, "creation_date": 1576613178, "post_id": 59380608, "comment_id": 104954676, "body": "I would like this macro to automatically run. The user just clicks print invoice, and the invoice is populated from a mail merge. The amounts are unformatted though and seem to be strings. So yes calling a macro with an argument is my main question."}, {"owner": {"reputation": 320, "user_id": 10893308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iPDNN.png?s=128&g=1", "display_name": "tytyf", "link": "https://stackoverflow.com/users/10893308/tytyf"}, "edited": false, "score": 0, "creation_date": 1576613524, "post_id": 59380608, "comment_id": 104954806, "body": "print invoice is a button on a web application."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1576612347, "post_id": 59380935, "comment_id": 104954339, "body": "Currency in not a double, it is an 64 bit integer counting 10,000th of a dollar/rupee. From VBA Language Spec - <b>Currency  Numbers with 4 fractional decimal digits in the range  -922,337,203,685,477.5808 to  +922,337,203,685,477.5807   64-bit signed binary two\u2019s complement integer  implicitly scaled by 10-4</b>"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1576613196, "post_id": 59380935, "comment_id": 104954687, "body": "Note to internationalization: <code>CCur</code> conversion from a given string (instead from a double) uses regional language settings regarding decimal points which may give unwanted results e.g. in most central European countries (&quot;,&quot; instead of a decimal point &quot;.&quot;)"}, {"owner": {"reputation": 320, "user_id": 10893308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iPDNN.png?s=128&g=1", "display_name": "tytyf", "link": "https://stackoverflow.com/users/10893308/tytyf"}, "edited": false, "score": 0, "creation_date": 1576613414, "post_id": 59380935, "comment_id": 104954767, "body": "How would I get stringNum to be dynamic changing on the text in the word document? I receive my amount/num from a mailmerge field."}, {"owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "edited": false, "score": 0, "creation_date": 1576619041, "post_id": 59380935, "comment_id": 104957019, "body": "Is the source an Excel file?  Do you have the option of changing the data on the source?"}], "tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 0, "last_activity_date": 1576611611, "last_edit_date": 1576611611, "creation_date": 1576611144, "answer_id": 59380935, "question_id": 59380608, "link": "https://stackoverflow.com/questions/59380608/convert-string-to-double-in-word-vba/59380935#59380935", "title": "Convert string to double in word (vba)", "body": "<p>If you want to convert the number to a <code>Double</code> data type then try this:</p>\n\n<pre><code>Function StringToDouble(ByVal baseString As String) As Double\n    StringToDouble = VBA.CDbl(baseString)\nEnd Function\n</code></pre>\n\n<p>If you're only concerned about formatting currency, convert the string to the <code>Currency</code> data type like this:</p>\n\n<pre><code>Function StringToCurrency(ByVal baseString As String) As Currency\n    StringToCurrency = VBA.CCur(baseString)\nEnd Function\n</code></pre>\n\n<p>You will still need to format the number but both functions give you a number that can be formatted.</p>\n\n<p>Here's an example that also gives you a string formatted as USD (e.g. $4,999.75).  It requires the <code>StringToCurrency</code> function above.</p>\n\n<pre><code>Sub test()\n    Dim stringNum As String\n    stringNum = \"4,999.754501\"\n    Debug.Print \"stringNum=\" &amp; stringNum                ' outputs 4,999.754501\n\n    Dim currencyNum As Currency\n    currencyNum = StringToCurrency(stringNum)           ' outputs 4999.7545\n    Debug.Print \"currencyNum=\" &amp; currencyNum\n\n    Dim formattedString As String\n    formattedString = Format$(currencyNum, \"$#,##0.00\")\n    Debug.Print \"formattedString=\" &amp; formattedString    ' outputs $4,999.75\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 1, "last_activity_date": 1576619510, "creation_date": 1576619510, "answer_id": 59382635, "question_id": 59380608, "link": "https://stackoverflow.com/questions/59380608/convert-string-to-double-in-word-vba/59382635#59382635", "title": "Convert string to double in word (vba)", "body": "<p>You don't need a macro for this!!! All you need do is learn how to use formatting switches in Word fields.</p>\n\n<p>To control number &amp; currency formatting in Word, add a numeric picture switch to the mergefield. To do this:</p>\n\n<ul>\n<li>select the mergefield;</li>\n<li>press Shift-F9 to reveal the field coding. It should look something like {MERGEFIELD MyData};</li>\n<li>edit the field so that you get {MERGEFIELD MyData # $,0.00} (or whatever other numeric format you prefer - see below);</li>\n<li>position the cursor anywhere in this field and press F9 to update it.</li>\n</ul>\n\n<p><strong>Note 1:</strong> The '# $,0.00' in the field is referred to as a numeric picture switch. Other possibilities include:</p>\n\n<ul>\n<li># 0 for rounded whole numbers</li>\n<li># ,0 for rounded whole numbers with a thousands separator</li>\n<li># ,0.00 for numbers accurate to two decimal places, with a thousands separator</li>\n<li># $,0 for rounded whole dollars with a thousands separator</li>\n<li># \"$,0.00;($,0.00);'-'\" for currency, with brackets around negative numbers and a hyphen for 0 values</li>\n</ul>\n\n<p><strong>Note 2:</strong> The precision of the displayed value is controlled by the '0.00'. You can use anything from '0' to '0.000000000000000'.\nIf you use a final ';' in the formatting switch with nothing following, (eg # \"$,0.00;($,0.00);\") zero values will be suppressed. Note that this suppresses 0s resulting from empty fields and from fields containing 0s.</p>\n\n<p><strong>Note 3:</strong> If you use a decimal tab or right-aligned tab to align the values, wrap the switch in quotes (i.e. # \"$,0.00\") and insert a tab into the field code after the $ sign, you can have the values output with the decimal alignment occurring after the $ sign.</p>\n\n<p>For more Mailmerge Tips &amp; Tricks, see: <a href=\"https://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\" rel=\"nofollow noreferrer\">https://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html</a></p>\n"}], "owner": {"reputation": 320, "user_id": 10893308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iPDNN.png?s=128&g=1", "display_name": "tytyf", "link": "https://stackoverflow.com/users/10893308/tytyf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1576641131, "creation_date": 1576609638, "last_edit_date": 1576641131, "question_id": 59380608, "link": "https://stackoverflow.com/questions/59380608/convert-string-to-double-in-word-vba", "title": "Convert string to double in word (vba)", "body": "<p>I am trying to convert a text in a word document to be a double, so I can do currency formatting on it. I receive this text from a mail merge. How would I create a macro that can receive this text and return it as a number?\nI'm unfamiliar with word, and VBA script. What I have made so far is </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>Function stringToDouble(baseString As String)\n    Dim num As Double\n\n    num = Val(baseString)\n\n    stringToDouble = num\n\nEnd Function\n\n</code></pre>\n\n<p>I'm not sure how I would call this macro. Because it takes a parameter it does not show up in the macro table. \nI may be completely off on how to convert text to a double in word, but any help is appreciated.\nThanks. Please comment for any clarifications.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1576610407, "post_id": 59380603, "comment_id": 104953464, "body": "list the column by their reference rather than name, ie &quot;A:C&quot; etc"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1576610491, "post_id": 59380603, "comment_id": 104953505, "body": "Ctrl+H, find <code>_</code>, replace by an empty string. Then Ctrl+H again, find <code>ColumnsToDelete =</code>, and replace by <code>ColumnsToDelete = ColumnsToDelete &amp; </code>, and that should be good to go."}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576610978, "post_id": 59380603, "comment_id": 104953715, "body": "@MathieuGuindon I did what you said, it deleted the first line, but the second and moving forward, they are not deleted."}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1576611247, "post_id": 59380603, "comment_id": 104953836, "body": "@alowflyingpig But the workbooks that we edit don&#39;t have the same column sequence all the time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576611341, "post_id": 59380603, "comment_id": 104953881, "body": "Try it again.. make sure to select &quot;in procedure&quot;, not just &quot;selection&quot;"}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576611571, "post_id": 59380603, "comment_id": 104953994, "body": "@MathieuGuindon What&#39;s that? I am sorry. I am new to this and still practicing. Click Insert then Procedure. Then that&#39;s where I will place the Dosomething or the DeleteColumns sub?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576611648, "post_id": 59380603, "comment_id": 104954031, "body": "In the find/replace dialog, there&#39;s a series of optionbuttons that determine where to search: in the current selection, the current procedure, the current module, the entire project"}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576612053, "post_id": 59380603, "comment_id": 104954221, "body": "@MathieuGuindon I have updated my post. Check the new codes above. I did what you asked and edited in the current procedure. Yes, it only deleted the first line. The second line and onwards, they still remain."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576614781, "post_id": 59380603, "comment_id": 104955276, "body": "I don&#39;t understand. Your code looks fine here. Still &quot;too many line continuations&quot;?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1576616957, "post_id": 59380603, "comment_id": 104956133, "body": "Possibly starting from the 2nd row of string concatenation the code line should include a prefixed colon to each further string sequence, i.e. <code>ColumnsToDelete = ColumnsToDelete &amp; &quot;,&quot; &amp; &quot;...&quot;</code> to identify each sequence starter correctly (and separated by the &quot;,&quot; delimiter) instead of combining it with the last preceding string element :-)"}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576617124, "post_id": 59380603, "comment_id": 104956216, "body": "@MathieuGuindon The too many lines continuation error no longer occurs. However, the result is still the same. Only the first line is working. The second line and onwards are not deleting the columns specified. Thanks for your help with the too many line continuations error though! Appreciate it!"}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1576617259, "post_id": 59380603, "comment_id": 104956283, "body": "@T.M. I am confused with your instructions. I am sorry. Can you please clarify? Thank you."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1576617599, "post_id": 59380603, "comment_id": 104956411, "body": "The <code>Split</code> function needs a &quot;,&quot; delimiter to separate the string tokens correctly. If the last column name in the 1st line and the first column name in the new line have no &quot;,&quot; in between, these two names won&#39;t be identified. So I assume the second code line should start with an additional colon, i.e. <code>ColumnsToDelete = ColumnsToDelete &amp; &quot;,&quot; &amp; &quot;Additional Intended Use For Child,AHAM CADR Dust rating,.....&quot;</code>, similarly the 3rd line and so forth :-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576617840, "post_id": 59380603, "comment_id": 104956499, "body": "The post title and body is about too many line continuations, but the code isn&#39;t, and the actual question is buried in a bunch of comments. Please <a href=\"https://stackoverflow.com/posts/59380603/edit\">edit</a> your post to clarify."}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1576618262, "post_id": 59380603, "comment_id": 104956712, "body": "@MathieuGuindon done. Thank you."}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1576618698, "post_id": 59380603, "comment_id": 104956885, "body": "@T.M. Thank you so much! It&#39;s working now! One last thing. I have column names like &quot;Dry, Damp, or Wet Location Listed - CAN&quot;. VBA is reading it like &quot;Dry&quot; and &quot;Damp&quot; &quot;or Wet Location Listed - CAN&quot;. How can I make it as one?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1576686656, "post_id": 59380603, "comment_id": 104981910, "body": "@Jezun 1) Change the &quot;,&quot; in <code>Dry, Damp, or Wet ...</code> to an unused character within the <code>ColumnsToDelete</code> assignment rows, e.g. to &quot;$&quot; and 2) <i>replace</i> the  <code>V</code> variable back in the loop, e.g. via <code>Rows(1).Find(Trim(Replace(V, &quot;$&quot;, &quot;,&quot;), , , xlWhole, , , False).EntireColumn.Delete</code>"}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "edited": false, "score": 0, "creation_date": 1578597582, "post_id": 59380603, "comment_id": 105500335, "body": "this stopped working. I just noticed that after all, it only deletes the word Certifications, and the rest after that is ignored"}, {"owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1578600437, "post_id": 59380603, "comment_id": 105501525, "body": "@T.M. Can you help? :("}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1578691381, "post_id": 59380603, "comment_id": 105534972, "body": "It&#39;s hard to help without knowing your complete (manual) changes (c.f. <code>Dry, Damp, or Wet ...</code> ~&gt; <code>Dry$ Damp$ or Wet ...</code>) Suppose you overwrote other delimiters :-)"}], "owner": {"reputation": 79, "user_id": 5122847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7896223933fbeff2d8f1152796a65812?s=128&d=identicon&r=PG&f=1", "display_name": "Jezun", "link": "https://stackoverflow.com/users/5122847/jezun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1578597613, "creation_date": 1576609620, "last_edit_date": 1578597613, "question_id": 59380603, "link": "https://stackoverflow.com/questions/59380603/how-to-delete-these-specified-columns", "title": "How to delete these specified columns?", "body": "<p>I want to delete specific columns to all sheets in a workbook. When I run my codes, it will only remove the columns specified in the first line. The rest are not included. How do I do it with many columns to specify? How do I go about this?</p>\n\n<pre><code>Sub Dosomething()\n  Dim xSh As Worksheet\n  Application.ScreenUpdating = False\n  For Each xSh In Worksheets\n      xSh.Select\n      Call DeleteColumns\n  Next\n  Application.ScreenUpdating = True\nEnd Sub\nSub DeleteColumns()\n  Dim ColumnsToDelete As String, V As Variant\n  ColumnsToDelete = ColumnsToDelete &amp; \"AAFA Certified|AATCC 116 Grade|AATCC 16.1-2014 Grade|AATCC 16.3-2014 Grade|AATCC 8 Grade|AC Rated|AC Rating|ACT Flammability Guidelines Compliant|ADA Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"Additional Intended Use For Child|AHAM CADR Dust rating|AHAM CADR Pollen rating|AHAM CADR Smoke rating|AHAM Certified|AHMA Compliant|AHRI Certified|American Cornhole Association (ACA) Certified|ANSI A117.1 Compliant|ANSI A137.1 Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"ANSI IT9.2 Compliant|ANSI Z1.5A/CGA 9.1M Certified|ANSI Z124.1.2 Compliant|ANSI Z124.3 Compliant|ANSI Z124.6-97 Compliant|ANSI Z358 Compliant|ANSI/BHMA A156 Certified|ANSI/BIFMA e3 Furniture Sustainability Standard|ANSI/BIFMA X5.1 Office Seating|ANSI/BIFMA X5.11 Large Occupant Office Seating\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"ANSI/BIFMA X5.3 Vertical Files|ANSI/BIFMA X5.4 Lounge &amp; Public Seating|ANSI/BIFMA X5.5 Desk Products|ANSI/BIFMA X5.6 Panel Systems|ANSI/BIFMA X5.9 Storage|ANSI/BIFMA X6.1 Educational Seating|ANSI/BIFMA X7.1 Standard for Formaldehyde &amp; TVOC Emissions|ANSI/ESD S20.20 Certified|ANSI/NISO Z39.48 Compliant|ANSI/SOHO S6.5 Small Office/Home Office\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"APMA Certified| ASHRAE 62.2 Standard Compliant| ASME A112.18.1 Compliant| ASME A112.18.2 Compliant| ASME A112.19.1 Compliant| ASME A112.19.2 Compliant| ASME A112.19.3 Compliant| ASP:02:01 Certification| ASSE 1001 Certified| ASSE 1006 Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"ASSE 1016 Certified| ASTM E1590-07| ASTM F1004-19 Certified| ASTM F1148-17| ASTM F1148-18 Certified| ASTM F1169 - 13 Certified| ASTM F1821 - 16 Certified| ASTM F1912-17 Certified| ASTM F1917 - 12 Certified| ASTM F2057 - 14 Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"ASTM F2057 - 17 Certified| ASTM F2057 - 19 Certified| ASTM F2085 - 12 Certified| ASTM F2088-15| ASTM F2194 Certified| ASTM F2225-15| ASTM F2388 - 18 Certified| ASTM F2613 - 17 Certified| ASTM F2933-18 Certified| ASTM F3084 - 16 Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"ASTM F3096 - 14 Certified| ASTM F3317-18 Certified| ASTM F381-16| ASTM F406 - 10a Certified| ASTM F406 - 15 Certified| ASTM F406 - 17 Certified| ASTM F963 - 17 Certified| ASTM F963-11| ATA Rated| AZO Free\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"BHFTI Upholstered Furniture Flammability Compliant| BIFMA G1 Ergonomics Guideline for Furniture| BIFMA HCF 8.1 - Healthcare Furniture Design| Blauer Engel| BPA Free| BS 5287: 1988 Certified| BS 5852 Certified| BS 5867-2:2008 Certified| BS 7176: 2007 Certified| BS 7177:2008+A1:2011 Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"BS EN 13120: 2009 + A1: 2014 (Requirements for Window Blinds or Drapery Cords) - EU ONLY| BS EN 71 Compliant - EU ONLY| BS EN 716-1 Compliant - EU ONLY| BS EN12790 Certified| Bulb Included| Bulb Type| CAL TB 116 Compliant| CAL TB 117-2013 Compliant| CALGreen Compliant| California AB 1953 Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"California Pesticide (DPR) Registration Number| California Proposition 65 Warning Required| Canada Product Restriction| CARB Phase II Compliant (formaldehyde emissions)| CE Certified| CEE Rating| Certifications| CertiPUR-US Certified| cETL Certified| cETL Listed\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"CFC Free| Chemicals of Concern Compliant| Children\u2019s Product Certificate (CPC)| CISPR 22 Compliant| Commercial ONLY Certifications| Commercial OR Residential Certifications| Commercial Warranty| Composite Wood Product (CWP)| Consumer Safety Specification for Bunk Beds ASTM F1427 - 13| Contains Flame Retardant Materials\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"Country of Origin| Country of Origin - Additional Details| CPAI-84 Compliant| CPG Compliant| CPSC - 15 U.S. Code \u00a7 1278a - Children\u2019s Products Containing Lead| CPSC - 16 CFR 1213 Compliant| CPSC - 16 CFR 1217 Compliant| CPSC - 16 CFR 1218 Compliant| CPSC - 16 CFR 1219 Compliant| CPSC - 16 CFR 1220 Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"CPSC - 16 CFR 1234 Compliant| CPSC - 16 CFR 1237 Compliant| CPSC - 16 CFR 1238 Compliant| CPSC - 16 CFR 1239 Compliant| CPSC - 16 CFR 1303 Compliant| CPSC - 16 CFR 1500.49 Compliant| CPSC - 16 CFR 1513 Compliant| CPSC - 16 CFR 1630 Compliant| CPSC - 16 CFR 1631 Compliant| CPSC - 16 CFR 1632 Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"CPSC - 16 CFR 1633 Compliant| CPSC - 16 CFR Part 1130-Requirements For Consumer Registration Of Durable Infant Or Toddler Products| CPSC - 16 CFR Part 1307-Prohibition Of Children's Toys And Child Care Articles Containing Specified Phthalates| CPSIA Compliant| CPSIA or CPSC Compliant| Cradle to Cradle Certified| CRI Certified| CRI Green Label Certified| CRI Green Label Plus Certified| CSA B125 Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"CSA B125.1 Certified| CSA B125.2 Certified| CSA B13 Certified| CSA B45 Certified| CSA B45.1 Certified| CSA B45.2 Certified| CSA Certified| CSA Listed for Canada| CSA Listed for USA| cUL Listed\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"cUPC Certified| Dark Sky Compliant| DECT 6.0 Compliant| DIN EN 12935 Certified| Dry, Damp, or Wet Location Listed - CAN| Dry, Damp, or Wet Location Listed - USA| EEP Compliant| EIA Compliant| EISA 2007 Compliant| EISA Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"Emergency Feed| EN 1130-1:1996 (Safety Requirements for Cribs and Cradles) - EU ONLY| EN 12221-1 (Standards for Changing Tables) - EU ONLY| EN 13219 (Standards for Trampolines) - EU ONLY| EN 14878: 2007 (Requirements for Children's Sleepwear) - EU ONLY| EN 14988-1 (Safety Standards for High Chairs) - EU ONLY| EN 15312 (Safety Standards for Multi-Sport Equipment) - EU ONLY| EN 1725 (Safety Standards for Adult Beds) - EU ONLY| EN 1930 (Standards for Child Gates and Safety Barriers) - EU ONLY| EN 50291-1 (Standards for Smoke Detectors and CO Detectors) - EU ONLY\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"EN 54-12 (Standards for Smoke Detectors and CO Detectors) - EU ONLY| EN 71 Compliant| EN 71-14:2018 Compliant| EN 747-1 (Standards for Childrens Bunk Beds) - EU ONLY| EN 748 (Safety Standards for Football Goals) - EU ONLY| Energy Label Type| Energy Policy Act 1992 Compliant| Energy Star Compliant| EPA Compliant| EPA Pesticide Registration Number\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"EPAct 2005 Compliant| EPP Compliant| ETL Listed| EuroLatex ECO-Standard| FCC Compliant| FCC Part 15 Certified| FCC Part 15 Compliant| FCC Part 68 Compliant| FDA Approved| FIRA Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"Fire Rated| Fire Resistant| FISP Certified| FloorScore Certification| FM Approved| FourB Compliant| FSC Certified| General Certificate of Conformity (GCC)| Glass Doors and Enclosures Regulations SOR/2016-174| Glazed Ceramics and Glassware Regulations SOR/2016-175\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"GOLS 3.0 (Global Organic Latex Standard) Certified| GOLS License Expiry Date| GOLS License Number| Goodweave Certified| GOTS 5.0 (Global Organic Textile Standard) Certified| GOTS License Expiry Date| GOTS License Number| Grade of GOLS Certification| Grade of GOTS Certification| Green Compliance\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"GREENGUARD Certified| GREENGUARD Gold Certified| GS (Gepr\u00fcfte Sicherheit) verzeichnet| GSA Approved| Health Canada - SOR/2016-176 Compliant| Health Canada - SOR/2016-179 Compliant| Health Canada - SOR/2016-183 Compliant| Health Canada Compliant| HFES 100 Certified Ergonomic| HVI 2100 Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"HVI Certified| IAPMO Certified| IATA Compliant| Indoor Air Quality Certified| IP Rating| IPEMA Certified| ISO 14000 Certified| ISO 14001 Certified| ISO 9000 Certified| ISO 9001 Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"ITSF Compliant| ITTF Approved| ITTO Compliant| Janka Hardness Rating (PSI)| JPMA Certified| Kettles Regulations SOR/2016-181| Knife Included| Lacey Act Compliant| Latex Free| Lead Free\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"LEED Project Appropriate| LM-79 Certified| LM-80 Certified| Low Lead Compliant| Mattress Flammability Testing - Public Occupancy Use| Maximum Wattage (per bulb)| MERV Rating| MET Listed| Minnesota 325F.177 Compliant| MOHS - Surface Hardness\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"NAECA Certified| NAHB Compliant| NEMA Certified| NFPA 253 or ASTM E648 Certified| NFPA Compliant| NFSI Certified| NHPA Approved| NOMITE Certified| Non-Toxic| NRPA Certified\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"NSF Certified| NSF/ANSI 184 Certified| NSF/ANSI 3 Certified| NSF/ANSI 336 Compliant| NSF/ANSI 61 Certified| OEKO-TEX Standard 100 Certified| OSHA Compliant| PAT Tested| PEFC Certified| PEI Rated\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"PEI Rating| PFOA Free| Phthalate Free| Product Warranty| PTFE Free| PTFE or PFOA| PTFE or PFOA Free| Reason for Restriction| Responsible Down Standard Certified| RoHS Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"SATRA Approved| SCC Compliant| SCS Certified| SDWA Compliant| SFI Certified| SOR/2016-152 - Canadian Regulation - Cribs, Cradles and Bassinets| SOR/2016-193 - Surface Coating Materials Regulations| SOR/2018-83 -Consumer Products Containing Lead Regulations| Stiftung Warentest Note| TAA Compliant\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"TB 117-2013 Compliant| TB 133 Compliant| TCLP Compliant| Textile Flammability Regulations SOR/2016-194| Textile Labelling and Advertising Regulations (C.R.C., c. 1551)| Tipover Restraint Device Included| Title 20 - California Code of Regulations| Title 24 Compliant| Total Recycled Content (Percentage)| Total Wattage\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"Toys Regulations SOR/2016-195| TSA Compliant| TSCA Title VI Compliant (formaldehyde emissions)| T\u00dcV Certified| T\u00dcV Rheinland zertifiziert| UL 10B Compliant| UL 10C Compliant| UL 1678 Listed| UL 1951 Listed| UL 2108 Listed\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"UL 4041 - Safety Standard for Outdoor Furniture| UL Listed| ULC ORD-C627.1-2008\u00a0- Unvented Ethyl Alcohol Fuel Burning Decorative Appliances| ULC/ORD-C627.1-2008| Uniform Packaging and Labeling Regulations (UPLR) Compliant| UPC Certified| USATT Approved| USDA Compliant| USDA Organic/ NOP Certified| USDA/NOP Certificate Number\"\n  ColumnsToDelete = ColumnsToDelete &amp; \"|\" &amp; \"USDA/NOP License Expiry Date| USPS Approved| Vermont Act 193 Compliant| VESA Compliant| Washington State VIAQ Code Compliant| Wattage| WEEE Recycling Required| WQA Gold Seal Certified| WW-P-541 Certified\"\n  On Error Resume Next\n  For Each V In Split(ColumnsToDelete, \"|\")\n    Rows(1).Find(Trim(V), , , xlWhole, , , False).EntireColumn.Delete\n  Next\n  On Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1576610091, "post_id": 59380581, "comment_id": 104953334, "body": "<code>&quot;= $B2 &amp; &quot;&quot;.&quot;&quot; &amp; $D2 &amp; &quot;&quot;@gmail.com&quot;&quot;&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1576856031, "creation_date": 1576856031, "answer_id": 59427786, "question_id": 59380581, "link": "https://stackoverflow.com/questions/59380581/how-to-make-the-symbol-work-in-a-formula-inside-of-a-macro-in-vba/59427786#59427786", "title": "How to make the &quot;@&quot; symbol work in a formula inside of a macro in VBA?", "body": "<p>To close out this question: You have quotes issues:</p>\n\n<pre><code>\"= $B2 &amp; \"\".\"\" &amp; $D2 &amp; \"\"@gmail.com\"\"\"\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 10229586, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kktXaFkUBN8/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oI75ef7nlKkVYco3xqig4UA9HbNw/mo/photo.jpg?sz=128", "display_name": "Sasha Desansky", "link": "https://stackoverflow.com/users/10229586/sasha-desansky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 59427786, "answer_count": 1, "score": 0, "last_activity_date": 1576856031, "creation_date": 1576609529, "last_edit_date": 1576613143, "question_id": 59380581, "link": "https://stackoverflow.com/questions/59380581/how-to-make-the-symbol-work-in-a-formula-inside-of-a-macro-in-vba", "title": "How to make the &quot;@&quot; symbol work in a formula inside of a macro in VBA?", "body": "<p>I have the below macro:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub GenerateTestData()\n    Range(\"F3:F151\").Formula = \"= $B2 &amp; \"\".\"\" &amp; $D2 &amp; \"@gmail.come\"\"\nEnd Sub\n</code></pre>\n\n<p>There is an issues with the @ symbol, and I am not sure how to make it work as a string.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12549061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2D20jeD7G3o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfsSewFg0R20zEEgzRUV2waGEA5fg/photo.jpg?sz=128", "display_name": "user12549061", "link": "https://stackoverflow.com/users/12549061/user12549061"}, "edited": false, "score": 0, "creation_date": 1576611362, "post_id": 59380281, "comment_id": 104953889, "body": "The code works fine if executed from the VBA Window or from any of the two sheets. I have the command button on an input sheet, when I run the code it just copies the cells in the input sheet and pastes it to the region and model sheets. How do I fix this so it only copies from the region and model sheets?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 13, "user_id": 12549061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2D20jeD7G3o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfsSewFg0R20zEEgzRUV2waGEA5fg/photo.jpg?sz=128", "display_name": "user12549061", "link": "https://stackoverflow.com/users/12549061/user12549061"}, "edited": false, "score": 0, "creation_date": 1576615021, "post_id": 59380281, "comment_id": 104955381, "body": "You need to qualify which sheet <code>Columns(BeforeR)</code> is on."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1576608083, "creation_date": 1576608083, "answer_id": 59380281, "question_id": 59380244, "link": "https://stackoverflow.com/questions/59380244/why-do-i-get-object-required-error-for-the-below-vba-code/59380281#59380281", "title": "Why do I get object required error for the below VBA code?", "body": "<p>You want an actual member of the <code>Worksheets</code> collection:</p>\n\n<pre><code>Set ws = ThisWorkbook.Worksheets(xSheets(i))\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><code>BeforeR = R.Column - 1</code></p>\n</blockquote>\n\n<p>What is <code>R</code>? Add <code>Option Explicit</code> to the top of the module and declare all variables.</p>\n"}], "owner": {"reputation": 13, "user_id": 12549061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2D20jeD7G3o/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfsSewFg0R20zEEgzRUV2waGEA5fg/photo.jpg?sz=128", "display_name": "user12549061", "link": "https://stackoverflow.com/users/12549061/user12549061"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 1, "accepted_answer_id": 59380281, "answer_count": 1, "score": 0, "last_activity_date": 1576608121, "creation_date": 1576607980, "last_edit_date": 1576608121, "question_id": 59380244, "link": "https://stackoverflow.com/questions/59380244/why-do-i-get-object-required-error-for-the-below-vba-code", "title": "Why do I get object required error for the below VBA code?", "body": "<p>I am new to VBA, I need help applying the below VBA code to two specific work sheets by Region and by Model. The code simply finds the last column which has the name total for the year and copies the previous months values into a new column. But I get an error object required at ws. </p>\n\n<pre><code>   Sub Insert_New_Col()\n\nDim Found As Range, BeforeR As Long\nDim xSheets As Variant\nDim ws As Worksheet\nDim i As Long\n\nxSheets = Array(\"By Region\", \"By Model\") '\n\nFor i = LBound(xSheets) To UBound(xSheets)\n\n    Set ws = xSheets(i)\n    Set Found = ws.Rows(3).Find(What:=\"Total for the Year\", Lookat:=xlWhole)\n    BeforeR = R.Column - 1\n\n    If Found Is Nothing Then\n        MsgBox (\"The word 'Totals' was not found in Row 5 on Sheet: \" &amp; ws.Name)\n    Else\n        Columns(BeforeR).Copy\n        ws.Columns(R.Column).Insert Shift:=xlRight\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1576605958, "post_id": 59379788, "comment_id": 104951630, "body": "When you are opening the workbook, capture the result in a workbook variable: <code>Set wb = Workbooks.Open...</code>. Now you don&#39;t need to refer to it by name at all."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1576607362, "creation_date": 1576607362, "answer_id": 59380106, "question_id": 59379788, "link": "https://stackoverflow.com/questions/59379788/open-file-rename-file-to-variable-and-be-able-to-activate-window-throughout-mac/59380106#59380106", "title": "Open file, rename file to variable and be able to activate window throughout macro using new name", "body": "<p>Normally you don't need or want to <code>Activate</code> or <code>Select</code> - see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this question</a> for a thorough explanation why not and how to avoid doing so.</p>\n\n<p>In your case, when you are opening the workbook, capture the result in a workbook variable:</p>\n\n<pre><code>Dim wb as Workbook\nSet wb = Workbooks.Open(...)\n</code></pre>\n\n<p>Now you don't need to refer to the file by name at all.</p>\n"}], "owner": {"reputation": 1, "user_id": 12527131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mCEhx6K41e0FHNq0kst_S8OqRs-vHteV0brMQdB=k-s128", "display_name": "Brandon Clarke", "link": "https://stackoverflow.com/users/12527131/brandon-clarke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576607362, "creation_date": 1576605810, "last_edit_date": 1576605995, "question_id": 59379788, "link": "https://stackoverflow.com/questions/59379788/open-file-rename-file-to-variable-and-be-able-to-activate-window-throughout-mac", "title": "Open file, rename file to variable and be able to activate window throughout macro using new name", "body": "<p>I realize this is probably a simple task but I am having issues activating files in my code. I need to have the user choose a file from a pop-up box, have the file opened, and then be able to rename the file so I can activate it periodically in my macro without worrying about the file name being different each time the macro is run.</p>\n\n<p>I am relatively new to VBA and am taking a course online to get better. I would appreciate any help with this. </p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576605426, "post_id": 59379640, "comment_id": 104951374, "body": "<code>For Each ws in ThisWorkbook.Worksheets</code>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1576606427, "post_id": 59379640, "comment_id": 104951839, "body": "Review the questions under &quot;Related&quot; on this page."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12546814, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBLxpRreMGjYVGzBEcUe7ZrRLwWnzDikxgUGBE2Aw=k-s128", "display_name": "Agus OZ", "link": "https://stackoverflow.com/users/12546814/agus-oz"}, "is_accepted": false, "score": 0, "last_activity_date": 1576610218, "last_edit_date": 1576610218, "creation_date": 1576609850, "answer_id": 59380655, "question_id": 59379640, "link": "https://stackoverflow.com/questions/59379640/how-do-i-get-my-vba-code-to-loop-through-all-sheets-in-workbook/59380655#59380655", "title": "How do I get my VBA Code to loop through all sheets in workbook?", "body": "<p>You should do something like this:</p>\n\n<pre><code>Sub EnteringAllSheetsOneByOne()\n    For Each ws In Excel.Workbooks(\"YourWorkbook.xlsx\").Worksheets\n        ws.Select\n        Call RemoveOldPlatforms(ws) 'must to be called here and use ws as parameter\n    Next ws\n    MsgBox \"Done!\"\nEnd Sub\n\n' Just add the \"ws\" parameter to your current sub\nSub RemoveOldPlatforms(ws As Object)\n   'Dim ws As Worksheet\n\n   'Set ws = ThisWorkbook.Worksheets(\"RAW\")\n\n    ws.Range(\"$A$1:$J$100000\").AutoFilter Field:=2, Criteria1:=Array(\"Coniferous\", \"Broafleaf\", \"Mixedwood\", \"Water\", \"Exposed Land / Barren\", \"Urban / Developed\", \"Greenhouses\", \"Shrubland\", \"Wetland\", \"Grassland\"), Operator:=xlFilterValues\n\n    ws.Range(\"$A$2:$J$100000\").SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    ws.Range(\"$A$1:$J$100000\").AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p><strong>Note:</strong> Please pay atention to all I've commented, <code>Dim</code> and <code>Set</code> in this case are not necessary</p>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 11306926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jueZb.jpg?s=128&g=1", "display_name": "Patouf", "link": "https://stackoverflow.com/users/11306926/patouf"}, "is_accepted": true, "score": 0, "last_activity_date": 1576614154, "creation_date": 1576614154, "answer_id": 59381576, "question_id": 59379640, "link": "https://stackoverflow.com/questions/59379640/how-do-i-get-my-vba-code-to-loop-through-all-sheets-in-workbook/59381576#59381576", "title": "How do I get my VBA Code to loop through all sheets in workbook?", "body": "<p>Hi pretty simple code to check every worksheets in a workbook, </p>\n\n<pre><code>Dim ws As Worksheet\n\nFor Each ws In ThisWorkbook.Worksheets\n    'called once per worsheet\nNext ws\n</code></pre>\n\n<p>Here I loop trough all the worksheet to find all tables availiable in ANOTHER workbook and display it inside a ComboBox</p>\n\n<pre><code>Private Sub UpdateTablesFromFile()\n\nDim wb As Workbook\nDim ws As Worksheet\nDim tbl As ListObject\nDim text As String\nDim I As Integer\nDim FileToOpen As String\n\nFolderPath = Application.ActiveWorkbook.Path\nFilePath = FolderPath &amp; \"\\\" &amp; ComboBox1.Value \n\nApplication.ScreenUpdating = False\nWorkbooks.Open Filename:=FilePath\n\nFor Each ws In Workbooks(ComboBox1.Value).Worksheets\n    For Each tbl In ws.ListObjects\n\n        text = ws.Name &amp; \"\\\" &amp; tbl.Name\n        ImportForm1.ComboBox2.AddItem text 'add every tables in my entire workbook inside the ComboBox2\n\n    Next tbl\nNext ws\n\nWorkbooks(ComboBox1.Value).Close SaveChanges:=False\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12553953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f584187fc3ccd0f04d5b019d43b1eac?s=128&d=identicon&r=PG&f=1", "display_name": "RockiesSkier", "link": "https://stackoverflow.com/users/12553953/rockiesskier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 59381576, "answer_count": 2, "score": -1, "last_activity_date": 1576632248, "creation_date": 1576605242, "last_edit_date": 1576632248, "question_id": 59379640, "link": "https://stackoverflow.com/questions/59379640/how-do-i-get-my-vba-code-to-loop-through-all-sheets-in-workbook", "title": "How do I get my VBA Code to loop through all sheets in workbook?", "body": "<p>I am currently using the following code to remove classifications I do not require in my tables:</p>\n\n<pre><code>Sub RemoveOldPlatforms()\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"RAW\")\n\n    ws.Range(\"$A$1:$J$100000\").AutoFilter Field:=2, Criteria1:=Array(\"Coniferous\", \"Broafleaf\", \"Mixedwood\", \"Water\", \"Exposed Land / Barren\", \"Urban / Developed\", \"Greenhouses\", \"Shrubland\", \"Wetland\", \"Grassland\"), Operator:=xlFilterValues\n\n    ws.Range(\"$A$2:$J$100000\").SpecialCells(xlCellTypeVisible).EntireRow.Delete\n    ws.Range(\"$A$1:$J$100000\").AutoFilter\n\nEnd Sub\n</code></pre>\n\n<p>As is, I am specifying a single identified worksheet, but how do I loop it through all worksheets in my workbook (20+)?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1576605225, "post_id": 59379601, "comment_id": 104951266, "body": "You can use SpecialCells for this and get a range object of all cells holding numeric values. Instead of iterating all cells."}, {"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1576605323, "post_id": 59379601, "comment_id": 104951309, "body": "Just a few typos towards the end and you need to assess the <code>.Value</code> property of the cell / range: <code>If IsNumeric(Sheet7.Range(&quot;C&quot; &amp; i).Value) Then Sheet7.Range(&quot;C&quot; &amp; i).Value = Sheet7.Range(&quot;C&quot; &amp; i).Value &amp; &quot;s&quot; Next i</code> should be alright (only a quick glance hence just a comment)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1576606513, "post_id": 59379601, "comment_id": 104951876, "body": "Watch out for <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit qualifiers</a>: <code>Sheet7.Range(...)</code> is flawless. <code>Cells(...)</code> however, isn&#39;t qualified. If that code is in some worksheet module&#39;s code-behind, then it&#39;s <code>Me.Cells</code>; if the code is anywhere else, then it&#39;s <code>ActiveSheet.Cells</code>, and when <i>whatever the active sheet is</i> isn&#39;t <i>really</i> what was <i>actually</i> intended, there&#39;s an opening for a funny bug to show its ugly head =)"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12394092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e257eed99876b9d8b41c2ea98bbf3928?s=128&d=identicon&r=PG&f=1", "display_name": "Dunkinjoes", "link": "https://stackoverflow.com/users/12394092/dunkinjoes"}, "edited": false, "score": 1, "creation_date": 1576611373, "post_id": 59379809, "comment_id": 104953892, "body": "Thanks, everyone for your input, it was very helpful. @ jsanchezs, awesome suggestion, your code works flawlessly.  Happy coding!!"}], "tags": [], "owner": {"reputation": 1602, "user_id": 5682919, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4rC18.png?s=128&g=1", "display_name": "jsanchezs", "link": "https://stackoverflow.com/users/5682919/jsanchezs"}, "is_accepted": true, "score": 0, "last_activity_date": 1576605934, "creation_date": 1576605934, "answer_id": 59379809, "question_id": 59379601, "link": "https://stackoverflow.com/questions/59379601/excel-vba-loop-through-cells-in-a-column-looking-for-integer/59379809#59379809", "title": "Excel VBA loop through cells in a column looking for integer", "body": "<p>You can use the cells indexing like this:</p>\n\n<pre><code>    Dim N As Long, i As Long, j As Long \n    N = Cells(Rows.Count, \"A\").End(xlUp).Row \n    For i = 2 To N\n        if isNumeric(Cells(i,3)) then\n            Cells(i,3) = cells(i,3) &amp; \"S\"\n        end if\n    Next\n</code></pre>\n\n<p>Where \"i\" is the row iterating in the loop, and 3 is the \"C\" column.Hope it helps you.</p>\n"}], "owner": {"reputation": 3, "user_id": 12394092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e257eed99876b9d8b41c2ea98bbf3928?s=128&d=identicon&r=PG&f=1", "display_name": "Dunkinjoes", "link": "https://stackoverflow.com/users/12394092/dunkinjoes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 59379809, "answer_count": 1, "score": 0, "last_activity_date": 1576605934, "creation_date": 1576605056, "question_id": 59379601, "link": "https://stackoverflow.com/questions/59379601/excel-vba-loop-through-cells-in-a-column-looking-for-integer", "title": "Excel VBA loop through cells in a column looking for integer", "body": "<p>I am fairly new with VBA, but I have a good understanding on how for loop and if-else statement works.  I have created a worksheet that needs to loop through the entire column of \"C\" looking for any integer.  If found, I would like to add a letter \"s\" at the end of the current cell value. I have the following, but I am guessing my syntax is incorrect.   Any pointer will be appreciated.</p>\n\n<pre><code>Dim N As Long, i As Long, j As Long\nN = Cells(Rows.Count, \"A\").End(xlUp).Row\nj = 2\nFor i = 2 To N\nIf IsNumeric(Sheet7.Range(\"C\") &amp; i) = True Then\nSheet7.Range(\"C\" &amp; i) = Sheet7.Range(\"C\" &amp; i) &amp; \"s\"\nNext i\nEnd If\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "foreach"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576606776, "post_id": 59379451, "comment_id": 104952010, "body": "<a href=\"https://stackoverflow.com/questions/49330011/determining-if-html-button-is-disabled-in-ie/49330249\" title=\"determining if html button is disabled in ie\">stackoverflow.com/questions/49330011/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 12338410, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAEk0LegYoVWfct-5pmKbV5CSWfCmThK7aC47ANaA=k-s128", "display_name": "Nick Hubers", "link": "https://stackoverflow.com/users/12338410/nick-hubers"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576608142, "post_id": 59379451, "comment_id": 104952564, "body": "Thanks, but both solutions didn&#39;t work. Some 438 error when useing the getElementById and 13 error when using the original GetElementByClassName.Dim nxt As HTMLButtonElement Set nxt = ie.document.getElementsByClassName(&quot;btn btn-primary center-block ng-binding&quot;)  If nxt.disabled Then     ie.Quit Else     nxt.Click End If"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576609878, "post_id": 59379451, "comment_id": 104953250, "body": "Your button has no id attribute, so not sure why you&#39;d use getElementById ?  I only pointed to that question as an example of how to access the disabled attribute.  Did you try accessing <code>botao.getAttribute(&quot;disabled&quot;)</code> ?"}, {"owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "edited": false, "score": 1, "creation_date": 1576616787, "post_id": 59379451, "comment_id": 104956081, "body": "If you use <i>botao.getAttribute(&quot;disabled&quot;)</i> that attribute must be there. In the html snipets I can see this attribute only in the second example wich should be the last button. If an attribute you ask for is missing you get a runtime error. So you must use <i>botao.hasAttribute(&quot;disabled&quot;)</i> I think."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1576634340, "post_id": 59379451, "comment_id": 104960663, "body": "Can you share the url?"}, {"owner": {"reputation": 3, "user_id": 12338410, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAEk0LegYoVWfct-5pmKbV5CSWfCmThK7aC47ANaA=k-s128", "display_name": "Nick Hubers", "link": "https://stackoverflow.com/users/12338410/nick-hubers"}, "edited": false, "score": 0, "creation_date": 1576745953, "post_id": 59379451, "comment_id": 105000465, "body": "I have no idea why I used the getElementById, perhaps it was some kind of logic to me. I do not have the knowledge and experience to know this. If it comes to prograrmmering which I have to do from time to time it is just copy and paste it with a lot of trial and error. I tried to learn programming, but somehow I don&#39;t get it, the language barriere I guess. On topic: At the moment I have a better solution via Power Query, which gives me the data in a table for each row(the data when you click on it) The url: <a href=\"https://sportvloeren.sport.nl/sportvloerenlijst\" rel=\"nofollow noreferrer\">sportvloeren.sport.nl/sportvloerenlijst</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12338410, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAEk0LegYoVWfct-5pmKbV5CSWfCmThK7aC47ANaA=k-s128", "display_name": "Nick Hubers", "link": "https://stackoverflow.com/users/12338410/nick-hubers"}, "edited": false, "score": 0, "creation_date": 1576748008, "post_id": 59380235, "comment_id": 105001525, "body": "I tested this one, and this did exactly what I was looking for! Thankyou for the effort!"}], "tags": [], "owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "is_accepted": true, "score": 0, "last_activity_date": 1576616420, "last_edit_date": 1576616420, "creation_date": 1576607950, "answer_id": 59380235, "question_id": 59379451, "link": "https://stackoverflow.com/questions/59379451/vba-loop-untill-disabled-is-in-the-name/59380235#59380235", "title": "VBA Loop untill &quot;disabled&quot; is in the name", "body": "<p>Many little errors in your code and I can't say any more without html code. If there are more problems it would be the best you post the url. You can try this:</p>\n\n<p>Edited: Reorder macro code [loop borders, get data, button click and IE outside loop]. Sorry, for confusion.</p>\n\n<pre><code>Option Explicit\n\nSub LaadAllePaginaenScrape()\n\n  Dim URL As String\n  Dim ie As Object\n  Dim botao As Object\n  Dim htmlEle As Object\n  Dim e As Long\n\n  e = 1\n  URL = \"Somepage\"\n\n  Set ie = CreateObject(\"InternetExplorer.Application\")\n  ie.Visible = True\n  ie.navigate URL\n  Application.StatusBar = URL &amp; \" is loading. Please wait...\"\n  Do Until ie.readyState = 4: DoEvents: Loop\n  Application.StatusBar = URL &amp; \" Loaded\"\n  Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n  Do\n    For Each htmlEle In ie.document.getElementsByClassName(\"table\")(0).getElementsByTagName(\"tr\")\n      With ActiveSheet\n        .Range(\"A\" &amp; e).Value = htmlEle.Children(0).textContent\n        .Range(\"B\" &amp; e).Value = htmlEle.Children(3).textContent\n        .Range(\"C\" &amp; e).Value = htmlEle.Children(4).textContent\n      End With\n      e = e + 1\n    Next htmlEle\n\n    Set botao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")(0)\n    botao.Click (1)\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n  Loop Until botao.hasAttribute(\"disabled\")\n\n  ie.Quit\n  Set ie = Nothing\n  Set botao = Nothing\n  Set htmlEle = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12338410, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAEk0LegYoVWfct-5pmKbV5CSWfCmThK7aC47ANaA=k-s128", "display_name": "Nick Hubers", "link": "https://stackoverflow.com/users/12338410/nick-hubers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 59380235, "answer_count": 1, "score": 0, "last_activity_date": 1576616420, "creation_date": 1576604406, "last_edit_date": 1576606586, "question_id": 59379451, "link": "https://stackoverflow.com/questions/59379451/vba-loop-untill-disabled-is-in-the-name", "title": "VBA Loop untill &quot;disabled&quot; is in the name", "body": "<p>I got the code below working, but as you can see it takes a lot of time. Because  I need to be sure that all the results are loaded. I think I am looking for a loop instead?</p>\n\n<pre><code>Sub LaadAllePaginaenScrape()\n    Dim i As Long\n    Dim URL As String\n    Dim ie As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    'Dim ieObj As InternetExplorer\n    Dim htmlEle As IHTMLElement\n    Dim e As Integer\n\ne = 1\n\nApplication.ScreenUpdating = False\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\nie.Visible = False\n\nURL = \"Somepage\"\n\nie.navigate URL\n\nApplication.StatusBar = URL &amp; \" is loading. Please wait...\"\n\nDo While ie.readyState = 4: DoEvents: Loop\nDo Until ie.readyState = 4: DoEvents: Loop\n\nApplication.StatusBar = URL &amp; \" Loaded\"\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nbotao = ie.document.getElementsByClassName(\"btn btn-primary center-block ng-binding\")\nbotao.Click (1)\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nFor Each htmlEle In ie.document.getElementsByClassName(\"table\")(0).getElementsByTagName(\"tr\")\n    With ActiveSheet\n        .Range(\"A\" &amp; e).Value = htmlEle.Children(0).textContent\n        .Range(\"B\" &amp; e).Value = htmlEle.Children(3).textContent\n        .Range(\"C\" &amp; e).Value = htmlEle.Children(4).textContent\n    End With\n\n    e = e + 1\nNext htmlEle\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The following code is been used in the VBA code to click on the specific button:</p>\n\n<pre><code>&lt;button class=\"btn btn-primary center-block ng-binding\" \n     ng-disabled=\"!lastCallHadData\" ng-click=\"addPage()\" \n     data-ajaxform-clicked=\"\"&gt;\n    &lt;span ng-show=\"loading\" \n        class=\"glyphicon glyphicon-refresh spinning ng-hide\"&gt;&lt;/span&gt; \n       Laad meer resultaten\n&lt;/button&gt;\n</code></pre>\n\n<p>But I want to loop untill the code has a disabled attribute(?) in the tag.</p>\n\n<pre><code>&lt;button class=\"btn btn-primary center-block ng-binding\" \n     ng-disabled=\"!lastCallHadData\" ng-click=\"addPage()\" \n     data-ajaxform-clicked=\"\" disabled=\"disabled\"&gt; &lt;&lt; Here you have the attribute disabled\n      &lt;span ng-show=\"loading\" \n        class=\"glyphicon glyphicon-refresh spinning ng-hide\"&gt;&lt;/span&gt; \n           Meer resultaten niet gevonden\n &lt;/button&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "is_accepted": false, "score": 0, "last_activity_date": 1576605089, "creation_date": 1576605089, "answer_id": 59379608, "question_id": 59379252, "link": "https://stackoverflow.com/questions/59379252/referring-to-a-cell-address-reference-inside-a-formula/59379608#59379608", "title": "Referring to a cell address/reference inside a formula", "body": "<p>Use the value for lastRow: <code>Range(\"E8\") = \"=MIN(C2:C\" &amp; lastRow &amp; \")\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "edited": false, "score": 0, "creation_date": 1576608560, "post_id": 59379678, "comment_id": 104952734, "body": "your suggested formula refers to the whole column C right ? because in my file, I will have to refer it from C33 to last cell that contains a text. However, Thank you for your clarification on my code, It worked as you said."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "edited": false, "score": 0, "creation_date": 1576608908, "post_id": 59379678, "comment_id": 104952876, "body": "@RayanBared. No, it does not.  It refers to <code>C2:last_cell_containing_number</code> For the suggested formula, merely change the <code>$C$2</code> to whatever cell you want for the start of the range.  I used <code>C2</code> only because that&#39;s what you used in your code."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "edited": false, "score": 0, "creation_date": 1576609154, "post_id": 59379678, "comment_id": 104952981, "body": "@RayanBared Also, in your question and comment, you write <code>contains a text</code>, but your VBA code is looking for <code>*</code>, which would match anything (text or number).  My recommended formula looks for last row containing a <code>number</code>, which should be functionally equivalent since <code>MIN</code> ignores text."}, {"owner": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "edited": false, "score": 0, "creation_date": 1576615064, "post_id": 59379678, "comment_id": 104955398, "body": "Can you explain what does 9.9+307 refer to exactly please if you don&#39;t mind. Thank you"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "edited": false, "score": 0, "creation_date": 1576617769, "post_id": 59379678, "comment_id": 104956473, "body": "@RayanBared See the Edit in my answer for an explanation of the formula."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "edited": false, "score": 0, "creation_date": 1576630340, "post_id": 59379678, "comment_id": 104959931, "body": "@RayanBared Oh, also there was a typo which I have corrected.  That should have been <b><code>9.9E+307</code></b>"}, {"owner": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "edited": false, "score": 0, "creation_date": 1576666903, "post_id": 59379678, "comment_id": 104971236, "body": "Thank you for your explanation, Much appreciated."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1576630292, "last_edit_date": 1576630292, "creation_date": 1576605353, "answer_id": 59379678, "question_id": 59379252, "link": "https://stackoverflow.com/questions/59379252/referring-to-a-cell-address-reference-inside-a-formula/59379678#59379678", "title": "Referring to a cell address/reference inside a formula", "body": "<p>It's not how I would do this, but :</p>\n\n<pre><code>Range(\"E8\") _\n    = \"=MIN(C2:\" &amp; LC &amp; \")\" 'The MIN function\nEnd If\n</code></pre>\n\n<p>and, in your code, since LC is a string and not an object, be sure to remove the <code>Set</code> word.</p>\n\n<p>That, of course, puts a static formula into <code>E8</code>.</p>\n\n<p>So, if column <code>C</code> changes (more data added below LC, for example), you'll need to rewrite the formula to the worksheet.</p>\n\n<p>If you prefer a formula that automagically adjusts to changing numbers of rows in column C, you can use:</p>\n\n<pre><code>=MIN(INDEX($C$2:INDEX($C:$C,LOOKUP(9.9E+307,$C:$C,ROW($C:$C))),0,1))\n</code></pre>\n\n<p><strong>Edit</strong>: <em>(Explanation of the formula)</em></p>\n\n<p>The formula uses a feature of the <code>LOOKUP</code> function to find the last row. When <code>lookup_value</code> is greater than any value in <code>lookup_array</code>, <code>LOOKUP</code> will match the last value in <code>lookup_array</code>.  Since we are using the optional <code>result_vector</code> argument, <code>LOOKUP</code> returns the value in the matching position which is that row number.</p>\n\n<p>By using a very large number as lookup_value, one that is close to the maximum number allowed in Excel, we assure that there will not be a larger number in <code>lookup_array</code></p>\n\n<p>We then use the <code>INDEX</code> function to create an array that begins with <code>C2</code> (or whatever you put in for a starting cell) and ends and <code>Cn</code> where <code>n</code> is the row number returned by the <code>LOOKUP</code> function.</p>\n"}], "owner": {"reputation": 37, "user_id": 12499441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18cabedf53125beb6ad0edcfb35250a2?s=128&d=identicon&r=PG&f=1", "display_name": "Rayan Bared", "link": "https://stackoverflow.com/users/12499441/rayan-bared"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59379678, "answer_count": 2, "score": 2, "last_activity_date": 1576630292, "creation_date": 1576603594, "last_edit_date": 1576604572, "question_id": 59379252, "link": "https://stackoverflow.com/questions/59379252/referring-to-a-cell-address-reference-inside-a-formula", "title": "Referring to a cell address/reference inside a formula", "body": "<p>I want to refer to the last cell that contains a text by its address (ex, C800) inside the MIN function. Can you help please? </p>\n\n<pre><code>Sub Set_Formula()\n' -----------------------------\n\nDim lastRow As Long\nDim Lastcell As Range\nDim LC As String\n\nSet Lastcell = Range(\"C:C\").Find(\"*\", Range(\"C1\"), SearchDirection:=xlPrevious)\nSet LC = Lastcell.Address()\n\n'find last cell in the row\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\nDim r As Long\nFor r = 2 To lastRow\n    If (Cells(r, 3).Value &lt;&gt; \"\") Then \n        Range(\"E8\") _\n        = \"=MIN(C2:LC)\" 'The MIN function \n    End If\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576600203, "post_id": 59378304, "comment_id": 104948922, "body": "Are you sure that you have correct formats?"}, {"owner": {"reputation": 1249, "user_id": 9014183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130f92b641d6d10b005bde89dc4a48b5?s=128&d=identicon&r=PG&f=1", "display_name": "Royce", "link": "https://stackoverflow.com/users/9014183/royce"}, "reply_to_user": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1576600437, "post_id": 59378304, "comment_id": 104949043, "body": "I updated my question with formats used."}, {"owner": {"reputation": 114, "user_id": 11106493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/467b2ed419ae538a9068c066d83b01f7?s=128&d=identicon&r=PG&f=1", "display_name": "Nuri", "link": "https://stackoverflow.com/users/11106493/nuri"}, "edited": false, "score": 1, "creation_date": 1576600495, "post_id": 59378304, "comment_id": 104949075, "body": "This seems like a formatting issue. When I try the formula you gave, I get 4.13 (days) then I simply multiply it with 24 and get 99."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1576600537, "post_id": 59378304, "comment_id": 104949096, "body": "<a href=\"https://support.office.com/en-us/article/add-or-subtract-time-16aa6697-6d6e-49c1-8e2c-3398a7cad6ad\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 3, "last_activity_date": 1576600746, "creation_date": 1576600746, "answer_id": 59378538, "question_id": 59378304, "link": "https://stackoverflow.com/questions/59378304/difference-between-two-datetime-with-excel-formula/59378538#59378538", "title": "Difference between two datetime with Excel formula", "body": "<p>As mentioned <a href=\"https://support.office.com/en-us/article/add-or-subtract-time-16aa6697-6d6e-49c1-8e2c-3398a7cad6ad\" rel=\"nofollow noreferrer\">here</a>, use a custom format: <code>[h]:mm;@</code>. In your case you want <code>[hh]:mm:ss;@</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/wVKGy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wVKGy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1249, "user_id": 9014183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/130f92b641d6d10b005bde89dc4a48b5?s=128&d=identicon&r=PG&f=1", "display_name": "Royce", "link": "https://stackoverflow.com/users/9014183/royce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 59378538, "answer_count": 1, "score": 0, "last_activity_date": 1577376582, "creation_date": 1576599873, "last_edit_date": 1576600360, "question_id": 59378304, "link": "https://stackoverflow.com/questions/59378304/difference-between-two-datetime-with-excel-formula", "title": "Difference between two datetime with Excel formula", "body": "<p>I have 4 columns : <code>Date1, Time1, Date2, Time2</code>.</p>\n\n<p>My objective is to know the time difference between two datetime in format <code>hh:mm:ss</code>.</p>\n\n<p>Some examples :</p>\n\n<pre><code>Date1       | Time1    | Date2      | Time2    | ExpectedResult\n12/11/2019  | 12:00:00 | 16/11/2019 | 15:00:00 | 99:00:00\n10/11/2019  | 11:10:00 | 10/11/2019 | 12:09:15 | 00:59:15\n...\n</code></pre>\n\n<p>With VBA there is no problem. However, is it possible to do it wihtout VBA but with a formula? Thank you.</p>\n\n<p><strong>Format</strong></p>\n\n<p><code>Date1</code> and <code>Date2</code> have the format : <code>*14/03/2012</code></p>\n\n<p><code>Time1</code>, <code>Time2</code> and <code>ExpectedResult</code> have the format : <code>hh:mm:ss</code></p>\n\n<p><strong>Already tried</strong></p>\n\n<pre><code>=(Date2+Time2)-(Date1+Time1)\n</code></pre>\n\n<p>But the result is <code>03:00:00</code>. Days are not present.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 390, "user_id": 6784072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iY9Ty.jpg?s=128&g=1", "display_name": "Lukyanov Mikhail", "link": "https://stackoverflow.com/users/6784072/lukyanov-mikhail"}, "edited": false, "score": 0, "creation_date": 1576671572, "post_id": 59379296, "comment_id": 104973538, "body": "Thanks, the working solution is <code>Sub select4() &#39; &#39; select4 Macro &#39; &#39;     ActiveDocument.Tables(1).Select     ActiveDocument.Range(Start:=Selection.End, End:=Selection.End).InsertBreak _          Type:=wdSectionBreakNextPage     Selection.PageSetup.Orientation = wdOrientLandscape End Sub</code>"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 390, "user_id": 6784072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iY9Ty.jpg?s=128&g=1", "display_name": "Lukyanov Mikhail", "link": "https://stackoverflow.com/users/6784072/lukyanov-mikhail"}, "edited": false, "score": 0, "creation_date": 1576681147, "post_id": 59379296, "comment_id": 104978665, "body": "Yes, that&#39;s a condensation of my answer. If you found my input helpful, please upvote it, thanks."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 1, "last_activity_date": 1576603747, "creation_date": 1576603747, "answer_id": 59379296, "question_id": 59378261, "link": "https://stackoverflow.com/questions/59378261/change-orientation-pages-only-where-a-table-is/59379296#59379296", "title": "Change orientation pages only where a table is", "body": "<p>As when you use the Word interface, a page orientation change requires the addition of section breaks at the beginning and end of the rotated portion. Word's macro recorder can be informative. After deleting some less useful page setup properties:</p>\n\n<pre><code>ActiveDocument.Range(Start:=Selection.Start, End:=Selection.Start).InsertBreak Type:=wdSectionBreakNextPage\nSelection.Start = Selection.Start + 1\nActiveDocument.Range(Start:=Selection.End, End:=Selection.End).InsertBreak Type:=wdSectionBreakNextPage\nWith Selection.PageSetup\n    .Orientation = wdOrientLandscape\n    .TopMargin = CentimetersToPoints(1.27)\n    .BottomMargin = CentimetersToPoints(1.27)\n    .LeftMargin = CentimetersToPoints(1.27)\n    .RightMargin = CentimetersToPoints(1.27)\n    .Gutter = CentimetersToPoints(0)\n    .HeaderDistance = CentimetersToPoints(0.63)\n    .FooterDistance = CentimetersToPoints(0.63)\n    .PageWidth = CentimetersToPoints(27.94)\n    .PageHeight = CentimetersToPoints(21.59)\n    .SectionStart = wdSectionNewPage\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 390, "user_id": 6784072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iY9Ty.jpg?s=128&g=1", "display_name": "Lukyanov Mikhail", "link": "https://stackoverflow.com/users/6784072/lukyanov-mikhail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 59379296, "answer_count": 1, "score": 0, "last_activity_date": 1576613608, "creation_date": 1576599722, "last_edit_date": 1576613608, "question_id": 59378261, "link": "https://stackoverflow.com/questions/59378261/change-orientation-pages-only-where-a-table-is", "title": "Change orientation pages only where a table is", "body": "<p>My table goes beyond the borders of the page, I want to change the orientation of the pages where the table is located, but the orientation of all pages of the document is changing. The table is selected normally, but then the orientation of the entire document changes.</p>\n\n<pre><code>Sub slect1()\n'\n' slect1 Macro\n'\n'\nActiveDocument.Tables(1).Select\nSelection.PageSetup.Orientation = wdOrientLandscape\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "opencsv"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1576599476, "post_id": 59378141, "comment_id": 104948574, "body": "can you show code?"}, {"owner": {"reputation": 17, "user_id": 9360923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81bbe7373af2b103c1c86140a0ffdfd?s=128&d=identicon&r=PG", "display_name": "Danhadnagy", "link": "https://stackoverflow.com/users/9360923/danhadnagy"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576663178, "post_id": 59378141, "comment_id": 104969303, "body": "I added the code but it must be capacity problem or just another black hole in the microsoft universe"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1576663839, "post_id": 59378141, "comment_id": 104969617, "body": "remove this line <code>On Error Resume Next</code> and you&#39;l find out about the error.  Also, reference the workbook you are opening so <code>set w=workbooks.open(...</code> then in this line <code>Range(&quot;A1&quot;, Range(&quot;A1&quot;).End(xlDown)).Rows.Count</code> you can make sure you&#39;re on the correct book and sheet"}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 9360923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81bbe7373af2b103c1c86140a0ffdfd?s=128&d=identicon&r=PG", "display_name": "Danhadnagy", "link": "https://stackoverflow.com/users/9360923/danhadnagy"}, "is_accepted": false, "score": -1, "last_activity_date": 1576668403, "creation_date": 1576668403, "answer_id": 59391044, "question_id": 59378141, "link": "https://stackoverflow.com/questions/59378141/losing-data-through-csv-file-opening-loop-vba/59391044#59391044", "title": "Losing data through csv file opening loop vba", "body": "<p>I just had to change last and newraw variable to long.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1577132839, "creation_date": 1577132839, "answer_id": 59460987, "question_id": 59378141, "link": "https://stackoverflow.com/questions/59378141/losing-data-through-csv-file-opening-loop-vba/59460987#59460987", "title": "Losing data through csv file opening loop vba", "body": "<p>Can you try it like this and feedback?</p>\n\n<pre><code>Option Explicit\n\n#If VBA7 Then\n    Private Declare PtrSafe Function OpenProcess Lib \"kernel32\" _\n        (ByVal dwDesiredAccess As Long, _\n        ByVal bInheritHandle As Long, _\n        ByVal dwProcessId As Long) As Long\n\n    Private Declare PtrSafe Function GetExitCodeProcess Lib \"kernel32\" _\n        (ByVal hProcess As Long, _\n        lpExitCode As Long) As Long\n#Else\n    Private Declare Function OpenProcess Lib \"kernel32\" _\n        (ByVal dwDesiredAccess As Long, _\n        ByVal bInheritHandle As Long, _\n        ByVal dwProcessId As Long) As Long\n\n    Private Declare Function GetExitCodeProcess Lib \"kernel32\" _\n        (ByVal hProcess As Long, _\n        lpExitCode As Long) As Long\n#End If\n\n\nPublic Const PROCESS_QUERY_INFORMATION = &amp;H400\nPublic Const STILL_ACTIVE = &amp;H103\n\n\nPublic Sub ShellAndWait(ByVal PathName As String, Optional WindowState)\n    Dim hProg As Long\n    Dim hProcess As Long, ExitCode As Long\n    'fill in the missing parameter and execute the program\n    If IsMissing(WindowState) Then WindowState = 1\n    hProg = Shell(PathName, WindowState)\n    'hProg is a \"process ID under Win32. To get the process handle:\n    hProcess = OpenProcess(PROCESS_QUERY_INFORMATION, False, hProg)\n    Do\n        'populate Exitcode variable\n        GetExitCodeProcess hProcess, ExitCode\n        DoEvents\n    Loop While ExitCode = STILL_ACTIVE\nEnd Sub\n\n\nSub Merge_CSV_Files()\n    Dim BatFileName As String\n    Dim TXTFileName As String\n    Dim XLSFileName As String\n    Dim FileExtStr As String\n    Dim FileFormatNum As Long\n    Dim DefPath As String\n    Dim Wb As Workbook\n    Dim oApp As Object\n    Dim oFolder\n    Dim foldername\n\n    'Create two temporary file names\n    BatFileName = Environ(\"Temp\") &amp; _\n            \"\\CollectCSVData\" &amp; Format(Now, \"dd-mm-yy-h-mm-ss\") &amp; \".bat\"\n    TXTFileName = Environ(\"Temp\") &amp; _\n            \"\\AllCSV\" &amp; Format(Now, \"dd-mm-yy-h-mm-ss\") &amp; \".txt\"\n\n    'Folder where you want to save the Excel file\n    DefPath = Application.DefaultFilePath\n    If Right(DefPath, 1) &lt;&gt; \"\\\" Then\n        DefPath = DefPath &amp; \"\\\"\n    End If\n\n    'Set the extension and file format\n    If Val(Application.Version) &lt; 12 Then\n        'You use Excel 97-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007 or higher\n        FileExtStr = \".xlsx\": FileFormatNum = 51\n        'If you want to save as xls(97-2003 format) in 2007 use\n        'FileExtStr = \".xls\": FileFormatNum = 56\n    End If\n\n    'Name of the Excel file with a date/time stamp\n    XLSFileName = DefPath &amp; \"MasterCSV \" &amp; _\n                  Format(Now, \"dd-mmm-yyyy h-mm-ss\") &amp; FileExtStr\n\n    'Browse to the folder with CSV files\n    Set oApp = CreateObject(\"Shell.Application\")\n    Set oFolder = oApp.BrowseForFolder(0, \"Select folder with CSV files\", 512)\n    If Not oFolder Is Nothing Then\n        foldername = oFolder.Self.Path\n        If Right(foldername, 1) &lt;&gt; \"\\\" Then\n            foldername = foldername &amp; \"\\\"\n        End If\n\n        'Create the bat file\n        Open BatFileName For Output As #1\n        Print #1, \"Copy \" &amp; Chr(34) &amp; foldername &amp; \"*.csv\" _\n                &amp; Chr(34) &amp; \" \" &amp; TXTFileName\n        Close #1\n\n        'Run the Bat file to collect all data from the CSV files into a TXT file\n        ShellAndWait BatFileName, 0\n        If Dir(TXTFileName) = \"\" Then\n            MsgBox \"There are no csv files in this folder\"\n            Kill BatFileName\n            Exit Sub\n        End If\n\n        'Open the TXT file in Excel\n        Application.ScreenUpdating = False\n        Workbooks.OpenText Filename:=TXTFileName, Origin:=xlWindows, StartRow _\n                :=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _\n                ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=False, Comma:=True, _\n                Space:=False, Other:=False\n\n        'Save text file as a Excel file\n        Set Wb = ActiveWorkbook\n        Application.DisplayAlerts = False\n        Wb.SaveAs Filename:=XLSFileName, FileFormat:=FileFormatNum\n        Application.DisplayAlerts = True\n\n        Wb.Close savechanges:=False\n        MsgBox \"You find the Excel file here: \" &amp; vbNewLine &amp; XLSFileName\n\n        'Delete the bat and text file you temporary used\n        Kill BatFileName\n        Kill TXTFileName\n\n        Application.ScreenUpdating = True\n    End If\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win021.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win021.htm</a></p>\n"}], "owner": {"reputation": 17, "user_id": 9360923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c81bbe7373af2b103c1c86140a0ffdfd?s=128&d=identicon&r=PG", "display_name": "Danhadnagy", "link": "https://stackoverflow.com/users/9360923/danhadnagy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1577132839, "creation_date": 1576599226, "last_edit_date": 1576663794, "question_id": 59378141, "link": "https://stackoverflow.com/questions/59378141/losing-data-through-csv-file-opening-loop-vba", "title": "Losing data through csv file opening loop vba", "body": "<p>I got CSV dataset every day from 5 partners after 8PM. The files are in the same structure, the range of the size 4- 130 KB in the same folder. I want to merge all files to one by macro, the today result is days from 10-15th are missing. Data of 16th (the last day) are good. When I run the macro for only one partner, I get full result. What can be the problem?</p>\n\n<pre><code>Dim MyFolder As String\nDim MyFile As String\nDim last As Integer\nDim newrow As Integer\nDim sh As Worksheet\nDim name As String\nDim name2 As String\nDim myYear As Variant\nDim myMonth As Variant\n\nSheets(\"Munka1\").Select\nname = ActiveWorkbook.name\n\nScreenUpdating = False\nRange(Cells(2, 1), Cells(300000, 200)).Select\nSelection.Clear\nCells(2, 1).Select\n\n\nMyFolder = \"InputFolder\"\nMyFile = Dir(MyFolder &amp; \"\\FILE_*\" &amp; \"*.csv\")\n\nDo While MyFile &lt;&gt; \"\"\nWorkbooks.Open Filename:=MyFolder &amp; \"\\\" &amp; MyFile, Local:=True\nname2 = ActiveWorkbook.name\nOn Error Resume Next\n\nRange(Cells(2, 1), Cells(3000, 11)).Select\nSelection.Copy\n\nWindows(name).Activate\nCells(newrow, 1).Select\nActiveSheet.Paste\n\nlast= Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\nnewrow = last + 1\n\nApplication.CutCopyMode = False\nWindows(name2).Close savechanges:=False\n\nMyFile = Dir\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1576599732, "post_id": 59378035, "comment_id": 104948714, "body": "<code>.previous.width</code>"}, {"owner": {"reputation": 33, "user_id": 12553043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3f4045c726a62fbc1544348446edc1?s=128&d=identicon&r=PG&f=1", "display_name": "schraubedrin", "link": "https://stackoverflow.com/users/12553043/schraubedrin"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1576601314, "post_id": 59378035, "comment_id": 104949493, "body": "Thank you! Although this isn&#39;t quite the correct answer, you led me to it: <code>testRange1.Previous.ColumnWidth</code> it is.  If you post it as an answer, i can accept it and close the question."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1576633924, "post_id": 59378035, "comment_id": 104960591, "body": "<code>But now i&#39;m really curious as to where those hidden columns store the width to which they will be restored.</code> Your question is where is the value <b>Stored</b>. I answered that. The value is <b>not</b> stored in <code>testRange1.Previous.ColumnWidth</code>.  That piece of code that you gave <b>retrieves</b> the value stored :)"}, {"owner": {"reputation": 33, "user_id": 12553043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3f4045c726a62fbc1544348446edc1?s=128&d=identicon&r=PG&f=1", "display_name": "schraubedrin", "link": "https://stackoverflow.com/users/12553043/schraubedrin"}, "edited": false, "score": 0, "creation_date": 1576661494, "post_id": 59378035, "comment_id": 104968471, "body": "I understand, thanks for clarifying :) That&#39;s what happens when an engineer tries to program."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12553043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3f4045c726a62fbc1544348446edc1?s=128&d=identicon&r=PG&f=1", "display_name": "schraubedrin", "link": "https://stackoverflow.com/users/12553043/schraubedrin"}, "edited": false, "score": 0, "creation_date": 1576601439, "post_id": 59378459, "comment_id": 104949560, "body": "Thank you for this detailed answer. I didn&#39;t know that you can look into excel files this way.    But @Nathan_Sav&#39;s answer is what i actually looked for."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 33, "user_id": 12553043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3f4045c726a62fbc1544348446edc1?s=128&d=identicon&r=PG&f=1", "display_name": "schraubedrin", "link": "https://stackoverflow.com/users/12553043/schraubedrin"}, "edited": false, "score": 0, "creation_date": 1576634197, "post_id": 59378459, "comment_id": 104960634, "body": "No worries :) Feel free to go with that answer."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1576600843, "last_edit_date": 1576600843, "creation_date": 1576600466, "answer_id": 59378459, "question_id": 59378035, "link": "https://stackoverflow.com/questions/59378035/column-width-property-on-hidden-columns/59378459#59378459", "title": "Column width property on hidden columns", "body": "<p><code>But now i'm really curious as to where those hidden columns store the width to which they will be restored.</code> </p>\n\n<p>They are stored in the xml file which can be accessed by renaming the .xlsx file to .zip and then going to the sheet.xml in the <code>xl\\worksheets\\</code> folder inside the zip file</p>\n\n<p>Let's do a small test. Create a blank excel file. And then change the width of the 1st column to 1.22(18 pixels). Change the 4th column's width to 5.89(60 pixels).</p>\n\n<p><a href=\"https://i.stack.imgur.com/46Ff8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/46Ff8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Save the file as say <code>C:\\book1.xlsx</code>.</p>\n\n<p>Rename the file from <code>book1.xlsx</code> to <code>book1.zip</code> and open it say in Winzip (<em>I am using winzip. You can use any other program</em>). Go to <code>xl\\worksheets\\</code> folder as shown below</p>\n\n<p><a href=\"https://i.stack.imgur.com/CrotL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CrotL.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you open the xml file you will notice the widths stored there for the 1st and 4th column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/l4lms.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l4lms.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Another test</strong></p>\n\n<p>Rename the file back to xlsx. Now hide column A:F. as shown below</p>\n\n<p><a href=\"https://i.stack.imgur.com/f3sdZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f3sdZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now see what the xml file has :)</p>\n\n<p><a href=\"https://i.stack.imgur.com/lzs5N.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lzs5N.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1576602227, "creation_date": 1576602227, "answer_id": 59378923, "question_id": 59378035, "link": "https://stackoverflow.com/questions/59378035/column-width-property-on-hidden-columns/59378923#59378923", "title": "Column width property on hidden columns", "body": "<p>You could use the <code>.previous.width</code> properties of the range, so</p>\n\n<p><code>set r=range(\"a1\")\ndebug.? r.previous.width</code></p>\n\n<p>Would show.</p>\n"}], "owner": {"reputation": 33, "user_id": 12553043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3f4045c726a62fbc1544348446edc1?s=128&d=identicon&r=PG&f=1", "display_name": "schraubedrin", "link": "https://stackoverflow.com/users/12553043/schraubedrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59378923, "answer_count": 2, "score": 3, "last_activity_date": 1576602227, "creation_date": 1576598907, "last_edit_date": 1576599094, "question_id": 59378035, "link": "https://stackoverflow.com/questions/59378035/column-width-property-on-hidden-columns", "title": "Column width property on hidden columns", "body": "<p>Where is a hidden column storing its columnwidth value?</p>\n\n<p>I've already found out that <code>testRange1.ColumnWidth = 0</code>\nis the same as <code>testRange2.EntireColumn.Hidden = True</code>.\nAnd grouping is similar too:</p>\n\n<pre><code>testRange3.Columns.Group\nActiveWorksheet.Outline.ShowLevels columnlevels:=1\n</code></pre>\n\n<p>The result in all three cases is:</p>\n\n<pre><code>debug.Print testRange1.ColumnWidth\n 0 \ndebug.Print testRange2.ColumnWidth\n 0 \ndebug.Print testRange3.ColumnWidth\n 0 \n</code></pre>\n\n<p>Unhiding the columns or expanding the group restores the original <code>ColumnWidth</code> (Much to my dismay).</p>\n\n<p>But now i'm really curious as to where those hidden columns store the width to which they will be restored.\nSetting the width to something obvious bevore hiding the column and then searching through the properties in the debug window, i couldn't find it anywhere.</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576625264, "post_id": 59377944, "comment_id": 104958865, "body": "Set subform DateEntry property to Yes."}, {"owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576632456, "post_id": 59377944, "comment_id": 104960329, "body": "And can I make the same subform to show me the datas when I tell it to open it in read only mode by pressing button 2. Because when I make the data entry property of subform to yes then after clicking button 2 which tells it to show in readonly it shows me a blank subform, zero data."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576636701, "post_id": 59377944, "comment_id": 104961068, "body": "Sorry, should have been more explicit: Use VBA to programmatically set the DataEntry property to True or False."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576637280, "post_id": 59377944, "comment_id": 104961185, "body": "Do you want the form opened as a subform in both cases?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576640495, "post_id": 59377944, "comment_id": 104961761, "body": "So what is code behind buttons to open main form? Edit your question."}, {"owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1576648696, "post_id": 59377944, "comment_id": 104963490, "body": "Sorry I am using a macro to open the main form. How can I use VBA to programmatically set the data Entry property of the subform to True Or False based on buttons pressed. Please guide me."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "edited": false, "score": 0, "creation_date": 1576835025, "post_id": 59387097, "comment_id": 105032367, "body": "I am getting error if I am pass the value like this:        DoCmd.OpenForm &quot;FrmGeneXpertAdd&quot;, , , &quot;PatientID = &quot; &amp; PatientID, , , , , , &quot;btnRegister&quot;"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "edited": false, "score": 0, "creation_date": 1576843364, "post_id": 59387097, "comment_id": 105035962, "body": "What error? Did you change DataEntry line to also use string &quot;btnRegister&quot;? Don&#39;t use filter criteria for button that should open form for DataEntry True."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1576653212, "creation_date": 1576653212, "answer_id": 59387097, "question_id": 59377944, "link": "https://stackoverflow.com/questions/59377944/form-and-subform/59387097#59387097", "title": "Form and subform", "body": "<p>One way to accomplish is to use OpenArgs.</p>\n\n<p>Code in Button1.</p>\n\n<p><code>DoCmd.OpenForm \"YourMainFormName\",,,,,,\"Button1\"</code></p>\n\n<p>Code in Button2.</p>\n\n<p><code>DoCmd.OpenForm \"YourMainFormName\",,,,,,\"Button2\"</code></p>\n\n<p>Code in main form Load event.  </p>\n\n<p><code>Me.YourSubformContainerName.Form.DataEntry = IIf(Me.OpenArgs = \"Button1\", True, False)</code></p>\n"}], "owner": {"reputation": 9, "user_id": 12213096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22457f5320ed207f3c113f4c863a2857?s=128&d=identicon&r=PG&f=1", "display_name": "pal", "link": "https://stackoverflow.com/users/12213096/pal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 59387097, "answer_count": 1, "score": 0, "last_activity_date": 1593762017, "creation_date": 1576598586, "last_edit_date": 1593762017, "question_id": 59377944, "link": "https://stackoverflow.com/questions/59377944/form-and-subform", "title": "Form and subform", "body": "<p>How can I set a subform to open in data entry mode when opened by pressing button 1 from another form and open the same subform in view mode when pressed button 2. Right now not only the subform but the main form also goes into data entry mode. So how can I make the subform to change based on the buttons pressed.</p>\n"}, {"tags": ["excel", "vba", "copy", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "edited": false, "score": 0, "creation_date": 1576600187, "post_id": 59378013, "comment_id": 104948912, "body": "L. Scott Johnson is right to recommend whole columns for the lookup range. In this formula, the lookup range <code>J:L</code> is all of columns J, K, and L. Whole columns is the easiest way to write a VLOOKUP formula. Another common problem with writing a VLOOKUP formula is understanding that the <code>3</code> in this formula means the third column of the lookup range (not an offset of 3 columns). Another common problem is understanding that <code>FALSE</code> means an exact match."}], "tags": [], "owner": {"reputation": 3545, "user_id": 2183547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dd540edd4677da5281d4331bf835f51?s=128&d=identicon&r=PG", "display_name": "L. Scott Johnson", "link": "https://stackoverflow.com/users/2183547/l-scott-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1576673155, "last_edit_date": 1576673155, "creation_date": 1576598804, "answer_id": 59378013, "question_id": 59377926, "link": "https://stackoverflow.com/questions/59377926/how-to-copy-data-from-one-cell-to-another-depending-on-the-cell-next-to-it/59378013#59378013", "title": "How to copy data from one cell to another - depending on the cell next to it?", "body": "<p>In the group of columns, J:L, L is the fourth column, so use 4 in VLOOKUP:</p>\n\n<p>Formula for C3:</p>\n\n<pre><code>=VLOOKUP($B3,$J:L,3,FALSE)\n</code></pre>\n\n<p>D3 is the same, but with 4 instead of 3 to get M.</p>\n\n<p>If you want to get fancy and have the formula copy nicely across columns, you can use the COLUMN() function to help calculate the 3s and 4s:</p>\n\n<p>Formula for C3: </p>\n\n<pre><code>=VLOOKUP($B3,$J:L,COLUMN(L3)-COLUMN($J3)+1,FALSE)\n</code></pre>\n\n<p>Then when you copy that from C3 to D3, the L becomes M and the column calculation produces 4 instead of 3.</p>\n"}], "owner": {"reputation": 3, "user_id": 12553340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-807xxIu5Deo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcCWaxvbu9sEm_yTy_thIKyZH846A/photo.jpg?sz=128", "display_name": "Jo Reggelt", "link": "https://stackoverflow.com/users/12553340/jo-reggelt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 59378013, "answer_count": 1, "score": 0, "last_activity_date": 1579888372, "creation_date": 1576598523, "last_edit_date": 1579888372, "question_id": 59377926, "link": "https://stackoverflow.com/questions/59377926/how-to-copy-data-from-one-cell-to-another-depending-on-the-cell-next-to-it", "title": "How to copy data from one cell to another - depending on the cell next to it?", "body": "<p>I'm trying to:<br>\nIn cell C3, search Column J to find an identical match of B3, then copy the data from Lx.<br>\nIn cell D3, Search Column J to find an identical match of B3, then copy the data from Mx. </p>\n\n<p>There are 10285 rows of data. </p>\n\n<p><a href=\"https://i.stack.imgur.com/UG1BA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UG1BA.png\" alt=\"My current problem!\"></a></p>\n\n<p>I have tried several IF and VLOOKUP statements. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576597501, "post_id": 59377633, "comment_id": 104947507, "body": "Side note: use <code>Long</code> instead of <code>Integer</code>. Excel has more rows than <code>Integer</code> can handle."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576597546, "post_id": 59377633, "comment_id": 104947527, "body": "<code>Worksheets(&quot;Sheet 1&quot;).Range(&quot;B1:I&quot; &amp; LastRow).Copy</code>."}, {"owner": {"reputation": 21, "user_id": 11875801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f4d0d7a38d7c101331a21c2dfdfc83?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/11875801/jay"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576598007, "post_id": 59377633, "comment_id": 104947790, "body": "Thanks on the Long vs Integer tip @BigBen however I still get a run-time &#39;1004&#39; error when I try to run it in another sheet"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576598061, "post_id": 59377633, "comment_id": 104947817, "body": "See my second comment."}, {"owner": {"reputation": 21, "user_id": 11875801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f4d0d7a38d7c101331a21c2dfdfc83?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/11875801/jay"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576601203, "post_id": 59377633, "comment_id": 104949427, "body": "@bigben This works! Thank you!"}], "owner": {"reputation": 21, "user_id": 11875801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23f4d0d7a38d7c101331a21c2dfdfc83?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/11875801/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576597370, "creation_date": 1576597370, "question_id": 59377633, "link": "https://stackoverflow.com/questions/59377633/copy-and-paste-middle-range-down-to-last-row-into-another", "title": "Copy and Paste middle range down to last row into another", "body": "<p>I am trying to copy only Sheet 1 columns B-I in a sheet with data in columns A-K, but only until the last row and paste it into Sheet 2 Cell A4. I then want to paste this information in another sheet. I have the following line of code set however this only works when I am in SHEET 1 and have cell B1 selected (i'm sure this is because of the selection line i grabbed from the recorded macro). I want to be able to run the code without activating the sheet to speed up the code. How can this be done?</p>\n\n<p>Code below:</p>\n\n<pre><code>Worksheets(\"Sheet 1\").Range(\"B1:I1\", Selection.End(xlDown)).copy Worksheets(\"Sheet 2\").Range(\"A4\")\n</code></pre>\n\n<p>I've Dim'd LastRow already based on the information in sheet 3 to use in sheet 1. This LastRow would be the same LastRow as Sheet1. </p>\n\n<p>Code as follows:</p>\n\n<pre><code>Dim LastRow As Integer\nLastRow = ThisWorkbook.Sheets(\"Sheet 3\").Cells(Rows.Count, 1).End(xlUp).Row\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1576596953, "post_id": 59377489, "comment_id": 104947206, "body": "Highly suggest you give <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this question</a> a read. Also suggest avoiding <code>ActiveSheet.Paste</code>."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1576598099, "post_id": 59377489, "comment_id": 104947837, "body": "You want <code>Range(cells(cell.Row, 6), cells(cell.Row, 17))</code> not <code>Range(cell(cell.Row, 6), cell(cell.Row, 17))</code>"}, {"owner": {"reputation": 31, "user_id": 2471416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3757a234be5acd4a8c3e2eeb92fa5a?s=128&d=identicon&r=PG", "display_name": "user2471416", "link": "https://stackoverflow.com/users/2471416/user2471416"}, "edited": false, "score": 0, "creation_date": 1576598434, "post_id": 59377489, "comment_id": 104948014, "body": "This was it thanks! any idea why cell was so far off while cells worked perfectly?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1576598643, "post_id": 59377489, "comment_id": 104948125, "body": "If you use <code>Cell</code> instead of <code>Cells</code>, you are offsetting <i>from each cell</i>, rather than using an absolute position on the sheet. So if <code>cell.row</code> is 4, then <code>Cell(cell.row, 1)</code> is actually 3 rows below that (since <code>Cell(1, 1)</code> is the Cell itself)"}, {"owner": {"reputation": 31, "user_id": 2471416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3757a234be5acd4a8c3e2eeb92fa5a?s=128&d=identicon&r=PG", "display_name": "user2471416", "link": "https://stackoverflow.com/users/2471416/user2471416"}, "edited": false, "score": 0, "creation_date": 1576603204, "post_id": 59377489, "comment_id": 104950363, "body": "Didn&#39;t know that. Thanks for the info."}], "owner": {"reputation": 31, "user_id": 2471416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a3757a234be5acd4a8c3e2eeb92fa5a?s=128&d=identicon&r=PG", "display_name": "user2471416", "link": "https://stackoverflow.com/users/2471416/user2471416"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576596917, "creation_date": 1576596879, "last_edit_date": 1576596917, "question_id": 59377489, "link": "https://stackoverflow.com/questions/59377489/why-does-my-paste-end-up-2x-1-rows-further-down-than-it-should", "title": "Why does my paste end up 2x-1 rows further down than it should?", "body": "<p>I was given a project where I need to run some logic before copying and pasting information based on the following. The logic works fine but the issue I'm running into is that no matter what I do I can't get the pastes to occur in the correct spot. Theyre 2x-1 in the current setup. I kept thinking that it has something to do with cell.row but all of my trial, error, and testing has shown no results. If anyone has any ideas I'd be grateful. Changing all of the cell.Row to ((cell.Row+1)/2) doesn't work either.</p>\n\n<p>i.e.\nwere on row 12 and the case is 0. instead of pasting to row 12 it pastes to row 23. for each subsequent row it will paste 2 rows down instead of 1 making the next row 25, and so on.</p>\n\n<pre><code>Sub CopyClass()\n'\n' Macro2 Macro\n'\n    Dim rng As Range, cell As Range\n    Set rng = Range(\"B12:B250\")\n'\n\n    For Each cell In rng\n\n    Select Case cell\n    Case Is = 0\n        cell(7, 2).Select\n        Selection.Copy\n        cell(cell.Row, 2).Select\n        ActiveSheet.Paste\n        Range(\"G7:R7\").Select\n        Selection.Copy\n        Range(cell(cell.Row, 6), cell(cell.Row, 17)).Select\n        ActiveSheet.Paste\n    Case Is = 1\n        cell(8, 2).Select\n        Selection.Copy\n        cell(cell.Row, 2).Select\n        ActiveSheet.Paste\n        Range(\"G8:R8\").Select\n        Selection.Copy\n        Range(cell(cell.Row, 6), cell(cell.Row, 17)).Select\n        ActiveSheet.Paste\n    Case Is = 2\n        If InStr(cell(cell.Row, 5), \"IRA\") &gt; 0 Then\n            cell(10, 18).Select\n            Selection.Copy\n            cell(cell.Row, 2).Select\n            ActiveSheet.Paste\n            cell(9, 18).Select\n            Selection.Copy\n            cell(cell.Row, 6).Select\n            ActiveSheet.Paste\n            Range(\"H9:R9\").Select\n            Selection.Copy\n            Range(cell(cell.Row, 7), cell(cell.Row, 17)).Select\n            ActiveSheet.Paste\n        Else\n            cell(10, 19).Select\n            Selection.Copy\n            cell(cell.Row, 2).Select\n            ActiveSheet.Paste\n            cell(9, 19).Select\n            Selection.Copy\n            cell(cell.Row, 6).Select\n            ActiveSheet.Paste\n            Range(\"H9:R9\").Select\n            Selection.Copy\n            Range(cell(cell.Row, 7), cell(cell.Row, 17)).Select\n            ActiveSheet.Paste\n        End If\n    Case Else\n        cell(10, 2).Select\n        Selection.Copy\n        cell(cell.Row, 2).Select\n        ActiveSheet.Paste\n        Range(\"G10:R10\").Select\n        Selection.Copy\n        Range(cell(cell.Row, 6), cell(cell.Row, 17)).Select\n        ActiveSheet.Paste\n    End Select\n\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1576595739, "post_id": 59377118, "comment_id": 104946513, "body": "Either one of the workbook name is incorrect or the worksheet name is incorrect"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1576595799, "post_id": 59377118, "comment_id": 104946548, "body": "Create individual objects for workbook and worksheet. This way you will be able to narrow down which is incorrect."}, {"owner": {"reputation": 1, "user_id": 12553131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDD5_JnSWjX2X3_xhpEwpSSrrZ98o_vSoEZOP0O=k-s128", "display_name": "Nimish Ojale", "link": "https://stackoverflow.com/users/12553131/nimish-ojale"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1576597100, "post_id": 59377118, "comment_id": 104947296, "body": "Thanks for the reply @SiddharthRout! I tried this, and the code is giving em the error while defining the source sheet. This error persists even when I changed the Sheet name in the code and the file to &quot;Sheet1&quot;."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1576601277, "post_id": 59377118, "comment_id": 104949471, "body": "Workbooks(&quot;SAP Open Sales Orders with SWB Details.xlsx&quot;) is <b><i>Open</i></b>, right?"}, {"owner": {"reputation": 1, "user_id": 12553131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDD5_JnSWjX2X3_xhpEwpSSrrZ98o_vSoEZOP0O=k-s128", "display_name": "Nimish Ojale", "link": "https://stackoverflow.com/users/12553131/nimish-ojale"}, "edited": false, "score": 0, "creation_date": 1578419999, "post_id": 59377118, "comment_id": 105429598, "body": "Yes, both the workbooks are open."}], "owner": {"reputation": 1, "user_id": 12553131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDD5_JnSWjX2X3_xhpEwpSSrrZ98o_vSoEZOP0O=k-s128", "display_name": "Nimish Ojale", "link": "https://stackoverflow.com/users/12553131/nimish-ojale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1576595579, "creation_date": 1576595579, "question_id": 59377118, "link": "https://stackoverflow.com/questions/59377118/getting-a-subscript-out-of-range-error-for-a-simple-range-copy-line-what-am-i", "title": "Getting a &quot;Subscript out of range&quot; error for a simple Range.Copy line. What am I doing wrong?", "body": "<p>My code looks like this:</p>\n\n<pre><code>Sub Copy_all_OpenSO()\n\nWorkbooks(\"SAP Open Sales Orders with SWB Details.xlsx\").Worksheets(\"SAP Open Sales Orders with SWB\").Range(\"A2:CH10000\").Copy _\nDestination:=Workbooks(\"SAP Open Sales Orders with SWB.xlsm\").Worksheets(\"SAP Open Sales Orders with SWB\").Range(\"A2\")\n\nEnd Sub\n</code></pre>\n\n<p>I read a few answers on similar errors, but still unable to sort this one out. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1576598577, "post_id": 59377109, "comment_id": 104948087, "body": "<code>Application.GetOpenFileName</code>"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1576620078, "post_id": 59377109, "comment_id": 104957382, "body": "Cross-posted at: <a href=\"https://www.mrexcel.com/board/threads/editing-word-doc-using-excel-vba.1118161/\" rel=\"nofollow noreferrer\">mrexcel.com/board/threads/&hellip;</a>. For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12553091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc22354ee830dcfd88cff827e4092f64?s=128&d=identicon&r=PG&f=1", "display_name": "newtotheforum2019", "link": "https://stackoverflow.com/users/12553091/newtotheforum2019"}, "edited": false, "score": 0, "creation_date": 1576611242, "post_id": 59379026, "comment_id": 104953833, "body": "Yes, thats exactly right. Does a function exist where the user can select the file by clicking through windows explorer as opposed to typing the path?"}], "tags": [], "owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "is_accepted": false, "score": 0, "last_activity_date": 1576602631, "creation_date": 1576602631, "answer_id": 59379026, "question_id": 59377109, "link": "https://stackoverflow.com/questions/59377109/select-word-doc-using-excel-vba/59379026#59379026", "title": "Select Word Doc using Excel VBA", "body": "<p>Do you want the user to input the name of a Word file? Do you want the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.inputbox\" rel=\"nofollow noreferrer\">InputBox</a> method?</p>\n\n<pre><code>    Dim strWord As String\n    strWord = InputBox(prompt:=\"Type the file path and name of the Word file.\", title:=\"Which file?\", default:=\"C:\\Path\\File.docx\")\n    Set wd = wdApp.Documents.Open(strWord)\n</code></pre>\n\n<p>Tell me if I didn't understand your question.</p>\n"}], "owner": {"reputation": 1, "user_id": 12553091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc22354ee830dcfd88cff827e4092f64?s=128&d=identicon&r=PG&f=1", "display_name": "newtotheforum2019", "link": "https://stackoverflow.com/users/12553091/newtotheforum2019"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584393817, "creation_date": 1576595562, "last_edit_date": 1584393817, "question_id": 59377109, "link": "https://stackoverflow.com/questions/59377109/select-word-doc-using-excel-vba", "title": "Select Word Doc using Excel VBA", "body": "<p>I want to create Excel VBA code that asks the user to open a pre-existing Word document with text form fields and input existing Excel data in these form fields.</p>\n\n<p>I have code that writes the Excel data into the Word text form field.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub NewMacro()    \n\n    Dim wdApp As Object, wd As Object, ac As Long, ws As Worksheet\n\n    Set ws = Sheets(\"Tables\")\n\n    On Error Resume Next\n\n    Set wdApp = GetObject(, \"Word.Application\")\n\n    If Err.Number &lt;&gt; 0 Then\n        Set wdApp = CreateObject(\"Word.Application\")\n    End If\n\n    On Error GoTo 0\n\n    Set wd = wdApp.Documents.Open(\"C:\\Test\\Test.docx\")\n\n    wdApp.Visible = True\n\n    With wd\n        .FormFields(\"CustomerName\").Result = ws.Range(\"D4\").Value\n    End With\n\n    Set wd = Nothing\n\n    Set wdApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I am lost as to converting the <code>Set wd= wdApp.Documents.Open(\"FilePath\")</code> line into a dialog box.</p>\n\n<p>Does a function exist where the user can select the file by clicking through Windows Explorer as opposed to typing the path?</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 1198506, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f0c3eeb16409bf2dbe33e5b5ec5ee540?s=128&d=identicon&r=PG", "display_name": "syphon228", "link": "https://stackoverflow.com/users/1198506/syphon228"}, "is_accepted": false, "score": 1, "last_activity_date": 1576597020, "creation_date": 1576597020, "answer_id": 59377535, "question_id": 59377064, "link": "https://stackoverflow.com/questions/59377064/outlook-vba-not-updating-follow-up-flag/59377535#59377535", "title": "Outlook VBA not updating follow up flag", "body": "<p>I figured it out, I need to save the mail object:</p>\n\n<p>objItem.FlagRequest = flagString\nobjItem.Save</p>\n"}], "owner": {"reputation": 149, "user_id": 1198506, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/f0c3eeb16409bf2dbe33e5b5ec5ee540?s=128&d=identicon&r=PG", "display_name": "syphon228", "link": "https://stackoverflow.com/users/1198506/syphon228"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576599113, "creation_date": 1576595403, "last_edit_date": 1576599113, "question_id": 59377064, "link": "https://stackoverflow.com/questions/59377064/outlook-vba-not-updating-follow-up-flag", "title": "Outlook VBA not updating follow up flag", "body": "<p>I am currently experiencing an issue where my Outlook VBA code is not updating the follow up flag on emails in my Outlook view. What is interesting is when I check the assignment it seems to be updating correctly. Below is my code for reference:</p>\n\n<pre><code>Sub RemoveDuplicateItems()\n    Dim objFolder As Folder\n    Dim objDictionary As Object\n    Dim i As Long\n    Dim objItem As Object\n    Dim strKey As String\n\n    Set objDictionary = CreateObject(\"scripting.dictionary\")\n    'Select a source folder\n    Set objFolder = Outlook.Application.Session.PickFolder\n\n    If Not (objFolder Is Nothing) Then\n       For i = objFolder.Items.Count To 1 Step -1\n           Set objItem = objFolder.Items.Item(i)\n\n           Select Case objFolder.DefaultItemType\n                  'Check email subject, body and sent time\n                  Case olMailItem\n                       strKey = objItem.Subject\n                       'MsgBox \"Looking at: \" + strKey + \", Flag is: \" + objItem.FlagRequest\n                       strKey = Replace(strKey, \"RE: \", \"\")\n                       strKey = Replace(strKey, \"Re: \", \"\")\n                       strKey = Replace(strKey, \"FW: \", \"\")\n           End Select\n\n           'Remove the duplicate items\n           If objDictionary.Exists(strKey) = True Then\n              If objDictionary(strKey).SentOn &lt;= objItem.SentOn Then\n                   flagString = objDictionary(strKey).FlagRequest\n                   objDictionary(strKey).Delete\n                   objDictionary.Remove strKey\n                   If flagString &lt;&gt; \"Follow Up\" And flagString &lt;&gt; \"\" Then\n                        objItem.FlagRequest = flagString\n                   End If\n                   'MsgBox \"Stored flag: \" + objItem.FlagRequest\n                   objDictionary.Add strKey, objItem\n\n              Else\n                    If objItem.FlagRequest &lt;&gt; \"Follow Up\" And objItem.FlagRequest &lt;&gt; \"\" Then\n                        objDictionary(strKey).FlagRequest = objItem.FlagRequest\n                    End If\n                    objItem.Delete\n              End If\n           Else\n              objDictionary.Add strKey, objItem\n           End If\n       Next i\n    End If\n    Set objMsg = Nothing\n    Set objItem = Nothing\n    Set objDictionary = Nothing\n    Set objFolder = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": true, "score": 1, "last_activity_date": 1576595894, "creation_date": 1576595894, "answer_id": 59377191, "question_id": 59376908, "link": "https://stackoverflow.com/questions/59376908/access-get-latest-date-if-column-contains-value-from-another-one/59377191#59377191", "title": "Access - Get latest date if column contains value from another one", "body": "<p>If you want a query that returns your expected results, you can join the table and the query with the use of the operator <code>LIKE</code>:</p>\n\n<pre><code>SELECT q.UnpairEquipment AS Equipment, MAX([Last Inspection]) AS [Latest Date]\nFROM qryunpair AS q INNER JOIN tbldata AS t\nON '-' + t.Equipment + '-' LIKE '*-' +  q.UnpairEquipment + '-*'\nGROUP BY q.UnpairEquipment\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>Equipment   Latest Date\n402         2019-06-29\n413         2019-12-12\n420         2019-12-12\n433         2019-06-15\n440         2019-06-15\n483         2019-06-29\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12552966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a45cab7e052501771eadcf7a28fe61?s=128&d=identicon&r=PG&f=1", "display_name": "michaelnoze08", "link": "https://stackoverflow.com/users/12552966/michaelnoze08"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 59377191, "answer_count": 1, "score": 0, "last_activity_date": 1576596182, "creation_date": 1576594823, "last_edit_date": 1576596182, "question_id": 59376908, "link": "https://stackoverflow.com/questions/59376908/access-get-latest-date-if-column-contains-value-from-another-one", "title": "Access - Get latest date if column contains value from another one", "body": "<p>I'm having an issue with a VBA function for my query in Access.<br/>\nI have a table \"<strong>tbldata</strong>\"</p>\n\n<pre><code>Equipment   Last Inspection\n420-413     2019-06-15\n440-433     2019-06-15\n402-483     2019-06-29\n420-413     2019-12-12\n</code></pre>\n\n<p>and a query \"<strong>qryunpair</strong>\"</p>\n\n<pre><code>UnpairEquipment\n420 \n413 \n440 \n433 \n402 \n483 \n</code></pre>\n\n<p>What I'm trying to achieve is:</p>\n\n<pre><code>Equipment Latest Date\n420       2019-12-12\n413       2019-12-12\n440       2019-06-15\n433       2019-06-15\n402       2019-06-29\n483       2019-06-29\n</code></pre>\n\n<p>I've made the following code, but when I ran it, it didn't return any values.\nIs there a solution to this?</p>\n\n<pre><code>Function typeinspection(Source As String) As String\nDim Rst As Recordset\nDim Rst2 As Recordset\nDim s As String\n    s = \"\"\n    Set Rst = CurrentDb.OpenRecordset(\"tbldata\")\n    Set Rst2 = CurrentDb.OpenRecordset(\"qryunpair\")\n    While Not Rst.EOF\n\n        If InStr(Source, Rst2.Fields(\"UnpairEquipment\") &gt; 0) Then _\n            s = Rst.Fields(\"Last Inspection\")\n        Rst.MoveNext\n    Wend\n\n    Set Rst = Nothing\n    Set Rst2 = Nothing\n    typeinspection = s\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576594678, "post_id": 59376853, "comment_id": 104945957, "body": "<code>LastRow</code> is a <code>Long</code>, not a <code>Range</code>. You can&#39;t select <code>7</code> or <code>234</code> or <code>339232</code> for example. Perhaps you are looking to use <code>Cells(LastRow, lcol)</code>?"}, {"owner": {"reputation": 37, "user_id": 12187275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59c8322aae0c3f8bc8400596ff565c8?s=128&d=identicon&r=PG&f=1", "display_name": "G_TTI", "link": "https://stackoverflow.com/users/12187275/g-tti"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576594808, "post_id": 59376853, "comment_id": 104946029, "body": "Hi @BigBen, let me try!"}, {"owner": {"reputation": 37, "user_id": 12187275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59c8322aae0c3f8bc8400596ff565c8?s=128&d=identicon&r=PG&f=1", "display_name": "G_TTI", "link": "https://stackoverflow.com/users/12187275/g-tti"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576594956, "post_id": 59376853, "comment_id": 104946106, "body": "It works great! many thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 11306926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jueZb.jpg?s=128&g=1", "display_name": "Patouf", "link": "https://stackoverflow.com/users/11306926/patouf"}, "is_accepted": false, "score": 0, "last_activity_date": 1576613125, "creation_date": 1576613125, "answer_id": 59381360, "question_id": 59376853, "link": "https://stackoverflow.com/questions/59376853/dynamic-range-creation/59381360#59381360", "title": "Dynamic range creation", "body": "<p>Seems like an agrument is missing on your code. Here is the code for create a new table that contains all filled cells in the current sheet</p>\n\n<pre><code>    Dim LastRow As Long\n    Dim LastColumn As Long\n    Dim NewTableRange As Range\n\n'1st you need to find your last row &amp; column\n    LastRow = ActiveSheet.Cells(ActiveSheet.Rows.Count, StartCell.Column).End(xlUp).row\n\n   LastColumn = ActiveSheet.Cells(StartCell.row, ActiveSheet.Columns.Count).End(xlToLeft).Column\n\n'2nd you set the need table range   \n    Set NewTableRange = ActiveSheet.Range(StartCell, ActiveSheet.Cells(LastRow, LastColumn))\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12187275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59c8322aae0c3f8bc8400596ff565c8?s=128&d=identicon&r=PG&f=1", "display_name": "G_TTI", "link": "https://stackoverflow.com/users/12187275/g-tti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1576613125, "creation_date": 1576594624, "last_edit_date": 1576595002, "question_id": 59376853, "link": "https://stackoverflow.com/questions/59376853/dynamic-range-creation", "title": "Dynamic range creation", "body": "<p>I am trying to create a variable reference for a dynamic range. My code is below. \nAll seems working fine besides the last line  <code>Range(startcells, Lastrow).Select</code>, which returns an error of \"method of range and object required\". Any idea why?</p>\n\n<p>I think there is a problem on how I define the lastrow... because if I select the startcells alone it works.</p>\n\n<pre><code>Sub colvar()\n\n  ' select the entire column\n   Dim lcol As Integer\n   lcol = Sheets(\"A\").Range(\"B1\").Value\n   Sheets(\"B\").Activate\n\n   Dim Lastrow As Long, i As Long, startcells As Range\n   Lastrow = Cells(Rows.Count, lcol).End(xlUp).Row\n   i = 6\n   Set startcells = Cells(i, lcol)\n\n   'startcells.Select\n    Range(startcells, Lastrow).Select\n\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "function"], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1576596911, "creation_date": 1576596911, "answer_id": 59377497, "question_id": 59376771, "link": "https://stackoverflow.com/questions/59376771/addtion-to-exciting-function-sumcellsbycolor/59377497#59377497", "title": "Addtion to exciting function SumCellsByColor", "body": "<p>There are many different ways of doing this but the easiest I can think of would be:</p>\n\n<pre><code>Function SumCellsByColor(rData As Range, cellRefColor As Range, column_offset As Long, TextToMatch As String)\n    Dim indRefColor As Long\n    Dim cellCurrent As Range\n    Dim sumRes\n\n    Application.Volatile\n    sumRes = 0\n    indRefColor = cellRefColor.Cells(1, 1).Interior.Color\n    For Each cellCurrent In rData\n        If indRefColor = cellCurrent.Interior.Color And cellCurrent.Offset(0, column_offset).Value = TextToMatch Then\n            sumRes = WorksheetFunction.Sum(cellCurrent, sumRes)\n        End If\n    Next cellCurrent\n\n    SumCellsByColor = sumRes\nEnd Function\n</code></pre>\n\n<p>You would then call it in your example with:</p>\n\n<pre><code>=SumCellsByColor(G$2:G$95;$C111,-3,\"MJE\")\n</code></pre>\n\n<p>Where column D is 3 to the left of column G, ie. offset -3.</p>\n"}], "owner": {"reputation": 1, "user_id": 10396394, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213052035402841/picture?type=large", "display_name": "mmm1992", "link": "https://stackoverflow.com/users/10396394/mmm1992"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576596911, "creation_date": 1576594366, "last_edit_date": 1576594422, "question_id": 59376771, "link": "https://stackoverflow.com/questions/59376771/addtion-to-exciting-function-sumcellsbycolor", "title": "Addtion to exciting function SumCellsByColor", "body": "<p>Thanks for a great forum. I have a question concerning an existing code (not my own). The code itself works perfectly for the purpose, but now I need some additional and I can\u2019t figure out how to get it to work. The original code can be seen below. </p>\n\n<p>I need the function to be able to have another criteria. I need the code to be able to only sum if colmn D is true given an input. Something like IF cells(x;x) = \u201cMJE\u201d then\u2026 \nI hope it make sense otherwise please fell free to ask questions.  </p>\n\n<pre><code>Function SumCellsByColor(rData As Range, cellRefColor As Range)\n    Dim indRefColor As Long\n    Dim cellCurrent As Range\n    Dim sumRes\n\n    Application.Volatile\n    sumRes = 0\n    indRefColor = cellRefColor.Cells(1, 1).Interior.Color\n    For Each cellCurrent In rData\n        If indRefColor = cellCurrent.Interior.Color Then\n            sumRes = WorksheetFunction.Sum(cellCurrent, sumRes)\n        End If\n    Next cellCurrent\n\n    SumCellsByColor = sumRes\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ZhrHS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZhrHS.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1576594154, "post_id": 59376686, "comment_id": 104945683, "body": "What&#39;s the text of run-time error 91, and what line does it appear on?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1576594518, "post_id": 59376686, "comment_id": 104945872, "body": "If you are looking at a specific cell, you don&#39;t need to <code>.find()</code>.  <code>If Range(&quot;L1&quot;).Value &lt;= Now() Then</code> woudl suffice."}, {"owner": {"reputation": 15, "user_id": 7545788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f7a37feb204f75ac98358143f69a6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Counter", "link": "https://stackoverflow.com/users/7545788/j-counter"}, "edited": false, "score": 0, "creation_date": 1576594993, "post_id": 59376686, "comment_id": 104946122, "body": "Runtimeerror is happening on this bit of code <code>If FoundCell = (&quot;&lt;= Today&quot;) Then</code>"}, {"owner": {"reputation": 15, "user_id": 7545788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f7a37feb204f75ac98358143f69a6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Counter", "link": "https://stackoverflow.com/users/7545788/j-counter"}, "edited": false, "score": 0, "creation_date": 1576595348, "post_id": 59376686, "comment_id": 104946320, "body": "Using the If range bypasses the runtimeerrror however it won&#39;t run the module 1 just bypasses that line of code."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1576595673, "post_id": 59376960, "comment_id": 104946479, "body": "Or just <code>Module1.nextweek</code>"}, {"owner": {"reputation": 15, "user_id": 7545788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f7a37feb204f75ac98358143f69a6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Counter", "link": "https://stackoverflow.com/users/7545788/j-counter"}, "edited": false, "score": 0, "creation_date": 1576595924, "post_id": 59376960, "comment_id": 104946632, "body": "Genius Cyril. Thank you so much"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 15, "user_id": 7545788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f7a37feb204f75ac98358143f69a6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Counter", "link": "https://stackoverflow.com/users/7545788/j-counter"}, "edited": false, "score": 0, "creation_date": 1576596531, "post_id": 59376960, "comment_id": 104946968, "body": "@J.Counter if this resolved your issue, please mark as answered (check mark left of my response).  That will get this off of the &quot;unanswered&quot; questions list to help more folks get the help they need!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 2, "last_activity_date": 1576594995, "creation_date": 1576594995, "answer_id": 59376960, "question_id": 59376686, "link": "https://stackoverflow.com/questions/59376686/run-a-subroutine-if-a-cells-date-is-after-today/59376960#59376960", "title": "Run a subroutine if a cell&#39;s date is after today", "body": "<p>Will move my comment to an answer.</p>\n\n<hr>\n\n<p>If you are looking at a specific cell, you don't need to .find(). If Range(\"L1\").Value &lt;= Now() Then would suffice.</p>\n\n<p>You may also need to check that <code>L1</code> is in fact a date, so you would use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/isdate-function\" rel=\"nofollow noreferrer\">IsDate</a> to check.</p>\n\n<p>Third point, don't use activate... you can just qualify the <code>Sheets()</code> for the cell reference.</p>\n\n<p>Mock-up of your code with above changes (untested):</p>\n\n<pre><code>Dim DateCell As Range\nSet DateCell = Sheets(\"HAULAGE PLANNER\").Range(\"L1\")\nIf Not IsDate(DateCell.Value) Then Exit Sub\nIf DateCell.Value &lt;= Now() Then Application.Run(\"Module1.nextweek\")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7545788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca6f7a37feb204f75ac98358143f69a6?s=128&d=identicon&r=PG&f=1", "display_name": "J.Counter", "link": "https://stackoverflow.com/users/7545788/j-counter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 59376960, "answer_count": 1, "score": 0, "last_activity_date": 1576594995, "creation_date": 1576594067, "last_edit_date": 1576594282, "question_id": 59376686, "link": "https://stackoverflow.com/questions/59376686/run-a-subroutine-if-a-cells-date-is-after-today", "title": "Run a subroutine if a cell&#39;s date is after today", "body": "<p>Im trying to get some vba code to run if cell l1's date has already passed. However im am getting a run time error 91.\nThe code i am using is as follows but something is not quite right with the variables which unfortunately despite my efforts i cannot solve.</p>\n\n<pre><code>Sheets(\"HAULAGE PLANNER\").Activate\nDim FoundCell As Object\n\nSet FoundCell = Range(\"L1\").Find(what:=Date)\n\n    If FoundCell = (\"&lt;= Today\") Then\n\n   Run.Module1.nextweek\n\n    Else: Exit Sub\n   End If\nEnd Sub\n</code></pre>\n"}]