[{"tags": ["database", "vba", "date", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6042165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79bd85f6c9dd3e1d5ee581f435d6fce9?s=128&d=identicon&r=PG&f=1", "display_name": "rammpeth", "link": "https://stackoverflow.com/users/6042165/rammpeth"}, "edited": false, "score": 0, "creation_date": 1457571317, "post_id": 35905098, "comment_id": 59471571, "body": "Thanks, I tweaked it a bit to work within VBA but more importantly is Im understanding the logic behind. Ill test it out further. Thanks"}], "tags": [], "owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "is_accepted": true, "score": 0, "last_activity_date": 1457567991, "creation_date": 1457567991, "answer_id": 35905098, "question_id": 35904926, "link": "https://stackoverflow.com/questions/35904926/access-sql-how-to-select-dates-after-today-if-current-year-else-select-all-dat/35905098#35905098", "title": "Access SQL: How to select dates after today if current year, else select all dates", "body": "<p>You can do it with straight logic;</p>\n\n<pre><code>    select monto from cupones where (year(fechapago) = year(date() and (month(fechapago) &gt; month(date()) or (month(fechapago) == month(date() and day(fechapago) &gt; day(date()))( or (year(fechapago()) &gt; year(date()))\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6042165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79bd85f6c9dd3e1d5ee581f435d6fce9?s=128&d=identicon&r=PG&f=1", "display_name": "rammpeth", "link": "https://stackoverflow.com/users/6042165/rammpeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 35905098, "answer_count": 1, "score": 0, "last_activity_date": 1457567991, "creation_date": 1457567071, "last_edit_date": 1457567884, "question_id": 35904926, "link": "https://stackoverflow.com/questions/35904926/access-sql-how-to-select-dates-after-today-if-current-year-else-select-all-dat", "title": "Access SQL: How to select dates after today if current year, else select all dates", "body": "<p>Im working on a query where if the records in a table are from the current year, i need only to select records whose day and month are equal or greater than the current date. Otherwise (if the year is greater) I need to select all dates.</p>\n\n<p>I was thinking of using the iif function or conditions on the where clause but im not close at at all. </p>\n\n<p>For example </p>\n\n<pre><code>SELECT IFF(YEAR(FECHAPAGO) = YEAR(DATE()), MONTO WHERE MONTH(FECHAPAGO) &gt;= MONTH(DATE), MONTO) FROM CUPONES\n</code></pre>\n\n<p>or</p>\n\n<pre><code>SELECT MONTO FROM CUPONES WHERE IF YEAR(FECHAPAGO) = YEAR(DATE()) ... \n</code></pre>\n\n<p>I apologize if im not being clear enough but im having trouble putting it to words. If any clarification is needed Ill be happy to rephrase my question.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1457564533, "post_id": 35904198, "comment_id": 59469178, "body": "First, <code>Name</code> is probably a protected word, so rename your variable to something like <code>SName</code>.  Second, since you copy the Template Sheet to the end, try replacing <code>ActiveSheet.Name = SName</code> with <code>Sheets(Sheets.Count).Name = SName</code>"}, {"owner": {"reputation": 657, "user_id": 4052227, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh4.googleusercontent.com/-ayQSJ7XAJWE/AAAAAAAAAAI/AAAAAAAACCQ/5i65DQBsNUY/photo.jpg?sz=128", "display_name": "J.D. Ray", "link": "https://stackoverflow.com/users/4052227/j-d-ray"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1457564841, "post_id": 35904198, "comment_id": 59469290, "body": "Using <code>Sheets(Sheets.Count).Name = SName</code> throws an error: <code>Runtime error &#39;1004&#39;: Application-defined or object-defined error</code>"}], "answers": [{"tags": [], "owner": {"reputation": 657, "user_id": 4052227, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh4.googleusercontent.com/-ayQSJ7XAJWE/AAAAAAAAAAI/AAAAAAAACCQ/5i65DQBsNUY/photo.jpg?sz=128", "display_name": "J.D. Ray", "link": "https://stackoverflow.com/users/4052227/j-d-ray"}, "is_accepted": false, "score": 0, "last_activity_date": 1457566017, "creation_date": 1457566017, "answer_id": 35904720, "question_id": 35904198, "link": "https://stackoverflow.com/questions/35904198/duplicating-sheets-in-excel/35904720#35904720", "title": "Duplicating Sheets in Excel", "body": "<p>It turns out I was causing my own problem.</p>\n\n<p>In order to ensure that the user doesn't modify the template worksheet, I had it hidden.  Duplicating it was also duplicating the <code>.Visible</code> property setting, so the sheets were actually getting duplicated, but since they weren't visible, the last sheet in the book that was visible was getting selected, and therefore the one getting renamed.</p>\n\n<p>I updated the code with some error checking so canceling the input box doesn't cause problems.  Here's the working code.</p>\n\n<pre><code>Sub AddSOW()\n    Dim SName As String\n\n    SName = InputBox(\"SOW Name\")\n    ' Duplicate the template sheet\n    If SName &lt;&gt; \"\" Then\n        Worksheets(\"Template\").Visible = True\n        Worksheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n        ActiveSheet.Name = SName\n        Worksheets(\"Template\").Visible = False\n        Sheets(\"Dashboard\").Select\n        ' Find the last row of data\n        FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n        ' Loop through each row\n        For x = 2 To FinalRow\n            ' Decide if to copy based on column A\n            ThisValue = Cells(x, 1).Value\n            If ThisValue = \"Template\" Then\n                Cells(x, 1).Resize(1, 50).Copy\n                NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n                Cells(NextRow, 1).Select\n                ActiveSheet.Paste\n                ActiveCell.Value = SName\n            End If\n        Next x\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 657, "user_id": 4052227, "user_type": "registered", "accept_rate": 81, "profile_image": "https://lh4.googleusercontent.com/-ayQSJ7XAJWE/AAAAAAAAAAI/AAAAAAAACCQ/5i65DQBsNUY/photo.jpg?sz=128", "display_name": "J.D. Ray", "link": "https://stackoverflow.com/users/4052227/j-d-ray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457566017, "creation_date": 1457563521, "last_edit_date": 1457564205, "question_id": 35904198, "link": "https://stackoverflow.com/questions/35904198/duplicating-sheets-in-excel", "title": "Duplicating Sheets in Excel", "body": "<p>I'm trying to construct a spreadsheet to track project data, with a worksheet for each project and an overview sheet that provides summary information.  I constructed a sheet based on a sample set of projects, and it all seems to work the way I expected.  Adding a new project takes a lot of care and feeding, though, so I decided to give the user a button to click, a dialog to ask for a project name, and let the script do the rest.</p>\n\n<p>I created a template sheet (conveniently titled \"Template\"), and I've attempted to script duplication of that sheet to the end of the workbook using the <code>Worksheets(\"Name\").Copy</code> method as suggested on MSDN.  This attempt is reflected in the first few lines of code below.  After that I take a template row and add it to the end of the list on the overview sheet (named \"Dashboard\").</p>\n\n<p>What ends up happening (as far as I can tell) is that the sheet doesn't copy, the last sheet in the workbook gets selected, and <code>ActiveSheet.Name = Name</code> ends up renaming it, blowing up my dashboard sheet that uses <code>INDIRECT</code> to find and represent data.</p>\n\n<p>Here's the code I currently have (inefficient as it is):</p>\n\n<pre><code>Sub AddSOW()\n    ' Duplicate the template sheet\n    Dim Name As String\n    Name = InputBox(\"SOW Name\")\n    Worksheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n    ActiveSheet.Name = Name\n\n\n    Sheets(\"Dashboard\").Select\n    ' Find the last row of data\n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n    ' Loop through each row\n    For x = 2 To FinalRow\n        ' Decide if to copy based on column A\n        ThisValue = Cells(x, 1).Value\n        If ThisValue = \"Template\" Then\n            Cells(x, 1).Resize(1, 50).Copy\n            NextRow = Cells(Rows.Count, 1).End(xlUp).Row + 1\n            Cells(NextRow, 1).Select\n            ActiveSheet.Paste\n            ActiveCell.Value = Name\n        End If\n    Next x\nEnd Sub\n</code></pre>\n\n<p>No errors get thrown, it just doesn't work.  Stepping through doesn't help either.</p>\n"}, {"tags": ["sql-server", "vba", "ssis", "vpn", "openvpn"], "comments": [{"owner": {"reputation": 2126, "user_id": 232589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MV9Xi.png?s=128&g=1", "display_name": "Ricardo C", "link": "https://stackoverflow.com/users/232589/ricardo-c"}, "edited": false, "score": 0, "creation_date": 1457563739, "post_id": 35904106, "comment_id": 59468827, "body": "umm.. see the last line &quot;askpass login.txt&quot; ? I think... search your computer for that text file where you should find the username and password... I think... maybe ;)"}, {"owner": {"reputation": 817, "user_id": 3800000, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/55e48e9d21744feacfdab6e06b0d80ef?s=128&d=identicon&r=PG&f=1", "display_name": "Lambo", "link": "https://stackoverflow.com/users/3800000/lambo"}, "reply_to_user": {"reputation": 2126, "user_id": 232589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MV9Xi.png?s=128&g=1", "display_name": "Ricardo C", "link": "https://stackoverflow.com/users/232589/ricardo-c"}, "edited": false, "score": 0, "creation_date": 1457564214, "post_id": 35904106, "comment_id": 59469037, "body": "@Ricardo C There was no that line before and I had to copy and paste my password to a black prompt window every time. So I created that file and it only contains a password (learned that from someone else from other website). Thanks for your comment:)"}, {"owner": {"reputation": 2126, "user_id": 232589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MV9Xi.png?s=128&g=1", "display_name": "Ricardo C", "link": "https://stackoverflow.com/users/232589/ricardo-c"}, "edited": false, "score": 0, "creation_date": 1457565100, "post_id": 35904106, "comment_id": 59469416, "body": "&quot;my password&quot; you said? as in my windows password? man, it sounds like your OpenVPN is using Active directory for the authentication. This being the case you username and password is no other but the one you use to logon into your computer, your windows username and password."}, {"owner": {"reputation": 817, "user_id": 3800000, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/55e48e9d21744feacfdab6e06b0d80ef?s=128&d=identicon&r=PG&f=1", "display_name": "Lambo", "link": "https://stackoverflow.com/users/3800000/lambo"}, "reply_to_user": {"reputation": 2126, "user_id": 232589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MV9Xi.png?s=128&g=1", "display_name": "Ricardo C", "link": "https://stackoverflow.com/users/232589/ricardo-c"}, "edited": false, "score": 0, "creation_date": 1457569994, "post_id": 35904106, "comment_id": 59471176, "body": "Oh, sorry it&#39;s not really &quot;my password&quot;. It is just a password to login OpenVPN and totally different one. Sorry about my misleading statement"}, {"owner": {"reputation": 1294, "user_id": 3584553, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0847303778bc764e001e7a5b6d48b588?s=128&d=identicon&r=PG&f=1", "display_name": "SebTHU", "link": "https://stackoverflow.com/users/3584553/sebthu"}, "edited": false, "score": 0, "creation_date": 1458041312, "post_id": 35904106, "comment_id": 59671411, "body": "The SO question/answer you linked to uses a different VPN tool (judging by the code, something called RASDIAL).  So the parameters being used there are not relevant if you intend to use OpenVPN.  Have you checked the docs for OpenVPN for command-line options?  Is there a way to launch it while specifying a config file?  If you can get that far, then Shell-ing that command-line in an SSIS Script Task will work, leaving you with the problem of entering a password.  Please update the question with any further info."}, {"owner": {"reputation": 817, "user_id": 3800000, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/55e48e9d21744feacfdab6e06b0d80ef?s=128&d=identicon&r=PG&f=1", "display_name": "Lambo", "link": "https://stackoverflow.com/users/3800000/lambo"}, "reply_to_user": {"reputation": 1294, "user_id": 3584553, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0847303778bc764e001e7a5b6d48b588?s=128&d=identicon&r=PG&f=1", "display_name": "SebTHU", "link": "https://stackoverflow.com/users/3584553/sebthu"}, "edited": false, "score": 0, "creation_date": 1458080005, "post_id": 35904106, "comment_id": 59697560, "body": "@SebTHU thanks for your response. Here is the doc I found in OpenVPN <a href=\"https://www.dropbox.com/s/18x67l2atlpvi29/openvpn.8.html?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/s/18x67l2atlpvi29/openvpn.8.html?dl=0</a> . I&#39;m not sure where I should be looking at. Can you have a look at this please? Thanks"}, {"owner": {"reputation": 1294, "user_id": 3584553, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0847303778bc764e001e7a5b6d48b588?s=128&d=identicon&r=PG&f=1", "display_name": "SebTHU", "link": "https://stackoverflow.com/users/3584553/sebthu"}, "edited": false, "score": 0, "creation_date": 1458118321, "post_id": 35904106, "comment_id": 59711121, "body": "It&#39;s the second entry under Options: openvpn [path to config file].  That should start OpenVPN with your config file.  To figure out how the security works, you&#39;ll have to read through the document to find out how the settings in your particular config file affect things."}], "answers": [{"tags": [], "owner": {"reputation": 1294, "user_id": 3584553, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0847303778bc764e001e7a5b6d48b588?s=128&d=identicon&r=PG&f=1", "display_name": "SebTHU", "link": "https://stackoverflow.com/users/3584553/sebthu"}, "is_accepted": false, "score": 3, "last_activity_date": 1457604649, "last_edit_date": 1457604649, "creation_date": 1457602151, "answer_id": 35912391, "question_id": 35904106, "link": "https://stackoverflow.com/questions/35904106/how-to-put-open-vpn-process-in-an-ssis-task-control-flow/35912391#35912391", "title": "How to put Open VPN process in an SSIS task control flow", "body": "<p>I don't know anything about OpenVPN, but I ran into a similar problem a while back with a server that insisted on an SSH tunnel using PuTTY as the only allowed connection method.</p>\n\n<p>People who put these policies in place never think of the impact on SSIS, especially for unattended processing.</p>\n\n<p>The solution I found was:</p>\n\n<ol>\n<li>Find the command-line equivalent to the PuTTy client (which is called plink)</li>\n<li>Have the detailed documentation to hand, because this is really difficult.</li>\n<li>Have the SSIS package start plink.exe, passing various parameters (Note: don't use the Execute Process task, as that waits for the process to exit: launch the process in a Script task, and get the handle of plink.exe's ProcessID).</li>\n<li>After a wait, have another Script task in SSIS connect to the plink process' InputBuffer, \"typing in\" a password.  Yes, insecure and clunky, though you can store SSIS project parameters encrypted (this obviously requires SSIS 2012 or later)\n\n<ol start=\"5\">\n<li>The SSIS package can now connect to the server and do data stuff, as if it was a normal server without stupid access requirements.</li>\n<li>At the end of the package, kill the plink.exe process.</li>\n</ol></li>\n</ol>\n\n<p>Bear in mind, also, that on unattended execution (e.g. when scheduled in a job), your package will be running in a <em>different</em> security context from the one you work in to develop the package (depending on the SSIS service settings).  If your access to OpenVPN has any dependency on ActiveDirectory, you may have to set up another OpenVPN account for the SSIS service's Logon user.</p>\n\n<p>If this sounds horrible, nightmarishly complicated and unstable, it's because it is.  Really, the TL;DR version is: tell whoever administers the server that if they really want you to access it using SSIS, they should put some more sensible access policy in place.</p>\n"}, {"tags": [], "owner": {"reputation": 817, "user_id": 3800000, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/55e48e9d21744feacfdab6e06b0d80ef?s=128&d=identicon&r=PG&f=1", "display_name": "Lambo", "link": "https://stackoverflow.com/users/3800000/lambo"}, "is_accepted": true, "score": 0, "last_activity_date": 1461896872, "creation_date": 1461896872, "answer_id": 36928552, "question_id": 35904106, "link": "https://stackoverflow.com/questions/35904106/how-to-put-open-vpn-process-in-an-ssis-task-control-flow/36928552#36928552", "title": "How to put Open VPN process in an SSIS task control flow", "body": "<p>After working with my IT colleague, I think I solve the problem. Here are my answer and opinion to this question, and please correct me if I am wrong. </p>\n\n<p>I think opening a VPN automatically is a case by case issue. In this case I am still using <strong>Execute Process Task</strong> in SSIS. Inside the task editor, what we are executing is not openVPN.exe, it should be a batch file. In the batch file (.bat file) it contains the command of opening .ovpn file with OpenVPN.exe</p>\n\n<p>The process below gives you more detailed info.</p>\n\n<p>The command line is what I use in the batch file:</p>\n\n<pre><code>@echo off\nCD /D \"C:\\Program Files\\OpenVPN\\config\"\nstart openvpn client.ovpn\nTIMEOUT /T 10\nexit\n</code></pre>\n\n<p>In SSIS execute process task \n<a href=\"https://i.stack.imgur.com/f42Gl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f42Gl.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hopefully this is useful </p>\n"}], "owner": {"reputation": 817, "user_id": 3800000, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/55e48e9d21744feacfdab6e06b0d80ef?s=128&d=identicon&r=PG&f=1", "display_name": "Lambo", "link": "https://stackoverflow.com/users/3800000/lambo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1513, "favorite_count": 0, "accepted_answer_id": 36928552, "answer_count": 2, "score": 1, "last_activity_date": 1461896872, "creation_date": 1457563154, "last_edit_date": 1495539849, "question_id": 35904106, "link": "https://stackoverflow.com/questions/35904106/how-to-put-open-vpn-process-in-an-ssis-task-control-flow", "title": "How to put Open VPN process in an SSIS task control flow", "body": "<p>I'm learning how to use SSIS to create auto scheduled tasks. Everything went smoothly until the security policy has changed. Before whenever I wanted to connect to database, I just type in IP address, username and password in SSIS connection manager. <strong>Now</strong> I need to open up OpenVPN first which is still a manual process. So I really would like to put this bit into an SSIS task flow.</p>\n\n<p>I had a search on Stackoverflow and over some other websites. Here is a <a href=\"https://stackoverflow.com/questions/24529188/start-vpn-from-ssis-package\">link</a> in stackoverflow. This example gives the idea that we can use VBA to setup the link. However that example shows we need a VPN connection name and VPN username which I don't really have and don't know where to find. Everytime I just right click on a .ovpn file and choose <strong>start openvpn on this config file</strong>. Also when I open that .ovpn file there is no command indicating which is my connection name or user name. Here is what it looks like when I open it up (there is no <code>-auth-user-pass</code> thing in this file and I can use this file without having to specify it):</p>\n\n<pre><code>client\ndev tun\nproto udp\nremote a website here 1111\nresolv-retry infinite\nnobind\npersist-key\npersist-tun\ncomp-lzo\nverb 3\n\nca ca.crt\ncert office.crt\nkey office.key\naskpass login.txt\n</code></pre>\n\n<p>Is it possible to find my connection name and user name? If I don't need connection name and user name, can I still write up VBA to build up an auto connection process?</p>\n\n<p>I also notice there is an <code>execute process task</code> in SSIS. Is it possible that I can make use of it (because in my understanding obviously I use openvpn.exe to execute a .ovpn file)?</p>\n\n<p>Please correct me if I'm saying something wrong since I'm new to both VPN and SSIS. And much appreciate for whoever can help me with this.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1457562898, "post_id": 35903801, "comment_id": 59468416, "body": "Could you add them to an array instead?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6041889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1321101951239670/picture?type=large", "display_name": "Lee", "link": "https://stackoverflow.com/users/6041889/lee"}, "edited": false, "score": 0, "creation_date": 1457566000, "post_id": 35904064, "comment_id": 59469740, "body": "It is Jeeped. and the add() command is item:=, key:=, before:=, after:= with item: being the only bit of info required. I&#39;ve tried using the dictionary but i&#39;m still getting the same answer"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1457562926, "creation_date": 1457562926, "answer_id": 35904064, "question_id": 35903801, "link": "https://stackoverflow.com/questions/35903801/runtime-error-7-out-of-memory-using-vba-collection/35904064#35904064", "title": "runtime error 7 Out of Memory using vba collection", "body": "<p><strong>TSMDataBulk</strong> looks like it is a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251825.aspx\" rel=\"nofollow\">Scripting.Dictionary</a> object. You are adding a key but no item.</p>\n\n<pre><code>TSMDataBulk.add key:=json, item:=json\n'alternate no. 1\nTSMDataBulk.add key:=json, item:=\"\"\n'alternate no. 2 (overwrite method)\nTSMDataBulk.item(json) = \"\"\n</code></pre>\n\n<p>Judging by your sample code there is a session id in the first position. I might try to use that as the key and put the remainder in as the item.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457570863, "post_id": 35905221, "comment_id": 59471434, "body": "Good catch! Completely missed that myself."}, {"owner": {"reputation": 23, "user_id": 6041889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1321101951239670/picture?type=large", "display_name": "Lee", "link": "https://stackoverflow.com/users/6041889/lee"}, "edited": false, "score": 0, "creation_date": 1457594732, "post_id": 35905221, "comment_id": 59479295, "body": "Thankyou barrwc. That was spot on. I&#39;de give you some rep but my rep is too low to do that!"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 2, "last_activity_date": 1457568762, "creation_date": 1457568762, "answer_id": 35905221, "question_id": 35903801, "link": "https://stackoverflow.com/questions/35903801/runtime-error-7-out-of-memory-using-vba-collection/35905221#35905221", "title": "runtime error 7 Out of Memory using vba collection", "body": "<p>It looks like you are using <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251677.aspx\" rel=\"nofollow\">Mid$</a> as though the parameters were: Mid$(string, start, end) In reality, the parameters are: Mid$(string, start, length)</p>\n\n<p>So if strStart was 5000 and strFinish was 5050, you would be returning all of the characters from 5000 to 10549 instead of returning those from 5000 to 5050. This may well explain the out of memory errors as you get further into the string.</p>\n\n<p>Change:</p>\n\n<pre><code>json = Mid$(dataStr, strStart, strFinish)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>json = Mid$(dataStr, strStart, (strFinish - strStart) + 1)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6041889, "user_type": "registered", "profile_image": "https://graph.facebook.com/1321101951239670/picture?type=large", "display_name": "Lee", "link": "https://stackoverflow.com/users/6041889/lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1457568762, "creation_date": 1457561873, "last_edit_date": 1457566152, "question_id": 35903801, "link": "https://stackoverflow.com/questions/35903801/runtime-error-7-out-of-memory-using-vba-collection", "title": "runtime error 7 Out of Memory using vba collection", "body": "<p>I'm new to vba in excel, infact its the first time for me. Along the way i've managed to work most things out and find answers in the net. However the latest issue im having i cant find an answer, solution to my problem.</p>\n\n<p>this function, downloads a json string, and is usually 5+mb big. and this loop finds the opening and closing {} for each component and adds it to a collection. All is well until I get to around the 1600/35k entry and the runtime error happens.</p>\n\n<p>There is a 2nd error, with a out of string message, but assigning vbNullString to the string stops this from happening</p>\n\n<pre><code>Dim cnt As Long\nDim json As String, idKey As String\nDim strStart As Long, strFinish As Long\n\ncnt = 0\nstrStart = 1\nstrFinish = 0\nOn Error GoTo HandleIt\nDo While strFinish &lt;= Len(dataStr) - 5\n    json = vbNullString\n    strStart = InStr(strStart, dataStr, \"{\"\"Id\"\":\", vbBinaryCompare)\n    strFinish = InStr(strStart, dataStr, \"}\", vbBinaryCompare) - 1\n    json = Mid$(dataStr, strStart, strFinish)\n\n    ' Get the itemID for the key\n    'strStart = InStr(6, json, \",\", vbBinaryCompare)\n    'idKey = Mid$(json, 7, strStart - 7)\n\n    TSMDataBulk.add json\n    strStart = strFinish\n    cnt = cnt + 1\nLoop\n</code></pre>\n\n<p>tltd: Everything runs fine until TSMDataBulk.add causes a out of memory error. Can anyone help?</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1457561015, "post_id": 35903385, "comment_id": 59467445, "body": "Personally I would add a helper column with a countif() formula, then filter the pivot table on that column being greater than zero."}, {"owner": {"reputation": 891, "user_id": 2976546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tqlP6.png?s=128&g=1", "display_name": "nagyben", "link": "https://stackoverflow.com/users/2976546/nagyben"}, "edited": false, "score": 0, "creation_date": 1457566533, "post_id": 35903385, "comment_id": 59469954, "body": "Have you tried stepping through line-by-line using the debugger?"}, {"owner": {"reputation": 39, "user_id": 4889198, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-KVFLkP7aNlg/AAAAAAAAAAI/AAAAAAAAAEQ/ufE7h-C-Xks/photo.jpg?sz=128", "display_name": "Jared Benedict", "link": "https://stackoverflow.com/users/4889198/jared-benedict"}, "edited": false, "score": 0, "creation_date": 1457589502, "post_id": 35903385, "comment_id": 59476868, "body": "I have not, that is a good idea. I will look into that."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 5907512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68af2bf482c072d192a4967e095f840?s=128&d=identicon&r=PG&f=1", "display_name": "Misterneo", "link": "https://stackoverflow.com/users/5907512/misterneo"}, "is_accepted": false, "score": 0, "last_activity_date": 1457563442, "creation_date": 1457563442, "answer_id": 35904179, "question_id": 35903385, "link": "https://stackoverflow.com/questions/35903385/how-to-filter-pivottable-to-only-show-values-contained-in-another-column-using-v/35904179#35904179", "title": "How to filter PivotTable to only show values contained in another column using vba", "body": "<p>try this </p>\n\n<pre><code>Sub partNum()\nDim pt As PivotTable\n\nSet pt = Worksheets(\"Feuil4\").PivotTables(1)\npt.PivotCache.op\npt.PivotCache.MissingItemsLimit = xlMissingItemsNone\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4889198, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-KVFLkP7aNlg/AAAAAAAAAAI/AAAAAAAAAEQ/ufE7h-C-Xks/photo.jpg?sz=128", "display_name": "Jared Benedict", "link": "https://stackoverflow.com/users/4889198/jared-benedict"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1059, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474462670, "creation_date": 1457560385, "last_edit_date": 1474462670, "question_id": 35903385, "link": "https://stackoverflow.com/questions/35903385/how-to-filter-pivottable-to-only-show-values-contained-in-another-column-using-v", "title": "How to filter PivotTable to only show values contained in another column using vba", "body": "<p>I am trying to create a vba macro that will filter a pivot table so that the only values that show are the ones that also exist in a list of items on another worksheet.</p>\n\n<p>The pivot table has the following construction:</p>\n\n<pre><code>Raw Material Item Code | other column1 | other column2 | ... etc.\n       1001            |               |               |\n       1002            |               |               |       \n       10PT            |               |               |\n         .             |               |               |\n         .             |               |               |\n         .             |               |               |\n</code></pre>\n\n<p>I am wanting to place a filter on the \"Raw Material Item Code\" Field.</p>\n\n<p>The other table is simply a list of items, starting at A1 on a separate worksheet that looks like this:</p>\n\n<pre><code>    A\n1| 1001\n2| 1234\n3| 8123\n4| 1004\n5|   .\n6|   .\n7|   .\n8|   .\n</code></pre>\n\n<p>Essentially, I want to be able to add or remove items to the list and have the PivotTable automatically filtered to show only the items where it's \"Raw Material Item Code\" value matches an item in the other list.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    Dim NewCat As String\n    Dim col As New Collection\n    Dim Pi As PivotItem\n\n'   This is getting a collection of all of the values containted in the other table.\n\n        Worksheets(\"test\").Select\n        Worksheets(\"test\").Range(\"A1\").Select\n\n        Do Until ActiveCell.Value = \"\"\n            NewCat = ActiveCell.Value\n                col.Add (NewCat)\n            ActiveCell.Offset(1, 0).Select\n        Loop\n\n'   This is interating through the Pivot Items in the Pivot Table and setting their visability to False.\n\n        With Worksheets(\"Trim Inventory - NC-Obsolete\").PivotTables(\"PivotTable2\").PivotFields(\"Raw Material Item Code\")\n            For i = 1 To .PivotItems.Count - 1\n                .PivotItems(.PivotItems(i).Name).Visible = False\n            Next i\n\n'   This is interating back through the Pivot Items in the Pivot Table and setting the visability of the items that exist in the \n'   other table to True.\n\n             For i = 1 To .PivotItems.Count - 1\n                For Each c In col\n                    If UCase(.PivotItems(.PivotItems(i).Name).Value) = c Then\n                        .PivotItems(.PivotItems(i).Name).Visible = False\n                    End If\n                Next c\n            Next i\n\n        End With\n\nEnd Sub\n</code></pre>\n\n<p>When this runs, it just filters out everything. Can someone please point me in the correct direction? I am also open for complete code change suggestions seeing as how I understand that this approach may not be the most efficient one.</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1457560019, "post_id": 35903146, "comment_id": 59466931, "body": "You are passing to the first parameter of Match <code>Application.WorksheetFunction.Left(Worksheets(&quot;Terms&quot;), Range(&quot;N:N&quot;).Value, 6)</code> which is invalid.  What do you expect this to be?"}, {"owner": {"reputation": 31, "user_id": 1932747, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c4480a6ec17f250c94b2b4495135dc2?s=128&d=identicon&r=PG", "display_name": "user1932747", "link": "https://stackoverflow.com/users/1932747/user1932747"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1457561666, "post_id": 35903146, "comment_id": 59467801, "body": "In Excel the formula would be typed out as follows: {=MATCH(LEFT(Terms!N3,6),Results!3:3)}   I&#39;m checking the first 6 letters of the N column in the &quot;Terms&quot; tab and finding the matching column in the Results tab."}, {"owner": {"reputation": 31, "user_id": 1932747, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c4480a6ec17f250c94b2b4495135dc2?s=128&d=identicon&r=PG", "display_name": "user1932747", "link": "https://stackoverflow.com/users/1932747/user1932747"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1457561997, "post_id": 35903146, "comment_id": 59467978, "body": "I just updated the line thinking it would work, It didn&#39;t.  Application.WorksheetFunction.Left(Worksheets(&quot;Terms&quot;).Range&zwnj;&#8203;(&quot;N&quot; &amp; Row).Value, 6)"}, {"owner": {"reputation": 56607, "user_id": 695364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUNjJ.jpg?s=128&g=1", "display_name": "Scott Marcus", "link": "https://stackoverflow.com/users/695364/scott-marcus"}, "edited": false, "score": 1, "creation_date": 1457562595, "post_id": 35903146, "comment_id": 59468275, "body": "A simpler way to figure this out would be to do one function at a time and store the result in a variable, instead of nesting functions inside of other functions. Once you know which function is actually causing the function, you can address it."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1457569292, "post_id": 35903146, "comment_id": 59470937, "body": "<code>Left</code> isn&#39;t available as a method of <code>WorksheetFunction</code> (the &quot;Object&quot; the error refers to is <code>WorksheetFunction</code>).  Instead of <code>Application.WorksheetFunction.Left</code> just use <code>Left</code>.  Another point, don&#39;t bother with the <code>.Value</code>&#39;s in the Location and Title lines, just leave them out (I get an Out of Memory error if they are left in)"}, {"owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "edited": false, "score": 0, "creation_date": 1457590143, "post_id": 35903146, "comment_id": 59477138, "body": "Your whole code is a junk! since no loop is required when you are using built-in functions.  So please describe in words about each steps to know what you are trying to achieve."}, {"owner": {"reputation": 31, "user_id": 1932747, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c4480a6ec17f250c94b2b4495135dc2?s=128&d=identicon&r=PG", "display_name": "user1932747", "link": "https://stackoverflow.com/users/1932747/user1932747"}, "edited": false, "score": 0, "creation_date": 1457647591, "post_id": 35903146, "comment_id": 59515112, "body": "I started making notes and realized you might be right. But I&#39;m not sure it is because of the loops.I made  few edits, but I&#39;m new to VBA. Could you tell me what I&#39;m doing wrong?  The idea is to retrieve a value via a Vlookup in a semi-circular way. I find the value that fits in one the terms  tab, and if it is in the row, I do a vlookup of the term concatenated with a fixed value. If the fixed value has an error, the loop starts over again. Else, it prints the result, and moves on to the next row. I&#39;m posting the new code with documentation on the next comment."}, {"owner": {"reputation": 31, "user_id": 1932747, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c4480a6ec17f250c94b2b4495135dc2?s=128&d=identicon&r=PG", "display_name": "user1932747", "link": "https://stackoverflow.com/users/1932747/user1932747"}, "edited": false, "score": 0, "creation_date": 1457647640, "post_id": 35903146, "comment_id": 59515134, "body": "It&#39;s too. Long. I&#39;m editing my OP instead."}], "owner": {"reputation": 31, "user_id": 1932747, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c4480a6ec17f250c94b2b4495135dc2?s=128&d=identicon&r=PG", "display_name": "user1932747", "link": "https://stackoverflow.com/users/1932747/user1932747"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 417, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1462520887, "creation_date": 1457559543, "last_edit_date": 1462520887, "question_id": 35903146, "link": "https://stackoverflow.com/questions/35903146/object-doesnt-support-this-property-excel-vba", "title": "Object doesn&#39;t support this property EXCEL VBA", "body": "<p>I know what this error is, but I can't figure out why it is being called. I ran the scrip to the cursor and it seems to break on lin 6 [Title = Application....]. What about my code isn't supported in VBA?</p>\n\n<pre><code>Function Term_gen()\n    TermRow = 3    \\\\Starting Row on Term Tab    \n    ResultsRow = 3  'Starting Row on Results tab\n    Do Until IsEmpty(Worksheets(\"Results\").Range(\"A:A\").Value) 'Loop through a column in \"Results\" tab until cells are blank\n\n        Do Until IsEmpty(Worksheets(\"Terms\").Range(\"N:N\").Value) 'Loop through column in \"Terms\" tab until cells are blank\n\n\n            Lefty = Left(Worksheets(\"Terms\").Range(\"N\" &amp; TermRow).Value, 6) 'Take left 6 letters in the designated cell\n            Location = Application.WorksheetFunction.Match(Lefty, Worksheets(\"Results\").Range(\"ResultsRow:ResultsRow\"), 0) 'Use the match function to find the location of the string found in  Lefty, in the row designated    \n\n        If Location IsError Then 'If the tern Row produces an error\n\n            TermRow =  TermRow + 1  'Go to the next Row in Terms and reset loop\n        Else\n\n                    Title = Application.WorksheetFunction.Index(Worksheets(\"Results\").Range(\"A1:CR200000\"), Location, ResultsRow) 'Store the value of the term found in the row \n        Loop 'End the loop\n\n        whole_name = Title &amp; Worksheets(\"Results\").Range(\"X1\").Value 'Concatinate the Title Value with a fixed value in spreadsheet\n\n    If whole_name IsError Then 'If the Vlookup Produces an error\n            TermRow = TermRow + 1 'Go to next row in Terms and reset loop\n    Else\n\n                 term = Application.WorksheetFunction.VLookup(whole_name, Worksheets(\"Terms\").Range(\"N:O\"), 2, 1) 'Vlookup of the whole term in the term sheet\n\n                 Worksheets(\"Test_Sheet\").Range(\"A\" &amp; ResultsRow).Value = term 'Print Term in designated cell\n\n\n                 ResultsRow = ResultsRow + 1 'Go to next row. Start loop over.\n\nLoop\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457559950, "post_id": 35903140, "comment_id": 59466903, "body": "Can you elaborate a little? Range <code>A1:D4</code> should not be blank, correct? If a cell <i>is</i> blank, you want to fill it with the value in Cell <code>A1</code>?  You need to make your references relative, as right now, only Cell <code>A1</code> is being checked if it&#39;s blank.  Do you want to check each cell in <code>A1:D4</code>?"}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457560085, "post_id": 35903140, "comment_id": 59466957, "body": "A1:D1 is not blank, but any below it may still be blank. Yes, that is what I want, a blank to be filled with a value that is known previously. I thought cell(1,1) meant I start the iteration at A1, but for some reason it checks cell(1,2) and not cell(2,1) first like I want."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1457560308, "post_id": 35903285, "comment_id": 59467068, "body": "This works, perfectly and clear in logic. If I wanted to make the lower right corner dynamic as in I know for sure that it will have a value, how will I be able to do that?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1457560373, "post_id": 35903285, "comment_id": 59467096, "body": "After so many times of trying to point out not to use <code>Cell</code> as a variable, I kind of gave up...Thanks for pointing that out, I think that causes some issues with a lot of people."}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1457560437, "post_id": 35903285, "comment_id": 59467130, "body": "Ah, so did I implicitly create a variable &quot;cell&quot;?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1457560458, "post_id": 35903285, "comment_id": 59467142, "body": "@AltoidsBenefitsH that is a different question.  The answer is <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">HERE</a>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1457560523, "post_id": 35903285, "comment_id": 59467176, "body": "@AltoidsBenefitsH yes you did by using it in the for each loop.  It sets the range to the variable cell.  This variable then changes as the loop iterates."}, {"owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "edited": false, "score": 0, "creation_date": 1457560601, "post_id": 35903285, "comment_id": 59467226, "body": "Thanks Scott, I accepted, but I can&#39;t upvote it, not enough rep yet"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1457560310, "last_edit_date": 1457560310, "creation_date": 1457560031, "answer_id": 35903285, "question_id": 35903140, "link": "https://stackoverflow.com/questions/35903140/filling-an-empty-cell-with-previous-known-value-in-a-column/35903285#35903285", "title": "Filling an Empty Cell with Previous Known Value in a column", "body": "<p>Try this:</p>\n\n<pre><code>Sub autofiller()\nDim cell as range\nDim DataRange As Range\nSet DataRange = Range(\"A1:D4\")\n\nFor Each cell In DataRange\n    If cell.Value = \"\" Then\n        cell.Value = cell.Offset(-1).Value\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Because the for each will go left to right, top to bottom it will fill it with the cell above as it encounters empty cells.</p>\n\n<p>You are confusing your variable <code>cell</code> which is a range variable with <code>Cells()</code> which is a range object.  <code>cell(1,1)</code> is equal to <code>cell</code> as it is getting the first cell in a range of one.</p>\n\n<p>Another way to write <code>cell.Offset(-1)</code> would be <code>cell(-1,1)</code> this gets the cell directly above the cell.</p>\n"}], "owner": {"reputation": 45, "user_id": 5941733, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/445eb36fbcf5e7bbf5ec09d19d001db5?s=128&d=identicon&r=PG&f=1", "display_name": "AltoidsBenefitsH", "link": "https://stackoverflow.com/users/5941733/altoidsbenefitsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 35903285, "answer_count": 1, "score": 0, "last_activity_date": 1457560310, "creation_date": 1457559494, "question_id": 35903140, "link": "https://stackoverflow.com/questions/35903140/filling-an-empty-cell-with-previous-known-value-in-a-column", "title": "Filling an Empty Cell with Previous Known Value in a column", "body": "<p>I have various empty cells in a table that I want to fill with the last known value in that column.</p>\n\n<pre><code>Sub autofiller()\n\nDim DataRange As Range\nSet DataRange = Range(\"A1:D4\")\nDim i As Integer\n\nFillA = \"\"\n\nFor Each cell In DataRange\n\nIf cell(1, 1).Value &lt;&gt; \"\" Then\n\nFillA = cell(1, 1).Value\n\nElse\n    cell(1, 1).Value = FillA\n\nEnd If\n\ni = i + 1\n\nRange(\"C1\").Value = i\n\nNext\n\nEnd Sub\n</code></pre>\n\n<p>There will be no empty values in the first row. My logic is that it will look through every cell in that range, and if it is not an empty cell, pick up the value until it hits an empty cell where then I will place that value. The i counter is for me to keep track. It seems to me that the code is checking cell by cell horizontally but I want it to check cell by cell vertically. How can I make it check vertically?</p>\n\n<p>I am new to VBA so any additional comments/guides will help.</p>\n"}, {"tags": ["vba", "automation", "screen-scraping"], "comments": [{"owner": {"reputation": 1, "user_id": 6041750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc57e512822e85a30a6f5486eb3aecb4?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6041750/pete"}, "edited": false, "score": 0, "creation_date": 1457558735, "post_id": 35902925, "comment_id": 59466189, "body": "sorry, here is the HTML for the &quot;Sign On&quot; button:  &quot; &lt;input name=&quot;action&quot; class=&quot;button&quot; type=&quot;SUBMIT&quot; value=&quot;Sign On&quot;&gt; &quot;"}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1457564116, "post_id": 35902925, "comment_id": 59468984, "body": "Can you list the URL?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457565414, "post_id": 35902925, "comment_id": 59469529, "body": "What happens when you run your code ?"}, {"owner": {"reputation": 1, "user_id": 6041750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc57e512822e85a30a6f5486eb3aecb4?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6041750/pete"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1457618348, "post_id": 35902925, "comment_id": 59495398, "body": "@justkrys - unfortunately not, it&#39;s an internal site with my company."}, {"owner": {"reputation": 1, "user_id": 6041750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc57e512822e85a30a6f5486eb3aecb4?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6041750/pete"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457618383, "post_id": 35902925, "comment_id": 59495422, "body": "@TimWilliams - It will open the Internet Explorer, enter username and password, and then just stop."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1538336440, "creation_date": 1538336440, "answer_id": 52581492, "question_id": 35902925, "link": "https://stackoverflow.com/questions/35902925/how-can-i-fix-this-vba-code-to-click-a-form-button-on-internet-explorer/52581492#52581492", "title": "How can I fix this VBA code to click a form button on Internet Explorer?", "body": "<p>Providing more HTML would help as there may be parent frame/iframe to handle.</p>\n\n<p>The element you show can, without parent frame/iframe, be selected with CSS selector combinations of <code>input.button[value='Sign On']</code>.</p>\n\n<p>That is <code>input</code> tag element with class <code>button</code> and attribute <code>value</code> with value <code>'Sign On'</code></p>\n\n<pre><code>ie.document.querySelector(\"input.button[value='Sign On']\").Click\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6041750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc57e512822e85a30a6f5486eb3aecb4?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6041750/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538336440, "creation_date": 1457558689, "last_edit_date": 1457565363, "question_id": 35902925, "link": "https://stackoverflow.com/questions/35902925/how-can-i-fix-this-vba-code-to-click-a-form-button-on-internet-explorer", "title": "How can I fix this VBA code to click a form button on Internet Explorer?", "body": "<p>I am writing a VBA code to open up a Internet Explorer, enter username and password and click a 'Sign On' Button.</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Sub Example()\n\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    IE.Visible = True\n\n    IE.navigate \"webexample.com\"\n\n    Do While IE.busy: DoEvents: Loop\n    Do While IE.READYSTATE &lt;&gt; 4: DoEvents: Loop\n    Do While IE.Document.READYSTATE &lt;&gt; \"complete\": DoEvents: Loop\n\n    IE.Document.all.Item(\"userID\").Value = \"username\"\n    IE.Document.all.Item(\"password\").Value = \"password\"\n    IE.Document.forms(0).submit (\"Sign On\")\n\nEnd Sub\n</code></pre>\n\n<p>And here is the HTML for the \"Sign On\" button:</p>\n\n<pre><code>&lt;input name=\"action\" class=\"button\" type=\"SUBMIT\" value=\"Sign On\"&gt;\n</code></pre>\n\n<p>Is there something I'm missing or need to correct?  Any assistance is appreciated and I thank you in advance for your time and help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1457558521, "post_id": 35902844, "comment_id": 59466077, "body": "&quot;I am getting an error&quot; What error?"}, {"owner": {"reputation": 3, "user_id": 6041752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc176c4e1f7b69f6bde6865baba980c7?s=128&d=identicon&r=PG&f=1", "display_name": "R.G.", "link": "https://stackoverflow.com/users/6041752/r-g"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1457559259, "post_id": 35902844, "comment_id": 59466506, "body": "Runtime error 13 - type mismatch"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6041752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc176c4e1f7b69f6bde6865baba980c7?s=128&d=identicon&r=PG&f=1", "display_name": "R.G.", "link": "https://stackoverflow.com/users/6041752/r-g"}, "edited": false, "score": 0, "creation_date": 1457560053, "post_id": 35903177, "comment_id": 59466944, "body": "Yes! That worked perfectly. Thank you so much. One quick additional question. If I want to also update font, fill, etc in the textboxes, what would I need to add?"}], "tags": [], "owner": {"reputation": 16, "user_id": 5907512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68af2bf482c072d192a4967e095f840?s=128&d=identicon&r=PG&f=1", "display_name": "Misterneo", "link": "https://stackoverflow.com/users/5907512/misterneo"}, "is_accepted": true, "score": 0, "last_activity_date": 1457559670, "creation_date": 1457559670, "answer_id": 35903177, "question_id": 35902844, "link": "https://stackoverflow.com/questions/35902844/trying-to-dynamically-update-textboxes-with-values-in-vba/35903177#35903177", "title": "Trying to dynamically update textboxes with values in VBA", "body": "<p>try this</p>\n\n<pre><code>Sub UpdateMap()\nDim rng As Range\nDim cell As Range\n\nWith ThisWorkbook.Worksheets(\"5th floor map\")\n    Set rng = .Range(\"A2:A5\")\n    For Each cell In rng\n        .OLEObjects(\"TextBox\" &amp; cell).Object.Text = cell.Offset(0, 1).Value\n    Next\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 5907512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68af2bf482c072d192a4967e095f840?s=128&d=identicon&r=PG&f=1", "display_name": "Misterneo", "link": "https://stackoverflow.com/users/5907512/misterneo"}, "is_accepted": false, "score": 0, "last_activity_date": 1457565519, "creation_date": 1457565519, "answer_id": 35904612, "question_id": 35902844, "link": "https://stackoverflow.com/questions/35902844/trying-to-dynamically-update-textboxes-with-values-in-vba/35904612#35904612", "title": "Trying to dynamically update textboxes with values in VBA", "body": "<p>try this </p>\n\n<pre><code>Sub oo()\nDim ol As OLEObject\n\nSet ol = ThisWorkbook.Worksheets(\"MySheet\").OLEObjects(\"TextBox1\")\nWith ol\n    .Object.Text = \"blabla\"\n    .Object.ForeColor = RGB(0, 0, 192)\n    .Object.BorderStyle = fmBorderStyleSingle\n    .Object.SpecialEffect = fmSpecialEffectFlat\n    .Object.BackColor = RGB(192, 192, 192)\n    '.object.....\n\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6041752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc176c4e1f7b69f6bde6865baba980c7?s=128&d=identicon&r=PG&f=1", "display_name": "R.G.", "link": "https://stackoverflow.com/users/6041752/r-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3830, "favorite_count": 0, "accepted_answer_id": 35903177, "answer_count": 2, "score": 0, "last_activity_date": 1457565519, "creation_date": 1457558421, "question_id": 35902844, "link": "https://stackoverflow.com/questions/35902844/trying-to-dynamically-update-textboxes-with-values-in-vba", "title": "Trying to dynamically update textboxes with values in VBA", "body": "<p>I have put a map into excel of a building seating chart and created activeX text boxes on each spot where someone is sitting. I also have a list of each seat and the person sitting there. What I want to do is go through the list and assign the correct name to the textbox for each person. The name of each textbox is \"TextBox____\" where the blank is the seat name\". I am getting an error on the \"set tbox\" line.</p>\n\n<pre><code>Sub UpdateMap()\n   Dim name As Variant\n   Dim tbox As MSForms.TextBox\n   Dim rng As Range\n   Dim cell As Range\n   With ThisWorkbook.Worksheets(\"5th floor map\")\n   Set rng = .Range(\"A2:A5\")\n   For Each cell In rng\n    ws = cell.Value\n    name = Application.VLookup(ws, .Range(\"A2:B5\"), 2, False)\n    Set tbox = ThisWorkbook.Worksheets(\"5th floor map\").Shapes(\"TextBox\" &amp; ws)\n    tbox.Value = name\n    Next\n   End With\nEnd Sub\n</code></pre>\n\n<p>I only used the first four names/seats for this example, and used the for loop because in reality there are over 100 of these. Any suggestions for how i could make this work would be appreciated. Or if I am thinking about this totally wrong, please tell me that too. Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457558156, "post_id": 35902745, "comment_id": 59465861, "body": "<code>Range(rngAddress, rngAddress.End(xlDown)).Offset(,1).Select</code>"}, {"owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457558399, "post_id": 35902745, "comment_id": 59465993, "body": "I edited my question, what I mean select the next row after the header &quot;Address&quot;. Sorry for the confusion."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1457558448, "post_id": 35902745, "comment_id": 59466023, "body": "<code>Range(rngAddress.offset(1), rngAddress.End(xlDown)).Select</code>"}, {"owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457558698, "post_id": 35902745, "comment_id": 59466173, "body": "Thank you so much! What is the difference of that line and this line: <code>Range(rngAddress.Cells(2, 1), rngAddress.End(xlDown).Cells(2, 1)).Select</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457558906, "post_id": 35902745, "comment_id": 59466302, "body": "Not much.  The <code>.Cells(2,1)</code> when referring to a single cell does the same as offset(1).  I would not offset after the <code>End(xlDown)</code> you are no including  an extra empty cell on the bottom.  As you have it written <code>Range(rngAddress, rngAddress.End(xlDown)).Offset(1).Select</code> would give you the same range without extra typing."}, {"owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457559065, "post_id": 35902745, "comment_id": 59466403, "body": "I see. I got it. Much appreciated!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1457558927, "last_edit_date": 1495540403, "creation_date": 1457558927, "answer_id": 35903001, "question_id": 35902745, "link": "https://stackoverflow.com/questions/35902745/select-all-cells-with-a-value-under-header/35903001#35903001", "title": "Select all cells with a value under header", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow noreferrer\">WorksheetFunction object</a> <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow noreferrer\">MATCH function</a> to locate the column header label in the first row.</p>\n\n<pre><code>Sub FindAddressColumn()\n    dim cl as long\n    with worksheets(\"Sheet1\")\n        if not iserror(application.match(\"address\", .rows(1), 0)) then\n            cl = application.match(\"address\", .rows(1), 0)\n            .range(.cells(2, cl), .cells(rows.count, cl).end(xlup)).select\n        else\n            MsgBox \"Address column was not found.\"\n            Exit Sub\n        end if\n    end with\nEnd Sub\n</code></pre>\n\n<p>I prefer to look from  the bottom up to find the last populated cell in a column but if you prefer to look from the top down, the above code could be easily modified to suit.</p>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197597.aspx\" rel=\"nofollow noreferrer\">Range .Select</a>\u00b9 method is not always the most reliable method of referencing individual or groups of <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow noreferrer\">Range object</a>s. Directly referencing the parent worksheet with a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow noreferrer\">With ... End With statement</a> should help.</p>\n\n<hr>\n\n<p>\u00b9 <sub>See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a> for more methods on getting away from relying on select and activate to accomplish your goals.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "is_accepted": false, "score": 2, "last_activity_date": 1487355554, "last_edit_date": 1487355554, "creation_date": 1457559091, "answer_id": 35903039, "question_id": 35902745, "link": "https://stackoverflow.com/questions/35902745/select-all-cells-with-a-value-under-header/35903039#35903039", "title": "Select all cells with a value under header", "body": "<p>In case you have blanks in your address column, use this code:</p>\n\n<pre><code>Sub FindAddressColumn()\n  Dim rngAddress As Range, LastRow As Long\n  Set rngAddress = Range(\"A1:Z1\").Find(\"Address\")\n  If rngAddress Is Nothing Then\n    MsgBox \"Address column was not found.\"\n  Else\n    LastRow = Cells(Rows.Count, rngAddress.Column).End(xlUp).Row\n    Range(Cells(2, rngAddress.Column), Cells(LastRow, rngAddress.Column)).Select\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1487382378, "creation_date": 1457558050, "last_edit_date": 1487382378, "question_id": 35902745, "link": "https://stackoverflow.com/questions/35902745/select-all-cells-with-a-value-under-header", "title": "Select all cells with a value under header", "body": "<p>I have a code that selects the column which has \"Address\" header. </p>\n\n<pre><code>Sub FindAddressColumn()\n  Dim rngAddress As Range\n  Set rngAddress = Range(\"A1:Z1\").Find(\"Address\")\n  If rngAddress Is Nothing Then\n    MsgBox \"Address column was not found.\"\n    Exit Sub\n  End If\n  Range(rngAddress, rngAddress.End(xlDown)).Select\nEnd Sub\n</code></pre>\n\n<p>I want to select 2nd row or the row after the header \"Address\" all the way down to the last row with value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1457556338, "post_id": 35902200, "comment_id": 59464835, "body": "Try putting <code>.Value</code> on the end?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457556677, "post_id": 35902200, "comment_id": 59465039, "body": "@ScottCraner DOH!  that did it, thanks!  Why don&#39;t you put that in an answer so I can give you credit?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457556916, "post_id": 35902200, "comment_id": 59465179, "body": "Glad to help, I make it a habit to always put the <code>.Value</code> after then I do not need to worry as much.  As to why one needs it and the other does not I do not know.  And since I can only give you the end without the why I prefer to leave it as a comment.  Good Luck."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457560916, "post_id": 35902200, "comment_id": 59467388, "body": "Another thing to try which should be equivalent: <code>Da_Array = Sheets(1).Range(Cells(Range(&quot;_FilterDatabase&quot;).Row, Range(&quot;_FilterDatabase&quot;).Column), Cells(Range(&quot;_FilterDatabase&quot;).Row + 11, Range(&quot;_FilterDatabase&quot;).Column + 125))</code>.  Note use of the two arguments of the Range object.  It is hard to imagine that .column + 125 would result in Column Z, though."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457561338, "post_id": 35902200, "comment_id": 59467639, "body": "You should also note that, with the syntax you are using, you will probably see a <code>1004</code> error if Sheets(1) is not the active sheet when you run the macro.  This is due to the various <code>Cells</code> objects not having a defined object to reference.  You can either prefix each instance with <code>Sheets(1)</code>, or use a <code>With ...End With</code> construct."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1457616373, "post_id": 35902200, "comment_id": 59493903, "body": "@RonRosenfeld  Thank you.  The &quot;125&quot; was a typographical error on my part, and thank you for your advice."}], "owner": {"user_type": "does_not_exist", "display_name": "user5889203"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457556246, "creation_date": 1457556211, "last_edit_date": 1531161705, "question_id": 35902200, "link": "https://stackoverflow.com/questions/35902200/trying-to-set-an-array-to-a-range-get-error-in-one-instance-not-another", "title": "Trying to set an array to a range, get error in one instance, not another", "body": "<pre><code> Da_Array = Range(\"$A15:$z26\")\n</code></pre>\n\n<p>gets no error, and assigns with no problem, but when I try this.... </p>\n\n<pre><code>Da_Array = Sheets(1).Range(Cells(Range(\"_FilterDatabase\").Row, _ \n  Range(\"_FilterDatabase\").Column).Address &amp; \":\" &amp; _ \n  Cells(Range(\"_FilterDatabase\").Row + 11, Range(\"_FilterDatabase\").Column + 125).Address)\n</code></pre>\n\n<p>anyone know why?  I walked through the code and couldn't figure it out.  When I highlighted the part starting with \"Cells\" I did get the same address, (\"$A15:$z26\")  I'm stuck.  any help would be much appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1457557904, "post_id": 35902141, "comment_id": 59465724, "body": "What are you trying to do?"}, {"owner": {"reputation": 329, "user_id": 4841030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a4ff149bee595ba6336ca3a3280b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Woli\u0144ski", "link": "https://stackoverflow.com/users/4841030/micha%c5%82-woli%c5%84ski"}, "reply_to_user": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1457559764, "post_id": 35902141, "comment_id": 59466805, "body": "Change all western ([a-z][A-Z][0-9]) characters font to Arial."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1457562495, "post_id": 35902141, "comment_id": 59468227, "body": "Use the 2nd argument of the <code>Characters</code> object to denote the number of characters you wish to return.  The <code>Name</code> of the font object should be a string.  Use the <code>Like</code> operator to do the comparison.  (See my answer below)"}], "answers": [{"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 1, "last_activity_date": 1457562111, "creation_date": 1457562111, "answer_id": 35903869, "question_id": 35902141, "link": "https://stackoverflow.com/questions/35902141/set-font-on-part-of-text-zh-cn-excel/35903869#35903869", "title": "Set font on part of text (zh-CN, Excel)", "body": "<p>Try:</p>\n\n<pre><code>Dim I As Long\nFor I = 1 To ActiveCell.Characters.Count\n    With ActiveCell.Characters(I, 1)\n        If .Text Like \"[A-Za-z0-9]\" Then\n            .Font.Name = \"Arial\"\n        End If\n    End With\nNext I\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4841030, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a4ff149bee595ba6336ca3a3280b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Woli\u0144ski", "link": "https://stackoverflow.com/users/4841030/micha%c5%82-woli%c5%84ski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 35903869, "answer_count": 1, "score": 1, "last_activity_date": 1457562731, "creation_date": 1457556080, "last_edit_date": 1531161705, "question_id": 35902141, "link": "https://stackoverflow.com/questions/35902141/set-font-on-part-of-text-zh-cn-excel", "title": "Set font on part of text (zh-CN, Excel)", "body": "<p>I've found question here about formatting part of cell, but colution not work at all (not sure if this is language related).</p>\n\n<p><a href=\"https://stackoverflow.com/questions/2109644/use-different-fonts-in-same-excel-cell#\">Use different fonts in same Excel cell?</a></p>\n\n<p><code>.text</code> below returns full text of cell, instead of signle character, so I can't check if text is western.</p>\n\n<pre><code>Sub TMP()\n'\n' TMP Macro\n'\nFor i = 1 To ActiveCell.Characters.Count\n    With ActiveCell.Characters(i)\n    If InStr(1, \"ABCDEFGHIJKLMNOPRSTQUVWXYZabcdefghijklmnopqrstuvwxyz1234567890\", .Text) &gt; 0     Then\n        .Font.Name = Arial\n    End If\n    End With\nNext\nEnd Sub\n</code></pre>\n\n<p>Do you know any way around that glitch?</p>\n\n<p>EDIT1:\nI've checked another way for IF:</p>\n\n<pre><code>InStr(1, \"ABCDEFGHIJKLMNOPRSTQUVWXYZabcdefghijklmnopqrstuvwxyz1234567890\", Mid(ActiveCell.Text, i, 1)) &gt; 0\n</code></pre>\n\n<p>But it still not change <code>.font.name</code> property (but changes color if requested)</p>\n\n<p>EDIT2:\nI found where that glitch is: on merged cells. Didn't notice that I have them mixed with not merged. I bet that answer below will work with <code>Mid</code> if I will find way, to unmerge-merge cells with no visual effect.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1457556083, "post_id": 35901978, "comment_id": 59464706, "body": "Would a Vlookup work instead?"}, {"owner": {"reputation": 248, "user_id": 1934994, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2774b14824943127f6ade513a76a6539?s=128&d=identicon&r=PG", "display_name": "Gunnar Valur Gunnarsson", "link": "https://stackoverflow.com/users/1934994/gunnar-valur-gunnarsson"}, "edited": false, "score": 0, "creation_date": 1457557465, "post_id": 35901978, "comment_id": 59465468, "body": "the &amp; operator is used in VBA to concatenate 2 strings together. You say that the number is always in B4 but you are doing a replace on the whole column.  However if the value is indeed in B4 you can do this.  <code>ActiveSheet.Range(&quot;B4&quot;).Value = ActiveSheet.Range(&quot;B4&quot;).Value &amp; &quot;-AA&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 1188594, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/020ebedc4b0d943f4533c8dea5e56604?s=128&d=identicon&r=PG", "display_name": "Stephen Lloyd", "link": "https://stackoverflow.com/users/1188594/stephen-lloyd"}, "edited": false, "score": 0, "creation_date": 1457636054, "post_id": 35902802, "comment_id": 59508133, "body": "@joshski Thanks for accepting the answer.  My vba is rusty, I just realized that didn&#39;t need to be a function.  You can replace &quot;Function&quot; with &quot;Sub&quot;."}], "tags": [], "owner": {"reputation": 699, "user_id": 1188594, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/020ebedc4b0d943f4533c8dea5e56604?s=128&d=identicon&r=PG", "display_name": "Stephen Lloyd", "link": "https://stackoverflow.com/users/1188594/stephen-lloyd"}, "is_accepted": true, "score": 0, "last_activity_date": 1457558745, "last_edit_date": 1457558745, "creation_date": 1457558244, "answer_id": 35902802, "question_id": 35901978, "link": "https://stackoverflow.com/questions/35901978/concatenating-a-single-cell-in-excel-vba/35902802#35902802", "title": "Concatenating a single cell in Excel VBA", "body": "<p>try the below function, which loops through the range and checks for empty cells. Add case statements as needed.  There are better solutions, but this is quick.</p>\n\n<pre><code>Sub test()\n\n    ReplaceText (ActiveSheet.Columns(\"B:B\").Cells)\n\nEnd Sub\n\nFunction ReplaceText(rng As Range)\n    Dim r As Range\n    For Each r In rng\n        If IsEmpty(r.Value) = False Then\n            'r.Value = Replace(r.Value, \"as\", \"bm\") &amp; \"-AA\"\n            Select Case r.Value\n                Case \"A100\"\n                    r.Value = Replace(r.Value, \"A100\", \"FSAEM\u201316\u2013121\u2013BR\u2013A000\")\n                Case \"A200\"\n                    r.Value = Replace(r.Value, \"A200\", \"FSAEM\u201316\u2013121\u2013EN\u2013A000\")\n            End Select\n            r.Value = r.Value &amp; \"-AA\"\n        End If\n    Next\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1457566299, "creation_date": 1457566299, "answer_id": 35904770, "question_id": 35901978, "link": "https://stackoverflow.com/questions/35901978/concatenating-a-single-cell-in-excel-vba/35904770#35904770", "title": "Concatenating a single cell in Excel VBA", "body": "<p>Using a regular expression might be your only option here since you are searching for a partial match and using composition.</p>\n\n<p>Here is an example replacing all the matching values from column B with the defined templates:</p>\n\n<pre><code>' load the data from column B\nDim rg_data As Range, data(), template$, r&amp;\nSet rg_data = Intersect(ActiveSheet.Columns(\"B\"), ActiveSheet.UsedRange)\ndata = rg_data.Value2\n\n' define the pattern to match the targeted values\nConst MATCH_PATTERN = \"(A?[1-8])(00.)\"\n\n' define the replacement templates (key = first group, $2 = second group)\nDim tpls As New collection\ntpls.Add \"FSAEM\u201316\u2013121\u2013BR\u2013A0$2-AA\", \"A1\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013BR\u201300$2-AA\", \"1\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013EN\u2013A0$2-AA\", \"A2\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013EN\u201300$2-AA\", \"2\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013FR\u2013A0$2-AA\", \"A3\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013FE\u201300$2-AA\", \"3\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013EL\u2013A0$2-AA\", \"A4\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013EL\u201300$2-AA\", \"4\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013MS\u2013A0$2-AA\", \"A5\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013MS\u201300$2-AA\", \"5\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013ST\u2013A0$2-AA\", \"A6\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013ST\u201300$2-AA\", \"6\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013SU\u2013A0$2-AA\", \"A7\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013SU\u201300$2-AA\", \"7\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013WT\u2013A0$2-AA\", \"A8\"\ntpls.Add \"FSAEM\u201316\u2013121\u2013WT\u201300$2-AA\", \"8\"\n\n' create the regex object\nDim re As Object, match As Object\nSet re = CreateObject(\"VBScript.RegExp\")\nre.pattern = MATCH_PATTERN\n\n' replace all the values\nFor r = 1 To UBound(data)\n  Set match = re.Execute(data(r, 1))\n  If match.count Then  ' if found\n    template = tpls(match(0).SubMatches(0))\n    data(r, 1) = re.Replace(data(r, 1), template)\n  End If\nNext\n\n' copy the data back to the sheet\nrg_data.Value2 = data\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6035813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b990cfbaae09ade4c3171a67608f7760?s=128&d=identicon&r=PG&f=1", "display_name": "Joshkl", "link": "https://stackoverflow.com/users/6035813/joshkl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 35902802, "answer_count": 2, "score": 1, "last_activity_date": 1457566299, "creation_date": 1457555571, "question_id": 35901978, "link": "https://stackoverflow.com/questions/35901978/concatenating-a-single-cell-in-excel-vba", "title": "Concatenating a single cell in Excel VBA", "body": "<p>So I'm writing a macro to turn a part number from a simple part number to an extended part number. My code right now is not elegant by any means, but it's working.</p>\n\n<p>Say I have a part number A1001 and I need it to become FSAEM\u201316\u2013121\u2013BR\u2013A0001-AA, where the BR comes from the first 1 and the rest of the part number stays constant, I have this code.</p>\n\n<pre><code>Sub Part_Number_Replacer()\nWith ActiveSheet.Columns(\"B:B\")\n.Replace \"A100\", \"FSAEM\u201316\u2013121\u2013BR\u2013A000\", xlPart\n.Replace \"100\", \"FSAEM\u201316\u2013121\u2013BR\u20130000\", xlPart\n.Replace \"A200\", \"FSAEM\u201316\u2013121\u2013EN\u2013A000\", xlPart\n.Replace \"200\", \"FSAEM\u201316\u2013121\u2013EN\u20130000\", xlPart\n.Replace \"A300\", \"FSAEM\u201316\u2013121\u2013FR\u2013A000\", xlPart\n.Replace \"300\", \"FSAEM\u201316\u2013121\u2013FE\u20130000\", xlPart\n.Replace \"A400\", \"FSAEM\u201316\u2013121\u2013EL\u2013A000\", xlPart\n.Replace \"400\", \"FSAEM\u201316\u2013121\u2013EL\u20130000\", xlPart\n.Replace \"A500\", \"FSAEM\u201316\u2013121\u2013MS\u2013A000\", xlPart\n.Replace \"500\", \"FSAEM\u201316\u2013121\u2013MS\u20130000\", xlPart\n.Replace \"A600\", \"FSAEM\u201316\u2013121\u2013ST\u2013A000\", xlPart\n.Replace \"600\", \"FSAEM\u201316\u2013121\u2013ST\u20130000\", xlPart\n.Replace \"A700\", \"FSAEM\u201316\u2013121\u2013SU\u2013A000\", xlPart\n.Replace \"700\", \"FSAEM\u201316\u2013121\u2013SU\u20130000\", xlPart\n.Replace \"A800\", \"FSAEM\u201316\u2013121\u2013WT\u2013A000\", xlPart\n.Replace \"800\", \"FSAEM\u201316\u2013121\u2013WT\u20130000\", xlPart\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Told you it wasn't elegant. The part numbers are always in cell B4. How would I go about concatenating the -AA to the end in VBA? I can't find anything about concatenation code. (Right now this macro does everything I need but replace the -AA).</p>\n\n<p>Barring that, is there a more elegant way to write it so I don't need to concatenate the -AA at the end and have it in the same line as the .replace?</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1457557332, "post_id": 35902152, "comment_id": 59465389, "body": "I&#39;ve come across this function, but wasn&#39;t sure if it would achieve this. Now that you confirmed, I will try to use it. Thanks a lot!"}, {"owner": {"reputation": 46, "user_id": 6037243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9tAv2.png?s=128&g=1", "display_name": "Verity", "link": "https://stackoverflow.com/users/6037243/verity"}, "reply_to_user": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1457575665, "post_id": 35902152, "comment_id": 59472807, "body": "I&#39;ve edited my answer a bit to elaborate on what I would do"}, {"owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1457618523, "post_id": 35902152, "comment_id": 59495503, "body": "Apparently this function is an Outlook-VBA function, so I can&#39;t use it in Excel VBA"}, {"owner": {"reputation": 46, "user_id": 6037243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9tAv2.png?s=128&g=1", "display_name": "Verity", "link": "https://stackoverflow.com/users/6037243/verity"}, "reply_to_user": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1457620583, "post_id": 35902152, "comment_id": 59497093, "body": "You would need to call it through the olApp (Outlook.Application object) you&#39;re creating, e.g. olApp.AdvancedSearch"}, {"owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1457624537, "post_id": 35902152, "comment_id": 59500238, "body": "Thanks a lot. it really worked, but I had to get rid of       olApp.Session.DefaultStore.IsInstantSearchEnabled part, because it would give me &quot;An object could not be found&quot; error. Do you know why this could be the case?"}, {"owner": {"reputation": 46, "user_id": 6037243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9tAv2.png?s=128&g=1", "display_name": "Verity", "link": "https://stackoverflow.com/users/6037243/verity"}, "reply_to_user": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1457629171, "post_id": 35902152, "comment_id": 59503588, "body": "I&#39;m not sure, sorry. Perhaps try checking if olApp.Session.DefaultStore Is Nothing (true false) in debug."}], "tags": [], "owner": {"reputation": 46, "user_id": 6037243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9tAv2.png?s=128&g=1", "display_name": "Verity", "link": "https://stackoverflow.com/users/6037243/verity"}, "is_accepted": true, "score": 2, "last_activity_date": 1457576006, "last_edit_date": 1457576006, "creation_date": 1457556103, "answer_id": 35902152, "question_id": 35901433, "link": "https://stackoverflow.com/questions/35901433/searching-outlook-email-and-replying-to-it-using-excel-vba/35902152#35902152", "title": "Searching Outlook email (and replying to it) using Excel VBA", "body": "<p>You can use the built in <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866933.aspx\" rel=\"nofollow\">AdvancedSearch</a> function, which returns a Search object containing items. \nThese should have date properties, so you only need your code to go through the search object mailItems and find that with the latest date ( ReceivedTime)?</p>\n\n<p>I would suggest using the bottom example on that page - it gets a table object from the search, and then you use </p>\n\n<pre><code>Set MyTable = MySearch.GetTable  \nDo Until MyTable.EndOfTable  \n    Set nextRow = MyTable.GetNextRow()  \n    Debug.Print nextRow(\"ReceivedTime\")  \nLoop\n</code></pre>\n\n<p>From there, you can do the comparison to find the latest time, and if you want to do something with the mailitem you would need to obtain the  \"EntryID\" column from the table. \nThen use the GetItemFromID method of the NameSpace object to obtain a full item, since the table returns readonly objects.</p>\n\n<p>You can also apply a date filter to the search if you wish, if you knew a minimum date for instance.</p>\n"}, {"comments": [{"owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "edited": false, "score": 0, "creation_date": 1457557233, "post_id": 35902214, "comment_id": 59465339, "body": "Thanks a lot for the input. I will let you know how this goes!"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 1, "creation_date": 1457558680, "post_id": 35902214, "comment_id": 59466161, "body": "You may be interested in learning this technique for processing folders recursively <a href=\"http://stackoverflow.com/questions/2272361/can-i-iterate-through-all-outlook-emails-in-a-folder-including-sub-folders\" title=\"can i iterate through all outlook emails in a folder including sub folders\">stackoverflow.com/questions/2272361/&hellip;</a>"}], "tags": [], "owner": {"reputation": 131, "user_id": 5990128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Llzeq.png?s=128&g=1", "display_name": "Cornel", "link": "https://stackoverflow.com/users/5990128/cornel"}, "is_accepted": false, "score": 1, "last_activity_date": 1457556281, "creation_date": 1457556281, "answer_id": 35902214, "question_id": 35901433, "link": "https://stackoverflow.com/questions/35901433/searching-outlook-email-and-replying-to-it-using-excel-vba/35902214#35902214", "title": "Searching Outlook email (and replying to it) using Excel VBA", "body": "<p>To go through all folders do this:\n  Go once through all the primary folders in Outlook and then for each major folder go through each subfolder. If you have more branches then is guess you have to add more levels to the code \"for each Folder3 in folder2.folders\". Also in the if clause you can test the date of the mail and go from the newest to the oldest. Set   <code>oMsg.display</code> to see what mail is being checked</p>\n\n<pre><code>Public Sub FORWARD_Mail_STAT_IN()\nDim Session As Outlook.NameSpace\nDim oOutLookObject As New Outlook.Application\nDim olNameSpace As NameSpace\nDim oItem As Object\nDim oMsg As Object\nDim searchkey As String\n\nSet oOutLookObject = CreateObject(\"Outlook.Application\")\nSet oItem = oOutLookObject.CreateItem(0)\nSet olNameSpace = oOutLookObject.GetNamespace(\"MAPI\")\n\nSet Session = Application.Session\nSet Folders = Session.Folders\nFor Each Folder In Folders  'main folders in Outlook\n\n        xxx = Folder.Name\n           For Each Folder2 In Folder.Folders  'all the subfolders from a main folder\n            yyy = Folder2.Name\n             Set oFolder = olNameSpace.Folders(xxx).Folders(yyy)  'in each folder we search all the emails\n\n              For Z = oFolder.Items.Count To 1 Step -1 ' For Z = 1 To oFolder.Items.Count\n                  With oFolder.Items(Z)\n                   Set oMsg = oFolder.Items(Z)\n\n                    If Format(oMsg.SentOn, \"mm/dd/yyyy\") = Format(Date, \"mm/dd/yyyy\") And InStr(1, LCase(oMsg.Subject), searchkey, vbTextCompare) &gt; 0 Then \noMsg.display\n                        '  insert code\n                        End If\n                      End With\n                  Next Z\n           Next Folder2\n        Next Folder\n</code></pre>\n"}], "owner": {"reputation": 64, "user_id": 5278917, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f25b8d72fcdafdf5c83543b22692b539?s=128&d=identicon&r=PG&f=1", "display_name": "ramesses", "link": "https://stackoverflow.com/users/5278917/ramesses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2059, "favorite_count": 0, "accepted_answer_id": 35902152, "answer_count": 2, "score": 1, "last_activity_date": 1457576006, "creation_date": 1457553537, "last_edit_date": 1531164843, "question_id": 35901433, "link": "https://stackoverflow.com/questions/35901433/searching-outlook-email-and-replying-to-it-using-excel-vba", "title": "Searching Outlook email (and replying to it) using Excel VBA", "body": "<p>I want to search ALL my outlook for latest message in a conversation (I use Subject name as search key). </p>\n\n<p>This latest message can be in Inbox, Sent Items, in a sub folder of Inbox, a sub-sub folder of Inbox (anywhere). </p>\n\n<p>I can achieve this by some very tedious code, going through every level of each major folder, but not only this method is very messy, I can't determine if this found message is the latest in this conversation. </p>\n\n<p>I have the following code, which</p>\n\n<p>--> Searches Inbox for \"searchKey\"</p>\n\n<p>--> If finds it in Inbox folder, replies to it</p>\n\n<p>--> If not, it moves into subfolders of Inbox, and continues the same process</p>\n\n<pre><code>Dim olApp As Outlook.Application\nDim olNs As Namespace\nDim Fldr As MAPIFolder\nDim olFldr As MAPIFolder\nDim olMail ' As Outlook.MailItem\nDim i As Integer\n\nSet olApp = New Outlook.Application\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet Fldr = olNs.GetDefaultFolder(olFolderInbox)\nSet olFldr = Fldr\n\ntryAgain:\n\n    For Each olMail In olFldr.Items\n        If InStr(olMail.Subject, searchKey) &lt;&gt; 0 Then\n            Set ReplyAll = olMail.ReplyAll\n            With ReplyAll\n                .HTMLBody = Msg &amp; .HTMLBody\n                emailReady = True\n                .Display\n            End With\n        End If\n    Next olMail\n\n\nIf Not emailReady Then\n    i = i + 1\n    If i &gt; Fldr.Folders.Count Then\n        MsgBox (\"The email with the given subject line was not found!\")\n        Exit Sub\n    Else\n        Set olFldr = Fldr.Folders(i)\n        GoTo tryAgain\n    End If\nEnd If\n</code></pre>\n\n<p>This code might be confusing and long, so please let me know if you need any clarification.</p>\n\n<p>The question is: How can I search through ALL Outlook, without going manually through every folder/subfolder/sub-subfolder... without this method, and find the LAST message in a specific conversation? Or, at least, how can I optimize this code so I don't miss any folder, and know the dates and times these emails were sent?</p>\n"}, {"tags": ["mysql", "sql", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 3868991, "user_type": "registered", "profile_image": "https://graph.facebook.com/538292390/picture?type=large", "display_name": "Austin Mao", "link": "https://stackoverflow.com/users/3868991/austin-mao"}, "edited": false, "score": 0, "creation_date": 1457994203, "post_id": 35901806, "comment_id": 59651051, "body": "Here is the working SQL tested within Access Update query: UPDATE [tblA] INNER JOIN [tblB] ON [tblA].sku = [tblB].[V SKU] SET [tblA].upc = [tblB]![UPC Code] WHERE ((([tblA].upc) Like &#39;<i>0000</i>&#39;)) OR ((([tblA].upc) Is Null));"}], "tags": [], "owner": {"reputation": 4114, "user_id": 1208034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uSUep.jpg?s=128&g=1", "display_name": "Max Szczurek", "link": "https://stackoverflow.com/users/1208034/max-szczurek"}, "is_accepted": false, "score": 0, "last_activity_date": 1457555256, "last_edit_date": 1457555256, "creation_date": 1457554914, "answer_id": 35901806, "question_id": 35901260, "link": "https://stackoverflow.com/questions/35901260/sql-compare-data-from-two-tables-then-return-value-from-different-column-if-cond/35901806#35901806", "title": "SQL compare data from two tables then return value from different column if conditions", "body": "<p>I created some sample data like this (and let me know if the setup of the sample data is incorrect):</p>\n\n<pre><code>create table tblA\n(\n    sku varchar(25),\n    upc varchar(25)\n)\ngo\ncreate table tblB\n(\n    sku varchar(25),\n    upc varchar(25)\n)\ngo\n\ninsert into tblA values ('sku1', null)\ninsert into tblB values ('sku1', 'correct upc #1!')\ninsert into tblA values ('sku2', 'CORRUPT UPC!')\ninsert into tblB values ('sku2', 'correct upc #2!')\ninsert into tblA values ('sku3', 'CORRUPT UPC WITH NO MATCH!')\n</code></pre>\n\n<p>Then I run these update commands:</p>\n\n<p>First, for your point #1:</p>\n\n<pre><code>update tblA set upc = tblB.upc\nfrom tblA\ninner join tblB on tblA.sku = tblB.sku and tblA.upc is null\n</code></pre>\n\n<p>Then for your point #2:</p>\n\n<pre><code>update tblA set upc = isnull(tblB.upc, '')\nfrom tblA\nleft join tblB on tblA.sku = tblB.sku \nwhere tblA.upc like 'CORRUPT%' \n-- you'll need to specify the actual criteria that makes a upc corrupted,\n-- and replace the \"like 'CORRUPT%'\" clause!\n</code></pre>\n\n<p>Afterward, this query:</p>\n\n<pre><code>select * from tblA\n</code></pre>\n\n<p>Gives you:</p>\n\n<pre><code>--sku   upc\n--sku1  correct upc #1!\n--sku2  correct upc #2!\n--sku3  &lt;blank&gt;\n</code></pre>\n\n<p>Any (uncorrupted) upc in tblA without a corresponding sku in tblB would be left alone. Does that put you on the right track?</p>\n"}], "owner": {"reputation": 17, "user_id": 3868991, "user_type": "registered", "profile_image": "https://graph.facebook.com/538292390/picture?type=large", "display_name": "Austin Mao", "link": "https://stackoverflow.com/users/3868991/austin-mao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1457555256, "creation_date": 1457552956, "question_id": 35901260, "link": "https://stackoverflow.com/questions/35901260/sql-compare-data-from-two-tables-then-return-value-from-different-column-if-cond", "title": "SQL compare data from two tables then return value from different column if conditions", "body": "<ul>\n<li><b>Environment:</b> MS Access</li>\n<li><b>Technical Area:</b> SQL/Query</li>\n<li><p><b>Situation:</b>\n<Br><Br>\nI have 2 tables, tblA, tblB.\ntblA contains 9000 products information       ==> SKU, UPC\ntblB contains manufacture 1500 products  Info ==> sku, UPC\nThe problem is the UPC on tblA has either: blank, corrupted UPC and good UPC.\nHow can I:</p>\n\n<ol>\n<li>Lookup and update good UPC from tblB if tblA!UPC is blank</li>\n<li>Determine if UPC on tblA is corrupred (e.g: 812440000000, 8450+11) then    lookup matching UPC on tblB. If no match found, return \"blank\"</li>\n<li>Keep good UPC on tblA if no matching UPC was found on tblB</li>\n</ol></li>\n</ul>\n\n<p>I want the good UPC to be updated on tblA instead of just viewing it as query.</p>\n\n<p>Thank you all!</p>\n"}, {"tags": ["vba", "excel", "ftp"], "answers": [{"tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": false, "score": 0, "last_activity_date": 1457558223, "creation_date": 1457558223, "answer_id": 35902793, "question_id": 35901015, "link": "https://stackoverflow.com/questions/35901015/pulling-images-from-a-ftp-site-to-excel/35902793#35902793", "title": "Pulling images from a FTP site to Excel", "body": "<p>I see three main questions, probably better to separate these into different questions but I'll give it a shot.</p>\n\n<ol>\n<li><p>Ignore row 2 in the first code block.</p>\n\n<p>Change <code>1</code> to <code>3</code> on this line: <code>data = wks.Range(wks.Cells(3, \"B\"), wks.Cells(lastRow, \"B\")).Value2</code>  This sets your data range starting at row 3 and ignores your two header rows.</p></li>\n<li><p>FTP link</p>\n\n<p>This is better suited for a separate question.  Start by creating a new function that handles FTP links.  Then identify which path is in the cell, i.e. does it start with http, c://, etc...  Then call appropriate function and have it return the image to the main program.</p></li>\n<li><p>Check if shape is in column A.</p>\n\n<p>Use the <code>TopLeftCell</code> attribute and see if it intersects column A</p>\n\n<pre><code>For Each shp In wks.Shapes\n  If Not Intersect(shp.TopLeftCell, Columns(1)) Is Nothing Then  '&lt;-- New Line checks if in col A\n    If shp.Type &lt;&gt; msoFormControl Then\n      ....\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 91, "user_id": 4966093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/92RpQ.png?s=128&g=1", "display_name": "proxy156", "link": "https://stackoverflow.com/users/4966093/proxy156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457558223, "creation_date": 1457552219, "question_id": 35901015, "link": "https://stackoverflow.com/questions/35901015/pulling-images-from-a-ftp-site-to-excel", "title": "Pulling images from a FTP site to Excel", "body": "<p>I have the following working codes.\nColumn B has image names, this pulls images in the selected folder that match the names in column B and inserts them into Column A (please note, first two rows are used for my header). I've noticed that the code errors if the header in B2 is missing, then the code errors out. I would like to fix this so it will only try to find images if there is a name in Range(\"B3:B1002\").</p>\n\n<pre><code>Option Explicit\nPrivate Sub Add_Images_Click()\n\n    Const EXIT_TEXT         As String = \"\"\n    Const NO_PICTURE_FOUND  As String = \"No picture found\"\n\n    Dim picName             As String\n    Dim picFullName         As String\n    Dim rowIndex            As Long\n    Dim lastRow             As Long\n    Dim selectedFolder      As String\n    Dim data()              As Variant\n    Dim wks                 As Worksheet\n    Dim Cell                As Range\n    Dim pic                 As Picture\n\n    On Error GoTo ErrorHandler\n\n    selectedFolder = GetFolder\n    If Len(selectedFolder) = 0 Then GoTo ExitRoutine\n\n    Application.ScreenUpdating = False\n\n    Set wks = ActiveSheet\n    lastRow = wks.Cells(2, \"B\").End(xlDown).Row\n    data = wks.Range(wks.Cells(1, \"B\"), wks.Cells(lastRow, \"B\")).Value2\n\n    For rowIndex = 3 To UBound(data, 1)\n        If StrComp(data(rowIndex, 1), EXIT_TEXT, vbTextCompare) = 0 Then GoTo ExitRoutine\n\n        picName = data(rowIndex, 1)\n        picFullName = selectedFolder &amp; picName\n\n        If Len(Dir(picFullName)) &gt; 0 Then\n            Set Cell = wks.Cells(rowIndex, \"A\")\n            Set pic = wks.Pictures.Insert(picFullName)\n            With pic\n                .ShapeRange.LockAspectRatio = msoFalse\n                .Height = Cell.Height\n                .Width = Cell.Width\n                .Top = Cell.Top\n                .Left = Cell.Left\n                .Placement = xlMoveAndSize\n            End With\n        Else\n            wks.Cells(rowIndex, \"A\").Value = NO_PICTURE_FOUND\n        End If\n    Next rowIndex\n\nExitRoutine:\n    Set wks = Nothing\n    Set pic = Nothing\n    Application.ScreenUpdating = True\n    Exit Sub\n\nErrorHandler:\n    MsgBox Prompt:=\"Unable to find photo\", _\n           Title:=\"An error occured\", _\n           Buttons:=vbExclamation\n    Resume ExitRoutine\nEnd Sub\n</code></pre>\n\n<p>This is the Function that has the user select the folder that contains the images when the above sub is ran. I would like to modify this if possible to also work with an URL like an FTP site. So if the images are in a folder on the users pc, it will run like below, but if the images are located in a FTP location, it will still be able to pull the images.</p>\n\n<pre><code>Private Function GetFolder() As String\n    Dim selectedFolder  As String\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .InitialFileName = Application.DefaultFilePath &amp; \"\\\"\n        .Title = \"Select the folder containing the Image/PDF files.\"\n        .Show\n\n        If .SelectedItems.Count &gt; 0 Then\n            selectedFolder = .SelectedItems(1)\n            If Right$(selectedFolder, 1) &lt;&gt; Application.PathSeparator Then _\n                selectedFolder = selectedFolder &amp; Application.PathSeparator\n        End If\n    End With\n    GetFolder = selectedFolder\nEnd Function\n</code></pre>\n\n<p>This Sub is meant to remove all images from column A. The problem is that this works too well. It is fine when used with a normal button, but when I try using a CommandButton to have my buttons on a user form, this Sub removes the CommandButton. It also removes all comments from the sheet. I would like to either limit this to only remove images, or to quarantine the code to only look at Range(\"A3:A1002\").</p>\n\n<pre><code>Private Sub Remove_Images_Click()\n'Remove Images\n\n    Dim wks         As Worksheet\n    Dim shp         As Shape\n    Dim picArray()  As String\n    Dim index       As Integer\n\n    On Error GoTo ErrorHandler\n\n    Columns(1).Replace What:=\"No Picture Found\", Replacement:=vbNullString, LookAt:=xlPart\n    Set wks = ActiveSheet\n    index = 1\n    For Each shp In wks.Shapes\n        If shp.Type &lt;&gt; msoFormControl Then\n            ReDim Preserve picArray(1 To index)\n            picArray(index) = shp.Name\n            index = index + 1\n        End If\n    Next shp\n\n    wks.Shapes.Range(picArray).Delete\n\nExitRoutine:\n    Set wks = Nothing\n    Set shp = Nothing\n    Erase picArray          \n    Exit Sub\n\nErrorHandler:\n    MsgBox Prompt:=\"Unable to find photo\", _\n           Title:=\"An error occured\", _\n           Buttons:=vbExclamation\n    Resume ExitRoutine\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3, "user_id": 6041339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47ac599705f6e1bba5068e4fcc63d20?s=128&d=identicon&r=PG&f=1", "display_name": "SadieQ", "link": "https://stackoverflow.com/users/6041339/sadieq"}, "reply_to_user": {"reputation": 1451, "user_id": 4879022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RHKqx.png?s=128&g=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4879022/techie"}, "edited": false, "score": 0, "creation_date": 1457552984, "post_id": 35900808, "comment_id": 59462882, "body": "So far, I tried a work around where I have the user select from a list (data validation) for each point (1st, 2nd, 3rd) and generate an error if they have a duplicate. Would like to get a bit more advanced if possible."}], "answers": [{"comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "reply_to_user": {"reputation": 3, "user_id": 6041339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47ac599705f6e1bba5068e4fcc63d20?s=128&d=identicon&r=PG&f=1", "display_name": "SadieQ", "link": "https://stackoverflow.com/users/6041339/sadieq"}, "edited": false, "score": 0, "creation_date": 1457616250, "post_id": 35901798, "comment_id": 59493810, "body": "Thanks!  If you don&#39;t mind clicking the green check to accept this as an answer I&#39;d appreciate it.  Helps with the points so people know I am at least somewhat reputable :).  Happy coding!"}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 0, "last_activity_date": 1457554890, "creation_date": 1457554890, "answer_id": 35901798, "question_id": 35900808, "link": "https://stackoverflow.com/questions/35900808/sortable-list-in-vba/35901798#35901798", "title": "Sortable List in VBA?", "body": "<p>For this solution I used a <code>UserForm</code> with a <code>ListBox</code> and a <code>SpinButton</code> control.</p>\n\n<p>I put a list of cells I wanted in my listbox in Column A of Sheet1.  I have a generic <code>Building 1</code>, <code>Building 2</code>, etc. through <code>Building 19</code> so that my data is contained in the range <code>A1:A19</code> of <code>Sheet1</code>.  This is arbitrary and you should change to suit your needs.</p>\n\n<p>This code basically stores the original <code>RowSource</code> that contains the items in the <code>ListBox</code>, deletes the <code>RowSource</code> from the <code>ListBox</code>, rearranges the underlying source data and then re-applies the <code>RowSource</code> to the <code>ListBox</code> in the new order after the user clicks either up or down on the <code>SpinButton</code></p>\n\n<p>I did not change the default control names (<code>UserForm1</code>, <code>SpinButton1</code>, <code>ListBox1</code>).</p>\n\n<ol>\n<li>Open the VB Editor (either Developer tab --> Visual Basic or press <kbd>ALT+F11</kbd></li>\n<li>Right click Microsoft Excel Objects --> Insert --> UserForm\n<a href=\"https://i.stack.imgur.com/WEfHX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WEfHX.png\" alt=\"enter image description here\"></a></li>\n<li>Add a <code>SpinButton</code> and a <code>ListBox</code> so the UserForm looks like so\n<a href=\"https://i.stack.imgur.com/ONT3L.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ONT3L.jpg\" alt=\"enter image description here\"></a></li>\n<li>In the VB Editor, right click <code>UserForm1</code> under Forms --> View Code</li>\n<li><p>Paste the following code in</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    'Populate the UserForm with data from range A1:A19 (arbitrary, change to suit your needs\n    ListBox1.RowSource = Sheet1.Range(Sheet1.Range(\"A1\"), Sheet1.Range(\"A1\").End(xlDown)).Address\n\nEnd Sub\n\nPrivate Sub SpinButton1_SpinDown()\n\n    With ListBox1\n            If .ListIndex = .ListCount - 1 Then Exit Sub 'No item selected or we are in the last position\n           lCurrentListIndex = .ListIndex + 1 'Get the current position of the item\n           strRowSource = .RowSource 'Get the current row source\n           strAddress = Range(strRowSource).Address 'Address of the row source range\n           strSheetName = Range(strRowSource).Parent.Name 'Grab the parent sheet name\n           .RowSource = vbNullString 'Empty the listbox\n\n           'Re-arrange the underlying data\n           With Range(strRowSource)\n            .Rows(lCurrentListIndex).Cut\n            .Rows(lCurrentListIndex + 2).Insert Shift:=xlDown\n           End With\n\n           'Re-apply the row source\n           .RowSource = strRowSource\n\n           'For continuity, select the previously selected element in its new position\n           .Selected(lCurrentListIndex) = True\n    End With\n\nEnd Sub\n\nPrivate Sub SpinButton1_SpinUp()\n      Dim lCurrentListIndex As Long\n      Dim strRowSource As String\n      Dim strAddress As String\n      Dim strSheetName As String\n\n      With ListBox1\n            If .ListIndex &lt; 1 Then Exit Sub 'No item selected or we are in the first position\n           lCurrentListIndex = .ListIndex + 1\n           strRowSource = .RowSource\n           strAddress = Range(strRowSource).Address\n           strSheetName = Range(strRowSource).Parent.Name\n           .RowSource = vbNullString\n\n           With Range(strRowSource)\n            .Rows(lCurrentListIndex).Cut\n            .Rows(lCurrentListIndex - 1).Insert Shift:=xlDown\n           End With\n\n           .RowSource = strRowSource\n           .Selected(lCurrentListIndex - 2) = True\n\n    End With\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>I tried to add comments to clarify what I am doing.  It is a slightly cumbersome method, and was adapted from code available <a href=\"http://www.ozgrid.com/VBA/listbox-up-down.htm\" rel=\"nofollow noreferrer\">here</a>.  If you click the Debug (looks like play) button the form should display and populate with the values of cells A1:A19 of Sheet1.  You can then select an item in the <code>ListBox</code> and press the up or down buttons of the <code>SpinButton</code> in order to move items up or down the list.  An important assumption is that <code>MultiSelect</code> <strong>is disabled</strong> on this <code>ListBox</code>.</p>\n\n<p>Ordinarily I would not post such an in-depth solution without seeing what you tried, but this problem piqued my curiosity.</p>\n"}], "owner": {"reputation": 3, "user_id": 6041339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a47ac599705f6e1bba5068e4fcc63d20?s=128&d=identicon&r=PG&f=1", "display_name": "SadieQ", "link": "https://stackoverflow.com/users/6041339/sadieq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 35901798, "answer_count": 1, "score": 0, "last_activity_date": 1526448957, "creation_date": 1457551525, "last_edit_date": 1526448957, "question_id": 35900808, "link": "https://stackoverflow.com/questions/35900808/sortable-list-in-vba", "title": "Sortable List in VBA?", "body": "<p>Is there a way to create a VBA user interface that will allow user to order items? See example image taken from a pdf editor. </p>\n\n<p><img src=\"https://i.stack.imgur.com/2Pwb8.png\" alt=\"sample\"> </p>\n\n<p>I want my users to be able to order data in a popout window or list and output their order to a different location. Data is a list of buildings. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 442, "user_id": 5773951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ab4118ae0aebf82f87404d8315e47eb?s=128&d=identicon&r=PG&f=1", "display_name": "dnep", "link": "https://stackoverflow.com/users/5773951/dnep"}, "is_accepted": false, "score": 0, "last_activity_date": 1457557131, "creation_date": 1457557131, "answer_id": 35902470, "question_id": 35900464, "link": "https://stackoverflow.com/questions/35900464/copying-dynamic-ranges-into-existing-workbook/35902470#35902470", "title": "Copying dynamic ranges into existing workbook", "body": "<p>It looks like you are really beginning with VBA so, I will provide some overview information.</p>\n\n<p>To do what you want, you should a VBA subroutine that can be called as a macro (from a button, keyboard shortcut etc.). There are tons of tutorials online to guide you through the basics of VBA programming, so I'll just skip to your specific problem.</p>\n\n<p>To copy the contents of a cell or a range to somewhere else, you just need an attribution (<code>=</code>) involving the objects that represent the ranges and the desired properties (depending on whether you want to copy values, text, formulas etc.). The following example copies the values of cells A1-A5 on Sheet1 to cells B1-B5 on Sheet2:</p>\n\n<pre><code>Sub CopyData()\n    WorkSheets(\"Sheet2\").Range(\"B1:B5\").Value = WorkSheets(\"Sheet1\").Range(\"A1:A5\").Value\nEnd Sub\n</code></pre>\n\n<p>In your problem, you also will need to find the first empty cell in a column, to find out where you will write your data. One simple way to do this is to probe the contents of each cell in the column, checking if it is empty, until you find one that is. This example does just that with column A of the active sheet and the sets its value to a string, check it out:</p>\n\n<pre><code>Sub FirstEmpty()\n    Dim aRow As Long\n    aRow = 1\n    While ActiveSheet.Range(\"A\" &amp; aRow).Value &lt;&gt; \"\"\n        aRow = aRow + 1\n    Wend\n    ActiveSheet.Range(\"A\" &amp; aRow).Value = \"FOUND IT!\"\nEnd Sub \n</code></pre>\n\n<p>Notice that this will count as empty a cell that has a formula whose result is an empty string. If you want to avoid this, replace the <code>.Value</code> property in the <code>While</code> statement with the <code>.Formula</code> property. There are other (probably better) ways to reach the same result - I just wanted to present an option.</p>\n\n<p>Try to combine these fragments and adapt to your problem. Experiment, google around... If you still can't solve your problem, post your code and ask for help again. Its easier to get help from the community if you already have some code and just need help to get it to work as expected. Good luck.</p>\n"}], "owner": {"reputation": 13, "user_id": 6041216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e4e63b0682c0323b710566714cd04a?s=128&d=identicon&r=PG&f=1", "display_name": "Don ", "link": "https://stackoverflow.com/users/6041216/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457557131, "creation_date": 1457550489, "last_edit_date": 1531164843, "question_id": 35900464, "link": "https://stackoverflow.com/questions/35900464/copying-dynamic-ranges-into-existing-workbook", "title": "Copying dynamic ranges into existing workbook", "body": "<p>Complete beginner to VBA and having issues copying values between Workbooks.</p>\n\n<p>My goal is to copy certain columns from a worksheet named SupExp and paste them in a different workbook with a worksheet named Expenses. The columns needed from SupExp are A:C, H:M, and O. The values I need start on row 9 for every column and any information above should be disregarded. The number of rows change every time this report comes in and this process needs to be done every time the worksheet SupExp comes in.</p>\n\n<p>When pasted into Expenses the information needs to be pasted starting on the next empty row. So for instance if there is information in A100 of Expenses the values being copied from A9 of SupExp need to start on A101 of Expenses.</p>\n\n<p>Columns A:C of SupExp match columns A:C of Expenses. Column O of SupExp needs to be placed in Column D of Expenses. Columns H:M of SupExp coincide with columns E:J.</p>\n\n<p>Thank you for any help or recommendations on where to learn how to do this.</p>\n"}, {"tags": ["vba", "if-statement"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1457550593, "post_id": 35900417, "comment_id": 59461453, "body": "Uppercase <i>C</i> and lowercase <i>c</i> are not the same, and you&#39;re testing only for lowercase <i>c</i>. <i>cass</i> matches because the <i>c</i> is lowercase; <i>Cassetti</i> does not because the <i>C</i> is UPPERCASE."}, {"owner": {"reputation": 147, "user_id": 2966885, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/687352291/picture?type=large", "display_name": "BigBlack", "link": "https://stackoverflow.com/users/2966885/bigblack"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1457720036, "post_id": 35900417, "comment_id": 59550819, "body": "I&#39;ve other if working even If I don&#39;t use uppercase"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1457720615, "post_id": 35900417, "comment_id": 59551125, "body": "Show the rest of your code. .."}, {"owner": {"reputation": 147, "user_id": 2966885, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/687352291/picture?type=large", "display_name": "BigBlack", "link": "https://stackoverflow.com/users/2966885/bigblack"}, "edited": false, "score": 0, "creation_date": 1457726736, "post_id": 35900417, "comment_id": 59554318, "body": "The code is very long, About 300 lines or more... I don&#39;t succed to format it here.. i try to copy a part of it"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 0, "last_activity_date": 1457550756, "creation_date": 1457550756, "answer_id": 35900559, "question_id": 35900417, "link": "https://stackoverflow.com/questions/35900417/vba-if-statement-dont-work-sometimes/35900559#35900559", "title": "VBA If statement don&#39;t work sometimes", "body": "<p>Use <code>Option Compare Text</code> at the top of the module where this code is placed, or, cast your strings to consistent case, e.g.:</p>\n\n<pre><code>Dim myString as Variant\nmyString = LCase(Cstr(Cells(1,5).value))\nIf InStr(1, myString, \"cass\", 1) Then\n    Cells(i, 135).Value = Cells(i, 135).Value &amp; \"/cassetti.jpg::cassetti inox;;/cassetti2.jpg::cassetti inox;;\"\nEnd If \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 2966885, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/687352291/picture?type=large", "display_name": "BigBlack", "link": "https://stackoverflow.com/users/2966885/bigblack"}, "edited": false, "score": 0, "creation_date": 1457720003, "post_id": 35900633, "comment_id": 59550797, "body": "even with like it&#39;s the same... And I&#39;ve other if with the same system and they are working even if I have Uppercase in the searched words"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 0, "last_activity_date": 1457550974, "creation_date": 1457550974, "answer_id": 35900633, "question_id": 35900417, "link": "https://stackoverflow.com/questions/35900417/vba-if-statement-dont-work-sometimes/35900633#35900633", "title": "VBA If statement don&#39;t work sometimes", "body": "<p>Try using <code>Like</code>:  </p>\n\n<pre><code>If myString Like \"cass*\" Then\n</code></pre>\n\n<p>It's more readable, much faster and case insensitive</p>\n"}], "owner": {"reputation": 147, "user_id": 2966885, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/687352291/picture?type=large", "display_name": "BigBlack", "link": "https://stackoverflow.com/users/2966885/bigblack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1457726927, "creation_date": 1457550365, "last_edit_date": 1457726927, "question_id": 35900417, "link": "https://stackoverflow.com/questions/35900417/vba-if-statement-dont-work-sometimes", "title": "VBA If statement don&#39;t work sometimes", "body": "<p>I've made a very long script to reoganize an excel file. So I'm working with several if and they work all fine. I'm trying to undestand what's wrong with theese 2 part of code:   </p>\n\n<pre><code>If InStr(1, Cells(i, 5), \"cass\", 1) Then\n    Cells(i, 135).Value = Cells(i, 135).Value &amp; \"/cassetti.jpg::cassetti inox;;/cassetti2.jpg::cassetti inox;;\"\nEnd If     \n</code></pre>\n\n<p>In the Cells 5 I've Words like \"Cassetti\" or \"Cassettiera\"  Now with word \"cass\" it write on the cell, only sometimes. This thing is driving me crazy from 2 days.. You see something that I don't see? </p>\n\n<p>Edit:\nThis is a more big part of my code:</p>\n\n<pre><code>Cells(1, 135) = \"media_gallery\"\nIf InStr(1, Cells(i, 5), \"tavol\", 1) Or InStr(1, Cells(i, 5), \"lav\", 1) Or InStr(1, Cells(i, 5), \"vasc\", 1) Then\nCells(i, 135).Value = img_tav\nEnd If\n\nIf InStr(1, Cells(i, 5), \"armadiat\", 1) Then\nCells(i, 135).Value = img_tav_arm\nEnd If\nIf InStr(1, Cells(i, 5), \"armadio\", 1) Then\nCells(i, 135).Value = img_arm\nEnd If\nIf InStr(1, Cells(i, 5), \"arm\", 1) And InStr(1, Cells(i, 5), \"cass\", 1) Then\nCells(i, 135).Value = img_cass_arm\nEnd If\nIf InStr(1, Cells(i, 5), \"caldo\", 1) Then\nCells(i, 135).Value = img_caldo\nEnd If\nIf InStr(1, Cells(i, 5), \"labirinto\", 1) Then\nCells(i, 135).Value = img_asp\nEnd If\nIf InStr(1, Cells(i, 5), \"lavatoio\", 1) Or InStr(1, Cells(i, 5), \"vasco\", 1) Then\nCells(i, 135).Value = img_lav\nEnd If\nIf (InStr(1, Cells(i, 5), \"lavat\", 1) Or InStr(1, Cells(i, 5), \"vasco\", 1)) Then\nIf InStr(1, Cells(i, 5), \"armad\", 1) Then\n       Cells(i, 135).Value = img_lav_arm\nEnd If\nEnd If\nIf InStr(1, Cells(i, 5), \"pens\", 1) And InStr(1, Cells(i, 5), \"scorr\", 1) Then\n Cells(i, 135).Value = img_pensile\nEnd If\nIf Cells(i, 5).Value Like \"*cass*\" Then\n Cells(i, 135).Value = Cells(i, 135).Value &amp; \"/cassetti.jpg::cassetti inox;;/cassetti2.jpg::cassetti     inox;;\"\nEnd If\n</code></pre>\n\n<p>And theese are variable declared at the begin of the script:</p>\n\n<pre><code>img_tav = \"/piede.jpg::piede in acciaio inox;;/saldatura.jpg::saldatura;;\"\nimg_tav_arm = \"/anta.jpg::anta inox scorrevole;;/piede.jpg::piede in acciaio    inox;;/saldatura.jpg::saldatura;;/saldatura2.jpg::saldatura;;/top-raggiato.jpg::Top raggiato  opzionale;;/fianchi.jpg::fianchi inox lisci;;\"\nimg_arm = \"/anta.jpg::anta inox scorrevole;;/piede.jpg::piede in acciaio inox;;/saldatura.jpg::saldatura;;/saldatura2.jpg::saldatura;;/fianchi.jpg::fianchi inox lisci;;\"\nimg_cass = \"/piede.jpg::piede in acciaio inox;;/saldatura.jpg::saldatura;;/saldatura2.jpg::saldatura;;/top-raggiato.jpg::Top raggiato opzionale;;\"\nimg_cass_arm = \"/piede.jpg::piede in acciaio inox;;/saldatura.jpg::saldatura;;/saldatura2.jpg::saldatura;;/top-raggiato.jpg::Top raggiato opzionale;;/fianchi.jpg::fianchi inox lisci;;\"\nimg_caldo = \"/caldo.jpg::tavolo caldo;;/anta.jpg::anta inox scorrevole;;/piede.jpg::piede in acciaio inox;;/saldatura.jpg::saldatura;;/saldatura2.jpg::saldatura;;/top-raggiato.jpg::Top raggiato opzionale;;/fianchi.jpg::fianchi inox lisci;;\"\nimg_asp = \"/labirinto.jpg::filtri a labirinto;;\"\nimg_lav = \"/troppo-pieno.jpg::Troppo Pieno;;\"\nimg_lav_arm = \"/troppo-pieno.jpg::Troppo Pieno;;/anta.jpg::anta inox scorrevole;;/piede.jpg::piede in acciaio inox;;/saldatura.jpg::saldatura;;/saldatura2.jpg::saldatura;;/top-raggiato.jpg::Top raggiato opzionale;;/fianchi.jpg::fianchi inox lisci;;\"\nimg_pensile = \"/guide-pensili.jpg::Guide Anti Sporco;;/anta.jpg::anta inox scorrevole;;\"\n</code></pre>\n\n<p>All of them are working fine but not the last If.. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 248, "user_id": 1934994, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2774b14824943127f6ade513a76a6539?s=128&d=identicon&r=PG", "display_name": "Gunnar Valur Gunnarsson", "link": "https://stackoverflow.com/users/1934994/gunnar-valur-gunnarsson"}, "reply_to_user": {"reputation": 45, "user_id": 5619877, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5973a300d98cac5d42b7db871b9b8a0e?s=128&d=identicon&r=PG&f=1", "display_name": "Foong", "link": "https://stackoverflow.com/users/5619877/foong"}, "edited": false, "score": 1, "creation_date": 1457578793, "post_id": 35903213, "comment_id": 59473718, "body": "For me it adds a table.  It is badly visible because it doesn&#39;t have any borders.  Then it gets stuck in the first cell and adds an other table in that cell and so on.  To test this better I added this:   <code>Set myTable = objDoc.Tables.Add(Range:=objWord.Selection.Range, NumRows:=4,   NumColumns:=3)</code> <code>myTable.Borders.Enable = True</code> <code>myTable.Borders.InsideLineStyle = wdLineStyleSingle</code> <code>objDoc.Characters.Last.Select</code> <code>objWord.Selection.Collapse</code>"}], "tags": [], "owner": {"reputation": 248, "user_id": 1934994, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2774b14824943127f6ade513a76a6539?s=128&d=identicon&r=PG", "display_name": "Gunnar Valur Gunnarsson", "link": "https://stackoverflow.com/users/1934994/gunnar-valur-gunnarsson"}, "is_accepted": true, "score": 2, "last_activity_date": 1457559785, "creation_date": 1457559785, "answer_id": 35903213, "question_id": 35900392, "link": "https://stackoverflow.com/questions/35900392/excel-vba-450-tables-add/35903213#35903213", "title": "Excel VBA 450 Tables.Add", "body": "<p>How about this: </p>\n\n<pre><code>objDoc.Tables.Add Range:=objWord.Selection.Range, NumRows:=4, NumColumns:=3\n</code></pre>\n\n<p>That is use objDoc instead of objWord and use the objWord.Selection instead of just Selection</p>\n"}], "owner": {"reputation": 45, "user_id": 5619877, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5973a300d98cac5d42b7db871b9b8a0e?s=128&d=identicon&r=PG&f=1", "display_name": "Foong", "link": "https://stackoverflow.com/users/5619877/foong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "accepted_answer_id": 35903213, "answer_count": 1, "score": 0, "last_activity_date": 1457559785, "creation_date": 1457550293, "question_id": 35900392, "link": "https://stackoverflow.com/questions/35900392/excel-vba-450-tables-add", "title": "Excel VBA 450 Tables.Add", "body": "<p>I'm currently learning VBA in Excel to produce Word documents from spreadsheet data.</p>\n\n<p>I got error 450 : Wrong number of arguments or invalid property assignment.</p>\n\n<p>I have no idea what's wrong. Can anyone help me?</p>\n\n<p>Other than that, what should i do to insert string inside cell in table?</p>\n\n<p>Thank you.</p>\n\n<pre><code>'Create document\nSub main()\nDim objWord As Object\nDim objDoc As Object\nSet objWord = CreateObject(\"Word.Application\")\nobjWord.Visible = True\nSet objDoc = objWord.Documents.Add()\n\nDim i As Integer\nDim strValue As String\nFor i = 1 To 5\n    objDoc.Activate\n    'define string\n    strID = Cells(i, 1)\n    strSTR = Cells(i, 2)\n    strKK = Cells(i, 3)\n    strDEF = Cells(i, 4)\n    strEX = Cells(i, 5)\n    'write the value to the document\n    objWord.Selection.TypeText Text:=strID + \". \" + strSTR + \"  \" + strKK + \"  \" + strDEF\n    'move to the next line\n    objWord.Selection.TypeParagraph\n    objWord.Tables.Add Range:=Selection.Range, NumRows:=4, NumColumns:=3\n\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457648167, "post_id": 35901545, "comment_id": 59515411, "body": "Slubee, thank you very much! I had a problem with my spreedsheet, but as soon as possible I will test the code! After this, I come back here to post a feedback. Thank&#39;s again!"}, {"owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457716592, "post_id": 35901545, "comment_id": 59548884, "body": "Something went wrong. The highlighted were the opposite that was my intention. That is, were highlighted the cells with 1 in the content.  I already tried to change the line &quot;If (ActiveCell.Row) &lt;&gt; 1 Then&quot; replacing for &quot;If (ActiveCell.Row) &lt;&gt; 0 Then&quot;. This way I got I different result but not the one I&#39;d like to."}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "reply_to_user": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457717270, "post_id": 35901545, "comment_id": 59549299, "body": "If Activecell.row &lt;&gt; 0 is to make sure you are not in the 1st row. so you want to highlight if the above cell is empty?"}, {"owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457718648, "post_id": 35901545, "comment_id": 59550052, "body": "Thanks for the explanation."}, {"owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457718721, "post_id": 35901545, "comment_id": 59550091, "body": "Anyway, I want to highlight if the above cell is not empty."}, {"owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457718801, "post_id": 35901545, "comment_id": 59550138, "body": "But this was happening above the cells with the value 1 and I would like to happen above the cells with the value 0."}, {"owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457718915, "post_id": 35901545, "comment_id": 59550193, "body": "Sorry about my difficult to explain... I&#39;m striving, but English it&#39;s not my native language and also I&#39;m very beginner in VBA."}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "reply_to_user": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457719206, "post_id": 35901545, "comment_id": 59550327, "body": "cells.find ..... line in the above code looks for 0.                                    Not IsEmpty(ActiveCell.Offset(-1).Value) is checking if the above cell is not empty"}, {"owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457721071, "post_id": 35901545, "comment_id": 59551390, "body": "Thanks for the explanation. It looks right, but something it&#39;s still not working. I thought of something that had not yet mentioned, the 0 or 1 value in the cells are result from formulas. That change anything?"}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "reply_to_user": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "edited": false, "score": 0, "creation_date": 1457723349, "post_id": 35901545, "comment_id": 59552644, "body": "Try with :                                                                                       Cells.Find(What:=0, After:=ActiveCell, LookIn:=xlValues, SearchOrder:=xlByRows, SearchDirection:=xlNext).Select"}], "tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": false, "score": 0, "last_activity_date": 1457553975, "creation_date": 1457553975, "answer_id": 35901545, "question_id": 35900282, "link": "https://stackoverflow.com/questions/35900282/vba-how-do-i-ask-to-excel-search-for-cells-with-0-in-the-content-and-higligh/35901545#35901545", "title": "VBA - How do I &quot;ask&quot; to excel search for cells with 0 in the content and higlight them if the cell above it&#39;s not empty?", "body": "<p>Make sure to change the range accordingly.</p>\n\n<pre><code>Sub Test()\nDim rng As Range, cell As Range\n\nSet rng = Range(\"A1:G100\")\nRange(\"A1\").Select\n    For Each cell In rng\n    Cells.Find(What:=0, After:=ActiveCell, SearchOrder:=xlByRows, SearchDirection:=xlNext).Select\n    If (ActiveCell.Row) &lt;&gt; 1 Then\n    If Not IsEmpty(ActiveCell.Offset(-1).Value) Then\n     ActiveCell.Select\n     With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .Color = 65535\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n         End With\n     End If\n     End If\nNext cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6041041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-l1ZvzOaE9ws/AAAAAAAAAAI/AAAAAAAAPTw/F2ZO4tDPv6c/photo.jpg?sz=128", "display_name": "Felipe Vigato Prado", "link": "https://stackoverflow.com/users/6041041/felipe-vigato-prado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457555673, "creation_date": 1457549865, "last_edit_date": 1457555673, "question_id": 35900282, "link": "https://stackoverflow.com/questions/35900282/vba-how-do-i-ask-to-excel-search-for-cells-with-0-in-the-content-and-higligh", "title": "VBA - How do I &quot;ask&quot; to excel search for cells with 0 in the content and higlight them if the cell above it&#39;s not empty?", "body": "<p>I have already searched for this but I've had no success. My understanding of VBA is very poor.  So, it's difficult to search.</p>\n\n<p>I intend to study and to learn more about this, but I need to know so much to solve this and complete a job.</p>\n\n<p>Does anyone of you could help me?</p>\n"}, {"tags": ["vba", "excel", "date-formatting"], "comments": [{"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "edited": false, "score": 0, "creation_date": 1457553596, "post_id": 35900060, "comment_id": 59463245, "body": "Thank you both for your assistance. Well, this did not resolve my issue. Both answers below are good ones, but I chose to go with Kevin&#39;s. However, I thought that since the column had dates that were formatted differently that when I ran the code for removing duplicates, that was causing the duplicates not to be removed from the worksheet. As it turns out, this was not the issue. So my hunt goes on to resolve the duplicate issue. I smell a new question coming up..."}], "answers": [{"tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 1, "last_activity_date": 1457549645, "creation_date": 1457549645, "answer_id": 35900209, "question_id": 35900060, "link": "https://stackoverflow.com/questions/35900060/copy-paste-date-format-into-a-column-on-a-ws-in-another-workbook/35900209#35900209", "title": "Copy/Paste Date format into a column on a WS in another workbook", "body": "<p>The problem is the line:</p>\n\n<p><code>sourceWorksheet.Range(\"G2\").Copy destinationWorksheet.Range(\"G2:H2000\").PasteSpecial(xlPasteFormats, Operation:=xlNone, SkipBlanks:=False)</code></p>\n\n<p>is invalid syntax. </p>\n\n<p>The Copy method has an optional argument to pass a <code>Range</code> object as the destination. By adding the <code>PasteSpecial</code> method to the range, this ceases to be valid.</p>\n\n<p>Try this:</p>\n\n<pre><code>sourceWorksheet.Range(\"G2\").Copy \ndestinationWorksheet.Range(\"G2:H2000\").PasteSpecial(xlPasteFormats, Operation:=xlNone, SkipBlanks:=False)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 6035689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5271571ebf616c124935f4d81418ace?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6035689/kevin"}, "is_accepted": true, "score": 1, "last_activity_date": 1457550136, "creation_date": 1457550136, "answer_id": 35900353, "question_id": 35900060, "link": "https://stackoverflow.com/questions/35900060/copy-paste-date-format-into-a-column-on-a-ws-in-another-workbook/35900353#35900353", "title": "Copy/Paste Date format into a column on a WS in another workbook", "body": "<p>As @Scott said, the copy line needs to be split into two lines. However, you do not need the <code>Operation:=xlNone, SkipBlanks:=False</code> parts because by default they will be set to that. The following should work. </p>\n\n<pre><code>sourceWorksheet.Range(\"G2\").Copy\ndestinationWorksheet.Range(\"G2:H2000\").PasteSpecial xlPasteFormats\n</code></pre>\n\n<p>*Note: You don't need the parenthesis to pass the parameter in this case.  </p>\n"}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 35900353, "answer_count": 2, "score": 0, "last_activity_date": 1457550136, "creation_date": 1457549163, "last_edit_date": 1531164843, "question_id": 35900060, "link": "https://stackoverflow.com/questions/35900060/copy-paste-date-format-into-a-column-on-a-ws-in-another-workbook", "title": "Copy/Paste Date format into a column on a WS in another workbook", "body": "<p>I am using data from two different sources. Each source has formatted their date/time differently. I need to put both sets of data into one worksheet and remove duplicates. The date format differences is preventing this. I am trying to copy the date format from workbook \"A\" to a column range of existing data in workbook \"B\" so that when I copy the data over from workbook \"A\" to the end of workbook \"B\", the date formats will match.</p>\n\n<p>The date format in workbook \"A\" is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9FCGV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9FCGV.png\" alt=\"enter image description here\"></a></p>\n\n<p>The Date format in workbook \"B\" is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ttTzz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ttTzz.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have supplied the entire code below. But here is the line I have added:</p>\n\n<pre><code>sourceWorksheet.Range(\"G2\").Copy destinationWorksheet.Range(\"G2:H2000\").PasteSpecial(xlPasteFormats, Operation:=xlNone, SkipBlanks:=False)\n</code></pre>\n\n<p>Which gives me the following error:</p>\n\n<p>Run-time error '1004':\nUnable to get the PasteSpecial property of the Range class</p>\n\n<p>Here is the entire code set:</p>\n\n<pre><code>Sub QA_1603_March()\n'\n    Dim ANS As Long\n    Dim LR As Long\n    Dim uRng As Range\n    Dim she As Worksheet\n\n    ANS = MsgBox(\"Is the March 2016 Swivel Master File checked out of SharePoint and currently open on this desktop?\", vbYesNo + vbQuestion + vbDefaultButton1, \"Master File Open\")\n    If ANS = vbNo Or IsWBOpen(\"Swivel - Master - March 2016\") = False Then\n        MsgBox \"The required workbook is not currently open. This procedure will now terminate.\", vbOKOnly + vbExclamation, \"Terminate Procedure\"\n        Exit Sub\n    End If\n\n    Call Verification_Format_WS\n\n    Dim sourceWorkBook As Workbook\n        Set sourceWorkBook = Workbooks(\"Verification Temp.xlsx\")\n    Dim destinationWorkbook As Workbook\n        Set destinationWorkbook = Workbooks(\"Swivel - Master - March 2016.xlsm\")\n    Dim sourceWorksheet As Worksheet\n        Set sourceWorksheet = sourceWorkBook.Sheets(\"Verification\")\n    Dim destinationWorksheet As Worksheet\n        Set destinationWorksheet = destinationWorkbook.Sheets(\"Validation\")\n\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    sourceWorksheet.Cells.EntireRow.Hidden = False\n\n    sourceWorksheet.Range(\"G2\").Copy destinationWorksheet.Range(\"G2:H2000\").PasteSpecial(xlPasteFormats, Operation:=xlNone, SkipBlanks:=False)\n\n    For LR = sourceWorksheet.Range(\"J\" &amp; Rows.Count).End(xlUp).row To 2 Step -1\n        If sourceWorksheet.Range(\"J\" &amp; LR).Value &lt;&gt; \"3\" Then\n            If uRng Is Nothing Then\n                Set uRng = sourceWorksheet.Rows(LR)\n            Else\n                Set uRng = Union(uRng, sourceWorksheet.Rows(LR))\n            End If\n        End If\n    Next LR\n\n    If Not uRng Is Nothing Then uRng.Delete\n        For Each she In destinationWorkbook.Worksheets\n        If she.FilterMode Then she.ShowAllData\n    Next\n\n    With sourceWorksheet.Sort\n        With .SortFields\n            .Clear\n            .Add Key:=Range(\"A2:A2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .Add Key:=Range(\"G2:G2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .Add Key:=Range(\"B2:B2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .Add Key:=Range(\"C2:C2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .Add Key:=Range(\"D2:D2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n            .Add Key:=Range(\"E2:E2000\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        End With\n        .SetRange Range(\"A2:AE2000\")\n        .Apply\n    End With\n\n    sourceWorksheet.Cells.WrapText = False\n\n    Dim lastRow As Long\n    lastRow = sourceWorksheet.Range(\"A\" &amp; Rows.Count).End(xlUp).row\n    Dim destinationRow As Long\n    destinationRow = destinationWorksheet.Cells(Rows.Count, 1).End(xlUp).row + 1\n    sourceWorksheet.Range(\"A2:J\" &amp; lastRow).Copy destinationWorksheet.Range(\"A\" &amp; destinationRow)\n\n    Call Verification_Save\n    Call Verification_Delete_Temp_Workbook\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n\n<p>I have tried a few variations of this from examples I have found here, but I keep getting errors of one kind or another.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1457547699, "post_id": 35899499, "comment_id": 59459558, "body": "Have you tried VBA <code>find</code> function?"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "reply_to_user": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "edited": false, "score": 0, "creation_date": 1457547819, "post_id": 35899499, "comment_id": 59459626, "body": "No, how does FInd work?"}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1457547860, "post_id": 35899499, "comment_id": 59459650, "body": "Does this code work?  If so, this question belongs on CodeReview"}, {"owner": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1457547951, "post_id": 35899499, "comment_id": 59459718, "body": "@Chrismas007 That&#39;s not a valid close reason. Vote to close because it&#39;s on-topic here, not because it may or may not be on-topic somewhere else."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "edited": false, "score": 0, "creation_date": 1457548012, "post_id": 35899499, "comment_id": 59459749, "body": "@Mast Migration is a valid VTC reason.  It is in the VTC options.  However, CodeReview is not currently an actual option, so I had to make it a custom one."}, {"owner": {"reputation": 5466, "user_id": 1803692, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/umD6Q.jpg?s=128&g=1", "display_name": "Vogel612", "link": "https://stackoverflow.com/users/1803692/vogel612"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 1, "creation_date": 1457548130, "post_id": 35899499, "comment_id": 59459830, "body": "@Chrismas007 actually ... you&#39;re wrong. But that&#39;s only because the VTC-Dialog&#39;s Design is incorrect in that regard. More info on that can be found in  <a href=\"http://meta.codereview.stackexchange.com/questions/5777/a-guide-to-code-review-for-stack-overflow-users\">A Guide to Code Review for Stack Overflow Users</a>, especially in the section &quot;What you should not do.&quot;"}, {"owner": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1457548211, "post_id": 35899499, "comment_id": 59459884, "body": "@Chrismas007 Code Review doesn&#39;t accept migrations by said menu to eliminate a whole lot of false candidates. Please take a look at <a href=\"http://meta.stackoverflow.com/q/311348/1014587\">this thread</a>, especially the answers."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "edited": false, "score": 0, "creation_date": 1457548507, "post_id": 35899499, "comment_id": 59460078, "body": "@Mast TBH, I&#39;ll just VTC as Too Broad then in the future and STILL refer them to CR.  I see that in your and Vogel&#39;s links the main counter-point is that CR doesn&#39;t want these kinds of posts.  But as a community member of SO, my purpose is to get them off SO..."}, {"owner": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "reply_to_user": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "edited": false, "score": 0, "creation_date": 1457550832, "post_id": 35899499, "comment_id": 59461598, "body": "@Chrismas007 Your purpose is to close them. Don&#39;t migrate questions if they&#39;ll get closed on the other end, that&#39;s wasting a lot of people&#39;s time."}, {"owner": {"reputation": 5954, "user_id": 4241535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b1fce746f77b5beac922733e4891f4be?s=128&d=identicon&r=PG", "display_name": "Chrismas007", "link": "https://stackoverflow.com/users/4241535/chrismas007"}, "reply_to_user": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "edited": false, "score": 0, "creation_date": 1457558184, "post_id": 35899499, "comment_id": 59465875, "body": "@Mast I&#39;m not migrating.  I&#39;m saying I think this should be closed on SO.  A moderator would have to migrate and only if 5 people voted in the same way."}], "answers": [{"comments": [{"owner": {"reputation": 1978, "user_id": 1149739, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2b604d34ffcee9eac86c075083af39d4?s=128&d=identicon&r=PG", "display_name": "wilsjd", "link": "https://stackoverflow.com/users/1149739/wilsjd"}, "edited": false, "score": 0, "creation_date": 1457549770, "post_id": 35899559, "comment_id": 59460917, "body": "Why the downvote? I&#39;d be happy to know why someone disagrees why what I mentioned wouldn&#39;t be more efficient for the OP."}], "tags": [], "owner": {"reputation": 1978, "user_id": 1149739, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2b604d34ffcee9eac86c075083af39d4?s=128&d=identicon&r=PG", "display_name": "wilsjd", "link": "https://stackoverflow.com/users/1149739/wilsjd"}, "is_accepted": false, "score": 1, "last_activity_date": 1457547695, "creation_date": 1457547695, "answer_id": 35899559, "question_id": 35899499, "link": "https://stackoverflow.com/questions/35899499/how-to-make-a-worksheet-function-more-efficient/35899559#35899559", "title": "How to make a worksheet function more efficient?", "body": "<p>You should avoid iterating through the rows as much as possible. I would suggest that you instead do a paste of the Vlookup function in the range of the CS column.</p>\n"}, {"comments": [{"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457549686, "post_id": 35899740, "comment_id": 59460857, "body": "I had misspelled the formula. Try now."}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457549854, "post_id": 35899740, "comment_id": 59460975, "body": "It ran ok this time, but no values were returned to my sheet1. Does wks. need to be added so that the formula is referencing Sheet2?"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457550176, "post_id": 35899740, "comment_id": 59461186, "body": "Now I&#39;m getting. &quot;Object variable or With block variable not set&quot;"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457550389, "post_id": 35899740, "comment_id": 59461308, "body": "It runs through like 6 lines and then stops and gives me the error message."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457550438, "post_id": 35899740, "comment_id": 59461341, "body": "Why don&#39;t you assign a variable to the result first and see what you get when you debug it? The code is working fine for me (use last edit)."}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457550826, "post_id": 35899740, "comment_id": 59461597, "body": "Are some of your lookup values numbers?"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457550900, "post_id": 35899740, "comment_id": 59461647, "body": "it works for the 6 lines. all lookup values are numbers"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457551485, "post_id": 35899740, "comment_id": 59461990, "body": "No change. same 5 lines coming through"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457551535, "post_id": 35899740, "comment_id": 59462022, "body": "maybe because it&#39;s not finding on that value. maybe iferror resume next?"}, {"owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "reply_to_user": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457551676, "post_id": 35899740, "comment_id": 59462106, "body": "You get &quot;Object variable or With block variable not set&quot;, right? Are you using the exact same code I wrote?"}, {"owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "edited": false, "score": 0, "creation_date": 1457551772, "post_id": 35899740, "comment_id": 59462170, "body": "Yes, same code. It works when I add an On Error Resume next, but I should probably use some sort of IF statement instead."}], "tags": [], "owner": {"reputation": 743, "user_id": 5817689, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/52cff1bc3c3ad1b173c26301158e7003?s=128&d=identicon&r=PG&f=1", "display_name": "N. Pavon", "link": "https://stackoverflow.com/users/5817689/n-pavon"}, "is_accepted": false, "score": 1, "last_activity_date": 1457551164, "last_edit_date": 1457551164, "creation_date": 1457548274, "answer_id": 35899740, "question_id": 35899499, "link": "https://stackoverflow.com/questions/35899499/how-to-make-a-worksheet-function-more-efficient/35899740#35899740", "title": "How to make a worksheet function more efficient?", "body": "<p>This is how it would go if you used the <code>find</code> function:</p>\n\n<pre><code>Dim ws as worksheet, wks as worksheet, lastrow as long, i as long\nSet ws = Sheets(\"Sheet1\")\nSet wks = Sheets(\"Sheet2\")\n\nLastrow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 to Lastrow\nws.Range(\"CS\" &amp; i) = wks.Range(\"B:B\").find(ws.Range(\"B\" &amp; i).Text, , xlValues).Offset(0, 22).Value\nNext i\n</code></pre>\n\n<p>Let me know if it works.</p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1457552796, "creation_date": 1457552796, "answer_id": 35901212, "question_id": 35899499, "link": "https://stackoverflow.com/questions/35899499/how-to-make-a-worksheet-function-more-efficient/35901212#35901212", "title": "How to make a worksheet function more efficient?", "body": "<p>I would remove all the reading and writing on cells from the loop:</p>\n\n<pre><code>Dim rg_table As Range, rg_lookup As Range, values(), r&amp;\n\nSet rg_table = [Sheet1].UsedRange\nSet rg_lookup = [Sheet2!B2:X100000]\n\n' load the values to search\nvalues = rg_table.columns(\"B\").Value\n\n' lookup the values\nFor r = 2 To UBound(values)\n  values(r, 1) = Application.VLookup(values(r, 1), rg_lookup, 23, False)\nNext\n\n' write the results to the sheet\nrg_table.columns(\"CS\") = values\n</code></pre>\n"}], "owner": {"reputation": 984, "user_id": 1813558, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/81efad0c3c7cb541ed3ed8a5158bdb47?s=128&d=identicon&r=PG", "display_name": "Chris2015", "link": "https://stackoverflow.com/users/1813558/chris2015"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 35901212, "answer_count": 3, "score": 0, "last_activity_date": 1457552796, "creation_date": 1457547487, "question_id": 35899499, "link": "https://stackoverflow.com/questions/35899499/how-to-make-a-worksheet-function-more-efficient", "title": "How to make a worksheet function more efficient?", "body": "<p>I am trying to make a worksheet function that loops through rows more efficient. Here is what I have -</p>\n\n<pre><code>Dim ws as worksheet, wks as worksheet, lastrow as long, i as long\nSet ws = Sheets(\"Sheet1\")\nSet wks = Sheets(\"Sheet2\")\n\nWith ws\nLastrow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 to Lastrow\n.Range(\"CS\" &amp; i) = Application.Vlookup(ws.Range(\"B\" &amp; i), wks.Range(\"B2:X100000\"),23,false)\nnext\nend with\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1457545965, "post_id": 35898622, "comment_id": 59458487, "body": "This question requires an opinionated answer and is not proper for StackOverflow."}, {"owner": {"reputation": 113, "user_id": 5882487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WoJTdJtvDbI/AAAAAAAAAAI/AAAAAAAAACE/kOLmaw_rzGc/photo.jpg?sz=128", "display_name": "Tiggerous", "link": "https://stackoverflow.com/users/5882487/tiggerous"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457555984, "post_id": 35898622, "comment_id": 59464641, "body": "I&#39;m asking for an opinion rooted in fact, qualifying &#39; most elegant&#39; as most efficient in terms of speed of execution."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457556517, "post_id": 35898622, "comment_id": 59464948, "body": "Well at least two people with enough rep points to close this question agree with me.  Questions like these are better suited for code review than Stack overflow."}, {"owner": {"reputation": 113, "user_id": 5882487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WoJTdJtvDbI/AAAAAAAAAAI/AAAAAAAAACE/kOLmaw_rzGc/photo.jpg?sz=128", "display_name": "Tiggerous", "link": "https://stackoverflow.com/users/5882487/tiggerous"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457557085, "post_id": 35898622, "comment_id": 59465268, "body": "OK, apologies. I&#39;ll re-think."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 1, "creation_date": 1457546006, "post_id": 35898946, "comment_id": 59458512, "body": "IIRC, Range.Interior.ColorIndex does not work on conditionally formatted colors."}, {"owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "reply_to_user": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1457619924, "post_id": 35898946, "comment_id": 59496574, "body": "You are correct. I&#39;ve never used it for conditional formatting and had no idea. Thanks."}], "tags": [], "owner": {"reputation": 762, "user_id": 3508218, "user_type": "registered", "profile_image": "https://graph.facebook.com/502317116/picture?type=large", "display_name": "asp8811", "link": "https://stackoverflow.com/users/3508218/asp8811"}, "is_accepted": false, "score": 0, "last_activity_date": 1457545817, "creation_date": 1457545817, "answer_id": 35898946, "question_id": 35898622, "link": "https://stackoverflow.com/questions/35898622/most-elegant-solution-to-copy-only-selected-rows-from-a-large-amount-of-text-bas/35898946#35898946", "title": "Most elegant solution to copy only selected rows from a large amount of text based on cell fill colour", "body": "<p>Personally, I would go the easy route and do a nested loop to check the cells in used rows and columns on each page for formatting, then use a counter (n=n+1) to paste whatever information you find to row(n) on the summary sheet. That way, you are not deleting any rows.</p>\n\n<p>Use an If statement on Range(\"CR\").Interior.ColorIndex to check if the color matches what you're looking for. You could also use a Select Case for multiple colors.</p>\n"}, {"tags": [], "owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "is_accepted": true, "score": 0, "last_activity_date": 1457546259, "creation_date": 1457546259, "answer_id": 35899075, "question_id": 35898622, "link": "https://stackoverflow.com/questions/35898622/most-elegant-solution-to-copy-only-selected-rows-from-a-large-amount-of-text-bas/35899075#35899075", "title": "Most elegant solution to copy only selected rows from a large amount of text based on cell fill colour", "body": "<p>In addition to asp8811's answer, to write elegant, fast code in Excel VBA, you should seek to minimize your use of the Range object and especially the Range.Copy method. Something like the following is preferable to Range.Copy:</p>\n\n<pre><code>Dim vCopy As Variant, vPaste As Variant\nvCopy = IteratingSheet.UsedRange.Value\nIf vCopy(a, b) = ConditionalFormattingCriteria Then\n    vPaste(x, y) = vCopy(a, b)\nEnd If\n\nWith SummarySheet\n    .Range(.Cells(1, 1), .Cells(UBound(vPaste), UBound(vPaste, 2))).Value = vPaste\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5882487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-WoJTdJtvDbI/AAAAAAAAAAI/AAAAAAAAACE/kOLmaw_rzGc/photo.jpg?sz=128", "display_name": "Tiggerous", "link": "https://stackoverflow.com/users/5882487/tiggerous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "closed_date": 1457730510, "accepted_answer_id": 35899075, "answer_count": 2, "score": -2, "last_activity_date": 1457547174, "creation_date": 1457544793, "last_edit_date": 1457547174, "question_id": 35898622, "link": "https://stackoverflow.com/questions/35898622/most-elegant-solution-to-copy-only-selected-rows-from-a-large-amount-of-text-bas", "closed_reason": "Opinion-based", "title": "Most elegant solution to copy only selected rows from a large amount of text based on cell fill colour", "body": "<p>I have run into issues creating an application for use in my workplace. The workbook is composed of a varying number of similar subsheets and one summary sheet. Each subsheet has 70 predefined areas for user text entry, though normally the majority of these would not be used. Any text entered by a user cause the cells in which it is entered conditionally formatted one of three colours.</p>\n\n<p>I'm attempting to write a macro which will copy sequentially all of the user entered text in the subsheets into a list in the summary sheet. I intially thought that the best way to do this was to copy all user entered text and then delete the entire row of any text which didn't match the desired criteria. However, having written a macro which loops through all sheets and copies all the user entered text quickly correctly I've discovered that the formatting is not carried through. I therefore cannot delete the rows based on their format. (I've been using the basic copying method below)</p>\n\n<pre><code>.Range(x, x).Copy Worksheets(\"Summary Sheet\").Cells(x, x)\n</code></pre>\n\n<p>Should I either: \nA) Modify my code to check and copy row by row only the text in the subsheets that matches my criteria \nB) Use a PasteSpecial command instead of the simpler copy command I have been using (see above) and then delete rows based on their formatting as previously intended\nC) Some other method?</p>\n\n<p>What is the most elegant solution? To clarify, I am primarily concerned about the load on my computer that any given solution would require and thus the ultimate speed of execution. Any thoughts appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1457544472, "creation_date": 1457544472, "answer_id": 35898514, "question_id": 35898458, "link": "https://stackoverflow.com/questions/35898458/method-of-range-object-worksheet-failed-error-in-copying-and-pasting-data-from-a/35898514#35898514", "title": "Method of Range Object_Worksheet failed error in copying and pasting data from a worksheet to another", "body": "<p>Change NextRow to NextRow1.  Right now you are calling a variable that doesn't exist.</p>\n\n<p>Or you can do the opposite (NextRow1 to NextRow)</p>\n\n<p>Same with LastRow and LastRow1</p>\n"}], "owner": {"reputation": 3, "user_id": 5913867, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dPjhqou4GO8/AAAAAAAAAAI/AAAAAAAABUU/azTdI7CTRf4/photo.jpg?sz=128", "display_name": "Daniele Casciaro", "link": "https://stackoverflow.com/users/5913867/daniele-casciaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457544472, "creation_date": 1457544336, "question_id": 35898458, "link": "https://stackoverflow.com/questions/35898458/method-of-range-object-worksheet-failed-error-in-copying-and-pasting-data-from-a", "title": "Method of Range Object_Worksheet failed error in copying and pasting data from a worksheet to another", "body": "<p>I am trying to copy and paste data from an input sheet into an output sheet, and once the data is in the next spreadsheet, it will be filled down the next rows from a starting date to an ending date. </p>\n\n<p>As is, the code gets me the following errors when debugging:\nws1.Range(\"A\" &amp; NextRow) = Method of Range Object_Worsheet failed; same for ws1.Range(\"B\" &amp; NextRow); ws1.Range(\"C\" &amp; NextRow) etc...</p>\n\n<p>ws1.Cells(LastRow, \"H\") = Application-defined or object-defined error.</p>\n\n<p>Also, I noticed that when I set RawDataEntries it equals 37, that is the last non-empty row, but then when I try to use the For loop and point my mouse on RawDataEntries in For n=1 To RawDataEntries, VBA returns me a value of 105, which seems to come out of nowhere.</p>\n\n<p>I think the logic behind the code is correct. What might have gone wrong? </p>\n\n<pre><code>Sub AddFlight_Click()\nConst RNG_END_DT As String = \"N2\"\nDim NextRow1 As Long, LastRow1 As Long, ws1 As Worksheet\nDim ws2 As Worksheet, RawDataEntries As Long\n\n\nSet ws1 = Sheets(\"JetAir Flight Plan\")\nSet ws2 = Sheets(\"TUI B Flight Plan\")\nLastRow1 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nNextRow1 = LastRow1 + 1\nRawDataEntries = ws2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor n = 1 To RawDataEntries\n\n'Data from an input worksheet is copied and pasted into specific cells in an output worksheet.\n\n    ws1.Range(\"A\" &amp; NextRow).Value = ws2.Range(\"A\" &amp; n).Value\n    ws1.Range(\"B\" &amp; NextRow).Value = ws2.Range(\"B\" &amp; n).Text\n    ws1.Range(\"D\" &amp; NextRow).Value = ws2.Range(\"D\" &amp; n).Text\n    ws1.Range(\"E\" &amp; NextRow).Value = ws2.Range(\"E\" &amp; n).Text\n    ws1.Range(\"F\" &amp; NextRow).Value = ws2.Range(\"F\" &amp; n).Text\n    ws1.Range(\"G\" &amp; NextRow).Value = ws2.Range(\"G\" &amp; n).Text\n    ws1.Range(RNG_END_DT).Value = ws2.Range(\"H\" &amp; n).Value\n\n'A series of dates is created from a starting date\n'    to an ending date in column A of ws1.\n\n    ws1.Range(\"A\" &amp; NextRow).DataSeries Rowcol:=xlColumns, _\n        Type:=xlChronological, Date:=xlDay, Step:=7, _\n        Stop:=ws1.Range(RNG_END_DT).Value, Trend:=False\n\n'The data filled in the last row with the userform data through\n' the first part of the macro will be copied and pasted in\n' the next row until there is a blank cell in column A.\n\n    LastRow1 = ws1.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    ws1.Range(ws1.Range(\"B\" &amp; NextRow), ws1.Cells(LastRow, \"H\")).FillDown\n\n'We repeat the process for other rows on the sheet data are pulled from\n\nNext n\n</code></pre>\n\n<p>Thanks a lot. </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "formula"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1457545082, "last_edit_date": 1457545082, "creation_date": 1457544110, "answer_id": 35898360, "question_id": 35898326, "link": "https://stackoverflow.com/questions/35898326/excel-formula-for-removing-leading-1-on-phone-number-if-present/35898360#35898360", "title": "Excel Formula for removing leading 1 on phone number if present", "body": "<p>Use this simple formula:</p>\n\n<pre><code>=--Right(E2,10)\n</code></pre>\n\n<p>The Right() Function turns it into text so the <code>--</code> turns it back to a number.</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "edited": false, "score": 0, "creation_date": 1457547759, "post_id": 35898402, "comment_id": 59459593, "body": "You rock! The below formula worked perfectly. The 11 digit number had no dashes or spaces. :) =IF(LEN(A1)=11, RIGHT(A1,10),A1)"}], "tags": [], "owner": {"reputation": 1355, "user_id": 2635566, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/AIEWh.jpg?s=128&g=1", "display_name": "BobNoobGuy", "link": "https://stackoverflow.com/users/2635566/bobnoobguy"}, "is_accepted": true, "score": 2, "last_activity_date": 1457544198, "creation_date": 1457544198, "answer_id": 35898402, "question_id": 35898326, "link": "https://stackoverflow.com/questions/35898326/excel-formula-for-removing-leading-1-on-phone-number-if-present/35898402#35898402", "title": "Excel Formula for removing leading 1 on phone number if present", "body": "<p>Try this if you are sure the value are clean and no spaces and dash</p>\n\n<pre><code>=IF(LEN(A1)=11, RIGHT(A1,10),A1)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1457546176, "post_id": 35898633, "comment_id": 59458627, "body": "The <a href=\"https://support.office.com/en-us/article/RIGHT-RIGHTB-functions-240267EE-9AFA-4639-A02B-F19E1786CF2F\" rel=\"nofollow noreferrer\">RIGHT function</a> returns the ten-right-most digits regardless of what the 11th digit is or even if there isn&#39;t an 11th digit. The <code>&quot;[&gt;1999999999]0000000000;;;&quot;</code> format mask only produces a ten-digit number if the first digit starts with at least a <b>2</b>; nothing if it starts with a 1 or is a nine-or-less digit number."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457546338, "post_id": 35898633, "comment_id": 59458739, "body": "And we look for the 2 because US Area codes start with 201 and go up.  I see, It is a way to check if the data is valid."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1457544812, "creation_date": 1457544812, "answer_id": 35898633, "question_id": 35898326, "link": "https://stackoverflow.com/questions/35898326/excel-formula-for-removing-leading-1-on-phone-number-if-present/35898633#35898633", "title": "Excel Formula for removing leading 1 on phone number if present", "body": "<p>Try,</p>\n\n<pre><code>=IFERROR(--TEXT(--RIGHT(E2, 10), \"[&gt;1999999999]0000000000;;;\"), \"\")\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4775461, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f941a4f3881a600cf969e7f7449ceca1?s=128&d=identicon&r=PG&f=1", "display_name": "joel", "link": "https://stackoverflow.com/users/4775461/joel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15382, "favorite_count": 0, "accepted_answer_id": 35898402, "answer_count": 3, "score": 0, "last_activity_date": 1532718714, "creation_date": 1457544012, "last_edit_date": 1531164843, "question_id": 35898326, "link": "https://stackoverflow.com/questions/35898326/excel-formula-for-removing-leading-1-on-phone-number-if-present", "title": "Excel Formula for removing leading 1 on phone number if present", "body": "<p>I am needing to create a formula that removes the leading 1 from a 11 digit phone number as shown below. </p>\n\n<p>I would also like the formula to exclude any 10 numbers that doesn't have a leading 1.</p>\n\n<p>I am trying to have my list all the same with just 10 digits.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8vyq9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8vyq9.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["arrays", "vba", "average"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 0, "last_activity_date": 1457544452, "last_edit_date": 1457544452, "creation_date": 1457543985, "answer_id": 35898317, "question_id": 35898057, "link": "https://stackoverflow.com/questions/35898057/average-within-an-array/35898317#35898317", "title": "average within an array", "body": "<p>You would move the desired values into a 1D array, then use the application.Average() function.  For example:</p>\n\n<pre><code>Dim rwarr() As Double\n\nFor i = 1 To UBound(TMP, 1)\n    ReDim rwarr(1 To UBound(TMP, 2)) As Double\n    For j = 1 To UBound(TMP, 2)\n        rwarr(j) = TMP(i, j)\n    Next j\n    results(i, 1) =  Application.Average(rwarr)\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5999607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3094f460155b1391a38ec196d116061?s=128&d=identicon&r=PG&f=1", "display_name": "centurion79b", "link": "https://stackoverflow.com/users/5999607/centurion79b"}, "edited": false, "score": 0, "creation_date": 1457606188, "post_id": 35898737, "comment_id": 59486804, "body": "Thanks for the help Scott!"}], "tags": [], "owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "is_accepted": false, "score": 0, "last_activity_date": 1457545131, "creation_date": 1457545131, "answer_id": 35898737, "question_id": 35898057, "link": "https://stackoverflow.com/questions/35898057/average-within-an-array/35898737#35898737", "title": "average within an array", "body": "<p>Here's a function that can take the average of multiple columns in each row of a 2-D array.</p>\n\n<pre><code>Public Function AverageRowsIn2DArray(Arr As Variant, LBoundCol As Integer, UBoundCol As Integer) As Variant\n    Dim iNumValues As Integer\n    iNumValues = UBoundCol - LBoundCol + 1\n    If iNumValues &lt; 1 Then GoTo ErrHandler\n    On Error GoTo ErrHandler\n    Dim retArr As Variant\n    Dim inArr As Variant\n    If TypeName(Arr) = \"Range\" Then\n        inArr = Arr.Value\n    Else\n        inArr = Arr\n    End If\n\n    ReDim retArr(1 To UBound(inArr), 1 To 1)\n\n    Dim i As Integer, j As Integer\n    Dim dSum As Double\n\n    For i = 1 To UBound(inArr)\n        dSum = 0\n        For j = LBoundCol To UBoundCol\n            dSum = dSum + inArr(i, j)\n        Next j\n        retArr(i, 1) = dSum / iNumValues\n    Next i\n\n    AverageRowsIn2DArray = retArr\n    Exit Function\n\nErrHandler:\n    AverageRowsIn2DArray = 0\nEnd Function\n</code></pre>\n\n<p>In your specific case, you would want to call </p>\n\n<pre><code>Dim results() as Double\nresults = AverageRowsIn2DArray(TMP, 13, 15)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5999607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3094f460155b1391a38ec196d116061?s=128&d=identicon&r=PG&f=1", "display_name": "centurion79b", "link": "https://stackoverflow.com/users/5999607/centurion79b"}, "is_accepted": false, "score": 0, "last_activity_date": 1457612619, "last_edit_date": 1457612619, "creation_date": 1457604524, "answer_id": 35913382, "question_id": 35898057, "link": "https://stackoverflow.com/questions/35898057/average-within-an-array/35913382#35913382", "title": "average within an array", "body": "<p>Thanks for the Function Scott.  I did modify it slightly to limit the input to a single row.  It's working great!! Thank you.  Here is the modified Function:</p>\n\n<pre><code>Public Function AverageRowsIn2DArray(Arr As Variant, Nrow As Integer, LBoundCol As Integer, UBoundCol As Integer) As Variant\n    Dim iNumValues As Integer\n    iNumValues = UBoundCol - LBoundCol + 1\n    If iNumValues &lt; 1 Then GoTo ErrHandler\n    On Error GoTo ErrHandler\n    Dim retArr As Integer\n    Dim inArr As Variant\n    If TypeName(Arr) = \"Range\" Then\n        inArr = Arr.Value\n    Else\n        inArr = Arr\n    End If\n\n    Dim i As Integer, j As Integer\n    Dim dSum As Double\n\n\n    For i = LBoundCol To UBoundCol\n        dSum = dSum + inArr(Nrow, i)\n    Next i\n    retArr = dSum / iNumValues\n\n\n    AverageRowsIn2DArray = retArr\n    Erase inArr\n    retArr = 0\n    Exit Function\n\nErrHandler:\n    AverageRowsIn2DArray = 0\nEnd Function\n</code></pre>\n\n<p>now my call is,</p>\n\n<pre><code>results(i, 4) = AverageRowsIn2DArray(TMP, i, 13, 15)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1457612534, "creation_date": 1457612534, "answer_id": 35916397, "question_id": 35898057, "link": "https://stackoverflow.com/questions/35898057/average-within-an-array/35916397#35916397", "title": "average within an array", "body": "<p>Assuming that you have less than 30K elements in the first rank, use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction object</a> <a href=\"https://support.office.com/en-us/article/index-function-0ee99cef-a811-4762-8cfb-a222dd31368a\" rel=\"nofollow\">INDEX function</a> to peel off a row to process an <a href=\"https://support.office.com/en-us/article/AVERAGE-function-047BAC88-D466-426C-A32B-8F33EB960CF6\" rel=\"nofollow\">AVERAGE</a> from.</p>\n\n<pre><code>Sub avgVals()\n    Dim tmp As Variant, results As Variant, a As Long\n\n    With Worksheets(\"Sheet2\")\n        With .Cells(1, 1).CurrentRegion\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                tmp = .Cells.Value2\n            End With\n\n            ReDim results(LBound(tmp, 1) To UBound(tmp, 1), 1 To 1)\n            For a = LBound(tmp, 1) To UBound(tmp, 1)\n                results(a, 1) = Application.Average(Application.Index(tmp, a, 0))\n            Next a\n\n            With .Resize(.Rows.Count - 1, 1).Offset(1, .Columns.Count)\n                .Cells.Resize(UBound(results, 1), UBound(results, 2)) = results\n            End With\n\n        End With\n\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"nofollow\">Excel Application object</a> to facilitate INDEX slicing an array apart is not the fastest method and ultimately it has limiations but it can provide an expedient method of achieving your <a href=\"https://support.office.com/en-us/article/AVERAGE-function-047BAC88-D466-426C-A32B-8F33EB960CF6\" rel=\"nofollow\">AVERAGE</a> results for smaller batches.</p>\n"}], "owner": {"reputation": 1, "user_id": 5999607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3094f460155b1391a38ec196d116061?s=128&d=identicon&r=PG&f=1", "display_name": "centurion79b", "link": "https://stackoverflow.com/users/5999607/centurion79b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1455, "favorite_count": 1, "answer_count": 4, "score": 0, "last_activity_date": 1457612619, "creation_date": 1457543253, "question_id": 35898057, "link": "https://stackoverflow.com/questions/35898057/average-within-an-array", "title": "average within an array", "body": "<p>I am looking for a way to elegantly average within a 2D array.  I have code that works for a small range of elements but I need something that I can use for a large number of elements.</p>\n\n<p>Here is the code I have for a small number of elements.  This code will average 3 elements on the same row and return the answer to a results array.  How can I rewrite this if 50 elements?  As you can imagine this approach will not work well for a large number of elements.</p>\n\n<pre><code>    For i = 1 To UBound(TMP)\n                results(i, 1) = ((TMP(i, 13) + TMP(i, 14) + TMP(i, 15)) / 3)\n    Next i\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1457541791, "post_id": 35897389, "comment_id": 59455542, "body": "<code>MD</code> is undefined unless you&#39;ve gone and made it some kind of public or private var."}, {"owner": {"reputation": 1, "user_id": 6040218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336ce9125c5b8338ebcdef4549f5f936?s=128&d=identicon&r=PG&f=1", "display_name": "user506606", "link": "https://stackoverflow.com/users/6040218/user506606"}, "edited": false, "score": 0, "creation_date": 1457542135, "post_id": 35897389, "comment_id": 59455787, "body": "Yes Jeeped. Many thanks ! Appreciate it."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1457541903, "creation_date": 1457541903, "answer_id": 35897560, "question_id": 35897389, "link": "https://stackoverflow.com/questions/35897389/object-required-runtime-error-424-using-vlookup-to-populate-textbox-in-userfor/35897560#35897560", "title": "Object Required Runtime error 424 . Using Vlookup to populate textbox in userform", "body": "<p><code>MD</code> is undefined unless you've gone and made it some kind of public or private var. From your narrative this may be <code>Worksheets(\"MD\")</code>.</p>\n\n<pre><code>Private Sub cmdcheck_Click()\n\n    Me.txtfirstnm = Application.VLookup(Me.txtmobno, Worksheets(\"MD\").Range(\"a1:i10\"), 2, 0)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457542433, "post_id": 35897599, "comment_id": 59456007, "body": "See how a Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx\" rel=\"nofollow noreferrer\">.CodeName property</a> differs from a Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\">.Name property</a>."}], "tags": [], "owner": {"reputation": 1, "user_id": 6040218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336ce9125c5b8338ebcdef4549f5f936?s=128&d=identicon&r=PG&f=1", "display_name": "user506606", "link": "https://stackoverflow.com/users/6040218/user506606"}, "is_accepted": false, "score": 0, "last_activity_date": 1457542031, "creation_date": 1457542031, "answer_id": 35897599, "question_id": 35897389, "link": "https://stackoverflow.com/questions/35897389/object-required-runtime-error-424-using-vlookup-to-populate-textbox-in-userfor/35897599#35897599", "title": "Object Required Runtime error 424 . Using Vlookup to populate textbox in userform", "body": "<p>so I figured that even if you rename the sheets in vba you use Sheet1 Sheet 2 and so on ... so replacing MD with Sheet1 worked !</p>\n"}], "owner": {"reputation": 1, "user_id": 6040218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336ce9125c5b8338ebcdef4549f5f936?s=128&d=identicon&r=PG&f=1", "display_name": "user506606", "link": "https://stackoverflow.com/users/6040218/user506606"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1457542031, "creation_date": 1457541452, "last_edit_date": 1531164843, "question_id": 35897389, "link": "https://stackoverflow.com/questions/35897389/object-required-runtime-error-424-using-vlookup-to-populate-textbox-in-userfor", "title": "Object Required Runtime error 424 . Using Vlookup to populate textbox in userform", "body": "<p>I have a multipage userform called UserForm2. I am taking a 10 digit input from user in a textbox called txtmobno (short for mobile number) and then intend to use that input as an argument of vlookup function to get firstname from a worksheet called MD. Once, I have the first name as returned by vlookup, I want to populate textbox called txtfirstnm on UserForm2 with this firstname. The textbox should populate on clicking a command button called cmdcheck. But I am getting an error \"Object Required\". My code looks like this. What am I missing ? Thanks in advance</p>\n\n<pre><code>Private Sub cmdcheck_Click()\n\nMe.txtfirstnm = Application.WorksheetFunction.VLookup(Me.txtmobno, MD.Range(\"a1:i10\"), 2, 0)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1457540991, "post_id": 35897058, "comment_id": 59454965, "body": "Application.StatusBar = &quot;X/X&quot; - You could try using this? you can put any string into it but remember to return it to &quot;&quot; after use. I use this to stop the not responding message, just post this in a few of your loops. Obv replace &quot;X/X&quot; with something like i &amp; &quot;/&quot; &amp; dU1.Count - 1"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 3, "creation_date": 1457541007, "post_id": 35897058, "comment_id": 59454974, "body": "Try adding <code>Application.ScreenUpdating = False</code> at the beginning and then setting it back to true just before the end of the Sub with <code>Application.ScreenUpdating = True</code>"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1457541032, "post_id": 35897058, "comment_id": 59454987, "body": "To keep Excel responsive, add the line <code>DoEvents</code> just after the <code>For k = 2 To lrU</code> line. That lets Excel handle any pending events which may have built up"}, {"owner": {"reputation": 21, "user_id": 6002548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398d71560cd623edf13ed301e14c2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "KML", "link": "https://stackoverflow.com/users/6002548/kml"}, "edited": false, "score": 0, "creation_date": 1457541289, "post_id": 35897058, "comment_id": 59455198, "body": "Just tried, <code>Application.ScreenUpdating = False</code> it doesn&#39;t seem to make a difference with Excel stop responding, thanks for the suggestion, will leave it in place as sure it makes it quicker (certainly didn&#39;t stop responding quite as quickly)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1457542553, "post_id": 35897058, "comment_id": 59456089, "body": "<code>ReDim Preserve</code> is an expensive operation, especially performing it so many times in a loop. If you could describe what you&#39;re <i>actually trying to do</i> (not the code, but what is the <i>intent</i> of the code?) there may be a better way to handle this..."}, {"owner": {"reputation": 21, "user_id": 6002548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398d71560cd623edf13ed301e14c2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "KML", "link": "https://stackoverflow.com/users/6002548/kml"}, "edited": false, "score": 0, "creation_date": 1457543539, "post_id": 35897058, "comment_id": 59456805, "body": "Cheers, with the <code>Application.StatusBar = &quot;X&#47;X&quot;</code> and <code>DoEvents</code> it works perfectly stops Not responding, and gives me an idea of where it&#39;s at! :)"}, {"owner": {"reputation": 21, "user_id": 6002548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398d71560cd623edf13ed301e14c2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "KML", "link": "https://stackoverflow.com/users/6002548/kml"}, "edited": false, "score": 0, "creation_date": 1457543846, "post_id": 35897058, "comment_id": 59457039, "body": "Sure thing David, There should be two pictures in my original post before and after, that is what I&#39;m trying to achieve. I have 1426 records, out of those records I need to merge the contents of rows which have the same Name (A1) [They can be put next to each other if easier]. There&#39;ll only ever be two rows with the same name, and there wont be any issue with data existing in both rows in the same column, if data is in one of the rows, that same field will be blank in the other. Just need to get it all on one line :)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6002548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398d71560cd623edf13ed301e14c2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "KML", "link": "https://stackoverflow.com/users/6002548/kml"}, "edited": false, "score": 0, "creation_date": 1457543277, "post_id": 35897610, "comment_id": 59456611, "body": "That&#39;s awesome, that and the <code>DoEvents</code> work perfectly! The status bar is perfect, just running it now, looks like my code is possibly doing too much or something :/ Waiting to see if it&#39;ll repeat 757 times or not lol Cheers for the help --- Currently at <code>0&#47;757 - 23&#47;50 - 400&#47;1426</code>"}, {"owner": {"reputation": 343, "user_id": 5103770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a5f1c3817c808ae0036a22d25db7853?s=128&d=identicon&r=PG&f=1", "display_name": "Stadem", "link": "https://stackoverflow.com/users/5103770/stadem"}, "edited": false, "score": 0, "creation_date": 1457546889, "post_id": 35897610, "comment_id": 59459045, "body": "Some other ways to speed up this code: 1) <code>Application.Calculation = xlCalculationManual</code> before the beginning of the loop, 2) make a variant array, declare it as <code>Worksheets(&quot;Lookup&quot;).Range(&quot;B2:AX&quot; &amp; lrU).Value</code>, and loop over that array with j and k instead. See <a href=\"http://stackoverflow.com/q/13016249/5103770\">this question</a> for lots of good ideas."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1457606022, "post_id": 35897610, "comment_id": 59486679, "body": "You could also setup timers if you was really concerned about speed, would help you work out where is taking the most time. And as always taking any sheet reading out will speed up VBA code - by that I mean read the data into an array once at the start and then read out once at the end."}], "tags": [], "owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "is_accepted": false, "score": 0, "last_activity_date": 1457542058, "creation_date": 1457542058, "answer_id": 35897610, "question_id": 35897058, "link": "https://stackoverflow.com/questions/35897058/excel-not-responding-vba/35897610#35897610", "title": "Excel Not Responding VBA", "body": "<p>Example using the .statusbar and doevents (compliments of barrowc) methods</p>\n\n<pre><code>Sub OnOneLine()\n\nDim dU1 As Object, cU1 As Variant, iU1 As Long, lrU As Long\nDim MyArray() As Variant\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim h As Integer\n\nSet dU1 = CreateObject(\"Scripting.Dictionary\")\nlrU = Worksheets(\"LOOKUP\").Cells(Rows.Count, 1).End(xlUp).Row\ncU1 = Worksheets(\"LOOKUP\").Range(\"A2:A\" &amp; lrU)\nFor iU1 = 1 To UBound(cU1, 1)\ndU1(cU1(iU1, 1)) = 1\nNext iU1\n\nFor i = 0 To dU1.Count - 1\nApplication.StatusBar = i &amp; \"/\" &amp; dU1.Count - 1\nReDim MyArray(1 To 1) As Variant\n\nFor j = 2 To 50\n    a = 0\n    Application.StatusBar = i &amp; \"/\" &amp; dU1.Count - 1 &amp; \" - \" &amp; j &amp; \"/50\"\n    For k = 2 To lrU\n        Application.StatusBar = i &amp; \"/\" &amp; dU1.Count - 1 &amp; \" - \" &amp; j &amp; \"/50\" &amp; \" - \" &amp; k &amp; \"/\" &amp; lrU\n        DoEvents\n        If (Worksheets(\"LOOKUP\").Cells(k, 1).Value = dU1.keys()(i) And Worksheets(\"LOOKUP\").Cells(k, j).Value &lt;&gt; \"\") Then\n                MyArray(UBound(MyArray)) = Worksheets(\"LOOKUP\").Cells(k, j).Value\n                ReDim Preserve MyArray(1 To UBound(MyArray) + 1) As Variant\n                a = a + 1\n        End If\n    Next\n    If a = 0 Then\n                MyArray(UBound(MyArray)) = \"\"\n                ReDim Preserve MyArray(1 To UBound(MyArray) + 1) As Variant\n    End If\nNext\nWorksheets(\"Index\").Cells(i + 2, 1) = dU1.keys()(i)\n\nFor h = 2 To UBound(MyArray)\n        Worksheets(\"Index\").Cells(i + 2, h) = MyArray(h - 1)\nNext\nNext\nApplication.StatusBar = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1457546645, "creation_date": 1457546645, "answer_id": 35899200, "question_id": 35897058, "link": "https://stackoverflow.com/questions/35897058/excel-not-responding-vba/35899200#35899200", "title": "Excel Not Responding VBA", "body": "<p>I believe Excel is overloaded by the task. It would be more efficient if there were no cell reading and no \"ReDim Preserve\" inside the loop.\nTry this to collapse you data:</p>\n\n<pre><code>Const column_id = 1\nConst column_first = 2\nConst column_second = 4\n\nDim table As Range, data(), indexes As New Collection, index&amp;, r&amp;, c&amp;\n\n' get the range and the data\nSet table = [LOOKUP!A1].CurrentRegion\ndata = table.Value2\n\n' store the indexes for the rows were the first dataset is not empty\nFor r = 2 To UBound(data)\n  If data(r, column_first) = Empty Then Exit For\n  indexes.Add r, data(r, column_id)\nNext\n\n' collapse the data were the second dataset is not empty\nFor r = 2 To UBound(data)\n  If Not VBA.IsEmpty(data(r, column_second)) Then\n    index = indexes(data(r, column_id))\n    For c = column_second To UBound(data, 2)\n      data(index, c) = data(r, c)\n      data(r, c) = Empty\n    Next\n    data(r, column_id) = Empty\n  End If\nNext\n\n'copy the data back to the sheet\ntable = data\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6002548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/398d71560cd623edf13ed301e14c2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "KML", "link": "https://stackoverflow.com/users/6002548/kml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1457546645, "creation_date": 1457540548, "last_edit_date": 1457542954, "question_id": 35897058, "link": "https://stackoverflow.com/questions/35897058/excel-not-responding-vba", "title": "Excel Not Responding VBA", "body": "<p>I am running a script which merges rows with the same name together, joining the data from each together, like so:</p>\n\n<p>Before:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CyNB8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CyNB8.png\" alt=\"enter image description here\"></a></p>\n\n<p>After:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ncrop.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ncrop.png\" alt=\"enter image description here\"></a></p>\n\n<p>The script works, but upon using it with more columns (45), and more rows (1000+) it causes Excel to stop responding, and usually crash before it can even complete. I was wondering, as it works with less columns (albeit still very slow and showing as not responding), is there a way to get it to do it in manageable chunks? Or make it less likely to stop responding/give some hint on progress (As it's hard to tell if it's still working/how long is left, or if it's simply crashed and no longer doing anything - attempting 64-bit of Office as 32-bit was installed for some reason, may help)</p>\n\n<pre><code>Sub OnOneLine()\n\nDim dU1 As Object, cU1 As Variant, iU1 As Long, lrU As Long\nDim MyArray() As Variant\nDim i As Integer\nDim j As Integer\nDim k As Integer\nDim h As Integer\n\nSet dU1 = CreateObject(\"Scripting.Dictionary\")\nlrU = Worksheets(\"LOOKUP\").Cells(Rows.Count, 1).End(xlUp).Row\ncU1 = Worksheets(\"LOOKUP\").Range(\"A2:A\" &amp; lrU)\nFor iU1 = 1 To UBound(cU1, 1)\ndU1(cU1(iU1, 1)) = 1\nNext iU1\n\nFor i = 0 To dU1.Count - 1\nReDim MyArray(1 To 1) As Variant\n\nFor j = 2 To 50\n    a = 0\n    For k = 2 To lrU\n        If (Worksheets(\"LOOKUP\").Cells(k, 1).Value = dU1.keys()(i) And Worksheets(\"LOOKUP\").Cells(k, j).Value &lt;&gt; \"\") Then\n                MyArray(UBound(MyArray)) = Worksheets(\"LOOKUP\").Cells(k, j).Value\n                ReDim Preserve MyArray(1 To UBound(MyArray) + 1) As Variant\n                a = a + 1\n        End If\n    Next\n    If a = 0 Then\n                MyArray(UBound(MyArray)) = \"\"\n                ReDim Preserve MyArray(1 To UBound(MyArray) + 1) As Variant\n    End If\nNext\nWorksheets(\"Index\").Cells(i + 2, 1) = dU1.keys()(i)\n\nFor h = 2 To UBound(MyArray)\n        Worksheets(\"Index\").Cells(i + 2, h) = MyArray(h - 1)\nNext\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "syntax", "vba"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 0, "creation_date": 1457542720, "post_id": 35896922, "comment_id": 59456208, "body": "Thanxs @Hansup Sorry to bother.  I&#39;ll go to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194626.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff194626.aspx</a> - before asking next time."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 1, "creation_date": 1457542918, "post_id": 35896922, "comment_id": 59456358, "body": "No bother, John.  Good to see you again.  I don&#39;t understand why you would need to go to the web, though.  Can&#39;t you use Access&#39; built-in help?"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 1, "creation_date": 1457543142, "post_id": 35896922, "comment_id": 59456523, "body": "BTW, check out <code>Debug.Print AccessError(2342)</code> in the Immediate window.  The template text for that error message includes more detail which would have clarified the situation at the outset.  I don&#39;t know why the error dialog only showed you part of it.  But <code>AccessError()</code> is another useful tool to keep in your toolbox.  Regards."}, {"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 0, "creation_date": 1457624146, "post_id": 35896922, "comment_id": 59499958, "body": "While here at the Company, the built-in help isn&#39;t always helpful, so I usually disregard that feature."}, {"owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 0, "creation_date": 1457624176, "post_id": 35896922, "comment_id": 59499983, "body": "Using Debug.Print AccessError(2342) gets the following in the immediate window: &quot;A RunSQL action requires an argument consisting of an SQL statement.@For example, an action query that appends records starts with INSERT INTO. A data-definition query that creates a table starts with CREATE TABLE.@@1@1@3698@1&quot; - Thanxs"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "edited": false, "score": 1, "creation_date": 1457624343, "post_id": 35896922, "comment_id": 59500098, "body": "Your&#39;re welcome.  Yes, it would have been useful if the error dialog showed you more of that message."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1457541287, "last_edit_date": 1457541287, "creation_date": 1457540244, "answer_id": 35896922, "question_id": 35896765, "link": "https://stackoverflow.com/questions/35896765/sql-syntax-issue-ms-access-vba/35896922#35896922", "title": "SQL Syntax Issue MS Access VBA", "body": "<p>You can't use <code>DoCmd.RunSQL</code> with a plain <code>SELECT</code> query. </p>\n\n<p>From the <em>DoCmd.RunSQL Method</em> help topic ...</p>\n\n<blockquote>\n  <p>A string expression that's a valid SQL statement for an action query\n  or a data-definition query. It uses an INSERT INTO, DELETE,\n  SELECT...INTO, UPDATE, CREATE TABLE, ALTER TABLE, DROP TABLE, CREATE\n  INDEX, or DROP INDEX statement. Include an IN clause if you want to\n  access another database.</p>\n</blockquote>\n\n<p>If your intention is to view the results from that query in Datasheet View, create a saved query with its SQL.  </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim strSelect As String\n\nstrSelect = \"SELECT ... blah, blah, blah\"\nDebug.Print strSelect '&lt;- inspect this in Immediate window; Ctrl+g will take you there\nSet db = CurrentDb\nSet qdf = db.CreateQueryDef(\"YourQueryNameHere\", strSelect)\n</code></pre>\n\n<p>Then you can open the saved query with <code>DoCmd.OpenQuery</code> ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenQuery \"YourQueryNameHere\"\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4601655, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh4.googleusercontent.com/-bMOUaEZ_Yh4/AAAAAAAAAAI/AAAAAAAAAFM/oa9q6gxp9Q8/photo.jpg?sz=128", "display_name": "John Shaw", "link": "https://stackoverflow.com/users/4601655/john-shaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 1, "accepted_answer_id": 35896922, "answer_count": 1, "score": 1, "last_activity_date": 1457541287, "creation_date": 1457539831, "last_edit_date": 1457540485, "question_id": 35896765, "link": "https://stackoverflow.com/questions/35896765/sql-syntax-issue-ms-access-vba", "title": "SQL Syntax Issue MS Access VBA", "body": "<p>I'm having problems with the syntax: \nI transferred this from SQL Design View to VBA.  [area] is numeric.  I'm simply asking you guys to do a cursory review and tell me if anything Jumps out at you.</p>\n\n<pre><code>DoCmd.RunSQL \"SELECT 'VCAP0112' AS VCAP0112, VCAP0112.[RECV IND] AS OMU, VCAP0112.[LEGACY ACCT], Sum(VCAP0112.[1 to 30 Day]) AS [0 - 30], \" _\n        &amp; \"Sum(VCAP0112.[31 to 60 Day]) AS [31 - 60], Sum(VCAP0112.[61 to 90 Day]) AS [61 - 90], Sum(VCAP0112.[91 to 120 Day]) AS [91 -  120], \" _ \n        &amp; \"Sum(VCAP0112.[Greater than 120]) AS [+120], Sum(VCAP0112.[Pmt Difference]) AS TOTAL \" _\n        &amp; \"FROM Urcrosswalk INNER JOIN VCAP0112 ON Urcrosswalk.[Legacy GL] = VCAP0112.[LEGACY ACCT] \" _\n        &amp; \"WHERE (((Left([VCAP0112].[area], 2))=80 Or (Left([VCAP0112].[area], 2))= 81)) \" _\n        &amp; \"GROUP BY 'VCAP0112', VCAP0112.[RECV IND], VCAP0112.[LEGACY ACCT] \" _\n        &amp; \"HAVING (((VCAP0112.[RECV IND])='O' Or (VCAP0112.[RECV IND])='M' Or (VCAP0112.[RECV IND])='U'));\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JBYmE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JBYmE.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "loops", "if-statement", "row"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457541628, "post_id": 35896736, "comment_id": 59455442, "body": "Wouldn&#39;t it be much easier to format the table as such and ask Excel to do the formatting with <code>.ListObjects.Add(xlSrcRange, Range(&quot;I12:I&quot; &amp; 12 + i),, xlYes).Name = &quot;YourTableName&quot;</code>? Alternatively, you could also use the conditional formatting using a formula to determine the cell format with <code>=mod(row(), 2)</code>. Conditional formatting allowed you to change the background color and the border lines even prior to Office 2007+."}, {"owner": {"reputation": 1, "user_id": 6040452, "user_type": "registered", "profile_image": "https://graph.facebook.com/1111087205602932/picture?type=large", "display_name": "Nasser Alfaraj", "link": "https://stackoverflow.com/users/6040452/nasser-alfaraj"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457544065, "post_id": 35896736, "comment_id": 59457193, "body": "I don&#39;t know how to exactly do that,  I&#39;m a student doing this for a class assignment.   I&#39;m not sure how to incorporate i in =mod(row(), 2)."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6040452, "user_type": "registered", "profile_image": "https://graph.facebook.com/1111087205602932/picture?type=large", "display_name": "Nasser Alfaraj", "link": "https://stackoverflow.com/users/6040452/nasser-alfaraj"}, "edited": false, "score": 0, "creation_date": 1457552985, "post_id": 35898658, "comment_id": 59462884, "body": "I have a table, that adds items the user inputs, every time the user inputs an item number, a new raw of data is added to the table, and so on. I&#39;m trying to make every other row that is added to the table yellow"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 1, "user_id": 6040452, "user_type": "registered", "profile_image": "https://graph.facebook.com/1111087205602932/picture?type=large", "display_name": "Nasser Alfaraj", "link": "https://stackoverflow.com/users/6040452/nasser-alfaraj"}, "edited": false, "score": 0, "creation_date": 1457555669, "post_id": 35898658, "comment_id": 59464452, "body": "This solution makes every other row blue. You may certainly change it to be yellow in your case."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1457544872, "creation_date": 1457544872, "answer_id": 35898658, "question_id": 35896736, "link": "https://stackoverflow.com/questions/35896736/vba-excel-fill-every-other-executed-row-with-a-color/35898658#35898658", "title": "VBA excel, fill every other executed row with a color", "body": "<p>Based on your comment I am posting the solution using the conditional formatting:</p>\n\n<ol>\n<li>Select the cells which you would like to format.</li>\n<li>Select conditional formatting from the menu.</li>\n<li>Click on \"Use a formula to determine which cells to format\"</li>\n<li>Enter the formula I posted above <code>=mod(row(), 2)</code></li>\n<li>Make the formatting choices you want and confirm with OK.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/8CNGJ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8CNGJ.gif\" alt=\"enter image description here\"></a></p>\n\n<p>Note, if you record your actions with the Excel macro recorder then you can also incorporate the VBA code into your program.</p>\n"}], "owner": {"reputation": 1, "user_id": 6040452, "user_type": "registered", "profile_image": "https://graph.facebook.com/1111087205602932/picture?type=large", "display_name": "Nasser Alfaraj", "link": "https://stackoverflow.com/users/6040452/nasser-alfaraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 838, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1512900329, "creation_date": 1457539756, "last_edit_date": 1512900329, "question_id": 35896736, "link": "https://stackoverflow.com/questions/35896736/vba-excel-fill-every-other-executed-row-with-a-color", "title": "VBA excel, fill every other executed row with a color", "body": "<p>I am having trouble with this part of my code. So far it's correct, but I am required to fill every other row with a color, and all rows with borders</p>\n\n<p>Purpose of full code: everytime the user presses the add item button, the procedure runs, and adds the data row to the following row of a table.</p>\n\n<pre><code>If IsNumeric(Quantity) And Quantity &gt;= 1 Then\n  While Not IsEmpty(Range(\"I12\").Offset(i, 0))\n    i = i + 1\n  Wend\n  Range(\"G13\").Offset(i - 1, 0).Value = item_no\n  Range(\"H13\").Offset(i - 1, 0).Value = itemDescription\n  Range(\"I13\").Offset(i - 1, 0).Value = Quantity\n  Range(\"J13\").Offset(i - 1, 0).Select\n  Selection.Offset(0, 0) = Quantity * itemValue\nElse:\n  Quantity = False Or Quantity = vbCancel\n  QtyError = MsgBox(\"Please enter a valid purchase quantity!\", _\n        vbCritical, \"Incorrect Purchase Quantity\")\nEnd If\n</code></pre>\n"}, {"tags": ["c#", "vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1457537937, "post_id": 35895770, "comment_id": 59452658, "body": "you&#39;d use an excel application class in c#, then use the same prefixed by this eg excel.application x, then x.activeworkbook ? Have you managed any code?  Also, may have more luck posting in c#"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1457538456, "post_id": 35895770, "comment_id": 59453092, "body": "What&#39;s wrong with using <code>WorksheetFunction.Min(</code> and <code>WorksheetFunction.Max(</code> or <code>Application.Min(</code> and <code>Application.Max(</code>?"}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457538512, "post_id": 35895770, "comment_id": 59453144, "body": "Are you sure it&#39;s treating the data in the range as dates and not strings?"}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "edited": false, "score": 0, "creation_date": 1457538591, "post_id": 35895770, "comment_id": 59453195, "body": "WorksheetFunction only gives me &quot;Equals&quot; or &quot;ReferenceEquals&quot; after the period."}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457540341, "post_id": 35895770, "comment_id": 59454531, "body": "So @Ralph got me thinking. I was pretty sure it shouldnt be as difficult as it seems, and the commands should be similar enough. so i did a little digging and found where i was going wrong (or more specifically where i wasnt going). edited my code to show the working variant in case anyone needs it in future and +1&#39;d Ralph for the kick in the brain. :)"}, {"owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457692418, "post_id": 35895770, "comment_id": 59532140, "body": "Meant to say, @Ralph if you post your response as an answer i can accept it."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1457696866, "post_id": 35895770, "comment_id": 59534994, "body": "@DDuffy Thank you for the offer. I&#39;d be glad to accept the credits for this. Yet, I don&#39;t think this would be honest since you had already the answer within your question when you mentioned <code>SYear = Format(WorksheetFunction.Min(Range(&quot;T1:T&quot; &amp; DataInputRows)), &quot;dd&#47;MM&#47;yyyy&quot;)</code> (which was already the right direction and merely needed some code tweaking). So, I propose that you either delete the question or answer the question yourself (and earn your next badge if the answer gets a score of 3 or more). Thanks again for the offer though. Self-learning is always the best and what we encourage here."}], "answers": [{"tags": [], "owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "is_accepted": true, "score": 1, "last_activity_date": 1457705606, "creation_date": 1457705606, "answer_id": 35942435, "question_id": 35895770, "link": "https://stackoverflow.com/questions/35895770/get-minimum-and-maximum-date-from-a-column-in-excel-c/35942435#35942435", "title": "Get minimum and maximum date from a column in excel. C#", "body": "<p>So @Ralph got me thinking. I was pretty sure it shouldnt be as difficult as it seems, and the commands should be similar enough. so i did a little digging and found where i was going wrong (or more specifically where i wasnt going). edited my code to show the working variant in case anyone needs it in future and +1'd Ralph for the kick in the brain. :) </p>\n\n<pre><code>DataInputRows = InputSheet.UsedRange.Rows.Count;\n                Excel.Range rng = (Excel.Range)InputSheet.Cells[2, 19];\n                rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                rng = (Excel.Range)InputSheet.Cells[2, 20];\n                rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                rng = (Excel.Range)InputSheet.Cells[2, 22];\n                rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                SourceRange.Sort(SourceRange.Columns[20, Type.Missing], Excel.XlSortOrder.xlAscending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlYes, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal);\n\n\n                Excel.WorksheetFunction wsf = ObjApp.WorksheetFunction;\n\n                rng = (Excel.Range)InputSheet.Cells[2, 20];\n                var SYear = wsf.Min(rng);\n                DateTime dt = DateTime.FromOADate(SYear);\n                MessageBox.Show(dt.ToString());\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 1753935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2mkbh.jpg?s=128&g=1", "display_name": "DDuffy", "link": "https://stackoverflow.com/users/1753935/dduffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1336, "favorite_count": 0, "accepted_answer_id": 35942435, "answer_count": 1, "score": 1, "last_activity_date": 1457705606, "creation_date": 1457537226, "last_edit_date": 1457540454, "question_id": 35895770, "link": "https://stackoverflow.com/questions/35895770/get-minimum-and-maximum-date-from-a-column-in-excel-c", "title": "Get minimum and maximum date from a column in excel. C#", "body": "<p>I am trying to return the minimum and maximum dates in a column in an excel sheet. \ni have a program that i created in VBA, that i am rewriting in C# and am not quite sure on this part.\nThe original code i used was;</p>\n\n<pre><code>WB.Activate\n    DataInputRows = ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible).Rows.Count\n    ActiveSheet.Range(\"S2:T\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).NumberFormat = \"dd/mm/yyyy\"\n    ActiveSheet.Range(\"V2:V\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).NumberFormat = \"dd/mm/yyyy\"\n    ActiveSheet.Range(\"A1:\" &amp; LastColumn &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).Sort _\n        Key1:=Range(\"T1\"), Header:=xlYes\n\nSYear = Format(WorksheetFunction.Min(Range(\"T1:T\" &amp; DataInputRows)), \"dd/MM/yyyy\")\nEYear = Format(WorksheetFunction.Max(Range(\"T1:T\" &amp; DataInputRows)), \"dd/MM/yyyy\")\n</code></pre>\n\n<p>I have the sort and format area covered, but i cant quite get the \"SYear =\" or \"EYear = \" bit nailed down. </p>\n\n<p>Does anyone know a \"Simple\" way of finding the minimum and maximum value from a column?</p>\n\n<p>The code i have in c# so far is;</p>\n\n<pre><code>                            DataInputRows = InputSheet.UsedRange.Rows.Count;\n                        Excel.Range rng = (Excel.Range)OutputSheet.Cells[2, 19];\n                        rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                        rng = (Excel.Range)OutputSheet.Cells[2, 20];\n                        rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                        rng = (Excel.Range)OutputSheet.Cells[2, 22];\n                        rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                        SourceRange.Sort(SourceRange.Columns[20, Type.Missing], Excel.XlSortOrder.xlAscending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlYes, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal);\n\n                        var SYear = (This is where i need the minimum value of column T (20))\n</code></pre>\n\n<p>GOT IT!!</p>\n\n<pre><code>                    DataInputRows = InputSheet.UsedRange.Rows.Count;\n                    Excel.Range rng = (Excel.Range)InputSheet.Cells[2, 19];\n                    rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                    rng = (Excel.Range)InputSheet.Cells[2, 20];\n                    rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                    rng = (Excel.Range)InputSheet.Cells[2, 22];\n                    rng.EntireColumn.NumberFormat = \"dd/MM/yyyy\";\n                    SourceRange.Sort(SourceRange.Columns[20, Type.Missing], Excel.XlSortOrder.xlAscending, Type.Missing, Type.Missing, Excel.XlSortOrder.xlAscending, Type.Missing, Excel.XlSortOrder.xlAscending, Excel.XlYesNoGuess.xlYes, Type.Missing, Type.Missing, Excel.XlSortOrientation.xlSortColumns, Excel.XlSortMethod.xlPinYin, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal, Excel.XlSortDataOption.xlSortNormal);\n\n\n                    Excel.WorksheetFunction wsf = ObjApp.WorksheetFunction;\n\n                    rng = (Excel.Range)InputSheet.Cells[2, 20];\n                    var SYear = wsf.Min(rng);\n                    DateTime dt = DateTime.FromOADate(SYear);\n                    MessageBox.Show(dt.ToString());\n</code></pre>\n\n<p>Thank you to Ralph for the jumpstart.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1457539047, "post_id": 35895608, "comment_id": 59453563, "body": "Are you talking about internet links such as www.stackoverflow.com or are you talking about file links such as C:\\YourFolder\\YourFIle.xls or maybe intranet files such as //YourIntranet/YourSite/YourFile.pdf or maybe even only links within a file from one sheet to another?"}, {"owner": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457543275, "post_id": 35895608, "comment_id": 59456609, "body": "@ Ralph I am talking about images link please check the samples below <a href=\"http://ecx.images-amazon.com/images/I/81I2yVZ25LL._UX695_.jpg\" rel=\"nofollow noreferrer\">ecx.images-amazon.com/images/I/81I2yVZ25LL._UX695_.jpg</a> <a href=\"http://ecx.images-amazon.com/images/I/81jY-fVj4cL._UX695_.jpg\" rel=\"nofollow noreferrer\">ecx.images-amazon.com/images/I/81jY-fVj4cL._UX695_.jpg</a> <a href=\"http://ecx.images-amazon.com/images/I/81LEfaH%2BeML._UY695_.jpg\" rel=\"nofollow noreferrer\">ecx.images-amazon.com/images/I/81LEfaH%2BeML._UY695_.jpg</a> <a href=\"http://ecx.images-amazon.com/images/I/81LEfaH%2BeML._UY695_.jpg\" rel=\"nofollow noreferrer\">ecx.images-amazon.com/images/I/81LEfaH%2BeML._UY695_.jpg</a> <a href=\"http://ecx.images-amazon.com/images/I/81I2yVZ2L._UX695_.jpg\" rel=\"nofollow noreferrer\">ecx.images-amazon.com/images/I/81I2yVZ2L._UX695_.jpg</a> <a href=\"http://ecx.images-amazon.com/images/I/81jY-fVj4L._UX695_.jpg\" rel=\"nofollow noreferrer\">ecx.images-amazon.com/images/I/81jY-fVj4L._UX695_.jpg</a>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457543610, "post_id": 35895608, "comment_id": 59456865, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1118221/sort-dead-hyperlinks-in-excel-with-vba\">Sort dead hyperlinks in Excel with VBA?</a>"}, {"owner": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457546244, "post_id": 35895608, "comment_id": 59458678, "body": "the answer is not working for me i don&#39;t have idea for First add a reference to Microsoft XML V3 (or above), using Tools-&gt;References. Then paste this code:"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1457546470, "post_id": 35895608, "comment_id": 59458817, "body": "Here you can read and learn how to add a reference in the VBE: <a href=\"http://www.cpearson.com/excel/missingreferences.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/missingreferences.aspx</a>"}], "owner": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457536822, "creation_date": 1457536822, "last_edit_date": 1531161705, "question_id": 35895608, "link": "https://stackoverflow.com/questions/35895608/deadlinks-or-url-checker-using-macro-excel", "title": "Deadlinks or url checker using macro excel", "body": "<p>Please need help, I am trying to search for a formula or macro formula for checking links for example if i paste a link on the entire column a and column c then the result will show on column b and d.\"YES\" if the link is existing then \"NO\" if the links is not exist </p>\n"}, {"tags": ["excel", "search-engine", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1457536939, "post_id": 35895523, "comment_id": 59451816, "body": "Yes it is possible. Get started on some code (the <a href=\"https://support.office.com/en-us/article/Step-1-Start-with-the-macro-recorder-6DC53056-1DE1-4483-AA07-63E4E0EFE3C2\" rel=\"nofollow noreferrer\">macro recorder</a> should be a good start) then come back with your copde if you have a problem."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4495961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8e224fad6bc6db735cdc93148a6339c?s=128&d=identicon&r=PG&f=1", "display_name": "Salim Chorfi", "link": "https://stackoverflow.com/users/4495961/salim-chorfi"}, "edited": false, "score": 0, "creation_date": 1457964590, "post_id": 35896583, "comment_id": 59631968, "body": "Hello Jcarroll, Thanks a lot for the answer, i&#39;m not sure how the code works. How do you launch de macro and on which cell do you index the word you are searching? Thanks again!"}, {"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "reply_to_user": {"reputation": 5, "user_id": 4495961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8e224fad6bc6db735cdc93148a6339c?s=128&d=identicon&r=PG&f=1", "display_name": "Salim Chorfi", "link": "https://stackoverflow.com/users/4495961/salim-chorfi"}, "edited": false, "score": 0, "creation_date": 1458132191, "post_id": 35896583, "comment_id": 59720937, "body": "@SalimChorfi Please see my updated answer, it should be more useful now. But let me know if you have more questions."}], "tags": [], "owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "is_accepted": false, "score": 0, "last_activity_date": 1458132138, "last_edit_date": 1458132138, "creation_date": 1457539372, "answer_id": 35896583, "question_id": 35895523, "link": "https://stackoverflow.com/questions/35895523/find-copy-and-paste-search-engine-in-excel/35896583#35896583", "title": "Find, copy and paste search engine in Excel", "body": "<p>Sub CreateList()</p>\n\n<pre><code>Application.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nDim LastRow As Long\nDim I As Integer\nDim J As Integer\nDim srchtxt As String\nDim celltxt As String\n\n\n\n'Determines last row of database worksheet to know what range to loop through\nLastRow = Worksheets(\"DB\").Cells.Find(What:=\"*\", After:=Range(\"A1\"), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n'Gets the text or value to be searched\nsrchtxt = Worksheets(\"SearchWS\").Range(\"B5\") '***Change cell to search\n\n'Clear research sheet, the destination sheet\nWorksheets(\"Research\").Cells.Clear\n\n'Activate DataBase sheet\nWorksheets(\"DB\").Activate\n\n'Loops through and copies all rows with desired value or text, pasting them in the research sheet. j keeps track of the next empty row.\n'The InStr and UCase ensure capitalization doesn't cause a problem. You may not want this if you need exact match.\nJ = 2 '*** Change the first row to paste\nFor I = 2 To LastRow\n    celltxt = Worksheets(\"DB\").Cells(I, 1).Text 'Gets the value from the DB worksheet ***Change the column to seach in\n    If InStr(1, UCase(celltxt), UCase(srchtxt)) Then 'Compares it to the specified text, B5 in this case\n    Worksheets(\"DB\").Range(Cells(I, 1), Cells(I, 2)).Copy Destination:=Worksheets(\"Research\").Cells(J, 1)\n    'Copies the range above. ***Change the range to copy, from 1 to 2\n    J = J + 1\nEnd If\nNext I 'Loops through\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 5, "user_id": 4495961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8e224fad6bc6db735cdc93148a6339c?s=128&d=identicon&r=PG&f=1", "display_name": "Salim Chorfi", "link": "https://stackoverflow.com/users/4495961/salim-chorfi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1458132138, "creation_date": 1457536628, "last_edit_date": 1531164843, "question_id": 35895523, "link": "https://stackoverflow.com/questions/35895523/find-copy-and-paste-search-engine-in-excel", "title": "Find, copy and paste search engine in Excel", "body": "<p>I'm trying to create a macro that would search the value of the cell B5 in a sheet called DB and paste all of the results in a sheet called Research. The idea is to copy every line that match the keyword and to paste them starting at B11 in the DB sheet. </p>\n\n<p>I don't know if it's possible, but thank you in advance for your time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457538979, "post_id": 35895430, "comment_id": 59453493, "body": "Also worth noting that <code>range(&quot;A1:D&quot; &amp; UBound(mastersheet, 4))</code> would return an error as <code>UBound()</code> returns an integer.  <code>Range()</code> requires a string, therefore you would have to convert the integer to a string <code>range(&quot;A1:D&quot; &amp; CStr(UBound(mastersheet, 4)))</code>"}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457539037, "post_id": 35895430, "comment_id": 59453556, "body": "This was likely the cause of your error 13 as you were trying to concatenate a string with an integer"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457536956, "post_id": 35895562, "comment_id": 59451828, "body": "But mastersheet() at this point is the result of a code which added vales to it... the only way to know the dimensions of the array is to use the UBound function, as far as i know."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457537169, "post_id": 35895562, "comment_id": 59452025, "body": "If you have an array of values that imitates the rows &#215; columns on a worksheet then you have a 1 to <i>x</i>, 1 to <i>y</i> array. <i>x</i> is the number of rows nad <i>y</i> is the number of columns. If you have two &#39;records&#39; of 4 fields (e.g. A1:D2) then you have 1 to 2, 1 to 4. <b>Not</b> (1, 1, 1, 1)."}, {"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457537514, "post_id": 35895562, "comment_id": 59452294, "body": "you are right, this was a very big conceptual mistake on my part."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457537604, "post_id": 35895562, "comment_id": 59452366, "body": "No worries; I hope the above simple demo helps sort things out."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1457536721, "creation_date": 1457536721, "answer_id": 35895562, "question_id": 35895430, "link": "https://stackoverflow.com/questions/35895430/copying-array-onto-range-of-cells/35895562#35895562", "title": "copying array onto range of cells", "body": "<p>You seem to be confusing the <strong>rank</strong> with the actual dimension. </p>\n\n<p>Rewrite your code so that <strong>mastersheet</strong> is 1 to <em>x</em>, 1 to 4. Put the values into the array as,</p>\n\n<pre><code>redim mastersheet(1 to 2, 1 to 4)\nmastersheet(1, 1) = \"A1\"\nmastersheet(1, 2) = \"B1\"\nmastersheet(1, 3) = \"C1\"\nmastersheet(1, 4) = \"D1\"\nmastersheet(2, 1) = \"A2\"\nmastersheet(2, 2) = \"B2\"\nmastersheet(2, 3) = \"C2\"\nmastersheet(2, 4) = \"D2\"\n</code></pre>\n\n<p>Write the values back to the worksheet like this,</p>\n\n<pre><code>wbmastersheet.Worksheets(1).range(\"A1\").Resize(UBound(mastersheet, 1), UBound(mastersheet, 2)) = mastersheet\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 35895562, "answer_count": 1, "score": 1, "last_activity_date": 1457541032, "creation_date": 1457536393, "last_edit_date": 1457541032, "question_id": 35895430, "link": "https://stackoverflow.com/questions/35895430/copying-array-onto-range-of-cells", "title": "copying array onto range of cells", "body": "<p>I want to copy the values of the array <code>mastersheet()</code> onto a range of cells of equal size.</p>\n\n<p><code>mastersheet()</code> is initially declared as a variant\n<code>Dim mastersheet() As Variant</code></p>\n\n<p>Eventually in the code it has 4 \"columns\" or dimensions.\n<code>ReDim mastersheet(1, 1, 1, 1)</code></p>\n\n<p>Eventually strings are added to it in column 2, or the second dimension. Not all column have the same data type.</p>\n\n<p><code>wbmastersheet.Worksheets(1).range(\"A1:D\" &amp; UBound(mastersheet, 4)) = mastersheet()</code></p>\n\n<p>I am getting the below error</p>\n\n<blockquote>\n  <p>Error 13: type mismatch</p>\n</blockquote>\n\n<p>Can anyone please resolve this ?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 1, "creation_date": 1457535984, "post_id": 35895245, "comment_id": 59451051, "body": "Have you tried Text-to-Columns, then Copy-&gt;Paste Special-&gt;Transpose?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457536059, "post_id": 35895245, "comment_id": 59451118, "body": "You might even try recording yourself performing a Text-to-Columns to see what it comes up with."}, {"owner": {"reputation": 101, "user_id": 2115367, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49771d646c3f82526a53fbe0bae9c949?s=128&d=identicon&r=PG", "display_name": "wiecman", "link": "https://stackoverflow.com/users/2115367/wiecman"}, "edited": false, "score": 0, "creation_date": 1457536462, "post_id": 35895245, "comment_id": 59451431, "body": "Thanks for fast response but in my situation it not enought. I need do it with formula because i collate it to data validation list"}, {"owner": {"reputation": 248, "user_id": 1934994, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2774b14824943127f6ade513a76a6539?s=128&d=identicon&r=PG", "display_name": "Gunnar Valur Gunnarsson", "link": "https://stackoverflow.com/users/1934994/gunnar-valur-gunnarsson"}, "edited": false, "score": 0, "creation_date": 1457537340, "post_id": 35895245, "comment_id": 59452150, "body": "Would you like 1 formula is it ok to have multiple (maybe hidden) cells with intermediate results?"}], "answers": [{"comments": [{"owner": {"reputation": 248, "user_id": 1934994, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2774b14824943127f6ade513a76a6539?s=128&d=identicon&r=PG", "display_name": "Gunnar Valur Gunnarsson", "link": "https://stackoverflow.com/users/1934994/gunnar-valur-gunnarsson"}, "edited": false, "score": 0, "creation_date": 1457539006, "post_id": 35896305, "comment_id": 59453523, "body": "You could also in the same way do this down buy putting the formulas in A2 and A3 then copy them to A4 &amp; A5, etc... Then hide row 3, 5, 7 etc."}], "tags": [], "owner": {"reputation": 248, "user_id": 1934994, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2774b14824943127f6ade513a76a6539?s=128&d=identicon&r=PG", "display_name": "Gunnar Valur Gunnarsson", "link": "https://stackoverflow.com/users/1934994/gunnar-valur-gunnarsson"}, "is_accepted": false, "score": 0, "last_activity_date": 1457538660, "creation_date": 1457538660, "answer_id": 35896305, "question_id": 35895245, "link": "https://stackoverflow.com/questions/35895245/split-multiple-cells-into-column/35896305#35896305", "title": "Split multiple cells into column", "body": "<p>Here is a solution where you need to have every other column hidden:\nSay that you have the value in A1 then put in the following formulas:</p>\n\n<pre><code>B1: =IF(ISERR(FIND(\",\";A1;1));A1;LEFT(A1;FIND(\",\";A1;1)-1))\nC1: =IF(ISERR(FIND(\",\";A1;1));\"\";RIGHT(A1;LEN(A1)-FIND(\",\";A1;1)))\n</code></pre>\n\n<p>B1 will then contain the first value in the list, C1 will contain the list minus the first value.  Now you can copy these formulas to D1 and E1 and they will now look like</p>\n\n<pre><code>D1: =IF(ISERR(FIND(\",\";C1;1));C1;LEFT(C1;FIND(\",\";C1;1)-1))\nE1: =IF(ISERR(FIND(\",\";C1;1));\"\";RIGHT(C1;LEN(C1)-FIND(\",\";C1;1)))\n</code></pre>\n\n<p>Now keep on copying this formulas for as long to the right as you need.</p>\n\n<p>Once this is done you can hide all columns that contain the shortened list, starting with C, then E, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 494, "user_id": 351245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6e389d56363816b1eba051b879f962?s=128&d=identicon&r=PG", "display_name": "Ian", "link": "https://stackoverflow.com/users/351245/ian"}, "is_accepted": true, "score": 0, "last_activity_date": 1457571930, "creation_date": 1457571930, "answer_id": 35905752, "question_id": 35895245, "link": "https://stackoverflow.com/questions/35895245/split-multiple-cells-into-column/35905752#35905752", "title": "Split multiple cells into column", "body": "<p>Using VBA code in Excel:</p>\n\n<p>note: google how to a command button on the sheet and paste this as the code.</p>\n\n<pre><code>Option Explicit\n\n' note: vbNullString is the same as \"\" (empty string)\n\nConst START_ROW = 1\nConst SRC_COL = 1    ' column A\nConst DST_COL = 2    ' column B\n\n' this gets triggered when the button is pressed\nPrivate Sub CommandButton1_Click()\n    ' call the routine\n    Call Go\nEnd Sub\n\nFunction Go()\n    ' assume the button is on the sheet to be processed\n    Dim ws As Excel.Worksheet\n    Set ws = Excel.ActiveSheet\n\n    Dim srcRow As Integer ' current row being processed\n    Dim dstRow As Integer ' current row to put result in\n    srcRow = START_ROW: dstRow = START_ROW\n\n    ' keep going while column 'A' is not blank\n    While ws.Cells(srcRow, SRC_COL) &lt;&gt; vbNullString\n        Call Split(ws, ws.Cells(srcRow, SRC_COL), dstRow)\n        srcRow = srcRow + 1\n    Wend\nEnd Function\n\nSub Split(ws As Excel.Worksheet, srcStr As String, ByRef dstRow As Integer)\n    If (srcStr = vbNullString) Then\n        'remove comment if you want blanks at the end\n        ' ex. Apple,Banana, \n        '     will create 3 entries, notice the comma at the end \n        'ws.Cells(dstRow, DST_COL) = vbNullString\n        'dstRow = dstRow + 1\n        Exit Sub\n    endif\n\n    ' find \",\"\n    Dim pos As Integer\n    pos = InStr(1, srcStr, \",\")\n    If (pos = 0) Then\n        ' no \",\" - put the whole string\n        ws.Cells(dstRow, DST_COL) = Trim(srcStr)\n        dstRow = dstRow + 1\n    Else\n        ' has \",\" - put the left part of the string\n        ' ex: apple,banana,carrot\n        '     put \"apple\"\n        '     continue processing \"banana,carrot\"\n        ws.Cells(dstRow, DST_COL) = Trim(Mid(srcStr, 1, pos - 1))\n        ' move to next row and process the right of the string\n        dstRow = dstRow + 1\n        Call Split(ws, Mid(srcStr, pos + 1), dstRow)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 2115367, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/49771d646c3f82526a53fbe0bae9c949?s=128&d=identicon&r=PG", "display_name": "wiecman", "link": "https://stackoverflow.com/users/2115367/wiecman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 35905752, "answer_count": 2, "score": 0, "last_activity_date": 1457571930, "creation_date": 1457535910, "last_edit_date": 1531161705, "question_id": 35895245, "link": "https://stackoverflow.com/questions/35895245/split-multiple-cells-into-column", "title": "Split multiple cells into column", "body": "<p>I have multiple cells with string like </p>\n\n<p>for. ex cel A1 </p>\n\n<pre><code>m2_10cm[0.10],m2_20cm[0.20],m2_5cm[0.05],m3[1.9]\n</code></pre>\n\n<p>and cell A2</p>\n\n<pre><code>m3_22[2.2],m3_19[1.9]\n</code></pre>\n\n<p>Hov can i split it to one column like </p>\n\n<pre><code>  Column  B\n    Cell 1   m2_10cm[0.10]\n    Cell 2 m2_20cm[0.20]\n    Cell 3 m2_5cm[0.05]\n    Cell 4 m3[1.9]\n    Cell 5 m3_22[2.2]\n    Cell 6 m3_19[1.9]\n</code></pre>\n\n<p>I will be apriciate for any help </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1457535681, "post_id": 35894988, "comment_id": 59450795, "body": "You can use array formula, so index(a1:c10,if((a1:a10=&quot;xyx&quot;)*(c1:c10=&quot;abc&quot;),row(a1:a10)),1&zwnj;&#8203;)   have a look at array formula"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457536183, "post_id": 35894988, "comment_id": 59451224, "body": "See <a href=\"http://stackoverflow.com/questions/31979340/excel-match-two-columns-and-output-third-and-there-are-multiple-instance/31980952#31980952\">match two columns and output third \u2026 AND\u2026 there are multiple instances in each column</a>."}, {"owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1457538172, "post_id": 35894988, "comment_id": 59452862, "body": "I see that, except in this case you have to specify the &quot;Name&quot; and &quot;Report #&quot; to return the value. This won&#39;t work because I have 167 names and cannot do an iteration of this formula that many times. How can it be name &quot;agnostic&quot; and just return the value of the report if it matches the two name columns?"}, {"owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1457538323, "post_id": 35894988, "comment_id": 59452988, "body": "@Jeeped In that example he specifies &quot;red&quot; &quot;boat&quot;, I can&#39;t specify that for each report"}], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1457537516, "post_id": 35895225, "comment_id": 59452295, "body": "This won&#39;t work, it won&#39;t be an exact match between the two name columns, plus there are other criteria to the right that are about ~160 rows too, need to condense the 4000."}], "tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1457535875, "creation_date": 1457535875, "answer_id": 35895225, "question_id": 35894988, "link": "https://stackoverflow.com/questions/35894988/excel-2013-vlookup-based-on-multiple-criteria-retrieving-multiple-rows/35895225#35895225", "title": "Excel 2013 VLOOKUP() based on multiple criteria, retrieving multiple rows", "body": "<p>Have you explored the option of using a Pivot Table?</p>\n\n<p>The output would look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xskQ1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xskQ1.png\" alt=\"enter image description here\"></a></p>\n\n<p>With the Pivot Table setup like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BvIyf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BvIyf.png\" alt=\"enter image description here\"></a></p>\n\n<p>This method would make for a cleaner view, as your current method looks to repeat ~4,000 times (once for each report &amp; name combo).  Hopefully this works for what you need.</p>\n"}, {"comments": [{"owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1457550511, "post_id": 35899333, "comment_id": 59461405, "body": "I think this is actually working - going to implement and validate. Could you explain to me how this works exactly?"}, {"owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1457552053, "post_id": 35899333, "comment_id": 59462331, "body": "I&#39;m very interested in understanding the mechanics..think I know, but I&#39;m not 100% sure"}, {"owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "reply_to_user": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 1, "creation_date": 1457564608, "post_id": 35899333, "comment_id": 59469211, "body": "so this woks as follows; column A counts how many times this user used that particular report from beginning of table up to that point. column B gives you a count of the number unique report the user is up to at that point. then by joining the user name and number report hes up to we can ID for <code>Vlookup</code> what to search for. hope i&#39;v been clear to understand. glad to help if needed"}, {"owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "edited": false, "score": 0, "creation_date": 1457633747, "post_id": 35899333, "comment_id": 59506658, "body": "I think I understand now. Thank you very much :)"}], "tags": [], "owner": {"reputation": 131, "user_id": 6031537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad492645a4134f007c8b82deff038e39?s=128&d=identicon&r=PG&f=1", "display_name": "aFast", "link": "https://stackoverflow.com/users/6031537/afast"}, "is_accepted": true, "score": 1, "last_activity_date": 1457547996, "last_edit_date": 1457547996, "creation_date": 1457546999, "answer_id": 35899333, "question_id": 35894988, "link": "https://stackoverflow.com/questions/35894988/excel-2013-vlookup-based-on-multiple-criteria-retrieving-multiple-rows/35899333#35899333", "title": "Excel 2013 VLOOKUP() based on multiple criteria, retrieving multiple rows", "body": "<p>I made a method that uses additional three columns and it worked for me.\nI used the data you provided above.</p>\n\n<p>Add three columns to the left. </p>\n\n<ul>\n<li>in A2 enter <code>=COUNTIFS($D$2:$D2,D2,$E$2:$E2,E2)</code>.</li>\n<li>in B2 enter <code>=SUMIFS($A$2:$A2,$A$2:$A2,1,$D$2:D2,D2)</code>.</li>\n<li>in C2 enter <code>=D2&amp;B2</code>. </li>\n</ul>\n\n<p>Now copy those cells to all your 4000 rows.</p>\n\n<p>Now next to the second name column add column headers numbered from 1 to as many reports you think can be the max one user can have (you said 15). </p>\n\n<p>Now enter this <code>vlookup</code> in F2 <code>=IFERROR(VLOOKUP($F2&amp;G$1, your table array starting from column C as absolute/fixed ,3,FALSE),\"\")</code> in my case it was <code>=IFERROR(VLOOKUP($F2&amp;G$1,$C$2:$E$11,3,FALSE),\"\")</code>.</p>\n\n<p>Copy the formula accross all columns with number headers and down all rows that have names in second name column (160).</p>\n\n<p><a href=\"http://i.stack.imgur.com/aa06u.jpg\" rel=\"nofollow\">your sheet shuld look something like this image</a></p>\n\n<p>All the best let me know if it worked for you.</p>\n"}], "owner": {"reputation": 305, "user_id": 5175420, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/40f4e473317614c0031ff8d6db0c8938?s=128&d=identicon&r=PG&f=1", "display_name": "DukeLuke", "link": "https://stackoverflow.com/users/5175420/dukeluke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 1, "accepted_answer_id": 35899333, "answer_count": 2, "score": 0, "last_activity_date": 1457549248, "creation_date": 1457535315, "last_edit_date": 1457549248, "question_id": 35894988, "link": "https://stackoverflow.com/questions/35894988/excel-2013-vlookup-based-on-multiple-criteria-retrieving-multiple-rows", "title": "Excel 2013 VLOOKUP() based on multiple criteria, retrieving multiple rows", "body": "<p>I have an issue that can (I believe) be solved by just excel, and may won't require VBA (I could be wrong). I believe it can be solved by nested functions but the formula I've tried has not worked.</p>\n\n<p>Here's my data:</p>\n\n<pre><code> Name               Report #          Name\nMark Doe            ReportXXX       Mark Doe\nConnie Doe          ReportYYY       Connie Doe\nDebbie Doe          REPORTYYY       Debbie Doe  \nValerie Doe         FSMVALTR1       Valerie Doe\nJeff Doe            FSMVALTR1       Jeff Doe\nAndy Doe            RAZXYBCA1       Andy Doe    \nRyan Doe            RAZXYBCA1       Ryan Doe    \nAndy Doe            RAZ111111       Jill Doe    \nRyan Doe            RAZ222112       Amanda Doe\n</code></pre>\n\n<p>This list goes on for about ~4000 rows in the first NAME and REPORT # columns. In the second NAME column I have ~160 rows. </p>\n\n<p>The second name column identifies all the users who actually use the report, with no duplicates. The two name and report # columns have many duplicates, since users have access to multiple reports, and many of them are the same report used for different purposes. Since the second NAME column has so few rows, the names don't match up all the way through, which can be observed near the bottom of both the NAME columns. </p>\n\n<p>What I need to do is have a <code>VLOOKUP</code> that identifies the name in both of the columns and then returns the report number that each individual has access to across rows (horizontally), not down the columns. It also needs to I.D. numerous reports since individuals have access to anywhere from 1-15 reports, starting at the second and so on after the previous has been extracted.   </p>\n\n<p>Ideally it would look something like this:</p>\n\n<pre><code>Name          Report #      Name       ex column  ex column  ex column\nMark Doe      ReportXXX    Mark Doe    ReportXXX  ReportAAA   ReportB\n</code></pre>\n\n<p>I didn't list the other reports \"Mark Doe\" has access to and these would be somewhere down the long list of ~4000, along with his name repeated multiple times in the first NAME column, but the second \"unique\" name column would be where it is returning the reports to, across rows.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1457570632, "post_id": 35899410, "comment_id": 59471369, "body": "I couldn&#39;t remember off the top of my head if WithEvents applied to other applications (and was too busy to test) so was happy to see your answer. That&#39;s a pretty amazing capability - makes me want to come up with a reason to need it :-)"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "edited": false, "score": 0, "creation_date": 1457626947, "post_id": 35899410, "comment_id": 59502041, "body": "@DougGlancy Yeah, it&#39;s pretty neat.  Needs to be used in a class module or form though....can&#39;t be used in a regular module."}, {"owner": {"reputation": 1245, "user_id": 5938276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-zolc90p2grA/AAAAAAAAAAI/AAAAAAAAOBU/TloVnogHxWU/photo.jpg?sz=128", "display_name": "Al Grant", "link": "https://stackoverflow.com/users/5938276/al-grant"}, "edited": false, "score": 0, "creation_date": 1606758717, "post_id": 35899410, "comment_id": 115052686, "body": "Item.subject prints subject, but Item.Sender doesn&#39;t allow me to get the senders email address - which is another exchange user. Is this something to do with propertyAccessor?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 1245, "user_id": 5938276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-zolc90p2grA/AAAAAAAAAAI/AAAAAAAAOBU/TloVnogHxWU/photo.jpg?sz=128", "display_name": "Al Grant", "link": "https://stackoverflow.com/users/5938276/al-grant"}, "edited": false, "score": 0, "creation_date": 1606928654, "post_id": 35899410, "comment_id": 115113770, "body": "@Al Grant You have the wrong property.  When the item is an email, it is of type <code>MailItem</code>  If you want the email address of the sender you want <code>Item.SenderEmailAddress</code> or if just the name <code>Item.SenderName</code>.  The <code>Sender</code> property is not a String, it&#39;s an AddressEntry object.  See: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.sender\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.sen&zwnj;&#8203;der</a>  Note that I do not know enough about email to determine whether the items I&#39;m suggesting can be faked or not, so hopefully your usage does not need any sort of security."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 2, "last_activity_date": 1457547263, "creation_date": 1457547263, "answer_id": 35899410, "question_id": 35894485, "link": "https://stackoverflow.com/questions/35894485/utilizing-outlook-events-from-excel/35899410#35899410", "title": "Utilizing Outlook Events From Excel", "body": "<p>You can do this, but you need to use a Class module in Excel to accomplish it.</p>\n\n<p>Class Module - \"myOutlook\" or call it whatever you want.</p>\n\n<pre><code> Private WithEvents myItems As Outlook.Items\n\n Private Sub Class_Initialize()\n\n     Dim oNS As Namespace\n     Dim myOL As Outlook.Application\n\n     Set myOL = New Outlook.Application\n     Set oNS = myOL.GetNamespace(\"MAPI\")\n     Set myItems = oNS.GetDefaultFolder(olFolderInbox).Items\n     'Set this equal to the folder you wish to use this on\n\n End Sub\n\n Private Sub myItems_ItemAdd(ByVal Item As Object)\n\n      Debug.Print \"Got_EMAIL!!!\"\n\n End Sub\n</code></pre>\n\n<p>Then, in a regular module do this:</p>\n\n<pre><code> Dim myOutlook As myOutlook\n\n Sub TestSub()\n\n      Set myOutlook = New myOutlook\n\n  End Sub\n</code></pre>\n\n<p>Once you initialize the instance of your user defined class, the events will be caught by it.</p>\n\n<p>Obviously, you will need to set the \"myItems\" object to be linked to the correct inbox.  For mine, it's just linked to my default mailbox which was easiest for testing.</p>\n"}], "owner": {"reputation": 163, "user_id": 5789928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59b826831eb813bc729ce9ead8a92b84?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Hiles", "link": "https://stackoverflow.com/users/5789928/matthew-hiles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 1, "accepted_answer_id": 35899410, "answer_count": 1, "score": 3, "last_activity_date": 1457547263, "creation_date": 1457534068, "question_id": 35894485, "link": "https://stackoverflow.com/questions/35894485/utilizing-outlook-events-from-excel", "title": "Utilizing Outlook Events From Excel", "body": "<p>I'm attempting to utilize the \"ItemAdd\" Event <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869609.aspx\" rel=\"nofollow\">MSDN Link Here</a> from the Outlook Object Model in a Excel macro; however, I haven't been able to find a way to utilize events from outside of Excel.</p>\n\n<p>My intended use case is to monitor items received in a shared mailbox and log their reception. I am currently running a loop on a timer that checks for new emails, however I would prefer to simply log each time an event fires if possible. </p>\n\n<p>Unfortunately I am not able to run any macros from Outlook directly so I am restricted to accessing the Outlook Object Model from other Office applications.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "edited": false, "score": 0, "creation_date": 1457537282, "post_id": 35894419, "comment_id": 59452116, "body": "This formula works:                                                                        my_date =  DATEVALUE(&quot;3/1/&quot;&amp;this_year)+6-WEEKDAY(DATEVALUE(&quot;3/1/&quot;&amp;this_&zwnj;&#8203;year),3)+7"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1457537663, "post_id": 35894419, "comment_id": 59452421, "body": "I recommend not to use DATEVALUE() that may breaks if you are in a country where DD/MM/YYYY format is used instead of MM/DD/YYYY"}, {"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1457548659, "post_id": 35894419, "comment_id": 59460179, "body": "Ended up using:                                                                                    DateSerial(this_year, 3, 1) + 6 - WorksheetFunction.Weekday(DateSerial(this_year, 3, 1), 3) + 7 :-  For VBA                                                                                              DateSerial(this_year, 3, 1) + 6 - Weekday(DateSerial(this_year, 3, 1), 3) + 7 :- For  Excel"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1457549948, "post_id": 35894419, "comment_id": 59461025, "body": "Since you&#39;ve found something that worked and other &quot;Answers&quot; were posted that apparently did not meet your requirements, please put your code in an &quot;Answer&quot; which can be upvoted and which you can (in a while) mark as &quot;the&quot; Answer by clicking the checkmark next to it. This will help site admin and others who may have the same question and are searching for an answer :-)"}], "answers": [{"comments": [{"owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "edited": false, "score": 0, "creation_date": 1457537229, "post_id": 35894693, "comment_id": 59452070, "body": "I was looking for way to edit my formula without having to check for sunday"}], "tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1457534573, "creation_date": 1457534573, "answer_id": 35894693, "question_id": 35894419, "link": "https://stackoverflow.com/questions/35894419/vba-to-find-second-sunday-for-march-every-year/35894693#35894693", "title": "VBA to find Second sunday for March every year", "body": "<p>Enter the year you want to look at in Cell A1, then select a cell where you want to see the date of the 2nd Sunday in March for the given year and run this code:</p>\n\n<pre><code>Sub test()\n\nDim i As Integer\nDim dt As Date\nDim y As Integer\n\ni = 0\ny = Range(\"A1\").Value\ndt = \"3/1/\" &amp; y\n\nWhile i &lt; 2\n\nIf WeekdayName(Weekday(dt), False, vbUseSystemDayOfWeek) = \"Sunday\" Then\n\ni = i + 1\nIf i &lt;&gt; 2 Then\ndt = DateAdd(\"d\", 1, dt)\nEnd If\n\nElse\n\nIf i &lt;&gt; 2 Then\ndt = DateAdd(\"d\", 1, dt)\nEnd If\n\nEnd If\n\nWend\n\nActiveCell.Value = dt\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1457550113, "post_id": 35895847, "comment_id": 59461132, "body": "If you feel an &quot;Answer&quot; is not good, you can downvote it (click the &quot;down&quot; arrow to the left). On this site, marking something as &quot;not an answer&quot; should only be used for off-topic, comments, spam, people posting other questions &quot;on top of&quot; your question, etc. Yeah, it&#39;s confusing... :-)"}, {"owner": {"reputation": 10326, "user_id": 2822004, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ec7196aaa220767879f125eab493f7a2?s=128&d=identicon&r=PG&f=1", "display_name": "tumultous_rooster", "link": "https://stackoverflow.com/users/2822004/tumultous-rooster"}, "edited": false, "score": 0, "creation_date": 1457575204, "post_id": 35895847, "comment_id": 59472658, "body": "I came across this in the &quot;Low Quality Posts&quot; queue. Usually code only posts with no context become candidates for deletion."}], "tags": [], "owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "is_accepted": false, "score": -1, "last_activity_date": 1457537404, "creation_date": 1457537404, "answer_id": 35895847, "question_id": 35894419, "link": "https://stackoverflow.com/questions/35894419/vba-to-find-second-sunday-for-march-every-year/35895847#35895847", "title": "VBA to find Second sunday for March every year", "body": "<pre><code>If my_date = (DateSerial(this_year, 3, 1) + (8 - Weekday(DateSerial(this_year, 3, 1)) Mod 7) + 7) Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "is_accepted": true, "score": 0, "last_activity_date": 1457550589, "creation_date": 1457550589, "answer_id": 35900497, "question_id": 35894419, "link": "https://stackoverflow.com/questions/35894419/vba-to-find-second-sunday-for-march-every-year/35900497#35900497", "title": "VBA to find Second sunday for March every year", "body": "<p>This works:</p>\n\n<p>For VBA :\nDateSerial(this_year, 3, 1) + 6 - WorksheetFunction.Weekday(DateSerial(this_year, 3, 1), 3) + 7 </p>\n\n<p>For Excel:\nDateSerial(this_year, 3, 1) + 6 - Weekday(DateSerial(this_year, 3, 1), 3) + 7</p>\n"}, {"tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1552761433, "creation_date": 1552761433, "answer_id": 55200254, "question_id": 35894419, "link": "https://stackoverflow.com/questions/35894419/vba-to-find-second-sunday-for-march-every-year/55200254#55200254", "title": "VBA to find Second sunday for March every year", "body": "<p>I thought I would just add this below code for anyone else who comes across this. I wanted to create a GENERAL purpose block of code that gets any day of week of any month. Ie. if I want the second Sunday or the last Sunday I could retrieve this from one function. Thus I have written the below. You can alter it to how you need it. Ie. Sunday/ Monday or first, second or third etc. This is done by cycling through the days of the month and if the day return which ever day of week you are looking for you save the day in a collection. Once your have cycled through the month you then cycle through the collection to retrieve the necessary date you need! </p>\n\n<pre><code>Function DayOfMonth(theDate As String) As String\n    'cycle through the given month\n    'check each day of month and if sunday add day of month to collection\n    'then cycle through collection for required sunday of month\n    'daylight savings only happens in march and november\n    On Error Resume Next\n    Dim i As Long\n    Dim testDate As String 'this get passed through function\n    Dim theYear As Long, theMonth As Long\n    Dim dayCollection As New Collection\n\n    theYear = Year(theDate)\n    theMonth = Month(theDate)\n\n    'build collection of sunday's day of month\n    For i = 1 To 31\n        testDate = i &amp; \"/\" &amp; theMonth &amp; \"/\" &amp; theYear\n        If Weekday(testDate, vbSunday) = 1 Then\n            dayCollection.Add i\n        End If\n    Next i\n\n    For i = 1 To dayCollection.Count\n        '2nd sunday\n        If i = 2 Then\n            DayOfMonth = dayCollection(i) &amp; \"/\" &amp; theMonth &amp; \"/\" &amp; theYear\n        End If\n        'last sunday of month\n        If i = dayCollection.Count Then\n            DayOfMonth = dayCollection(i) &amp; \"/\" &amp; theMonth &amp; \"/\" &amp; theYear\n        End If\n    Next i\n\n    'clear collection\n    Set dayCollection = New Collection\n\nEnd Function\n</code></pre>\n\n<p>Cheers!</p>\n"}], "owner": {"reputation": 366, "user_id": 5621866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15e2f5c3ce73b5e3d34d6b1635b91377?s=128&d=identicon&r=PG&f=1", "display_name": "Slubee", "link": "https://stackoverflow.com/users/5621866/slubee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1471, "favorite_count": 0, "accepted_answer_id": 35900497, "answer_count": 4, "score": -1, "last_activity_date": 1552761433, "creation_date": 1457533891, "last_edit_date": 1531164843, "question_id": 35894419, "link": "https://stackoverflow.com/questions/35894419/vba-to-find-second-sunday-for-march-every-year", "title": "VBA to find Second sunday for March every year", "body": "<p>I have an if condition in my VBA code to check if it is spring Day light savings day, which is the second Sunday of March. The below code works for all except when 3/1/2015 (for example) is Sunday, then this shows 3rd Sunday. I can add another condition to check if it is Sunday then don't add 7 to the formula, but is there a better way of doing this? </p>\n\n<p>If my_date = (DATEVALUE(\"3/1/\" &amp; this_year) + 7+ CHOOSE(WEEKDAY(DATEVALUE(\"3/1/\" &amp; this_year), 1),7,6,5,4,3,2,1)) </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1457533492, "post_id": 35894091, "comment_id": 59449080, "body": "what have you tried so far? this is no &quot;free code for you&quot; site (I suggest thats the reason for the downvote)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1457534487, "post_id": 35894091, "comment_id": 59449841, "body": "You could use formula for this also, array formula, like MIN(if(a1:a10=&quot;Michael&quot;,b1:b10))"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1457535743, "last_edit_date": 1457535743, "creation_date": 1457535410, "answer_id": 35895027, "question_id": 35894091, "link": "https://stackoverflow.com/questions/35894091/excel-vba-2013-getting-the-start-time-and-end-time-of-the-value/35895027#35895027", "title": "Excel VBA 2013 - Getting the start time and end time of the value", "body": "<p>You need to get the conditional <a href=\"https://support.office.com/en-nz/article/max-function-f7bec1eb-9c66-489a-9166-51d2c9d19333\" rel=\"nofollow noreferrer\">MAX</a> and <a href=\"https://support.office.com/en-us/article/MIN-function-735E28B8-829A-413A-BA38-668FCF0520D7\" rel=\"nofollow noreferrer\">MIN</a> time values for each name in column A. These values need to be in the first occurrence of the name.</p>\n\n<pre><code>Sub min_max_del()\n    Dim rw As Long, cr As Long, lr As Long\n\n    With Worksheets(\"Sheet3\")\n        With .Cells(1, 1).CurrentRegion\n            lr = .Cells(Rows.Count, \"A\").End(xlUp).Row\n            For rw = lr To 2 Step -1\n                If rw = Application.Match(.Cells(rw, \"A\"), .Columns(1), 0) Then\n                    .Cells(rw, 2) = Evaluate(\"min(if('\" &amp; .Parent.Name &amp; \"'!A2:A\" &amp; lr &amp; \"=A\" &amp; rw &amp; \", '\" &amp; .Parent.Name &amp; \"'!B2:B\" &amp; lr &amp; \"))\")\n                    .Cells(rw, 3) = Evaluate(\"max(if('\" &amp; .Parent.Name &amp; \"'!A2:A\" &amp; lr &amp; \"=A\" &amp; rw &amp; \", '\" &amp; .Parent.Name &amp; \"'!C2:C\" &amp; lr &amp; \"))\")\n                End If\n            Next rw\n            .RemoveDuplicates Columns:=1, Header:=xlYes\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Once the times have been properly collated, the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193823.aspx\" rel=\"nofollow noreferrer\">Range.RemoveDuplicates method</a> will get rid of extraneous entries.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/mVqIa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mVqIa.png\" alt=\"min_max_times_before\"></a>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/QZzOm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QZzOm.png\" alt=\"min_max_times_after\"></a><br/>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>sample data before</sup>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<sup>sample data after</sup></p>\n"}], "owner": {"reputation": 53, "user_id": 3398666, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/e845a91c545eb925c0a7cda512423a2b?s=128&d=identicon&r=PG&f=1", "display_name": "user3398666", "link": "https://stackoverflow.com/users/3398666/user3398666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457535743, "creation_date": 1457533079, "last_edit_date": 1457534421, "question_id": 35894091, "link": "https://stackoverflow.com/questions/35894091/excel-vba-2013-getting-the-start-time-and-end-time-of-the-value", "title": "Excel VBA 2013 - Getting the start time and end time of the value", "body": "<p>I'm trying to get the Start Time and End Time of the same values and delete the entire row of it. </p>\n\n<pre><code>Name       Start time    End time\nMichael    2:57:00 PM   3:04:10 PM\nMichael    3:04:10 PM   3:12:29 PM\nMichael    3:12:29 PM   3:14:57 PM\nSarah      3:19:53 PM   3:20:00 PM\nSarah      3:20:00 PM   3:20:23 PM\nMichael    3:20:23 PM   3:23:49 PM\n</code></pre>\n\n<p>Output will be</p>\n\n<pre><code>Michael    2:57:00 PM   3:14:57 PM\nSarah      3:19:53 PM   3:20:23 PM\nMichael    3:20:23 PM   3:23:49 PM\n</code></pre>\n\n<p>Sorry. I really don't know Macro. If someone can help me please. \nIt would much appreciated!</p>\n\n<p>Thanks!</p>\n\n<p>UPDATE:</p>\n\n<p>What I have is only deleting the duplicates. Which I think is not possible.</p>\n\n<pre><code>With ActiveSheet\n    Set Rng = Range(\"A2\", Range(\"B2\").End(xlDown))\n    Rng.RemoveDuplicates Columns:=Array(1, 2), Header:=xlYes\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1457532918, "creation_date": 1457532918, "question_id": 35894026, "link": "https://stackoverflow.com/questions/35894026/how-to-convert-relative-object-coordinates-to-absolute", "title": "How to convert relative object coordinates to absolute", "body": "<p>I have a button on form, which opens popup menu. I need to open this popup menu right under button. <code>ShowPopup</code> function accepts absolute desktop coordinates. How to calculate absolute coordinates, if I know button position on form?</p>\n\n<p>Currently I'm using this trick:</p>\n\n<pre><code>Private Type RECT\n    Left As Long\n    Top As Long\n    Right As Long\n    Bottom As Long\nEnd Type\n\nPrivate Declare Function GetWindowRect Lib \"user32.dll\" (ByVal hWnd As Long, lpRect As RECT) As Long\nPrivate Declare Function GetFocus Lib \"user32\" () As Long\n\nPrivate Sub Command1_Click()\n    Dim r As RECT\n    Dim chwnd As Long\n    Dim h As Long\n\n    Me.Text1.SetFocus\n    chwnd = GetFocus\n    Me.Command1.SetFocus\n    h = GetWindowRect(chwnd, r)\n    CommandBars(\"PopupMenu\").ShowPopup r.Left, r.Bottom\nEnd Sub\n</code></pre>\n\n<p>It works, but additional TextBox <code>Text1</code> right under the button, which allows to get absolute position using API is not really good solution, wanted to calculate instead of using artificial \"bookmarks\"</p>\n"}, {"tags": ["sql-server", "excel", "oracle", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 1, "last_activity_date": 1457534663, "creation_date": 1457534663, "answer_id": 35894723, "question_id": 35893940, "link": "https://stackoverflow.com/questions/35893940/microsoft-odbc-for-oracle-is-missing/35894723#35894723", "title": "Microsoft ODBC for Oracle is missing", "body": "<p>Yes you will need to install, if it isn't already present.  Microsoft don't recommend using their ODBC Driver for Oracle, anymore.</p>\n\n<blockquote>\n  <p>This feature will be removed in a future version of Windows. Avoid\n  using this feature in new development work, and plan to modify\n  applications that currently use this feature. Instead, use the ODBC\n  driver provided by Oracle.</p>\n</blockquote>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ms713590(v=vs.85).aspx\" rel=\"nofollow\">Source</a>.</p>\n\n<p>Instead use the <a href=\"http://www.oracle.com/technetwork/database/windows/index-098976.html\" rel=\"nofollow\">Oracle driver</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 359, "user_id": 5177028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RRv9J.jpg?s=128&g=1", "display_name": "Rachit Solanki", "link": "https://stackoverflow.com/users/5177028/rachit-solanki"}, "is_accepted": false, "score": 0, "last_activity_date": 1457534761, "creation_date": 1457534761, "answer_id": 35894765, "question_id": 35893940, "link": "https://stackoverflow.com/questions/35893940/microsoft-odbc-for-oracle-is-missing/35894765#35894765", "title": "Microsoft ODBC for Oracle is missing", "body": "<p>See Whether it is coming or not under the add section\nProbably you did not set connection with you database that's why you are getting run time error</p>\n\n<p><a href=\"https://i.stack.imgur.com/POZjb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/POZjb.png\" alt=\"Step1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/CcBmZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CcBmZ.png\" alt=\"Step 2\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "is_accepted": false, "score": 1, "last_activity_date": 1457607543, "last_edit_date": 1457607543, "creation_date": 1457606489, "answer_id": 35914129, "question_id": 35893940, "link": "https://stackoverflow.com/questions/35893940/microsoft-odbc-for-oracle-is-missing/35914129#35914129", "title": "Microsoft ODBC for Oracle is missing", "body": "<p>Which 'ODBC Data Source Administrator' do you use? 32-bit or 64-bit? If your Excel is 32-bit (which is most likely the case) you also have to use 32-bit ODBC Data Sources. </p>\n\n<p>Start <code>%SYSTEMROOT%\\SysWOW64\\odbcad32.exe</code> to launch the 32-bit version.</p>\n\n<p>Note, ODBC driver for Oracle from Microsoft supports only 32-bit, 64-bit is not available. As already mentioned it is <a href=\"https://msdn.microsoft.com/en-us/library/ms713590%28v=vs.85%29.aspx\" rel=\"nofollow\">deprecated</a> and should not be used for new projects.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8734432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52061d999649c847e4fbfe64727176d6?s=128&d=identicon&r=PG&f=1", "display_name": "marc guvenc", "link": "https://stackoverflow.com/users/8734432/marc-guvenc"}, "is_accepted": false, "score": 0, "last_activity_date": 1507320015, "creation_date": 1507320015, "answer_id": 46613131, "question_id": 35893940, "link": "https://stackoverflow.com/questions/35893940/microsoft-odbc-for-oracle-is-missing/46613131#46613131", "title": "Microsoft ODBC for Oracle is missing", "body": "<p>I created the Microsoft ODBC drivers for Oracle this way,  </p>\n\n<ol>\n<li><p>Find the table in MS Access not in Oracle (make sure all the column names and table names are Upper Case)</p></li>\n<li><p>Right click > Export > ODBC Databases</p></li>\n<li><p>Click OK</p></li>\n<li><p>Click on the \"Machine Data Source\" tab</p></li>\n<li><p>Click the New button</p></li>\n<li><p>Click the radio button \"User Data Sources\"</p></li>\n<li><p>Click the \"Next >\" button</p></li>\n<li><p>Scroll down until you see the \"Microsoft ODBC for Oracle\" driver</p></li>\n<li><p>Select it and click the \"Next >\" button</p></li>\n<li><p>Add all the credentials and this will create driver and add it your Data Sources going forward</p></li>\n</ol>\n"}], "owner": {"reputation": 405, "user_id": 2122388, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/f2ce5f3e94b1b5f4118872ca74ae090a?s=128&d=identicon&r=PG", "display_name": "zeal", "link": "https://stackoverflow.com/users/2122388/zeal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8780, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1507320015, "creation_date": 1457532667, "question_id": 35893940, "link": "https://stackoverflow.com/questions/35893940/microsoft-odbc-for-oracle-is-missing", "title": "Microsoft ODBC for Oracle is missing", "body": "<p>I'm trying to connect Oracle database from Excel VBA, but got some run time error and figured out that 'Microsoft ODBC for Oracle' is missing in 'ODBC Data Source Administrator' under 'Drivers' tab.</p>\n\n<p>Under 'Drivers' tab I could see only 'SQL Server' - so do I need to install 'Microsoft ODBC for Oracle' manually? Because I thought that 'Microsoft ODBC for Oracle' should have got installed by default with OS. Is my assumption wrong here? If so please confirm and also let me know which application would install that driver by default.... because I have never faced this issue in most of the client machines..... so bit confused here.... please help.</p>\n"}, {"tags": ["vba", "colors", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1457537460, "post_id": 35893902, "comment_id": 59452252, "body": "Google is your friend.  Ask it for help with e.g. RGB LONG to R G B"}], "answers": [{"tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": false, "score": 0, "last_activity_date": 1457537346, "creation_date": 1457537346, "answer_id": 35895819, "question_id": 35893902, "link": "https://stackoverflow.com/questions/35893902/converting-msaccess-colors-to-rgb-in-vba/35895819#35895819", "title": "Converting MSaccess colors to RGB in VBA", "body": "<p>You can convert this \"colorInt\" to RGB using something like </p>\n\n<pre><code>B = floor(colorInt / (256*256))\nG = floor((colorInt - B*256*256)/256)\nR = colorInt - B*256*256 - G*256\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1457538335, "creation_date": 1457538335, "answer_id": 35896183, "question_id": 35893902, "link": "https://stackoverflow.com/questions/35893902/converting-msaccess-colors-to-rgb-in-vba/35896183#35896183", "title": "Converting MSaccess colors to RGB in VBA", "body": "<p>To format an RGB color with Excel:</p>\n\n<pre><code>Const color = vbMagenta\n\nDim r&amp;, g&amp;, b&amp;\nr = color And 255\ng = color \\ 256 And 255\nb = color \\ 65536\nDebug.Print Format(r * 1000000 + g * 1000&amp; + b, \"000,000,000\")\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 5469176, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/031e28aeacbf16f3a78ece53dcc8f18b?s=128&d=identicon&r=PG&f=1", "display_name": "SFro", "link": "https://stackoverflow.com/users/5469176/sfro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1488, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1457538335, "creation_date": 1457532585, "question_id": 35893902, "link": "https://stackoverflow.com/questions/35893902/converting-msaccess-colors-to-rgb-in-vba", "title": "Converting MSaccess colors to RGB in VBA", "body": "<p>I'm designing a macro to check all the shapes, charts and smart art on a given PowerPoint slide and print it's font colour and style.</p>\n\n<p>The line that is (indirectly) giving me problems is</p>\n\n<pre><code>MsgBox .TextFrame.TextRange.Font.Color.RGB\n</code></pre>\n\n<p>The colour is outputted, but it is giving the MSaccess colour which is not as useful as the RGB colour. For example, a white block of text would be displayed as \"16777215\", whereas I would like to see \"255,255,255\"</p>\n\n<p>I've indicated in the line that I want .color.rgb but this doesn't seem to make a difference.</p>\n\n<p>I'd appreciate any help very much! Thank you!</p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1457563736, "post_id": 35893868, "comment_id": 59468826, "body": "Creating this ProgID - <code>CreateObject(&quot;Microsoft.XMLDOM&quot;)</code>  - is now obsolete. Use <code>CreateObject(&quot;MSXML2.DOMDocument.6.0&quot;)</code> instead - see <a href=\"http://blogs.msdn.com/b/xmlteam/archive/2006/10/23/using-the-right-version-of-msxml-in-internet-explorer.aspx\" rel=\"nofollow noreferrer\">here</a> for more info"}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "edited": false, "score": 0, "creation_date": 1457537707, "post_id": 35895787, "comment_id": 59452457, "body": "Ahh, I was trying everyting by almost 2 hours and didn&#39;t see that. Thank you very much!"}], "tags": [], "owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "is_accepted": true, "score": 2, "last_activity_date": 1457537272, "creation_date": 1457537272, "answer_id": 35895787, "question_id": 35893868, "link": "https://stackoverflow.com/questions/35893868/get-text-to-a-string-from-xml-file/35895787#35895787", "title": "Get text to a string from XML file", "body": "<p>You are really close.  Just remove the extra <code>/</code> after <code>number</code></p>\n\n<pre><code>Set HWNode = oXMLFile.SelectSingleNode(\"/header_xml/number\")\n</code></pre>\n\n<p><strong>Tested</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/dj0gR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dj0gR.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 279, "user_id": 5607762, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fae4c4a7bf2793baa71cd24bdced10f5?s=128&d=identicon&r=PG&f=1", "display_name": "GohanP", "link": "https://stackoverflow.com/users/5607762/gohanp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 35895787, "answer_count": 1, "score": 0, "last_activity_date": 1457537272, "creation_date": 1457532497, "last_edit_date": 1531164843, "question_id": 35893868, "link": "https://stackoverflow.com/questions/35893868/get-text-to-a-string-from-xml-file", "title": "Get text to a string from XML file", "body": "<p>I have a xml file and I want to take a text ('aaa') from the number tag to a string. It looks like this:</p>\n\n<p><code>&lt;header_xml&gt;\n    &lt;number&gt;aaa&lt;/number&gt;\n&lt;/header_xml&gt;</code></p>\n\n<p>I tried to use methods found in the Internet but they doesn't work. </p>\n\n<p>This is my code:</p>\n\n<pre><code>Set oXMLFile = CreateObject(\"Microsoft.XMLDOM\")\nsGeneratorPath = ThisWorkbook.Path\n\nWith Application.FileDialog(msoFileDialogOpen) ' --- Open FileDialog\n    .InitialFileName = sGeneratorPath ' --- inital path\n    .Filters.Clear\n    .Filters.Add \"XML Files (*.xml)\", \"*.xml\" ' --- add filter to choose only xml files\n    .AllowMultiSelect = False ' --- to select only one file\n\n    If .Show = False Then ' --- if operation aborted, display message\n        MsgBox \"Operation Cancelled\"\n        End\n    End If\n\n    sXMLPath = .SelectedItems(1) ' --- path of xml file\nEnd With\n\noXMLFile.Load (sXMLPath)\n\nSet HWNode = oXMLFile.SelectSingleNode(\"/header_xml/number/\")\nsHWID = HWNode.Text\nMsgBox sHWID\n\nMsgBox \"Done\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "find", "keyword-search"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457531228, "post_id": 35893239, "comment_id": 59447471, "body": "It looks like you are going to have to nest some loops. I&#39;d suggest variant memory arrays loaded from the worksheet and the <a href=\"https://msdn.microsoft.com/en-us/library/aa263365(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Split function</a>. Possibly a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251825.aspx\" rel=\"nofollow noreferrer\">Scripting.Dictionary</a> object to keep track of them."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5052287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48a4616f0e44117614445ec6db612b39?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Meehan", "link": "https://stackoverflow.com/users/5052287/alex-meehan"}, "is_accepted": false, "score": 0, "last_activity_date": 1464198623, "creation_date": 1464198623, "answer_id": 37444371, "question_id": 35893239, "link": "https://stackoverflow.com/questions/35893239/excel-vba-look-for-keywords-list-based-if-value-lookup-exists-and-then-edit-the/37444371#37444371", "title": "excel vba look for keywords list based if value lookup exists and then edit the value of another cell", "body": "<p>I think something along the lines of the below would work, change the ranges to suit your needs, but it will check the guestname against the list 1st and then assigns the keywords to an array and check those.</p>\n\n<pre><code>Sub example1()\nDim WS1 As Worksheet, WS2 As Worksheet\nDim GuestName() As Variant, Keywords As Variant\nDim GNi As Integer, Ri As Integer, KWi As Integer\n\nSet WS1 = Worksheets(\"Sheet2\")\nSet WS2 = Worksheets(\"Sheet1\")\n\nWith WS1\n  GuestName = .Range(\"A2:A\" &amp; .Cells.SpecialCells(xlCellTypeLastCell).Row)\nEnd With\n\nWith WS2\n  For Ri = 2 To .Cells.SpecialCells(xlCellTypeLastCell).Row 'starting at the 2nd row to the last row with data on the sheet\n    For GNi = 1 To UBound(GuestName)\n      If InStr(1, .Range(\"B\" &amp; Ri), GuestName(GNi, 1)) &gt; 0 Then 'searches for the guestname to match against\n        Keywords = WS1.Range(\"C\" &amp; GNi + 1) 'assigns the keywords matching the guestname\n        Keywords = Split(Keywords, \",\")\n        For KWi = 0 To UBound(Keywords)\n          If InStr(1, .Range(\"C\" &amp; Ri), Keywords(KWi)) &gt; 0 Then\n            'found keyword\n          End If\n        Next\n      End If\n    Next\n  Next\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5429103, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/223f5eac4d95f026d38a37abe43d58a6?s=128&d=identicon&r=PG&f=1", "display_name": "exlover", "link": "https://stackoverflow.com/users/5429103/exlover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 607, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1464198623, "creation_date": 1457530850, "question_id": 35893239, "link": "https://stackoverflow.com/questions/35893239/excel-vba-look-for-keywords-list-based-if-value-lookup-exists-and-then-edit-the", "title": "excel vba look for keywords list based if value lookup exists and then edit the value of another cell", "body": "<p>I have a list of guests whom each eats a certain type of vegetables. For instance John,Smith eats potato and tomato. While Bill,Peter eats Carrots,Onions. I have created a list along with keywords that looks like this </p>\n\n<p><a href=\"https://i.stack.imgur.com/GAZ8F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GAZ8F.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now, I receive a data extract that has a list of names along with a free text description of the food they ate. Here is what i get</p>\n\n<p><a href=\"https://i.stack.imgur.com/jZ8pZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jZ8pZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Unfortunately, I get the names in a format that I do not want like John,Smith (Primary Customer) and I want excel to add the vegetable they ate given it is written in the description. For example, John,Smith (Primary Customer) has the description as: \"he had French fries and wedges\" and since the description contains a keyword listed in my initial table for the same indivdual then his name will be changed from John,Smith (Primary Customer) to John,Smith-Potato (Primary Customer).</p>\n\n<p>I want excel to check if the name exists in the first table first and then look through the description to find any keywords. This will make sure if the name at hand is not contained in my list then excel will not spend time looking for keywords. Also, if no keyword found then do not edit the name.</p>\n\n<p>this is what I expect to get</p>\n\n<p><a href=\"https://i.stack.imgur.com/thTei.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/thTei.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code tried so faar... I keep getting an error and I didn't reach to the point to validate this code to check if it gives me the results I was looking for.. Any help is much appreciated.</p>\n\n<pre><code>Option Explicit\nSub homework()\nDim ws1 As Worksheet, ws2 As Worksheet, keywords() As String, lastRow As Integer, lastRow2 As Integer, c As Variant, x As Integer, y As Integer, k As Variant, cel As Range, descript As Range\nDim SrchRng As Range\nDim SrchStr As Variant\nSet ws1 = Worksheets(\"Sheet2\") 'the sheet that contains keywords which is the sheet i will make\nSet ws2 = Worksheets(\"Sheet1\") 'the sheet that contains description of food\nlastRow = ws1.Cells.Find(What:=\"*\", After:=[A1], SearchOrder:=xlByRows, searchdirection:=xlPrevious).Row\nlastRow2 = ws2.Cells.Find(What:=\"*\", After:=[A1], SearchOrder:=xlByRows, searchdirection:=xlPrevious).Row\nSet SrchRng = Worksheets(\"Sheet2\").Range(\"A1:A1000\")\nSet descript = ws2.Range(\"C2:C\" &amp; lastRow2)\nFor x = 2 To lastRow ' this is to the last row in the database i will create\nkeywords = Split(ws1.Cells(x, 3), \",\")\nFor Each k In keywords\n    For Each cel In descript\n    For y = 2 To lastRow2\n    Do\n    SrchStr = Left(ws2.Cells(y, 2), InStr(ws2.Cells(y, 2), \" (\") - 1)\n    Set c = SrchRng.Find(SrchStr, LookIn:=xlValues)\n        If Not SrchRng.Find(SrchStr, LookIn:=xlValues) Is Nothing And InStr(ws2.Cells(y, 3), k) &lt;&gt; 0 Then\n            ws2.Cells(y, 2).Value = ws1.Cells(x, 1).Value &amp; \"-\" &amp; ws1.Cells(x, 2).Value\n            SrchStr = Nothing\n            Exit Do\n            End If\n    Loop While Not c Is Nothing\n        Next y\n    Next cel\nNext k\nNext x\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 5997802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/553572e802f45ffdb8c3c6e76c382afe?s=128&d=identicon&r=PG", "display_name": "this.guy", "link": "https://stackoverflow.com/users/5997802/this-guy"}, "edited": false, "score": 0, "creation_date": 1457534761, "post_id": 35893524, "comment_id": 59450051, "body": "Huzzah! It works! Could you briefly please explain what <code>InStr</code> does. As i can&#39;t quite figure it out from the code and the google search results don&#39;t really help me. Thank you."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 91, "user_id": 5997802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/553572e802f45ffdb8c3c6e76c382afe?s=128&d=identicon&r=PG", "display_name": "this.guy", "link": "https://stackoverflow.com/users/5997802/this-guy"}, "edited": false, "score": 0, "creation_date": 1457534928, "post_id": 35893524, "comment_id": 59450186, "body": "@this.guy - see the <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow noreferrer\">MSDN Instr</a> article."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1457531559, "creation_date": 1457531559, "answer_id": 35893524, "question_id": 35893074, "link": "https://stackoverflow.com/questions/35893074/copy-part-of-cells-that-varies-in-both-length-and-content-using-vba/35893524#35893524", "title": "Copy part of cells that varies in both length and content using VBA", "body": "<p>Try this code out. Change object names as needed. this will loop through each cell until A27, checking for the \"P...:\" combination.</p>\n\n<pre><code>Sub Test()\n\nDim wbThis As Workbook\nDim wbTarget As Workbook\n\nSet wbThis = Workbooks(\"Workbook1.xlsx\") 'change as needed\nSet wbTarget = Workbooks(\"Workbook2.xlsx\") 'change as needed\n\nDim wsThis As Worksheet\nDim wsTarget As Worksheet\n\nSet wsThis = wbThis.Sheets(\"Sheet1\")\nSet wsTarget = wbTarget.Sheets(\"Sheet1\")\n\nDim rowRng As Integer\nDim targetRowRange As Integer\n\ntargetRowRange = 14\n\nFor rowRng = 6 To 27\n\n    With wsThis\n\n        If Left(.Cells(rowRng, 1), 1) = \"P\" Then\n\n            Dim iPos As Integer\n            iPos = InStr(1, .Cells(rowRng, 1), \":\")\n\n            wsTarget.Cells(targetRowRange, 5).Value = Left(.Cells(rowRng, 1), iPos - 1)\n\n            targetRowRange = targetRowRange + 1\n\n        End If\n\n    End With\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 5997802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/553572e802f45ffdb8c3c6e76c382afe?s=128&d=identicon&r=PG", "display_name": "this.guy", "link": "https://stackoverflow.com/users/5997802/this-guy"}, "edited": false, "score": 0, "creation_date": 1457534845, "post_id": 35893535, "comment_id": 59450123, "body": "Unfortunately that wont work because &quot;:&quot; isn&#39;t the rightmost char."}], "tags": [], "owner": {"reputation": 46, "user_id": 6037243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9tAv2.png?s=128&g=1", "display_name": "Verity", "link": "https://stackoverflow.com/users/6037243/verity"}, "is_accepted": false, "score": 0, "last_activity_date": 1457531574, "creation_date": 1457531574, "answer_id": 35893535, "question_id": 35893074, "link": "https://stackoverflow.com/questions/35893074/copy-part-of-cells-that-varies-in-both-length-and-content-using-vba/35893535#35893535", "title": "Copy part of cells that varies in both length and content using VBA", "body": "<p>Would</p>\n\n<pre><code>If Right((A:rowRng).Value,1) = \":\" Then\n</code></pre>\n\n<p>be what you want? Alternatively one solution may be to replace the characters with \"\", e.g.</p>\n\n<pre><code>Replace (Replace ( your_string, \"P\", \"\"), \":\",\"\")\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 5997802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/553572e802f45ffdb8c3c6e76c382afe?s=128&d=identicon&r=PG", "display_name": "this.guy", "link": "https://stackoverflow.com/users/5997802/this-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 35893524, "answer_count": 2, "score": 0, "last_activity_date": 1457532381, "creation_date": 1457530419, "last_edit_date": 1457532381, "question_id": 35893074, "link": "https://stackoverflow.com/questions/35893074/copy-part-of-cells-that-varies-in-both-length-and-content-using-vba", "title": "Copy part of cells that varies in both length and content using VBA", "body": "<p>So I have workbook1 (wbThis) and workbook2 (wbTarget) and in wbThis' sheet I have some cells which are filled. These cells have the format of:</p>\n\n<p>From <code>A6</code></p>\n\n<p>P2123: Begin procedure</p>\n\n<p><code>A7</code></p>\n\n<p>P1234: Code</p>\n\n<p><code>A8</code></p>\n\n<p>P4456-6: Document</p>\n\n<p>|     </p>\n\n<p>V</p>\n\n<p>(down arrow)</p>\n\n<p><code>A27</code></p>\n\n<p>It continues like that. Now I have 2 issues.</p>\n\n<p><strong>Problem1</strong> I want to copy the <code>PXXXxX:</code> (small x is like an arbitrary summation of - or _ or > etc etc) codes to wbTarget. This code varies as you can see but there will <em>always</em> be a \"P\" in the beginning and a \":\" at the end. Regarding this, I have tried with the code:</p>\n\n<pre><code>Dim wbThis As Workbook\nDim wbTarget As Workbook\nDim rowRng As Integer\nDim targetRowRng As Integer\n\nFor rowRng 6 To 27\n   For targetRowRng 14 To 35 \n      If Left((A:rowRng).Value,1) = \"P\" Then\n         wbThis.Sheets(\"Sheet1\").Range(A:rowRng).Copy\n         wbTarget.Sheets(\"Sheet1\").Range(E:targetRowRng).PasteSpecial\n      End If\n   Next\nNext\n</code></pre>\n\n<p>However, as you may have noticed, I have not wrote the code where I want it to end on \":\" and copy everything inbetween (<strong>including</strong> \"P\" <strong>but excluding</strong> \":\").. I don't know how to code this and I would like your help.</p>\n\n<p>Since the length of PXXXxX varies - something like:</p>\n\n<pre><code>If Left((A:rowRng).Value,1) = \"P\" Then\n   If Left((A:rowRng).Value,5) = \":\" Then\n</code></pre>\n\n<p>won't work, unfortunately.</p>\n\n<p><strong>Problem2</strong> Now there is no way to that all cells of wbThis' range of <code>A6</code> -> <code>A27</code> will be filled everytime there's a new document and because I don't want unnecessary copy/pasting I want the script to stop the copy/pasting of PXXXxX: if the script doesn't find a P in eg <code>A16</code>. (if there is no P there is no PXXXxX and then the cell will be empty and therefore redundant - the same applies to all cells under it within the same column)\nI guess you can code this using else to the If statement above:</p>\n\n<pre><code>ElseIf\n       Pass 'Any code here that return to the rest of the script\n</code></pre>\n\n<p>This doesn't look right though, I haven't found much regarding this.</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1457530514, "post_id": 35893062, "comment_id": 59446934, "body": "Why not use the Remove Duplicates function within Excel, and not use VBA? In Excel 2013: Highlight your column, navigate to <i>Data-&gt;Remove Duplicates</i>"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457530770, "post_id": 35893062, "comment_id": 59447098, "body": "I&#39;ve found the tips on <a href=\"https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/\" rel=\"nofollow noreferrer\">this site</a> good for getting my code to run faster, a good first step may be having a look there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457530940, "post_id": 35893062, "comment_id": 59447224, "body": "OK, it sounds like you are trying to build your own flavor of &#39;fuzzy logic&#39; (something that MS has already accomplished fairly well). Take a look at <a href=\"http://stackoverflow.com/questions/16602872/\">Set Auto Filtering multiple wildcards</a>, <a href=\"http://stackoverflow.com/questions/34532282/\">Can Advanced Filter criteria be in the VBA rather than a range?</a> and <a href=\"http://stackoverflow.com/questions/34614417\">Can AutoFilter take both inclusive and non-inclusive wildcards from Dictionary keys?</a>."}, {"owner": {"reputation": 87, "user_id": 4962011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQH6L.png?s=128&g=1", "display_name": "RJGordon", "link": "https://stackoverflow.com/users/4962011/rjgordon"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457532115, "post_id": 35893062, "comment_id": 59448085, "body": "I don&#39;t want to remove duplicates, I want to flag possible duplicates (things that have the same first and last name, and either the same email or address) for later inspection. I am also writing this for people who are very tech illiterate and just want to be able to hit &#39;run&#39; and have it do what it was supposed to do. Furthermore I will be implementing some additional functionality that I can&#39;t get from advanced filtering in the future, so I&#39;m going to continue using a custom macro. @eirikdaude, I will look at that, thanks."}, {"owner": {"reputation": 1949, "user_id": 1723119, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8182f3271d9881acad7c1a4d8844ca15?s=128&d=identicon&r=PG", "display_name": "99moorem", "link": "https://stackoverflow.com/users/1723119/99moorem"}, "edited": false, "score": 0, "creation_date": 1457532444, "post_id": 35893062, "comment_id": 59448340, "body": "I would say you need to read your data into an array and then do processing for duplicates on the array. You could even read the duplicate &quot;Yes&quot;&#39;s into the array in a new column and then output the whole thing. the slowest part of working with spreadsheets is normally accessing the sheet itself so with the above mentioned method you will only access the sheet twice, once to read once to write."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1457533722, "post_id": 35893062, "comment_id": 59449265, "body": "The usual way to get rid of two nested search loops (which is quadratic in the size of the ranges) is to make them sequential rather than nested by using a <code>Dictionary</code> which is loaded in the first loop and then used to check for matches in the second loop. If the ranges are large this sort of thing can make the difference between an algorithm which takes hours to run vs. an algorithm which takes seconds to run."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1457597601, "post_id": 35893062, "comment_id": 59480854, "body": "don&#39;t use <code>dim</code> inside a loop. And the way you declare multiple dim&#39;s is wrong, only the last one will be declared correctly..."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 0, "creation_date": 1457597692, "post_id": 35893062, "comment_id": 59480905, "body": "use <code>option explicit</code>: it seems you didn&#39;t declare i, n, ..."}], "answers": [{"tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": true, "score": 2, "last_activity_date": 1457563169, "creation_date": 1457563169, "answer_id": 35904115, "question_id": 35893062, "link": "https://stackoverflow.com/questions/35893062/optimizing-vba-excel-macro-code-finding-duplicates-in-large-sheet/35904115#35904115", "title": "Optimizing VBA / Excel Macro Code (Finding Duplicates in Large Sheet)", "body": "<p>Okay, so this is one of those problems that stuck in the back of my head, so I had to solve it (thanks a lot @RJGordon!). I ended up solving it two different ways - the first with nested loops and the second with hashed dictionaries. The second is a cleaner and faster algorithm, but I'll present both for thoroughness sake.</p>\n\n<p><strong>Nested Loops</strong></p>\n\n<p>As @JohnColeman pointed out, this method makes sense logically but scales terribly. It was easy enough to provide a list of all the duplicate rows for each record and has the advantage of tagging the first rows in the dataset. (The second solution below does not tag the initial record with the duplicates below, but you can solve for that as well if needed.)</p>\n\n\n\n<pre><code>Option Explicit\n\nSub test()\n    MarkDuplicates ActiveSheet, 1, 2, 3, 4, 5, 6\nEnd Sub\n\nSub MarkDuplicates(sh As Worksheet, lNameCol As Long, _\n                   fNameCol As Long, addressCol As Long, _\n                   emailCol As Long, duplicateCol As Long, _\n                   fOccuranceCol As Long)\n    Dim lastRow As Long\n    Dim lastCol As Long\n    Dim acctRange As Range\n    Dim acctData As Variant\n    Dim checkRow As Long\n    Dim otherRow As Long\n    Dim dupScore As Integer\n    Dim dupList As String\n\n    '--- determine the range of data and copy to a memory-based array\n    lastRow = sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row\n    lastCol = sh.Cells(1, sh.Columns.Count).End(xlToLeft).Column\n    Set acctRange = sh.Range(\"A1\").Resize(lastRow, lastCol)\n    acctData = acctRange\n\n    '--- nested loop to check each row against every other row\n    For checkRow = 2 To lastRow\n        dupList = \"\"\n        For otherRow = 2 To lastRow\n            dupScore = 0\n            If otherRow &lt;&gt; checkRow Then\n                If acctData(checkRow, lNameCol) = acctData(otherRow, lNameCol) Then\n                    dupScore = dupScore + 2\n                End If\n                If acctData(checkRow, fNameCol) = acctData(otherRow, fNameCol) Then\n                    dupScore = dupScore + 2\n                End If\n                If acctData(checkRow, addressCol) = acctData(otherRow, addressCol) Then\n                    dupScore = dupScore + 1\n                End If\n                If acctData(checkRow, emailCol) = acctData(otherRow, emailCol) Then\n                    dupScore = dupScore + 1\n                End If\n                If dupScore &gt; 4 Then\n                    dupList = dupList &amp; otherRow &amp; \",\"\n                End If\n            End If\n        Next otherRow\n        If Len(dupList) &gt; 0 Then\n            dupList = Left(dupList, Len(dupList) - 1)\n            acctData(checkRow, duplicateCol) = \"Yes\"\n            acctData(checkRow, fOccuranceCol) = dupList\n        Else\n            acctData(checkRow, duplicateCol) = \"\"\n            acctData(checkRow, fOccuranceCol) = \"\"\n        End If\n    Next checkRow\n\n    '--- copy the array back to the worksheet\n    acctRange = acctData\n\n    Set sh = Nothing\nEnd Sub\n</code></pre>\n\n<p><strong>Using Dictionaries</strong></p>\n\n<p>And I do mean dictionaries (plural). Because your duplicate score threshold can be reached with three different combinations of fields, your dictionary hash must test each combination. The dictionary key (hash) I've chosen is a concatenated string of the fields that, when tested, would indicate a duplicate record. This solution shows only a single loop with three dictionaries. If you wanted a list of all duplicate records found, then rewrite the code to create all three dictionaries in a single loop, then use a separate (not nested) loop to each record against each dictionary key and keep a running list of the dupes. (I kept it to a single loop for efficiency.)</p>\n\n<p>Creating a single dictionary with a longer key (e.g. lastName+firstName+address+email) will cause you to have key collisions for records with duplicate ALL those fields, but you'll still have to find a way to test the other combinations. Someone far smarter than me may come up with a simpler way.</p>\n\n\n\n<pre><code>Option Explicit\n\nSub test()\n    MarkDuplicates ActiveSheet, 1, 2, 3, 4, 5, 6\nEnd Sub\n\nSub MarkDuplicates(sh As Worksheet, lNameCol As Long, _\n                   fNameCol As Long, addressCol As Long, _\n                   emailCol As Long, duplicateCol As Long, _\n                   fOccuranceCol As Long)\n    Dim lastRow As Long\n    Dim lastCol As Long\n    Dim acctRange As Range\n    Dim acctData As Variant\n    Dim acctDict1 As Dictionary\n    Dim acctDict2 As Dictionary\n    Dim acctDict3 As Dictionary\n    Dim acctKey As String\n    Dim checkRow As Long\n    Dim otherRow As Long\n    Dim dupScore As Integer\n    Dim dupList As String\n\n    '--- determine the range of data and copy to a memory-based array\n    lastRow = sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row\n    lastCol = sh.Cells(1, sh.Columns.Count).End(xlToLeft).Column\n    Set acctRange = sh.Range(\"A1\").Resize(lastRow, lastCol)\n    acctData = acctRange\n\n    Set acctDict1 = New Dictionary\n    Set acctDict2 = New Dictionary\n    Set acctDict3 = New Dictionary\n\n    '--- build the initial dictionary\n    '    for the key to trip as duplicate, there are three possible\n    '    combinations to check, so we make three dictionaries and\n    '    create keys as combinations of the fields\n    For checkRow = 2 To lastRow\n        '--- clear previous flags\n        acctData(checkRow, duplicateCol) = \"\"\n        acctData(checkRow, fOccuranceCol) = \"\"\n\n        '--- dupe is lastname + firstname\n        acctKey = acctData(checkRow, lNameCol) &amp; acctData(checkRow, fNameCol)\n        If Not acctDict1.Exists(acctKey) Then\n            acctDict1.Add acctKey, checkRow\n        ElseIf acctData(checkRow, duplicateCol) &lt;&gt; \"Yes\" Then\n            acctData(checkRow, duplicateCol) = \"Yes1\"\n            acctData(checkRow, fOccuranceCol) = acctDict1.Item(acctKey)\n        End If\n\n        '--- dupe is lastname + address + email\n        acctKey = acctData(checkRow, lNameCol) &amp; acctData(checkRow, addressCol) &amp; _\n                  acctData(checkRow, emailCol)\n        If Not acctDict2.Exists(acctKey) Then\n            acctDict2.Add acctKey, checkRow\n        ElseIf acctData(checkRow, duplicateCol) &lt;&gt; \"Yes\" Then\n            acctData(checkRow, duplicateCol) = \"Yes2\"\n            acctData(checkRow, fOccuranceCol) = acctDict2.Item(acctKey)\n        End If\n\n        '--- dupe is firstname + address + email\n        acctKey = acctData(checkRow, fNameCol) &amp; acctData(checkRow, addressCol) &amp; _\n                  acctData(checkRow, emailCol)\n        If Not acctDict3.Exists(acctKey) Then\n            acctDict3.Add acctKey, checkRow\n        ElseIf acctData(checkRow, duplicateCol) &lt;&gt; \"Yes\" Then\n            acctData(checkRow, duplicateCol) = \"Yes3\"\n            acctData(checkRow, fOccuranceCol) = acctDict3.Item(acctKey)\n        End If\n    Next checkRow\n\n    '--- copy the array back to the worksheet\n    acctRange = acctData\n\n    Set sh = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 4962011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQH6L.png?s=128&g=1", "display_name": "RJGordon", "link": "https://stackoverflow.com/users/4962011/rjgordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1925, "favorite_count": 0, "accepted_answer_id": 35904115, "answer_count": 1, "score": 2, "last_activity_date": 1457563169, "creation_date": 1457530398, "question_id": 35893062, "link": "https://stackoverflow.com/questions/35893062/optimizing-vba-excel-macro-code-finding-duplicates-in-large-sheet", "title": "Optimizing VBA / Excel Macro Code (Finding Duplicates in Large Sheet)", "body": "<p>I haven't really ever coded in VBA or anything of the sort except short little things in VB done years ago. This is my attempt at writing some code that will search through a excel sheet database of client accounts and search for possible duplicate accounts. Sadly, on the machine that I need to run this on, it can only handle about 3,500 entries without crashing Excel. I contribute this to both my code being horribly unoptimized as-well as the machine being slow. </p>\n\n<p>What can be done to optimize the following code, and what best practices in VBA should I use in the future?</p>\n\n<pre><code>'Essentially, this loops through each row in the sheet\n'For each row, it loops through every row after it, searching for duplicates of itself (skipping over a rows that have previously been marked as duplicates)\n'Duplicates are defined by entries that meet a 'threshhold' of similarity\n'The threshhold is defined as the number '5', first and last names are each two points, address and email address are one point\n'That means that in order for an entry to meet the thresshold, the first and last name must be the same, and it must also have either the same address or email\n'When duplicates are found, the duplicate column is marked as 'Yes' for that row, and the first occurence column is marked with a number defining the row number where the account first appeared\n\nSub Main():\n    Dim lNameCol, fNameCol, addressCol, emailCol, duplicateCol, fOccurenceCol As String\n\n    'Defines the column letters for the various data fields\n    lNameCol = \"A\"\n    fNameCol = \"B\"\n    addressCol = \"C\"\n    emailCol = \"D\" \n    duplicateCol = \"E\"   'The column where a entry/row will be marked as being a duplicate\n    fOccurenceCol = \"F\"  'The column that contains the row number where a duplicate accounts first occurence was found\n\n    Call Duplicates(lNameCol, fNameCol, addressCol, emailCol, duplicateCol, fOccurenceCol)\nEnd Sub\n\n'Gets number of rows in currently active sheet\nFunction RowCount():\n    Application.ActiveSheet.UsedRange\n    RowCount = Worksheets(\"Sheet1\").UsedRange.Rows.Count\nEnd Function\n\n'Finds and labels duplicates\nSub Duplicates(ByVal lNameCol As String, ByVal fNameCol As String, ByVal addressCol As String, ByVal emailCol As String, ByVal duplicateCol As String, ByVal fOccurenceCol As String)\n    Dim lRowCount As Integer\n    lRowCount = RowCount()\n\n    'Loops through each row in the sheet\n    For i = 1 To lRowCount\n\n        Dim duplicate, lastName, firstName, email, address As String\n\n        'Sets these variables' values corresponding cell value in row 'i'\n        'UCase capitilizes things to make entries case-insensitive\n        duplicate = UCase(Range(duplicateCol &amp; i).Value)\n        lastName = UCase(Range(lNameCol &amp; i).Value)\n        firstName = UCase(Range(fNameCol &amp; i).Value)\n        email = UCase(Range(emailCol &amp; i).Value)\n        address = UCase(Range(addressCol &amp; i).Value)\n\n        'Checks to make sure row has not already been marked a duplicate, if it hasn't it continues\n        If (StrComp(duplicate = \"YES\", vbTextCompare) = 1) Then\n\n            'Loops through every row after the current row (row 'i')\n            For n = (i + 1) To lRowCount\n\n                'duplicateThreshold is an integer that defines the threshhold of similarity that rows need to have in order to be labeled a duplicate\n                Dim duplicateThreshhold As Integer\n                Dim lastName2, firstName2, email2, address2 As String\n\n                duplicateThreshhold = 0\n\n                'These are the entry variables for account entry at row 'n' being compared to the account entry at row 'i'\n                lastName2 = UCase(Range(lNameCol &amp; n).Value)\n                firstName2 = UCase(Range(fNameCol &amp; n).Value)\n                email2 = UCase(Range(emailCol &amp; n).Value)\n                address2 = UCase(Range(addressCol &amp; n).Value)\n\n                'Adds 2 points to threshhold if first name is the same\n                If lastName = lastName2 Then\n                    duplicateThreshhold = duplicateThreshhold + 2\n\n                End If\n\n                'Adds 2 points to threshold if last name is the same\n                If firstName = firstName2 Then\n                    duplicateThreshhold = duplicateThreshhold + 2\n                End If\n\n                'The remaining two fields give 1 point each to the thresshold\n                'As long as the sum of the points given by first and last name is always greater than half of the threshhold, first and last name will always be required\n\n                If email = email2 Or address = address2 Then\n                    duplicateThreshhold = duplicateThreshhold + 1\n                End If\n\n                If duplicateThreshhold &gt; 4 Then\n                   'Labels duplicate entries as duplicates\n                    Range(duplicateCol &amp; i).Value = \"Yes\"\n                    Range(duplicateCol &amp; n).Value = \"Yes\" \n\n                   'Labels duplicate entries with the first occurence of that entry\n                    Range(fOccurenceCol &amp; i).Value = i 'Labels first occurence account's row number\n                    Range(fOccurenceCol &amp; n).Value = i\n\n                End If\n\n            Next\n        End If\n    Next\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "ms-access", "interop", "vbe"], "comments": [{"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1457530976, "post_id": 35892640, "comment_id": 59447260, "body": "Why do you want to insert the code into the database at all? Why aren&#39;t you implementing the things the code should do in your C# code?"}, {"owner": {"reputation": 343, "user_id": 4193116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0026bd50142b4050a9dc8e6e42c326?s=128&d=identicon&r=PG&f=1", "display_name": "prizm1", "link": "https://stackoverflow.com/users/4193116/prizm1"}, "reply_to_user": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1457531694, "post_id": 35892640, "comment_id": 59447764, "body": "Oh yeah, i fix the title to &#39;modules&#39; instead of macros. This is a little weird to explain, but in short: there were crafted a lot of similiar access databases in the past, which are slightly different but those differencies are meaningful. The code that gets passed into the db, executes other vba-functions in the database, which can&#39;t be called directly because they are affiliated with forms in the MSA-DB."}, {"owner": {"reputation": 343, "user_id": 4193116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0026bd50142b4050a9dc8e6e42c326?s=128&d=identicon&r=PG&f=1", "display_name": "prizm1", "link": "https://stackoverflow.com/users/4193116/prizm1"}, "reply_to_user": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1457531726, "post_id": 35892640, "comment_id": 59447796, "body": "This was a process, which was done by users before and now is the job of the pc. But I guess it is impossible to achieve it, done a little research already and the VBE-.NET-solution seems to be too universal for all office tools to be much of a help on this issue."}, {"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1457532411, "post_id": 35892640, "comment_id": 59448312, "body": "I still don&#39;t get it. If the existing code in the database references forms, it will fail if the forms are not open, regardless if it is called directly from your C# code or via inserted &quot;proxy&quot;-code inside the db."}, {"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 1, "creation_date": 1457532565, "post_id": 35892640, "comment_id": 59448431, "body": "The AcObjectType in your sample code should be acModule not acMacro."}, {"owner": {"reputation": 343, "user_id": 4193116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0026bd50142b4050a9dc8e6e42c326?s=128&d=identicon&r=PG&f=1", "display_name": "prizm1", "link": "https://stackoverflow.com/users/4193116/prizm1"}, "reply_to_user": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1457533180, "post_id": 35892640, "comment_id": 59448835, "body": "!_! thats indeed the solution!!! It appeared below the modules list in access after using acModule instead of acMacro! You don&#39;t need to Open, it seems to be present for Access just not accessible for some parts of the program. Thanks a lot. And for the question before, the forms include variable information which are checked for plausibility by routines in the c#-code before proxy-code launches the rest. I hope to get rid of this asap, but you know how things are! Would love to give you a accepted answer or a upvote, if you dont want to write an answer, i will do it after 2 days so all see it"}], "owner": {"reputation": 343, "user_id": 4193116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ea0026bd50142b4050a9dc8e6e42c326?s=128&d=identicon&r=PG&f=1", "display_name": "prizm1", "link": "https://stackoverflow.com/users/4193116/prizm1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457531745, "creation_date": 1457529313, "last_edit_date": 1457531745, "question_id": 35892640, "link": "https://stackoverflow.com/questions/35892640/saving-modules-correctly-using-access-interop", "title": "Saving Modules correctly using Access-Interop", "body": "<p>Even though my last questions weren't accepted well, I will give it another try.</p>\n\n<p>I'm working on a program that is capable of controlling a lot of office-application behaviour by using the COM/Interop-Interface Microsoft provided for Word/Access/Excel. Still some functions differ from each other in the way that they are kept specific for the program that gets addressed.</p>\n\n<p>My ambition is to Insert Macro-Code to an existing Access-Database and run the code while the Database is open and delete the code before the Database closes down. Partially this works as wished by using following C# code:</p>\n\n<pre><code>        VBProject found = null;\n        Access.Application currApplication = this._currentInstance.Application;\n        if (target.Equals(\"\") || scriptText.Equals(\"\"))\n            return false;\n        foreach (VBProject vb in currApplication.VBE.VBProjects)\n        {\n            if (currApplication.CurrentDb().Name.Equals(vb.FileName))\n            {\n                found = vb;\n                break;\n            }\n        }\n\n        if (found != null)\n        {\n            foreach (VBComponent foundComponent in found.VBComponents) \n            {\n                if (foundComponent.Name.Equals(target))\n                {\n                    return true;\n                }\n            }\n            VBComponent module = found.VBComponents.Add(vbext_ComponentType.vbext_ct_StdModule);\n            module.Name = target;\n            module.CodeModule.AddFromString(scriptText);\n            return true;\n        }\n        else\n        {\n            return false;\n        }\n</code></pre>\n\n<p>Now in particular, Access makes a diversion between VBA-Code-Modules which are visible in the Code-Editor and Modules which are loaded into the Database itself. For inserting the Module into the Database, it needs to be saved another time. When using the GUI, there's a window that popsup and asks for the Name to be used when saving it into the DB. It already takes the correct one etc. and it's fine after doing it by hand. </p>\n\n<p>Besides the manual solution I found no way to do this step programatically.</p>\n\n<p>Initial thoughts were:</p>\n\n<pre><code>            currApplication.DoCmd.OpenModule(target, Type.Missing);\n            currApplication.DoCmd.Save(Access.AcObjectType.acMacro, target);\n</code></pre>\n\n<p>or</p>\n\n<pre><code>            found.VBE.ActiveVBProject.SaveAs(\"\");\n</code></pre>\n\n<p>The only two methods I could imagine would be doing the step I wanted. VBE in it's new .NET compatible form is documented very bad. Methods that would have applied to the native version are not guilty anymore. So I'm stuck with it now.</p>\n\n<p>In case someone asks, why would you save the module at all, because once it's inserted in VBE it can be run like any other module listed in Access also, that's true, but for some unknown reasons this seems to be more fault-prone then to save it twice. Got runtime errors (like 2501) while launching the macro, which is not the case when it's saved properly.</p>\n\n<p>Keeping it forever in the Access-Databases would be the last option but since those are many MDBs and thus they are changing frequently, I thought it would be nice to have it dynamic.</p>\n\n<p>Hope somebody understands what I wrote here, (not so easy for me), and is enabled to help somehow :)</p>\n\n<p>Thanks for all the reading. Looking forward for some good results, from the best community, hehe.</p>\n"}, {"tags": ["excel", "vba", "for-loop"], "comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1457529391, "post_id": 35892520, "comment_id": 59446110, "body": "it still be true, you need to reset it manually"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 4, "last_activity_date": 1457529553, "creation_date": 1457529553, "answer_id": 35892728, "question_id": 35892520, "link": "https://stackoverflow.com/questions/35892520/if-you-define-a-variable-inside-a-loop-is-it-still-defined-after-the-loop-is-cl/35892728#35892728", "title": "if you define a variable inside a loop, is it still defined after the loop is closed?", "body": "<p>Yes. It will continue to be defined until it is assigned a new value or a destructor is applied to it (e.g. when exiting the sub when <strong>a</strong> has been declared within the sub).</p>\n\n<p>Additionally, something like a <a href=\"https://msdn.microsoft.com/en-us/library/5ebk1751.aspx\" rel=\"nofollow\">For Each...Next Statement</a> can have the value of the increment evaluated after the loop has been exited.</p>\n\n<pre><code>dim i as long, lr as long\nlr = 500\n\nfor i = 1 to lr\n    if i &gt; 99 then exit for\nnext i\n\nif i &lt;= lr then\n    debug.print \"did not finish loop\"\nelse\n    debug.print \"finished loop\"\nend if\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1457529553, "creation_date": 1457528918, "question_id": 35892520, "link": "https://stackoverflow.com/questions/35892520/if-you-define-a-variable-inside-a-loop-is-it-still-defined-after-the-loop-is-cl", "title": "if you define a variable inside a loop, is it still defined after the loop is closed?", "body": "<p>if we define the value of <code>a = something</code> inside a for loop.\nWhen the loop finishes, will <code>a = something</code> continue to be true or will it be reset after the loop is finished?</p>\n"}, {"tags": ["arrays", "excel", "vba", "function", "return"], "comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1457528022, "post_id": 35891999, "comment_id": 59445119, "body": "I&#39;m not 100% sure, but I think you need to use <code>Set</code>. <code>Set CNPJs = unArray(Plan2.Range(&quot;A2:A&quot; &amp; U_L))</code>... Also use <code>New</code> for the collection in the function..."}, {"owner": {"reputation": 722, "user_id": 3841056, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bfMFP.png?s=128&g=1", "display_name": "Lugarini", "link": "https://stackoverflow.com/users/3841056/lugarini"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1457528283, "post_id": 35891999, "comment_id": 59445315, "body": "It works!!! Thanks man! I also had to use <code>Set</code> here: <code>Set unArray = arr</code>  . Please post as answer and I will acept it."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1457529036, "post_id": 35891999, "comment_id": 59445841, "body": "I&#39;m just on phone right now. But would need to explain why to post a suitable answer... maybe later... still, I don&#39;t mind the points. You got it to work, that is all that counts for me ;)"}, {"owner": {"reputation": 722, "user_id": 3841056, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bfMFP.png?s=128&g=1", "display_name": "Lugarini", "link": "https://stackoverflow.com/users/3841056/lugarini"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1457609417, "post_id": 35891999, "comment_id": 59489005, "body": "ok, but I need to chose an answer, please post it :)"}], "answers": [{"comments": [{"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1457614114, "post_id": 35892966, "comment_id": 59492259, "body": "Unfortunately that is not true. <code>&quot;A&quot; &amp; variable</code> will be a string in the first place. (As long as <code>variable</code> is no object which would throw an error (still will work if the object is a pointer to a non-object variable like <code>Range</code> or <code>Cells</code>)). At the other hand, <code>Range(Cells(1 ,1))</code> will also work and it is just a pointer (no string or numerical variable). ;)"}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "reply_to_user": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1457617381, "post_id": 35892966, "comment_id": 59494670, "body": "Is this a recent change to excel, because I have certainly received errors by doing this in the past.  I don&#39;t understand how you can concatenate a string with an integer and not get an error"}], "tags": [], "owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "is_accepted": false, "score": 0, "last_activity_date": 1457530138, "creation_date": 1457530138, "answer_id": 35892966, "question_id": 35891999, "link": "https://stackoverflow.com/questions/35891999/excel-vba-function-with-return/35892966#35892966", "title": "Excel vba Function with return", "body": "<pre><code>U_L = Plan2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n</code></pre>\n\n<p>This will return a long or integer.  A range requires a string and therefore you need to convert U_L to a string when referencing it in a range.</p>\n\n<pre><code>CNPJs = unArray(Plan2.Range(\"A2:A\" &amp; CStr(U_L)))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": true, "score": 1, "last_activity_date": 1457613637, "creation_date": 1457613637, "answer_id": 35916790, "question_id": 35891999, "link": "https://stackoverflow.com/questions/35891999/excel-vba-function-with-return/35916790#35916790", "title": "Excel vba Function with return", "body": "<p>A collection is an object and needs to be treated like one, means you need to <code>Set</code> it. But keep in mind that this action just creates a pointer to the range inside your RAM.<br>\nFor your case just use:</p>\n\n<pre><code>Set CNPJs = unArray(Plan2.Range(\"A2:A\" &amp; U_L))\n</code></pre>\n\n<p>That said, it doesn't matter for your code, but having 2 collections while one is <code>Set</code> to the other, alternating one of them will also effect the other.</p>\n\n<p>If you still have questions, just ask. :)</p>\n"}], "owner": {"reputation": 722, "user_id": 3841056, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bfMFP.png?s=128&g=1", "display_name": "Lugarini", "link": "https://stackoverflow.com/users/3841056/lugarini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 35916790, "answer_count": 2, "score": 1, "last_activity_date": 1457613637, "creation_date": 1457527565, "last_edit_date": 1495540228, "question_id": 35891999, "link": "https://stackoverflow.com/questions/35891999/excel-vba-function-with-return", "title": "Excel vba Function with return", "body": "<p>I found <a href=\"https://stackoverflow.com/a/3017973/3841056\">this solution</a> for my problem. And it works fine like this:  </p>\n\n<pre><code>Dim CNPJs As New Collection, a\nDim i As Long\nDim rng As Range\n\nU_L = Plan2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nOn Error Resume Next\nFor Each rng In Plan2.Range(\"A2:A\" &amp; U_L)\n    CNPJs.Add rng.value, rng.value\nNext\n</code></pre>\n\n<p>But now I want to bulid a function that returns this unique array, because I will use this many times...  I tried this:  </p>\n\n<pre><code>Public Function unArray(myRange As Range) As Collection\n\n    Dim arr As Collection, a\n\n    On Error Resume Next\n    For Each rng In myRange\n        arr.Add rng.value, rng.value\n    Next\n\n    unArray = arr\n\nEnd Function\n</code></pre>\n\n<p>And I call it:</p>\n\n<pre><code>Sub test()\n\n      Dim CNPJs As New Collection, a\n\n      U_L = Plan2.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n      CNPJs = unArray(Plan2.Range(\"A2:A\" &amp; U_L))\n\nEnd Sub\n</code></pre>\n\n<p>But it returns this error:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/ymCnA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ymCnA.png\" alt=\"enter image description here\"></a><br>\n\"<em>Compilation error:</em>\"<br>\n\"<em>The argument is required\"</em>  </p>\n\n<p>Can you help me?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1457526820, "post_id": 35891618, "comment_id": 59444261, "body": "<code>On Error Resume Next</code> will enable your code to completely ignore errors - although typically it&#39;s not advised to use. <code>On Error GoTo 0</code> will allow errors to occur once more."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6039254, "user_type": "registered", "profile_image": "https://graph.facebook.com/184065445306408/picture?type=large", "display_name": "IClancularius", "link": "https://stackoverflow.com/users/6039254/iclancularius"}, "edited": false, "score": 0, "creation_date": 1457529264, "post_id": 35891871, "comment_id": 59446020, "body": "Can you provide examples on how i would include the above?"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "reply_to_user": {"reputation": 15, "user_id": 6039254, "user_type": "registered", "profile_image": "https://graph.facebook.com/184065445306408/picture?type=large", "display_name": "IClancularius", "link": "https://stackoverflow.com/users/6039254/iclancularius"}, "edited": false, "score": 0, "creation_date": 1457529458, "post_id": 35891871, "comment_id": 59446162, "body": "Just put <code>On Error Resume Next</code> at the top of the procedure. So after line <code>Private Sub CommandButton25_Click()</code>."}, {"owner": {"reputation": 15, "user_id": 6039254, "user_type": "registered", "profile_image": "https://graph.facebook.com/184065445306408/picture?type=large", "display_name": "IClancularius", "link": "https://stackoverflow.com/users/6039254/iclancularius"}, "edited": false, "score": 0, "creation_date": 1457530394, "post_id": 35891871, "comment_id": 59446840, "body": "Perfect! Thanks very much indeed."}], "tags": [], "owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1457527185, "last_edit_date": 1525816150, "creation_date": 1457527185, "answer_id": 35891871, "question_id": 35891618, "link": "https://stackoverflow.com/questions/35891618/excel-vba-to-clear-filters-from-table-and-supress-any-errors/35891871#35891871", "title": "Excel VBA to clear filters from table and supress any errors", "body": "<p>You can use <code>On Error Resume Next</code>.</p>\n\n<p>You should ensure to turn error handling back on at a suitable place in your code <code>On Error GoTo 0</code>.</p>\n\n<p>You can also create a label and tell the code to go to this label if an error occurs <code>On Error GoTo &lt;label&gt;</code>.</p>\n\n<p>See <a href=\"http://www.cpearson.com/excel/errorhandling.htm\" rel=\"nofollow noreferrer\">Chip Pearson's article</a> on error handling for more information.</p>\n"}], "owner": {"reputation": 15, "user_id": 6039254, "user_type": "registered", "profile_image": "https://graph.facebook.com/184065445306408/picture?type=large", "display_name": "IClancularius", "link": "https://stackoverflow.com/users/6039254/iclancularius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 35891871, "answer_count": 1, "score": -1, "last_activity_date": 1457527185, "creation_date": 1457526512, "question_id": 35891618, "link": "https://stackoverflow.com/questions/35891618/excel-vba-to-clear-filters-from-table-and-supress-any-errors", "title": "Excel VBA to clear filters from table and supress any errors", "body": "<p>Go easy im a newbie, and new to Excel and VBA etc. </p>\n\n<p>I have a large database that contains user profile details which is in table form. the issue i am having is i have a command button to clear the filters that are applied to the table, i got the requried macro by recording it, however if there are no filters applied i run into the below error:</p>\n\n<p>Run-time error '1004':</p>\n\n<p>ShowAllData method of worksheet class failed</p>\n\n<p>I know why im getting the error, which is simply because there are no filters applied and hence it throws this error up, what i would like is to have this error ignored entirely. </p>\n\n<p>Here is my Command Button code:</p>\n\n<pre><code>Private Sub CommandButton25_Click()\nClearFilters2 Macro\nRange(\"Table24[#Headers]\").Select\nActiveSheet.ShowAllData\n\nEnd Sub\n</code></pre>\n\n<p>Any help to supress the runtime error would be appreciated, could i ask that the code be supplied with the correction?</p>\n\n<p>Thanks, </p>\n\n<p>JD</p>\n"}, {"tags": ["vba", "macros", "excel-2010", "save-as"], "comments": [{"owner": {"reputation": 975, "user_id": 1428108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0Gnsi.png?s=128&g=1", "display_name": "High Plains Grifter", "link": "https://stackoverflow.com/users/1428108/high-plains-grifter"}, "reply_to_user": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1457526973, "post_id": 35891365, "comment_id": 59444362, "body": "I&#39;ll try the suggestion in the possible duplicate and comment if it solves the problem, making it genuinely a duplicate - I agree it looks like it will be."}, {"owner": {"reputation": 975, "user_id": 1428108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0Gnsi.png?s=128&g=1", "display_name": "High Plains Grifter", "link": "https://stackoverflow.com/users/1428108/high-plains-grifter"}, "reply_to_user": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1457527535, "post_id": 35891365, "comment_id": 59444766, "body": "Yes, I agree it is a duplicate. Thanks for pointing this out and pointing me in the right direction."}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1457528079, "post_id": 35891365, "comment_id": 59445165, "body": "Glad the other question helped you."}], "owner": {"reputation": 975, "user_id": 1428108, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/0Gnsi.png?s=128&g=1", "display_name": "High Plains Grifter", "link": "https://stackoverflow.com/users/1428108/high-plains-grifter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1457527571, "answer_count": 0, "score": 0, "last_activity_date": 1457525785, "creation_date": 1457525785, "last_edit_date": 1495541730, "question_id": 35891365, "link": "https://stackoverflow.com/questions/35891365/saveas-non-workbook-file-using-vba", "closed_reason": "Duplicate", "title": "SaveAs non-workbook file using vba", "body": "<p>I have a series of .xml files that are used as data sources for our customers, viewed through an Excel \"template\", which populates tables etc. from the .xml.</p>\n\n<p>Each month, we get new .xml files on the server and one of our users runs a macro which adds the .xml files in turn to the template, saving the template each time with a new name corresponding to the name of the .xml file it now shows.</p>\n\n<p>I would like add a step to this macro, to move each .xml file to a new archive location. Ideally this would look the same as a cut/paste operation, removing the .xml file from the original location. I know how to delete a file using vba (thanks to <a href=\"https://stackoverflow.com/questions/67835/deleting-a-file-in-vba\">this</a> question), but not how to SaveAS a file that is not a workbook... How would I go about doing this?</p>\n"}, {"tags": ["excel", "vba", "macros"], "answers": [{"tags": [], "owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "is_accepted": false, "score": 1, "last_activity_date": 1457526019, "creation_date": 1457526019, "answer_id": 35891445, "question_id": 35891251, "link": "https://stackoverflow.com/questions/35891251/excel-macro-for-series-autofill/35891445#35891445", "title": "Excel macro for series autofill", "body": "<p>Never mind, I find the solution and I'll it share it for others who needs it also:</p>\n\n<pre><code>Sub FillSerialNumbers()\n  With Range(\"A2:A\" &amp; Range(\"B\" &amp; Rows.Count).End(xlUp).Row)\n    .Cells(1, 1).Value = 1\n    .DataSeries Rowcol:=xlColumns, Type:=xlLinear, Step:=1, Trend:=False\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1457527378, "creation_date": 1457527378, "answer_id": 35891932, "question_id": 35891251, "link": "https://stackoverflow.com/questions/35891251/excel-macro-for-series-autofill/35891932#35891932", "title": "Excel macro for series autofill", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff195345.aspx\" rel=\"nofollow\">Range.AutoFill method</a> is not the same as the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839262.aspx\" rel=\"nofollow\">Range.DataSeries</a>.</p>\n\n<pre><code>Sub FillHandle()\n    Dim lr As Long\n\n    'do not know what this is for\n    If IsEmpty(ActiveCell.Value) Then Exit Sub\n    'do not know what this is for either\n    If ActiveCell.Row = Rows.Count Then Exit Sub\n\n    With Worksheets(\"Sheet2\")   '&lt;~~ you should always know what worksheet you are on\n        lr = .Cells(Rows.Count, \"B\").End(xlUp).Row\n        .Cells(2, \"A\") = 1\n        .Range(.Cells(2, \"A\"), .Cells(lr, \"A\")).DataSeries _\n            Rowcol:=xlColumns, Type:=xlLinear, Step:=1\n    End With\n\n    'if the series is to be linear but not 1, 2, 3, etc then supply both\n    ' the first and last value and let .Series fill in the difference\n    With Worksheets(\"Sheet2\")   '&lt;~~ you should always know what worksheet you are on\n        lr = .Cells(Rows.Count, \"B\").End(xlUp).Row\n        .Cells(2, \"A\") = 1\n        .Cells(lr, \"A\") = 99\n        .Range(.Cells(2, \"A\"), .Cells(lr, \"A\")).DataSeries _\n            Rowcol:=xlColumns, Type:=xlLinear, _\n            Step:=(.Cells(lr, \"A\").Value2 - .Cells(2, \"A\").Value2) / (lr - 2)\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>The first example is a strictly <em>1, 2, 3</em> ordinal. The latter is a relative series fill where the first and last value and known but not necessarily the number of rows rows in between.</p>\n"}], "owner": {"reputation": 193, "user_id": 1136990, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f10d832460f2472e27caedb66f288101?s=128&d=identicon&r=PG", "display_name": "Paolo Medina", "link": "https://stackoverflow.com/users/1136990/paolo-medina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1457527378, "creation_date": 1457525485, "question_id": 35891251, "link": "https://stackoverflow.com/questions/35891251/excel-macro-for-series-autofill", "title": "Excel macro for series autofill", "body": "<p>I would like to ask how to create macro to autofill serial/series(1, 2, 3 and so on) from row A2 up to the end of data where there is data from Column B?</p>\n\n<p>I use this code:</p>\n\n<pre><code>  Sub FillHandle()\n  If IsEmpty(ActiveCell.Value) Then Exit Sub\n  If ActiveCell.Row = Rows.Count Then Exit Sub\n  If ActiveCell.Column &gt; 1 Then\n    If Not IsEmpty(ActiveCell.Offset(, -1)) And Not IsEmpty(ActiveCell.Offset(1, -1)) Then\n      Range(ActiveCell, ActiveCell.Offset(, -1).End(xlDown).Offset(, 1)).FillDown\n      Exit Sub\n    End If\n  End If\n  If ActiveCell.Column &lt; Columns.Count Then\n    If Not IsEmpty(ActiveCell.Offset(, 1)) And Not IsEmpty(ActiveCell.Offset(1, 1)) Then\n      Range(ActiveCell, ActiveCell.Offset(, 1).End(xlDown).Offset(, -1)).FillDown\n      Exit Sub\n    End If\n  End If\nEnd Sub\n</code></pre>\n\n<p>However, it just autofill \"1\" all through out.</p>\n\n<p>Below is the format of my excel sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/b6peB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b6peB.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba", "if-statement", "row"], "comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1457524702, "post_id": 35890900, "comment_id": 59442802, "body": "do you mean all cells in row for columns ` in columns B,C,D,E,F` equal to zero, or sum of these cells equal to zero, or any cell in specified cells for columns is equal zero? pleace specify"}, {"owner": {"reputation": 39, "user_id": 6004004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f653fec84c719758935b7c0d1540fb?s=128&d=identicon&r=PG&f=1", "display_name": "Faminebob", "link": "https://stackoverflow.com/users/6004004/faminebob"}, "reply_to_user": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1457525257, "post_id": 35890900, "comment_id": 59443164, "body": "Apologies for not being clear... I mean, for example: if A5 = 0 and B5 = 0 and C5 = 0, etc until G5, then delete row 5 entirely, for all used rows in the worksheet. Many thanks"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1457525554, "post_id": 35890900, "comment_id": 59443356, "body": "so, you need sum of cells?"}, {"owner": {"reputation": 39, "user_id": 6004004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f653fec84c719758935b7c0d1540fb?s=128&d=identicon&r=PG&f=1", "display_name": "Faminebob", "link": "https://stackoverflow.com/users/6004004/faminebob"}, "reply_to_user": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1457525713, "post_id": 35890900, "comment_id": 59443467, "body": "No. on certain rows the cells B through to G are blank. In this instance I do not want the row to be deleted. If the code deletes rows based on SUM(B:G)=0 then that would also delete rows in which cells are blank."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1457526029, "post_id": 35890900, "comment_id": 59443711, "body": "now it&#39;s fine, see one of the possible solutions"}, {"owner": {"reputation": 39, "user_id": 6004004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f653fec84c719758935b7c0d1540fb?s=128&d=identicon&r=PG&f=1", "display_name": "Faminebob", "link": "https://stackoverflow.com/users/6004004/faminebob"}, "reply_to_user": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1457526848, "post_id": 35890900, "comment_id": 59444281, "body": "Works perfect (the 2nd one) ... Thanks Vasily"}], "answers": [{"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 1, "last_activity_date": 1457527501, "last_edit_date": 1457527501, "creation_date": 1457525984, "answer_id": 35891430, "question_id": 35890900, "link": "https://stackoverflow.com/questions/35890900/vba-macro-to-delete-row-if-cells-in-b-c-d-e-f-g-all-0/35891430#35891430", "title": "VBA Macro to delete row if cells in B,C,D,E,F &amp; G all = &quot;0&quot;", "body": "<p>same algorithm as has been provided by <code>Gary's Student</code> but also has some difference, just for info:</p>\n\n<pre><code>Sub dural2()\n    Dim Cnt&amp;, RowCnt&amp;\n    RowCnt = Cells.Find(\"*\", , , , , xlPrevious).Row\n    For Cnt = RowCnt To 1 Step -1\n        If Evaluate(\"=COUNTIF(B\" &amp; Cnt &amp; \":G\" &amp; Cnt &amp; \",0)\") = 6 Then\n            Rows(Cnt).Delete\n        End If\n    Next Cnt\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1457526650, "last_edit_date": 1457526650, "creation_date": 1457526193, "answer_id": 35891502, "question_id": 35890900, "link": "https://stackoverflow.com/questions/35890900/vba-macro-to-delete-row-if-cells-in-b-c-d-e-f-g-all-0/35891502#35891502", "title": "VBA Macro to delete row if cells in B,C,D,E,F &amp; G all = &quot;0&quot;", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub dural()\n    Dim N As Long, i As Long, wf As WorksheetFunction\n\n    N = Cells(Rows.Count, \"B\").End(xlUp).Row\n    Set wf = Application.WorksheetFunction\n\n    For i = N To 1 Step -1\n        If wf.CountIf(Range(\"B\" &amp; i &amp; \":G\" &amp; i), 0) = 6 Then\n            Range(\"B\" &amp; i).EntireRow.Delete\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p><em>Note:</em></p>\n\n<p><code>COUNTIF()</code> can tell the difference between a true <strong>0</strong> and an empty cell.</p>\n"}, {"tags": [], "owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "is_accepted": false, "score": 0, "last_activity_date": 1457527760, "creation_date": 1457527760, "answer_id": 35892062, "question_id": 35890900, "link": "https://stackoverflow.com/questions/35890900/vba-macro-to-delete-row-if-cells-in-b-c-d-e-f-g-all-0/35892062#35892062", "title": "VBA Macro to delete row if cells in B,C,D,E,F &amp; G all = &quot;0&quot;", "body": "<p>As a different approach:</p>\n\n<pre><code>Sub DelLines()\n  Dim i As Long, j As Long, val As Variant, rng As Range\n  val = Intersect(ActiveSheet.UsedRange, Range(\"B:G\")).Value\n  For i = 1 To Ubound(val)\n    For j = 1 To 6\n      If val(i, j) &lt;&gt; 0 Or Len(val(i, j)) &gt; 0 Then Exit For\n    Next\n    If j &gt; 6 Then\n      If rng Is Nothing Then\n        Set rng = Rows(i)\n      Else\n        Set rng = Union(rng, Rows(i))\n      End If\n    End If\n  Next\n  rng.EntireRow.Delete\nEnd Sub\n</code></pre>\n\n<p>If you still have questions, just ask :)</p>\n\n<p><em>Done by phone, may contain errors or typos</em></p>\n"}], "owner": {"reputation": 39, "user_id": 6004004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f653fec84c719758935b7c0d1540fb?s=128&d=identicon&r=PG&f=1", "display_name": "Faminebob", "link": "https://stackoverflow.com/users/6004004/faminebob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1457527760, "creation_date": 1457524463, "question_id": 35890900, "link": "https://stackoverflow.com/questions/35890900/vba-macro-to-delete-row-if-cells-in-b-c-d-e-f-g-all-0", "title": "VBA Macro to delete row if cells in B,C,D,E,F &amp; G all = &quot;0&quot;", "body": "<p>I'm looking for some code that will delete all rows, who's cells in columns B,C,D,E,F &amp; G all =\"0\"</p>\n\n<p>Many thanks for any help in advance</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 1, "creation_date": 1457529470, "post_id": 35890737, "comment_id": 59446168, "body": "If you could flesh this out a bit more it would be helpful.  Is the above Update query all that&#39;s happening?  Why does it matter who updates the record first?  What, exactly, are you trying to do with this code?  How likely is it that the code will be run at the exact same time by more than one user?  What &quot;concurrency issues&quot; are you experiencing?  All of these questions are important to any proposed solution."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1457530151, "post_id": 35890737, "comment_id": 59446662, "body": "Race condition? Doesn&#39;t make sense here."}, {"owner": {"reputation": 81, "user_id": 1425563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b291d76925ce986fc303ce5051327c60?s=128&d=identicon&r=PG", "display_name": "laagland", "link": "https://stackoverflow.com/users/1425563/laagland"}, "edited": false, "score": 0, "creation_date": 1457531159, "post_id": 35890737, "comment_id": 59447405, "body": "This query is all that&#39;s happening. When I execute the query multiple times with multiple users, sometimes an updated [field] value gets overwritten. This shouldn&#39;t be happening as the subquery only selects null fields."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "edited": false, "score": 0, "creation_date": 1457531482, "post_id": 35890737, "comment_id": 59447630, "body": "Can you set the <code>[field]</code> to save on its initial save? instead of going back to an existing record and updating it."}, {"owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "edited": false, "score": 0, "creation_date": 1457532017, "post_id": 35890737, "comment_id": 59448020, "body": "Might have to slow the processing down.  Select Min(ID).  Run a DoEvents to let it catch up.  Put Min(ID) in a temp table if Min(ID) doesn&#39;t already exist in the temp table.  Run a DoEvents to let it catch up.  Run your code but with an inner join to the temp table to only pull that ID.  Yeah, it&#39;s clunky but in theory it should eliminate running twice for the same ID."}], "answers": [{"tags": [], "owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "is_accepted": false, "score": 0, "last_activity_date": 1457542741, "creation_date": 1457542741, "answer_id": 35897876, "question_id": 35890737, "link": "https://stackoverflow.com/questions/35890737/avoid-race-condition-in-vba-access-with-subquery/35897876#35897876", "title": "Avoid race condition in VBA Access with subquery", "body": "<p>You need a transaction. You need the entire script to be ACID. </p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/bb208950%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/bb208950%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n"}], "owner": {"reputation": 81, "user_id": 1425563, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b291d76925ce986fc303ce5051327c60?s=128&d=identicon&r=PG", "display_name": "laagland", "link": "https://stackoverflow.com/users/1425563/laagland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1457542741, "creation_date": 1457523989, "question_id": 35890737, "link": "https://stackoverflow.com/questions/35890737/avoid-race-condition-in-vba-access-with-subquery", "title": "Avoid race condition in VBA Access with subquery", "body": "<p>I'm updating an Access table from VBA Excel with a query containing a subquery:</p>\n\n<pre><code>UPDATE table\nSET [field] = \"username\"\nWHERE ID = (\nSELECT Min(ID)\n    FROM table\n    WHERE [field] Is Null\n)\n</code></pre>\n\n<p>The query is working fine, but when used by multiple users concurrency issues appear which let me to believe that the subquery is subject to a race condition. I've googled the problem and found some confirmations on this, but no real solutions.</p>\n\n<p>Anyone who can give me a pointer on how to avoid this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": true, "score": 1, "last_activity_date": 1457519865, "creation_date": 1457519865, "answer_id": 35889171, "question_id": 35888625, "link": "https://stackoverflow.com/questions/35888625/separate-text-in-excel-cell-based-on-formatting/35889171#35889171", "title": "Separate text in excel cell based on formatting", "body": "<p>I found a way that works, however I don't know your font color codes, so in my example I'm using red.  You will need to figure out the font colors in your cells.</p>\n\n<p>Use <code>MsgBox ActiveCell.Characters(Start:=1, Length:=1).Font.Color</code> to get the code for the first character in the <code>ActiveCell</code>.</p>\n\n<p>The way it works is it check each character in the string 1 at a time.  If the character is red, then it adds a digit to the <code>c</code> variable. At the end I take the left <code>c</code> number of characters.</p>\n\n<pre><code>Sub test1()\n\nDim i As Integer\nDim c As Integer\nDim l As Integer\n\n\nWhile ActiveCell.Value &lt;&gt; \"\"\n\ni = 1\nc = 0\nl = Len(ActiveCell.Value)\n\nWhile i &lt;= l\n\nIf ActiveCell.Characters(Start:=1, Length:=i).Font.Color = 255 Then\nc = c + 1\ni = i + 1\n\nElse\n\ni = i + 1\n\nEnd If\n\nWend\n\nActiveCell.Offset(0, 1).Value = Left(ActiveCell.Value, c)\nActiveCell.Offset(0, 2).Value = Right(ActiveCell.Value, l - c)\n\nActiveCell.Offset(1, 0).Select\n\nWend\n\nEnd Sub\n</code></pre>\n\n<p>Results in the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KAvAh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KAvAh.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 130, "user_id": 5856153, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ea38303c73d487e4ecd63373176b7ba1?s=128&d=identicon&r=PG&f=1", "display_name": "flohdieter", "link": "https://stackoverflow.com/users/5856153/flohdieter"}, "is_accepted": false, "score": 0, "last_activity_date": 1457519990, "creation_date": 1457519990, "answer_id": 35889219, "question_id": 35888625, "link": "https://stackoverflow.com/questions/35888625/separate-text-in-excel-cell-based-on-formatting/35889219#35889219", "title": "Separate text in excel cell based on formatting", "body": "<p>Is it possible to seperate the blue text from the other with as sample a semicolon? Because then you could split the string which include the value of the cell: <code>StrArray = Split(CellXY.Value, \";\")</code> strArray is a string array which get the two elements \"Arnald, Biarb\" and \"dfgh.sukusi@drems.com\". Then you just have to say which cell should get which value. As sample: <code>CellXY.Value = strArray(0)</code></p>\n"}, {"tags": [], "owner": {"reputation": 2419, "user_id": 6035522, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IRcpJnt8LgQ/AAAAAAAAAAI/AAAAAAAAACE/fKzGPuhZUEE/photo.jpg?sz=128", "display_name": "White Feather", "link": "https://stackoverflow.com/users/6035522/white-feather"}, "is_accepted": false, "score": 1, "last_activity_date": 1457529307, "last_edit_date": 1457529307, "creation_date": 1457526062, "answer_id": 35891457, "question_id": 35888625, "link": "https://stackoverflow.com/questions/35888625/separate-text-in-excel-cell-based-on-formatting/35891457#35891457", "title": "Separate text in excel cell based on formatting", "body": "<ol>\n<li><p>Press Alt + F11 to open the Microsoft Visual Basic for Applications window</p></li>\n<li><p>Past the following code:</p>\n\n<pre><code>Function GetBoldString(workCell As Range)  \nstrLen = Len(workCell)  \nGetBoldString = \"\"  \nFor i = 1 To strLen  \n   If workCell.Characters(i, 1).Font.Bold Then  \n       GetBoldString = GetBoldString &amp; workCell.Characters(i, 1).Text  \n   End If  \nNext i  \nEnd Function  \n\nFunction GetNoBoldString(workCell As Range)  \nstrLen = Len(workCell)  \nGetNoBoldString = \"\"  \nFor i = 1 To strLen  \n   If workCell.Characters(i, 1).Font.Bold = False Then  \n      GetNoBoldString = GetNoBoldString &amp; workCell.Characters(i, 1).Text  \nEnd If  \nNext i  \nEnd Function  \n</code></pre></li>\n<li><p>Return to the spreadsheet.<br>\nIn the cell where you want the bold part paste:</p>\n\n<p>= GetBoldString(A1)</p></li>\n<li><p>In the cell where you want the no bold part paste:</p>\n\n<p>= GetNoBoldString(A1)</p></li>\n</ol>\n\n<p>Replace A1 with the reference to cell you want to split.</p>\n\n<p>Working on the properties of workCell.Characters(i, 1) you can split by other format attributes, like color.</p>\n\n<p>Here are two VBA functions to separate the string part of any color, different from black, from the black part.</p>\n\n<pre><code>Function GetColorString(workCell As Range)\nstrLen = Len(workCell)\nGetColorString = \"\"\nFor i = 1 To strLen\n    If workCell.Characters(i, 1).Font.Color &lt;&gt; vbBlack Then\n        GetColorString = GetColorString &amp; workCell.Characters(i, 1).Text\n    End If\nNext i\nEnd Function\n\nFunction GetBlackString(workCell As Range)\nstrLen = Len(workCell)\nGetBlackString = \"\"\nFor i = 1 To strLen\n    If workCell.Characters(i, 1).Font.Color = vbBlack Then\n        GetBlackString = GetBlackString &amp; workCell.Characters(i, 1).Text\nEnd If\nNext i\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/0XrgN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0XrgN.png\" alt=\"Here is the result using this VBA functions:\"></a></p>\n\n<p>Regards</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14629315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6990c1e84ba554a30b57b7a57f9a6f1?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelWorker", "link": "https://stackoverflow.com/users/14629315/excelworker"}, "is_accepted": false, "score": 0, "last_activity_date": 1605238294, "last_edit_date": 1605238294, "creation_date": 1605225993, "answer_id": 64813658, "question_id": 35888625, "link": "https://stackoverflow.com/questions/35888625/separate-text-in-excel-cell-based-on-formatting/64813658#64813658", "title": "Separate text in excel cell based on formatting", "body": "<p>Thanks to @TheGuyThatDoesn'tKnowMuch</p>\n<p>I built this based on your vba and it can now separate different colors and run the whole column. Hope it helps everyone.</p>\n<pre><code>Sub SplitCellBasedOnColor()\n\nDim Cel As Range\nFor Each Cel In Application.Selection.Cells\n\ni = 1\nGroup = 1\nwholelength = Len(Cel.Value)\nGroupOrder = 1\nCellOrder = 1\n\n'''loop to separate each group of text within same color\nWhile i &lt; wholelength\nIf Cel.Characters(Start:=i, Length:=1).Font.Color = _\n    Cel.Characters(Start:=i + 1, Length:=1).Font.Color Then\nGroup = Group + 1\ni = i + 1\nElse\nCel.Offset(0, CellOrder).NumberFormat = &quot;@&quot;\nCel.Offset(0, CellOrder).Value = Mid(Cel, GroupOrder, Group)\nCel.Offset(0, CellOrder).Font.Color = Cel.Characters(Start:=i, Length:=1).Font.Color\nGroupOrder = GroupOrder + Group\nGroup = 1\ni = i + 1\nCellOrder = CellOrder + 1\nEnd If\nWend\n\n\n'''when i = wholelength then run below\nCel.Offset(0, CellOrder).NumberFormat = &quot;@&quot;\nCel.Offset(0, CellOrder).Value = Mid(Cel, GroupOrder, Group)\nCel.Offset(0, CellOrder).Font.Color = Cel.Characters(Start:=i, Length:=1).Font.Color\n\n'''cell in next row\nNext Cel\n\nEnd Sub\n</code></pre>\n<p>Result as follows:</p>\n<p><a href=\"https://i.stack.imgur.com/YcgA6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YcgA6.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 1315, "user_id": 4655707, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/8169a61d2fad36252262a59bccb38976?s=128&d=identicon&r=PG&f=1", "display_name": "BountyHunter", "link": "https://stackoverflow.com/users/4655707/bountyhunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1858, "favorite_count": 0, "accepted_answer_id": 35889171, "answer_count": 4, "score": 0, "last_activity_date": 1605238294, "creation_date": 1457518390, "last_edit_date": 1531161705, "question_id": 35888625, "link": "https://stackoverflow.com/questions/35888625/separate-text-in-excel-cell-based-on-formatting", "title": "Separate text in excel cell based on formatting", "body": "<p>I would like to split text in one cell to 2 cells based on the formatting of the content in the cell. In the image below: I would like to separate the text in blue from the email address. Could anyone suggest an excel formula or workaround to do this?</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Bwtf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Bwtf.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457518488, "post_id": 35888474, "comment_id": 59438516, "body": "What is <code>debug.print strTesto</code> immediately after <code>strTesto = PercorsoSalva &amp; ValCell</code>?"}, {"owner": {"reputation": 375, "user_id": 3101404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CcPD1.jpg?s=128&g=1", "display_name": "tumisma", "link": "https://stackoverflow.com/users/3101404/tumisma"}, "edited": false, "score": 3, "creation_date": 1457518848, "post_id": 35888474, "comment_id": 59438785, "body": "as @Jeeped said check the value of strTesto because maybe it is null when you&#39;re going to save it."}, {"owner": {"reputation": 5, "user_id": 3202508, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e2ace4d6ae438e1a9bd11ab702759632?s=128&d=identicon&r=PG&f=1", "display_name": "Metallic01", "link": "https://stackoverflow.com/users/3202508/metallic01"}, "reply_to_user": {"reputation": 375, "user_id": 3101404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CcPD1.jpg?s=128&g=1", "display_name": "tumisma", "link": "https://stackoverflow.com/users/3101404/tumisma"}, "edited": false, "score": 0, "creation_date": 1457519154, "post_id": 35888474, "comment_id": 59438991, "body": "@tumisma You have any advice to solve the problem?"}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 1, "creation_date": 1457519987, "post_id": 35888474, "comment_id": 59439511, "body": "He just gave you advice ;)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457523323, "post_id": 35889857, "comment_id": 59441820, "body": "Your latter approach is wrong. You are advocating a file extension of .XLSM for a file format of .XLSX. I&#39;ve found that a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff841185.aspx\" rel=\"nofollow noreferrer\">Workbook.SaveAs method</a> ius best with a filename without an extension and leaving that aspect to the FilFormat parameter."}, {"owner": {"reputation": 375, "user_id": 3101404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CcPD1.jpg?s=128&g=1", "display_name": "tumisma", "link": "https://stackoverflow.com/users/3101404/tumisma"}, "edited": false, "score": 0, "creation_date": 1457523664, "post_id": 35889857, "comment_id": 59442106, "body": "Ok, then delete the extension and try just with the file name. But I highly recommend you debug instead of changing the parameters"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457523796, "post_id": 35889857, "comment_id": 59442191, "body": "Even with that revision I do not think that &#39;not supplying&#39; a folder would be appropriate. You should know where your new workbook is going to end up."}, {"owner": {"reputation": 375, "user_id": 3101404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CcPD1.jpg?s=128&g=1", "display_name": "tumisma", "link": "https://stackoverflow.com/users/3101404/tumisma"}, "edited": false, "score": 0, "creation_date": 1457524622, "post_id": 35889857, "comment_id": 59442753, "body": "There&#39;s no need to supply a folder, it will be in the folder where your workbook is store"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457524956, "post_id": 35889857, "comment_id": 59442958, "body": "Again, you are wrong. It will go to whatever folder is currently holding the default folder property within that application instance of excel. It could be <code>thisworkbook.path</code> or it could be <code>Application.DefaultFilePath</code> or it could be the most recently opened folder from that application instance."}, {"owner": {"reputation": 375, "user_id": 3101404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CcPD1.jpg?s=128&g=1", "display_name": "tumisma", "link": "https://stackoverflow.com/users/3101404/tumisma"}, "edited": false, "score": 0, "creation_date": 1457525319, "post_id": 35889857, "comment_id": 59443203, "body": "Upss, you&#39;re right. Never happened to my before. I will delete that"}], "tags": [], "owner": {"reputation": 375, "user_id": 3101404, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CcPD1.jpg?s=128&g=1", "display_name": "tumisma", "link": "https://stackoverflow.com/users/3101404/tumisma"}, "is_accepted": false, "score": 0, "last_activity_date": 1457525327, "last_edit_date": 1457525327, "creation_date": 1457521685, "answer_id": 35889857, "question_id": 35888474, "link": "https://stackoverflow.com/questions/35888474/runtime-1004-method-saveas-of-object-workbook-failed/35889857#35889857", "title": "Runtime 1004: method saveas of object _workbook failed", "body": "<p>You should debug the value of <code>strTesto</code>. Check if it's not null and if it has the extension correct (<code>.xlsm</code>) </p>\n\n<blockquote>\n  <p>TIP: <a href=\"http://www.excel-easy.com/vba/examples/debugging.html\" rel=\"nofollow\">How to debug in\n  excel</a></p>\n</blockquote>\n"}], "owner": {"reputation": 5, "user_id": 3202508, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e2ace4d6ae438e1a9bd11ab702759632?s=128&d=identicon&r=PG&f=1", "display_name": "Metallic01", "link": "https://stackoverflow.com/users/3202508/metallic01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 638, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457525327, "creation_date": 1457518004, "last_edit_date": 1457520658, "question_id": 35888474, "link": "https://stackoverflow.com/questions/35888474/runtime-1004-method-saveas-of-object-workbook-failed", "title": "Runtime 1004: method saveas of object _workbook failed", "body": "<p>I have some problem with Excel macro...</p>\n\n<p>When I run this script I received </p>\n\n<blockquote>\n  <p>error runtime 1004: method save as of object _workbook failed</p>\n</blockquote>\n\n<p>One month ago this macro worked good.... Where is the problem?</p>\n\n<p>I did not do a program this script, I found it already used in the station of my old colleague, and so far has ever given no problem ....</p>\n\n<p>Thanks for help </p>\n\n<pre><code>Sub StampaVodafone()\n    Dim i, j As Integer\n    Dim Fogliotmp As Worksheet\n    Dim ContoVodafone As String\n    Dim FoglioElenco As Worksheet\n    Dim Percorsofile As String\n    Dim PercorsoSalva As String\n    Dim ValCell As Variant\n    Dim strTesto As String\n    strTesto = \"Vuoi procedere con la stampa ?\" &amp; vbCr &amp; \"SI - Per procedere con la stampa dei dettagli telefonici\" &amp; _\n             vbCr &amp; \"NO - Per andare alla procedura successiva\"\n    If MsgBox(strTesto, 68, \"Avvio StampaVodafone\") = vbYes Then\n        'Procedura di stampa documenti\n        i = 1\n        Do\n            Set Fogliotmp = ActiveWorkbook.Worksheets(i)\n            If UCase(Mid(Fogliotmp.Name, 1, 3)) = \"TEL\" Or UCase(Mid(Fogliotmp.Name, 1, 3)) = \"LA \" Then\n                'Trovo dove sta la fine pagina\n                j = 15\n                ValCell = Mid(CStr(Fogliotmp.Cells(j, 1).Value), 1, 12)\n                Do While (UCase(ValCell) &lt;&gt; \"TOTALE COSTI\")\n                    j = j + 1\n                    ValCell = Mid(CStr(Fogliotmp.Cells(j, 1).Value), 1, 12)\n                Loop\n\n                With Fogliotmp.PageSetup\n                    .LeftMargin = 0\n                    .RightMargin = 0\n                    .TopMargin = 0\n                    .BottomMargin = 0\n                    .PrintArea = \"$A$1:$P$\" &amp; CStr(j)\n                    .LeftHeader = \"\"\n                    .CenterHeader = \"\"\n                    .RightHeader = \"\"\n                    .LeftFooter = \"\"\n                    .CenterFooter = \"\"\n                    .RightFooter = \"\"\n                    .LeftMargin = Application.InchesToPoints(0)\n                    .RightMargin = Application.InchesToPoints(0)\n                    .TopMargin = Application.InchesToPoints(0)\n                    .BottomMargin = Application.InchesToPoints(0)\n                    .HeaderMargin = Application.InchesToPoints(0.511811023622047)\n                    .FooterMargin = Application.InchesToPoints(0.511811023622047)\n                    .PrintHeadings = False\n                    .PrintGridlines = False\n                    .PrintComments = xlPrintNoComments\n                    .PrintQuality = 600\n                    .CenterHorizontally = False\n                    .CenterVertically = False\n                    .Orientation = xlPortrait\n                    .Draft = False\n                    .PaperSize = xlPaperA4\n                    .FirstPageNumber = xlAutomatic\n                    .Order = xlDownThenOver\n                    .BlackAndWhite = False\n                    .Zoom = False\n                    .FitToPagesWide = 1\n                    .FitToPagesTall = 1\n                    .PrintErrors = xlPrintErrorsDisplayed\n                    .OddAndEvenPagesHeaderFooter = False\n                    .DifferentFirstPageHeaderFooter = False\n                    .ScaleWithDocHeaderFooter = True\n                    .AlignMarginsHeaderFooter = False\n                    .EvenPage.LeftHeader.Text = \"\"\n                    .EvenPage.CenterHeader.Text = \"\"\n                    .EvenPage.RightHeader.Text = \"\"\n                    .EvenPage.LeftFooter.Text = \"\"\n                    .EvenPage.CenterFooter.Text = \"\"\n                    .EvenPage.RightFooter.Text = \"\"\n                    .FirstPage.LeftHeader.Text = \"\"\n                    .FirstPage.CenterHeader.Text = \"\"\n                    .FirstPage.RightHeader.Text = \"\"\n                    .FirstPage.LeftFooter.Text = \"\"\n                    .FirstPage.CenterFooter.Text = \"\"\n                    .FirstPage.RightFooter.Text = \"\"\n                End With\n                Application.PrintCommunication = True\n                Fogliotmp.PrintOut\n            End If\n            i = i + 1\n            Set Fogliotmp = Nothing\n        Loop While (i &lt; ActiveWorkbook.Worksheets.Count + 1)\n        MsgBox \"Ho terminato di stampare\", vbExclamation, \"MACRO SONIA\"\n        'Fine procedura stampa\n    End If\n    '--\n    strTesto = \"Vuoi procedere con l'estrazione dei file XLSX da spedire agli utenti?\" &amp; vbCr &amp; _\n             \"SI - Inizia la generazione dei file XLSX\" &amp; vbCr &amp; _\n             \"NO - Termina la macro\"\n    If MsgBox(strTesto, 68, \"Genera XLS\") = vbYes Then\n        'Inizio estrazione\n        Percorsofile = \"H:\\Vodafone\\ElencoCellEstrazione.xlsx\"\n        PercorsoSalva = \"H:\\Vodafone\\Estratti\\\"\n        ContoVodafone = Application.ActiveWorkbook.Name\n        '--\n        Set FoglioElenco = Workbooks.Open(Percorsofile).Worksheets(1)\n        '--\n        i = 1\n        Do\n            Windows(ContoVodafone).Activate\n            Set Fogliotmp = ActiveWorkbook.Worksheets(i)\n            If UCase(Mid(Fogliotmp.Name, 1, 3)) = \"TEL\" Then\n                strTesto = Trim(Mid(Fogliotmp.Name, 4, Len(Fogliotmp.Name)))\n                'Cerco il nome della persona\n                j = 2\n                ValCell = Trim(CStr(FoglioElenco.Cells(j, 1).Value))\n                Do While (UCase(ValCell) &lt;&gt; UCase(strTesto) And UCase(ValCell) &lt;&gt; \"END LIST\")\n                    j = j + 1\n                    ValCell = Trim(CStr(FoglioElenco.Cells(j, 1).Value))\n                Loop\n                If UCase(ValCell) &lt;&gt; \"END LIST\" Then\n                    'Ho il nome dell'intestatario del telefono\n                    ValCell = Trim(CStr(FoglioElenco.Cells(j, 2).Value))\n                    strTesto = PercorsoSalva &amp; ValCell\n                    'Salvo il documento\n                     Windows(ContoVodafone).Activate\n                     Sheets(Fogliotmp.Name).Select\n                     Sheets(Fogliotmp.Name).Copy\n                     ActiveWorkbook.SaveAs Filename:=strTesto, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n                     ActiveWindow.Close\n                     Windows(ContoVodafone).Activate\n                End If\n            End If\n            '--\n            i = i + 1\n            Set Fogliotmp = Nothing\n            Windows(ContoVodafone).Activate\n        Loop While (i &lt; ActiveWorkbook.Worksheets.Count + 1)\n        MsgBox \"Ho terminato gli export XlsX\", vbExclamation, \"MACRO SONIA\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "range"], "comments": [{"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 1, "creation_date": 1457517946, "post_id": 35888336, "comment_id": 59438133, "body": "Haven&#39;t played with the code yet but just noticed quickly.  Is     &#39;wbfeedingtypes&#39; a workbook or worksheet variable?"}, {"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "reply_to_user": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457518080, "post_id": 35888336, "comment_id": 59438227, "body": "wbfeedingtypes is a workbook. to update you, I had mispelled this in my code, and I fixed it... However, there is still something else wrong with the statement as it gives me a different error : object doesnt support this property or method &quot;error 438&quot;"}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457518153, "post_id": 35888336, "comment_id": 59438271, "body": "I don&#39;t use arrays often in excel but I don&#39;t think you can just dump an entire range into one.  I&#39;ll try something and get back to you"}, {"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "reply_to_user": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457518216, "post_id": 35888336, "comment_id": 59438322, "body": "I also tried the code without <code>.Value</code> so it reads <code>feedingtypes() = wbfeedingtypes.Range(&quot;A2:A&quot; &amp; lrowfeedingtypes)</code>"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457518244, "post_id": 35888336, "comment_id": 59438339, "body": "You need a worksheet between the workbook and range, a workbook doesn&#39;t contain ranges. Btw, if you want to respond to someone in the comments, you can reply to them by using @ + their username."}, {"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "reply_to_user": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457518424, "post_id": 35888336, "comment_id": 59438481, "body": "@eirikdaude the workbook has only one worksheet... can you please show me how I can refer to it?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457518605, "post_id": 35888336, "comment_id": 59438609, "body": "I think Ralph edited it into his answer, but to answer it here as well, it would be something like <code>wbfeedingtypes.Worksheets(&quot;Sheet1&quot;).Range(&quot;A2:A&quot; &amp; lrowfeedingtypes)</code>, if you haven&#39;t edited the worksheets name, and your language is English."}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457519228, "post_id": 35888336, "comment_id": 59439035, "body": "Preferably refer to worksheets by number instead of name.  If someone renames the worksheet it will break your code."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457518827, "post_id": 35888480, "comment_id": 59438770, "body": "thanks,now with this statement. error 13: runtype mismatch."}, {"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457519038, "post_id": 35888480, "comment_id": 59438913, "body": "ok this works, I had <code>Dim feedingtypes() As String</code>, changed to the <code>Variant</code> and it works."}, {"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457519380, "post_id": 35888480, "comment_id": 59439122, "body": "This code works if I define the dimension as Variant, but not String But I would like to define the dimension of each value as a string, why can&#39;t I do that?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "reply_to_user": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457519852, "post_id": 35888480, "comment_id": 59439439, "body": "If you want to use <code>string</code> then you have to assign each array item one by one as shown in the solution provided by @iShaymus. If you want to assign them all at once you have to use the type <code>variant</code>. I am aware that variant variables are not as fast in their performance as strings would be. But one of Excel&#39;s biggest speed constraint is reading from a sheet and (even more so) writing back to a sheet (later on in your code I&#39;d assume)."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": true, "score": -1, "last_activity_date": 1457519088, "last_edit_date": 1457519088, "creation_date": 1457518011, "answer_id": 35888480, "question_id": 35888336, "link": "https://stackoverflow.com/questions/35888336/error-424-object-required-error/35888480#35888480", "title": "error 424 object required error", "body": "<p>I believe this is what you're looking for:</p>\n\n<pre><code>Dim feedingtypes() As Variant\nfeedingtypes = wbfeedingtypes.Sheets(1).Range(\"A2:A\" &amp; lrowfeedingtypes)\n</code></pre>\n\n<p>Note, that there are not brackets in the second line of code after the variable name.\nBased on your comments it seems there is only one worksheet. Hence, you can also refer to the sheet by number. I changed the answer accordingly.</p>\n"}, {"comments": [{"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457519526, "post_id": 35888855, "comment_id": 59439213, "body": "I think that this would definitely work, but I would really like to work around a smaller statement, because the overall code for which I am using this is already very big."}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "reply_to_user": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457519949, "post_id": 35888855, "comment_id": 59439486, "body": "The reason for this code other than the one liner is that it allows you to control which data to pull out of a range e.g. in my example ignoring blanks.  This many not be required for your purpose but could save you time down the road if you decide to ignore blanks, numeric etc."}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "reply_to_user": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457520025, "post_id": 35888855, "comment_id": 59439537, "body": "Also you can put it in a module and then just call it. <code>Call RangeToArray(myWorksheet, myRange)</code>"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457520494, "post_id": 35888855, "comment_id": 59439857, "body": "If you have any speed concerns then you might want to read this post: <a href=\"https://fastexcel.wordpress.com/2011/05/25/writing-efficient-vba-udfs-part-1/\" rel=\"nofollow noreferrer\">fastexcel.wordpress.com/2011/05/25/&hellip;</a> The author has (seemingly) spent a significant amount of time to speed-test and refine his code."}], "tags": [], "owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "is_accepted": false, "score": 1, "last_activity_date": 1457528176, "last_edit_date": 1457528176, "creation_date": 1457519038, "answer_id": 35888855, "question_id": 35888336, "link": "https://stackoverflow.com/questions/35888336/error-424-object-required-error/35888855#35888855", "title": "error 424 object required error", "body": "<p>I have run and tested the following</p>\n\n<pre><code>Sub RangeToArray()\n  Dim i As Long\n  Dim ws As Worksheet\n  Dim myRange As Range, cell As Range\n  Dim feedingtypes() As String\n\n  Set ws = ThisWorkbook.Worksheets(1)\n  Set myRange = ws.Range(\"A1:A20\")\n  i = 1\n\n  For Each cell In myRange\n    'Only add non blanks\n    If cell.Value &lt;&gt; \"\" Then\n      'Resize the array each time another cell is added\n      ReDim Preserve feedingtypes(i)\n      feedingtypes(i) = cell.Value\n      i = i + 1\n    End If\n  Next cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 903, "favorite_count": 0, "accepted_answer_id": 35888480, "answer_count": 2, "score": 1, "last_activity_date": 1457528176, "creation_date": 1457517617, "question_id": 35888336, "link": "https://stackoverflow.com/questions/35888336/error-424-object-required-error", "title": "error 424 object required error", "body": "<p>I'm trying to input the values in a range of cells into an array.</p>\n\n<p>the following code give me an error 424 object required message. Please help</p>\n\n<p><code>feedingtypes() = wbfeedingtypes.Range(\"A2:A\" &amp; lrowfeedingtypes).Value</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457517424, "post_id": 35887974, "comment_id": 59437745, "body": "Exactly what error message do you get? Could it be a missing reference of this sort? <a href=\"https://social.microsoft.com/Forums/getfile/48449/\" rel=\"nofollow noreferrer\">social.microsoft.com/Forums/getfile/48449</a>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1457518309, "post_id": 35887974, "comment_id": 59438383, "body": "Do  you have any userforms in the workbook?"}], "owner": {"reputation": 4630, "user_id": 347904, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b00b80efa99573461285c13d30b0663b?s=128&d=identicon&r=PG", "display_name": "Jakob", "link": "https://stackoverflow.com/users/347904/jakob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457520246, "creation_date": 1457516699, "last_edit_date": 1531164843, "question_id": 35887974, "link": "https://stackoverflow.com/questions/35887974/cant-find-object-using-reference-in-workbook", "title": "cant find object using reference in workbook", "body": "<p>I'm trying to remove an old reference to Microsoft Office Web Components 11 (32 bit) in a workbook I'm updating, so it can run on office 365 (64 bit). I've removed all the objects I could find in sheets, and I've edited the code, so it now works, but I still get an error message saying:</p>\n\n<pre><code>Can't remove control or reference; in use\n</code></pre>\n\n<p>How do I find out where it is being used, so I can remove the reference and change it?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457519021, "post_id": 35887796, "comment_id": 59438897, "body": "What is in C9 on the Menu-sheet? The customer name?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5789142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c831b95193906c20f18cf36e019a6e?s=128&d=identicon&r=PG&f=1", "display_name": "F.A.H.", "link": "https://stackoverflow.com/users/5789142/f-a-h"}, "edited": false, "score": 0, "creation_date": 1457516797, "post_id": 35887900, "comment_id": 59437289, "body": "Wow, feel like an idiot now! Thanks.  Though I&#39;m now getting a &#39;Object Required&#39; error on  the Set RowCount line; any ideas?"}, {"owner": {"reputation": 37, "user_id": 5789142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c831b95193906c20f18cf36e019a6e?s=128&d=identicon&r=PG&f=1", "display_name": "F.A.H.", "link": "https://stackoverflow.com/users/5789142/f-a-h"}, "edited": false, "score": 0, "creation_date": 1457517577, "post_id": 35887900, "comment_id": 59437857, "body": "It&#39;s all working fine except that it returns one less of the rows than exist in the data table. If there are five it should return, only four appear in the results tab.  Any ideas?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 37, "user_id": 5789142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c831b95193906c20f18cf36e019a6e?s=128&d=identicon&r=PG&f=1", "display_name": "F.A.H.", "link": "https://stackoverflow.com/users/5789142/f-a-h"}, "edited": false, "score": 0, "creation_date": 1457517811, "post_id": 35887900, "comment_id": 59438039, "body": "@F.A.H. Could you link to some sample data, post it to google sheets or something? It&#39;d be much simpler to troubleshoot your code with some sample data to work with."}, {"owner": {"reputation": 37, "user_id": 5789142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c831b95193906c20f18cf36e019a6e?s=128&d=identicon&r=PG&f=1", "display_name": "F.A.H.", "link": "https://stackoverflow.com/users/5789142/f-a-h"}, "edited": false, "score": 0, "creation_date": 1457518356, "post_id": 35887900, "comment_id": 59438416, "body": "Sure, <a href=\"https://docs.google.com/spreadsheets/d/19j1HFGf9Ay2YU-etA6pz2sV-hgMODQBCAG17eh_Lp50/edit?usp=sharing\" rel=\"nofollow noreferrer\">here</a> is the format of it at the moment; the final thing will have a few hundred rows and ~3 more columns of actual data, but that will be easy to alter.  Thanks again."}, {"owner": {"reputation": 37, "user_id": 5789142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c831b95193906c20f18cf36e019a6e?s=128&d=identicon&r=PG&f=1", "display_name": "F.A.H.", "link": "https://stackoverflow.com/users/5789142/f-a-h"}, "edited": false, "score": 0, "creation_date": 1457519332, "post_id": 35887900, "comment_id": 59439091, "body": "Ah fixed it; the issue was starting the If RowCount &gt; 1 statements at 1, rather than zero. Which makes a lot of sense; another silly error.  Thanks, for your help!"}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": true, "score": 1, "last_activity_date": 1457520873, "last_edit_date": 1457520873, "creation_date": 1457516450, "answer_id": 35887900, "question_id": 35887796, "link": "https://stackoverflow.com/questions/35887796/vba-calling-multiple-rows-from-a-larger-table/35887900#35887900", "title": "VBA: Calling multiple rows from a larger table", "body": "<p>Looks like you have got the order of <code>MATCH</code>'s arguments mixed up, the first argument should be the value you're looking for while the second should be the range you search over. You have them the other way round.</p>\n\n<p>In response to your request, I've edited your code a bit to make it more compact:</p>\n\n<pre><code>Sub CheckPrevious()\n    Dim RowCount As Long\n    Dim FirstRow As Long\n    Dim RowOffset As Long\n    Dim ColumnOffset As Long\n    Dim Rng As Range\n    Dim MatchRng As Range\n    Dim MatchItem As String\n\n    Set Rng = ThisWorkbook.Worksheets(\"Database\").Range(\"A1:P200\")\n    Set MatchRng = ThisWorkbook.Worksheets(\"Database\").Range(\"A1:A200\")\n    MatchItem = ThisWorkbook.Worksheets(\"Menu\").Range(\"C9\")\n    RowCount = Application.WorksheetFunction.CountIf(Worksheets(\"Database\").Range(\"A:A\"), MatchItem)\n    FirstRow = Application.WorksheetFunction.Match(MatchItem, MatchRng, 0)\n\n    ThisWorkbook.Worksheets(\"Pricing\").Range(\"A2:E6\").ClearContents\n\n    With ThisWorkbook.Worksheets(\"Database\").AutoFilter.Sort\n        .SortFields.Clear\n        .SortFields.Add Key:=Range(\"A1:A11\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n\n    For RowOffset = 0 To RowCount - 1\n        For ColumnOffset = 0 To 4\n            ThisWorkbook.Worksheets(\"Pricing\").Range(\"A2\").Offset(RowOffset, ColumnOffset).Value2 _\n                    = ThisWorkbook.Worksheets(\"Database\").Range(\"A\" &amp; FirstRow).Offset(RowOffset, ColumnOffset).Value2\n        Next ColumnOffset\n    Next RowOffset\nEnd Sub\n</code></pre>\n\n<p>I won't go into all the details on how it works now, but I'll say that the main improvement over what you had written is the outer for-loop which completely eliminates the if-statements you had in your code.</p>\n\n<p>I was a bit uncertain about whether or not the inner for-loop was necessary, as it decreases readability quite a bit, but decided on leaving it in, if for no other reason than to demonstrate further how to use OFFSET to refer to cells.</p>\n\n<p>You should also notice that if C9 in the Menu-sheet is left blank, there is a good chance your code will crash - so maybe add in a check for that.</p>\n\n<p>In conclusion I won't say that this is exactly how I'd have solved your task if I was the one to create a solution in the first place, but hopefully my editing of your code will give you some insight into a somewhat different approach to the problem.</p>\n\n<p>This was what the three sheets I copied into my workbook looked like after I attempted running the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/X2lCD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X2lCD.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/l9h2o.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/l9h2o.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/814I0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/814I0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 37, "user_id": 5789142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6c831b95193906c20f18cf36e019a6e?s=128&d=identicon&r=PG&f=1", "display_name": "F.A.H.", "link": "https://stackoverflow.com/users/5789142/f-a-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 35887900, "answer_count": 1, "score": 1, "last_activity_date": 1457520873, "creation_date": 1457516170, "question_id": 35887796, "link": "https://stackoverflow.com/questions/35887796/vba-calling-multiple-rows-from-a-larger-table", "title": "VBA: Calling multiple rows from a larger table", "body": "<p>I want to insert rows from an excel table into a 'results' sheet if the values in column A of the table match a value specified by the user on the results sheet.</p>\n\n<p>Firstly I would like to ask if there is a more efficient way to do this than what I have embarked on, and if not I would appreciate some help with my attempt.</p>\n\n<p>I was planning on the following </p>\n\n<ol>\n<li>sorting the data table by column A so that if new items have been added they appear in alphabetical order</li>\n<li>Using WorksheetFunction.CountIf to determine the number of rows matching the criteria &amp; setting this as a variable</li>\n<li>Using WorksheetFunction.Match to find the first matching Row &amp; setting this value as a variable</li>\n<li><p>using established variables to copy the relevant values over to the results tab</p>\n\n<pre><code>Sub CheckPrevious()\n    Dim RowCount As Integer\n    Dim FirstRow As Integer\n    Dim Rng As Range\n    Dim MatchRng As Range\n    Dim MatchItem As Variant\n\n    Rng = Sheets(\"Database\").Range(\"A1:P200\")\n    MatchRng = Sheets(\"Database\").Range(\"A1:A200\")\n    MatchItem = Sheets(\"Menu\").Range(\"C9\")\n    RowCount = WorksheetFunction.CountIf(Worksheets(\"Database\").Range(\"A:A\"), _\n    Worksheets(\"Menu\").Range(\"C9\").Value)\n    FirstRow = WorksheetFunction.Match(MatchRng, MatchItem, 0)\n\nSheets(\"Pricing\").Range(\"A2:E6\").ClearContents\n\nWorksheets(\"Database\").AutoFilter.Sort.SortFields.Clear\nWorksheets(\"Database\").AutoFilter.Sort.SortFields.Add Key:= _\n    Range(\"A1:A7\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n    xlSortNormal\nWith ActiveWorkbook.Worksheets(\"Database\").AutoFilter.Sort\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n\nIf RowCount &gt; 1 Then\n    Sheets(\"Pricing\").Range(\"A2\").Value = Worksheets(\"Database\").Range(\"A\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"B2\").Value = Worksheets(\"Database\").Range(\"B\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"C2\").Value = Worksheets(\"Database\").Range(\"C\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"D2\").Value = Worksheets(\"Database\").Range(\"D\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"E2\").Value = Worksheets(\"Database\").Range(\"E\" &amp; FirstRow).Value\n    FirstRow = FirstRow + 1\nEnd If\n\nIf RowCount &gt; 2 Then\n    Sheets(\"Pricing\").Range(\"A3\").Value = Worksheets(\"Database\").Range(\"A\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"B3\").Value = Worksheets(\"Database\").Range(\"B\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"C3\").Value = Worksheets(\"Database\").Range(\"C\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"D3\").Value = Worksheets(\"Database\").Range(\"D\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"E3\").Value = Worksheets(\"Database\").Range(\"E\" &amp; FirstRow).Value\n    FirstRow = FirstRow + 1\nEnd If\n\nIf RowCount &gt; 3 Then\n    Sheets(\"Pricing\").Range(\"A4\").Value = Worksheets(\"Database\").Range(\"A\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"B4\").Value = Worksheets(\"Database\").Range(\"B\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"C4\").Value = Worksheets(\"Database\").Range(\"C\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"D4\").Value = Worksheets(\"Database\").Range(\"D\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"E4\").Value = Worksheets(\"Database\").Range(\"E\" &amp; FirstRow).Value\n    FirstRow = FirstRow + 1\nEnd If\n\nIf RowCount &gt; 4 Then\n    Sheets(\"Pricing\").Range(\"A5\").Value = Worksheets(\"Database\").Range(\"A\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"B5\").Value = Worksheets(\"Database\").Range(\"B\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"C5\").Value = Worksheets(\"Database\").Range(\"C\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"D5\").Value = Worksheets(\"Database\").Range(\"D\" &amp; FirstRow).Value\n    Sheets(\"Pricing\").Range(\"E5\").Value = Worksheets(\"Database\").Range(\"E\" &amp; FirstRow).Value\n    FirstRow = FirstRow + 1\nEnd If\n\n\nEnd Sub\n</code></pre></li>\n</ol>\n\n<p>Am currently getting a type mismatch error on my WorksheetFunction.Match </p>\n\n<p>Thanks in advance for any help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1457515854, "post_id": 35887363, "comment_id": 59436634, "body": "Which version of Excel do you use?"}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 1, "creation_date": 1457515969, "post_id": 35887363, "comment_id": 59436707, "body": "Maybe you can propose your client to use Excel built-in <i>Condition Formatting</i>? There are 5-grad rating sets, but they do not use stars."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1457515988, "post_id": 35887363, "comment_id": 59436721, "body": "There are conditional formats that do so dependant on version tho."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457518966, "post_id": 35887363, "comment_id": 59438862, "body": "There are stars in Excel when you look on the <code>Insert</code> tab for <code>Shapes</code>. Yet, it would be a major task programming task to generate for each value 5 stars, fill them will yellow or not, size them correctly, align them correctly, and finally put them in a nice fitting spot on the sheet (next to the number value). Sounds a bit steep for a first VBA programming task. But if you are up for it you can create some stars and record the macros (just to get started)."}, {"owner": {"reputation": 13, "user_id": 4273473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5154ef6929b71791899389e15f4e7ee6?s=128&d=identicon&r=PG&f=1", "display_name": "bnktop", "link": "https://stackoverflow.com/users/4273473/bnktop"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1457519478, "post_id": 35887363, "comment_id": 59439182, "body": "@J.Chomel   I use the 2013 version. The client used before  built-in condition formatting, but they asked me if is it possible to use stars to make it more user friendly and more modern.  And they particular want to be the same as in Amazon or ebay...maybe its possible to combine with another technology like php/js?"}, {"owner": {"reputation": 13, "user_id": 4273473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5154ef6929b71791899389e15f4e7ee6?s=128&d=identicon&r=PG&f=1", "display_name": "bnktop", "link": "https://stackoverflow.com/users/4273473/bnktop"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1457520233, "post_id": 35887363, "comment_id": 59439655, "body": "@Ralph yeah, it seems to be a hard one, and for me personal VBA is looking so unfriendly.. How about to embed in that worksheet some JS scripts to realize that? is it possible?"}], "answers": [{"comments": [{"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1457530228, "post_id": 35890176, "comment_id": 59446718, "body": "There&#39;s also the question of determining how many stars to render for any given item. The code you propose deals with the rendering itself, and rendering an arbitrary number can be done with loops, but how will the program know how many stars to create for the table item it is working on?"}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1457522508, "creation_date": 1457522508, "answer_id": 35890176, "question_id": 35887363, "link": "https://stackoverflow.com/questions/35887363/how-to-create-a-stars-review-system-in-excel-for-a-table/35890176#35890176", "title": "How to create a stars review system in Excel for a table?", "body": "<p>Based on your last comment I would like to merely sketch the basic concept of doing such rating manually. Since I couldn't fit it in a comment box I'll put it here as a conceptual draft of what it might look like (this is not an attempt to be a solution):</p>\n\n<p>(1) Getting a star on a sheet is as simple as that</p>\n\n<pre><code>Sheet1.Shapes.AddShape Type:=msoShape5pointStar, _\n    Left:=100, Top:=100, Width:=7.2, Height:=7.2\n</code></pre>\n\n<p>(2) Getting four more stars next to it should be simple enough by adding the width of prior star(s) and some extra space to the <code>Left</code>.</p>\n\n<p>(3) Color your star(s) yellow or white with presets (Office 2010+)</p>\n\n<pre><code>.ShapeStyle = msoShapeStylePreset12\n</code></pre>\n\n<p>(4) In order to locate the stars on the sheet next to the cell containing the value which should be rated you can use the following methods assuming that the value is in cell A1:</p>\n\n<pre><code>.Left = Sheets(1).Range(\"A1\").Left + Sheets(1).Range(\"A1\").Width\n</code></pre>\n\n<p>Of course, there is a bit more to it than the above. You will have to determine the range of cells for which you want to create stars. Also, if someone adds a column or changes the width of a column then all stars might get changed and will have to be drawn again. Also, you'll have to make sure that the column B is wide enough to hold all the stars. But that's the basic concept (as I would attempt to do it).</p>\n"}], "owner": {"reputation": 13, "user_id": 4273473, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5154ef6929b71791899389e15f4e7ee6?s=128&d=identicon&r=PG&f=1", "display_name": "bnktop", "link": "https://stackoverflow.com/users/4273473/bnktop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 483, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1457522508, "creation_date": 1457515009, "last_edit_date": 1457515286, "question_id": 35887363, "link": "https://stackoverflow.com/questions/35887363/how-to-create-a-stars-review-system-in-excel-for-a-table", "title": "How to create a stars review system in Excel for a table?", "body": "<p>I am new in VBA, and I got a task to find a way to implement the 5 stars review like in Amazon/Ebay with graphical stars itself for an excel table. Is it possible that? or even to combine with other technologies.</p>\n\n<p>All I need are some hits, how to do that, and where to start.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 1, "creation_date": 1457520545, "post_id": 35887224, "comment_id": 59439883, "body": "Completely unrelated to your question.  A big piece of advice I can give you as a self taught VBA scripter is reduce your tab spacing to 2.  It will make things so much easier to read when you go back and look at code you wrote 2+ years ago.  Also comments, you can never have enough comments.  This will stop the you from now wanting to build a time machine to punch the you from 2 years ago in the face."}, {"owner": {"reputation": 390, "user_id": 4889516, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JExrI.jpg?s=128&g=1", "display_name": "iShaymus", "link": "https://stackoverflow.com/users/4889516/ishaymus"}, "edited": false, "score": 0, "creation_date": 1457520778, "post_id": 35887224, "comment_id": 59440046, "body": "Also <code>For Each Row In Range</code> it&#39;s probably not a good idea to use <code>Row</code>. If you wanted to get the row number of Row it wouldn&#39;t make for good readability if it would work at all. <code>myLong = Row.row &#39;insert boat here </code>"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457520471, "post_id": 35887507, "comment_id": 59439833, "body": "If there is a better way to do this then I would appreciate the help.  I have some data to the question.I cant understand how to reach the goal I want to get. I need to check row by row and see if the value red appears 1 of the 3 cells if it does add a count to red, if not nxt check amber if yes add a count to amber, other wise add count for green.  This needs to happen for each row within the range of mediums. - I hope that makes sense and you can understand what it is I am trying to achieve"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457521824, "post_id": 35887507, "comment_id": 59440742, "body": "@user3088476 You only want one count added to &quot;red&quot;, even if there are multiple &quot;reds&quot; in each row?"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457522268, "post_id": 35887507, "comment_id": 59441008, "body": "yes that is correct only one count to be added to red even if multiple occurrences in the row, if no occurrence then check for amber and only one count to be added the amber count even if multiple occurrence."}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457522321, "post_id": 35887507, "comment_id": 59441055, "body": "No counts added to amber if &quot;red&quot; is already found? @user3088476"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457522681, "post_id": 35887507, "comment_id": 59441291, "body": "yes that&#39;s right, if a red occurrence has been found then no counts to be added to amber or green just add count to red and move on to the next row in the range. if no red but an amber then only add the count to the amber and not the red or green.  Same applies for the green count, if no occurrences of red or amber only add to green count"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457527596, "post_id": 35887507, "comment_id": 59444815, "body": "Thanks for that, I have copied your code over, but it doesn&#39;t seem to do anything.  I compiles ok but when I run I get no results at all printed on the screen and no message box"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457528843, "post_id": 35887507, "comment_id": 59445724, "body": "That means it hasn&#39;t entered the enclosing if-statement, which again means that the first find hasn&#39;t found a range containing &quot;medium&quot; in column H. I&#39;d advice you to check if your range and worksheet references are correct.  @user3088476"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457530295, "post_id": 35887507, "comment_id": 59446762, "body": "there was a typo in it from when I copied it over I think, it now enters the if statement, does some counting, but I don&#39;t get the results I was expecting.  I don&#39;t a manual count and on my proper web page there is 47 Greens, 4 Ambers and 0 reds for the medium range.  but the results I am getting when running the code is Red 0 Amber 5 green 1"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457530512, "post_id": 35887507, "comment_id": 59446930, "body": "Check the spelling of &quot;Red Variance&quot; in the macro / on your sheet? It&#39;s hard to tell for certain without seeing your data. And doublecheck that all ranges refer to what you think they refer to. If none of the data is confidential, try posting the contents of it to a google-sheet, and I&#39;ll see if I can spot anything obvious. @user3088476"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457533436, "post_id": 35887507, "comment_id": 59449040, "body": "ive checked the spellings etc and I cant see any other typos and I think all the range are correct.  So not sure exactly why is it isn&#39;t working correctly.  unfortunately I cant post my data as the info is confidential. - thanks for all the help you have given so far,"}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457536082, "post_id": 35887507, "comment_id": 59451144, "body": "I have written a small if (countIf statement which I know works on a single cell : - &#39;=IF(COUNTIF(AS22:AU22,&quot;red Variance&quot;)&gt;0,&quot;red Variance&quot;,IF(COUNTIF(AS22:AU22,&quot;amber Variance&quot;)&gt;0,&quot;amber Variance&quot;,&quot;green&quot;))&#39; So I have tried putting this in the vb code using this infront : - &#39; Range(&quot;DO22:DO&quot; &amp; lastRow).formula &#39; but get a compile error, I would also need to change the cells in the if count as I wont always knot the start and end cell this will be found running the bit of code from earlier. the mediumStart and mediumEnd  Any ideas why this isn&#39;t working?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "reply_to_user": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457540141, "post_id": 35887507, "comment_id": 59454391, "body": "@user3088476 I&#39;m a bit preoccupied right now, but if you&#39;re not in too much of a hurry,  I&#39;ll try to have a look at it again tomorrow."}, {"owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "edited": false, "score": 0, "creation_date": 1457541160, "post_id": 35887507, "comment_id": 59455090, "body": "Thank would be a great help if you didn&#39;t mind doing that.  Im at a loss really as to why It wont work."}], "tags": [], "owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "is_accepted": false, "score": 0, "last_activity_date": 1457524680, "last_edit_date": 1457524680, "creation_date": 1457515392, "answer_id": 35887507, "question_id": 35887224, "link": "https://stackoverflow.com/questions/35887224/vba-beginner-searching-a-row-for-a-specific-value-then-count-it/35887507#35887507", "title": "VBA Beginner - searching a row for a specific value then count it", "body": "<p>A simpler way of counting the number of occurences of each of the variables you put into <code>DO22:DO24</code> would be to simply put a <code>COUNTIF</code>-function into them:</p>\n\n<pre><code>Dim sAddress As String\nSet sAddress = \"AS\" &amp; mediumStartRow &amp; \":AU\" &amp; mediumEndRow\n(...)\nRange(\"DO22\").Formula = \"=COUNTIF(\" &amp; sAddress &amp; \",\" &amp; redVar &amp; \")\"\nRange(\"DO23\").Formula = \"=COUNTIF(\" &amp; sAddress &amp; \",\" &amp; amberVar &amp; \")\"\nRange(\"DO24\").Formula = \"=COUNTIF(\" &amp; sAddress &amp; \",\" &amp; greenVar &amp; \")\"\n</code></pre>\n\n<p>If you want the cells to be numbers and not formulas, you can use worksheetfunctions inside of macros as well:</p>\n\n<pre><code>Dim r As Range\nDim redVar As String\n\nSet r = Range(\"AS\" &amp; mediumStartRow &amp; \":AU\" &amp; mediumEndRow)\nredVar = \"Red Variance\"\nredVarCount = Application.WorksheetFunction.CountIf(r, redVar)\n\netc.\n</code></pre>\n\n<p>If you want a review of your original code, which I definitely think could use some improvements, feel free to say so in the comments. As it is I don't feel like trying to track down your bug when I don't have your source data, and your code is a bit convoluted to read, unless you really want to know where you've gone wrong.</p>\n\n<p><strong>- edit -</strong>\nAfter you expanding about your problems a bit, it is clear that the above solution won't work. I hacked together the following macro, which isn't very elegant, but should get the job done. Please contact me if you have any questions.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub counts()\n  Dim redVarCount   As Long\n  Dim amberVarCount As Long\n  Dim greenVarCount As Long\n  Dim i             As Long\n  Dim mediumStart   As Range\n  Dim mediumEnd     As Range\n  Dim r             As Range\n  Dim redVar        As String\n  Dim amberVar      As String\n  Dim greenVar      As String\n  Dim amberFound    As Boolean\n  Dim greenFound    As Boolean\n\n\n  'Used to find the first and last occurrence of the type want to count colors for\n  Set mediumStart = Range(\"H:H\").Find(What:=\"Medium\", After:=Range(\"H20\"), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlNext, MatchCase:=False)\n  Set mediumEnd = Range(\"H:H\").Find(What:=\"Medium\", After:=Range(\"H20\"), LookIn:=xlValues, LookAt:=xlWhole, SearchDirection:=xlPrevious, MatchCase:=False)\n\n  If Not mediumStart Is Nothing Then\n    MsgBox \"First and Last Row for Medium Projects: \" &amp; mediumStart.Row &amp; \" &amp; \" &amp; mediumEnd.Row\n\n    redVar = \"Red Variance\" 'This is the value I am looking for in the row - Red Variance\n    amberVar = \"Amber Variance\" 'this is the value I am looking for in the row - Amber Variance\n    greenVar = \"Green Variance\" 'This is the value I am looking for in the row - Green Variance\n\n    redVarCount = 0\n    amberVarCount = 0\n    greenVarCount = 0\n    amberFound = False\n    greenFound = False\n\n    For Each r In Range(\"AS\" &amp; mediumStart.Row &amp; \":AS\" &amp; mediumEnd.Row)\n      For i = 0 To 2\n        Debug.Print r.Offset(0, i).Address\n        If r.Offset(0, i).Value2 = redVar Then\n          redVarCount = redVarCount + 1\n          Exit For\n        ElseIf r.Offset(0, i).Value2 = amberVar And Not amberFound Then\n          amberVarCount = amberVarCount + 1\n          amberFound = True\n        ElseIf r.Offset(0, i).Value2 = greenVar And Not amberFound And Not greenFound Then\n          greenVarCount = greenVarCount + 1\n          greenFound = True\n        End If\n      Next i\n    Next r\n\n    Range(\"DO22\").Value = redVarCount\n    Range(\"DO23\").Value = amberVarCount\n    Range(\"DO24\").Value = greenVarCount\n  End If\nEnd Sub\n</code></pre>\n\n<p><strong>Results</strong>\n<a href=\"https://i.stack.imgur.com/HuthJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HuthJ.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 145, "user_id": 3088476, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f42f1f2f5a87c5c55ebf2cae5c3c2a5a?s=128&d=identicon&r=PG&f=1", "display_name": "user3088476", "link": "https://stackoverflow.com/users/3088476/user3088476"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 390, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457524680, "creation_date": 1457514575, "last_edit_date": 1457519960, "question_id": 35887224, "link": "https://stackoverflow.com/questions/35887224/vba-beginner-searching-a-row-for-a-specific-value-then-count-it", "title": "VBA Beginner - searching a row for a specific value then count it", "body": "<p>I am relatively new to VBA and I am learning as I go, so my scripting probably isn't the best solution to the problem at hand.  I have a range of cells which I need to check a row of three columns for an occurrence of a string/value, if it appears at least once within the row of three columns then I need to add a count this, if not then I need to look for the next option which is another value, if that appears more than once count this occurrence and then finally check for the last option and add a count to that.  I want to then print the counts to a cell within the work sheet. </p>\n\n<p>Unfortunately I wont know what the first row and last row number I will be searching is so I have a bit of script which will tell me these and assign to an integer, I know this works.  What doesn't work is the second part where I am searching the rows and looking for the value and adding a count.  It does print to the worksheet but all I get it three 0's.</p>\n\n<p>I am not sure where in my code has gone wrong - compiles fine with no errors.</p>\n\n<p>This is the scripting I have: -</p>\n\n<pre><code>Public Sub counts()\n\n    Dim redVarCount As Integer\n    Dim amberVarCount As Integer\n    Dim greenVarCount As Integer\n\n    'Used to find the first and last occurrence of the type want to count colors for\n    mediumStartRow = Range(\"H:H\").Find(what:=\"Medium\", after:=Range(\"H21\")).Row\n    mediumEndRow = Range(\"H:H\").Find(what:=\"Medium\", after:=Range(\"H21\"), searchdirection:=xlPrevious).Row\n    MsgBox \"First and Last Row for Medium Projects: \" &amp; mediumStartRow &amp; mediumEndRow\n\n    redVar = \"Red Variance\" 'This is the value I am looking for in the row - Red Variance\n    amberVar = \"Amber Variance\" 'this is the value I am looking for in the row - Amber Variance\n    greenVar = \"Green Variance\" 'This is the value I am looking for in the row - Green Variance\n\n    redVarCount = 0\n    amberVarCount = 0\n    greenVarCount = 0\n\n    For Each Row In Range(\"AS\" &amp; mediumStartRow &amp; \":AU\" &amp; mediumEndRow)\n        If Row.Value2 = redVar &gt; 0 Then\n            redVarCount = redVarCount + 1\n            Else\n            If Row.Value2 = amberVar &gt; 0 Then\n                amberVarCount = amberVarCount + 1\n                Else\n                If Row.Value2 = greenVar &gt; 0 Then\n                    greenVarCount = greenVarCount + 1\n                End If\n            End If\n        End If\n    Next\n\n    Range(\"DO22\").Value = redVarCount\n    Range(\"DO23\").Value = amberVarCount\n    Range(\"DO24\").Value = greenVarCount\n\nEnd Sub\n</code></pre>\n\n<p>Can anyone tell me where I have gone wrong or a better way of doing this please</p>\n\n<p>Edit 1</p>\n\n<p>Here is an example of the data</p>\n\n<pre><code>Medium  Green   Red Amber       Counts for medium   \nmedium  Green   Green   Green       Green   1\nmedium  Amber   Green   Green       Amber   1\nlarge   Green   Amber   Amber       Red 1\nlarge   Red Green   Green           \nsmall   Amber   Amber   Amber           \nsmall   Green   Green   Green           \nsmall   Green   Green   Amber           \nsmall   Green   Amber   Green   \n</code></pre>\n\n<p>Once I can get it working for the mediums I will be doing it for the Large and Small.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1457512886, "post_id": 35886563, "comment_id": 59434879, "body": "You need to convert your Formula to R1C1 type and then paste the formula as is in your range E2 rather than the result. Alternatively u can use a loop"}, {"owner": {"reputation": 5, "user_id": 5882982, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-HDGYr0pR1LA/AAAAAAAAAAI/AAAAAAAAIXM/DMyEy9Q7Z1k/photo.jpg?sz=128", "display_name": "Epil epic", "link": "https://stackoverflow.com/users/5882982/epil-epic"}, "reply_to_user": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1457513048, "post_id": 35886563, "comment_id": 59434978, "body": "Thanks for the fast response @izzymo, I will look into those options."}], "answers": [{"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": true, "score": 0, "last_activity_date": 1457513208, "creation_date": 1457513208, "answer_id": 35886793, "question_id": 35886563, "link": "https://stackoverflow.com/questions/35886563/vba-drag-down-vlookup/35886793#35886793", "title": "VBA Drag down Vlookup", "body": "<p>You should use the Formula as an R1C1 reference and then u will be able to drag down</p>\n\n<pre><code>Sheets(\"Data\").Range(\"E2\").FormulaR1C1 = \"=VLookup('Data'!R[-1]C,'Blocked'!C[-2]:C[-1],2,0)\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5882982, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-HDGYr0pR1LA/AAAAAAAAAAI/AAAAAAAAIXM/DMyEy9Q7Z1k/photo.jpg?sz=128", "display_name": "Epil epic", "link": "https://stackoverflow.com/users/5882982/epil-epic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "accepted_answer_id": 35886793, "answer_count": 1, "score": 0, "last_activity_date": 1462525395, "creation_date": 1457512457, "last_edit_date": 1462525395, "question_id": 35886563, "link": "https://stackoverflow.com/questions/35886563/vba-drag-down-vlookup", "title": "VBA Drag down Vlookup", "body": "<p>All,</p>\n\n<p>I have a data sheet of around 1.000 values which need a matching amount (the amount of valueschanges every day) . These amounts can be found in another tab <code>\"Data\"</code>. </p>\n\n<p>so using a Vlookup code in VBA should help me. The code I'm using is:</p>\n\n<pre><code>Sheets(\"Data\").Range(\"E2\") = Application.WorksheetFunction.VLookup(Sheets(\"Data\").Range(\"D2\"), Sheets(\"Blocked\").Range(\"C:D\"), 2, False)\n</code></pre>\n\n<p>Result should appear in <code>column E</code> responding with the row of the <code>lookup_value</code> which can be found in <code>column D</code>.The table and column index don't change being <code>Sheets(\"Blocked\").Range(\"C:D\")</code>and <code>2</code></p>\n\n<p>This code gives me the result I wanted but as I tried to drag down the formula with this function:\n<code>Range(\"E2\").AutoFill Destination:=Range(\"E2:E440\")</code></p>\n\n<p>How can I drag down this formula without needing to create a seperate vlookup for each row?</p>\n"}, {"tags": ["sql-server", "vba", "excel", "tcp", "sql-server-2014"], "comments": [{"owner": {"reputation": 183, "user_id": 4993057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf3fc323f33dccd300166ea098b69de?s=128&d=identicon&r=PG&f=1", "display_name": "Jasqlg", "link": "https://stackoverflow.com/users/4993057/jasqlg"}, "edited": false, "score": 1, "creation_date": 1457513034, "post_id": 35886528, "comment_id": 59434970, "body": "Check two things first, Is the Server configured to allow remote connections. If it is a named instance and not listening to the port 1433, see whether SQL server browser service is enabled or not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1452705"}, "reply_to_user": {"reputation": 183, "user_id": 4993057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf3fc323f33dccd300166ea098b69de?s=128&d=identicon&r=PG&f=1", "display_name": "Jasqlg", "link": "https://stackoverflow.com/users/4993057/jasqlg"}, "edited": false, "score": 0, "creation_date": 1457517536, "post_id": 35886528, "comment_id": 59437820, "body": "@Jasqlg the browser service is enabled. Not sure what you mean with the named instance? I thought every instance is named? Or am I miss understanding things?"}, {"owner": {"reputation": 183, "user_id": 4993057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf3fc323f33dccd300166ea098b69de?s=128&d=identicon&r=PG&f=1", "display_name": "Jasqlg", "link": "https://stackoverflow.com/users/4993057/jasqlg"}, "edited": false, "score": 1, "creation_date": 1457518236, "post_id": 35886528, "comment_id": 59438334, "body": "There are two kinds of instances we can create.Default and named. Run this against your server. SELECT SERVERPROPERTY(&#39;InstanceName&#39;). If the result is null then Default, if not then Named. You can even check the service name. it would be MSSQLSERVER for default one and someother incase of named insatnace."}, {"owner": {"reputation": 183, "user_id": 4993057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf3fc323f33dccd300166ea098b69de?s=128&d=identicon&r=PG&f=1", "display_name": "Jasqlg", "link": "https://stackoverflow.com/users/4993057/jasqlg"}, "edited": false, "score": 1, "creation_date": 1457518497, "post_id": 35886528, "comment_id": 59438524, "body": "For named instances, add the instance name in connection string like &quot;Data Source=ServerName\\YourInstancename;&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1452705"}, "reply_to_user": {"reputation": 183, "user_id": 4993057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abf3fc323f33dccd300166ea098b69de?s=128&d=identicon&r=PG&f=1", "display_name": "Jasqlg", "link": "https://stackoverflow.com/users/4993057/jasqlg"}, "edited": false, "score": 1, "creation_date": 1457582050, "post_id": 35886528, "comment_id": 59474510, "body": "@Jasqlg, I found that I had needed to allow listen all in the TCP/IP. But your help was invaluable in coming to this conclusion. Thanks."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1452705"}, "is_accepted": true, "score": 1, "last_activity_date": 1457584643, "last_edit_date": 1457584643, "creation_date": 1457581882, "answer_id": 35907238, "question_id": 35886528, "link": "https://stackoverflow.com/questions/35886528/2014-sql-server-connection-to-different-pc-on-local-network-vba/35907238#35907238", "title": "2014 SQL Server Connection to different PC on local network. VBA", "body": "<p>For future reference to people who also get stuck.</p>\n\n<p>I found the answer was in Server Configuration Manager under SQL Server Network Configuration <code>TCP/IP</code> settings under properties on the Protocol tab. There is <code>Listen All</code> feature which I had set to \"No\", setting it to \"yes\" allowed the following connection strings to work.</p>\n\n<pre><code>sConnString = \"PROVIDER=SQLOLEDB;\" &amp; _\n              \"Data Source=190.190.1.100,1433;\" &amp; _\n              \"Initial Catalog=DBNameHere;\" &amp; _\n              \"User Id=sa;\" &amp; _\n              \"Password=yourPassword;\"\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>sConnString = \"PROVIDER=SQLOLEDB;\" &amp; _\n              \"Data Source=yourServerName;\" &amp; _\n              \"Initial Catalog=DBNameHere;\" &amp; _\n              \"User Id=sa;\" &amp; _\n              \"Password=yourPassword;\"\n</code></pre>\n\n<p>Both strings work and are tested on a local network.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1452705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 1, "accepted_answer_id": 35907238, "answer_count": 1, "score": 1, "last_activity_date": 1457584643, "creation_date": 1457512345, "question_id": 35886528, "link": "https://stackoverflow.com/questions/35886528/2014-sql-server-connection-to-different-pc-on-local-network-vba", "title": "2014 SQL Server Connection to different PC on local network. VBA", "body": "<p>I trying to connect to an instance of 2014 SQL Server on Windows Server 2012 R2 standard over a local network without any success.</p>\n\n<ol>\n<li>I have gone into Configuration manager and enabled TCP/IP.</li>\n<li>I have gone into advanced settings on the server firewall and added new inbound     rules for all the SQL Server used TCP ports, </li>\n</ol>\n\n<blockquote>\n  <p>135,1433,1434,2382,2383,4022</p>\n</blockquote>\n\n<ol start=\"3\">\n<li>I have enabled sa authentication and set a new password.</li>\n</ol>\n\n<p>My connection string looks like this.</p>\n\n<pre><code>sConnString = \"PROVIDER=SQLOLEDB;\" &amp; _\n              \"Data Source=ServerName;\" &amp; _\n              \"Initial Catalog=Staff_Manager;\" &amp; _\n              \"User Id=sa;\" &amp; _\n              \"Password=myPassword;\" &amp; _\n              \"INTEGRATED SECURITY=SSPI;\"\n</code></pre>\n\n<p>But , I get this error when trying to connect. </p>\n\n<blockquote>\n  <p>[DBNETLIB][ConnectionOpen (Connect()).]SQL Server does not exist or\n  access denied</p>\n</blockquote>\n\n<p>I checked the Databases name and password and that is correct.</p>\n\n<p>So I tried the Microsoft workaround found here, <a href=\"https://support.microsoft.com/en-us/kb/888228\" rel=\"nofollow\">Bug #: 471480 (SQL Server 8.0)</a></p>\n\n<p>And I came up with this connection string,</p>\n\n<pre><code>sConnString = \"PROVIDER=SQLOLEDB;\" &amp; _\n              \"Integrated Security=SSPI;\" &amp; _\n              \"Persist Security Info=False;\" &amp; _\n              \"User Id=sa;\" &amp; _\n              \"Data Source=tcp:192.192.1.111,1433;\"\n</code></pre>\n\n<p>But, I am still getting the same error. Anyone point me in the right direction as I have run out of solutions.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48375, "user_id": 188331, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UhYfd.jpg?s=128&g=1", "display_name": "Raptor", "link": "https://stackoverflow.com/users/188331/raptor"}, "edited": false, "score": 0, "creation_date": 1457511493, "post_id": 35886228, "comment_id": 59434128, "body": "Have you heard of for loop? <a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/loop.html</a>"}, {"owner": {"reputation": 2765, "user_id": 4646304, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cb7e0e8a97f18e0cc2ddfb28552ff6d5?s=128&d=identicon&r=PG&f=1", "display_name": "luke_t", "link": "https://stackoverflow.com/users/4646304/luke-t"}, "edited": false, "score": 0, "creation_date": 1457514202, "post_id": 35886228, "comment_id": 59435630, "body": "This is a question for <a href=\"http://codereview.stackexchange.com/\">Code Review</a>."}], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 2315230, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2ee66032c2c475fb9f04b75d4fdf3e6a?s=128&d=identicon&r=PG", "display_name": "Noldor130884", "link": "https://stackoverflow.com/users/2315230/noldor130884"}, "is_accepted": false, "score": -1, "last_activity_date": 1457512069, "creation_date": 1457512069, "answer_id": 35886433, "question_id": 35886228, "link": "https://stackoverflow.com/questions/35886228/how-could-i-make-this-code-shorter/35886433#35886433", "title": "How could I make this code shorter?", "body": "<p>With the use of a For cycle:</p>\n\n<pre><code> r = 11\n\nDo Until tgtWSheet.Cells(r, 2) = \"0\"\n    for i = 1 to 18\n        If tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + i, 2) Then\n            MsgBox \"Duplicate Record Found!\"\n            Exit Sub\n        Else\n            r = r + 1\n        End If\n    next\nLoop\n</code></pre>\n\n<p>Be careful though! The code stops at the first \"0\" encountered.</p>\n\n<p>BONUS: <code>Do While Not</code> = <code>Do Until</code></p>\n"}, {"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 1, "last_activity_date": 1457515517, "last_edit_date": 1457515517, "creation_date": 1457512529, "answer_id": 35886588, "question_id": 35886228, "link": "https://stackoverflow.com/questions/35886228/how-could-i-make-this-code-shorter/35886588#35886588", "title": "How could I make this code shorter?", "body": "<p>Using the <code>WorksheetFunction.CountIF</code> you can count the number of times a particular values in your case Range(r &amp; \"2) is repeated in a range and using that result we can compute if the value is duplicated.</p>\n\n<pre><code>r = 11\n\nDo While Not tgtWSheet.Cells(r, 2) = \"0\"\n    IF WorksheetFunction.CountIF(tgtWSheet.Range(\"B\" &amp; r &amp; \":S\" &amp; r),tgtWSheet.Range(\"B\" &amp; r)) &gt; 1 Then\n\n        MsgBox \"Duplicate Record Found!\"\n        Exit Sub\n\n    Else\n\n        r = r + 1\n\n    End If\n\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1457515118, "creation_date": 1457515118, "answer_id": 35887403, "question_id": 35886228, "link": "https://stackoverflow.com/questions/35886228/how-could-i-make-this-code-shorter/35887403#35887403", "title": "How could I make this code shorter?", "body": "<p>you could use <code>.Find()</code> method of \"Range\" object</p>\n\n<pre><code>    Option Explicit\n\n    Sub main()\n\n    Dim rowOffset As Long\n    Dim tgtWSheet As Worksheet\n\n    Set tgtWSheet = ThisWorkbook.Worksheets(\"tgtW\") '&lt;== adapt to your needs\n\n    With tgtWSheet.Cells(11, 2)\n        Do While .Offset(rowOffset).Value &lt;&gt; \"0\"\n\n            If .Offset(rowOffset + 1).Resize(18).Find(What:=.Offset(rowOffset), LookIn:=xlValues, lookat:=xlWhole, MatchCase:=False) Is Nothing Then\n                rowOffset = rowOffset + 1\n            Else\n                MsgBox \"Duplicate Record Found!\"\n                Exit Sub\n            End If\n\n        Loop\n    End With\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5972135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99e147afda513140b2e19ab3b94d87a0?s=128&d=identicon&r=PG&f=1", "display_name": "john bandiola", "link": "https://stackoverflow.com/users/5972135/john-bandiola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1457515517, "creation_date": 1457511308, "last_edit_date": 1457513000, "question_id": 35886228, "link": "https://stackoverflow.com/questions/35886228/how-could-i-make-this-code-shorter", "title": "How could I make this code shorter?", "body": "<p>How can I make this code shorter?</p>\n\n<pre><code>r = 11\n\nDo While Not tgtWSheet.Cells(r, 2) = \"0\"\n\n    If tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 1, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 2, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 3, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 4, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 5, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 6, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 7, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 8, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 9, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 10, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 11, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 12, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 13, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 14, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 15, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 16, 2) Or _\n        tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 17, 2) Or tgtWSheet.Cells(r, 2) = tgtWSheet.Cells(r + 18, 2) Then\n\n        MsgBox \"Duplicate Record Found!\"\n        Exit Sub\n\n    Else\n\n        r = r + 1\n\n    End If\n\nLoop\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter"], "answers": [{"tags": [], "owner": {"reputation": 118, "user_id": 3269584, "user_type": "registered", "profile_image": "https://graph.facebook.com/789525412/picture?type=large", "display_name": "Bennett Elder", "link": "https://stackoverflow.com/users/3269584/bennett-elder"}, "is_accepted": false, "score": 1, "last_activity_date": 1457509407, "last_edit_date": 1495542224, "creation_date": 1457509407, "answer_id": 35885741, "question_id": 35885547, "link": "https://stackoverflow.com/questions/35885547/get-excel-filter-results-into-vba-array/35885741#35885741", "title": "Get Excel filter results into VBA array", "body": "<p>It looks like the best way to do it is looping through each row, checking to see if the row is hidden (<code>cell.EntireRow.Hidden = False</code>), and adding the data for that row into the array if it's not hidden. Similar example: <a href=\"https://stackoverflow.com/questions/10849177/easiest-way-to-loop-through-a-filtered-list-with-vba\">Easiest way to loop through a filtered list with VBA?</a></p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "edited": false, "score": 0, "creation_date": 1457514205, "post_id": 35886134, "comment_id": 59435633, "body": "It&#39;s breaking down at this line:                                                                                                                   &quot;If CBool(Application.Subtotal(103, .Cells)) Then&quot;   with runtime error 438  - Object doesn&#39;t support this property or method&quot;.   Maybe this function is  not available in VBA for Autocad?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "edited": false, "score": 0, "creation_date": 1457515442, "post_id": 35886134, "comment_id": 59436359, "body": "It&#39;s breaking down at the application object. You might try something like <code>If CBool(xlbook.Subtotal(103, .Cells))</code> Then` but I don&#39;t have VBA for Autocad to test on."}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1457516406, "post_id": 35886134, "comment_id": 59437009, "body": "in Autocad VBA use &quot;ExcelApp.WorksheetFunction.Subtotal(103, .Cells))&quot; where &quot;ExcelApp&quot; is the name of the variable you set Excel Application object to"}, {"owner": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "edited": false, "score": 0, "creation_date": 1457535295, "post_id": 35886134, "comment_id": 59450493, "body": "Jeeped, I&#39;ve got a bit further with your code but it now stops with error 13-type mismatch&quot; at line   &quot;ReDim Preserve vals(1 To UBound(vals, 1), 1 To UBound(vals, 2) - 1)&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457535894, "post_id": 35886134, "comment_id": 59450969, "body": "As I do not have VBA for AutoCAD, I would suggest running through the sub procedure completely within Excel and its own native VBA. When that works, run it through VBA for AutoCAD and use the documentation to make substitutions in the code."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1457510924, "creation_date": 1457510924, "answer_id": 35886134, "question_id": 35885547, "link": "https://stackoverflow.com/questions/35885547/get-excel-filter-results-into-vba-array/35886134#35886134", "title": "Get Excel filter results into VBA array", "body": "<p>After applying the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193884.aspx\" rel=\"nofollow\">Range.AutoFilter Method</a> and determining that there are visible cells, you need to work through the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196243.aspx\" rel=\"nofollow\">Range.Areas property</a> of the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells method</a> with xlCellTypeVisible. Each of the areas will have one or more rows to process.</p>\n\n<pre><code>Sub FilterTo1Criteria()\n    Dim a As Long, r As Long, c As Long, vals As Variant\n    Dim xlSheet As Worksheet\n    'Set xlbook = GetObject(\"C:\\07509\\04-LB-06 MX-sv.xlsx\")\n    Set xlSheet = Worksheets(\"04-LB-06 MX\")\n    With xlSheet\n        If .AutoFilterMode Then .AutoFilterMode = False\n\n        'With .Range(\"blockn\")\n        With .Cells(1, 1).CurrentRegion\n            .AutoFilter Field:=1, Criteria1:=\"SV-PCS7\"\n            'step off the header row\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                'check if there are visible cells\n                If CBool(Application.Subtotal(103, .Cells)) Then\n                    'dimension the array (backwards)\n                    ReDim vals(1 To .Columns.Count, 1 To 1)\n                    'loop through the areas\n                    For a = 1 To .SpecialCells(xlCellTypeVisible).Areas.Count\n                        With .SpecialCells(xlCellTypeVisible).Areas(a)\n                            'loop through the rows in each area\n                            For r = 1 To .Rows.Count\n                                'put the call values in backwards because we cannot redim the 'row'\n                                For c = LBound(vals, 1) To UBound(vals, 1)\n                                    vals(c, UBound(vals, 2)) = .Cells(r, c).Value\n                                Next c\n                                'make room for the next\n                                ReDim Preserve vals(1 To UBound(vals, 1), 1 To UBound(vals, 2) + 1)\n                            Next r\n                        End With\n                    Next a\n                End If\n            End With\n        End With\n\n        If .AutoFilterMode Then .AutoFilterMode = False\n    End With\n\n\n    'trim off the last empty 'row'\n    ReDim Preserve vals(1 To UBound(vals, 1), 1 To UBound(vals, 2) - 1)\n    'reorient the array\n    vals = Application.Transpose(vals)\n    'show the extents\n    Debug.Print LBound(vals, 1) &amp; \":\" &amp; UBound(vals, 1)\n    Debug.Print LBound(vals, 2) &amp; \":\" &amp; UBound(vals, 2)\n\n    'show the values\n    For r = LBound(vals, 1) To UBound(vals, 1)\n        For c = LBound(vals, 2) To UBound(vals, 2)\n            Debug.Print vals(r, c)\n        Next c\n    Next r\n\nEnd Sub\n</code></pre>\n\n<p>The <strong>Preserve</strong> option can be used with the <a href=\"https://msdn.microsoft.com/en-us/library/w8k3cys2.aspx\" rel=\"nofollow\">ReDim statement</a> but only the last range can be redimensioned. I've built the array in the wrong orientation and then used the <a href=\"https://support.office.com/en-us/article/TRANSPOSE-function-ED039415-ED8A-4A81-93E9-4B6DFAC76027\" rel=\"nofollow\">TRANSPOSE function</a> to flip the orientation. Note: there are limits to the amount of array elements that can be successfully flipped.</p>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "edited": false, "score": 0, "creation_date": 1457525587, "post_id": 35886447, "comment_id": 59443379, "body": "The temp sheet solution works well. When it gets to the point of deleting the sheet, it switches to Excel for confirmation. Could I disable this (either in the code or in Excel)"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "edited": false, "score": 0, "creation_date": 1457528422, "post_id": 35886447, "comment_id": 59445418, "body": "@tmccar Application.DisplayAlerts = False"}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 1, "last_activity_date": 1457528484, "last_edit_date": 1457528484, "creation_date": 1457512116, "answer_id": 35886447, "question_id": 35885547, "link": "https://stackoverflow.com/questions/35885547/get-excel-filter-results-into-vba-array/35886447#35886447", "title": "Get Excel filter results into VBA array", "body": "<p>If you want to avoid the complex looping of Jeeped's (excellent) solution, you can use a temp sheet to copy the visible rows first.</p>\n\n<pre><code>Sub test()\n    Dim src As Range, m As Variant, sh As Worksheet\n\n    Set src = Sheet1.Range(\"c3\").CurrentRegion.SpecialCells(xlCellTypeVisible)\n    Set sh = Worksheets.Add\n\n    src.Copy sh.Range(\"a1\")\n    m = sh.Range(\"a1\").CurrentRegion\n    Application.DisplayAlerts = False\n    sh.Delete\n    Application.DisplayAlerts = True\n    Debug.Print UBound(m)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 557167, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/4a63be38501a446613975ace3d9bbf8f?s=128&d=identicon&r=PG", "display_name": "tmccar", "link": "https://stackoverflow.com/users/557167/tmccar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "accepted_answer_id": 35886447, "answer_count": 3, "score": 1, "last_activity_date": 1457528484, "creation_date": 1457508747, "question_id": 35885547, "link": "https://stackoverflow.com/questions/35885547/get-excel-filter-results-into-vba-array", "title": "Get Excel filter results into VBA array", "body": "<p>I have a VBA subroutine which filters records that have the text \"SV-PCS7\" in column 4. How can I get these results into an array?</p>\n\n<pre><code>Sub FilterTo1Criteria()\nDim xlbook As Excel.Workbook\nDim xlsheet As Excel.Worksheet\nDim ro As Integer\nSet xlbook = GetObject(\"C:\\07509\\04-LB-06 MX-sv.xlsx\")\nSet xlsheet = xlbook.Sheets(\"04-LB-06 MX\")\n   With xlsheet\n\n       .AutoFilterMode = False\n       .Range(\"blockn\").AutoFilter Field:=1, Criteria1:=\"SV-PCS7\"\n\n   End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457513646, "post_id": 35886875, "comment_id": 59435310, "body": "This is not exactly what I want. My example is a simplified example of a larger code. I would like to group the letter with all subsequent numbers and do something with it. so for example: the code would apply for rows containing the D 1 2 3 4 and B 3 5 1 and C and D 1 2"}, {"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "reply_to_user": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457513701, "post_id": 35886875, "comment_id": 59435341, "body": "You would need to be specific with the rows and the data in it. Or the sequence of the same."}, {"owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "edited": false, "score": 0, "creation_date": 1457513896, "post_id": 35886875, "comment_id": 59435451, "body": "Yes but the problem is that I wouldn&#39;t know the row number at which the next letter will be found."}], "tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 0, "last_activity_date": 1457513461, "creation_date": 1457513461, "answer_id": 35886875, "question_id": 35885464, "link": "https://stackoverflow.com/questions/35885464/loops-for-values-in-between-rows-with-a-certain-value/35886875#35886875", "title": "loops for values in between rows with a certain value", "body": "<p>the simple loop below should do the job for you.</p>\n\n<pre><code>For i = 1 to Range(\"A\" &amp; Rows.count).end(xlUp).Row\n  IF isNumeric(Range(\"A\" &amp; i)) THEN \n    'Do SOmething Here for the Numbers\n  ELSE\n    'Do something if there are letters.\n  END IF\nnext i\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 5452319, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8a3648c3303b0c86372d58db31998987?s=128&d=identicon&r=PG&f=1", "display_name": "devakotia", "link": "https://stackoverflow.com/users/5452319/devakotia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457513461, "creation_date": 1457508451, "last_edit_date": 1457510909, "question_id": 35885464, "link": "https://stackoverflow.com/questions/35885464/loops-for-values-in-between-rows-with-a-certain-value", "title": "loops for values in between rows with a certain value", "body": "<p>For the example data in the \"A\" column:</p>\n\n<p>(Column 1)\nD\n1\n2\n3\n4\nB\n3\n5\n1\nC\nD\n1\n2</p>\n\n<p>I would like to write a code does something to the rows that are in between the letters.</p>\n\n<p>I'm thinking  I need to do a for loop that goes down the entire column and finds the letters.</p>\n\n<p>Problem is: Within that loop I want to perform another loop that stops at the next letter. So in the example... the code will be performed for the rows or integers that are between D and B, B and C, C and D.</p>\n\n<p>Can someone please help me on how you would approach this problem?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "edited": false, "score": 0, "creation_date": 1457513880, "post_id": 35886244, "comment_id": 59435443, "body": "You have to change &quot;picture&quot; with the actual name of the sheet you want to work with"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "edited": false, "score": 0, "creation_date": 1457515223, "post_id": 35886244, "comment_id": 59436229, "body": "if it works you may want to mark your question as answered, upvote my answer and/or give some rep. thank you"}, {"owner": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "edited": false, "score": 0, "creation_date": 1457518919, "post_id": 35886244, "comment_id": 59438828, "body": "Still out of range did you test this from your side?"}, {"owner": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "edited": false, "score": 0, "creation_date": 1457519513, "post_id": 35886244, "comment_id": 59439201, "body": "i got it now thanks but it is not working for the entire column,,for example if i put url in the entire column a then the result for all the link image will be in the column b"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "edited": false, "score": 0, "creation_date": 1457524859, "post_id": 35886244, "comment_id": 59442889, "body": "maybe you didn&#39;t notice that &quot;For i = 2 to 3&quot;, by which I limited rows range for testing purposes. set that &quot;3&quot; to whatever you need."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1457511379, "creation_date": 1457511379, "answer_id": 35886244, "question_id": 35884778, "link": "https://stackoverflow.com/questions/35884778/install-url-picture-by-excel-vba/35886244#35886244", "title": "Install url picture by Excel VBA", "body": "<p>try this</p>\n\n<pre><code>Sub InstallPictures()\nDim i As Long\nDim v As String\nDim sht As Worksheet\nDim colWithUrl As Long, colWithPics As Long\n\ncolWithUrl = 1\ncolWithPics = 2\n\nSet sht = ThisWorkbook.Sheets(\"picture\")\nWith sht\n    .Columns(colWithPics).ColumnWidth = .Columns(colWithUrl).ColumnWidth\n    For i = 2 To 3\n        v = .Cells(i, colWithUrl).Value\n        If v &lt;&gt; \"\" Then Call setPic(ActiveSheet.Pictures.Insert(v), .Cells(i, colWithPics), .Cells(i, colWithUrl))\n    Next i\nEnd With\n\nEnd Sub\n\n\nSub setPic(myPic As Picture, cellToMoveImageTo As Range, cellToCopySizeFrom As Range)\n\nWith myPic.ShapeRange\n    ' move image to have its upper left corner as the \"cellToMoveImageTo\" cell one\n    .Left = cellToMoveImageTo.Left\n    .Top = cellToMoveImageTo.Top\n\n\n    ' resize the image to fit the \"cellToCopySizeFrom\" size\n    .LockAspectRatio = False '&lt;== you have to do that otherwise the original picture aspect ratio will stay and won't fit the aspect ratio of the cell whose upper left corner it shares\n    .Height = cellToCopySizeFrom.Height\n    .Width = cellToCopySizeFrom.Width\n\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5982034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdc0ee9415853cf95d5102ea69ec0218?s=128&d=identicon&r=PG&f=1", "display_name": "cath", "link": "https://stackoverflow.com/users/5982034/cath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 35886244, "answer_count": 1, "score": 0, "last_activity_date": 1486803609, "creation_date": 1457506029, "last_edit_date": 1457520795, "question_id": 35884778, "link": "https://stackoverflow.com/questions/35884778/install-url-picture-by-excel-vba", "title": "Install url picture by Excel VBA", "body": "<p>I am seeking for help I am trying to find solution to the macro below:\n1st issue I want to paste url on column a and I would like the result picture on column b with the same size on the link column a</p>\n\n<pre><code>Sub InstallPictures()\n    Dim i As Long, v As String\n    On Error Resume Next\n        For i = 2 To 1903\n            v = Cells(i, \"a\").Value\n            If v = \"\" Then Exit Sub\n            With ActiveSheet.Pictures\n                .Insert (v)\n            End With\n        Next i\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/BPUL9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BPUL9.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sql", "oracle", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 7586, "user_id": 1151269, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/5eoVa.jpg?s=128&g=1", "display_name": "Rachcha", "link": "https://stackoverflow.com/users/1151269/rachcha"}, "is_accepted": true, "score": 0, "last_activity_date": 1457513870, "creation_date": 1457513870, "answer_id": 35886997, "question_id": 35884777, "link": "https://stackoverflow.com/questions/35884777/pivot-a-table-with-repeating-the-values-is-it-possible/35886997#35886997", "title": "Pivot a table with repeating the values- is it possible?", "body": "<p>I have found an answer I can live with:</p>\n\n<pre><code>with rate as\n         (select 1 location_id,\n                 'A' rate_type_code,\n                 0.04 rate_1,\n                 null as start_date,\n                 to_date ('30 JUN 2015') end_date\n            from dual\n          union all\n          select 1 location_id,\n                 'A' rate_type_code,\n                 0.02 rate_1,\n                 to_date ('01 JUL 2015') as start_date,\n                 to_date ('30 JUN 2016') end_date\n            from dual\n          union all\n          select 1,\n                 'A',\n                 0,\n                 to_date ('01 JUL 2016'),\n                 null\n            from dual\n          union all\n          select 2,\n                 'A',\n                 0.05,\n                 to_date ('01 JUL 2004'),\n                 null\n            from dual\n          union all\n          select 3,\n                 'A',\n                 0.09,\n                 to_date ('01 JUL 2004'),\n                 null\n            from dual\n          union all\n          select 2,\n                 'B',\n                 0.28,\n                 to_date ('01 JUL 2004'),\n                 to_date ('30 APR 2016')\n            from dual\n          union all\n          select 2,\n                 'B',\n                 0.34,\n                 to_date ('01 MAY 2016'),\n                 to_date ('30 APR 2017')\n            from dual\n          union all\n          select 2,\n                 'B',\n                 0.30,\n                 to_date ('01 MAY 2017'),\n                 null\n            from dual),\n     mod_rate as\n         (select r.location_id,\n                 r.rate_type_code,\n                 case\n                     when nvl (r.start_date, to_date ('01-JAN-2000')) &gt;\n                              :my_start_date then\n                         nvl (r.start_date, to_date ('01-JAN-2000'))\n                     else\n                         :my_start_date\n                 end\n                     as start_date,\n                 case\n                     when nvl (r.end_date, to_date ('31-DEC-2099')) &lt;\n                              nvl ( :my_end_date,\n                                   add_months ( :my_start_date, 12)) then\n                         nvl (r.end_date, to_date ('31-DEC-2099'))\n                     else\n                         nvl ( :my_end_date, add_months ( :my_start_date, 12))\n                 end\n                     as end_date,\n                 r.rate_1\n            from rate r\n           where     (   r.start_date is null\n                      or r.start_date &lt;= :my_start_date\n                      or     r.start_date &gt;= :my_start_date\n                         and r.start_date &lt;=\n                                 nvl ( :my_end_date,\n                                      add_months ( :my_start_date, 12)))\n                 and (   r.end_date is null\n                      or r.end_date &gt;=\n                             nvl ( :my_end_date,\n                                  add_months ( :my_start_date, 12))\n                      or r.end_date &gt;= :my_start_date)),\n     date_range as\n         (  select mr.rate_type_code,\n                   mr.start_date,\n                   mr.end_date,\n                   lead (\n                       mr.start_date,\n                       1)\n                   over (partition by mr.rate_type_code\n                         order by mr.rate_type_code, mr.start_date)\n                       next_start_date\n              from mod_rate mr\n          group by mr.rate_type_code, mr.start_date, mr.end_date\n          order by mr.rate_type_code, mr.start_date, mr.end_date),\n     final_date_range as\n         (select dr.rate_type_code, dr.start_date, dr.end_date\n            from date_range dr\n           where not (    nvl (dr.next_start_date, dr.start_date) &gt;\n                              dr.start_date\n                      and nvl (dr.next_start_date, dr.end_date) &lt; dr.end_date))\nselect fdr.rate_type_code,\n       fdr.start_date,\n       fdr.end_date,\n       (select mr.rate_1\n          from mod_rate mr\n         where     mr.rate_type_code = fdr.rate_type_code\n               and mr.start_date &lt;= fdr.start_date\n               and mr.end_date &gt;= fdr.end_date\n               and mr.location_id = 1)\n           as rates_for_location_1,\n       (select mr.rate_1\n          from mod_rate mr\n         where     mr.rate_type_code = fdr.rate_type_code\n               and mr.start_date &lt;= fdr.start_date\n               and mr.end_date &gt;= fdr.end_date\n               and mr.location_id = 2)\n           as rates_for_location_2,\n       (select mr.rate_1\n          from mod_rate mr\n         where     mr.rate_type_code = fdr.rate_type_code\n               and mr.start_date &lt;= fdr.start_date\n               and mr.end_date &gt;= fdr.end_date\n               and mr.location_id = 3)\n           as rates_for_location_3\n  from final_date_range fdr;\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre><code>RATE_TYPE_CODE START_DATE END_DATE    RATES_FOR_LOCATION_1 RATES_FOR_LOCATION_2 RATES_FOR_LOCATION_3\n-------------- ---------- ----------- -------------------- -------------------- --------------------\nA              1/04/2016  30/06/2016  0.02                 0.05                 0.09\nA              1/07/2016  1/04/2017   0                    0.05                 0.09\nB              1/04/2016  30/04/2016                       0.28                   \nB              1/05/2016  1/04/2017                        0.34                   \n</code></pre>\n\n<p>I can simply transpose this data after receiving it in Excel and get it in desired format.</p>\n"}], "owner": {"reputation": 7586, "user_id": 1151269, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/5eoVa.jpg?s=128&g=1", "display_name": "Rachcha", "link": "https://stackoverflow.com/users/1151269/rachcha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 35886997, "answer_count": 1, "score": 0, "last_activity_date": 1457513870, "creation_date": 1457506028, "last_edit_date": 1531164843, "question_id": 35884777, "link": "https://stackoverflow.com/questions/35884777/pivot-a-table-with-repeating-the-values-is-it-possible", "title": "Pivot a table with repeating the values- is it possible?", "body": "<p>I have one single table- <code>RATE</code> as follows:</p>\n\n<pre><code>LOCATION_ID RATE_TYPE_CODE     RATE_1 START_DATE END_DATE \n----------- -------------- ---------- ---------- ---------\n          1 A                     .04            30-JUN-15\n          1 A                     .02 01-JUL-15  30-JUN-16\n          1 A                       0 01-JUL-16           \n          2 A                     .05 01-JUL-04           \n          3 A                     .09 01-JUL-04           \n          2 B                     .28 01-JUL-04  30-APR-16\n          2 B                     .34 01-MAY-16  30-APR-17\n          2 B                      .3 01-MAY-17           \n</code></pre>\n\n<p>I have to query this table from an Excel workbook macro and get rates in columnar format against location IDs, separated by date ranges. So, for an effective date of <code>01-APR-2016</code> I have to get the rates that are applicable till <code>01-APR-2017</code> in columnar format like this in Excel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kQewH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kQewH.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>What I tried:</strong> Fetch the right rates with respect to the effective date and upto a year later. Here is the query:</p>\n\n<pre><code>select *\n  from rate r\n where     (   r.start_date is null\n            or r.start_date &lt;= to_date ('01-APR-2016')\n            or     r.start_date &gt;= to_date ('01-APR-2016')\n               and r.start_date &lt;= add_months (to_date ('01-APR-2016'), 12))\n       and (   r.end_date is null\n            or r.end_date &gt;= add_months (to_date ('01-APR-2016'), 12)\n            or r.end_date &gt;= to_date ('01-APR-2016'));\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>LOCATION_ID RATE_TYPE_CODE     RATE_1 START_DATE END_DATE \n----------- -------------- ---------- ---------- ---------\n          1 A                     .02 01-JUL-15  30-JUN-16\n          1 A                       0 01-JUL-16           \n          2 A                     .05 01-JUL-04           \n          3 A                     .09 01-JUL-04           \n          2 B                     .28 01-JUL-04  30-APR-16\n          2 B                     .34 01-MAY-16  30-APR-17\n</code></pre>\n\n<p>I reckon such a pivot is possible but I can't see a way. Any help on this will be much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1457507383, "post_id": 35884977, "comment_id": 59432128, "body": "i have another questions,, how can i arrange it byup-to-date if a have column date?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "edited": false, "score": 0, "creation_date": 1457537607, "post_id": 35884977, "comment_id": 59452369, "body": "I would create another question for that, including more sample data"}, {"owner": {"reputation": 149, "user_id": 9900837, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4dfe88bda4124ecb650d5845e758757?s=128&d=identicon&r=PG&f=1", "display_name": "Winnie-c", "link": "https://stackoverflow.com/users/9900837/winnie-c"}, "edited": false, "score": 0, "creation_date": 1545727782, "post_id": 35884977, "comment_id": 94683655, "body": "The code is working. However, I found additional blank rows exist in the &quot;pasted&quot; worksheet. How can it be solved?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1457506702, "creation_date": 1457506702, "answer_id": 35884977, "question_id": 35884764, "link": "https://stackoverflow.com/questions/35884764/vba-how-to-copy-all-data-from-other-workbook-and-paste-it-in-last-row/35884977#35884977", "title": "VBA - How to copy all data from other workbook and paste it in last row", "body": "<pre><code>Dim Sheet1 As Worksheet\nDim Sheet2 As Worksheet\nDim rng As Range\n\nSet Sheet1 = Workbooks.Open(TextBox1.Text).Sheets(1)\nSet Sheet2 = Workbooks.Open(TextBox2.Text).Sheets(1)\n\nSet rng = Sheet1.Range(\"A1\").CurrentRegion 'assuming no blank rows/column\nSet rng = rng.Offset(1, 0).Resize(rng.Rows.Count - 1, rng.Columns.Count) 'exclude header\n\nSheet2.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Resize( _\n              rng.Rows.Count, rng.Columns.Count).Value = rng.Value\n\nSheet2.Parent.Close True 'save changes\nSheet1.Parent.Close False 'don't save\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5865646, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/6bDpC.jpg?s=128&g=1", "display_name": "7A65726F", "link": "https://stackoverflow.com/users/5865646/7a65726f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 35884977, "answer_count": 1, "score": 1, "last_activity_date": 1457520854, "creation_date": 1457505983, "last_edit_date": 1457520854, "question_id": 35884764, "link": "https://stackoverflow.com/questions/35884764/vba-how-to-copy-all-data-from-other-workbook-and-paste-it-in-last-row", "title": "VBA - How to copy all data from other workbook and paste it in last row", "body": "<p>I would like to copy the data from a workbook and paste it in the last row of the other workbook without the header.</p>\n\n<p>For example:</p>\n\n<pre><code>Workbook1                                Workbook2\n**Color** |  **Animals** |  Fruits       **Color** | **Animals**| **Fruits**               \nyellow    | elephant     | apple         black     | pig        |  mango\nblue      | girrafe      | banana        white     | dog        |  grapes\n</code></pre>\n\n<p>now what i want is all data from workbook will be pasted below worbk2 without the headers...</p>\n\n<pre><code>Workbook1\n**Colors** | **Animal** | **Fruits**\nyellow     | elephant   |  apple  \nblue       | girrafe    |  banana\nblack      | pig        |  mango\nwhite      | dog        |  grapes\n</code></pre>\n\n<p>can someone please help about this.\nheres my code..</p>\n\n<pre><code>Public Sub sample1()\n\nDim file1 As Excel.Workbook\nDim file2 As Excel.Workbook\nDim Sheet1 As Worksheet\nDim Sheet2 As Worksheet\nDim CopyRange As Range\n\n    'Open both workbooks first:\n    Set file1 = Workbooks.Open(TextBox1.Text)\n    Set file2 = Workbooks.Open(TextBox2.Text)\n\n    Set Sheet1 = file1.Sheets(1)\n    Set Sheet2 = file2.Sheets(1)\n\n    lngLastCol = Sheet1.Cells(1, 256).End(xlToLeft).Column\n    lngLastRow = Sheet1.Range(\"A\" &amp; Sheet1.Rows.Count).End(xlUp).Row\n\n    varArray = Sheet1.Range(Sheet1.Cells(2, 1), Sheet1.Cells(lngLastRow, lngLastCol)).Value\n\n    Set CopyRange = Sheet1.Range(\"A1:A\" &amp; lngLastRow)\n    CopyRange.EntireRow.Copy Sheet1.Cells(Rows.Count, 1).End(xlUp)(2)\n\n    'Now, copy what you want from :\n    file1.Sheets(\"sheet1\").CopyRange.EntireRow.Copy Sheet1.Cells(Rows.Count, 1).End(xlUp)(2)\n\n\n    'Now, paste to  worksheet:\n    file2.Sheets(\"sheet1\").Range(\"B1\").PasteSpecial\n\n    'Close 1-2:\n    file2.Save\n    file1.Close\n    file2.Close\n</code></pre>\n"}, {"tags": ["excel", "colors", "vba"], "comments": [{"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457514097, "post_id": 35884762, "comment_id": 59435571, "body": "Welcome to StackOverflow. We are not a script writing service. We expect users to tell us what they have tried so far (including any scripts they are using) and where they&#39;re stuck so that we can help with specific problems. Questions that only ask for scripts are too broad and are likely to be <a href=\"http://stackoverflow.com/help/closed-questions\">put on hold or closed</a>. Please read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1457531068, "post_id": 35884762, "comment_id": 59447337, "body": "This can be achieved without any VBA at all, using conditional formatting and the <a href=\"https://support.office.com/en-us/article/INDIRECT-function-474b3a3a-8a26-4f44-b491-92b6306fa261\" rel=\"nofollow noreferrer\">indirect function</a>. For example: <code>=AND(OR(=INDIRECT(&quot;M&quot; &amp; ROW()) = &quot;NW&quot;, =INDIRECT(&quot;M&quot; &amp; ROW()) = &quot;NE&quot;), =RIGHT(INDIRECT(&quot;C&quot; &amp; ROW()), 2) &gt;= &quot;22&quot;)</code>"}, {"owner": {"reputation": 11, "user_id": 6037920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4632649b988b34afe39090bdeeb77f46?s=128&d=identicon&r=PG&f=1", "display_name": "Andre P", "link": "https://stackoverflow.com/users/6037920/andre-p"}, "edited": false, "score": 0, "creation_date": 1457546238, "post_id": 35884762, "comment_id": 59458675, "body": "Thanks for your assistance, maybe I don\u2019t completely understand how to apply the information you offered or I am doing something but, that\u2019s not exactly working. This seems to be a formula that I would have to enter into another cell, column and preform this task on a row by row basis and unfortunately I don\u2019t have that much freedom on the worksheet."}, {"owner": {"reputation": 11, "user_id": 6037920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4632649b988b34afe39090bdeeb77f46?s=128&d=identicon&r=PG&f=1", "display_name": "Andre P", "link": "https://stackoverflow.com/users/6037920/andre-p"}, "edited": false, "score": 0, "creation_date": 1457546270, "post_id": 35884762, "comment_id": 59458690, "body": "I would like to use a macro for this because it allows the freedom of searching the data without having to use or input more data on the worksheet, kind of like the macro included below. It allows me to select a cell and it searches the entire column of the selected cell and simply highlights cells that are duplicates. I am pretty much trying to do the same thing but, in this case search two different columns based on the criteria mentioned previously.  Can this be done?"}, {"owner": {"reputation": 11, "user_id": 6037920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4632649b988b34afe39090bdeeb77f46?s=128&d=identicon&r=PG&f=1", "display_name": "Andre P", "link": "https://stackoverflow.com/users/6037920/andre-p"}, "edited": false, "score": 0, "creation_date": 1457546337, "post_id": 35884762, "comment_id": 59458737, "body": "Sub FindDups()        ScreenUpdating = False    FirstItem = ActiveCell.Value    SecondItem = ActiveCell.Offset(1, 0).Value    Offsetcount = 1    Do While ActiveCell &lt;&gt; &quot;&quot;       If FirstItem = SecondItem Then         ActiveCell.Offset(Offsetcount, 0).Interior.Color = RGB(255, 0, 0)        Offsetcount = Offsetcount + 1        SecondItem = ActiveCell.Offset(Offsetcount, 0).Value      Else        ActiveCell.Offset(Offsetcount, 0).Select        FirstItem = ActiveCell.Value        SecondItem = ActiveCell.Offset(1, 0).Value        Offsetcount = 1       End If    Loop    ScreenUpdating = True End Sub"}, {"owner": {"reputation": 3667, "user_id": 2390644, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ExbTg.png?s=128&g=1", "display_name": "William Price", "link": "https://stackoverflow.com/users/2390644/william-price"}, "edited": false, "score": 0, "creation_date": 1457651859, "post_id": 35884762, "comment_id": 59516971, "body": "Andre, please use the <a href=\"https://stackoverflow.com/posts/35884762/edit\">edit</a> link to place additional details <i>directly in your question</i> instead of in comments."}], "owner": {"reputation": 11, "user_id": 6037920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4632649b988b34afe39090bdeeb77f46?s=128&d=identicon&r=PG&f=1", "display_name": "Andre P", "link": "https://stackoverflow.com/users/6037920/andre-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1457507024, "creation_date": 1457505968, "last_edit_date": 1531164843, "question_id": 35884762, "link": "https://stackoverflow.com/questions/35884762/compare-text-in-multiple-columns-and-change-cell-color-based-results", "title": "Compare text in multiple columns and change cell color based results", "body": "<p>I have a spreadsheet with 11,000 entries. I need help with a macro to check the distribution of specific data based on:</p>\n\n<ul>\n<li>RowCode in column C</li>\n<li>Position form in column H, and</li>\n<li>Quadrant located in column M.</li>\n</ul>\n\n<p>The RowCode always contains a series of numbers and a letter either A or B (01A-01) the numbers associated with A are typically in the lower range like A1 to 22 and the numbers associated with B are typically in the higher range like B23 to 76 but this can vary from time to time. </p>\n\n<p><img src=\"https://i.stack.imgur.com/Uexj3.png\" alt=\"Screenshot of an example Excel Worksheet\"></p>\n\n<p>The quadrant in column M identifies location, this is always either <code>NW</code>, <code>SW</code>, <code>NE</code>, or <code>SE</code>. All <code>NW</code> or <code>NE</code> rows should be in the lower number range of the A section and all <code>SW</code> or <code>SE</code> rows should be in the higher number range of the B sections as noted below. </p>\n\n<ul>\n<li>NW: 1-22</li>\n<li>NE: 1-22        </li>\n<li>SW: 22-76</li>\n<li>SE: 22-76</li>\n</ul>\n\n<p>The last condition to be met is the \u201cposition form\u201d located in column H. This column will contain either <code>East</code> or <code>West</code> based on the data in column M. If column M has <code>NE</code> or <code>SE</code> in it column H should reflect <code>West</code>. If column H has <code>NW</code> or <code>SW</code> in it column H should reflect <code>East</code>. </p>\n\n<p>I would like a macro to check all these conditions and highlight the cell in the column that does not meet these conditions so I can determine what\u2019s incorrect and make the correction manually. </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 2470, "user_id": 5832518, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cKPiUtKxJvw/AAAAAAAAAAI/AAAAAAAAAmQ/egOpZRu_8Bk/photo.jpg?sz=128", "display_name": "Raju", "link": "https://stackoverflow.com/users/5832518/raju"}, "edited": false, "score": 1, "creation_date": 1457503969, "post_id": 35884213, "comment_id": 59430729, "body": "Pure code-writing requests are off-topic on Stack Overflow -- we expect  questions here to relate to <i>specific</i> programming problems -- but we  will happily help you write it yourself! Tell us  <a href=\"http://stackoverflow.com/help/how-to-ask\">what you&#39;ve tried</a>, and where you are stuck.  This will also help us answer your question better."}, {"owner": {"reputation": 2797, "user_id": 1867590, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/np7f8.png?s=128&g=1", "display_name": "JFS", "link": "https://stackoverflow.com/users/1867590/jfs"}, "edited": false, "score": 0, "creation_date": 1457504039, "post_id": 35884213, "comment_id": 59430759, "body": "What have you done so far..."}, {"owner": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "edited": false, "score": 0, "creation_date": 1457612502, "post_id": 35884213, "comment_id": 59491157, "body": "I&#39;m new for programming that&#39;s why i&#39;m seeking help from talented programming  peoples like  gizlmeier. Help me if u can don&#39;t criticize JFS"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "edited": false, "score": 0, "creation_date": 1457518549, "post_id": 35884433, "comment_id": 59438564, "body": "Thanks for your great help buddy.. and i got a run-time error type mismatch in line 13.. pls help to solve it  ... my sheet name is sheet1 cell address is full D column"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "edited": false, "score": 0, "creation_date": 1457535104, "post_id": 35884433, "comment_id": 59450341, "body": "This is weird, the code works fine for me. Could you give any more info of where exactly the code fails?"}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "edited": false, "score": 0, "creation_date": 1457605187, "post_id": 35884433, "comment_id": 59486044, "body": "No you used it wrong, the Sheetname variable is for the name of your Worksheet, default Worksheet name is Sheet1 for Example  And the line inside the If (Sheets(Sheetname).Range(Cell.Address).Interior.ColorIndex = 4) Should stay as it is, you may only change the ColorIndex"}, {"owner": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "edited": false, "score": 0, "creation_date": 1457612637, "post_id": 35884433, "comment_id": 59491256, "body": "Oh what are the things i want to change in that code to make it work??? i&#39;m very new for excel but its requires for my new job so pls help to solve it gizlmeier..."}, {"owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "reply_to_user": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "edited": false, "score": 0, "creation_date": 1457677769, "post_id": 35884433, "comment_id": 59524256, "body": "You could just tell me your Worksheet name and how the found cell should be highlighted and I modify the Code for you"}, {"owner": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "edited": false, "score": 1, "creation_date": 1458728872, "post_id": 35884433, "comment_id": 59986671, "body": "gizlmeier Thanks For your Help And I&#39;m Happy to inform you that i created an vba app in my own with your code as reference... :-)"}], "tags": [], "owner": {"reputation": 1702, "user_id": 5840837, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zRpzo.png?s=128&g=1", "display_name": "gizlmo", "link": "https://stackoverflow.com/users/5840837/gizlmo"}, "is_accepted": false, "score": 0, "last_activity_date": 1457504586, "creation_date": 1457504586, "answer_id": 35884433, "question_id": 35884213, "link": "https://stackoverflow.com/questions/35884213/excel-vba-how-to-get-input-from-user-and-compare-exact-match-in-column-d/35884433#35884433", "title": "Excel VBA: How to get input from user and compare exact match in column D?", "body": "<p>By exact match you are talking about case sensitive matching, aren't you? If so this should do it:</p>\n\n<pre><code>Function findValue()\n\nDim Value As Variant\nDim Sheetname As String\n\nValue = InputBox(\"Enter Value:\", \"Input\")\n\nSheetname = \"ENTER SHEETNAME HERE\"\n\n'Sheets(Sheetname).Columns(\"D:D\").Select\nDim Cell As Variant\n\n'Search in Column D | MatchCase True = case sensitive\nSet Cell = Sheets(Sheetname).Columns(\"D:D\").Find(What:=Value, After:=Sheets(Sheetname).Range(\"D1\"), LookIn:=xlFormulas, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n    MatchCase:=True, SearchFormat:=False)\n\nIf Not Cell Is Nothing Then\n\n    'Value is found, Highlight Cell\n    Sheets(Sheetname).Range(Cell.Address).Interior.ColorIndex = 4\nElse\n\n    'Value Not found\n    MsgBox \"Not Found\"\nEnd If\nEnd Function\n</code></pre>\n\n<p>Otherwise you have to change the MatchCase option to False</p>\n"}], "owner": {"reputation": 1, "user_id": 6037654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/157ade68396a17ca7379c7adcf68f993?s=128&d=identicon&r=PG&f=1", "display_name": "MaximusID", "link": "https://stackoverflow.com/users/6037654/maximusid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2085, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457582121, "creation_date": 1457503756, "last_edit_date": 1457520970, "question_id": 35884213, "link": "https://stackoverflow.com/questions/35884213/excel-vba-how-to-get-input-from-user-and-compare-exact-match-in-column-d", "title": "Excel VBA: How to get input from user and compare exact match in column D?", "body": "<p>Excel VBA: How to get input from user and compare exact match in column D if a match found highlight that found match  automatically in column D? Is it possible by using Excel 2013?</p>\n\n<ol>\n<li>Get input from the user  if a exact match found in column D\nhighlight that value in column D (value must be type Variant) </li>\n<li>If no match found an alert msg(Not Found)</li>\n<li>Wants to clear the input text box automatically for next user input</li>\n</ol>\n\n<p>please help this will very helpful for me....</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "answers": [{"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457506051, "post_id": 35884748, "comment_id": 59431527, "body": "Missed that.  Thanks"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1457506037, "last_edit_date": 1457506037, "creation_date": 1457505916, "answer_id": 35884748, "question_id": 35884047, "link": "https://stackoverflow.com/questions/35884047/need-help-to-input-if-and-vlookup-formula-into-cell-using-vba/35884748#35884748", "title": "Need help to input If and Vlookup formula into cell using VBA", "body": "<pre><code>Dim emptyRow As Long, addr as string\nemptyRow = Range(\"Z100000\").End(xlUp).Offset(1, 0).Row\naddr = Cells(emptyRow,40).Address()\n\nCells(emptyRow, 43).Formula = \"=IF(\" &amp; addr &amp; \"=0, \"\"\"\", VLOOKUP(\" &amp; _\n                              addr &amp; \",'Job Category'!$G$10:$I$12, 3, TRUE))\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 5993600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75ed5dd461d967326aa078dead40390?s=128&d=identicon&r=PG&f=1", "display_name": "Stu", "link": "https://stackoverflow.com/users/5993600/stu"}, "edited": false, "score": 0, "creation_date": 1457546466, "post_id": 35884754, "comment_id": 59458813, "body": "Works perfectly! Thank you and everyone else for helping!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1457505942, "creation_date": 1457505942, "answer_id": 35884754, "question_id": 35884047, "link": "https://stackoverflow.com/questions/35884047/need-help-to-input-if-and-vlookup-formula-into-cell-using-vba/35884754#35884754", "title": "Need help to input If and Vlookup formula into cell using VBA", "body": "<p>You are mashing together worksheet function syntax and VBA syntax. While you can use a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff834434.aspx\" rel=\"nofollow\">WorksheetFunction object</a> to return the result from a <a href=\"https://support.office.com/en-us/article/vlookup-function-adceda66-30de-4f26-923b-7257939faa65\" rel=\"nofollow\">VLOOKUP function</a>, it seems that you want to write the formula into the cell. This may be better as an xlR1C1 style formula due to the emptyRow variable.</p>\n\n<pre><code>'as an xlA1 style\n Cells(emptyRow, 43).Formula = _\n    \"=IF(AN\" &amp; emptyRow &amp; \"=0, \"\"\"\", VLOOKUP(AN\" &amp; emptyRow &amp; \",'Job Category'!$G$10:$I$12, 3, TRUE))\"\n'as an xlR1C1 style\n Cells(emptyRow, 43).FormulaR1C1 = _\n    \"=IF(RC40=0, \"\"\"\", VLOOKUP(RC40, 'Job Category'!R10C7:R12C9, 3, TRUE))\"\n</code></pre>\n\n<p>Remember that when including quotes within a quoted string, you need to double up the quotes.</p>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1457507118, "creation_date": 1457507118, "answer_id": 35885082, "question_id": 35884047, "link": "https://stackoverflow.com/questions/35884047/need-help-to-input-if-and-vlookup-formula-into-cell-using-vba/35885082#35885082", "title": "Need help to input If and Vlookup formula into cell using VBA", "body": "<p>You can use iferror as well, </p>\n\n<pre><code>Sub Button1_Click()\n    Dim emptyRow As Long\n\n    emptyRow = Cells(Rows.Count, \"Z\").End(xlUp).Row + 1\n    Cells(emptyRow, 43).Formula = \"=IFERROR(VLOOKUP(AN\" &amp; emptyRow &amp; \",'Job Category'!$G$10:$I$12,3,1),\"\"\"\")\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5993600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e75ed5dd461d967326aa078dead40390?s=128&d=identicon&r=PG&f=1", "display_name": "Stu", "link": "https://stackoverflow.com/users/5993600/stu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 35884754, "answer_count": 3, "score": 2, "last_activity_date": 1457507118, "creation_date": 1457503102, "last_edit_date": 1457506084, "question_id": 35884047, "link": "https://stackoverflow.com/questions/35884047/need-help-to-input-if-and-vlookup-formula-into-cell-using-vba", "title": "Need help to input If and Vlookup formula into cell using VBA", "body": "<p>I created a button which adds a new job entry into my job database. Based on the value in <code>Cells (emptyRow,40)</code>, Vlookup with search <strong>\"Job Category\"</strong> Worksheet and output the results in <code>Cells (emptyRow,43)</code>. Hence, each time I am adding a new job entry, I would like <code>Cells(emptyRow,43)</code> to input the formula and tell me what job this falls under, as shown below </p>\n\n<pre><code>Dim emptyRow As Long\nemptyRow = Range(\"Z100000\").End(xlUp).Offset(1, 0).Row\nCells(emptyRow, 43).Formula = \"=IF(Cells(emptyRow,40)=0, \"\", VLOOKUP(Cells(emptyRow,40),'Job Category'!$G$10:$I$12, 3, TRUE))\"\n</code></pre>\n\n<p>However, I get this message: <code>\"Run-time error '1004' : Application-defined or object-defined error.\"</code></p>\n\n<p>Anyone knows why?</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1457511483, "post_id": 35883378, "comment_id": 59434120, "body": "Which version of Mac Excel?"}, {"owner": {"reputation": 2923, "user_id": 4497791, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/vCgRs.png?s=128&g=1", "display_name": "eirikdaude", "link": "https://stackoverflow.com/users/4497791/eirikdaude"}, "edited": false, "score": 0, "creation_date": 1457514349, "post_id": 35883378, "comment_id": 59435694, "body": "Not using <code>Select</code>, and explicitly  stating what <code>Workbook</code> / <code>Worksheet</code> / <code>Ranges</code> / <code>Other object</code> the macro is working on is a good way to prevent macros from starting to behave in unexpected ways. I&#39;m not saying it is the issue here, but I&#39;ve seen a lot of trouble originating from such statements before."}, {"owner": {"reputation": 37, "user_id": 3908152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/781e2adef1a40729c4c57b288520f16d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3908152/josh"}, "edited": false, "score": 1, "creation_date": 1459474113, "post_id": 35883378, "comment_id": 60314425, "body": "I finally heard back from my client and I was able to identify the problematic chunk of code. The exception is being thrown when I try to create the PivotTable. So this block.   User is on Excel:mac 2011, version 14.4.7      ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _         &quot;Indirect Import!R1C1:R1048576C4&quot;, Version:=6).CreatePivotTable _         TableDestination:=&quot;IndirectPivot!R1C1&quot;, TableName:=&quot;PivotTable4&quot;, _         DefaultVersion:=6"}], "owner": {"reputation": 37, "user_id": 3908152, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/781e2adef1a40729c4c57b288520f16d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/3908152/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 551, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593700818, "creation_date": 1457500204, "last_edit_date": 1593700818, "question_id": 35883378, "link": "https://stackoverflow.com/questions/35883378/excel-vba-works-in-windows-but-not-in-mac-os", "title": "Excel VBA works in Windows but not in Mac-OS", "body": "<p>The following sub runs like a champ on Windows version of Excel 2016 but I have a user trying to run it on her Mac and it's throwing an error. I don't have a screenshot of the error but when she sends it to me, I'll post it here.</p>\n\n<p>I have written several other macros for this user, so I know she's not generally having any troubles with macros as such; It's specific to this macro. Is the code for generating PivotTables different in the Mac version?</p>\n\n<pre><code>Private Sub PivotCreate()\n   Sheets(\"IndirectPivot\").Select\n\n   Cells.Select\n    Selection.Delete Shift:=xlUp\n\n    Range(\"A1\").Select\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Indirect Import!R1C1:R1048576C4\", Version:=6).CreatePivotTable _\n        TableDestination:=\"IndirectPivot!R1C1\", TableName:=\"PivotTable4\", _\n        DefaultVersion:=6\n    Sheets(\"IndirectPivot\").Select\n    Cells(1, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Funder\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"GL\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Class\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n    ActiveSheet.PivotTables(\"PivotTable4\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable4\").PivotFields(\"Amount\"), \"Count of Amount\", xlCount\n    With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Count of Amount\")\n        .Caption = \"Sum of Amount\"\n        .Function = xlSum\n        .NumberFormat = \"0.00\"\n    End With\n    ActiveSheet.PivotTables(\"PivotTable4\").RowAxisLayout xlTabularRow\n    ActiveSheet.PivotTables(\"PivotTable4\").RepeatAllLabels xlRepeatLabels\n    With ActiveSheet.PivotTables(\"PivotTable4\")\n        .ColumnGrand = False\n        .RowGrand = False\n    End With\n    ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Funder\").Subtotals = Array( _\n        False, False, False, False, False, False, False, False, False, False, False, False)\n    ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"GL\").Subtotals = Array( _\n        False, False, False, False, False, False, False, False, False, False, False, False)\n    ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Amount\").Subtotals = Array( _\n        False, False, False, False, False, False, False, False, False, False, False, False)\n    ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"Class\").Subtotals = Array( _\n        False, False, False, False, False, False, False, False, False, False, False, False)\n    With ActiveSheet.PivotTables(\"PivotTable4\").PivotFields(\"GL\")\n        .PivotItems(\"(blank)\").Visible = False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1457500777, "post_id": 35883252, "comment_id": 59429490, "body": "I&#39;m betting that <code>productInfoContainter</code> is a typo."}, {"owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "edited": false, "score": 0, "creation_date": 1457513805, "post_id": 35883252, "comment_id": 59435401, "body": "Is the first few lines the simplified version of the code. As i do not see you opening the website? or setting doc.navigate and i see that you are calling the code from excel based on your tags. Have you set the references to use the Internet Controls?"}], "answers": [{"tags": [], "owner": {"reputation": 882, "user_id": 3513596, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/ac0999854e485f17e883bb7fce7ea8b4?s=128&d=identicon&r=PG&f=1", "display_name": "izzymo", "link": "https://stackoverflow.com/users/3513596/izzymo"}, "is_accepted": false, "score": 0, "last_activity_date": 1457513973, "creation_date": 1457513973, "answer_id": 35887030, "question_id": 35883252, "link": "https://stackoverflow.com/questions/35883252/would-like-to-extract-text-from-a-website-with-excel-vba/35887030#35887030", "title": "Would like to extract text from a website with excel vba", "body": "<p>The code I would expect is something like this</p>\n\n<pre><code>Sub WebNavigate()\n    Set objIE = CreateObject(\"InternetExplorer.Application\")\n    WebSite = \"www.YourWebsite.com/Links\"\n    With objIE\n        .Visible = True\n        .navigate WebSite\n        Do While .Busy Or .readyState &lt;&gt; 4\n            DoEvents\n        Loop\n\n        Set Element = .document.getElementById(\"productInfoContainter\")\n        Sheet1.Cells(i, 8) = Element.innertext\n        End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6037596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d0608069d7e9fe111c72d8ca9b5464e?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Yao", "link": "https://stackoverflow.com/users/6037596/jay-yao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2393, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457513973, "creation_date": 1457499656, "question_id": 35883252, "link": "https://stackoverflow.com/questions/35883252/would-like-to-extract-text-from-a-website-with-excel-vba", "title": "Would like to extract text from a website with excel vba", "body": "<p>i current have the following code which is not working giving me a object variable or with block variable not set.</p>\n\n<pre><code>Set doc = IE.document\nDim sDD4 As String\nsDD4 = Trim(doc.getElementById(\"productInfoContainter\").getElementsByTagName(\"span\")(0).innerText)\nSheet1.Cells(i, 8) = sDD4\n</code></pre>\n\n<p>the html im trying to extract from looks like this:</p>\n\n<pre><code>&lt;div id=\"productInfoContainter\" style=\"display: block;\"&gt;\n&lt;table width=\"100%\" style=\"display: none;\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"&gt;\n    &lt;tbody&gt;\n        &lt;tr&gt;\n            &lt;td valign=\"top\"&gt;\n                &lt;div style=\"margin: 5px;\"&gt; \n                    &lt;span class=\"notranslate\" onmouseover=\"_tipon(this)\" onmouseout=\"_tipoff()\"&gt;\n                        &lt;span class=\"google-src-text\" style=\"text-align: left; direction: ltr;\"&gt;\n                            &lt;b&gt;text i need 1&lt;/b&gt;\n                        &lt;/span&gt; \n                            &lt;b&gt;text i need 2&lt;/b&gt;\n                    &lt;/span&gt; \n                &lt;/div&gt;\n            &lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td valign=\"top\"&gt;\n                &lt;div style=\"margin: 10px 10px 20px;\" itemprop=\"description\"&gt;&lt;/div&gt;\n            &lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>i have also tried getElementbyClassName(\"google-src-text\")(0).innerText</p>\n\n<p>comes up with the same error.</p>\n\n<p>basically i am trying to translate a website in google translate the take out a body of the translated text</p>\n\n<p>any help appreciated</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457506178, "post_id": 35883073, "comment_id": 59431577, "body": "Screenshots of your input and expected output would help here."}, {"owner": {"reputation": 3, "user_id": 6037296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf30c2e36fae7347671482a678940593?s=128&d=identicon&r=PG&f=1", "display_name": "S.A", "link": "https://stackoverflow.com/users/6037296/s-a"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457534810, "post_id": 35883073, "comment_id": 59450097, "body": "I added the screenshot to the post. Thanks in advance!"}, {"owner": {"reputation": 3, "user_id": 6037296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf30c2e36fae7347671482a678940593?s=128&d=identicon&r=PG&f=1", "display_name": "S.A", "link": "https://stackoverflow.com/users/6037296/s-a"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457554725, "post_id": 35883073, "comment_id": 59463870, "body": "Acknowledged. First time using stack overflow to post the question. Wasn&#39;t aware of that. It is now acknowledged!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1457554888, "post_id": 35883073, "comment_id": 59463974, "body": "Two points: 1) posting sample data as a screen shot alone is not useful - do you expect people to type it out? 2) what have <i>you</i> done to solve this?  Simply dumping your requirements on SO and asking people to do your work is not what SO is for"}, {"owner": {"reputation": 3, "user_id": 6037296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf30c2e36fae7347671482a678940593?s=128&d=identicon&r=PG&f=1", "display_name": "S.A", "link": "https://stackoverflow.com/users/6037296/s-a"}, "edited": false, "score": 0, "creation_date": 1457555360, "post_id": 35883073, "comment_id": 59464262, "body": "I said: Any input as in any guidance would be appreciated I don&#39;t expect the whole code to be solved."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6037296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf30c2e36fae7347671482a678940593?s=128&d=identicon&r=PG&f=1", "display_name": "S.A", "link": "https://stackoverflow.com/users/6037296/s-a"}, "edited": false, "score": 0, "creation_date": 1457567851, "post_id": 35904334, "comment_id": 59470412, "body": "Thank you so much Tim! It worked like a charm. I really needed to understand the logic. I have never written a macro nor have I ever coded and this project fell into my lap. And thank you for writing it in a way that I could really understand what is going on in the code! I really appreciate it! Thank you!!!!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1457564065, "creation_date": 1457564065, "answer_id": 35904334, "question_id": 35883073, "link": "https://stackoverflow.com/questions/35883073/splitting-text-with-semi-colons-in-two-columns-and-one-to-one-mapping-with-corre/35904334#35904334", "title": "Splitting text with semi colons in two columns and one to one mapping with corresponding data duplicated", "body": "<p>Try this:</p>\n\n<pre><code>Sub Reformat()\n    Dim rwIn As Range, rwOut As Range\n    Dim arrLoc, arrDt, locs, dts, i\n\n    Set rwIn = ActiveSheet.Range(\"A2:E2\")\n    Set rwOut = ActiveSheet.Range(\"G2:K2\")\n\n    Do While Application.CountA(rwIn) &gt; 0\n        locs = rwIn.Cells(2).Value\n        dts = rwIn.Cells(4).Value\n\n        If Len(locs) &gt; 0 And Len(dts) &gt; 0 Then\n            arrLoc = Split(locs, \";\")\n            arrDt = Split(dts, \";\")\n            For i = LBound(arrLoc) To UBound(arrLoc)\n                With rwOut\n                    .Cells(1) = rwIn.Cells(1)\n                    .Cells(2) = arrLoc(i)\n                    .Cells(3) = rwIn.Cells(3)\n                    If i &lt;= UBound(arrDt) Then\n                        .Cells(4) = arrDt(i)\n                    End If\n                    .Cells(5) = rwIn.Cells(5)\n                End With\n                Set rwOut = rwOut.Offset(1, 0)\n            Next i\n        End If\n        Set rwIn = rwIn.Offset(1, 0)\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6037296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf30c2e36fae7347671482a678940593?s=128&d=identicon&r=PG&f=1", "display_name": "S.A", "link": "https://stackoverflow.com/users/6037296/s-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 35904334, "answer_count": 1, "score": -1, "last_activity_date": 1462519426, "creation_date": 1457498696, "last_edit_date": 1531164843, "question_id": 35883073, "link": "https://stackoverflow.com/questions/35883073/splitting-text-with-semi-colons-in-two-columns-and-one-to-one-mapping-with-corre", "title": "Splitting text with semi colons in two columns and one to one mapping with corresponding data duplicated", "body": "<p>I need help on tweaking the code below. The screenshot is listed below the code labeled 'Screenshot'. It is a sample format of a similar data I am trying to separate. I have 3000+ rows of data in this format. The code below is able to split one column and duplicate the data but now I have to do a one to one mapping with the location and dates as well as duplicate all the corresponding data. Any input would be really appreciated. </p>\n\n<p>I want the data to not only split at the semi colons into separate rows but to also map the dates with each corresponding location and to duplicate the data next to them.</p>\n\n<p>This is the code that I had been using on one particular column. Thanks in advance! Source of the code is from a post on stack overflow: A very useful code. <a href=\"https://stackoverflow.com/questions/16546311/scripting-in-excel-insert-new-row-based-on-comma-separated-list/16546973#16546973\">Scripting in Excel - Insert new row based on comma-separated list</a></p>\n\n<pre><code>Sub SplitPartsRows()\nDim rng As Range\nDim r As Long\nDim arrParts() As String\nDim partNum As Long\nDim Trail As String\n'## In my example i use columns A:E, and column D contains the Corresponding Parts ##\n\nSet rng = Range(\"A1:BI13876\") '## Modify as needed ##'\n\nr = 2\n\nDo While r &lt;= rng.Rows.Count\n    '## Split the value in column BB (54) by commas, store in array ##\n    arrParts = Split(rng(r, 17).Value, \";\")\n    '## If there's more than one item in the array, add new lines ##\n    If UBound(arrParts) &gt;= 1 Then '## corrected this logic for base 0 array\n        rng(r, 17).Value = arrParts(0)\n\n        '## Iterate over the items in the array ##\n        For partNum = 1 To UBound(arrParts)\n            '## Insert a new row ##'\n            '## increment the row counter variable ##\n            r = r + 1\n            rng.Rows(r).Insert Shift:=xlDown\n\n            '## Copy the row above ##'\n            rng.Rows(r).Value = rng.Rows(r - 1).Value\n\n            '## update the part number in the new row ##'\n            rng(r, 17).Value = Trim(arrParts(partNum))\n\n            '## resize our range variable as needed ##\n            Set rng = rng.Resize(rng.Rows.Count + 1, rng.Columns.Count)\n\n        Next\n\n    End If\n'## increment the row counter variable ##\nr = r + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/EHar6.jpg\" rel=\"nofollow noreferrer\">Screenshot</a></p>\n"}, {"tags": ["excel", "ms-office", "vba"], "comments": [{"owner": {"reputation": 2682, "user_id": 4072843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tKkUM.jpg?s=128&g=1", "display_name": "Castaglia", "link": "https://stackoverflow.com/users/4072843/castaglia"}, "edited": false, "score": 0, "creation_date": 1457498440, "post_id": 35882952, "comment_id": 59428692, "body": "Welcome to StackOverflow!  You will find that it works best if you show, in your question, at least one approach/formulate you&#39;ve tried, and maybe how it didn&#39;t work.  That way, we can help point you in the right direction, if not answer the question directly."}, {"owner": {"reputation": 2121, "user_id": 1707924, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3db6eccbb391183f60c4060dcdc7c074?s=128&d=identicon&r=PG", "display_name": "Isham Mohamed", "link": "https://stackoverflow.com/users/1707924/isham-mohamed"}, "reply_to_user": {"reputation": 2682, "user_id": 4072843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tKkUM.jpg?s=128&g=1", "display_name": "Castaglia", "link": "https://stackoverflow.com/users/4072843/castaglia"}, "edited": false, "score": 0, "creation_date": 1457671347, "post_id": 35882952, "comment_id": 59522010, "body": "I agree with @Castaglia please try something and show us what you have done."}, {"owner": {"reputation": 44235, "user_id": 1124287, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rgSLN.jpg?s=128&g=1", "display_name": "barry houdini", "link": "https://stackoverflow.com/users/1124287/barry-houdini"}, "edited": false, "score": 0, "creation_date": 1512391578, "post_id": 35882952, "comment_id": 82224945, "body": "What should the result be if given date is Friday or Saturday?"}], "answers": [{"tags": [], "owner": {"reputation": 1865, "user_id": 4025652, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/sBr6z.jpg?s=128&g=1", "display_name": "Sixthsense", "link": "https://stackoverflow.com/users/4025652/sixthsense"}, "is_accepted": false, "score": 0, "last_activity_date": 1457498560, "creation_date": 1457498560, "answer_id": 35883042, "question_id": 35882952, "link": "https://stackoverflow.com/questions/35882952/how-to-get-the-last-working-day-of-the-week-for-any-given-date/35883042#35883042", "title": "How to get the Last working day of the Week for any Given date", "body": "<p><strong>In A1 Cell</strong></p>\n\n<p>01-03-2016</p>\n\n<p><strong>In B1 Cell</strong></p>\n\n<p>=A1-WEEKDAY(A1,3)+IF(WEEKDAY(A1,3)>4,11,4)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9050143, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/e27a785db710a71575e84b7fa259a097?s=128&d=identicon&r=PG", "display_name": "Muslim", "link": "https://stackoverflow.com/users/9050143/muslim"}, "is_accepted": false, "score": 0, "last_activity_date": 1512380431, "creation_date": 1512380431, "answer_id": 47630379, "question_id": 35882952, "link": "https://stackoverflow.com/questions/35882952/how-to-get-the-last-working-day-of-the-week-for-any-given-date/47630379#47630379", "title": "How to get the Last working day of the Week for any Given date", "body": "<p>A1 Cell = Your date (you need last working day in this week)</p>\n\n<p>B1 Cell = A1+(6-WEEKDAY(A1))   - result (in case that friday is last working date)</p>\n\n<p>NOTICE: B1 must be formated as date!</p>\n"}], "owner": {"reputation": 1, "user_id": 6037550, "user_type": "registered", "profile_image": "https://graph.facebook.com/991599684227104/picture?type=large", "display_name": "Pau Li", "link": "https://stackoverflow.com/users/6037550/pau-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1973, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1512380431, "creation_date": 1457498040, "last_edit_date": 1531161705, "question_id": 35882952, "link": "https://stackoverflow.com/questions/35882952/how-to-get-the-last-working-day-of-the-week-for-any-given-date", "title": "How to get the Last working day of the Week for any Given date", "body": "<p>I need to calculate Last working day of the Week (Friday) for any date which is given in the excel sheet... Example:: if my date is given as 09-March-2016 the last working day would be 11-March-2016, similarly if my date in Excel cell is 01-March-2016 the Last working day would be 04-March-2016, Can Any one help me with the formula so that I can work further pleaseeeeeeeee... really need your help team :) </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1457641016, "post_id": 35882845, "comment_id": 59511163, "body": "It happens pretty quick, so I can read the entire box, however, a box pops up and says &quot;Now outputting...&quot; in the middle it starts to list what looks like a file name. Then almost immediately the &quot;Microsoft Office Access has stopped working box&quot; pops up and Access shuts down."}, {"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1457641534, "post_id": 35882845, "comment_id": 59511467, "body": "I do have some code in Detail_Format that runs when I open the Print Preview. I&#39;ll add that code to the question above."}, {"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1457641857, "post_id": 35882845, "comment_id": 59511657, "body": "When I use the debugger on the formatting code, I notice that this check for records runs twice."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "edited": false, "score": 0, "creation_date": 1457533235, "post_id": 35887010, "comment_id": 59448886, "body": "Yes, sorry I don&#39;t think I explained well. I don&#39;t want a loop, however, this code keeps crashing Access. I was wondering if I inadvertently created a loop."}, {"owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "edited": false, "score": 0, "creation_date": 1457533627, "post_id": 35887010, "comment_id": 59449192, "body": "I think your suggestion may miss a part of my objective with this code. I am trying to accommodate three contingencies: 1)if the file does not exist I would like to immediately save my PDF. 2)If the file already exists and I choose &quot;No&quot; to overwriting, I would like to exit the sub. 3)If the fie already exists and I choose &quot;Yes&quot; to overwriting, I would like to overwrite the existing file."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "edited": false, "score": 0, "creation_date": 1457535334, "post_id": 35887010, "comment_id": 59450519, "body": "You should be able to figure that out. However, see edit."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1457535332, "last_edit_date": 1457535332, "creation_date": 1457513907, "answer_id": 35887010, "question_id": 35882845, "link": "https://stackoverflow.com/questions/35882845/have-i-created-a-loop-in-a-nested-if-statement/35887010#35887010", "title": "Have I created a loop in a nested If statement?", "body": "<p>You don't need a loop:</p>\n\n<pre><code>strFileName = Me.[QuoteNumber]\nIf Len(Dir(\"C:\\Users\\A\\Desktop\\Safe\\Development\\Qutoes\\Test Quotes\\\" &amp; strFileName &amp; \".pdf\")) = 0 Then\n    Response = vbYes\nElse\n    Response = MsgBox(\"That file already exists! Should I continue?\", vbQuestion + vbYesNo, \"File Exists!\")\nEnd If\n\nIf Response = vbYes Then\n    strWhere = \"[ID] = \" &amp; Me.[ID]\n    Debug.Print \"Quote ID: \" &amp; strWhere\n    DoCmd.OpenReport \"QuotesReport\", acViewPreview, , strWhere\n    DoCmd.OutputTo acOutputReport, \"\", acFormatPDF, \"C:\\Users\\A\\Desktop\\Safe\\Development\\Qutoes\\Test Quotes\\\" &amp; strFileName &amp; \".pdf\"\n    DoCmd.Close acReport, \"QuotesReport\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 5162824, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/899a22387ed284615a96d8c51d77e186?s=128&d=identicon&r=PG&f=1", "display_name": "Hawsidog", "link": "https://stackoverflow.com/users/5162824/hawsidog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594642579, "creation_date": 1457497347, "last_edit_date": 1594642579, "question_id": 35882845, "link": "https://stackoverflow.com/questions/35882845/have-i-created-a-loop-in-a-nested-if-statement", "title": "Have I created a loop in a nested If statement?", "body": "<p>I wrote this code to check for an existing file and save a PDF of the report if there was not an existing file or if I choose to write over that file. I don't think I wrote the nested if correctly and I think that I may have created a loop. The code crashes on the DoCmd.Close line, however, I can't figure out what needs to change. The report I am opening should be a report of one record from my database. Something about the DoCmd.Close line seems to be causing the report to try and open all of the records. Using GoTo is probably not correct either.</p>\n\n<p>Thank you for taking a look.</p>\n\n<pre><code>strFileName = Me.[QuoteNumber]\nIf Len(Dir(\"C:\\Users\\A\\Desktop\\Safe\\Development\\Qutoes\\Test Quotes\\\" &amp; strFileName &amp; \".pdf\")) &gt; 0 Then\n    Response = MsgBox(\"That file already exists! Should I continue?\", vbYesNo, \"File Exists!\")\n    If Response = vbNo Then\n        Exit Sub\n    Else\n        GoTo Continue1\n    End If\n\nElse\nContinue1:\n    strWhere = \"[ID] = \" &amp; Me.[ID]\n    Debug.Print \"Quote ID: \" &amp; strWhere\n    DoCmd.OpenReport \"QuotesReport\", acViewPreview, , strWhere\n    DoCmd.OutputTo acOutputReport, \"\", acFormatPDF, \"C:\\Users\\A\\Desktop\\Safe\\Development\\Qutoes\\Test Quotes\\\" &amp; strFileName &amp; \".pdf\"\n    DoCmd.Close acReport, \"QuotesReport\"\nEnd If\n</code></pre>\n\n<p>This code runs on the Formatting of the report. I have four similar checks. I wonder if this is not efficient and contributes to crashing??</p>\n\n<pre><code>'See if the optional section has items, if not set height to 0\nDim optionalSQL As String\nDim optionalDB As DAO.Database\nDim optionalRS As DAO.Recordset\n\noptionalSQL = \"SELECT Top 1 OptionalItems.ID FROM OptionalItems LEFT JOIN     Quotes On OptionalItems.quoteID = Quotes.ID WHERE Quotes.QuoteNumber = \" &amp; \"'\" &amp;      Me.[reportQuoteNumber] &amp; \"'\"\n\n\nSet optionalDB = CurrentDb\nSet optionalRS = optionalDB.OpenRecordset(optionalSQL)\n\nDebug.Print \"Optional record count: \" &amp; optionalRS.RecordCount\n\nIf optionalRS.RecordCount = 0 Then\n\n    Me!OptionalItems_subreport.Height = 0\n\nElse\n\nEnd If\n\noptionalRS.Close\nSet optionalRS = Nothing\nSet optionalDB = Nothing\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1457489238, "post_id": 35881525, "comment_id": 59426223, "body": "Instead of <code>Range(&quot;pricelist&quot;)</code>  just use <code>pricelist</code> by itself no quotes. It is a range."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457502122, "post_id": 35881525, "comment_id": 59429985, "body": "Also add <code>False</code> as a final argument to <code>VLookup()</code> if you need exact matches."}, {"owner": {"reputation": 21, "user_id": 6037179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac972643ee6a7b0894a2128b1c61dd4d?s=128&d=identicon&r=PG&f=1", "display_name": "khert87", "link": "https://stackoverflow.com/users/6037179/khert87"}, "edited": false, "score": 0, "creation_date": 1457545463, "post_id": 35881525, "comment_id": 59458147, "body": "That worked.  Thanks"}], "owner": {"reputation": 21, "user_id": 6037179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac972643ee6a7b0894a2128b1c61dd4d?s=128&d=identicon&r=PG&f=1", "display_name": "khert87", "link": "https://stackoverflow.com/users/6037179/khert87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1457511080, "creation_date": 1457488483, "last_edit_date": 1457511080, "question_id": 35881525, "link": "https://stackoverflow.com/questions/35881525/method-range-of-object-global-failed-error-when-using-vlookup", "title": "Method &#39;Range&#39; of object &#39;_Global&#39; failed error when using vlookup", "body": "<p>So I am new to VBA and just starting to learn.  I am practicing using a Vlookup function and am getting the \"Method 'Range' of object '_Global' failed error.\"</p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Sub findprice()\n    Dim partnumber As Variant\n    Dim price As Integer\n    Dim pricelist As Range\n    Set pricelist = ActiveSheet.Range(\"a12:b21\")\n    partnumber = InputBox(\"enter part number\")\n    price = WorksheetFunction.VLookup(partnumber, Range(\"pricelist\"), 2)\n    MsgBox price\nEnd Sub\n</code></pre>\n\n<p>Can anyone help me to understand why I am getting this error and how to fix it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1457484124, "post_id": 35880752, "comment_id": 59424852, "body": "I put that string in and it&#39;s not a problem here.  Have you been editing that module a lot?"}, {"owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "reply_to_user": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1457485476, "post_id": 35880752, "comment_id": 59425237, "body": "might be some kind of invisible character that didn&#39;t post on this site when I setup this thread."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1457499635, "post_id": 35880752, "comment_id": 59429043, "body": "always possible.  I don&#39;t know what the white space conspiracy holds, but there&#39;s something behind the scenes."}], "answers": [{"tags": [], "owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "is_accepted": false, "score": 1, "last_activity_date": 1457499696, "last_edit_date": 1457499696, "creation_date": 1457484398, "answer_id": 35880909, "question_id": 35880752, "link": "https://stackoverflow.com/questions/35880752/text-being-entered-not-where-cursor-is-in-vba-project-window/35880909#35880909", "title": "Text being entered not where cursor is, in VBA Project window", "body": "<p>Sometimes working in (editing) modules can cause wackiness.  I have found that macros can sometimes hang without throwing an error, and other such strangeness.  In these cases I usually copy the contents of the module into another module (removing leading and trailing white space) and delete the old module.  Then I save, close, re-open.  This isn't a silver bullet, but it has definitely solved some odd behavior for me in that past.  You may also recognize that your workbook shrinks by a few kilobytes, this is pretty normal.</p>\n"}], "owner": {"reputation": 641, "user_id": 3931725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/612340301/picture?type=large", "display_name": "Johnson Jason", "link": "https://stackoverflow.com/users/3931725/johnson-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457499696, "creation_date": 1457483456, "last_edit_date": 1531164843, "question_id": 35880752, "link": "https://stackoverflow.com/questions/35880752/text-being-entered-not-where-cursor-is-in-vba-project-window", "title": "Text being entered not where cursor is, in VBA Project window", "body": "<p>I have this string:</p>\n\n<pre><code>Admin_List = \"`{&amp;\"\n</code></pre>\n\n<p>For whatever reason my cursor in VBA project window is bonker when trying to work with this string. If I try to add a comma after the <code>{</code> it lands after the <code>&amp;</code> </p>\n\n<p>Any idea what is causing this wacky behavior?\nThank you :)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 4, "creation_date": 1457480973, "post_id": 35880319, "comment_id": 59423817, "body": "Is this in a workbook module, or worksheet module? It works for me if I place in a Workbook module."}, {"owner": {"reputation": 142786, "user_id": 42346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZikEw.jpg?s=128&g=1", "display_name": "mechanical_meat", "link": "https://stackoverflow.com/users/42346/mechanical-meat"}, "edited": false, "score": 1, "creation_date": 1457481044, "post_id": 35880319, "comment_id": 59423836, "body": "I think this is a duplicate of: <a href=\"http://stackoverflow.com/questions/12351339/cant-use-vba-functions-in-a-spreadsheet-formula-in-excel-2010\" title=\"cant use vba functions in a spreadsheet formula in excel 2010\">stackoverflow.com/questions/12351339/&hellip;</a>"}, {"owner": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "edited": false, "score": 1, "creation_date": 1457481107, "post_id": 35880319, "comment_id": 59423864, "body": "Sorry, what is the difference between the two? I just inserted a module by right clicking on the project and creating a new module."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1457481132, "post_id": 35880319, "comment_id": 59423873, "body": "worksheet UDFs should be created in a standard code module <b>in the same workbook</b>. Failing that, try giving your UDF an explicit return data type"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457481149, "post_id": 35880319, "comment_id": 59423880, "body": "That is where it should be.  It should be in a module attached to the workbook in which it is being called."}, {"owner": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "edited": false, "score": 0, "creation_date": 1457481304, "post_id": 35880319, "comment_id": 59423953, "body": "I can confirm that the module is in the same workbook as it is the only one open. Note: the function shows up when I type =, but just won&#39;t compile"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457481790, "post_id": 35880319, "comment_id": 59424124, "body": "Does it highlight a specific line when you debug?"}, {"owner": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "edited": false, "score": 0, "creation_date": 1457481840, "post_id": 35880319, "comment_id": 59424137, "body": "I gave it a return datatype of Integer and didn&#39;t help. It&#39;s highlighting the first line of code. This code has worked before, so I don&#39;t think it has to do with coding."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457481868, "post_id": 35880319, "comment_id": 59424147, "body": "Is the workbook/worksheet protected in any way?  Try closing Excel completely, and open a new workbook and add this macro. Does it work then?"}, {"owner": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "edited": false, "score": 0, "creation_date": 1457482172, "post_id": 35880319, "comment_id": 59424248, "body": "Doesn&#39;t work if I open a new workbook. It&#39;s strange because I have gotten this code to work before. It might have to do with permissions or whatnot though."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457482198, "post_id": 35880319, "comment_id": 59424256, "body": "Are your macros enabled?"}, {"owner": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "edited": false, "score": 0, "creation_date": 1457482433, "post_id": 35880319, "comment_id": 59424326, "body": "Other macros run fine, just not this function"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457486876, "post_id": 35880319, "comment_id": 59425589, "body": "Exactly where are you typing <code>=CountColor(A1, A2)</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "edited": false, "score": 0, "creation_date": 1457541643, "post_id": 35885638, "comment_id": 59455451, "body": "I guess that APplication.volatile did the trick? Not sure, but once I added that, the error stopped being produced. Thanks!"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "edited": false, "score": 0, "creation_date": 1457554187, "post_id": 35885638, "comment_id": 59463585, "body": "@user3002486 String is the wrong data type for <code>iCol</code>.  <code>.Color</code> returns numeric, casting it to String is pointless.  Better to use <code>Long</code>"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1457509091, "creation_date": 1457509091, "answer_id": 35885638, "question_id": 35880319, "link": "https://stackoverflow.com/questions/35880319/function-error-sub-or-function-not-defined/35885638#35885638", "title": "Function: Error Sub or Function not defined", "body": "<p>I could not reproduce the error that you are experiencing.</p>\n\n<p>If you use the code as you have it, the result will not be accurate, for example:\n<code>=CountColor(A1,B1:B20)</code> will only give you a result of 1 or 0 because you are not adding the results together.</p>\n\n<p>If you are just comparing the interior colors, you don't really need to use <code>interior.colorindex</code>, just <code>interior.color</code> should work, so I changed <code>iCol as string</code></p>\n\n<p><code>else</code> is not required in your if statement.</p>\n\n<p>I also added <code>Application.volatile</code> to the code, so it will calculate when the sheet calculates.</p>\n\n<pre><code>Function CountColor(rColor As Range, rSumRange As Range)\n    Dim rCell As Range\n    Dim iCol As String\n    Dim vResult As Integer\n\n    iCol = rColor.Interior.Color\n    Application.Volatile\n\n    For Each rCell In rSumRange\n        If rCell.Interior.Color = iCol Then\n            vResult = 1 + vResult\n            '        Else\n            '            vResult = 0\n        End If\n    Next rCell\n\n    CountColor = vResult\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 3002486, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/bdb350a48bd09bbd75d306e4c8f7dede?s=128&d=identicon&r=PG&f=1", "display_name": "user3002486", "link": "https://stackoverflow.com/users/3002486/user3002486"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 1, "accepted_answer_id": 35885638, "answer_count": 1, "score": 0, "last_activity_date": 1457509091, "creation_date": 1457480861, "last_edit_date": 1457486560, "question_id": 35880319, "link": "https://stackoverflow.com/questions/35880319/function-error-sub-or-function-not-defined", "title": "Function: Error Sub or Function not defined", "body": "<pre><code>Function CountColor(rColor As Range, rSumRange As Range)\n    Dim rCell As Range\n    Dim iCol As Integer\n    Dim vResult As Integer\n    iCol = rColor.Interior.ColorIndex\n\n    For Each rCell In rSumRange\n        If rCell.Interior.ColorIndex = iCol Then\n            vResult = 1\n        Else \n            vResult =  0\n        End If\n    Next rCell\u00a0\n    CountColor = vResult\nEnd Function\n</code></pre>\n\n<p>I try typing <strong><code>\"=CountColor(A1, A2)\"</code></strong> but I always get the error <code>\"Sub or function not defined\"</code> Why is this? I've been stuck on this for hours. </p>\n"}, {"tags": ["vba", "outlook", "hyperlink", "outlook-2010"], "comments": [{"owner": {"reputation": 59, "user_id": 5847773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/882c4b60b5539b38bd6313f59a86622c?s=128&d=identicon&r=PG&f=1", "display_name": "broncos15", "link": "https://stackoverflow.com/users/5847773/broncos15"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1457540962, "post_id": 35880099, "comment_id": 59454944, "body": "Sorry I forgot to hit accept. Thanks again for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 2, "last_activity_date": 1457496707, "creation_date": 1457496707, "answer_id": 35882736, "question_id": 35880099, "link": "https://stackoverflow.com/questions/35880099/insert-hyperlink-in-outlook-body/35882736#35882736", "title": "Insert Hyperlink in Outlook body", "body": "<p>Set your references to Word object Library </p>\n\n<p><strong><em><code>Tools &gt; References &gt; add Word object Library</code></em></strong></p>\n\n<pre><code>Option Explicit\nSub Add_Hyperlinks()\n    Dim olNameSpace As Outlook.NameSpace\n    Dim wDoc As Word.Document\n    Dim rngSel As Word.Selection\n\n    If Application.ActiveInspector.EditorType = olEditorWord Then\n        Set wDoc = Application.ActiveInspector.WordEditor ' use WordEditor\n        Set olNameSpace = Application.Session\n        Set rngSel = wDoc.Windows(1).Selection ' Current selection\n\n        wDoc.Hyperlinks.Add rngSel.Range, _\n        Address:=\"U:\\plot.log\", TextToDisplay:=\"Here is the link\"\n    End If\n\n    Set wDoc = Nothing\n    Set olNameSpace = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1457549602, "post_id": 35895072, "comment_id": 59460798, "body": "I don&#39;t think you need Error trapping - also see <a href=\"https://msdn.microsoft.com/en-us/library/y9341s4f.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">option explicit</a>"}], "tags": [], "owner": {"reputation": 59, "user_id": 5847773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/882c4b60b5539b38bd6313f59a86622c?s=128&d=identicon&r=PG&f=1", "display_name": "broncos15", "link": "https://stackoverflow.com/users/5847773/broncos15"}, "is_accepted": false, "score": 1, "last_activity_date": 1457549501, "last_edit_date": 1457549501, "creation_date": 1457535512, "answer_id": 35895072, "question_id": 35880099, "link": "https://stackoverflow.com/questions/35880099/insert-hyperlink-in-outlook-body/35895072#35895072", "title": "Insert Hyperlink in Outlook body", "body": "<p>Thank you so much for the help, I really appreciate it! So I made a slight variation to your code to try and get it to paste whatever is on the clipboard. </p>\n\n<p>My new code is as follows. Do I need to add in any error trapping? Also, what does the option explicit exactly do?</p>\n\n<pre><code>Option Explicit\nSub Add_Hyperlinks()\n   Dim olNameSpace As Outlook.NameSpace\n   Dim wDoc As Word.Document\n   Dim rngSel As Word.Selection\n   Dim DataObj As MSForms.DataObject\n   Set DataObj = New MSForms.DataObject\n   DataObj.GetFromClipboard\nIf Application.ActiveInspector.EditorType = olEditorWord Then\n    Set wDoc = Application.ActiveInspector.WordEditor ' use WordEditor\n    Set olNameSpace = Application.Session\n    Set rngSel = wDoc.Windows(1).Selection ' Current selection\n    wDoc.Hyperlinks.Add rngSel.Range, _\n    Address:=DataObj.GetText(1), TextToDisplay:=\"here\"\nEnd If\nSet wDoc = Nothing\nSet olNameSpace = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 5847773, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/882c4b60b5539b38bd6313f59a86622c?s=128&d=identicon&r=PG&f=1", "display_name": "broncos15", "link": "https://stackoverflow.com/users/5847773/broncos15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3886, "favorite_count": 0, "accepted_answer_id": 35882736, "answer_count": 2, "score": 1, "last_activity_date": 1600226739, "creation_date": 1457479695, "last_edit_date": 1592872870, "question_id": 35880099, "link": "https://stackoverflow.com/questions/35880099/insert-hyperlink-in-outlook-body", "title": "Insert Hyperlink in Outlook body", "body": "<p>So I am trying to create a code to expedite inserting a hyperlink in Outlook. </p>\n\n<p>I am trying to have it so that if I have already copied a path, I can just go in and type Ctrl W and it will insert the hyperlink for the word here. My attempt at the code is:</p>\n\n<pre><code>Sub InsertHyperlink()\n'\n'\n'\nOn Error Resume Next\nActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:= _\n    \"U:\\plot.log\", _\n    SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:=\"here\"\nEnd Sub\n</code></pre>\n\n<p>I am having issues on how to update my code so that will work in Outlook (I programmed it in Word) and so that the \"U:\\plot.log\" would actually be the copied path (not the copied path when I recorded the macro). </p>\n\n<p>Does anyone have any suggestions?</p>\n"}, {"tags": ["excel", "oracle", "vba"], "comments": [{"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 1, "creation_date": 1457480340, "post_id": 35879899, "comment_id": 59423590, "body": "You&#39;ll probably have to update the connection string on the querytable to include the password, refresh, and then remove the password from the connection string.  Brief research showed that when the password is entered, it is saved in the connection string so that you won&#39;t have to enter it in later."}, {"owner": {"reputation": 408, "user_id": 5517926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cb3f11c5ab7130fa6bca33a0747118?s=128&d=identicon&r=PG", "display_name": "Kris B", "link": "https://stackoverflow.com/users/5517926/kris-b"}, "edited": false, "score": 1, "creation_date": 1457480966, "post_id": 35879899, "comment_id": 59423814, "body": "Apparently if you recreate the database connection, there is a small box to &#39;remember the password&#39;. Some other people discuss it on this here: <a href=\"http://visualbasic.ittoolbox.com/groups/technical-functional/vb-vba-l/using-ms-excel-to-run-a-query-vba-to-enter-password-2301150\" rel=\"nofollow noreferrer\">visualbasic.ittoolbox.com/groups/technical-functional/vb-vba&zwnj;&#8203;-l/&hellip;</a> You can also edit the connection string (which should be saved externally), to include the password. It&#39;s usually recommended to have a &#39;read-only&#39; user for the database, to use in applications like these. That way if someone takes/cracks the password, its no big deal."}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "edited": false, "score": 0, "creation_date": 1457488374, "post_id": 35879899, "comment_id": 59426001, "body": "I&#39;m familiar with the checkbox.  Was hoping to find a way that would allow me to distribute the sheet to a few people without giving out my password.   I only have read access so I&#39;m not sure what harm would come from them having my password,  but still,  I would prefer to keep it secure. I didn&#39;t think about VBA to rewrite the connection strong each time.   Kind of easy to &quot;hack&quot;, but in the application I intend,  I highly doubt anyone would be trying.   I&#39;ll have to test it when I have a chance to see if it can be done that way.   Thanks"}, {"owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "edited": false, "score": 0, "creation_date": 1457533517, "post_id": 35879899, "comment_id": 59449100, "body": "I checked and it does appear that I can use VBA code to update.  I appreciate the help.   If either of you care to post it as an &quot;answer&quot;,  I would gladly accept it so you can get credit for the answer and the question would not sit as &quot;unanswered&quot; when you have, in fact, already answered the question."}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "is_accepted": true, "score": -1, "last_activity_date": 1458145833, "creation_date": 1458145833, "answer_id": 36041563, "question_id": 35879899, "link": "https://stackoverflow.com/questions/35879899/can-i-use-vba-to-pass-a-password-to-an-external-database-connection-in-excel/36041563#36041563", "title": "Can I use VBA to &quot;pass&quot; a password to an external database connection in Excel?", "body": "<p>The answer was indeed to update the connection string in VBA, as suggested by OpiesDad and KrisB.   </p>\n"}], "owner": {"reputation": 183, "user_id": 5573687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41f5bf563be73c33e4352abcc722dc91?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/5573687/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1484, "favorite_count": 0, "accepted_answer_id": 36041563, "answer_count": 1, "score": 0, "last_activity_date": 1458145833, "creation_date": 1457478710, "question_id": 35879899, "link": "https://stackoverflow.com/questions/35879899/can-i-use-vba-to-pass-a-password-to-an-external-database-connection-in-excel", "title": "Can I use VBA to &quot;pass&quot; a password to an external database connection in Excel?", "body": "<p>I am trying to use VBA to hide the password for a data connection I have set up in an Excel sheet.   Since Excel stores passwords to external data sources in plain text, I wanted to have VBA call the refresh of the table and supply the password.   I recorded a macro of my refreshing the table and entering the password, but to my dismay, it seems it omitted the password part...which was the only part I needed. </p>\n\n<pre><code>Sheets(\"RAW\").Select\nRange(\"R16\").Select\nSelection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>I am unable to find any solutions to this online.  I am vaguely aware that a DB connection can be set up directly through VBA, but a) there are a lot of pivots and whatnot built off of the data table and b) I'm not sure I understand DB's enough to figure all that out.   Does anyone know if there is any way to have VBA \"pass\" the password to an external data connection?   </p>\n"}, {"tags": ["vba", "internet-explorer"], "comments": [{"owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "edited": false, "score": 0, "creation_date": 1457480346, "post_id": 35879866, "comment_id": 59423591, "body": "I am unable to get the currently selected value."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457482530, "post_id": 35879866, "comment_id": 59424367, "body": "If these select elements are somehow dependent (changing one changes the options available in the next) then you need to wait for the next one to populate, which is why it works when stepping through but not if you run the whole thing straight through."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "edited": false, "score": 0, "creation_date": 1457541453, "post_id": 35883921, "comment_id": 59455313, "body": "Awesome. Thanks for answering. This is much cleaner than what I did."}, {"owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "edited": false, "score": 0, "creation_date": 1457541533, "post_id": 35883921, "comment_id": 59455381, "body": "I found out that there was something wierd going on with my system. I rebooted and the problem went away. Strange however I closed all appications and tried again but it eventually came down to a reboot. Next time I will just reboot my system before posting."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1457502601, "creation_date": 1457502601, "answer_id": 35883921, "question_id": 35879866, "link": "https://stackoverflow.com/questions/35879866/vba-cannot-get-the-option-via-select-drop-down-to-work/35883921#35883921", "title": "VBA Cannot get the Option via select drop down to work", "body": "<p>Ignoring the timing issue for now, your code would be easier as:</p>\n\n<pre><code>If ecode &lt;&gt; \"\" Then ie.document.getElementById(\"entNo\").Value = ecode\nie.document.getElementById(\"currStatus\").Value = \"Open\"\nie.document.getElementById(\"opStatus\").Value = \"All\"\n</code></pre>\n\n<p>Since your select elements seem to have id attributes.</p>\n"}], "owner": {"reputation": 33, "user_id": 3490906, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bd4303395ad300469966f0d76c571e0c?s=128&d=identicon&r=PG&f=1", "display_name": "user3490906", "link": "https://stackoverflow.com/users/3490906/user3490906"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457502601, "creation_date": 1457478554, "last_edit_date": 1457479394, "question_id": 35879866, "link": "https://stackoverflow.com/questions/35879866/vba-cannot-get-the-option-via-select-drop-down-to-work", "title": "VBA Cannot get the Option via select drop down to work", "body": "<p>I am trying to set the value for a drop down box and it shows a blank which is not even an option. </p>\n\n<p>Here is the HTML snip-it: (NOTE: internal website so I cant give URL or too much)</p>\n\n<pre><code>&lt;select id=\"entNo\" name=\"entNo\" style=\"width:75px\"&gt;\n  &lt;option selected=\"selected\" value=\"All\"&gt;All&lt;/option&gt;\n  &lt;option value=\"650101\"&gt;650101&lt;/option&gt;\n  &lt;option value=\"66\"&gt;66&lt;/option&gt;\n</code></pre>\n\n<p>Here is the function for it.</p>\n\n<pre><code>    function requestEntities()\n  {\n      var ele = document.getElementById('entNo');\n      if (ele) {\n          ele.options.length = 0;\n          ele.options[0] = new Option('All');\n          ele.disabled = true;\n          ele = document.getElementById('divNo');\n          if (ele) {\n              var i = ele.selectedIndex;\n              var div = ele.options[i].value;\n              sendHttpRequest('http://example.com/cgi-bin/wspd_cgi.sh/WService=wslive//wpr/entityList.r?div=' + div);\n          }\n      }\n  }\n</code></pre>\n\n<p>The vba code I am using is this:</p>\n\n<pre><code>Set objCollection = ie.document.getElementsByTagName(\"select\")\n    'Debug.Print objCollection.Length\n\n    i = 1\n    While i &lt; objCollection.Length        'Loop to locate and change the fields with proper data using the \"select\" tags\n        Debug.Print objCollection(i).Value\n        If objCollection(i).Name = \"entNo\" Then\n            If ecode &lt;&gt; \"\" Then\n            Debug.Print objCollection(i).Value\n                objCollection(i).Value = ecode\n            End If\n\n        ElseIf objCollection(i).Name = \"curStatus\" Then\n            objCollection(i).Value = \"Open\"\n\n        ElseIf objCollection(i).Name = \"opStatus\" Then\n            objCollection(i).Value = \"All\"\n\n\n        End If\n            i = i + 1\n    Wend\n</code></pre>\n\n<p>I can't give more as this is for work. I have exhausted google searches.<br>\nOne other thing that is strange is that it will work when I single step. It just will not work otherwise. \nAny suggestions would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457478063, "post_id": 35879725, "comment_id": 59422755, "body": "What are you  trying to do? You just want the Default stuff to go in the &quot;D&quot; column, everything else the same?"}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457478280, "post_id": 35879725, "comment_id": 59422849, "body": "If I was to explain it in the simplest way I can it would be. C1 has text and replicates the text into C7:C999 if those fields are empty. I need to replicate the same result but use D1 for the reference cell and replicate it to E7:E999. Essentially creating another different placeholder, while leaving the other intact."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457478482, "post_id": 35879725, "comment_id": 59422952, "body": "Ah, okay - one more clarification, why is it a <code>Worksheet_Change</code> event? If the user changes <i>any</i> cell in range <code>E7:E999</code>, you want this to run, correct?"}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457478630, "post_id": 35879725, "comment_id": 59423008, "body": "I believe that is correct yes."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457478808, "post_id": 35879725, "comment_id": 59423071, "body": "Why don&#39;t you think your second macro is incorrect? I tried it and it worked for me. If I put &quot;Automobile&quot; in <code>D1</code> and delete the text in any cell in the range <code>E7:E999</code>, it correctly fills that cell with &quot;Automobile&quot;.  If I type &quot;Car&quot; over the cell that has &quot;Automobile&quot;, then &quot;Car&quot; stays there. (Note: You&#39;re filling in the blanks with a formula, so if you change `D1, then the text down there will change too).  What&#39;s the macro <b>not</b> doing that you expect it to? How is it &quot;messing up&quot;?"}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457478884, "post_id": 35879725, "comment_id": 59423092, "body": "I have my code beneath the original. so I think the two are arguing. I get the result with The first, but not the second."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1457479029, "post_id": 35879725, "comment_id": 59423142, "body": "Your code has to be between <code>Private Sub Worksheet_Change(ByVal Target As Range)</code> and the <code>End Sub</code> final line for the second part of your script to fire when you make changes on the sheet. Is that how you have it? Also you declare the same variables again, this in my mind should throw an error in VBA."}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 0, "creation_date": 1457479190, "post_id": 35879725, "comment_id": 59423209, "body": "I have both code sections between the private sub and end sub. If I split the two between two private subs I get an ambiguous code error from VBA."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457479469, "post_id": 35879725, "comment_id": 59423311, "body": "Oh wait, are you trying to combine these?? Are these supposed to be two separate Worksheet_Change events (i.e. running on two separate sheets), or combined - you want Range <code>E7:E999</code> to default to the &quot;D&quot; column values, and the range <code>C7:C999,D7:D999,G7:G999</code> to default to C values??"}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 0, "creation_date": 1457479524, "post_id": 35879725, "comment_id": 59423322, "body": "Yes I think this is what I am trying to achieve as I think they are arguing. They are both on the same worksheet."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1457479601, "post_id": 35879725, "comment_id": 59423351, "body": "Hopefully final clarification: Will the range <code>E7:E999</code> look to <code>E1</code> for the default value, or will <code>E7:E999</code> look a column to the left, to <code>D1</code> for the value?  Can you perhaps post a screenshot of sample data and where you expect the data to be?"}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 0, "creation_date": 1457479700, "post_id": 35879725, "comment_id": 59423382, "body": "That is correct as I am hiding these default cells from the user. So I want to tell cells E7:E999 to look at D1 for their value if empty. If a screen shot helps I&#39;ll put one up. :)"}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 0, "creation_date": 1457479950, "post_id": 35879725, "comment_id": 59423458, "body": "Hope this helps, (<a href=\"http://i.stack.imgur.com/8irbf.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/8irbf.png</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 0, "creation_date": 1457480190, "post_id": 35880136, "comment_id": 59423541, "body": "Almost there, I&#39;m having issues with C7:C999 and G7:G999 displaying correctly. C7:C999 is displaying &#39;0&#39; and G7:G999 is displaying &#39;00/01/00&#39;."}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 0, "creation_date": 1457480252, "post_id": 35880136, "comment_id": 59423562, "body": "C is looking at &gt; =$B$1 for its value and G is looking at &gt; =$F$1. I need them to look at C1 also."}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 0, "creation_date": 1457480419, "post_id": 35880136, "comment_id": 59423612, "body": "Scratch that, I just figured if the top row is hidden I can define these fields with the same text."}, {"owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 1, "creation_date": 1457480444, "post_id": 35880136, "comment_id": 59423625, "body": "Your answer is spot on, thank you for your assistance, kind sir! :)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "edited": false, "score": 1, "creation_date": 1457480641, "post_id": 35880136, "comment_id": 59423703, "body": "@Null - Happy to help!"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1457480712, "last_edit_date": 1457480712, "creation_date": 1457479849, "answer_id": 35880136, "question_id": 35879725, "link": "https://stackoverflow.com/questions/35879725/place-holder-text-excel-multiple-defaults/35880136#35880136", "title": "Place Holder Text Excel - Multiple Defaults", "body": "<p>How's this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n' I am assuming that the Ranges you want to fill with Default Values are ONE column to the RIGHT of the Default Text\n' i.e. Range `D7:D999` will look for the default value in `C1`\n\n'the formula reference\nDim defaultFormula As String\ndefaultFormula = \"=r1c\" &amp; Target.Column - 1\n\n'The default text cell:\nDim defaultText As Range\nSet defaultText = Range(\"C1\")\n\n'The cells you want to monitor:\nDim rng As Range\nSet rng = Range(\"C7:C999,D7:D999,E7:E999,G7:G999\") '## Modify as needed\n\n'Cell iterator\nDim cl As Range\n\nIf Not Intersect(Target, rng) Is Nothing Then 'If the change happened in any of the `rng` ranges\n\n    'Avoid infinite looping\n    Application.EnableEvents = False\n\n    'If the user has deleted the value in the cell, then replace it with the     formula:\n    For Each cl In Intersect(Target, rng)\n    Debug.print cl.value\n    If Trim(cl.Value) = vbNullString Then\n        cl.Formula = defaultFormula\n    End If\n    Next\n\nEnd If\n'Turn on Events:\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Since your Default Values are in row 1 of the column LEFT of your \"changing ranges\", all you basically needed to do was switch your <code>defaultFormula</code> to look there.  I used R1C1 style notation.  This way, it looks at your <code>Target.Colum</code>, being the column you changed a cell in, then looks LEFT one column (<code>- 1</code>) and up to row 1 (<code>R1</code> means \"row 1\").</p>\n\n<p>I also changed the <code>If Intersect() Is Nothing Then Exit Sub</code> just for personal preference, but you can of course leave yours.  </p>\n"}], "owner": {"reputation": 1567, "user_id": 2220339, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/puqgu.jpg?s=128&g=1", "display_name": "Beaniie", "link": "https://stackoverflow.com/users/2220339/beaniie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 35880136, "answer_count": 1, "score": 0, "last_activity_date": 1457480712, "creation_date": 1457477889, "last_edit_date": 1531161705, "question_id": 35879725, "link": "https://stackoverflow.com/questions/35879725/place-holder-text-excel-multiple-defaults", "title": "Place Holder Text Excel - Multiple Defaults", "body": "<p>A kind gentleman helped me on here before with generating some VBA code to create place holder text in excel. Now I'm not versed in such code and am not to sure how to achieve the result I am looking for. I was wondering if I could receive a little assistance.</p>\n\n<p>With his code here, I was able to achieve the effect I was looking for, however I now need to place another place holder in place for a different column with different default text.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n'the formula reference\nDim defaultFormula As String\ndefaultFormula = \"=$C$1\"\n\n'The default text cell:\nDim defaultText As Range\nSet defaultText = Range(\"C1\")\n\n'The cells you want to monitor:\nDim rng As Range\nSet rng = Range(\"C7:C999,D7:D999,G7:G999\") '## Modify as needed\n\n'Cell iterator\nDim cl As Range\n\nIf Intersect(Target, rng) Is Nothing Then Exit Sub\n\n'Avoid infinite looping\nApplication.EnableEvents = False\n\n'If the user has deleted the value in the cell, then replace it with the     formula:\nFor Each cl In Intersect(Target, rng)\nIf Trim(cl.Value) = vbNullString Then\n    cl.Formula = defaultFormula\nEnd If\nNext\n\n'Turn on Events:\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>I tried to create the same result with an alternate cell using this code here but I don't think this is the correct way. If someone could nudge me in the right direction I would be eternally grateful.</p>\n\n<p>Here's what I came up with; </p>\n\n<pre><code>'the formula reference\nDim defaultFormula1 As String\ndefaultFormula1 = \"=$D$1\"\n\n'The default text cell:\nDim defaultText1 As Range\nSet defaultText1 = Range(\"D1\")\n\n'The cells you want to monitor:\nDim rng1 As Range\nSet rng1 = Range(\"E7:E999\") '## Modify as needed\n\n'Cell iterator\nDim dl As Range\n\nIf Intersect(Target, rng1) Is Nothing Then Exit Sub\n\n'Avoid infinite looping\nApplication.EnableEvents = False\n\n'If the user has deleted the value in the cell, then replace it with the     formula:\nFor Each dl In Intersect(Target, rng1)\nIf Trim(dl.Value) = vbNullString Then\n    dl.Formula = defaultFormula1\nEnd If\nNext\n\n'Turn on Events:\nApplication.EnableEvents = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1457476361, "creation_date": 1457476361, "answer_id": 35879358, "question_id": 35879226, "link": "https://stackoverflow.com/questions/35879226/how-to-combine-data-from-different-excel-tabs-into-master-sheet-using-vba/35879358#35879358", "title": "How to combine data from different Excel tabs into master sheet using VBA", "body": "<p>Try this:</p>\n\n<pre><code>Sub CopyRanges()\nDim WB1 As Workbook\nDim WB2 As Workbook\nDim LastRow As Long\nDim sht As Worksheet\n\nSet WB1 = ActiveWorkbook\nSet WB2 = Workbooks.Open(WB1.Path &amp; \"\\Datafile.xls\")\n\nFor Each sht In WB2.Sheets\n    With sht\n        .Unprotect (\"Password1\")\n        LastRow = .Range(\"B\" &amp; .Rows.count).End(xlUp).Row\n        WB1.Sheets(\"Output\").Range(\"A\" &amp; WB1.Sheets(\"Output\").Rows.count).End(xlUp).Resize(LastRow - 5, 12).value = .Range(\"B6:M\" &amp; LastRow).value\n        .Protect (\"Password1\")\n    End With\nNext sht\nWB2.Close\nEnd Sub\n</code></pre>\n\n<p>When only wanting the values it is faster to assign the values than to copy them.</p>\n"}], "owner": {"reputation": 1, "user_id": 5999478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/146506e195366c6e1b995b090cdd5efa?s=128&d=identicon&r=PG&f=1", "display_name": "Yohanan Zekharya", "link": "https://stackoverflow.com/users/5999478/yohanan-zekharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "closed_date": 1457480305, "answer_count": 1, "score": 0, "last_activity_date": 1457476361, "creation_date": 1457475834, "question_id": 35879226, "link": "https://stackoverflow.com/questions/35879226/how-to-combine-data-from-different-excel-tabs-into-master-sheet-using-vba", "closed_reason": "Duplicate", "title": "How to combine data from different Excel tabs into master sheet using VBA", "body": "<p>I am using the below script to copy data from \"Sheet1\" of a multi-sheet Excel file into a master sheet of another Excel file. It's working perfectly for one sheet. Now I need to get it to run through all the sheets pasting the data into the next available row in the Master file. </p>\n\n<p>Please note: all the sheets use the same password.</p>\n\n<p>Please help!</p>\n\n<p>Thanks, </p>\n\n<p>Yohanan</p>\n\n<pre><code>Sub CopyRanges()\nDim WB1 As Workbook\nDim WB2 As Workbook\nDim LastRow As Long\n\nSet WB1 = ActiveWorkbook\nSet WB2 = Workbooks.Open(WB1.Path &amp; \"\\Datafile.xls\")\n\nSheets(\"Sheet1\").Unprotect (\"Password1\")\n\nWith WB2.Sheets(\"Sheet1\")\n  LastRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\nEnd With\nWB2.Sheets(\"71235\").Range(\"B6:M\" &amp; LastRow).Copy\nWB1.Sheets(\"Output\").Range(\"A2\").PasteSpecial xlPasteValues\n\nSheets(\"Sheet1\").Protect (\"FTCCTOR\")\nWB2.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "zip"], "comments": [{"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1457478117, "post_id": 35879149, "comment_id": 59422776, "body": "Do you get valid paths from ZipName and FolderName?"}, {"owner": {"reputation": 65, "user_id": 3167899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/613215337/picture?type=large", "display_name": "GerHick", "link": "https://stackoverflow.com/users/3167899/gerhick"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1457478943, "post_id": 35879149, "comment_id": 59423115, "body": "Yes. I even tried using the immediate window - <code>?zipname</code> and <code>?Foldername</code>, then pasting those values back into the code... When I paste the actual value it works, but when I use ZipName or FolderName it doesn&#39;t work..."}, {"owner": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1457480033, "post_id": 35879149, "comment_id": 59423492, "body": "So where is it getting ZipName and FolderName from? Are they in immediate window from the method that&#39;s calling this function or for this function itself? If you do a Debug.Print for each of those does it give you what you expect?"}, {"owner": {"reputation": 65, "user_id": 3167899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/613215337/picture?type=large", "display_name": "GerHick", "link": "https://stackoverflow.com/users/3167899/gerhick"}, "reply_to_user": {"reputation": 284, "user_id": 5469005, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/43a26a12f19dbd50d01b4e5ae9cf5064?s=128&d=identicon&r=PG&f=1", "display_name": "justkrys", "link": "https://stackoverflow.com/users/5469005/justkrys"}, "edited": false, "score": 0, "creation_date": 1457482068, "post_id": 35879149, "comment_id": 59424210, "body": "ZipName and FolderName are passed into the function. Doing a Debug.Print gives me what I&#39;d expect. Here&#39;s a link to a screenshot (note the actual code is a little messier than what I posted above): <a href=\"https://drive.google.com/file/d/0B-wKk1NwzzccN0R2ZGVudk5WTDA/view\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B-wKk1NwzzccN0R2ZGVudk5WTDA/view</a>"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 3167899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/613215337/picture?type=large", "display_name": "GerHick", "link": "https://stackoverflow.com/users/3167899/gerhick"}, "edited": false, "score": 0, "creation_date": 1457493898, "post_id": 35881100, "comment_id": 59427534, "body": "Thanks SO much for that! Exactly where I went wrong."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1457485532, "creation_date": 1457485532, "answer_id": 35881100, "question_id": 35879149, "link": "https://stackoverflow.com/questions/35879149/vba-copy-to-zip-file-returns-error/35881100#35881100", "title": "VBA copy to zip file returns error", "body": "<p>When using a <code>Shell.Application</code> object, you should pass all paths and filenames as Variants, not string.</p>\n\n<p>If you look at Ron's code you'll see that's what he does.</p>\n\n<p>As he says on that page:</p>\n\n<blockquote>\n  <p>Note: Do not Dim for example FileNameZip as String in the code\n  examples. This must be a Variant, if you change this the code will not\n  work.</p>\n</blockquote>\n"}], "owner": {"reputation": 65, "user_id": 3167899, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/613215337/picture?type=large", "display_name": "GerHick", "link": "https://stackoverflow.com/users/3167899/gerhick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1089, "favorite_count": 0, "accepted_answer_id": 35881100, "answer_count": 1, "score": 1, "last_activity_date": 1457485532, "creation_date": 1457475474, "question_id": 35879149, "link": "https://stackoverflow.com/questions/35879149/vba-copy-to-zip-file-returns-error", "title": "VBA copy to zip file returns error", "body": "<p>I've written a script to add all files in a folder to a zip file using code adapted from www.rondebruin.nl, but I keep getting an error 'Object variable or With block variable not set'.</p>\n\n<pre><code>Function ZipDir(FolderName As String, ZipName As String) As String\n'Copied from: http://www.rondebruin.nl/win/s7/win001.htm\nDim FileNameZip ', FolderName\nDim strDate As String, DefPath As String\nDim oApp As Object\n\n'Create empty Zip File\nNewZip ZipName\n\nSet oApp = CreateObject(\"Shell.Application\")\n'Copy the files to the compressed folder\noApp.Namespace(ZipName).CopyHere oApp.Namespace(FolderName).items '&lt;&lt;ERROR HERE\n\n'Keep script waiting until Compressing is done\nOn Error Resume Next\nDo Until oApp.Namespace(ZipName).items.Count = _\n    oApp.Namespace(FolderName).items.Count\n    Application.Wait (Now + TimeValue(\"0:00:01\"))\nLoop\nOn Error GoTo 0\n\nMsgBox \"You find the zipfile here: \" &amp; ZipName\nEnd Function\n</code></pre>\n\n<p>The code errors on the <code>oApp.Namespace(ZipName).CopyHere oApp.Namespace(FolderName).items</code> line. However if I explicitly declare the source and destination files like so: <code>oApp.Namespace(\"C:\\MyZip.Zip\").CopyHere \"C:\\Temp\\MyFile.pdf\"</code></p>\n\n<p>If I change Either the zip name, or the file name from above, then it errors.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1457491033, "post_id": 35878432, "comment_id": 59426707, "body": "Here&#39;s the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg278455.aspx\" rel=\"nofollow noreferrer\">Operator Precedence table</a> in VBA for future reference"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457473092, "post_id": 35878480, "comment_id": 59420346, "body": "or it could be <code>IF Not (A And B)</code>"}, {"owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "edited": false, "score": 0, "creation_date": 1457473293, "post_id": 35878480, "comment_id": 59420449, "body": "Perfect @Alex McMillan, I was able to use:     IF A And Not B as I actually wanted it to select Supplier A records but not ones that included &quot;Rail&quot; in the description. Thanks!"}], "tags": [], "owner": {"reputation": 13687, "user_id": 1136527, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/LpVhn.jpg?s=128&g=1", "display_name": "Alex McMillan", "link": "https://stackoverflow.com/users/1136527/alex-mcmillan"}, "is_accepted": true, "score": 10, "last_activity_date": 1457472915, "creation_date": 1457472915, "answer_id": 35878480, "question_id": 35878432, "link": "https://stackoverflow.com/questions/35878432/opposite-of-like-statement/35878480#35878480", "title": "Opposite of LIKE statement", "body": "<p>You should use brackets or logic to explicitly state what you are after.</p>\n\n<pre><code>If Not rngData.Cells(i, 11).Value = \"SUPPLIER A\" And rngData.Cells(i, 6).Value Like \"*RAIL*\" Then\n</code></pre>\n\n<p>is the same as</p>\n\n<pre><code>If Not A And B\n</code></pre>\n\n<p>when it appears you want</p>\n\n<pre><code>If Not A And Not B\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 2, "last_activity_date": 1457523299, "last_edit_date": 1495542689, "creation_date": 1457523299, "answer_id": 35890485, "question_id": 35878432, "link": "https://stackoverflow.com/questions/35878432/opposite-of-like-statement/35890485#35890485", "title": "Opposite of LIKE statement", "body": "<p>As VBA <a href=\"https://stackoverflow.com/questions/24641923/vba-short-circuit-and-alternatives\">doesn't short circuit</a> it is better to write logic as below with the more likely <em>False</em> condition first (so the redundant second test isn't run).</p>\n\n<p>So</p>\n\n<p><code>If Not A Then\n  If Not B</code></p>\n\n<p>Or in your case;</p>\n\n<pre><code>If Not rngData.Cells(i, 11).Value = \"SUPPLIER A\" Then\n    If Not rngData.Cells(i, 6).Value Like \"*RAIL*\" Then\n            j = j + 1\n            rngData.Rows(i).Copy Destination:=wsGalreq.Cells(j, 1)\n    End If\n End If \n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5627581, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh5.googleusercontent.com/-GNRQm4VOme4/AAAAAAAAAAI/AAAAAAAADS4/gDwqCnfBs04/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5627581/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1366, "favorite_count": 0, "accepted_answer_id": 35878480, "answer_count": 2, "score": 1, "last_activity_date": 1457523352, "creation_date": 1457472658, "last_edit_date": 1457523352, "question_id": 35878432, "link": "https://stackoverflow.com/questions/35878432/opposite-of-like-statement", "title": "Opposite of LIKE statement", "body": "<p>I am having some issues getting a <code>If NOT Like</code> code to work.</p>\n\n<p>Below is the part of the coding that has it. It seems like the coding is bringing over the second record that has <em>Rail</em> in the field being looked at, but none of the records with rail before that one or after that one. </p>\n\n<p>In reality, it should be bringing over records that don't contain rail anywhere in that field but it doesn't do that either. Any feedback is appreciated.</p>\n\n<pre><code>Set rngData = Intersect(wsData.UsedRange, wsData.Range(\"A:K\"))\n\n    j = 1\n    rngData.Rows(1).Copy Destination:=wsGalreq.Cells(j, 1)\n\n    For i = 2 To rngData.Rows.Count\n        If Not rngData.Cells(i, 11).Value = \"SUPPLIER A\" And rngData.Cells(i, 6).Value Like \"*RAIL*\" Then\n            j = j + 1\n            rngData.Rows(i).Copy Destination:=wsGalreq.Cells(j, 1)\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 2126, "user_id": 3076048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6400b93631ba00051f21c5e158f1ed34?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Balhoff", "link": "https://stackoverflow.com/users/3076048/mark-balhoff"}, "edited": false, "score": 0, "creation_date": 1457477573, "post_id": 35878106, "comment_id": 59422550, "body": "@lrb Looking at the queries, I think he wants to know how many distinct times exist for each day. If so that&#39;s pretty easily done with subqueries"}], "answers": [{"tags": [], "owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "is_accepted": false, "score": 1, "last_activity_date": 1457477646, "creation_date": 1457477646, "answer_id": 35879667, "question_id": 35878106, "link": "https://stackoverflow.com/questions/35878106/need-sql-with-subquery-to-get-distinct-values-for-vba-code/35879667#35879667", "title": "Need SQL with subquery to get distinct values for VBA code", "body": "<p>Subquery your distinct table inside and perform your aggregates outside until you get the desired result:</p>\n\n<pre><code>SELECT DistinctDateTime.LongDate, Count(DistinctDateTime.Time) AS CountOfTime\nFROM \n(\n    SELECT DISTINCT BAR_DATA.LongDate, BAR_DATA.Time\n    FROM BAR_DATA\n) AS DistinctDateTime\nGROUP BY DistinctDateTime.LongDate\nHAVING (((Count(DistinctDateTime.Time))&lt;&gt;390 And (Count(DistinctDateTime.Time))&lt;&gt;210));\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 5543095, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dc17332c5df2cc21e8760db01f31950f?s=128&d=identicon&r=PG&f=1", "display_name": "OldRoboCoder", "link": "https://stackoverflow.com/users/5543095/oldrobocoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457477646, "creation_date": 1457471563, "last_edit_date": 1457476165, "question_id": 35878106, "link": "https://stackoverflow.com/questions/35878106/need-sql-with-subquery-to-get-distinct-values-for-vba-code", "title": "Need SQL with subquery to get distinct values for VBA code", "body": "<p>I have a table BAR_DATA with two fields:  LongDate, Time.  Both are long integers.  No Access Date/Time involved here.\nFor each distinct LongDate value there are hundreds of records, each with Time value which may be distinct or duplicate within that LongDate.</p>\n\n<p>I need to create an SQL statement that will group by LongDate and give me a count of distinct Times within each LongDate.<br>\nThe following SQL statement, (built by an Acess query) does NOT work (some LongDates are omitted):</p>\n\n<h3>Query A</h3>\n\n<pre><code>SELECT DISTINCT BAR_DATA.LongDate, Count(BAR_DATA.Time) AS CountOfTime\nFROM BAR_DATA\nGROUP BY BAR_DATA.LongDate\nHAVING (((Count(BAR_DATA.Time))&lt;&gt;390 And (Count(BAR_DATA.Time))&lt;&gt;210));\n</code></pre>\n\n<p>However, if I use Query B to reference Query DistinctDateTime, it does work:</p>\n\n<h3>Query B</h3>\n\n<pre><code>SELECT DistinctDateTime.LongDate, Count(DistinctDateTime.Time) AS CountOfTime\nFROM DistinctDateTime\nGROUP BY DistinctDateTime.LongDate\nHAVING (((Count(DistinctDateTime.Time))&lt;&gt;390 And (Count(DistinctDateTime.Time))&lt;&gt;210));\n</code></pre>\n\n<h3>Query DistinctDateTime</h3>\n\n<pre><code>SELECT DISTINCT BAR_DATA.LongDate, BAR_DATA.Time\nFROM BAR_DATA;\n</code></pre>\n\n<p>My problem:\nI need to get Query B and Query DistinctDateTime wrapped into a single SQL statement so I can paste it into a VBA function.  I presume there\nis some subquery techniques, but I have failed at every attempt, and find no pertinent example.</p>\n\n<p>Any help will be greatly appreciated.  Thanks!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1457472862, "post_id": 35877848, "comment_id": 59420232, "body": "Do you have a parent/child relationship set on the main form?"}, {"owner": {"reputation": 141, "user_id": 2320492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38658a96ae3e866ef70a44cba6201d53?s=128&d=identicon&r=PG", "display_name": "user2320492", "link": "https://stackoverflow.com/users/2320492/user2320492"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1457536532, "post_id": 35877848, "comment_id": 59451478, "body": "Yes when some of the fields on the child satisfy some constraint. The parent buttons enabled/disabled depending on this value."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1457537776, "post_id": 35877848, "comment_id": 59452523, "body": "Could you provide the control sources for the form and subform and the parent/child field with any pertinent table relationships?"}, {"owner": {"reputation": 141, "user_id": 2320492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38658a96ae3e866ef70a44cba6201d53?s=128&d=identicon&r=PG", "display_name": "user2320492", "link": "https://stackoverflow.com/users/2320492/user2320492"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1457538932, "post_id": 35877848, "comment_id": 59453459, "body": "Can you give me more details on that. Also when I try to export documentation for the form and sub form when the form is open I got the following error : application-defined or object-defined error"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1457543720, "post_id": 35877848, "comment_id": 59456941, "body": "I don&#39;t need the documentation, just the code that sits in the control source box in the properties pane (on the data tab) of the main form and the subform. The parent/child is in the properties pane too. That&#39;s the only way anyone will be able to diagnose the issue. Post an edit to your question including the code and where you pulled it from."}, {"owner": {"reputation": 141, "user_id": 2320492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38658a96ae3e866ef70a44cba6201d53?s=128&d=identicon&r=PG", "display_name": "user2320492", "link": "https://stackoverflow.com/users/2320492/user2320492"}, "reply_to_user": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1458055285, "post_id": 35877848, "comment_id": 59682170, "body": "@ Christopher D. After a lot of testing I found out that the cause is the select stmnt mentioned in the update question. I need it this way to use it in a search function later but not sure why it cause this error."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 2320492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38658a96ae3e866ef70a44cba6201d53?s=128&d=identicon&r=PG", "display_name": "user2320492", "link": "https://stackoverflow.com/users/2320492/user2320492"}, "is_accepted": true, "score": 1, "last_activity_date": 1458056128, "creation_date": 1458056128, "answer_id": 36015709, "question_id": 35877848, "link": "https://stackoverflow.com/questions/35877848/recordset-is-not-updateable-when-try-from-form-but-work-fine-if-only-subform-loa/36015709#36015709", "title": "Recordset is not updateable when try from form but work fine if only subform loaded", "body": "<p>I found the error and it was actually logic one. The problem in the DISTINCT. This is why I can not update because it is more then one record with the same values and the access have no clue which to update.</p>\n"}], "owner": {"reputation": 141, "user_id": 2320492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38658a96ae3e866ef70a44cba6201d53?s=128&d=identicon&r=PG", "display_name": "user2320492", "link": "https://stackoverflow.com/users/2320492/user2320492"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 36015709, "answer_count": 1, "score": 0, "last_activity_date": 1458056128, "creation_date": 1457470567, "last_edit_date": 1458054802, "question_id": 35877848, "link": "https://stackoverflow.com/questions/35877848/recordset-is-not-updateable-when-try-from-form-but-work-fine-if-only-subform-loa", "title": "Recordset is not updateable when try from form but work fine if only subform loaded", "body": "<p>I have a form with datasheet subform. When I try to load the main form and update some of the fields in the subform it gives me the error : (Recordset is not updateable)</p>\n\n<p>but when I load the subform by itself it works fine. Iam using Access 2007.</p>\n\n<p>Code under one of the files is:</p>\n\n<pre><code>Private Sub No_open_quality_issues_Click()\nIf (Me.No_open_quality_issues.Value = True) Then\n    Me.No_open_quality_issues.Locked = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>it looks like the problem happen when I change the source record source from :</p>\n\n<pre><code>SELECT Production_Readiness.*\nFROM Production_Readiness;\n</code></pre>\n\n<p>To :</p>\n\n<pre><code>SELECT DISTINCT Production_Readiness.*\nFROM Production_Readiness\nWHERE (((Production_Readiness.Material) Like '' &amp; \"*\" Or (Production_Readiness.Material) Is Null) AND ((Production_Readiness.[All Engine Models]) Like '' &amp; \"*\" Or (Production_Readiness.[All Engine Models]) Is Null) AND ((Production_Readiness.Commodities) Like '' &amp; \"*\" Or (Production_Readiness.Commodities) Is Null) AND ((Production_Readiness.[Buyer Name]) Like '' &amp; \"*\" Or (Production_Readiness.[Buyer Name]) Is Null) AND ((Production_Readiness.Vendor) Like '' &amp; \"*\" Or (Production_Readiness.Vendor) Is Null) AND ((Production_Readiness.[Vendor Name]) Like '' &amp; \"*\" Or (Production_Readiness.[Vendor Name]) Is Null) AND ((Production_Readiness.[MinOfStat-Rel Del Date     Next coming delivery])&gt;=#5/16/1892# And (Production_Readiness.[MinOfStat-Rel Del Date     Next coming delivery])&lt;=#3/15/2016#) AND ((Production_Readiness.[Buyer Badge])=FctUserID()) AND ((Production_Readiness.Status)&lt;&gt;'Processed'));\n</code></pre>\n\n<p>to be more specific it happen when I try to use this function on loading the form :</p>\n\n<pre><code>Private Function LoadHOQuery()\n\nprogComb_Filter = \"Like '' &amp; \"\"*\"\" Or (Production_Readiness.[All Engine Models]) Is Null\"\npartNoCmb_Filter = \"Like '' &amp; \"\"*\"\" Or (Production_Readiness.Material) Is Null\"\ncommodCmb_Filter = \"Like '' &amp; \"\"*\"\" Or (Production_Readiness.Commodities) Is Null\"\ncustCmb_Filter = \"Like '' &amp; \"\"*\"\" Or (Production_Readiness.[Buyer Name]) Is Null\"\nsubCodeCmb_Filter = \"Like '' &amp; \"\"*\"\" Or (Production_Readiness.[Vendor]) Is Null\"\nsubCmb_Filter = \"Like '' &amp; \"\"*\"\" Or (Production_Readiness.[Vendor Name]) Is Null\"\nstartDateTxt_Filter = \"5/16/1892\"\nendDateTxt_Filter = Date\nDim sqlCmd As String\n\nDim isFormLoades As Boolean\nIf (openCondition = \"Buyer\") Then\n    isFormLoades = IsLoaded(\"Handoff_Frm\")\n    If (isFormLoades) Then\n        sqlCmd = \"SELECT DISTINCT Production_Readiness.* \" &amp; _\n                 \"FROM Production_Readiness \" &amp; _\n                 \"WHERE (((Production_Readiness.Material) \" &amp; partNoCmb_Filter &amp; \") AND ((Production_Readiness.[All Engine Models]) \" &amp; progComb_Filter &amp; \") AND \" &amp; _\n                        \"((Production_Readiness.Commodities) \" &amp; commodCmb_Filter &amp; \" ) AND ((Production_Readiness.[Buyer Name]) \" &amp; custCmb_Filter &amp; \" ) AND \" &amp; _\n                        \"((Production_Readiness.Vendor) \" &amp; subCodeCmb_Filter &amp; \") AND ((Production_Readiness.[Vendor Name]) \" &amp; subCmb_Filter &amp; \") AND \" &amp; _\n                        \"((Production_Readiness.[MinOfStat-Rel Del Date     Next coming delivery])&gt;=#\" &amp; startDateTxt_Filter &amp; \"#) AND ((Production_Readiness.[MinOfStat-Rel Del Date     Next coming delivery])&lt;=#\" &amp; endDateTxt_Filter &amp; \"#) And\" &amp; _\n                        \"(((Production_Readiness.[Buyer Badge])=FctUserID()) And ((Production_Readiness.[Status]) &lt;&gt;  'Processed') ) ); \"\n\n        'MsgBox sqlCmd\n\n\n        Me.ManageHanOff.Form.RecordSource = sqlCmd\n        Me.ManageHanOff.Form.Requery\n     End If\n ElseIf (openCondition = \"Manager\") Then\n\n End If\n</code></pre>\n\n<p>End Function</p>\n\n<p>Can you help me.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 2, "creation_date": 1457470548, "post_id": 35877786, "comment_id": 59419012, "body": "A macro is definitely overkill here. Where you have the &quot;2&quot; in your vlookup formula above, change it to this: &quot;COLUMN(B:B)&quot;. This reduces to 2. As you drag the formula to the right, it will become &quot;COLUMN(C:C)&quot; [which reduces to 3], and so on."}, {"owner": {"reputation": 171, "user_id": 1096859, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a7971ec4cad2d783fa5a2e37ee8f827c?s=128&d=identicon&r=PG", "display_name": "ch1zra", "link": "https://stackoverflow.com/users/1096859/ch1zra"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1457470732, "post_id": 35877786, "comment_id": 59419129, "body": "but vlookup needs the first collumn to use as refference."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1457470917, "post_id": 35877786, "comment_id": 59419226, "body": "Your question is how to increment col_index_num. I have shown you how to do that. Do you also want to know how to make VLOOKUP always pick up column A on the left, and a newly iterated column n on the right? If so, just do this: VLOOKUP($A2,$A:B,2,0). Here, the $ to the left of A means it will always look at column A to the left. The lack of $ to the left of B means that as you drag the formula to the right, B will increment by 1."}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 2, "creation_date": 1457471703, "post_id": 35877786, "comment_id": 59419640, "body": "I think Grade &#39;Eh&#39; means <code>=IFERROR(VLOOKUP($A2,OLD!$A:B,COLUMN(B:B),0),0)</code>."}, {"owner": {"reputation": 171, "user_id": 1096859, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a7971ec4cad2d783fa5a2e37ee8f827c?s=128&d=identicon&r=PG", "display_name": "ch1zra", "link": "https://stackoverflow.com/users/1096859/ch1zra"}, "edited": false, "score": 1, "creation_date": 1457472503, "post_id": 35877786, "comment_id": 59420058, "body": "it works, thanx a lot. Had no idea that I could use collumn refference for that. I always used flat number."}], "owner": {"reputation": 171, "user_id": 1096859, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a7971ec4cad2d783fa5a2e37ee8f827c?s=128&d=identicon&r=PG", "display_name": "ch1zra", "link": "https://stackoverflow.com/users/1096859/ch1zra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457521084, "creation_date": 1457470361, "last_edit_date": 1531164843, "question_id": 35877786, "link": "https://stackoverflow.com/questions/35877786/excel-vba-replacing-part-of-formula-for-selected-cells", "title": "Excel VBA: replacing part of formula for selected cells", "body": "<p>I have this kind of formula:</p>\n\n<pre><code>=IFERROR(VLOOKUP($A2,OLD!$A:$B,**2**,0),0)\n</code></pre>\n\n<p>And I want to select certain number of cells right of the first one, and then to fill them with formula that changes only <code>col_index_num</code> (increments by 1 for each next cell to the right)</p>\n\n<p>And I have no idea how to do it in VBA. I could make a Autohotkey script, but a lot of my colleagues need this too, and Excel macro would be nice :)</p>\n\n<p>Sheet names and cell ranges may differ from need to need, but just <code>col_index_num</code> needs to be incremented.</p>\n"}, {"tags": ["excel", "add-in", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1457470264, "post_id": 35877485, "comment_id": 59418851, "body": "You don&#39;t appear to delete any existing commandbar by that name before trying to add a new one."}, {"owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1457470505, "post_id": 35877485, "comment_id": 59418988, "body": "@Rory Just as you posted, I made the same discovery. +1 for being quick! Thanks for the help."}], "owner": {"reputation": 742, "user_id": 5596937, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/1fAS1.jpg?s=128&g=1", "display_name": "Iron Man", "link": "https://stackoverflow.com/users/5596937/iron-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1457469303, "creation_date": 1457469303, "last_edit_date": 1531164843, "question_id": 35877485, "link": "https://stackoverflow.com/questions/35877485/custom-menu-ceated-in-add-in-works-once-then-throw-a-rt5-error-on-subsequent-att", "title": "Custom Menu ceated in Add-In works once then throw a RT5 error on subsequent attempts", "body": "<p>I have created an AddIn that utilizes an extensive menu system to call code based on the worksheet name the user is working in. Some of these worksheets are in different workbooks. All of the individual subs work, but I am having difficulty in figuring out why the menu (a button in the Ribbon triggers the menu code) only works once, then gives me a </p>\n\n<blockquote>\n  <p>Run-time error '5': Invalid procedure call or argument</p>\n</blockquote>\n\n<p>The button triggers this code to run:</p>\n\n<pre><code>Sub CreateMasterMenu()\n\n'\n    Select Case ActiveSheet.name\n        Case \"BCM Hourly Comparison an\": Call Extract_Initial_Save\n        Case \"Daily Impacts Verification Step\": Call Verification_Initial_Save\n        Case \"Extract\": Call Extract_Menu\n        Case \"Swivel\": Call Swivel_Menu\n        Case \"Disputed\": Call Disputed_Menu\n        Case \"Verification\": Call Verification_Menu\n        Case Else: MsgBox \"There are no menu options available for this worksheet.\"\n    End Select\n\n    On Error Resume Next\n    Application.CommandBars(Menuname).ShowPopup\n    On Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>This will call a popup menu based on the name of the active worksheet. When I first open the workbook and make a choice, it works as expected. But when I click on the button a second time to make another choice, I receive the RT error.</p>\n\n<pre><code>Sub Swivel_Menu()\n\n'\n    Dim MenuItem As CommandBarPopup\n\n    With Application.CommandBars.Add(name:=Menuname, Position:=msoBarPopup, _\n         MenuBar:=False, Temporary:=True) 'This is where the debugger says the error is\n\n        With .Controls.Add(Type:=msoControlButton)\n            .Caption = \"Hide Columns\"\n            .FaceId = 1649\n            .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"Swivel_Hide_Columns\"\n        End With\n        With .Controls.Add(Type:=msoControlButton)\n            .Caption = \"Highlight &amp; Copy Disputed\"\n            .FaceId = 3881\n            .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"Swivel_HandC_Disputed\"\n        End With\n        With .Controls.Add(Type:=msoControlButton)\n            .Caption = \"Swivel Sheet Sort\"\n            .FaceId = 706\n            .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"Swivel_Sheet_sort\"\n        End With\n        With .Controls.Add(Type:=msoControlButton)\n            .Caption = \"Unhide Columns\"\n            .FaceId = 1650\n            .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"Swivel_Unhide_Columns\"\n        End With\n\n        Set MenuItem = .Controls.Add(Type:=msoControlPopup)\n        With MenuItem\n            .Caption = \"Swivel Tools\"\n\n            With .Controls.Add(Type:=msoControlButton)\n                .Caption = \"Remove Duplicates\"\n                .FaceId = 2165\n                .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"Swivel_Remove_Duplicates\"\n            End With\n            With .Controls.Add(Type:=msoControlButton)\n                .Caption = \"Copy To Validate\"\n                .FaceId = 731\n                .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"Swivel_Copy_To_Validate\"\n            End With\n            With .Controls.Add(Type:=msoControlButton)\n                .Caption = \"Not Available\"\n                .FaceId = 463\n                .OnAction = \"'\" &amp; ThisWorkbook.name &amp; \"'!\" &amp; \"Menu_Construct_Msg\"\n            End With\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I had this code running from a workbook and did not have this issue. It is pretty much copied into the add-in (with extra menu options added), but the code is the same.</p>\n\n<p>Am I getting this error because I am running it from an add-in as opposed to running it from the workbook as before?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1457469596, "post_id": 35877410, "comment_id": 59418475, "body": "If you are using the latest 365 or online excel then <code>TEXTJOIN(&quot;|&quot;,TRUE,IF($B$1:$B$5 = &quot;User1&quot;, $A$1:$A$5, &quot;&quot;))</code>. This is an array formula so confirm with ctrl-shift-enter..  Other wise you will need to sort on column 2 and use a helper column to concatenate each row with the one below it. Then use a vlookup to get the first.  If sorting is not what you want then vba is the only way. <a href=\"http://stackoverflow.com/questions/35565694/get-unique-value-list-in-excel/35566254#35566254\">HERE</a> are examples of the formula route."}, {"owner": {"reputation": 3, "user_id": 5538412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8db243fb68799b0f999df235bf1f43b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Windmiller", "link": "https://stackoverflow.com/users/5538412/scott-windmiller"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457656370, "post_id": 35877410, "comment_id": 59518308, "body": "This helped me figure it out. Thanks!!!"}], "answers": [{"tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 0, "last_activity_date": 1457477226, "last_edit_date": 1525816189, "creation_date": 1457477226, "answer_id": 35879565, "question_id": 35877410, "link": "https://stackoverflow.com/questions/35877410/excel-matching-data-and-writing-to-another-column/35879565#35879565", "title": "Excel - Matching data and writing to another column", "body": "<p>Using Chip's UDF located <a href=\"http://www.cpearson.com/excel/stringconcatenation.aspx\" rel=\"nofollow noreferrer\">here</a> and included below you can then on your target cell place the following formula:</p>\n\n<pre><code>=TRIM(stringconcat(\" | \",IF(B:B=\"User1\",A:A,\"\")))\n</code></pre>\n\n<p>This will output all folders concatenated with the \"|\" delimiter for \"User1\". Cheers,</p>\n\n<p>StringConcat code:</p>\n\n<pre><code>Function StringConcat(Sep As String, ParamArray Args()) As Variant\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' StringConcat\n' By Chip Pearson, chip@cpearson.com, www.cpearson.com\n'                  www.cpearson.com/Excel/stringconcatenation.aspx\n' This function concatenates all the elements in the Args array,\n' delimited by the Sep character, into a single string. This function\n' can be used in an array formula. There is a VBA imposed limit that\n' a string in a passed in array (e.g.,  calling this function from\n' an array formula in a worksheet cell) must be less than 256 characters.\n' See the comments at STRING TOO LONG HANDLING for details.\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nDim S As String\nDim N As Long\nDim M As Long\nDim R As Range\nDim NumDims As Long\nDim LB As Long\nDim IsArrayAlloc As Boolean\n\n'''''''''''''''''''''''''''''''''''''''''''\n' If no parameters were passed in, return\n' vbNullString.\n'''''''''''''''''''''''''''''''''''''''''''\nIf UBound(Args) - LBound(Args) + 1 = 0 Then\n    StringConcat = vbNullString\n    Exit Function\nEnd If\n\nFor N = LBound(Args) To UBound(Args)\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    ' Loop through the Args\n    ''''''''''''''''''''''''''''''''''''''''''''''''\n    If IsObject(Args(N)) = True Then\n        '''''''''''''''''''''''''''''''''''''\n        ' OBJECT\n        ' If we have an object, ensure it\n        ' it a Range. The Range object\n        ' is the only type of object we'll\n        ' work with. Anything else causes\n        ' a #VALUE error.\n        ''''''''''''''''''''''''''''''''''''\n        If TypeOf Args(N) Is Excel.Range Then\n            '''''''''''''''''''''''''''''''''''''''''\n            ' If it is a Range, loop through the\n            ' cells and create append the elements\n            ' to the string S.\n            '''''''''''''''''''''''''''''''''''''''''\n            For Each R In Args(N).Cells\n                If Len(R.Text) &gt; 0 Then\n                    S = S &amp; R.Text &amp; Sep\n                End If\n            Next R\n        Else\n            '''''''''''''''''''''''''''''''''\n            ' Unsupported object type. Return\n            ' a #VALUE error.\n            '''''''''''''''''''''''''''''''''\n            StringConcat = CVErr(xlErrValue)\n            Exit Function\n        End If\n\n    ElseIf IsArray(Args(N)) = True Then\n        '''''''''''''''''''''''''''''''''''''\n        ' ARRAY\n        ' If Args(N) is an array, ensure it\n        ' is an allocated array.\n        '''''''''''''''''''''''''''''''''''''\n        IsArrayAlloc = (Not IsError(LBound(Args(N))) And _\n            (LBound(Args(N)) &lt;= UBound(Args(N))))\n        If IsArrayAlloc = True Then\n            ''''''''''''''''''''''''''''''''''''\n            ' The array is allocated. Determine\n            ' the number of dimensions of the\n            ' array.\n            '''''''''''''''''''''''''''''''''''''\n            NumDims = 1\n            On Error Resume Next\n            Err.Clear\n            NumDims = 1\n            Do Until Err.Number &lt;&gt; 0\n                LB = LBound(Args(N), NumDims)\n                If Err.Number = 0 Then\n                    NumDims = NumDims + 1\n                Else\n                    NumDims = NumDims - 1\n                End If\n            Loop\n            On Error GoTo 0\n            Err.Clear\n            ''''''''''''''''''''''''''''''''''\n            ' The array must have either\n            ' one or two dimensions. Greater\n            ' that two caues a #VALUE error.\n            ''''''''''''''''''''''''''''''''''\n            If NumDims &gt; 2 Then\n                StringConcat = CVErr(xlErrValue)\n                Exit Function\n            End If\n            If NumDims = 1 Then\n                For M = LBound(Args(N)) To UBound(Args(N))\n                    If Args(N)(M) &lt;&gt; vbNullString Then\n                        S = S &amp; Args(N)(M) &amp; Sep\n                    End If\n                Next M\n\n            Else\n                ''''''''''''''''''''''''''''''''''''''''''''''''\n                ' STRING TOO LONG HANDLING\n                ' Here, the error handler must be set to either\n                '   On Error GoTo ContinueLoop\n                '   or\n                '   On Error GoTo ErrH\n                ' If you use ErrH, then any error, including\n                ' a string too long error, will cause the function\n                ' to return #VALUE and quit. If you use ContinueLoop,\n                ' the problematic value is ignored and not included\n                ' in the result, and the result is the concatenation\n                ' of all non-error values in the input. This code is\n                ' used in the case that an input string is longer than\n                ' 255 characters.\n                ''''''''''''''''''''''''''''''''''''''''''''''''\n                On Error GoTo ContinueLoop\n                'On Error GoTo ErrH\n                Err.Clear\n                For M = LBound(Args(N), 1) To UBound(Args(N), 1)\n                    If Args(N)(M, 1) &lt;&gt; vbNullString Then\n                        S = S &amp; Args(N)(M, 1) &amp; Sep\n                    End If\n                Next M\n                Err.Clear\n                M = LBound(Args(N), 2)\n                If Err.Number = 0 Then\n                    For M = LBound(Args(N), 2) To UBound(Args(N), 2)\n                        If Args(N)(M, 2) &lt;&gt; vbNullString Then\n                            S = S &amp; Args(N)(M, 2) &amp; Sep\n                        End If\n                    Next M\n                End If\n                On Error GoTo ErrH:\n            End If\n        Else\n            If Args(N) &lt;&gt; vbNullString Then\n                S = S &amp; Args(N) &amp; Sep\n            End If\n        End If\n        Else\n        On Error Resume Next\n        If Args(N) &lt;&gt; vbNullString Then\n            S = S &amp; Args(N) &amp; Sep\n        End If\n        On Error GoTo 0\n    End If\nContinueLoop:\nNext N\n\n'''''''''''''''''''''''''''''\n' Remove the trailing Sep\n'''''''''''''''''''''''''''''\nIf Len(Sep) &gt; 0 Then\n    If Len(S) &gt; 0 Then\n        S = Left(S, Len(S) - Len(Sep))\n    End If\nEnd If\n\nStringConcat = S\n'''''''''''''''''''''''''''''\n' Success. Get out.\n'''''''''''''''''''''''''''''\nExit Function\nErrH:\n'''''''''''''''''''''''''''''\n' Error. Return #VALUE\n'''''''''''''''''''''''''''''\nStringConcat = CVErr(xlErrValue)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5538412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8db243fb68799b0f999df235bf1f43b?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Windmiller", "link": "https://stackoverflow.com/users/5538412/scott-windmiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457477226, "creation_date": 1457469053, "last_edit_date": 1531161705, "question_id": 35877410, "link": "https://stackoverflow.com/questions/35877410/excel-matching-data-and-writing-to-another-column", "title": "Excel - Matching data and writing to another column", "body": "<p>I am looking to do some matching of data to display in a 3rd.\nI have a column of folders and the second column shows what users have access to that folder, So:</p>\n\n<pre><code>Column1 Column2\nFolder1 User1\nFolder1 User2\nFolder2 User1\nFolder3 User1\n</code></pre>\n\n<p>I have a list of users I want to search for (I made a \"unique\" list based off of Column2) and want to find the match in Column2 and in Column3 put the User with the corresponding folders separated by a delimiter. It does not have to be column3 it could even be another sheet, the data is column3 is the only data I will need once done. So Column3 would look like:</p>\n\n<pre><code>User1|Folder1|Folder2|Folder3\nUser2|Folder1\n</code></pre>\n\n<p>Does this make sense?</p>\n\n<p>Thanks for any help you can give.\nScott</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1457472307, "post_id": 35877042, "comment_id": 59419953, "body": "Have you ever tried to use ADODB within VBA? Using database-based approach will be the best option for you. Any VBA solution using 2 loops will be much, much slower!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457472453, "post_id": 35877042, "comment_id": 59420031, "body": "See my answer here for an approach using a pair of Dictionary objects  <a href=\"http://stackoverflow.com/questions/35777978/vba-comparing-two-2d-arrays-rows-vba-throws-type-mismatch-declarations-ok/35778287#35778287\" title=\"vba comparing two 2d arrays rows vba throws type mismatch declarations ok\">stackoverflow.com/questions/35777978/&hellip;</a>   It will be a lot faster than your current code."}, {"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1457480825, "post_id": 35877042, "comment_id": 59423759, "body": "Hi Tim, that looks very interesting, if I understand correctly would this be something like an array with 3 dimensions? each array &quot;position&quot; would consist of 3 columns?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1457485818, "post_id": 35877042, "comment_id": 59425329, "body": "You would need a modification of that code since one of your &quot;keys&quot; is only a substring of the cell value.  Your &quot;keys&quot; would be the order number, and the values would be row numbers within each dataset."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1457480939, "post_id": 35879567, "comment_id": 59423802, "body": "I guess I dont really know enough of SQL to understand this code. What does it exactly do?"}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "reply_to_user": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1457481411, "post_id": 35879567, "comment_id": 59423988, "body": "It combines 2 tables into a third one. For the basics : <a href=\"http://www.w3schools.com/sql/sql_join_inner.asp\" rel=\"nofollow noreferrer\">w3schools.com/sql/sql_join_inner.asp</a>"}], "tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1457477238, "creation_date": 1457477238, "answer_id": 35879567, "question_id": 35877042, "link": "https://stackoverflow.com/questions/35877042/vba-reconciliation-of-large-datasets/35879567#35879567", "title": "VBA - Reconciliation of Large datasets", "body": "<p>I would process the data with some SQL.\nHere is an example to join two sheets in a third one :</p>\n\n<pre><code>Sub QueryExample()\n\n  Const SQL_JOIN_SHEETS = _\n    \"SELECT * \" &amp; _\n    \"FROM [Sheet1$] a INNER JOIN [Sheet2$] b \" &amp; _\n    \"ON a.ID = b.ID \"\n\n  SqlExec source:=ThisWorkbook, sql:=SQL_JOIN_SHEETS, target:=[Sheet3]\n\nEnd Sub\n\n''\n' Executes a query on a workbook.\n' @source {Workbook}  Workbook loaded by the SQL engine\n' @target {Worksheet} Worksheet to display the result\n' @sql {String} SQL query\n''\nSub SqlExec(source As workbook, sql As String, target As Worksheet)\n  Dim rs As Object, conn$\n  Set rs = CreateObject(\"ADODB.recordset\")\n  conn = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; _\n    source.FullName &amp; \";Extended Properties=\"\"Excel 8.0;HDR=Yes\"\";\"\n\n  ' execute the query\n  rs.Open sql, conn\n\n  ' copy the headers to the target sheet\n  target.Cells.Clear\n  For i = 1 To rs.Fields.Count\n    target.Cells(1, i).Value = rs.Fields(i - 1).Name\n  Next\n\n  ' copy the values to the target sheet\n  target.Cells(2, 1).CopyFromRecordset rs\n\n  ' dispose\n  rs.Close\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1457519890, "post_id": 35881280, "comment_id": 59439456, "body": "Thank you so much Tim, Ill take a look at it later today , but it looks like exactly what I am looking for."}, {"owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "edited": false, "score": 0, "creation_date": 1457823201, "post_id": 35881280, "comment_id": 59583556, "body": "Fantastic Tim. You are a life saver."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1457486762, "creation_date": 1457486762, "answer_id": 35881280, "question_id": 35877042, "link": "https://stackoverflow.com/questions/35877042/vba-reconciliation-of-large-datasets/35881280#35881280", "title": "VBA - Reconciliation of Large datasets", "body": "<p>Untested but should give you a starting point:</p>\n\n<pre><code>Sub Tester()\n\n    Dim desLRow As Long, srcLRow As Long\n    Dim dictDest As Object, dictSrc As Object\n\n    With revnW.Sheets(1)\n       Set dictDest = RowMap(.Range(.Cells(2, 43), .Cells(.Rows.Count, 43).End(xlUp)), 7)\n    End With\n    With wPay.Sheets(1)\n       Set dictSrc = RowMap(.Range(.Cells(3, 3), .Cells(.Rows.Count, 3).End(xlUp)))\n    End With\n\n    For Each k In dictDest.keys\n        If dictSrc.exists(k) Then\n\n            'do the rest of your checks here....\n\n            Debug.Print \"Match between Dest \" &amp; dictDest(k).Address &amp; \" and \" &amp; _\n                        dictSrc(k).Address\n        End If\n    Next k\n\nEnd Sub\n</code></pre>\n\n<p>Here's the \"map\" function:</p>\n\n<pre><code>'Get a \"map\" of row keys to the\n'    rows where they are located (just maps the first cell in each row)\n' \"rng\" is the range to be mapped\n' \"numright\" -  pass a number if you just want a part of the value to be mapped\nFunction RowMap(rng As Range, Optional numRight As Long = 0)\n    Dim rv, nr As Long, nc As Long, r As Long, c As Long\n    Dim k, data\n\n    Set rv = CreateObject(\"scripting.dictionary\")\n\n    data = rng.Value\n    For r = 1 To UBound(data, 1)\n        k = data(r, 1)\n        If numRight &gt; 0 Then k = Right(k, numRight)\n        If rv.exists(k) Then\n            Set rv(k) = Application.Union(rv(k), rng.Columns(1).Cells(r))\n        Else\n            rv.Add k, rng.Columns(1).Cells(r)\n        End If\n    Next r\n    Set RowMap = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 6031229, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4bd1862b112c8c300ac7f84a1d95fdea?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Pl&#225;cido", "link": "https://stackoverflow.com/users/6031229/francisco-pl%c3%a1cido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "closed_date": 1457995535, "accepted_answer_id": 35881280, "answer_count": 2, "score": 0, "last_activity_date": 1457486762, "creation_date": 1457467628, "question_id": 35877042, "link": "https://stackoverflow.com/questions/35877042/vba-reconciliation-of-large-datasets", "closed_reason": "Needs more focus", "title": "VBA - Reconciliation of Large datasets", "body": "<p>I currently have two files with 50k+ rows.\nThey both include an order code. In one file that would be Right(\"AQ column\", 7) and the other one would have it in column C.\nI would like to match an order code, and compare if the values are the same. Also, in the second file, there should be a check in a different column to see if there is a string matching \"SETTLED\" as there are duplicate order codes in that file.</p>\n\n<p>I have tried a few approaches, Ill paste a not so efficient one below, in order for what I am trying to fix to be clear.\nrevnW and Wpay are the 2 different workbooks</p>\n\n<pre><code>DesLRow = revnW.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\nSrcLRow = wPay.Sheets(1).Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 2 to DesLrow\n for j = 3 to srcLrow\n  If right(revnW.Sheets(1).Cells(i,43).text, 7) = wPay.Sheets(1).Cells(j,3).text And_\n Instr(wPay.Sheets(1).Cells(j,5).text, \"SETTLED\") And value &lt;&gt; value 2 (pseudo code) Then\n\n\nDo stuff (get transaction number, and some other things)\n      exit for   \n      next j\nNext i\n</code></pre>\n\n<p>I know this code is not efficient, I have tried to load the columns into an array, but then I could only compare one column, and not the values etc..</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1457470021, "post_id": 35876369, "comment_id": 59418694, "body": "Try to project this value to Date data type."}], "answers": [{"comments": [{"owner": {"reputation": 1613, "user_id": 162313, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/298ba5e3e7f636656efc5493a1a51e39?s=128&d=identicon&r=PG", "display_name": "MarkL", "link": "https://stackoverflow.com/users/162313/markl"}, "edited": false, "score": 1, "creation_date": 1457469323, "post_id": 35876473, "comment_id": 59418325, "body": "No, something else is going on, at least if this is vb6 (I don&#39;t know about vba).  The default property for a textbox control is the Text property, so <code>IsDate(TextBox1)</code> is the same as <code>IsDate(TextBox1.Text)</code>."}, {"owner": {"reputation": 8784, "user_id": 116830, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a8105cf7a85838072d606d4230cdd6?s=128&d=identicon&r=PG", "display_name": "Gratzy", "link": "https://stackoverflow.com/users/116830/gratzy"}, "reply_to_user": {"reputation": 1613, "user_id": 162313, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/298ba5e3e7f636656efc5493a1a51e39?s=128&d=identicon&r=PG", "display_name": "MarkL", "link": "https://stackoverflow.com/users/162313/markl"}, "edited": false, "score": 0, "creation_date": 1457474874, "post_id": 35876473, "comment_id": 59421326, "body": "@MarkL I can confirm the behavior you describe works exactly like that in vba 7.0 as well. So I&#39;m not sure if he is using something older or as if you say it was something else going on."}, {"owner": {"reputation": 8784, "user_id": 116830, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a8105cf7a85838072d606d4230cdd6?s=128&d=identicon&r=PG", "display_name": "Gratzy", "link": "https://stackoverflow.com/users/116830/gratzy"}, "reply_to_user": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457704627, "post_id": 35876473, "comment_id": 59540277, "body": "@Kamil out of curiosity what are you developing in?"}, {"owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "edited": false, "score": 0, "creation_date": 1457714922, "post_id": 35876473, "comment_id": 59547801, "body": "@Gratzy A form which adds a record to the database. Ive changed the input box for date to a DateTimePicker and i use Date.Now() to check if the chosen date is not a date from the past. The code is                                              &quot;If DateTimePicker1.Text &lt;= Date.Now Then&quot;                                      but theres a problem with it where if i pick todays date, the date is considered LESS for some reason and it pick the ELSE event"}], "tags": [], "owner": {"reputation": 8784, "user_id": 116830, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a8105cf7a85838072d606d4230cdd6?s=128&d=identicon&r=PG", "display_name": "Gratzy", "link": "https://stackoverflow.com/users/116830/gratzy"}, "is_accepted": true, "score": 0, "last_activity_date": 1457465742, "creation_date": 1457465742, "answer_id": 35876473, "question_id": 35876369, "link": "https://stackoverflow.com/questions/35876369/how-to-validate-user-input-to-be-date-in-vb/35876473#35876473", "title": "how to validate user input to be Date in vb", "body": "<p>You want the value in the TextBox not the TextBox itself.  Change to TextBox1.Text</p>\n\n<pre><code>Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n    If IsDate(TextBox1.Text) Then\n        MsgBox(\"well done\")\n    Else\n        MsgBox(\"you failed\")\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 0, "last_activity_date": 1457471747, "last_edit_date": 1495542671, "creation_date": 1457471747, "answer_id": 35878155, "question_id": 35876369, "link": "https://stackoverflow.com/questions/35876369/how-to-validate-user-input-to-be-date-in-vb/35878155#35878155", "title": "how to validate user input to be Date in vb", "body": "<p>Everybody knows that <code>IsDate</code> function may provide several issues, i.e.:</p>\n\n<pre><code>IsDate(\"13.50\") 'returns  True\nIsDate(\"12.25.2010\") 'may return False/True\n                     'depending on current culture  (OS date-time settings)\n</code></pre>\n\n<p>Take a look here: <a href=\"https://stackoverflow.com/questions/4338025/isdate-function-returns-unexpected-results\">IsDate function returns unexpected results</a></p>\n\n<p>I'd strongly recommend to use <code>CDate()</code> function, which returns proper date or causes conversion error.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/2dt118h2%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/2dt118h2%28v=vs.84%29.aspx</a></p>\n\n<p>Note: i'd suggest to pass vaule into <code>CDate</code> function in ISO standard format: <code>yyyy/MM/dd</code> to be sure that conversion will return proper date (time).</p>\n"}], "owner": {"reputation": 3, "user_id": 5971321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/501635456709910/picture?type=large", "display_name": "Kamil Lazarowicz", "link": "https://stackoverflow.com/users/5971321/kamil-lazarowicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 35876473, "answer_count": 2, "score": 0, "last_activity_date": 1457481361, "creation_date": 1457465409, "last_edit_date": 1457481361, "question_id": 35876369, "link": "https://stackoverflow.com/questions/35876369/how-to-validate-user-input-to-be-date-in-vb", "title": "how to validate user input to be Date in vb", "body": "<p>Ive tried using IsDate() and made a very simple code just to try and validate one textbox which is the user's input. Everytime i get the Else code meaning the date is not validated properly. Any ideas on how to make it work?</p>\n\n<pre><code>    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click\n    If IsDate(TextBox1) Then\n        MsgBox(\"well done\")\n    Else\n        MsgBox(\"you failed\")\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "edited": false, "score": 0, "creation_date": 1457464620, "post_id": 35875719, "comment_id": 59415528, "body": "It would be helpful if you posted the code you are currently using to attempt performing this task. If you haven&#39;t written anything yet, take a crack at it and update your question with the specific issue you are running into."}, {"owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "reply_to_user": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "edited": false, "score": 0, "creation_date": 1457468197, "post_id": 35875719, "comment_id": 59417678, "body": "It came out to be pretty simple, in fact. My issue was that I had to only include those shapes that had a text frame with actual text. Otherwise, the macros would shrink to fit all shapes even with an empty text frame."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1457468853, "post_id": 35875719, "comment_id": 59418077, "body": "So are you good to go or do you still have questions that need answering?"}, {"owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "edited": false, "score": 0, "creation_date": 1520969553, "post_id": 35875719, "comment_id": 85532270, "body": "We are good, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": true, "score": 3, "last_activity_date": 1457513941, "creation_date": 1457513941, "answer_id": 35887019, "question_id": 35875719, "link": "https://stackoverflow.com/questions/35875719/vba-for-shrinking-the-font-in-powerpoint-when-text-overflows/35887019#35887019", "title": "VBA for shrinking the font in PowerPoint when text overflows", "body": "<p>Could you use the AutoSize property of the shape's TextRange and leave PowerPoint to automatically shrink the text based on the content because the fit will depend in the font face, size and style properties? You can do this with the following property:</p>\n\n<pre><code>oShp.TextFrame2.AutoSize = msoAutoSizeTextToFitShape\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6035935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-7pUfAi3aKh4/AAAAAAAAAAI/AAAAAAAAADo/1J3J_O_ofYU/photo.jpg?sz=128", "display_name": "Ilia Shifrin", "link": "https://stackoverflow.com/users/6035935/ilia-shifrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1362, "favorite_count": 1, "accepted_answer_id": 35887019, "answer_count": 1, "score": 2, "last_activity_date": 1457513941, "creation_date": 1457463470, "question_id": 35875719, "link": "https://stackoverflow.com/questions/35875719/vba-for-shrinking-the-font-in-powerpoint-when-text-overflows", "title": "VBA for shrinking the font in PowerPoint when text overflows", "body": "<p>I'm trying to figure out a macros for PowerPoint files that I export after language conversion through a CAT tool. In some of the language pairs the translated content will not fit into the source file text boxes due to the differences in the language lengths. </p>\n\n<p>Therefore, the translated and exported PowerPoint files contain multiple shapes/text boxes that have some content outside of the visible areas of such shapes. I was wondering what is way to get the newly exported textual content within all shapes/text boxes in the exported PPTs files shrunk globally throughout the file to fit the original sizes of those shapes - only for those shapes when a content overflow occurs.</p>\n\n<p>All I really need is a macros with IF text height/length is more than shape height/length THEN lower font size by one until text dimensions = shape dimensions. I am working in MS Office 15.</p>\n\n<p>Thank you for your input!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 1, "last_activity_date": 1457466904, "creation_date": 1457466904, "answer_id": 35876823, "question_id": 35875645, "link": "https://stackoverflow.com/questions/35875645/dsum-with-tempvars-returning-error/35876823#35876823", "title": "DSum with tempvars returning error", "body": "<p>Compare the last pieces of your <code>DSum</code> expressions ...</p>\n\n<ol>\n<li><code>AND [QTR]= '3'\")</code></li>\n<li><code>AND [QTR]= \" &amp; [TempVars]![ThisQtr])</code></li>\n</ol>\n\n<p>You reported #1 works and #2 triggers the <em>\"Data type mismatch\"</em> error.  So add single quotes before and after the <code>TempVar</code> value ...</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>AND [QTR]= '\" &amp; [TempVars]![ThisQtr] &amp; \"'\")\n</code></pre>\n"}], "owner": {"reputation": 925, "user_id": 5197739, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0eb1950fceec1477ac6713029546eab9?s=128&d=identicon&r=PG&f=1", "display_name": "JamTay317", "link": "https://stackoverflow.com/users/5197739/jamtay317"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 35876823, "answer_count": 1, "score": 1, "last_activity_date": 1457467008, "creation_date": 1457463261, "last_edit_date": 1457467008, "question_id": 35875645, "link": "https://stackoverflow.com/questions/35875645/dsum-with-tempvars-returning-error", "title": "DSum with tempvars returning error", "body": "<p>I have some VBA code that sets a <code>TempVar</code>:</p>\n\n<pre><code>TempVars!ThisQtr = quarter\nTempVars!LastQtr = lastQuarter\nTempVars!LastYr = lastYear\nTempVars!ThisYr = currentYear\n</code></pre>\n\n<p>Great! I know that it does set it as I have checked multiple times.\n<br/><strong>now my problem:</strong><br/>\nI'm trying to use this in a query</p>\n\n<pre><code>DSum(\"[SumBase]\",\"CompareUnionQuery\",\"[AU] = '\" &amp; [AU] &amp; \"' AND [GRP_ID] = \" &amp; [GRP_ID] &amp; \" AND [ACCOUNT] = '\" &amp; [ACCOUNT] &amp; \"'\" &amp; \" AND [Fiscal_Year] = \" &amp; [TempVars]![ThisYr] &amp; \" AND [QTR]= \" &amp; [TempVars]![ThisQtr])\n</code></pre>\n\n<p>which this does work when I change out the <code>TempVars</code> with values. Can anyone help me with this?\nI have tried to put a single quote around them and that doesn't work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/joShM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/joShM.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>this expression does work:</p>\n\n<pre><code>DSum(\"[SumBase]\",\"CompareUnionQuery\",\"[AU] = '\" &amp; [AU] &amp; \"' AND [GRP_ID] = \" &amp; [GRP_ID] &amp; \" AND [ACCOUNT] = '\" &amp; [ACCOUNT] &amp; \"'\" &amp; \" AND [Fiscal_Year] = 2015 AND [QTR]= '3'\")\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 7, "creation_date": 1457461913, "post_id": 35875059, "comment_id": 59413894, "body": "Your code is too long to really get a sense of the core of the problem, plus it&#39;s filled with <code>On Error Resume Next</code> which doesn&#39;t help...  I see some unqualified <code>Range()</code> calls in <code>Fill_Client_Report</code> - you should try to never use that form - always qualify with a worksheet object or your code may behave unpredictably.  That may well be the cause of your problem."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1457462142, "post_id": 35875059, "comment_id": 59414018, "body": "Do you have a sense of <i>when</i> the errors happen? Stepping through the macro may help (use <code>F8</code>), or you can also set a Watch, to look out for a change to some variable.  I&#39;d start by commenting out the <code>On Error Resume</code> so any errors get brought to your attention (as perhaps one of these errors is causing your issue)."}, {"owner": {"reputation": 28, "user_id": 6035689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5271571ebf616c124935f4d81418ace?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6035689/kevin"}, "edited": false, "score": 0, "creation_date": 1457464261, "post_id": 35875059, "comment_id": 59415315, "body": "Thanks for the feed back. I do not know when the error happens because it only happens about 1 in every 30 times I run it. I&#39;ve tried re-running the code on a file that had the problem in several ways (with the external report open, with it closed, with selecting the file, with Bruce:having the newest one chosen, etc.) and not been able to reproduce it. I did not know about Watch. I think that could be the way to keep an eye out for this. A lot of the On Error Resume Next calls are because each file is slightly different (different named ranges), so I don&#39;t think I would get far without those."}, {"owner": {"reputation": 28, "user_id": 6035689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5271571ebf616c124935f4d81418ace?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6035689/kevin"}, "edited": false, "score": 0, "creation_date": 1457464641, "post_id": 35875059, "comment_id": 59415539, "body": "Tim, I agree that unqualified Range() calls are not ideal, but those are set up to identify to correct page hosting the named range (there are usually two matching named ranges, but they may be on different pages across reports). My approach works around this, but I might need to make sure that the workbooks don&#39;t get swapped when it does this. I&#39;ll look into this."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1457468461, "post_id": 35875059, "comment_id": 59417838, "body": "You could add in a section of code which continually checks whether a certain cell has a value or a formula. Then add a watch to it, and go about your business as you have been. When you run it and it creates the error, the code will pause, and you should have some more info about what was going on when it happened. As it stands, your question is basically &quot;This is way too tedious for me to debug because it doesnt happen all the time. Does someone else want to debug it for me?&quot; Not a lot we can say without actually having your data and just running it, as you should be doing."}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 6035689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5271571ebf616c124935f4d81418ace?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6035689/kevin"}, "edited": false, "score": 0, "creation_date": 1457544393, "post_id": 35878118, "comment_id": 59457417, "body": "Thanks. For the input on using <code>On Error GoTo 0</code> to limit the scope of <code>On Error Resume Next</code>. That will help with debugging. Also, this function is a much better way to identify matching ranges in the &quot;Fill_Client_Report&quot; part of my code. I&#39;ll roll it out across my reports and see if that along with a function watching for the problem helps me find the error."}, {"owner": {"reputation": 28, "user_id": 6035689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5271571ebf616c124935f4d81418ace?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6035689/kevin"}, "edited": false, "score": 0, "creation_date": 1465484115, "post_id": 35878118, "comment_id": 62930134, "body": "After incorporating this function into my code and testing it out for several months, the problem appears to have gone away. I think using the <code>Workbook.Names(&quot;Name_of_Named_Range&quot;).RefersToRange</code> accomplished what I had been attempting to do in my earlier code, but it allowed me to have more control over the workbook so that it didn&#39;t get mixed up and overwrite my range with values. Thank you very much for your help!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1457471598, "creation_date": 1457471598, "answer_id": 35878118, "question_id": 35875059, "link": "https://stackoverflow.com/questions/35875059/excel-formulas-replaced-with-values-sporadically-after-using-macro/35878118#35878118", "title": "Excel formulas replaced with values sporadically after using macro", "body": "<p>You can make your code more robust by using a function to get the named ranges which takes both a workbook argument and a range name.</p>\n\n<p>E.g:</p>\n\n<pre><code>Sub Tester()\n    Dim rng As Range\n    Set rng = GetNamedRange(ActiveWorkbook, \"TESTER2\")\n    If Not rng Is Nothing Then\n        Debug.Print rng.Parent.Name, rng.Address\n    Else\n        Debug.Print \"Range not found!\"\n    End If\nEnd Sub\n\n'returns the range for \"theName\", or Nothing if not found\nFunction GetNamedRange(wb As Workbook, theName As String)\n    Dim rv As Range\n    On Error Resume Next 'ignore a specific error\n    Set rv = ActiveWorkbook.Names(\"TESTER2\").RefersToRange\n    On Error GoTo 0      'stop ignoring errors\n    Set GetNamedRange = rv\nEnd Function\n</code></pre>\n\n<p>Where possible you should remove <code>On Error Resume Next</code> from the rest of your code: if you <em>have</em> to use it then make sure you turn it off again as soon as possible.  </p>\n\n<p>It's OK to ignore specific errors if you can reasonably expect that they might occur in <em>normal</em> operation and you can test for the error after the case, but you shouldn't ignore errors wholesale.</p>\n"}], "owner": {"reputation": 28, "user_id": 6035689, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5271571ebf616c124935f4d81418ace?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/6035689/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 35878118, "answer_count": 1, "score": -1, "last_activity_date": 1457521135, "creation_date": 1457461418, "last_edit_date": 1457521135, "question_id": 35875059, "link": "https://stackoverflow.com/questions/35875059/excel-formulas-replaced-with-values-sporadically-after-using-macro", "title": "Excel formulas replaced with values sporadically after using macro", "body": "<p>I wrote a macro for Excel to populate data from one internal file to an external monthly report. As is, 90-95% of the time, it works perfectly. However, I have found that occasionally, it appears to turn the equations in the original file into values, which then forces me to have to fix all of the equations before I run the next month's report. </p>\n\n<p>The code (below) works by running from the internal report and opening the most recent external report (or one selected by the user). In both reports, there are matching named ranges. The macro then iterates through the named ranges and sets the external report's ranges to equal the value of the internal report's ranges. </p>\n\n<p>Currently, I populate client reports from nearly identical internal reports about 15 times a month, and despite all of my best efforts, I cannot appear to replicate the problem. It just seems to do it sometimes and not others. I usually do not even find out that the original formulas are gone until the following month (though, now I am paying more attention to the potential problem). </p>\n\n<p>I read that if Excel copies a range from one instance of Excel to another, it can cause the original equations to be <a href=\"http://database.ittoolbox.com/groups/technical-functional/excel-l/formulas-disappeared-in-excel-file-4665988\" rel=\"nofollow\">set to values</a>, but I do not believe that my code should be creating separate instances of Excel, and when I added a code to try to warn me when a second instance was started, it did not seem to address the problem. Has anyone experienced a similar issue or does anyone have any idea of what might be going on (either in how to reproduce or to fix it?). </p>\n\n<p>Thank you for you help. </p>\n\n<p>FYI: I am running Excel 2010 on Windows 7. Also, the files are hosted on a shared drive, and therefore are not running of my local machine. </p>\n\n<pre><code>Option Explicit\nDim wbSeoReport As Workbook 'Internal workbook\nDim wbClientReport As Workbook 'workbook for clients\nDim sSeoReportName As String\nDim sClientFileName As String 'wbClientReport Name\nDim sFilePath As String 'Folder containing this file\n\nSub Populate_Client_File()\n\nDim replace_page As Worksheet\nDim sCompanyName As String 'Client company name\nDim sClientFileNameAndPath As String 'wbClientReport Name and path for opening file\n'These are used to find the most recent version (date is this month or last, version is the highest available, starting at 10)\nDim iClientFileMonth As Integer\nDim iOriginalMonth As Integer\nDim iClientFileYear As Integer\nDim iClientFileVersion As Integer\nDim sClientFileVersion As String 'this is used to add the v to the client version as iClientFileVersion iterates from 10-1\nDim objFileDialog As FileDialog 'This is for selecting a file when the user does not want the most recent\nDim iUserInput As Integer 'Used to decide whether the most recent file will be used or not.\nDim bFileExists As Boolean\nDim bStayInLoop As Boolean\nDim x As Long, z As Long\nDim labels(1 To 1000) As String\n\nSet wbSeoReport = ThisWorkbook\n\nIf ExcelInstances &gt; 1 Then 'This checks the instances of Excel, which could be an issue making formulas saving as values.\n    MsgBox \"There are \" &amp; str(ExcelInstances) &amp; \" instances of Excel open. Please close extra instances and start again.\"\n    Exit Sub\nEnd If\n\nsFilePath = ActiveWorkbook.path &amp; \"\\\"\n\niUserInput = MsgBox(\"Would you like to use the most recent file?\", vbYesNoCancel) 'Results returned as integers: 6 is yes, 7 is no, 2 is cancel\n\nIf iUserInput = 6 Then\n'The following code seeks to identify the most recent client file based on month and file version\n'it then checks if it is open, opens it, and sets the file as wbClientReport\n\n    iClientFileMonth = Month(wbSeoReport.Worksheets(\"Traffic Summary\").range(\"S1\").value)\n    iOriginalMonth = iClientFileMonth 'This is used for only running the file finder once.\n    iClientFileYear = Year(wbSeoReport.Worksheets(\"Traffic Summary\").range(\"S1\").value) - 2000\n    sCompanyName = wbSeoReport.Worksheets(\"Traffic Summary\").range(\"Z1\").value\n    bFileExists = False\n\n     bStayInLoop = True\n     'This loop is used to go through this month and the previous.\n     'If it fails, you can select the report to open.\n        Do While bStayInLoop = True\n\n                For iClientFileVersion = 10 To 0 Step -1\n                'This loops through file versions starting at 10.\n                    If iClientFileVersion &gt; 0 Then\n                        sClientFileVersion = \" v\" &amp; iClientFileVersion\n                    Else\n                        sClientFileVersion = \"\"\n                    End If\n                    sClientFileNameAndPath = sFilePath &amp; sCompanyName &amp; \" - MOM -  Client Report  \" &amp; iClientFileYear &amp; \" - \" &amp; iClientFileMonth _\n                    &amp; sClientFileVersion &amp; \".xlsm\"\n                    sClientFileName = sCompanyName &amp; \" - MOM -  Client Report  \" &amp; iClientFileYear &amp; \" - \" &amp; iClientFileMonth _\n                    &amp; sClientFileVersion &amp; \".xlsm\"\n                    bFileExists = IsFile(sClientFileNameAndPath)\n                    If bFileExists = True Then\n                        bStayInLoop = False\n                        Exit For\n                        'GoTo exitLoop\n                    End If\n                Next iClientFileVersion\n\n                If bStayInLoop = True Then\n\n                    If iOriginalMonth - 1 = 0 And iClientFileMonth - 1 = 0 Then\n                        iClientFileMonth = 12\n                        iClientFileYear = iClientFileYear - 1\n                    ElseIf iClientFileMonth = iOriginalMonth Then\n                        iClientFileMonth = iClientFileMonth - 1\n                    Else\n                        iUserInput = 7 'Allows user to find file.\n                        bStayInLoop = False\n                    End If\n                End If\n\n        Loop\n\n        'This sets an opened file (or opens it) to the wbClientReport\n        If bFileExists = True Then\n            If BookOpen(sClientFileName) = True Then\n                Set wbClientReport = Workbooks(sClientFileName)\n            Else\n                Set wbClientReport = Workbooks.Open(sClientFileNameAndPath)\n            End If\n        End If\nEnd If\nIf iUserInput = 7 Then\n'This allows a user to select their own file.\n    Set objFileDialog = Application.FileDialog(msoFileDialogOpen)\n    With objFileDialog\n        .InitialFileName = sFilePath\n        .AllowMultiSelect = False\n        .Show\n        On Error Resume Next\n         sClientFileName = Dir(.SelectedItems.Item(1))\n        .Execute\n    End With\n'This sets an opened file (or opens it) to the wbClientReport\n    Set wbClientReport = Workbooks(sClientFileName)\nElseIf iUserInput = 6 Then\n    'Do nothing. Work has already been done.\nElse\n    'User pressed cancel\n    GoTo EndOfCode\nEnd If\n\nsSeoReportName = wbSeoReport.name\n\nIf ExcelInstances &gt; 1 Then 'This checks the instances of Excel, which could be an issue making formulas saving as values.\n    MsgBox \"There are \" &amp; str(ExcelInstances) &amp; \" instances of Excel open. Please close extra instances and start again.\"\n    Exit Sub\nEnd If\n\n'This code calls the function that sets the named ranges equal to each other to populate\n'the data from the SEO Report to the Client Report\n\nPopulate_Client_Template\n\n'This makes errors = 0 to look better for clients.\nFor Each replace_page In wbClientReport.Worksheets\n\n        replace_page.Cells.Replace what:=\"#DIV/0!\", Replacement:=\"0\", LookAt:=xlWhole, _\n        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n        ReplaceFormat:=False\nNext\nEndOfCode:\nApplication.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub Populate_Client_Template()\nDim replace_page As Worksheet\nDim label As String 'Used to identify one label in a named range.\nDim labels(1 To 1000) As String 'Used to store all of the named range labels.\nDim x As Long, z As Long 'x keeps track of the entry number in labels. z is a loop iterator.\nDim rngTitleRange As range\n\nx = 0\n\nlabels(x + 1) = \"Branded_Keywords\"\nx = x + 1\nlabels(x + 1) = \"Conversion_Rate_by_Source\"\nx = x + 1\n'...\n'This adds about 30 more names of the named ranges to the array \"labels\" to be iterated through in the following loop.\n\nOn Error Resume Next\n\nFor z = 1 To x + 1\n    Fill_Client_Report (labels(z)) 'Uses function to populate Client Report with data.\n    Fill_Client_Report (labels(z) &amp; \"_Titles\") 'Uses function to populate named ranges that have title info (ie column a in 13 month window).\nNext z\n\nEnd Sub\n\nSub Fill_Client_Report(label As String)\n\nDim wsClient_Page As Worksheet 'This is used to select the page on which a named range exists in the client report\nDim wsSeo_Page As Worksheet 'This is used to select the page on which a named range exists in the SEO Report\nDim rngTestRange As range 'This is used to check if a named range exists in the respective documents.\n\n\nwbSeoReport.Activate\nOn Error Resume Next\nSet rngTestRange = range(label)\nIf Not rngTestRange Is Nothing Then 'This checks if the named range exists in the SEO Report\n    Set wsSeo_Page = range(label).parent 'This sets the page containing the named range.\n    wbClientReport.Activate\n    Set rngTestRange = range(label)\n    If Not rngTestRange Is Nothing Then 'This checks if the named range exists in the Client Report\n        Set wsClient_Page = range(label).parent 'This sets the page containing the named range.\n    'The following sets the two ranges equal to populate the client report with seo report data.\n        wsClient_Page.range(label).value = wsSeo_Page.range(label).value\n    Else\n        'This shows is the named range isn't in the client report.\n        Debug.Print label\n    End If\nElse\n    'This shows if the named range isn't in the seo report.\n    Debug.Print label\nEnd If\n\nEnd Sub\n\nFunction IsFile(fName As String) As Boolean\n    'Returns TRUE if the provided name points to an existing file.\n    'Returns FALSE if not existing, or if it's a folder\n        On Error Resume Next\n        IsFile = ((GetAttr(fName) And vbDirectory) &lt;&gt; vbDirectory)\nEnd Function\n\n\nFunction BookOpen(strBookName As String) As Boolean\n    'This code checks if a workbook is open\n    Dim Bk As Workbook\n    On Error Resume Next\n    Set Bk = Workbooks(strBookName)\n    On Error GoTo 0\n    If Bk Is Nothing Then\n        BookOpen = False\n    Else\n        BookOpen = True\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "count", "sum", "sumifs", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1457463536, "post_id": 35874546, "comment_id": 59414838, "body": "One method to do so would be to use a helper column and then a sumifs() on the helper column, but I do not see that as much less work or faster than your current method."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 2770832, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f53e17904d915ce4508dd0e705273e7c?s=128&d=identicon&r=PG&f=1", "display_name": "TyloRen", "link": "https://stackoverflow.com/users/2770832/tyloren"}, "edited": false, "score": 0, "creation_date": 1457462722, "post_id": 35874697, "comment_id": 59414354, "body": "Thanks for the response.  The issue with this approach is that I need the identification of a unique row to be dynamic in the formula. My data set has 1,000 rows with upwards of 800 unique IDs; I can&#39;t do this formula 800+ times."}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "reply_to_user": {"reputation": 39, "user_id": 2770832, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f53e17904d915ce4508dd0e705273e7c?s=128&d=identicon&r=PG&f=1", "display_name": "TyloRen", "link": "https://stackoverflow.com/users/2770832/tyloren"}, "edited": false, "score": 0, "creation_date": 1457463413, "post_id": 35874697, "comment_id": 59414762, "body": "Can you provide an example of the dataset? Might be as simple as replacing the &quot;Product 1&quot; and &quot;Type 1&quot; etc. fields in the formula with cell references"}, {"owner": {"reputation": 111, "user_id": 4802868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7053c9d9457583a9a26b3711a3076311?s=128&d=identicon&r=PG&f=1", "display_name": "NikG", "link": "https://stackoverflow.com/users/4802868/nikg"}, "edited": false, "score": 0, "creation_date": 1457465456, "post_id": 35874697, "comment_id": 59416097, "body": "Sumifs should be your solution here. You just need to replace TheGuyThatDoesn&#39;tKnowMuch&#39;s formula with the references to each of 1, Product 1, Type 1, New, etc."}, {"owner": {"reputation": 39, "user_id": 2770832, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f53e17904d915ce4508dd0e705273e7c?s=128&d=identicon&r=PG&f=1", "display_name": "TyloRen", "link": "https://stackoverflow.com/users/2770832/tyloren"}, "edited": false, "score": 0, "creation_date": 1457477062, "post_id": 35874697, "comment_id": 59422329, "body": "Updated the original post with better sample data.  Essentially, within one cell I need to be able to input a formula that will sum the Number of Days column where &quot;Product&quot; is &quot;Nebula&quot;, &quot;Status&quot; is &quot;Won&quot;, and where there is a unique combination of &quot;ID&quot; and &quot;Product&quot;. The originally suggested formula will not work.  As you can see, you can have a product listed multiple times within an ID because it is associated with different items sold (these rows represent sales).  For the purposes of my calculation, the days should only be considered one time per product + ID combination."}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1457480223, "post_id": 35874697, "comment_id": 59423551, "body": "Edited my answer.  You can add a &quot;helper&quot; column that is the combination of ID and Product, then <code>SUMIFS</code> using that"}, {"owner": {"reputation": 39, "user_id": 2770832, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f53e17904d915ce4508dd0e705273e7c?s=128&d=identicon&r=PG&f=1", "display_name": "TyloRen", "link": "https://stackoverflow.com/users/2770832/tyloren"}, "edited": false, "score": 0, "creation_date": 1457498238, "post_id": 35874697, "comment_id": 59428611, "body": "I&#39;m not sure I follow. There is no column H in your example, the helper column is column G. Can you explain further?"}, {"owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "edited": false, "score": 0, "creation_date": 1457518514, "post_id": 35874697, "comment_id": 59438534, "body": "Column H would be a distinct list of what is created in Column G."}], "tags": [], "owner": {"reputation": 1240, "user_id": 3918993, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/aPf5t.jpg?s=128&g=1", "display_name": "TheGuyThatDoesn&#39;tKnowMuch", "link": "https://stackoverflow.com/users/3918993/theguythatdoesntknowmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1457480142, "last_edit_date": 1457480142, "creation_date": 1457460225, "answer_id": 35874697, "question_id": 35874546, "link": "https://stackoverflow.com/questions/35874546/excel-summing-a-column-based-upon-unique-values-in-another-column-plus-addition/35874697#35874697", "title": "Excel: Summing a column based upon unique values in another column plus additional criterea", "body": "<pre><code>=SUMIFS(E:E,A:A,1,B:B,\"Product 1\",C:C,\"Type 1\",D:D,\"New\")\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Add a helper column that is ID + Product, then use that for the <code>SUMIF</code></p>\n\n<pre><code>ID | Product   | Type       | Status   | Number of Days | Item   | Helper\n1  | Nebula    | New        | Won      | 3              | Module | 1Nebula\n1  | Nebula    | New        | Won      | 3              | Mobile | 1Nebula\n1  | Saturn    | Existing   | Won      | 3              | Module | 1Saturn\n2  | Nebula    | New        | Won      | 3              | Mobile | 2Nebula\n2  | Saturn    | Existing   | Won      | 3              | Mobile | 2Saturn\n3  | Mars      | New        | Lost     | 5              | Module | 3Mars\n</code></pre>\n\n<p>In this scenario, you would have a list of the unique labels in the <code>Helper</code> column, then use the following <code>SUMIFS</code> (assuming the distinct <code>Helper</code> list is in Column H)</p>\n\n<pre><code>=SUMIFS(E:E,G:G,H:H,B:B,\"Nebula\",D:D,\"Won\")\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2770832, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f53e17904d915ce4508dd0e705273e7c?s=128&d=identicon&r=PG&f=1", "display_name": "TyloRen", "link": "https://stackoverflow.com/users/2770832/tyloren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2047, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457480142, "creation_date": 1457459779, "last_edit_date": 1531161705, "question_id": 35874546, "link": "https://stackoverflow.com/questions/35874546/excel-summing-a-column-based-upon-unique-values-in-another-column-plus-addition", "title": "Excel: Summing a column based upon unique values in another column plus additional criterea", "body": "<p>I am trying to sum a column of numbers only in the instance where I have a unique row (defined by two columns) and only when certain other criteria are met. I am considering something as \"unique\" based upon the combination of two columns: the ID and Product (see below).  </p>\n\n<p>To use an example to illustrate what I am trying to do, I would want the sum for \"Number of Days\" where a unique value existed (based on ID and Product), and only where \"Type\" is equal to \"Nebula\" and \"Status\" is equal to \"Won\".</p>\n\n<p>Currently, my only way of doing this is to remove duplicate from my data based upon the ID and Product, and then use a PivotTable and filter to determine the averages.  However, my goal is to be able to write a formula in a cell so that this step is not required.</p>\n\n<pre><code>ID | Product   | Type       | Status   | Number of Days | Item\n1  | Nebula    | New        | Won      | 3              | Module\n1  | Nebula    | New        | Won      | 3              | Mobile\n1  | Saturn    | Existing   | Won      | 3              | Module\n2  | Nebula    | New        | Won      | 3              | Mobile\n2  | Saturn    | Existing   | Won      | 3              | Mobile\n3  | Mars      | New        | Lost     | 5              | Module\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1457459641, "post_id": 35874474, "comment_id": 59412714, "body": "That is not VB.NET code.  It looks like some form of VBA"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "edited": false, "score": 0, "creation_date": 1457494079, "post_id": 35880366, "comment_id": 59427585, "body": "Thanks quick reply  I have two problems  when U is 100 1. After running your macro in I3 Balance I am getting Rs 40, I want that zero &amp; T1 is 40 great and U1 is 60 great.   I want the Balance I3 to be zero, because the Rs 40 amount has been adjusted with the value of U1. U W Ycolumn are the excess column, where consumer paid us in advance so that if he paid Rs 10 out of Rs 50 then we should have balance 40 but he has already deposited Rs 100 in advance for us thats why the Rs 40 need to be adjusted &amp; should show on T1 &amp; with your code thats working but I need the I3 column to show zero"}, {"owner": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "edited": false, "score": 0, "creation_date": 1457494107, "post_id": 35880366, "comment_id": 59427589, "body": "2. when U 1 is having value less than balance  for example I1 Demand is 50 I2 collection is 10 &amp; balance showed 40, but U1 having value 10 then that Rs 10 need to be adjusted U1 should be 0 but with your code I am getting U1 -30.  &amp; I3 should be 50- collection 10 &amp; adjusted 10 hence I 3 should be 30 &amp; T1 should be 10  Same principle should apply for INS column associated with UWY column"}, {"owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "reply_to_user": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "edited": false, "score": 0, "creation_date": 1457528582, "post_id": 35880366, "comment_id": 59445532, "body": "Try stepping through the code using the debugger. You&#39;ll be able to see what the values are and how the if statements are working."}, {"owner": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "edited": false, "score": 0, "creation_date": 1457544054, "post_id": 35880366, "comment_id": 59457189, "body": "yes, but I don&#39;t understand VB coding, any help would have been better if possible... thanks"}], "tags": [], "owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "is_accepted": false, "score": 1, "last_activity_date": 1457481107, "creation_date": 1457481107, "answer_id": 35880366, "question_id": 35874474, "link": "https://stackoverflow.com/questions/35874474/multiple-conditional-vb-macro-in-excel-simple-code-modification-required/35880366#35880366", "title": "Multiple Conditional VB Macro in Excel, simple code modification required", "body": "<p>I think this is what you want:</p>\n\n<pre><code>    Sub DCB()\n Dim c As Range\n Dim lRow As Long\n lRow = 1\n Dim lRowLast As Long\n Dim lRowDiff As Long\n Dim lRowPortion As Long\n lRowPortion = 1\n Dim bFoundCollection As Boolean\n Dim lRowLastDemand As Long\n\n\n With ActiveSheet\n  lRowLast = .Cells(.Rows.Count, 1).End(xlUp).row\n  Do\n   Set c = .Range(\"A\" &amp; lRow)\n   If c.Value Like \"*COLLECTION*\" Then\n    bFoundCollection = True\n   ElseIf c.Value Like \"*DEMAND*\" Then\n    lRowLastDemand = lRow\n   ElseIf bFoundCollection Then\n    bFoundCollection = False\n    If c.Value &lt;&gt; \"BALANCE\" Then\n     c.EntireRow.Insert\n     lRowLast = lRowLast + 1\n     Set c = c.Offset(-1, 0)\n     c.Value = \"BALANCE\"\n    End If\n    If c.Value = \"BALANCE\" Then\n     .Range(c, c.Offset(0, 18)).Font.Color = RGB(0, 0, 0)\n     .Range(c, c.Offset(0, 18)).Interior.Color = RGB(200, 200, 200)\n     lRowDiff = c.row - lRowPortion\n     .Range(c.Offset(0, 3), c.Offset(0, 18)).FormulaR1C1 = _\n      \"=SUMIF(R[-\" &amp; lRowDiff &amp; \"]C1:RC1, \"\"*DEMAND*\"\", R[-\" &amp; lRowDiff &amp; \"]C:RC)\" &amp; _\n      \"-SUMIF(R[-\" &amp; lRowDiff &amp; \"]C1:RC1, \"\"*COLLECTION*\"\", R[-\" &amp; lRowDiff &amp; \"]C:RC)\"\n      If ((.Cells(lRow, 9)) &gt; 0) And (.Cells(lRowLastDemand, 21) &gt; 0) Then 'If Column I Balance &gt; 0 and U has value\n         .Cells(lRowLastDemand, 20) = .Cells(lRow, 9) 'T1 = Balance\n         .Cells(lRowLastDemand, 21) = .Cells(lRowLastDemand, 21) - .Cells(lRow, 9) 'Adjust Col U\n      End If\n      If ((.Cells(lRow, 14)) &gt; 0) And (.Cells(lRowLastDemand, 23) &gt; 0) Then 'If Column N Balance &gt; 0 and W has value\n         .Cells(lRowLastDemand, 22) = .Cells(lRow, 14) 'V1 = Balance\n         .Cells(lRowLastDemand, 23) = .Cells(lRowLastDemand, 23) - .Cells(lRow, 14) 'Adjust Col W\n      End If\n      If ((.Cells(lRow, 19)) &gt; 0 And (.Cells(lRowLastDemand, 25) &gt; 0)) Then 'If Column S Balance &gt; 0 and Y has value\n         .Cells(lRowLastDemand, 24) = .Cells(lRow, 19) 'X1 = Balance\n         .Cells(lRowLastDemand, 25) = .Cells(lRowLastDemand, 25) - .Cells(lRow, 19) 'Adjust Col Y\n      End If\n     lRowPortion = c.row + 1\n    End If\n   End If\n   lRow = lRow + 1\n  Loop While lRow &lt;= lRowLast + 1\n End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5700175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/faed7c28a00b8fe3eb9ba535d5c88828?s=128&d=identicon&r=PG&f=1", "display_name": "Jyotirmaya Chandra", "link": "https://stackoverflow.com/users/5700175/jyotirmaya-chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457521180, "creation_date": 1457459542, "last_edit_date": 1457521180, "question_id": 35874474, "link": "https://stackoverflow.com/questions/35874474/multiple-conditional-vb-macro-in-excel-simple-code-modification-required", "title": "Multiple Conditional VB Macro in Excel, simple code modification required", "body": "<p>I am using the following code to calculate the Balance from the data, Balance = Demand - collection</p>\n\n<p>Code:</p>\n\n<pre><code>Sub DCB()\n Dim c As Range\n Dim lRow As Long\n lRow = 1\n Dim lRowLast As Long\n Dim lRowDiff As Long\n Dim lRowPortion As Long\n lRowPortion = 1\n Dim bFoundCollection As Boolean\n With ActiveSheet\n  lRowLast = .Cells(.Rows.Count, 1).End(xlUp).Row\n  Do\n   Set c = .Range(\"A\" &amp; lRow)\n   If c.Value Like \"*COLLECTION*\" Then\n    bFoundCollection = True\n   ElseIf bFoundCollection Then\n    bFoundCollection = False\n    If c.Value &lt;&gt; \"BALANCE\" Then\n     c.EntireRow.Insert\n     lRowLast = lRowLast + 1\n     Set c = c.Offset(-1, 0)\n     c.Value = \"BALANCE\"\n    End If\n    If c.Value = \"BALANCE\" Then\n     .Range(c, c.Offset(0, 18)).Font.Color = RGB(0, 0, 0)\n     .Range(c, c.Offset(0, 18)).Interior.Color = RGB(200, 200, 200)\n     lRowDiff = c.Row - lRowPortion\n     .Range(c.Offset(0, 3), c.Offset(0, 18)).FormulaR1C1 = _\n      \"=SUMIF(R[-\" &amp; lRowDiff &amp; \"]C1:RC1, \"\"*DEMAND*\"\", R[-\" &amp; lRowDiff &amp; \"]C:RC)\" &amp; _\n      \"-SUMIF(R[-\" &amp; lRowDiff &amp; \"]C1:RC1, \"\"*COLLECTION*\"\", R[-\" &amp; lRowDiff &amp; \"]C:RC)\"\n     lRowPortion = c.Row + 1\n    End If\n   End If\n   lRow = lRow + 1\n  Loop While lRow &lt;= lRowLast + 1\n End With\nEnd Sub\n</code></pre>\n\n<p>But I have some problems now, there are some conditions to be applied while calculating the balance. The columns U W Y are the Excess amount columns and the value of those columns are depended for I N S columns Balance amount respectively.</p>\n\n<p>For example in I1 demand is 50 collection is 10 so as per the formula, Balance = Demand - collection hence 50-10 = 40, but there are values in U column, I want that the rest 40 amount should be deducted from the U column &amp; balance should show 0 and the adjusted 40 amount should show on T1 column.</p>\n\n<p>I want the above macro to be tweaked, at first the value of I2 should be checked if the value of I2 is greater than I1 then no problem, simple formula will apply B= D-C, but if value of I2 is less than I1 or the value of I2 is 0, then it will check if there are some value in U1, if have some value then that amount will be adjusted accordingly and adjusted amount should show in T1.</p>\n\n<p>Similarly N column is associated with W column and adjusted amount will show on V column &amp; S column is associated with Y column and adjusted amount will show on X column.\n<a href=\"https://i.stack.imgur.com/9GhhZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9GhhZ.jpg\" alt=\"Kindly check the image\"></a></p>\n"}]