[{"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "edited": false, "score": 0, "creation_date": 1496282942, "post_id": 44296020, "comment_id": 75600698, "body": "This is a maze! My advice is not to go there. Basically, the font for the bullet is specified differently and separately from the font of the text. There is a myriad of objects, some of them not accessible the way you might expect, none of them well documented and no documentation at all about how they work together. If you insist, the best help I found is available at <a href=\"http://www.shaunakelly.com/word/bullets/controlbullets20072010.html\" rel=\"nofollow noreferrer\">shaunakelly.com/word/bullets/controlbullets20072010.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 8094710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6b455e4b169e4b89e9625149de1e6afa?s=128&d=identicon&r=PG&f=1", "display_name": "Socrates", "link": "https://stackoverflow.com/users/8094710/socrates"}, "edited": false, "score": 0, "creation_date": 1496585810, "post_id": 44305453, "comment_id": 75711965, "body": "you got it right!! i needed the color of the text that comes after the bullet. but in most cases the starting bullet character matches the color so didn&#39;t felt the need to clarify."}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 0, "last_activity_date": 1496313941, "creation_date": 1496313941, "answer_id": 44305453, "question_id": 44296020, "link": "https://stackoverflow.com/questions/44296020/vbamsword-cant-find-bullet-points-with-a-specific-rgb-color/44305453#44305453", "title": "VBA(MSWord): cant find Bullet points with a specific rgb color", "body": "<p>It is not <code>Font</code> that the compiler is objecting to but <code>Color</code>. When looking for the font colour of a <code>Range</code> you need to look at the <code>Fill</code> properties.</p>\n\n<p>If you adjust your code to <code>objParagraph.Range.Font.Fill.ForeColor.RGB</code> you will then be able to compile your code.</p>\n\n<p>I take it from your code that you are looking for the colour of the text that follows the bullet and not the bullet character? If you are looking for the colour of the bullet character then please see the comment from Variatus.</p>\n"}, {"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1496376977, "last_edit_date": 1496376977, "creation_date": 1496376327, "answer_id": 44320595, "question_id": 44296020, "link": "https://stackoverflow.com/questions/44296020/vbamsword-cant-find-bullet-points-with-a-specific-rgb-color/44320595#44320595", "title": "VBA(MSWord): cant find Bullet points with a specific rgb color", "body": "<p>The comment made by @Variatus is absolutely correct. There are a variety of ways of colouring a bullet point and you'd need to know what the author has done before writing your code.</p>\n\n<p>It is possible to colour a bullet point by highlighting a paragraph and colouring the text. The bullet point will adopt the colour of your last, ie paragraph, character. If the paragraph contains multiple colours then the <code>Paragraph.Font.Color</code> property will return 'all the 9s', so your best bet would be to test the colour of the last character.</p>\n\n<p>Assuming this is the way you want to test the bullet point colour - and that's a BIG assumption - then the problem with your code lies not in the <code>Font</code> property but in the fact that <code>RGB</code> is not a property of <code>Color</code>. <code>RGB()</code> is a function that returns a long from your RGB values, so you need to compare the <code>Color</code> value with <code>RGB(r,b,g)</code> according to the following syntax:</p>\n\n<p><code>If ... .Font.Color = RGB(r, b, g) Then</code></p>\n\n<p>Your corrected code would therefore be something like this:</p>\n\n<pre><code>Dim rng As Range\nDim para As Paragraph\nDim myCyan As Long, myPurple As Long, myGreen As Long\nDim cyanCount As Long, purpleCount As Long, greenCount As Long\n\nmyCyan = RGB(51, 204, 204)\nmyPurple = RGB(204, 153, 255)\nmyGreen = RGB(0, 176, 80)\n\nSet rng = Selection.Range\nFor Each para In rng.Paragraphs\n    With para.Range\n        If .ListFormat.ListType = wdListBullet Then\n            Select Case .Characters.Last.Font.Color\n                Case myCyan: cyanCount = cyanCount + 1\n                Case myPurple: purpleCount = purpleCount + 1\n                Case myGreen: greenCount = greenCount + 1\n            End Select\n        End If\n    End With\nNext\n\nMsgBox \"Cyan=\" &amp; cyanCount &amp; \", \" &amp; _\n       \"Purple=\" &amp; purpleCount &amp; \", \" &amp; _\n       \"Green=\" &amp; greenCount\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8094710, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6b455e4b169e4b89e9625149de1e6afa?s=128&d=identicon&r=PG&f=1", "display_name": "Socrates", "link": "https://stackoverflow.com/users/8094710/socrates"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 44305453, "answer_count": 2, "score": 0, "last_activity_date": 1496376977, "creation_date": 1496272066, "last_edit_date": 1496272437, "question_id": 44296020, "link": "https://stackoverflow.com/questions/44296020/vbamsword-cant-find-bullet-points-with-a-specific-rgb-color", "title": "VBA(MSWord): cant find Bullet points with a specific rgb color", "body": "<p>I want to count all bullet points in a text consisting of three different colored bullets which are not index colors but costume RGBs (<em>e.g.</em> 51, 204, 204). And then want to display how many were of each color (<em>e.g.</em> 42 with blue)\nSo came up with this but doesn't compile and says \"invalid qualifier\" pointing to \".Font\" which i highlighted in the code:</p>\n\n<pre><code>Sub GetNumberOfBullets()\n\n   Dim objRange As Range\n   Dim objParagraph As Paragraph\n   Dim nNumber As Integer\n\n   '  Initialization\n   Set objRange = Selection.Range\n   nNumber = 0\n   cyannum = 0\n   purplenum = 0\n   greennum = 0\n\n   For Each objParagraph In objRange.Paragraphs\n   If objParagraph.Range.ListFormat.ListType = WdListType.wdListBullet Then\n     nNumber = nNumber + 1\n     If objParagraph.Range`.Font`.Color.RGB = RGB(51, 204, 204) Then\n        cyannum = cyannum + 1\n        End If\n     If objParagraph.Range`.Font`.Color.RGB = RGB(204, 153, 255) Then\n        purplenum = purplenum + 1\n        End If\n     If objParagraph.Range`.Font`.Color.RGB = RGB(0, 176, 80) Then\n        greennum = greennum + 1\n        End If\n     End If\n   Next objParagraph\n\n   '  Pop up a message box to show the total number of bullets.\n   MsgBox (\"Bullet number:\" &amp; nNumber &amp; \"Cyan number:\" &amp; cyannum &amp; \"Purple number:\" &amp; purplenum &amp; \"Green number:\" &amp; greennum)\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "pdf"], "answers": [{"comments": [{"owner": {"reputation": 1010, "user_id": 7885853, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/SaqmO.jpg?s=128&g=1", "display_name": "YvetteLee", "link": "https://stackoverflow.com/users/7885853/yvettelee"}, "edited": false, "score": 0, "creation_date": 1496331532, "post_id": 44295656, "comment_id": 75629326, "body": "Thank you for your reply. Is it possible to use the following code and have the same result."}, {"owner": {"reputation": 1010, "user_id": 7885853, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/SaqmO.jpg?s=128&g=1", "display_name": "YvetteLee", "link": "https://stackoverflow.com/users/7885853/yvettelee"}, "edited": false, "score": 0, "creation_date": 1496331565, "post_id": 44295656, "comment_id": 75629354, "body": "DoCmd.OutputTo acForm, &quot;FormName&quot;, acFormatPDF, FileName, False"}, {"owner": {"reputation": 1010, "user_id": 7885853, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/SaqmO.jpg?s=128&g=1", "display_name": "YvetteLee", "link": "https://stackoverflow.com/users/7885853/yvettelee"}, "edited": false, "score": 0, "creation_date": 1496331626, "post_id": 44295656, "comment_id": 75629389, "body": "Output the form and fit in one page."}], "tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": true, "score": 1, "last_activity_date": 1496269816, "creation_date": 1496269816, "answer_id": 44295656, "question_id": 44295441, "link": "https://stackoverflow.com/questions/44295441/access-vba-outputto-to-pdf/44295656#44295656", "title": "Access VBA OutPutTo to PDF", "body": "<p>Resize your report so that it fits on one page, and set the page orientation of the report to Landscape...</p>\n\n<p>To set the Page layout, goto Print Preview, then click Page Setup on the Ribbon, adjust the page Orientation, and save the report.</p>\n"}], "owner": {"reputation": 1010, "user_id": 7885853, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/SaqmO.jpg?s=128&g=1", "display_name": "YvetteLee", "link": "https://stackoverflow.com/users/7885853/yvettelee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 0, "accepted_answer_id": 44295656, "answer_count": 1, "score": 1, "last_activity_date": 1496270630, "creation_date": 1496268555, "last_edit_date": 1496270630, "question_id": 44295441, "link": "https://stackoverflow.com/questions/44295441/access-vba-outputto-to-pdf", "title": "Access VBA OutPutTo to PDF", "body": "<p>I am using the following code:</p>\n\n<pre><code> DoCmd.OutputTo acReport, \"ReportName\", acFormatPDF, fileName, False\n</code></pre>\n\n<p>I need the output pdf to fit in one page and view page horizontal. Now I am getting vertical and 3 pages.</p>\n\n<p>thank you. </p>\n"}, {"tags": ["sql", "vba", "oledb"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496268357, "post_id": 44295290, "comment_id": 75597051, "body": "Not sure what you mean about delimiting for the country code. Do you mean to have another field in Table1 that has the country codes? Sadly I don&#39;t have control over this output."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496268786, "post_id": 44295290, "comment_id": 75597176, "body": "That requires knowing for each dial code what the country code is before hand. Seems kinda suggesting to put the cart in front of the horse? The intent of the query is actually to find the country codes that relate to each dial code. I cannot change the structure of Table1. I can change Table2 if required though doesn&#39;t seem like it would add anything. Anything you can suggest in regards to the query itself?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "reply_to_user": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496269258, "post_id": 44295290, "comment_id": 75597354, "body": "From my example &#39;7708&#39;, first try to find a match with the 4 digits. If no match drop a digit and repeat. Go until a match is found from the country codes list. In this case first match would be &#39;77&#39;, before it would match &#39;7&#39;, hence that should be the country code (&#39;77&#39;) for this dial code."}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496336495, "post_id": 44295706, "comment_id": 75632071, "body": "Thank you for your answer. This works as required in SO Data Explorer but fails through VBA/ACE OLEDB with error &quot;Syntax error (missing operator) in query expression &#39;row_number() OVER (PARTITION BY bcr.DialCode ORDER BY cc.cc_len DESC)&#39;.&quot; Any suggestion to resolve?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496346313, "post_id": 44295706, "comment_id": 75637341, "body": "Searching online seems that ACE OLEDB/Access don&#39;t support &#39;ROW_NUMBER&#39; function. Thanks for your efforts though."}], "tags": [], "owner": {"reputation": 14370, "user_id": 2095534, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d3c704aafdd6b320be07e0fc21964b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kamil Gosciminski", "link": "https://stackoverflow.com/users/2095534/kamil-gosciminski"}, "is_accepted": false, "score": 0, "last_activity_date": 1496270075, "creation_date": 1496270075, "answer_id": 44295706, "question_id": 44295290, "link": "https://stackoverflow.com/questions/44295290/left-join-on-longest-match/44295706#44295706", "title": "Left Join on Longest Match", "body": "<p>I've modified your solution from data.stackexchange with following things:</p>\n\n<ul>\n<li>added length of country code</li>\n<li>changed join condition to <code>LIKE</code> matching the pattern</li>\n<li>added <code>row_number</code> function to properly assign the priority of length matching</li>\n<li>added another select statement level to choose those with longest match <code>rn = 1</code></li>\n</ul>\n\n<hr>\n\n<p>Here's the modified query:</p>\n\n<pre><code>SELECT DialCode, Destination, CountryCode\nFROM (\n  SELECT\n      STR(bcr.DialCode) as DialCode,\n      bcr.Destination,\n      LTRIM(STR(cc.CountryCode)) as CountryCode,\n      row_number() OVER (PARTITION BY bcr.DialCode ORDER BY cc.cc_len DESC) AS rn\n  FROM @Table1 AS bcr \n  LEFT JOIN\n      (\n      SELECT CountryCode, LEN(CountryCode) AS cc_len\n      FROM @Table2\n      ) AS cc \n      ON bcr.DialCode LIKE CONCAT(cc.CountryCode, '%')\n    ) x\nWHERE rn = 1\n;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496336858, "post_id": 44297492, "comment_id": 75632269, "body": "Errors out in SO Data Explorer with &quot;Column &#39;@Table2.CountryCode&#39; is invalid in the HAVING clause because it is not contained in either an aggregate function or the GROUP BY clause.&quot; Also errors in VBA/ACE OLEDB with error &quot;Your query does not include the specified expression &#39;TRIM(STR(bcr.DialCode))&#39; as part of an aggregate function.&quot; Any suggestions to resolve?"}, {"owner": {"reputation": 734, "user_id": 1228379, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4f560996a3b0ecf96e6320f44a338e21?s=128&d=identicon&r=PG", "display_name": "inarilo", "link": "https://stackoverflow.com/users/1228379/inarilo"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496393872, "post_id": 44297492, "comment_id": 75654225, "body": "try with where instead of having. btw why do you need trim(str())?"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496433498, "post_id": 44297492, "comment_id": 75676922, "body": "I did try &#39;WHERE&#39; as one of my random flailings but that produced an error as well. The ACE OLEDB implementaion of SQL turned out a bit trickier than I thought. I managed to solve the issue though by rewritting the query. I just pulled all the matches in a subquery, sort by LEN(cc.CountryCode) and then group all the rows but only keep LAST(t.CountryCode). I did the trim as for some reason when converting to string it was adding a blank space in front. Not sure why. Thanks for your help. Regards"}, {"owner": {"reputation": 734, "user_id": 1228379, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4f560996a3b0ecf96e6320f44a338e21?s=128&d=identicon&r=PG", "display_name": "inarilo", "link": "https://stackoverflow.com/users/1228379/inarilo"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496472932, "post_id": 44297492, "comment_id": 75685506, "body": "you should post your solution as an answer and accept it :)"}], "tags": [], "owner": {"reputation": 734, "user_id": 1228379, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4f560996a3b0ecf96e6320f44a338e21?s=128&d=identicon&r=PG", "display_name": "inarilo", "link": "https://stackoverflow.com/users/1228379/inarilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1496393771, "last_edit_date": 1496393771, "creation_date": 1496283745, "answer_id": 44297492, "question_id": 44295290, "link": "https://stackoverflow.com/questions/44295290/left-join-on-longest-match/44297492#44297492", "title": "Left Join on Longest Match", "body": "<pre><code>SELECT\nTOP 1 TRIM(STR(bcr.DialCode)) as DialCode,\nbcr.Destination,\nTRIM(STR(cc.CountryCode)) as CountryCode\nFROM table1 AS bcr \nINNER JOIN table2 AS cc\nON cc.CountryCode = LEFT(bcr.DialCode, LEN(cc.CountryCode))\nWHERE LEN(cc.CountryCode) = MAX(LEN(cc.CountryCode));\n</code></pre>\n"}], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1496393771, "creation_date": 1496267795, "last_edit_date": 1610973137, "question_id": 44295290, "link": "https://stackoverflow.com/questions/44295290/left-join-on-longest-match", "title": "Left Join on Longest Match", "body": "<p>As context I am running a SQL query in VBA using ACE OLEDB.</p>\n<p>The intent of the query is to match dial codes with their destination country. The difficulty is that the match is done not on all digits but to the country code that has the most left matching digits. For example for dial code '7708' it should match to country code '77' (Kazakhstan) but my current code also pulls in '7' (Russia) to the results.</p>\n<p>Current query is as follows:</p>\n<pre><code>SELECT\n    TRIM(STR(bcr.DialCode)) as DialCode,\n    bcr.Destination,\n    TRIM(STR(cc.CountryCode)) as CountryCode\nFROM table1 AS bcr \nLEFT JOIN\n    (\n        SELECT CountryCode\n        FROM table2\n        ORDER BY LEN(CountryCode) DESC\n    ) AS cc \nON cc.CountryCode = LEFT(bcr.DialCode, LEN(cc.CountryCode))\nORDER BY LEN(cc.CountryCode) DESC;\n</code></pre>\n<p>Mock up of schema and query here: <a href=\"https://data.stackexchange.com/stackoverflow/query/679084/left-join-on-longest-match\" rel=\"nofollow noreferrer\">https://data.stackexchange.com/stackoverflow/query/679084/left-join-on-longest-match</a> . I had to remove the 'ORDER BY' as it would not accept this command. Don't think it changed the results though. Also had to change TRIM to LTRIM.</p>\n<p>As you can see on the results, it doubles each Table1 row for '7' and '77' in the results. Would want only '77' for that particular sample of dial codes. Any guidance is much appreciated. Regards,</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1496266996, "post_id": 44295081, "comment_id": 75596549, "body": "What does &#39;n&#39; point to when it fails? All rows or somewhere further down? What is the &#39;format&#39; of that cell versus prior?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1496267180, "post_id": 44295081, "comment_id": 75596627, "body": "I&#39;m unclear on why <code>.Text</code> is there at all. <code>Dn.Characters(n, 1)</code> is all that is necessary. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198232.aspx\" rel=\"nofollow noreferrer\">Official docs</a> do not show .Text as a property of Range.Characters although I suppose it could be inherited as a subset Range object. .Text is the <b>displayed value</b> and can include extraneous characters and/or spaces from cell formatting; .Value does not."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496267480, "post_id": 44295081, "comment_id": 75596740, "body": "@Jeeped - The <code>Range.Characters</code> property returns a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194098.aspx\" rel=\"nofollow noreferrer\"><code>Characters</code> object</a> which has a <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838596.aspx\" rel=\"nofollow noreferrer\"><code>Text</code> property</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1496267673, "post_id": 44295081, "comment_id": 75596808, "body": "Right. So <code>=TODAY()</code> in a cell formatted as <code>dd-mmm-yyyy</code> produces <code>31-May-2017</code> for .Text, <code>05&#47;31&#47;2017</code> for .Value (depending a little on regional settings) and <code>42886</code> for .Value2. So why use <code>For n = 1 To Len(Dn.Value)</code> and then <code>Dn.Characters(n, 1).Text</code>?"}, {"owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 0, "creation_date": 1496267950, "post_id": 44295081, "comment_id": 75596913, "body": "Ok I have found the culprit, <code>.Text</code> doesn&#39;t like it when there is no text found,  and there are only numbers. So the solution to my question now is how can I alter it so that it is happy to look at column cells that contain text and numbers, as well as column cells with numbers (But not do anything with them obviously)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496268163, "post_id": 44295081, "comment_id": 75596972, "body": "@Jeeped - you have to use the <code>.Text</code> property of the <code>Characters</code> object to access the text - it doesn&#39;t have a default property as far as I can see.  But it appears the <code>Characters</code> object of a cell containing a date does not have a <code>Text</code> property (which sort of makes sense)."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1496268208, "post_id": 44295081, "comment_id": 75596991, "body": "Are you just trying to do <code>Mid(Dn.Value, n, 1)</code>?  Why use a <code>Characters</code> object at all?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1496268432, "post_id": 44295081, "comment_id": 75597068, "body": "<code>if IsNumeric(Mid(Dn.Value, n, 1)) then</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496268496, "post_id": 44295081, "comment_id": 75597083, "body": "And FWIW, a cell containing a formula will also cause the <code>Characters</code> object to not have a <code>Text</code> property (which also makes sense).  Basically, the Characters.Text property seems to only be available on cells containing constant strings."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496269307, "post_id": 44295081, "comment_id": 75597376, "body": "depends if you want numbers or only digits <a href=\"https://www.google.com/search?q=excel+vba+extract+numbers+from+text\" rel=\"nofollow noreferrer\">google.com/search?q=excel+vba+extract+numbers+from+text</a>"}, {"owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "edited": false, "score": 0, "creation_date": 1496298046, "post_id": 44295081, "comment_id": 75605030, "body": "If I have a column with cells that contain data like <code>TRFG1234</code> (Could be any combination of letters and numbers), all I really want in this cell for example is <code>1234</code> that is all"}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "is_accepted": false, "score": 0, "last_activity_date": 1496299347, "creation_date": 1496299347, "answer_id": 44300257, "question_id": 44295081, "link": "https://stackoverflow.com/questions/44295081/unable-to-get-the-text-property-of-the-characters-class-no-change-to-line-causi/44300257#44300257", "title": "unable to get the text property of the characters class, no change to line causing error", "body": "<p>With help from the commenters, this section of code works better to perform the task of number extraction:</p>\n\n<pre><code>   For n = 1 To Len(Dn.Value)\n    If IsNumeric(Mid(Dn.Value, n, 1)) Then\n        nStr = nStr &amp; Mid(Dn.Value, n, 1)\n    End If\nNext n\n</code></pre>\n"}], "owner": {"reputation": 445, "user_id": 2401697, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4a1cce666166e60904a00071f2766319?s=128&d=identicon&r=PG", "display_name": "Aurelius", "link": "https://stackoverflow.com/users/2401697/aurelius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 549, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496299347, "creation_date": 1496266690, "last_edit_date": 1496268070, "question_id": 44295081, "link": "https://stackoverflow.com/questions/44295081/unable-to-get-the-text-property-of-the-characters-class-no-change-to-line-causi", "title": "unable to get the text property of the characters class, no change to line causing error", "body": "<p>I have a sub that will be passed a column letter, and for row 2 to the last row of that column, extract only the numbers from the cells and overwrite the cells with those numbers.`</p>\n\n<pre><code>Sub ExtractNumbersInColumn(ColWithNums As String)\n\nDim Rng As Range, Dn As Range, nStr As String, n As Long\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"RefindData\")\n\nDim rngStart As Range\nDim rngEnd As Range\n\nSet rngStart = ws.Range(ColWithNums &amp; \"2\")\nSet rngEnd = ws.Range(ColWithNums &amp; Rows.Count).End(xlUp)\nSet Rng = ws.Range(rngStart, rngEnd)\n\nFor Each Dn In Rng\n\nFor n = 1 To Len(Dn.Value)\n    If Dn.Characters(n, 1).Text Like \"[0-9]\" Then\n        nStr = nStr &amp; Dn.Characters(n, 1).Text\n    End If\nNext n\n\nDn = Val(nStr): nStr = \"\"\n\nNext Dn\n\nEnd Sub`\n</code></pre>\n\n<p>I am getting an issue with this line:</p>\n\n<pre><code> If Dn.Characters(n, 1).Text Like \"[0-9]\" Then\n</code></pre>\n\n<p>with the error - \"unable to get the text property of the characters class\"</p>\n\n<p>After doing a little research this problem appears with older versions of Excel. I am using 2003. However, the simplified version of this code:</p>\n\n<pre><code>  Sub MG31May23\nDim Rng As Range, Dn As Range, nStr As String, n As Long\nSet Rng = Range(Range(\"A1\"), Range(\"A\" &amp; Rows.Count).End(xlUp))\nFor Each Dn In Rng\nFor n = 1 To Len(Dn.Value)\n    If Dn.Characters(n, 1).Text Like \"[0-9]\" Then\n        nStr = nStr &amp; Dn.Characters(n, 1).Text\n    End If\nNext n\nDn.Offset(, 1) = Val(nStr): nStr = \"\"\nNext Dn\nEnd Sub\n</code></pre>\n\n<p>Works fine, and that particular line is not changed.</p>\n\n<p>Any ideas?</p>\n\n<p>EDIT:</p>\n\n<p>I have discovered that it does not like to look at a cell containing only numbers otherwise <code>.Text</code> will kick up a fuss. So the real question now is how can I alter this for it to be happy looking at cells that contain letters and numbers, as well as just numbers (but not do anything with obviously)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496266074, "post_id": 44294918, "comment_id": 75596174, "body": "Is it only pulling from files with names starting with the letters &quot;A&quot; to &quot;L&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1496266769, "post_id": 44294918, "comment_id": 75596457, "body": "You might think about putting a file mask so that you are only dealing with workbooks (e.g. <code>MyFile = Dir(&quot;T:\\Sales Orders\\2017\\May\\*.xl*&quot;)</code>). Windows will put system files like <code>thumbs.db</code> that will really foul up a loop like yours."}, {"owner": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "edited": false, "score": 0, "creation_date": 1496429415, "post_id": 44294918, "comment_id": 75675115, "body": "YowE3K - No, there doesn&#39;t seem to be any rhyme or reason to the files that get skipped."}, {"owner": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "edited": false, "score": 0, "creation_date": 1496429534, "post_id": 44294918, "comment_id": 75675157, "body": "Jeeped - Thanks for the tip!  All the files in this folder are excel workbooks."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "edited": false, "score": 0, "creation_date": 1496429609, "post_id": 44295019, "comment_id": 75675195, "body": "Thank you!  I&#39;ve tried this, but now the macro just wants to run through the files indefinitely.  Any ideas?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "edited": false, "score": 0, "creation_date": 1496431170, "post_id": 44295019, "comment_id": 75675912, "body": "@L.Oldenburg did you place the label <code>NextFile:</code> <b>before</b> the line <code>MyFile = Dir</code> ?"}, {"owner": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "edited": false, "score": 0, "creation_date": 1496445169, "post_id": 44295019, "comment_id": 75681026, "body": "Here&#39;s what I did:Sub LoopThroughDirectory() Dim MyFile As String Dim erow Dim Filepath As String Filepath = &quot;T:\\Sales Orders\\2017\\May\\&quot; NextFile: MyFile = Dir(&quot;T:\\Sales Orders\\2017\\May\\&quot;)  Do While Len(MyFile) &gt; 0 If MyFile = &quot;maytt.xlsm&quot; Then GoTo NextFile End If  Workbooks.Open (&quot;T:\\Sales Orders\\2017\\May\\&quot; &amp; MyFile) Range(&quot;F1:F7&quot;).Copy ActiveWorkbook.Close  ecolumn = Sheet1.Cells(Columns.Count).End(xlToLeft).Offset(0, 1).Column   ActiveSheet.Paste Destination:=Worksheets(&quot;Summary&quot;).Range(Cells(1, ecolumn), Cells(7, ecolumn))   MyFile = Dir Loop  End Sub"}, {"owner": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "edited": false, "score": 0, "creation_date": 1496445338, "post_id": 44295019, "comment_id": 75681059, "body": "As it turns out though, I was mistaken previously.  The code is still skipping about half of the files in my folder, but now it starts over again when it reaches the end (pulling the same files)."}, {"owner": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "edited": false, "score": 0, "creation_date": 1497549302, "post_id": 44295019, "comment_id": 76136627, "body": "I have the &quot;NextFile:&quot; on the line directly above &quot;MyFile = Dir&quot;"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1496266613, "last_edit_date": 1496266613, "creation_date": 1496266341, "answer_id": 44295019, "question_id": 44294918, "link": "https://stackoverflow.com/questions/44294918/loopthrough-function-skipping-files/44295019#44295019", "title": "LoopThrough function skipping files", "body": "<p>It looks like you want to <em>skip</em> the file <code>\"maytt.xlsm\"</code> but what you are actually doing is stopping the whole thing (<code>Then Exit Sub</code>) when that file is reached. To skip the file and continue, do the following modifications to the code:</p>\n\n<p>1- Add a line label before the <code>myFile = Dir</code> statement:</p>\n\n<pre><code>NextFile: ' &lt;---------Add this\n        MyFile = Dir\n    Loop\n</code></pre>\n\n<p>2- Replace <code>Exit Sub</code> with <code>Goto NextFile</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8094447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da736364318022e1b062300b555c3181?s=128&d=identicon&r=PG&f=1", "display_name": "L. Oldenburg", "link": "https://stackoverflow.com/users/8094447/l-oldenburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496279329, "creation_date": 1496265890, "last_edit_date": 1496279329, "question_id": 44294918, "link": "https://stackoverflow.com/questions/44294918/loopthrough-function-skipping-files", "title": "LoopThrough function skipping files", "body": "<p>I'm new to the site and in need of some help.  I've created a Macro within excel to pull the values from certain cells in workbooks within a folder and consolidate that information.  The code seems to be working, Except that it's only pulling from about half of the workbooks in the folder.  Does anyone know Why it's doing this and how I can fix it?</p>\n\n<pre><code>Sub LoopThroughDirectory()\n  Dim MyFile As String\n  Dim erow\n  Dim Filepath As String\n  Filepath = \"T:\\Sales Orders\\2017\\May\\\"\n  MyFile = Dir(\"T:\\Sales Orders\\2017\\May\\\")\n\n  Do While Len(MyFile) &gt; 0\n    If MyFile = \"maytt.xlsm\" Then\n      Exit Sub\n    End If\n\n    Workbooks.Open (\"T:\\Sales Orders\\2017\\May\\\" &amp; MyFile)\n    Range(\"F1:F7\").Copy\n    ActiveWorkbook.Close\n\n    ecolumn = Sheet1.Cells(Columns.Count).End(xlToLeft).Offset(0, 1).Column\n\n\n    ActiveSheet.Paste Destination:=Worksheets(\"Summary\").Range(Cells(1, ecolumn), Cells(7, ecolumn))\n\n    MyFile = Dir\n  Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "dictionary", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496264046, "post_id": 44294446, "comment_id": 75595336, "body": "I can&#39;t see immediately why you would get an error on that line, but <code>For k = 2 To attendanceSheet.Range(&quot;a1&quot;).End(xlRight).Row</code> is equivalent to <code>For k = 2 To 1</code>, which is a bit pointless."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1496264054, "post_id": 44294446, "comment_id": 75595341, "body": "Should be <code>xlToRight</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1496264073, "post_id": 44294446, "comment_id": 75595356, "body": "@JNevill - DOH!!"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496264199, "post_id": 44294446, "comment_id": 75595409, "body": "@YowE3K I <code>xlToRight</code> should be sound here as it will stop wherever the data stops to the right of <code>A1</code>. I think you are like me and are getting your directions backwards (I have to hold up my hands to find the &quot;L&quot; to get it correct)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1496264291, "post_id": 44294446, "comment_id": 75595455, "body": "@JNevill - Wherever it stops on row 1, the <code>Row</code> will be <code>1</code>.  I&#39;m just trying to work out whether the OP intends <code>k</code> to refer to a row or a column, and getting hopelessly confused by the code.  (P.S.  I also use my hands to work out L from not-L!! Learnt that trick when I was very young and still haven&#39;t forgotten it [although I have forgotten just about everything else])"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1496264392, "post_id": 44294446, "comment_id": 75595502, "body": "OH! YES YOU are right. Sneaky ROW() at the end there. @bdpolinsky, I&#39;m almost certain that you want here is <code>For k = 2 To attendanceSheet.Range(&quot;a1&quot;).End(xlToRight).Column</code> changing that to <code>xlToRight</code> and <code>.Column</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1496264476, "post_id": 44294446, "comment_id": 75595543, "body": "@JNevill - But the only time the code uses <code>k</code> is as a row reference, which is why I am confused.  (I might actually have to read the text of the question, and not just look at the code, before I will be able to work out what is intended :D )"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496269079, "post_id": 44294446, "comment_id": 75597273, "body": "It may help to see some data, as I also think it should be <code>For k = 2 to [...].Column</code>, but since <code>k</code> is later used as a row (<code>...indivName.Add attendanceSheet.Cells(k,1)...</code>, perhaps there&#39;s a value in that last cell in row 1 that OP wants to use?  @bdpolinsky, what do you intend <code>k</code> to do?  Also, are you <i>sure</i> that <code>CLng(total &#47; totalWeeklyHours.Count)</code> will return a whole number that you will then use as a column reference?"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1496269469, "creation_date": 1496263873, "last_edit_date": 1531161705, "question_id": 44294446, "link": "https://stackoverflow.com/questions/44294446/application-or-user-defined-error", "title": "Application or User Defined Error", "body": "<p>I have the following code in one of my workbooks. Basically, there are two sheets - one with a matrix where the top row is names, and the left column is dates. As of now, there are 735 rows (or dates) in the \"attendance\" spreadsheet, and around 80 names of individuals. It's supposed to track peoples' attendance.</p>\n\n<p>I need to find out how much each person works per week. The code below attempts to do the following:</p>\n\n<ol>\n<li>For each individual, scan the first period of 7 days (or 7 rows). Sum up that period, and place the value in a dictionary at an incremeneted item. So for instance, in 700 days, there will be a dictionary 100 units large. Do this only if the value which is going to be added to the dictionary is greater than 0 (if they worked that week)</li>\n<li>Take this dictionary, and sum up the value of all the items in the dictionary, then divide it by the count of that dictionary, to get an average work week during a 7 day block. </li>\n<li>Then, place the value of that dictionary into another dictionary, where the individuals name (top row in attendance sheet) is the key, and the value of the previous dictionary is the item.</li>\n<li>In the \"Summary Sheet\", place  the item associated with each key in the 9th column. For instance - </li>\n</ol>\n\n<p>Individual  |  Weekly Hours<br>\nJohn     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   |     &nbsp;&nbsp;&nbsp;20<br>\nJane    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;15<br>\nJoe &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;12</p>\n\n<p>the hope is to be able to derive the amount of work each person puts in per week unit (not 7 unit block) directly from attendance data that is entered into the spreadsheet. </p>\n\n<p>The error occurs at the following line:</p>\n\n<pre><code> For k = 2 To attendanceSheet.Range(\"a1\").End(xlRight).Row\n</code></pre>\n\n<p>Excel says \"Application or user defined error: #1004\"</p>\n\n<p>Also, any assistance with optimization would be appreciated as this seems to be rather bulky code.</p>\n\n<pre><code>  Public Sub calculateAverageWeek()\n\n    Dim i As Long\n\n    Dim attendanceSheet As Worksheet\n    Set attendanceSheet = ActiveWorkbook.Worksheets(\"Attendance\")\n\n    'calculate week block\n    Dim lastRow As Long\n    lastRow = attendanceSheet.Range(\"a1\").End(xlDown).Row\n\n    Dim indivName As Dictionary\n    Set indivName = New Dictionary\n\n    Dim k As Long\n    For k = 2 To attendanceSheet.Range(\"a1\").End(xlRight).Row\n            Dim total As Long\n            Dim v As Variant\n            Dim totalWeeklyHours As Dictionary\n            Set totalWeeklyHours = New Dictionary\n            Dim j As Long\n            j = 1\n            Dim curTotal As Double\n            curTotal = 0\n\n        'scan attendance worksheet\n        For i = 2 To lastRow\n\n            curTotal = curTotal + attendanceSheet.Cells(i, 2)\n            If (i - 1) Mod 7 = 0 Then\n                If curTotal &gt; 0 Then\n                    totalWeeklyHours.Add j, curTotal\n                    j = j + 1\n                    curTotal = 0\n                Else\n                End If\n            End If\n\n            If i = lastRow Then\n                For Each v In totalWeeklyHours\n                    total = total + totalWeeklyHours.Item(v)\n                Next\n               ' Worksheets(\"Summary\").Cells(2, 9) = CLng(total / totalWeeklyHours.Count)\n               indivName.Add attendanceSheet.Cells(k, 1), attendanceSheet.Cells(k, CLng(total / totalWeeklyHours.Count))\n            End If\n        Next i\n    Next k\n\n    For i = 2 To Worksheets(\"Summary\").Range(\"A2\").End(xlDown).Row\n        Worksheets(\"Summary\").Cells(i, 9) = indivName.Item(Cells(i, 1))\n\n    Next i\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "error-handling", "match"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1496264000, "post_id": 44294433, "comment_id": 75595311, "body": "Instead of <code>If plan &gt; 0 Then</code> check if it is an error <code>If Not IsError(plan) Then</code> do this for all three."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1496266762, "post_id": 44294433, "comment_id": 75596453, "body": "By using &#39;On Error Resume Next&#39;, you will be ignoring any errors you encounter - and you never reset that. A better approach, for your testing, would be to use an error trap where you could place a breakpoint, examine the error, then resume back at the failing line to find where it happened, then either correct the code if possible, or add some &#39;If Err.Number = nnn&#39; code in the error trap to handle/ignore the error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1496267716, "post_id": 44294433, "comment_id": 75596824, "body": "I would suggest just removing the <code>On Error Resume Next</code> as it will not be needed anymore with my suggestion above."}, {"owner": {"reputation": 11, "user_id": 8094311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da477a5e2b991d8a3fba6de352026a5f?s=128&d=identicon&r=PG&f=1", "display_name": "userls", "link": "https://stackoverflow.com/users/8094311/userls"}, "edited": false, "score": 0, "creation_date": 1496323425, "post_id": 44294433, "comment_id": 75622786, "body": "Thank you a lot!!! it works perfect!"}], "owner": {"reputation": 11, "user_id": 8094311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da477a5e2b991d8a3fba6de352026a5f?s=128&d=identicon&r=PG&f=1", "display_name": "userls", "link": "https://stackoverflow.com/users/8094311/userls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496266368, "creation_date": 1496263817, "last_edit_date": 1496266368, "question_id": 44294433, "link": "https://stackoverflow.com/questions/44294433/error-on-vba-match-with-if", "title": "Error on VBA Match with If", "body": "<p>Could someone help me find out what is wrong with this VBA Code, please?\nIn the vba code workbook BASE has more than 3000 items in column A and Each line has a name, for example: \"B-Y0011\".\nI want to search this item in another workbook named in this vba code 'wb'.\nBUT this workbook 'wb' has three sheets. I have to find the item in one of these sheets and the line position which the item is on.\nIt ran one time, but when it doesn't find it, it got an error. And now that I tried to add an ERROR function, it gives me another ERROR.</p>\n\n<p>Thank you so much</p>\n\n<pre><code>Sub ATUALIZAR_ALOCACAO()\n\nDim caminho As String, Dim j As Variant, Dim plan As Variant, Dim plan1 As \nVariant, Dim plan2 As Variant, Dim wb As Workbook, Dim ws As Worksheet\n\nApplication.ScreenUpdating = False\nApplication.AskToUpdateLinks = False\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n\nmes = InputBox(\"Qual o m\u00eas que voc\u00ea est\u00e1 consolidando informa\u00e7\u00e3o de Diesel?\")\nano = ThisWorkbook.Sheets(\"BASE\").Range(\"R1\").Value\n\nind_mes = Application.Match(mes, ThisWorkbook.Sheets(\"BASE\").Range(\"L:L\"), 0)\nmes_aloc = ThisWorkbook.Sheets(\"BASE\").Range(\"N\" &amp; ind_mes).Value\nnum_mes = ThisWorkbook.Sheets(\"BASE\").Range(\"M\" &amp; ind_mes).Value\n\nIf num_mes &lt; 10 Then\n    num_mes_cod = \"0\" &amp; num_mes\nElse\n    num_mes_cod = num_mes\nEnd If\n\ncaminho = \"\\\\sedenas01\\carnaxide\\A&amp;CCC\\15 - Brasil - Inova\u00e7\u00e3o e \nDesenvolvimento\\PDCAs\\Consumo Diesel\\Aloca\u00e7\u00e3o\\2017\\\" &amp; num_mes_cod &amp; \n\".RELA\u00c7\u00c3O DE FROTAS GERAL IC \" &amp; mes_aloc &amp; \" \" &amp; ano &amp; \".xls\"\nSet wb = Workbooks.Open(Filename:=caminho, ReadOnly:=True)\n\nWith wb\n    lastrow = ThisWorkbook.Sheets(\"BASE\").Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 2 To lastrow\n        j = ThisWorkbook.Sheets(\"BASE\").Cells(i, 1).Value\n        plan = Application.Match(j, wb.Sheets(\"BETONEIRAS\").Range(\"K:K\"), 0)\n\n        On Error Resume Next\n\n        If plan &gt; 0 Then\n\n            wb.Sheets(\"BETONEIRAS\").Range(\"M\" &amp; plan).Copy\n            ThisWorkbook.Sheets(\"BASE\").Range(\"I\" &amp; i).PasteSpecial xlPasteValues\n\n            wb.Sheets(\"BETONEIRAS\").Range(\"P\" &amp; plan).Copy\n            ThisWorkbook.Sheets(\"BASE\").Range(\"J\" &amp; i).PasteSpecial xlPasteValues\n\n        Else\n\n            plan1 = Application.Match(j, wb.Sheets(\"BOMBAS DE CONCRETO\").Range(\"K:K\"), 0)\n\n            If plan1 &gt; 0 Then\n\n                wb.Sheets(\"BOMBAS DE CONCRETO\").Range(\"M\" &amp; plan1).Copy\n                ThisWorkbook.Sheets(\"BASE\").Range(\"I\" &amp; i).PasteSpecial xlPasteValues\n\n                wb.Sheets(\"BOMBAS DE CONCRETO\").Range(\"P\" &amp; plan1).Copy\n                ThisWorkbook.Sheets(\"BASE\").Range(\"J\" &amp; i).PasteSpecial xlPasteValues\n\n            Else\n\n                plan2 = Application.Match(j, wb.Sheets(\"BOMBAS DE CONCRETO\").Range(\"H:H\"), 0)\n\n                If plan2 &gt; 0 Then\n\n                    wb.Sheets(\"P\u00c1S CARREGADEIRAS\").Range(\"J\" &amp; plan2).Copy\n                    ThisWorkbook.Sheets(\"BASE\").Range(\"I\" &amp; i).PasteSpecial xlPasteValues\n\n                    wb.Sheets(\"P\u00c1S CARREGADEIRAS\").Range(\"L\" &amp; plan2).Copy\n                    ThisWorkbook.Sheets(\"BASE\").Range(\"J\" &amp; i).PasteSpecial xlPasteValues\n\n                End If\n            End If\n        End If\n    Next\n\nEnd With\n\nwb.Close SaveChanges:=False\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496263514, "post_id": 44294234, "comment_id": 75595113, "body": "What&#39;s the <code>DoEvents</code> for?"}, {"owner": {"reputation": 11, "user_id": 8094265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e81fdd2d3d07dee119f691ef987248?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Spargo", "link": "https://stackoverflow.com/users/8094265/nathan-spargo"}, "edited": false, "score": 0, "creation_date": 1496263669, "post_id": 44294234, "comment_id": 75595180, "body": "That was it! Thank you so much."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1496263685, "post_id": 44294234, "comment_id": 75595190, "body": "@BruceWayne - Not sure why the OP had it there, but I didn&#39;t bother to remove it"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496265287, "post_id": 44294234, "comment_id": 75595876, "body": "...@YowE3K - makes sense to me! Normally, isn&#39;t <code>DoEvents</code> used to allow Excel to do other things while waiting on a loop? As far as I can recall, I&#39;ve only used it when doing things like loading a URL via an IE Object."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1496265808, "post_id": 44294234, "comment_id": 75596076, "body": "@BruceWayne - yes, <code>DoEvents</code> hands control back to the operating system (or to Excel which then passes back to the o/s?) so that other processes can be run.  Unfortunately I have never really worked out when it is and isn&#39;t required in normal code - and I find some code refuses to allow Ctrl-Break without it, and other code does (which means I have on many occasions had to &quot;terminate&quot; Excel because of a bad bit of code).  My best guess is it depends on whether the macro is chewing up all the CPUs or whether it is just using a single one."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 3, "last_activity_date": 1496263019, "creation_date": 1496263019, "answer_id": 44294234, "question_id": 44294149, "link": "https://stackoverflow.com/questions/44294149/using-vba-to-switch-between-active-worksheets-only/44294234#44294234", "title": "Using VBA to switch between active worksheets only", "body": "<p>Use the worksheet's <code>Visible</code> property:</p>\n\n<pre><code>Public Sub Switch()\n    Dim ws As Worksheet\n\n    Do\n        For Each ws In ThisWorkbook.Worksheets\n            If ws.Visible = xlSheetVisible Then\n                'Only process things if the sheet is visible\n                ws.Activate\n                Application.Wait Now() + TimeValue(\"00:00:05\")\n                DoEvents\n            End If\n        Next ws\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8094265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65e81fdd2d3d07dee119f691ef987248?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Spargo", "link": "https://stackoverflow.com/users/8094265/nathan-spargo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496263019, "creation_date": 1496262626, "question_id": 44294149, "link": "https://stackoverflow.com/questions/44294149/using-vba-to-switch-between-active-worksheets-only", "title": "Using VBA to switch between active worksheets only", "body": "<p>I'm trying to write a macro that changes between active worksheets only after a prescribed amount of time.  </p>\n\n<p>I have several hidden sheets, and currently, this code will cycle me to the last visible sheet, and then pause on that sheet for the same amount of time that it would take to cycle through the hidden sheets as well. So I end up looking at my last visible sheet for several times longer than the other sheets. </p>\n\n<p>This is my code.</p>\n\n<pre><code>Public Sub Switch()\n Dim ws As Worksheet\n\nDo\nFor Each ws In ThisWorkbook.Worksheets\n        ws.Activate\n        Application.Wait Now() + TimeValue(\"00:00:05\")\n        DoEvents\n    Next ws\nLoop\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be amazing!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1496262762, "post_id": 44294119, "comment_id": 75594776, "body": "What di you mean &quot;<i>this does not work</i>&quot;  What does it do?"}, {"owner": {"reputation": 107, "user_id": 7178871, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d233f8b1f29f66572ce0b38a5c0bf388?s=128&d=identicon&r=PG&f=1", "display_name": "AdMac", "link": "https://stackoverflow.com/users/7178871/admac"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1496262989, "post_id": 44294119, "comment_id": 75594881, "body": "That worked perfect... it yielded the city before the comma.  Do I manipulate the last integer to get to the characters after the comma?"}, {"owner": {"reputation": 107, "user_id": 7178871, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d233f8b1f29f66572ce0b38a5c0bf388?s=128&d=identicon&r=PG&f=1", "display_name": "AdMac", "link": "https://stackoverflow.com/users/7178871/admac"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1496263013, "post_id": 44294119, "comment_id": 75594891, "body": "Yes, yes I do.  Thanks!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496263543, "post_id": 44294119, "comment_id": 75595128, "body": "Although Scott&#39;s answer would be the best way to solve your problem, as a FYI the correct way of getting the city/state using the approach you were attempting would be <code>citypart = Left(Sheets(i).Range(&quot;C6&quot;).Value, InStr(Sheets(i).Range(&quot;C6&quot;).Value, &quot;,&quot;) - 1)</code> and <code>statepart = Mid(Sheets(i).Range(&quot;C6&quot;).Value, InStr(Sheets(i).Range(&quot;C6&quot;).Value, &quot;,&quot;) + 1)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1496262818, "creation_date": 1496262818, "answer_id": 44294196, "question_id": 44294119, "link": "https://stackoverflow.com/questions/44294119/vba-split-before-after-the-comma/44294196#44294196", "title": "VBA split before &amp; after the comma", "body": "<p>Use Split:</p>\n\n<pre><code>n = ActiveWorkbook.Sheets.Count\nFor i = 2 To n\n    Z = Split(Sheets(i).Range(\"C6\").Value,\",\")(0) '(0) returns the first and (1) the second.\n    Cells(39, i) = Z\nNext i\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 7178871, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d233f8b1f29f66572ce0b38a5c0bf388?s=128&d=identicon&r=PG&f=1", "display_name": "AdMac", "link": "https://stackoverflow.com/users/7178871/admac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "accepted_answer_id": 44294196, "answer_count": 1, "score": 1, "last_activity_date": 1496262818, "creation_date": 1496262540, "question_id": 44294119, "link": "https://stackoverflow.com/questions/44294119/vba-split-before-after-the-comma", "title": "VBA split before &amp; after the comma", "body": "<p>I have a report that produces the location as City, State... i.e. Baltimore, Maryland</p>\n\n<p>I'm currently using the following to pull the full location string in:</p>\n\n<pre><code>n = ActiveWorkbook.Sheets.Count\nFor i = 2 To n\nZ = Sheets(i).Range(\"C6\").Value\nCells(39, i) = Z\nNext i\n</code></pre>\n\n<p>I know that I can write a formula for the field to do the work, but a VBA code would be much quicker.</p>\n\n<p>excel formula for before the comma would be:\n=LEFT(B39, FIND(\",\",B39)-1)</p>\n\n<p>for after the comma (it's a state abbreviation):\n=RIGHT(B39,2)</p>\n\n<p>This does not work:</p>\n\n<pre><code>n = ActiveWorkbook.Sheets.Count\nFor i = 2 To n\nZ = Sheets(i).Range(left((\"C6\"), find(\",\",\"C6\"))-1).Value\nCells(39, i) = Z\nNext i\n</code></pre>\n\n<p>Any suggestion on how to incorporate the left function into this code?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3602, "user_id": 812786, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AtQA7.png?s=128&g=1", "display_name": "user812786", "link": "https://stackoverflow.com/users/812786/user812786"}, "edited": false, "score": 0, "creation_date": 1496266016, "post_id": 44294010, "comment_id": 75596158, "body": "Hi Martin, you need to include more details about what you have tried and what is going wrong. Please see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for more info. Once you add example code we can try to help you debug."}, {"owner": {"reputation": 1, "user_id": 8094195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07189058f2f7809cc8b9ac9ab6d77b88?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/8094195/martin"}, "reply_to_user": {"reputation": 3602, "user_id": 812786, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AtQA7.png?s=128&g=1", "display_name": "user812786", "link": "https://stackoverflow.com/users/812786/user812786"}, "edited": false, "score": 1, "creation_date": 1496414174, "post_id": 44294010, "comment_id": 75666881, "body": "i Updated my Question."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1496414597, "post_id": 44294010, "comment_id": 75667124, "body": "The error is quite clear, isn&#39;t it? You start a With block, but don&#39;t end it."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1496414607, "post_id": 44294010, "comment_id": 75667128, "body": "Also, use Option Explicit. <a href=\"https://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/3554/always-use-option-explicit#t=201607281607357211291\">stackoverflow.com/documentation/excel-vba/1107/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 8128255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3da0b88f6c4e143482e5ccfd425a1b80?s=128&d=identicon&r=PG&f=1", "display_name": "user8128255", "link": "https://stackoverflow.com/users/8128255/user8128255"}, "is_accepted": false, "score": 0, "last_activity_date": 1497251951, "last_edit_date": 1497251951, "creation_date": 1497175578, "answer_id": 44482583, "question_id": 44294010, "link": "https://stackoverflow.com/questions/44294010/making-a-history-quiz-card-from-an-access-database/44482583#44482583", "title": "Making a history quiz card from an Access database", "body": "<p>Try to get rid of the with statement.</p>\n\n<pre><code>xlSheet.Columns(\"B\").ColumWidth = 20\nxlSheet.Range(\"B2\").CopyFromRecordset rs1\n</code></pre>\n\n<p>And you should use <code>option explicit</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8094195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07189058f2f7809cc8b9ac9ab6d77b88?s=128&d=identicon&r=PG&f=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/8094195/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1577488007, "creation_date": 1496262101, "last_edit_date": 1577488007, "question_id": 44294010, "link": "https://stackoverflow.com/questions/44294010/making-a-history-quiz-card-from-an-access-database", "title": "Making a history quiz card from an Access database", "body": "<p>I want to make a card set with 4 unique history objects (like: Urbanization, Pope, Knight, Feudalism) on each card (to play the board game 30 seconds with a history theme and teach my students things the need to learn in a fun way). I already have an Access 2016 database with this information in it coupled with the time period each object is related to and several queries (to sort the object to time period). So I want to export it to Excel to make cards out of them. To do that I need to export the object to a specific column (b2). If come up with the following VB code (coupled to a button). Only when I run the code I get an error message:</p>\n\n<blockquote>\n  <p>Compile error Expected End With</p>\n</blockquote>\n\n<p>This is the code:</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cmdTransfer_Click()\n\n    Dim xlApp As Excel.Application\n    Dim xlBook As Excel.Workbook\n    Dim xlSheet As Excel.Worksheet\n    Dim SQL As String\n    Dim rs1 As DAO.Recordset\n\n    SQL = \"SELECT Begrip\" &amp; _\n                \"FROM Begrippen\"\n\n        Set rs1 = CurrentDb.OpenRecordset(SQL, dbOpenSnapshot)\n\n        Set xlApp = Excel.Application\n        xlApp.Visable = False\n        Set xlBook = xlApp.Workbooks.Open(\"D:\\30seconds.xlsx\")\n        Set xlSheet = xlBook.Worksheets(1)\n\n        With xlSheet\n            .Columns(\"B\").ColumWidth = 20\n\n            .Range(\"B2\").CopyFromRecordset rs1\n        end With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1496259998, "post_id": 44293240, "comment_id": 75593438, "body": "What do you get in the Immediate window when you add <code>debug.print MyFile &amp; &quot; - &quot; &amp; LMD</code> after <code>LMD = FileDateTime(MyPath &amp; MyFile)</code> ?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496260043, "post_id": 44293240, "comment_id": 75593463, "body": "Just to make sure... Are you saying that any file named <code>MyFile053017.xls</code> must always be newer than another one named <code>myfile052517.xls</code>? Besides, if the actual <code>last modification dates</code> matche those names, then yes the first one is the &quot;latest&quot;."}, {"owner": {"reputation": 23, "user_id": 7987215, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550100151691286/picture?type=large", "display_name": "Danny Hagstrom", "link": "https://stackoverflow.com/users/7987215/danny-hagstrom"}, "edited": false, "score": 0, "creation_date": 1496260149, "post_id": 44293240, "comment_id": 75593527, "body": "still gave me oldest file"}, {"owner": {"reputation": 23, "user_id": 7987215, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550100151691286/picture?type=large", "display_name": "Danny Hagstrom", "link": "https://stackoverflow.com/users/7987215/danny-hagstrom"}, "edited": false, "score": 0, "creation_date": 1496260315, "post_id": 44293240, "comment_id": 75593615, "body": "Well i thought this program was analyzing the workbooks date within the name not the actual date modified. So when i saved one and copied it down with different dates it wouldn&#39;t work like that. I was trying to test to make sure it was finalized before I moved onto the next vba. Thank you A.S.H XD"}, {"owner": {"reputation": 23, "user_id": 7987215, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550100151691286/picture?type=large", "display_name": "Danny Hagstrom", "link": "https://stackoverflow.com/users/7987215/danny-hagstrom"}, "edited": false, "score": 0, "creation_date": 1496261167, "post_id": 44293240, "comment_id": 75594033, "body": "Now im going forward with getting that file to open into the current workbook as a sheet with the name of the workbook, Then im going to compare changes from sheet to sheet with a new sheet containing the changes.. Got a lot of ways togo."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1496262109, "post_id": 44293240, "comment_id": 75594452, "body": "Seems, you want to open first file based on the date included in its name, but not on time of its creation. Am i right?"}, {"owner": {"reputation": 23, "user_id": 7987215, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550100151691286/picture?type=large", "display_name": "Danny Hagstrom", "link": "https://stackoverflow.com/users/7987215/danny-hagstrom"}, "edited": false, "score": 0, "creation_date": 1496262877, "post_id": 44293240, "comment_id": 75594834, "body": "Correct, just in case someone opens it and saves it. I am also trying to figure out how i get the second to last &quot;last modified workbook&quot;, so i can compare the two most recent."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1496279947, "creation_date": 1496279947, "answer_id": 44297022, "question_id": 44293240, "link": "https://stackoverflow.com/questions/44293240/how-do-i-get-this-program-to-open-the-last-modified-date-workbook-by-the-date-in/44297022#44297022", "title": "How do I get this program to open the last modified date workbook by the date in the name", "body": "<p>If you want to only look at the filenames to determine the \"latest\" file, then instead of calling <code>FileDateTime</code> on the full path, call the function below on the filename only.</p>\n\n<p>You will need to make some adjustments of your file names aren't exactly as shown in your question.</p>\n\n<pre><code>'MyFile053017.xls &gt;&gt; 5/30/2017\nFunction NewFileDateTime(sFile As String)\n    NewFileDateTime = DateSerial(2000 + Mid(sFile, 11, 2), _\n                                        Mid(sFile, 7, 2), _\n                                        Mid(sFile, 9, 2))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7987215, "user_type": "registered", "profile_image": "https://graph.facebook.com/1550100151691286/picture?type=large", "display_name": "Danny Hagstrom", "link": "https://stackoverflow.com/users/7987215/danny-hagstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496279947, "creation_date": 1496259011, "last_edit_date": 1496263253, "question_id": 44293240, "link": "https://stackoverflow.com/questions/44293240/how-do-i-get-this-program-to-open-the-last-modified-date-workbook-by-the-date-in", "title": "How do I get this program to open the last modified date workbook by the date in the name", "body": "<p>My files are all named <strong>MyFile053017.xls</strong> and <strong>myfile052517.xls</strong>.</p>\n\n<p>I am trying to grab the date in the name and use that as the last modified date, just in case of an instance where someone opens and saves one of the workbooks</p>\n\n<pre><code>'Force the explicit delcaration of variables\nOption Explicit\n\nSub OpenLatestFile()\n\n    'Declare the variables\n    Dim MyPath As String\n    Dim MyFile As String\n    Dim LatestFile As String\n    Dim LatestDate As Date\n    Dim LMD As Date\n\n    'Specify the path to the folder\n    MyPath = \"M:\\Users\\Dan\\Access\\DiscontinueQuerry\\DiscontinueQuerrySave\\\"\n\n    'Make sure that the path ends in a backslash\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then MyPath = MyPath &amp; \"\\\"\n\n    'Get the first Excel file from the folder\n    MyFile = Dir(MyPath &amp; \"*.xls\", vbNormal)\n\n    'If no files were found, exit the sub\n    If Len(MyFile) = 0 Then\n        MsgBox \"No files were found...\", vbExclamation\n        Exit Sub\n    End If\n\n    'Loop through each Excel file in the folder\n    Do While Len(MyFile) &gt; 0\n\n        'Assign the date/time of the current file to a variable\n        LMD = FileDateTime(MyPath &amp; MyFile)\n\n        'If the date/time of the current file is greater than the latest\n        'recorded date, assign its filename and date/time to variables\n        If LMD &gt; LatestDate Then\n            LatestFile = MyFile\n            LatestDate = LMD\n        End If\n\n        'Get the next Excel file from the folder\n        MyFile = Dir\n    Loop\n\n    'Open the latest file\n    Workbooks.Open MyPath &amp; LatestFile\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "oledb"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1496258095, "post_id": 44292945, "comment_id": 75592370, "body": "the subquery <code>bcr.DialCode LIKE cc.CountryCode+&#39;%&#39;</code> I think they need to be the other way around ? and try using * as your wildcard."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1496258101, "post_id": 44292945, "comment_id": 75592376, "body": "ACE/OleDb database engine does not know [%]. You have to replace it with [*]."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496259069, "post_id": 44292945, "comment_id": 75592885, "body": "Thanks for the indications. The query does work though with <code>cc.CountryCode LIKE &#39;1&#39;+&#39;%&#39;</code> as per above (third query provided). And it outputs all the country codes that start with <code>1</code> and have the max LEN of 4. I tried changing <code>%</code> for <code>*</code> and <code>[*]</code> with the same error. Tried repacing <code>&#39;%&#39;</code> with <code>[*]</code> and got &quot;No value given for one or more required parameters.&quot; Any other thoughts?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1496259841, "post_id": 44292945, "comment_id": 75593324, "body": "Please, check my answer."}], "answers": [{"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496260698, "post_id": 44293470, "comment_id": 75593813, "body": "Thank you for your further response. Using the code you provided I get a &quot;At most one record can be returned by this subquery.&quot; error. It should produce as many matches as rows in Table1 as all calls will match to at least 1 country. Is this even considered an actual LEFT JOIN? Should I perhaps change it into using a LEFT JOIN rather then the solution that I am following?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496260997, "post_id": 44293470, "comment_id": 75593952, "body": "@nbayly, check updated answer. This should return all data where <code>CountryCode</code> starts with <code>DialCode</code>. Good luck!"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496262495, "post_id": 44293470, "comment_id": 75594657, "body": "This is now running without errors but there are some issues with the logic of the query that I hope you can help with. It is not outputting the most inclusive match. For example for a dial code of &#39;7708&#39; it is matching to Russia dial code &#39;7&#39; rather than the more inclusive &#39;77&#39; Kazakhstan. Any suggestions? I am marking your answer as correct as it did resolve the run time error."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496263080, "post_id": 44293470, "comment_id": 75594932, "body": "@nbayly, sorry, but not getting you... If <code>CountryCode</code> is <code>7</code> then above query should match <code>DialCode</code>s which starts with <code>7</code>. So, it should return {<code>7</code>, <code>70</code>, <code>717</code>, <code>7771</code>, etc.}"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496263887, "post_id": 44293470, "comment_id": 75595256, "body": "If the dial code is &#39;7708&#39; it should return the most inclusive matched country code between &#39;7&#39; (Russia) and &#39;77&#39; (Kazakhstan) which in this case would be &#39;77&#39; as more left digits of the dial code match. I hope this clarifies your doubt."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496264163, "post_id": 44293470, "comment_id": 75595397, "body": "Actually I have progressed a bit but still have some issues with the results. I will post this as another question as it does not relate to my initial issue reported. Cheers"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496264579, "post_id": 44293470, "comment_id": 75595594, "body": "@nbayly, You can MAX() function with <code>WHERE</code> clause, for example: <code>WHERE MAX(LEN(cc.CountryCode)) GROUP BY bcr.DialCode,     bcr.Destination</code>"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1496267890, "post_id": 44293470, "comment_id": 75596887, "body": "I have moved the rest of my questions here: <a href=\"https://stackoverflow.com/questions/44295290/left-join-on-longest-match\" title=\"left join on longest match\">stackoverflow.com/questions/44295290/left-join-on-longest-ma&zwnj;&#8203;tch</a> Thanks again for all your help. Regards"}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": true, "score": 1, "last_activity_date": 1496260981, "last_edit_date": 1496260981, "creation_date": 1496259823, "answer_id": 44293470, "question_id": 44292945, "link": "https://stackoverflow.com/questions/44292945/vba-ace-oledb-sql-run-time-error-2147217913-data-type-mismatch-in-criteria-expr/44293470#44293470", "title": "VBA/ACE OLEDB/SQL Run-Time error -2147217913 Data type mismatch in criteria expression", "body": "<p>First of all, please read my comment to the question.</p>\n\n<p>Secondly, please read these articles:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/I-get-a-message-about-data-type-mismatch-c75b62ff-bcfd-4bb0-83f8-8129f372d59f\" rel=\"nofollow noreferrer\">I get a message about data type mismatch</a></p>\n\n<p><a href=\"https://www.techonthenet.com/access/queries/like.php\" rel=\"nofollow noreferrer\">MS Access 2003: LIKE condition (using wildcards)</a></p>\n\n<p>Finally, if you would like to compare one data to another which <code>StartsWith(\"SomeString\")</code>, you can use something like this:</p>\n\n<pre><code>SELECT\n    bcr.DialCode,\n    bcr.Destination,\n    cc.CountryCode\nFROM table1 AS bcr \n    INNER JOIN table2 AS cc \n    ON cc.CountryCode = LEFT(bcr.DialCode, LEN(cc.CountryCode))\nORDER BY LEN(cc.CountryCode) DESC;\n</code></pre>\n\n<p>For further details, please see: <a href=\"https://www.techonthenet.com/access/functions/string/left.php\" rel=\"nofollow noreferrer\">MS Access: Left Function</a></p>\n\n<p>Note: Do not forget to use [<code>;</code>] at the end of query. MS Access database likes it ;)</p>\n"}], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 0, "accepted_answer_id": 44293470, "answer_count": 1, "score": 0, "last_activity_date": 1496260981, "creation_date": 1496257853, "question_id": 44292945, "link": "https://stackoverflow.com/questions/44292945/vba-ace-oledb-sql-run-time-error-2147217913-data-type-mismatch-in-criteria-expr", "title": "VBA/ACE OLEDB/SQL Run-Time error -2147217913 Data type mismatch in criteria expression", "body": "<p>I am running a SQL query from VBA using ACE OLEDB without connecting to Access. I do this so I can smash together quickly some Excel tables. I am not looking to transition this to another platform so would prefer to resolve the current issue.</p>\n\n<p>VBA code works without issue for numerous queries but I am running into the mentioned error for the following query:</p>\n\n<pre><code>SELECT\n    bcr.DialCode,\n    bcr.Destination,\n    (\n        SELECT\n            TOP 1 cc.CountryCode\n        FROM\n            table2 AS cc\n        WHERE\n            bcr.DialCode LIKE cc.CountryCode+'%'\n        ORDER BY LEN(cc.CountryCode) DESC\n    ) AS CountryCodes\nFROM\n    table1 AS bcr\n</code></pre>\n\n<p>Code adapted from: <a href=\"https://stackoverflow.com/questions/10845035/longest-prefix-match-in-sql-server-2000\">Longest prefix match in SQL Server 2000</a></p>\n\n<p>The intention is to match dialed telephone numbers to the destination country by finding the most inclusive match. Reusing the quoted text sample of input and expected results (adapted to this exercise):</p>\n\n<pre><code>bcr.DialCode = '0841234567'\n\ncc.CountryCode = {'084',\n                 '0841',\n                 '08412'}\n\nExpected output = {'0841234567','Destination 1','08412'}\n</code></pre>\n\n<p>From searching online seems like maybe I'm using a reserved word in the query. But I have tested different parts of the query individually and don't get any errors. For example:</p>\n\n<pre><code>SELECT\n    bcr.DialCode,\n    bcr.Destination\nFROM\n    table1 AS bcr\n</code></pre>\n\n<p>Works as expected. Also:</p>\n\n<pre><code>SELECT\n    TOP 1 cc.CountryCode\nFROM\n    table2 AS cc\nWHERE\n    cc.CountryCode LIKE '1'+'%'\nORDER BY LEN(cc.CountryCode) DESC\n</code></pre>\n\n<p>Has no errors and outputs the expected results.</p>\n\n<p>The variable used to pass the query to the ADO connection is dimmed as String but I have tried setting as Variant with no change.</p>\n\n<p>Is there perhaps a difference in the implementation of SQL through ACE for which the \"Longest prefix match\" query doesn't work? Any guidance will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1496253957, "post_id": 44291425, "comment_id": 75590081, "body": "<i>but it&#39;s not working</i> You get an error or what? <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask a good question?</a>"}, {"owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "reply_to_user": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1496254191, "post_id": 44291425, "comment_id": 75590202, "body": "Not getting any Error. But First row remains unselected. @Masoud"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496255170, "post_id": 44291425, "comment_id": 75590724, "body": "Me.ListView1.ListItems(1).Selected = True"}, {"owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496255398, "post_id": 44291425, "comment_id": 75590839, "body": "Not Working @JohnMuggins, Anyway thank You"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496255516, "post_id": 44291425, "comment_id": 75590913, "body": "did you change listview1 to the name of your listview?  ie, ListViewParcels.ListItems(1).Selected = True"}, {"owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "edited": false, "score": 0, "creation_date": 1496255716, "post_id": 44291425, "comment_id": 75591044, "body": "Yes, i changed it"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496256482, "post_id": 44291425, "comment_id": 75591458, "body": "That works for me.  But mine is named ListView1.  Is this listview in a form or on a worksheet?"}, {"owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "edited": false, "score": 0, "creation_date": 1496258690, "post_id": 44291425, "comment_id": 75592689, "body": "its in  the form"}], "owner": {"reputation": 1, "user_id": 7933839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc9dd68e6c6c4cf3a7126e3ee9e571e?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/7933839/qwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 339, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496253275, "creation_date": 1496252574, "last_edit_date": 1531164843, "question_id": 44291425, "link": "https://stackoverflow.com/questions/44291425/how-to-select-the-first-row-from-a-listview-in-excel-vba", "title": "How to select the first row from a ListView in Excel VBA", "body": "<p>I tried this, but it's not working. <code>ListViewParcels</code> is my ListView name.</p>\n\n<pre><code>ListViewParcels.ListItems(1).Checked = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1496252389, "post_id": 44291284, "comment_id": 75589260, "body": "is it always an 8-digit numeric preceded by <code>BT#</code>? If so, you can probably just use <code>Mid</code> and <code>Instr</code> functions to parse the text. If more complicated, consider a RegEx approach."}, {"owner": {"reputation": 3, "user_id": 8093539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f16af77b4e39c92aaf8c2b32f19b9986?s=128&d=identicon&r=PG&f=1", "display_name": "Vlady Mhore Battulayan", "link": "https://stackoverflow.com/users/8093539/vlady-mhore-battulayan"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1496252643, "post_id": 44291284, "comment_id": 75589390, "body": "yes. it is always 8 digit. thanks for your reply. I will untag vb.net btw, can you help me crack to code for Mid and Instr function? I am new to programming and coding that is why I am doing a lot of research."}, {"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1496253497, "post_id": 44291284, "comment_id": 75589845, "body": "You should be able to get more than enough basic info from Google on those two.  Let us know if you have specific questions though."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1496254392, "post_id": 44291284, "comment_id": 75590293, "body": "I&#39;m voting to close this question, because there&#39;s no question. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 5981967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Wyx7.jpg?s=128&g=1", "display_name": "JeffB", "link": "https://stackoverflow.com/users/5981967/jeffb"}, "is_accepted": true, "score": 0, "last_activity_date": 1496255411, "creation_date": 1496255411, "answer_id": 44292254, "question_id": 44291284, "link": "https://stackoverflow.com/questions/44291284/excel-vba-copy-certain-text-in-email-body/44292254#44292254", "title": "Excel vba copy certain text in email body", "body": "<pre><code>'add two vars, 1) for the number you seek, and 2) position of \"BT#\" prefix\nDim strBTNum as String, lngPos as Long\n'check to see if your body contains the BT#\nlngPos = Instr(1, .Body, \"BT#\")\nIf lngPos &gt; 0 Then 'you found your prefix at position lngPos\n    'so get the eight digit number\n    strBTNum = Mid(.Body, lngPos + 3, 8)\nElse\n    strBTNum = \"NotFound\"\nEnd If\n'now put strBTNum wherever you want, maybe ...?\nCells(i + 1, 3).Formula = strBTNum\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8093539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f16af77b4e39c92aaf8c2b32f19b9986?s=128&d=identicon&r=PG&f=1", "display_name": "Vlady Mhore Battulayan", "link": "https://stackoverflow.com/users/8093539/vlady-mhore-battulayan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2177, "favorite_count": 0, "accepted_answer_id": 44292254, "answer_count": 1, "score": -1, "last_activity_date": 1496255411, "creation_date": 1496252018, "last_edit_date": 1496254466, "question_id": 44291284, "link": "https://stackoverflow.com/questions/44291284/excel-vba-copy-certain-text-in-email-body", "title": "Excel vba copy certain text in email body", "body": "<p>I found the below code in this website that copies the email body from a specified folder in outlook and pastes it to excel. However, the problem is I want a specific text only to be copied to excel. I inserted the email sample and I want the highlighted item to be copied. FYI, the position of the numeric characters varies per email. eg. \"Batch Number 12345678\"; \"Bnumber 12345678\";\"B#87654321\";\"BT# 12345678\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/WqKUR.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WqKUR.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>CODE: </p>\n\n<pre><code>Option Explicit\n  Public gblStopProcessing As Boolean\n  Sub ParseBlockingSessionsEmailPartOne()\n  ' This macro requires Microsoft Outlook Object Library (Menu: Tools/References) be available\n  Dim wb As Workbook\n  Dim ws As Worksheet\n  Dim objFolder As Object\n  Dim objNSpace As Object\n  Dim objOutlook As Outlook.Application\n  Dim lngAuditRecord As Long\n  Dim lngCount As Long\n  Dim lngTotalItems As Long 'Count of emails in the Outlook folder.\n  Dim lngTotalRecords As Long\n  Dim i As Integer\n  Dim EmailCount As Integer 'The counter, which starts at zero.\n  '\n   On Error GoTo HandleError\n   'Application.ScreenUpdating = True\n   'Application.ScreenUpdating = False\n  '\n  Sheets(\"Merge Data\").Select\n  '\n      ' Initialize:\n       Set wb = ThisWorkbook\n       lngAuditRecord = 1 ' Start row\n       lngTotalRecords = 0\n  '\n      ' Read email messages:\n       Application.ScreenUpdating = False\n       Set objOutlook = CreateObject(\"Outlook.Application\")\n       Set objNSpace = objOutlook.GetNamespace(\"MAPI\")\n  '\n      ' Allow user to choose folder:#\n       Set objFolder = objNSpace.pickfolder\n      ' Check if cancelled:\n       If objFolder Is Nothing Then\n           gblStopProcessing = True\n           MsgBox \"Processing cancelled\"\n          Exit Sub\n       End If\n  '\n       lngTotalItems = objFolder.Items.Count\n       If lngTotalItems = 0 Then\n           MsgBox \"Outlook folder contains no email messages\", vbOKOnly + vbCritical, \"Error - Empty Folder\"\n           gblStopProcessing = True\n          GoTo HandleExit\n       End If\n      If lngTotalItems &gt; 0 Then\n           On Error Resume Next\n               Application.DisplayAlerts = False\n               wb.Worksheets(\"Merge Data\").Delete\n               'wb.Worksheets(\"Audit\").Delete\n               Application.DisplayAlerts = True\n           On Error GoTo HandleError\n           wb.Worksheets.Add After:=Worksheets(Worksheets.Count)\n           Set ws = ActiveSheet\n           ws.Name = \"Merge Data\"\n\n          'Insert Title Row and Format                 NOTE:  THE MACRO CAN BE USED TO PARSE OUT OTHER PARTS OF AN EMAIL.\n          '                                                   I JUST COMMENTED OUT THE LINES NOT USED FOR THE CURRENT PROJECT.\n           'ws.Cells(1, 1) = \"Received\"\n           ws.Cells(1, 1) = \"Email Body\"\n           ws.Cells(lngAuditRecord, 2) = \"Subject\"\n           'ws.Cells(lngAuditRecord, 4) = \"Attachments Count\"\n           'ws.Cells(lngAuditRecord, 4) = \"Sender Name\"\n           'ws.Cells(lngAuditRecord, 5) = \"Sender Email\"\n           ws.Range(Cells(lngAuditRecord, 1), Cells(lngAuditRecord, 1)).Select\n           Selection.EntireRow.Font.Bold = True\n           Selection.HorizontalAlignment = xlCenter\n\n           'Populate the workbook\n           For lngCount = 1 To lngTotalItems\n               Application.StatusBar = \"Reading message \" &amp; lngCount &amp; \" of \" &amp; lngTotalItems\n                  i = 0\n                  'read email info\n                  While i &lt; lngTotalItems\n                      i = i + 1\n                      If i Mod 50 = 0 Then Application.StatusBar = \"Reading email messages \" &amp; Format(i / lngTotalItems, \"0%\") &amp; \"...\"\n                      With objFolder.Items(i)\n                          'Cells(i + 1, 1).Formula = .ReceivedTime\n                          Cells(i + 1, 1).Formula = .Body\n                          Cells(i + 1, 2).Formula = .Subject\n                          'Cells(i + 1, 4).Formula = .Attachments.Count\n                          'Cells(i + 1, 5).Formula = .SenderName\n                          'Cells(i + 1, 6).Formula = .SenderEmailAddress\n                      End With\n                  Wend\n                  'Set objFolder = Nothing\n               ws.Activate\n           Next lngCount\n           lngTotalRecords = lngCount\n\n          'Format Worksheet\n              Columns(\"A:A\").Select\n              Selection.ColumnWidth = 255\n              Cells.Select\n              Selection.Columns.AutoFit\n              Selection.Rows.AutoFit\n              With Selection\n                  .VerticalAlignment = xlTop\n              End With\n              Range(\"A1\").Select\n      End If\n  '\n  ' Check that records have been found:\n       If lngTotalRecords = 0 Then\n           MsgBox \"No records were found for import\", vbOKOnly + vbCritical, \"Error - no records found\"\n           gblStopProcessing = True\n           GoTo HandleExit\n      End If\n  '\n      With Selection\n          Cells.Select\n          .VerticalAlignment = xlTop\n          .WrapText = True\n      End With\n      Range(\"A1\").Select\n  '\n HandleExit:\n       On Error Resume Next\n       Application.ScreenUpdating = True\n       Set objNSpace = Nothing\n       Set objFolder = Nothing\n       Set objOutlook = Nothing\n       Set ws = Nothing\n       Set wb = Nothing\n       If Not gblStopProcessing Then\n              MsgBox \"Processing completed\" &amp; vbCrLf &amp; vbCrLf &amp; _\n                 \"Please check results\", vbOKOnly + vbInformation, \"Information\"\n       End If\n  'Call ParseBlockingSessionsEmailPartTwo\n       Exit Sub\n  '\n HandleError:\n      MsgBox Err.Number &amp; vbCrLf &amp; Err.Description\n      gblStopProcessing = True\n      Resume HandleExit\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-project"], "owner": {"reputation": 11, "user_id": 8093413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2888c04b6a95d9e4bd1339ad58866018?s=128&d=identicon&r=PG&f=1", "display_name": "O.Coll", "link": "https://stackoverflow.com/users/8093413/o-coll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496687274, "creation_date": 1496251117, "last_edit_date": 1496687274, "question_id": 44291044, "link": "https://stackoverflow.com/questions/44291044/vba-to-export-excel-tasks-into-ms-project", "title": "VBA to export excel tasks into MS Project", "body": "<p>I'm currently trying to create code that will allow myself, and other users of the excel workbook I create, to export tasks, start dates and finish dates from Excel to MS Project. \nI've tried a number of ways, without much success. </p>\n\n<p>I've seen that you can simply create and save a map between Excel and Project - however, this will only work for one user. Is there a way to export a map so that all users can use the same map? e.g. saving the map on a shared drive, and getting the code to import tasks into Project using that mapping?</p>\n\n<p>I'm currently saving the Excel output I need to export under the headings the mapping creates:</p>\n\n<p><code>ID,    Outline_Level,  Name,   Start_Date, Finish_Date.</code></p>\n\n<p>I've also seen that it is possible to add a task in Project using VBA from Excel. However, I could not find a way to state the start date and finish date. Ideally, I would like a macro in Excel which reads down a list of tasks, and adds them one by one into MS Project, exporting the Start and Finish dates.\nI know it would be quicker to do this all in one go, but I will not be using it for a huge array of tasks per project.</p>\n\n<p>Any help is well received! Thanks in advance! </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 1, "creation_date": 1496250510, "post_id": 44290462, "comment_id": 75588203, "body": "You can use combination of <code>VLOOKUP</code> and <code>HLOOKUP</code> or <code>MATCH</code> and <code>INDEX</code>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1496252087, "post_id": 44290462, "comment_id": 75589098, "body": "You can copy the entire <code>PivotTable.Range</code> to another sheet, and then you&#39;ll have a regular <code>Range</code>. Or, you can loop through the <code>PivotItems</code> and find the value you are looking for"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496251711, "post_id": 44290950, "comment_id": 75588882, "body": "I tried using that, but the problem is, the ID numbers aren&#39;t the same every time I update the table, and neither are the column headers. That&#39;s where I&#39;m stuck with this."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1496252241, "last_edit_date": 1496252241, "creation_date": 1496250778, "answer_id": 44290950, "question_id": 44290462, "link": "https://stackoverflow.com/questions/44290462/how-to-move-parts-of-a-dynamic-pivot-table-to-a-separate-table/44290950#44290950", "title": "How to move parts of a dynamic pivot table to a separate table?", "body": "<p>I think you want the GETPIVOTDATA function.  Determine what your logic will look like and click on the appropriate combination of cells.  Excel will automatically setup the GETPIVOTDATA function appropriately for you.</p>\n\n<p><a href=\"http://www.contextures.com/xlPivot06.html\" rel=\"nofollow noreferrer\">http://www.contextures.com/xlPivot06.html</a></p>\n\n<p>Also, if the last used columns and last used rows are changing, you will probably need a Macro to help you with your task.</p>\n\n<pre><code>Sub LastRowInOneColumn()\n'Find the last used row in a Column: column A in this example\n    Dim LastRow As Long\n    With ActiveSheet\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n    MsgBox LastRow\nEnd Sub\n\nSub LastColumnInOneRow()\n'Find the last used column in a Row: row 1 in this example\n    Dim LastCol As Integer\n    With ActiveSheet\n        LastCol = .Cells(1, .Columns.Count).End(xlToLeft).Column\n    End With\n    MsgBox LastCol\nEnd Sub\n</code></pre>\n\n<p>You can use a combination of functions to help you get the last used cell in a specific range.</p>\n\n<p><a href=\"https://exceljet.net/formula/address-of-last-cell-in-range\" rel=\"nofollow noreferrer\">https://exceljet.net/formula/address-of-last-cell-in-range</a></p>\n\n<p>From there, I think you can figure out your next steps.  </p>\n\n<p>Post back with more information if you still have trouble with this, or start a new post if your question is answered.</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496251663, "post_id": 44291077, "comment_id": 75588861, "body": "I think maybe I explained this poorly, but the names will not be in the same spots every time, and neither will the column names. This is where I am struggling with this."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496251787, "post_id": 44291077, "comment_id": 75588924, "body": "@Lampoa I explicitly defined the names (i.e. <code>BEER Total</code> and <code>M307577</code>). But I guess you want to refer to them (like in cells) so you can expand the formula, right?"}, {"owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496251985, "post_id": 44291077, "comment_id": 75589042, "body": "I think I&#39;m confused. The name M307577 would only occur 1/3 of the time I run this problem, as they only work one every three shift, so I&#39;m looking for a way that doesn&#39;t tie a specific alias to a cell, but something that looks at the number of rows/columns that exist in the pivot table once updated, and copies those to a non-pivot table."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496252069, "post_id": 44291077, "comment_id": 75589087, "body": "@Lampoa I am working on it. The solution would be in defining a dynamic range."}, {"owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496252193, "post_id": 44291077, "comment_id": 75589156, "body": "Thanks! I updated the description to reflect an example where the pivot table would have less data depending on what occurred during a specific shift."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496252782, "post_id": 44291077, "comment_id": 75589474, "body": "@Lampoa if you want to account for last row/column then VBA is needed. Otherwise, you can make refer to the names included in your pivot table in a column and a row of the other sheet and expand the formula till the end (some of them will be zeros as the cells in the pivot table are empty). Then you can refer to those cells and use the formula I provided. Personally, I advise using VBA."}, {"owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "edited": false, "score": 0, "creation_date": 1496253156, "post_id": 44291077, "comment_id": 75589674, "body": "That&#39;s what I was thinking. I&#39;m just super unfamiliar with VBA, I studied chemical engineering in school and we didn&#39;t learn any coding!"}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 1, "last_activity_date": 1496253818, "last_edit_date": 1496253818, "creation_date": 1496251247, "answer_id": 44291077, "question_id": 44290462, "link": "https://stackoverflow.com/questions/44290462/how-to-move-parts-of-a-dynamic-pivot-table-to-a-separate-table/44291077#44291077", "title": "How to move parts of a dynamic pivot table to a separate table?", "body": "<p>Let's assume you want the cell to have the value from \"BEER Total\" for \"M307577\". Then this would be the formula you put in the cell:</p>\n\n<pre><code>=VLOOKUP(\"M307577\",A5:Z100,MATCH(\"BEER Total\",A5:Z5,0),FALSE)\n</code></pre>\n\n<p><code>\"A5:Z100\"</code> would be the whole pivot table and <code>\"A5:Z5\"</code> would be the first row containing variables.</p>\n\n<hr>\n\n<p>As you mentioned you are not familiar with VBA, I would suggest this approach:</p>\n\n<p>Use the first column and first row of the second sheet as a reference. Refer to all the variables from the pivot table there (refer to the cell containing IDs and Variables, and pull the formula to the last row for IDs and last column for variables (or a reasonable range as last column and row would not be sufficient)). This will leave you with zeros, empty cells from the pivot table sheet, but will have all the names that you need.</p>\n\n<p>Then refer to those cells and use the aforementioned formula (instead of names, use the cells that you just created).</p>\n\n<p>Whenever the pivot table updates, those cells will be updated as well and you will see the values for the corresponding ID and Variable. </p>\n"}], "owner": {"reputation": 129, "user_id": 6640500, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/89fc6fb423362fc6ed64691c58975695?s=128&d=identicon&r=PG&f=1", "display_name": "Lampoa", "link": "https://stackoverflow.com/users/6640500/lampoa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1049, "favorite_count": 0, "accepted_answer_id": 44291077, "answer_count": 2, "score": 0, "last_activity_date": 1496253818, "creation_date": 1496249190, "last_edit_date": 1496252135, "question_id": 44290462, "link": "https://stackoverflow.com/questions/44290462/how-to-move-parts-of-a-dynamic-pivot-table-to-a-separate-table", "title": "How to move parts of a dynamic pivot table to a separate table?", "body": "<p>I have pivot table pulling data from a query from a proprietary database system we use at work. I'm trying to figure out a way to move certain parts of the pivot table to a different sheet where it wouldn't exist as a pivot table there. My problem I'm running into is that the table changes the number of columns and rows depending upon the types and amounts of things that we shipped that shift, so I can't have it simply have my new table equal the cell values in the pivot table. </p>\n\n<p><a href=\"https://i.stack.imgur.com/k4ZEb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k4ZEb.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is an example of the pivot data having fewer columns and rows based on what occurred that shift at work.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZQbZ0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZQbZ0.png\" alt=\"enter image description here\"></a></p>\n\n<p>The reason why I would like this in a regular table as opposed to a pivot table is because there's other calculations I'd like to put into the table that extend beyond a pivot table's capabilities (ex. have the user id be displayed as their name, and have a weighted system based off of what the driver moves, but I suppose that's irrelevant.) </p>\n\n<p>I've been poking around the internet, and it seems that the majority of answers to this issue deal with static tables. Any help would be appreciated!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1496257974, "creation_date": 1496257974, "answer_id": 44292979, "question_id": 44290354, "link": "https://stackoverflow.com/questions/44290354/extracting-data-out-of-pivot-table/44292979#44292979", "title": "Extracting data out of Pivot Table", "body": "<p>You can copy the <code>.PivotItems(\"France\").DataRange.EntireRow</code> to \"Sheet2\", without the need to use <code>Select</code>.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Option Explicit\n\nSub CopyPivotItemDataRange()\n\nDim PvtTbl As PivotTable\nDim PvtFld As PivotField\n\n' set the Pivot Table object\nSet PvtTbl = Sheets(\"MY Pivot\").PivotTables(\"MY_Pivot\")\n' set the Pivot Field object\nSet PvtFld = PvtTbl.PivotFields(\"Country\")\n\nWith PvtFld\n    .PivotItems(\"France\").ShowDetail = True 'Show pivot item\n\n    ' copy &gt;&gt; paste the entire Range data under \"France\" to \"Sheet2\"\n    .PivotItems(\"France\").DataRange.EntireRow.Copy Destination:=Sheets(\"Sheet2\").Range(\"A1\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1352, "user_id": 7070298, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/AyWmq.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/7070298/brad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "accepted_answer_id": 44292979, "answer_count": 1, "score": 0, "last_activity_date": 1496257974, "creation_date": 1496248878, "question_id": 44290354, "link": "https://stackoverflow.com/questions/44290354/extracting-data-out-of-pivot-table", "title": "Extracting data out of Pivot Table", "body": "<p>I have a pivot table set up(see image to get a better idea). I am trying to extract data from the pivot table based on the country. You can see that the row country gives access to the row region, and the row region gives access to row product. I want to copy the data under the constraint of: <code>France</code> to get both regions, all products, and the sum of price and move it to sheet2. </p>\n\n<p>Here is my idea how I could go about it, but the select method is not supported in the current property/method. How might I go about selecting all of the data under france?</p>\n\n<pre><code>Sheets(\"MY Pivot\").PivotTables(\"MY_Pivot\").PivotFields(\"Country\").PivotItems(\"France\" _\n    ).ShowDetail = True 'Show pivot item\n\nSheets(\"MY Pivot\").PivotTables(\"MY_Pivot\").PivotFields(\"Country\").PivotItems(\"France\" _\n    ).Select 'Select pivot item to copy\n\nSelection.Copy 'Copy the pivot items\nSheets(\"Sheet2\").Range(\"A1\").Select 'Select sheet cell for paste\nSheets(\"Sheet2\").Paste 'Paste the selected France results\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QwyZv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QwyZv.jpg\" alt=\"Pivot Table\"></a></p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1496252746, "post_id": 44290353, "comment_id": 75589449, "body": "Why not to scrape the data via XHR instead of IE automation?"}, {"owner": {"reputation": 27, "user_id": 3959633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d5ea71efdd69c394a428b9d59bcb822?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3959633/nick"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1496266095, "post_id": 44290353, "comment_id": 75596186, "body": "Can you use XHR when you do not have a specific URL of the results page?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1496268646, "post_id": 44290353, "comment_id": 75597135, "body": "You can find XHR after you click &quot;Show results&quot; manually in browser, in Developer Tools, Network tab: the URL is <a href=\"http://landregistry.data.gov.uk/app/ppd/search\" rel=\"nofollow noreferrer\">landregistry.data.gov.uk/app/ppd/search</a>, method POST, also there are Form Data parameters. Seems there is no need to make POST XHR, since the server responses to simple GET XHR by the URL like <a href=\"http://landregistry.data.gov.uk/app/ppd/search?paon=17&amp;postcode=pl6\" rel=\"nofollow noreferrer\">landregistry.data.gov.uk/app/ppd/&hellip;</a>, more of that the direct link to download csv data is <a href=\"http://landregistry.data.gov.uk/app/ppd/ppd_data.csv?limit=all&amp;paon=17&amp;postcode=pl6\" rel=\"nofollow noreferrer\">landregistry.data.gov.uk/app/ppd/&hellip;</a>"}, {"owner": {"reputation": 27, "user_id": 3959633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d5ea71efdd69c394a428b9d59bcb822?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3959633/nick"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1496302858, "post_id": 44290353, "comment_id": 75608024, "body": "The original question was more to do with what&#39;s wrong with the statement rather than how to get the end data, however,thanks for this. How do I send a SPARQL query"}], "owner": {"reputation": 27, "user_id": 3959633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d5ea71efdd69c394a428b9d59bcb822?s=128&d=identicon&r=PG&f=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3959633/nick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1496248872, "creation_date": 1496248872, "question_id": 44290353, "link": "https://stackoverflow.com/questions/44290353/cannot-read-new-page-html-excel-vba", "title": "Cannot Read New Page HTML Excel VBA", "body": "<p>I am trying to get scraped data from a results page, after I have entered search variables on the previous page. I cannot get the .doc HTML to reflect the new page's html, (well not consistently, it reads correctly in 5-10% of cases). I have looked at other solutions for this problem and the majority come down to not waiting for the new page html to appear, but I have put 5,10 even twenty second waits in but that doesn't seem to do the trick. \nAny advice / pointers would be welcome</p>\n\n<pre><code>&lt;code&gt;Sub ParseInternet()\n\nDim post_code As String\nDim house_num As String\npost_code = CStr(Sheet1.Cells(9, 2).Value)  'get search data from worksheet\nhouse_num = CStr(Sheet1.Cells(9, 1).Value)\nIf post_code = \"\" Then\n    MsgBox (\"House Name /Number and postcode MUST be entered\")\n    Exit Sub\nEnd If\nSet site = CreateObject(\"InternetExplorer.application\")\nDim url As String\nurl = \"http://landregistry.data.gov.uk/app/ppd\"\n\nsite.Navigate url\nWhile site.ReadyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n\nsite.Visible = True\nsite.Document.getElementById(\"paon\").Value = house_num\nsite.Document.getElementById(\"postcode\").Value = post_code\nSet my_classes = site.Document.getElementsByClassName(\"btn btn-primary\")\nFor Each my_class In my_classes\n     my_class.Click\nNext my_class   \n\nWhile site.ReadyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n Application.Wait (Now + TimeValue(\"0:00:10\"))\n Dim a As String\n Dim b As String\n b = \"property by searching for\"\n '''STILL PREVIOUS PAGE HTML IN .DOC\n Set HTMLLI = site.Document.getElementsByTagName(\"div\")\n\n For xli = 0 To HTMLLI.Length - 1\n    a = site.Document.getElementsByTagName(\"div\")(xli).innerText\n    If InStr(site.Document.getElementsByTagName(\"div\")(xli).innerText, b) Then\n        Sheet1.Cells(9, 4).Value = site.Document.getElementsByTagName(\"div\")(xli).innerText\n        Exit For\n    End If\n\nNext xli\nsite.Quit\nSet site = Nothing\nEnd Sub\n&lt;/code&gt;\n</code></pre>\n"}, {"tags": ["excel", "selenium-webdriver", "vba"], "answers": [{"comments": [{"owner": {"reputation": 326, "user_id": 1480143, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/963f238f2da633547f19064d72f88233?s=128&d=identicon&r=PG", "display_name": "Sanjoy", "link": "https://stackoverflow.com/users/1480143/sanjoy"}, "edited": false, "score": 0, "creation_date": 1496406806, "post_id": 44294747, "comment_id": 75662217, "body": "Since you cannot click an element which is not displayed using webdriver, but executing a javascript works even if the element is not displayed."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1496265106, "creation_date": 1496265106, "answer_id": 44294747, "question_id": 44289599, "link": "https://stackoverflow.com/questions/44289599/execute-javascript-using-selenium-webdriver/44294747#44294747", "title": "Execute JavaScript using Selenium Webdriver", "body": "<p>For what it's worth,</p>\n\n<pre><code>driver.ExecuteScript(\"$x(\"//label[text()[contains(.,'British')]]\")[0].children[1].children[0].click()\")\n</code></pre>\n\n<p>should be written like this:</p>\n\n<pre><code>driver.ExecuteScript(\"$x(\"\"//label[text()[contains(.,'British')]]\"\")[0].children[1].children[0].click()\")\n</code></pre>\n"}], "owner": {"reputation": 326, "user_id": 1480143, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/963f238f2da633547f19064d72f88233?s=128&d=identicon&r=PG", "display_name": "Sanjoy", "link": "https://stackoverflow.com/users/1480143/sanjoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2300, "favorite_count": 0, "accepted_answer_id": 44294747, "answer_count": 1, "score": 1, "last_activity_date": 1496406739, "creation_date": 1496246646, "last_edit_date": 1531164843, "question_id": 44289599, "link": "https://stackoverflow.com/questions/44289599/execute-javascript-using-selenium-webdriver", "title": "Execute JavaScript using Selenium Webdriver", "body": "<p>Hi I am trying to execute a JavaScript in VBA in the native excel application using Selenium Wrapper.</p>\n\n<p>The following code executes a JavaScript on Chrome Console and gives me my expected output. </p>\n\n<pre><code>$x(\"//label[text()[contains(.,'British')]]\")[0].children[1].children[0].click()\n</code></pre>\n\n<p>To execute JavaScript usually it needs to be in double quotes however this is not accepted by VBA since it has two double quotes.</p>\n\n<pre><code>driver.ExecuteScript(\"$x(\"//label[text()[contains(.,'British')]]\")[0].children[1].children[0].click()\")\n</code></pre>\n\n<p>I tried to define it as a string in another variable with the concatenation of the values, but it is still giving me error.</p>\n\n<p>I don't want findElementByXpath with click method. Would request if anyone knows a workaround of this.</p>\n\n<p><strong>Edit 1</strong>\ninstead of $x which works on chrome, using document.evaluate works in webdriver. </p>\n"}, {"tags": ["vb.net", "vba", "excel", "dll"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1496247074, "post_id": 44289348, "comment_id": 75586121, "body": "What is the error? &quot;does not work&quot; doesn&#39;t mean anything. Did you reference the type library in VBA? Where and how is <code>objMda</code> declared and assigned? Does the VB.NET code have the required type and member attributes? Do you see your VB.NET API in VBA&#39;s object browser? Have you tried passing the arrays <code>As Object</code> and <code>ByRef</code>? Is your VB.NET code catching any exception? Have you tried debugging the VB.NET code by attaching to the EXCEL.EXE process? Do you know that you could use <code>System.Collections.ArrayList</code> directly in VBA for this?"}, {"owner": {"reputation": 103, "user_id": 7150232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954e4cbcd44f1ce9e101705bfb5f0114?s=128&d=identicon&r=PG&f=1", "display_name": "MDA", "link": "https://stackoverflow.com/users/7150232/mda"}, "edited": false, "score": 0, "creation_date": 1496248957, "post_id": 44289348, "comment_id": 75587238, "body": "the error is &quot;Microsoft Excel stop working&quot;...when i use fuction widout any byref variable in the library the library is working perfect but when i use byref variable in library Excel stop working and restart excel."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1496249221, "post_id": 44289348, "comment_id": 75587386, "body": "&quot;Microsoft Excel stopped working&quot; is because your DLL is throwing an exception without catching it. You need to attach the VS debugger to the running EXCEL.EXE process and see what the exception is. Consider exposing a <code>Function</code> instead of returning your result with a <code>ByRef</code> parameter."}, {"owner": {"reputation": 103, "user_id": 7150232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954e4cbcd44f1ce9e101705bfb5f0114?s=128&d=identicon&r=PG&f=1", "display_name": "MDA", "link": "https://stackoverflow.com/users/7150232/mda"}, "edited": false, "score": 0, "creation_date": 1496249756, "post_id": 44289348, "comment_id": 75587737, "body": "i know that when i use function without byref variable the dll works.but i need a sub that return several variable and for this purpose i must use byref variable"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496250019, "post_id": 44289348, "comment_id": 75587881, "body": "You realize that makes a shitty API? Your sorting method has one single return value. A method that returns one single return value should be implemented as a <code>Function</code> that <i>returns</i> that value - that&#39;s how idiomatic VBA/VB/.NET code is written. Your method doesn&#39;t return &quot;several variables&quot;, so there&#39;s nothing in what you have here that justifies abusing <code>ByRef</code> like this. Declare <code>Sorted_Item</code> as a <code>Variant</code> and make the VB.NET code take a <code>ByRef outResult As Object</code> if you absolutely want that. Just saying, it&#39;s ugly code. Yours is probably failing because <code>Sorted_Item</code> isn&#39;t initialized."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496250108, "post_id": 44289348, "comment_id": 75587928, "body": "VBA talking to .NET happens through COM interop; your VBA array needs to be marshaled before VB.NET can use it. Again, <b>use a debugger attached to your process</b> to find out what the exact exception is, we can&#39;t do that for you."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496250316, "post_id": 44289348, "comment_id": 75588069, "body": "Also your <code>Function</code> is inefficient, it&#39;s iterating the array more than it needs to. Remove the <code>ToList</code> call to <code>Return arr.Distinct.ToArray</code> instead, you&#39;ll have the same result, pretty much twice as fast."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 1, "creation_date": 1496250431, "post_id": 44289348, "comment_id": 75588151, "body": "BTW, no need to convert it to list. just <code>Return arr.Distinct.ToArray</code> and <code>a = arr.ToArray : Array.Sort(a)</code>"}, {"owner": {"reputation": 103, "user_id": 7150232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954e4cbcd44f1ce9e101705bfb5f0114?s=128&d=identicon&r=PG&f=1", "display_name": "MDA", "link": "https://stackoverflow.com/users/7150232/mda"}, "edited": false, "score": 0, "creation_date": 1496252077, "post_id": 44289348, "comment_id": 75589092, "body": "the dll file works in vb.net.i create a project in vb.net and reference dll file and works perfect.but dll doesn&#39;t work in excel"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1496253146, "post_id": 44289348, "comment_id": 75589670, "body": "Yes, we got that part. You need to debug your VB.NET dll <i>when it is used through VBA</i>. To do that you need to attach the VB.NET / Visual Studio debugger to the running EXCEL.EXE process, place a breakpoint on the first executable statement, execute the failing VBA code (which calls your dll), and then you can step through the VB.NET code and inspect what VBA has been giving you. The VB.NET code is throwing an exception, and without knowing what that exception is, you&#39;re working blindly."}, {"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 0, "creation_date": 1496283448, "post_id": 44289348, "comment_id": 75600817, "body": "It is strange that you state that passing an array from VBA to .Net as <code>ByVal</code> works.  Typically, this results in the VBA compiler error:  <i>Function or interface marked as restricted, or the function uses an Automation type not supported in Visual Basic</i>, with the resolution being to declare the argument as <code>ByRef</code> (see: <a href=\"https://web.archive.org/web/20140531181434/http://support.microsoft.com:80/kb/327084\" rel=\"nofollow noreferrer\">BUG: Visual Basic 6.0 cannot use the .NET method with the ParamArray parameter in Visual Studio .NET</a>)."}, {"owner": {"reputation": 103, "user_id": 7150232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954e4cbcd44f1ce9e101705bfb5f0114?s=128&d=identicon&r=PG&f=1", "display_name": "MDA", "link": "https://stackoverflow.com/users/7150232/mda"}, "edited": false, "score": 0, "creation_date": 1496510892, "post_id": 44289348, "comment_id": 75696069, "body": "I attached debugger to EXCEL.EXE and error was this &quot;Exception thrown at 0x70731138 (clr.dll) in EXCEL.EXE: 0xC0000005: Access violation reading location 0x00000002.  If there is a handler for this exception, the program may be safely continued.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 7150232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954e4cbcd44f1ce9e101705bfb5f0114?s=128&d=identicon&r=PG&f=1", "display_name": "MDA", "link": "https://stackoverflow.com/users/7150232/mda"}, "is_accepted": true, "score": 1, "last_activity_date": 1496917526, "last_edit_date": 1496917526, "creation_date": 1496916000, "answer_id": 44432562, "question_id": 44289348, "link": "https://stackoverflow.com/questions/44289348/create-dll-file-in-vb-net-and-use-in-excel-vba/44432562#44432562", "title": "Create DLL file in VB.NET and use in Excel VBA", "body": "<p>Finally i can find my answer.\ncode in vb.net </p>\n\n<pre><code>Public Class MainClass\n    Sub sortArr(ByVal arr As String(), ByRef sortedarr As String())\n        sortedarr = arr\n        Array.Sort(sortedarr)\n\n    End Sub\nEnd Class\n</code></pre>\n\n<p>and code in excel vba:</p>\n\n<pre><code>Sub aaa()\nDim Mycode As excelcode.MainClass\nSet Mycode = New excelcode.MainClass\nDim arr(2) As String\narr(0) = \"m\"\narr(1) = \"a\"\narr(2) = \"d\"\nDim sortedArr() As String\nReDim sortedArr(0)\n  Mycode.sortArr arr, sortedArr\nEnd Sub\n</code></pre>\n\n<p>by this code i can pass array byval to vb.net dll then vb.net pass sorted array.</p>\n"}], "owner": {"reputation": 103, "user_id": 7150232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/954e4cbcd44f1ce9e101705bfb5f0114?s=128&d=identicon&r=PG&f=1", "display_name": "MDA", "link": "https://stackoverflow.com/users/7150232/mda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2860, "favorite_count": 0, "accepted_answer_id": 44432562, "answer_count": 1, "score": 2, "last_activity_date": 1496917526, "creation_date": 1496245870, "last_edit_date": 1531164843, "question_id": 44289348, "link": "https://stackoverflow.com/questions/44289348/create-dll-file-in-vb-net-and-use-in-excel-vba", "title": "Create DLL file in VB.NET and use in Excel VBA", "body": "<p>I have created a DLL file in VB.NET and I want use it in Excel VBA. When I use it like a function it is working perfect but when I use sub with a <code>ByRef</code> variable it does not work and Excel restarts with an error.</p>\n\n<p>The code in VB.NET is:</p>\n\n<pre><code>Public Function distinctArr(ByVal arr As String()) As String()\n        Return arr.ToList.Distinct.ToArray\nEnd Function\n\nPublic Sub sortArr(ByVal arr As String(), ByRef a As String())\n    Dim tolist As List(Of String) = arr.ToList\n    tolist.Sort()\n    a = tolist.ToArray\nEnd Sub\n</code></pre>\n\n<p>This is the code in VBA:    </p>\n\n<pre><code>Dim objMda As Excelcode.mda\nSet objMda = New Excelcode.mda\nDim distinc_Item() As String\nDim all_Items() As String\nall_Items = rng_to_string(rng_rizmetre)\ndistinc_Item = objMda.distinctArr(all_Items) '''This line is working perfect\nDim Sorted_Item() As String\nobjMda.sortArr distinc_Item, Sorted_Item\n</code></pre>\n\n<p>What is wrong with the code?</p>\n"}, {"tags": ["php", "vba", "ms-word", "com"], "comments": [{"owner": {"reputation": 23, "user_id": 2785695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7059b8799a63b0542db9d942b55c01f?s=128&d=identicon&r=PG&f=1", "display_name": "alex lapin", "link": "https://stackoverflow.com/users/2785695/alex-lapin"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496390432, "post_id": 44289342, "comment_id": 75652269, "body": "I&#39;ve edited my post and changed a little the question, any help is welcomed :)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496424176, "post_id": 44289342, "comment_id": 75672496, "body": "Please post more of your code block and not few line snippets. We need to see how you initialize COM object."}, {"owner": {"reputation": 23, "user_id": 2785695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7059b8799a63b0542db9d942b55c01f?s=128&d=identicon&r=PG&f=1", "display_name": "alex lapin", "link": "https://stackoverflow.com/users/2785695/alex-lapin"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496646326, "post_id": 44289342, "comment_id": 75728302, "body": "HI, I&#39;ve edited my 1st post and added the full code. I&#39;ve found something ...  I was using apache 2.4.25 x64 vc14 + php 7.0.17 x64 vc14 + office 2010 x64,  I&#39;ve changed apache and php with the same versions but x86 ... and all is working now ... so my problem is solved ... but i&#39;m curious why it isnt working with x64 versions"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 15564095, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Girm_L5vAh9WMriCdoUY78FML0FwPlBBKBvZLq47w=k-s128", "display_name": "Amirreza Noori", "link": "https://stackoverflow.com/users/15564095/amirreza-noori"}, "is_accepted": false, "score": 0, "last_activity_date": 1618234310, "last_edit_date": 1618234310, "creation_date": 1618125315, "answer_id": 67042367, "question_id": 44289342, "link": "https://stackoverflow.com/questions/44289342/php-comword-application-functions-and-methods-parameters-issue/67042367#67042367", "title": "PHP COM(&#39;word.application&#39;) functions and methods parameters issue", "body": "<p>The only problem that I see in this code is related to <code>protect</code> <code>function</code>. First parameter must be <code>VARIANT</code> like this :</p>\n<pre><code>$word-&gt;Documents[1]-&gt;Protect(\n        new VARIANT(3, VT_I4),\n        false,\n        'Your password',\n        false,\n        true\n  );     \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2785695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7059b8799a63b0542db9d942b55c01f?s=128&d=identicon&r=PG&f=1", "display_name": "alex lapin", "link": "https://stackoverflow.com/users/2785695/alex-lapin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 937, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1618234310, "creation_date": 1496245854, "last_edit_date": 1496646967, "question_id": 44289342, "link": "https://stackoverflow.com/questions/44289342/php-comword-application-functions-and-methods-parameters-issue", "title": "PHP COM(&#39;word.application&#39;) functions and methods parameters issue", "body": "<p>I'm using php and new COM('word.application') to manipulate a .doc file (add and edit fields), I'm on a Windows Server 2012 R2 with apache 2.4.25 x64 and php 7.0.17 x64.</p>\n\n<p>So far I made a simple code which work great, but I have an issue when using functions with multiple parameters like this one</p>\n\n<pre><code>$word-&gt;Documents[1]-&gt;Protect(3, false, 'mypassword', false, false);\n</code></pre>\n\n<p>I get the following error :</p>\n\n<p>[Erreur] Impossible de lancer le connecteur Microsoft Office Word. : com_exception: Parameter 4: Le type ne correspond pas</p>\n\n<p>Approx translation in english :</p>\n\n<p>[Error] Impossible to laungh the Microsoft Office Word connector : com_exception: Parameter 4: type does not correspond</p>\n\n<p>In VBA code like this it's working</p>\n\n<pre><code>ActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True\n</code></pre>\n\n<p>According to the doc found in VBA</p>\n\n<p><a href=\"https://i.stack.imgur.com/zXc4X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zXc4X.png\" alt=\"And this : https://msdn.microsof\"></a>t.com/en-us/library/office/aa220366(v=office.11).aspx</p>\n\n<p>Parameters 2, 4 and 5 should be booleans, so I don't know why I'm getting this error. If i remove parameters 4 and 5, I get the same error but on parameter 2.</p>\n\n<p>With some searches i looked at the object new VARIANT() but it didn't work too.</p>\n\n<p>I have also the problem with $this->Documents<a href=\"https://i.stack.imgur.com/zXc4X.png\" rel=\"nofollow noreferrer\">1</a>->SaveAs()</p>\n\n<pre><code>$fileName = \"D:\\\\test.doc\";\n$this-&gt;Documents[1]-&gt;SaveAs($fileName);\n</code></pre>\n\n<p>It works.</p>\n\n<p>According to the doc (<a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.document.saveas(v=vs.120).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/microsoft.office.tools.word.document.saveas(v=vs.120).aspx</a>) I should be able to use a second parameter like this :</p>\n\n<pre><code>$fileName = \"D:\\\\test.doc\";\n$fileFormat = 0;\n$this-&gt;Documents[1]-&gt;SaveAs($fileName, $fileFormat);\n</code></pre>\n\n<p>Like this I have the error \"Parameter 0: Le type ne correspond pas\" (Type does not correspond).</p>\n\n<p>In VBA it's working differently, maybe I'm doing something wrong ... </p>\n\n<p>Much thanks if you help me :)</p>\n\n<p>edit : full example code</p>\n\n<pre><code>&lt;?php\n\n$word = new COM(\"word.application\") or die(\"Cannot create Word object\");\necho \"com object created&lt;br&gt;\";\n$word-&gt;Visible = false;\n$word-&gt;WindowState = 2;\n$word-&gt;DisplayAlerts = false;\n$word-&gt;Documents-&gt;Open(\"D:\\\\test.doc\");\necho \"document loaded&lt;br&gt;\";\n\n$import = $word-&gt;Documents[1]-&gt;VBProject-&gt;VBComponents-&gt;Import(\"D:\\\\fr.mac\");\n$import-&gt;name = \"Macrofr\";\n\n$myModule = $word-&gt;Documents[1]-&gt;VBProject-&gt;VBComponents-&gt;Import(\"D:\\\\test1.mac\");\n$myModule-&gt;name = \"MacroInit\";\n\n$myModule2 = $word-&gt;Documents[1]-&gt;VBProject-&gt;VBComponents-&gt;Import(\"D:\\\\test2.mac\");\n$myModule2-&gt;name = \"MacroFonction\";\n\n$myModule3 = $word-&gt;Documents[1]-&gt;VBProject-&gt;VBComponents-&gt;Import(\"D:\\\\test3.frm\");\n$myModule3-&gt;name = \"MacroProgression\";\n\n\n$word-&gt;Documents[1]-&gt;Protect(3,false,'motdepasse',false,false); // (type de protection,noReset,mdp)\n\n$word-&gt;Documents[1]-&gt;SaveAs(\"D:\\\\doc_with_macro.doc\", 0);\n$word-&gt;Documents[1]-&gt;Close();\necho \"closing doc&lt;br&gt;\";\n\n$word-&gt;Quit();\n$word = null;\necho \"end&lt;br&gt;\";\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1496245748, "post_id": 44289281, "comment_id": 75585264, "body": "You&#39;re setting the DOMdocument <i>before</i> you actually navigate to the desired page..."}, {"owner": {"reputation": 3760, "user_id": 4031083, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-cunV3U71-ec/AAAAAAAAAAI/AAAAAAAAANw/JtcloU-mZrw/photo.jpg?sz=128", "display_name": "Baro", "link": "https://stackoverflow.com/users/4031083/baro"}, "edited": false, "score": 0, "creation_date": 1496246040, "post_id": 44289281, "comment_id": 75585466, "body": "Try to wait for readyState on the second &quot;browser.navigate&quot;, probably the page is not ready yet."}, {"owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "edited": false, "score": 0, "creation_date": 1496246113, "post_id": 44289281, "comment_id": 75585516, "body": "So could I just reset HTMLDoc (Set HTMLDoc = Browser.document) after I have navigated my desired page? Or would I have to create a new instance of DOMdocument? thanks for the quick response btw"}, {"owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "reply_to_user": {"reputation": 3760, "user_id": 4031083, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-cunV3U71-ec/AAAAAAAAAAI/AAAAAAAAANw/JtcloU-mZrw/photo.jpg?sz=128", "display_name": "Baro", "link": "https://stackoverflow.com/users/4031083/baro"}, "edited": false, "score": 0, "creation_date": 1496246334, "post_id": 44289281, "comment_id": 75585668, "body": "@Baro I tried that but it just waits forever."}, {"owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "edited": false, "score": 0, "creation_date": 1496248130, "post_id": 44289281, "comment_id": 75586740, "body": "I tried setting the DOMdocument after and it worked for the first run, then stopped working :( . I tried creating a new instance of DOMdocument and still no luck."}], "answers": [{"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 0, "last_activity_date": 1496249015, "creation_date": 1496249015, "answer_id": 44290394, "question_id": 44289281, "link": "https://stackoverflow.com/questions/44289281/vba-how-to-refresh-htmldocument-object-when-navigating-new-html-page-on-same-b/44290394#44290394", "title": "(VBA) How to refresh HTMLDocument object when navigating new html page on same browser?", "body": "<p><strong>Not tested:</strong></p>\n\n<p>Try replacing </p>\n\n<pre><code>Set eleColtr = HTMLDoc.getElementsByTagName(\"tr\")\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>Set eleColtr = Nothing\nFor i = 1 To 50\n    On Error Resume Next\n    Set eleColtr = HTMLDoc.getElementsByTagName(\"tr\")\n    If Err.Number = 91 Then\n        GoTo Skip\n    End If\n    Exit For\nSkip:\nApplication.Wait (Now() + TimeValue(\"00:00:001\"))\nNext i\n</code></pre>\n\n<p>I have not tested this so if you still get the last table's details, then you need to set HTMLDoc again.</p>\n"}, {"tags": [], "owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "is_accepted": true, "score": 0, "last_activity_date": 1496250472, "creation_date": 1496250472, "answer_id": 44290858, "question_id": 44289281, "link": "https://stackoverflow.com/questions/44289281/vba-how-to-refresh-htmldocument-object-when-navigating-new-html-page-on-same-b/44290858#44290858", "title": "(VBA) How to refresh HTMLDocument object when navigating new html page on same browser?", "body": "<p>I did eventually get my code to work, thanks everyone for their help. @Macro Man was correct in that I didn't set DOMdocument after I navigated to my desired page. So I created a new instance of DOMdocument after my Browser.navigate but that's not all that was needed. For some reason I needed to navigate to my desired page again right before setting my new DOMdocument. I still am confused why this works but who cares it works.</p>\n\n<pre><code>Browser.navigate (\"URL\")\n\n\nDebug.Print \"DELAY STARTED\"\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\n\nBrowser.navigate (\"URL\")'DONT REMOVE OR WILL BREAK\nSet WTF = Browser.document ' my new instance of DOMdocument\n\nDebug.Print \"Second Delay\"\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\n\n'*****************************************************************************************************************************************\n'http://www.ozgrid.com/forum/showthread.php?t=184695\nDim eleColtr As MSHTML.IHTMLElementCollection 'Element collection for tr tags\nDim eleColtd As MSHTML.IHTMLElementCollection 'Element collection for td tags\nDim eleRow As MSHTML.IHTMLElement 'Row elements\nDim eleCol As MSHTML.IHTMLElement 'Column elements\n\nSet eleColtr = WTF.getElementsByTagName(\"tr\") 'Find all tr tags\n'This section populates Excel\n    i = 0 'start with first value in tr collection\n    For Each eleRow In eleColtr 'for each element in the tr collection\n        Debug.Print \"goodnews\"\n        Set eleColtd = WTF.getElementsByTagName(\"tr\")(i).getElementsByTagName(\"td\") 'get all the td elements in that specific tr\n        j = 0 'start with the first value in the td collection\n        For Each eleCol In eleColtd 'for each element in the td collection\n            Sheets(\"Sheet1\").Range(\"A1\").Offset(i, j).Value = eleCol.innerText 'paste the inner text of the td element, and offset at the same time\n            j = j + 1 'move to next element in td collection\n        Next eleCol 'rinse and repeat\n        i = i + 1 'move to next element in td collection\n    Next eleRow 'rinse and repeat \n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 4665692, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BXJxN.jpg?s=128&g=1", "display_name": "sourceCode", "link": "https://stackoverflow.com/users/4665692/sourcecode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2272, "favorite_count": 0, "accepted_answer_id": 44290858, "answer_count": 2, "score": 0, "last_activity_date": 1496250472, "creation_date": 1496245644, "last_edit_date": 1531164843, "question_id": 44289281, "link": "https://stackoverflow.com/questions/44289281/vba-how-to-refresh-htmldocument-object-when-navigating-new-html-page-on-same-b", "title": "(VBA) How to refresh HTMLDocument object when navigating new html page on same browser?", "body": "<p>I am tasked with creating a macro that logs into a website and navigates to a specific page where a html table can be copied into excel. My problem is that when I try to pull the html table, I get the html table of the previous webpage. My thinking is I need to update my HTMLDocument some how. Is this possible? I unfortunately can't give the specific URL as it's confidential.</p>\n\n<p>My code can be found below.</p>\n\n<pre><code>Sub website_login()\n\n'variables\nDim HTMLDoc As HTMLDocument\nDim Browser As InternetExplorer\nDim HTML_Element As IHTMLElement\nDim URL As String\nDim l As Object\n\nOn Error GoTo Err_Clear\nURL = \"MY URL\"\n\nSet Browser = New InternetExplorer\n    Browser.Silent = True\n    Browser.navigate URL\n    Browser.Visible = True\n\nWith Browser\nDo While .Busy Or .readyState &lt;&gt; 4\n    DoEvents\nLoop\nEnd With\n\nSet HTMLDoc = Browser.document\n\n'fill in login credentials\nHTMLDoc.getElementById(\"username\").Value = \"USERNAME\" \nHTMLDoc.getElementById(\"password\").Value = \"PASSWORD\"\n\n'loop through collection of INPUT tags and Login In\nFor Each HTML_Element In HTMLDoc.getElementsByTagName(\"input\")\n    If HTML_Element.Value = \"Login\" Then\n        HTML_Element.Click\n        Exit For\n    End If\nNext\n\n'will be brought back to login if delays aren't added\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\nApplication.Wait (Now + TimeValue(\"0:00:05\")) ' delay 5 seconds\n\nBrowser.navigate (\"NEW URL\")'navigate to new webpage on same website\n\n\n'BELOW CODE COPIES TABLE INTO EXCEL\n'http://www.ozgrid.com/forum/showthread.php?t=184695\nDim eleColtr As MSHTML.IHTMLElementCollection 'Element collection for tr tags\nDim eleColtd As MSHTML.IHTMLElementCollection 'Element collection for td tags\nDim eleRow As MSHTML.IHTMLElement 'Row elements\nDim eleCol As MSHTML.IHTMLElement 'Column elements\n\nSet eleColtr = HTMLDoc.getElementsByTagName(\"tr\") 'Find all tr tags\n'This section populates Excel\n    i = 0 'start with first value in tr collection\n    For Each eleRow In eleColtr 'for each element in the tr collection\n        Set eleColtd = HTMLDoc.getElementsByTagName(\"tr\")(i).getElementsByTagName(\"td\") 'get all the td elements in that specific tr\n        j = 0 'start with the first value in the td collection\n        For Each eleCol In eleColtd 'for each element in the td collection\n            Sheets(\"Sheet1\").Range(\"A1\").Offset(i, j).Value = eleCol.innerText 'paste the inner text of the td element, and offset at the same time\n            j = j + 1 'move to next element in td collection\n        Next eleCol 'rinse and repeat\n        i = i + 1 'move to next element in td collection\n    Next eleRow 'rinse and repeat\n\n\n\nDebug.Print \"DONE!\"\nExit Sub\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nErr.Clear\nResume Next\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel", "adodb"], "comments": [{"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1496248413, "post_id": 44289124, "comment_id": 75586915, "body": "Can you better explain what the problem is?"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1496248517, "post_id": 44289124, "comment_id": 75586981, "body": "This is easier achieved by removing the fourth column (the one with test123) from your query and modifying the query to become a group-by query."}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1496248621, "post_id": 44289124, "comment_id": 75587043, "body": "@jkpieterse, unfortunately I need to keep the column that has the test123 as it has data that is needed. Can a group by still be used with this column? Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1496303014, "post_id": 44291550, "comment_id": 75608128, "body": "thank you this work perfectly!! It would have taken me ages to get to this on my own. Is is possible to exclude rows where [F10] = 0. Thanks for the assistance."}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1496303594, "post_id": 44291550, "comment_id": 75608524, "body": "I think i managed to follow along correctly and got it to work, i am still new to using SQL and especially aggregate queries, but i add &#39;WHERE NOT main.[F10] = 0&#39; just before the group by, which seems to be working, is this is wrong please do let me know. Thank You"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1496327345, "post_id": 44291550, "comment_id": 75625921, "body": "Nope, <code>WHERE</code> clause should go before <code>GROUP BY</code>. Glad to help! Happy coding!"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1497602651, "post_id": 44291550, "comment_id": 76157191, "body": "Hello there, i know its been a couple of weeks, but i have been doing some further testing, and i am still getting zeros in F10, could i pick your brain again please. Thank You"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1497628055, "post_id": 44291550, "comment_id": 76174376, "body": "Maybe <i>F10</i> is a string, try wraping 0 in quotes: <code>WHERE NOT main.[F10] = &#39;0&#39;</code>"}, {"owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "edited": false, "score": 0, "creation_date": 1497630492, "post_id": 44291550, "comment_id": 76175650, "body": "Hi, thanks for getting back to me, it turns out I needed to use Having, after the group by."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1496253001, "creation_date": 1496253001, "answer_id": 44291550, "question_id": 44289124, "link": "https://stackoverflow.com/questions/44289124/excel-vba-adodb-sql-sum-if-data-matches/44291550#44291550", "title": "Excel VBA ADODB SQL sum if data matches", "body": "<p>As mentioned, consider an aggregate query grouped by first three columns, <em>F7</em>, <em>F9</em>, <em>F6</em>, summing <em>F10</em> and taking the max of all other non-grouped columns. Max/Min works on strings and numbers.</p>\n\n<p>Notice your original query embedded as a derived table with aggregate on outside. Below is the SQL version to be incorporated into your VBA string. Do not use <code>Join()</code> due to <code>GROUP BY</code>:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT main.[wF7], main.[F9], main.[F6], Max(main.[F8]) As maxF8, \n       Sum(main.[F10]) As sumF10, Max(main.[F11]) As maxF11, \n       Max(main.[F15]) As maxF15, Max(main.[F25]) As maxF25, Max(main.[sF7]) As maxsF7\nFROM\n\n  (SELECT sWIR.[F7] As wF7, sWIR.[F9], sWIR.[F6], sWIR.[F8], sWIR.[F10],\n          sWIR.[F11], sWIR.[F15], sWIR.[F25], sCodes.[F7] As sF7\n   FROM [\" &amp; SourceWIR &amp; \"] AS sWIR \n   INNER JOIN [\" &amp; SourceCODES &amp; \"] AS sCodes \n       ON sWIR.[F5] = sCodes.[F6]\n   WHERE sWIR.[F1] ='\" &amp; Address &amp; \"') AS main\n\nGROUP BY main.[wF7], main.[F9], main.[F6]\nORDER BY Max(main.[sF7]), main.[wF7]\n</code></pre>\n"}], "owner": {"reputation": 491, "user_id": 4925420, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/a46e2bd849822edc3501d1f41079f607?s=128&d=identicon&r=PG&f=1", "display_name": "atame", "link": "https://stackoverflow.com/users/4925420/atame"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1881, "favorite_count": 0, "accepted_answer_id": 44291550, "answer_count": 1, "score": 0, "last_activity_date": 1497614191, "creation_date": 1496245250, "last_edit_date": 1497614191, "question_id": 44289124, "link": "https://stackoverflow.com/questions/44289124/excel-vba-adodb-sql-sum-if-data-matches", "title": "Excel VBA ADODB SQL sum if data matches", "body": "<p>This is the query I am currently using to generate my SQL string, which is currently getting the correct information.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim colArray As Variant: colArray = Array(7,9,6,8,10,11,15,25)                               \n\nszSQL = \"SELECT \n          sWIR.[F\" &amp; Join(colArray, \"], sWIR.[F\") &amp; \"], sCodes.[F7]\n          FROM [\" &amp; SourceWIR &amp; \"] sWIR INNER JOIN [\" &amp; SourceCODES &amp; \"] AS sCodes ON sWIR.[F5] = sCodes.[F6] \n          WHERE sWIR.[F1] =\"\"\" &amp; Address &amp; \"\"\" \n          ORDER BY sCodes.[F7], sWIR.[F7];\"\n</code></pre>\n\n<p>What I need it to include is if the data in columns 7, 9, 6 are equal then sum column 10</p>\n\n<p>Below is the full code, I am using for the ADODB Connection</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim szConnect As String, szSQL As String\nDim SourceFileName As String: SourceFileName = Left(wb.Name, Len(wb.Name) - 5)\nDim SourceFile As String: SourceFile = wb.FullName\nDim rsCon As New ADODB.Connection\nDim rsData As New ADODB.Recordset\nszConnect = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; \"Data Source=\" &amp; SourceFile &amp; \";\" &amp; \"Extended Properties=\"\"Excel 12.0;HDR=No\"\";\"\nrsCon.Open szConnect\n\nDim LastRow As Long: LastRow = wb.WIR.Cells(Rows.Count, \"A\").End(xlUp).Row\nDim LastCol As Long: LastCol = wb.WIR.Cells(1, wb.WIR.Columns.Count).End(xlToLeft).Column\n\nDim SourceWIR As String: SourceWIR = wb.WIR.Name &amp; \"$\"\nDim SourceCODES As String: SourceCODES = wb.CODES.Name &amp; \"$\"\n\nDim colArray As Variant: colArray = Array(7,9,6,8,10,11,15,25)\n\nszSQL = \"SELECT  sWIR.[F\" &amp; Join(colArray, \"], sWIR.[F\") &amp; \"], sCodes.[F7]FROM [\" &amp; SourceWIR &amp; \"] sWIR INNER JOIN [\" &amp; SourceCODES &amp; \"] AS sCodes ON sWIR.[F5] = sCodes.[F6] \" &amp; _\n        \"WHERE sWIR.[F1] =\"\"\" &amp; Address &amp; \"\"\" ORDER BY sCodes.[F7], sWIR.[F7];\"\n\nrsData.Open szSQL, rsCon, adOpenKeyset, adLockOptimistic\n\nwb.Sheets(\"Sheet2\").Range(\"A25\").CopyFromRecordset rsData\n</code></pre>\n\n<p>Below is an image of what the data looks like now, and how the data should look when matches are found.</p>\n\n<p><a href=\"https://i.stack.imgur.com/2A0ZZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2A0ZZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>With help from Parfait, who provided me with the correct string.</p>\n\n<p>After spending hours googling and testing I was able to get the correct string to exclude zero values.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>szSQL = SELECT \n             main.[wF7], main.[F9], main.[F6], Max(main.[F8]) As maxF8,\n             Sum(main.[F10]) As sumF10, Max(main.[F11]) As maxF11, \n             Max(main.[F15]) As maxF15, Max(main.[F25]) As maxF25, \n             Max(main.[sF7]) As maxsF7 \n         FROM (\n             SELECT \n                 sWIR.[F7] As wF7, sWIR.[F9], sWIR.[F6], sWIR.[F8], sWIR.[F10],\n                 sWIR.[F11], sWIR.[F15], sWIR.[F25], sCodes.[F7] As sF7 \n             FROM \n                 [Works Instruction Record$] AS sWIR \n             INNER JOIN \n                 [Codes$] AS sCodes \n             ON \n                 sWIR.[F5] = sCodes.[F6] \n             WHERE \n                 sWIR.[F1] =\"1 Foney Road\") AS main \n         GROUP BY \n             main.[wF7], main.[F9], main.[F6] \n         HAVING \n             Sum(main.[F10]) = 0 \n         ORDER BY \n             Max(main.[sF7]), main.[wF7];\n</code></pre>\n\n<p>I found that when using a group by, I needed to use a having clause with the same sum statement used within the select.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2877, "user_id": 5111870, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BEtKy.jpg?s=128&g=1", "display_name": "kk.", "link": "https://stackoverflow.com/users/5111870/kk"}, "edited": false, "score": 0, "creation_date": 1496245072, "post_id": 44288908, "comment_id": 75584827, "body": "Please show us what you have done first."}, {"owner": {"reputation": 1, "user_id": 4363425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7461531b39d8b2977bc4985c00b0712?s=128&d=identicon&r=PG&f=1", "display_name": "rukumini venkatesh", "link": "https://stackoverflow.com/users/4363425/rukumini-venkatesh"}, "reply_to_user": {"reputation": 2877, "user_id": 5111870, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BEtKy.jpg?s=128&g=1", "display_name": "kk.", "link": "https://stackoverflow.com/users/5111870/kk"}, "edited": false, "score": 0, "creation_date": 1496248056, "post_id": 44288908, "comment_id": 75586697, "body": "I have tried to use regular expressions. But I would want to see if we can do it using string and array operations, that will make it easy to uderstand"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1496271276, "post_id": 44288908, "comment_id": 75598004, "body": "Please edit the question and add HTML content sample."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1496247031, "creation_date": 1496247031, "answer_id": 44289742, "question_id": 44288908, "link": "https://stackoverflow.com/questions/44288908/split-the-string-in-html-tag-and-put-them-in-different-columns-vba/44289742#44289742", "title": "Split the string in HTML tag and put them in different columns VBA", "body": "<p>I think the Macro recorder will come in very helpful here.</p>\n\n<pre><code>Sub Macro1()\n\n    Columns(\"A:A\").Select\n    Selection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=True, _\n        Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _\n        Array(7, 1), Array(8, 1)), TrailingMinusNumbers:=True\n    With Selection\n        .HorizontalAlignment = xlGeneral\n        .VerticalAlignment = xlBottom\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n        .MergeCells = False\n    End With\n    Cells.Select\n    Cells.EntireColumn.AutoFit\n    Range(\"A1\").Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4363425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7461531b39d8b2977bc4985c00b0712?s=128&d=identicon&r=PG&f=1", "display_name": "rukumini venkatesh", "link": "https://stackoverflow.com/users/4363425/rukumini-venkatesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496247031, "creation_date": 1496244662, "question_id": 44288908, "link": "https://stackoverflow.com/questions/44288908/split-the-string-in-html-tag-and-put-them-in-different-columns-vba", "title": "Split the string in HTML tag and put them in different columns VBA", "body": "<p>I have a following data in html</p>\n\n<pre>\n    ....\n   35.25 65.45 Car        0.2584  0.2587  0.2413  0.8956   8456  4512\n     556 45.23            IN      1.3696  4.2384  9.2475   4657  4732 </pre>\n\n<p>I need to get the values in 8 columns and same row.     </p>\n"}, {"tags": ["excel", "vba", "ole"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 3, "creation_date": 1496244453, "post_id": 44288799, "comment_id": 75584386, "body": "<a href=\"https://groups.google.com/forum/?hl=en#!msg/microsoft.public.excel.programming/ct8NRT-o7rs/jawi42S8Ci0J\" rel=\"nofollow noreferrer\">groups.google.com/forum/?hl=en#!msg/&hellip;</a>"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496245656, "post_id": 44288799, "comment_id": 75585184, "body": "We need more context. How do the two methods relate? Does the mail merge connect to the database being built? Where do you call the two routines? It&#39;s not clear why you need to build a whole database on the fly each time."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496245727, "post_id": 44288799, "comment_id": 75585249, "body": "Finally, it seems you have MS Access installed, consider using it to call the other office apps as it arguably has a better object model and application/automation environment."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 4, "creation_date": 1496245846, "post_id": 44288799, "comment_id": 75585342, "body": "Seems shutting off that message is tackling the <i>symptom</i> rather than the actual problem. If your queries have performance issues, the solution isn&#39;t to tell the client to stop whining - the solution is to get the queries to complete in a reasonable amount of time. Are you missing indexes? Are your queries written in inefficient ways? Anything that takes more than, say, 7 seconds to refresh, should be done differently. Consider doing the heavy processing overnight and dumping the results in a table, and then simply querying that table. Oh wait, Access. Good luck!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496251606, "post_id": 44288799, "comment_id": 75588829, "body": "A little free code-review: Please consider changing <code>If Len(statement) &lt; 5 Then GoTo skpStatement</code> to <code>if Len(statement) &gt;=5 Then</code>. It eliminates the needless <code>GoTo</code> statement by simply testing for the cases when you <i>do</i> want to execute the code instead of when you <i>don&#39;t</i> want to."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496306061, "post_id": 44288799, "comment_id": 75610103, "body": "@Mat&#39;sMug <code>Oh wait, Access. Good luck!</code> Ye well, don&#39;t get me started. ;) <code>SQL</code> runs as fast as you&#39;d expect (no indexes bc flatfiles with <code>schema.ini</code>, normalizing columns to rows with <code>UNION ALL</code> for a lack of better options).... so: pretty slow. Still, I feel like I did what I could to streamline the <code>SQL</code>. I am perfectly content with the <code>.Execute</code> taking 10 minutes, as long as I am not buggered by messages suggesting something is amiss, when in fact the code does run error-free"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496306436, "post_id": 44288799, "comment_id": 75610343, "body": "@Parfait Thanks for your input. As stated, those are only two examples of lengthy operations that cause said behavior, not related. As for your 2nd point: interesting advice, will keep that in mind! Sadly, in this particular case, I had to use <code>Excel</code>, since afaik <code>Access</code> can&#39;t be automated with <code>Powershell</code>"}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496306533, "post_id": 44288799, "comment_id": 75610396, "body": "@FreeMan Fair point, thanks for pointing that out. However, in that example, it&#39;s actually the <code>.Execute</code> that takes like 5 minutes per file (which by itself would be perfectly fine by me)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496317041, "post_id": 44288799, "comment_id": 75617997, "body": "Eliminating the <code>Goto</code> has nothing to do with code execution speed (in particular), it&#39;s just an opportunity to get rid of a <code>Goto</code>! It&#39;s bad enough that we&#39;re forced to use them in VBA for error handling... :/ (Yes, there are a few legitimate uses for <code>Goto</code>, just not many.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496324049, "post_id": 44288799, "comment_id": 75623290, "body": "@MartinDreher I worked in a place where it was deemed <i>normal</i> for a SSRS report to take 30 minutes to process... People have varying standards I guess. Still, I would recommend you put your SQL up for review on <a href=\"https://codereview.stackexchange.com\">Code Review</a> if you can - you never know, maybe there&#39;s a chance it can be tweaked to run in under 10 seconds =)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496329719, "post_id": 44288799, "comment_id": 75627895, "body": "Yes, MSAccess.exe is an exe like Excel and so can be automated with PowerShell, Batch, Cmd, etc. Build a module called in its <a href=\"https://support.office.com/en-us/article/Automate-startup-events-with-a-macro-b08d4f22-b517-4ccf-bd14-8670416628b0\" rel=\"nofollow noreferrer\">AutoExec macro</a> so runs every time Access opens."}, {"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1496387517, "post_id": 44288799, "comment_id": 75650711, "body": "I am aware of Access being an exe. I do vaguely remember running into errors when powershell tried calling a sub that creates a database from scratch stored in my access database, with the same sub running smoothly when stored in an excel. Might want to look into it some more. <b>Thanks for your input guys!</b>"}], "answers": [{"comments": [{"owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "edited": false, "score": 0, "creation_date": 1496308480, "post_id": 44289000, "comment_id": 75611844, "body": "@Tehscript , Darren: Does feel like I throwing the baby out with the bathwater. I do, however, really need that tub. Works for me, thanks a ton!"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 8, "last_activity_date": 1571406510, "last_edit_date": 1571406510, "creation_date": 1496244904, "answer_id": 44289000, "question_id": 44288799, "link": "https://stackoverflow.com/questions/44288799/how-to-deal-with-microsoft-excel-is-waiting-for-another-application-to-complete/44289000#44289000", "title": "How to deal with &quot;Microsoft Excel is waiting for another application to complete an OLE action&quot;", "body": "<p>I'll add the code that @Tehscript linked to in the comments.  </p>\n\n<blockquote>\n  <p>You can solve this by using the COM API to remove VBA's message filter.\n  This will prevent COM from telling VBA to displaying a message box when it\n  thinks the process you're calling has blocked. Note that if the process\n  really has blocked for some reason this will prevent you from receiving any\n  notification of that.  [<a href=\"https://groups.google.com/forum/?hl=en#!msg/microsoft.public.excel.programming/ct8NRT-o7rs/jawi42S8Ci0J\" rel=\"nofollow noreferrer\">source</a>]</p>\n</blockquote>\n\n<p>I think this is the code I used back in 2006 for the same problem (it worked).</p>\n\n<pre><code>Private Declare Function _\n    CoRegisterMessageFilter Lib \"OLE32.DLL\" _\n    (ByVal lFilterIn As Long, _\n    ByRef lPreviousFilter) As Long\n\nSub KillMessageFilter()  \n    '''Original script Rob Bovey  \n\n    '''https://groups.google.com/forum/?hl=en#!msg/microsoft.public.excel.programming/ct8NRT-o7rs/jawi42S8Ci0J\n    '''http://www.appspro.com/\n\n    Dim lMsgFilter As Long\n\n    ''' Remove the message filter before calling Reflections.\n    CoRegisterMessageFilter 0&amp;, lMsgFilter\n\n    ''' Call your code here....\n\n    ''' Restore the message filter after calling Reflections.\n    CoRegisterMessageFilter lMsgFilter, lMsgFilter\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 304, "user_id": 1487861, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2a847ef2bc86618ac8624d51e84a7dad?s=128&d=identicon&r=PG", "display_name": "user1487861", "link": "https://stackoverflow.com/users/1487861/user1487861"}, "is_accepted": false, "score": 0, "last_activity_date": 1598440906, "creation_date": 1598440906, "answer_id": 63596559, "question_id": 44288799, "link": "https://stackoverflow.com/questions/44288799/how-to-deal-with-microsoft-excel-is-waiting-for-another-application-to-complete/63596559#63596559", "title": "How to deal with &quot;Microsoft Excel is waiting for another application to complete an OLE action&quot;", "body": "<p>I tried the COM API code as well, which works. But it is only useful in so far as you don't see the error - the 30-sec delay every time the error is triggered still happens which makes this unworkable for me.</p>\n<p>The better change I have made is to turn off &quot;Real time presence in Microsoft Office&quot; in Drive File Stream (the google product). This has (so far!) resolved the issue for me. I'm guessing there is some sort of clash between this and another excel addin.</p>\n"}], "owner": {"reputation": 1362, "user_id": 5979902, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/OmvV7.jpg?s=128&g=1", "display_name": "Martin Dreher", "link": "https://stackoverflow.com/users/5979902/martin-dreher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6901, "favorite_count": 4, "accepted_answer_id": 44289000, "answer_count": 2, "score": 5, "last_activity_date": 1598440906, "creation_date": 1496244310, "question_id": 44288799, "link": "https://stackoverflow.com/questions/44288799/how-to-deal-with-microsoft-excel-is-waiting-for-another-application-to-complete", "title": "How to deal with &quot;Microsoft Excel is waiting for another application to complete an OLE action&quot;", "body": "<p>When automating other MS-Office applications with excel, I frequently get ok-only prompts saying that <code>Microsoft Excel is waiting for another application to complete an OLE action.</code></p>\n\n<p>This only happens when automating lengthy tasks.</p>\n\n<p><strong>How can I deal with this in an appropriate fashion?</strong></p>\n\n<p>Two recent examples (I recon the code is less important):</p>\n\n<ul>\n<li><p>creating an accdb-Database from Excel with an <code>Access.Application</code> and populating it by running rather complex SQL-queries on large amount of data.</p>\n\n<pre><code>Public Function createDB(pathDB As String, pathSQL As String) As String\n\n    Dim dbs As DAO.Database\n    Dim sql As String\n    Dim statement As Variant, file As Variant\n\n    Dim sErr As String, iErr As Integer\n\n    With New Access.Application\n\n        With .DBEngine.CreateDatabase(pathDB, dbLangGeneral)\n\n            For Each file In Split(pathSQL, \";\")\n\n                sql = fetchSQL(file)\n                For Each statement In Split(sql, \";\" &amp; vbNewLine)\n                    If Len(statement) &lt; 5 Then GoTo skpStatement\n                    Debug.Print statement\n\n                    On Error Resume Next\n                    .Execute statement, dbFailOnError\n\n                    With Err\n                        If .Number &lt;&gt; 0 Then\n                            iErr = iErr + 1\n                            sErr = sErr &amp; vbCrLf &amp; \"Error \" &amp; .Number &amp; \" | \" &amp; Replace(.Description, vbCrLf, vbNullString)\n                            .Clear\n                        End If\n                    End With\n                    On Error GoTo 0\nskpStatement:\n                Next statement\n            Next file\n        End With\n        .Quit acQuitSaveAll\n    End With\n\n    dTime = Now() - starttime\n\n    ' Returnwert\n    If sErr = vbNullString Then sErr = \"Keine Fehler\"\n    createDB = \"Zeit: \" &amp; Now &amp; \" | Dauer: \" &amp; Format(dTime, \"hh:mm:ss\") &amp; \" | Anzahl Fehler: \" &amp; iErr &amp; vbCrLf &amp; sErr\n\n    ' Log\n    With ThisWorkbook\n        '...\n        .Saved = True\n        .Save\n    End With\n\nEnd Function\n</code></pre></li>\n<li><p>create mail merges from Excel in a <code>Word.Application</code>, using existing and rather large <code>.docm</code>-templates and dynamic SQL-queries that returns the receipents</p>\n\n<pre><code>Set rst = GetRecordset(ThisWorkbook.Sheets(\"Parameter\").Range(\"A1:S100\"))\n\nWith New Word.Application\n\n    .Visible = False\n\n    While Not rst.EOF\n        If rst!Verarbeiten And Not IsNull(rst!Verarbeiten) Then\n            Debug.Print rst!Sql\n\n            .Documents.Open rst!inpath &amp; Application.PathSeparator &amp; rst!infile\n            stroutfile = fCheckPath(rst!outpath, True) &amp; Application.PathSeparator &amp; rst!outfile\n\n            .Run \"quelle_aendern\", rst!DataSource, rst!Sql\n\n            .Run MacroName:=\"TemplateProject.AutoExec.SeriendruckInDokument\"\n\n            Application.DisplayAlerts = False\n\n            .ActiveDocument.ExportAsFixedFormat _\n                OutputFileName:=stroutfile _\n                , ExportFormat:=wdExportFormatPDF _\n                , OpenAfterExport:=False _\n                , OptimizeFor:=wdExportOptimizeForPrint _\n                , Range:=wdExportAllDocument _\n                , From:=1, To:=1 _\n                , Item:=wdExportDocumentContent _\n                , IncludeDocProps:=False _\n                , KeepIRM:=True _\n                , CreateBookmarks:=wdExportCreateNoBookmarks _\n                , DocStructureTags:=False _\n                , BitmapMissingFonts:=True _\n                , UseISO19005_1:=False\n\n            Application.DisplayAlerts = True\n\n            For Each doc In .Documents\n                With doc\n                    .Saved = True\n                    .Close SaveChanges:=wdDoNotSaveChanges\n                End With\n            Next doc\n\n        End If\n        rst.MoveNext\n    Wend\n\n    .Quit\nEnd With\n</code></pre></li>\n</ul>\n\n<p><strong>notes:</strong></p>\n\n<ul>\n<li>When run on a smaller scale (for example, when querying less records or using less complex templates), both codes do run smoothly.</li>\n<li>In both cases, when I <code>OK</code> through all the reappearing prompts, the code will eventually finish with the desired results.\nTherefore, I guess I'm not encountering an error (also it doesn't trigger the error handlers), but rather something like a timeout.</li>\n</ul>\n\n<p>As suggested on other sources, I do wrap my code into <code>Application.DisplayAlerts = False</code>. This, however, seems like a horrible idea, since there might actually be cases where I do need to be alerted.</p>\n"}, {"tags": ["sql-server", "excel", "listbox", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496277399, "post_id": 44288797, "comment_id": 75599484, "body": "&quot;I got it all working&quot; - without knowing <i>how</i> you&#39;re doing this, it&#39;s difficult to make useful suggestions."}, {"owner": {"reputation": 13, "user_id": 8092479, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CVO4vti_lGg/AAAAAAAAAAI/AAAAAAAAJPs/F-HkmGhIo9g/photo.jpg?sz=128", "display_name": "Latoya", "link": "https://stackoverflow.com/users/8092479/latoya"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496324215, "post_id": 44288797, "comment_id": 75623415, "body": "Awesome! How did you get it working? For now, I am just using &#39; wmav_code in (?,?,?,?)&#39; in the where clause after I made the connection to SQL server. So I am limited to four (4) prompts to the user."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496334028, "post_id": 44288797, "comment_id": 75630808, "body": "I didn&#39;t do anything - that is a quote from your question and a request from me for you to explain how you &quot;got it working&quot;.  There&#39;s are more than one way to get data from a database into Excel: it&#39;s difficult to suggest how to move forward if we don&#39;t know what you&#39;re doing. Bottom line though: there is no easy way to use parameters when you&#39;re performing an &quot;in&quot; query - you will need to construct the SQL according to the number of items the user selects, either hard-coding the values or adding one parameter per value."}, {"owner": {"reputation": 13, "user_id": 8092479, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CVO4vti_lGg/AAAAAAAAAAI/AAAAAAAAJPs/F-HkmGhIo9g/photo.jpg?sz=128", "display_name": "Latoya", "link": "https://stackoverflow.com/users/8092479/latoya"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496334429, "post_id": 44288797, "comment_id": 75631013, "body": "Oh ok! I got you. I set the parameters, to display the information base on the user input in cells A2, A3, A4 and A5, hence why I am saying that I am limited to four (4). I would not want to hard code all 96 codes."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496334904, "post_id": 44288797, "comment_id": 75631258, "body": "How <i>exactly</i> is my question here.  Are you using VBA ? ADO? How are you running this query?"}, {"owner": {"reputation": 13, "user_id": 8092479, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CVO4vti_lGg/AAAAAAAAAAI/AAAAAAAAJPs/F-HkmGhIo9g/photo.jpg?sz=128", "display_name": "Latoya", "link": "https://stackoverflow.com/users/8092479/latoya"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496336773, "post_id": 44288797, "comment_id": 75632219, "body": "I just realize that I didn&#39;t finish typing that reply. I am using a SQL query. I made the connection to the SQL server with the Get External Data (From Microsoft Query) selection under the data tab. I then created the connection and put my query in the SQL field. I returned the information back to Excel. I then added wmav_code (?,?,?,?) in the where clause to prompt the user from for inputs. These inputs are placed in A2, A3, A4 and A5 and the returned results is changed based on the inputted values."}, {"owner": {"reputation": 13, "user_id": 8092479, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CVO4vti_lGg/AAAAAAAAAAI/AAAAAAAAJPs/F-HkmGhIo9g/photo.jpg?sz=128", "display_name": "Latoya", "link": "https://stackoverflow.com/users/8092479/latoya"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496336993, "post_id": 44288797, "comment_id": 75632340, "body": "The method I explained above is limiting me to user inputs of 4. I have a list of the codes that I would want the user choose from, instead of hard coding them into the parameter fields (which would be 96 parameters). Hence why I thought about going with a listbox with the codes, where the user can do multiple selections and the report is generated from those selections."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496339445, "post_id": 44288797, "comment_id": 75633720, "body": "I think you&#39;d find it easier to manage if you use ADO which will give you a lot more control (after a little initial learning curve) over how the query is run.  See for example: <a href=\"http://www.dreamincode.net/forums/topic/24677-connecting-to-a-sql-server-database-using-adodb/\" rel=\"nofollow noreferrer\">dreamincode.net/forums/topic/&hellip;</a>  That&#39;s for VB6 but VBA will be pretty much the same."}], "owner": {"reputation": 13, "user_id": 8092479, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CVO4vti_lGg/AAAAAAAAAAI/AAAAAAAAJPs/F-HkmGhIo9g/photo.jpg?sz=128", "display_name": "Latoya", "link": "https://stackoverflow.com/users/8092479/latoya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496250165, "creation_date": 1496244307, "last_edit_date": 1531161705, "question_id": 44288797, "link": "https://stackoverflow.com/questions/44288797/report-from-sql-to-excel-using-user-prompts", "title": "Report from SQL to Excel using user prompts", "body": "<p>I am pulling a report from SQL in Excel. I got it all working, except I need multiple user prompts (one parameter with multiple values).</p>\n\n<p>I decided to use a listbox which contains all the possible selection that I want the user to choose from (These values are on another sheet in the same workbook) and then when a button is clicked, it displays the information in that same worksheet base on the selected choices the user choose.</p>\n\n<p>This information that is being displayed is coming straight from SQL server.</p>\n\n<p>I tried using a userform in VBA in Excel, but I am still not quite sure how to have it pull from SQL base on the selections in the listbox.</p>\n\n<p>I had it where the information was displayed, except I was only able to input one parameter at a time. I want the user to be able to do multiple selections and then the information is displayed.</p>\n\n<p>In my query I had wmav_code = ? to prompt the user to input what code they wanted, but as stated before, it generates a report base on that one value. I tried <code>wmav_code in (?,?,?,?)</code>, however, that's limiting the prompts to 4. I have 97 various codes to choose from (Hence the decision to use a listbox).</p>\n\n<p>I tried <code>(InStr(?, [wmav_code])&gt;0)</code>, but Excel 2016 does not recognize that function (<code>InStr()</code>).</p>\n\n<p>P.S. These are all within the 'WHERE' clause.</p>\n\n<p>I don't have to use a listbox, a simpler route/method would be appreciated.</p>\n"}, {"tags": ["vba", "excel", "cells"], "answers": [{"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1496244104, "post_id": 44288542, "comment_id": 75584149, "body": "I like this &quot;no loop&quot; approach!"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1496244226, "post_id": 44288542, "comment_id": 75584253, "body": "&quot;To loop or not to loop, that is the ques...&quot; - Nope, just don&#39;t. :)"}, {"owner": {"reputation": 57, "user_id": 8092436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10213002427125690/picture?type=large", "display_name": "Liviu-Adrian", "link": "https://stackoverflow.com/users/8092436/liviu-adrian"}, "edited": false, "score": 1, "creation_date": 1496245277, "post_id": 44288542, "comment_id": 75584950, "body": "Thanks, dude! Not all heroes wear capes. :D"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1496245499, "post_id": 44288542, "comment_id": 75585092, "body": "oh ffs, which one isn&#39;t wearing a cape? I thought we all agreed the dress code ages ago *smh*"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1496243655, "creation_date": 1496243655, "answer_id": 44288542, "question_id": 44288436, "link": "https://stackoverflow.com/questions/44288436/excel-vba-fill-in-empty-cells-with-adjacent-cell-values/44288542#44288542", "title": "Excel VBA: Fill in empty cells with adjacent cell values", "body": "<pre><code>Dim blanks As Excel.Range\n\nSet blanks = Range(\"I2:I\" &amp; Cells(Rows.Count, 7).End(xlUp).Row).SpecialCells(xlCellTypeBlanks)\n\nblanks.Value = blanks.Offset(0, -2).Value\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8092436, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10213002427125690/picture?type=large", "display_name": "Liviu-Adrian", "link": "https://stackoverflow.com/users/8092436/liviu-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1176, "favorite_count": 0, "accepted_answer_id": 44288542, "answer_count": 1, "score": 2, "last_activity_date": 1496243655, "creation_date": 1496243395, "last_edit_date": 1531164843, "question_id": 44288436, "link": "https://stackoverflow.com/questions/44288436/excel-vba-fill-in-empty-cells-with-adjacent-cell-values", "title": "Excel VBA: Fill in empty cells with adjacent cell values", "body": "<p>I was wondering if someone can help - </p>\n\n<p>I have a column 'I' containing cells of different values; some of these cells are blank. I also have an adjacent complete column 'G' - no blank cells.    </p>\n\n<p>What I'm basically trying to do is use VBA to fill in the empty cells in column 'I' with the value of their adjacent cells in column 'G'. </p>\n\n<p>I wrote the below code in a command button: </p>\n\n<pre><code>Sub CommandButton2_Click()\n\n   Lastrow = Cells(Rows.Count, \"G\").End(xlUp).Row\n\n   Range(\"I2:I\" &amp; Lastrow).SpecialCells(xlCellTypeBlanks).Value = Range(\"G2:G\" &amp; Lastrow).Value\n\nEnd Sub\n</code></pre>\n\n<p>The above code populates the blank 'I' cells, but it always seems to start with the second 'G' cell when populating. I want it to populate the blank 'I' cell with it's adjacent 'G' cell, and not start counting from the beginning when it finds a blank cell. </p>\n\n<p>Hope someone can help. Let me know if I need to clarify things further. </p>\n\n<p>Regards, </p>\n\n<p>Adrian</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496242765, "post_id": 44287888, "comment_id": 75583163, "body": "What code have you tried so far? What is unsuccessful about it? (Does it throw errors, does it run but not do anything, does it do something but not what you&#39;re expecting, etc.)"}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1496243645, "post_id": 44287888, "comment_id": 75583793, "body": "Wouldn&#39;t &quot;top 5 rows&quot; include &quot;A1:Z1&quot;?"}, {"owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496244587, "post_id": 44287888, "comment_id": 75584467, "body": "Yes it does, currently I have a really long version of the VBA set up."}, {"owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496244644, "post_id": 44287888, "comment_id": 75584514, "body": "current code to just remove the top rows."}, {"owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496244750, "post_id": 44287888, "comment_id": 75584582, "body": "Sub remove_rows()  remove_rows Macro       Rows(&quot;1:10&quot;).Select     Selection.EntireRow.Hidden = False     Range(&quot;D20&quot;).Select     Rows(&quot;1:9&quot;).Select     Range(&quot;A9&quot;).Activate     Selection.Delete Shift:=xlUp     Sheets(&quot;BioME-Box- (2)&quot;).Select     Rows(&quot;1:15&quot;).Select     Selection.EntireRow.Hidden = False     Rows(&quot;1:9&quot;).Select"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496259743, "post_id": 44291782, "comment_id": 75593270, "body": "Hello John yes it"}, {"owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496259846, "post_id": 44291782, "comment_id": 75593328, "body": "John, it could be getting the drop down values from a list, what I am trying to do is keep the selected values and merge all the worksheets into 1. But starting the appending of data only from A10 as A1 to A9 consists of examples of how to fill the data and what type of data"}, {"owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496339857, "post_id": 44291782, "comment_id": 75633916, "body": "I will try to upload a sample workbook. Thank you for all the help"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496253771, "creation_date": 1496253771, "answer_id": 44291782, "question_id": 44287888, "link": "https://stackoverflow.com/questions/44287888/merge-worksheets-that-have-drop-down-list/44291782#44291782", "title": "merge worksheets that have drop-down list", "body": "<p>It sounds like you are talking about Validation lists as your \"drop down\" lists.  If so then they might be getting their options from a another range somewhere else.  So if you delete a range that the validation lists are using then all of their options disappear.  I don't know if this is your problem.  But you can copy a validation list and paste only its value, not the whole list, this way.</p>\n\n<pre><code>Sub Macro1()\n    Range(\"D3\").Select '    This is the validation list\n    Selection.Copy\n\n    '   Change \"SomeOtherRangeHere\" to any cell you want to\n    Range(\"SomeOtherRangeHere\").PasteSpecial Paste:=xlPasteValues\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496328087, "post_id": 44307955, "comment_id": 75626546, "body": "Hello John, I tried the code, it did not throw up any error but neither did it do anything. Am not sure what is wrong?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496331797, "post_id": 44307955, "comment_id": 75629495, "body": "it will only copy data from below row 9.  Is there data on the other sheets below row 9?  Also what sheet are you copying to? Sheet1, sheet2..?  Are you running the code from within a single workbook or two workbooks.  This is designed (as it is) to go through all sheets in a single workbook and copy data below row 9 on all sheets other than sheet1.  Because sheet1 is where the copied data is being placed.  It works fine for me"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496332091, "post_id": 44307955, "comment_id": 75629696, "body": "Try stepping through it with the debugger to see where it is not working."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496332445, "post_id": 44307955, "comment_id": 75629928, "body": "After reviewing it&#39;s possible that the &quot;MainWSLastRow =&quot; line was throwing an error if sheet 1 is blank.  I&#39;ve changed the code above to account for that."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "edited": false, "score": 0, "creation_date": 1496332899, "post_id": 44307955, "comment_id": 75630230, "body": "Sorry but I had to update it again for error handling.  It should be working now"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496332866, "last_edit_date": 1496332866, "creation_date": 1496321163, "answer_id": 44307955, "question_id": 44287888, "link": "https://stackoverflow.com/questions/44287888/merge-worksheets-that-have-drop-down-list/44307955#44307955", "title": "merge worksheets that have drop-down list", "body": "<p>Try this one.  Be sure to change mainWS to the worksheet you are copying to.  I used sheet1 but you may be using another.  In this sub it copies everything below Row 9 of all sheets and pastes them to the first available row in sheet1.</p>\n\n<pre><code>Sub Macro1()\nDim ws As Worksheet, mainWS As Worksheet\nDim wsLastRow As Long, mainWSlastRow As Long, wsLastCol As Long\n\n    Set mainWS = Sheet1 ' Change this to the sheet you are copying everthing to\n    For Each ws In ThisWorkbook.Worksheets\n        def = mainWS.Name\n        abc = ws.Name\n        If ws.Name &lt;&gt; mainWS.Name Then ' Make sure to not copy from the sheet yuo are copying to\n            wsLastRow = ws.UsedRange.Rows.Count\n            wsLastCol = ws.UsedRange.Columns.Count\n            On Error Resume Next\n            mainWSlastRow = Sheet1.Cells.Find(\"*\", [A1], , , xlByRows, xlPrevious).Row\n            If Err.Number = 91 Then\n                mainWSlastRow = 1\n                On Error GoTo 0\n            End If\n            ws.Range(\"A10:\" &amp; Chr(wsLastCol + 64) &amp; wsLastRow).Copy Destination:=mainWS.Range(\"A\" &amp; mainWSlastRow + 1)\n        End If\n    Next ws\n    Set mainWS = Nothing\n    Set ws = Nothing\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8092625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5afed705cef82c4fd3f2b5f69ee57a7?s=128&d=identicon&r=PG&f=1", "display_name": "thekid", "link": "https://stackoverflow.com/users/8092625/thekid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1496332866, "creation_date": 1496242004, "last_edit_date": 1531161705, "question_id": 44287888, "link": "https://stackoverflow.com/questions/44287888/merge-worksheets-that-have-drop-down-list", "title": "merge worksheets that have drop-down list", "body": "<p>I have a workbook that consists of 180 worksheets. Each worksheet has the top 9 rows and columns A1:Z1 with information that I do not need. </p>\n\n<p>The rest of the worksheet has data that I do need and want to append into one worksheet. The problem is that each of the worksheet has drop-down choices embedded in them. The choices have already been made and I need to append the sheets with the choices selected. </p>\n\n<p>Been trying to run a VBA script but have been unsuccessful. Any help is greatly appreciated.\nThank you</p>\n\n<p>Current code that I used to remove the top rows for few of the sheets, only removal but not appending. And I have inserted sheet names, but with 180 sheets that will not be possible.</p>\n\n<p><code>Sub remove_rows()</code>\n'\n' <code>remove_rows Macro</code>\n'</p>\n\n<p>'</p>\n\n<pre><code>`Rows(\"1:10\").Select`\n`Selection.EntireRow.Hidden = False`\n`Range(\"D20\").Select`\n`Rows(\"1:9\").Select`\n`Range(\"A9\").Activate`\n`Selection.Delete Shift:=xlUp`\n`Sheets(\"BioME-Box- (2)\").Select`\n`Rows(\"1:15\").Select`\n`Selection.EntireRow.Hidden = False`\n`Rows(\"1:9\").Select`\n`Range(\"A9\").Activate`\n`Selection.Delete Shift:=xlUp`\n`Sheets(\"BioME-Box- (3)\").Select`\n`Rows(\"1:13\").Select`\n`Selection.EntireRow.Hidden = False`\n</code></pre>\n\n<p><code>Rows(\"1:9\").Select</code>\n    <code>Range(\"A9\").Activate</code>\n    <code>Selection.Delete Shift:=xlUp</code> </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "edited": false, "score": 0, "creation_date": 1496251834, "post_id": 44290148, "comment_id": 75588961, "body": "Option 1 runs pretty well in about 40 seconds.  I&#39;ll post the code in a little while."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 1, "last_activity_date": 1496248199, "creation_date": 1496248199, "answer_id": 44290148, "question_id": 44287724, "link": "https://stackoverflow.com/questions/44287724/using-excel-2013-vba-to-build-multipage-report-from-userform-selections/44290148#44290148", "title": "Using Excel 2013 VBA to build multipage report from userform selections", "body": "<p>I think option 1 would be the best. It gives you a lot of flexibility and if you structure your code in a good way, it will be quite easy to maintain as well. If you disable the screen updating while running, it'll be quite smooth for the end user.<br>\nAnother possibility (since you mentioned Word) is the possibility to create a Word document from within your macro. Just add a reference to \"Microsoft Word nn.n Object Library\" under Tools - References. Then you have access to Word's object model and can create documents from your Excel data.</p>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "is_accepted": true, "score": 0, "last_activity_date": 1496256240, "last_edit_date": 1496256240, "creation_date": 1496254848, "answer_id": 44292101, "question_id": 44287724, "link": "https://stackoverflow.com/questions/44287724/using-excel-2013-vba-to-build-multipage-report-from-userform-selections/44292101#44292101", "title": "Using Excel 2013 VBA to build multipage report from userform selections", "body": "<p>I tested options 1 and 2. Option 1 ran in about 30 seconds, using Save as..PDF (manually, haven't coded it yet) yielded a 2.3MB PDF (95 pages).  Option 2 ran in 100 seconds and produced a 1.0MB PDF. Both PDFs were similar, however option 2 showed a text box that was set to not print even though the xlPrinter appearance property of CopyPicture method was set. Saving the option 1 temp worksheet added 500KB to the xlsm file, option 2 added only 115KB which was surprising.</p>\n\n<p>Code is below for anyone who might stumble on this in the future:</p>\n\n<pre><code>Sub PrintEqEst()\nDim tmpSht As Worksheet, EqSht As Worksheet\nDim i as Long\nDim TWB As Workbook\nPrintingReport = True 'Global boolean used to keep display updating from being turned back on in event routine\nSet TWB = ThisWorkbook\nSet EqSht=TWB.Worksheets(\"Equipment\")\nSet cMyListBox2 = UserForm1.ListBox2\nt(1) = timer *1000\nIf cMyListBox2.Rowsource = \"\" Then PopulateListBox\nSet tmpSht = TWB.Sheets.Add(After:=TWB.Sheets(TWB.Sheets.Count))\nApplication.ScreenUpdating = False    \nFor i = 0 to cMyListBox2.ListCount - 2 '-1 because it ListIndex starts at 0, -1 because there is intentional blank item at end of List\n   DoEvents\n   cMyListBox2.ListIndex = i 'Triggers event that updates Equipment Sheet\n   EqSht.Range(\"C2:L73\").Copy\n   If i = 0 Then tmpSht.Cells(1, 1).PasteSpecial Paste:=xlPasteColumnWidths\n    tmpsht.Cells(77*i+1, 1).PasteSpecial Paste:=xlPasteAll\n    tmpsht.Cells(77*i+1, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats\nNext i\ntmpSht.UsedRange.RowHeight = 11.25\nIf ListBox2Index &gt;= 1 Then cMyListBox2.ListIndex = ListBox2Index 'If something previously selected, go back to it. (ListBox2Index is global that keeps track of selected item)\nWith tmpSht.PageSetup\n    [...]\nEnd With\nApplication.ScreenUpdating=True\nPrintingReport=False\nDebug.Print \"Create Report: \" &amp; Round(timer * 1000 - t(1), 0) &amp; \"ms\"\nEnd Sub\n</code></pre>\n\n<p>Option 2 uses the above code except the for loop uses:</p>\n\n<pre><code>EqSht.Range(\"C2:L73\").CopyPicture Appearance:=xlPrinter, Format:=xlPicture\ntmpSht.Cells(64 * i + 2, 1).Select\ntmpSht.Paste\n</code></pre>\n"}], "owner": {"reputation": 150, "user_id": 7612553, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d6f03ece678aac00d6d45736eebcf7d3?s=128&d=identicon&r=PG&f=1", "display_name": "MattD", "link": "https://stackoverflow.com/users/7612553/mattd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 793, "favorite_count": 0, "accepted_answer_id": 44292101, "answer_count": 2, "score": 0, "last_activity_date": 1496256240, "creation_date": 1496241576, "last_edit_date": 1531161705, "question_id": 44287724, "link": "https://stackoverflow.com/questions/44287724/using-excel-2013-vba-to-build-multipage-report-from-userform-selections", "title": "Using Excel 2013 VBA to build multipage report from userform selections", "body": "<p>I have an Excel 2013 workbook that captures a lot of data about different equipment.  To make input user friendly, it is split in to two worksheets \"Equipment\" and \"Equipment-Data\".  Equipment is a front-end that presents the data from Equipment-Data in an easy to read/edit/print format.  Equipment-Data is the back-end data table with 85 columns of data by 100 pieces of equipment.  </p>\n\n<p>Navigation is performed by choosing equipment on a ListBox residing on a UserForm that lets them quickly navigate between items.  When the ListBox selection changes, the appropriate row from the data table is read to an array and written to the front-end. Any changes are seamlessly pushed back to the data table.  Excel was chosen over Access based on end-user familiarity and the fact the two worksheets are part of a larger workbook that wouldn't fit well in Access.  Also, the workbook supports one deliverable and isn't going to be updated long term.</p>\n\n<p>I'm working on developing a way to gather all the equipment pages and export them to go into a report built from a mix of Word and PDFs (final output PDF). I'm sure there a dozen ways to do this but I'm wondering if there is a preferable way. I'm still relatively new to VBA-having already rewritten the code on this project to move subroutines from sheets to modules, pass variables between subs instead of using globals, and read/write arrays instead of looping through cells as I learned better ways to do things.</p>\n\n<p>The way I see it, my options are:</p>\n\n<ol>\n<li>Create temp worksheet, loop through listbox, copy range from front-end, paste special into temp sheet. I found from experimenting, I need to double paste-first xlPasteColumnWidths and then xlPasteValuesAndNumberFormats.  I tried using just \"Values &amp; Source Formatting\" (xlPasteAllUsingSourceTheme) but I get an error about merged cells.  After the first iteration, I can replace xlPasteColumnWidths with just .Paste but still need to follow up with the Values &amp; Number formats because there are equations.  After pasting, skip ahead ListIndex*78 to get to the start of next page and repeat. At the end, export the temp sheet to PDF and delete temp sheet.</li>\n<li>Same as #1 but using CopyPicture method using xlPicture to get vector output. After loop, export to PDF and delete temp sheet. This <em>should</em> be indistinguishable in the final output from option #1 not sure if I'd run in to speed or memory issues with 100 pages of images.</li>\n<li>Loop through listbox and use ExportAsFixedFormat to create a PDF using ListIndex&amp;Equipment_Name as the filename. Then use an external PDF tool to merge the files in to one.</li>\n<li>Create Access database, use Equipment-Data sheet as data source, and build report to mimic format of Equipment sheet.</li>\n<li>Same as 1 or 2 but copy each ListItem to a new worksheet, select all the worksheets, export to pdf, delete worksheets.</li>\n</ol>\n\n<p>Is there a better way that I'm missing?  I'm seeing options 1 and 3 as being the best to pursue. 3 seems like a good quick-fix since it is unlikely anyone else will need to build the report, but 1 would be nicer for some future user who might find the spreadsheet on a shared drive and want to reuse it on a different project.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3, "user_id": 5329329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b437e8f7a0e2efd43b287fd83fcabb19?s=128&d=identicon&r=PG&f=1", "display_name": "DHagens11", "link": "https://stackoverflow.com/users/5329329/dhagens11"}, "edited": false, "score": 0, "creation_date": 1496240668, "post_id": 44287382, "comment_id": 75581524, "body": "Function Col_Letter(lngCol As Integer) As String Dim vArr vArr = Split(Cells(1, lngCol).Address(True, False), &quot;$&quot;) Col_Letter = vArr(0) End Function"}], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1496240955, "creation_date": 1496240955, "answer_id": 44287521, "question_id": 44287382, "link": "https://stackoverflow.com/questions/44287382/string-variable-referencing-range-not-being-evaluated-within-workbookfunction-su/44287521#44287521", "title": "string variable referencing range not being evaluated within workbookfunction SUM", "body": "<p>One solution is to alter your function like this:</p>\n\n<pre><code>Function Col_letter(iCol As Long) As String\n    If iCol &gt; 0 And iCol &lt;= Columns.Count Then\n        Col_letter = Evaluate(\"substitute(address(1, \" &amp; iCol &amp; \", 4), \"\"1\"\", \"\"\"\")\")\n    End If\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5329329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b437e8f7a0e2efd43b287fd83fcabb19?s=128&d=identicon&r=PG&f=1", "display_name": "DHagens11", "link": "https://stackoverflow.com/users/5329329/dhagens11"}, "edited": false, "score": 0, "creation_date": 1496263796, "post_id": 44287568, "comment_id": 75595229, "body": "Thank you very much! This was very helpful."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 3, "user_id": 5329329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b437e8f7a0e2efd43b287fd83fcabb19?s=128&d=identicon&r=PG&f=1", "display_name": "DHagens11", "link": "https://stackoverflow.com/users/5329329/dhagens11"}, "edited": false, "score": 0, "creation_date": 1496263855, "post_id": 44287568, "comment_id": 75595240, "body": "You now need to choose <b>ONE</b> to mark as correct.  Choose the one you ended up using and click on the check mark by that answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1496241095, "creation_date": 1496241095, "answer_id": 44287568, "question_id": 44287382, "link": "https://stackoverflow.com/questions/44287382/string-variable-referencing-range-not-being-evaluated-within-workbookfunction-su/44287568#44287568", "title": "string variable referencing range not being evaluated within workbookfunction SUM", "body": "<p>There is no need to get the letter of the column, use the number, it is faster.</p>\n\n<p>Also if you try to sum the whole column with a formula in the same column you will get a circular reference error.</p>\n\n<pre><code>For c = 3 To lastColumn    \n    Cells(lastRow + 1, c).Formula = \"=SUM(\" &amp; Range(Cells(1,c),Cells(lastRow, c)).Address &amp; \")\"   \n\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5329329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b437e8f7a0e2efd43b287fd83fcabb19?s=128&d=identicon&r=PG&f=1", "display_name": "DHagens11", "link": "https://stackoverflow.com/users/5329329/dhagens11"}, "edited": false, "score": 0, "creation_date": 1496263819, "post_id": 44287653, "comment_id": 75595234, "body": "I will look into how R1C1 works- thanks for your response!"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 3, "user_id": 5329329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b437e8f7a0e2efd43b287fd83fcabb19?s=128&d=identicon&r=PG&f=1", "display_name": "DHagens11", "link": "https://stackoverflow.com/users/5329329/dhagens11"}, "edited": false, "score": 0, "creation_date": 1496264299, "post_id": 44287653, "comment_id": 75595457, "body": "@DHagens11 <code>R1</code> is row 1, <code>R[-1]</code> is the row above the formula, and <code>C</code> without number is the same column as the formula. It will still show up as A1 style reference in the formula bar - for example <code>=SUM(C1:C7)</code>, <code>=SUM(D1:D7)</code>, etc."}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": false, "score": 2, "last_activity_date": 1496271853, "last_edit_date": 1496271853, "creation_date": 1496241361, "answer_id": 44287653, "question_id": 44287382, "link": "https://stackoverflow.com/questions/44287382/string-variable-referencing-range-not-being-evaluated-within-workbookfunction-su/44287653#44287653", "title": "string variable referencing range not being evaluated within workbookfunction SUM", "body": "<p>Not needed if you use R1C1 reference:</p>\n\n<pre><code>Cells(lastRow + 1, 3).Resize(, lastColumn - 2).FormulaR1C1 = \"=SUM(R1C:R[-1]C)\"\n</code></pre>\n\n<hr>\n\n<p>A1 reference alternative:</p>\n\n<pre><code>Cells(lastRow + 1, 3).Resize(, lastColumn - 2).Formula = \"=SUM(C1:C\" &amp; lastRow &amp; \")\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5329329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b437e8f7a0e2efd43b287fd83fcabb19?s=128&d=identicon&r=PG&f=1", "display_name": "DHagens11", "link": "https://stackoverflow.com/users/5329329/dhagens11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 44287568, "answer_count": 3, "score": 0, "last_activity_date": 1496271853, "creation_date": 1496240626, "last_edit_date": 1531164843, "question_id": 44287382, "link": "https://stackoverflow.com/questions/44287382/string-variable-referencing-range-not-being-evaluated-within-workbookfunction-su", "title": "string variable referencing range not being evaluated within workbookfunction SUM", "body": "<p>I am trying to figure out the correct syntax so that my String variable <em>colLetter</em> will be evaluated within the SUM workbookfunction instead of being read as the literal text \"colLetter\".</p>\n\n<p><em>colLetter</em> stores Strings within a loop for each column range: \"A:A\", then \"B:B\", \"C:C\" and so on...</p>\n\n<p>I have a function Col_Letter(integer) As String that takes an integer and returns the String of the column letter in excel that integer corresponds to. Example: Col_Letter(3) returns \"C\"</p>\n\n<p>Right now my loop looks like so:</p>\n\n<pre><code>For c = 3 To lastColumn\n\n    Dim colLetter As String\n    colLetter = Col_Letter(c) &amp; \":\" &amp; Col_Letter(c)\n    Cells(lastRow + 1, c).Formula = \"=SUM(colLetter)\"\n\n\nNext\n</code></pre>\n\n<p>I want the formula to return =SUM(\"A:A\"), =SUM(\"B:B\") etc...but it returns =SUM(colLetter) instead and thus #Value!</p>\n\n<p>I can't figure out what needs to be fixed with my syntax of the sum formula. Any help would be much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7400632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d98b3efe89da17ef5829815e22291?s=128&d=identicon&r=PG&f=1", "display_name": "KyleWolf", "link": "https://stackoverflow.com/users/7400632/kylewolf"}, "edited": false, "score": 0, "creation_date": 1496257861, "post_id": 44289441, "comment_id": 75592231, "body": "Thanks! that works perfectly.  I was trying something similar but it would keep cycling back up to the top (E1 in your example) for each new item (fruit).  I appreciate the help."}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 5, "user_id": 7400632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d98b3efe89da17ef5829815e22291?s=128&d=identicon&r=PG&f=1", "display_name": "KyleWolf", "link": "https://stackoverflow.com/users/7400632/kylewolf"}, "edited": false, "score": 0, "creation_date": 1496302118, "post_id": 44289441, "comment_id": 75607534, "body": "@KyleWolf Thats great!!"}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 1, "last_activity_date": 1496246145, "creation_date": 1496246145, "answer_id": 44289441, "question_id": 44287160, "link": "https://stackoverflow.com/questions/44287160/expanding-table-with-observational-values-to-a-list-in-excel-reverse-remove-dup/44289441#44289441", "title": "expanding table with observational values to a list in excel- Reverse remove duplicate", "body": "<p>Try out this simple code,</p>\n\n<pre><code>Sub reverseDups()\nDim i As Long, j As Long, k As Long\nk = 1\nFor i = 1 To Cells(Rows.Count, 1).End(xlUp).Row\n    For j = 1 To Cells(i, 2)\n        Cells(k, 5) = Cells(i, 1)\n        k = k + 1\n    Next j\nNext i\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pdBY0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pdBY0.png\" alt=\"enter image description here\"></a></p>\n\n<p><code>Columns A and B</code> is your source data and you will get your output in <code>Column E</code></p>\n"}], "owner": {"reputation": 5, "user_id": 7400632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512d98b3efe89da17ef5829815e22291?s=128&d=identicon&r=PG&f=1", "display_name": "KyleWolf", "link": "https://stackoverflow.com/users/7400632/kylewolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 44289441, "answer_count": 1, "score": 0, "last_activity_date": 1496246145, "creation_date": 1496240009, "last_edit_date": 1592644375, "question_id": 44287160, "link": "https://stackoverflow.com/questions/44287160/expanding-table-with-observational-values-to-a-list-in-excel-reverse-remove-dup", "title": "expanding table with observational values to a list in excel- Reverse remove duplicate", "body": "<p>In excel, I am trying to turn a simple table of items and the number of observations for each item into a single column of items where each items is present in the same number as the number observed in the table.</p>\n<p>Essentially, I want the reverse of the more typical &quot;copy-paste, remove duplicates, countif(parent data, unique value)&quot;.</p>\n<p>In the attached example, the top example is what I imagine is the more typical desire, the bottom example is what I am looking to accomplish. I assume this will be a VBA solution, but if it can be done without, that is just as fine.</p>\n<p><a href=\"https://i.stack.imgur.com/nMaon.jpg\" rel=\"nofollow noreferrer\">Example of what I mean</a></p>\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "variables", "global", "userform"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6352777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e17a95168451b85cc9e38527883f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Holmes", "link": "https://stackoverflow.com/users/6352777/alec-holmes"}, "edited": false, "score": 0, "creation_date": 1496241103, "post_id": 44287339, "comment_id": 75581868, "body": "Thank you! I knew it had to be simple like that. Does this work with regular modules as well? Simply declaring the variable before all the subs shares that variable within the module?"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 27, "user_id": 6352777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e17a95168451b85cc9e38527883f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Holmes", "link": "https://stackoverflow.com/users/6352777/alec-holmes"}, "edited": false, "score": 0, "creation_date": 1496242445, "post_id": 44287339, "comment_id": 75582913, "body": "@AlecHolmes You&#39;re welcome. Yes that&#39;s true. That&#39;s called module level variables if you declare them at the top of module."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1496240533, "creation_date": 1496240533, "answer_id": 44287339, "question_id": 44287112, "link": "https://stackoverflow.com/questions/44287112/excel-vba-sharing-variable-within-userfrom-subs/44287339#44287339", "title": "Excel VBA Sharing Variable Within Userfrom Subs", "body": "<p>If you declare a variable on the top of UserForm Module, the variable can be accessed by any control or a procedure on the UserForm Module.</p>\n\n<p>Insert a UserForm and place two command buttons on it and place the following code on UserForm Module.\nLaunch the UserForm and click both the command buttons to see how can you access a variable this way.</p>\n\n<pre><code>Option Explicit\n\nDim Str As String\n\nPrivate Sub CommandButton1_Click()\nMsgBox Str\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\nCall Test\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nStr = \"This variable can be accessed by any code on UserForm Module.\"\nEnd Sub\n\nSub Test()\nMsgBox Str\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 6352777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e17a95168451b85cc9e38527883f1da?s=128&d=identicon&r=PG&f=1", "display_name": "Alec Holmes", "link": "https://stackoverflow.com/users/6352777/alec-holmes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 44287339, "answer_count": 1, "score": 0, "last_activity_date": 1496240533, "creation_date": 1496239887, "question_id": 44287112, "link": "https://stackoverflow.com/questions/44287112/excel-vba-sharing-variable-within-userfrom-subs", "title": "Excel VBA Sharing Variable Within Userfrom Subs", "body": "<p>So this isn't a huge deal, but it's getting under my skin. I'm trying to share a variable between subs <em>within</em> a userform. Declaring a public variable seems like an easy way to do it, but apparently, you can't declare public variables from within a userform. So it seems I have to declare the variable in a completely unrelated module, which I find maddeningly annoying. Is this the only way to pass variables between subs within a userform? </p>\n\n<p>For context, I'm trying to make \"Ok\", \"Apply\", and \"Cancel\" buttons on a Settings userform, where the \"Ok\" and \"Apply\" buttons permanently make changes that I made in the settings. </p>\n\n<p>Here's button that's removing items from a listbox (PathList). The listbox is storing data on a worksheet, but I don't want the items to actually be removed from the sheet until I hit \"Apply\". I want to share the SelectedArray() variable with the ApplyButton_Click subroutine so that the \"Apply\" button can actually delete the cells from the sheet. The commented code is what I want the \"Apply\" button to do.</p>\n\n<pre><code>Private Sub RemovePathButton_Click()\nDim SelectedArray()\nDim ctr As Integer\nctr = 1\n\nFor intCount = PathList.ListCount - 1 To 0 Step -1\n    If PathList.Selected(intCount) = True Then\n        ReDim Preserve SelectedArray(ctr)\n        SelectedArray(ctr) = intCount\n        ctr = ctr + 1\n    End If\nNext intCount\n\n\nFor i = 1 To UBound(SelectedArray)\n'    Dim num As Integer\n'    num = SelectedArray(i) + 4\n'    Worksheets(\"Settings\").Range(\"A\" + CStr(num)).Delete (xlShiftUp)\n    PathList.RemoveItem (SelectedArray(i))\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1496240117, "post_id": 44286773, "comment_id": 75581103, "body": "There&#39;s only one <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839952.aspx\" rel=\"nofollow noreferrer\"><code>wdSaveAsFormat</code></a> to specify a PDF. A quick google search suggests that while you can create a PDF from Word, you need to use Acrobat to make it &quot;fillable&quot; and specify which fields/forms are fillable by the user. <a href=\"https://langlit.ucdavis.edu/technical-support/create-fill-able-pdf-word-document\" rel=\"nofollow noreferrer\">langlit.ucdavis.edu/technical-support/&hellip;</a>"}], "owner": {"reputation": 241, "user_id": 6654790, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9019a96fdfbf926d154a20a696611015?s=128&d=identicon&r=PG&f=1", "display_name": "bdpolinsky", "link": "https://stackoverflow.com/users/6654790/bdpolinsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 590, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496239001, "creation_date": 1496239001, "last_edit_date": 1531164843, "question_id": 44286773, "link": "https://stackoverflow.com/questions/44286773/excel-word-vba-save-as-fillable-pdf", "title": "Excel/Word VBA save as fillable PDF", "body": "<p>is there a way to save a word document as a fillable formated PDF? The line I use to save it as a regular pdf is:</p>\n\n<pre><code>wordObject.SaveAs2 fileName:=fileName, FileFormat:=wdFormatPDF\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1496239063, "post_id": 44286702, "comment_id": 75580310, "body": "Strongly consider using <b>Double</b> vs <b>Single</b>."}, {"owner": {"reputation": 33, "user_id": 7540424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5c361771c32d2f80b097d6dfaa2c07?s=128&d=identicon&r=PG&f=1", "display_name": "ZulKaz", "link": "https://stackoverflow.com/users/7540424/zulkaz"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1496239309, "post_id": 44286702, "comment_id": 75580488, "body": "Even if the values are only between -32768 and 32768?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496240728, "post_id": 44286702, "comment_id": 75581575, "body": "Y9u need to use a break point and check the value of the string you believe is a number.  There may be alpha characters in the variable valueToRead.  Try a &quot;debug.print valueToRead&quot; directly before the line that cause the error."}, {"owner": {"reputation": 33, "user_id": 7540424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5c361771c32d2f80b097d6dfaa2c07?s=128&d=identicon&r=PG&f=1", "display_name": "ZulKaz", "link": "https://stackoverflow.com/users/7540424/zulkaz"}, "edited": false, "score": 0, "creation_date": 1496241862, "post_id": 44286702, "comment_id": 75582440, "body": "I tried to change realAngle into a double and to use realAngle = CDbl(valueToRead) but I have still &quot;execution error &#39;13&#39;, type incompatibility&quot;.  I am using a break point and the value of the string is &quot;1.580000&quot; then the problem occurs when I am trying to set the value into realAngle."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1496242177, "post_id": 44286702, "comment_id": 75582711, "body": "@ZulKaz try simple <code>Debug.Print CDbl(&quot;1.580000&quot;)</code> and <code>Debug.Print CDbl(&quot;1,580000&quot;)</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1496242700, "post_id": 44286702, "comment_id": 75583117, "body": "Supporting the idea of not using <code>Single</code> in VBA."}, {"owner": {"reputation": 33, "user_id": 7540424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5c361771c32d2f80b097d6dfaa2c07?s=128&d=identicon&r=PG&f=1", "display_name": "ZulKaz", "link": "https://stackoverflow.com/users/7540424/zulkaz"}, "edited": false, "score": 0, "creation_date": 1496242899, "post_id": 44286702, "comment_id": 75583257, "body": "Debug.Print CDbl(&quot;1,580000&quot;) is working fine Debug.Print CSng(&quot;1.580000&quot;) is not working, &quot;execution error &#39;13&#39;, type incompatibility&quot;.  I don&#39;t really understand two things then: 1) Why is not working with Single? 2) Why my line:  realAngle = CDbl(valueToRead) when realAngle is a Double is not working either?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1496242947, "post_id": 44286702, "comment_id": 75583291, "body": "What are your regional settings?  Is your decimal a . or a , ?"}, {"owner": {"reputation": 33, "user_id": 7540424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5c361771c32d2f80b097d6dfaa2c07?s=128&d=identicon&r=PG&f=1", "display_name": "ZulKaz", "link": "https://stackoverflow.com/users/7540424/zulkaz"}, "edited": false, "score": 0, "creation_date": 1496243118, "post_id": 44286702, "comment_id": 75583424, "body": "Oups, I didn&#39;t saw the difference in Vityata message with the . and ,. My bad.  My Excel is set to french...I&#39;ll take a look for moving it to English.  I guess it is looking for , instead of . which is provoking the error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496243122, "post_id": 44286702, "comment_id": 75583427, "body": "<code>realAngle = CSng(Replace(valueToRead, &quot;.&quot;, &quot;,&quot;))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7540424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5c361771c32d2f80b097d6dfaa2c07?s=128&d=identicon&r=PG&f=1", "display_name": "ZulKaz", "link": "https://stackoverflow.com/users/7540424/zulkaz"}, "edited": false, "score": 0, "creation_date": 1496243452, "post_id": 44288236, "comment_id": 75583658, "body": "Well I get what is the problem now! Thank you all for your quick answers :) Is it also possible to know why Double is preferable to Single?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 7540424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5c361771c32d2f80b097d6dfaa2c07?s=128&d=identicon&r=PG&f=1", "display_name": "ZulKaz", "link": "https://stackoverflow.com/users/7540424/zulkaz"}, "edited": false, "score": 0, "creation_date": 1496244290, "post_id": 44288236, "comment_id": 75584292, "body": "@Zulkaz - write in google &quot;Why should use long in stead of integer vba&quot;. The reason is pretty much the same. Sry, away from PC now."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1496243147, "last_edit_date": 1496243147, "creation_date": 1496242871, "answer_id": 44288236, "question_id": 44286702, "link": "https://stackoverflow.com/questions/44286702/converting-a-string-into-a-single/44288236#44288236", "title": "Converting a String into a Single", "body": "<p>Just guessing that you are not in USA/UK. In Germany, you have <code>,</code> and not <code>.</code> as a regional setting. Thus, add this to the string, before casting:</p>\n\n<pre><code>Public Function change_commas(ByVal myValue As Variant) As String\n\n    Dim str_temp As String\n\n    str_temp = CStr(myValue)\n    change_commas = Replace(str_temp, \",\", \".\")\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7540424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b5c361771c32d2f80b097d6dfaa2c07?s=128&d=identicon&r=PG&f=1", "display_name": "ZulKaz", "link": "https://stackoverflow.com/users/7540424/zulkaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3458, "favorite_count": 0, "accepted_answer_id": 44288236, "answer_count": 1, "score": 2, "last_activity_date": 1496243147, "creation_date": 1496238828, "last_edit_date": 1531164843, "question_id": 44286702, "link": "https://stackoverflow.com/questions/44286702/converting-a-string-into-a-single", "title": "Converting a String into a Single", "body": "<p>My question might sound stupid but I tried several solutions exposed on internet without any success. I'm totally new to VBA.</p>\n\n<p><strong>Problem:</strong>\nI am extracting data from a txt file. That data is stored into a String and I need to store that value into a Single variable.</p>\n\n<p><strong>Context:</strong>\nI am using Microsoft Excel 2010, the code is done under Microsoft Visual Basic for Applications.</p>\n\n<p><strong>Solutions that i tried:</strong>\nIn all these cases, valueToRead is equal to \"1.580000\".</p>\n\n<p>1) realAngle = CSng(valueToRead)\nI get the execution error '13', type incompatibility</p>\n\n<p>2) realAngle = Single.Parse(valueToRead)\nCompilation error, syntax error</p>\n\n<p>3) realAngle = Single.Parse(valueToRead, System.Globalization.NumberFormatInfo.InvariantInfo)\nCompilation error, syntax error</p>\n\n<p>4) realAngle = Convert.ToSingle(valueToRead)\nExecution error '424': object required</p>\n\n<p>My code is below :</p>\n\n<pre><code>Sub macro_test()\n' File to read data from\nDim logFile As String\n' Variable containing a line from the file\nDim textLine As String\n' Variable containing a part of the line\nDim ReadValue As Variant\n' Variable containing a  part of ReadValue\nDim ReadValue2 As Variant\n' Desperate variable in order to be sure to have a String value\nDim valueToRead As String\n' Angle value stored in the file\nDim realAngle As Single\n' Number of elements separated by \" | \" in the lien\nDim Size As Integer\n\n' Initialize variables\nSize = 0\nrealAngle = 0\nlogFile = \"FilePathAndName\"\n\n' Open the txt file\nOpen logFile For Input As #1\n\n' Read until the end of the file\nDo Until EOF(1)\n    ' Get a line of text from the file\n    Line Input #1, textLine\n    ' Split the line with \" | \" separator\n    ReadValue = Split(textLine, \" | \")\n\n    ' Count the number of elements\n    Size = UBound(ReadValue) - LBound(ReadValue) + 1\n\n    ' If the line have enough elements then it may be of interest\n    If Size &gt; 9 Then\n        ' if this is the correct line thanks to a correct identificator\n        If ReadValue(3) = \"MyIdentificator\" Then\n        ' Split the line with the \" = \" sign\n        ReadValue2 = Split(ReadValue(8), \" = \")\n        ' Storing the value into a String\n        valueToRead = ReadValue2(1)\n\n        realAngle = CSng(valueToRead)\n        'realAngle = Single.Parse(valueToRead)\n        'realAngle = Convert.ToSingle(valueToRead)\n        'realAngle = Single.Parse(valueToRead, System.Globalization.NumberFormatInfo.InvariantInfo)\n        End If\n    End If\nLoop\n\nClose #1\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for your help!</p>\n\n<p>edit: Here is an exemple of the line that I get in the file:\nLog Level: LogLevel | File name: X:\\Folder1\\Folder2\\Folder3\\Folder4\\Folder5\\Folder6\\FileName.h | Function name: FunctionName| Line number: XXXX | Information: MYINFO | BLABLA | VALUE1 = 32768 | VALUE2 = 0.000000 | VALUE3 = 1.580000 | VALUE4 = 0.000000 | VALUE5 = 3581.941895 | VALUE6 = 36349.941406</p>\n\n<p>I am currently trying to get VALUE3.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1496239123, "post_id": 44286661, "comment_id": 75580364, "body": "<code>x1toRight</code> should be <code>xLtoRight</code>  and <code>x1Down</code> sould be <code>xLDown</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1496239199, "post_id": 44286661, "comment_id": 75580409, "body": "Why are you trying to use <code>xlDown</code> when you start with full columns anyways? Record yourself performing these actions and examine the code you produce."}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1496239794, "post_id": 44286661, "comment_id": 75580871, "body": "You should also avoid using <code>Select</code>, see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">this answer</a> for some more info"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8092309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1038dd90bbf30965914d8db79e2e1b?s=128&d=identicon&r=PG&f=1", "display_name": "CZ31", "link": "https://stackoverflow.com/users/8092309/cz31"}, "edited": false, "score": 0, "creation_date": 1496245689, "post_id": 44287132, "comment_id": 75585224, "body": "I am trying to select all of the columns after E until the end of my data. The lists that I&#39;m pulling my info from vary in the number of columns that I need to copy. Will this work for that?"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 5, "user_id": 8092309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1038dd90bbf30965914d8db79e2e1b?s=128&d=identicon&r=PG&f=1", "display_name": "CZ31", "link": "https://stackoverflow.com/users/8092309/cz31"}, "edited": false, "score": 0, "creation_date": 1496246680, "post_id": 44287132, "comment_id": 75585890, "body": "@user8092309 well, if you tell me what your sheet looks like I can answer your question. Or you can just try and see. Either way. I&#39;m sure it works or I can make it work"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "reply_to_user": {"reputation": 5, "user_id": 8092309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1038dd90bbf30965914d8db79e2e1b?s=128&d=identicon&r=PG&f=1", "display_name": "CZ31", "link": "https://stackoverflow.com/users/8092309/cz31"}, "edited": false, "score": 0, "creation_date": 1496246821, "post_id": 44287132, "comment_id": 75585972, "body": "@user8092309 You say &quot;all of the columns&quot;. Yet the code you gave us above indivates it&#39;s a range of cells and not columns you select. First line you select E column, then &quot;ctrl right arrow&quot; menas select till end. Fine. But then you do &quot;ctrl down arrow&quot;, do you see the confusion? Do you want columns or range of cells?"}, {"owner": {"reputation": 5, "user_id": 8092309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1038dd90bbf30965914d8db79e2e1b?s=128&d=identicon&r=PG&f=1", "display_name": "CZ31", "link": "https://stackoverflow.com/users/8092309/cz31"}, "edited": false, "score": 0, "creation_date": 1496321588, "post_id": 44287132, "comment_id": 75621386, "body": "I can see why that would be confusing. Either will work. I need to capture all of the information in column E until the end of the spreadsheet."}, {"owner": {"reputation": 5, "user_id": 8092309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1038dd90bbf30965914d8db79e2e1b?s=128&d=identicon&r=PG&f=1", "display_name": "CZ31", "link": "https://stackoverflow.com/users/8092309/cz31"}, "edited": false, "score": 0, "creation_date": 1496323532, "post_id": 44287132, "comment_id": 75622875, "body": "I did and it worked. I&#39;m not sure why it did, but I really do appreciate your help."}], "tags": [], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "is_accepted": true, "score": 0, "last_activity_date": 1496239951, "creation_date": 1496239951, "answer_id": 44287132, "question_id": 44286661, "link": "https://stackoverflow.com/questions/44286661/excel-vba-varaible-column-selection/44287132#44287132", "title": "Excel VBA varaible column selection", "body": "<p>Not exactly sure what you are trying to do but this code till select E1 -> last column and last row filled.  </p>\n\n<p>You need to adapt it to suit your needs. I assumed your table is square, if not change the code.  </p>\n\n<p>I counted the rows used in column E, if that is not what you want change that.<br>\nI also looked for the last column in row 1. change that if that is incorrect.  </p>\n\n<pre><code>LastCol = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column ' here you need to change '1' to what row to look at\nLastRow = Cells(Rows.Count, \"E\").End(xlUp).Row ' change \"E\" to fit your need\nRange(\"E1:\" &amp; Split(Cells(1, LastCol).Address(True, False), \"$\")(0) &amp; LastRow).Select\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8092309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad1038dd90bbf30965914d8db79e2e1b?s=128&d=identicon&r=PG&f=1", "display_name": "CZ31", "link": "https://stackoverflow.com/users/8092309/cz31"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 44287132, "answer_count": 1, "score": 0, "last_activity_date": 1496239951, "creation_date": 1496238750, "last_edit_date": 1531161705, "question_id": 44286661, "link": "https://stackoverflow.com/questions/44286661/excel-vba-varaible-column-selection", "title": "Excel VBA varaible column selection", "body": "<p>I am currently trying to finish a Macro that will pull together a list of all the people into 1 list and show all of the different info for people across all of the lists.</p>\n\n<p>I have gotten to the point where I have all the lists together, and all I need to do now is select the proper data and compile it.</p>\n\n<p>My current code:</p>\n\n<pre><code>Sheets(\"Sheet2\").Select\nColumns(\"E:AI\").Select\nSelection.Copy\nSheets(\"Sheet1\").Select\nRange(\"E1\").Select\nActiveSheet.Paste\n</code></pre>\n\n<p>I am trying to replace the columns line so that it can select a variable length.</p>\n\n<pre><code>Columns(\"E\").Select\nRange(Selection, Selection.End(x1toRight)).Select\nRange(Selection, Selection.End(x1Down)).Select\nSelection.Copy\n</code></pre>\n\n<p>When the Macro gets to the first 2nd line in my updated code, I get a run time error '1004': Application-defined or object defined error.</p>\n\n<p>When I go through it line by line, there seems to be an issue with the Columns(\"E\") selecting the same data as it previously had when it was Columns (\"E:AI\").</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "excel-formula", "excel-charts", "vba"], "comments": [{"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1496238803, "post_id": 44286646, "comment_id": 75580123, "body": "Does =iferror() work? Or ifna(), I think it&#39;s called that..."}, {"owner": {"reputation": 8331, "user_id": 2378710, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2faf91f2efa646f23b07220deb997687?s=128&d=identicon&r=PG", "display_name": "Jamgreen", "link": "https://stackoverflow.com/users/2378710/jamgreen"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1496239939, "post_id": 44286646, "comment_id": 75580975, "body": "But I don&#39;t want to decide whether a cell has <code>NA()</code>. I just want to exclude them from my Chart, so in the example above, I only want to show Germany, France, and UK (and not the NA() data point)"}, {"owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1496240116, "post_id": 44286646, "comment_id": 75581100, "body": "Yes and with =iferror(&quot;your formula&quot;, &quot;&quot;)  the cell will be left blank if there is an error in the formula. What does that do with your chart? Does that remove the datapoint or will it create a blank datapoint in the chart?"}, {"owner": {"reputation": 8331, "user_id": 2378710, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2faf91f2efa646f23b07220deb997687?s=128&d=identicon&r=PG", "display_name": "Jamgreen", "link": "https://stackoverflow.com/users/2378710/jamgreen"}, "reply_to_user": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "edited": false, "score": 0, "creation_date": 1496240740, "post_id": 44286646, "comment_id": 75581584, "body": "I added the <code>NA()</code> myself because I thought it would work. Leaving it blank will just create a blank data point in the chart."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 2, "creation_date": 1496241814, "post_id": 44286646, "comment_id": 75582402, "body": "Have you searches SO before posting this? See this thread for example: <a href=\"https://stackoverflow.com/questions/15013911/creating-a-chart-in-excel-that-ignores-n-a-or-blank-cells\" title=\"creating a chart in excel that ignores n a or blank cells\">stackoverflow.com/questions/15013911/&hellip;</a>"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1496260385, "post_id": 44286646, "comment_id": 75593650, "body": "Your chart should respond to filters on the underlying table (and if your data isnt formatted as a table, it should be). You can then add a slicer, and filter out (or to) anything you prefer. Try formatting your data as a table, then create a chart from that table (Insert &gt; Charts &gt; Line Chart). You can add a slicer by going to Insert &gt; Slicer and selecting the category you want to slice. You can also skip the slicer and directly filter the table using the dropdown filters."}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1496260447, "post_id": 44289898, "comment_id": 75593691, "body": "No need for a pivottable in this case. A plain table will do (and is more closely aligned with the OP&#39;s need)."}], "tags": [], "owner": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1496247460, "creation_date": 1496247460, "answer_id": 44289898, "question_id": 44286646, "link": "https://stackoverflow.com/questions/44286646/hide-data-points-in-excel-if-n-a/44289898#44289898", "title": "Hide data points in Excel if #N/A", "body": "<p>What about turning your chart into a Pivotchart, allowing you to unfilter values which equal #N/A?</p>\n\n<ol>\n<li>Select the table, Insert > Pivot table. </li>\n<li>Create the chart, select the Pivot Table as the source</li>\n<li>Filter out #N/A in the chart, or table</li>\n</ol>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 8331, "user_id": 2378710, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/2faf91f2efa646f23b07220deb997687?s=128&d=identicon&r=PG", "display_name": "Jamgreen", "link": "https://stackoverflow.com/users/2378710/jamgreen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1297, "favorite_count": 0, "closed_date": 1496260423, "answer_count": 1, "score": -1, "last_activity_date": 1496260200, "creation_date": 1496238709, "last_edit_date": 1531161705, "question_id": 44286646, "link": "https://stackoverflow.com/questions/44286646/hide-data-points-in-excel-if-n-a", "closed_reason": "Duplicate", "title": "Hide data points in Excel if #N/A", "body": "<p>I have a chart in Excel</p>\n\n<p><a href=\"https://i.stack.imgur.com/iExbd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iExbd.png\" alt=\"enter image description here\"></a></p>\n\n<p>based on the data</p>\n\n<p><a href=\"https://i.stack.imgur.com/g2zXw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g2zXw.png\" alt=\"enter image description here\"></a></p>\n\n<p>My problem is that I want to hide the data point at #N/A.</p>\n\n<p>The use case is that sometimes there will be a country, but I want the user to be able to disable/enable each country and I want the chart to dynamically respond to the changes.</p>\n\n<p>So instead of having all the data points, I want it, in this example, to have only 3 data points.</p>\n"}, {"tags": ["excel", "vba", "pivot", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1727944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3010fba0e4ca16177d5b9202cf9e66dc?s=128&d=identicon&r=PG", "display_name": "Shiyas", "link": "https://stackoverflow.com/users/1727944/shiyas"}, "is_accepted": false, "score": 0, "last_activity_date": 1527071742, "creation_date": 1527071742, "answer_id": 50486162, "question_id": 44286459, "link": "https://stackoverflow.com/questions/44286459/how-can-i-force-excel-to-place-sigma-values-pivot-field-into-the-columns-label-u/50486162#50486162", "title": "How can I force Excel to place Sigma Values pivot field into the Columns Label using VBA code?", "body": "<p>You can set DataOnRows property to False</p>\n\n<pre><code>pivotTable.DataOnRows = False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8092164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b040bc1da62f3e498877a12029552?s=128&d=identicon&r=PG&f=1", "display_name": "PointingNoWhere", "link": "https://stackoverflow.com/users/8092164/pointingnowhere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 698, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527071742, "creation_date": 1496238178, "question_id": 44286459, "link": "https://stackoverflow.com/questions/44286459/how-can-i-force-excel-to-place-sigma-values-pivot-field-into-the-columns-label-u", "title": "How can I force Excel to place Sigma Values pivot field into the Columns Label using VBA code?", "body": "<p>In my Pivot Tables, I prefer to see the Value fields displayed as column labels next to the Row label fields. By default, Excel will create a field \"Sigma Values\" and move it into either the Row Labels or Column Labels. I would like to add to my Pivot Table Create macro, a line(s) of code to create and place this field into the Columns Label. Below I show the orientation I would like. Thanks in advance! \n<a href=\"https://i.stack.imgur.com/SCt1U.jpg\" rel=\"nofollow noreferrer\">The Sigma Values field is created by default. I would like to force excel to always place this field in Column Label</a></p>\n\n<p>Here is my VBA code, it is still not finished</p>\n\n<pre><code>    Sub olderRTSPivot()\n\n    Dim objTable As PivotTable, objField As PivotField\n</code></pre>\n\n<p>'point to top left of raw data table (ie the Exception Report )</p>\n\n<pre><code>     ActiveWorkbook.Sheets(\"Sheet Name\").Select\n     Range(\"A1\").Select\n</code></pre>\n\n<p>'tell Excel to use this table to create the pivot</p>\n\n<pre><code>     Set objTable = ActiveSheet.PivotTableWizard\n</code></pre>\n\n<p>'set Filter fields</p>\n\n<pre><code>     Set objField = objTable.PivotFields(\"Aging Category\")\n     objField.Orientation = xlPageField\n\n     Set objField = objTable.PivotFields(\"Project\")\n     objField.Orientation = xlPageField\n</code></pre>\n\n<p>'Set Row Fields</p>\n\n<pre><code>     Set objField = objTable.PivotFields(\"Originator\")\n     objField.Orientation = xlRowField\n\n     Set objField = objTable.PivotFields(\"Created\")\n     objField.Orientation = xlRowField\n</code></pre>\n\n<p>'Set Data Fields</p>\n\n<pre><code>     Set objField = objTable.PivotFields(\"RTS\")\n     objField.Orientation = xlDataField\n     objField.Function = xlCount\n\n     Set objField = objTable.PivotFields(\"Days Aged\")\n     objField.Orientation = xlDataField\n     objField.Function = xlAverage\n\n     Set objField = objTable.PivotFields(\"Days Aged\")\n     objField.Orientation = xlDataField\n     objField.Function = xlMax\n\n     End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1496238237, "post_id": 44286419, "comment_id": 75579690, "body": "I suspect that when you called the form your &quot;active row&quot; lost focus"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496238728, "post_id": 44286419, "comment_id": 75580072, "body": "post the code of <code>ModifyTableRow</code>, or the relevant part of it."}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 2538316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/addebb8e7df2f18346eeacde6375b83f?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2538316/andy"}, "edited": false, "score": 0, "creation_date": 1496300534, "post_id": 44287016, "comment_id": 75606432, "body": "I added the above code and got Compile error: variable not defined"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 277, "user_id": 2538316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/addebb8e7df2f18346eeacde6375b83f?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2538316/andy"}, "edited": false, "score": 0, "creation_date": 1496321676, "post_id": 44287016, "comment_id": 75621443, "body": "All the variables in this subroutine are defined by a dim statement so you are not getting that error from this code.  Is there any worksheet subroutines working in the background?  Something else is causing that error.  Tested this code several times, with and without &quot;Option Explicit&quot;"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496239624, "creation_date": 1496239624, "answer_id": 44287016, "question_id": 44286419, "link": "https://stackoverflow.com/questions/44286419/use-vba-userform-to-update-active-row/44287016#44287016", "title": "Use VBA Userform to update active row", "body": "<p>Try this to get the active row of the current table.  Found <a href=\"https://stackoverflow.com/questions/26232250/find-table-row-number-from-selected-cell\">here</a>\nOriginally answered by @Anand </p>\n\n<pre><code>Sub FindRowNoInTable()\n\nDim ObjSheet As Worksheet\nDim startRow, ActiveRow, ActiveCol\nDim ObjList As ListObject\nSet ObjSheet = ActiveSheet\nActiveRow = ActiveCell.Row\nActiveCol = ActiveCell.Column\nFor Each ObjList In ObjSheet.ListObjects\n        Application.Goto ObjList.Range\n        startRow = ObjList.Range.Row\nNext\nDebug.Print (ActiveRow - startRow)\n\nEnd Sub\n</code></pre>\n\n<p>Then put (ActiveRow - startRow) into the variable \"CurrentRow\"</p>\n"}, {"tags": [], "owner": {"reputation": 277, "user_id": 2538316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/addebb8e7df2f18346eeacde6375b83f?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2538316/andy"}, "is_accepted": true, "score": 0, "last_activity_date": 1496391231, "creation_date": 1496391231, "answer_id": 44323980, "question_id": 44286419, "link": "https://stackoverflow.com/questions/44286419/use-vba-userform-to-update-active-row/44323980#44323980", "title": "Use VBA Userform to update active row", "body": "<p>After playing around with the code this solution worked for me</p>\n\n<pre><code>Option Explicit\nPrivate ExpensesTable As ListObject\nPrivate CurrentRow As Long\nPrivate WithEvent`enter code here`s Calendar1 As cCalendar\n\nPrivate Sub UpdateExpenses_Click()\nCurrentRow = ActiveCell.Row\nCells(CurrentRow, 2) = Calendar1.Value\nCells(CurrentRow, 3) = Me.StaffName.Value\nCells(CurrentRow, 4) = Me.CircuitDesc.Value\nCells(CurrentRow, 5) = Me.SystemID.Value\nCells(CurrentRow, 6) = Me.ChannelNum.Value\nCells(CurrentRow, 7) = Me.SystemAEnd.Value\nCells(CurrentRow, 8) = Me.SystemBEnd.Value\nCells(CurrentRow, 9) = Me.TypeofCircuit.Value\nCells(CurrentRow, 10) = Me.CircuitStatus.Value\nCells(CurrentRow, 11) = Me.Comments.Value\nUnload ExpensesForm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 2538316, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/addebb8e7df2f18346eeacde6375b83f?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/2538316/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1551, "favorite_count": 0, "accepted_answer_id": 44323980, "answer_count": 2, "score": 0, "last_activity_date": 1496391231, "creation_date": 1496238072, "last_edit_date": 1496300460, "question_id": 44286419, "link": "https://stackoverflow.com/questions/44286419/use-vba-userform-to-update-active-row", "title": "Use VBA Userform to update active row", "body": "<p>I load the user form and edit the data when i click the update button the last row of the table is updated instead of the row i have selected</p>\n\n<pre><code>Private Sub UpdateExpenses_Click()\n\nModifyTableRow ExpensesTable.ListRows(CurrentRow).Range\n\nUpdatePositionCaption\n\nEnd Sub\n\nPrivate Sub ModifyTableRow(TableRow As Range)\n\nWith TableRow\n\n    .Cells(1, 1) = Calendar1.Value\n    .Cells(1, 2) = StaffName.Value\n    .Cells(1, 4) = SystemID.Value\n    .Cells(1, 6) = SystemAEnd.Value\n    .Cells(1, 7) = SystemBEnd.Value\n    .Cells(1, 3) = CircuitDesc.Value\n    .Cells(1, 9) = CircuitStatus.Value\n    .Cells(1, 10) = Comments.Value\n    .Cells(1, 8) = TypeofCircuit.Value\n    .Cells(1, 5) = ChannelNum.Value\n\n\n\nEnd With\n\nChangeRecord.Max = ExpensesTable.ListRows.Count\n</code></pre>\n\n<p>End Sub</p>\n\n<p>any help with this code would be much appriciated</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "edited": false, "score": 0, "creation_date": 1496300347, "post_id": 44293032, "comment_id": 75606334, "body": "Thank you, it was what i was looking for. Isn&#39;t possible to use a public string() in vba ?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "edited": false, "score": 0, "creation_date": 1496300989, "post_id": 44293032, "comment_id": 75606752, "body": "It is but what\u2019s the point for such overhead if you\u2019re only planning to use it once? Public variables are loaded in memory when your app starts and stay there until the app\u2019s terminated. I personally avoid them as much as possible."}, {"owner": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "edited": false, "score": 0, "creation_date": 1496306529, "post_id": 44293032, "comment_id": 75610391, "body": "I understand this, but i need to share 2 type of string, i can&#39;t know what string will be of each format exemple  string 1 = &quot;exemple1&quot; string 2 = &quot;exemple2&quot; So for to separate each i must use a second identifier like &quot;?exemple1&quot; and &quot;!exemple2&quot; ? I will have something like 10 string in each array"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "edited": false, "score": 0, "creation_date": 1496306586, "post_id": 44293032, "comment_id": 75610435, "body": "Where do your strings come from?"}, {"owner": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "edited": false, "score": 0, "creation_date": 1496306715, "post_id": 44293032, "comment_id": 75610526, "body": "From 2 text box on my main form, currently i stock them separatly"}, {"owner": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "edited": false, "score": 0, "creation_date": 1496308648, "post_id": 44293032, "comment_id": 75611981, "body": "The update doesn&#39;t really help, i have updated my question in the subject"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1496322534, "last_edit_date": 1496322534, "creation_date": 1496258181, "answer_id": 44293032, "question_id": 44286402, "link": "https://stackoverflow.com/questions/44286402/how-to-do-a-global-string-array-in-vba/44293032#44293032", "title": "How to do a global string array in vba?", "body": "<p>If you need to pass it when the form loads, you can concatenate the values to a single string and pass it through the <code>.OpenArgs</code>.</p>\n\n<p>On the other form's load event, you can split the string and create an array.</p>\n\n<pre><code>DoCmd.OpenForm \"FormName\", acNormal, , , acFormPropertySettings, acWindowNormal, \"String1;String2;String3;String4\"\n\n'...\n\nPrivate Sub Form_Load()\n\n    Dim arr As Variant\n    With Me\n        If Not IsNull(.OpenArgs) Then\n            arr = Split(.OpenArgs, \";\")\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<h2>Update 1:</h2>\n\n<p>You can build the <code>.OpenArgs</code> string like this:</p>\n\n<pre><code>dim oneString as String\n\nWith Me\n    oneString = .YourtextBoxName1.Value &amp; \";\" &amp; .YourtextBoxName2.Value 'etc...\nEnd With\n\nDoCmd.OpenForm \"FormName\", acNormal, , , acFormPropertySettings, acWindowNormal, oneString\n</code></pre>\n\n<h2>Update 2:</h2>\n\n<p>Place this in a Standard Module:</p>\n\n<pre><code>Private mArrValues() As Variant\n\n'ArrayValues\nPublic Property Get ArrayValues() As Variant\n    ArrayValues = mArrValues()\nEnd Property\n\n'Add value to array\nPublic Sub AddToArrayValues(ByVal index As Integer, value As String)\n    ReDim Preserve mArrValues(0 To index)\n    mArrValues(index) = value\nEnd Sub\n\n'Erase\nPublic Sub EraseArrayValues()\n    Erase mArrValues\nEnd Sub\n</code></pre>\n\n<p>You can add values to the array like this:</p>\n\n<pre><code>Module1.AddToArrayValues 0, \"Thomas\"\nModule1.AddToArrayValues 1, \"Henry\"\nModule1.AddToArrayValues 2, \"Bob\"\n</code></pre>\n\n<p>You can retrieve values by index:</p>\n\n<pre><code>Dim i As Integer\nFor i = LBound(Module1.ArrayValues) To UBound(Module1.ArrayValues)\n    Debug.Print Module1.ArrayValues(i)\nNext i\n\n'Thomas\n'Henry\n'Bob\n</code></pre>\n\n<p>Do forget you need to erase the array before refilling it:</p>\n\n<pre><code>Module1.EraseArrayValues\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8092330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5c72acbc1a54f0d7256eb0bf090445?s=128&d=identicon&r=PG&f=1", "display_name": "el furetto", "link": "https://stackoverflow.com/users/8092330/el-furetto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 44293032, "answer_count": 1, "score": -2, "last_activity_date": 1496322534, "creation_date": 1496238037, "last_edit_date": 1496308634, "question_id": 44286402, "link": "https://stackoverflow.com/questions/44286402/how-to-do-a-global-string-array-in-vba", "title": "How to do a global string array in vba?", "body": "<p>i'm working on access and i need to send strings from one form to another, so i'd like to use a string() but the application don't want it.</p>\n\n<p>Any suggestions ?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I have a form with 2 text box, each text box will take data with the same syntax, like textbox1:\"JOHN\" textbox2: \"DAVID\"\nI have and add button for each text box who stock each value in different array.\nThe adds buttons are checking if the value of each textbox exists in 2 differents tables, table1 for textbox1 and table2 for textbox2.\nIf it exists i need to keep them until a user press an other button who load a second form.\nThe user can set an infinite numbers of value in each text box, by pressing add when he set a new value.</p>\n\n<p>And when i load this second form i need to keep the values who exists in each table but separatly for to load in 2 subform some datas based on each values.</p>\n\n<p>All is working except i don't know how to pass 2 arrays from form 1 to form 2, array 1 with values of textbox1, and array 2 with values from textbox2</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496238203, "post_id": 44286343, "comment_id": 75579664, "body": "You&#39;ve included <code>ED</code> within the string, so it&#39;s reading it exactly as <code>ED</code>.  Try changing the line to <code>DoCmd.ApplyFilter , &quot;[Avtalsslut] &lt; &quot; &amp; ED</code>."}, {"owner": {"reputation": 23, "user_id": 8035819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebadd607046e386c5bea410d81dbb2f?s=128&d=identicon&r=PG&f=1", "display_name": "Merpz", "link": "https://stackoverflow.com/users/8035819/merpz"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496238462, "post_id": 44286343, "comment_id": 75579857, "body": "I did what you suggested, but it makes the entire form blank"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496239065, "post_id": 44286343, "comment_id": 75580312, "body": "That&#39;ll suggest the filter is working, but the filter value isn&#39;t holding the correct value for the field.  Access can be problematic with dates - parts of it uses the local date settings, while others are always US date standard.  Try changing the line to <code>DoCmd.ApplyFilter , &quot;[Avtalsslut] &lt; &quot; &amp; CLng(ED)</code>.  On my test I added <code>AM = 1</code> and <code>AD = DateValue(&quot;10 March 2017&quot;)</code>.  The filter returned the one record that had a date less than 10th April 2017."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1496239284, "post_id": 44286343, "comment_id": 75580473, "body": "@DarrenBartrup-Cook That is not the right way to do it. See <a href=\"http://allenbrowne.com/ser-36.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-36.html</a> for working properly with international dates in queries/filters. Use <code>DoCmd.ApplyFilter , &quot;[Avtalsslut] &lt; #&quot; &amp; Format$(ED, &quot;\\#mm\\&#47;dd\\&#47;yyyy\\#&quot;) &amp; &quot;#&quot;</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1496239463, "post_id": 44286343, "comment_id": 75580598, "body": "Thanks for the correction @Erik.  I always forget how to properly deal with dates in Access."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496239715, "post_id": 44286343, "comment_id": 75580811, "body": "Quick update - <code>DoCmd.ApplyFilter , &quot;[Avtalsslut] &lt; #&quot; &amp; Format$(ED, &quot;\\#mm\\&#47;dd\\&#47;yyyy\\#&quot;) &amp; &quot;#&quot;</code> returns an error (<code>Syntax error (missing operator) in query expression &#39;[Avtalsslut] &lt; ##04&#47;10&#47;2017##&#39;.</code>).  Use <code>DoCmd.ApplyFilter , &quot;[Avtalsslut] &lt;  #&quot; &amp; Format(ED, &quot;mm\\&#47;dd\\&#47;yyyy&quot;) &amp; &quot;#&quot;</code> (3rd bullet point in section 2 on link Erik provided)."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1496245888, "post_id": 44286343, "comment_id": 75585367, "body": "You have added an extra # around the dates the date string should be #mm/dd/yyyy#"}, {"owner": {"reputation": 23, "user_id": 8035819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebadd607046e386c5bea410d81dbb2f?s=128&d=identicon&r=PG&f=1", "display_name": "Merpz", "link": "https://stackoverflow.com/users/8035819/merpz"}, "edited": false, "score": 0, "creation_date": 1496293455, "post_id": 44286343, "comment_id": 75603286, "body": "Hi! Thanks for all the help! -&gt; DoCmd.ApplyFilter , &quot;[Avtalsslut] &lt; #&quot; &amp; Format(ED, &quot;mm\\/dd\\/yyyy&quot;) &amp; &quot;#&quot; as Darren suggested in the &quot;quick update&quot; works perfectly!"}], "owner": {"reputation": 23, "user_id": 8035819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ebadd607046e386c5bea410d81dbb2f?s=128&d=identicon&r=PG&f=1", "display_name": "Merpz", "link": "https://stackoverflow.com/users/8035819/merpz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496237887, "creation_date": 1496237887, "question_id": 44286343, "link": "https://stackoverflow.com/questions/44286343/ms-access-docmd-applyfilter-does-not-get-the-value-from-my-variable", "title": "Ms Access DoCmd.ApplyFilter does not get the value from my variable", "body": "<p>I have a table with leased vehicles and i am trying to make a form where you can filter out which vehicles expire in less than x months. What I did was this:</p>\n\n<pre><code>Option Compare Database\nPrivate Sub butFilterTruck_Click()\n    Dim ED As Date\n    Dim AM As Integer\n    Dim AD As Date\n\n    AM = txtM.Value\n    AD = txtDate.Value\n\n    ED = DateAdd(\"m\", AM, AD)\n\n    DoCmd.ApplyFilter , \"[Avtalsslut] &lt; ED\"\n\nEnd Sub\n</code></pre>\n\n<p>When I click the \"filter\" button access prompts me to enter a value for ED... Why is that?</p>\n\n<p>The filter works if I add a date when access asks for it.\nI appreciate any help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1496257147, "post_id": 44285434, "comment_id": 75591807, "body": "have you tried any of the solution below ? any feedback ?"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "edited": false, "score": 0, "creation_date": 1496236027, "post_id": 44285587, "comment_id": 75578002, "body": "Thank you very much that worked! Still new to VBA so I appreciate the help"}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 0, "last_activity_date": 1496235744, "creation_date": 1496235744, "answer_id": 44285587, "question_id": 44285434, "link": "https://stackoverflow.com/questions/44285434/refreshing-user-form-textbox-with-vba/44285587#44285587", "title": "Refreshing User Form Textbox with VBA", "body": "<p>You are using the wrong object. Instead of <code>Private Sub date_txtb_Change()</code> you should use <code>Private Sub shift_cbox_Change()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1496235956, "creation_date": 1496235956, "answer_id": 44285661, "question_id": 44285434, "link": "https://stackoverflow.com/questions/44285434/refreshing-user-form-textbox-with-vba/44285661#44285661", "title": "Refreshing User Form Textbox with VBA", "body": "<p>You need to enter your code on the <code>Change</code> event of your Combo-Box, also you can use <code>Select Case</code> to have a clearer and shorter code, which will also allow you more versatility to add more scenarios in the future (if you needed to).</p>\n\n<pre><code>Private Sub shift_cbox_Change()\n\nSelect Case shift_cbox.Value\n    Case \"Shift 1\", \"Shift 2\"\n        date_txtb.Text = Format(Now(), \"MM/DD/YY\") 'Current Date\n\n    Case \"Shift 3\"\n        date_txtb.Text = Format(Now() - 1, \"MM/DD/YY\") 'Current Date -1\n\n    Case Else\n        'do nothing , or something for future scenario\n\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7889757, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/d5713e71c44aba9ccf99f0599c542168?s=128&d=identicon&r=PG&f=1", "display_name": "accortdr", "link": "https://stackoverflow.com/users/7889757/accortdr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 712, "favorite_count": 0, "accepted_answer_id": 44285587, "answer_count": 2, "score": 0, "last_activity_date": 1496235956, "creation_date": 1496235333, "question_id": 44285434, "link": "https://stackoverflow.com/questions/44285434/refreshing-user-form-textbox-with-vba", "title": "Refreshing User Form Textbox with VBA", "body": "<p>I have a UserForm that has a textbox that is populated from the <code>=Now()</code> function. However the data I am tracking runs on a 3 shift schedule, so \"3rd shift\" will technically be entering their data on next day. I have adjusted for this using an if statement, but my problem is getting my textbox to update on the change of a combo box that allows you to select what shift you're entering for. I tried the DoEvents function at the suggestion from another helpsite, but it did not work. Thanks in advance!</p>\n\n<p><code>Private Sub date_txtb_Change()\n If shift_cbox.Text = \"Shift 1\" Then\n    date_txtb.Text = Format(Now(), \"MM/DD/YY\") 'Current Date\n    DoEvents</code></p>\n\n<pre><code>ElseIf shift_cbox.Text = \"Shift 2\" Then\ndate_txtb.Text = Format(Now(), \"MM/DD/YY\") 'Current Date\nDoEvents\n\nElseIf shift_cbox.Text = \"Shift 3\" Then\ndate_txtb.Text = Format(Now() - 1, \"MM/DD/YY\") 'Current Date -1\nDoEvents\n\nElse\n'do nothing'\n\nEnd If\n</code></pre>\n\n<p><code>End Sub</code>.          </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 0, "creation_date": 1496235283, "post_id": 44285349, "comment_id": 75577411, "body": "Impossible to accurately diagnose problem without seeing the patient. Paste the code."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496235427, "post_id": 44285349, "comment_id": 75577517, "body": "Are these two workbooks opening in <code>Protected View</code> or <code>Read-Only</code> ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1496235562, "post_id": 44285349, "comment_id": 75577601, "body": "Neither is &quot;Code does not work&quot; a valid/good error description (So please <a href=\"https://stackoverflow.com/posts/44285349/edit\">edit</a> your question and add the error message) nor can anyone say whats wrong with your code if you don&#39;t show it (So please <a href=\"https://stackoverflow.com/posts/44285349/edit\">edit</a> your question and add your macro code)."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "edited": false, "score": 0, "creation_date": 1496236777, "post_id": 44285349, "comment_id": 75578582, "body": "I have added the code! thank you!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496237368, "post_id": 44285349, "comment_id": 75579032, "body": "Did you that those two workbooks have a worksheet name &quot;Feuil1&quot;? and, what is the value of <code>i</code> when it breaks? Besides, why do you keep opening then closing the workbook <code>destFullpath</code>? This is not good practice. Open it once then close it when finished with it."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 0, "creation_date": 1496237599, "post_id": 44285349, "comment_id": 75579195, "body": "@KoderM16 I have posted the code! but the problem is not with my code, as it works for 50 at once! the problem is with the 2 excel workbooks no?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1496237699, "post_id": 44285349, "comment_id": 75579278, "body": "When you keep opening/closing the same WB (<code>destFullpath</code>) for more than 50 times, expect trouble. Try to open it once then close it at the end."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496237784, "post_id": 44285349, "comment_id": 75579355, "body": "Either something broke when you pasted or I don&#39;t see how this could ever work. You have <code>&#39;Loop through each Excel file in folder</code>, <code>Set y = Workbooks.Open(destFullpath)</code>, <code>For i = 1 To y.Sheets(&quot;Feuil1&quot;).Range(&quot;M1&quot;)</code>, <code>Do Events</code> (which is unnecessary, but being a courteous Win citizen), <code>Set y = Workbooks.Open(destFullpath)</code>. You open a workbook, start a loop through all the worksheets, then attempt to open it again. I&#39;m going to assume that was a copy-pasta error and you need to repost your code."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496237905, "post_id": 44285349, "comment_id": 75579458, "body": "@A.S.H it breaks when i is equal to the emplacement of those 2, they are at the end of the serie. To be clear I have tried with 11 samples including those 2, the code breaks and so on the destination excel (the result column) I have 9 only!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1496237961, "post_id": 44285349, "comment_id": 75579502, "body": "Further to what @A.S.H said, there is no loop through the files in the folder! You open <code>Set y = Workbooks.Open(destFullpath)</code> where <code>destFullpath</code> is a fixed value."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496238014, "post_id": 44285349, "comment_id": 75579540, "body": "@FreeMan the destination WB is the same, but the formula gets computed from those different files."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496238228, "post_id": 44285349, "comment_id": 75579685, "body": "@A.S.H how can I do that? to open it and close it at the end? destFullpath is  the same but  I have 50 different myfile! that&#39;s why i have made a loop For! (I don&#39;t understand! )"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496238261, "post_id": 44285349, "comment_id": 75579703, "body": "By the way, you&#39;re not opening <code>myFile</code> so you have to provide it&#39;s path along with its name in the formula. I wonder how this worked for another workbooks but basically it should be: <code>.Formula = &quot;=&#39;&quot; &amp; myPath &amp; &quot;[&quot; &amp; myFile &amp; &quot;]Para RF&#39;!L2&quot;</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496238388, "post_id": 44285349, "comment_id": 75579796, "body": "No, your <code>destFullpath</code> is the same, both in the code and in the problem description: <i>&quot;from multiple workbooks and paste it into a destination workbook &quot;</i>. What is changing within the loop is the <b>source</b> file <code>myFile</code>."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496238655, "post_id": 44285349, "comment_id": 75580021, "body": "@A.S.H but  <code>myFile = Dir(myPath &amp; myExtension)</code> so if I write <code>.Formula = &quot;=&#39;&quot; &amp; myPath &amp; &quot;[&quot; &amp; myFile &amp; &quot;]Para RF&#39;!L2&quot;</code> it will be like writing my path twice! right?"}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496238804, "post_id": 44285349, "comment_id": 75580124, "body": "@A.S.H you are right! haha! sorry! i edited it but you didn&#39;t see!"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496238993, "post_id": 44285349, "comment_id": 75580273, "body": "remove the second occurrence of <code>Set y = Workbooks.Open(destFullpath)</code> and move the statement <code>y.Close saveChanges:=True</code> to after the end of the loop (the <code>Next</code> statement)."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496239359, "post_id": 44285349, "comment_id": 75580521, "body": "@A.S.H I tried it <code>.Formula = &quot;=&#39;&quot; &amp; myPath &amp; &quot;[&quot; &amp; myFile &amp; &quot;]Para RF&#39;!L2&quot; </code>the code breaks at once!"}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "edited": false, "score": 0, "creation_date": 1496239712, "post_id": 44285349, "comment_id": 75580806, "body": "The Problem is NOT in the code!! the problem is with the 2 excels workbooks! because everything work except when I have those 2 included in &quot;myfile&quot;!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496239996, "post_id": 44285349, "comment_id": 75581019, "body": "If the problem isn&#39;t in the code, then tell us what error message you&#39;re getting when you attempt to open those 2 workbooks. Is it only and <i>always</i> those two? Do you get the same error if if&#39;s only those 2 in the folder you&#39;re parsing? Can you create a copy of one of the &quot;working&quot; workbooks and make it the 51st one and see if it works OK with that many? You&#39;ve written very difficult to read code, you&#39;ve got people trying to help you and you&#39;re yelling at them when they try. That doesn&#39;t make people very willing to try to help further..."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496240077, "post_id": 44285349, "comment_id": 75581080, "body": "@UGP these two workbooks open in  Read-Only! i have unprotected them!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1496240145, "post_id": 44285349, "comment_id": 75581124, "body": "I would speculate that it&#39;s because you&#39;re using the poorly named <code>y</code> as the <code>workbook</code> variable to hold <code>destFullPath</code>, then you&#39;re opening <code>destFullPath</code> again (while it was already open), and assigning it again to <code>y</code>. If this is not the actual, breaking code, but a sample to show us the issues, it&#39;s not a very good sample."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496240303, "post_id": 44285349, "comment_id": 75581248, "body": "@FreeMan I am not yelling at all, I am very greatfull for your help! I am saying the problem is not in the code because the code works always and everytime with any number!  the code breaks only and always with those 2!"}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496241645, "post_id": 44285349, "comment_id": 75582288, "body": "@FreeMan I wish I can post screen shots to show you what i mean! maybe i am not clear as i am not english native :("}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496241845, "post_id": 44285349, "comment_id": 75582423, "body": "@FreeMan yes, the problem is with those 2 workbooks. I am 100% certain that the layout is identical! I can open them normally like the others! the code breaks means that when having those 2 with the others, the code runs when i is different from those 2 and when i is equal to one of them the process stops! for those 2 I am not getting any result =&gt; blank!"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496241947, "post_id": 44285349, "comment_id": 75582524, "body": "I apologize - you have given us the error message <code>1004</code> and the line it happens on. My bad - reading failure on my part. Again, my apologies! In that case, my guess would be an issue with the file name you&#39;re trying to open. Why don&#39;t you tell us what that file name is."}, {"owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496242049, "post_id": 44285349, "comment_id": 75582603, "body": "@FreeMan i have one workbook that i can&#39;t open when clicking on it (there is a problem with it) but this one doesn&#39;t stop or break the code. the process continues and it gives <code>#REF!</code> instead of blank as for the 2 famous workbooks"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1496242683, "post_id": 44285349, "comment_id": 75583101, "body": "You&#39;re getting <code>#REF</code> because the value of <code>myFile</code> provided in the formula is invalid (blank) because you&#39;re getting an error when you&#39;re trying to execute <code>myFile = Dir(myPath &amp; myExtension)</code>. Again, since this is the place where you&#39;re getting the error, and it only happens with these two files, <i>what are the names of the files that cause the problem</i>? My bet is that there is something in the file name like a <code>&quot;</code>, or perhaps, since English isn&#39;t your native tongue, there&#39;s a unicode character in there that VBA is choking on."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496242788, "post_id": 44285349, "comment_id": 75583175, "body": "It&#39;s hard to correlate the code with the question, since the code clearly doesn&#39;t do what you claim it does. Please <a href=\"https://stackoverflow.com/posts/44285349/edit\">edit</a> your post to remove the fluff, clarify the problem statement and include an actual <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that demonstrates and reproduces the problem. Continuing this comment thread is useless, if you want help you need to clarify your post."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496254277, "post_id": 44285349, "comment_id": 75590239, "body": "When you are saying its in Read-Only and NOT protected View then they are opened somewhere else, you might want to look in the taskmanager for invisible excel applications and close them."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1496245160, "creation_date": 1496245160, "answer_id": 44289093, "question_id": 44285349, "link": "https://stackoverflow.com/questions/44285349/my-code-runs-and-works-on-some-excel-workbooks-but-not-all-of-them-why-vba/44289093#44289093", "title": "my code runs and works on some excel workbooks but not all of them, why? VBA", "body": "<p>You're not iterating 50 <em>workbooks</em>. You're iterating 50 <em>file names</em>.</p>\n\n<pre><code>.Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!L2\"\n</code></pre>\n\n<p>Error 1004 on this line means <code>myFile</code> somehow contains invalid characters, or (more likely) that there is no worksheet named <code>Para RF</code> in that workbook.</p>\n\n<p>Try typing <code>='[that file name.xlsx]Para RF'!L2</code> directly in a cell (in any workbook). You'll see this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/FhdMg.png\" alt=\"A formula in this worksheet contains one or more invalid references. Verify that your formula contains a valid path, workbook, range name, and cell reference.\"></p>\n\n<p>So, <em>Verify that your formula contains a valid path, workbook, range name, and cell reference.</em></p>\n\n<p>If there <em>is</em> such a <code>Para RF</code> sheet in the failing workbook, make sure there's no leading/trailing spaces.</p>\n"}], "owner": {"reputation": 13, "user_id": 8085581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/92dcf21fe08c61d00ceab6b3c7f7a705?s=128&d=identicon&r=PG&f=1", "display_name": "S.Mag", "link": "https://stackoverflow.com/users/8085581/s-mag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496245160, "creation_date": 1496235082, "last_edit_date": 1496240602, "question_id": 44285349, "link": "https://stackoverflow.com/questions/44285349/my-code-runs-and-works-on-some-excel-workbooks-but-not-all-of-them-why-vba", "title": "my code runs and works on some excel workbooks but not all of them, why? VBA", "body": "<p>I have a weird problem with my code VBA.</p>\n\n<p>I am using excel 2010, i wrote a code which works perfectly on multiple source except some.</p>\n\n<p>my code object is to copy the same cell from the same sheet from multiple workbooks and paste it into a destination workbook as a column.</p>\n\n<p>My code runs on 50 workbooks without any problem, except 2.\nNotice that those 2 are the same sample as the others, but of course different values.\nIf I ad those 2 workbooks with the other 50, I have an error message 'Error of execution'1004' and I should then stop the process.\nthe yellow line stand on a the formula :\n<code>myFile = Dir(myPath &amp; myExtension)\n    Set y = Workbooks.Open(destFullpath)</code></p>\n\n<pre><code>    `With y.Sheets(\"Feuil1\").Range(\"A\" &amp; i + 1)\n        **.Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!L2\" 'date** \n        .Value = .Value\n        y.Sheets(\"Feuil1\").Range(\"A\" &amp; i + 1).NumberFormat = \"dd/mm/yy;@\"  ' &lt;-- to specify that it is a date format\n\n    End With`\n</code></pre>\n\n<p>Do you have an idea why can this problem occur? \nwhat should i do? Is there anything to change with the settings etc?</p>\n\n<p>Note That I have tried to save those 2 as excel without macros, so xlsx and did not run.\nI tried to unprotect the sheets: did not run\nI broke the link between them and other one: this didn't help either!!!</p>\n\n<p>what can it be??</p>\n\n<p>Thank you!!</p>\n\n<p>This is the entire code :</p>\n\n<pre><code>Sub LoopAllExcelFilesInFolderr()\n'PURPOSE: To loop through all Excel files in a user specified folder and \nperform a set task on them\n\n\nDim wb As Workbook\nDim myPath As String\nDim myFile As String\nDim destFullpath As String\nDim myExtension As String\nDimFldrPicker As FileDialog\nDim y As Workbook\nDim i As Integer\n\n'Optimize Macro Speed\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlCalculationManual\n'Application.DisplayAlerts = False\n\n'Retrieve Target Folder Path From User\n\nmyPath = \"Z:\\VBA\\para_macro\\\"\ndestFullpath = \"Z:\\VBA\\base-macro.xlsx\"\nIf myPath = \"\" Then GoTo ResetSettings\n\n'Target File Extension (must include wildcard \"*\")\nmyExtension = \"*.xls*\"\n\n'Target Path with Ending Extention\nmyFile = Dir(myPath &amp; myExtension)\n\n\n'Loop through each Excel file in folder\nSet y = Workbooks.Open(destFullpath)\n\nFor i = 1 To y.Sheets(\"Feuil1\").Range(\"M1\")\n\n\n'Ensure Workbook has opened before moving on to next line of code\n  DoEvents\n\n\n\n\n\n\n    With y.Sheets(\"Feuil1\").Range(\"A\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!L2\" 'date devis\n        .Value = .Value\n        y.Sheets(\"Feuil1\").Range(\"A\" &amp; i + 1).NumberFormat = \"dd/mm/yy;@\"  ' &lt;-- to specify that it is a date format\n\n    End With\n\n\n    With y.Sheets(\"Feuil1\").Range(\"B\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!E11\" 'date d'installation\n        .Value = .Value\n\n\n    End With\n\nWith y.Sheets(\"Feuil1\").Range(\"c\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!H5\" 'type\n        .Value = .Value\n\n\n    End With\n\n    With y.Sheets(\"Feuil1\").Range(\"D\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!H8\" 'montant final\n        .Value = .Value\n        .NumberFormat = \"0.000\"\n\n    End With\n\n    With y.Sheets(\"Feuil1\").Range(\"E\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!K8\" 'montant tarif\n        .Value = .Value\n        .NumberFormat = \"0.000\"\n\n    End With\n\n     With y.Sheets(\"Feuil1\").Range(\"F\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!K10\" 'remise\n        .Value = .Value\n         .NumberFormat = \"0.000\"\n\n    End With\n\n    With y.Sheets(\"Feuil1\")\n        .Range(\"G2:G\" &amp; .Cells(.Rows.count, \"F\").End(xlUp).Row).Formula = \"=$F2/$E2\"\n    y.Sheets(\"Feuil1\").Range(\"G2:G\" &amp; .Cells(.Rows.count, \"F\").End(xlUp).Row).NumberFormat = \"0.00%\"\n\n    End With\n\n    With y.Sheets(\"Feuil1\").Range(\"H\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!D6\" 'soci\u00e9t\u00e9\n        .Value = .Value\n\n\n    End With\n\n    With y.Sheets(\"Feuil1\").Range(\"I\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!F8\" 'ville\n        .Value = .Value\n\n\n    End With\n\n\n    With y.Sheets(\"Feuil1\").Range(\"J\" &amp; i + 1)\n        .Formula = \"='\" &amp; \"[\" &amp; myFile &amp; \"]Para RF'!G5\" 'nom vendeur\n        .Value = .Value\n\n\n    End With\n\n\n'Ensure Workbook has closed before moving on to next line of code\n  DoEvents\n\n'Get next file name\n  myFile = Dir()\n\nNext\n'Save and Close Workbook\n\n  y.Close saveChanges:=True\n'Message Box when tasks are completed\nMsgBox \"Task Complete!\"\n\nResetSettings:\n'Reset Macro Optimization Settings\nApplication.EnableEvents = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1496234711, "post_id": 44285139, "comment_id": 75577005, "body": "your <code>newTBArray</code> is a 2-D array, if you want to print the entire second dimension, you need to loop through it, you can just use <code>newTBArray(2)</code> as if it was a single dimension array"}, {"owner": {"reputation": 51, "user_id": 5053335, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fdd6ae76b70cd80368c60836a609871b?s=128&d=identicon&r=PG&f=1", "display_name": "modhorat", "link": "https://stackoverflow.com/users/5053335/modhorat"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1496235918, "post_id": 44285139, "comment_id": 75577898, "body": "Thanks, understood...  thus <code>Debug.Print newTBArray(2,1)</code> works,  Is there any way to input a <code>Range</code> into a single-dimension array?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1496235986, "post_id": 44285139, "comment_id": 75577962, "body": "Yes, use <code>Application.Transpose(Range...)</code>"}], "owner": {"reputation": 51, "user_id": 5053335, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fdd6ae76b70cd80368c60836a609871b?s=128&d=identicon&r=PG&f=1", "display_name": "modhorat", "link": "https://stackoverflow.com/users/5053335/modhorat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496234516, "creation_date": 1496234516, "last_edit_date": 1531161705, "question_id": 44285139, "link": "https://stackoverflow.com/questions/44285139/display-values-in-dynamic-array-run-time-error-9-subscript-out-of-range", "title": "Display Values in Dynamic Array - Run-time error &#39;9&#39; (Subscript out of Range)", "body": "<p>I have a dynamic array, when attempting to print it, I receive the error:</p>\n\n<blockquote>\n  <p>Run-time error '9':</p>\n  \n  <p>Subscript out of Range</p>\n</blockquote>\n\n<p>I have the following code:</p>\n\n<pre><code>Dim newTBArray As Variant\nnewTBArray = Range(newTBSheet.Cells(2, 1), newTBSheet.Cells(lastRow, 1)).Value\n\nDebug.Print newTBArray(2)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496234660, "post_id": 44285085, "comment_id": 75576957, "body": "Do you want to change the url for each row?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 1, "creation_date": 1496234897, "post_id": 44285085, "comment_id": 75577151, "body": "Why don&#39;t you just use a <code>For</code> loop?"}, {"owner": {"reputation": 11, "user_id": 8091976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5dc345c5d2ba550a23e831f72caae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Vondra", "link": "https://stackoverflow.com/users/8091976/jan-vondra"}, "edited": false, "score": 0, "creation_date": 1496234954, "post_id": 44285085, "comment_id": 75577175, "body": "yes, i need to change url (example from <a href=\"http://wwwinfo.mfcr.cz/cgi-bin/ares/darv_std.cgi?obchodni_firma=\" rel=\"nofollow noreferrer\">wwwinfo.mfcr.cz/cgi-bin/ares/darv_std.cgi?obchodni_firma=</a>&quot; &amp; Sheets(1).Range(&quot;C2&quot;) to <a href=\"http://wwwinfo.mfcr.cz/cgi-bin/ares/darv_std.cgi?obchodni_firma=\" rel=\"nofollow noreferrer\">wwwinfo.mfcr.cz/cgi-bin/ares/darv_std.cgi?obchodni_firma=</a>&quot; &amp; Sheets(1).Range(&quot;C3&quot;)"}, {"owner": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 1, "creation_date": 1496235078, "post_id": 44285085, "comment_id": 75577264, "body": "Is <code>FaTruelse</code> actually a thing?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 897, "user_id": 7857211, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YqTB-VQ2ASI/AAAAAAAAAAI/AAAAAAAABEg/l0NMo4nonOg/photo.jpg?sz=128", "display_name": "David G", "link": "https://stackoverflow.com/users/7857211/david-g"}, "edited": false, "score": 0, "creation_date": 1496235920, "post_id": 44285085, "comment_id": 75577899, "body": "@David G it&#39;s the new way of writing alternative truths - just wrap it in falsehoods."}], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496234962, "creation_date": 1496234962, "answer_id": 44285291, "question_id": 44285085, "link": "https://stackoverflow.com/questions/44285085/repeating-excel-macro-command-1000-rows/44285291#44285291", "title": "Repeating Excel Macro Command 1000 rows", "body": "<p>This is untested:</p>\n\n<pre><code>Sub ares()\n\nApplication.ScreenUpdating = False 'potlac\u00ed obnovov\u00e1n\u00ed obrazovky\nApplication.DisplayAlerts = False 'potlac\u00ed varovn\u00e9 hl\u00e1\u0161ky\n\nSheets.Add(After:=Sheets(Sheets.Count)).Name = \"ares\"\nSheets(\"ares\").Activate 'presun na tento nov\u00fd list\n\nFor i = 2 To 1002\n    ActiveWorkbook.XmlImport URL:=\"http://wwwinfo.mfcr.cz/cgi-bin/ares/darv_std.cgi?obchodni_firma=\" &amp; Sheets(1).Range(\"C \" &amp; i).Value, ImportMap:=Nothing, Overwrite:=True, Destination:=Range(\"$A$1\")\n\n    Sheets(1).Range(\"A\" &amp; i) = Sheets(\"ares\").Range(\"AK3\")\n\n    Cells.Select\n    Selection.ClearContents\n    Range(\"A1\").Select\nNext i\n\n\nSheets(\"ares\").Delete 'smaz\u00e1n\u00ed pomocn\u00e9ho listu\n\nApplication.ScreenUpdating = True 'zapne obnovov\u00e1n\u00ed obrazovky\nApplication.DisplayAlerts = True 'obnov\u00ed varovn\u00e9 hl\u00e1\u0161ky\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8091976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5dc345c5d2ba550a23e831f72caae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Vondra", "link": "https://stackoverflow.com/users/8091976/jan-vondra"}, "is_accepted": false, "score": 1, "last_activity_date": 1496237064, "creation_date": 1496237064, "answer_id": 44286055, "question_id": 44285085, "link": "https://stackoverflow.com/questions/44285085/repeating-excel-macro-command-1000-rows/44286055#44286055", "title": "Repeating Excel Macro Command 1000 rows", "body": "<p>This is tested. Thanky you</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub ares()\r\n\r\n\r\n\r\n\r\n\r\nFor i = 14 To 17\r\n    Application.ScreenUpdating = False 'potlac\u00ed obnovov\u00e1n\u00ed obrazovky\r\n    Application.DisplayAlerts = False 'potlac\u00ed varovn\u00e9 hl\u00e1\u0161ky\r\n    Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"ares\"\r\n    Sheets(\"ares\").Activate 'presun na tento nov\u00fd list\r\n    ActiveWorkbook.XmlImport URL:=\"http://wwwinfo.mfcr.cz/cgi-bin/ares/darv_std.cgi?obchodni_firma=\" &amp; Sheets(1).Range(\"C\" &amp; i).Value, ImportMap:=Nothing, Overwrite:=True, Destination:=Range(\"$A$1\")\r\n\r\n    Sheets(1).Range(\"D\" &amp; i) = Sheets(\"ares\").Range(\"AK3\")\r\n\r\n    Cells.Select\r\n    Selection.ClearContents\r\n    Range(\"A1\").Select\r\n    Sheets(\"ares\").Delete 'smaz\u00e1n\u00ed pomocn\u00e9ho listu\r\n    Application.ScreenUpdating = True 'zapne obnovov\u00e1n\u00ed obrazovky\r\n    Application.DisplayAlerts = True 'obnov\u00ed varovn\u00e9 hl\u00e1\u0161ky\r\nNext i\r\n\r\n\r\n\r\n\r\n\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 11, "user_id": 8091976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5dc345c5d2ba550a23e831f72caae1e?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Vondra", "link": "https://stackoverflow.com/users/8091976/jan-vondra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496237064, "creation_date": 1496234356, "last_edit_date": 1496234420, "question_id": 44285085, "link": "https://stackoverflow.com/questions/44285085/repeating-excel-macro-command-1000-rows", "title": "Repeating Excel Macro Command 1000 rows", "body": "<p>I have 1000 rows in sheet and have this macro:</p>\n\n<pre><code>Sub ares()\n\nApplication.ScreenUpdating = False 'potla\u010d\u00ed obnovov\u00e1n\u00ed obrazovky\nApplication.DisplayAlerts = False 'potla\u010d\u00ed varovn\u00e9 hl\u00e1\u0161ky\n\nSheets.Add(After:=Sheets(Sheets.Count)).Name = \"ares\"\nSheets(\"ares\").Activate 'p\u0159esun na tento nov\u00fd list\n\n'XML dotaz do ARESU s t\u00edm, \u017ee i\u010do m\u00e1me na prvn\u00ed listu v bu\u0148ce C2 a importovn\u00e1 data chceme vlo\u017eit do bu\u0148ky A1\nActiveWorkbook.XmlImport URL:=\"http://wwwinfo.mfcr.cz/cgi-bin/ares/darv_std.cgi?obchodni_firma=\" &amp; Sheets(1).Range(\"C2\").Value, ImportMap:=Nothing, Overwrite:=True, Destination:=Range(\"$A$1\")\n\nSheets(1).Activate \nSheets(1).Range(\"A2\") = Sheets(\"ares\").Range(\"AK3\") \nSheets(\"ares\").Delete 'smaz\u00e1n\u00ed pomocn\u00e9ho listu\n\nApplication.ScreenUpdating = True 'zapne obnovov\u00e1n\u00ed obrazovky\nApplication.DisplayAlerts = FaTruelse 'obnov\u00ed varovn\u00e9 hl\u00e1\u0161ky\n\nEnd Sub\n</code></pre>\n\n<p>I would like to repeat this task over the range of 1000 rows, instead of what is shown above.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 368, "user_id": 7405312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Wz1uhBTOyxw/AAAAAAAAAAI/AAAAAAAAA5o/JlT31wBSGM0/photo.jpg?sz=128", "display_name": "SQLserving", "link": "https://stackoverflow.com/users/7405312/sqlserving"}, "edited": false, "score": 0, "creation_date": 1496235876, "post_id": 44285240, "comment_id": 75577857, "body": "Thanks for the feedback. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 2, "last_activity_date": 1496234800, "creation_date": 1496234800, "answer_id": 44285240, "question_id": 44285051, "link": "https://stackoverflow.com/questions/44285051/vba-lookup-function/44285240#44285240", "title": "VBA Lookup function", "body": "<p>Try something like this...</p>\n\n<pre><code>Sub GetClasses()\nDim wsSource As Worksheet, wsDest As Worksheet\nDim lr1 As Long, lr2 As Long\nApplication.ScreenUpdating = False\nSet wsSource = Sheets(\"Sheet1\")\nSet wsDest = Sheets(\"Sheet2\")\nlr1 = wsSource.Cells(Rows.Count, 1).End(xlUp).Row\nlr2 = wsDest.Cells(Rows.Count, 1).End(xlUp).Row\nwsDest.Range(\"B2:B\" &amp; lr2).Formula = \"=LOOKUP(A2,'\" &amp; wsSource.Name &amp; \"'!$A$2:$A$\" &amp; lr1 &amp; \",'\" &amp; wsSource.Name &amp; \"'!$B$2:$B$\" &amp; lr1 &amp; \")\"\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 368, "user_id": 7405312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Wz1uhBTOyxw/AAAAAAAAAAI/AAAAAAAAA5o/JlT31wBSGM0/photo.jpg?sz=128", "display_name": "SQLserving", "link": "https://stackoverflow.com/users/7405312/sqlserving"}, "edited": false, "score": 0, "creation_date": 1496237060, "post_id": 44285535, "comment_id": 75578808, "body": "Thanks for the quick intro to R1C1. Your first two points made way more sense than many of the websites I&#39;ve gone through. Will be learning more about it for sure. It is relatively elegant."}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": false, "score": 2, "last_activity_date": 1496235962, "last_edit_date": 1496235962, "creation_date": 1496235616, "answer_id": 44285535, "question_id": 44285051, "link": "https://stackoverflow.com/questions/44285051/vba-lookup-function/44285535#44285535", "title": "VBA Lookup function", "body": "<p>R1C1 reference style is a bit strange at first, but you should try to understand it if you are going to do VBA.</p>\n\n<p>Square brackets denote relative reference, no brackets mean absolute reference:</p>\n\n<p><code>R1C4</code> = Row 1, Column 4 = <code>$D$1</code><br>\n<code>R[1]C[-2]</code> = Relative to where the formula is, 1 Row down and 2 Columns to the left.<br>\n<code>[0]</code> becomes nothing, so <code>R[0]C[1]</code> would actually become <code>RC[1]</code>, meaning same row, one column to the right.</p>\n\n<p>So in your case, the formula should look like this:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n    \"=LOOKUP(RC[-1],Sheet1!R2C1:R[4]C[-1],Sheet1!R2C2:R[4]C)\"\n</code></pre>\n\n<p>You can have Excel display formulas like this, it might help understand how this formula type works. In File/Options/Formulas, tick \"R1C1 Reference Style\".</p>\n\n<p>Alternatively you can use <code>.Formula</code> instead of <code>.FormulaR1C1</code> as @sktneer did. It is easier at first, though you will find it is more limited in its uses in VBA.</p>\n"}], "owner": {"reputation": 368, "user_id": 7405312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Wz1uhBTOyxw/AAAAAAAAAAI/AAAAAAAAA5o/JlT31wBSGM0/photo.jpg?sz=128", "display_name": "SQLserving", "link": "https://stackoverflow.com/users/7405312/sqlserving"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "accepted_answer_id": 44285240, "answer_count": 2, "score": 1, "last_activity_date": 1496235962, "creation_date": 1496234272, "last_edit_date": 1496234883, "question_id": 44285051, "link": "https://stackoverflow.com/questions/44285051/vba-lookup-function", "title": "VBA Lookup function", "body": "<p>I have a table in sheet1 of a workbook like this:  </p>\n\n<pre><code>section  |  Class  \n11       |  2  \n11       |  2  \n12       |  3  \n12       |  3  \n12       |  3  \n13       |  4\n</code></pre>\n\n<p>On sheet 2 I have something like this:  </p>\n\n<pre><code>section  |  Class  \n11       |    \n11       |   \n11       |  \n11       |  \n11       |  \n11       |   \n12       |    \n12       |    \n12       |  \n12       |  \n12       |    \n13       |  \n</code></pre>\n\n<p>I want to use the lookup function in sheet2 to get the value for Class from sheet1 and this is the macro that is generated for the first cell only:  </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n        \"=LOOKUP(RC[-1],Sheet1!RC[-1]:R[4]C[-1],Sheet1!RC:R[4]C)\"\n</code></pre>\n\n<p>My actual formula is:  </p>\n\n<pre><code>=LOOKUP(A2,Sheet1!A2:A6,Sheet1!B2:B6)\n</code></pre>\n\n<p>I would want it to be like:  </p>\n\n<pre><code>=LOOKUP(A2,Sheet1!$A$2:A6,Sheet1!$B$2:B6)\n</code></pre>\n\n<p>but this not allowed.\nCould anybody help me fill in the Class column?</p>\n"}, {"tags": ["vba", "ms-word", "event-handling"], "answers": [{"tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1496313175, "creation_date": 1496313175, "answer_id": 44305179, "question_id": 44284920, "link": "https://stackoverflow.com/questions/44284920/vba-event-handler-for-checking-cells-in-a-table-in-word/44305179#44305179", "title": "VBA event handler for checking cells in a table in Word", "body": "<p>Only the built-in events can be handled in Word. There are no specific events for either tables or bookmarks. The only event that gets you anywhere close is the WindowSelectionChange event which fires each time the selection is changed, i.e. each time the insertion point is moved.</p>\n"}], "owner": {"reputation": 1, "user_id": 8076166, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b4ae86726ad34bbd286ad31992c005?s=128&d=identicon&r=PG&f=1", "display_name": "LParks", "link": "https://stackoverflow.com/users/8076166/lparks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496313175, "creation_date": 1496233942, "question_id": 44284920, "link": "https://stackoverflow.com/questions/44284920/vba-event-handler-for-checking-cells-in-a-table-in-word", "title": "VBA event handler for checking cells in a table in Word", "body": "<p>I have a table in Word:\n<a href=\"https://i.stack.imgur.com/Nrlns.jpg\" rel=\"nofollow noreferrer\">Table Example</a>  \uf0fc   \uf0fc   \uf0fc   \uf0fc       \uf0fc   \uf0fc   </p>\n\n<p>Table is bookmarked in the document, as it can appear in different places in the document.  I access the table using the bookmark like this:</p>\n\n<p>Set Tbl = ActiveDocument.Bookmarks(\"bookmarkname\").Range.Tables(1)</p>\n\n<p>I have a script that checks if a cell has a checkmark and displays a Msgbox when it has a checkmark and shouldn\u2019t, based on certain criteria of the Row and Column name.</p>\n\n<p>Here\u2019s the question:</p>\n\n<p>I would like this script to fire by a Cell_OnLeave type of event, so that when user leaves a cell, script will run. Is this possible?</p>\n\n<p>If this is not possible, I would like the script to fire when user leaves the table, and script can check the whole table?  Maybe a bookmark_deselected event would work for that?  How could this be done?</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "edited": false, "score": 0, "creation_date": 1496753922, "post_id": 44291279, "comment_id": 75781080, "body": "Hi, no I am not using a single merged cell."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "edited": false, "score": 0, "creation_date": 1496758898, "post_id": 44291279, "comment_id": 75784827, "body": "Sounds weird.  I&#39;ll update my answer.  Try the script above."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1496758940, "last_edit_date": 1496758940, "creation_date": 1496251991, "answer_id": 44291279, "question_id": 44284887, "link": "https://stackoverflow.com/questions/44284887/vba-macro-not-working-for-certain-cells/44291279#44291279", "title": "VBA Macro not working for certain cells", "body": "<p>Maybe this...</p>\n\n<pre><code>Sub Macro1()\n\nDim strDelimiter As String\nstrDelimiter = \",\"\n\n    Selection.TextToColumns Destination:=ActiveCell.Range(\"A1\"), DataType:=xlDelimited, _\n    TextQualifier:=xlSingleQuote, ConsecutiveDelimiter:=False, Tab:=False, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar:=strDelimiter, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "is_accepted": false, "score": 0, "last_activity_date": 1502844898, "last_edit_date": 1502844898, "creation_date": 1502721849, "answer_id": 45677150, "question_id": 44284887, "link": "https://stackoverflow.com/questions/44284887/vba-macro-not-working-for-certain-cells/45677150#45677150", "title": "VBA Macro not working for certain cells", "body": "<p>I found the problem. It was the array within text to columns. Since what I was working on was dates, the array needed to be Array(1, 4) instead of Array(1, 1).</p>\n"}], "owner": {"reputation": 13, "user_id": 8091887, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/49ca9b9a7b9816d066a2c63bf241d1f3?s=128&d=identicon&r=PG&f=1", "display_name": "PaulRey", "link": "https://stackoverflow.com/users/8091887/paulrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1502844898, "creation_date": 1496233840, "question_id": 44284887, "link": "https://stackoverflow.com/questions/44284887/vba-macro-not-working-for-certain-cells", "title": "VBA Macro not working for certain cells", "body": "<p>I currently export information into Excel on a daily basis. Certain days of the month are missing, so I've been creating a macro to add them. The macro works fine, but I have to convert the text that excel doesn't recognise into actual text. I use \"Text to Columns\" for this. I created the following macro:</p>\n\n<pre><code>Sub ejemplo()\n'\n' ejemplo Macro\n'\n\n\nDim i As Integer\ni = 2\n\nDo\nCells(1, i).Select\n\nSelection.TextToColumns Destination:=Cells(1, i), DataType:=xlDelimited, _\n    TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n    Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _\n    :=Array(1, 1), TrailingMinusNumbers:=True\n\ni = i + 1\nLoop Until ActiveCell = \"\"\n\nEnd Sub\n</code></pre>\n\n<p>The macro works fine for the first 10 or so columns (depending on which export I am trying to use it on), but then it simply runs over the cell and performs no action. If i do it manually it works, it's only when I do it from the macro that it doesn't.</p>\n\n<p>I have tried copying the information and transfering to other sheets, but nothing seems to work. The format of these cells is the same as the ones where the macro works.</p>\n\n<p>I hope someone can help.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496235550, "post_id": 44284624, "comment_id": 75577593, "body": "So lets say the data of the named range starts in column B, so your green checkmark ( a shape?) would be in column A?"}, {"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "reply_to_user": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496237388, "post_id": 44284624, "comment_id": 75579056, "body": "correct, the check mark symbols which are &quot;P&quot; are in the column to the left of the master list."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1496237724, "post_id": 44285769, "comment_id": 75579302, "body": "thank you UGP, I knew it must&#39;ve been a simple flip of a line but I couldn&#39;t see it. Works perfectly."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 1, "last_activity_date": 1496237862, "last_edit_date": 1496237862, "creation_date": 1496236248, "answer_id": 44285769, "question_id": 44284624, "link": "https://stackoverflow.com/questions/44284624/populate-range-with-values-from-one-column-based-on-values-in-another/44285769#44285769", "title": "populate range with values from one column based on values in another", "body": "<p>Its pasting everything in the same row, because you didnt calculate the lastrow with every new value.</p>\n\n<pre><code>Sub Macro3()\nDim lastrow As Long, ws As Worksheet\nSet ws = Sheets(\"named content\")\nDim c As Range\nFor Each c In Range(\"MasterList\").Offset(, -1).Cells\n    If c = \"P\" Then\n        lastrow = ws.Range(\"F\" &amp; Rows.Count).End(xlUp).Row + 1\n        ws.Range(\"F\" &amp; lastrow).Value = c.Offset(, 1)\n    End If\nNext c\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "edited": false, "score": 0, "creation_date": 1496237978, "post_id": 44285884, "comment_id": 75579513, "body": "It&#39;s a webdings 2 check mark which is a capital P. I wanted to take the value in the column to the right of each &quot;P&quot; and populate a third column with each of those values. Which I had for the most part but it was dropping the values in the same cell. many thanks for the idea though."}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496236539, "creation_date": 1496236539, "answer_id": 44285884, "question_id": 44284624, "link": "https://stackoverflow.com/questions/44284624/populate-range-with-values-from-one-column-based-on-values-in-another/44285884#44285884", "title": "populate range with values from one column based on values in another", "body": "<p>This is not an exact fix, but might get you started in the right direction.  I'm assuming that your green check mark is a shape.  I don't know what type of shape it is, so you will have to change the line for that.  I used \"Right Arrow\" shapes to substitute.  It should put all the \"checked\" row numbers into an array that you can then use to get the data from those rows.</p>\n\n<pre><code>Public Sub LoopThroughShapes()\nDim Shape As Shape, myArray() As Variant, arrayCounter As Long\n\nReDim myArray(1 To 1)\narrayCounter = 1\nFor Each Shape In ActiveSheet.Shapes\n    If InStr(1, Shape.Name, \"Right Arrow\") &lt;&gt; 0 Then\n        Shape.Select\n        Debug.Print Shape.Name, Shape.TopLeftCell.Row\n        ReDim Preserve myArray(1 To arrayCounter)\n        myArray(arrayCounter) = Shape.TopLeftCell.Row\n        arrayCounter = arrayCounter + 1\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 44285769, "answer_count": 2, "score": 0, "last_activity_date": 1496241696, "creation_date": 1496233102, "last_edit_date": 1531161705, "question_id": 44284624, "link": "https://stackoverflow.com/questions/44284624/populate-range-with-values-from-one-column-based-on-values-in-another", "title": "populate range with values from one column based on values in another", "body": "<p>Happy hump day all,\nI'm hoping to get some help with this macro that I'm fairly certain has an easy solution but I'm missing a key factor.</p>\n\n<p><strong>scenario:</strong> I've got a named range that populates the combobox of a userform, I want to allow a user to add or remove choices from this range so the userform only contains choices for what they are working on <em>(in a user friendly fashion for the non excel savvy)</em>. There is a \"master list\" that contains dozens of choices to choose from, to the left of the list I've added a worksheet event on double click which adds a green check mark, indicating the item is selected.</p>\n\n<p><strong>goal:</strong> after making selections from the master list, I want the user to click a button which will run a macro to identify where there is a check mark to the left of the list and add the corresponding value to the named range on the next available row.</p>\n\n<p><strong>issue:</strong> my attempt at looping through each \"P\" (webdings 2 checkmark) and adding the value to the right is technically working but it is adding the values to the same cell resulting in only the last item checked off to remain.</p>\n\n<p>how can I loop through each \"P\" and add it to a row separately?</p>\n\n<pre><code>Sub Macro3()\nDim lastrow As Long, ws As Worksheet\nSet ws = Sheets(\"named content\")\nlastrow = ws.Range(\"F\" &amp; Rows.Count).End(xlUp).Row + 1\nDim c As Range\nFor Each c In Range(\"MasterList\").Offset(, -1).Cells\n    If c = \"P\" Then\n    ws.Range(\"F\" &amp; lastrow).Value = c.Offset(, 1)\n      End If\nNext c\nEnd Sub\n</code></pre>\n\n<p>I've played around with a few alterations and all end up with the same or similar result. Any help would be immensely appreciated! in the mean time I think I will attempt to add and remove each value when the check marks are added and see if that works better.</p>\n\n<p><strong>EDIT:</strong>   All; UGP answered my question perfectly but thought I would share the workaround I was going to use. </p>\n\n<p>Whereas the original code identifies each checked value and adds them to the column upon running the macro, this worksheet event adds the value to the named range column upon double clicking to add the check mark next to the value in the master list, and likewise; removes the value from the named range column when the check mark is removed:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\nDim lastrow As Long, ws As Worksheet\nSet ws = Sheets(\"named content\")\nlastrow = ws.Range(\"F\" &amp; Rows.Count).End(xlUp).Row + 1\nIf Not Intersect(Target, Range(\"MasterList\").Offset(, -1)) Is Nothing Then\n        Application.EnableEvents = False\n        If ActiveCell.Value = \"P\" Then\n            ActiveCell.ClearContents\n            For c = lastrow To 3 Step -1\n            If ws.Cells(c, 6).Value = ActiveCell.Offset(, 1) Then\n            Cells(c, 6).Delete Shift:=xlUp\n            End If\n            Next\n\n        Else\n            ActiveCell.Value = \"P\"\n            ws.Range(\"F\" &amp; lastrow).Value = ActiveCell.Offset(, 1)\n        End If\n        Cancel = True\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1496257574, "post_id": 44292434, "comment_id": 75592056, "body": "Yes I apologize, I should clear it up more.  There are two values separated by a blank cell, hence the range of 3 cells.  So that I understand yours correctly, what my goal is is to highlight the &quot;winner&quot; of each match up, and then highlight the &quot;best loser&quot; (IE the 4th seed) in a separate color"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1496408470, "post_id": 44292434, "comment_id": 75663198, "body": "how do I switch it so that the code can also work where the &quot;winning&quot; values are the smallest?  If I change the first greater than to a less than, I get the 3 lowest values, but if I switch the second greater than to a less than, I get an &quot;Object variable not set&quot; error on the maxcell.interior.color line.  If I change the maxcell to mincell (and also declare it) it does not work.  What am I missing?"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1496417435, "post_id": 44292434, "comment_id": 75668888, "body": "Not entirely sure what you&#39;re after. If you switch the 1st greater than sign, you&#39;ll highlight all the losers of each round.  With that change and to get the winner with the lowest time, you&#39;d have to set maxval to something like 999.9 initially and then change the second greater than to a less than sign."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1496421723, "post_id": 44292434, "comment_id": 75671213, "body": "In this example, the lower numbers are actually winners, not higher.  So 1, 2 and 3 would win out versus 4, 5 and 6, and 4 would be the &quot;best loser&quot;.  Switching the first sign gives me the lower winners, but it was that 4th winner I could not get"}, {"owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "reply_to_user": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1496423867, "post_id": 44292434, "comment_id": 75672308, "body": "Okay lower # is the winner - makes sense.  So what you&#39;re showing in your picture is that the winner of each round has a white background (losers have a dark green background).  You want the 4th placed person based on a sorted ranking from lowest to highest highlighted with a light green background?  If you can confirm, I can revise the code to get you that.  So as per your original problem statement you want 0:05:15 shown highlighted in light green?"}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1496425182, "post_id": 44292434, "comment_id": 75672978, "body": "Yes, so basically I have 7 different categories.  Some are times, some are whole number values, some are percentages.  Four of the categories, the higher values are better, and the other 3, lower are better.  So in my example, lower is actually the better value.  I just kept it at higher since I needed that code to work as well (albeit it for a different category).  In the above example, seed 6, 2 and 3 should win, with seed 5 as the 4th placed person.  I hope that makes sense."}, {"owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "edited": false, "score": 0, "creation_date": 1496684697, "post_id": 44292434, "comment_id": 75750296, "body": "That did it.  Thanks!"}], "tags": [], "owner": {"reputation": 1383, "user_id": 5981533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/688353da6deb0ac1d22eb9d42e032269?s=128&d=identicon&r=PG", "display_name": "Amorpheuses", "link": "https://stackoverflow.com/users/5981533/amorpheuses"}, "is_accepted": true, "score": 1, "last_activity_date": 1496429509, "last_edit_date": 1496429509, "creation_date": 1496256090, "answer_id": 44292434, "question_id": 44284608, "link": "https://stackoverflow.com/questions/44284608/excel-vba-conditional-highlighting-highlight-next-highest-value/44292434#44292434", "title": "Excel VBA - Conditional highlighting - highlight next highest value", "body": "<p>I'm not sure you'd be able to do what you're trying strictly with only conditional formatting.  I'd steer clear of them in this instance and just use regular vba.  Set 'rng' in this sub to the 1st cell of each set of times.  As per our discussion the lowest values are the winner for each pair.  Each loser's value is then checked to see whether it's the lower than the lowest value seen thus far; if it is then the 'minval' variable is updated with this value and the pointer to that cell, 'mincell', is also updated.</p>\n\n<pre><code>Sub OrgHighestAndNext1()\n\n    Dim rng As Range: Set rng = [C4,C9,C14]\n\n    Range(\"C\" &amp; rng.Row &amp; \":C\" &amp; rng.Areas(3).Rows.Row + 2).Interior.ColorIndex = xlColorIndexNone\n\n    Dim cell As Range, scell As Range, mincell As Range\n    Dim minval As Double: minval = 9999.9\n\n    For Each cell In rng\n      If cell.Value2 &lt; cell.Offset(2, 0).Value2 Then\n         cell.Interior.Color = 5296274\n         Set scell = cell.Offset(2, 0).Cells\n      Else\n         cell.Offset(2, 0).Interior.Color = 5296274\n         Set scell = cell.Cells\n      End If\n\n      If scell.Value2 &lt; minval Then\n        Set mincell = scell\n        minval = scell.Value2\n      End If\n    Next\n\n    mincell.Interior.Color = 10092492\nEnd Sub\n</code></pre>\n\n<p>Winners (lowest) value are given a background of dark green.  Loser background is left unchanged (white if worksheet was that way to begin with).  The lowest of the loser (what 'mincell' points to after all pairs have been processed) is given a color of light green.</p>\n\n<p>Speaking in terms of ranking based only on time from lowest to\nhighest the seeds are ranked like this: 2,3,5,6,4,1 so seed 6 is the\n4th ranked purely on time alone.  But if you rank first based on\nwinners times and then losers times the seeds are ranked like this:\n2,3,6 (these are winners) and 5,4,1 (losers).   What you're after is\nthis second type of ranking - in which you really don't care about\nthe winners but do want the losers ranked according to lowest time so\nyou can find the loser with the best (lowest) time.</p>\n"}], "owner": {"reputation": 375, "user_id": 7374176, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/9c1bfe06d0b4b4a56af1447b2f33c5f7?s=128&d=identicon&r=PG&f=1", "display_name": "sbagnato", "link": "https://stackoverflow.com/users/7374176/sbagnato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 44292434, "answer_count": 1, "score": 0, "last_activity_date": 1496429509, "creation_date": 1496233054, "last_edit_date": 1496314848, "question_id": 44284608, "link": "https://stackoverflow.com/questions/44284608/excel-vba-conditional-highlighting-highlight-next-highest-value", "title": "Excel VBA - Conditional highlighting - highlight next highest value", "body": "<p>I have code that takes 3 pairs of values, highlights the highest (or lowest values) and then is supposed to highlight the next highest (or lowest value), to provide a second round of 2 pairs to match up.</p>\n\n<p>While the code for highlighting the winner or the first 3 pairs could be a little cleaner (I went with above average, but maybe there is a way to just have it pick the highest value as opposed to the logic of above and below averages...), I cannot get the second part to work.  I went with the logic of formulating a top 10, which would provide me with that 4th value.  I don't get any error, and when I debug and try to print a value, I get nothing at all.</p>\n\n<pre><code>'Highlight winners of first round\n    Range(\"C4:C6\").Select\n    Selection.FormatConditions.AddAboveAverage\n    Selection.FormatConditions(1).AboveBelow = xlAboveAverage\n    Selection.FormatConditions(1).Interior.Color = 5296274\n    Range(\"C9:C11\").Select\n    Selection.FormatConditions.AddAboveAverage\n    Selection.FormatConditions(1).AboveBelow = xlAboveAverage\n    Selection.FormatConditions(1).Interior.Color = 5296274\n    Range(\"C14:C16\").Select\n    Selection.FormatConditions.AddAboveAverage\n    Selection.FormatConditions(1).AboveBelow = xlAboveAverage\n    Selection.FormatConditions(1).Interior.Color = 5296274\n\n'Highlight highest losing analyst\n    Range(\"C4:C16\").Select\n    If Selection.FormatConditions(1).Interior.Color &lt;&gt; 5296274 Then\n        Selection.FormatConditions.AddTop10\n        With Selection.FormatConditions\n            .TopBottom = xlTop10Top\n            .Rank = 10\n        End With\n        With Selection.FormatConditions.Interior\n            .Color = 10092492\n        End With\n    End If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tQwGI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tQwGI.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Any ideas on my issue?</p>\n\n<p>Edited: A screenshot was added to show what the file looks like after the script runs.  The winner of each matchup is shown, however, since the next round would also be head to head, I need the \"4th\" place person to be highlighted as well, in this case, person  B</p>\n"}, {"tags": ["vba", "excel", "passwords"], "answers": [{"comments": [{"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1496233464, "post_id": 44284108, "comment_id": 75576082, "body": "Thank you for that answer. I guess it will work also without it, I do not want to bother with it for too long. have a great day!"}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 1, "last_activity_date": 1496231636, "creation_date": 1496231636, "answer_id": 44284108, "question_id": 44283819, "link": "https://stackoverflow.com/questions/44283819/unlocking-a-vba-project-with-vba-knowing-the-password/44284108#44284108", "title": "unlocking a vba project with vba, knowing the password?", "body": "<p>Thats not possible. The Password is not exposed in the VBA Object, so you cant directly access it trough VBA Code. There is only a method to send the keys for the password, but i wouldnt recommend it. </p>\n"}], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 44284108, "answer_count": 1, "score": 0, "last_activity_date": 1496231636, "creation_date": 1496230871, "question_id": 44283819, "link": "https://stackoverflow.com/questions/44283819/unlocking-a-vba-project-with-vba-knowing-the-password", "title": "unlocking a vba project with vba, knowing the password?", "body": "<p>I think that question has been asked in different ways. But I didn't found a satisfying solution. I want to unlock a VBA-project using vba code. Possibly something like the .unprotect method for workbooks or -sheets. I know the password, I do not need to crack open the project. </p>\n\n<p>Is there a simple way to realise this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496231037, "post_id": 44283646, "comment_id": 75574178, "body": "Seems like you are adressing the index and not the value try <code>ItemReq = Sheets(&quot;Main&quot;).Ent_ListBox.Selected(lItem).Value</code>"}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496231968, "post_id": 44283646, "comment_id": 75574961, "body": "No, I tried .Value method and it didn&#39;t work for me."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 1, "creation_date": 1496234325, "post_id": 44283646, "comment_id": 75576727, "body": "ItemReq = Sheets(&quot;Main&quot;).Ent_ListBox.List(lItem)"}], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": true, "score": 1, "last_activity_date": 1496233143, "creation_date": 1496233143, "answer_id": 44284639, "question_id": 44283646, "link": "https://stackoverflow.com/questions/44283646/get-selected-items-from-listbox-main-sheet-and-display-it-in-a-listbox-on-user/44284639#44284639", "title": "Get Selected items from Listbox (main sheet) and display it in a listbox on Userform - VBA", "body": "<p>So you need to use <code>ItemReq = Sheets(\"Main\").Ent_ListBox.List(lItem)</code> instead of <code>ItemReq = Sheets(\"Main\").Ent_ListBox.Selected(lItem)</code></p>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1560, "favorite_count": 0, "accepted_answer_id": 44284639, "answer_count": 1, "score": 0, "last_activity_date": 1496233143, "creation_date": 1496230386, "last_edit_date": 1531164843, "question_id": 44283646, "link": "https://stackoverflow.com/questions/44283646/get-selected-items-from-listbox-main-sheet-and-display-it-in-a-listbox-on-user", "title": "Get Selected items from Listbox (main sheet) and display it in a listbox on Userform - VBA", "body": "<p>I am trying to get the selected items from a listbox which is on the mainsheet and get those selected items inside a Listbox which is on a user form. </p>\n\n<p>This is the Code,</p>\n\n<pre><code>Sub Viewselectshow()\n\n For lItem = 0 To Sheets(\"Main\").Ent_ListBox.ListCount - 1\n\n        If Sheets(\"Main\").Ent_ListBox.Selected(lItem) = True Then\n\n            ItemReq = Sheets(\"Main\").Ent_ListBox.Selected(lItem)\n\n            ViewSelectedEntitlements.ViewEntitlementListbox.AddItem ItemReq\n\n        End If\n\n    Next\n\nViewSelectedEntitlements.Show\n\nEnd Sub\n</code></pre>\n\n<p>It works, But it shows a value of -1 in the Listbox on the Userform which is clearly not the Selected item. The Selected Item is a \"CaraPhone\". Any Suggestions, Kindly share your thoughts.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1496231641, "post_id": 44283622, "comment_id": 75574691, "body": "You&#39;ll know from all your Python questions that SO doesn&#39;t work this way. If you don&#39;t know any VBA, then this post and tag are a little pointless."}], "answers": [{"tags": [], "owner": {"reputation": 54, "user_id": 3322179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4621fa216266bf634b1bf6a570da6bac?s=128&d=identicon&r=PG&f=1", "display_name": "Urry", "link": "https://stackoverflow.com/users/3322179/urry"}, "is_accepted": true, "score": 0, "last_activity_date": 1496231135, "creation_date": 1496231135, "answer_id": 44283899, "question_id": 44283622, "link": "https://stackoverflow.com/questions/44283622/vba-macro-for-excel-mark-row-if-cells-in-column-a-are-the-same-but-different-in/44283899#44283899", "title": "VBA macro for excel. Mark row if cells in column A are the same but different in column C", "body": "<p>You do not really need macros to identify your rows.</p>\n\n<p>Simply put this formula in a new column</p>\n\n<pre><code>=COUNTIFS($A$1:$A$8,A1,$C$1:$C$8,\"&lt;&gt;\"&amp;C1)\n</code></pre>\n\n<p>Wherever there are different values in col C for same value of col A it will throw a 1 else 0</p>\n\n<p>If you want to highlight, I recommend using conditional formatting based on the value of your new column with (0/1) values.</p>\n\n<p>Hope this answers your query.</p>\n"}], "owner": {"reputation": 625, "user_id": 4436411, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/6b66bf0c4a5aa4a07949330163aea0a4?s=128&d=identicon&r=PG&f=1", "display_name": "MaciejPL", "link": "https://stackoverflow.com/users/4436411/maciejpl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 44283899, "answer_count": 1, "score": -1, "last_activity_date": 1496231135, "creation_date": 1496230332, "question_id": 44283622, "link": "https://stackoverflow.com/questions/44283622/vba-macro-for-excel-mark-row-if-cells-in-column-a-are-the-same-but-different-in", "title": "VBA macro for excel. Mark row if cells in column A are the same but different in column C", "body": "<p>I do not have any code yet as I dont know VBA that much or at all.\nI got excell sheet with 4 columns. Column A is main group and C is subgroups within groups from column A. </p>\n\n<p>i need to mark somehow rows where within same JobID, WFID is the same and where WFID is different within same JobID.</p>\n\n<pre><code>JobID   TaskID   WFID\n39822   913914  Complete\n39822   913915  no complete\n37941   905439  Complete\n37941   905440  Complete\n</code></pre>\n\n<p>Would you be able to help pleasE?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496238533, "post_id": 44283341, "comment_id": 75579919, "body": "Slicers can be connected to multiple pivot tables as long as they share a PivotCache. Since each set of PivotTables are based on a different Dataset, the PivotCaches will be different. If there are values that occur in one PivotCache, but not in the other, in the CostCentre field, you&#39;ll run into trouble. N.b. if you have access to / can use PowerPivot, that would instantly solve your problem, since there you can link the datasets."}, {"owner": {"reputation": 41, "user_id": 5152577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f14543ca93deaf3bf8fa107e509cd53?s=128&d=identicon&r=PG&f=1", "display_name": "LCousins", "link": "https://stackoverflow.com/users/5152577/lcousins"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496240578, "post_id": 44283341, "comment_id": 75581453, "body": "Indeed when I originally took on the task my plan hinged on power pivots, however it turns out our IT support function has removed the add in (all add ins, not just some random vendetta against power pivots!) and are unwilling to re-install any of them. Therefore my need to delve into the world of VBA which I know very little about :-)"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496241647, "post_id": 44283341, "comment_id": 75582289, "body": "If an item exists in the Slicer you wish to update, but not in the Slicer that was initially set (e.g. where you want to sync from), should that item be selected? And what if there&#39;s no items that are the same at all?"}, {"owner": {"reputation": 41, "user_id": 5152577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f14543ca93deaf3bf8fa107e509cd53?s=128&d=identicon&r=PG&f=1", "display_name": "LCousins", "link": "https://stackoverflow.com/users/5152577/lcousins"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496243053, "post_id": 44283341, "comment_id": 75583377, "body": "Im trying to think of a suitable analogy -   dataset 1 lists all rooms in a house, each room can have multiple rows as each one lists a past or present occupant (for the sake of the example all rooms in the house have had at least 1 occupant)  dataset 2 lists all the furniture in the rooms. a room can have multiple rows for multiple bits of furniture however not every room has any furniture.  the slicer in this analogy would be on room number. as such all room numbers appearing in the slicer for dataset 2 are guaranteed to be in the slicer for dataset 1 but not the other way around"}, {"owner": {"reputation": 41, "user_id": 5152577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f14543ca93deaf3bf8fa107e509cd53?s=128&d=identicon&r=PG&f=1", "display_name": "LCousins", "link": "https://stackoverflow.com/users/5152577/lcousins"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1496243156, "post_id": 44283341, "comment_id": 75583449, "body": "as such if on the primary slider I selected a room number not in the second dataset i would expect that pivot to not show any results. Thankyou for talking through it, apologies if I am not doing a good job of explaining"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 5152577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f14543ca93deaf3bf8fa107e509cd53?s=128&d=identicon&r=PG&f=1", "display_name": "LCousins", "link": "https://stackoverflow.com/users/5152577/lcousins"}, "edited": false, "score": 0, "creation_date": 1496300626, "post_id": 44288106, "comment_id": 75606500, "body": "Awesome, that has worked, nice and simple logic too thankyou very much!"}, {"owner": {"reputation": 113, "user_id": 2816820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a93779007b798404cc4b0717cbcdb0?s=128&d=identicon&r=PG&f=1", "display_name": "bs0d", "link": "https://stackoverflow.com/users/2816820/bs0d"}, "edited": false, "score": 0, "creation_date": 1525724176, "post_id": 44288106, "comment_id": 87460989, "body": "Is there a way to make selections in sc2 match what&#39;s selected from sc1, rather than (from appearances) loop and match all in sc2 that exist in sc1? So If i click an item (or multiple items) from sc1, sc2 would reflect the same selections where a match exists?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 113, "user_id": 2816820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a93779007b798404cc4b0717cbcdb0?s=128&d=identicon&r=PG&f=1", "display_name": "bs0d", "link": "https://stackoverflow.com/users/2816820/bs0d"}, "edited": false, "score": 0, "creation_date": 1525775710, "post_id": 44288106, "comment_id": 87480275, "body": "@bs0d No, not immediate; there&#39;s no array of only selected items available or anything like that. The answer is based on the fact that the two slicers don&#39;t share the same SlicerCache. If they do, the change is reflected automatically anyway."}, {"owner": {"reputation": 113, "user_id": 2816820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7a93779007b798404cc4b0717cbcdb0?s=128&d=identicon&r=PG&f=1", "display_name": "bs0d", "link": "https://stackoverflow.com/users/2816820/bs0d"}, "edited": false, "score": 0, "creation_date": 1525873651, "post_id": 44288106, "comment_id": 87527513, "body": "It&#39;s likely beyond the scope of this question, but you can in fact capture an array of selected slicer items and subsequently use that array to filter other tables as desired - all through VBA. The caveat being, you have one master slicer, and other slicers would not be necessary."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1525875121, "post_id": 44288106, "comment_id": 87528586, "body": "It is. However that array isn&#39;t available by default as far as I&#39;m aware. Even if there is a SelectedItems, you can&#39;t just pass is to another slicer cache like that. Manually building the array will save some looping on SC2 only."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 1, "last_activity_date": 1496242605, "creation_date": 1496242605, "answer_id": 44288106, "question_id": 44283341, "link": "https://stackoverflow.com/questions/44283341/excel-2010-vba-check-if-slicer-value-exists/44288106#44288106", "title": "Excel 2010 VBA - check if slicer value exists", "body": "<p>For starters: Altering the part with the loop as follows will not generate errors. If the item from slicer1 exists in the one you are updating, it will take the selection from the first slicer based on the name.</p>\n\n<pre><code>On Error Resume Next\nFor Each si1 In sc1.SlicerItems\n   Set si2 = sc2.SlicerItems(si1.Name)\n   If Not si2 Is Nothing Then\n        si2.Selected = si1.Selected\n    End If\nNext si1\nOn Error GoTo 0\n</code></pre>\n\n<p>However, items that are in the second slicer that aren't available in the first one, will be selected no matter what in this scenario, since you cleared the initial selection using <code>sc2.ClearManualFilter</code></p>\n\n<p>If you wish to invert that behaviour, use:</p>\n\n<pre><code>On Error Resume Next\nFor Each si2 In sc2.SlicerItems\n    Set si1 = sc1.SlicerItems(si2.Name)\n    If Not si1 Is Nothing Then\n        si2.Selected = si1.Selected\n    Else\n        si2.Selected = False\n    End If\nNext si2\nOn Error GoTo 0\n</code></pre>\n\n<p>In this case, if nothing is selected in the second slicer (since there are no matching items), no filter will be applied (select all).</p>\n\n<p>Of course you can also leave out the <code>sc2.ClearManualFilter</code> line: That way you will only trigger each item to be equal to slicer1 with the first option above. The rest of the selection will then stay as it was before the script was executed.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 41, "user_id": 5152577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f14543ca93deaf3bf8fa107e509cd53?s=128&d=identicon&r=PG&f=1", "display_name": "LCousins", "link": "https://stackoverflow.com/users/5152577/lcousins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2969, "favorite_count": 0, "accepted_answer_id": 44288106, "answer_count": 1, "score": 0, "last_activity_date": 1496242605, "creation_date": 1496229423, "last_edit_date": 1531164843, "question_id": 44283341, "link": "https://stackoverflow.com/questions/44283341/excel-2010-vba-check-if-slicer-value-exists", "title": "Excel 2010 VBA - check if slicer value exists", "body": "<p>I have a spreadsheet looking at multiple different details of an organisation. All fields are different in the different datasets apart from 'costcentre' which is present in all datasets.</p>\n\n<p>each dataset has its own set of pivot tables and slicers. I am looking to make the costcentre slicer for each table match a chosen slicer. </p>\n\n<p>I have made it work when both slicers have the same values but when the slicer being changed does not have the value of the chosen slicer it is selecting all values. Therefore I am trying to get it to check if a value exists before changing its state and getting it to move onto the next one if it does not (multiple values can be selected) but I cannot find a way of simply checking if a value exists and if not then move on to the next value in the for each bit of the code. Any advice on how to do that or a simpler way of achieving the original goal would be much appreciated</p>\n\n<p>Below is my VBA code. Please note I don't actually have any experience of VBA, this has been constructed from searching for answers on this site and copying bits that seemed relevant with a little bit of trial and error thrown in.</p>\n\n<pre><code>Sub test()\nDim sc1 As SlicerCache\nDim sc2 As SlicerCache\nDim si1 As SlicerItem\nDim si2 As SlicerItem\n\nSet sc1 = ThisWorkbook.SlicerCaches(\"Slicer_CC1\")\nSet sc2 = ThisWorkbook.SlicerCaches(\"Slicer_CC\")\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nsc2.ClearManualFilter\n\n\n\nFor Each si1 In sc1.SlicerItems\n        sc2.SlicerItems(si1.Name).Selected = si1.Selected\n        On Error Resume Next\nNext si1\n\n\n    MsgBox \"Update Complete\"\n\nclean_up:\n        Application.EnableEvents = True\n        Application.ScreenUpdating = True\n        Exit Sub\n\nerr_handle:\n        MsgBox Err.Description\n        Resume clean_up\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496230410, "post_id": 44283152, "comment_id": 75573741, "body": "<code>Range(slct)</code> should be just <code>slct</code>"}, {"owner": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496230581, "post_id": 44283152, "comment_id": 75573868, "body": "@Slai that worked! You should post it as answer."}], "answers": [{"comments": [{"owner": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "edited": false, "score": 0, "creation_date": 1496230115, "post_id": 44283301, "comment_id": 75573512, "body": "Please see the edited question for the full error message even after using <code>Set</code>"}], "tags": [], "owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "is_accepted": false, "score": 0, "last_activity_date": 1496229291, "creation_date": 1496229291, "answer_id": 44283301, "question_id": 44283152, "link": "https://stackoverflow.com/questions/44283152/vba-function-which-takes-a-range-parameter-as-input-and-returns-a-range/44283301#44283301", "title": "vba function which takes a range parameter as input and returns a range", "body": "<p>There is nothing wrong with your code. You should call it like,</p>\n\n<pre><code>Set rg = find_cell_range(Range(\"A1\", Range(\"A1\").End(xlToRight)), \"Col1\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "edited": false, "score": 0, "creation_date": 1496230077, "post_id": 44283309, "comment_id": 75573484, "body": "I have used <code>Set</code>, but I&#39;m still getting the error (edited the question to show the full error)"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "edited": false, "score": 0, "creation_date": 1496230218, "post_id": 44283309, "comment_id": 75573591, "body": "@StrikeR  If <b>Set</b> failed, that means the <b>Find()</b> failed!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1496229314, "creation_date": 1496229314, "answer_id": 44283309, "question_id": 44283152, "link": "https://stackoverflow.com/questions/44283152/vba-function-which-takes-a-range-parameter-as-input-and-returns-a-range/44283309#44283309", "title": "vba function which takes a range parameter as input and returns a range", "body": "<p>You must use <strong><em>Set</em></strong>:</p>\n\n<p><strong>UNTESTED</strong>:</p>\n\n<pre><code>Sub test_sub()\n\n    Dim rg as Range\n    Set rg = find_cell_range(Range(\"A1\", Range(\"A1\").End(xlToRight)), \"Col1\")\n    'Some code which uses Range variable rg\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "edited": false, "score": 0, "creation_date": 1496230686, "post_id": 44283674, "comment_id": 75573938, "body": "I&#39;m writing it as a separate function for the purpose of re-usability of code"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "edited": false, "score": 0, "creation_date": 1496230766, "post_id": 44283674, "comment_id": 75573991, "body": "But you can do that with the function itself, why make it more complicated than its already is."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "edited": false, "score": 0, "creation_date": 1496230872, "post_id": 44283674, "comment_id": 75574069, "body": "the only thing you would need to edit is <code>MatchCase:= True</code>"}, {"owner": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "edited": false, "score": 0, "creation_date": 1496231230, "post_id": 44283674, "comment_id": 75574329, "body": "Its true that this function is making it complicated, but I would see it as lesson to properly write and reuse the code. The first comment on the question helped me with the error."}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1496230472, "creation_date": 1496230472, "answer_id": 44283674, "question_id": 44283152, "link": "https://stackoverflow.com/questions/44283152/vba-function-which-takes-a-range-parameter-as-input-and-returns-a-range/44283674#44283674", "title": "vba function which takes a range parameter as input and returns a range", "body": "<p>I dont understand why u are calling the function in a function. Just use:</p>\n\n<pre><code>Sub Test()\nDim rg As Range\nDim LastRow As Long\nDim sht As Worksheet\n\nSet sht = Worksheets(\"Tabelle1\")\nLastRow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row\nSet rg = sht.Range(\"A1:A\" &amp; LastRow).Find(\"Col1\")\nEnd Sub\n</code></pre>\n\n<p>And now you can address <code>rg</code> like you want it from your function. </p>\n"}, {"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 0, "last_activity_date": 1496231056, "creation_date": 1496231056, "answer_id": 44283875, "question_id": 44283152, "link": "https://stackoverflow.com/questions/44283152/vba-function-which-takes-a-range-parameter-as-input-and-returns-a-range/44283875#44283875", "title": "vba function which takes a range parameter as input and returns a range", "body": "<p>You can catch the error using its number if that's what you want:</p>\n\n<pre><code>Sub test_sub()\n    Dim rg As Range\n    On Error Resume Next\n    Set rg = find_cell_range(Range(\"A1\", Range(\"A1\").End(xlToRight)), \"Col1\")\n    If Err.Number = 1004 Then\n        MsgBox \"Set range returns an error!\"\n        'you can exit sub, set a new range, or goto anywhere in your code\n    End If\n    'Some code which uses Range variable rg\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 1, "last_activity_date": 1496232040, "creation_date": 1496232040, "answer_id": 44284248, "question_id": 44283152, "link": "https://stackoverflow.com/questions/44283152/vba-function-which-takes-a-range-parameter-as-input-and-returns-a-range/44284248#44284248", "title": "vba function which takes a range parameter as input and returns a range", "body": "<p><code>Range()</code> accepts either a single string A1 reference, or 2 cell Range/String address.</p>\n\n<pre><code>Function find_cell_range(slct As Range, ByVal search_name As String) As Range\n\n    Set find_cell_range = slct.Find(What:=search_name, LookAt:=xlWhole, MatchCase:=True, SearchFormat:=False)\n\nEnd Function\n\n\nSub test_sub()\n\n    Dim rg as Range\n    rg = find_cell_range(Range(\"A1\", Range(\"A1\").End(xlToRight)), \"Col1\")\n\n    If Not rg Is Nothing Then\n        'Some code which uses Range variable rg\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1428, "user_id": 2787586, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/0jsm6.jpg?s=128&g=1", "display_name": "StrikeR", "link": "https://stackoverflow.com/users/2787586/striker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 44284248, "answer_count": 5, "score": 0, "last_activity_date": 1496232040, "creation_date": 1496228902, "last_edit_date": 1496229938, "question_id": 44283152, "link": "https://stackoverflow.com/questions/44283152/vba-function-which-takes-a-range-parameter-as-input-and-returns-a-range", "title": "vba function which takes a range parameter as input and returns a range", "body": "<p>I want to write a vba function which takes a range parameter as input and outputs the cell where it gets the match.</p>\n\n<pre><code>Function find_cell_range(slct As Range, ByVal search_name As String) As Range\n\n    Dim rg As Range\n    With Range(slct)\n         Set rg = .Find(What:=search_name, LookAt:=xlWhole, MatchCase:=True, SearchFormat:=False)\n    End With\n\n    Set find_cell_range = rg\n\nEnd Function\n\n\nSub test_sub()\n\n    Dim rg as Range\n    rg = find_cell_range(Range(\"A1\", Range(\"A1\").End(xlToRight)), \"Col1\")\n    'Some code which uses Range variable rg\n\nEnd Sub\n</code></pre>\n\n<p>With this, I'm sometimes getting  <code>Run-time error '1004': Method 'Range' of object '_Global' failed</code> error. How should I successfully pass the range that can be used in my function?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1496234267, "post_id": 44283132, "comment_id": 75576677, "body": "Not a comment on the question:  When adding code just paste all the code in, select the pasted code and click the Code Sample icon just above the text you entered - it&#39;s two curly brackets <code>{ }</code>.  You won&#39;t get the <i>enter code here</i> text then."}, {"owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1499860226, "post_id": 44283132, "comment_id": 77086789, "body": "The best way is to first check if file is updatable, if not use goto line # function."}], "owner": {"reputation": 159, "user_id": 5179321, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ec2c077f8c8bcb3d8313897477a568c?s=128&d=identicon&r=PG&f=1", "display_name": "Gaus Shaikh", "link": "https://stackoverflow.com/users/5179321/gaus-shaikh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496233903, "creation_date": 1496228838, "last_edit_date": 1531164843, "question_id": 44283132, "link": "https://stackoverflow.com/questions/44283132/multiuser-connections-with-access", "title": "Multiuser connections with access", "body": "<p>I am very new in Microsoft access and apologies for asking any incorrect question.</p>\n\n<p>I have a Excel VBA tool which is connected with Access. I just wanted to know as to how to handle the situation if multi user updating same recordset. Can we halt/wait till the recordset get closed by other user without letting the user know about background activities.</p>\n\n<p>Below coding is being used by me.</p>\n\n<pre><code>Dim Acon As New ADODB.Connection\nDim Rs As New ADODB.Recordset\n\n    With Acon\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n        .ConnectionString = \"Data Source=\" + myFileNameDir\n        .Open\n    End With\n\nWith Rs\n    .CursorLocation = adUseClient\n    .CursorType = adOpenDynamic\n    .LockType = adLockOptimistic\n    .ActiveConnection = Acon\n    .Source = \"Select * from Sheet1\"\n     .Open\nEnd With\n\nWith Rs\n  Rs.MoveFirst\n  While Not Rs.EOF\n    .Fields![status] = \"Refresher\"\n    .Fields![Reason for Refresh Training] = \"Refresher-\" &amp; myValuec\n    Rs.MoveNext\n  Wend\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "line", "vba"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3434943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e9fff67f9fe461948cdbdf8d8fcff7?s=128&d=identicon&r=PG&f=1", "display_name": "user3434943", "link": "https://stackoverflow.com/users/3434943/user3434943"}, "edited": false, "score": 0, "creation_date": 1496308459, "post_id": 44291839, "comment_id": 75611822, "body": "Thank you very much for the help. There is a code part which is not fully clear for me. <code>x = Split(txt, vbNewLine)     For i = 0 To UBound(x)         If Left(x(i), 4) = &quot;Band&quot; Then             y = x(i)         ElseIf Left(x(i), 6) = &quot;LZFmax&quot; Then             z = x(i)             Exit For         End If</code>   So vbLine option in split, splits entire file into lines and  numbers 4 and 6 are for checking if Band and LZF is in those lines ?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 21, "user_id": 3434943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e9fff67f9fe461948cdbdf8d8fcff7?s=128&d=identicon&r=PG&f=1", "display_name": "user3434943", "link": "https://stackoverflow.com/users/3434943/user3434943"}, "edited": false, "score": 0, "creation_date": 1496309371, "post_id": 44291839, "comment_id": 75612526, "body": "Yes <code>vbNewLine</code> splits the txt file into 9 Lines, the array <code>x</code> now contains 9 Elements. Now im going through each line and cutting the first 4(6) letters to see if they either <code>Band</code>or <code>LZFmax</code>. But its just like you said. If you have any other question, just ask :)"}], "tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 0, "last_activity_date": 1496309032, "last_edit_date": 1496309032, "creation_date": 1496253957, "answer_id": 44291839, "question_id": 44283084, "link": "https://stackoverflow.com/questions/44283084/excel-vba-read-specific-row-from-txt-file-through-selected-column-range/44291839#44291839", "title": "Excel VBA: Read specific row from txt file through selected column range", "body": "<p>So i took your raw data as input, had to modify it a bit for me to get it to work. I fixed some things and ended up with this code: </p>\n\n<pre><code>Private Sub Open_Click()\n    Dim fn As Variant, myLine As Long, txt As String\n    Dim i As Integer, x As Variant, y As Variant, z As Variant, c As Variant\n    Dim sht As Worksheet\n    Set sht = Worksheets(\"Tabelle1\") 'EDIT\n    fn = Application.GetOpenFilename(\"Text Files (*.txt),*.txt\", , _\n           \"Open File\")\n    If fn = False Then Exit Sub\n    txt = CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(fn).ReadAll\n    x = Split(txt, vbNewLine)\n    For i = 0 To UBound(x)\n        If Left(x(i), 4) = \"Band\" Then\n            y = x(i)\n        ElseIf Left(x(i), 6) = \"LZFmax\" Then\n            z = x(i)\n            Exit For\n        End If\n    Next i\n    y = Replace(y, \"  \", \" \")\n    y = Split(y, \" \")\n    z = Replace(z, \"  \", \" \")\n    z = Split(z, \" \")\n    c = 2\n    For i = 0 To UBound(y)\n        If y(i) &lt;&gt; \"\" And y(i) &lt;&gt; \"[Hz]\" And y(i) &lt;&gt; \"Band\" Then\n            sht.Cells(c, 3).Value = y(i)\n            c = c + 1\n        End If\n    Next i\n    c = 1\n    For i = 0 To UBound(z)\n        If z(i) &lt;&gt; \"\" Then\n            sht.Cells(c, 4).Value = z(i)\n            c = c + 1\n        End If\n    Next i\n    sht.Range(\"C1\").Value = \"Band [Hz]\"\nClose #1\nEnd Sub\n</code></pre>\n\n<p>Im not sure, how you planned to arrange the data in excel, but i just printed the scale and the data in two columns. Its searches in the textfile for the right lines (cut the first letter of each line and compares) and arranges the data in two arrays (not one because of the formatting, they have different lenghts) and print them out. The header of the first line was seperated into two elements so i ignored them and added the header for it later, to make it not that ugly. Here's the output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fSOaR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fSOaR.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 3434943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e9fff67f9fe461948cdbdf8d8fcff7?s=128&d=identicon&r=PG&f=1", "display_name": "user3434943", "link": "https://stackoverflow.com/users/3434943/user3434943"}, "edited": false, "score": 0, "creation_date": 1496310626, "post_id": 44302972, "comment_id": 75613543, "body": "Thank You very much. I tested this code and it works. But sometimes measurement device adds extra lines describing setup, before measurement results.  So this part of code is responsible for looking my required data ?  <code>If colIndex = 1 Then &#39;condition for Band Column                 arr = Split(CStr(LineText), &quot; &quot;)                 bandArr = GetArray(arr)             ElseIf colIndex = 5 Then &#39;condition for LZFMax Column</code>"}, {"owner": {"reputation": 21, "user_id": 3434943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e9fff67f9fe461948cdbdf8d8fcff7?s=128&d=identicon&r=PG&f=1", "display_name": "user3434943", "link": "https://stackoverflow.com/users/3434943/user3434943"}, "edited": false, "score": 0, "creation_date": 1496310835, "post_id": 44302972, "comment_id": 75613705, "body": "Sometimes data might look like this: <code># Hardware Configuration  \tDevice Info:    \tXL2, SNo. A2A-09994-E0, FW3.10  \tMic Type:       \tNTi Audio M4260, SNo. 5396, Factory adjusted   \tMic Sensitivity:\t32.0 mV&#47;Pa  \tTime Zone:      \tUTC+01:00 (Europe&#47;Berlin)  \tBand [Hz]\t6.3     \t8.0     \t10.0    \t12.5    \t16.0    \t20.0    \t25.0    \t31.5    \t40.0    \t50.0    \t63.0    \t80.0    \t100.0   \t125.0   \t160.0   \t200.0   \t250.0   \t315.0   \t400.0   \t500.0   \t630.0   \t800.0   \t1000.0  \t1250.0  \t1600.0  \t2000.0  \t2500.0  \t3150.0  \t4000.0  \t5000.0  \t6300.0  \t8000.0  \t10000.0 \t12500.0</code>"}, {"owner": {"reputation": 21, "user_id": 3434943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e9fff67f9fe461948cdbdf8d8fcff7?s=128&d=identicon&r=PG&f=1", "display_name": "user3434943", "link": "https://stackoverflow.com/users/3434943/user3434943"}, "edited": false, "score": 0, "creation_date": 1496310992, "post_id": 44302972, "comment_id": 75613813, "body": "So what I need to do is setup correctly colIndex values right?"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496311750, "post_id": 44302972, "comment_id": 75614365, "body": "<code>Band</code> and <code>[Hz]</code>are stored in 2 Elements so <code>LZFmax</code> Values are one index higher. It should be <code>ActiveSheet.Cells(rIndex, 2).Value = LZFMaxArr(j - 1)</code>. I dont know how it worked for you  with the decimal comparison that you get this output but i need to use <code>If bandArr(j) &gt;= 500 And bandArr(j) &lt;= 50000 Then</code> . Excel is weired sometimes."}, {"owner": {"reputation": 21, "user_id": 3434943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e9fff67f9fe461948cdbdf8d8fcff7?s=128&d=identicon&r=PG&f=1", "display_name": "user3434943", "link": "https://stackoverflow.com/users/3434943/user3434943"}, "edited": false, "score": 0, "creation_date": 1496312454, "post_id": 44302972, "comment_id": 75614886, "body": "Well I changed index values, opened file in notepad++ to see exact lines. It works. But data filled in excel cells has strange format, it has additional tab. So excel cant plot graphs or calculate"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 0, "last_activity_date": 1496307617, "creation_date": 1496307617, "answer_id": 44302972, "question_id": 44283084, "link": "https://stackoverflow.com/questions/44283084/excel-vba-read-specific-row-from-txt-file-through-selected-column-range/44302972#44302972", "title": "Excel VBA: Read specific row from txt file through selected column range", "body": "<p>Following should give you desired result.</p>\n\n<pre><code>Sub GetDataFromFile()\n    Dim colIndex As Long\n    Dim LineText As String\n    Dim bandArr, LZFMaxArr, arr\n    Dim fn As Variant\n    'Open \"C:\\Users\\Shiva\\Desktop\\t1.txt\" For Input As #24\n    fn = Application.GetOpenFilename(\"Text Files (*.txt),*.txt\", , _\n           \"Open File\")\n    If fn = False Then Exit Sub\n    Open fn For Input As #24\n    colIndex = 1\n    While Not EOF(24)\n        Line Input #24, LineText\n            If colIndex = 1 Then 'condition for Band Column\n                arr = Split(CStr(LineText), \" \")\n                bandArr = GetArray(arr)\n            ElseIf colIndex = 5 Then 'condition for LZFMax Column\n                arr = Split(CStr(LineText), \" \")\n                LZFMaxArr = GetArray(arr)\n            End If\n            colIndex = colIndex + 1\n    Wend\n    Close #24\n\n    Dim rIndex As Long\n    rIndex = 2\n    'display headers\n    ActiveSheet.Cells(1, 1).Value = bandArr(1)\n    ActiveSheet.Cells(1, 2).Value = LZFMaxArr(1)\n    'display column value where 50&lt;=Band&lt;=5000\n    For j = 2 To UBound(bandArr)\n        If bandArr(j) &gt;= 50 And bandArr(j) &lt;= 5000 Then\n            ActiveSheet.Cells(rIndex, 1).Value = bandArr(j)\n            ActiveSheet.Cells(rIndex, 2).Value = LZFMaxArr(j)\n            rIndex = rIndex + 1\n        End If\n    Next j\nEnd Sub\n\nPrivate Function GetArray(arr As Variant)\n    Dim destArr(), tempArr() As String\n    Dim rowIndex, index As Long\n    Dim temp As String\n    temp = \"\"\n    rowIndex = 1\n    For j = 1 To UBound(arr)\n        If Not arr(j - 1) = vbNullString Then\n            'add column values in a atring\n            temp = temp &amp; \",\" &amp; arr(j - 1)\n        End If\n    Next j\n    tempArr = Split(temp, \",\")\n\n    ReDim destArr(LBound(tempArr) To UBound(tempArr))\n    For index = LBound(tempArr) To UBound(tempArr)\n        'assign comma separated values to array\n        destArr(index) = tempArr(index)\n    Next index\n\n    GetArray = destArr\nEnd Function\n</code></pre>\n\n<p>This is the output I get from above code.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cnbRm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cnbRm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Let me know if anything is not clear.</p>\n"}], "owner": {"reputation": 21, "user_id": 3434943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21e9fff67f9fe461948cdbdf8d8fcff7?s=128&d=identicon&r=PG&f=1", "display_name": "user3434943", "link": "https://stackoverflow.com/users/3434943/user3434943"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2207, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496309032, "creation_date": 1496228728, "last_edit_date": 1531164843, "question_id": 44283084, "link": "https://stackoverflow.com/questions/44283084/excel-vba-read-specific-row-from-txt-file-through-selected-column-range", "title": "Excel VBA: Read specific row from txt file through selected column range", "body": "<p>I am new to excel vba scripting. What I need is get LZFmax data.<br>\nMeasurement Results</p>\n\n<pre><code>Band [Hz]   6.3         8.0         10.0        12.5        16.0        20.0        25.0        31.5        40.0        50.0        63.0        80.0        100.0       125.0       160.0       200.0       250.0       315.0       400.0       500.0       630.0       800.0       1000.0      1250.0      1600.0      2000.0      2500.0      3150.0      4000.0      5000.0      6300.0      8000.0      10000.0     12500.0     16000.0     20000.0 \n\n            [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]        [dB]    \n\nLZFmax      88.5        81.9        72.8        71.5        70.3        71.0        75.0        69.9        76.5        86.9        93.4        97.9        93.4        86.7        88.8        99.4        98.0        100.8       103.4       97.6        101.4       96.5        93.3        90.2        88.5        91.2        85.2        86.7        80.9        78.4        79.8        80.3        75.8        68.9        66.9        63.9    \n\nLZFmin      20.0        21.4        22.8        20.1        24.6        24.6        28.7        30.5        32.8        35.0        29.0        35.6        34.5        38.0        39.4        39.0        42.5        40.1        41.9        41.7        43.0        39.2        38.5        37.5        36.7        35.4        34.7        34.8        34.6        34.2        34.7        35.7        36.6        37.5        38.9        40.9    \n\nLZeq        61.8        56.8        46.8        46.7        49.1        55.5        49.4        47.5        56.2        69.0        75.3        79.4        75.2        70.7        72.7        76.7        78.8        79.0        79.2        78.6        81.3        78.5        75.2        70.5        70.9        70.0        67.2        68.2        63.6        62.7        57.5        57.4        53.7        51.8        47.8        53.9 \n</code></pre>\n\n<p><strong>I already have a code:</strong> </p>\n\n<pre><code>Public koef_k As Double\n\nPrivate Sub Open_Click()\n\nDim myFile As Variant, koef_k As Integer\nmyFile = Application.GetOpenFilename(\"Text Files (*.txt),*.txt\", , _\n           \"Select file\")\nIf myFile = False Then Exit Sub\n\nOpen myFile For Input As #1\nrow_number = 0\n\nDo Until EOF(1)\nLine Input #1, LineFromFile\n\nLineItems = Split(LineFromFile, vbTab)\n\nRange(\"C9\").Offset(row_number, 0).Value = LineItems(1)\n\nrow_number = row_number + 1\n\nLoop\n\nClose #1\n\nEnd Sub\n</code></pre>\n\n<p>which works for data format like this:</p>\n\n<pre><code>Band[Hz]    LZFmax                  \n50      51                  \n63      58                  \n80      60                  \n100     61                  \n125     63                  \n160     65                  \n200     66                  \n250     69                  \n315     73                  \n400     67                  \n500     65                  \n630     62                  \n800     60                  \n1000    58                  \n1250    55                  \n1600    51                  \n2000    48                  \n2500    42                  \n3150    39                  \n4000    36\n5000    32\n</code></pre>\n\n<p>How to modify this code that it will read only LZFmax line and go through Band [Hz] columns from 50 to 5000Hz?</p>\n\n<p><strong>Currently I found partial solution</strong> </p>\n\n<pre><code>Private Sub Open_Click()\n    Dim fn As Variant, myLine As Long, txt As String, i As Integer, x\n    fn = Application.GetOpenFilename(\"Text Files (*.txt),*.txt\", , _\n           \"Open File\")\n    If fn = False Then Exit Sub\n    myLine = 111 '&lt;- change to suite\n    txt = CreateObject(\"Scripting.FileSystemObject\").OpenTextFile(fn).ReadAll\n    x = Split(txt, vbTab)\n    'MsgBox x(myLine + 1)\n    row_number = 0\n    Range(\"C9\").Offset(row_number, 0).Value = x(myLine - 10)\n    i = 10\n    Do While i &lt; 31\n    Cells(i, \"C\").Value = x(myLine)\n    i = i + 1\n    myLine = myLine + 1\n    Loop\nClose #1\nEnd Sub\n</code></pre>\n\n<p>This code works as I want, only  myLine value is not very handy, because I had to find it manually.\nMaybe there is a better way to optimize this code?</p>\n"}, {"tags": ["excel", "file", "vba"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1496227352, "post_id": 44282502, "comment_id": 75571647, "body": "Change <code>strFil = Dir(strFolder &amp; &quot;\\*.xls*&quot;)</code> to <code>strFil = Dir(strFolder &amp; &quot;\\*.csv*&quot;)</code>"}, {"owner": {"reputation": 23, "user_id": 2017716, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e6d3fc6f8cb168bffefa61686297b88e?s=128&d=identicon&r=PG", "display_name": "user2017716", "link": "https://stackoverflow.com/users/2017716/user2017716"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1496227531, "post_id": 44282502, "comment_id": 75571779, "body": "where shall I put my macro in this code ?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 2017716, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e6d3fc6f8cb168bffefa61686297b88e?s=128&d=identicon&r=PG", "display_name": "user2017716", "link": "https://stackoverflow.com/users/2017716/user2017716"}, "edited": false, "score": 0, "creation_date": 1496231681, "post_id": 44282686, "comment_id": 75574717, "body": "Do I need to add the whole code or is there a way to provide the macro name or some sort of link ?"}, {"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "reply_to_user": {"reputation": 23, "user_id": 2017716, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e6d3fc6f8cb168bffefa61686297b88e?s=128&d=identicon&r=PG", "display_name": "user2017716", "link": "https://stackoverflow.com/users/2017716/user2017716"}, "edited": false, "score": 0, "creation_date": 1496234050, "post_id": 44282686, "comment_id": 75576528, "body": "Just use the name of the macro e.g. if your sub is called <code>import</code> simply add <code>import</code> with whichever parameters you need."}], "tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": true, "score": 2, "last_activity_date": 1496227665, "creation_date": 1496227665, "answer_id": 44282686, "question_id": 44282502, "link": "https://stackoverflow.com/questions/44282502/run-excel-macro-on-multiple-workbooks-files/44282686#44282686", "title": "Run Excel macro on multiple workbooks / files", "body": "<p>If you want to do something to the workbook you've opened your code will need to go after the <code>Workbooks.Open</code> function:</p>\n\n<pre><code>Sub OpenFilesVBA()\n\nDim Wb As Workbook\nDim strFolder As String\nDim strFil As String\n\nstrFolder = \"c:\\Temp\"\nstrFil = Dir(strFolder &amp; \"\\*.csv*\")\nDo While strFil &lt;&gt; vbNullString\n    Set Wb = Workbooks.Open(strFolder &amp; \"\\\" &amp; strFil)\n\n    'Add your code here\n\n    Wb.Close False\n    strFil = Dir\nLoop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 2017716, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e6d3fc6f8cb168bffefa61686297b88e?s=128&d=identicon&r=PG", "display_name": "user2017716", "link": "https://stackoverflow.com/users/2017716/user2017716"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "accepted_answer_id": 44282686, "answer_count": 1, "score": 0, "last_activity_date": 1496230952, "creation_date": 1496227175, "last_edit_date": 1531161705, "question_id": 44282502, "link": "https://stackoverflow.com/questions/44282502/run-excel-macro-on-multiple-workbooks-files", "title": "Run Excel macro on multiple workbooks / files", "body": "<p>I found this script to loop through workbooks within a folder.</p>\n\n<pre><code>Sub OpenFilesVBA()\n    Dim Wb As Workbook\n    Dim strFolder As String\n    Dim strFil As String\n\n    strFolder = \"c:\\Temp\"\n    strFil = Dir(strFolder &amp; \"\\*.xls*\")\n    Do While strFil &lt;&gt; vbNullString\n        Set Wb = Workbooks.Open(strFolder &amp; \"\\\" &amp; strFil)\n        Wb.Close False\n        strFil = Dir\n    Loop\nEnd Sub\n</code></pre>\n\n<p>I seved my macro to <code>PERSONAL.XLSB</code> which is called \"import\". My files are Microsoft Excel csv files which will be at the of my code saved as xlsx.</p>\n\n<p>My question is how to modify the above code to run my macro through all the files? where to include my macro?</p>\n\n<p>Many thanks </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1496227157, "post_id": 44282460, "comment_id": 75571516, "body": "No, It still says object required !"}], "tags": [], "owner": {"reputation": 75, "user_id": 7056354, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HorCv.jpg?s=128&g=1", "display_name": "Fahad Ejaz Butt", "link": "https://stackoverflow.com/users/7056354/fahad-ejaz-butt"}, "is_accepted": false, "score": 0, "last_activity_date": 1496227052, "creation_date": 1496227052, "answer_id": 44282460, "question_id": 44282386, "link": "https://stackoverflow.com/questions/44282386/write-value-to-a-textbox-in-userform-vba/44282460#44282460", "title": "Write value to a textbox in Userform - VBA", "body": "<p>N_Ent_TextBox.Text = TotalSelected\ntry to use this </p>\n"}, {"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 0, "creation_date": 1496227376, "post_id": 44282509, "comment_id": 75571668, "body": "No worries, don&#39;t forget to accept the answer if it solved your problem."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "edited": false, "score": 1, "creation_date": 1496227411, "post_id": 44282509, "comment_id": 75571691, "body": "Will Accept it. It says I have to wait for 6 minutes to accept it :)"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 2, "last_activity_date": 1496227199, "creation_date": 1496227199, "answer_id": 44282509, "question_id": 44282386, "link": "https://stackoverflow.com/questions/44282386/write-value-to-a-textbox-in-userform-vba/44282509#44282509", "title": "Write value to a textbox in Userform - VBA", "body": "<p>It looks like your code isn't actually inside the userform's class module - so you need to fully qualify the object:</p>\n\n<pre><code>Questionaire.N_Ent_TextBox.Value = TotalSelected\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3228, "favorite_count": 0, "accepted_answer_id": 44282509, "answer_count": 2, "score": 2, "last_activity_date": 1496227199, "creation_date": 1496226838, "last_edit_date": 1531164843, "question_id": 44282386, "link": "https://stackoverflow.com/questions/44282386/write-value-to-a-textbox-in-userform-vba", "title": "Write value to a textbox in Userform - VBA", "body": "<p>I am trying to write a value dynamically in Textbox which is placed on a Userform. This is my code, and I am getting an error in the last line. It says object required. </p>\n\n<pre><code>Sub Userform1_Display()\n\nTotalSelected = 0\n\nWith Sheets(\"Main\").Ent_ListBox\n\n    For i = 0 To .ListCount - 1\n        If .Selected(i) = True Then\n          Count = 1\n          TotalSelected = TotalSelected + Count\n        End If\n    Next i\n\nEnd With\n\n'Useform'\nQuestionaire.Show\n\n'TextBox placed in Userform'\nN_Ent_TextBox.Value = TotalSelected\n\n\nEnd Sub\n</code></pre>\n\n<p>Kindly share your thoughts </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496226801, "post_id": 44282193, "comment_id": 75571316, "body": "You have a missing library and hence you are getting that error. Open VBA Editor and click on Tools | References. Uncheck any missing Library and you will be good :)"}, {"owner": {"reputation": 1, "user_id": 8091305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce61ac1e2abf8e8343a8a67dd93ca463?s=128&d=identicon&r=PG&f=1", "display_name": "Bieke", "link": "https://stackoverflow.com/users/8091305/bieke"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496228841, "post_id": 44282193, "comment_id": 75572661, "body": "I&#39;ve already checked the library, but there are no missing Libraries :-("}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1496230333, "post_id": 44282193, "comment_id": 75573677, "body": "I think Siddharth is right though. Any external controls used on userforms?"}, {"owner": {"reputation": 1, "user_id": 8091305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce61ac1e2abf8e8343a8a67dd93ca463?s=128&d=identicon&r=PG&f=1", "display_name": "Bieke", "link": "https://stackoverflow.com/users/8091305/bieke"}, "edited": false, "score": 0, "creation_date": 1496230993, "post_id": 44282193, "comment_id": 75574150, "body": "I&#39;v checked the libraries again (on an other pc than last time), and indeed, a library was missing. Bothersome that this can be so different from one pc to another."}], "owner": {"reputation": 1, "user_id": 8091305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce61ac1e2abf8e8343a8a67dd93ca463?s=128&d=identicon&r=PG&f=1", "display_name": "Bieke", "link": "https://stackoverflow.com/users/8091305/bieke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496226300, "creation_date": 1496226300, "last_edit_date": 1531164843, "question_id": 44282193, "link": "https://stackoverflow.com/questions/44282193/file-issue-excel-vba-code-works-for-2016-but-not-in-2010", "title": "file issue: excel vba code works for 2016, but not in 2010", "body": "<p>I have some problems executing vba code in one excel file (other files with similar code are working fine).\nI've got some errors using code like <code>Left(word,2)</code> \u2192 dll missing.\nthis I got solved by using <code>vba.string.Left(word,2)</code>\nI still have an error trying to open a workbook, again DLL is missing.\nThis issue is only when using Excel 2010 and with this file.\nThe file is working fine using Excel 2016.</p>\n\n<pre><code>Dim objApp As Excel.Application\nDim objWbks As Excel.Workbooks\nSet objApp = Excel.Application\nSet objWbks = objApp.Workbooks\nobjWbks.Open (TempFilePath &amp; TempFileName &amp; FileExtStr)\n</code></pre>\n\n<p>Thanks a lot if you have any sugestion!</p>\n"}, {"tags": ["excel", "code-editor", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496226481, "post_id": 44282163, "comment_id": 75571073, "body": "The only place I can see column as a variable is <code>Worksheets(&quot;Temp-Data&quot;).Range(&quot;A&quot; &amp; EarthingRowNumStart &amp; &quot;:&quot; &amp; ColumnName &amp; EarthingRowNumEnd).Copy Worksheets(&quot;Earthing Bars&quot;).Range(&quot;A4:K&quot; &amp; (EarthingRowNumEnd - EarthingRowNumStart + 4))</code> What is the value of <code>ColumnName</code>?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496226701, "post_id": 44282163, "comment_id": 75571246, "body": "BTW are you talking about last column or last row?"}, {"owner": {"reputation": 45, "user_id": 4423819, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de36f237abac9b38797a3ed6ac20ec48?s=128&d=identicon&r=PG&f=1", "display_name": "user4423819", "link": "https://stackoverflow.com/users/4423819/user4423819"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496227600, "post_id": 44282163, "comment_id": 75571829, "body": "Last column. The column is a variable, but that is not the problem as even if I change it to a fixed string I still get the same error."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496227821, "post_id": 44282163, "comment_id": 75571984, "body": "So you are saying that copying Col A:K from one sheet to the another sheet A:K is not working and the data gets pasted to only A:J ?"}, {"owner": {"reputation": 45, "user_id": 4423819, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de36f237abac9b38797a3ed6ac20ec48?s=128&d=identicon&r=PG&f=1", "display_name": "user4423819", "link": "https://stackoverflow.com/users/4423819/user4423819"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496228140, "post_id": 44282163, "comment_id": 75572199, "body": "Yes...but works fine when I run it through the code editor. I only have this problem when I run it through the click of a button in excel"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496229156, "post_id": 44282163, "comment_id": 75572870, "body": "You have to do something different then. Do you run through the code always to the end and not stop anywhere? It could happen that it works for a time but you overwrite it somewhere else in your code and get wrong results."}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1496230477, "post_id": 44282163, "comment_id": 75573790, "body": "You don&#39;t show us all the code, especially the part where rownumbers are assigned, please add that bit."}, {"owner": {"reputation": 45, "user_id": 4423819, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de36f237abac9b38797a3ed6ac20ec48?s=128&d=identicon&r=PG&f=1", "display_name": "user4423819", "link": "https://stackoverflow.com/users/4423819/user4423819"}, "edited": false, "score": 0, "creation_date": 1496232180, "post_id": 44282163, "comment_id": 75575124, "body": "I press the play button in the code editor without having stopping mark, it works as intended. When I press the form button in excel, it doesn&#39;t. I read something about the debugger&#39;s execution is different than when you run it straight <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-msoffice_custom/vba-working-on-f8-step-through-but-not-when-run/27c0d442-5b4f-410b-8505-d642b0bf523e\" rel=\"nofollow noreferrer\">link</a>...Also all the other variables are row numbers which I do not have problem with. The only problem I have is that the VBA code edits one column short"}], "owner": {"reputation": 45, "user_id": 4423819, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de36f237abac9b38797a3ed6ac20ec48?s=128&d=identicon&r=PG&f=1", "display_name": "user4423819", "link": "https://stackoverflow.com/users/4423819/user4423819"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496227409, "creation_date": 1496226206, "last_edit_date": 1531161705, "question_id": 44282163, "link": "https://stackoverflow.com/questions/44282163/excel-vba-runs-as-intended-in-code-editor-but-not-within-excel", "title": "Excel VBA runs as intended in code editor but not within excel", "body": "<p>I have a code that requires to copy range of data from one sheet, paste it in another sheet, then delete it. When I run the code through excel's VBA code editor it works as intended, however, when I run it through the spreadsheet using the forms button it always misses the last column. And it doesn't matter if I increase the column in the range, it always takes one less column than needed. My code sample is below</p>\n\n<pre><code>        'Copy Rebar Data\n    If RebarRowNumStart &lt;&gt; 0 And RebarRowNumEnd &lt;&gt; 0 Then\n    Worksheets(\"Temp-Data\").Range(\"A\" &amp; RebarRowNumStart &amp; \":I\" &amp; RebarRowNumEnd).Copy Worksheets(\"Rebar-Data\").Range(\"A4:I\" &amp; (RebarRowNumEnd - RebarRowNumStart + 4))\n    End If\n\n    If WeldsRowNumStart &lt;&gt; 0 And WeldsRowNumEnd &lt;&gt; 0 Then\n    Worksheets(\"Temp-Data\").Range(\"A\" &amp; WeldsRowNumStart &amp; \":G\" &amp; WeldsRowNumEnd).Copy Worksheets(\"Welds-Data\").Range(\"A4:G\" &amp; (WeldsRowNumEnd - WeldsRowNumStart + 4))\n    End If\n\n    If EarthingRowNumStart &lt;&gt; 0 And EarthingRowNumEnd &lt;&gt; 0 Then\n    Worksheets(\"Temp-Data\").Range(\"A\" &amp; EarthingRowNumStart &amp; \":k\" &amp; EarthingRowNumEnd).Copy Worksheets(\"Earthing Bars\").Range(\"A4:K\" &amp; (EarthingRowNumEnd - EarthingRowNumStart + 4))\n    End If\n\n    If AnchorRowNumStart &lt;&gt; 0 And AnchorRowNumEnd &lt;&gt; 0 Then\n    Worksheets(\"Temp-Data\").Range(\"A\" &amp; AnchorRowNumStart &amp; \":K\" &amp; AnchorRowNumEnd).Copy Worksheets(\"Anchor Plates\").Range(\"A4:K\" &amp; (AnchorRowNumEnd - AnchorRowNumStart + 4))\n    End If\n\n    If HalfenRowNumStart &lt;&gt; 0 And HalfenRowNumEnd &lt;&gt; 0 Then\n    Worksheets(\"Temp-Data\").Range(\"A\" &amp; HalfenRowNumStart &amp; \":K\" &amp; HalfenRowNumEnd).Copy Worksheets(\"Halfen Channels\").Range(\"A4:K\" &amp; (HalfenRowNumEnd - HalfenRowNumStart + 4))\n    End If\n\n    If ConesRowNumStart &lt;&gt; 0 And ConesRowNumEnd &lt;&gt; 0 Then\n    Worksheets(\"Temp-Data\").Range(\"A\" &amp; ConesRowNumStart &amp; \":K\" &amp; ConesRowNumEnd).Copy Worksheets(\"Cones\").Range(\"A4:K\" &amp; (ConesRowNumEnd - ConesRowNumStart + 4))\n    End If\n\n    'Delete Data\n    Range(\"A2:K\" &amp; LastRow).Clear\n</code></pre>\n\n<p>So it works fine when I run in in the code editor but not from clicking the button. Tried to run it on Excel 2007 and 2016, same results. Your help is appreciated.</p>\n\n<p>The purpose of it is to read a bunch of data in a spreadsheet called \"Temp-Data\" figures out what it corresponds to, then copy them in the right spreadsheet in the same workbook. It works as intended except the part where it doesn't copy / paste / delete the last column (\"K\"). P.S: It works perfectly when I run through the code editor</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 2, "creation_date": 1496223884, "post_id": 44281221, "comment_id": 75569223, "body": "Please can you provide a better explanation of your issue"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 3, "creation_date": 1496223927, "post_id": 44281221, "comment_id": 75569252, "body": "Please add more infomation and code to your question. Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 11, "user_id": 8069664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df1a051e8a47e7ad8fb7681e075e576?s=128&d=identicon&r=PG&f=1", "display_name": "Burhan Pazar", "link": "https://stackoverflow.com/users/8069664/burhan-pazar"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496224616, "post_id": 44281221, "comment_id": 75569743, "body": "I have added more detail, @UGP"}, {"owner": {"reputation": 11, "user_id": 8069664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df1a051e8a47e7ad8fb7681e075e576?s=128&d=identicon&r=PG&f=1", "display_name": "Burhan Pazar", "link": "https://stackoverflow.com/users/8069664/burhan-pazar"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1496224785, "post_id": 44281221, "comment_id": 75569877, "body": "@Jordan I have added more detail"}, {"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1496224995, "post_id": 44281221, "comment_id": 75570050, "body": "Error 424 means &quot;Object Required&quot; so you should split this line and check for <code>Is Nothing</code> - <code>Set tbl=objIE.document.getElementById(&quot;vatResponseFormTable&quot;): If Not tbl Is Nothing Then &lt;proceed with program&gt;</code>"}, {"owner": {"reputation": 11, "user_id": 8069664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df1a051e8a47e7ad8fb7681e075e576?s=128&d=identicon&r=PG&f=1", "display_name": "Burhan Pazar", "link": "https://stackoverflow.com/users/8069664/burhan-pazar"}, "reply_to_user": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 0, "creation_date": 1496225564, "post_id": 44281221, "comment_id": 75570464, "body": "@SBF can&#39;t get this to work still, it&#39;s weird because when I run it slowly by clicking f8 it works all the way through"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1496229633, "post_id": 44281221, "comment_id": 75573173, "body": "The code runs okay for me if I provide a dummy vat#. I get text &quot;No, invalid VAT number (please refer to FAQ, questions 7, 11, 12, 13 and 20 for more information).&quot;  Can you provide a valid vat# to try the code?"}, {"owner": {"reputation": 11, "user_id": 8069664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df1a051e8a47e7ad8fb7681e075e576?s=128&d=identicon&r=PG&f=1", "display_name": "Burhan Pazar", "link": "https://stackoverflow.com/users/8069664/burhan-pazar"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1496230042, "post_id": 44281221, "comment_id": 75573459, "body": "@sktneer 577300832 this is a valid vat number"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1496233783, "post_id": 44281221, "comment_id": 75576341, "body": "Okay. I have just added a solution and see if this approach works for you."}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1496233743, "creation_date": 1496233743, "answer_id": 44284849, "question_id": 44281221, "link": "https://stackoverflow.com/questions/44281221/excel-macro-error-code-424-works-when-slowly-clicking-through/44284849#44284849", "title": "Excel Macro Error Code 424 works when slowly clicking through", "body": "<p>Sometimes the pages gets loaded internally through some scripts so the html element you are trying to get actually isn't found on the document as the code runs very fast. So somehow you have to wait until page loads completely.</p>\n\n<p>Please try this approach and see if the code runs without producing an error.</p>\n\n<pre><code>Sub SearchBot()\n\n'dimension (declare or set aside memory for) our variables\nDim objIE As InternetExplorer 'special object variable representing the IE browser\nDim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\nDim vatFormTable As IHTMLElement\nDim tr As IHTMLElement\nDim y As Integer 'integer variable we'll use as a counter\nDim result As String 'string variable that will hold our result link\n\nDim x As Integer\n Application.ScreenUpdating = False\n ' Set numrows = number of rows of data.\n NumRows = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n ' Select cell a1.\n Range(\"A1\").Select\n ' Establish \"For\" loop to loop \"numrows\" number of times.\n For x = 1 To NumRows\n    ' Insert your code here.\n\n    'initiating a new instance of Internet Explorer and asigning it to objIE\nSet objIE = New InternetExplorer\n\n'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate \"http://ec.europa.eu/taxation_customs/vies/vatResponse.html\"\n\n'wait here a few seconds while the browser is busy\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n'in the search box put cell \"A2\" value, the word \"in\" and cell \"C1\" value\nobjIE.document.getElementById(\"countryCombobox\").Value = \"GB\"\nobjIE.document.getElementById(\"number\").Value = ActiveCell.Value\n\n'click the 'go' button\nobjIE.document.getElementById(\"submit\").Click\n\n'wait again for the browser\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n\n    On Error Resume Next\n    Dim vatResponse As String\n    Do While vatFormTable Is Nothing\n       Set vatFormTable = objIE.document.getElementById(\"vatResponseFormTable\")\n    Loop\n\n    Do While tr Is Nothing\n       Set tr = vatFormTable.getElementsByTagName(\"tr\")(0)\n    Loop\n\n    vatResponse = tr.Children(0).innerText\n    ActiveCell.Offset(0, 2).Value = vatResponse\n\n    ' Selects cell down 1 row from active cell.\n\n 'Next\n Application.ScreenUpdating = True\n\n'close the browser\nobjIE.Quit\n\nActiveCell.Offset(1, 0).Select\n   'End\n\nNext\n\n'exit our SearchBot subroutine\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8069664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df1a051e8a47e7ad8fb7681e075e576?s=128&d=identicon&r=PG&f=1", "display_name": "Burhan Pazar", "link": "https://stackoverflow.com/users/8069664/burhan-pazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 44284849, "answer_count": 1, "score": -3, "last_activity_date": 1496233743, "creation_date": 1496223703, "last_edit_date": 1496224988, "question_id": 44281221, "link": "https://stackoverflow.com/questions/44281221/excel-macro-error-code-424-works-when-slowly-clicking-through", "title": "Excel Macro Error Code 424 works when slowly clicking through", "body": "<pre><code>'start a new subroutine called SearchBot\n\nSub SearchBot()\n\n'dimension (declare or set aside memory for) our variables\nDim objIE As InternetExplorer 'special object variable representing the IE browser\nDim aEle As HTMLLinkElement 'special object variable for an &lt;a&gt; (link) element\nDim y As Integer 'integer variable we'll use as a counter\nDim result As String 'string variable that will hold our result link\n\n\n\n Dim x As Integer\n  Application.ScreenUpdating = False\n  ' Set numrows = number of rows of data.\n  NumRows = Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\n  ' Select cell a1.\n  Range(\"A1\").Select\n  ' Establish \"For\" loop to loop \"numrows\" number of times.\n  For x = 1 To NumRows\n     ' Insert your code here.\n\n     'initiating a new instance of Internet Explorer and asigning it to objIE\nSet objIE = New InternetExplorer\n\n'make IE browser visible (False would allow IE to run in the background)\nobjIE.Visible = True\n\n'navigate IE to this web page (a pretty neat search engine really)\nobjIE.navigate \"http://ec.europa.eu/taxation_customs/vies/vatResponse.html\"\n\n'wait here a few seconds while the browser is busy\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n'in the search box put cell \"A2\" value, the word \"in\" and cell \"C1\" value\nobjIE.document.getElementById(\"countryCombobox\").Value = \"GB\"\nobjIE.document.getElementById(\"number\").Value = ActiveCell.Value\n\n'click the 'go' button\nobjIE.document.getElementById(\"submit\").Click\n\n'wait again for the browser\nDo While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n\n\n     Dim vatResponse As String\n\n     vatResponse = objIE.document.getElementById(\"vatResponseFormTable\").getElementsByTagName(\"tr\")(0).Children(0).textContent\n\n     ActiveCell.Offset(0, 2).Value = vatResponse\n\n     ' Selects cell down 1 row from active cell.\n\n  'Next\n  Application.ScreenUpdating = True       \n\n'close the browser\nobjIE.Quit\n\nActiveCell.Offset(1, 0).Select\n    'End\n\nNext\n\n'exit our SearchBot subroutine\nEnd Sub\n</code></pre>\n\n<p>So basically on this code line:</p>\n\n<pre><code>vatResponse = objIE.document.getElementById(\"vatResponseFormTable\").getElementsByTagName(\"tr\")(0).Children(0).textContent\n</code></pre>\n\n<p>I am getting an error message saying that I have an error code 424</p>\n"}, {"tags": ["vba", "excel", "sharepoint"], "answers": [{"tags": [], "owner": {"reputation": 231, "user_id": 7225842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b8722c5124082def2d241b39610d99?s=128&d=identicon&r=PG&f=1", "display_name": "Ethan", "link": "https://stackoverflow.com/users/7225842/ethan"}, "is_accepted": true, "score": 1, "last_activity_date": 1496308837, "creation_date": 1496308837, "answer_id": 44303500, "question_id": 44280947, "link": "https://stackoverflow.com/questions/44280947/change-view-in-linked-excel-with-sharepoint-list/44303500#44303500", "title": "Change view in linked excel with sharepoint list", "body": "<p>You need to do small changes in your code (see below)</p>\n\n<pre><code>Sub link_edit_Mode()\n\nDim mySh As Worksheet\nDim spSite As String\n\nSet mySh = Sheets(\"one\")\n\nDim src(0 To 2) As Variant\n\n   spSite = \" url \" 'site name\n   src(0) = spSite &amp; \"/_vti_bin\"\n   src(1) = \"{lists GUID}\" 'GUID\n   src(2) = \"{view GUID}\" \n\nmySh.ListObjects.Add xlSrcExternal, src, True, xlYes, mySh.Range(\"A1\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 7629532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b114af3cbb5d8f6d4967dd5cf8fc3a45?s=128&d=identicon&r=PG&f=1", "display_name": "L.Horvath", "link": "https://stackoverflow.com/users/7629532/l-horvath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 44303500, "answer_count": 1, "score": 1, "last_activity_date": 1496308837, "creation_date": 1496223080, "last_edit_date": 1496234547, "question_id": 44280947, "link": "https://stackoverflow.com/questions/44280947/change-view-in-linked-excel-with-sharepoint-list", "title": "Change view in linked excel with sharepoint list", "body": "<p>Can someone help me how can I change view in Excel, which is connected with Lists in Sharepoint ? This is my VBA code:</p>\n\n<pre><code>Sub link_edit_Mode()\n\nDim mySh As Worksheet\nDim spSite As String\n\nSet mySh = Sheets(\"one\")\n\nDim src(0 To 1) As Variant\n\n   spSite = \" url \" 'site name\n   src(0) = spSite &amp; \"/_vti_bin\"\n   src(1) = \"{lists GUID}\" 'GUID\n\nmySh.ListObjects.Add xlSrcExternal, src, True, xlYes, mySh.Range(\"A1\")\n\nEnd Sub\n</code></pre>\n\n<p>It works, but it gives me the table from sharepoint, which has default view, but I need change this view.</p>\n"}, {"tags": ["vba", "excel", "increment"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1496223114, "post_id": 44280433, "comment_id": 75568621, "body": "Exactly what I wanted! Thanks a lot for your time."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1496225562, "post_id": 44280433, "comment_id": 75570461, "body": "Also <code>...Range(&quot;3:24&quot;).Columns(i)...</code> is possible while <code>paste</code> will extend the range as it needs to. In most cases also <code>...Cells(3, i).Paste</code> will do the job ;)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1496221804, "creation_date": 1496221804, "answer_id": 44280433, "question_id": 44280296, "link": "https://stackoverflow.com/questions/44280296/excel-vba-increment-column-reference-in-range/44280433#44280433", "title": "Excel VBA - increment column reference in range", "body": "<p>You can use the <code>Cells(Row, Column)</code>, so you increment the <code>Column</code> part easily with the numeric value, without using a conversion function from Numeric to Alphabetical.</p>\n\n<pre><code>For i = 23 To 27\n    'start at column w (which is number 23)\n    Range(Cells(3, i), Cells(24, i)).PasteSpecial\nNext\n</code></pre>\n"}], "owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11896, "favorite_count": 0, "accepted_answer_id": 44280433, "answer_count": 1, "score": 1, "last_activity_date": 1496221804, "creation_date": 1496221445, "question_id": 44280296, "link": "https://stackoverflow.com/questions/44280296/excel-vba-increment-column-reference-in-range", "title": "Excel VBA - increment column reference in range", "body": "<p>How do I increment the column reference in the code below? Just the column ref, the row values can stay the same.</p>\n\n<pre><code>Range(\"w3:w54\").PasteSpecial\n</code></pre>\n\n<p>I'm hoping I can do something like this:</p>\n\n<pre><code>For i = 23 to 27\n'start at column w (which is number 23)\n\nRange(Columns(i)+\"3\":Columns(i)+\"54\").PasteSpecial  \n\nNext            \n</code></pre>\n\n<p>But that throws an error. </p>\n\n<p>Any suggestions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "edited": false, "score": 1, "creation_date": 1496223354, "post_id": 44280214, "comment_id": 75568822, "body": "Wait, is there a typo here?"}], "answers": [{"comments": [{"owner": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496222143, "post_id": 44280483, "comment_id": 75567898, "body": "it is arranging in row-wise fashion. I want it to arrange it in column-wise. as you can see in the second split that i have given"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496222271, "post_id": 44280483, "comment_id": 75567999, "body": "same geometry, look at <code>offset</code> and <code>resize</code> to see how to switch."}, {"owner": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496222434, "post_id": 44280483, "comment_id": 75568122, "body": "I didn&#39;t get you"}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1496221937, "creation_date": 1496221937, "answer_id": 44280483, "question_id": 44280214, "link": "https://stackoverflow.com/questions/44280214/excel-split-data-of-simgle-column-into-multiple-column-column-wise-vba/44280483#44280483", "title": "Excel: Split data of simgle column into multiple column column-wise VBA", "body": "<p>Something like this, not fully tested yet, but a start.</p>\n\n<pre><code>Sub t()\n\nDim xDimension As Integer\nDim lngLoopCount As Long\nDim lngLastRow As Long\nDim lngPresentation As Long\n\nxDimension = 5\nlngPresentation = 1\n\nlngLastRow = Range(\"a1\").End(xlDown).Row\n\nFor lngLoopCount = 1 To lngLastRow Step xDimension\n    Range(\"c1\").Offset(lngPresentation, 0).Resize(1, xDimension).Value = _\n                Application.Transpose(Range(\"a1\").Offset(lngLoopCount - 1, 0).Resize(xDimension, 1).Value)\n    lngPresentation = lngPresentation + 1\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496223740, "post_id": 44281029, "comment_id": 75569125, "body": "I want to call it directly without using event"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "reply_to_user": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496223787, "post_id": 44281029, "comment_id": 75569158, "body": "Call it directly as <code>Button1_Click()</code> you mean?"}, {"owner": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496223843, "post_id": 44281029, "comment_id": 75569204, "body": "no, that program should execute directly when i click on Run"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "reply_to_user": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496223924, "post_id": 44281029, "comment_id": 75569248, "body": "I will edit this answer and assume that you have those numbers lined up in column A."}, {"owner": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496223969, "post_id": 44281029, "comment_id": 75569279, "body": "sure, that will be great"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "reply_to_user": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496224094, "post_id": 44281029, "comment_id": 75569366, "body": "Done, so paste both of the codes in the same module and I hope it works for you."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496224838, "post_id": 44281029, "comment_id": 75569913, "body": "I think you&#39;ve got rows and columns mixed up. @V15HM4Y wants it to be split over 5 rows, not 5 columns (example - change your function to split over 7 instead of 5 and it returns 4 columns)"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1496225411, "post_id": 44281029, "comment_id": 75570358, "body": "And I just did the same. 5 columns not 5 rows***"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1496226627, "post_id": 44281029, "comment_id": 75571185, "body": "Added sample picture. @Tom - am I really that mistaken?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "edited": false, "score": 0, "creation_date": 1496226778, "post_id": 44281029, "comment_id": 75571300, "body": "Reread question. Specifically states @V15HM4Y wants it to ask for number of columns not rows"}, {"owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1496227562, "post_id": 44281029, "comment_id": 75571801, "body": "@Tom - I stand corrected. * hides himself of shame *."}], "tags": [], "owner": {"reputation": 583, "user_id": 7499107, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k8p4p.jpg?s=128&g=1", "display_name": "Romcel Geluz", "link": "https://stackoverflow.com/users/7499107/romcel-geluz"}, "is_accepted": false, "score": 0, "last_activity_date": 1496226593, "last_edit_date": 1496226593, "creation_date": 1496223256, "answer_id": 44281029, "question_id": 44280214, "link": "https://stackoverflow.com/questions/44280214/excel-split-data-of-simgle-column-into-multiple-column-column-wise-vba/44281029#44281029", "title": "Excel: Split data of simgle column into multiple column column-wise VBA", "body": "<p>Please try this piece of code,</p>\n\n<pre><code>Function SPLITARR(ByRef v() As Variant, MaxRow As Integer) As Variant\n  Dim ArraySize As Integer\n  Dim MaxCols As Integer\n  Dim NewArray() As Variant\n  Dim x As Integer, y As Integer, z As Integer\n\n  ArraySize = (UBound(v(), 1) - LBound(v(), 1)) + 1\n  MaxCols = ArraySize \\ MaxRow\n\n  If ArraySize Mod MaxRow &gt; 0 Then MaxCols = MaxCols + 1\n  ReDim NewArray(LBound(v(), 1) To MaxRow, 1 To MaxCols)\n  For x = LBound(v(), 1) To UBound(v(), 1)\n    y = x Mod MaxRow\n    If y = 0 Then y = MaxRow\n    z = x \\ MaxRow\n    If x Mod MaxRow = 0 Then z = z - 1\n    NewArray(y, z + 1) = v(x, 1)\n  Next\n  SPLITARR = NewArray()\nEnd Function\n</code></pre>\n\n<p>and should be called like, </p>\n\n<pre><code>Sub caller()\nDim a() As Variant\na() = Range(\"A1\",Range(\"A\" &amp; Rows.Count).End(xlUp))\na() = SPLITARR(a(), 5) '&lt;~ change this to your needs\nActiveCell.Resize(UBound(a(), 1), UBound(a(), 2)).Value = a()\nEnd Sub\n</code></pre>\n\n<p><br><br><br>\nIt gives an output like</p>\n\n<p><a href=\"https://i.stack.imgur.com/bA3oM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bA3oM.png\" alt=\"called 1\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/ejFkv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ejFkv.png\" alt=\"called 2\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1496225368, "creation_date": 1496225368, "answer_id": 44281850, "question_id": 44280214, "link": "https://stackoverflow.com/questions/44280214/excel-split-data-of-simgle-column-into-multiple-column-column-wise-vba/44281850#44281850", "title": "Excel: Split data of simgle column into multiple column column-wise VBA", "body": "<p>This will split your range over 5 columns in the order that you want. It will need you to update the <code>With</code> statement to the relevant sheet that you're looking at and the split can be changed by altering the <code>NoCols</code> variable to how ever many columns you desire in your output.</p>\n\n<pre><code>Public Sub SplitRange()\n    Dim arr As Variant, tmp As Variant\n    Dim i As Long, j As Long\n    Dim NoCols As Long\n    Dim rng As Range\n    Dim c\n\n    ' Change this to how many columns you want\n    NoCols = 5\n\n    ' Change to your sheet\n    With Sheet6\n        .Range(.Columns(4), .Columns(20)).Clear\n        Set rng = .Range(.Cells(1, 1), .Cells(.Cells(.Rows.Count, 1).End(xlUp).Row, 1))\n        tmp = rng.Value2\n\n        ReDim arr(1 To WorksheetFunction.RoundUp(UBound(tmp) / NoCols, 0), 1 To NoCols)\n\n        i = 1: j = 1\n        For Each c In tmp\n            If i &gt; WorksheetFunction.RoundUp(UBound(tmp) / NoCols, 0) Then j = j + 1: i = 1\n                arr(i, j) = c\n            i = i + 1\n        Next c\n\n        With .Cells(1, 4)\n            Range(.Offset(0, 0), .Offset(UBound(arr, 1) - 1, UBound(arr, 2) - 1)) = arr\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": false, "score": 1, "last_activity_date": 1496250609, "creation_date": 1496250609, "answer_id": 44290895, "question_id": 44280214, "link": "https://stackoverflow.com/questions/44280214/excel-split-data-of-simgle-column-into-multiple-column-column-wise-vba/44290895#44290895", "title": "Excel: Split data of simgle column into multiple column column-wise VBA", "body": "<p>Try this code, a little user friendly,</p>\n\n<p>When you run this macro, <code>vba</code> shows a text box in which you can enter the number of columns you want to split your data into.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ib5f3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ib5f3.png\" alt=\"enter image description here\"></a></p>\n\n<p>When you enter <code>5</code>, and click <code>Ok</code>,</p>\n\n<p><a href=\"https://i.stack.imgur.com/0lTne.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0lTne.png\" alt=\"enter image description here\"></a></p>\n\n<p>and your code is here,</p>\n\n<pre><code>Sub transpose()\nDim col As Variant, i As Long, j As Long, k As Long\ncol = InputBox(\"Enter number of columns\")\ncol = Cells(Rows.Count, 1).End(xlUp).Row / col\ncol = WorksheetFunction.RoundUp(col, 0)\nj = 1\nk = 3\nFor i = 1 To Cells(Rows.Count, 1).End(xlUp).Row\n    Cells(j, k) = Cells(i, 1)\n    j = j + 1\n    If j &gt; col Then\n        j = 1\n        k = k + 1\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>This code dynamically splits the column based on your input. Hope this helps.</p>\n"}], "owner": {"reputation": 1557, "user_id": 2032569, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/8gBc9.jpg?s=128&g=1", "display_name": "V15HM4Y", "link": "https://stackoverflow.com/users/2032569/v15hm4y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "answer_count": 4, "score": -3, "last_activity_date": 1496250609, "creation_date": 1496221249, "question_id": 44280214, "link": "https://stackoverflow.com/questions/44280214/excel-split-data-of-simgle-column-into-multiple-column-column-wise-vba", "title": "Excel: Split data of simgle column into multiple column column-wise VBA", "body": "<p>I have some data in excel as given below:</p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n</code></pre>\n\n<p>When I split it into multiple columns using ASAP utilities. It splits the data column wise. Like suppose if i want to split it into 5 columns, it will be in row-wise fashion like this:</p>\n\n<pre><code>1   2   3   4   5\n6   7   8   9   10\n11  12  13  14  15\n16  17  18  19  20\n21  22  23\n</code></pre>\n\n<p>But, I want to split it column-wise like this:</p>\n\n<pre><code>1   6   11  16  20\n2   7   12  17  21\n3   8   13  18  22\n4   9   14  19  23\n5   10  15      \n</code></pre>\n\n<p>I used the code given <a href=\"https://www.extendoffice.com/documents/excel/2244-excel-split-long-column-into-multiple-columns.html\" rel=\"nofollow noreferrer\">here</a>, but it asks for number of rows. I want it to ask number of columns and then split the data just like ASAP Utilities does.</p>\n\n<p>All positive suggestions are welcomed...</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496219041, "post_id": 44279337, "comment_id": 75565779, "body": "<a href=\"http://www.siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba/\" rel=\"nofollow noreferrer\">siddharthrout.com/2011/07/14/find-and-findnext-in-excel-vba</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1496219089, "post_id": 44279337, "comment_id": 75565810, "body": "<code>On a side note, how can I open an excel file that starts with the name &quot;Indexation&quot; followed by anything else? (what in sql would be *)</code> Loop through the directory using <code>*</code> wildcard and then open the file"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1496219483, "post_id": 44279337, "comment_id": 75566044, "body": "Mind the types: <code>&quot;mai-2017&quot;</code> is a string, while in Excel dates are represented as numbers. Use the <code>DATEVALUE</code> function to convert strings to excel numbers."}, {"owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496219814, "post_id": 44279337, "comment_id": 75566264, "body": "&gt; Loop through the directory using * wildcard and then open the file How do I loop through files in a directory? A recordset?  &gt;Mind the types: &quot;mai-2017&quot; is a string, while in Excel dates are represented as numbers. Use the DATEVALUE function to convert strings to excel numbers. I tried DATEVALUE and also CDate but it still gives me the type incompatibility problem."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1496219996, "post_id": 44279337, "comment_id": 75566387, "body": "Instead of <code>appExcel.Sheets(&quot;Indices GO 2017&quot;).Select col = appExcel.Range(&quot;A22:Z22&quot;).Find(&quot;mai-2017&quot;, xlWhole, False, False).Column</code> you should use  <code>col = appExcel.Sheets(&quot;Indices GO 2017&quot;).Range(&quot;A22:Z22&quot;).Find(&quot;mai-2017&quot;, xlWhole, False, False).Column</code>"}, {"owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496220258, "post_id": 44279337, "comment_id": 75566567, "body": "I tried using that but it still gives me type incompatibility..."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496223281, "post_id": 44280791, "comment_id": 75568764, "body": "Thanks. I tried this but now it gives me &quot;Object variable or With block variable not set (Error 91)&quot;"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496223335, "post_id": 44280791, "comment_id": 75568802, "body": "@Voodoo it means not found. Which version did you try exactly and how?"}, {"owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496223890, "post_id": 44280791, "comment_id": 75569226, "body": "Now I tried creating a variable that will store the range, and then get the column from that range but now it crashes on the last line. <code>Dim c As Range Set c = appExcel.Sheets(&quot;Indices GO 2017&quot;).Range(&quot;A22:Z22&quot;).Find(DateValue(DateDebut))     col = c.Column</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496224055, "post_id": 44280791, "comment_id": 75569328, "body": "I can help more if you show me how are the data in your range. Are they actual dates or strings?"}, {"owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496224331, "post_id": 44280791, "comment_id": 75569539, "body": "I had to check the properties of the date cells to check it (I didn&#39;t create this Excel file, I only need data from it). The type of cell is &quot;personalized&quot; with &quot;mmm-aa&quot; (which might be month, year as its in french)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1496225741, "post_id": 44280791, "comment_id": 75570587, "body": "Well, that sounds like a date to me. Note that <code>Find(DateValue(&quot;May-2017&quot;))</code> only matches at the first of May 2017. While the values are displayed without days, days are probably saved and of influence on the find function. If you manually search (using find or filter), how many values are actually the first of May?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1496234850, "post_id": 44280791, "comment_id": 75577102, "body": "<code>Find(DateValue(&quot;May-2017&quot;))</code> <i>&quot;only matches at the first of May 2017&quot;</i> That&#39;s true. So what is your goal, is it to find the <i>first date</i> that occurs during May-2017 in row 1?"}, {"owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496235768, "post_id": 44280791, "comment_id": 75577767, "body": "There is a row with 12 cells, one for each month of the year like &quot;May-17&quot;. In my calculations I will have a date, which I want to find what cell it belongs to with the month."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496236032, "post_id": 44280791, "comment_id": 75578006, "body": "@Voodoo will the last edit work for you? Its strength is that it is independent of any formatting and locale settings.\\"}, {"owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496760543, "post_id": 44280791, "comment_id": 75786167, "body": "Hey @A.S.H what bibliography did you use for this answer? I&#39;m writing my thesis and should add in some bibliography. Thanks in advance."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "edited": false, "score": 0, "creation_date": 1496761234, "post_id": 44280791, "comment_id": 75786695, "body": "@Voodoo that was a week ago, I forgot. Will try to retrieve it to you when my sciencedirect account is reactivated ;)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1496236463, "last_edit_date": 1496236463, "creation_date": 1496222706, "answer_id": 44280791, "question_id": 44279337, "link": "https://stackoverflow.com/questions/44279337/finding-a-cell-in-an-excel-file-with-vba/44280791#44280791", "title": "Finding a cell in an Excel file with VBA", "body": "<blockquote>\n<pre><code>.Find(\"mai-2017\", xlWhole, False, False)\n</code></pre>\n</blockquote>\n\n<p>Remove the useless parameters, first off they are misplaced. for example the second parameter should be a <code>Range</code> (cell) where to start the search. <code>xlWhole</code> is a number, not a range. Its position is the 4th in the parameter list, not the second.</p>\n\n<p>The parameters are also of the wrong type. <code>False</code> for what, which parameters.\nanyway, it doesn't seem that you need anything else, just the first parameter, so let's make life easier:</p>\n\n<pre><code>.Find(\"mai-2017\")\n</code></pre>\n\n<p>If you really need to match whole cell at most, this:</p>\n\n<pre><code>.Find(\"mai-2017\",, xlWhole)\n</code></pre>\n\n<p>Finally, as per @ErikvonAsmuth in the comments section, a match wont be found if the searched cell is formatted as date, because its inner value is actually a number. In that case, try to match the date type, like this:</p>\n\n<pre><code>.Find(DateValue(\"May-2017\"))\n</code></pre>\n\n<hr>\n\n<p>Since your row has dates, try this to match the first occurrence of a date within may 2017 in the row:</p>\n\n<pre><code>col = appExcel.Evaluate(\"AGGREGATE(15, 6, COLUMN('Indices GO 2017'!22:22)\" &amp; _\n\"/ (MONTH('Indices GO 2017'!22:22)=5)/(YEAR('Indices GO 2017'!22:22)=2017), 1)\")\n</code></pre>\n\n<p>You can easily adapt it to return the first date within any given month (<code>5</code> corresponds to May) in row 22.</p>\n"}], "owner": {"reputation": 1, "user_id": 8090632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mw81U.jpg?s=128&g=1", "display_name": "Voodoo", "link": "https://stackoverflow.com/users/8090632/voodoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 535, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496236463, "creation_date": 1496218731, "last_edit_date": 1496221161, "question_id": 44279337, "link": "https://stackoverflow.com/questions/44279337/finding-a-cell-in-an-excel-file-with-vba", "title": "Finding a cell in an Excel file with VBA", "body": "<p>I never asked a question here but I'm desperate and I can't find the solution to my problem.</p>\n\n<p>I am programming with VBA for Access. I must get the value of a specific cell in a specific Excel file. To get this value I must Find the cell first, and thus comes my problem.</p>\n\n<p>When I try to use the .Find method to get the column of the cell I need, it gives me error \"13\", type incompatibility.</p>\n\n<p>This is what I'm doing:</p>\n\n<pre><code>Dim col As Integer\nDim appExcel As Excel.Application\nDim wbExcel As Excel.Workbook\nSet appExcel = CreateObject(\"Excel.Application\")\nappExcel.Visible = True\nSet wbExcel = Workbooks.Open(\"J:\\EXPLOITATION\\INDEXATION des tarifs\\2017\\Indexation GO client 2017.xls\")\nappExcel.Sheets(\"Indices GO 2017\").Select\ncol = appExcel.Range(\"A22:Z22\").Find(\"mai-2017\", xlWhole, False, False).Column\n</code></pre>\n\n<p>Basically like this I get the column of the cell (because the cell I want is in the same column as the cell I found), then I will do the same to find the row, then I can get the value of the cell with the row and column.</p>\n\n<p>On a side note, how can I open an excel file that starts with the name \"Indexation\" followed by anything else? (what in sql would be *)</p>\n\n<p>Thank you so much, I need this to finish my thesis.\nCordially,\nVoodoo.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1496216645, "post_id": 44278532, "comment_id": 75564270, "body": "There  a control for this RefEdit <a href=\"http://www.ozgrid.com/Excel/free-training/ExcelVBA2/excelvba2lesson20.htm\" rel=\"nofollow noreferrer\">ozgrid.com/Excel/free-training/ExcelVBA2/excelvba2lesson20.h&zwnj;&#8203;tm</a>"}, {"owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1496217523, "post_id": 44278532, "comment_id": 75564828, "body": "@Nathan_Sav thank you, that&#39;s exactly what I was looking for. If you post it as a full answer I will tick it."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": false, "score": 1, "last_activity_date": 1496216842, "creation_date": 1496216842, "answer_id": 44278721, "question_id": 44278532, "link": "https://stackoverflow.com/questions/44278532/populate-textbox-with-cell-reference-when-cell-is-clicked-while-userform-is-open/44278721#44278721", "title": "Populate TextBox with cell reference when cell is clicked while UserForm is open", "body": "<p>Have a look at using <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839468.aspx\" rel=\"nofollow noreferrer\">Application.InputBox()</a></p>\n\n<p>You can specify <code>type:=8</code> and it allows the user to choose a range, from which you can get the <code>.Address</code> property</p>\n\n<hr>\n\n<p>The other option is the RefEdit control in the link provided by Nathan_Sav - this is another good option (full disclosure - I am affiliated with OzGrid)</p>\n"}, {"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 2, "last_activity_date": 1496217598, "creation_date": 1496217598, "answer_id": 44278941, "question_id": 44278532, "link": "https://stackoverflow.com/questions/44278532/populate-textbox-with-cell-reference-when-cell-is-clicked-while-userform-is-open/44278941#44278941", "title": "Populate TextBox with cell reference when cell is clicked while UserForm is open", "body": "<p>There a control for this RefEdit available in the toolbox.  Excellent article here to get you started ozgrid.com/Excel/free-training/ExcelVBA2/excelvba2lesson20.h\u200c\u200btm </p>\n"}], "owner": {"reputation": 5222, "user_id": 1087852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8cjly.jpg?s=128&g=1", "display_name": "LucasSeveryn", "link": "https://stackoverflow.com/users/1087852/lucasseveryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 44278941, "answer_count": 2, "score": 2, "last_activity_date": 1496217598, "creation_date": 1496216243, "question_id": 44278532, "link": "https://stackoverflow.com/questions/44278532/populate-textbox-with-cell-reference-when-cell-is-clicked-while-userform-is-open", "title": "Populate TextBox with cell reference when cell is clicked while UserForm is open", "body": "<p>I am working on a small VBA project, part of it is a userform.</p>\n\n<p>One of the TextBoxes on the form requires the user to provide a cell reference</p>\n\n<p>While the UserForm is open, if the TextBox is currently selected, and user clicks on a cell in the workbook, I'd like the TextBox to be populated with a reference to that cell. </p>\n\n<p>(the same way as for example \"New Formatting Rule: Use a formula to determine which cells to format\" formula input is done)</p>\n\n<p>Is there any way of solving this?</p>\n\n<p>Important: the macro is not workbook specific, so I can't put anything in Workbook_Open event etc.</p>\n"}, {"tags": ["r", "vba", "excel", "shell"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1496216461, "post_id": 44278367, "comment_id": 75564152, "body": "Are you running this on a mac?"}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1496217162, "post_id": 44278367, "comment_id": 75564570, "body": "Check your references?"}, {"owner": {"reputation": 38493, "user_id": 2270475, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ajhT1.jpg?s=128&g=1", "display_name": "Moody_Mudskipper", "link": "https://stackoverflow.com/users/2270475/moody-mudskipper"}, "edited": false, "score": 0, "creation_date": 1496217220, "post_id": 44278367, "comment_id": 75564609, "body": "check this answer : <a href=\"https://stackoverflow.com/questions/18306362/run-r-script-from-command-line\" title=\"run r script from command line\">stackoverflow.com/questions/18306362/&hellip;</a>"}, {"owner": {"reputation": 38493, "user_id": 2270475, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ajhT1.jpg?s=128&g=1", "display_name": "Moody_Mudskipper", "link": "https://stackoverflow.com/users/2270475/moody-mudskipper"}, "edited": false, "score": 1, "creation_date": 1496217319, "post_id": 44278367, "comment_id": 75564680, "body": "the path of the script is not your entire command, you have to precede it with <code>Rscript</code> or <code>R CMD BATCH</code>"}, {"owner": {"reputation": 11, "user_id": 8090331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qdwWP.jpg?s=128&g=1", "display_name": "Abhishek kumar Jain", "link": "https://stackoverflow.com/users/8090331/abhishek-kumar-jain"}, "reply_to_user": {"reputation": 38493, "user_id": 2270475, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ajhT1.jpg?s=128&g=1", "display_name": "Moody_Mudskipper", "link": "https://stackoverflow.com/users/2270475/moody-mudskipper"}, "edited": false, "score": 0, "creation_date": 1496218439, "post_id": 44278367, "comment_id": 75565386, "body": "please elaborate @Moody_Mudskipper"}, {"owner": {"reputation": 11, "user_id": 8090331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qdwWP.jpg?s=128&g=1", "display_name": "Abhishek kumar Jain", "link": "https://stackoverflow.com/users/8090331/abhishek-kumar-jain"}, "edited": false, "score": 0, "creation_date": 1496218994, "post_id": 44278367, "comment_id": 75565754, "body": "Code:  Public Sub RunRTest()            shell (&quot;&quot;&quot;C:\\Users\\abhishek.b.jai\\Documents\\R\\R-            3.4.0\\bin\\RScript&quot;&quot;                         C:\\Users\\abhishek.b.jai\\Downloads\\data\\testcode.R&quot;)            End Sub                                                                                          similar code is running but nothing happens in R."}, {"owner": {"reputation": 38493, "user_id": 2270475, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ajhT1.jpg?s=128&g=1", "display_name": "Moody_Mudskipper", "link": "https://stackoverflow.com/users/2270475/moody-mudskipper"}, "edited": false, "score": 0, "creation_date": 1496225018, "post_id": 44278367, "comment_id": 75570074, "body": "What should your testcode script do ? What do you want to happen ? Do I understand correctly that your last piece of code doesn&#39;t return an error ?"}, {"owner": {"reputation": 11, "user_id": 8090331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qdwWP.jpg?s=128&g=1", "display_name": "Abhishek kumar Jain", "link": "https://stackoverflow.com/users/8090331/abhishek-kumar-jain"}, "edited": false, "score": 0, "creation_date": 1496227372, "post_id": 44278367, "comment_id": 75571665, "body": "Yes. I just want to run a Rscript from Excel itself using the VBA."}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 0, "last_activity_date": 1496251765, "creation_date": 1496251765, "answer_id": 44291228, "question_id": 44278367, "link": "https://stackoverflow.com/questions/44278367/running-r-script-in-excel-using-shell-command-in-vba/44291228#44291228", "title": "Running R script in Excel using Shell command in VBA", "body": "<p>You should probably take a look at this.</p>\n\n<p><a href=\"http://rcom.univie.ac.at/download.html\" rel=\"nofollow noreferrer\">http://rcom.univie.ac.at/download.html</a></p>\n\n<p>Also, consider doing it this way.</p>\n\n<pre><code>Sub RunRscript()\n'runs an external R code through Shell\n'The location of the RScript is 'C:\\R_code'\n'The script name is 'hello.R'\n\nDim shell As Object\nSet shell = VBA.CreateObject(\"WScript.Shell\")\nDim waitTillComplete As Boolean: waitTillComplete = True\nDim style As Integer: style = 1\nDim errorCode As Integer\nDim path As String\npath = \"RScript C:\\R_code\\hello.R\"\nerrorCode = shell.Run(path, style, waitTillComplete)\nEnd Sub\n</code></pre>\n\n<p>Look closely at the path...</p>\n\n<p><a href=\"https://www.howtogeek.com/181774/why-windows-uses-backslashes-and-everything-else-uses-forward-slashes/\" rel=\"nofollow noreferrer\">https://www.howtogeek.com/181774/why-windows-uses-backslashes-and-everything-else-uses-forward-slashes/</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8090331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qdwWP.jpg?s=128&g=1", "display_name": "Abhishek kumar Jain", "link": "https://stackoverflow.com/users/8090331/abhishek-kumar-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4193, "favorite_count": 1, "accepted_answer_id": 44291228, "answer_count": 1, "score": 0, "last_activity_date": 1497086745, "creation_date": 1496215736, "last_edit_date": 1497086745, "question_id": 44278367, "link": "https://stackoverflow.com/questions/44278367/running-r-script-in-excel-using-shell-command-in-vba", "title": "Running R script in Excel using Shell command in VBA", "body": "<p>I am using some code I took from here; <a href=\"https://stackoverflow.com/questions/40349796/run-r-function-in-vba-macro\">Run R function in VBA macro</a></p>\n\n  \n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub RunRscript()\n'runs an external R code through Shell\n'The location of the RScript is 'C:/Users/abhishek.b.jai/Downloads/data'\n'The script name is 'testcode.R'\nDim shell As Object\nSet shell = VBA.CreateObject(\"WScript.Shell\")\nDim waitTillComplete As Boolean: waitTillComplete = True\nDim style As Integer: style = 1\nDim errorCode As Integer\nDim path As String\npath = \"C:/Users/abhishek.b.jai/Downloads/data/testcode.r\"\nerrorCode = shell.Run(path, style, waitTillComplete)\nEnd Sub \n</code></pre>\n\n<p>I'm also using the same code itself but getting the error: Run-time error 429 mentioning \"<strong>ActiveX component can't create object</strong>\". \nPlease help me with this issue.\nThank You!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1496215505, "post_id": 44277960, "comment_id": 75563547, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44008609/dealing-with-split-function-how-to-adjust-for-either-return-tab-input\">Dealing with Split() function: how to adjust for either return/tab input</a>  (This must be a popular scanner!)"}], "answers": [{"tags": [], "owner": {"reputation": 392, "user_id": 8088127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b4f2e6673fa736e8d09cf39748c47e?s=128&d=identicon&r=PG&f=1", "display_name": "oviemoses", "link": "https://stackoverflow.com/users/8088127/oviemoses"}, "is_accepted": true, "score": 0, "last_activity_date": 1496214750, "creation_date": 1496214750, "answer_id": 44278039, "question_id": 44277960, "link": "https://stackoverflow.com/questions/44277960/altering-access-to-use-either-tab-return-as-a-delimiter-for-split-function/44278039#44278039", "title": "Altering Access to use either tab/return as a delimiter for split() function", "body": "<p>The second parameter of the Split() function is called Delimiter. This can be set to a single space, multiple spaces (as in your example) or even a tab character (vbTab in VBA). It's very flexible.</p>\n"}], "owner": {"reputation": 1, "user_id": 8080722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e9c685cf110d365b8a8624beadae7d5?s=128&d=identicon&r=PG&f=1", "display_name": "Derick", "link": "https://stackoverflow.com/users/8080722/derick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 44278039, "answer_count": 1, "score": -1, "last_activity_date": 1496214750, "creation_date": 1496214507, "last_edit_date": 1496214679, "question_id": 44277960, "link": "https://stackoverflow.com/questions/44277960/altering-access-to-use-either-tab-return-as-a-delimiter-for-split-function", "title": "Altering Access to use either tab/return as a delimiter for split() function", "body": "<pre><code>Dim InputString() As String\nDim i As Integer\nInputString = Split(InputName, \"    \")\nFor i = 0 To UBound(InputString)\n    CurrentDb.Execute \"INSERT INTO InventoryInputT(InputID) VALUES ('\" &amp; InputString(i) &amp; \"')\"\nNext i\n</code></pre>\n\n<p>Thus, an entry of </p>\n\n<pre><code>data1 data2 data3\n</code></pre>\n\n<p>In the textbox of the form resulted in a table input of</p>\n\n<pre><code>record1   data1\nrecord2   data2\nrecord3   data3\n</code></pre>\n\n<p>Which is desired. The scanner we purchased uses either a 'tab' delimiter or a 'return'... it can also use 'add jump line' but I don't know what that means and it seems to be similar to return (on the surface)</p>\n\n<p>Is there any way I can alter my code to either:</p>\n\n<p>1) use the tab function\n- the issue here is if the data in the scanner is represented as: 'data1 [tab] data2 [tab] data3'</p>\n\n<p>and then I upload that to the textbox, access seems to read the data as:\n-input 'data1'\n-execute [tab] (which means it navigates out of my textbox to whatever the next button is)\n... because it has navigated out of the textbox it can no longer enter 'data2' in the textbox... as such I don't know if this can be solved</p>\n\n<p>2) Can I use the return setup as it allows each data entry to have its own unique line in the textbox\n- can I adjust my code so it sets each line of the textbox to a value of i and then runs through my execute code? Example:</p>\n\n<p>data entered (as displayed in textbox)</p>\n\n<pre><code>data1\ndata2\ndata3\n</code></pre>\n\n<p>Get code to read it as:</p>\n\n<pre><code>data1 = line1 = i=0 - execute to table\ndata2 = line2 = i=1 - execute to table\ndata3 = line3 = i=2 - execute to table\n</code></pre>\n\n<p>or something along those lines?</p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1496215689, "post_id": 44277801, "comment_id": 75563666, "body": "Plenty of answers related to conditional formatting. Find what best fits your needs and if you get stuck post your code for assistance. <a href=\"https://stackoverflow.com/search?q=excel+conditional+formatting\">stackoverflow.com/search?q=excel+conditional+formatting</a>"}, {"owner": {"reputation": 7, "user_id": 6006421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wNeVyf1uDWI/AAAAAAAAAAI/AAAAAAAAAMM/k13sz6RdwVg/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/6006421/will"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1496227131, "post_id": 44277801, "comment_id": 75571504, "body": "I tried using if else function but no gain..."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6006421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wNeVyf1uDWI/AAAAAAAAAAI/AAAAAAAAAMM/k13sz6RdwVg/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/6006421/will"}, "edited": false, "score": 0, "creation_date": 1496723826, "post_id": 44290357, "comment_id": 75763178, "body": "Thanks a lot..it works...can I get one more help pls....In the same worksheet, I have 5 columns, 1st column contain the file name. I hv to split the file name in team,branch,location and week wise in preceding columns. after that hv to apply filter and first filter on week from A to Z then on location A to Z. I hv 3 weeks data in each report. At the end of the last row, I want to add 3 more row of respective weeks and sum the respective weeks data."}, {"owner": {"reputation": 7, "user_id": 6006421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wNeVyf1uDWI/AAAAAAAAAAI/AAAAAAAAAMM/k13sz6RdwVg/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/6006421/will"}, "edited": false, "score": 0, "creation_date": 1496725156, "post_id": 44290357, "comment_id": 75763553, "body": "each column for last 3 rows of weeks have different formula to be calculated from respective column... pls suggest"}, {"owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "reply_to_user": {"reputation": 7, "user_id": 6006421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wNeVyf1uDWI/AAAAAAAAAAI/AAAAAAAAAMM/k13sz6RdwVg/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/6006421/will"}, "edited": false, "score": 0, "creation_date": 1496744384, "post_id": 44290357, "comment_id": 75774393, "body": "@Will This seems to be a different question. Please mark this answer as correct to make this question resolved. I suggest you to open another question with the complete details."}], "tags": [], "owner": {"reputation": 3732, "user_id": 7676310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ssFxM.jpg?s=128&g=1", "display_name": "Gowtham Shiva", "link": "https://stackoverflow.com/users/7676310/gowtham-shiva"}, "is_accepted": true, "score": 0, "last_activity_date": 1496248883, "creation_date": 1496248883, "answer_id": 44290357, "question_id": 44277801, "link": "https://stackoverflow.com/questions/44277801/macro-for-conditional-formatting/44290357#44290357", "title": "Macro For Conditional Formatting", "body": "<p>If <code>E3</code> in <code>Sheet2</code> is 50 and <code>F3</code> is 60,</p>\n\n<p><a href=\"https://i.stack.imgur.com/kNT5c.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kNT5c.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub highlightcol()\nDim i As Long\nFor i = 1 To Cells(Rows.Count, \"M\").End(xlUp).Row\n    If Cells(i, \"M\") &lt; Sheets(\"Sheet2\").Range(\"E3\") Then\n        Cells(i, \"M\").Interior.Color = vbRed\n    ElseIf Cells(i, \"M\") &gt; Sheets(\"Sheet2\").Range(\"F3\") Then\n        Cells(i, \"M\").Interior.Color = vbGreen\n    Else\n        Cells(i, \"M\").Interior.Color = vbYellow\n    End If\nNext i\nEnd Sub\n</code></pre>\n\n<p>This simple code highlights all values in <code>Column M</code> based on conditions.</p>\n"}], "owner": {"reputation": 7, "user_id": 6006421, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wNeVyf1uDWI/AAAAAAAAAAI/AAAAAAAAAMM/k13sz6RdwVg/photo.jpg?sz=128", "display_name": "Will", "link": "https://stackoverflow.com/users/6006421/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1366, "favorite_count": 0, "accepted_answer_id": 44290357, "answer_count": 1, "score": -3, "last_activity_date": 1496248883, "creation_date": 1496214049, "last_edit_date": 1531164843, "question_id": 44277801, "link": "https://stackoverflow.com/questions/44277801/macro-for-conditional-formatting", "title": "Macro For Conditional Formatting", "body": "<p>Can anybody tell the macro for conditional formatting, like I have an excel which contains 2 worksheets, I need to format data in column M which is in % as pet the criteria given in another worksheet say Target(E,F columns). </p>\n\n<p>Eg. If value of M5 is less than E3 then Background color of M5 should be red, if it is greater than F3 then M5 should be green and if value of M5 is in between E3 &amp; F3 then color of M5 should be amber. </p>\n\n<p>Pls help with this.</p>\n"}, {"tags": ["oracle", "excel", "vba"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1496216211, "post_id": 44277709, "comment_id": 75564003, "body": "Which ODBC driver do you use? Microsoft or Oracle?"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 2732988, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4e95b5f9fdc464a36f89e2da66a10664?s=128&d=identicon&r=PG&f=1", "display_name": "user2732988", "link": "https://stackoverflow.com/users/2732988/user2732988"}, "is_accepted": false, "score": 0, "last_activity_date": 1496275842, "creation_date": 1496275842, "answer_id": 44296516, "question_id": 44277709, "link": "https://stackoverflow.com/questions/44277709/trouble-creating-odbc-driver-for-oracle-installed-on-a-remote-server/44296516#44296516", "title": "Trouble creating ODBC Driver for oracle installed on a remote server", "body": "<p>I was able to connect using this connection string.</p>\n\n<p>host:port/servicename</p>\n\n<p>Thank you.</p>\n"}], "owner": {"reputation": 71, "user_id": 2732988, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/4e95b5f9fdc464a36f89e2da66a10664?s=128&d=identicon&r=PG&f=1", "display_name": "user2732988", "link": "https://stackoverflow.com/users/2732988/user2732988"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496275842, "creation_date": 1496213751, "last_edit_date": 1531161705, "question_id": 44277709, "link": "https://stackoverflow.com/questions/44277709/trouble-creating-odbc-driver-for-oracle-installed-on-a-remote-server", "title": "Trouble creating ODBC Driver for oracle installed on a remote server", "body": "<p>I am trying to implement a vlookup functionality from my excel sheet to an oracle (11G) database.</p>\n\n<p>I was able to establish a connection to the database using the below connection string, but I am able to only download a copy of the table.</p>\n\n<p>(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=hostname)(PORT=1521))(CONNECT_DATA=(SID=sid)))</p>\n\n<p>I was looking at this post which suggests to create a ODBC data source to perform a vlookup.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20977348/excel-vlookup-incorporating-sql-table\">Excel vlookup incorporating SQL table</a></p>\n\n<p>Can someone please let me know if I can create an ODBC data source to an oracle instance on a remote machine, if so what is the connection string format that I should be using as the below format doesnt seem to work.</p>\n\n<p>(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=hostname)(PORT=1521))(CONNECT_DATA=(SID=sid)))</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5653808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01e2404bea70aeb67e6c4a367684581?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/5653808/amit"}, "edited": false, "score": 0, "creation_date": 1496306867, "post_id": 44276850, "comment_id": 75610635, "body": "Thank you very much @nightcrawler, the coding is giving me new things to learn. Happy :)"}], "tags": [], "owner": {"reputation": 1956, "user_id": 1651993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/782470992533de2a6fee3360cf08a5e6?s=128&d=identicon&r=PG", "display_name": "nightcrawler23", "link": "https://stackoverflow.com/users/1651993/nightcrawler23"}, "is_accepted": false, "score": 0, "last_activity_date": 1496210655, "creation_date": 1496210655, "answer_id": 44276850, "question_id": 44275899, "link": "https://stackoverflow.com/questions/44275899/name-of-the-file-inside-the-excel-file-cell-using-vba/44276850#44276850", "title": "Name of the file inside the excel file cell using VBA", "body": "<p>Try This</p>\n\n<pre><code>Sub t()\n    Dim Source As String\n    Dim StrFile As String\n    Dim wb As Workbook\n\n    'do not forget last backslash in source directory.\n    Source = \"C:\\Users\\Admin\\Desktop\\VBA\\\"\n    StrFile = Dir(Source)\n\n    Do While Len(StrFile) &gt; 0\n        Set wb = Workbooks.Open(Source &amp; StrFile)\n        wb.ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0) = wb.Name\n        StrFile = Dir()\n        wb.Close (True)\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1496227864, "post_id": 44276949, "comment_id": 75572016, "body": "I&#39;d add the assumption that column A of sheet 1 has a value on every row as you&#39;re using <code>COUNTA</code> to find the last row.  Would be better to use something like <code>Range(&quot;A&quot; &amp; Rows.Count).End(xlUp)</code>."}, {"owner": {"reputation": 1, "user_id": 5653808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01e2404bea70aeb67e6c4a367684581?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/5653808/amit"}, "edited": false, "score": 0, "creation_date": 1496306810, "post_id": 44276949, "comment_id": 75610590, "body": "Thank you so much SuShuang, the code is working absolutely fine."}], "tags": [], "owner": {"reputation": 190, "user_id": 5927134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/872d62710be12a87366b857a314b52c3?s=128&d=identicon&r=PG&f=1", "display_name": "SuShuang", "link": "https://stackoverflow.com/users/5927134/sushuang"}, "is_accepted": false, "score": 0, "last_activity_date": 1496296421, "last_edit_date": 1496296421, "creation_date": 1496210980, "answer_id": 44276949, "question_id": 44275899, "link": "https://stackoverflow.com/questions/44275899/name-of-the-file-inside-the-excel-file-cell-using-vba/44276949#44276949", "title": "Name of the file inside the excel file cell using VBA", "body": "<p>Try something like this.</p>\n\n<p>Assumptions:</p>\n\n<ul>\n<li>The Excel file name will be pasted always in the first Sheet - in case the specific sheets are naming always in the same way change lines <code>Sheets(1)</code> with <code>Sheets(\"YourName\")</code></li>\n<li>Every row in table from column A in Sheets(1) is not empty as I'm using <code>COUNTA</code> function (thx @Darren Bartrup-Cook)</li>\n</ul>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub InsertFileName()\n\nDim strFolderPath As String\nDim lngLastRow As Long\nDim FileName As String\nDim WorkBk As Workbook\nDim ErrNumbers As Integer\n\n'Choose folder with Excel files\nstrFolderPath = GetFolder(ThisWorkbook.Path) &amp; \"\\\"\n\n'Loop through all Excel files in FolderPath\nFileName = Dir(strFolderPath &amp; \"*.xl*\")\nDo While FileName &lt;&gt; \"\"\n\n    'Open Excel file\n    Set WorkBk = Workbooks.Open(strFolderPath &amp; FileName)\n\n    'Find the last row in A column\n    On Error Resume Next\n    lngLastRow = Application.WorksheetFunction.CountA(WorkBk.Sheets(1).Range(\"A:A\")) + 1\n    If lngLastRow = 1 Then\n        ErrNumbers = ErrNumbers + 1\n        Err.Clear\n        GoTo NextWkb\n    End If\n\n    WorkBk.Sheets(1).Range(\"A\" &amp; lngLastRow).Value = WorkBk.Name\nNextWkb:\n        'Close file and save changes\n        WorkBk.Close True\n        'Next file\n        FileName = Dir()\n    Loop\n\nIf ErrNumbers &lt;&gt; 0 Then\n    MsgBox \"There were some problems with Excel files. Check if there is some empty sheet or empty A column in one or more Excel files and try again\"\nElse\n    MsgBox \"Everything went fine!\"\nEnd If\n\n\nEnd Sub\n\n\nFunction GetFolder(strPath As String) As String\nDim fldr As FileDialog\nDim sItem As String\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nWith fldr\n    .Title = \"Select a Folder\"\n    .AllowMultiSelect = False\n    .InitialFileName = strPath\n    If .Show &lt;&gt; -1 Then GoTo NextCode\n    sItem = .SelectedItems(1)\nEnd With\nNextCode:\nGetFolder = sItem\nSet fldr = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5653808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01e2404bea70aeb67e6c4a367684581?s=128&d=identicon&r=PG&f=1", "display_name": "Amit", "link": "https://stackoverflow.com/users/5653808/amit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496296421, "creation_date": 1496206299, "last_edit_date": 1496224903, "question_id": 44275899, "link": "https://stackoverflow.com/questions/44275899/name-of-the-file-inside-the-excel-file-cell-using-vba", "title": "Name of the file inside the excel file cell using VBA", "body": "<p>I need a VBA where it updates the \"name of the excel file\" inside that particular \"excel file\". There are 12 files in the folder. The path for this folder is D:\\Amit. Name of those 12 files are \"Cash Report as on 11-05-2017 0000Hrs\" starting from Midnight (that's why 0000Hrs) and it increases by 2 hours making it 0200Hrs, 0400Hrs etc. We prepare these files daily after every 2 hours. Sometimes it does happen that we run the file after 3 hours making it 0500Hrs instead of 0400Hrs just after 0200Hrs. What I need is a VBA file which opens all these 12 files and in column A in the last row of each respective file, it mentions the name of that particular file. \nEg. it should open all 12 files and then in the first file named Cash Report as on 11-05-2017, in the last row of column A of this file - it should mention the name of this particular file. </p>\n\n<p>So if the VBA opened file \"Cash Report as on 11-05-2017 0400Hrs\" then in the last cell of the column A just after the text or data in the cell, using offset the very below blank cell should have the name of this file as \"Cash Report as on 11-05-2017 0000Hrs\". Likewise, need something like this for all the files which open up each individual file and update the respective file name inside the last row of column A.</p>\n\n<p>I was trying some of the codes but it's still in bits and pieces. </p>\n\n<pre><code>Dim Source As String\n    Dim StrFile As String\n\n    'do not forget the last backslash in the source directory.\n    Source = \"C:\\Users\\Admin\\Desktop\\VBA\\\"\n    StrFile = Dir(Source)\n\n    Do While Len(StrFile) &gt; 0\n        Workbooks.Open Filename:=Source &amp; StrFile\n        StrFile = Dir()\n    Loop\n\n    fldr = Activeworkbook.Path \n Dt = Application.InputBox(\"Enter Date as 'dd-mm-yyyy' \", format(Now,\" dd-mm-yyyy\"\n Workbooks.open Filename:= fldr &amp; \"\\Cash Report as on\" &amp; 0400 &amp; \"Hrs.xlsx\"\n Range(\"A1\").End(xlDown).Select\n Offset(1).Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1496205485, "post_id": 44275677, "comment_id": 75558708, "body": "What is the value of LR when it crashes?"}, {"owner": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1496205745, "post_id": 44275677, "comment_id": 75558793, "body": "Sorry I don&#39;t understand (new to vba). I&#39;ve declared LR and then used it to find the last row in column A. I haven&#39;t set it to a particular cell."}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1496205994, "post_id": 44275677, "comment_id": 75558885, "body": "Put <code>Debug.Print LR</code> right before the problematic line and the results will be printed in the immediate window (open it from the View menu)."}, {"owner": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1496206400, "post_id": 44275677, "comment_id": 75559022, "body": "I added it right above the last line which is causing the error and re-ran the code. Received a &quot;1&quot; in the immediate pane. Don&#39;t really know what than means.."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496211555, "post_id": 44275677, "comment_id": 75561244, "body": "Try <code>LR = Sheets(&quot;AOL DATA&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code> and then check the value of LR"}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1496213405, "post_id": 44275677, "comment_id": 75562214, "body": "I don&#39;t think you can autofill a range that is not a single row or single column."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1496214908, "post_id": 44275677, "comment_id": 75563160, "body": "Qualify your ranges with a sheet object. It looks like you&#39;re selecting a range on a different sheet from the active sheet and then trying to autofill a range on another sheet."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "edited": false, "score": 0, "creation_date": 1496293872, "post_id": 44278252, "comment_id": 75603397, "body": "Thanks Macro Man, however I get an error using your code at the line &quot;aolData.Range(&quot;A&quot; &amp; aolData.Rows.Count).End(xlUp).Offset(1, 0).Value = _.Resize(.Rows.Count - 1, .Columns.Count).Value&quot;  and if i skip it to the autofill part I still get an object error.  Thanks"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "edited": false, "score": 0, "creation_date": 1496296562, "post_id": 44278252, "comment_id": 75604323, "body": "Sorry typo should be <code>aolSheet</code>"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 1, "last_activity_date": 1496296513, "last_edit_date": 1496296513, "creation_date": 1496215402, "answer_id": 44278252, "question_id": 44275677, "link": "https://stackoverflow.com/questions/44275677/run-time-error-1004-application-defined-or-object-defined-error/44278252#44278252", "title": "Run-time Error 1004, Application defined or object-defined error", "body": "<p>You need to qualify your ranges with the actual sheet, otherwise VBA will default to the <code>ActiveSheet</code> object which may not be what you're expecting in your code.</p>\n\n<p>You can re-write your code as follows:</p>\n\n<pre><code>Sub Certainsheets()\n\nDim loanWorkbook As Excel.Workbook\nDim aolSheet     As Excel.Worksheet\nDim dataTable    As Excel.Range\n\nSet loanWorkbook = Workbooks.Open(\"C:\\Users\\asharma\\Desktop\\Loan Application\\Loan Data.xls\")\n\nSet aolSheet = ThisWorkbook.Sheets(\"AOL DATA\")\n\nSet dataTable = loanWorkbook.Sheets(1).Range(\"A1\").CurrentRegion\n\nWith dataTable.Offset(1, 0)\n    aolData.Range(\"A\" &amp; aolData.Rows.Count).End(xlUp).Offset(1, 0).Value = _\n    .Resize(.Rows.Count - 1, .Columns.Count).Value\nEnd With\n\nloanWorkbook.Close\n\nWith aolSheet\n    .Range(\"G2:M2\").AutoFill .Range(\"G2:M\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row)\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The <code>AutoFill()</code> method requires the source range to be included as part of the destination range. I suspect because of your code's reliance on <code>ActiveSheet</code> object that you're unknowingly specifying two ranges on different sheets, hence the code fails.</p>\n"}], "owner": {"reputation": 33, "user_id": 8089701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ccf3b069d562a24751728e3f4a89379?s=128&d=identicon&r=PG&f=1", "display_name": "Sky", "link": "https://stackoverflow.com/users/8089701/sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2318, "favorite_count": 0, "accepted_answer_id": 44278252, "answer_count": 1, "score": 2, "last_activity_date": 1496296513, "creation_date": 1496205013, "question_id": 44275677, "link": "https://stackoverflow.com/questions/44275677/run-time-error-1004-application-defined-or-object-defined-error", "title": "Run-time Error 1004, Application defined or object-defined error", "body": "<p>I've searched everywhere to see why I'm getting this error. Basically once I get to the last line the \"Selection.AutoFill Destination:=Range(\"G2:M\" &amp; LR)\" I get the error. The code works if in a separate sub, by itself. Therefore I'm assuming the code above it is somehow affecting it?</p>\n\n<pre><code>Sub Certainsheets()\n\nDim Wb1 As Workbook, wb2 As Workbook, wb3 As Workbook\nDim LR As Long\nDim rTable As Range\nDim strCellREF2Txt As String\nDim strFILEname As String\nDim WS As Worksheet\n\n\n'copy from ThisWorkbook\n'Set wb2 = Workbooks(2)\n Set wb2 = Workbooks.Open(\"C:\\Users\\asharma\\Desktop\\Loan Application\\Loan \n Data.xls\")\n\n'To this\nSet Wb1 = ThisWorkbook\n\n'Copying data from Loan Data file\nSet tbl = wb2.Sheets(1).Range(\"A1\").CurrentRegion\ntbl.Offset(1, 0).Resize(tbl.Rows.Count - 1, tbl.Columns.Count).Copy\n'wb2.Sheets(1).Range(\"A1\").CurrentRegion.Copy\n\n'Pasting data into AOL DATA Tab\nWb1.Activate\nSheets(\"AOL DATA\").Range(\"A10000\").End(xlUp).Offset(1, 0).PasteSpecial \nxlValues\n\n'Wb1.Sheets(1).Range(\"A1\").Select.PasteSpecial Paste:=xlPasteValues, \n'Operation:=xlNone, SkipBlanks _\n    ':=False, Transpose:=False\n\nApplication.CutCopyMode = False\nwb2.Close\n\n'REMOVING DUPLICATES\n'Sheets(\"AOL DATA\").Range(\"$A:$E\").RemoveDuplicates Columns:=1, Header:=xlNo\n\n'This part Autofills the formulas till the last row. \n\nLR = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nSheets(\"AOL DATA\").Range(\"G2:M2\").Select\nApplication.CutCopyMode = False\nSelection.AutoFill Destination:=Range(\"G2:M\" &amp; LR)\n\nEnd sub'\n</code></pre>\n\n<p>Any help would be appreciated</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "sumifs"], "comments": [{"owner": {"reputation": 121, "user_id": 4016507, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a38ed58ef5c1d25cc58f2c33e3d15b?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi  Xu", "link": "https://stackoverflow.com/users/4016507/vivi-xu"}, "edited": false, "score": 1, "creation_date": 1496216973, "post_id": 44274978, "comment_id": 75564445, "body": "Just solved it with this <code>cl.Formula = &quot;=SUMIFS(&#39;&quot; &amp; ws.Name &amp; &quot;&#39;! R[32]C[3] : R[243]C[3],&#39;&quot; &amp; ws.Name &amp; &quot;&#39;!R[33]C[2], C[-1]&quot;</code>. The key is to have space and quotes."}], "answers": [{"tags": [], "owner": {"reputation": 528, "user_id": 6266769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4d17dd331dcfe4464dab3d0fec40d3?s=128&d=identicon&r=PG&f=1", "display_name": "areklipno", "link": "https://stackoverflow.com/users/6266769/areklipno"}, "is_accepted": false, "score": 0, "last_activity_date": 1496216726, "creation_date": 1496216726, "answer_id": 44278675, "question_id": 44274978, "link": "https://stackoverflow.com/questions/44274978/reference-variable-worksheet-in-another-workbook-in-formula-sumifs-using-vba/44278675#44278675", "title": "Reference variable worksheet in another workbook in formula SUMIFS using VBA", "body": "<p>probably you have error in join/concat string...</p>\n\n<p>if you join/concat string you need to use &amp;. for example:</p>\n\n<pre><code>sheetname = \"mysheet\"\nRange(\"D5\").FormulaR1C1 = \"=SUM(\" &amp; sheetname &amp; \"!C[-2])\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121, "user_id": 4016507, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a38ed58ef5c1d25cc58f2c33e3d15b?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi  Xu", "link": "https://stackoverflow.com/users/4016507/vivi-xu"}, "edited": false, "score": 0, "creation_date": 1496283085, "post_id": 44278940, "comment_id": 75600742, "body": "Thank you for your help! <code>Set ws = wb.Sheets(&quot;ASEAN (EUR)&quot;)</code> My worksheet variable contains the workbook I refer to, so I think I don&#39;t have to add the workbook again in the formula, is this right?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 121, "user_id": 4016507, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a38ed58ef5c1d25cc58f2c33e3d15b?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi  Xu", "link": "https://stackoverflow.com/users/4016507/vivi-xu"}, "edited": false, "score": 0, "creation_date": 1496387134, "post_id": 44278940, "comment_id": 75650497, "body": "You have to but if you are putting the formula in the same workbook which has the worksheet as well then you do not need the workbook name."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1496217599, "creation_date": 1496217599, "answer_id": 44278940, "question_id": 44274978, "link": "https://stackoverflow.com/questions/44274978/reference-variable-worksheet-in-another-workbook-in-formula-sumifs-using-vba/44278940#44278940", "title": "Reference variable worksheet in another workbook in formula SUMIFS using VBA", "body": "<p>Couple of things</p>\n\n<ol>\n<li>Which sheet are you referring to here <code>Set rng = Range(\"C2:C\" &amp; usedRow2)</code></li>\n<li>The SumIfs() syntax is <code>=SUMIFS(Sum_range,Criteria_range1,Criteria1    ....)</code>.</li>\n<li>When using SUMIFS() with an external workbook, the formula looks like this</li>\n</ol>\n\n<p><code>\"=SUMIFS('[\" &amp; wb.Name &amp; \"]\" &amp; ws.Name &amp; \"'!\" &amp; YOUR_SUM_RANGE &amp; \",'[\" &amp; wb.Name &amp; \"]\" &amp; ws.Name &amp; \"'!\" &amp; YOUR_CRITERIA_RANGE &amp; \",\" &amp; YOUR_CRITERIA &amp; \")\"</code></p>\n\n<p>You are only using the worksheet name and not the workbook name. </p>\n\n<p><strong>My suggestion</strong>: Manually open the workbook and enter the formula (again manually). Check if the formula works and then use that formula in your code</p>\n"}], "owner": {"reputation": 121, "user_id": 4016507, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08a38ed58ef5c1d25cc58f2c33e3d15b?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi  Xu", "link": "https://stackoverflow.com/users/4016507/vivi-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2533, "favorite_count": 0, "accepted_answer_id": 44278940, "answer_count": 2, "score": 1, "last_activity_date": 1496217599, "creation_date": 1496200076, "last_edit_date": 1531164843, "question_id": 44274978, "link": "https://stackoverflow.com/questions/44274978/reference-variable-worksheet-in-another-workbook-in-formula-sumifs-using-vba", "title": "Reference variable worksheet in another workbook in formula SUMIFS using VBA", "body": "<p>I am trying to add a SUMIFS formula to cells, whereby I need to have variable which refers to another sheet in another workbook. However, this does not work in my code. FYI, I have already opened the workbook with <code>msoFileDialogFilePicker</code>. </p>\n\n<p>Here is the part I have to add the formula, ws is an object of worksheet:</p>\n\n<pre><code>    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n\n    With fd\n    .Title = \"...\"\n    .AllowMultiSelect = False\n\n    If .Show = True Then\n        If .SelectedItems(1) &lt;&gt; vbNullString Then\n            Filename = .SelectedItems(1)\n        End If\n    Else\n        Exit Sub\n    End If\n    Set wb = GetObject(Filename)\n    Set ws = wb.Sheets(\"ASEAN (EUR)\")\n\n    With ws\n        YTDws.Range(\"$A$1:$D$\" &amp; usedRow).AutoFilter Field:=1, Criteria1:=\"Singapore\"\n        If .Range(\"Q20\").Value = \"SINGAPORE\" Then\n        usedRow2 = YTDws.Cells(Rows.Count, 1).End(xlUp).Row\n        Set rng = Range(\"C2:C\" &amp; usedRow2)\n        For Each cl In rng.SpecialCells(xlCellTypeVisible)\n            cl.Select\n            cl.FormulaR1C1 = \"=SUMIFS('&amp;ws.name&amp;'!R[32]C[3]:R[243]C[3],'&amp;ws.name&amp;'!C[2], C[-1])\"\n        Next cl\n        End If\n    End With\n\nEnd With\n</code></pre>\n\n<p>I believe the problem lies with this line of code:</p>\n\n<pre><code>cl.FormulaR1C1 = \"=SUMIFS('&amp;ws.name&amp;'!R[32]C[3]:R[243]C[3],'&amp;ws.name&amp;'!C[2], C[-1])\"\n</code></pre>\n\n<p>I have searched online of many examples of doing and this one I got it from <a href=\"https://stackoverflow.com/questions/10142726/reference-variable-worksheet-in-vlookup-vba\">\nthis post</a>, where I found it similar to my case. However, it seems still not working, the program prompts me to select sheets from the workbook and saying it cannot find the worksheet <code>ws.name</code>. After I select the worksheet, the formula looks like this in the cell: <code>=SUMIFS('[&amp;ws.name&amp;]ASEAN (EUR)'!R[32]C[3]:R[243]C[3],'[&amp;ws.name&amp;]ASEAN (EUR)'!C[2], C[-1])</code>. </p>\n\n<p>Please help me to locate the problem, thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "sumifs"], "comments": [{"owner": {"reputation": 112, "user_id": 5209169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ab414b422c1bddeaef6b3ddb56816cd?s=128&d=identicon&r=PG&f=1", "display_name": "ksauter", "link": "https://stackoverflow.com/users/5209169/ksauter"}, "edited": false, "score": 0, "creation_date": 1496198885, "post_id": 44274705, "comment_id": 75557112, "body": "To me, its not clear whether or not you want to match groomsmen or jolly men. However, I just wondered if you&#39;ve tried the function =SEARCH() or =FIND() depending on you&#39;re wanting a solution that also compares capitalization or not. Another function you might want to consider is =MID() If this problem wont be solved until this evening - I don&#39;t have the time right now - I&#39;ll try to find a solution to this one."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496202056, "post_id": 44274856, "comment_id": 75557784, "body": "Would you also need to allow for <code>&quot;* &quot;&amp;A1&amp;&quot; *&quot;</code> to match for the word in the middle of the cell&#39;s value?"}, {"owner": {"reputation": 435, "user_id": 1462545, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a4a0ac195b4f728059ffff9b465df5d?s=128&d=identicon&r=PG", "display_name": "s.newave", "link": "https://stackoverflow.com/users/1462545/s-newave"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496211041, "post_id": 44274856, "comment_id": 75560983, "body": "As @YowE3K mentioned I also need to catch the case with a space on either side. That said thank you for posting this as I must&#39;ve missed it somehow?!"}], "tags": [], "owner": {"reputation": 126, "user_id": 8072213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd378f644dbfc9c68b2ca1d0f2265cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Juan Avalos", "link": "https://stackoverflow.com/users/8072213/juan-avalos"}, "is_accepted": true, "score": 2, "last_activity_date": 1496199206, "creation_date": 1496199206, "answer_id": 44274856, "question_id": 44274705, "link": "https://stackoverflow.com/questions/44274705/how-to-use-the-sumif-function-in-excel-or-something-similar-to-count-the-occur/44274856#44274856", "title": "How to use the SUMIF function in Excel, or something similar, to count the occurrence of a *word* within a given range?", "body": "<p>It's not clear what you want, but here's a formula that returns 1000 for those values:</p>\n\n<pre><code>=SUMIF($A$1:$A$3,A1,$B$1:$B$3)+SUMIF($A$1:$A$3,\"* \"&amp;A1,$B$1:$B$3)+SUMIF($A$1:$A$3,A1&amp;\" *\",$B$1:$B$3)\n</code></pre>\n\n<p>Inserting a space before the value will look for an exact match of \" men\", by adding the asterisk before, will look for anything that ends in \" men\", the opposite goes for the third part of the formula, looks for anything that starts with \"men \".</p>\n"}], "owner": {"reputation": 435, "user_id": 1462545, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1a4a0ac195b4f728059ffff9b465df5d?s=128&d=identicon&r=PG", "display_name": "s.newave", "link": "https://stackoverflow.com/users/1462545/s-newave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 44274856, "answer_count": 1, "score": 0, "last_activity_date": 1496199206, "creation_date": 1496197937, "question_id": 44274705, "link": "https://stackoverflow.com/questions/44274705/how-to-use-the-sumif-function-in-excel-or-something-similar-to-count-the-occur", "title": "How to use the SUMIF function in Excel, or something similar, to count the occurrence of a *word* within a given range?", "body": "<p>I'm trying to use the SUMIF function in Excel, or anything at this point, to sum up the occurrences of a given word within a given range.</p>\n\n<p>For example:</p>\n\n<pre><code>  A               B\nmen              500\ngroomsmen        500\njolly men        500\n</code></pre>\n\n<p>For the table above I would like to create a SUMIF, or equivalent, function that returns 1000. I've tried </p>\n\n<pre><code>=SUMIF($A$1:$A$3,\"*\"&amp;A1&amp;\"*\",$B$1:$B$3)\n</code></pre>\n\n<p>However that returns 1500 as it matches groomsmen. I've also tried </p>\n\n<pre><code>=SUMIF($A$1:$A$3,A1,$B$1:$B$3)+SUMIF($A$1:$A$3,\" \"&amp;A1,$B$1:$B$3)+SUMIF($A$1:$A$3,A1&amp;\" \",$B$1:$B$3)\n</code></pre>\n\n<p>But that doesn't seem to work as it seems that Excel trims the space character. </p>\n\n<p>Also tried using SUMIFS but that didn't work because the criteria is AND'd together.</p>\n\n<p>I even tried adding regexp support through some addon however the SUMIF function doesn't seem to be that flexible in the criteria it takes so that didn't work either.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "autonumber"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 5, "creation_date": 1496192172, "post_id": 44274023, "comment_id": 75555677, "body": "&quot;I&#39;m creating a database in Excel&quot; - there&#39;s your mistake. Excel is not a database."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1496192434, "post_id": 44274023, "comment_id": 75555724, "body": "any good reason for not using Access ?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1496193956, "post_id": 44274023, "comment_id": 75556073, "body": "(a) Note that your requirement 3 contradicts your requirement 1 - i.e. when a new row is inserted, column B on that row will be blank, requirement 3 says a new id should be generated but requirement 1 says it shouldn&#39;t be.  (b) Does requirement 4 mean that the cell&#39;s value must include the prefix, or simply display the prefix - i.e. would using a number format of <code>&quot;someprefix&quot;0000</code> satisfy the requirement?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496194425, "post_id": 44274023, "comment_id": 75556176, "body": "(c) When the user copies the entire row 5 (for instance) over the top of row 10 (for instance), where both rows had valid ids before the copy, what id should be used in row 10 after the copy?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1496212088, "post_id": 44274023, "comment_id": 75561505, "body": "Do <i>not</i> use Max() to find the next number - use instead a hidden sheet or name to store the current number, and increment it each time a new Id is required."}, {"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "reply_to_user": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 0, "creation_date": 1496212368, "post_id": 44274023, "comment_id": 75561668, "body": "Fully agree with @Dai. Most database management systems have already solved that ID-Auto-Increment problem. And it is <b>not</b> a trivial problem as you see now. And using a database management system must neither be rocket science nor cost expensive in those days."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1496212849, "creation_date": 1496212849, "answer_id": 44277439, "question_id": 44274023, "link": "https://stackoverflow.com/questions/44274023/excel-vba-auto-numbering/44277439#44277439", "title": "Excel VBA : Auto numbering", "body": "<p>Do not use Max() to find the next number - use instead a hidden sheet or name to store the current number, and increment it each time a new Id is required.</p>\n\n<p>For example:</p>\n\n<pre><code>Public Function NextNumber(SequenceName As String)\n    Dim n As Name, v\n    On Error Resume Next\n    Set n = ThisWorkbook.Names(SequenceName)\n    On Error GoTo 0\n\n    If n Is Nothing Then\n        'create the name if it doesn't exist\n        ThisWorkbook.Names.Add SequenceName, RefersTo:=2\n        v = 1\n    Else\n        'increment the current value\n        v = Replace(n.RefersTo, \"=\", \"\")\n        n.RefersTo = v + 1\n    End If\n    NextNumber = v\nEnd Function\n</code></pre>\n\n<p>This allows you to use multiple different sequences as long as you give each one a distinct name.</p>\n\n<pre><code>Dim seq\nseq = NextNumber(\"seqOne\")\n'etc\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8089188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab5dd20a8475d1b76495cf7bd5e8ed8d?s=128&d=identicon&r=PG&f=1", "display_name": "hanae", "link": "https://stackoverflow.com/users/8089188/hanae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 6404, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1496212849, "creation_date": 1496192093, "last_edit_date": 1496192209, "question_id": 44274023, "link": "https://stackoverflow.com/questions/44274023/excel-vba-auto-numbering", "title": "Excel VBA : Auto numbering", "body": "<p>I'm creating a database on Excel, and encountered some problems as I tried to assign auto number to each row.</p>\n\n<p>Requirements are:</p>\n\n<ol>\n<li>generate auto number to each row(on the column A) when column B is not blank.</li>\n<li>the number should be unique and must always be connected to the contents of the same row even when the column is sorted or when new rows are inserted, etc.</li>\n<li>when a new row is inserted (anywhere on the same column), a new number should be assigned (the newest number should be the biggest number)\nif</li>\n<li>possible, the auto number should have a prefix, and number should be displayed in four digits (e.g. 0001, 0011)</li>\n</ol>\n\n<p>I have tried some VBA codes I found from other people's questions (e.g. <a href=\"https://stackoverflow.com/questions/34987185/excel-vba-auto-generating-unique-number-for-each-row\">Excel VBA : Auto Generating Unique Number for each row</a>).</p>\n\n<p>So far, the code below has worked the best, but the requirement (3) and (4) couldn't be solved by that code.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim maxNumber\nIf Not Intersect(Target, Range(\"B:B\")) Is Nothing Then\n' don't run when more than one row is changed\n    If Target.Rows.Count &gt; 1 Then Exit Sub\n' if column A in the current row has a value, don't run\n    If Cells(Target.Row, 1) &gt; 0 Then Exit Sub\n' get the highest number in column A, then add 1 and write to the\n' current row, column A\n    maxNumber = Application.WorksheetFunction.Max(Range(\"A:A\"))\n    Target.Offset(0, -1) = maxNumber + 1\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I'm short of the knowledge of VBA and I hope someone could help me this.\nMany thanks.</p>\n"}, {"tags": ["excel", "certificate", "self-signed", "excel-2016", "vba"], "comments": [{"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496192106, "post_id": 44273982, "comment_id": 75555660, "body": "On the second computer by default the certificate probably shows as invalid or unable to validate.  You might be able to tell Windows to trust it anyway, I&#39;ve never tried that."}, {"owner": {"reputation": 127, "user_id": 4881054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/--fy65s8ppJI/AAAAAAAAAAI/AAAAAAAAAJc/mbpaW8JRqCc/photo.jpg?sz=128", "display_name": "binit joshi", "link": "https://stackoverflow.com/users/4881054/binit-joshi"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496192678, "post_id": 44273982, "comment_id": 75555771, "body": "Its not showing invalid or unable to validate. I was easily able to install it and see it in the certificate store."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496192863, "post_id": 44273982, "comment_id": 75555801, "body": "Look at the details for the cert.  If it&#39;s self-signed there is no certificate chain and in details is where it might show as can&#39;t be validated or untrusted."}, {"owner": {"reputation": 127, "user_id": 4881054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/--fy65s8ppJI/AAAAAAAAAAI/AAAAAAAAAJc/mbpaW8JRqCc/photo.jpg?sz=128", "display_name": "binit joshi", "link": "https://stackoverflow.com/users/4881054/binit-joshi"}, "reply_to_user": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496195191, "post_id": 44273982, "comment_id": 75556345, "body": "@Dave. Says the certificate is OK."}, {"owner": {"reputation": 1273, "user_id": 2287427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b12dacf80e8ab397c3fdcd4f0d49c32d?s=128&d=identicon&r=PG", "display_name": "Dave S", "link": "https://stackoverflow.com/users/2287427/dave-s"}, "edited": false, "score": 0, "creation_date": 1496197570, "post_id": 44273982, "comment_id": 75556820, "body": "My guess then is that setting really means &quot;... except digitally signed macros where the certificate is from a trsuted Certificate Authority like GoDaddy, Thawte or Digicert&quot;"}, {"owner": {"reputation": 7759, "user_id": 3245057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281c2234db530ddfb8c4e7c531714ea?s=128&d=identicon&r=PG", "display_name": "pepo", "link": "https://stackoverflow.com/users/3245057/pepo"}, "edited": false, "score": 0, "creation_date": 1496228907, "post_id": 44273982, "comment_id": 75572699, "body": "@Binit You installed the certificate in My (personal) store. Try to import the certificate to Trusted Root Certificates."}, {"owner": {"reputation": 127, "user_id": 4881054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/--fy65s8ppJI/AAAAAAAAAAI/AAAAAAAAAJc/mbpaW8JRqCc/photo.jpg?sz=128", "display_name": "binit joshi", "link": "https://stackoverflow.com/users/4881054/binit-joshi"}, "reply_to_user": {"reputation": 7759, "user_id": 3245057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281c2234db530ddfb8c4e7c531714ea?s=128&d=identicon&r=PG", "display_name": "pepo", "link": "https://stackoverflow.com/users/3245057/pepo"}, "edited": false, "score": 0, "creation_date": 1496288097, "post_id": 44273982, "comment_id": 75601894, "body": "@Pepo I tried importing the certificate to Trusted Root Certificates. But still didn&#39;t work."}, {"owner": {"reputation": 7759, "user_id": 3245057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6281c2234db530ddfb8c4e7c531714ea?s=128&d=identicon&r=PG", "display_name": "pepo", "link": "https://stackoverflow.com/users/3245057/pepo"}, "edited": false, "score": 0, "creation_date": 1496300471, "post_id": 44273982, "comment_id": 75606405, "body": "@Binit I would also try LocalMachine\\Root store. Or enable <a href=\"https://i.stack.imgur.com/iG0Yj.png\" rel=\"nofollow noreferrer\">CAPI2 event log</a>. There should be information about validation process that has been done when validating macro signature."}], "owner": {"reputation": 127, "user_id": 4881054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/--fy65s8ppJI/AAAAAAAAAAI/AAAAAAAAAJc/mbpaW8JRqCc/photo.jpg?sz=128", "display_name": "binit joshi", "link": "https://stackoverflow.com/users/4881054/binit-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496193145, "creation_date": 1496191642, "last_edit_date": 1531161705, "question_id": 44273982, "link": "https://stackoverflow.com/questions/44273982/how-do-i-use-my-self-signed-certificate-in-another-computer", "title": "How do I use my self signed certificate in another computer?", "body": "<p>I created a self signed certificate in Windows 10 using New-SelfSignedCertificate function as below:</p>\n\n<pre><code>New-SelfSignedCertificate -CertStoreLocation Cert:\\CurrentUser\\My -Subject \"CN=VBA Code Signing\" -KeyAlgorithm RSA -KeyLength 2048 -Provider \"Microsoft Enhanced RSA and AES Cryptographic Provider\" -KeyExportPolicy Exportable -KeyUsage DigitalSignature -Type CodeSigningCert\n</code></pre>\n\n<p>I exported the certificate including the private key and installed in another machine. However, the macro is still being blocked in the second machine. The macro settings is \"Disable all macros except digitally signed macros\"</p>\n\n<p>Does anybody know why is this happening?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1496184517, "post_id": 44272946, "comment_id": 75553934, "body": "If you include your existing code into the question, it will make it much, much easier for someone to show you how to amend it."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1496185109, "creation_date": 1496185109, "answer_id": 44273176, "question_id": 44272946, "link": "https://stackoverflow.com/questions/44272946/vba-to-move-cell-selection/44273176#44273176", "title": "VBA to move cell selection", "body": "<p>The answer to your question is yes. You just need to add criteria on which change event to capture. For example, something like below will work for you:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    On Error GoTo forward\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, Me.[A5]) Is Nothing Then\n        '/* your code to keep selection */\n    ElseIf Not Intersect(Target, Me.[A6]) Is Nothing Then\n        '/* your code to move cell selection down */\n    End If\n\nforward:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7577063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ea51f7ffdfab50c953a936c37485631?s=128&d=identicon&r=PG&f=1", "display_name": "lstrick", "link": "https://stackoverflow.com/users/7577063/lstrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 572, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1496185109, "creation_date": 1496183650, "question_id": 44272946, "link": "https://stackoverflow.com/questions/44272946/vba-to-move-cell-selection", "title": "VBA to move cell selection", "body": "<p>I need a VBA to move the cell selection down one row/cell in column E everytime cell A6 changes. please help! thank you! </p>\n\n<p>I already have a VBA code to keep a cell selection in the same cell if A5 changes. is it possible to have two of these VBA change codes in the same sheet?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496183721, "post_id": 44272741, "comment_id": 75553731, "body": "What have you tried so far?  What happened when you tried it?  Please include the code you used, and a description of the problems you had, or else we won&#39;t be &quot;helping&quot; you, we will just have to do all the work ourselves."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1496186544, "last_edit_date": 1496186544, "creation_date": 1496185472, "answer_id": 44273233, "question_id": 44272741, "link": "https://stackoverflow.com/questions/44272741/partially-renaming-multiple-excel-files/44273233#44273233", "title": "Partially renaming multiple Excel files", "body": "<p><strong>Edit1:</strong> Use <code>Name As</code> statement</p>\n\n<p>You can use <code>Name As</code> method like this:</p>\n\n<pre><code>'/* Syntax: Name [oldfilename] As [newfilename] */\n'/* where oldfilename and newfilename are full file paths */\nName \"C:\\Test\\2017_06 Jun QFR Planning.xlsx\" As \"C:\\Test\\2017_06 Jun QCR Planning.xlsx\"\n</code></pre>\n\n<p>If you have a lot of files, then you can incorporate a loop.<br></p>\n\n<pre><code>Dim xlFile As Variant\nDim nFile As String\n\nxlFile = Dir(\"C:\\Test\\*.xls*\") '/* Folder that contains the files */\n\nDo While xlFile &lt;&gt; \"\" '/* check if anything is returned */\n    If InStr(xlFile, \"QFR\") &lt;&gt; 0 Then '/* check if there is 'QFR' in the filename\n        nFile = VBA.Replace(xlFile, \"QFR\", \"QCR\") '/* replace if there is */\n        Name xlFile As nFile '/* rename the file */\n    End If\n    xlFile = Dir '/* Test for more */\nLoop\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4707904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdc82ae6a153c8173f9749f493aad805?s=128&d=identicon&r=PG&f=1", "display_name": "shamkris", "link": "https://stackoverflow.com/users/4707904/shamkris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 532, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496186544, "creation_date": 1496182283, "last_edit_date": 1531164843, "question_id": 44272741, "link": "https://stackoverflow.com/questions/44272741/partially-renaming-multiple-excel-files", "title": "Partially renaming multiple Excel files", "body": "<p>I need help regarding renaming of excel sheets partially . \nI have about 40 of these which needs partial renaming every month . </p>\n\n<p>For eg :</p>\n\n<pre><code>     2017_06 Jun QFR Planning File,\n\n     2017_06 Jun QFR Analytics File,\n\n     2017_06 Jun QFR Customer Service File\n</code></pre>\n\n<p>would need to be renamed to </p>\n\n<pre><code>     2017_07 Jul QCR Planning File\n\n     2017_07 Jul QCR Analytics File  \n\n     2017_07 Jul QCR Customer Service File . \n</code></pre>\n\n<p>Please help me in automating this. I tried looking online but every VBA code seems to change the name entirely . I want the files to have their respective file name and be successful in partially renaming them. </p>\n\n<p>Thank you very much in advance for the help. </p>\n"}, {"tags": ["sql", "vba", "excel", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "is_accepted": false, "score": 1, "last_activity_date": 1496213092, "creation_date": 1496213092, "answer_id": 44277502, "question_id": 44272632, "link": "https://stackoverflow.com/questions/44272632/sql-embedded-query-range-of-cells-for-parameter-excel-2010/44277502#44277502", "title": "sql embedded query range of cells for parameter excel 2010", "body": "<p>Try: </p>\n\n<pre><code>Sub SQL()\nDim strSQL\nstrSQL = \"select distinct k.USN ,k.is_commodity ,k.Import_SKU\" &amp; _\n     \"from k\" &amp; _\n     \"where k.usn in ('\" &amp; Join(Application.Transpose(Range(\"A9:A69\").Value), \"','\") &amp; \"')\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8088808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f95bccdaeff90165924d761dd9f1b825?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica", "link": "https://stackoverflow.com/users/8088808/jessica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496213092, "creation_date": 1496181536, "question_id": 44272632, "link": "https://stackoverflow.com/questions/44272632/sql-embedded-query-range-of-cells-for-parameter-excel-2010", "title": "sql embedded query range of cells for parameter excel 2010", "body": "<p>I am trying to pass a range of cells through a parameter, but whenever I do, whether I make a list box or concatenate all the values, my output is empty.</p>\n\n<p>Here is my SQL query:\n        select distinct\n        k.USN \n        ,k.is_commodity\n        ,k.Import_SKU\n        from ods..SKU k\n        where k.usn in (?)</p>\n\n<p>My parameters are in Sheet1, cells A9:A69</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1496245115, "post_id": 44279743, "comment_id": 75584857, "body": "Oh that sounds like a good solution (saving to another table).  Would I run my query (for the records), save those records to that &#39;new&#39; table, allow my user to edit as needed on my form, and then when they hit save, it&#39;ll do a save query of those records to my original table?"}, {"owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "reply_to_user": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1496292911, "post_id": 44279743, "comment_id": 75603121, "body": "Yes. Normally for syncing back you&#39;ll need 3 queries - update existing, insert added and and delete deleted rows. You can add to temporary table an additional Yes/No column with indicator that this row was changed by user."}], "tags": [], "owner": {"reputation": 6188, "user_id": 5339178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DL9b.jpg?s=128&g=1", "display_name": "Sergey S.", "link": "https://stackoverflow.com/users/5339178/sergey-s"}, "is_accepted": false, "score": 1, "last_activity_date": 1496219895, "creation_date": 1496219895, "answer_id": 44279743, "question_id": 44272406, "link": "https://stackoverflow.com/questions/44272406/message-box-on-record-change/44279743#44279743", "title": "Message Box on Record Change", "body": "<p>If you really want to ask user about saving changes for each row, ask in <code>Form_BeforeUpdate</code> and in <code>Form_BeforeDelConfirm</code>. Those events will be fired each time when user changes edited record, or when subform with edited records loses focus, or user closes form with data. But this is not good solution because messageboxes will be too annoying. The better way is to copy edited data to temporary table, allow user edit the data and copy back to source table changed data when user clicks \"Save\". It's quite simple if you don't need multi-user data editing, in this case you will need some additional code for avoiding collisions.</p>\n"}], "owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496219895, "creation_date": 1496180414, "question_id": 44272406, "link": "https://stackoverflow.com/questions/44272406/message-box-on-record-change", "title": "Message Box on Record Change", "body": "<p>I have a form that queries records that the user may want to edit. I want the user to only be able to save the record if they've clicked the 'Save' button. Hitting the 'Close' button will prompt the user if they haven't saved yet, and may ask if they want to save. </p>\n\n<p>I'm encountering a problem when the user changes through the records: I want to have a Y/N message box prompt the user for saving the changes they made to the previous record, otherwise their changes will be discarded. I have the following code set up: </p>\n\n<pre><code>Private Sub CmdCloseForm_Click()\n\nIf Me.Dirty Then\n    'checks that needed fields are completed\n    If IsFormValidated = False Then\n        If MsgBox(\"Required fields aren't filled.\" &amp; vbCrLf &amp; \"Would you like to close this form without saving?\", vbYesNo + vbQuestion + vbDefaultButton2, \"Warning\") = vbNo Then\n            Exit Sub\n        End If\n    Else\n        'checks if form has been saved already\n        If mSaved = False Then\n            Select Case MsgBox(\"Form hasn't been saved. Do you want to save and close?\" &amp; vbCrLf &amp; \"If you click 'No' the form will close without saving.\", vbQuestion + vbYesNoCancel, \"Save As\")\n                'selecting yes will save and close form\n                Case vbYes:\n                    mSaved = True\n                'selecting no will close the form w/o saving\n                Case vbNo:\n                    mSaved = False\n                'selecting cancel will cancel out of the prompt\n                Case vbCancel:\n                    Exit Sub\n            End Select\n        ElseIf mSaved = True Then\n            'if form has been previously saved, will finally close the form\n            If MsgBox(\"Would you like to close this form?\", vbYesNo + vbQuestion + vbDefaultButton2, \"Close Form\") = vbNo Then\n                Exit Sub\n            End If\n        End If\n    End If\nEnd If\n\nDoCmd.Close acForm, Me.Name, acSaveNo\nEnd Sub\n\n'won't save automatically unless mSaved is true\nPrivate Sub Form_BeforeUpdate(Cancel As Integer)\n'if mSaved = False then the record won't save\nIf mSaved = False Then\n    Cancel = True\n    Me.Undo\n    Cancel = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I pretty much want the 'CmdCloseForm' Message Boxes to run when the user moves on to the next record. Is there any way to do this? </p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "excel-2007", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496180622, "post_id": 44272158, "comment_id": 75552733, "body": "As an aside, in your <code>If</code> statement, do you want the <code>OnKey</code> events to occur only if the column is not 13?"}, {"owner": {"reputation": 11, "user_id": 8088559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4175ba6b9c344b8f3eef046823ab39?s=128&d=identicon&r=PG&f=1", "display_name": "user8088559", "link": "https://stackoverflow.com/users/8088559/user8088559"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496331998, "post_id": 44272158, "comment_id": 75629624, "body": "<code>If cell.Column = 13 Then x = 1</code> and then swapping the <code>OnKey</code> events also works.  I can&#39;t remember why I did it sort of backwards, but I played with it a lot when troubleshooting."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496343660, "post_id": 44272158, "comment_id": 75635892, "body": "I asked because the way it&#39;s written is the two <code>OnKey</code> events will <i>always</i> occur, no matter what the <code>cell.column</code> is. Is that what you intended?"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8088559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4175ba6b9c344b8f3eef046823ab39?s=128&d=identicon&r=PG&f=1", "display_name": "user8088559", "link": "https://stackoverflow.com/users/8088559/user8088559"}, "is_accepted": false, "score": 0, "last_activity_date": 1498167337, "creation_date": 1498167337, "answer_id": 44709750, "question_id": 44272158, "link": "https://stackoverflow.com/questions/44272158/worksheet-selectionchange-not-firing-from-selection-offset/44709750#44709750", "title": "Worksheet_SelectionChange not firing from Selection.Offset", "body": "<p>I solved it.<br>\nI had changed the function of \"~\" and \"{ENTER}\" only after there had been a selection change in the comments column itself (rather than on the prior height column before the curser arrives in the comments column).  I changed it so that when a selection change was made in the height column, THEN the function of \"~\" and \"{ENTER}\" changes.  So once the data is entered into height, the sheet tabs over to comments, then when the user hits ENTER or ~ it correctly goes back to weight on the next line, rather than enter just going to the next line and then the next time enter is hit it goes to the next row and left 7 columns.  </p>\n\n<p>Changed <code>If cell.Column &lt;&gt; 13 Then x = 1</code> to <code>If cell.Column &lt;&gt; 8 Then x = 1</code>.  </p>\n"}], "owner": {"reputation": 11, "user_id": 8088559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a4175ba6b9c344b8f3eef046823ab39?s=128&d=identicon&r=PG&f=1", "display_name": "user8088559", "link": "https://stackoverflow.com/users/8088559/user8088559"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498167337, "creation_date": 1496179501, "last_edit_date": 1531161705, "question_id": 44272158, "link": "https://stackoverflow.com/questions/44272158/worksheet-selectionchange-not-firing-from-selection-offset", "title": "Worksheet_SelectionChange not firing from Selection.Offset", "body": "<p>I'm trying to use the selection of a cell in a given column as an event.  This works if I physically mouse click or arrow into a cell in the column.  </p>\n\n<p>I would like to though, get to this column by using Selection.Offset or ActiveCell.Offset or something similar.  But when a cell in the given column is selected via this offset function, it doesn't seem to count as a SelectionChange event and therefore doesn't activate my next macro.  </p>\n\n<ol>\n<li>When Data is entered into \"Height\" column, Call Height_To_Comments()</li>\n<li>Height_To_Comments() moves over to \"Comments\" from \"Height\" in same row</li>\n<li>With or without data entry, in \"Comments\" Column, ENTER calls Comments_To_Weight()</li>\n<li><p>Comments_To_Weight() moves back to \"Weight\" from \"Comments\" and down a row</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"H3:H52\")) Is Nothing Then\nCall Height_To_Comments\nEnd If\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\nx = 0\nFor Each cell In Target\nIf cell.Column &lt;&gt; 13 Then x = 1\nApplication.OnKey \"~\"\nApplication.OnKey \"{ENTER}\"\nNext cell\nIf x = 0 Then\nApplication.OnKey \"~\", \"Comments_To_Weight\"\nApplication.OnKey \"{ENTER}\", \"Comments_To_Weight\"\n    End If\nEnd Sub\n\n\nSub Height_To_Comments()\nSelection.Offset(-1, 5).Select\nEnd Sub\n\nSub Comments_To_Weight()\nSelection.Offset(1, -7).Select\nEnd Sub\n</code></pre></li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1496179646, "post_id": 44272147, "comment_id": 75552354, "body": "There must be another issue because this runs fine for me."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1496179648, "post_id": 44272147, "comment_id": 75552355, "body": "<code>Range(&quot;B:D&quot;)</code> may refer to <code>Sheet1</code> in <code>Workbook1</code> or <code>Sheet2</code> in <code>Workbook2</code>, etc. Which one is proper? What i&#39;m trying to say is you have to use code in context!"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1496179689, "post_id": 44272147, "comment_id": 75552371, "body": "Maciej, this should run in all cases since columns B-D will exist on every sheet."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1496179750, "post_id": 44272147, "comment_id": 75552400, "body": "That&#39;s what i&#39;m trying to say ;)"}, {"owner": {"reputation": 1637, "user_id": 3171007, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Nltoh.jpg?s=128&g=1", "display_name": "n8.", "link": "https://stackoverflow.com/users/3171007/n8"}, "edited": false, "score": 0, "creation_date": 1496180124, "post_id": 44272147, "comment_id": 75552556, "body": "Ah.  Well, it&#39;s not the problem, but removing selects is always desirable.  <code>Range(&quot;B:D&quot;).Replace What:=&quot;(&quot;, Replacement:=&quot;&quot;, LookAt:=xlPart, SearchOrder:=xlByRows</code>"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1496187041, "post_id": 44272147, "comment_id": 75554542, "body": "Perhaps your Activesheet is not a Worksheet (<code>?ActiveSheet.Type=xlWorksheet</code>)? Launch Object Browser and search for <code>XlSheetType</code>."}, {"owner": {"reputation": 157, "user_id": 7256728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/97ad93d313a233c39f3b236f74f33713?s=128&d=identicon&r=PG&f=1", "display_name": "KoderM16", "link": "https://stackoverflow.com/users/7256728/koderm16"}, "edited": false, "score": 0, "creation_date": 1496235893, "post_id": 44272147, "comment_id": 75577880, "body": "Unless you are going to do this for a high number of sheets, just use the built in find and replace function in excel. Select columns B,C &amp; D. Find <code>(</code> replace with blank. Find <code>)</code> replace with blank."}], "answers": [{"tags": [], "owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1496179857, "creation_date": 1496179857, "answer_id": 44272258, "question_id": 44272147, "link": "https://stackoverflow.com/questions/44272147/vba-remove-parentheses-from-columns/44272258#44272258", "title": "VBA Remove parentheses from columns", "body": "<p>Does it work if you qualify with Sheet Name, not using Select?</p>\n\n<pre><code>Sheet1.Range(\"B:D\").Replace What:=\"(\", Replacement:=\"\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nSheet1.Range(\"B:D\").Replace What:=\")\", Replacement:=\"\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8088678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202e630da7e88b3ad1944fbab1bcfa45?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent Brown", "link": "https://stackoverflow.com/users/8088678/vincent-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 704, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1496179857, "creation_date": 1496179475, "question_id": 44272147, "link": "https://stackoverflow.com/questions/44272147/vba-remove-parentheses-from-columns", "title": "VBA Remove parentheses from columns", "body": "<p>I'm trying to format a spreadsheet by searching through three columns and removing any parentheses. Currently, I have:</p>\n\n<pre><code>Range(\"B:D\").Select\nSelection.Replace What:=\"(\", Replacement:=\"\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\nSelection.Replace What:=\")\", Replacement:=\"\", LookAt:=xlPart, _\nSearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\nReplaceFormat:=False\n</code></pre>\n\n<p>When I run the code, I get:</p>\n\n<p>Run-time error '1004':\nApplication-defined or object-defined error\"</p>\n"}, {"tags": ["mysql", "excel", "adodb", "vba"], "owner": {"reputation": 555, "user_id": 2488499, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/tbXdo.jpg?s=128&g=1", "display_name": "Mor Sagmon", "link": "https://stackoverflow.com/users/2488499/mor-sagmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1496179413, "creation_date": 1496179413, "last_edit_date": 1531164843, "question_id": 44272126, "link": "https://stackoverflow.com/questions/44272126/how-many-rows-affected-with-mysql-query-using-excel-vba-adodb", "title": "How many rows affected with MySQL query using Excel VBA ADODB", "body": "<p>I'm sending SQL queries from Excel VBA to MySQL, using ADODB. When sending queries for UPDATE, INSERT and DELETE, I would like to be able to return the number of rows affected in the DB, from my VBA function. How can I obtain the number of records affected post SQL execution?</p>\n\n<p>Here's a sample code from a DELETE function:</p>\n\n<pre><code>    Dim rs As New ADODB.Recordset\n    Dim strSQL As String\n\n    strSQL = \"DELETE FROM mytable WHERE mycol&gt;5;\"\n\n    ConnectDB\n    rs.Open strSQL, ConnDB\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1496178651, "post_id": 44271907, "comment_id": 75551923, "body": "You&#39;ll need to utilize the variables <code>lastcol</code> and <code>lastrow</code>. Here are some ways to find these: <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/7/7/&hellip;</a>"}, {"owner": {"reputation": 2423, "user_id": 4043845, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/75de73b9f9301869e5136edf9b663a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4043845/kyle"}, "edited": false, "score": 0, "creation_date": 1496178917, "post_id": 44271907, "comment_id": 75552032, "body": "Does the above code work otherwise?"}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "edited": false, "score": 0, "creation_date": 1496178963, "post_id": 44271907, "comment_id": 75552054, "body": "SpecialCells Method would be a good approach."}, {"owner": {"reputation": 13, "user_id": 8088630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d38fc38d4c1f6a4fc2c5f33289ec75?s=128&d=identicon&r=PG&f=1", "display_name": "wazhere24", "link": "https://stackoverflow.com/users/8088630/wazhere24"}, "edited": false, "score": 0, "creation_date": 1496179010, "post_id": 44271907, "comment_id": 75552075, "body": "It does not throw any errors but it doesn&#39;t do what I want it to do"}, {"owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "edited": false, "score": 0, "creation_date": 1496179418, "post_id": 44271907, "comment_id": 75552249, "body": "It&#39;s not clear what you are asking, if Cell A1=0, do you want Cell A2 to shift up into it&#39;s place, leaving Cell B1 alone?  Or do you want to delete rows where all values in the row are zero?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8088630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d38fc38d4c1f6a4fc2c5f33289ec75?s=128&d=identicon&r=PG&f=1", "display_name": "wazhere24", "link": "https://stackoverflow.com/users/8088630/wazhere24"}, "edited": false, "score": 0, "creation_date": 1496236602, "post_id": 44272137, "comment_id": 75578432, "body": "Thank you, this did what I was looking trying to accomplish, but how does it increment rows? I see the for loop for columns but I don&#39;t understand how the rows increment."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 13, "user_id": 8088630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d38fc38d4c1f6a4fc2c5f33289ec75?s=128&d=identicon&r=PG&f=1", "display_name": "wazhere24", "link": "https://stackoverflow.com/users/8088630/wazhere24"}, "edited": false, "score": 0, "creation_date": 1496236716, "post_id": 44272137, "comment_id": 75578531, "body": "@wazhere24 It does not loop through them. Using specialcells it finds all the empty cells and delete them. This is faster than looping through each cell and deleting them if they are empty. The reason I first find and replace zeros with blank cells is that special cell method cannot find zeros but can find blanks."}, {"owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "reply_to_user": {"reputation": 13, "user_id": 8088630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d38fc38d4c1f6a4fc2c5f33289ec75?s=128&d=identicon&r=PG&f=1", "display_name": "wazhere24", "link": "https://stackoverflow.com/users/8088630/wazhere24"}, "edited": false, "score": 0, "creation_date": 1496236821, "post_id": 44272137, "comment_id": 75578611, "body": "@wazhere24 look at the link for special cells, provided above."}], "tags": [], "owner": {"reputation": 18705, "user_id": 6461462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BlsdV.jpg?s=128&g=1", "display_name": "M--", "link": "https://stackoverflow.com/users/6461462/m"}, "is_accepted": true, "score": 0, "last_activity_date": 1496179445, "creation_date": 1496179445, "answer_id": 44272137, "question_id": 44271907, "link": "https://stackoverflow.com/questions/44271907/finding-and-deleting-zeroes-from-data/44272137#44272137", "title": "Finding and Deleting zeroes from data", "body": "<p>The sub below first <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff194086.aspx\" rel=\"nofollow noreferrer\">find and replaces</a></strong> all the zeros (Match with Whole Cell) with blanks and then remove all the blank cells using <strong><a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">SpecialCells</a></strong> method;</p>\n\n<pre><code>Option Explicit \n\nSub FindAndDeleteZeros()\n\nDim sht As Worksheet\nDim fnd As Variant\nDim rplc As Variant\nDim intCol As Integer\nDim intRow As Integer\n\nfnd = \"0\"\nrplc = \"\"\n\nSet sht = ActiveSheet\n\n  sht.Cells.Replace what:=fnd, Replacement:=rplc, _\n    LookAt:=xlWhole, SearchOrder:=xlByRows, MatchCase:=False, _\n    SearchFormat:=False, ReplaceFormat:=False\n\nintRow = 73\n\nFor intCol = 1 To 50 '1st to 50th column\n\n    sht.Range(sht.Cells(1, intCol), sht.Cells(intRow, intCol)). _ \n    SpecialCells(xlCellTypeBlanks).Delete Shift:=xlUp \n\nNext intCol \n\nEnd Sub \n</code></pre>\n\n<p>Look into the links provided in the comments to avoid from hard-coding the last column and last row in the module.</p>\n"}], "owner": {"reputation": 13, "user_id": 8088630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d38fc38d4c1f6a4fc2c5f33289ec75?s=128&d=identicon&r=PG&f=1", "display_name": "wazhere24", "link": "https://stackoverflow.com/users/8088630/wazhere24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 44272137, "answer_count": 1, "score": 1, "last_activity_date": 1496179445, "creation_date": 1496178435, "last_edit_date": 1496178556, "question_id": 44271907, "link": "https://stackoverflow.com/questions/44271907/finding-and-deleting-zeroes-from-data", "title": "Finding and Deleting zeroes from data", "body": "<p>So I'm at novice level working with VBA and I was attempting to use this code to find zero values and delete them from my data set.</p>\n\n<pre><code>Sub delete_empty_cells()\n    Dim lRow As Long\n    Dim iCol As Long\n    Dim iCntr As Long\n    lRow = 73\n    iCol = 50\n    For iCol = 50 To 1 Step -1\n        For iCntr = lRow To 1 Step -1\n            If Cells(iCntr, 1) = 0 Then\n                Range(iCol &amp; iCntr).Delete Shift:=xlUp\n            End If\n        Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>My data set is 73 by 50, but the size can change so an explanation on how to change the size of the parsed data would be stellar. I actually have very minimal idea on what's going on here so any help would be appreciated.</p>\n"}, {"tags": ["excel", "excel-formula", "multiple-columns", "raw-data", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1496178182, "post_id": 44271823, "comment_id": 75551731, "body": "What have you tried so far? There are similar questions around, and you don&#39;t likely need VBA.  Please show any attempts or code you have."}, {"owner": {"reputation": 22172, "user_id": 2557128, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3cc7fed3c952511b85cfb1c822ecb75?s=128&d=identicon&r=PG", "display_name": "NetMage", "link": "https://stackoverflow.com/users/2557128/netmage"}, "edited": false, "score": 1, "creation_date": 1496186152, "post_id": 44271823, "comment_id": 75554318, "body": "If Column A doesn&#39;t exist, how do you expect to figure out if e.g. B7 is email or phone?"}], "answers": [{"tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 1, "last_activity_date": 1496223198, "creation_date": 1496223198, "answer_id": 44281006, "question_id": 44271823, "link": "https://stackoverflow.com/questions/44271823/one-large-column-to-many-columns-and-rows-in-excel/44281006#44281006", "title": "One large column to many columns and rows in excel", "body": "<p>Following is VBA solution for your problem.</p>\n\n<pre><code>Sub Demo()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Dim lastrow, i, rowNum, colnum As Integer\n    Dim srcSht, destSht As Worksheet\n\n    Set srcSht = ThisWorkbook.Sheets(\"Sheet3\")\n    Set destSht = ThisWorkbook.Sheets(\"Sheet5\")\n\n    lastrow = srcSht.Cells(Rows.Count, \"B\").End(xlUp).Row\n    rowNum = 2\n    colnum = 1\n\n    For i = 1 To lastrow\n        If srcSht.Cells(i, 2).Value = \";\" Then\n            rowNum = rowNum + 1\n            colnum = 1\n        Else\n            destSht.Cells(rowNum, colnum).Value = srcSht.Cells(i, 2).Value\n            colnum = colnum + 1\n        End If\n    Next i\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8088576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/520ccfb22eb338274ead04de9c8e27e9?s=128&d=identicon&r=PG&f=1", "display_name": "Coby Talley", "link": "https://stackoverflow.com/users/8088576/coby-talley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496223198, "creation_date": 1496177986, "last_edit_date": 1531161705, "question_id": 44271823, "link": "https://stackoverflow.com/questions/44271823/one-large-column-to-many-columns-and-rows-in-excel", "title": "One large column to many columns and rows in excel", "body": "<p>My data currently is 5000 rows of contact information from different people; however each person provided inconsistent amounts of information so the data currently looks like this:\nExample Image 1 (Note: Column 'A' doesn't exist, only an example of what the number represent for clarification purposes)</p>\n\n<p><a href=\"https://i.stack.imgur.com/EZ74q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EZ74q.png\" alt=\"Example Image 1\"></a></p>\n\n<p>I separated each person by a semi-colon. How do I transform this one large column to several columns stacked on top of each other on another sheet similar to the photo below:</p>\n\n<p>Ideal Results Sheet 1</p>\n\n<p><a href=\"https://i.stack.imgur.com/P7f5H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P7f5H.png\" alt=\"Ideal Results Sheet 1\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 3, "creation_date": 1496177962, "post_id": 44271805, "comment_id": 75551630, "body": "Issue one delete per table.  Or, you might even want to just drop the tables instead."}, {"owner": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496178260, "post_id": 44271805, "comment_id": 75551764, "body": "truncate is the fastest but will reset your auto incremented fields... but have to be per table"}, {"owner": {"reputation": 4570, "user_id": 1385774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6z25x.jpg?s=128&g=1", "display_name": "maSTAShuFu", "link": "https://stackoverflow.com/users/1385774/mastashufu"}, "edited": false, "score": 0, "creation_date": 1496178342, "post_id": 44271805, "comment_id": 75551815, "body": "if you want to only use one sql command then create a stored procedure that contains truncation/deletion of data per table... call the stored proc in vb to execute"}], "answers": [{"comments": [{"owner": {"reputation": 5439, "user_id": 1736047, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GY4YE.jpg?s=128&g=1", "display_name": "STLDev", "link": "https://stackoverflow.com/users/1736047/stldev"}, "edited": false, "score": 0, "creation_date": 1496180812, "post_id": 44272347, "comment_id": 75552816, "body": "What? No Entity Framework?  One more thing - shouldn&#39;t these deletes be done within a transaction?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 5439, "user_id": 1736047, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GY4YE.jpg?s=128&g=1", "display_name": "STLDev", "link": "https://stackoverflow.com/users/1736047/stldev"}, "edited": false, "score": 0, "creation_date": 1496181872, "post_id": 44272347, "comment_id": 75553176, "body": "Transactions can be employed. Depends on OP&#39;s needs. Open source versions can be ignored. Future readers may find it helpful."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1496232141, "post_id": 44272347, "comment_id": 75575094, "body": "Great! Please accept solution (tick mark to side) to confirm resolution. Alternatives here is to dispel the myth that MS Access only works with VBA."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 5, "last_activity_date": 1496180162, "creation_date": 1496180162, "answer_id": 44272347, "question_id": 44271805, "link": "https://stackoverflow.com/questions/44271805/ms-access-query-to-delete-from-multiple-tables/44272347#44272347", "title": "MS-Access query to DELETE * FROM multiple tables", "body": "<p>MS Access' stored SQL queries only allow one DML or DDL statement at a time. For iterative actions, consider running action query in a loop using application layer code such as VBA or any language that can ODBC connect to .mdb/.accdb file. Also, <code>DELETE</code> does not need asterisk in MS Access SQL.</p>\n\n<p><strong>VBA</strong> <em>(using built-in DAO CurrentDb object)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim var as Variant\n\nFor Each var In Array(\"table4\", \"table7\", \"table8\", \"table9\", \"table10\", \"table11\")\n   CurrentDb.Execute \"DELETE FROM \" &amp; var, dbFailOnError\nNext var\n</code></pre>\n\n<hr>\n\n<h3>OPEN SOURCE ALTERNATIVES</h3>\n\n<p><strong>Python</strong> <em>(using pyodbc module)</em></p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import pyodbc\n\ndatabase = 'C:\\\\Path\\\\To\\\\Database\\\\File.accdb'\nconstr = \"Driver={{Microsoft Access Driver (*.mdb, *.accdb)}};DBQ={0};\".format(database)\n\ndb = pyodbc.connect(constr)\ncur = db.cursor()\n\nfor i in [\"table4\", \"table7\", \"table8\", \"table9\", \"table10\", \"table11\"]:\n    cur.execute(\"DELETE FROM {}\".format(i))\n    db.commit()\n\ncur.close()\ndb.close()\n</code></pre>\n\n<p><strong>PHP</strong>  <em>(ensure pdo_odbc is uncommented in .ini file)</em></p>\n\n<pre class=\"lang-php prettyprint-override\"><code>$database=\"C:\\Path\\To\\Database\\File.accdb\";\n\ntry {\n  $dbh = new PDO(\"odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=$database;\");\n\n  foreach(array(\"table4\", \"table7\", \"table8\", \"table9\", \"table10\", \"table11\") as $tbl){\n       $sql = \"DELETE FROM \".$tbl;    \n       $STH = $dbh-&gt;query($sql);    \n  }\n}\ncatch(PDOException $e) {  \n  echo $e-&gt;getMessage().\"\\n\";\n  exit;\n}\n\n$dbh = null;\n</code></pre>\n\n<p><strong>R</strong> <em>(using RDOBC package)</em></p>\n\n<pre class=\"lang-r prettyprint-override\"><code>library(RODBC)\n\ndatabase &lt;- \"C:\\\\Path\\\\To\\\\Database\\\\File.accdb\"\nconn &lt;- odbcDriverConnect(paste0('Driver={Microsoft Access Driver (*.mdb, *.accdb)};\n                                  DBQ=', database))\n\nlapply(c(\"table4\", \"table7\", \"table8\", \"table9\", \"table10\", \"table11\"),\n          function(t) sqlQuery(conn, paste0(\"DELETE FROM \", t)))\n\nclose(conn)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8088581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff808414150501d9f45e0fcbdc359e9?s=128&d=identicon&r=PG&f=1", "display_name": "car8514", "link": "https://stackoverflow.com/users/8088581/car8514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2932, "favorite_count": 0, "accepted_answer_id": 44272347, "answer_count": 1, "score": 0, "last_activity_date": 1496180162, "creation_date": 1496177926, "question_id": 44271805, "link": "https://stackoverflow.com/questions/44271805/ms-access-query-to-delete-from-multiple-tables", "title": "MS-Access query to DELETE * FROM multiple tables", "body": "<p>In my Access database I have 15 tables. I want to perform [DELETE * FROM table4, table7, table8, table9, table10, table11]. That does not work, but when I run the query with one table it works, it deletes all the records in that table. I would like it to work for more than one table in a single query or in a single Visual Basic module.</p>\n\n<p>Maybe I don't understand SQL and maybe this has to be done with Visual Basic?</p>\n\n<p>Thanks in Advanced.</p>\n"}, {"tags": ["vba", "powerpoint", "office-addins"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3746621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1808fe227c07fdc28c6a702257ff31?s=128&d=identicon&r=PG&f=1", "display_name": "tauneutrino", "link": "https://stackoverflow.com/users/3746621/tauneutrino"}, "is_accepted": false, "score": 0, "last_activity_date": 1496180233, "creation_date": 1496180233, "answer_id": 44272369, "question_id": 44271767, "link": "https://stackoverflow.com/questions/44271767/vbaproject-name-conflict/44272369#44272369", "title": "&quot;VBAProject&quot; name conflict", "body": "<p>So it seems as if I have found the solution to my problem and would like to share it with the community.  It involved a small change to the registry.  [Be careful when dealing w/ the registry and make a back-up prior to any changes.]</p>\n\n<p>From Regedit.exe -> HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Options.  Change value of DebugAddins from 0x00000000 (0) to 0x00000001 (1).  </p>\n\n<p>With this done you will be able to see all the add-ins in the VBA IDE and from there you can change the name 'VBAProject' to something unique.</p>\n"}], "owner": {"reputation": 11, "user_id": 3746621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1808fe227c07fdc28c6a702257ff31?s=128&d=identicon&r=PG&f=1", "display_name": "tauneutrino", "link": "https://stackoverflow.com/users/3746621/tauneutrino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1496180233, "creation_date": 1496177771, "last_edit_date": 1496178405, "question_id": 44271767, "link": "https://stackoverflow.com/questions/44271767/vbaproject-name-conflict", "title": "&quot;VBAProject&quot; name conflict", "body": "<p>My issue involves PowerPoint Add-Ins all being named VBAProject.</p>\n\n<ul>\n<li>Microsoft Office Pro Plus 2010 - PowerPoint 2010 32 bit  </li>\n<li>Running Windows 7 Pro SP1 64 bit</li>\n</ul>\n\n<p>I have several add-ins for PowerPoint saved as .PPAM files.  In any PowerPoint file I can (or should be able to) link add-ins to extend that presentation's functionality.  Each .PPAM file is named differently.  In the VBA IDE however, in the list of references, each add-in is called 'VBAProject'.  There are multiple entries of 'VBAProject' each one showing a path to a different .PPAM file.  The problem is that I cannot add a reference to more than one add-in because the same name assigned to each of these; VBAProject.  This results in a name conflict.  Using the add-in manager from PowerPoint design view I can see all the selected add-ins as being 'active'.  The Add-in manager for the VBA IDE shows no Add-ins.  </p>\n\n<p>Questions:</p>\n\n<ul>\n<li>Is the naming of PowerPoint Add-ins as 'VBAProject' expected for every add-in?</li>\n<li>Is there a way of change the name 'VBAProject' to something unique and hence avoid the name conflicts?</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/GSZ9k.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GSZ9k.jpg\" alt=\"1\"></a></p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 3, "creation_date": 1496177450, "post_id": 44271638, "comment_id": 75551368, "body": "Please tag your question with the database you are using."}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1496272667, "post_id": 44271638, "comment_id": 75598341, "body": "According to a comment, the code is in MS Access, so I fixed the tag."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8088537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d3c1df6f8688858bafd580316fdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Anthrochange", "link": "https://stackoverflow.com/users/8088537/anthrochange"}, "edited": false, "score": 0, "creation_date": 1496178516, "post_id": 44271713, "comment_id": 75551877, "body": "I&#39;ve tried this before and just tried it again, I get an error message saying: Error the filter applied to one or more fields was not valid."}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "reply_to_user": {"reputation": 45, "user_id": 8088537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d3c1df6f8688858bafd580316fdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Anthrochange", "link": "https://stackoverflow.com/users/8088537/anthrochange"}, "edited": false, "score": 1, "creation_date": 1496189389, "post_id": 44271713, "comment_id": 75555103, "body": "@Anthrochange . . . The <code>ORDER BY</code> conditions are not usually referred to as a &quot;filter&quot;.  Perhaps the problem is elsewhere in the query."}, {"owner": {"reputation": 37365, "user_id": 5683823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8551ed09606092a75f36b0638e5c318f?s=128&d=identicon&r=PG&f=1", "display_name": "mathguy", "link": "https://stackoverflow.com/users/5683823/mathguy"}, "reply_to_user": {"reputation": 45, "user_id": 8088537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d3c1df6f8688858bafd580316fdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Anthrochange", "link": "https://stackoverflow.com/users/8088537/anthrochange"}, "edited": false, "score": 0, "creation_date": 1496190478, "post_id": 44271713, "comment_id": 75555346, "body": "@Anthrochange - when you report error message for the purpose of getting help, you should report them EXACTLY as they are written. There are no &quot;fields&quot; in a relational database (certainly not in Oracle database); if you had that exact language in the error message, it may not have been an Oracle error."}, {"owner": {"reputation": 45, "user_id": 8088537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d3c1df6f8688858bafd580316fdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Anthrochange", "link": "https://stackoverflow.com/users/8088537/anthrochange"}, "reply_to_user": {"reputation": 37365, "user_id": 5683823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8551ed09606092a75f36b0638e5c318f?s=128&d=identicon&r=PG&f=1", "display_name": "mathguy", "link": "https://stackoverflow.com/users/5683823/mathguy"}, "edited": false, "score": 0, "creation_date": 1496239259, "post_id": 44271713, "comment_id": 75580461, "body": "@mathguy  that is the exact message I got, I don&#39;t think the problem is elsewhere as that is the only edit I made. The project I&#39;m working on is on Access, I&#39;m using VBA to code it, and calling sql to run the database search for full disclosure."}], "tags": [], "owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "is_accepted": false, "score": 4, "last_activity_date": 1496177526, "creation_date": 1496177526, "answer_id": 44271713, "question_id": 44271638, "link": "https://stackoverflow.com/questions/44271638/how-to-sort-an-sql-query-by-the-number-of-or-results/44271713#44271713", "title": "How to sort an SQL query by the number of OR results", "body": "<p>In any database, you should be able to use the ANSI standard <code>CASE</code> expression:</p>\n\n<pre><code>ORDER BY (CASE WHEN Title LIKE '%Title Keyword 1%' THEN 1 ELSE 0 END +\n          CASE WHEN Title LIKE '%Title Keyword 1%' THEN 1 ELSE 0 END +\n          . . .\n         ) DESC\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 4687335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/32R8r.png?s=128&g=1", "display_name": "dreamwork", "link": "https://stackoverflow.com/users/4687335/dreamwork"}, "is_accepted": false, "score": 0, "last_activity_date": 1496263466, "last_edit_date": 1496263466, "creation_date": 1496263003, "answer_id": 44294231, "question_id": 44271638, "link": "https://stackoverflow.com/questions/44271638/how-to-sort-an-sql-query-by-the-number-of-or-results/44294231#44294231", "title": "How to sort an SQL query by the number of OR results", "body": "<p>Try running the SQL in Oracle SQL Developer first, then later define the string in VBA and execute as a PASS THROUGH query (ADODB connection).</p>\n\n<p>If you're trying to use CASE WHEN in the Jet engine, it will fail. Native Access only allows \"immediate if\" IIF() functions--which you can still throw into the ORDER BY clause (it will just be messy since it's not as powerful as CASE WHEN).</p>\n"}], "owner": {"reputation": 45, "user_id": 8088537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/221d3c1df6f8688858bafd580316fdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Anthrochange", "link": "https://stackoverflow.com/users/8088537/anthrochange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496272656, "creation_date": 1496177175, "last_edit_date": 1496272656, "question_id": 44271638, "link": "https://stackoverflow.com/questions/44271638/how-to-sort-an-sql-query-by-the-number-of-or-results", "title": "How to sort an SQL query by the number of OR results", "body": "<p>I am using VBA and SQLdeveloper to compare multiple keyword inputs against a database. I either search using all ANDs or all ORs, the ANDs has been working fine, but I want the OR's to return based on the number of successful comparisons. The code I have currently seems to return the results in a random fashion, rather than how I want it which is essentially relevancy. Here's an example of my code:</p>\n\n<pre><code>Dim sSQLOrder As String\nsSQLOrder = \" ORDER BY ( Title LIKE '%Title Keyword 1%' + Title LIKE '%Title \nKeyword 2%' + ...) DESC\"\n</code></pre>\n\n<p>From my understanding, this should sort it, but doesn't. I've also tried sorting ASC vs DESC, which changes the order, but not in any productive way. Thanks for reading this.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496236681, "post_id": 44271693, "comment_id": 75578491, "body": "Sorry for he confusion. After i find the instr then i want to take that instr and search it in another cell if you look into attached file, you will understand. If i find the first string in cell 5, then i will search it on cell 1 and if i find the match then i will go to corresponding cell which is 2 and copy pick me and paste it into any empty cell."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496237089, "post_id": 44271693, "comment_id": 75578833, "body": "Sorry but I don&#39;t download pics or files.  And I&#39;m still a little confused on several things.  Do you want to find the first instance of &quot;h&quot; in column F, then find that same value in column A, and then do something with Column B of that same row?"}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496237415, "post_id": 44271693, "comment_id": 75579075, "body": "no i am not telling you to download it, its there you can see it below my code. So i am looping through column F, which contain values(Sam, Blue, Michacle)etc. If i find h which is michacle, i like to take Michacle and search it in Column A. If i find Michacle in column A then go to corresponding Column B and take the value and paste it in another Cell."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496237915, "post_id": 44271693, "comment_id": 75579465, "body": "Yes, my computer is blocked for images because they can carry hacked viruses.  But I changed my answer above.  It will find all instances of &quot;h&quot; in column &quot;F&quot;, search for that entire value in column &quot;A&quot;, and allow you to do whatever you need to a &quot;corresponding cell.&quot;  It is set up to find all instances of that value in column &quot;A&quot; also.  You can easily change that to the first instance of either column &quot;F&quot; or Column &quot;A&quot;."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496238068, "post_id": 44271693, "comment_id": 75579577, "body": "I had to make one change to the answer again"}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496238341, "post_id": 44271693, "comment_id": 75579762, "body": "Mugglins Quick question what is  firstAddress = c.Address means and Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress . Sorry if i am asking you too much, i just don&#39;t want to copy and paste the code, i also want to understand too. So i can learn it."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496239841, "post_id": 44271693, "comment_id": 75580901, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff839746.aspx</a>  The variable firstAddress is the first instance in column &quot;A&quot; where the value from Column &quot;F&quot; is found.  The loop continues through column &quot;A&quot; until it finds all instances of that value, in case there is more than one &quot;Michael&quot; in column &quot;A&quot; for example.  It will find all of them.  The FirstAddress is necessary to make the loop stop when it finds that again."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496241020, "post_id": 44271693, "comment_id": 75581808, "body": "oh ok so once i find the first address it will stop right cause i want it to exit loop soon as it&#39;s find the first michacle. Should i put exit loop in there after Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496241785, "post_id": 44271693, "comment_id": 75582379, "body": "No.  But I changed the answer again to comment out the loop.  Do you want to stop after it finds the first word with an &quot;h&quot; in Column &quot;F&quot; also?  If so just put &quot;Exit For&quot; after your code that changes the corresponding cell."}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496242458, "post_id": 44271693, "comment_id": 75582922, "body": "never mind code is working fine, the way it is. Thanks I am just confuse about the last line Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress"}, {"owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496261819, "post_id": 44271693, "comment_id": 75594327, "body": "another quick question. Did you define c as string or range. cause i did it both and getting an error but if i don&#39;t define it then i do&#39;t get an error. What&#39;s the trick here"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "edited": false, "score": 0, "creation_date": 1496321966, "post_id": 44271693, "comment_id": 75621673, "body": "Dim c as object"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 1, "last_activity_date": 1496241693, "last_edit_date": 1496241693, "creation_date": 1496177414, "answer_id": 44271693, "question_id": 44271264, "link": "https://stackoverflow.com/questions/44271264/how-to-find-a-certain-string-and-then-take-that-string-and-search-it-in-other-ce/44271693#44271693", "title": "How to find a certain string and then take that string and search it in other cell in vba?", "body": "<p>Your question confuses me a little.  I think you want to search for an \"h\" in values of column \"F\" and when found search column \"A\" for the value of found cell in column \"F\".  Then you want to do something with a \"corresponding cell\" </p>\n\n<pre><code>Sub ex_find()\n\n    Dim ws As Worksheet, m As String, lastrow As Long, myArray() As Variant\n    Set ws = ActiveWorkbook.Worksheets(\"Sheet3\")\n    lastrow = ws.UsedRange.Rows.Count + 1\n\n    For i = 1 To lastrow\n        If InStr(1, ws.Range(\"F\" &amp; i).Value, \"h\") &lt;&gt; 0 Then\n            With ws.Range(\"a1:a\" &amp; lastrow)\n                Set c = .Find(ws.Range(\"F\" &amp; i).Value, LookIn:=xlValues)\n                If Not c Is Nothing Then\n                    'firstAddress = c.Address\n                    'Do\n                    'This is where you put your code to change \"corresponding cell\"\n\n\n\n                    'Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress \n\n                End If\n            End With\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 3713336, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6425c70806faa65b4a79711c38b0edd6?s=128&d=identicon&r=PG&f=1", "display_name": "user3713336", "link": "https://stackoverflow.com/users/3713336/user3713336"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 44271693, "answer_count": 1, "score": 0, "last_activity_date": 1496241693, "creation_date": 1496175735, "last_edit_date": 1531164843, "question_id": 44271264, "link": "https://stackoverflow.com/questions/44271264/how-to-find-a-certain-string-and-then-take-that-string-and-search-it-in-other-ce", "title": "How to find a certain string and then take that string and search it in other cell in vba?", "body": "<p>How can I find a particular String and then copy that string, search for it in a different cell then if I find the correct string on the other cell, go to the corresponding cell and copy and paste it into another cell? I keep on getting an error while I am using Instr then another Instr. Any suggestion please anyone. If you see the attached then basically what i am trying to do is First find H which is in michale, then copy michale and search for it in A column, once i find it in A column i go to corresponding column and copy Pick-me* paste it any where in sheet.</p>\n\n<pre><code>     Sub ex_find()\n\n       Dim ws As Worksheet, m As String, lastrow As Long\n          Set ws = ActiveWorkbook.Worksheets(\"Sheet3\")\n           lastrow = ws.UsedRange.Rows.Count + 1\n              For i = 2 To lastrow\n                m = ws.Cells(i, 5)\n                  If InStr(ws.Cells(i, 5), \"h\") &gt; 0 Then\n                    InStr(ws.Cells(i, 1), \"m\") = 0\n\n                  End If\n\n             Next \n    End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Q9c4e.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q9c4e.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "scripting"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496175509, "post_id": 44270985, "comment_id": 75550388, "body": "I assume the links that can&#39;t be updated are within <code>EngineeringDriveSpace.xlsm</code> - have you checked to see which ones it can&#39;t update?  (You possibly have links to files you haven&#39;t loaded or, more likely, which don&#39;t exist.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1496175599, "post_id": 44270985, "comment_id": 75550427, "body": "Why don&#39;t you keep the object references for the books you open, instead of discarding them and then fetching them back from the <code>Workbooks</code> collection? <code>Set FDriveBook = Workbooks.Open(...)</code> ..."}, {"owner": {"reputation": 1, "user_id": 8088418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463692a25216a492e11298c005ef2f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Henry", "link": "https://stackoverflow.com/users/8088418/nicholas-henry"}, "edited": false, "score": 0, "creation_date": 1496175613, "post_id": 44270985, "comment_id": 75550434, "body": "YowE3k: Space A2 llooks like is this:  =IF(DiskReportKDrive.csv!$A2, DiskReportKDrive.csv!$A2, &quot;&quot;) They are being read from each drive&#39;s individual CSV file. Most of the VBA works, so it opens the csv files (which in turn updates the links and the master spreadsheet updates) then closes the csv files, but then the master spreadsheet says it cant update the links because the csv files are closed. If they are all open at the same time all the references update automatically. But i dont want the end user to have to open 6 excel documents to only look at the master one anyways."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1496178322, "post_id": 44270985, "comment_id": 75551806, "body": "So I assume you&#39;ve tried <code>Application.AskToUpdateLinks = False</code> ? I would say go place that and <code>Application.DisplayAlerts = False</code> in the CSV files, but it looks like you&#39;ve got them as CSV files for a reason."}, {"owner": {"reputation": 1, "user_id": 8088418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463692a25216a492e11298c005ef2f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Henry", "link": "https://stackoverflow.com/users/8088418/nicholas-henry"}, "edited": false, "score": 0, "creation_date": 1496232516, "post_id": 44270985, "comment_id": 75575394, "body": "I hadnt tried that one, but it still seems to say &quot;we cant update some of the links in your workbook right now, you can continue without updating their values, or edit the links you think are wrong.&quot; Then when i click edit links it shows each sheet that has a reference to each individual csv file. Only reason why they are csv files is because my script that queries each of the servers drives (5 in total) writes its used space/free space to it&#39;s own csv file."}], "owner": {"reputation": 1, "user_id": 8088418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/463692a25216a492e11298c005ef2f3f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Henry", "link": "https://stackoverflow.com/users/8088418/nicholas-henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496175530, "creation_date": 1496174750, "last_edit_date": 1496175530, "question_id": 44270985, "link": "https://stackoverflow.com/questions/44270985/vba-calling-csv-files", "title": "VBA calling CSV Files", "body": "<p>Here is my scenario. I have a script that runs on a server that exports used space, free space, etc to a csv file.\nI have a master excel.xlsm that calls data from those csv files. But they are external links so it continues to pop up asking to update those links but the files are closed. I have tried several varations of the displayalerts = false, etc. But nothing has worked. Here is my macro that runs everything:</p>\n\n<pre><code>Private Sub Auto_Open()\n\n    'MsgBox \"This Excel Document will open and then close source files to update data.\"\n    'Opens the Source CSV files so the Main Spreadsheet can update its external values.\n    Application.DisplayAlerts = False\n    Workbooks.Open \"\\\\Engineering\\CADD Admin\\EngineeringDriveSpace\\CSV_Docs\\DiskReportFDrive.csv\"\n    Workbooks.Open \"\\\\Engineering\\CADD Admin\\EngineeringDriveSpace\\CSV_Docs\\DiskReportGDrive.csv\"\n    Workbooks.Open \"\\\\Engineering\\CADD Admin\\EngineeringDriveSpace\\CSV_Docs\\DiskReportHDrive.csv\"\n    Workbooks.Open \"\\\\Engineering\\CADD Admin\\EngineeringDriveSpace\\CSV_Docs\\DiskReportJDrive.csv\"\n    Workbooks.Open \"\\\\Engineering\\CADD Admin\\EngineeringDriveSpace\\CSV_Docs\\DiskReportKDrive.csv\"\n\n    'Makes the Main Spreadsheet Active\n    'Activate Worksheet\n    'Workbooks(\"EngineeringDriveSpace.xlsm\").Activate\n    Workbooks.Open \"c:\\users\\nicholas.henry\\Downloads\\EngineeringDriveSpace.xlsm\", UpdateLinks:=xlUpdateLinksAlways\n    'Worksheets(\"MH07_F\").Activate\n    'Sheets(\"MH07_F\").Select\n\n    'Pause Application For Testing\n    'Application.Wait Now + #12:00:01 AM#\n\n    'Closes the Source CSV files.\n\n    Workbooks(\"DiskReportFDrive.csv\").Close SaveChanges:=False\n    Workbooks(\"DiskReportGDrive.csv\").Close SaveChanges:=False\n    Workbooks(\"DiskReportHDrive.csv\").Close SaveChanges:=False\n    Workbooks(\"DiskReportJDrive.csv\").Close SaveChanges:=False\n    Workbooks(\"DiskReportKDrive.csv\").Close SaveChanges:=False\n\n\nEnd Sub\n</code></pre>\n\n<p>Basically im looking for ZERO intervention from the end person opening the link (manager) even though he is tech savvy. What the idea situation would be is, he opens the master spread sheet, it opens all the other CSV files, updates the data, then closes the CSV files and leaves the master sheet open and on top WITHOUT warning him \"we cant update some of the links in your workbook right now\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496174003, "post_id": 44270753, "comment_id": 75549642, "body": "What have you tried? Wouldn&#39;t you just need a line in there saying something like <code>Sheets(&quot;Sheet1&quot;).Range(&quot;A&quot; &amp; Target.row).Offset(1,0).Font.Color = RGB(0,0,0)</code>?  ...what sheet did you put this <code>Worksheet_Change()</code> event in?"}, {"owner": {"reputation": 1, "user_id": 7577063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ea51f7ffdfab50c953a936c37485631?s=128&d=identicon&r=PG&f=1", "display_name": "lstrick", "link": "https://stackoverflow.com/users/7577063/lstrick"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1496174236, "post_id": 44270753, "comment_id": 75549761, "body": "Hi Bruce. this did not work for me.  the worksheet change is in my Sheet7. thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7577063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ea51f7ffdfab50c953a936c37485631?s=128&d=identicon&r=PG&f=1", "display_name": "lstrick", "link": "https://stackoverflow.com/users/7577063/lstrick"}, "edited": false, "score": 0, "creation_date": 1496175127, "post_id": 44270959, "comment_id": 75550194, "body": "This is only working one time. After every change, it should move down one row, creating a list in the end. any suggestions? thanks!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 1, "user_id": 7577063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ea51f7ffdfab50c953a936c37485631?s=128&d=identicon&r=PG&f=1", "display_name": "lstrick", "link": "https://stackoverflow.com/users/7577063/lstrick"}, "edited": false, "score": 0, "creation_date": 1496175186, "post_id": 44270959, "comment_id": 75550218, "body": "@lstrick - It&#39;s unclear - do you want the color to move down one cell <i>regardless</i> of the <code>Target</code> cell in <code>Sheet7</code>?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496175396, "post_id": 44270959, "comment_id": 75550316, "body": "That&#39;s the question .... It wasn&#39;t clear in the first question.  If You select the same cell in Sheet7, you want the black cells in sheet1 to increment down by one more, not just by one row?"}, {"owner": {"reputation": 1, "user_id": 7577063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ea51f7ffdfab50c953a936c37485631?s=128&d=identicon&r=PG&f=1", "display_name": "lstrick", "link": "https://stackoverflow.com/users/7577063/lstrick"}, "edited": false, "score": 0, "creation_date": 1496175425, "post_id": 44270959, "comment_id": 75550331, "body": "When the target cell changes (it changes because things are getting scanned into excel) it will pull the the number in the target A4 to another sheet. i need these numbers scanned from A4 to form a list elsewhere"}, {"owner": {"reputation": 1, "user_id": 7577063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ea51f7ffdfab50c953a936c37485631?s=128&d=identicon&r=PG&f=1", "display_name": "lstrick", "link": "https://stackoverflow.com/users/7577063/lstrick"}, "edited": false, "score": 0, "creation_date": 1496175680, "post_id": 44270959, "comment_id": 75550462, "body": "fully put, numbers get scanned into excel over and over again. the original VBA code keeps the cell selection in place when there is a change to save time for the person scanning. but now, we want to form a list of all &quot;Yes&quot; products (i tell if it is yes based on the output in C4.) these &quot;yes&quot; products, i need to be entered into a list. i am struggling to make this a continuous process when the scanner does not need to stop."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1496176024, "post_id": 44270959, "comment_id": 75550660, "body": "So A4 changes when the user scans something, and you just want to keep a list of everything that was scanned into A4.  Is that right?  Do you want that list to be in Sheet1 column A?"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496174663, "creation_date": 1496174663, "answer_id": 44270959, "question_id": 44270753, "link": "https://stackoverflow.com/questions/44270753/move-selection-down-a-row-and-change-font-color-from-red-to-black-when-there-is/44270959#44270959", "title": "Move selection down a row and change font color from red to black when there is a change to another sheet", "body": "<p>I haven't tested this, but it should be something like this</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Me.Range(\"A4\")) Is Nothing Then\n    Application.EnableEvents = False\n    Me.Range(\"A5\").Value = Target.Value\n    Target.Select\n    Sheet1.Range(\"A\" &amp; Target.row + 1).Interior.Color = RGB(0, 0, 0)\n    Application.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496176289, "creation_date": 1496176289, "answer_id": 44271409, "question_id": 44270753, "link": "https://stackoverflow.com/questions/44270753/move-selection-down-a-row-and-change-font-color-from-red-to-black-when-there-is/44271409#44271409", "title": "Move selection down a row and change font color from red to black when there is a change to another sheet", "body": "<p>Try this one.  Again, untested.  But I commented out the color change in case the text in Sheet1 Column A is black.  You wouldn't be able to see the text if it is.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim lastRow As Long\n\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    If Not Intersect(Target, Me.Range(\"A4\")) Is Nothing Then\n        Application.EnableEvents = False\n        Me.Range(\"A5\").Value = Target.Value\n        Target.Select\n        Sheet1.Range(\"A\" &amp; lastRow + 1).Value = Target.Value\n'        Sheet1.Range(\"A\" &amp; lastRow + 1).Interior.Color = vbBlack\n        Application.EnableEvents = True\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7577063, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8ea51f7ffdfab50c953a936c37485631?s=128&d=identicon&r=PG&f=1", "display_name": "lstrick", "link": "https://stackoverflow.com/users/7577063/lstrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496176289, "creation_date": 1496173783, "question_id": 44270753, "link": "https://stackoverflow.com/questions/44270753/move-selection-down-a-row-and-change-font-color-from-red-to-black-when-there-is", "title": "Move selection down a row and change font color from red to black when there is a change to another sheet", "body": "<p>I have a vba code that works great to keep the selection of one sheet on the same cell when there is a change. </p>\n\n<p>Now, i need a vba code to Move selection down a row and change font color from red to black in another sheet (sheet1 column A) when there is that same change. </p>\n\n<p>Current code:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Me.Range(\"A4\")) Is Nothing Then\nApplication.EnableEvents = False\nMe.Range(\"A5\").Value = Target.Value\nTarget.Select\nApplication.EnableEvents = True\nEnd If\nEnd Sub\n</code></pre>\n\n<p>So, when there is a change to Sheet7 cell A4, i need the selection in Sheet1 Column A to drop one row and change the font color from RED to BLACK.Please help!! </p>\n"}, {"tags": ["vba", "sharepoint", "properties"], "comments": [{"owner": {"reputation": 2222, "user_id": 1498401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de959f8403da285e0a23aabe603c6?s=128&d=identicon&r=PG", "display_name": "tinamou", "link": "https://stackoverflow.com/users/1498401/tinamou"}, "edited": false, "score": 0, "creation_date": 1496209048, "post_id": 44270414, "comment_id": 75560043, "body": "do you mean sharepoint listitem properties for document in document library?"}, {"owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "reply_to_user": {"reputation": 2222, "user_id": 1498401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de959f8403da285e0a23aabe603c6?s=128&d=identicon&r=PG", "display_name": "tinamou", "link": "https://stackoverflow.com/users/1498401/tinamou"}, "edited": false, "score": 0, "creation_date": 1496321008, "post_id": 44270414, "comment_id": 75620926, "body": "Yes, the properties associated with the document on SharePoint. Not the file properties if you opened it up off of the web."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "edited": false, "score": 0, "creation_date": 1496346268, "post_id": 44313185, "comment_id": 75637323, "body": "Thanks for your help! Just to confirm, all this code would be required to access the &quot;title&quot; properties in the snapshot I included in my question?"}, {"owner": {"reputation": 2222, "user_id": 1498401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de959f8403da285e0a23aabe603c6?s=128&d=identicon&r=PG", "display_name": "tinamou", "link": "https://stackoverflow.com/users/1498401/tinamou"}, "reply_to_user": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "edited": false, "score": 0, "creation_date": 1496348843, "post_id": 44313185, "comment_id": 75638760, "body": "proper REST call is required. web request in VBA is required, xml reading is also required :) I&#39;ll update my code to match your filename filter"}], "tags": [], "owner": {"reputation": 2222, "user_id": 1498401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41de959f8403da285e0a23aabe603c6?s=128&d=identicon&r=PG", "display_name": "tinamou", "link": "https://stackoverflow.com/users/1498401/tinamou"}, "is_accepted": false, "score": 0, "last_activity_date": 1496391902, "last_edit_date": 1496391902, "creation_date": 1496336042, "answer_id": 44313185, "question_id": 44270414, "link": "https://stackoverflow.com/questions/44270414/how-to-check-sharepoint-document-properties-using-vba/44313185#44313185", "title": "How to check Sharepoint Document Properties using VBA", "body": "<p>I am assuming SharePoint 2010 and higher version.</p>\n\n<p>Use SharePoint REST Services to get proper data items with desired properties.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/ff798339.aspx\" rel=\"nofollow noreferrer\">REST Services Reference for Sharepoint 2010</a></p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/jj860569.aspx\" rel=\"nofollow noreferrer\">REST API Reference for SharePoint 2013</a></p>\n\n<p>Get items from list using SharePoint 2010:</p>\n\n<p><code>http://lab/_vti_bin/listdata.svc/List1()?$filter=startswith(Title,'foo')&amp;$top=1&amp;$select=Title,Column2,Column3</code></p>\n\n<p>Get items from list using SharePoint 2013</p>\n\n<pre><code>http://lab/_api/web/lists/getbytitle('List1')/items?$filter=startswith(Title,'foo')&amp;$top=1&amp;$select=Title,Column2,Column3\n</code></pre>\n\n<p>Then you have to request this url with VBA (remeber to add references to <code>Microsoft WinHTTP Services, version 5.1</code> and <code>Microsoft XML, v6.0</code>)</p>\n\n<pre><code>URL = \"http://lab/_vti_bin/listdata.svc/List1()?$filter=startswith(Title,'foo')&amp;$top=1&amp;$select=Title,Column2,Column3\"\n\nSet req = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\nreq.Open \"GET\", URL, False\nreq.setRequestHeader \"Content-Type\", \"application/xml\"\nreq.SetCredentials \"login\", \"pass\", 0\nreq.Send\n\nSet objXML = CreateObject(\"Msxml2.DomDocument.6.0\")\nIf Not objXML.LoadXML(req.ResponseText) Then\n    Err.Raise objXML.parseError.ErrorCode, , objXML.parseError.reason\nEnd If\n</code></pre>\n\n<p>XML parsing is for you ;)</p>\n\n<p>/edit </p>\n\n<p>To filter element with your filename, use:</p>\n\n<pre><code>http://lab/_vti_bin/listdata.svc/Library()?$filter=FileLeafRef eq 'FileName.zip'&amp;$select=Title\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 6849473, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/9e04cb8ecb9abe76fcb89d684a2a3e76?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/6849473/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1824, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496391902, "creation_date": 1496172490, "last_edit_date": 1496346221, "question_id": 44270414, "link": "https://stackoverflow.com/questions/44270414/how-to-check-sharepoint-document-properties-using-vba", "title": "How to check Sharepoint Document Properties using VBA", "body": "<p><a href=\"https://i.stack.imgur.com/Jy1nj.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jy1nj.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I am looking to develop code to view the document properties of a file on SharePoint, then later build out this code to see if it matches the document properties of the <code>ActiveWorkbook</code>. Below is a sample of the code I have so far which is able to filter through to the correct document in the SharePoint Library. Does anyone know the function which must be added to <code>objFile</code> to access the SharePoint Document properties?</p>\n\n<pre><code>Sub CheckVersion()\nDim FSO As Object\nSet FSO = CreateObject(\"Scripting.FileSystemObject\")\n\nDim objFile As Object\nDim objDSO As Object\n\nFor Each objFile In FSO.GetFolder(\"\\\\SharePoint\\Library\\\").Files\n    If objFile.Name = \"FileName.zip\" Then\n        MsgBox (objFile.Properties.Title)\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496172661, "post_id": 44270229, "comment_id": 75548834, "body": "The code works for me, but your code differs to what you are saying is the line that crashes (i.e. <code>.RemoveDuplicates Columns:=1, Header:xYes</code> which has <code>Header:xYes</code> instead of the <code>Header:=xlYes</code> in the code)"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496172317, "post_id": 44270308, "comment_id": 75548661, "body": "The <code>Columns</code> parameter doesn&#39;t <b>have</b> to be an array - <code>Columns:=1</code> is fine and is what the macro recorder will generate"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496172497, "post_id": 44270308, "comment_id": 75548753, "body": "@YowE3K, well, i qouted MSDN documentation. This is exactly what has been wrote: <code>Columns - Array of indexes of the columns that contain the duplicate information. If nothing is passed then it assumes all columns contain duplicate information.</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496172868, "post_id": 44270308, "comment_id": 75548971, "body": "Unfortunately, Microsoft&#39;s documentation and Microsoft&#39;s implementation are not always consistent."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1496173287, "post_id": 44270308, "comment_id": 75549225, "body": "@YowE3K, yeah. It&#39;s quite possible. I&#39;ve seen few incompatibilities. This is probably the one of them."}], "tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 1, "last_activity_date": 1496172390, "last_edit_date": 1496172390, "creation_date": 1496172135, "answer_id": 44270308, "question_id": 44270229, "link": "https://stackoverflow.com/questions/44270229/trying-to-remove-duplicates-for-individual-columns-in-a-range-of-columns/44270308#44270308", "title": "Trying to remove duplicates for individual columns in a range of columns", "body": "<p>As per <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193823.aspx\" rel=\"nofollow noreferrer\">MSDN documentation</a> says, you have to pass an array in <code>Columns</code> parameter to <code>RemoveDuplicates</code> method.</p>\n\n<pre><code>ActiveSheet.Range(\"A1:C100\").RemoveDuplicates Columns:=Array(1,2), Header:=xlYes\n</code></pre>\n\n<p>or use defined range: </p>\n\n<pre><code>ActiveSheet.Range(\"A:A100\").RemoveDuplicates\n</code></pre>\n\n<p>Note: using <code>Range(\"A:Z\")</code> without context may provide unexpected results, depending on what sheet is currently active.</p>\n"}], "owner": {"reputation": 47, "user_id": 7834661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b0de85c903d365fad048a7ea7aa6e6c?s=128&d=identicon&r=PG&f=1", "display_name": "S Beard", "link": "https://stackoverflow.com/users/7834661/s-beard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496172390, "creation_date": 1496171800, "last_edit_date": 1496172144, "question_id": 44270229, "link": "https://stackoverflow.com/questions/44270229/trying-to-remove-duplicates-for-individual-columns-in-a-range-of-columns", "title": "Trying to remove duplicates for individual columns in a range of columns", "body": "<p>I am trying to remove duplicates for an individual column in a range of columns in my worksheet.  So far I have gotten this.</p>\n\n<pre><code>Sub removeDups()\nDim col As Range\nFor Each col In Range(\"A:Z\").Columns\n    With col\n        .RemoveDuplicates Columns:=1, Header:=xlYes\n    End With\nNext col\nEnd Sub\n</code></pre>\n\n<p>This continues to give me a 1004 error, and I am guessing its the structure of my</p>\n\n<pre><code>.RemoveDuplicates Columns:=1, Header:xYes\n</code></pre>\n\n<p>line, but I haven't been able to figure that part out.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "edited": false, "score": 0, "creation_date": 1496172156, "post_id": 44270246, "comment_id": 75548575, "body": "Thank u so much for quick response.. Would u please explain what does R+2, C+1 and (1,1) mean?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "edited": false, "score": 0, "creation_date": 1496172477, "post_id": 44270246, "comment_id": 75548741, "body": "<code>Cells(Row,Column)</code> we are just setting the first upper left as B3.  Since R and C start at 1 each we need to move the cell over.  This could also be done with <code>Range(&quot;B3:G11&quot;).Cells(R, C).Address(1,1)</code> which then refers to the range  and not the whole sheet.  the <code>(1,1)</code> makes the reference absolute, <code>(0,0)</code> would return a relative reference."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1496172515, "last_edit_date": 1496172515, "creation_date": 1496171879, "answer_id": 44270246, "question_id": 44270209, "link": "https://stackoverflow.com/questions/44270209/vba-return-cell-address-from-a-range-array/44270246#44270246", "title": "Vba-Return cell address from a range array", "body": "<p>Use this in place of <code>Debug.Print Arr(R, C)</code></p>\n\n<pre><code>Debug.Print Cells(R+2, C+1).Address(1,1)\n</code></pre>\n\n<p>One could also fill an array of ranges:</p>\n\n<pre><code>Dim Arr() As Range\nDim rng As Range\nReDim Arr(1 To Range(\"B3:G11\").Rows.Count, 1 To Range(\"B3:G11\").Columns.Count) As Range\nFor Each rng In Range(\"B3:G11\")\n    Set Arr(rng.Row - 2, rng.Column - 1) = rng\nNext rng\nDim R As Long\nDim C As Long\nFor R = 1 To UBound(Arr, 1)\n    For C = 1 To UBound(Arr, 2)\n        Debug.Print Arr(R, C).Address\n    Next C\nNext R\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 3286479, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1645324892/picture?type=large", "display_name": "user3286479", "link": "https://stackoverflow.com/users/3286479/user3286479"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1688, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496172515, "creation_date": 1496171707, "last_edit_date": 1531164843, "question_id": 44270209, "link": "https://stackoverflow.com/questions/44270209/vba-return-cell-address-from-a-range-array", "title": "Vba-Return cell address from a range array", "body": "<p>I read a range on a worksheet and put it into an array.</p>\n\n<pre><code>Dim Arr() As Variant\nArr = Range(\"B3:G11\")\nDim R As Long\nDim C As Long\nFor R = 1 To UBound(Arr, 1)\n    For C = 1 To UBound(Arr, 2)\n        Debug.Print Arr(R, C)\n    Next C\nNext R\n</code></pre>\n\n<p>This returns the value of the cell. Is there a way to get the address of the cell?!</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": true, "score": 3, "last_activity_date": 1496171658, "creation_date": 1496171658, "answer_id": 44270201, "question_id": 44270091, "link": "https://stackoverflow.com/questions/44270091/filedialog-persists-previous-filters/44270201#44270201", "title": "FileDialog persists previous filters", "body": "<p>You need to clear the filters.</p>\n\n<pre><code>With .Filters\n    .Clear \n    .Add \"Access\", \"*.accdb\", 1\n    '...\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 8088168, "user_type": "registered", "profile_image": "https://graph.facebook.com/143788949498873/picture?type=large", "display_name": "Linda", "link": "https://stackoverflow.com/users/8088168/linda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 44270201, "answer_count": 1, "score": 4, "last_activity_date": 1496172069, "creation_date": 1496171262, "last_edit_date": 1496172069, "question_id": 44270091, "link": "https://stackoverflow.com/questions/44270091/filedialog-persists-previous-filters", "title": "FileDialog persists previous filters", "body": "<p>I am making form in Access database I need to open file dialog window few  times. I just don't get why after I change option value for a few times and open file dialog window it didn't change filters.</p>\n\n<pre><code>Public Sub Command17_Click()\nDim fd As FileDialog\nSet fd = Application.FileDialog(msoFileDialogOpen)\n    With fd\n        .AllowMultiSelect = False\n        If Option18.Value = True Then\n         .Filters.Add \"Access\", \"*.accdb\", 1\n        Else\n        If Option20.Value = True Then\n         .Filters.Add \"Excel\", \"*.xlsx\", 1\n        End If\n        End If\n        .Show\n\n Text0.Value = fd.SelectedItems(1)\n    End With\n    Set fb = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "answers": [{"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 0, "last_activity_date": 1496170355, "creation_date": 1496170355, "answer_id": 44269823, "question_id": 44269698, "link": "https://stackoverflow.com/questions/44269698/if-cell-contains-value-create-chart-in-vba/44269823#44269823", "title": "If Cell contains value, create Chart in VBA", "body": "<p>Put your code in the sheet module and use the worksheet_change subroutine below.  It will determine if all three columns, A, B and C are not empty.  You could go one step further and check to make sure they are numeric with the isnumeric function.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.colum = 1 Or Target.colum = 2 Or Target.Column = 3 Then\n    If Range(\"A\" And Target.Row) &lt;&gt; \"\" And Range(\"B\" And Target.Row) &lt;&gt; \"\" And Range(\"C\" And Target.Row) &lt;&gt; \"\" Then\n        DoEvents\n        ' make your chart here\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8088088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b65f867e996081ff2ddd0649748d1f?s=128&d=identicon&r=PG&f=1", "display_name": "K Man", "link": "https://stackoverflow.com/users/8088088/k-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1598177583, "creation_date": 1496169976, "last_edit_date": 1598177583, "question_id": 44269698, "link": "https://stackoverflow.com/questions/44269698/if-cell-contains-value-create-chart-in-vba", "title": "If Cell contains value, create Chart in VBA", "body": "<p>I am trying to make my spreadsheet create pie charts and delete pie charts automatically.</p>\n<p>I have 3 columns as follows:</p>\n<p><a href=\"https://i.stack.imgur.com/wFnyF.png\" rel=\"nofollow noreferrer\"><strong>States &amp; Licensed Citizens</strong></a></p>\n<p>I would like to code in VBA so that excel creates a pie chart that compares Licensed Citizens to Unlicensed Citizens each time I have a value for each. For instance, when I add the State of Maine, and its values for each column, I'd like Excel to create a pie chart. When I delete the state of Maine, and its values, I'd like the pie chart to be deleted as well.</p>\n<p>I couldn't figure out how to create this condition. All help is greatly appreciated!</p>\n<p>-Steve</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1496171503, "post_id": 44269629, "comment_id": 75548251, "body": "Assuming what you&#39;re <i>actually</i> trying to do is to programmatically modify the header/footer of the document."}], "answers": [{"tags": [], "owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "is_accepted": false, "score": 2, "last_activity_date": 1496170199, "creation_date": 1496170199, "answer_id": 44269763, "question_id": 44269629, "link": "https://stackoverflow.com/questions/44269629/accessing-excels-custom-footer-dialog-box-w-vba/44269763#44269763", "title": "Accessing Excel&#39;s Custom Footer dialog box w/VBA", "body": "<p>You don't have to call any dialogbox. You can access header/footer directly:</p>\n\n<pre><code>ActiveSheet.PageSetup.CenterHeader = \"&amp;D  &amp;B&amp;ITime:&amp;I&amp;B&amp;T\"\n</code></pre>\n\n<p>More at <a href=\"https://msdn.microsoft.com/en-us/library/bb225426(v=office.12).aspx\" rel=\"nofollow noreferrer\">MSDN - Formatting and VBA Codes for Headers and Footers</a></p>\n"}, {"tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": false, "score": 2, "last_activity_date": 1496170732, "creation_date": 1496170732, "answer_id": 44269932, "question_id": 44269629, "link": "https://stackoverflow.com/questions/44269629/accessing-excels-custom-footer-dialog-box-w-vba/44269932#44269932", "title": "Accessing Excel&#39;s Custom Footer dialog box w/VBA", "body": "<p>To be more precise it would be </p>\n\n<pre><code>ActiveSheet.PageSetup.CenterFooter = \"&amp;D  &amp;B&amp;ITime:&amp;I&amp;B&amp;T\"\n</code></pre>\n\n<p>for the footer.  </p>\n\n<p>There are three points you can access, LeftFooter, CenterFooter, and RightFooter.  It will be the same for the header.</p>\n\n<p>This question has already been asked and answered <a href=\"https://stackoverflow.com/questions/28542260/replace-text-on-header-and-footer-of-excel-file\">here.</a> </p>\n"}], "owner": {"reputation": 1, "user_id": 8088036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f18fd91e5a77793b424c84d8af0ebfb4?s=128&d=identicon&r=PG&f=1", "display_name": "Hans A.", "link": "https://stackoverflow.com/users/8088036/hans-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "closed_date": 1496171421, "answer_count": 2, "score": 0, "last_activity_date": 1496175901, "creation_date": 1496169751, "last_edit_date": 1531164843, "question_id": 44269629, "link": "https://stackoverflow.com/questions/44269629/accessing-excels-custom-footer-dialog-box-w-vba", "closed_reason": "Duplicate", "title": "Accessing Excel&#39;s Custom Footer dialog box w/VBA", "body": "<p>Is there a way to access Excel's built-in custom footer dialog box with VBA? I'd like to access the actual dialog box; I know how to directly modify the footer via <code>ActiveSheet.PageSetup</code>. </p>\n\n<p>I can open the Page Setup box via <code>Application.Dialogs(xlDialogPageSetup).Show</code> but I'm not able to get to the Header/Footer tab, then Custom Footer. </p>\n\n<p>Here's what I've tried:</p>\n\n<pre><code>Application.Dialogs(xlDialogPageSetup).Show\nApplication.SendKeys \"h\" 'Go to the Header/Footer tab\nApplication.SendKeys \"{TAB}{TAB}{TAB}{ENTER}\", True 'Go to Custom Footer\n</code></pre>\n\n<p>Thank you.</p>\n\n<p><strong>EDIT:</strong> \nThanks for your responses thus far, and my apologies for not being clearer. </p>\n\n<p>As noted above, I understand how to use <code>ActiveSheet.PageSetup</code>to modify the Left/Center/Right footer fields; however, I'd like to <em>directly access the Custom Footer dialog box so that non-technical colleagues can easily modify these fields</em>, in a familiar manner, as opposed to having them look through the VBA and changing the existing text strings and/or codes.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4858714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b81991085e2881d8933e8a12020a56b?s=128&d=identicon&r=PG&f=1", "display_name": "Python", "link": "https://stackoverflow.com/users/4858714/python"}, "edited": false, "score": 0, "creation_date": 1496168918, "post_id": 44269040, "comment_id": 75546831, "body": "Thank you for your suggestions, unfortunately moving RowCount outside the Select Case didn&#39;t help.  I then replaced the select statement with your suggestion but it put everything into column D.   How should it increment the column in the same way I increment the Row?"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1496167995, "last_edit_date": 1496167995, "creation_date": 1496167617, "answer_id": 44269040, "question_id": 44268959, "link": "https://stackoverflow.com/questions/44268959/excel-vba-why-is-the-data-overwriting-same-row/44269040#44269040", "title": "Excel VBA - Why is the data overwriting same row?", "body": "<blockquote>\n<pre><code>RowCount = RowCount + 1\n</code></pre>\n</blockquote>\n\n<p>Should be moved to outside the <code>Select Case</code>, just after the <code>For Each</code>.</p>\n\n<pre><code>For Each ele In .document.all\n   RowCount = RowCount + 1 '&lt;------------------------------- Here\n     Select Case ele.classname\n       Case \"cardview\"\n       ...\n</code></pre>\n\n<p>This will increment a row for each element, but you will have blank rows for elements not matching any case. If you dont want those empty rows, you can simply decrement again the <code>RowCount</code> in the <code>Case Else</code>. But a better solution is to simplilfy your <code>Select</code> statement, since the same action is undertaken for all the cases:</p>\n\n<pre><code>For Each ele In .document.all\n  Select Case ele.classname\n    Case \"cardview\", \"jobTitle\", \"company\", \"location\", \"preview\"\n      RowCount = RowCount + 1\n      sht.Range(\"D\" &amp; RowCount) = ele.innertext\n  End Select\nNext ele\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4858714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b81991085e2881d8933e8a12020a56b?s=128&d=identicon&r=PG&f=1", "display_name": "Python", "link": "https://stackoverflow.com/users/4858714/python"}, "is_accepted": false, "score": 0, "last_activity_date": 1496401354, "creation_date": 1496401354, "answer_id": 44327349, "question_id": 44268959, "link": "https://stackoverflow.com/questions/44268959/excel-vba-why-is-the-data-overwriting-same-row/44327349#44327349", "title": "Excel VBA - Why is the data overwriting same row?", "body": "<p>I'm not sure why </p>\n\n<pre><code>Case \"cardview\"\n\nRowCount = RowCount + 1\n</code></pre>\n\n<p>is not executed. </p>\n\n<p>But when I moved </p>\n\n<pre><code>        RowCount = RowCount + 1\n</code></pre>\n\n<p>below    <code>Case \"jobTitle\"</code></p>\n\n<p>it then finally worked. </p>\n"}], "owner": {"reputation": 31, "user_id": 4858714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b81991085e2881d8933e8a12020a56b?s=128&d=identicon&r=PG&f=1", "display_name": "Python", "link": "https://stackoverflow.com/users/4858714/python"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1496401354, "creation_date": 1496167320, "question_id": 44268959, "link": "https://stackoverflow.com/questions/44268959/excel-vba-why-is-the-data-overwriting-same-row", "title": "Excel VBA - Why is the data overwriting same row?", "body": "<p>I am running this Sub and it is working but the data scraped is getting written to the second row and each instance is overwriting the last. I can't see where my script is wrong. Please help me understand: </p>\n\n<pre><code>Option Explicit\n\nSub test()\nDim ele As Object\nDim objIE As Object\nDim RowCount As Double\nDim sht As Worksheet\nDim myjobtype As String\nDim myzip As String\nDim what\nDim zipcode\n\nSet sht = Sheets(\"Sheet1\")\nRowCount = 1\nsht.Range(\"A\" &amp; RowCount) = \"Title\"\nsht.Range(\"B\" &amp; RowCount) = \"Company\"\nsht.Range(\"C\" &amp; RowCount) = \"Location\"\nsht.Range(\"D\" &amp; RowCount) = \"Description\"\n\nSet objIE = CreateObject(\"InternetExplorer.Application\")\n\nmyjobtype = InputBox(\"Enter type of job eg. sales, administration\")\nmyzip = InputBox(\"Enter zipcode of area where you wish to work\")\n\nWith objIE\n.Visible = True\n.navigate \"http://www.jobs.com/\"\n\nDo While .Busy Or _\n.readyState &lt;&gt; 4\nDoEvents\nLoop\n\nSet what = .document.getElementsByName(\"q\")\nwhat.Item(0).Value = myjobtype\nSet zipcode = .document.getElementsByName(\"where\")\nzipcode.Item(0).Value = myzip\n\n.document.forms(0).submit\n\nDo While .Busy Or _\n.readyState &lt;&gt; 4\nDoEvents\nLoop\n\nFor Each ele In .document.all\n    Select Case ele.classname\n        Case \"cardview\"\n            RowCount = RowCount + 1\n        Case \"jobTitle\"\n            sht.Range(\"A\" &amp; RowCount) = ele.innertext\n        Case \"company\"\n            sht.Range(\"B\" &amp; RowCount) = ele.innertext\n        Case \"location\"\n            sht.Range(\"C\" &amp; RowCount) = ele.innertext\n        Case \"preview\"\n            sht.Range(\"D\" &amp; RowCount) = ele.innertext\n    End Select\nNext ele\nEnd With\nSet objIE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2016"], "comments": [{"owner": {"reputation": 701, "user_id": 749673, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0mUeO.jpg?s=128&g=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/749673/tony"}, "edited": false, "score": 0, "creation_date": 1496166113, "post_id": 44268541, "comment_id": 75545259, "body": "If the name of the subform is <code>Daily_inputs_m_sub</code> then you should just need <code>Me.Daily_inputs_m_sub.Requery</code>"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 5835440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205568368144646/picture?type=large", "display_name": "Baurzhan Kozhaev", "link": "https://stackoverflow.com/users/5835440/baurzhan-kozhaev"}, "is_accepted": false, "score": 0, "last_activity_date": 1496222673, "creation_date": 1496222673, "answer_id": 44280776, "question_id": 44268541, "link": "https://stackoverflow.com/questions/44268541/to-dlook-up-function-works-when-entering-data-by-clicking-button/44280776#44280776", "title": "to dlook up function works when entering data by clicking button", "body": "<p>I've finally found a solution how to put a dlookup function into VBA Access:</p>\n\n<pre><code>Private Sub add_Click()\n\ntxt_1 As String\n\ntxt_1 = DLookup(\"[text_1]\", \"table_2\", \"text= '\" &amp; Forms!Daily_inputs!txt &amp; \"'\")\n\n'add data to table\nCurrentDb.Execute \"insert into Daily_inputs_m (date, text, text_1) \" &amp; _\n\" Values ('\" &amp; Me.date &amp; \"','\" &amp; Me.txt &amp; \"','\" &amp; txt_1 &amp; \"')\"    \n\n'refresh data in list on form\nMe.Daily_inputs_m_sub.Form.Requery    \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 5835440, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205568368144646/picture?type=large", "display_name": "Baurzhan Kozhaev", "link": "https://stackoverflow.com/users/5835440/baurzhan-kozhaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594639868, "creation_date": 1496165780, "last_edit_date": 1594639868, "question_id": 44268541, "link": "https://stackoverflow.com/questions/44268541/to-dlook-up-function-works-when-entering-data-by-clicking-button", "title": "to dlook up function works when entering data by clicking button", "body": "<p>I'm new to VBA and I am a bit stacked with the following issue.\nI have an access form wich has a subform.\nBy clicking the button on a form the data is added to subform and subform is refreshed by following code:</p>\n\n<pre><code>   Private Sub add_Click()\n\n'add data to table\nCurrentDb.Execute \"insert into Daily_inputs_m (date, text) \" &amp; _\n\" Values ('\" &amp; Me.date &amp; \"','\" &amp; Me.text &amp; \"')\"\n\n'refresh data in list on form\nMe.Daily_inputs_m_sub.Form.Requery  \n\nEnd Sub\n</code></pre>\n\n<p>I want the data on the next column would be chaged according to a \"text\" is added to a table. So please help me with is issue.</p>\n\n<p>For example I have a table with three columns \"date\",\"text\",\"text_1\" and another table with \"text\" and \"text_1\"\nIn the first form there are two textBoxes and a Button \"add\" where it should be \"date\" and \"text\" typed and then after clicking the button \"add\" the data as \"date\" and \"text\" is added to a subform which represents a table.</p>\n\n<p>So I want the column \"text_1\" would automatically get the data from the second table which matches to \"text\" column.</p>\n\n<p>for this I should use dlookup function but I dont know how to do it in VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1496166039, "post_id": 44268385, "comment_id": 75545218, "body": "For me you <i>can</i> access the <code>.Controls</code> of the third level... <code>Controls(&quot;Command&quot;)</code> are you sure of the key <code>&quot;Command&quot;</code>? Also, can you show a snippet how you created the submenus?"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1496222398, "post_id": 44268385, "comment_id": 75568091, "body": "Creating menu:  Set MenuContextual = Application.CommandBars.Add(Name:=NombreMenu, Position:=msoBarPopup, Temporary:=True)  Creating submenu:  Set SubMenuContextual = MenuContextual.Controls.Add(Type:=msoControlPopup)  Creating command  Set Boton = SubMenuContextual.Controls.Add  As you can see, simply"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "edited": false, "score": 0, "creation_date": 1496222677, "post_id": 44268385, "comment_id": 75568294, "body": "&quot;Command&quot; is a bar name, Apologize for the confusion. I must assign another alias :)"}], "owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 216, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1496165984, "creation_date": 1496165164, "last_edit_date": 1496165984, "question_id": 44268385, "link": "https://stackoverflow.com/questions/44268385/recursive-access-to-popup-submenus-in-vba-excel", "title": "recursive access to popup submenus in VBA (Excel)", "body": "<p>I've this recursive submenu created whith VBA: </p>\n\n<p><img src=\"https://i.stack.imgur.com/T18zR.png\" alt=\"sample menu\"></p>\n\n<p>This menu has been created with recursive CommandBar -> CommandBarControl -> CommandBarButton.</p>\n\n<p>Now, my problem is accesing after creating to second, third or fourth level of the menu.</p>\n\n<p>The first level access is easy:</p>\n\n<pre><code>Application.CommandBars(\"MenuJLECalc\").Controls(\"Insertar\").Visible = False\n</code></pre>\n\n<p>The problem comes in second level: I haven't the \".Controls\" property available as:</p>\n\n<pre><code>Application.CommandBars(\"MenuJLECalc\").Controls(\"Insertar\").Controls(\"Command\").Visible = False\n</code></pre>\n\n<p>What is the right way for accesing to second, third and fourth submenu levels ?</p>\n"}]