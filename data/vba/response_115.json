[{"tags": ["vba", "excel", "vlookup", "named-ranges"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490227267, "post_id": 42964844, "comment_id": 73023727, "body": "What&#39;s <code>TransactionInfo.Income_COA_Number</code>? You can also refer named range by <code>Thisworkbook.Names(&quot;COA_Range&quot;).RefersToRange</code>."}, {"owner": {"reputation": 111, "user_id": 7503849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10212158558590267/picture?type=large", "display_name": "Reed Turgeon", "link": "https://stackoverflow.com/users/7503849/reed-turgeon"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490228309, "post_id": 42964844, "comment_id": 73024053, "body": "it is a value taken from a userform. TransactionInfo.Income_COA_Number.Value works throughout the rest of my macro. your &quot;thisworkbook.names...&quot; was unsuccessful"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1490228598, "post_id": 42964844, "comment_id": 73024143, "body": "Try adding <code>Debug.Print Range(&quot;COA_Range&quot;).Address()</code> to make sure the range is found."}, {"owner": {"reputation": 111, "user_id": 7503849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10212158558590267/picture?type=large", "display_name": "Reed Turgeon", "link": "https://stackoverflow.com/users/7503849/reed-turgeon"}, "edited": false, "score": 0, "creation_date": 1490229313, "post_id": 42964844, "comment_id": 73024333, "body": "Yes the range is being found Range().Address() --&gt; immediate --&gt; $B$8:$F$41"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1490231606, "post_id": 42964844, "comment_id": 73024976, "body": "All of your test are ambiguous as to whether <code>TransactionInfo.Income_COA_Number.Value</code> is a true number or text-that-looks-like-a-number. I suspect it is the latter and the values in column B of <code>Range(&quot;COA_Range&quot;)</code> are true numbers. VLOOKUP cannot find  text-that-looks-like-a-number within a column of true numebers. Convert with <code>CLng(TransactionInfo.Income_COA_Number.Value2)</code> to get a true number. Of course, if <code>COA_Number </code> had been declared as a long instead of not-at-all or a variant then this would have been immediately obvious."}, {"owner": {"reputation": 111, "user_id": 7503849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10212158558590267/picture?type=large", "display_name": "Reed Turgeon", "link": "https://stackoverflow.com/users/7503849/reed-turgeon"}, "edited": false, "score": 0, "creation_date": 1490311510, "post_id": 42964844, "comment_id": 73069101, "body": "Thanks @jeeped your answer worked!"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 7503849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10212158558590267/picture?type=large", "display_name": "Reed Turgeon", "link": "https://stackoverflow.com/users/7503849/reed-turgeon"}, "edited": false, "score": 0, "creation_date": 1490311456, "post_id": 42965636, "comment_id": 73069084, "body": "Thank you for the response! I have posted my exact solution below"}], "tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1490232596, "creation_date": 1490232596, "answer_id": 42965636, "question_id": 42964844, "link": "https://stackoverflow.com/questions/42964844/setting-variable-with-vlookup-named-ranges/42965636#42965636", "title": "Setting Variable with VLookup &amp; Named Ranges", "body": "<p>Try to use <strong><em>Application.Vlookup</em></strong> instead of using <strong>Application.WorksheetFunction.Vlookup</strong>. Then set a Variant equal to this and if no match is found then it would return Error 2042 which can be tested using IsError</p>\n\n<p>See the Example Code below:</p>\n\n<pre><code>Dim ws As Worksheet: Set ws = ActiveSheet            'Change the sheet reference appropriately\nDim rngLookUpTable As Range: Set rngLookUpTable = ws.Range(\"COA_Range\")    \nDim vReturn As Variant\n\nIf Transaction_Type = 1 Then\n    Range(\"N10\").Value = \"Income\"\n    COA_Number = TransactionInfo.Income_COA_Number.Value\n    Range(\"N12\").Value = TransactionInfo.Income_COA_Number.Value\n    vReturn = Application.VLookup(COA_Number,rngLookUpTable, 2, False)\n    Range(\"N13\").Value = IIF(IsError(vReturn),\"Not Found\",vReturn)\nEnd If\n</code></pre>\n\n<p>WorksheetFunction version of VLookup and Match need error handling that re-routes your code to an error handler, returns to the next statement to evaluate, etc. With the Application functions, you can avoid that mess.</p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 7503849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10212158558590267/picture?type=large", "display_name": "Reed Turgeon", "link": "https://stackoverflow.com/users/7503849/reed-turgeon"}, "edited": false, "score": 0, "creation_date": 1490311462, "post_id": 42969430, "comment_id": 73069087, "body": "Thank you for the response! I have posted my exact solution below"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1490253110, "creation_date": 1490253110, "answer_id": 42969430, "question_id": 42964844, "link": "https://stackoverflow.com/questions/42964844/setting-variable-with-vlookup-named-ranges/42969430#42969430", "title": "Setting Variable with VLookup &amp; Named Ranges", "body": "<p>Following @Jeeped comment, make sure that the value in your User_Form named \"<strong>TransactionInfo</strong>\" in the TextBox \"<strong>Income_COA_Number</strong>\" has a Numeric value, and so all the values in your <code>Range(\"COA_Range\")</code> cells.</p>\n\n<p>Iv'e added 2 optional solutions (pick the one you preffer):</p>\n\n<ul>\n<li>Using <code>Application.Match</code>.</li>\n<li>Using <code>Find</code>.</li>\n</ul>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub VLookUpNamedRange()\n\nDim ws                  As Worksheet\nDim Transaction_Type    As Long\nDim MyCOARng            As Range\nDim COA_1               As Variant\nDim COA_Number          As Long\nDim FndRng              As Range\n\nSet ws = Worksheets(\"Sheet7\") '&lt;-- modify \"Sheet7\" to your sheet's name    \nSet MyCOARng = ws.Range(\"COA_Range\") '&lt;-- set Range to \"COA_Range\" Named Range\n\nCOA_Number = TransactionInfo.Income_COA_Number.Value\n\n' === Option 1: Use Application.Match ===\nIf Not IsError(Application.VLookup(COA_Number, MyCOARng, 2, False)) Then ' &lt;-- VLookup Successful\n    COA_1 = Application.VLookup(COA_Number, MyCOARng, 2, False)\nElse ' &lt;-- VLookup failed\n    COA_1 = COA_Number &amp; \" Not found in 'COA_Range' \"\nEnd If\n\n' === Option 2: Use Find ===\nSet FndRng = MyCOARng.Find(What:=COA_Number, LookIn:=xlValues, lookat:=xlWhole)\nIf Not FndRng Is Nothing Then '&lt;-- successful find\n    COA_1 = FndRng.Offset(, 2).Value\nElse '&lt;-- not found in your range\n    COA_1 = COA_Number &amp; \" Not found in 'COA_Range' \"\nEnd If\n\nDebug.Print COA_1 ' &lt;-- for DEBUG Only\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 7503849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10212158558590267/picture?type=large", "display_name": "Reed Turgeon", "link": "https://stackoverflow.com/users/7503849/reed-turgeon"}, "is_accepted": true, "score": 0, "last_activity_date": 1490311432, "creation_date": 1490311432, "answer_id": 42988769, "question_id": 42964844, "link": "https://stackoverflow.com/questions/42964844/setting-variable-with-vlookup-named-ranges/42988769#42988769", "title": "Setting Variable with VLookup &amp; Named Ranges", "body": "<p>Special thanks to @jainashish, @Shai Rado for the thoughtful responses. I was able to pick up a few pointers from each. </p>\n\n<p>It was @Jeeped however who actually solved my problem. The \"number\" was being read as text and the CLng() expression worked for me. I have added my updated code below. </p>\n\n<pre><code>    If Transaction_Type = 1 Then\n    Debug.Print \"Transaction Type :\"; Transaction_Type\n        Range(\"n10\").Value = \"Income\"\n\n        'thought from STACKOVERFLOW\n            'need to make sure that the number taken fromt the userform is ACTUALLY a number and not text that looks like a number\n                'use CLng to convert\n\n    Debug.Print \"COA # = \"; CLng(TransactionInfo.Income_COA_Number.Value)\n        COA_Number = CLng(TransactionInfo.Income_COA_Number.Value)\n            Debug.Print \"COA # = \"; COA_Number\n        Range(\"n12\").Value = COA_Number\n\n            'thought from STACK OVERFLOW\n                Debug.Print Range(\"COA_Range\").Address()\n                    'Yes the range is being found...\n                        Dim COA_Range As Range\n                        Set COA_Range = Range(\"COA_Range\")\n                            Debug.Print COA_Range.Address()\n\n        COA_1 = WorksheetFunction.VLookup(COA_Number, Range(\"COA_Range\"), 2, False)\n                Debug.Print COA_1\n                    Range(\"n13\").Value = COA_1\n\n        COA_2 = WorksheetFunction.VLookup(COA_Number, Range(\"COA_Range\"), 3, False)\n                Debug.Print COA_2\n                    Range(\"n14\").Value = COA_2\n\n        COA_3 = WorksheetFunction.VLookup(COA_Number, Range(\"COA_Range\"), 4, False)\n                Debug.Print COA_3\n                    Range(\"n15\").Value = COA_3\n\n        COA_4 = WorksheetFunction.VLookup(COA_Number, Range(\"COA_Range\"), 5, False)\n                Debug.Print COA_4\n                    Range(\"n16\").Value = COA_4enter code here\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 7503849, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10212158558590267/picture?type=large", "display_name": "Reed Turgeon", "link": "https://stackoverflow.com/users/7503849/reed-turgeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 42988769, "answer_count": 3, "score": 1, "last_activity_date": 1490311432, "creation_date": 1490227083, "last_edit_date": 1490249346, "question_id": 42964844, "link": "https://stackoverflow.com/questions/42964844/setting-variable-with-vlookup-named-ranges", "title": "Setting Variable with VLookup &amp; Named Ranges", "body": "<p>I can not get the <code>VLookup</code> function to work when using a named range. I am sure it has something to do with how I am referencing <code>\"COA_Range\"</code> but cant find a solution that works</p>\n\n<p>I have tried [], ([]), (\"\"), [\"\"],([\"\"])......</p>\n\n<p>(<em>Below is an updated and expanded section of the code</em>)</p>\n\n<pre><code>If Transaction_Type = 1 Then\n    Debug.Print \"Transaction Type :\"; Transaction_Type\n    Range(\"n10\").Value = \"Income\"\n\n    Debug.Print \"COA # = \"; TransactionInfo.Income_COA_Number.Value\n    COA_Number = TransactionInfo.Income_COA_Number.Value\n    Debug.Print COA_Number\n\n    Range(\"n12\").Value = TransactionInfo.Income_COA_Number.Value\n\n    'thought from STACK OVERFLOW\n    Debug.Print Range(\"COA_Range\").Address()\n\n    COA_1 = Application.WorksheetFunction.VLookup(COA_Number, Range(\"COA_Range\"), 2, False)\n    Debug.Print COA_1\n    Range(\"n13\").Value = COA_1\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490225385, "post_id": 42964396, "comment_id": 73023176, "body": "<code>if cells(i,1).Value = 1 or cells(i,1).Value = 2 or cells(i,1).Value = 3</code>. You can possibly shorten it with a <code>Select</code> statement."}, {"owner": {"reputation": 91, "user_id": 6740654, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f9e31a0f5bdd2e16a49d05d32ecb5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfrid", "link": "https://stackoverflow.com/users/6740654/siegfrid"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490225734, "post_id": 42964396, "comment_id": 73023290, "body": "yes, but I have 120 numbers....wanted to find a solution with Array.."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6740654, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f9e31a0f5bdd2e16a49d05d32ecb5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfrid", "link": "https://stackoverflow.com/users/6740654/siegfrid"}, "edited": false, "score": 0, "creation_date": 1490228627, "post_id": 42964978, "comment_id": 73024149, "body": "hi, thanks for answering... the Problem is I don&#180;t have Array in the worksheet. I have to create it in the script...and look up in this based on value in the worksheet. lets say if a cell = 1 then it should go to created Array and assign value for 1 from the Array...."}, {"owner": {"reputation": 91, "user_id": 6740654, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f9e31a0f5bdd2e16a49d05d32ecb5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfrid", "link": "https://stackoverflow.com/users/6740654/siegfrid"}, "edited": false, "score": 0, "creation_date": 1490229743, "post_id": 42964978, "comment_id": 73024471, "body": "Finally....thank you very much indeed! Now it look like: Sub test() Dim cell Dim arr(1 To 3, 1 To 2), m  arr(1, 1) = 1: arr(1, 2) = &quot;One&quot; arr(2, 1) = 2: arr(2, 2) = &quot;Two&quot; arr(3, 1) = 2: arr(3, 2) = &quot;Two&quot; For Each cell In Range(&quot;C9:C12&quot;) cell = Application.VLookup(cell, arr, 2, False) Next cell cell = IIf(IsError(cell), &quot;???&quot;, cell)  End Sub"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 91, "user_id": 6740654, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f9e31a0f5bdd2e16a49d05d32ecb5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfrid", "link": "https://stackoverflow.com/users/6740654/siegfrid"}, "edited": false, "score": 0, "creation_date": 1490230184, "post_id": 42964978, "comment_id": 73024595, "body": "If you want to share code then you should edit your question to add it - code in comments is too difficult to read..."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1490229161, "last_edit_date": 1490229161, "creation_date": 1490228045, "answer_id": 42964978, "question_id": 42964396, "link": "https://stackoverflow.com/questions/42964396/array-with-vlookup-and-loop/42964978#42964978", "title": "Array with Vlookup and Loop", "body": "<p>You can pick up a 2-d array from a worksheet, and then use <code>Vlookup</code> on that:    </p>\n\n<pre><code>Dim arr, m\n\narr = Range(\"G4:H6\").Value\n\nm = Application.VLookup(Range(\"G9\"), arr, 2, False)\n\nRange(\"H9\") = IIf(IsError(m), \"???\", m)\n</code></pre>\n\n<p>If there's no match then <code>IsError(m)</code> will be <code>True</code></p>\n\n<p>EDIT: loading the array in code</p>\n\n<pre><code>Dim arr(1 to 3, 1 to 2), m\n\narr(1, 1) = 1\narr(1, 2) = \"One\"\narr(2, 1) = 2\narr(2, 2) = \"Two\"\narr(3, 1) = 3\narr(3, 2) = \"Three\"\n\nm = Application.VLookup(Range(\"G9\"), arr, 2, False)\n\nRange(\"H9\") = IIf(IsError(m), \"???\", m)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 6740654, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f9e31a0f5bdd2e16a49d05d32ecb5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfrid", "link": "https://stackoverflow.com/users/6740654/siegfrid"}, "is_accepted": false, "score": 0, "last_activity_date": 1490231273, "creation_date": 1490231273, "answer_id": 42965442, "question_id": 42964396, "link": "https://stackoverflow.com/questions/42964396/array-with-vlookup-and-loop/42965442#42965442", "title": "Array with Vlookup and Loop", "body": "<p>Sorry for that..\nI modified a Little bit with Loop and it works, thanks</p>\n\n<pre><code>    Sub test()\nDim arr(1 To 3, 1 To 2), m\n\narr(1, 1) = 1: arr(1, 2) = \"One\"\narr(2, 1) = 2: arr(2, 2) = \"Two\"\narr(3, 1) = 3: arr(3, 2) = \"Three\"\nFor Each m In Range(\"C9:C12\")\nm.Value = Application.VLookup(m, arr, 2, False)\n\nm = IIf(IsError(m), \"???\", m)\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": false, "score": 0, "last_activity_date": 1490256839, "creation_date": 1490256839, "answer_id": 42970479, "question_id": 42964396, "link": "https://stackoverflow.com/questions/42964396/array-with-vlookup-and-loop/42970479#42970479", "title": "Array with Vlookup and Loop", "body": "<p>standing your array structure you coudl simplify your code as follows:</p>\n\n<pre><code>Sub test()\n    Dim arr As Variant\n    Dim m As Range\n\n    arr = Array(\"One\", \"Two\", \"Three\")\n\n    On Error Resume Next '&lt;--| prevent possible out-of-array values to stop the code\n    With Range(\"C9:C12\") '&lt;--| reference your relevant range\n        For Each m In .Cells '&lt;--| loop through its cells\n            m.Value = arr(m - 1) '&lt;--| an m.Value of 1 would point at the 0th (i.e.: the \"first\") position of the array \n        Next\n        .SpecialCells(xlCellTypeConstants, xlNumbers).Value = \"???\" '&lt;--| substitute \"survived\" numbers (i.e. out of array indexes) with \"???\"\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 6740654, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f9e31a0f5bdd2e16a49d05d32ecb5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfrid", "link": "https://stackoverflow.com/users/6740654/siegfrid"}, "is_accepted": false, "score": 0, "last_activity_date": 1490362114, "creation_date": 1490362114, "answer_id": 43000783, "question_id": 42964396, "link": "https://stackoverflow.com/questions/42964396/array-with-vlookup-and-loop/43000783#43000783", "title": "Array with Vlookup and Loop", "body": "<p>based on this code, how to add one more line\ne.g. </p>\n\n<pre><code>1 = \"One\" = \"OK\"\n2 = \"Two\" = \"OK\"\n3 = \"Three\" = \"Not OK\"\n</code></pre>\n\n<p>so basically: 1 and 2 have 2 dimenstion and one super-Dimension</p>\n\n<pre><code>            Sub test()\nDim arr(1 To 3, 1 To 2), m\n\narr(1, 1) = 1: arr(1, 2) = \"One\"\narr(2, 1) = 2: arr(2, 2) = \"Two\"\narr(3, 1) = 3: arr(3, 2) = \"Three\"\nFor Each m In Range(\"C9:C12\")\nm.Value = Application.VLookup(m, arr, 2, False)\n\nm = IIf(IsError(m), \"???\", m)\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 6740654, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f9e31a0f5bdd2e16a49d05d32ecb5f4?s=128&d=identicon&r=PG&f=1", "display_name": "Siegfrid", "link": "https://stackoverflow.com/users/6740654/siegfrid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 413, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1490362114, "creation_date": 1490224435, "question_id": 42964396, "link": "https://stackoverflow.com/questions/42964396/array-with-vlookup-and-loop", "title": "Array with Vlookup and Loop", "body": "<p>I am quite new in VBA, could you help me please?\nI want to create an Array with 3 values: 2 dimensions</p>\n\n<pre><code>1 = Data\n2 = Functions\n3 = Other\n</code></pre>\n\n<p>and then in Excel if one of These 3 numbers, look with For Each or For Next to the Array and retrieve the strings, like\n<code>for i = 1 to 20, if cells(i,1).Value = 1 or 2 or 3</code> then assign Strings..</p>\n\n<p>MAny thanks for your help</p>\n"}, {"tags": ["vba", "excel", "worksheet"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1490222185, "post_id": 42963877, "comment_id": 73021889, "body": "Check your <code>Sheets name</code> on each workbook"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1490222254, "post_id": 42963877, "comment_id": 73021929, "body": "What workbook is the sheet &quot;Document Register&quot;  in? The new one, or an existing one you&#39;re running this from?  I would also add the workbook name before <code>Sheets(&quot;Document Register&quot;)</code>"}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1490222492, "post_id": 42963877, "comment_id": 73022036, "body": "@0m3r - like I said in the question, all of the sheet names are correct"}, {"owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490222523, "post_id": 42963877, "comment_id": 73022060, "body": "@BruceWayne - I have now added the name of the workbook I am copying the document register sheet from, and it is still throwing the same error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1490222867, "post_id": 42963877, "comment_id": 73022209, "body": "Try the full workbook name (including the file extension)"}, {"owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "edited": false, "score": 1, "creation_date": 1490223242, "post_id": 42963877, "comment_id": 73022348, "body": "You&#39;ll get the subscript out of range error if the sheet you&#39;re referring to does not exist. I know you said that the sheet names are correct, but did you verify that Sheet1 is in NewWorkbook?"}], "answers": [{"comments": [{"owner": {"reputation": 1182, "user_id": 3546112, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fde927821f1c1fa92cbe20deabceac15?s=128&d=identicon&r=PG&f=1", "display_name": "Babar", "link": "https://stackoverflow.com/users/3546112/babar"}, "edited": false, "score": 0, "creation_date": 1507627915, "post_id": 42964151, "comment_id": 80274790, "body": "I am facing the same problem. However, I am copying the sheet to existing workbook. So, this solution doesn&#39;t work for me. All the sheets are present and named correctly. One observation that I will like to add is the sheet is copied in the target workbook and the code doesn&#39;t move forward and copy command is repeatedly called without any changes and then throws the error."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1490223286, "creation_date": 1490223286, "answer_id": 42964151, "question_id": 42963877, "link": "https://stackoverflow.com/questions/42963877/subscript-out-of-range-copy-worksheet-to-new-workbook-excel/42964151#42964151", "title": "Subscript out of range - copy worksheet to new workbook Excel", "body": "<p>Why not simply copy the worksheet directly to a new workbook (without manually creating the target workbook)?</p>\n\n<pre><code>Workbooks(\"COFFIE Project Tracker V2.0.0.0\").worksheets(\"Document Register\").Copy\nwith activeworkbook\n     .Title = \"Document Register\"\n     .SaveAs Filename:=\"some file path\" &amp; \" Program documents statusx\", FileFormat:=xlOpenXMLWorkbook\nend with\n</code></pre>\n\n<p>Note that I am using the <code>FileFormat</code> parameter of .SaveAs and discarding the file extension from the filename.</p>\n\n<p>If you need to use the <code>NewWorkbook</code> workbook object for something else than what you have shown, it is easy enough to set it to the activeworkbook you created on the copy-to-new-workbook-on-the-fly. </p>\n"}], "owner": {"reputation": 859, "user_id": 2901545, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e99f0e740e64b32a2fece89ed33a4c29?s=128&d=identicon&r=PG&f=1", "display_name": "scb998", "link": "https://stackoverflow.com/users/2901545/scb998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1138, "favorite_count": 0, "accepted_answer_id": 42964151, "answer_count": 1, "score": 2, "last_activity_date": 1490223505, "creation_date": 1490221902, "last_edit_date": 1490223505, "question_id": 42963877, "link": "https://stackoverflow.com/questions/42963877/subscript-out-of-range-copy-worksheet-to-new-workbook-excel", "title": "Subscript out of range - copy worksheet to new workbook Excel", "body": "<p>I'm attempting very simple process, where I am copying one worksheet to a new workbook as shown in the  following code:</p>\n\n<pre><code>Private Sub btn_Documents_Click()\n    Dim LastRow As Integer\n    Dim printrange As Range\n    Dim NewWorkbook As Workbook\n\n    Set NewWorkbook = Workbooks.Add\n    With NewWorkbook\n\n    .Title = \"Document Register\"\n    .SaveAs Filename:=\"some file path\" &amp; \" Program documents status.xlsx\"\nEnd With\nWorkbooks(\"COFFIE Project Tracker V2.0.0.0\").worksheets(\"Document Register\").Copy Before:=NewWorkbook.Sheets(\"Sheet1\")\n\nUnload Me\nfrm_Control.Show\n\nEnd Sub\n</code></pre>\n\n<p>This exact code has worked for me previously, however, this time it is throwing a subscript out of range error on the copy line of the code. I have double checked the file name, name of the sheet I am copying from, and it is all correct, so I am now at a loss as to why its is throwing this error.</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1490221728, "post_id": 42963753, "comment_id": 73021662, "body": "Build a dictionary so the keys can be used as criteria or add a helper column."}, {"owner": {"reputation": 83, "user_id": 6863661, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8bee33631210c76e49ee435d1e4faf07?s=128&d=identicon&r=PG&f=1", "display_name": "victor", "link": "https://stackoverflow.com/users/6863661/victor"}, "edited": false, "score": 0, "creation_date": 1490222022, "post_id": 42963753, "comment_id": 73021809, "body": "@Jeeped thank you i shall try this, i also want to know why                           Criteria1:=&quot;&lt;&gt;*??????????*&quot; is not working even when i converted criteria range to text format"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1490222103, "post_id": 42963753, "comment_id": 73021849, "body": "It probably has to do with the <code>*</code> wildcard being anything and everything."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 6863661, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8bee33631210c76e49ee435d1e4faf07?s=128&d=identicon&r=PG&f=1", "display_name": "victor", "link": "https://stackoverflow.com/users/6863661/victor"}, "edited": false, "score": 0, "creation_date": 1490222680, "post_id": 42963903, "comment_id": 73022127, "body": "i did try this with And/or operator, the result i am getting is based on mathematics value i.e it gives me numbers like 1010101010 (&gt;999999999), 4231597657 (&lt;10000000000) which are mathematically correct since both meet criteria of being &lt; or &gt; 10000000000 in value, what i am looking for is what i get it in excel by LEN formula which count the number of character in string"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 83, "user_id": 6863661, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8bee33631210c76e49ee435d1e4faf07?s=128&d=identicon&r=PG&f=1", "display_name": "victor", "link": "https://stackoverflow.com/users/6863661/victor"}, "edited": false, "score": 1, "creation_date": 1490222748, "post_id": 42963903, "comment_id": 73022153, "body": "Use a helper column."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1490222031, "creation_date": 1490222031, "answer_id": 42963903, "question_id": 42963753, "link": "https://stackoverflow.com/questions/42963753/autofilter-column-based-on-criteria-number-of-digits/42963903#42963903", "title": "Autofilter column based on criteria - number of digits", "body": "<p>Use <code>Criteria1</code> and <code>Criteria2</code> with <code>Operator:=xlAnd</code>.</p>\n\n<pre><code>with ActiveSheet.Range(\"$A$1:$BN$235\")\n    .AutoFilter Field:=12,  Criteria1:=\"&gt;999999999\", Operator:=xlAnd, Criteria2:=\"&lt;10000000000\"\nend with\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6863661, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8bee33631210c76e49ee435d1e4faf07?s=128&d=identicon&r=PG&f=1", "display_name": "victor", "link": "https://stackoverflow.com/users/6863661/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "accepted_answer_id": 42963903, "answer_count": 1, "score": 3, "last_activity_date": 1490222206, "creation_date": 1490221429, "last_edit_date": 1490222206, "question_id": 42963753, "link": "https://stackoverflow.com/questions/42963753/autofilter-column-based-on-criteria-number-of-digits", "title": "Autofilter column based on criteria - number of digits", "body": "<p>So far I have tried different <code>autofilter</code> options in but non seems to be working for me, I have license number column which should only have 10 digits in it and by <code>autofilter</code> I am trying to find entries which has less than or more than 10 digits, </p>\n\n<p>I converted that column to text filed in order to use</p>\n\n<p><strong><code>ActiveSheet.Range(\"$A$1:$BN$235\").AutoFilter Field:=12,  Criteria1:=\"&lt;&gt;*??????????*\"'</code></strong>     </p>\n\n<p>But this doesn't seems to be working as it gives me all the entries including <strong><code>&lt;&gt; &amp;= 10 digits</code></strong>, </p>\n\n<p>I also tried<br>\n    <strong><code>criteria ``\"&gt;\"10000000000\"' &amp;&lt;90000000000</code></strong>    </p>\n\n<p>This also is not working (I changed column to Number filed to match the criteria)    can I get any help on whats wrong I am doing here so I can rectify it</p>\n"}, {"tags": ["image", "vba", "url", "embed"], "comments": [{"owner": {"reputation": 101, "user_id": 7733587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885836db14c1905a97ec5ae85f6b60ef?s=128&d=identicon&r=PG&f=1", "display_name": "keydemographic", "link": "https://stackoverflow.com/users/7733587/keydemographic"}, "edited": false, "score": 0, "creation_date": 1490235911, "post_id": 42963511, "comment_id": 73026187, "body": "This works fine for me with 2016 64-bit. Can you include more info, such as a URL you are failing to load?"}, {"owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "reply_to_user": {"reputation": 101, "user_id": 7733587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885836db14c1905a97ec5ae85f6b60ef?s=128&d=identicon&r=PG&f=1", "display_name": "keydemographic", "link": "https://stackoverflow.com/users/7733587/keydemographic"}, "edited": false, "score": 1, "creation_date": 1490238192, "post_id": 42963511, "comment_id": 73026779, "body": "Well it seems I&#39;m having trouble with images from <a href=\"https://s3.amazonaws.com\" rel=\"nofollow noreferrer\">s3.amazonaws.com</a>  In my test file of urls, I added in a couple of extra image urls to google and a few other logos which all downloaded and embedded correctly.  Is there a way to get images from s3.amazonaws ? and also, how can I mark which urls errored while moving onto the next url without causing a debug error and stopping the code ??  Thanks again in advance"}, {"owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "reply_to_user": {"reputation": 101, "user_id": 7733587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885836db14c1905a97ec5ae85f6b60ef?s=128&d=identicon&r=PG&f=1", "display_name": "keydemographic", "link": "https://stackoverflow.com/users/7733587/keydemographic"}, "edited": false, "score": 0, "creation_date": 1490238694, "post_id": 42963511, "comment_id": 73026899, "body": "Unfortunately I cannot provide the url as it&#39;s linked to client data. I can however paste the url link into a browser that has never been logged into this site and download the image successfully but excel doesn&#39;t seem to be able to get the image"}, {"owner": {"reputation": 101, "user_id": 7733587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885836db14c1905a97ec5ae85f6b60ef?s=128&d=identicon&r=PG&f=1", "display_name": "keydemographic", "link": "https://stackoverflow.com/users/7733587/keydemographic"}, "edited": false, "score": 0, "creation_date": 1490245495, "post_id": 42963511, "comment_id": 73028658, "body": "To avoid the error you can add error handling (on error go to a statement that prints an error in the cell, then returns to the loop that is going over the column).  As far as not being able to pull s3 data, checking from a browser was a good test. Does the connection require https?"}, {"owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "reply_to_user": {"reputation": 101, "user_id": 7733587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885836db14c1905a97ec5ae85f6b60ef?s=128&d=identicon&r=PG&f=1", "display_name": "keydemographic", "link": "https://stackoverflow.com/users/7733587/keydemographic"}, "edited": false, "score": 1, "creation_date": 1490307380, "post_id": 42963511, "comment_id": 73067622, "body": "yes, it&#39;s https I can provide the following working example : <a href=\"https://ygl-photos.s3.amazonaws.com/7526W5416d77c1190d.jpg\" rel=\"nofollow noreferrer\">ygl-photos.s3.amazonaws.com/7526W5416d77c1190d.jpg</a>"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 7733587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885836db14c1905a97ec5ae85f6b60ef?s=128&d=identicon&r=PG&f=1", "display_name": "keydemographic", "link": "https://stackoverflow.com/users/7733587/keydemographic"}, "is_accepted": false, "score": 1, "last_activity_date": 1490336659, "last_edit_date": 1495542745, "creation_date": 1490336659, "answer_id": 42992763, "question_id": 42963511, "link": "https://stackoverflow.com/questions/42963511/vba-download-and-embed-images-using-url-from-adjacent-cell/42992763#42992763", "title": "VBA download and embed images using url from adjacent cell", "body": "<p>There's <a href=\"https://stackoverflow.com/a/32502926/7733587\">some evidence</a> that Excel has trouble downloading from AWS, and I've recreated your issue using the URL you mentioned. In this case, if I were on a deadline I'd put in this fall-back method when the first one fails: download the file, then insert it into the document, then delete the file. </p>\n\n<pre><code>directDownloadFailed:\nDim FileNum As Long\nDim TempFile As String\nDim FileData() As Byte\nDim WHTTP As Object\n\nSet WHTTP = CreateObject(\"WinHTTP.WinHTTPrequest.5.1\")\n\nWHTTP.Open \"GET\", imgURL, False\nWHTTP.Send\nFileData = WHTTP.ResponseBody\nSet WHTTP = Nothing\n\nFileNum = FreeFile\nTempFile = \"path\\to\\save\\img.jpg\"\nOpen TempFile For Binary Access Write As #FileNum\n    Put #FileNum, 1, FileData\nClose #FileNum\n\nSet img = ActiveSheet.Pictures.Insert(TempFile)\n\nSetAttr TempFile, vbNormal\nKill TempFile\n\nGoTo resumeProcessingImg\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "edited": false, "score": 0, "creation_date": 1490825468, "post_id": 43037421, "comment_id": 73291591, "body": "@keydemographic  Hi,  I haven&#39;t been able to incorporate your code to get it to work. Is it possible to use yours with the URL2IMG () code above ?"}, {"owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "edited": false, "score": 0, "creation_date": 1490825936, "post_id": 43037421, "comment_id": 73291767, "body": "Also, Thanks to @david-zemens for this code at <a href=\"http://stackoverflow.com/questions/15588995/excel-vba-insert-images-from-image-name-in-column/15589423#15589423\">link - excel-vba-insert-images-from-image-name-in-column</a>"}, {"owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "edited": false, "score": 0, "creation_date": 1491191992, "post_id": 43037421, "comment_id": 73426218, "body": "Hi @keydemographic, it turns out the problem was with version of Excel I was using, 2016. The URL2IMG code I was using actually works in Excel 2010. It seems the Insert property and/or Picture class has changed in someway that affects images behind s3.amazonaws urls. There is also some evidence that the s3.amazonaws urls are being redirected which may also be causing a problem for vba in 2016 but not in 2010. Either way, Thanks for taking the time to assist. Cheers Gav"}], "tags": [], "owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "is_accepted": true, "score": 0, "last_activity_date": 1490585904, "last_edit_date": 1490585904, "creation_date": 1490584802, "answer_id": 43037421, "question_id": 42963511, "link": "https://stackoverflow.com/questions/42963511/vba-download-and-embed-images-using-url-from-adjacent-cell/43037421#43037421", "title": "VBA download and embed images using url from adjacent cell", "body": "<p>@keydemographic</p>\n\n<p>I appreciate the response and that definitely sounds like an option but I cannot get that code to work or incorporate it into the code I'm using.  I get a compile error  \"Label Not defined\" on GoTo resumeProcessingImg</p>\n\n<p>The following will download and embed the images into the cells but the code stops once it gets to the s3 aws image urls.\nI'll try a few other ways to incorporate your code but I'm not having much luck with it so far.</p>\n\n<p><a href=\"https://drive.google.com/open?id=0BzJCv4TnxJureldGLTZiN0x4WTg\" rel=\"nofollow noreferrer\">This is my test file</a></p>\n\n<pre><code>Sub URL2IMG() \nDim pic As String 'path of pic\nDim myPicture As Picture 'embedded pic\nDim rng As Range 'range over which we will iterate\nDim cl As Range 'iterator\n\nSet rng = Range(\"b2:b12\")   '&lt;~~ as needed, Modify range to where the images are to be embedded.\nFor Each cl In rng\npic = cl.Offset(0, -1)      '&lt;~~ defines image link URL in column to the left of the embedded column\nSet myPicture = ActiveSheet.Pictures.Insert(pic)\n\n'you can play with the following to manipulate the size &amp; position of the picture.\n With myPicture\n    .ShapeRange.LockAspectRatio = msoFalse\n\n    ' currently this shrinks the picture to fit inside the cell.\n    .Width = cl.Width\n    .Height = cl.Height\n    .Top = Rows(cl.Row).Top\n    .Left = Columns(cl.Column).Left\n\n  End With\n\n Next\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3724286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d0013a1d2fc1cd2fac2cdf1a90c6e4e?s=128&d=identicon&r=PG&f=1", "display_name": "LangerFeen", "link": "https://stackoverflow.com/users/3724286/langerfeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1728, "favorite_count": 0, "accepted_answer_id": 43037421, "answer_count": 2, "score": 1, "last_activity_date": 1490585904, "creation_date": 1490220233, "last_edit_date": 1495541421, "question_id": 42963511, "link": "https://stackoverflow.com/questions/42963511/vba-download-and-embed-images-using-url-from-adjacent-cell", "title": "VBA download and embed images using url from adjacent cell", "body": "<p>I've attempted the solution in the following.\n<a href=\"https://stackoverflow.com/questions/16113876/inserting-an-online-picture-to-excel-with-vba\">Inserting an Online Picture to Excel with VBA</a></p>\n\n<p>Unfortunately I get a run-time error '1004'\n\"Unable to get the Insert property of the Picture class\"\nwhich stops on the following code :</p>\n\n<pre><code>    Set myPicture = ActiveSheet.Pictures.Insert(pic)\n</code></pre>\n\n<p>Could this be due to my Office version 2016 (64bit) ?\nIf not, are there any suggestions of how I might get embed images to adjacent cells in column AK using the image urls from column AJ ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["forms", "vba", "runtime-error", "controls", "multipage"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490221530, "post_id": 42963367, "comment_id": 73021581, "body": "Could the property be indexed and you need to specify a tab index to read it?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490230419, "post_id": 42963367, "comment_id": 73024656, "body": "@Mat&#39;sMug yep - turns out <code>BoundValue</code> returns a collection for these controls, and an index is required."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490230540, "post_id": 42963367, "comment_id": 73024688, "body": "Doesn&#39;t Rubberduck&#39;s context-sensitive status/selection show you that?"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490240235, "post_id": 42963367, "comment_id": 73027297, "body": "The <code>BoundValue</code> member is a member of <code>IControl</code> that is extended to each control, but while the <code>BoundValue</code> return type is <code>Variant</code>, the returned type varies by the control being accessed, so unless Rubberduck is inspecting a <i>Variable</i> of explicit type Control, it doesn&#39;t (currently) know that <code>BoundControl</code> is an available property. If it is inspecting a variable explicitly declared as type <code>Control</code>, it only knows that <code>BoundObject</code> returns a <code>Variant</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "is_accepted": false, "score": 1, "last_activity_date": 1490230102, "creation_date": 1490230102, "answer_id": 42965272, "question_id": 42963367, "link": "https://stackoverflow.com/questions/42963367/is-boundvalue-a-valid-property-for-a-multipage-or-tabstrip-control/42965272#42965272", "title": "Is BoundValue a valid property for a MultiPage or TabStrip control?", "body": "<p>Huh, I assigned <code>Me.MultiPage</code> and <code>Me.TabStrip1</code> to variables of type <code>Control</code> and inspected the <code>BoundValue</code> in the Locals window.</p>\n\n<p>The MultiPage <code>BoundValue</code> property returns the <em>complete</em> <code>Pages</code> collection, and the TabStrip <code>BoundValue</code> property returns the <em>complete</em> <code>Tabs</code> collection. For a MultiPage control, that's at odds with the documentation, and while the control's <code>Value</code> property returns a <code>Long</code> signifying the currently selected Page, having <code>BoundValue</code> return the <em>complete</em> <code>Pages</code> collection doesn't really tell me anything useful.</p>\n\n<p>I guess I now know that <code>BoundValue</code> does return something, but I don't know if what it returns is useful.</p>\n"}], "owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1490230102, "creation_date": 1490219638, "question_id": 42963367, "link": "https://stackoverflow.com/questions/42963367/is-boundvalue-a-valid-property-for-a-multipage-or-tabstrip-control", "title": "Is BoundValue a valid property for a MultiPage or TabStrip control?", "body": "<p>The VBA <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264403.aspx\" rel=\"nofollow noreferrer\">documentation</a> suggests that <code>BoundValue</code> is a valid <code>Control</code> property for a <code>MultiPage</code> control, but doesn't mention whether it is valid for a <code>TabStrip</code> control.</p>\n\n<p>When I try to use <code>Debug.Print Me.MultiPage1.BoundValue</code> or <code>Debug.Print Me.TabStrip1.BoundValue</code> (even if I explicitly set the focus to the control first), then VBA throws error <code>450 - Wrong number of arguments or invalid property assignment</code>. That <em>suggests</em> that I'm calling the member incorrectly, or there's some contextual requirement for it to return. But I can't seem to find any state in which the property is readable.</p>\n\n<p>Is the documentation incorrect (shock, horror!!!)? Is it possible to read the <code>BoundValue</code> property of a <code>MultiPage</code> or <code>TabStrip</code>? Are there any special conditions for it being readable?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1490218051, "post_id": 42962883, "comment_id": 73020061, "body": "What is the point of <code>.Value</code> in <code>arrHolder(i, 21).Value</code> ?"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1490218151, "post_id": 42962883, "comment_id": 73020108, "body": "@JohnColeman Without it it throws a &quot;ByRef argument type mimatch&quot;."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1490218252, "post_id": 42962883, "comment_id": 73020143, "body": "<code>SumIf(arrHolder, 21, i, CStr(arrHolder(i, 21)), 26)</code>?"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490218371, "post_id": 42962883, "comment_id": 73020211, "body": "@PatricK That worked! Thank you very much!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490218617, "post_id": 42962883, "comment_id": 73020323, "body": "@Patrick Maybe you could post that as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 3, "last_activity_date": 1490219165, "creation_date": 1490219165, "answer_id": 42963250, "question_id": 42962883, "link": "https://stackoverflow.com/questions/42962883/object-required-error-array/42963250#42963250", "title": "Object Required Error , Array", "body": "<p>As per comments on your POST, your UDF indicates a String as an input which errors on <code>arrHolder(i, 18) = arrHolder(i, 24) - SumIf(arrHolder, 21, i, arrHolder(i, 21).Value, 26)</code>. You can just put convert to string <code>CStr()</code> around the Variant.</p>\n\n<pre><code>SumIf(arrHolder, 21, i, CStr(arrHolder(i, 21)), 26)\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490219165, "creation_date": 1490217721, "question_id": 42962883, "link": "https://stackoverflow.com/questions/42962883/object-required-error-array", "title": "Object Required Error , Array", "body": "<p>I am getting the error 424 Object Required. I am very unfamiliar with arrays and assume it has something to do with that. I read a large number of the Object Required Error questions in this forum and tried the various suggestions, but none solved my issue. </p>\n\n<p>At the top of the module</p>\n\n<pre><code>Dim velocityLookup As Scripting.Dictionary\nDim arrHolder As Variant\nConst Velocity_Key_Col As Long = 10\nOption Explicit\n</code></pre>\n\n<p>Custom SumIf for Arrays</p>\n\n<pre><code>Public Function SumIf(lookupTable As Variant, lookupColumn As Long, currentRow As Long, lookupValue As String, sumifColumn As Long) As Long\n    Dim i As Long\n\n    SumIf = 0\n\n    For i = 1 To currentRow\n        If lookupTable(i, lookupColumn) = lookupValue Then\n            SumIf = SumIf + lookupTable(i, sumifColumn)\n        End If\n    Next i\nEnd Function\n</code></pre>\n\n<p>Issue Line</p>\n\n<pre><code>        arrHolder(i, 18) = arrHolder(i, 24) - SumIf(arrHolder, 21, i, arrHolder(i, 21).Value, 26)\n</code></pre>\n\n<p>Entire Code</p>\n\n<pre><code>Sub Calculate_Click()\n\n'******************* Insert a line to freeze screen here.\nDim wsMain As Worksheet\nDim wsQuantity As Worksheet\nDim wsVelocity As Worksheet\nDim wsParameters As Worksheet\nDim wsData As Worksheet\nDim lrMain As Long 'lr = last row\nDim lrQuantity As Long\nDim lrVelocity As Long\nDim lrParameters As Long\nDim lrData As Long\nDim i As Long 'Row Counter\n\n'For Optimization Testing Only.\nDim MainTimer As Double\nMainTimer = Timer\n\nSet wsMain = Worksheets(\"Main Tab\")\nSet wsQuantity = Worksheets(\"Quantity Available\")\nSet wsVelocity = Worksheets(\"Velocity\")\nSet wsParameters = Worksheets(\"Parameters\")\nSet wsData = Worksheets(\"Data Input by Account\")\n\nlrMain = wsMain.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\nlrQuantity = wsQuantity.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\nlrVelocity = wsVelocity.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\nlrParameters = wsParameters.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\nlrData = wsData.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n\nDim calcWeek As Long\ncalcWeek = wsParameters.Range(\"B3\").Value\n\nFor i = 2 To 5 'lrQuantity\n    With wsQuantity\n        .Cells(i, 5) = .Cells(i, 1) &amp; .Cells(i, 2)\n        .Cells(i, 6) = .Cells(i, 1) &amp; UCase(.Cells(i, 2)) &amp; .Cells(i, 3)\n    End With\nNext i\n\nwsData.Range(wsData.Cells(2, 1), wsData.Cells(lrData, 4)).Sort _\nkey1:=wsData.Range(\"A2\"), order1:=xlAscending, Header:=xlNo\n\nDim tempLookup As Variant\nFor i = 2 To 5 'lrData\n    tempLookup = Application.VLookup(wsData.Cells(i, 2), wsParameters.Range(\"Table5\"), 2, False)\n    If IsError(tempLookup) Then\n        wsData.Cells(i, 3).Value = \"Missing\"\n    Else\n        wsData.Cells(i, 3).Value = tempLookup\n    End If\nNext i\n\nFor i = 2 To 5 'lrVelocity\n    With wsVelocity\n        .Cells(i, 10) = CStr(Trim(.Cells(i, 1) &amp; .Cells(i, 4) &amp; .Cells(i, 5) &amp; .Cells(i, 9)))\n        .Cells(i, 11) = .Cells(i, 6)\n        .Cells(i, 12) = .Cells(i, 7)\n        .Cells(i, 13) = .Cells(i, 8)\n        .Cells(i, 14) = .Cells(i, 3)\n        .Cells(i, 22) = .Cells(i, 1) &amp; .Cells(i, 9)\n    End With\nNext i\n\nwsVelocity.Range(wsVelocity.Cells(2, 1), wsVelocity.Cells(lrVelocity, 10)).Sort _\nkey1:=wsVelocity.Range(\"J2\"), order1:=xlAscending, Header:=xlNo\n\nBuildVelocityLookup wsVelocity, Velocity_Key_Col, velocityLookup\n\nDim indexVelocity1 As Range\nDim indexVelocity2 As Range\nDim matchVelocity1 As Range\nDim matchVelocity2 As Range\n\nWith wsVelocity\n    Set indexVelocity1 = .Range(.Cells(2, 7), .Cells(lrVelocity, 7))\n    Set indexVelocity2 = .Range(.Cells(2, 3), .Cells(lrVelocity, 3))\n    Set matchVelocity1 = .Range(.Cells(2, 1), .Cells(lrVelocity, 1))\n    Set matchVelocity2 = .Range(.Cells(2, 22), .Cells(lrVelocity, 22))\nEnd With\n\nDim indexQuantity As Range\nDim matchQuantity As Range\nWith wsQuantity\n    Set indexQuantity = .Range(.Cells(2, 4), .Cells(lrQuantity, 4))\n    Set matchQuantity = .Range(.Cells(2, 6), .Cells(lrQuantity, 6))\nEnd With\n\nDim ShipMin As Long\nShipMin = wsParameters.Cells(7, 2).Value\n\nWith wsMain\n    .Range(.Cells(2, 9), .Cells(lrMain, 20)).ClearContents\n    .Range(.Cells(2, 22), .Cells(lrMain, 47)).ClearContents\nEnd With\n\narrHolder = wsMain.Range(wsMain.Cells(2, 1), wsMain.Cells(lrMain, 47))\n\n\nFor i = LBound(arrHolder) To lrMain\n\n        Dim conUD As String 'con=concatenate\n        'conUD = .Cells(i, 21) &amp; .Cells(i, 4) &amp; calcWeek\n        conUD = arrHolder(i, 21) &amp; arrHolder(i, 4) &amp; calcWeek\n\n        '.Cells(i, 21) = .Cells(i, 5) &amp; .Cells(i, 3)\n        arrHolder(i, 21) = arrHolder(i, 5) &amp; arrHolder(i, 3)\n\n        'If .Cells(i, 8) &lt;&gt; 0 Then\n        '    .Cells(i, 9) = .Cells(i, 6) / .Cells(i, 8)\n        'End If\n        If arrHolder(i, 8) &lt;&gt; 0 Then\n            arrHolder(i, 9) = arrHolder(i, 6) / arrHolder(i, 8)\n        End If\n\n        Dim velocityRow As Long\n        If velocityLookup.Exists(conUD) Then\n            velocityRow = velocityLookup.Item(conUD)\n            tempLookup = wsVelocity.Cells(velocityRow, 11)\n\n        '.Cells(i, 10).Value = tempLookup\n        arrHolder(i, 10) = tempLookup\n\n        tempLookup = wsVelocity.Cells(velocityRow, 14)\n\n        '.Cells(i, 11).Value = tempLookup\n        arrHolder(i, 11) = tempLookup\n\n\n        'If .Cells(i, 9) &gt; .Cells(i, 11) Then\n        '    .Cells(i, 12).Value = Round((.Cells(i, 6) / .Cells(i, 11)) / .Cells(i, 10), 0.1)\n        'End If\n        If arrHolder(i, 9) &gt; arrHolder(i, 11) Then\n            arrHolder(i, 12) = Round((arrHolder(i, 6) / arrHolder(i, 11)) / arrHolder(i, 10), 0.1)\n        End If\n\n        'If .Cells(i, 6) &gt; 0 Then\n        '    If .Cells(i, 12) &lt;&gt; \"\" Then\n        '        .Cells(i, 13).Value = .Cells(i, 12) - .Cells(i, 8)\n        '    End If\n        'End If\n        If arrHolder(i, 6) &gt; 0 Then\n            If arrHolder(i, 12) &lt;&gt; vbNullString Then\n                arrHolder(i, 13) = arrHolder(i, 12) - arrHolder(i, 8)\n            End If\n        End If\n\n        Dim conECD As String\n\n        'conECD = .Cells(i, 5) &amp; .Cells(i, 3) &amp; .Cells(i, 4) &amp; calcWeek\n        conECD = arrHolder(i, 5) &amp; arrHolder(i, 3) &amp; arrHolder(i, 4) &amp; calcWeek\n\n        ' It looks like you use this block a few times with different variables. Consider extracting to a function\n        If velocityLookup.Exists(conECD) Then\n            velocityRow = velocityLookup.Item(conECD)\n            tempLookup = wsVelocity.Cells(velocityRow, 12)\n\n        'If .Cells(i, 13) &lt;&gt; \"\" Then\n        '    If tempLookup &lt;&gt; 0 Then\n        '        .Cells(i, 14).Value = Int(.Cells(i, 13) / tempLookup)\n        '    End If\n        'End If\n        If arrHolder(i, 13) &lt;&gt; vbNullString Then\n            If tempLookup &lt;&gt; 0 Then\n                arrHolder(i, 14) = Int(arrHolder(i, 13) / tempLookup)\n            End If\n        End If\n\n            tempLookup = wsVelocity.Cells(velocityRow, 13)\n\n\n\n        'If .Cells(i, 14) &gt; tempLookup Then\n        '    If .Cells(i, 14) &lt;&gt; \"\" Then\n        '        .Cells(i, 15).Value = tempLookup\n        '    End If\n        'Else\n        '    .Cells(i, 15).Value = .Cells(i, 14).Value\n        'End If\n        If arrHolder(i, 14) &gt; tempLookup Then\n            If arrHolder(i, 14) &lt;&gt; vbNullString Then\n                arrHolder(i, 15) = tempLookup\n            End If\n        Else\n            arrHolder(i, 15) = arrHolder(i, 14)\n        End If\n\n        'If .Cells(i, 14) = \"\" Then\n        '    If .Cells(i, 11) = \"\" Then\n        '        .Cells(i, 26) = \"\"\n        '    Else\n        '        .Cells(i, 26).Value = Round(.Cells(i, 14).Value * .Cells(i, 11).Value, 0)\n        '    End If\n        'End If\n        If arrHolder(i, 14) = vbNullString Then\n            If arrHolder(i, 11) = vbNullString Then\n                arrHolder(i, 26) = vbNullString\n            Else\n                arrHolder(i, 26) = Round(arrHolder(i, 14) * arrHolder(i, 11), 0)\n            End If\n        End If\n\n\n        'tempLookup = Application.Index(indexQuantity, Application.Match((.Cells(i, 21).Value &amp; \"LIBERTY\") _\n        '    , matchQuantity, False))\n        Dim arrHolderRow As Long\n\n        tempLookup = Application.Index(indexQuantity, Application.Match((arrHolder(i, 21) &amp; \"LIBERTY\") _\n            , matchQuantity, False))\n\n        '.Cells(i, 24).Value = tempLookup\n        arrHolder(i, 24) = tempLookup\n\n        ' I havent used application SumIf on an array before, so I instead edited this so it should use the correct index value.\n        ' This will likely not work as I want it to, so it may just need to go into a separate loop or something.\n        ' .Cells(i, 18).Value = .Cells(i, 24) - Application.SumIf(.Range(.Cells(1, 21), .Cells(i, 21)), _\n        '    .Cells(i, 21).Value, .Range(.Cells(1, 26), .Cells(i, 26)))\n        arrHolder(i, 18) = arrHolder(i, 24) - SumIf(arrHolder, 21, i, arrHolder(i, 21).Value, 26)\n\n        '  arrHolder(I, 18) = .Cells(I + 1, 24) - Application.SumIf(.Range(.Cells(1, 21), .Cells(I + 1, 21)), _\n            .Cells(I + 1, 21).Value, .Range(.Cells(1, 26), .Cells(I + 1, 26)))\nEnd If\n\n            velocityRow = velocityLookup.Item(conUD)\n            tempLookup = wsVelocity.Cells(velocityRow, 13)\n\n\n        'If .Cells(i, 26) &gt; tempLookup Then\n        '    .Cells(i, 28).Value = tempLookup\n        'Else\n        '    .Cells(i, 28).Value = .Cells(i, 26).Value\n        'End If\n        If arrHolder(i, 26) &gt; tempLookup Then\n            arrHolder(i, 28) = tempLookup\n        Else\n            arrHolder(i, 28) = arrHolder(i, 26)\n        End If\n\n        'If .Cells(i, 18).Value &lt; 0 Then\n        '    .Cells(i, 29).Value = \"C\"\n        '    .Cells(i, 27).Value = \"\"\n        'Else\n        '    .Cells(i, 27) = .Cells(i, 28)\n        'End If\n        If arrHolder(i, 18) &lt; 0 Then\n            arrHolder(i, 29) = \"C\"\n            arrHolder(i, 27) = vbNullString\n        Else\n            arrHolder(i, 27) = arrHolder(i, 28)\n        End If\n\n        '.Cells(i, 31).Value = Application.SumIf(.Range(.Cells(2, 1), .Cells(lrMain, 1)), _\n        '    .Cells(i, 1).Value, .Range(.Cells(2, 27), .Cells(lrMain, 27)))\n        ' Another SumIf. Same as before, we will have to figure this out separately.\n        arrHolder(i, 31) = SumIf(arrHolder(), 1, i, arrHolder(i, 1).Value, 27)\n\n        'arrHolder(I, 31) = Application.SumIf(.Range(.Cells(2, 1), .Cells(lrMain, 1)), _\n            .Cells(I + 1, 1).Value, .Range(.Cells(2, 27), .Cells(lrMain, 27)))\n\n        'If .Cells(i, 5) = \"\" Then\n        '    .Cells(i, 35) = \"\"\n        'Else\n        '    .Cells(i, 35).Value = Application.Index(indexVelocity1, _\n        '    Application.Match(.Cells(i, 5), matchVelocity1, False))\n        'End If\n        ' Thinking about it now, I am not sure about Application Index/Match on an array either.\n        If arrHolder(i, 5) = vbNullString Then\n            arrHolder(i, 35) = vbNullString\n        Else\n            arrHolder(i, 35) = Application.Index(indexVelocity1, _\n            Application.Match(arrHolder(i, 5), matchVelocity1, False))\n        End If\n\n        'If .Cells(i, 6).Value = 0 Then\n        '    .Cells(i, 44).Value = 0\n        'Else\n        '    .Cells(i, 44).Value = Round(((((.Cells(i, 6).Value / .Cells(i, 11).Value) _\n        '        / .Cells(i, 10).Value) - .Cells(i, 8).Value) / .Cells(i, 35).Value), 0.1)\n        'End If\n        If arrHolder(i, 6) = 0 Then\n            arrHolder(i, 44) = 0\n        Else\n            arrHolder(i, 44) = Round(((((arrHolder(i, 6) / arrHolder(i, 11)) _\n                / arrHolder(i, 10)) - arrHolder(i, 8)) / arrHolder(i, 35)), 0.1)\n        End If\n\n        'If .Cells(i, 6).Value = 0 Then\n        '    .Cells(i, 34).Value = 0\n        '    .Cells(i, 33) = 0\n        'Else\n        '    .Cells(i, 34).Value = Round(((((.Cells(i, 6) / .Cells(i, 11)) / _\n        '    .Cells(i, 10)) - .Cells(i, 8)) / .Cells(i, 35)) * .Cells(i, 11), 0.1)\n        '    If .Cells(i, 34) &gt; 0 Then\n        '        .Cells(i, 33) = .Cells(i, 34)\n        '    Else\n        '        .Cells(i, 33) = 0\n        '    End If\n        'End If\n        If arrHolder(i, 6) = 0 Then\n            arrHolder(i, 34) = 0\n            arrHolder(i, 33) = 0\n        Else\n            arrHolder(i, 34) = Round(((((arrHolder(i, 6) / arrHolder(i, 11)) / _\n            arrHolder(i, 10)) - arrHolder(i, 8)) / arrHolder(i, 35)) * arrHolder(i, 11), 0.1)\n            If arrHolder(i, 34) &gt; 0 Then\n                arrHolder(i, 33) = arrHolder(i, 34)\n            Else\n                arrHolder(i, 33) = 0\n            End If\n        End If\n\n\n        '.Cells(i, 37) = 1 + calcWeek\n        arrHolder(i, 37) = 1 + calcWeek\n\n        '.Cells(i, 38) = .Cells(i, 5) &amp; .Cells(i, 37)\n        arrHolder(i, 38) = arrHolder(i, 5) &amp; arrHolder(i, 37)\n\n        '.Cells(i, 39).Value = Application.Index(indexVelocity2, _\n        '    Application.Match(.Cells(i, 38), matchVelocity2, False))\n        arrHolder(i, 39) = Application.Index(indexVelocity2, _\n            Application.Match(arrHolder(i, 38), matchVelocity2, False))\n\n        '.Cells(i, 40) = Round(((((.Cells(i, 6) / .Cells(i, 11)) * .Cells(i, 39)) _\n        '    - .Cells(i, 6)) - (.Cells(i, 8) - .Cells(i, 6))) / .Cells(i, 35), 0.1)\n        arrHolder(i, 40) = Round(((((arrHolder(i, 6) / arrHolder(i, 11)) * arrHolder(i, 39)) _\n            - arrHolder(i, 6)) - (arrHolder(i, 8) - arrHolder(i, 6))) / arrHolder(i, 35), 0.1)\n\n\n        'If .Cells(i, 40) &lt; 0 Then\n        '    .Cells(i, 41) = 0\n        'Else\n        '    .Cells(i, 41) = .Cells(i, 40)\n        'End If\n        If arrHolder(i, 40) &lt; 0 Then\n            arrHolder(i, 41) = 0\n        Else\n           arrHolder(i, 41) = arrHolder(i, 40)\n        End If\n\n        '.Cells(i, 42) = .Cells(i, 41) - .Cells(i, 33)\n        arrHolder(i, 42) = arrHolder(i, 41) - arrHolder(i, 33)\n\n        'If .Cells(i, 11) &lt; .Cells(1, 44) Then\n        '    .Cells(i, 45) = 0\n        '    .Cells(i, 32) = .Cells(i, 45)\n        'Else\n        '    .Cells(i, 32) = Application.Max(.Cells(i, 33), .Cells(i, 41))\n        '    If .Cells(i, 44) &lt; 0 Then\n        '        .Cells(i, 45) = \"\"\n        '    Else\n        '        .Cells(i, 45) = .Cells(i, 44)\n        '    End If\n        'End If\n        ' Not 100% sure if applicaiton.max will work here.\n        If arrHolder(i, 11) &lt; arrHolder(1, 44) Then\n            arrHolder(i, 45) = 0\n            arrHolder(i, 32) = arrHolder(i, 45)\n        Else\n            If arrHolder(i, 33) &gt; arrHolder(i, 41) Then\n                arrHolder(i, 32) = arrHolder(i, 33)\n            Else\n                arrHolder(i, 32) = arrHolder(i, 41)\n            End If\n\n            If arrHolder(i, 44) &lt; 0 Then\n                arrHolder(i, 45) = vbNullString\n            Else\n                arrHolder(i, 45) = arrHolder(i, 44)\n            End If\n        End If\n\n\n        'If .Cells(i, 31) &lt; ShipMin Then\n        '    .Cells(i, 47) = 0\n        'Else\n        '    .Cells(i, 47) = .Cells(i, 27)\n        'End If\n        If arrHolder(i, 31) &lt; ShipMin Then\n            arrHolder(i, 47) = 0\n        Else\n            arrHolder(i, 47) = arrHolder(i, 27)\n        End If\n\n        '.Cells(i, 46) = .Cells(i, 1) &amp; .Cells(i, 22) &amp; .Cells(i, 47)\n        arrHolder(i, 46) = arrHolder(i, 1) &amp; arrHolder(i, 22) &amp; arrHolder(i, 47)\n\n\n\n    If (i Mod 100) = 0 Then\n        Debug.Print \"Got to row \"; i; \" in \"; Timer - MainTimer; \" seconds.\"\n    End If\nEnd If\nNext i\n\nwsMain.Range(wsMain.Cells(2, 1), wsMain.Cells(lrMain, 47)).Value = arrHolder\n\nErase arrHolder\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["windows", "vba", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1490218756, "post_id": 42962850, "comment_id": 73020396, "body": "Are you getting any errors? <code>Tables.Add</code> returns a <code>Table</code> object, so you can declare a <code>Table</code> variable and then capture the reference with <code>Set whatever = Doc.Tables.Add &#39;with your arguments</code>.  Also, <code>Doc.Tables(tblIndx).Application</code> is the same thing as your <code>wd</code> instance."}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1490270557, "post_id": 42962850, "comment_id": 73042783, "body": "Your path indicates a network share. Have you included it in Word&#39;s &quot;trusted storage locations&quot;? File=&gt;Options=&gt;Trust Center =&gt; Trusted sites... (or similar, I have a localized version of Word)"}], "owner": {"reputation": 11, "user_id": 7674081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948036cca05017d11999075e47a868c3?s=128&d=identicon&r=PG&f=1", "display_name": "Deputy programmer", "link": "https://stackoverflow.com/users/7674081/deputy-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490219094, "creation_date": 1490217578, "last_edit_date": 1490219094, "question_id": 42962850, "link": "https://stackoverflow.com/questions/42962850/450-error-message", "title": "450 Error message", "body": "<p>I cannot get an original copy of word to open. It only allows me a read only copy. The Doc.Tables.Add... does not seem to work.  </p>\n\n<p>I will eventually pass an array to this sub routine, containing data to write to the fields of #the table.  First I have to get it to add tables. I get the #sense that my \"Doc\" is not recognized.  Any help is appreciated.</p>\n\n<pre><code>    Sub InsertTbl()\n        Dim wd As Word.Application\n        Dim Doc As Word.Document\n        Dim fn As String\n\n        fn = \"H:\\JailData\\aaNEW\\GTL_Receipts.docx\"\n        Set wd = New Word.Application\n        wd.Visible = True\n        Set Doc = wd.Documents.Open(fn)\n        MsgBox Doc.Tables.Count\n        Doc.Tables.Add Range:=Selection.Range, NumRows:=3, NumColumns:=4\n\n        tblIndx = Doc.Tables.Count\n        With Doc.Tables(tblIndx).Application\n            .Left = 100\n            .Top = 200\n        End With\n        Doc.Tables(tblIndx).Range.Font.Size = 8\n    End Sub\n</code></pre>\n"}, {"tags": ["angularjs", "vba", "excel"], "comments": [{"owner": {"reputation": 2490, "user_id": 7512742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/muuJz.png?s=128&g=1", "display_name": "Adam Vincent", "link": "https://stackoverflow.com/users/7512742/adam-vincent"}, "edited": false, "score": 0, "creation_date": 1490227031, "post_id": 42962626, "comment_id": 73023655, "body": "Ugh, I feel your pain.  I&#39;m doing stuff like this at work. I personally would have Excel fetch the data directly form the data source (via ODBC), and create a new macro to copy the fetched data into your pre-existing excel document. If you have more hurdles with this approach, let&#39;s discuss further."}, {"owner": {"reputation": 21, "user_id": 3081825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FiPw.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/3081825/john"}, "reply_to_user": {"reputation": 2490, "user_id": 7512742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/muuJz.png?s=128&g=1", "display_name": "Adam Vincent", "link": "https://stackoverflow.com/users/7512742/adam-vincent"}, "edited": false, "score": 0, "creation_date": 1490386169, "post_id": 42962626, "comment_id": 73106165, "body": "@AdamVincent there&#39;s definitely more hurdles. tl;dr, we have to take the sessionID from the web UI and pass it to the Excel workbook in order for any of the VBA service calls to work, as only an authenticated user can do the service calls and we&#39;re avoiding needing to login from the web UI and the workbook. we don&#39;t want to alter the back-end to allow an endpoint to access the sessionID without being authenticated, which is the major limitation."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 3081825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FiPw.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/3081825/john"}, "is_accepted": true, "score": 0, "last_activity_date": 1490892788, "last_edit_date": 1490892788, "creation_date": 1490725595, "answer_id": 43077209, "question_id": 42962626, "link": "https://stackoverflow.com/questions/42962626/edit-a-premade-macro-enabled-excel-document-from-angularjs-webapp/43077209#43077209", "title": "Edit a premade macro-enabled excel document from AngularJS webapp", "body": "<p>I may have found an answer, but it's not quite available yet. I left <a href=\"https://github.com/SheetJS/js-xlsx/issues/606\" rel=\"nofollow noreferrer\">an issue</a> on the SheetJS GitHub page which got answered today. Sounds like macro persistence functionality is being added into the release this upcoming Friday. From there, add <code>bookVBA:true</code> to the options of your readFile call like <code>XLSX.readFile(\"filename\", {bookVBA:true, /* .. other options */});</code>, and then on your writeFile call you add the option of <code>bookType:\"xlsm\"</code>.</p>\n\n<p>This is of course speculatory, as the change isn't live yet. I'll make sure to update this answer at that time. </p>\n\n<p>EDIT/UPDATE: SheetJS now works in copying over macros to a new workbook, but there's currently a bug. If you have any code in the ThisWorkbook object to do anything on startup, sheet changes, etc., they won't work after writing back out, as it creates a new ThisWorkbook1 object. I've already opened an issue on it, but that should be fixed relatively quickly. </p>\n"}], "owner": {"reputation": 21, "user_id": 3081825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FiPw.jpg?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/3081825/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 43077209, "answer_count": 1, "score": 0, "last_activity_date": 1490892788, "creation_date": 1490216653, "last_edit_date": 1495540451, "question_id": 42962626, "link": "https://stackoverflow.com/questions/42962626/edit-a-premade-macro-enabled-excel-document-from-angularjs-webapp", "title": "Edit a premade macro-enabled excel document from AngularJS webapp", "body": "<p>I've got quite the issue that I can't seem to figure out how to do cleanly after hours of scouring the internet, hoping you all could help me out.</p>\n\n<p>We have an AngularJS web-app that is used to create an object in a database according a large set of variables. After the object is put into the database, we want to put some of the fields into a macro-enabled excel doc containing some necessary VBA macros that then downloads to the user's computer. </p>\n\n<p>From what I've found, Angular can output the data to a new excel doc, but we need to have the data put into the pre-existing excel document. The closest tool I've found is <a href=\"https://github.com/SheetJS/js-xlsx\" rel=\"nofollow noreferrer\">SheetJS</a> from a <a href=\"https://stackoverflow.com/a/38639049/3081825\">different StackOverflow question/answer</a>, but that answer doesn't actually implement the functionality to edit the current excel, only write to a new excel document. </p>\n\n<p>Any and all suggestions on fixing my problem are appreciated!</p>\n"}, {"tags": ["excel", "vba", "dynamic", "filtering", "search-box"], "comments": [{"owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 1, "creation_date": 1490213914, "post_id": 42961704, "comment_id": 73017834, "body": "You should post the code assigned to these textboxes instead of sending a link for download..."}, {"owner": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "reply_to_user": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "edited": false, "score": 0, "creation_date": 1490214476, "post_id": 42961704, "comment_id": 73018137, "body": "Thank you, forgot about that. Edited the entry."}], "answers": [{"tags": [], "owner": {"reputation": 4475, "user_id": 3846228, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/j0fFT.jpg?s=128&g=1", "display_name": "dot.Py", "link": "https://stackoverflow.com/users/3846228/dot-py"}, "is_accepted": false, "score": 1, "last_activity_date": 1490214573, "creation_date": 1490214573, "answer_id": 42962034, "question_id": 42961704, "link": "https://stackoverflow.com/questions/42961704/dynamic-search-and-filtering-in-excel/42962034#42962034", "title": "Dynamic search and filtering in Excel", "body": "<p>In the second code:</p>\n\n<pre><code>Private Sub TextBox2_Change()\nActiveSheet.ListObjects(\"address2\").Range.AutoFilter Field:=1, Criteria1:=\"*\" &amp; [B1] &amp; \"*\", Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>You should change <code>Field:=1</code> to <code>Field:=2</code>, otherwise you'll be searching the content at <code>TextBox2_Change</code>at <code>addr1</code> column.</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1490222380, "last_edit_date": 1490222380, "creation_date": 1490219768, "answer_id": 42963394, "question_id": 42961704, "link": "https://stackoverflow.com/questions/42961704/dynamic-search-and-filtering-in-excel/42963394#42963394", "title": "Dynamic search and filtering in Excel", "body": "<p>The problem you are facing for now is that the filter <code>\"*1*\"</code> will only match strings, not numbers. Even if you format your cells as <code>Text</code>, the <em>already entered numbers</em> will be still parsed as numbers; they wont be converted to strings. You have two ways to enter a number as string:</p>\n\n<ul>\n<li><p>enter it in to the cell <em>after</em> you had formatted it as <code>Text</code></p></li>\n<li><p>enter it preceded with some <code>'</code> (single quote). i.e. <code>'123</code>. This would force Excel to take it as a string, even if the format of the cell is <code>General</code>.</p></li>\n</ul>\n\n<p>For the time being you may write a simple macro to convert all you table's data into strings and proceed from there.</p>\n\n<p>Finally I don't understand why you define a different table for each of the three adjacent columns. You should make only one table with three columns.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1490459240, "creation_date": 1490459240, "answer_id": 43018908, "question_id": 42961704, "link": "https://stackoverflow.com/questions/42961704/dynamic-search-and-filtering-in-excel/43018908#43018908", "title": "Dynamic search and filtering in Excel", "body": "<p>Try these two samples.  See the images below to get a sense of how these work.</p>\n\n<p><a href=\"http://www.mediafire.com/file/1ozjpza6zx0gav8/FastFilter.xls\" rel=\"nofollow noreferrer\">http://www.mediafire.com/file/1ozjpza6zx0gav8/FastFilter.xls</a></p>\n\n<p><a href=\"http://www.mediafire.com/file/u7la5pdx8qtxzm5/Filter_using_Event_Code.xlsb\" rel=\"nofollow noreferrer\">http://www.mediafire.com/file/u7la5pdx8qtxzm5/Filter_using_Event_Code.xlsb</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/9njWi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9njWi.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Ph74B.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ph74B.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 71, "user_id": 6294766, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb33d1ed1925238bb66ef1ba279b062e?s=128&d=identicon&r=PG&f=1", "display_name": "llorcs", "link": "https://stackoverflow.com/users/6294766/llorcs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3435, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1490459240, "creation_date": 1490213374, "last_edit_date": 1490214454, "question_id": 42961704, "link": "https://stackoverflow.com/questions/42961704/dynamic-search-and-filtering-in-excel", "title": "Dynamic search and filtering in Excel", "body": "<p>Currently I am experimenting with dynamic search bars and filtering in Excel. \nI have found a nice tutorial that uses a table and Active-X text box. I have recreated it and surely it works. My problem however is that it only takes into account one column. Now, I have created another table and another search bar, thinking that it would work just as fine, however, for some reason it does not.\nHere is the problem:\nThe data set looks like this;\n<a href=\"https://i.stack.imgur.com/mjpaB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mjpaB.jpg\" alt=\"enter image description here\"></a>\nSearching for cells containing \"1\" in \"addr1\"(works normal):\n<a href=\"https://i.stack.imgur.com/jyBuI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jyBuI.jpg\" alt=\"enter image description here\"></a>\nSearching for cells containing \"1\" in \"addr2\"(does not work):\n<a href=\"https://i.stack.imgur.com/mGmhW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mGmhW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried setting the format to Text, general, number etc. but nothing seems to have any effect. The second search should list the cells containing \"123\" as well but it doesn't.</p>\n\n<p>VBA Code in the Sheet:</p>\n\n<pre><code>Private Sub TextBox1_Change()\nActiveSheet.ListObjects(\"address1\").Range.AutoFilter Field:=1, Criteria1:=\"*\"  &amp; [A1] &amp; \"*\", Operator:=xlFilterValues\n\nEnd Sub\n\nPrivate Sub TextBox2_Change()\nActiveSheet.ListObjects(\"address2\").Range.AutoFilter Field:=1, Criteria1:=\"*\" &amp; [B1] &amp; \"*\", Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>Anybody has any solution?</p>\n\n<p>My sample file can be found here:\n<a href=\"https://www.dropbox.com/s/b4hpsczrhjbe2is/searchbar.xlsm?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/b4hpsczrhjbe2is/searchbar.xlsm?dl=0</a></p>\n\n<p>Thank you for any feedback!</p>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 751, "user_id": 7703272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7626dc82de2b4f94f721915b80360410?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7703272/kevin"}, "edited": false, "score": 1, "creation_date": 1490212664, "post_id": 42961439, "comment_id": 73017200, "body": "You can only delete rows from one tablet at a time. You are specifying two tables in your select clause. What should be deleted?"}, {"owner": {"reputation": 1, "user_id": 4489953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b9725b2b08e7c47d8b1d9647424b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaclyn Williams", "link": "https://stackoverflow.com/users/4489953/jaclyn-williams"}, "reply_to_user": {"reputation": 751, "user_id": 7703272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7626dc82de2b4f94f721915b80360410?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/7703272/kevin"}, "edited": false, "score": 0, "creation_date": 1490223073, "post_id": 42961439, "comment_id": 73022290, "body": "Both tables data will be deleted eventually. I am assuming I can only delete data from one table at a time. In this example the manhours table is having records deleted as they relate to the Tickets table. The criteria from the Tickets table is what determines which manhours record should be deleted (Manhours.TicketID = Ticket.ID). I&#39;ve been looking for a method to do this so if there is a better way of doing this please let me know."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4489953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b9725b2b08e7c47d8b1d9647424b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaclyn Williams", "link": "https://stackoverflow.com/users/4489953/jaclyn-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1490309412, "creation_date": 1490309412, "answer_id": 42988413, "question_id": 42961439, "link": "https://stackoverflow.com/questions/42961439/how-can-i-delete-records-based-on-a-query/42988413#42988413", "title": "How can I delete records based on a query?", "body": "<p>Good news!</p>\n\n<p>I found what I was looking for:</p>\n\n<p><code>DELETE FROM Manhours\n WHEN EXISTS (SELECT ID FROM Tickets\n WHERE (Tickets.Status) = \"Closed\" \n AND ((Year([Open Date]))&lt; Year(DATE())-1 OR ((Year([Open Date]))= Year(DATE()-1))</code></p>\n"}], "owner": {"reputation": 1, "user_id": 4489953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b9725b2b08e7c47d8b1d9647424b7e?s=128&d=identicon&r=PG&f=1", "display_name": "Jaclyn Williams", "link": "https://stackoverflow.com/users/4489953/jaclyn-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490309412, "creation_date": 1490212472, "last_edit_date": 1490212698, "question_id": 42961439, "link": "https://stackoverflow.com/questions/42961439/how-can-i-delete-records-based-on-a-query", "title": "How can I delete records based on a query?", "body": "<p>What I am trying to accomplish is to have VBA run the delete query on backup. The issue is with my query (I hope)\nI have a select query that isolates records which I want to delete, however when I try to make it a delete query I get this error:</p>\n\n<blockquote>\n  <p>Specify the table containing the records you want to delete.</p>\n</blockquote>\n\n<p>OR this error:</p>\n\n<blockquote>\n  <p>Reserved error (-3211); there is no message for this error.</p>\n</blockquote>\n\n<p>My select statement reads: </p>\n\n<pre><code>SELECT Manhours.*, Tickets.Status, Year([Open Date])\nFROM Manhours INNER JOIN Tickts ON Manhours.TicketID = Tickets.ID\nWHERE (Tickets.Status) = \"Closed\" AND ((Year([Open Date]))&lt; Year(DATE())-1 \n      OR ((Year([Open Date]))= Year(DATE()-1))\n</code></pre>\n\n<p>The select statement will call the records I need, but when I try to make it a delete query it errors out.</p>\n"}, {"tags": ["excel", "password-protection", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490212495, "post_id": 42961415, "comment_id": 73017100, "body": "That error suggests that you have code outside Sub/End Sub statements. Have you omitted them from your posted code or not added them? Also, the clause after the Then needs to be on a new line."}, {"owner": {"reputation": 1, "user_id": 7753370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e355511448d1e565a9e684842b88b6?s=128&d=identicon&r=PG&f=1", "display_name": "WSherm", "link": "https://stackoverflow.com/users/7753370/wsherm"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490212556, "post_id": 42961415, "comment_id": 73017132, "body": "I don&#39;t believe so, here&#39;s my full code I&#39;m trying to run.         Sub HideData()         With Sheet2         If Cells(&quot;B1&quot;).Text = &quot;preserve&quot; Then Rows(&quot;2:500&quot;).EntireRow.Hidden = False         Else: Rows(&quot;2:500&quot;).EntireRow.Hidden = True         End If         End With         End Sub"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490212644, "post_id": 42961415, "comment_id": 73017189, "body": "Please add to your original post and format as code."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490213082, "post_id": 42961415, "comment_id": 73017428, "body": "When that error comes up it will usually highlight the problem in the VB editor."}, {"owner": {"reputation": 1, "user_id": 7753370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e355511448d1e565a9e684842b88b6?s=128&d=identicon&r=PG&f=1", "display_name": "WSherm", "link": "https://stackoverflow.com/users/7753370/wsherm"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490213147, "post_id": 42961415, "comment_id": 73017471, "body": "Yeah, VB highlighted the B1..."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490213201, "post_id": 42961415, "comment_id": 73017501, "body": "Oops, completely missed that. The syntax is wrong (see answer below) but wouldn&#39;t have expected that error to appear. Actually, I think you must have some stray text elsewhere as the B1 would produce a different error message."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1490213694, "post_id": 42961415, "comment_id": 73017741, "body": "Yes, the <code>Else</code> following the single-line <code>If</code> should have generated an &quot;Else without If` compile error.  Once that is fixed (by moving the code after <code>Then</code> to a new line) you would get an &quot;Invalid procedure call or argument&quot; due to the <code>Cells(&quot;B1&quot;)</code>.  But nothing in your posted code should be generating an &quot;Invalid Outside Procedure&quot; error."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7753370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e355511448d1e565a9e684842b88b6?s=128&d=identicon&r=PG&f=1", "display_name": "WSherm", "link": "https://stackoverflow.com/users/7753370/wsherm"}, "edited": false, "score": 0, "creation_date": 1490213732, "post_id": 42961652, "comment_id": 73017756, "body": "Thanks SJR, this worked. But I might have to try a new method I think based on what I need the excel sheet to do. Thanks again."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 7753370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e355511448d1e565a9e684842b88b6?s=128&d=identicon&r=PG&f=1", "display_name": "WSherm", "link": "https://stackoverflow.com/users/7753370/wsherm"}, "edited": false, "score": 0, "creation_date": 1490214105, "post_id": 42961652, "comment_id": 73017920, "body": "OK, that sounds like it is a different question."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1490213542, "last_edit_date": 1490213542, "creation_date": 1490213177, "answer_id": 42961652, "question_id": 42961415, "link": "https://stackoverflow.com/questions/42961415/invalid-outside-procedure-new-to-coding/42961652#42961652", "title": "Invalid Outside Procedure - new to coding", "body": "<p>Try this (note the dots which tie the ranges to the sheet and without which the active sheet will be referenced - this won't have caused your error though):</p>\n\n<pre><code>Sub HideData()\n\nWith Sheet2\n    .Rows(\"2:500\").EntireRow.Hidden = Not (.Range(\"B1\").Text = \"preserve\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7753370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18e355511448d1e565a9e684842b88b6?s=128&d=identicon&r=PG&f=1", "display_name": "WSherm", "link": "https://stackoverflow.com/users/7753370/wsherm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490213542, "creation_date": 1490212392, "last_edit_date": 1531161705, "question_id": 42961415, "link": "https://stackoverflow.com/questions/42961415/invalid-outside-procedure-new-to-coding", "title": "Invalid Outside Procedure - new to coding", "body": "<p>I'm trying to hide certain rows of code dependent upon putting in a \"password\" into a cell in the same worksheet in Excel.\nI'm not very savvy but here's what I've pieced together so far:</p>\n\n<pre><code>Sub HideData()\n\nWith Sheet2\n\nIf Cells(\"B1\").Text = \"password\" Then Rows(\"2:500\").EntireRow.Hidden = False\nElse: Rows(\"2:500\").EntireRow.Hidden = True\nEnd If\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["regex", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1490223539, "last_edit_date": 1490223539, "creation_date": 1490213600, "answer_id": 42961770, "question_id": 42961146, "link": "https://stackoverflow.com/questions/42961146/vba-and-regex-with-named-groups/42961770#42961770", "title": "VBA and Regex with Named Groups", "body": "<p>You don't. VBA uses VBScript-flavored regex, which doesn't support named groups. Use numbered capture groups instead.</p>\n\n<p>And since that makes your regex pattern much harder to debug... and since you asked for a work-around, if you have access to Visual Studio you could whip up a little COM-visible class library that exposes a .net-flavored regex (much more similar to Java's than VBScript's) API that you could reference and use in your VBA code.</p>\n\n<p>The downside is that you now need to manage deployment of that library.</p>\n\n<p>If you <em>have</em> to stick with VBScript-regex, then use a tool like <a href=\"http://www.ultrapico.com/expresso.htm\" rel=\"nofollow noreferrer\">Expresso</a> (no affiliation, free with registration required after 30 days) to help you out.</p>\n\n<p><img src=\"https://i.stack.imgur.com/FE5dv.png\" alt=\"Expresso regex analyzer\"></p>\n\n<p>Expresso understands .net regex though, so it will deem your pattern completely valid.</p>\n\n<p>Or, use <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>'s <em>regex assistant</em> feature, which understands VBScript-regex and will tell you which part(s) of your pattern won't work in VBA (disclaimer: I maintain that project - it's free, open source and actively maintained):</p>\n\n<p><img src=\"https://i.stack.imgur.com/EG2az.png\" alt=\"Rubberduck regex analyzer\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/7bItJ.png\" alt=\"enter image description here\"></p>\n\n<p>Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 305, "user_id": 4634246, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/10102482762915129/picture?type=large", "display_name": "Jamie Snipes", "link": "https://stackoverflow.com/users/4634246/jamie-snipes"}, "edited": false, "score": 0, "creation_date": 1490216801, "post_id": 42962362, "comment_id": 73019462, "body": "This seems simpler now than I thought it was going to be. Can someone give me a walk through on picking out matching results with a loop. I keep seeing different methods used."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 305, "user_id": 4634246, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/10102482762915129/picture?type=large", "display_name": "Jamie Snipes", "link": "https://stackoverflow.com/users/4634246/jamie-snipes"}, "edited": false, "score": 0, "creation_date": 1490218687, "post_id": 42962362, "comment_id": 73020361, "body": "@JamieSnipes Supposedly, <code>For Each object in Collection</code> is a bit more efficient than <code>For I = 0 to .count-1</code>.   With your submatches, you are going to need to maintain a counter anyway."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490221182, "post_id": 42962362, "comment_id": 73021427, "body": "For Each is <i>definitely</i> faster than a For loop for iterating object collections."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1490223422, "post_id": 42962362, "comment_id": 73022429, "body": "You might want to mention that the tool isn&#39;t free."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490233971, "post_id": 42962362, "comment_id": 73025651, "body": "@Mat&#39;sMug That&#39;s one reason why I provided the translation. Although all that was necessary was to remove the <code>capture name tags</code> from the regex.  I just looked at the web site. The price is $39.95 with a three month money-back if not satisfied guarantee.  I have found it an excellent tool."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490234121, "post_id": 42962362, "comment_id": 73025695, "body": "@Mat&#39;sMug  That&#39;s what I have read about the <code>For Each</code> loops. And that&#39;s what I frequently use. But I&#39;ve never actually timed it myself.  Is it also faster if one has to increment a counter on each pass through the loop?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490236167, "post_id": 42962362, "comment_id": 73026260, "body": "<a href=\"http://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">This guy timed it</a> - &quot;<i>the For Each loops was almost 27x faster than the For loop</i>&quot; ...that&#39;s <i>orders of magnitude</i> faster. So.. Yeah."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490237139, "post_id": 42962362, "comment_id": 73026504, "body": "@Mat&#39;sMug Interesting that speed difference was for looping a Collection. The For ... loop was 3x faster looping an array."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1490238233, "post_id": 42962362, "comment_id": 73026786, "body": "Yes, that&#39;s exactly what I said earlier: use a For Each loop to iterate object collections. If you think about how arrays are represented in memory it&#39;s not surprising either that a For loop is faster for arrays. Object collections use a hidden <code>[_NewEnum]</code> property getter to yield the next object reference, they&#39;re literally optimized for For Each loops - it&#39;s much more work to retrieve an item by its index than using the enumerator."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1490239419, "post_id": 42962362, "comment_id": 73027083, "body": "@RonRosenfeld - Indexing into a SAFEARRAY is simply pointer math and memory dereferencing.  Once you have the base address and the element size, it&#39;s as simple as calculating the offset. I have a VBA demo <a href=\"http://stackoverflow.com/a/39146283/4088852\">in this answer</a>."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1490268700, "post_id": 42962362, "comment_id": 73041573, "body": "@Mat&#39;sMug Many thanks to you for your more detailed explanations."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1490216296, "last_edit_date": 1490216296, "creation_date": 1490215620, "answer_id": 42962362, "question_id": 42961146, "link": "https://stackoverflow.com/questions/42961146/vba-and-regex-with-named-groups/42962362#42962362", "title": "VBA and Regex with Named Groups", "body": "<p><a href=\"https://www.regexbuddy.com/\" rel=\"nofollow noreferrer\">RegexBuddy</a> is a program which can convert your Java regex to a vbScript compatible regex.  It gives the same output as the example you posted in your link, but with numbered rather than named capturing groups:</p>\n\n<pre><code>(\\d{1,3}(?:\\.\\d{1,3}){2}\\.(\\d{1,3}))(?:(?:/|\\s+/\\s+)(\\d{1,2})|(?:-|\\s+to\\s+)(\\d{1,3}(?![\\d.]))|(?:-|\\s*to\\s+)(\\d{1,3}(?:\\.\\d{1,3}){3})|\\s+(25\\d(?:\\.\\d{1,3}){3})|\\s*)?\n</code></pre>\n\n<p>It gives the output into numbered groups as follows:</p>\n\n<pre><code>1 Address\n2 FromSeg\n3 CIDR\n4 ToSeg\n5 ToIP\n</code></pre>\n\n<p>and the <code>debug.print</code> output in your macro appears to be correct, using your examples from your link.</p>\n"}], "owner": {"reputation": 305, "user_id": 4634246, "user_type": "registered", "accept_rate": 47, "profile_image": "https://graph.facebook.com/10102482762915129/picture?type=large", "display_name": "Jamie Snipes", "link": "https://stackoverflow.com/users/4634246/jamie-snipes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1490223539, "creation_date": 1490211470, "question_id": 42961146, "link": "https://stackoverflow.com/questions/42961146/vba-and-regex-with-named-groups", "title": "VBA and Regex with Named Groups", "body": "<p>Converting a method I had in Java to VBA is turning out to be much more difficult than anticipated. </p>\n\n<p>I have a regex which can be found <a href=\"https://regex101.com/r/zpI3qG/2/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>It uses named object groups which after some research, do not appear to be supported by VBA. I'm attempting to write a function for excel which will format IP addresses into different formats based on the inputs to the function. </p>\n\n<p>How can I work around using Named Groups in order to capture the different patterns? </p>\n\n<pre><code>Function formatIP(item As String, displayType As String) As String\n'displayTypes CIDR,MASK,RANGE\n\n'Set theRegEx = CreateObject(\"VBScript.RegExp\")\n\nDim theRegEx As New RegExp\n\n\nWith theRegEx\n.Global = True\n.MultiLine = False\n.IgnoreCase = False\n.Pattern = \"(?&lt;address&gt;\\d{1,3}(?:\\.\\d{1,3}){2}\\.(?&lt;FromSeg&gt;\\d{1,3}))(?:(?:\\/|\\s+\\/\\s+)(?&lt;CIDR&gt;\\d{1,2})|(?:-|\\s+to\\s+)(?&lt;ToSeg&gt;\\d{1,3}(?![\\d\\.]))|(?:-|\\s*to\\s+)(?&lt;ToIP&gt;\\d{1,3}(?:\\.\\d{1,3}){3})|\\s+(?&lt;Mask&gt;25\\d(?:\\.\\d{1,3}){3})|\\s*)?\"\n.Execute (item)\n\n\nEnd With\n\n\n'Set MyMatches = theRegEx.Execute(item)\nDebug.Print \"SubMatches.Count: \" &amp; MyMatches.item(0).SubMatches.Count\nIf MyMatches.Count &lt;&gt; 0 Then\n    With MyMatches\n        For myMatchCt = 0 To .Count - 1\n                Debug.Print \"myMatchCt: \" &amp; myMatchCt\n                For subMtCt = 0 To .item(subMtCt).SubMatches.Count - 1\n                    Debug.Print \"subMtCt: \" &amp; subMtCt\n                    Debug.Print (\",\" &amp;      .item(myMatchCt).SubMatches.item(subMtCt))\n                Next\n        Next\n    End With\nElse\nDebug.Print \"No Matches\"\nEnd If\n\nformatIP = \"\"\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1490211498, "creation_date": 1490211498, "answer_id": 42961156, "question_id": 42960986, "link": "https://stackoverflow.com/questions/42960986/excel-copy-all-from-workbook-2-paste-in-workbook/42961156#42961156", "title": "excel copy all from workbook 2, paste in workbook", "body": "<p>A few guesses as you haven't provided all the details</p>\n\n<pre><code>Sub UpdateTSOM()\n\nApplication.ScreenUpdating = False\n\nDim LastRow As Long\nDim StartCell As Range\nDim sht As Worksheet\nDim wb As Workbook\n\nSet sht = Sheet5\nSet StartCell = sht.Range(\"B2\")\n\n'Find Last Row\nLastRow = sht.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nIf MsgBox(\"Clear all Transmission Stock data?\", vbYesNo) = vbYes Then\n    Worksheets(\"TSOM\").Range(\"B2:N2000\").ClearContents\nEnd If\n\nSet wb = Workbooks.Open(\"P:\\ESO\\1790-ORL\\OUC\\_Materials\\Stock Status\\Transmission Stock Status **-**-**.xlsx\")\nwb.Sheets(1).UsedRange.Copy\nStartCell.PasteSpecial xlValues\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490621273, "post_id": 43047701, "comment_id": 73179562, "body": "why are you using <code>SendKeys</code>?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1490621400, "post_id": 43047701, "comment_id": 73179673, "body": "Also, instead of your <code>s = Mid(vFile, InstrRev(vFile, &quot;\\&quot;), + 1)</code> just do <code>s = Dir(vFile)</code>."}, {"owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490622349, "post_id": 43047701, "comment_id": 73180476, "body": "my <code>sendkeys</code> are used for dismissing a possible &quot;Large copy&quot; popup box. Anyway around it @DavidZemens ?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1490622626, "post_id": 43047701, "comment_id": 73180732, "body": "Yes, disable <code>Application.DisplayAlerts</code> should force the <i>default</i> option and suppress that dialog. Or you can do a direct value assignment (without invoking either <code>Copy</code> or <code>Paste&#47;PasteSpecial</code>) which will avoid any warning altogether."}], "tags": [], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "is_accepted": true, "score": 0, "last_activity_date": 1490621008, "creation_date": 1490621008, "answer_id": 43047701, "question_id": 42960986, "link": "https://stackoverflow.com/questions/42960986/excel-copy-all-from-workbook-2-paste-in-workbook/43047701#43047701", "title": "excel copy all from workbook 2, paste in workbook", "body": "<p>This is what I got to work. It brings up a select file folder and copies all the data from it into my current workbook. It then names B1 (my header) with the filename without the extension. </p>\n\n<pre><code>Sub UpdateTSOM()\nApplication.ScreenUpdating = False\nDim vFile As Variant\nDim wbCopyTo As Workbook\nDim wsCopyTo As Worksheet\nDim wbCopyFrom As Workbook\nDim wsCopyFrom As Worksheet\nDim s As String\n\nSet mycell = Worksheets(\"TSOM\").Range(\"B1\")\nSet wbCopyTo = ActiveWorkbook\nSet wsCopyTo = ActiveSheet\n\nIf MsgBox(\"Update transmission Stock Status data?\", vbYesNo) = vbYes Then\nWorksheets(\"TSOM\").Range(\"B2:N3000\").ClearContents\nElse: Exit Sub\nEnd If\n\n'Locate file to copy data from\nvFile = Application.GetOpenFilename(\"Excel Files (*.xl*),\" &amp; _\n\"*.xl*\", 1, \"Select Excel File\", \"Open\", False)\n\n'Assign filename to Header\ns = Mid(vFile, InStrRev(vFile, \"\\\") + 1)\ns = Left$(s, InStrRev(s, \".\") - 1)\nmycell.Value = s\n\nSet wbCopyFrom = Workbooks.Open(vFile)\nSet wsCopyFrom = wbCopyFrom.Worksheets(1)\n\n'Copy Range\nwsCopyFrom.Range(\"A1:N3000\").Copy\nwsCopyTo.Range(\"B2\").PasteSpecial Paste:=xlPasteValues, _\nOperation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nSendKeys \"Y\"\nSendKeys (\"{ESC}\")\n\n'Close file that was opened\nwbCopyFrom.Close SaveChanges:=False\nApplication.Wait (Now + 0.000005)\nCall NoSelect\nExit Sub\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1490622796, "last_edit_date": 1495535409, "creation_date": 1490622796, "answer_id": 43048341, "question_id": 42960986, "link": "https://stackoverflow.com/questions/42960986/excel-copy-all-from-workbook-2-paste-in-workbook/43048341#43048341", "title": "excel copy all from workbook 2, paste in workbook", "body": "<p>Avoid <code>SendKeys</code>, and since you are pasting values only, you don't need to use <em>either</em> <code>Copy</code> or <code>Paste/PasteSpecial</code>.</p>\n\n<pre><code>With wsCopyFrom.Range(\"A1:N3000\")\n    wsCopyTo.Range(\"B2\").Resize(.Rows.Count, .Columns.Count).Value = .Value \nEnd With\n</code></pre>\n\n<p>Here are several other ways to copy values from one file to another:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19351832/copy-from-one-workbook-and-paste-into-another/19352099#19352099\">Copy from one workbook and paste into another</a></p>\n"}], "owner": {"reputation": 389, "user_id": 7324177, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/10209248058172510/picture?type=large", "display_name": "Matt Taylor", "link": "https://stackoverflow.com/users/7324177/matt-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "closed_date": 1490622811, "accepted_answer_id": 43047701, "answer_count": 3, "score": 1, "last_activity_date": 1490622796, "creation_date": 1490210971, "last_edit_date": 1490232527, "question_id": 42960986, "link": "https://stackoverflow.com/questions/42960986/excel-copy-all-from-workbook-2-paste-in-workbook", "closed_reason": "Duplicate", "title": "excel copy all from workbook 2, paste in workbook", "body": "<p>I am trying to copy all data from a workbook on my server and paste the <code>values</code> to <code>B2</code> in another workbook.</p>\n\n<p>This is what I have so far. It brings me to the workbook 2, but I have to manually select all and copy then paste in workbook 1.</p>\n\n<pre><code>Sub UpdateTSOM()\n    Application.ScreenUpdating = False\n    Dim LastRow As Long\n    Dim StartCell As Range\n\n    Set sht = Sheet5\n    Set reportsheet = Sheet5\n    Set StartCell = Range(\"B2\")\n\n    'Refresh UsedRange\n    Worksheets(\"TSOM\").UsedRange\n\n    'Find Last Row\n    LastRow = sht.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n    'Select Range\n    sht.Range(\"B2:B\" &amp; LastRow).Select\n    With Range(\"B2:B\" &amp; LastRow)\n\n        If MsgBox(\"Clear all Transmission Stock data?\", vbYesNo) = vbYes Then\n\n            Worksheets(\"TSOM\").Range(\"B2:N2000\").ClearContents\n\n            MsgBox (\"Notes:\" &amp; vbNewLine &amp; vbNewLine &amp; _ 'This is not needed if I can automate the copy and paste.\n            \"Copy ALL\" &amp; vbNewLine &amp; _\n            \"Paste as Values\")\n        End If\n    End With\n    Workbooks.Open \"P:\\ESO\\1790-ORL\\OUC\\_Materials\\Stock Status\\Transmission Stock Status **-**-**.xlsx\"\n    ThisWorkbook.Activate\n\n    reportsheet.Select\n    Range(\"B2\").Select\n\n    whoa: 'If filename changes then open folder\n    Call Shell(\"explorer.exe\" &amp; \" \" &amp; \"P:\\ESO\\1790-ORL\\OUC\\_Materials\\Stock Status\", vbNormalFocus)\n    Range(\"B2\").Select\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "printing", "vba"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 3938754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52687677b23008501d980b3d68060ae?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Callas", "link": "https://stackoverflow.com/users/3938754/michael-callas"}, "is_accepted": false, "score": 2, "last_activity_date": 1490290819, "last_edit_date": 1490290819, "creation_date": 1490290284, "answer_id": 42983055, "question_id": 42960955, "link": "https://stackoverflow.com/questions/42960955/can-excel-2013-print-different-printtitlerows-to-each-page/42983055#42983055", "title": "Can Excel 2013 print different PrintTitleRows to each page?", "body": "<p>The answer in <em>no</em> and is based on my experience. The <strong>PrintTitleRows</strong> and <strong>PrintTitleColumns</strong> are a one time setting which I did in my <strong>PageSettings</strong> sub. Once <strong>ExportAsFixedFormat</strong> starts running, it never hits the <strong>PageSettings</strong> sub again.</p>\n\n<p><strong>PrintTitleRows</strong> is a one time setting that places the <em>same</em> row (or rows) at the top of every printed page but I needed <em>different</em> rows.</p>\n\n<p>The best I found way to achieve this is to add the necessary rows to the worksheet after each page break to make the report look the way I want when printed. I then hide these <em>header</em> rows from the user and display them when I print.</p>\n"}], "owner": {"reputation": 53, "user_id": 3938754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52687677b23008501d980b3d68060ae?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Callas", "link": "https://stackoverflow.com/users/3938754/michael-callas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490290819, "creation_date": 1490210869, "last_edit_date": 1531164843, "question_id": 42960955, "link": "https://stackoverflow.com/questions/42960955/can-excel-2013-print-different-printtitlerows-to-each-page", "title": "Can Excel 2013 print different PrintTitleRows to each page?", "body": "<p>I may be trying to do the impossible. What I need is to dynamically set the <strong>PrintTitleRows</strong> for each printed page in <strong>Excel</strong>. My worksheet is created dynamically and there are multiple <em>(yet similar)</em> sections of different row lengths and I want to show the <em>section name</em> and <em>description titles</em> on the top of the following page if the section overflows to multiple pages. The section names will <em>not</em> always be the same though the column titles will. The <em>section name</em> is on the row above the <em>description titles</em>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/iZIvD.png\" rel=\"nofollow noreferrer\">Section name and description titles</a></p>\n\n<p>Currently, I am calling my <strong>PageSettings</strong> sub and then executing the <strong>ExportAsFixedFormat</strong>, so I am guessing this can't be done.</p>\n\n<p>I have spent the last few hours searching the Microsoft site, <em>Stackoverflow.com</em> and the web in general with no questions or hits related to this question.</p>\n\n<p>Thanks in advance for any insight you may have.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490210393, "post_id": 42960778, "comment_id": 73015871, "body": "You are trying to insert a formula that will overwrite the data with the actual formula, and the formula needs a reference.  If you are trying to change the data in the cell to lower case then <code>r.Value = Lcase$(r.Value)</code>"}, {"owner": {"reputation": 3, "user_id": 7753222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd47f6a5f73f8b996910c767037b4563?s=128&d=identicon&r=PG&f=1", "display_name": "mystery-manatee", "link": "https://stackoverflow.com/users/7753222/mystery-manatee"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490210836, "post_id": 42960778, "comment_id": 73016103, "body": "Ah, okay! Should I insert <code>r.Value = Lcase&amp;(r.Value)</code> in place of <code>r.Formula</code>?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490210909, "post_id": 42960778, "comment_id": 73016153, "body": "yes, but it is <code>Lcase$(r.Value)</code>"}, {"owner": {"reputation": 3, "user_id": 7753222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd47f6a5f73f8b996910c767037b4563?s=128&d=identicon&r=PG&f=1", "display_name": "mystery-manatee", "link": "https://stackoverflow.com/users/7753222/mystery-manatee"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490211105, "post_id": 42960778, "comment_id": 73016256, "body": "Oops, yes, <code>$</code> instead of <code>&amp;</code>. Thanks for the catch! I tried a run and it prompted a &quot;compile error: Duplicate declaration in current scope&quot; for the <code>r As Range</code>?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490212426, "post_id": 42960778, "comment_id": 73017047, "body": "What is the LowerCase formula - is it a recent addition?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7753222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd47f6a5f73f8b996910c767037b4563?s=128&d=identicon&r=PG&f=1", "display_name": "mystery-manatee", "link": "https://stackoverflow.com/users/7753222/mystery-manatee"}, "edited": false, "score": 0, "creation_date": 1490211725, "post_id": 42961135, "comment_id": 73016617, "body": "Thank you so much! These modifications, along with u/Scott Craner&#39;s comment, made the code work!"}], "tags": [], "owner": {"reputation": 119, "user_id": 7626550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vt5dC.jpg?s=128&g=1", "display_name": "ArchiCAT", "link": "https://stackoverflow.com/users/7626550/archicat"}, "is_accepted": true, "score": 0, "last_activity_date": 1490211420, "creation_date": 1490211420, "answer_id": 42961135, "question_id": 42960778, "link": "https://stackoverflow.com/questions/42960778/applying-a-formula-to-multiple-columns-across-multiple-sheets-in-excel/42961135#42961135", "title": "Applying a formula to multiple columns, across multiple sheets in Excel", "body": "<p>There are several problems with this.</p>\n\n<ol>\n<li>You are using the <code>r</code> twice, once as a Long, once az a Range. </li>\n<li>The <code>For Each</code> loop's <code>Next</code> is missing</li>\n<li>The formula needs a reference of what would you like to set to lowercase.\nFor example, if you want to have the lowercase value of the left neightbouring cells, you should write: <code>=LOWERCASE(R[1]C[-1])</code></li>\n<li>Sheets are a 1 based collection, so if you write <code>For i = 1 To Sheets.Count - 1,</code> the last sheet wont be processed (maybe this is intentional?) and the code will throw an error at the first sheet (no sheets(0) exist)</li>\n</ol>\n\n<p>Something like this works:</p>\n\n<pre><code>Sub Clean_Lowercase()\n    Const N As Integer = 1\n    Dim r As Long, i As Integer, X As Integer, t As Long\n    Dim rng As Range, ri As Range\n    Dim v As Variant\n    v = Array(\"J\", \"O\", \"T\", \"Y\")\n    t = 1\n    For i = 1 To Sheets.Count\n        r = Sheets(i).UsedRange.Rows.Count\n        For X = 0 To UBound(v)\n            Set rng = Sheets(i).Range(v(X) &amp; N &amp; \":\" &amp; v(X) &amp; r)\n            For Each ri In rng\n                ri.Formula = \"=LOWERCASE(R[1]C[-1])\"\n            Next\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7753222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd47f6a5f73f8b996910c767037b4563?s=128&d=identicon&r=PG&f=1", "display_name": "mystery-manatee", "link": "https://stackoverflow.com/users/7753222/mystery-manatee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 42961135, "answer_count": 1, "score": 0, "last_activity_date": 1490211420, "creation_date": 1490210257, "last_edit_date": 1531164843, "question_id": 42960778, "link": "https://stackoverflow.com/questions/42960778/applying-a-formula-to-multiple-columns-across-multiple-sheets-in-excel", "title": "Applying a formula to multiple columns, across multiple sheets in Excel", "body": "<p>I am trying to apply the <code>=LOWERCASE()</code> formula to four columns (J, O, T, and Y) across multiple sheets in the same workbook. </p>\n\n<p>Here's the VBA code I have so far, it is applying to the right columns, but it's returning an error for each.</p>\n\n<pre><code>Sub Clean_Lowercase()\nConst N As Integer = 1\nDim r As Long, i As Integer, X As Integer, t As Long\nDim rng As Range, r As Range\nDim v As Variant\nv = Array(\"J\", \"O\", \"T\", \"Y\")\nt = 1\nFor i = 1 To Sheets.Count - 1\nr = Sheets(i).UsedRange.Rows.Count\nFor X = 0 To UBound(v)\n    Set rng = Sheets(i).Range(v(X) &amp; N &amp; \":\" &amp; v(X) &amp; r)\n    For Each r In rng\n        r.Formula = \"=LOWERCASE()\"\nNext\nNext\nEnd Sub\n</code></pre>\n\n<p>I am very new to VBA coding, any suggestions is greatly appreciated! I really want to learn.</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490210309, "post_id": 42960755, "comment_id": 73015827, "body": "Do you mean more than 4 <i>characters</i>? (counting the comma as a character, because none of the highlighted cells contain more than 4 <i>digits</i>)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490210358, "post_id": 42960755, "comment_id": 73015850, "body": "Also, you might want to indicate which line causes the error, and specifically what error message is?"}, {"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490210952, "post_id": 42960755, "comment_id": 73016179, "body": "I mean that if the number in the cell is 111 it will work, but if it&#39;s 1111 it won&#39;t work. The actual value of the cell doesn&#39;t contain the comma, that&#39;s just displaying from the number format that was automatically applied. The script is actually part of a larger script that has an error message box set, so the custom message is the response I&#39;m getting, not an excel error code. Let me remove the message box and see what the default excel response is"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490210996, "post_id": 42960755, "comment_id": 73016203, "body": "I&#39;m betting it&#39;s Overflow."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "edited": false, "score": 0, "creation_date": 1490275628, "post_id": 42961051, "comment_id": 73046769, "body": "You hit the nail right on the head! I had no idea that there was a limit for Integers vs Long types, that&#39;s good to know going forward in case I&#39;m working with either again. Thank you for the explanation and example! Also, from the link you posted it looks like Integer is maybe being slowly phased out, since VBA converts them all to Long in recent versions. I wonder if eventually this won&#39;t be an issue any more."}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1490303319, "post_id": 42961051, "comment_id": 73065630, "body": "Nice writeup here, David. Covers all the bases, and illustrates it very clearly!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1490211169, "creation_date": 1490211169, "answer_id": 42961051, "question_id": 42960755, "link": "https://stackoverflow.com/questions/42960755/excel-vba-more-than-4-digits-in-data-number-causes-script-error/42961051#42961051", "title": "Excel VBA - more than 4 digits in data number causes script error", "body": "<p>Overflow error is apparent from the screenshot data.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/aa164754.aspx\" rel=\"nofollow noreferrer\">Read up on the limitations of Integer data type:</a></p>\n\n<blockquote>\n  <p>Integer variables can hold values between -32,768 and 32,767, while Long variables can range from -2,147,483,648 to 2,147,483,647</p>\n</blockquote>\n\n<p>In your case, the sum of several integers can exceed the allowable values for your <code>Integer</code> variables. Change all of your <code>As Integer</code> declarations to <code>As Long</code>.</p>\n\n<p>Try this to illustrate it</p>\n\n<pre><code>Sub f()\n    Dim x As Integer, y As Integer, z As Integer\n    x = 9000\n    y = 23767\n    z = x + y\n    MsgBox z\n\n    MsgBox z + 1  '## Now we're over the limit of Integer type, this line will error\n\nEnd Sub\n</code></pre>\n\n<p>There also seems to be something tricky about arithmetic with Integer type -- namely: ifyou're adding several values together and <em>any one of them</em> are <code>Integer</code> type, VBA expects the return value to also be an integer. Sometimes this is not a problem, but when dealing with larger numbers it often is, so if you do:</p>\n\n<pre><code>val = 6 + 32767 'This will also raise an error!\nval = 32767 + 64738 'This will NOT error!\n</code></pre>\n\n<p>You need to coerce integers to <code>Long</code> and you can do this using <code>CLng</code> function:</p>\n\n<pre><code>val = CLng(6) + 32767\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7355139, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/933a14328a869a8841d3367b0033a9d6?s=128&d=identicon&r=PG&f=1", "display_name": "Alister M", "link": "https://stackoverflow.com/users/7355139/alister-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 42961051, "answer_count": 1, "score": 0, "last_activity_date": 1490211169, "creation_date": 1490210179, "last_edit_date": 1531161705, "question_id": 42960755, "link": "https://stackoverflow.com/questions/42960755/excel-vba-more-than-4-digits-in-data-number-causes-script-error", "title": "Excel VBA - more than 4 digits in data number causes script error", "body": "<p>I have a script that loops through all the CSV files in a folder, imports the data into a master workbook, then closes and deletes the CSV file before moving on to the next. A portion of the data import sets some cells as a variable and then performs a calculation to get a new number, which is then posted into the workbook. I was having an issue with ONE of my CSVs giving me an error and I have narrowed it down to having to do with whether the data is more than 4 digits long. <a href=\"https://i.stack.imgur.com/ObaHR.png\" rel=\"nofollow noreferrer\">This screenshot of the CSV shows what data is causing an error.</a> If I were to change the values by removing one digit from each of the highlighted cells, the CSV will import correctly. I don't know what's causing this or how to fix it. Changing the cell format to number/text/general/etc doesn't make a difference. The values of the cells themselves also do not contain the commas (the value is actually 9513, not 9,513)</p>\n\n<p>Below is the excerpt from the script that deals with importing the CSV data:</p>\n\n<pre><code>'LOOP THROUGH FOLLOWING CODE IF A MATCH IS FOUND\n    If Not rng1 Is Nothing Then\n        Dim table_list_object As ListObject\n        Dim table_object_row As ListRow\n        Set table_list_object = Workbooks(\"Spokes- Google Analytics trends.xlsm\").Worksheets(sheet_name_result).ListObjects(1)\n        Set table_object_row = table_list_object.ListRows.Add\n\n    'calculate pageviews\n        Dim organic_pageviews As Integer\n        Dim paid_pageviews As Integer\n        Dim direct_pageviews As Integer\n        Dim referral_pageviews As Integer\n        Dim display_pageviews As Integer\n        Dim sum_pageviews As Integer\n        organic_pageviews = Application.SumIf(Range(\"A:A\"), \"organic\", Range(\"C:C\"))\n        paid_pageviews = Application.SumIf(Range(\"A:A\"), \"paid\", Range(\"C:C\"))\n        direct_pageviews = Application.SumIf(Range(\"A:A\"), \"direct\", Range(\"C:C\"))\n        referral_pageviews = Application.SumIf(Range(\"A:A\"), \"referral\", Range(\"C:C\"))\n        display_pageviews = Application.SumIf(Range(\"A:A\"), \"display\", Range(\"C:C\"))\n        sum_pageviews = organic_pageviews + paid_pageviews + direct_pageviews + referral_pageviews + display_pageviews\n\n    'calculate visitors aka sessions\n        Dim organic_visitors As Integer\n        Dim paid_visitors As Integer\n        Dim direct_visitors As Integer\n        Dim referral_visitors As Integer\n        Dim display_visitors As Integer\n        Dim sum_visitors As Integer\n        organic_visitors = Application.SumIf(Range(\"A:A\"), \"organic\", Range(\"F:F\"))\n        paid_visitors = Application.SumIf(Range(\"A:A\"), \"paid\", Range(\"F:F\"))\n        direct_visitors = Application.SumIf(Range(\"A:A\"), \"direct\", Range(\"F:F\"))\n        referral_visitors = Application.SumIf(Range(\"A:A\"), \"referral\", Range(\"F:F\"))\n        display_visitors = Application.SumIf(Range(\"A:A\"), \"display\", Range(\"F:F\"))\n        sum_visitors = organic_visitors + paid_visitors + direct_visitors + referral_visitors + display_visitors\n\n    'calculate unique visitors aka new users\n        Dim organic_new As Integer\n        Dim paid_new As Integer\n        Dim direct_new As Integer\n        Dim referral_new As Integer\n        Dim display_new As Integer\n        Dim sum_new As Integer\n        organic_new = Application.SumIf(Range(\"A:A\"), \"organic\", Range(\"E:E\"))\n        paid_new = Application.SumIf(Range(\"A:A\"), \"paid\", Range(\"E:E\"))\n        direct_new = Application.SumIf(Range(\"A:A\"), \"direct\", Range(\"E:E\"))\n        referral_new = Application.SumIf(Range(\"A:A\"), \"referral\", Range(\"E:E\"))\n        display_new = Application.SumIf(Range(\"A:A\"), \"display\", Range(\"E:E\"))\n        sum_new = organic_new + paid_new + direct_new + referral_new + display_new\n\n    'calculate pages/visit\n        Dim pages_per_visit As String\n        pages_per_visit = (sum_pageviews / sum_visitors) / 100\n    'calculate organic traffic\n        Dim organic_percent As String\n        organic_percent = (organic_visitors / sum_visitors)\n\n    'calculate referral traffic\n        Dim referral_percent As String\n        referral_percent = (referral_visitors / sum_visitors)\n\n    'isolate start date\n        Dim date_location As String\n        Dim start_date_ugly As String\n        Dim start_date_string As String\n\n        date_location = ActiveWorkbook.Sheets(1).Range(\"A4\")\n        start_date_ugly = Left(date_location, 10)\n        start_date_string = Right(start_date_ugly, 8)\n\n    'isolate end date\n        Dim end_date_string As String\n\n        end_date_string = Right(date_location, 8)\n\n    'posts data to columns\n        table_object_row.Range(1, 1).Value = DateSerial(Left(start_date_string, 4), Mid(start_date_string, 5, 2), Right(start_date_string, 2))\n            table_object_row.Range(1, 1).NumberFormat = \"mm/dd/yyyy\"\n        table_object_row.Range(1, 2).Value = DateSerial(Left(end_date_string, 4), Mid(end_date_string, 5, 2), Right(end_date_string, 2))\n            table_object_row.Range(1, 2).NumberFormat = \"mm/dd/yyyy\"\n        table_object_row.Range(1, 3).Value = sum_pageviews\n        table_object_row.Range(1, 4).Value = sum_visitors\n        table_object_row.Range(1, 5).Value = sum_new\n        table_object_row.Range(1, 6).Value = Format((pages_per_visit), Percent)\n        table_object_row.Range(1, 7).Value = organic_percent\n        table_object_row.Range(1, 8).Value = referral_percent\n</code></pre>\n"}, {"tags": ["windows", "excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 7753184, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-r2_r1chXQJI/AAAAAAAAAAI/AAAAAAAAAvE/IwRQ6weIa_Y/photo.jpg?sz=128", "display_name": "Daniel J", "link": "https://stackoverflow.com/users/7753184/daniel-j"}, "edited": false, "score": 0, "creation_date": 1490640181, "post_id": 42960699, "comment_id": 73192647, "body": "@sirentec I wasn&#39;t able to figure out how to use public cell and public string, but I was able to write a working program. The only thing is excel often freezes when I run it. I have edited the program above to contain the new code."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7753184, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-r2_r1chXQJI/AAAAAAAAAAI/AAAAAAAAAvE/IwRQ6weIa_Y/photo.jpg?sz=128", "display_name": "Daniel J", "link": "https://stackoverflow.com/users/7753184/daniel-j"}, "edited": false, "score": 0, "creation_date": 1490213982, "post_id": 42960948, "comment_id": 73017863, "body": "wow, I don&#39;t understand that at all. I will have to go read up on public class and public string. Thanks"}], "tags": [], "owner": {"reputation": 734, "user_id": 796174, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/hrsZu.jpg?s=128&g=1", "display_name": "Sirentec", "link": "https://stackoverflow.com/users/796174/sirentec"}, "is_accepted": false, "score": 0, "last_activity_date": 1490210855, "creation_date": 1490210855, "answer_id": 42960948, "question_id": 42960699, "link": "https://stackoverflow.com/questions/42960699/how-to-check-raw-data-from-one-workbook-against-a-master-list-in-another-workboo/42960948#42960948", "title": "How to check raw data from one workbook against a master list in another workbook", "body": "<p>This is without the Excel parts, but how about something like this...</p>\n\n<pre><code>    public class CellValue\n    {\n        public string theValue { get; set; }\n    }\n\n    List&lt;CellValue&gt; masterList = new List&lt;CellValue&gt;(); //Load these values into the list\n    List&lt;CellValue&gt; otherList = new List&lt;CellValue&gt;();   //Load these values into the list\n\n    List&lt;string&gt; onesToDelete = otherList.Select(x =&gt; !masterList.Any(x2 =&gt; x2.theValue == x.theValue));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7753184, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-r2_r1chXQJI/AAAAAAAAAAI/AAAAAAAAAvE/IwRQ6weIa_Y/photo.jpg?sz=128", "display_name": "Daniel J", "link": "https://stackoverflow.com/users/7753184/daniel-j"}, "edited": false, "score": 0, "creation_date": 1490710414, "post_id": 43056193, "comment_id": 73227363, "body": "That was perfect. I really appreciate it."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1490711815, "last_edit_date": 1490711815, "creation_date": 1490647554, "answer_id": 43056193, "question_id": 42960699, "link": "https://stackoverflow.com/questions/42960699/how-to-check-raw-data-from-one-workbook-against-a-master-list-in-another-workboo/43056193#43056193", "title": "How to check raw data from one workbook against a master list in another workbook", "body": "<p>In VBA, you can try this:</p>\n\n<pre><code>Sub Firstcheck()\n    Dim cel As Range, masterList\n    With Workbooks.Open(\"T:\\Communications and Media\\Media\\Media    Reporting\\media master list.xlsx\")\n        With .Worksheets(1)\n            masterList = .Range(.Range(\"A1\"), .Range(\"A1\").End(xlDown)).value2\n        End With\n        .Close False\n    End With\n\n    For Each cel In ThisWorkbook.Worksheets(1).UsedRange.Columns(2).Cells\n        If IsError(Application.match(Trim(cel.value2)), masterList) Then\n            cel.Interior.ColorIndex = 4\n        Else\n            cel.Interior.ColorIndex = 5\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7753184, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-r2_r1chXQJI/AAAAAAAAAAI/AAAAAAAAAvE/IwRQ6weIa_Y/photo.jpg?sz=128", "display_name": "Daniel J", "link": "https://stackoverflow.com/users/7753184/daniel-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1490711815, "creation_date": 1490209979, "last_edit_date": 1531161705, "question_id": 42960699, "link": "https://stackoverflow.com/questions/42960699/how-to-check-raw-data-from-one-workbook-against-a-master-list-in-another-workboo", "title": "How to check raw data from one workbook against a master list in another workbook", "body": "<p>I am new to VBA-Excel and need some help. I have one workbook that contains a master list of acceptable string values. This workbook is updated regularly. I have another workbook that contains all raw data. I want to have my macro open the master list, check each entry from the second column in my raw data against the master list and delete any cells that are not contained in my master list. I need some pointers to set me on my way. Here is what I have so far:</p>\n\n<p>Sub Firstcheck()</p>\n\n<pre><code>Dim wkb As Object\nDim wkbname As Object\nDim masterlist As Range\nDim cell As Range\n\nSet wkbname = ActiveWorkbook\nSet wkb = Workbooks.Open(Filename:=\"T:\\Communications and Media\\Media\\Media    Reporting\\media master list.xlsx\")\nwkb.Activate\nSet masterlist = Range(\"a1\", Range(\"a1\").End(xlDown))\n\nwkbname.Activate\nRange(\"a1\").Select\nFor i = 1 To 3\nIf Len(ActiveCell.Offset(1, 0).Value) &gt; 1 Then\nActiveCell.Offset(1, 0).Select\n    For Each cell In masterlist.Cells\n        If cell = ActiveCell.Offset(0, 1).Value Then\n        ActiveCell.Interior.ColorIndex = 5\n        Exit For\n\n\n        Else: ActiveCell.Interior.ColorIndex = 4\n\n        End If\n\n        Next cell\n\n\nElse: i = 10\nEnd If\ni = i - 1\nNext\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance for any help you can give.</p>\n"}, {"tags": ["vba", "excel", "type-mismatch"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1490219886, "post_id": 42960588, "comment_id": 73020902, "body": "Before anything else, you need to rethink your use of <code>num_usr_att</code>. If <code>usr_attr.Count = 0</code> you will get error trying to ReDim with a negative number. Also try in Immediate window: <code>?Application.Match(&quot;UA::Test Location&quot;, user_label_array, False)</code> see if it gives <code>0</code>, if so, none is found and so you are trying to access an array with negative index - fails for sure."}, {"owner": {"reputation": 103, "user_id": 5938178, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/KA6Is.png?s=128&g=1", "display_name": "charwayne", "link": "https://stackoverflow.com/users/5938178/charwayne"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1490276817, "post_id": 42960588, "comment_id": 73047688, "body": "Thanks PatricK for pointing out the Immediate Window, didn&#39;t know that feature existed! Due to this I found my answer, I needed to use a wildcard in the string literal &quot;UA::Test Location*&quot; to get the correct result. Thanks for the help."}], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 5938178, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/KA6Is.png?s=128&g=1", "display_name": "charwayne", "link": "https://stackoverflow.com/users/5938178/charwayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1490277170, "creation_date": 1490277170, "answer_id": 42978071, "question_id": 42960588, "link": "https://stackoverflow.com/questions/42960588/type-mismatch-when-getting-header-info-using-vba/42978071#42978071", "title": "Type mismatch when getting header info using VBA", "body": "<p>The following code runs when the string in the faulty line of code uses a wildcard:</p>\n\n<pre><code>wb.ActiveSheet.Range(\"C8\") = user_data_array(Application.Match(\"UA::Test Location*\", user_label_array, False) - 1)\n</code></pre>\n\n<p>I believe that at some point the header file had been appended with a non-printing character, hence why a direct match would not work. Thanks to PatricK for his advice.</p>\n"}], "owner": {"reputation": 103, "user_id": 5938178, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/KA6Is.png?s=128&g=1", "display_name": "charwayne", "link": "https://stackoverflow.com/users/5938178/charwayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 42978071, "answer_count": 1, "score": 0, "last_activity_date": 1490283349, "creation_date": 1490209569, "last_edit_date": 1531164843, "question_id": 42960588, "link": "https://stackoverflow.com/questions/42960588/type-mismatch-when-getting-header-info-using-vba", "title": "Type mismatch when getting header info using VBA", "body": "<p>I am using the following to code to pull test header information from an LMS Waterfall:</p>\n\n<pre><code>Dim usr_attr As LMSTestLabAutomation.AttributeMap\nDim num_usr_att As Integer\nDim user_data_array() As String\nDim user_label_array() As String\n\nSet usr_attr = my_db.GetProperties(\"\")\nnum_usr_att = usr_attr.Count\nReDim user_label_array(num_usr_att - 1)\nReDim user_data_array(num_usr_att - 1)\n\nI = 0\nFor I = 0 To num_usr_att - 1\n   user_label_array(I) = usr_attr.KeyNames.Item(I)\n   user_data_array(I) = usr_attr.Item(I)\nNext I\n\n'Enter the data into the report\nwb.Sheets(\"Multi-cut Report\").Select ' Switch to the Report Page\nSet mcwb = wb.ActiveSheet\n\nwb.ActiveSheet.Range(\"C5\") = user_data_array(Application.Match(\"UA::Test request number:\", user_label_array, False) - 1)\nwb.ActiveSheet.Range(\"C6\") = user_data_array(Application.Match(\"UA::Test Start Date\", user_label_array, False) - 1)\nwb.ActiveSheet.Range(\"C7\") = user_data_array(Application.Match(\"UA::Test By\", user_label_array, False) - 1)\nwb.ActiveSheet.Range(\"C8\") = user_data_array(Application.Match(\"UA::Test Location\", user_label_array, False) - 1)  '&lt;&lt;&lt;&lt; function fails here &lt;&lt;&lt;&lt;\n</code></pre>\n\n<p>The last line of code gives me a type mismatch. However, prior to making my changes to the code (which did not include this block of code), I would not get a type mismatch and it would return the value in the header. When this bit of code is commented out, the script runs exactly as expected otherwise.</p>\n"}, {"tags": ["vba", "excel", "double-quotes"], "comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490211461, "post_id": 42960548, "comment_id": 73016485, "body": "My best guess is that the count of quotes within a string can&#39;t be even. This is likely due to a pair of quotes being seen as a string, and in the case of four quotes it would be seen as two sets of &quot;&quot; which would just result in two null strings. It likely tries to overcome this by making sure there is only an odd count of strings. Honestly, I cant say for sure if this is exactly what is happening, but the logic would make the most sense. Also, why not just avoid the headache? Use Chr(34) so you get exactly what you want (especially since you note that you know this.)"}], "answers": [{"comments": [{"owner": {"reputation": 567, "user_id": 4257449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b333ca3a0726ce4eb76f7f12845041e0?s=128&d=identicon&r=PG&f=1", "display_name": "coolDude", "link": "https://stackoverflow.com/users/4257449/cooldude"}, "edited": false, "score": 0, "creation_date": 1490219949, "post_id": 42961198, "comment_id": 73020935, "body": "I would like to confirm my understanding of this. For the 4 DQ case, the 2nd DQ is the actual escape character. Is this synonymous to \\ in Java (which is what I&#39;m more familiar with)? So <code>\\n</code> indicates a new line and \\ is the actual escape character. And any characters following the \\ will be interpreted differently. Is that correct? Or am I misunderstanding something?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 567, "user_id": 4257449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b333ca3a0726ce4eb76f7f12845041e0?s=128&d=identicon&r=PG&f=1", "display_name": "coolDude", "link": "https://stackoverflow.com/users/4257449/cooldude"}, "edited": false, "score": 0, "creation_date": 1490220592, "post_id": 42961198, "comment_id": 73021182, "body": "@coolDude correct, the escaped characters in <i>C-derived</i> languages is the <code>\\ </code>. In those languages, sequential DQs usually announce <i>concatenation</i>; i.e. <code>&quot;a &quot;&quot; b&quot;</code> &lt;==&gt; &quot;a  b&quot;. On the other hand, <code>\\ </code> has no special meaning in VB languages. You escape a DQ with a DQ. For a similarly, think of how you escape the <code>\\ </code> in Java with another <code>\\ </code>. An even number of <code>\\ </code>, say 2n, is n escaped backslashes."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 567, "user_id": 4257449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b333ca3a0726ce4eb76f7f12845041e0?s=128&d=identicon&r=PG&f=1", "display_name": "coolDude", "link": "https://stackoverflow.com/users/4257449/cooldude"}, "edited": false, "score": 0, "creation_date": 1490221923, "post_id": 42961198, "comment_id": 73021761, "body": "And by the way, there is no general <i>escape</i> in VB. Only double-quotes can be escaped, with another double-quote. To insert a new line in a string you have to <i>compose it</i> like <code>&quot;line 1&quot;  &amp; vbCrLf &amp; &quot;line 2&quot;</code>."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 5, "last_activity_date": 1490213198, "last_edit_date": 1490213198, "creation_date": 1490211631, "answer_id": 42961198, "question_id": 42960548, "link": "https://stackoverflow.com/questions/42960548/placing-double-quotes-within-a-string-in-vba/42961198#42961198", "title": "Placing Double Quotes Within a String in VBA", "body": "<p>The general rule is as follows.</p>\n\n<p>The first double-quote (DQ) announces the beginning of a string. Afterwards, some DQ announces the end of the string. However, if a DQ is preceded by a DQ, it is \"escaped\". Escaped means it is a character part of the string, not a delimiter.</p>\n\n<p>Simply put, when you have any <em>even number</em> of consecutive double-quotes inside a string, say <code>2n</code>, this means there are n escaped double-quotes. When the number is <em>odd</em>, say <code>2n+1</code>, you have n escaped DQs and a <em>delimiter</em>.</p>\n\n<p>Examples</p>\n\n<pre><code>  \"\"\" + iterator.Value + \"\"\"\n' delimiter \" + iterator.Value + \" delimiter\n'           ^ escaped            ^ escaped\n\n  \"\"\" + iterator.Value + \"\"\"\"\n' delimiter \" + iterator.Value + \"\"  ' (missing enclosing delimiter) \n'           ^ escaped            ^^ both escaped.\n</code></pre>\n\n<p>In this latter case the last delimiter is missing, For this reason VS inserted it for you, and you got 5 DQs.</p>\n\n<p>Finally the particular case <code>\"\"\"\"</code> (just 4 DQs), the first and last are delimiters, and inside there's one escaped DQ. This is equivalent to <code>chr(34)</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1490213329, "creation_date": 1490213329, "answer_id": 42961690, "question_id": 42960548, "link": "https://stackoverflow.com/questions/42960548/placing-double-quotes-within-a-string-in-vba/42961690#42961690", "title": "Placing Double Quotes Within a String in VBA", "body": "<p>To append iterator value to TGName in quotes, you can do this:</p>\n\n<pre><code>Data = TGName &amp; \"\"\"\" &amp; iterator.Value &amp; \"\"\"\"\n</code></pre>\n\n<p>or this:</p>\n\n<pre><code>Data = TGName &amp; Chr(34) &amp; iterator.Value &amp; Chr(34)\n</code></pre>\n\n<p>Note: I replaced + signs with &amp; because that's simply a VBA best practice when concatenating strings.</p>\n"}], "owner": {"reputation": 567, "user_id": 4257449, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b333ca3a0726ce4eb76f7f12845041e0?s=128&d=identicon&r=PG&f=1", "display_name": "coolDude", "link": "https://stackoverflow.com/users/4257449/cooldude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15295, "favorite_count": 0, "accepted_answer_id": 42961198, "answer_count": 2, "score": 3, "last_activity_date": 1490213329, "creation_date": 1490209425, "last_edit_date": 1531164843, "question_id": 42960548, "link": "https://stackoverflow.com/questions/42960548/placing-double-quotes-within-a-string-in-vba", "title": "Placing Double Quotes Within a String in VBA", "body": "<p>I'm having a hard time understanding how to place a double quote (\") within a String in VBA. I know that I can easily do this using the <code>char(34)</code> function. I also understand that another way of doing this is to use 4 double quotes: <code>\"\"\"\"</code>. All of this comes from a previous SO post:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9024724/how-do-i-put-double-quotes-in-a-string-in-vba\">How do I put double quotes in a string in vba?</a></p>\n\n<p>However, my question is.... Why are 4 quotes needed? Do the first two act as the escape, the third is the quote itself, and the fourth is the terminating quote? Or does it work in a different way? I haven't been able to find a concrete answer as to how VBA treats these double quotes. </p>\n\n<p>I've also noticed that if I try adding or removing the number of double quotes within a String, Visual Studio will dynamically add or remove double quotes. For example, I initially had the following String:</p>\n\n<pre><code>data = TGName + \"\"\" + iterator.Value + \"\"\"\n</code></pre>\n\n<p>...which produces the following within a message box:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RrkrS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RrkrS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>However, if I try adjusting the second set of double quotes at the end of the String (<code>+ \"\"\"</code>) from 3 to 4, Visual Studio automatically adjusts this to 5. There's no way for me to only have 4 quotes at the end. This is the resulting String within a message box:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XG00W.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XG00W.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The Strings within the message boxes aren't the actual output that I'm hoping to have, they're purely for experimental purposes. However, what I've noticed is that there clearly is a requirement for the number of quotes that are allowed within a String in VBA. Does anyone know what that requirement is? Why is the IDE forcefully inserting an additional quote in the second String? Can someone explain the differences between the actual String contents and the formatting quotes within both cases that I've described?</p>\n\n<p>As always, any assistance on this would be greatly appreciated :) </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490211794, "post_id": 42960484, "comment_id": 73016670, "body": "You want to wrap a cell? How do you know which cells to wrap? What&#39;s the max. number of characters you want per line? Do you want a wrap or could we insert a manual line break where you&#39;d want the wrap?"}, {"owner": {"reputation": 125, "user_id": 6045419, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156615292335503/picture?type=large", "display_name": "Matthew Perryman", "link": "https://stackoverflow.com/users/6045419/matthew-perryman"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490214719, "post_id": 42960484, "comment_id": 73018267, "body": "Hi Bruce, all very good points. I was wondering if there was a VBA way (like the auto sizing column code) that would auto wrap any cell that has more than say 150 characters in it."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 6045419, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156615292335503/picture?type=large", "display_name": "Matthew Perryman", "link": "https://stackoverflow.com/users/6045419/matthew-perryman"}, "edited": false, "score": 0, "creation_date": 1490220842, "post_id": 42962778, "comment_id": 73021277, "body": "Hmm I realised that 150 may have been to much so I copy/pasted the First VBA code and changed &gt;150 to &gt;30 and then closed the VBA Editor. It does not seemed o have done anything.  When I double click on a Cell it opens VBA and a pop up stating &#39;Compile Error: Invalid Next Control Variable Reference&#39;"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1490217293, "creation_date": 1490217293, "answer_id": 42962778, "question_id": 42960484, "link": "https://stackoverflow.com/questions/42960484/auto-sizing-and-auto-wrappin-in-excel/42962778#42962778", "title": "Auto Sizing and Auto Wrappin in Excel", "body": "<p>Is this what you were looking for?</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\nApplication.ScreenUpdating = False\nDim Val As Range\nFor Each Val In Target.Columns\n    Worksheets(Sh.Name).Columns(Val.Column).AutoFit\n    If Len(Val) &gt; 150 Then\n        Val.WrapText = True\n    End If\nNext Value\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Note: I suggest not using <code>Value</code> as a variable, since it's a \"reserved word\" in VBA.  I also assume <code>Value</code> is a cell, so I defined it as a Range.  It will check if <code>Value</code> is over 150 characters, and if so, wrap text.</p>\n\n<p>If that doesn't work, here's a general way to check if a cell has over 150 characters, and if so, wrap text:</p>\n\n<pre><code>Sub autoFitCell()\nDim cel As Range\nSet cel = Range(\"A1\")\nIf Len(cel) &gt; 150 Then\n    cel.WrapText = True\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 6045419, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156615292335503/picture?type=large", "display_name": "Matthew Perryman", "link": "https://stackoverflow.com/users/6045419/matthew-perryman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490217293, "creation_date": 1490209236, "question_id": 42960484, "link": "https://stackoverflow.com/questions/42960484/auto-sizing-and-auto-wrappin-in-excel", "title": "Auto Sizing and Auto Wrappin in Excel", "body": "<p>So I am looking for some way to auto wrap text in my excel document, posisbly based on number of characters per line.</p>\n\n<p>I would also like for my cells to continue auto sizing, I have used the following VBA code for it:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\nApplication.ScreenUpdating = False\nFor Each Value In Target.Columns\n    Worksheets(Sh.Name).Columns(Value.Column).AutoFit\nNext Value\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["database", "ms-access", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "edited": false, "score": 0, "creation_date": 1490212579, "post_id": 42960341, "comment_id": 73017147, "body": "Yeah I tried that as well, it&#39;s giving me the compile error at the cmdAdd_Click itself which is what is confusing me. Almost like it can&#39;t find the cmd or something I don&#39;t know."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490212825, "post_id": 42960341, "comment_id": 73017287, "body": "<b>If Me.txtICN.Tag &amp; &quot;&quot; = &quot;&quot; Then</b> looks funny.   Why are you checking for a value in the tag.  If somehow your are editing the caption to Add or Update, use that caption value to switch between your insert and update functions."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490212924, "post_id": 42960341, "comment_id": 73017343, "body": "(Sorry for deleting my original answer as it looked to be more than just one instance of the &quot;tag&quot; and it was rather ambiguous).   Also, watch out for the Insert if your table has autonumber because the insert looks like it&#39;s forcing a value in there."}, {"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "reply_to_user": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490213132, "post_id": 42960341, "comment_id": 73017463, "body": "My table does have auto number, but I tried it with and without auto number and ran into the same issue."}, {"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "reply_to_user": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490213161, "post_id": 42960341, "comment_id": 73017480, "body": "geeFlo could you explain what you&#39;re saying to me a bit more? How should I change that statement?"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490213700, "post_id": 42960341, "comment_id": 73017744, "body": "I&#39;m not sure what that tag is looking for, and why it&#39;s the basis of your IF statement.   Perhaps you use the button you&#39;re clicking and do something like &quot;IF me!cmdAdd.caption = &#39;Add&#39; THEN&quot;  (That is assuming your button&#39;s caption are somehow changing between &quot;Add&quot; and &quot;Update&quot; depending on the user&#39;s clicking of the EDIT button)"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490213868, "post_id": 42960341, "comment_id": 73017807, "body": "TAG itself is a hidden property in the field, so maybe you can explain why/how that&#39;s being used."}, {"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "reply_to_user": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490213989, "post_id": 42960341, "comment_id": 73017868, "body": "Yeah that is exactly what is happening, but that change did not fix it either, it&#39;s still giving me the error at cmdAdd_Click which is really odd to me."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490214502, "post_id": 42960341, "comment_id": 73018152, "body": "Yeah, you have to check out that funny IF statement.   It doesn&#39;t mean anything.  What is the &#39;&amp;&#39; for and why&#39;s the = sign in quotes.  Either get rid of that junk and place a condition on a proper value that determines if the user wants an add or an update."}, {"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "reply_to_user": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1490214954, "post_id": 42960341, "comment_id": 73018400, "body": "Do you have an easy suggestion on how I could do that? I&#39;m very new to this and I had the IF statement in there like that on the recommendation from a work friend, but obviously it isn&#39;t working."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "edited": false, "score": 0, "creation_date": 1490277867, "post_id": 42962202, "comment_id": 73048563, "body": "Yeah that didn&#39;t do it either, I&#39;m really stumped and frustrated on this one. Everytime I click add I get the error and it highlights Private Sub cmdAdd_Click() like it can&#39;t even find the method."}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "reply_to_user": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "edited": false, "score": 0, "creation_date": 1490278124, "post_id": 42962202, "comment_id": 73048768, "body": "Try testing if the tag is null too.    &gt; If nz(me.txtICN.Tag,&quot;&quot;) = &quot;&quot; then &lt;    Can&#39;t figure out how to hilite the code part, so just use the stuff between the arrows."}], "tags": [], "owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "is_accepted": false, "score": 0, "last_activity_date": 1490215041, "creation_date": 1490215041, "answer_id": 42962202, "question_id": 42960341, "link": "https://stackoverflow.com/questions/42960341/compile-error-when-trying-to-use-an-add-button-in-access/42962202#42962202", "title": "Compile error when trying to use an Add button in Access", "body": "<p>Okay, I see it now.   Your using the TAG property as an indicator if the record was edited or not.  i.e.  If it's a new record, then TAG = \"\", and if it's an existing record you replicate the ICN into the TAG.</p>\n\n<p>If that's the case then change that IF statement to this:</p>\n\n<pre><code>If Me.txtICN.Tag = \"\" Then\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7747333, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bbab9807ddcfa61c1a40e8dd90ffd43a?s=128&d=identicon&r=PG&f=1", "display_name": "Logan Derrick", "link": "https://stackoverflow.com/users/7747333/logan-derrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490215041, "creation_date": 1490208788, "question_id": 42960341, "link": "https://stackoverflow.com/questions/42960341/compile-error-when-trying-to-use-an-add-button-in-access", "title": "Compile error when trying to use an Add button in Access", "body": "<p>I posted about this yesterday and have since made changes and attempted a few things to try and fix it and am still having trouble.</p>\n\n<p>I'm working on a database for work and am getting a compile error when trying to add a record to a form.</p>\n\n<p>It's essentially an inventory system, I have a table with the inventory of our warehouse and I'm trying to create a form that has a text box for every piece of information on a piece of equipment. So you go to the form, fill out each text box with the information and then there are 5 boxes to the side of the text boxes that you click to do different things. Below this there is a subform of the main inventory table.</p>\n\n<p>There is an Add, Edit, Delete, Clear, and Close button. The Add button adds a record to this subform and consequently the main table with whatever information you type into the text boxes. To use the Edit box you click on a record in the subform and then click the Edit button and it will fill the text boxes with the information from the selected record, so that you can edit the information. At the same time, once you click Edit, it changes the label on the Add button to Update, so that once you have edited the data, you click Update and it will update the data in the subform and the main table. The other 3 buttons do what they're supposed to, you click a record and click delete to delete a record, click close to exit the form and click clear to clear any information that is filled in the text boxes.</p>\n\n<p>The problem I'm having is that the Add/Update button isn't working - when I click it I get this error: Compile error: Method or data member not found. Every other button works perfectly fine and I have written and re written this code over twice now and can't figure out what's going on.</p>\n\n<p>The weirdest part is that I basically copied this code over from another database that I coded that works exactly as intended and is super similar to this one. The only thing I even had to change when switching to this database was the names of the labels and table headers.</p>\n\n<p>Can anyone help me out here?</p>\n\n<p>Code:</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub cmdAdd_Click()\n    'when we click on Add button there are two options\n    '1. for inserting new data\n    '2. for updating selected data\n    If Me.txtICN.Tag &amp; \"\" = \"\" Then\n        'add data to table after clicking the add button\n        CurrentDb.Execute \"INSERT INTO tblInventory(ICN, manu, modelNum, serialNum, descr, dateRec, projectNum, dispo, flgDispo, dateRemoved, comments, ulNum, amcaNum)\" &amp; _\n            \"VALUES (\" &amp; Me.txtICN &amp; \", '\" &amp; Me.txtManu &amp; \"', '\" &amp; Me.txtModel &amp; \"', '\" &amp; Me.txtSerial &amp; \"', '\" &amp; Me.txtDesc &amp; \"', '\" &amp; Me.txtDateRec &amp; \"', '\" &amp; Me.txtProjectNum &amp; \"','\" &amp; _\n            Me.txtDispo &amp; \"', '\" &amp; Me.chkDispo &amp; \"', '\" &amp; Me.txtDateRemoved &amp; \"', '\" &amp; Me.txtComments &amp; \"', '\" &amp; Me.txtULNum &amp; \"', '\" &amp; Me.txtAMCANum &amp; \"')\"\n\n    Else\n        'otherwise\n        CurrentDb.Execute \"UPDATE tblInventory \" &amp; _\n            \" SET ICN =\" &amp; Me.txtICN &amp; _\n            \", manu ='\" &amp; Me.txtManu &amp; \"'\" &amp; _\n            \", modelNum ='\" &amp; Me.txtModel &amp; \"'\" &amp; _\n            \", serialNum ='\" &amp; Me.txtSerial &amp; \"'\" &amp; _\n            \", descr ='\" &amp; Me.txtDescr &amp; \"'\" &amp; _\n            \", dateRec ='\" &amp; Me.txtDateRec &amp; \"'\" &amp; _\n            \", projectNum ='\" &amp; Me.txtProjectNum &amp; \"'\" &amp; _\n            \", dispo ='\" &amp; Me.txtDispo &amp; \"'\" &amp; _\n            \", flgDispo ='\" &amp; Me.chkDispo &amp; \"'\" &amp; _\n            \", dateRemoved ='\" &amp; Me.txtDateRemoved &amp; \"'\" &amp; _\n            \", comments ='\" &amp; Me.txtComments &amp; \"'\" &amp; _\n            \", ulNum ='\" &amp; Me.txtULNum &amp; \"'\" &amp; _\n            \", amcaNum ='\" &amp; Me.txtAMCANum &amp; \"'\" &amp; _\n            \" WHERE ICN =\" &amp; Me.txtICN.Tag\n    End If\n\n    'clear form after data has been added to the table\n    cmdClear_Click\n    'refresh data in list on form after form has been cleared\n    frmInventorySub.Form.Requery\n\nEnd Sub\n\nPrivate Sub cmdClear_Click()\n\n    Me.txtICN = \"\"\n    Me.txtManu = \"\"\n    Me.txtModel = \"\"\n    Me.txtSerial = \"\"\n    Me.txtDesc = \"\"\n    Me.txtDateRec = \"\"\n    Me.txtProjectNum = \"\"\n    Me.txtDispo = \"\"\n    Me.chkDispo = \"\"\n    Me.txtDateRemoved = \"\"\n    Me.txtComments = \"\"\n    Me.txtULNum = \"\"\n    Me.txtAMCANum = \"\"\n\n    'set focus to ICN number\n    Me.txtICN.SetFocus\n    'set edit button to enabled after data has been cleared from form\n    Me.cmdEdit.Enabled = True\n    'change caption of button add to Add from Edit\n    Me.cmdAdd.Caption = \"Add\"\n    'clear tag on txtICN\n    Me.txtICN.Tag = \"\"\nEnd Sub\n\nPrivate Sub cmdClose_Click()\n    DoCmd.Close\nEnd Sub\n\nPrivate Sub cmdDelete_Click()\n    'delete record\n    'check existingselected record\n    If Not (Me.frmInventorySub.Form.Recordset.EOF And Me.frmInventorySub.Form.Recordset.BOF) Then\n        'confirm delete\n        If MsgBox(\"Are you sure you want to delete this record?)\", vbYesNo) = vbYes Then\n            'delete now\n            CurrentDb.Execute \"DELETE FROM tblInventory \" &amp; _\n                \"WHERE ICN=\" &amp; Me.frmInventorySub.Form.Recordset.Fields(\"ICN\")\n            'refresh data in list\n            Me.frmInventorySub.Form.Requery\n        End If\n    End If\n\nEnd Sub\n\nPrivate Sub cmdEdit_Click()\n    'check to see if data is already in the form\n    If Not (Me.frmInventorySub.Form.Recordset.EOF And Me.frmInventorySub.Form.Recordset.BOF) Then\n        'pull data from selected record into the text boxes\n        With Me.frmInventorySub.Form.Recordset\n            Me.txtICN = .Fields(\"ICN\")\n            Me.txtManu = .Fields(\"manu\")\n            Me.txtModel = .Fields(\"modelNum\")\n            Me.txtSerial = .Fields(\"serialNum\")\n            Me.txtDesc = .Fields(\"descr\")\n            Me.txtDateRec = .Fields(\"dateRec\")\n            Me.txtProjectNum = .Fields(\"projectNum\")\n            Me.txtDispo = .Fields(\"dispo\")\n            Me.chkDispo = .Fields(\"flgDispo\")\n            Me.txtDateRemoved = .Fields(\"dateRemoved\")\n            Me.txtComments = .Fields(\"comments\")\n            Me.txtULNum = .Fields(\"ulNum\")\n            Me.txtAMCANum = .Fields(\"amcaNum\")\n            'store ICN in tag of txtICN in case ICN is modified\n            Me.txtICN.Tag = .Fields(\"ICN\")\n            'change caption of add button to Update\n            Me.cmdAdd.Caption = \"Update\"\n            'disable edit button\n            Me.cmdEdit.Enabled = False\n\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "code128"], "comments": [{"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490209076, "post_id": 42960236, "comment_id": 73015116, "body": "I created the function under the personal workbook and it appears as shown in the image"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490209127, "post_id": 42960236, "comment_id": 73015161, "body": "I don&#39;t think you can refer to the Personal workbook in that manner.... The compiler is interpreting <code>PERSONAL.XLSB</code> as an <code>object.method</code> call and that&#39;s incorrect. hold on a second..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490209488, "post_id": 42960236, "comment_id": 73015359, "body": "it&#39;s not that you can&#39;t <i>use</i> these functions, you just can&#39;t use them <i>the way you&#39;re trying to use them</i>. As for where they <i>should</i> go, they <i>cannot</i> go in a .CSV file, and whether you put them in Book1 or Personal.xlsb depends on where you need to use them. If they are local helper functions only, then put them in Book1. If they are general functions you might use on many different files, put them in Personal."}, {"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490209690, "post_id": 42960236, "comment_id": 73015476, "body": "What could be the  solution to this."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490210394, "post_id": 42960725, "comment_id": 73015873, "body": "Now I get the error in the in the Line <code>Target.Font = &quot;Code 128&quot;</code>. I need to convert the Font Style of the values in Column A. It again says Object doesn&#39;t support this property or method. I have already installed the font  Code 128 and see them in the excel font drop down list"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490211288, "post_id": 42960725, "comment_id": 73016376, "body": "@user4912134 Try <code>Target.Font.Name = &quot;Code128&quot;</code>."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1490210056, "last_edit_date": 1495535397, "creation_date": 1490210056, "answer_id": 42960725, "question_id": 42960236, "link": "https://stackoverflow.com/questions/42960236/run-time-error-424-in-excel-macros/42960725#42960725", "title": "Run time error 424 in excel macros", "body": "<p>You should be able to use <code>Application.Run</code> to evaluate a function that exists in another workbook.  The format of that is:</p>\n\n<pre><code>Target.Value = Application.Run(\"PERSONAL.XLSB!Module2.Code128\", Target.Value)\n</code></pre>\n\n<p>Or more generally:</p>\n\n<pre><code>= Application.Run(workbookname$ &amp; \"!\" &amp; modulename &amp; \".\" &amp; functionname, args())\n</code></pre>\n\n<p>Barring that, you could <a href=\"https://stackoverflow.com/questions/28741828/call-an-excel-macro-from-a-different-workbook?noredirect=1&amp;lq=1\">Add a reference to Personal.xlb</a> in your Book1.</p>\n"}], "owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 0, "accepted_answer_id": 42960725, "answer_count": 1, "score": 0, "last_activity_date": 1490210056, "creation_date": 1490208430, "last_edit_date": 1490209214, "question_id": 42960236, "link": "https://stackoverflow.com/questions/42960236/run-time-error-424-in-excel-macros", "title": "Run time error 424 in excel macros", "body": "<p>I am new to excel macros, I am working on creating a macro which needs to format the cells and also to generate the bar code for column A. Created a function Code128() to convert the string in to bar code as given in the <a href=\"https://code.adonline.id.au/easily-generate-code-128-barcodes-in-excel/\" rel=\"nofollow noreferrer\">blog</a> and it works fine.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Vn40e.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vn40e.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I am using them in the macros I am creating like below</p>\n\n<pre><code> With ActiveSheet.PageSetup\n .PrintTitleRows = \"$1:$1\"\n .PrintGridlines = True\n\n .Orientation = xlLandscape\n .PaperSize = xlPaperA4\n\n .Zoom = False\n .FitToPagesWide = 1\n .FitToPagesTall = False\n\nEnd With\n\nColumns(\"A\").ColumnWidth = 10\n\nFor Each Target In Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\nIf Target.Value &lt;&gt; vbNullString Then\n    Target.Value = PERSONAL.XLSB!Code128(Target.Value)\n    Target.Resize(, 12).WrapText = True\n    Target.Font = \"Code 128\"\nEnd If\nNext\n\nNext\n</code></pre>\n\n<p>But when I run the macro on the excel I am getting the run time error like </p>\n\n<p><a href=\"https://i.stack.imgur.com/Pvywr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pvywr.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/O7xM4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O7xM4.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490208825, "post_id": 42960148, "comment_id": 73014988, "body": "This is a very broad question and you will not get specific code. You want to export a single record that is displayed on form? Pulling values from form as opposed to exporting a table or query or report will require complicated code. Best approach is to develop a query or simple report that presents the desired data and then export. Here is a good site to start with <a href=\"http://www.accessmvp.com/KDSnell/EXCEL_MainPage.htm\" rel=\"nofollow noreferrer\">accessmvp.com/KDSnell/EXCEL_MainPage.htm</a>"}, {"owner": {"reputation": 21, "user_id": 7401470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920914945e49602c429b2370f3f28ef2?s=128&d=identicon&r=PG&f=1", "display_name": "Koehler", "link": "https://stackoverflow.com/users/7401470/koehler"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490208999, "post_id": 42960148, "comment_id": 73015078, "body": "agreed it is a broad question, thank you for the starting point as i had no idea where to start. thank you"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7401470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920914945e49602c429b2370f3f28ef2?s=128&d=identicon&r=PG&f=1", "display_name": "Koehler", "link": "https://stackoverflow.com/users/7401470/koehler"}, "edited": false, "score": 0, "creation_date": 1490208850, "post_id": 42960279, "comment_id": 73015004, "body": "so would i take each individual field from the access form and add them to the has field name? There are over 15 cols and 25 rows of individual text boxes."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1490209509, "post_id": 42960279, "comment_id": 73015370, "body": "No. You should do research on use of the TransferSpreadsheet command and it&#39;s arguments. That (True/False) parameter is for import operation to indicate whether or not the range includes worksheet header row. Google is your friend. <a href=\"https://msdn.microsoft.com/en-us/library/office/ff844793.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff844793.aspx</a>"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1490209684, "last_edit_date": 1490209684, "creation_date": 1490208581, "answer_id": 42960279, "question_id": 42960148, "link": "https://stackoverflow.com/questions/42960148/taking-information-from-a-ms-access-form-with-text-boxes-and-send-the-informatio/42960279#42960279", "title": "Taking information from a MS Access form with text boxes and send the information to an excel", "body": "<p>I had the wrong command</p>\n\n<pre><code> Private Sub this()\n     DoCmd.OutputTo acOutputForm, \"form name\", acFormatXLS, \"C:\\Users\\dcoats\\Desktop\\filename.xls\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1490458536, "creation_date": 1490458536, "answer_id": 43018778, "question_id": 42960148, "link": "https://stackoverflow.com/questions/42960148/taking-information-from-a-ms-access-form-with-text-boxes-and-send-the-informatio/43018778#43018778", "title": "Taking information from a MS Access form with text boxes and send the information to an excel", "body": "<p>Basically, it's like this........if you mean an actual form in datasheet view, you can export that form's data to Excel with the DoCmd.OutputTo method.</p>\n\n<pre><code>DoCmd.OutputTo acOutputForm, \"frmResults\", acFormatXLS, _\n    \"C:\\your_path_here\\ExportedResults.xls\"\n</code></pre>\n\n<p>However, if you're opening a query in datasheet view, rather than an actual form, you can export the query's result set.</p>\n\n<pre><code>DoCmd.OutputTo acOutputQuery, \"qryResults\", acFormatXLS, _\n    \"C:\\your_path_here\\ExportedResults.xls\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7401470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/920914945e49602c429b2370f3f28ef2?s=128&d=identicon&r=PG&f=1", "display_name": "Koehler", "link": "https://stackoverflow.com/users/7401470/koehler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490458536, "creation_date": 1490208116, "question_id": 42960148, "link": "https://stackoverflow.com/questions/42960148/taking-information-from-a-ms-access-form-with-text-boxes-and-send-the-informatio", "title": "Taking information from a MS Access form with text boxes and send the information to an excel", "body": "<p>So i have an MS Access form that with predefined fields that are linked to different tables in my MS Access DB. What i want to do is take the information from each textbox in the form and make that into a spread sheet in excel and then save that to a predefined folder. I currently have no code and i am not sure how to execute this. I am trying to keep all the code tied to a button on the form so that you can load the form and then press the button. </p>\n\n<p>not sure what else to include but i am using MS Access 2013 and Excel 2013.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1490372214, "post_id": 42959920, "comment_id": 73098069, "body": "You&#39;re using VBA, not VBScript, so you might want to change the tags to reflect that. As to the problem you&#39;re facing, try adding one or more calls to DoEvents() after changing the text but before moving to slide 2.  It sometimes takes as many as five calls to DoEvents to sort things out, perhaps more."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1491576749, "post_id": 42959920, "comment_id": 73630394, "body": "Even if you use only the UI, it can happen that you change something on the slide but some parts of the window does not get updated. In this case I minimize the window, restore it, and it gets updated. Using VBA you may try Application.Visible = False: Application.Visible = True. (Or UpdateWindow, if you are familiar with WinAPI, and how to use it from VBA.)"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1491577113, "post_id": 42959920, "comment_id": 73630674, "body": "@SteveRindsberg: I don&#39;t think that DoEvents would help in this case. That is rather for situations where a deadlock or starvation would occur between your background calculation and the UI."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1491577431, "post_id": 42959920, "comment_id": 73630916, "body": "Why not try it?  If it works, you have a solution. If not, you&#39;ve lost a few minutes at most."}], "owner": {"reputation": 1832, "user_id": 3321579, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8507b1ffc84187a23597ae23ad773458?s=128&d=identicon&r=PG&f=1", "display_name": "Scorb", "link": "https://stackoverflow.com/users/3321579/scorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1491646259, "creation_date": 1490207271, "last_edit_date": 1491646259, "question_id": 42959920, "link": "https://stackoverflow.com/questions/42959920/powerpoint-vbscript-set-textbox-text-delay", "title": "PowerPoint VBScript set textbox text delay", "body": "<p>I am using VBScript to do some programming in a powerpoint presentation.</p>\n\n<p>When my slide is currently on slide 1, I call some code to populate some text boxes on slide 2 and 3, then I call to transition to slide 2.</p>\n\n<p>But when the transition begins to slide 2, the text is not yet set on slide 2, even though that code executed before the code to transition slides. So you can see the text populating after you transition to slide 2.</p>\n\n<p>Is there a way to rectify this?</p>\n\n<pre><code>        ActivePresentation.Slides(2).Shapes(\"slide2_text\").TextFrame.TextRange.Text = \"text value 1\"\n        ActivePresentation.Slides(3).Shapes(\"slide_3_title\").TextFrame.TextRange.Text = \"text value 2\"\nActivePresentation.SlideShowWindow.View.GotoSlide 2\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1490206901, "post_id": 42959771, "comment_id": 73013910, "body": "What part of your current code isn&#39;t working?"}, {"owner": {"reputation": 3, "user_id": 7753008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/456fdec7aa9704c50bc86abb79433412?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Freitas", "link": "https://stackoverflow.com/users/7753008/pedro-freitas"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490207352, "post_id": 42959771, "comment_id": 73014181, "body": "I don&#39;t know how to make the while() (if it&#39;s needed) to select 100 lines at time and pass to another file, it&#39;s at 0%"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1490207617, "post_id": 42959771, "comment_id": 73014306, "body": "What have you tried so far? Please post any code you have and let us know what you&#39;ve attempted."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1490207882, "post_id": 42959771, "comment_id": 73014460, "body": "You could use a <code>While</code> loop to go through the table until you get to the end (or, if you know there are exactly 2000 lines, a <code>For i = 1 to 2000 Step 100</code> loop), with (possibly) a <code>For j = i To i+99</code> loop within that to process each &quot;block&quot;.  Hopefully that will get you to at least 10%.  If you can&#39;t then get to 100%, post the code you are using and tell us what you are stuck on."}], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 7590602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b4cc17151e86b979a84e64d11dc547?s=128&d=identicon&r=PG&f=1", "display_name": "Kev", "link": "https://stackoverflow.com/users/7590602/kev"}, "is_accepted": false, "score": 0, "last_activity_date": 1490224185, "creation_date": 1490224185, "answer_id": 42964345, "question_id": 42959771, "link": "https://stackoverflow.com/questions/42959771/excel-vba-other-sheets/42964345#42964345", "title": "Excel VBA - other sheets", "body": "<p>Excel has some special cell types, one of which returns the cell showing the maximum extent of data in the worksheet. Research xlCellTypeLastCell in the help file. The returned value does not mean there is data in that particular cell, but that there is no data in rows or columns past that row and column ref.</p>\n\n<p>Eg You can select the last cell in a worksheet with the line below. </p>\n\n<pre><code>ActiveCell.SpecialCells(xlLastCell).Select\n</code></pre>\n\n<p>Then use the row number of that cell to set the bounds for your loop.</p>\n"}], "owner": {"reputation": 3, "user_id": 7753008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/456fdec7aa9704c50bc86abb79433412?s=128&d=identicon&r=PG&f=1", "display_name": "Pedro Freitas", "link": "https://stackoverflow.com/users/7753008/pedro-freitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490224185, "creation_date": 1490206776, "last_edit_date": 1531161705, "question_id": 42959771, "link": "https://stackoverflow.com/questions/42959771/excel-vba-other-sheets", "title": "Excel VBA - other sheets", "body": "<p>I'm trying to make a Excel VBA that gets 100 lines per time in a table and send them to a new excel file separately, but I don't know how. Is there a way?</p>\n\n<p>There are 2000 lines in the table, so I want 20 separate files.   </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490208556, "post_id": 42959765, "comment_id": 73014844, "body": "It&#39;s a very good question, but I&#39;m not sure that there will be a very good answer.  So much will depend on the specific formula that needs to be evaluated that I doubt if anyone will be able to come up with a one-size-fits-all solution.  I fear that the question will get closed as &quot;too broad&quot;.  :("}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490208758, "post_id": 42959765, "comment_id": 73014955, "body": "Looping over the range and filling an array with the resulting values, and then dumping the array to the range (in one fell swoop) is almost certainly going to be loads faster, because there&#39;s no dependencies that will recalculate (on that note, you&#39;ve disabled <code>ScreenUpdating</code> and <code>DisplayAlerts</code> but you didn&#39;t set <code>Calculation = xlCalculationManual</code>, you might try that just remember to revert to <code>Application.Calculation = xlCalculationAutomatic</code> before you exit the sub."}, {"owner": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "edited": false, "score": 1, "creation_date": 1490208830, "post_id": 42959765, "comment_id": 73014991, "body": "Specific to your example, it&#39;s difficult to surmise the proper approach, but I think first would be to pull all of your sources into Arrays, manipulate the arrays in memory, then write the final Array in one step to the target sheet.  I&#39;d also implement an Application.EnableEvents = False. Adding that last but might just boost your performance significantly without doing anything else. Also, with calcs off, you can target just Range(&quot;M2:M&quot; &amp; RecordStop) for a calc before writing values."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490208835, "post_id": 42959765, "comment_id": 73014995, "body": "so if you can disable the interim calculations, then maybe that will provide enough of a performance gain for you. worth a shot. Otherwise, you could try translating that formula to pure VBA which might also help, but you&#39;d have to do the performance testing to really be sure."}, {"owner": {"reputation": 3, "user_id": 7752764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e897bcc22b06b167cad5c3f922e373?s=128&d=identicon&r=PG&f=1", "display_name": "JWazar", "link": "https://stackoverflow.com/users/7752764/jwazar"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490273533, "post_id": 42959765, "comment_id": 73045082, "body": "@YowE3K - Thank you for correcting my original post"}, {"owner": {"reputation": 3, "user_id": 7752764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e897bcc22b06b167cad5c3f922e373?s=128&d=identicon&r=PG&f=1", "display_name": "JWazar", "link": "https://stackoverflow.com/users/7752764/jwazar"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490273667, "post_id": 42959765, "comment_id": 73045208, "body": "@DavidZemens - Yes, this sounds like the alternative. My question would then be how to &quot;and filling an array with the resulting values, and then dumping the array to the range (in one fell swoop)&quot;. There must be a post on this site that provides and example for this. Now that I know the appropriate terms (thanks), I&#39;ll try to search for that method. By chance would you happen to know of such a posting to point me to?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490273831, "post_id": 42959765, "comment_id": 73045327, "body": "yes I&#39;ll see what I can dig up but have you tried the other answer below yet? curious to know if disabling calculation will make a noticeable improvement?"}, {"owner": {"reputation": 3, "user_id": 7752764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e897bcc22b06b167cad5c3f922e373?s=128&d=identicon&r=PG&f=1", "display_name": "JWazar", "link": "https://stackoverflow.com/users/7752764/jwazar"}, "reply_to_user": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "edited": false, "score": 0, "creation_date": 1490273840, "post_id": 42959765, "comment_id": 73045336, "body": "@flaZer - Yes, similar to what David mentioned. The question is how? Thank you for pointing me in the right direction. I am searching now for those key terms."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490277857, "post_id": 42959765, "comment_id": 73048554, "body": "<i>How</i> will be pulling apart your formula in such a manner that you can write it to operate in a loop. I never work with R1C1 reference style, can you ELI5 this part of your formula?  It looks like you&#39;re trying to test whether a value exists in a range of cells. <code>IF(ISERROR(VLOOKUP(CONCATENATE(RC[-2],&quot;&quot;|&quot;&quot;,1),R1C12:R[-1]C[&zwnj;&#8203;-1],1,FALSE)),0,1)</code>  In particular, what is the <code>R1C12:R[-1][C-1]</code> representing? For any given row on the worksheet, what range does this identify? Your Vlookup is returning the first column, so perhaps <code>Match</code> or <code>CountIf</code> would be more efficient?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490279373, "post_id": 42959765, "comment_id": 73049812, "body": "Because <code>If(IsError(Match(RC[-2]&amp;&quot;&quot;|1&quot;&quot;,R1C1:R[-1],False)),0,1)</code> might evaluate the same way, and might be faster, IDK. Or, <code>IF(COUNTIF(R1C1:R[-1],RC[-2]&amp;&quot;&quot;|1&quot;)&gt;0,1,0)</code>. But I&#39;m not 100% sure about those range addresses in R1C1."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7752764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e897bcc22b06b167cad5c3f922e373?s=128&d=identicon&r=PG&f=1", "display_name": "JWazar", "link": "https://stackoverflow.com/users/7752764/jwazar"}, "edited": false, "score": 0, "creation_date": 1490274064, "post_id": 42960505, "comment_id": 73045524, "body": "Awesome, thanks I will incorporate this scheme to the tops of all subroutines going forward. I was surprised that this gut down on run time by 20% (total run time still &gt; 2.5 hrs). Still a far cry from the performance I would like to have but at least now I have this and know for sure its time to learn about &quot;Arrays in memory&quot;."}, {"owner": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "reply_to_user": {"reputation": 3, "user_id": 7752764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e897bcc22b06b167cad5c3f922e373?s=128&d=identicon&r=PG&f=1", "display_name": "JWazar", "link": "https://stackoverflow.com/users/7752764/jwazar"}, "edited": false, "score": 0, "creation_date": 1490285420, "post_id": 42960505, "comment_id": 73054883, "body": "You may get a speed bump using the &quot;with&quot; clause, but not really sure. Regardless, I&#39;ve added it to the solution."}, {"owner": {"reputation": 3, "user_id": 7752764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e897bcc22b06b167cad5c3f922e373?s=128&d=identicon&r=PG&f=1", "display_name": "JWazar", "link": "https://stackoverflow.com/users/7752764/jwazar"}, "edited": false, "score": 0, "creation_date": 1490288592, "post_id": 42960505, "comment_id": 73057080, "body": "A whole new world of possibilities! Thanks guys, I think the combination of the above standard start/end protocol and Arrays is the solution. Now to studying the &quot;how&quot;. Much appreciated!"}], "tags": [], "owner": {"reputation": 975, "user_id": 890266, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/iGHDm.gif?s=128&g=1", "display_name": "Bill Roberts", "link": "https://stackoverflow.com/users/890266/bill-roberts"}, "is_accepted": true, "score": 0, "last_activity_date": 1490285076, "last_edit_date": 1525816189, "creation_date": 1490209296, "answer_id": 42960505, "question_id": 42959765, "link": "https://stackoverflow.com/questions/42959765/excel-vba-correct-efficient-formula-population/42960505#42960505", "title": "Excel VBA correct/efficient formula population", "body": "<p>I might start with this before tinkering a bunch.</p>\n\n<p>If you don't get a performance boost, I'd then consider pulling your source data into Arrays, modify them in code, then write your results in a one line of code write back to your cells.</p>\n\n<p>Here's a great link for working the Array route: <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">VBA Arrays And Worksheet Ranges\n</a></p>\n\n<pre><code>Dim PrevCalc As XlCalculation\nWith Application\n    PrevCalc = .Calculation\n    .Calculation = xlCalculationManual\n    .Cursor = xlWait\n    .Calculate\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\nDim RecordStop As Long\n\nSet MyRange = ActiveSheet.Range(\"A:A\")\nRecordStop = Application.WorksheetFunction.CountA(MyRange)\n\n'Apply Formula\nWith Range(\"M2:M\" &amp; RecordStop)\n    .FormulaR1C1 = \"=IF(RC[-7]=1,IF(ISERROR(VLOOKUP(CONCATENATE(RC[-2],\"\"|\"\",1),R1C12:R[-1]C[-1],1,FA  LSE)),0,1),0)\"\n\n    'Calc only the target\n    .Calculate\n\n    'Drop Formula, keep values\n    .Value = .Value\nEnd With 'Range(\"M2:M\" &amp; RecordStop)\n\nWith Application\n    .Cursor = xlDefault\n    .Calculate\n    .Calculation = PrevCalc\n    '.ScreenUpdating = True 'Not Needed...\n    .EnableEvents = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7752764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86e897bcc22b06b167cad5c3f922e373?s=128&d=identicon&r=PG&f=1", "display_name": "JWazar", "link": "https://stackoverflow.com/users/7752764/jwazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 42960505, "answer_count": 1, "score": 0, "last_activity_date": 1490285076, "creation_date": 1490206759, "last_edit_date": 1531164843, "question_id": 42959765, "link": "https://stackoverflow.com/questions/42959765/excel-vba-correct-efficient-formula-population", "title": "Excel VBA correct/efficient formula population", "body": "<p>Good Afternoon,</p>\n\n<p>I have been developing solutions in VBA for going on 6 years now. A lot of what I have learned along the way has been sourced from SO in that time, so finally I get a chance to say THANK YOU!</p>\n\n<p>Today I have come to the conclusion that I need to post a question that has been bothering me for years. So - one of the things I do most often in VBA for Excel is to populate defined ranges with results from formulas applied to the range in question. Until now I have used the below method to accomplish this:</p>\n\n<pre><code>Sub CalculateField()\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n'''''''''''''''''''''''''''''''''\nDim RecordStop As Long\n\nSet MyRange = ActiveSheet.Range(\"A:A\")\nRecordStop = Application.WorksheetFunction.CountA(MyRange)\n\n'Apply Formula\nRange(\"M2:M\" &amp; RecordStop).FormulaR1C1 = \"=IF(RC[-7]=1,IF(ISERROR(VLOOKUP(CONCATENATE(RC[-2],\"\"|\"\",1),R1C12:R[-1]C[-1],1,FA  LSE)),0,1),0)\"\n\n'Drop Formula, keep values\nRange(\"M2:M\" &amp; RecordStop).Value = Range(\"M2:M\" &amp; RecordStop).Value\n\n''''''''''''''''''''''''''''''''''\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>What I have found is that, although this method works, with larger files/more complex formula the hit I take in performance is HUGE! Now, I know that there must be a more efficient way to derive the results of the formula and inject them directly into the sheet where one wants the results to come back to as values. In the above method I first calculate the results then overwrite the \"Formulas\" with the \"values\"(results). I am currently working on a file that will need 21 calculated fields and average between 100k - 400k records.</p>\n\n<p>I fear the time has come for me to learn a better way, the proper more professional way to do this. I have searched here and via the mighty google for examples on how to do this. I have found posts on SO describing what I think is part of the solution, but have had difficulty finding a specific simple example I can follow to implement. I think the correct method involves one or all of the following:</p>\n\n<ol>\n<li>Arrays</li>\n<li>Dictionaries</li>\n<li>Collections </li>\n</ol>\n\n<p>... I hope you guys can point me in the right direction. This, once solved, I feel will greatly up my game in VBA development. I have been hesitant to delve into this as I am self educated and never really thought I would get this far as it is not my primary role, but would love to get past this now so I would greatly appreciate your assistance. </p>\n\n<p>BTW; I am pretty good at self learning, so if by chance there is already a post that can get me there just point the way. Again, in searching I could not find what I was looking for so I apologize if that was a result of not knowing how to (words to describe) look for the answer. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 983, "user_id": 6753444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a4459e9cb4ab680f510b698e7002eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6753444/jonathan"}, "edited": false, "score": 0, "creation_date": 1490208609, "post_id": 42959752, "comment_id": 73014880, "body": "Not to be facetious... but wouldn&#39;t it be easier to just teach them how to use INDEX-MATCH?"}, {"owner": {"reputation": 51, "user_id": 6635958, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723382dd398ed7168f02b430ffd9078e?s=128&d=identicon&r=PG&f=1", "display_name": "peter.domanico", "link": "https://stackoverflow.com/users/6635958/peter-domanico"}, "reply_to_user": {"reputation": 983, "user_id": 6753444, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9a4459e9cb4ab680f510b698e7002eca?s=128&d=identicon&r=PG&f=1", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6753444/jonathan"}, "edited": false, "score": 0, "creation_date": 1490208699, "post_id": 42959752, "comment_id": 73014928, "body": "I&#39;d actually like to figure this out for myself as well. I find manually entering multiple Index Match formulas rather tedious"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490209780, "post_id": 42959752, "comment_id": 73015536, "body": "get the proper row from the match alone. then use something like this <code>.Range(&quot;A:D&quot;).Rows(i).Values</code> where i is the number returned by the match.  It will return an array of four values at that row."}, {"owner": {"reputation": 51, "user_id": 6635958, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723382dd398ed7168f02b430ffd9078e?s=128&d=identicon&r=PG&f=1", "display_name": "peter.domanico", "link": "https://stackoverflow.com/users/6635958/peter-domanico"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490210469, "post_id": 42959752, "comment_id": 73015930, "body": "@ScottCraner thanks Scott, this sounds interesting. Any chance you have a working example of this being utilized?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490210839, "post_id": 42959752, "comment_id": 73016107, "body": "I just gave you one, here is another ActiveSheet.Range(&quot;A5:N100&quot;).Rows(3).Address` which will return the address <code>$A$7:$N$7</code>  Just use your match alone and allow the user to select multiple columns and set that as the range and match as the row."}, {"owner": {"reputation": 51, "user_id": 6635958, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723382dd398ed7168f02b430ffd9078e?s=128&d=identicon&r=PG&f=1", "display_name": "peter.domanico", "link": "https://stackoverflow.com/users/6635958/peter-domanico"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490211155, "post_id": 42959752, "comment_id": 73016287, "body": "@ScottCraner thanks Scott, let me see what I can do."}], "owner": {"reputation": 51, "user_id": 6635958, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/723382dd398ed7168f02b430ffd9078e?s=128&d=identicon&r=PG&f=1", "display_name": "peter.domanico", "link": "https://stackoverflow.com/users/6635958/peter-domanico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490206717, "creation_date": 1490206717, "last_edit_date": 1531164843, "question_id": 42959752, "link": "https://stackoverflow.com/questions/42959752/use-index-match-to-pull-multiple-columns-of-data", "title": "Use Index Match to pull multiple columns of data", "body": "<p>The following script allows users to perform an Index Match function through a series of Input Boxes. This version only allows users to pull one column of data per use. I'm wondering if its possible to change this code to allow users to pull multiple columns of data. I appreciate any feedback the community can provide.</p>\n\n<pre><code>Sub MatchMaster()\n\n'this script helps simplify the use of Excel's Index Match function\n'place this script in your personal macro workbook and assign it to a button\n'use it to pull data between two worksheets that share unique identifiers\n\n'dim ranges\nDim ValuesToPull As Range\nDim TargetIDs As Range\nDim SourceIDs As Range\nDim MyRange As Range\n\n'dim worksheets\nDim Source1 As Worksheet\nDim Target1 As Worksheet\nDim Source2 As Worksheet\nDim Target2 As Worksheet\n\n'input box dims\nDim Prompt1 As String\nDim Prompt2 As String\nDim Prompt3 As String\nDim Prompt4 As String\nDim Title1 As String\nDim Title2 As String\nDim Title3 As String\nDim Title4 As String\n\n'set prompts\nPrompt1 = \"Select values to pull (1 column only)\"\nPrompt2 = \"Select unique IDs on target sheet (1 column only)\"\nPrompt3 = \"Select unique IDs on source sheet (1 column only)\"\nPrompt4 = \"Where should we put these values? (1 column only)\"\n\n'set titles\nTitle1 = \"Source Sheet\"\nTitle2 = \"Target Sheet\"\nTitle3 = \"Source Sheet\"\nTitle4 = \"Target Sheet\"\n\n'error handling\nOn Error GoTo OuttaHere\n\n'input boxes\nSet SourceIDs = Application.InputBox(Prompt3, Title3, Type:=8)\nSet Source1 = SourceIDs.Worksheet\nSourceIDcolumn = SourceIDs.Column\nLastSourceID = Source1.Cells(Rows.Count, SourceIDcolumn).End(xlUp).Row\nSource1.Activate\n\nSet ValuesToPull = Application.InputBox(Prompt1, Title1, Type:=8)\nSet Source2 = ValuesToPull.Worksheet\nValuesColumn = ValuesToPull.Column\nLastValue = Source2.Cells(Rows.Count, ValuesColumn).End(xlUp).Row\nSource2.Activate\n\nSet TargetIDs = Application.InputBox(Prompt2, Title2, Type:=8)\nSet Target1 = TargetIDs.Worksheet\nTargetIDcolumn = TargetIDs.Column\nLastTargetID = Target1.Cells(Rows.Count, TargetIDcolumn).End(xlUp).Row '&lt;~~ also use this for MyRange\nTarget1.Activate\n\nSet MyRange = Application.InputBox(Prompt4, Title4, Type:=8)\nSet Target2 = MyRange.Worksheet\nMyColumn = MyRange.Column\nTarget2.Activate\n\n'convert input to Range Cells format\nWith Source1\n    Set SourceIDs = .Range(.Cells(1, SourceIDcolumn), .Cells(LastSourceID, SourceIDcolumn))\nEnd With\n\nWith Source2\n    Set ValuesToPull = .Range(.Cells(1, ValuesColumn), .Cells(LastValue, ValuesColumn))\nEnd With\n\nWith Target1\n     Set TargetIDs = .Range(.Cells(1, TargetIDcolumn), .Cells(LastTargetID, TargetIDcolumn))\nEnd With\n\nWith Target2\n     Set MyRange = .Range(.Cells(1, MyColumn), .Cells(LastTargetID, MyColumn))\nEnd With\n\n'apply formula\nMyRange = Application.Index(ValuesToPull, Application.Match(TargetIDs, SourceIDs, 0))\n\nOuttaHere:\nActiveWorkbook.ActiveSheet.Columns.AutoFit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1490210277, "post_id": 42959747, "comment_id": 73015814, "body": "as a side note, PivotTable makes grouping much easier if the order is not important"}, {"owner": {"reputation": 3, "user_id": 7752974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c3ed9281407ceed364354626e18e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Qwin", "link": "https://stackoverflow.com/users/7752974/qwin"}, "reply_to_user": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1490213185, "post_id": 42959747, "comment_id": 73017491, "body": "The order is important as the tables are used in ThinkCell waterfall charts."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7752974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c3ed9281407ceed364354626e18e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Qwin", "link": "https://stackoverflow.com/users/7752974/qwin"}, "edited": false, "score": 0, "creation_date": 1490213274, "post_id": 42960090, "comment_id": 73017538, "body": "This worked great. Thanks very much Shai Rado for the code, I was somewhat on the right track, but still quite a ways off. Appreciate it!"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1490207923, "creation_date": 1490207923, "answer_id": 42960090, "question_id": 42959747, "link": "https://stackoverflow.com/questions/42959747/vba-excel-group-rows-based-on-specific-criteria/42960090#42960090", "title": "VBA Excel - Group rows based on specific criteria", "body": "<p>You had a few <code>Else If</code> not in the right place.</p>\n\n<p>Also, you need to loop through the <code>Union</code> Range <code>Areas</code> to group each one of them.</p>\n\n<p><strong>Note</strong>: You don't need to use <code>rng0.Select</code> and later <code>Selection.Rows.Group</code>.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub SelectGroupRows0()\n\nDim c As Range\nDim rng0 As Range\nDim block As Range\n\nSet block = Range(\"B4:B23\")\n\nFor Each c In block\n    If Not IsEmpty(c) And c.Value = 0 Then\n        If rng0 Is Nothing Then\n            Set rng0 = c\n        Else\n            Set rng0 = Union(rng0, c)\n        End If\n    End If\nNext c\n\n' loop through your Range's Areas and group each one of them\nFor Each c In rng0.Areas\n    c.EntireRow.Group\nNext c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7752974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c3ed9281407ceed364354626e18e9d?s=128&d=identicon&r=PG&f=1", "display_name": "Qwin", "link": "https://stackoverflow.com/users/7752974/qwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4094, "favorite_count": 0, "accepted_answer_id": 42960090, "answer_count": 1, "score": 0, "last_activity_date": 1490207923, "creation_date": 1490206700, "last_edit_date": 1490207429, "question_id": 42959747, "link": "https://stackoverflow.com/questions/42959747/vba-excel-group-rows-based-on-specific-criteria", "title": "VBA Excel - Group rows based on specific criteria", "body": "<p>I'm very new to VBA and I'm trying to create code in Excel which will select rows based on values in a range (eg. 0's) and group them together using the group function in Excel. In the linked captures below you can see where I start (Capture 1) to where I want to go (Capture 2). </p>\n\n<p>The following code is where I've got to which selects all rows which are 0. Unfortunately, I cannot use the Group function when multiple rows are selected that are not together. </p>\n\n<p>I'm not quite sure what to add into the code to make it group the first set of 0's then move to the next set of 0's and do the same until it reached the end of the range. I would also like it to skip blank cells such as that in row 13 of the screen captures attached. </p>\n\n<pre><code>Sub SelectGroupRows0()\n\nDim c As Range\nDim rng0 As Range\nDim block As Range\n\nSet block = Range(\"B4:B23\")\n\nFor Each c In block\n    If c = 0 Then\n        If rng0 Is Nothing Then Set rng0 = c.EntireRow\n        Set rng0 = Union(rng0, c.EntireRow)\n\n    Else: End If\nNext c\n\nrng0.Select\nSelection.Rows.Group \n</code></pre>\n\n<p><code>End Sub</code></p>\n\n<p>Any help on this would be greatly appreciated. </p>\n\n<p>Thanks in advance,</p>\n\n<p>Q</p>\n\n<p><a href=\"https://i.stack.imgur.com/8SliX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8SliX.jpg\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/XEUgM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XEUgM.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook", "contacts"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b14db87398a09d6f8576fb7b012cbc?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mallett", "link": "https://stackoverflow.com/users/7752820/r-mallett"}, "edited": false, "score": 0, "creation_date": 1490381349, "post_id": 42965728, "comment_id": 73103569, "body": "Thanks for this. I didn&#39;t mention this was for Outlook 2010. It doesn&#39;t look like you can enable a shared contact folder as an Outlook Address Book. Please let me know if I&#39;m wrong about that."}, {"owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "reply_to_user": {"reputation": 11, "user_id": 7752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b14db87398a09d6f8576fb7b012cbc?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mallett", "link": "https://stackoverflow.com/users/7752820/r-mallett"}, "edited": false, "score": 0, "creation_date": 1490397005, "post_id": 42965728, "comment_id": 73110757, "body": "By default, no you cannot. However there is a hack that may or may not work: <a href=\"https://www.slipstick.com/outlook/contacts/display-other-contacts-in-address-book/\" rel=\"nofollow noreferrer\">slipstick.com/outlook/contacts/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": false, "score": 0, "last_activity_date": 1490233169, "creation_date": 1490233169, "answer_id": 42965728, "question_id": 42958969, "link": "https://stackoverflow.com/questions/42958969/how-to-find-contact-matches-in-shared-folders/42965728#42965728", "title": "How to find contact matches in shared folders", "body": "<p>GetContact will search any Contact folder that is enabled as an Outlook Address Book (in the folder's properties dialog).  However I believe for a Contact in a shared folder that only the user's default Contacts folder is searched as only default folders can be shared.</p>\n"}], "owner": {"reputation": 11, "user_id": 7752820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b14db87398a09d6f8576fb7b012cbc?s=128&d=identicon&r=PG&f=1", "display_name": "R.Mallett", "link": "https://stackoverflow.com/users/7752820/r-mallett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490233169, "creation_date": 1490204384, "question_id": 42958969, "link": "https://stackoverflow.com/questions/42958969/how-to-find-contact-matches-in-shared-folders", "title": "How to find contact matches in shared folders", "body": "<p>I am writing a macro that automatically renames emails based on information in a Contact's notes field. I'd like this macro to be able to reference Contacts in a shared contacts folder. I can't get it to work.</p>\n\n<p>The problem is that I am reliant on GetContact. I don't know how to get this kind of function to refer to another Contact folder. </p>\n\n<p>I'm not a programmer obviously - any help would be very appreciated. Here's the relevant part of what I've written:</p>\n\n<pre><code>Function AddSender(X As String)\n\nSet myContact = thisItem.Sender.GetContact\n\nIf Not myContact Is Nothing Then\n\ncontactProperties = myContact.Body\n\na = InStr(contactProperties, \";\")\nb = InStr(contactProperties, \"]\")\n\nRole = Mid(contactProperties, a + 2, b - a - 2)\nMsgBox (Role)\n\nnewSubject = Role + \" - \" + X\nthisItem.Subject = newSubject\nthisItem.Save\n\nEnd If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 1, "creation_date": 1490204279, "post_id": 42958774, "comment_id": 73012213, "body": "When you protect the sheet, use <code>UserInterfaceOnly:= True</code> which will protect the sheet from a user making changes, but allow your VBA code to make any required changes unhindered."}, {"owner": {"reputation": 167, "user_id": 4488338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00bdcf5b054a3cfe9592bdf4b25f51bf?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeCoder", "link": "https://stackoverflow.com/users/4488338/coffeecoder"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1490205512, "post_id": 42958774, "comment_id": 73012997, "body": "It works for me if I step through the code in the VBA editor, but calling it from a macro button within the worksheet does not work, the same behavior occurs."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1490205703, "post_id": 42958774, "comment_id": 73013112, "body": "That usually suggests a range isn&#39;t being qualified properly. You should always fully qualify ranges rather than using <code>ActiveSheet</code>"}, {"owner": {"reputation": 167, "user_id": 4488338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00bdcf5b054a3cfe9592bdf4b25f51bf?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeCoder", "link": "https://stackoverflow.com/users/4488338/coffeecoder"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1490206145, "post_id": 42958774, "comment_id": 73013389, "body": "Thanks, I will look into including that. For now, I tried unchecking &quot;disable background refresh&quot; on the oledb connection, and that seems to have resolved my issue. Appreciate the help, you taught me two things!"}], "answers": [{"tags": [], "owner": {"reputation": 167, "user_id": 4488338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00bdcf5b054a3cfe9592bdf4b25f51bf?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeCoder", "link": "https://stackoverflow.com/users/4488338/coffeecoder"}, "is_accepted": false, "score": 0, "last_activity_date": 1490206220, "creation_date": 1490206220, "answer_id": 42959580, "question_id": 42958774, "link": "https://stackoverflow.com/questions/42958774/excel-2013-protected-sheet-vba-pop-up-message/42959580#42959580", "title": "Excel 2013 protected sheet vba pop-up message", "body": "<p>To resolve my issue, I went into the Data tab and unchecked \"Enable background refresh\". I believe this only resolves my issue because I am using an OLEDB connection type. </p>\n"}], "owner": {"reputation": 167, "user_id": 4488338, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/00bdcf5b054a3cfe9592bdf4b25f51bf?s=128&d=identicon&r=PG&f=1", "display_name": "CoffeeCoder", "link": "https://stackoverflow.com/users/4488338/coffeecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1292, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490206838, "creation_date": 1490203787, "last_edit_date": 1490206838, "question_id": 42958774, "link": "https://stackoverflow.com/questions/42958774/excel-2013-protected-sheet-vba-pop-up-message", "title": "Excel 2013 protected sheet vba pop-up message", "body": "<p>I'm working on a protected Excel workbook and am trying to eliminate or understand why the follow message occurs AFTER my .MsgBox popup:</p>\n\n<blockquote>\n  <p>The cell or chart you're trying to change is on a protected sheet. To\n  make changes, click Unprotect Sheet in the Review tab (you might need\n  a password).</p>\n</blockquote>\n\n<p>I only have one input field in the workbook (date field), and I've set that cell style to \"Input\", as well as modified the cell format to \"unprotected\" so it stays editable even if the workbook is locked.</p>\n\n<p>My VBA/Macro:</p>\n\n<pre><code>Sub WeeklyReport()\n\nDim Week As String\n\nSet WeekValue = ThisWorkbook.Sheets(\"Report_Weekly\").Range(\"PRM_weekvalue\")\n\nWeek = WeekValue\n\n\nApplication.ScreenUpdating = False\nCall unprotectmacro\n\n\nWith ActiveWorkbook.Connections(\"SQLDBConnection\").OLEDBConnection\n.CommandText = \"EXEC dbo.usp_WeeklyReport '\" &amp; Week &amp; \"'\"\nActiveWorkbook.Connections(\"SQLDBConnection\").Refresh\n\n    Sheets(\"Report_Weekly\").Select\n    Range(\"A13\").Select\n    MsgBox \"The workbook is now refreshed.\"\n\nEnd With\n    ActiveSheet.Protect \"passwordgoeshere\", DrawingObjects:=True, Contents:=True, Scenarios:=True\n    ActiveWorkbook.Protect \"passwordgoeshere\", Structure:=True, Windows:=False\n    'Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>I would like this message not to appear to my end users, but I don't understand why it is occurring. My only thought is the table isn't done being refreshed after the protect sheet is turned back on. If that is the case, is there a way to wait for the background query to finish running before protecting the sheet again?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2013"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1490203626, "post_id": 42958630, "comment_id": 73011810, "body": "The VLOOKUP formula only returns the first result found. You would have to use a different formula or the Find method for example."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1490204566, "creation_date": 1490204566, "answer_id": 42959038, "question_id": 42958630, "link": "https://stackoverflow.com/questions/42958630/vlookup-return-1st-non-null-or-non-0-value/42959038#42959038", "title": "VLOOKUP() Return 1st Non Null Or Non 0 Value", "body": "<p>I would be using the AGGREGATE worksheet function to accomplish this on a worksheet. Taking that into VBA, you can use <code>Application.Evaluate(...)</code> on the same formula.</p>\n\n<pre><code>Dim filterCon As String, fr As Variant, lr As Long, vreturn As Variant\n\nfilterCon = \"findthis\"\n\nWith Worksheets(\"Ace Up Sleeve\")\n    lr = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    fr = Application.Evaluate(\"aggregate(15, 6, row(1:\" &amp; lr &amp; \")/('Ace Up Sleeve'!K1:K\" &amp; lr &amp; \"&lt;&gt;0), 1)\")\n    If Not IsError(fr) Then\n        vreturn = .Cells(fr, \"K\").Value\n        Debug.Print vreturn\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 42959038, "answer_count": 1, "score": 1, "last_activity_date": 1490204663, "creation_date": 1490203337, "last_edit_date": 1490204663, "question_id": 42958630, "link": "https://stackoverflow.com/questions/42958630/vlookup-return-1st-non-null-or-non-0-value", "title": "VLOOKUP() Return 1st Non Null Or Non 0 Value", "body": "<p>I am using <code>VLOOKUP()</code> to return values, but am  hitting an issue where the 1st value may be <code>NULL</code> or <code>0</code></p>\n\n<p>How can I use this function (or a similar one) to return the 1st <strong>NON</strong> Null or 0 value?</p>\n\n<pre><code>Application.WorksheetFunction.VLookup(filterCon, Sheets(\"Ace Up Sleeve\").Range(\"A:P\"), 11, False)\n</code></pre>\n"}, {"tags": ["excel", "conditional", "copy-paste", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1490205393, "post_id": 42958691, "comment_id": 73012923, "body": "Your <code>sh2.Cells(Rows.Count, 1)</code> is not fully qualified, <code>Rows.Count</code> without the <code>sh2</code> before means it&#39;s looking for the <code>ActiveSheet</code>. Also, the PO wants to copy values from Columns K:L , your code only copies the values from column K."}, {"owner": {"reputation": 15, "user_id": 7691022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3lbVeq7NMyE/AAAAAAAAAAI/AAAAAAAAAYU/mm8sNMde6HI/photo.jpg?sz=128", "display_name": "Dad Walsh", "link": "https://stackoverflow.com/users/7691022/dad-walsh"}, "edited": false, "score": 0, "creation_date": 1490207791, "post_id": 42958691, "comment_id": 73014403, "body": "This worked too.  And I cannot tell the difference in the results.  Thank you both."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1490206163, "last_edit_date": 1490206163, "creation_date": 1490203526, "answer_id": 42958691, "question_id": 42958629, "link": "https://stackoverflow.com/questions/42958629/vba-to-copy-from-named-range-based-on-condition-to-paste-vlaues-in-another-works/42958691#42958691", "title": "VBA to Copy from Named Range based on Condition to Paste Vlaues in another worksheet", "body": "<p>Try this</p>\n\n<pre><code>Sub CopyOnCondition()\n     Dim sh1 As Worksheet, sh2 As Worksheet, c As Range\n     Set sh1 = Sheet1 'Edit sheet name\n     Set sh2 = Sheet10 'Edit sheet name\n     With sh1\n         For Each c In .Range(\"L18:L24\")\n             If c.Value &gt; 0 Then\n                 sh2.Cells(Rows.Count, 1).End(xlUp)(2, 1).resize(,2).value=c.offset(,-1).resize(,2).value\n             End If\n         Next\n     End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 7691022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3lbVeq7NMyE/AAAAAAAAAAI/AAAAAAAAAYU/mm8sNMde6HI/photo.jpg?sz=128", "display_name": "Dad Walsh", "link": "https://stackoverflow.com/users/7691022/dad-walsh"}, "edited": false, "score": 0, "creation_date": 1490206811, "post_id": 42959286, "comment_id": 73013851, "body": "AWESOME!  Works like a charm.  THANK YOU"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 0, "last_activity_date": 1490205301, "creation_date": 1490205301, "answer_id": 42959286, "question_id": 42958629, "link": "https://stackoverflow.com/questions/42958629/vba-to-copy-from-named-range-based-on-condition-to-paste-vlaues-in-another-works/42959286#42959286", "title": "VBA to Copy from Named Range based on Condition to Paste Vlaues in another worksheet", "body": "<p>The code below will copy the values only from Columns K:L when the value in column L > 0.</p>\n\n<pre><code>Sub CopyOnCondition()\n\n     Dim sh1 As Worksheet, sh2 As Worksheet, c As Range\n     Set sh1 = Sheet1 'Edit sheet name\n     Set sh2 = Sheet10 'Edit sheet name\n\n     With sh1\n         For Each c In .Range(\"L18:L24\")\n             If c.Value &gt; 0 Then\n                 c.Offset(, -1).Resize(1, 2).Copy '&lt;-- copy column K with L\n                 ' paste values to the first empty row in Column A of sh2\n                 sh2.Cells(sh2.Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlValues\n             End If\n         Next c\n     End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7691022, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3lbVeq7NMyE/AAAAAAAAAAI/AAAAAAAAAYU/mm8sNMde6HI/photo.jpg?sz=128", "display_name": "Dad Walsh", "link": "https://stackoverflow.com/users/7691022/dad-walsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 42959286, "answer_count": 2, "score": 0, "last_activity_date": 1490245976, "creation_date": 1490203336, "last_edit_date": 1531161705, "question_id": 42958629, "link": "https://stackoverflow.com/questions/42958629/vba-to-copy-from-named-range-based-on-condition-to-paste-vlaues-in-another-works", "title": "VBA to Copy from Named Range based on Condition to Paste Vlaues in another worksheet", "body": "<p>I have a Named Range \"Quantities\" (Worksheet Sheet1, cells I21:L28) that have formula that reports a the quantity in column \"L\".  I would like to search Column L for values >0, and then Paste those Values (along with Data from Column K) into another worksheet (Sheet10).\nThe following Code is close, but it paste the formula not the values.\nPlease assist.</p>\n\n<pre><code>Sub CopyOnCondition()\n     Dim sh1 As Worksheet, sh2 As Worksheet, c As Range\n     Set sh1 = Sheet1 'Edit sheet name\n     Set sh2 = Sheet10 'Edit sheet name\n     With sh1\n         For Each c In .Range(\"L18:L24\")\n             If c.Value &gt; 0 Then\n                 c.Copy sh2.Cells(Rows.Count, 1).End(xlUp)(2, 1)\n             End If\n         Next\n     End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 192, "user_id": 7607686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/435f7fca50284f6317909c183bd89a22?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/7607686/john"}, "edited": false, "score": 0, "creation_date": 1490203256, "post_id": 42958438, "comment_id": 73011573, "body": "for quickest/easiest - I&#39;d add a calc&#39;ed column to hold the &quot;dynamic&quot; text (without the &quot;d&quot;), and mail merge (the &quot;d&quot; can be hardcoded where needed - so the calc column would hold &quot;increase&quot;.  NOTE: if you need other forms (capitalization, etc) then a code-based approach may be necessary, if you don&#39;t want to add columns for all needed permutations. (increase, increased, Increase, Increased, etc)"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1490207335, "post_id": 42958438, "comment_id": 73014170, "body": "If you use mailmerge you could handle increase/decrease in a couple of ways. (a) Use merge fields for the occurrences of increase/decrease. (b) The mail merge supports if-then-else logic, so when the change in sales &lt; 0 you can have the merge insert &quot;decreased&quot;. For example <code>{ IF { MERGEFIELD SalesChange } &gt; 0 &quot;increased&quot; &quot;decreased&quot; }</code>"}], "owner": {"reputation": 3000, "user_id": 292973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/de98e76d77be51182efd9eb4bddffb2a?s=128&d=identicon&r=PG", "display_name": "Mutuelinvestor", "link": "https://stackoverflow.com/users/292973/mutuelinvestor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1522177781, "creation_date": 1490202860, "last_edit_date": 1531161705, "question_id": 42958438, "link": "https://stackoverflow.com/questions/42958438/how-would-one-write-a-dynamic-word-document-using-query-results-excel-and-word", "title": "How would one write a dynamic word document using query results, excel and word", "body": "<p>I've been tasked with coming up with an approach to use query results to write a dynamic paragraph or two in word.  The subject matter is financial and the paragraph will take the form of the following example:</p>\n\n<p>Net sales <em>increased</em> [000] or [000]%. This compares to the prior period when sales were [ ].  Operating profit <em>increased</em> by [00]% or $[00] to [00]. The <em>increase</em> was fueled by...</p>\n\n<p>The data include the brackets would come directly from the query results. Words like increased could or should also be dynamic, reflecting the values in the query. </p>\n\n<p>Possible approaches:</p>\n\n<ol>\n<li><p>One approach I have considered is to set up a mailmerge document with fields and map the query result to the document and simple merged the query result into the mailmerge document.  This approach does well with the bracket data but I'm not quite sure how it would do with the increase/decreases.</p></li>\n<li><p>A second approach would be to use Excels text() function and concatenation to dynamically create the sentences and paragraphs and then perform a copy past special before copying to a word document. </p></li>\n<li><p>A third approach might be to use Excel VBA to write the document, but this has the potential to get very involved. </p></li>\n</ol>\n\n<p>Have others come across a similar task?  If so, how did you solve this problem?  Just trying to get some fresh ideas on how to tackle this.  I work primarily in Excel, perhaps Word has some features that lend themselves well to this challenge. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 4, "creation_date": 1490203395, "post_id": 42958370, "comment_id": 73011661, "body": "There is literally nothing you can do to protect an Excel file in this manner from a <i>deliberate</i> attempt to hack it by a reasonably-knowledgeable user. The best you can do is safeguard against accidental stuff and n00b users. Heck, the user can disable macros via Security setting. There is no VBA you can use that will circumvent or override <i>that</i>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1490203428, "post_id": 42958370, "comment_id": 73011685, "body": "You do know that is is fairly common knowledge to break a workbook&#39;s vba project passwrd..?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490203552, "post_id": 42958370, "comment_id": 73011761, "body": "I would lock the VBproject and Workbook structure, and make the protected sheet <code>xlVeryHidden</code>, and have your <code>Open</code> event unprotect and make it <code>xlVisible</code>. That&#39;s the best you can do. In that case if the macros are disabled, the user won&#39;t be able to do anything until/unless she hacks your VBProject, and if she&#39;s that competent, there&#39;s nothing you can do anyways."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1490203691, "post_id": 42958370, "comment_id": 73011854, "body": "There&#39;s not much you can do to protect an Excel file in this manner from an <b><i>accidental</i></b> non-attempt not to hack it by a completely unknowledgeable user. What do you do when macro security is set too high by policy (or the user) to allow it to run?"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490261809, "post_id": 42958370, "comment_id": 73036601, "body": "@Jeeped and in response to David Zemen&#39;s first comment; Perhaps I made my intent unclear. I&#39;m aware that Excel security is weak. I wanted to employ this technique as a trigger to mid-level users that macros must be enabled. Without too much detail it&#39;s for a challenge, no hacking allowed, just inventive uses of Excel to force the situation on someone, and their task is to look at macros and formulae and unravel the sheet&#39;s workings. I don&#39;t want to override security settings - I thought I made that clear in the question, the user <i>decides</i> to turn on macros, otherwise the workbook is unusable."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1490262187, "post_id": 42958370, "comment_id": 73036883, "body": "@Comintern Similar to above, high macro security is precisely the situation I want to deal with. By making the sheet <i>and</i> code inaccessible (in an Excel clean fashion, not in an inaccessible to hackers fashion), and by leaving some explanatory note, I prompt users to lower their macro security, allowing the event to run. So I&#39;m not <i>really</i> looking for a workaround what you describe. Of course if a user is un-knowledgeable enough not to have the admin privileges, then sure, I&#39;m stuck."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490262667, "post_id": 42958370, "comment_id": 73037248, "body": "@DavidZemens - with regard to your second comment, I agree that that would protect the workbook from all non-hacking users, forcing the macro-enable that I&#39;m after. In fact I intend to use <code>xlVeryHidden</code>. However it doesn&#39;t really solve my problem, as I want the code accessible once the macro has run (or after a series of predetermined events), automatically and without having to give the users a password. Perhaps in this case the <i>why</i> isn&#39;t important, maybe I shouldn&#39;t have included it in my question, really I just want to know whether I can toggle the viewing status automatically."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490273053, "post_id": 42958370, "comment_id": 73044713, "body": "you can&#39;t toggle it unless macros are enabled, and even then I am not 100% sure you can lock/unlock the VBProject using vba.. if you can, it would require user allows programmatic access to vba project object model, and this has to be done manually by the user as it&#39;s explicitly impossible to use VBA, even with SendKeys, to toggle the macro security or anything else in Trust Center settings."}], "answers": [{"comments": [{"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490203226, "post_id": 42958491, "comment_id": 73011546, "body": "Actually, I&#39;m happy for the user to view/edit the macro code, provided I&#39;ve run the first macro."}, {"owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490376679, "post_id": 42958491, "comment_id": 73100883, "body": "Your main question is: &quot;How to hide macro code from a user using VBA&quot;, but now you say you are ok with the user viewing and editing the macro code.  I am not sure now what you are looking for. Am I correct: You want to start the macro not accessible for the user, once the macro runs what it needs to run, you want it become accessible again?"}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490602203, "post_id": 42958491, "comment_id": 73166610, "body": "Yes, that is correct. The macro code must be hidden <i>and</i> un-hidden programatically, so that the user can access it only once the first macro has run."}, {"owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490624173, "post_id": 42958491, "comment_id": 73181991, "body": "Well, I would assume no macro can change the VBA settings as you mentioned before, but I think there are ways to work it out.  First, it is possible to make the macro run without the user needing to press any button for it to happen: <a href=\"https://support.office.com/en-us/article/Run-a-macro-5535c4ee-ff91-4e99-9704-99a49f1dcdf4#__toc270927005\" rel=\"nofollow noreferrer\">link</a>. Now if there is buttons in your spreadsheet, instead of linking the button with the macro, make the macro link the button for you. `    ActiveSheet.Shapes.Range(Array(&quot;Button 1&quot;)).Select     Selection.OnAction = &quot;Macro1&quot;`."}, {"owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490624436, "post_id": 42958491, "comment_id": 73182197, "body": "So, whenever the macro finishes its rotine, you attribute the button(s) with their respective macro(s) and you are good to go!"}, {"owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "reply_to_user": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490625855, "post_id": 42958491, "comment_id": 73183335, "body": "ps: The other macros should not run while one of them is working, but just in case, make sure to disable the buttons when you initialize your worksheet before the routine."}], "tags": [], "owner": {"reputation": 36, "user_id": 6894341, "user_type": "registered", "profile_image": "https://graph.facebook.com/1094314787327525/picture?type=large", "display_name": "Lucas Poloni Cordeiro", "link": "https://stackoverflow.com/users/6894341/lucas-poloni-cordeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1490202981, "creation_date": 1490202981, "answer_id": 42958491, "question_id": 42958370, "link": "https://stackoverflow.com/questions/42958370/how-to-hide-macro-code-from-a-user-using-vba/42958491#42958491", "title": "How to hide macro code from a user using VBA", "body": "<p>What about having two spreadsheet?\nOne of them will be for the user, you save it as Excel Workbook only (not Excel Macro-Enable Workbook). So the user won't even be able to see that there is a macro associated to it.\nThe other spreadsheet will be only for you, which you will import all the data the user adds to the other spreadsheet automatically and you can access the macro when you need it.</p>\n"}], "owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3514, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490202981, "creation_date": 1490202652, "question_id": 42958370, "link": "https://stackoverflow.com/questions/42958370/how-to-hide-macro-code-from-a-user-using-vba", "title": "How to hide macro code from a user using VBA", "body": "<p><strong>I already know how to hide macro code from the user</strong>; Simply open up your VBA project and go <code>Tools</code> - <code>VBAProject Properties</code> - <code>Protection</code> and check <code>Lock project for viewing</code> enter a password and your code is made inaccessible to users.</p>\n\n<p>I want to know if this can be automated with VBA.</p>\n\n<p><em>Why?</em></p>\n\n<p>I have a sheet of data that I use a macro to scramble, and a key to unscramble. A macro runs on a <code>Workbook_open</code> event and I want to guarantee this runs <em>before</em> the user can access any content.</p>\n\n<p>When a user opens the workbook, they can just hold <kbd>Shift</kbd> or choose not to enable macros, I don't want that. So I hide the macro code and protect all the cells <strong>by default</strong> using a really long and strong password. Part of the <code>Workbook_open</code> code then removes these restrictions (presumably by using the password), and of course the <code>Workbook_open</code> code only runs if macros are enabled.</p>\n\n<p>So can I toggle the viewing status with VBA? I imagine some string of <code>SendKeys</code> would do the job, but not ideal.</p>\n"}, {"tags": ["vba", "excel", "code128"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490203677, "post_id": 42958328, "comment_id": 73011839, "body": "Think you need to post all your code. if you Google custom functions I&#39;m sure you will find guidance on how to call."}, {"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490204114, "post_id": 42958328, "comment_id": 73012116, "body": "@SJR I tried googling, not sure how to iterate over a column to call the function. Thats the reason I reached out here for help"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490204164, "post_id": 42958328, "comment_id": 73012151, "body": "OK well post the function code. Are you asking how to call it from the code that you have posted above?"}, {"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490204298, "post_id": 42958328, "comment_id": 73012223, "body": "The above is the macro. I will post the function code now"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490204826, "post_id": 42958328, "comment_id": 73012553, "body": "Are all the values in column A strings? Do you want them replaced with the result of passing them through the formula, or the results placed elsewhere?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490205182, "post_id": 42958328, "comment_id": 73012784, "body": "You appear to have posted this question twice - please can you close the other one so people don&#39;t waste their time answering it?"}, {"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490205479, "post_id": 42958328, "comment_id": 73012975, "body": "I have deleted the other question. The column A is string currently but once I call the function I will have to set the font to Code128"}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490205987, "post_id": 42959402, "comment_id": 73013294, "body": "How can set the font style of column A"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490206257, "post_id": 42959402, "comment_id": 73013459, "body": "That&#39;s a different question. Looks like the link has instructions on how to install the font."}, {"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490206947, "post_id": 42959402, "comment_id": 73013946, "body": "Ya i did install the font. But I am not sure how to set one column when <code>Target.Font = Code 128</code> it throws error"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490207211, "post_id": 42959402, "comment_id": 73014112, "body": "A guess but try Target.Font = &quot;Code 128&quot; or you could do manually as in step 7."}, {"owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490207816, "post_id": 42959402, "comment_id": 73014414, "body": "I am getting an runtime error 424  in the <code>Target.Value = Code128(Target.Value)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "edited": false, "score": 0, "creation_date": 1490210194, "post_id": 42959402, "comment_id": 73015772, "body": "You&#39;ve marked this as an answer - does this mean that you have solved the problem?"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1490205677, "creation_date": 1490205677, "answer_id": 42959402, "question_id": 42958328, "link": "https://stackoverflow.com/questions/42958328/call-the-function-in-macros/42959402#42959402", "title": "Call the function in macros", "body": "<p>I'm not entirely sure what you mean by \"set the font to Code128\" so this is my best guess</p>\n\n<pre><code>With ActiveSheet.PageSetup\n    .PrintTitleRows = \"$1:$1\"\n    .PrintGridlines = True\n    .Orientation = xlLandscape\n    .PaperSize = xlPaperA4\n    .Zoom = False\n    .FitToPagesWide = 1\n    .FitToPagesTall = False\nEnd With\n\nFor Each Target In Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n    If Target.Value &lt;&gt; vbNullString Then\n        Target.Value = Code128(Target.Value)\n        Target.Resize(, 12).WrapText = True\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 253, "user_id": 1168160, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/75c746005702f67c78c0b0f916e95e88?s=128&d=identicon&r=PG", "display_name": "Mjall2", "link": "https://stackoverflow.com/users/1168160/mjall2"}, "is_accepted": false, "score": 0, "last_activity_date": 1490211091, "creation_date": 1490211091, "answer_id": 42961031, "question_id": 42958328, "link": "https://stackoverflow.com/questions/42958328/call-the-function-in-macros/42961031#42961031", "title": "Call the function in macros", "body": "<pre><code>Application.WorksheetFunction.Code128(tempString)\n</code></pre>\n\n<p>Make sure Option Explicit is at the top of your function (may not be needed if you have a Public function, not sure)</p>\n"}], "owner": {"reputation": 565, "user_id": 4912134, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e2acf4f3d82de4ab30d4c9b982b2e7cf?s=128&d=identicon&r=PG&f=1", "display_name": "user4912134", "link": "https://stackoverflow.com/users/4912134/user4912134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 1, "accepted_answer_id": 42959402, "answer_count": 2, "score": 1, "last_activity_date": 1490211091, "creation_date": 1490202529, "last_edit_date": 1490206809, "question_id": 42958328, "link": "https://stackoverflow.com/questions/42958328/call-the-function-in-macros", "title": "Call the function in macros", "body": "<p>I added a function in the excel visual basic like below which converts the string in to the bar code got this from the <a href=\"https://code.adonline.id.au/easily-generate-code-128-barcodes-in-excel/\" rel=\"nofollow noreferrer\">blog</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/5uots.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5uots.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>   Public Function Code128(SourceString As String)\n\n  Dim Counter As Integer\n  Dim CheckSum As Long\n  Dim mini As Integer\n  Dim dummy As Integer\n  Dim UseTableB As Boolean\n  Dim Code128_Barcode As String\n\n  If Len(SourceString) &gt; 0 Then\n\n    'Check for valid characters\n    For Counter = 1 To Len(SourceString)\n\n        Select Case Asc(Mid(SourceString, Counter, 1))\n\n            Case 32 To 126, 203\n\n            Case Else\n\n                MsgBox \"Invalid character in barcode string.\" &amp; vbCrLf &amp; vbCrLf &amp; \"Please only use standard ASCII characters\", vbCritical\n                Code128 = \"\"\n                Exit Function\n\n        End Select\n\n    Next\n\n    Code128_Barcode = \"\"\n    UseTableB = True\n\n    Counter = 1\n    Do While Counter &lt;= Len(SourceString)\n\n        If UseTableB Then\n\n            'Check if we can switch to Table C\n            mini = IIf(Counter = 1 Or Counter + 3 = Len(SourceString), 4, 6)\n            GoSub testnum\n\n            If mini% &lt; 0 Then 'Use Table C\n\n                If Counter = 1 Then\n\n                    Code128_Barcode = Chr(205)\n\n                Else 'Switch to table C\n\n                    Code128_Barcode = Code128_Barcode &amp; Chr(199)\n\n                End If\n\n                UseTableB = False\n\n            Else\n\n                If Counter = 1 Then Code128_Barcode = Chr(204) 'Starting with table B\n\n            End If\n\n        End If\n\n        If Not UseTableB Then\n\n            'We are using Table C, try to process 2 digits\n            mini% = 2\n            GoSub testnum\n\n            If mini% &lt; 0 Then 'OK for 2 digits, process it\n\n                dummy% = Val(Mid(SourceString, Counter, 2))\n                dummy% = IIf(dummy% &lt; 95, dummy% + 32, dummy% + 100)\n                Code128_Barcode = Code128_Barcode &amp; Chr(dummy%)\n                Counter = Counter + 2\n\n            Else 'We haven't got 2 digits, switch to Table B\n\n                Code128_Barcode = Code128_Barcode &amp; Chr(200)\n                UseTableB = True\n\n            End If\n\n        End If\n\n        If UseTableB Then\n\n            'Process 1 digit with table B\n            Code128_Barcode = Code128_Barcode &amp; Mid(SourceString, Counter, 1)\n            Counter = Counter + 1\n\n        End If\n\n    Loop\n\n    'Calculation of the checksum\n    For Counter = 1 To Len(Code128_Barcode)\n\n        dummy% = Asc(Mid(Code128_Barcode, Counter, 1))\n        dummy% = IIf(dummy% &lt; 127, dummy% - 32, dummy% - 100)\n\n        If Counter = 1 Then CheckSum&amp; = dummy%\n\n        CheckSum&amp; = (CheckSum&amp; + (Counter - 1) * dummy%) Mod 103\n\n    Next\n\n    'Calculation of the checksum ASCII code\n    CheckSum&amp; = IIf(CheckSum&amp; &lt; 95, CheckSum&amp; + 32, CheckSum&amp; + 100)\n\n    'Add the checksum and the STOP\n    Code128_Barcode = Code128_Barcode &amp; Chr(CheckSum&amp;) &amp; Chr$(206)\nEnd If\n\nCode128 = Code128_Barcode\n\nExit Function\n\n\n     testnum:\n\n    'if the mini% characters from Counter are numeric, then mini%=0\n    mini% = mini% - 1\n    If Counter + mini% &lt;= Len(SourceString) Then\n\n        Do While mini% &gt;= 0\n\n            If Asc(Mid(SourceString, Counter + mini%, 1)) &lt; 48 Or Asc(Mid(SourceString, Counter + mini%, 1)) &gt; 57 Then Exit Do\n            mini% = mini% - 1\n\n        Loop\n\n    End If\n\n    Return\n\n   End Function\n</code></pre>\n\n<p>I need to call this function in the macro I am creating for formating the cells.  I am new to macros and the vba function. Now I dont know how to call these function inside macros and pass the column A in to the function in a loop.So all the values in column A is converted in to bar codes </p>\n\n<pre><code>With ActiveSheet.PageSetup\n.PrintTitleRows = \"$1:$1\"\n.PrintGridlines = True\n\n.Orientation = xlLandscape\n.PaperSize = xlPaperA4\n\n .Zoom = False\n .FitToPagesWide = 1\n .FitToPagesTall = False\n\n  End With\n\n  For Each Target In Range(Cells(1, 1), Cells(65536, 1).End(xlUp))\n   If Target &lt;&gt; \"\" Then\n   With Range(Target, Target.Offset(0, 11))\n   .WrapText = True\n  End With\n   End If\n  Next\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 3, "creation_date": 1490201466, "post_id": 42957957, "comment_id": 73010409, "body": "Can you not just use <code>Option Compare Text</code>?  Alternatively, add <code>vbTextCompare</code> arg to your first <code>InStr</code>."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "edited": false, "score": 1, "creation_date": 1490201859, "post_id": 42957957, "comment_id": 73010692, "body": "Of the two that @blackworx notes, the latter would be preferable for sake of good habit."}], "answers": [{"comments": [{"owner": {"reputation": 250, "user_id": 3884538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AN4kC.png?s=128&g=1", "display_name": "Mike Powell", "link": "https://stackoverflow.com/users/3884538/mike-powell"}, "edited": false, "score": 0, "creation_date": 1490202168, "post_id": 42958181, "comment_id": 73010891, "body": "Ucase will change both sides of the comparison to upper case"}, {"owner": {"reputation": 3, "user_id": 7752586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb6603154f3bd368e86a3b1fcb29152?s=128&d=identicon&r=PG&f=1", "display_name": "gaceag", "link": "https://stackoverflow.com/users/7752586/gaceag"}, "edited": false, "score": 0, "creation_date": 1490202599, "post_id": 42958181, "comment_id": 73011149, "body": "Thank you verry much. It works perfect. Thank you again."}], "tags": [], "owner": {"reputation": 250, "user_id": 3884538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AN4kC.png?s=128&g=1", "display_name": "Mike Powell", "link": "https://stackoverflow.com/users/3884538/mike-powell"}, "is_accepted": true, "score": 0, "last_activity_date": 1490202121, "creation_date": 1490202121, "answer_id": 42958181, "question_id": 42957957, "link": "https://stackoverflow.com/questions/42957957/vba-excel-macro-not-case-sensitive/42958181#42958181", "title": "vba excel macro not case sensitive", "body": "<p>Change this one line</p>\n\n<p>StartPos = InStr(Ucase(cl), Ucase(SearchText))</p>\n"}], "owner": {"reputation": 3, "user_id": 7752586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fb6603154f3bd368e86a3b1fcb29152?s=128&d=identicon&r=PG&f=1", "display_name": "gaceag", "link": "https://stackoverflow.com/users/7752586/gaceag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1540, "favorite_count": 0, "accepted_answer_id": 42958181, "answer_count": 1, "score": 0, "last_activity_date": 1490215743, "creation_date": 1490201379, "last_edit_date": 1531164843, "question_id": 42957957, "link": "https://stackoverflow.com/questions/42957957/vba-excel-macro-not-case-sensitive", "title": "vba excel macro not case sensitive", "body": "<p>I have this code and I need some help in makeing it not case sensitive. Right now the serch is case sensitive and I have some excel tables that contains data that are both in uppercase and inlowercase.\n Thanks</p>\n\n<pre><code>Sub FormatSelection()\n\n    Dim cl As Range\n    Dim SearchText As String\n    Dim StartPos As Integer\n    Dim EndPos As Integer\n    Dim TestPos As Integer\n    Dim TotalLen As Integer\n\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    SearchText = Application.InputBox _\n    (Prompt:=\"Enter string.\", Title:=\"Which string to format?\", Type:=2)\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n    If SearchText = \"\" Then\n        Exit Sub\n    Else\n        For Each cl In Selection\n          TotalLen = Len(SearchText)\n          StartPos = InStr(cl, SearchText)\n          TestPos = 0\n          Do While StartPos &gt; TestPos\n            With cl.Characters(StartPos, TotalLen).Font\n              .FontStyle = \"Bold\"\n              .ColorIndex = 3\n            End With\n            EndPos = StartPos + TotalLen\n            TestPos = TestPos + EndPos\n            StartPos = InStr(TestPos, cl, SearchText, vbTextCompare)\n          Loop\n        Next cl\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490209555, "post_id": 42957921, "comment_id": 73015395, "body": "Welcome to SO.  This is not a free code-writing service but exists to help others with code or functions they are trying to develop.  As such, we expect to see clear cut questions with examples of data, attempted code, actual output, desired output, research efforts to solve the problem, etc.  Please read the HELP pages for information as to <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here?</a>, <a href=\"http://stackoverflow.com/help/how-to-ask\">How to Ask a Good Question</a>, and <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5002497, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-PrjmpWItf0I/AAAAAAAAAAI/AAAAAAAAABY/wgxnS2BAIYQ/photo.jpg?sz=128", "display_name": "Andrew Dunlop", "link": "https://stackoverflow.com/users/5002497/andrew-dunlop"}, "is_accepted": false, "score": 0, "last_activity_date": 1490368206, "creation_date": 1490368206, "answer_id": 43003001, "question_id": 42957921, "link": "https://stackoverflow.com/questions/42957921/aggregating-single-orders-to-block-orders/43003001#43003001", "title": "Aggregating single orders to block orders.", "body": "<p>I managed to work it out in a fairly unconventional way, but works nonetheless. Easier to merge all the parameters, so that it truly distinguishes orders that are 100% the same excluding size. Then aggregate by size, then reverse the procedure. This way actually seems to make it fairly easy for me to maintain. \n[D = Side, E = Qty, F = Contract, G = Ticker, H = Expiry, I = LimitPx, J = StopPx, K = Notes, L = Notes]  - O &amp; P are just blank/free columns.  </p>\n\n<pre><code>Dim strFormula(1 To 1) As Variant\nDim LastRow As Long\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Sheets(\"ORDERS\")\nLastRow = ws.Range(\"F\" &amp; ws.Rows.Count).End(xlUp).Row\nWith ThisWorkbook.Sheets(\"ORDERS\")\n\nstrFormula(1) =   \"=D4&amp;\"\"/\"\"&amp;F4&amp;\"\"/\"\"&amp;G4&amp;\"\"/\"\"&amp;H4&amp;\"\"/\"\"&amp;I4&amp;\"\"/\"\"&amp;J4&amp;\"\"/\"\"&amp;K4&amp;\"\"/\"\"&amp;L4\"\n\n.Range(\"O4:O4\").Formula = strFormula\nws.Range(\"O4:O\" &amp; LastRow).FillDown\n\nEnd With\n\nSheets(\"ORDERS\").Range(Range(\"O4\"), Range(\"O4\").End(xlDown)).Copy\nRange(\"O4\").PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\n\n'********************************************************************\n\nDim OrderRng As Range\nDim Dic As Variant\nDim ordparam As Variant\n\nOn Error Resume Next\n\nxTitleId = \"ETS_TRADE_BLOCK\"\nSet OrderRng = Range(Range(\"A4\"), Range(\"O4\").End(xlDown))\nSet Dic = CreateObject(\"Scripting.Dictionary\")\n\nordparam = OrderRng.Value\n\nFor i = 1 To UBound(ordparam, 1)\n\n    Dic(ordparam(i, 15)) = Dic(ordparam(i, 15)) + ordparam(i, 5)\n\nNext\nApplication.ScreenUpdating = False\n\nOrderRng.ClearContents\nOrderRng.Range(\"O1\").Resize(Dic.Count, 1) = Application.WorksheetFunction.Transpose(Dic.keys)\nOrderRng.Range(\"P1\").Resize(Dic.Count, 1) = Application.WorksheetFunction.Transpose(Dic.items)\n\nApplication.ScreenUpdating = True\n\n'***************************************************************************\n\nDim reFormula(1 To 9) As Variant\nDim LastRows As Long\nDim wst As Worksheet\n\nSet wst = ThisWorkbook.Sheets(\"ORDERS\")\nLastRows = wst.Range(\"O\" &amp; wst.Rows.Count).End(xlUp).Row\nWith ThisWorkbook.Sheets(\"ORDERS\")\n\n    reFormula(1) = \"=LEFT(O4,FIND(\"\"/\"\",O4)-1)\"\n    reFormula(2) = \"=P4\"\n    reFormula(3) = \"=TRIM(LEFT(SUBSTITUTE(MID(O4,FIND(\"\" | \"\",SUBSTITUTE(O4,\"\"/\"\",\"\" | \"\",1))+1,LEN(O4)),\"\"/\"\",REPT(\"\" \"\",LEN(O4))),LEN(O4)))\"\n    reFormula(4) = \"=TRIM(LEFT(SUBSTITUTE(MID(O4,FIND(\"\" | \"\",SUBSTITUTE(O4,\"\"/\"\",\"\" | \"\",2))+1,LEN(O4)),\"\"/\"\",REPT(\"\" \"\",LEN(O4))),LEN(O4)))\"\n    reFormula(5) = \"=TRIM(LEFT(SUBSTITUTE(MID(O4,FIND(\"\" | \"\",SUBSTITUTE(O4,\"\"/\"\",\"\" | \"\",3))+1,LEN(O4)),\"\"/\"\",REPT(\"\" \"\",LEN(O4))),LEN(O4)))\"\n    reFormula(6) = \"=TRIM(LEFT(SUBSTITUTE(MID(O4,FIND(\"\" | \"\",SUBSTITUTE(O4,\"\"/\"\",\"\" | \"\",4))+1,LEN(O4)),\"\"/\"\",REPT(\"\" \"\",LEN(O4))),LEN(O4)))\"\n    reFormula(7) = \"=TRIM(LEFT(SUBSTITUTE(MID(O4,FIND(\"\" | \"\",SUBSTITUTE(O4,\"\"/\"\",\"\" | \"\",5))+1,LEN(O4)),\"\"/\"\",REPT(\"\" \"\",LEN(O4))),LEN(O4)))\"\n    reFormula(8) = \"=TRIM(LEFT(SUBSTITUTE(MID(O4,FIND(\"\" | \"\",SUBSTITUTE(O4,\"\"/\"\",\"\" | \"\",6))+1,LEN(O4)),\"\"/\"\",REPT(\"\" \"\",LEN(O4))),LEN(O4)))\"\n    reFormula(9) = \"=TRIM(LEFT(SUBSTITUTE(MID(O4,FIND(\"\" | \"\",SUBSTITUTE(O4,\"\"/\"\",\"\" | \"\",7))+1,LEN(O4)),\"\"/\"\",REPT(\"\" \"\",LEN(O4))),LEN(O4)))\"\n\n.Range(\"D4:L4\").Formula = reFormula\nwst.Range(\"D4:L\" &amp; LastRows).FillDown\n\nEnd With\n\nSheets(\"ORDERS\").Range(Range(\"D4\"), Range(\"L4\").End(xlDown)).Copy\nRange(\"D4\").PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5002497, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-PrjmpWItf0I/AAAAAAAAAAI/AAAAAAAAABY/wgxnS2BAIYQ/photo.jpg?sz=128", "display_name": "Andrew Dunlop", "link": "https://stackoverflow.com/users/5002497/andrew-dunlop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1490368206, "creation_date": 1490201261, "last_edit_date": 1531161705, "question_id": 42957921, "link": "https://stackoverflow.com/questions/42957921/aggregating-single-orders-to-block-orders", "title": "Aggregating single orders to block orders.", "body": "<p>I have a sheet with a number of orders. e.g. [A2, B2, C2, D2, E2, F2] = [<em>Account#, Side, Quantity, ticker, limit price, stop price</em>] - I would like a way to aggregate the orders first by the ticker, and then by the side. e.g. if I have 3 orders for Oil with quantities 2,5,4, with sides, Buy, Buy, Sell - I would like to have 2 rows with Buy 7 Oil and Sell 4 Oil. Any suggestions would be great. \nI don't have any sample code to reference as not sure where to start. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 724, "user_id": 3112610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/VcnQ4.jpg?s=128&g=1", "display_name": "Adam", "link": "https://stackoverflow.com/users/3112610/adam"}, "edited": false, "score": 2, "creation_date": 1490201210, "post_id": 42957866, "comment_id": 73010221, "body": "Can you show what you have so far?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1490202180, "post_id": 42958140, "comment_id": 73010900, "body": "One more level of error control if you use <code>length = Instr(start,...</code> for the second one. It will still return the position from the begining, not from where <i>start</i> is."}, {"owner": {"reputation": 3, "user_id": 7752563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39bd84b963fe48b47a195fbe7859fabc?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7752563/craig"}, "edited": false, "score": 0, "creation_date": 1490204963, "post_id": 42958140, "comment_id": 73012640, "body": "This seems to work! What would be the easiest way to put this in a loop? Sometimes I have multiple of these bracket statements per cell. (My excel VBA is really crap)"}], "tags": [], "owner": {"reputation": 470, "user_id": 2011597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/10vNY.png?s=128&g=1", "display_name": "blackworx", "link": "https://stackoverflow.com/users/2011597/blackworx"}, "is_accepted": true, "score": 1, "last_activity_date": 1490255127, "last_edit_date": 1490255127, "creation_date": 1490201972, "answer_id": 42958140, "question_id": 42957866, "link": "https://stackoverflow.com/questions/42957866/change-color-of-text-in-cells-within-brackets/42958140#42958140", "title": "Change color of text in cells within brackets", "body": "<pre><code>Range(SomeRange).Characters(start,length).Font.Color = vbGreen\n</code></pre>\n\n<p>To get your start and length, use <code>Instr</code></p>\n\n<pre><code>start = Instr(1, Range(SomeRange).Value, \"[Assign\", vbTextCompare)\nlength = Instr(start, Range(SomeRange).Value, \"]\", vbTextCompare) - start + 1\n</code></pre>\n\n<p>If <code>start</code> is zero then string not found.</p>\n\n<p>--</p>\n\n<p><em><strong>UPDATE:</strong></em></p>\n\n<p>Off top of my head, for multiple instances in the same cell:</p>\n\n<pre><code>start = 1\n\nDo\n\n    start = Instr(start, Range(SomeRange).Value, \"[Assign\", vbTextCompare)\n\n    If start &gt; 0 Then\n\n        length = Instr(start, Range(SomeRange).Value, \"]\", vbTextCompare) - start + 1\n\n        if length &gt; 1 then Range(SomeRange).Characters(start, length).Font.Color = vbGreen\n\n        start = start + length\n\n    End If\n\nLoop While start &gt; 0\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7752563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39bd84b963fe48b47a195fbe7859fabc?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/7752563/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 42958140, "answer_count": 1, "score": -1, "last_activity_date": 1490255127, "creation_date": 1490201084, "last_edit_date": 1490202959, "question_id": 42957866, "link": "https://stackoverflow.com/questions/42957866/change-color-of-text-in-cells-within-brackets", "title": "Change color of text in cells within brackets", "body": "<p>I have cells in a sheet that include a bunch of text, but also have certain text within square brackets that look like this:</p>\n\n<blockquote>\n  <p>[Assign: some text here]</p>\n  \n  <p>[Select: some text here]</p>\n</blockquote>\n\n<p>I need a macro that will change the color of any text starting with Assign to green (including Assign) and any text starting with Select to blue (also including Select). Brackets themselves could be color changed or not, whatever is easiest.</p>\n\n<p>I have tried multiple ways to do this but cannot figure out with a regex or a replace how to do this. Closest I have come was uppercasing all text within [] brackets but not making a distinction between Assign or Select.</p>\n\n<p>Appreciate the help</p>\n\n<p>Edit: </p>\n\n<p>What I have so far:</p>\n\n<pre><code>Sub test()\n    Dim r As Range\n    Dim m As Object\n    Dim test As Range\n    Dim strInput As String\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = True\n        .IgnoreCase = True\n        .Pattern = \"\\[(.*?)\\]\"\n        For Each r In Range(\"C2:C2\")\n            If .test(r.Value) Then\n                For Each m In .Execute(r.Value)\n                    r.Value = Replace(r.Value, m.Value, UCase(m.Value))\n                Next\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 2, "creation_date": 1490201129, "post_id": 42957791, "comment_id": 73010164, "body": "If your subroutine requires a parameter (or parameters) to be passed through it you will not be able to simply run it without providing these parameters, unless they are optional."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1490201350, "post_id": 42957791, "comment_id": 73010322, "body": "There is nothing wrong with the code you&#39;ve provided. You need to show more code including the declaration; e.g. <b>Sub MyMacro()</b>. Could you be in Debug Mode or Macro Recording mode? You cannot run a sub in these environments."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1490209738, "post_id": 42957791, "comment_id": 73015508, "body": "It may also be the case that your date is a &quot;real date&quot; and displayed in English due to your windows regional settings or formatting.  If that is the case, the solution will be different."}], "owner": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490200872, "creation_date": 1490200872, "question_id": 42957791, "link": "https://stackoverflow.com/questions/42957791/replace-part-of-cell-with-something-else-for-a-specific-range", "title": "Replace part of cell with something else for a specific range", "body": "<p>I have a date in the form DD-MMM-YY and I need to replace the English months (MMM) with the German ones (my Excel is in German). I found this code on the Microsoft dev page: </p>\n\n<p><code>Worksheets(\"Sheet1\").Columns(\"A\").Replace _ \n What:=\"SIN\", Replacement:=\"COS\", _ \n SearchOrder:=xlByColumns, MatchCase:=True</code></p>\n\n<p>which I adjusted to my needs as follows: </p>\n\n<p><code>Worksheets(\"export0\").columns(\"J\").Replace _\n What:=\"DEC\", Replacement:=\"DEZ\", _\n SearchOrder:=xlByColumns, MatchCase:=True</code></p>\n\n<p>However, when running it, Excel shows me a pop-up asking for the name of the makro and it does not allow me to execute it. Would anyone be able to provide some guiding on this? </p>\n"}, {"tags": ["html", "vba", "excel", "export"], "answers": [{"tags": [], "owner": {"reputation": 3148, "user_id": 1016567, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aI7P1.png?s=128&g=1", "display_name": "laylarenee", "link": "https://stackoverflow.com/users/1016567/laylarenee"}, "is_accepted": false, "score": 1, "last_activity_date": 1490203184, "creation_date": 1490203184, "answer_id": 42958569, "question_id": 42957701, "link": "https://stackoverflow.com/questions/42957701/save-all-sheets-in-workbook-as-html-files/42958569#42958569", "title": "Save all sheets in workbook as HTML files", "body": "<p>You will need to iterate each sheet in the file and save an output file for it:</p>\n\n<pre><code>Const xlHtml = 44\n\nSub SaveAllTabsAsHtmlFiles()\n\n    Set objExcel = CreateObject(\"Excel.Application\")\n    ' open that source file\n    objExcel.Workbooks.Open \"C:\\Workbook\\newitems.xlsx\"\n    ' iterate all sheets in source file\n    For i = 1 To objExcel.ActiveWorkbook.Worksheets.Count\n        ' select each sheet\n        objExcel.ActiveWorkbook.Worksheets(i).Select\n        ' get name of current sheet\n        sheetname = objExcel.ActiveWorkbook.Worksheets(i).Name\n        ' name of output file (I added underscore + sheetname)\n        outputfile = \"C:\\Workbook\\newitems_\" &amp; sheetname &amp; \".html\"\n        ' save current sheet as html\n        objExcel.ActiveWorkbook.SaveAs Filename:=outputfile, FileFormat:=xlHtml\n    Next i\n    'done\n    objExcel.Quit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7428003, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WMp52clojC4/AAAAAAAAAAI/AAAAAAAAAHk/YFRsm1kwSvU/photo.jpg?sz=128", "display_name": "Rootinshell", "link": "https://stackoverflow.com/users/7428003/rootinshell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490203754, "creation_date": 1490200606, "last_edit_date": 1490203754, "question_id": 42957701, "link": "https://stackoverflow.com/questions/42957701/save-all-sheets-in-workbook-as-html-files", "title": "Save all sheets in workbook as HTML files", "body": "<p>I've been using the following script to convert an .xlsx file to HTML web page. Now I need to save all the sheets in this workbook as HTML and this function doesn't work.</p>\n\n<pre><code>Const xlHtml = 44\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Workbooks.Open \"C:\\Workbook\\newitems.xlsx\"\nobjExcel.ActiveWorkbook.SaveAs \"C:\\Workbook\\newitems.html\", xlHtml\nobjExcel.Quit\n</code></pre>\n\n<p>Thanks for your help </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1490200125, "post_id": 42957438, "comment_id": 73009454, "body": "Month(Now).  Watch the format, though."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7748417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kgGOo.jpg?s=128&g=1", "display_name": "Brian Faires", "link": "https://stackoverflow.com/users/7748417/brian-faires"}, "is_accepted": false, "score": 0, "last_activity_date": 1490261025, "last_edit_date": 1490261025, "creation_date": 1490200845, "answer_id": 42957777, "question_id": 42957438, "link": "https://stackoverflow.com/questions/42957438/specify-current-month-in-file-path-preventing-having-to-change-macro-each-month/42957777#42957777", "title": "Specify current month in file path preventing having to change macro each month", "body": "<p>This function works for me in VBA:</p>\n\n<pre><code>Function GetMonth() As String\n\n    GetMonth = Application.WorksheetFunction.Text(Date, \"mmmm\")\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1490265744, "creation_date": 1490265744, "answer_id": 42973720, "question_id": 42957438, "link": "https://stackoverflow.com/questions/42957438/specify-current-month-in-file-path-preventing-having-to-change-macro-each-month/42973720#42973720", "title": "Specify current month in file path preventing having to change macro each month", "body": "<p>Use the VBA <code>Format</code> keyword which </p>\n\n<blockquote>\n  <p>Returns a Variant (String) containing an expression formatted\n  according to instructions contained in a format expression..  </p>\n  \n  <p><em>Format(expression[, format[, firstdayofweek[, firstweekofyear]]])</em><br>\n  <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251755.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/gg251755.aspx</a></p>\n</blockquote>\n\n<p>Don't forget your year will need updating as well.</p>\n\n<pre><code>\"TEXT;G:\\Rejects\\\" &amp; Year(Date) &amp; \"\\\" &amp; Format(Date, \"mmmm\") &amp; \"\\Test_3.csv\"\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490265744, "creation_date": 1490199894, "last_edit_date": 1531164843, "question_id": 42957438, "link": "https://stackoverflow.com/questions/42957438/specify-current-month-in-file-path-preventing-having-to-change-macro-each-month", "title": "Specify current month in file path preventing having to change macro each month", "body": "<p>I am trying to run the following macro on a file in the current month's folder.  I have a macro working which locates the current month's folder on a shared drive location and successfully Calls this macro.  However, the below macro specifies March but I'm looking for a way to specify \"current month\" so I don't have to change the macro every month.\n(This macro just converts .csv to .xlsx but is only for test purposes now.)</p>\n\n<pre><code>Sub Reject_Review()\n\n\n\nActiveWorkbook.Worksheets.Add\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;G:\\Rejects\\2017\\March\\Test_3.csv\" _\n    , Destination:=Range(\"$A$1\"))\n    .Name = \"Test\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = False\n    .TextFileSpaceDelimiter = False\n    .TextFileOtherDelimiter = \"|\"\n    .TextFileColumnDataTypes = Array(2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 _\n    , 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, _\n    1, 1, 1, 1, 1)\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\n\n\nEnd With\n\nEnd Sub    \n</code></pre>\n"}, {"tags": ["excel", "hyperlink", "userform", "vba"], "comments": [{"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 0, "creation_date": 1490201367, "post_id": 42957404, "comment_id": 73010337, "body": "How are you attempting to join the three values? What would you like the outcome to look like?"}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 2830807, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8d4fed935473e237688b0e4a7fb9fa5b?s=128&d=identicon&r=PG&f=1", "display_name": "chris1982", "link": "https://stackoverflow.com/users/2830807/chris1982"}, "edited": false, "score": 0, "creation_date": 1490267101, "post_id": 42961421, "comment_id": 73040523, "body": "I used your second solution, declaring the variable definitely helped when I needed to extend the hyperlink to include the value from another user input box."}], "tags": [], "owner": {"reputation": 229, "user_id": 7729923, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t7mS9.png?s=128&g=1", "display_name": "J. L. Muller", "link": "https://stackoverflow.com/users/7729923/j-l-muller"}, "is_accepted": true, "score": 0, "last_activity_date": 1490213584, "last_edit_date": 1490213584, "creation_date": 1490212419, "answer_id": 42961421, "question_id": 42957404, "link": "https://stackoverflow.com/questions/42957404/concatenating-userform-data-and-passing-to-cell-as-hyperlink/42961421#42961421", "title": "Concatenating Userform Data And Passing To Cell As Hyperlink", "body": "<p>This can be solved if you process part 2 and 3 <em>before</em> step 1. This way you can add the texts from these two parts in the hyperlink formula:</p>\n\n<pre><code>ActiveSheet.Cells(lRow, 3).Value = UCase(Left(Me.cbo_action_type.Value, 2))\nActiveSheet.Cells(lRow, 4).Value = Format(CStr(Now), \"yyyymmdd_hhmmss\")\nActiveSheet.Cells(lRow, 2).Value = _\n    \"=Hyperlink(\"\"H:\\revised_action_tracker\\test\\\" &amp; _\n    ActiveSheet.Cells(lRow, 3).Value &amp; ActiveSheet.Cells(lRow, 4).Value &amp; \"\"\")\"\n</code></pre>\n\n<p>Or, if you don't wanna make it this large sentence, declare a variable to concatenate those strings, like this:</p>\n\n<pre><code>ActiveSheet.Cells(lRow, 3).Value = UCase(Left(Me.cbo_action_type.Value, 2))\nActiveSheet.Cells(lRow, 4).Value = Format(CStr(Now), \"yyyymmdd_hhmmss\")\nDim c As String: c = ActiveSheet.Cells(lRow, 3).Value &amp; ActiveSheet.Cells(lRow, 4).Value\nActiveSheet.Cells(lRow, 2).Value = \"=Hyperlink(\"\"H:\\revised_action_tracker\\test\\\" &amp; c &amp; \"\"\")\"\n</code></pre>\n\n<p>As an alternative, if you wanna setup a link without changing the text, you can create a cell with simple string and associate a hyperlink to it, instead of creating it with the formula HYPERLINK(). So you'd have something like this:</p>\n\n<pre><code>ActiveSheet.Cells(lRow, 2).Value = \"H:\\revised_action_tracker\\test\\\"\nActiveSheet.Cells(lRow, 3).Value = UCase(Left(Me.cbo_action_type.Value, 2))\nActiveSheet.Cells(lRow, 4).Value = Format(CStr(Now), \"yyyymmdd_hhmmss\")\nActiveSheet.Hyperlinks.Add Anchor:=Cells(lRow, 2), Address:=\"H:\\revised_action_tracker\\test\\\" &amp; Cells(lRow, 3) &amp; Cells(lRow, 4)\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 2830807, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8d4fed935473e237688b0e4a7fb9fa5b?s=128&d=identicon&r=PG&f=1", "display_name": "chris1982", "link": "https://stackoverflow.com/users/2830807/chris1982"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 42961421, "answer_count": 1, "score": 1, "last_activity_date": 1490213584, "creation_date": 1490199757, "last_edit_date": 1531164843, "question_id": 42957404, "link": "https://stackoverflow.com/questions/42957404/concatenating-userform-data-and-passing-to-cell-as-hyperlink", "title": "Concatenating Userform Data And Passing To Cell As Hyperlink", "body": "<p>I am trying to pass combined data from a user form to a cell to create a hyperlink.</p>\n\n<p>I'm hoping to end up with a hyperlink structure as follows:</p>\n\n<ul>\n<li>Part 1: static folder location</li>\n<li>Part 2: First 2 characters from option selected in user form</li>\n<li>Part 3: Current Date and Time</li>\n</ul>\n\n<p>I have all of this working in isolation:</p>\n\n<ol>\n<li><code>.Cells(lRow, 2).Value = \"=Hyperlink(\"\"H:\\revised_action_tracker\\test\\\"\")\"</code></li>\n<li><code>.Cells(lRow, 3).Value = UCase(Left(Me.cbo_action_type.Value, 2))</code></li>\n<li><code>.Cells(lRow, 4).Value = Format(CStr(Now), \"yyyymmdd_hhmmss\")</code></li>\n</ol>\n\n<p>When I attempt to join part 2 and 3 into the working Hyperlink from Part 1 it throws a Syntax error.</p>\n\n<p>I'm expecting the hyperlink to look like this:</p>\n\n<p>H:\\revised_action_tracker\\test\\CT-20170322_162111</p>\n\n<p>I feel like I'm going round in circles with this, any help would be gratefully received.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 33, "user_id": 6226773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-CvcOv2hHC3o/AAAAAAAAAAI/AAAAAAAAASo/N4Low3I5ryE/photo.jpg?sz=128", "display_name": "sai krishna", "link": "https://stackoverflow.com/users/6226773/sai-krishna"}, "reply_to_user": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "edited": false, "score": 0, "creation_date": 1490199672, "post_id": 42957253, "comment_id": 73009133, "body": "where to change, I changed in both places. But still getting error"}], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "is_accepted": true, "score": 0, "last_activity_date": 1490200699, "last_edit_date": 1490200699, "creation_date": 1490200363, "answer_id": 42957602, "question_id": 42957253, "link": "https://stackoverflow.com/questions/42957253/run-time-error-430-for-power-point-application-in-vba/42957602#42957602", "title": "Run-Time Error 430 for Power point application in VBA", "body": "<p>You should add a Presentation :    </p>\n\n<pre><code>Sub CreatePPT()\n\nDim MYPPT As PowerPoint.Application\nSet MYPPT = New PowerPoint.Application\n\nDim PPTPresent as PowerPoint.Presentation\n\nWith MYPPT\n\n    .Visible = msoTrue\n     set PPTPresent = .Presentations.add\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6226773, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-CvcOv2hHC3o/AAAAAAAAAAI/AAAAAAAAASo/N4Low3I5ryE/photo.jpg?sz=128", "display_name": "sai krishna", "link": "https://stackoverflow.com/users/6226773/sai-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 42957602, "answer_count": 1, "score": 0, "last_activity_date": 1490200699, "creation_date": 1490199333, "last_edit_date": 1531164843, "question_id": 42957253, "link": "https://stackoverflow.com/questions/42957253/run-time-error-430-for-power-point-application-in-vba", "title": "Run-Time Error 430 for Power point application in VBA", "body": "<p>I want to create powerpoint presentation through VBA Code and I selected library (early binding) reference in tools also. But I'm unable to create Powerpoint application through VBA. I wrote the below code and i'm getting the error as <strong>\"Class does not support automation or does not support expected interface\"</strong>. Could you please help to resolve the issue.</p>\n\n<pre><code>Sub CreatePPT()\n\nDim MYPPT As PowerPoint.Application\nSet MYPPT = New PowerPoint.Application\n\nWith MYPPT\n\n    .Visible = msoTrue\n    .Activate\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 4, "creation_date": 1490199888, "post_id": 42957248, "comment_id": 73009295, "body": "You could do but you&#39;d have to trust the vba project object model. Another  and simpler solution might be saving the whole workbook as a copy and deleting the sheets that aren&#39;t relevant? This would require a lot less code and keep your macros in tact."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1490200625, "post_id": 42957248, "comment_id": 73009812, "body": "What kind of button?  Forms or ActiveX ?"}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1490201027, "post_id": 42957248, "comment_id": 73010099, "body": "The button is an image (round circle with and i as for Information)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1490201203, "post_id": 42957248, "comment_id": 73010215, "body": "Your code shows you create a new workbook by copying the sheets - is the code contained in the sheet modules, or in regular modules in the source workbook?  Are you asking about how to also copy the code, or just about how to &quot;repoint&quot; the shape&#39;s &quot;onaction&quot; setting?"}, {"owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "edited": false, "score": 0, "creation_date": 1490254352, "post_id": 42957248, "comment_id": 73032133, "body": "Tim, I would need both, to copy be code and make that the shape points to the code in the newly created file"}], "answers": [{"tags": [], "owner": {"reputation": 119, "user_id": 7626550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Vt5dC.jpg?s=128&g=1", "display_name": "ArchiCAT", "link": "https://stackoverflow.com/users/7626550/archicat"}, "is_accepted": true, "score": 2, "last_activity_date": 1490226999, "creation_date": 1490226999, "answer_id": 42964828, "question_id": 42957248, "link": "https://stackoverflow.com/questions/42957248/vba-copy-sheets-with-macros/42964828#42964828", "title": "VBA copy sheets with macros", "body": "<p>Try saving the whole workbok as a new file and delete the sheets you don't need. That way you keep the macro and the refrence in place. If the macro in the original file ties to itself by name ( <code>like workbooks(filename)</code> ) you should change that to <code>ThisWorkbook</code> or something similar dinamic reference in the original file.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6050906, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-iwRIP7bN7oM/AAAAAAAAAAI/AAAAAAAAA7U/2i67o_OaP6w/photo.jpg?sz=128", "display_name": "rejdrouin", "link": "https://stackoverflow.com/users/6050906/rejdrouin"}, "is_accepted": false, "score": 1, "last_activity_date": 1541730806, "creation_date": 1541730806, "answer_id": 53219032, "question_id": 42957248, "link": "https://stackoverflow.com/questions/42957248/vba-copy-sheets-with-macros/53219032#53219032", "title": "VBA copy sheets with macros", "body": "<p>Put the code in the sheet(s) instead of a module and it will transfer to the new book.</p>\n"}], "owner": {"reputation": 1945, "user_id": 2148939, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/65a4495f8cf59bfe786fe5b75598ff13?s=128&d=identicon&r=PG", "display_name": "Selrac", "link": "https://stackoverflow.com/users/2148939/selrac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2066, "favorite_count": 0, "accepted_answer_id": 42964828, "answer_count": 2, "score": 1, "last_activity_date": 1541730806, "creation_date": 1490199329, "last_edit_date": 1490206746, "question_id": 42957248, "link": "https://stackoverflow.com/questions/42957248/vba-copy-sheets-with-macros", "title": "VBA copy sheets with macros", "body": "<p>I have a series of Sheets in Excel which I'm coping to a new File. One of the Sheets has an object button that refers to a macro of the original file. On the new created file the button refers to the macro in the original file. </p>\n\n<p>The code I use to transfer the Sheets is the following</p>\n\n<pre><code>Sheets(Array(\"A\", \"B\", \"C\", \"D\", \"E\")).Copy\nActiveWorkbook.SaveAs Filename:= \"\\\\XXX\\\" &amp; Filename &amp; \".xlsb\" _\n    , FileFormat:=xlExcel12, CreateBackup:=False\nActiveWindow.Close\n</code></pre>\n\n<p>Is it possible to transfer the macros when copying the Sheets and refer the button to the new file?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1490199428, "post_id": 42957100, "comment_id": 73008949, "body": "Absolute reference: <code>=CORREL(HIIK!R2C8:R221C8...</code>"}, {"owner": {"reputation": 1, "user_id": 7612146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36a9bae4c66c32a7a1e46207f246467?s=128&d=identicon&r=PG&f=1", "display_name": "mathvxn", "link": "https://stackoverflow.com/users/7612146/mathvxn"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1490200098, "post_id": 42957100, "comment_id": 73009438, "body": "That worked! Thanks! 1/2 way there... :)"}, {"owner": {"reputation": 1, "user_id": 7612146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36a9bae4c66c32a7a1e46207f246467?s=128&d=identicon&r=PG&f=1", "display_name": "mathvxn", "link": "https://stackoverflow.com/users/7612146/mathvxn"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1490203465, "post_id": 42957100, "comment_id": 73011707, "body": "Alternately, instead of starting 220 from the top, it could start 1 down from the last cell if that would be easier."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1490257664, "post_id": 42957100, "comment_id": 73033836, "body": "What&#39;s the first starting point? Your code uses relative references but gives no indication where the active cell is when you start adding the formulas."}], "owner": {"reputation": 1, "user_id": 7612146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36a9bae4c66c32a7a1e46207f246467?s=128&d=identicon&r=PG&f=1", "display_name": "mathvxn", "link": "https://stackoverflow.com/users/7612146/mathvxn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490198943, "creation_date": 1490198943, "question_id": 42957100, "link": "https://stackoverflow.com/questions/42957100/vba-correl-function-using-specific-cells", "title": "VBA Correl Function: Using specific cells", "body": "<p>I have a 2-part question. I'm attempting to create a macro to use to calculate the correlation between a set column of data and a variable column of data (meaning, I always want H2:H221 for the first column, but want the second column to jump 220 cells down from the last starting point).</p>\n\n<p>The first question is how do I set those starting and ending cells to be H2 and H221 in worksheet HIIK?\nThis is the code I have so far:</p>\n\n<pre><code>Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = _\n        \"=CORREL(HIIK!R[-23]C[5]:R[196]C[5],Data!R[19777]C[5]:R[19996]C[5])\"\n    ActiveCell.Offset(1, 0).Range(\"A1\").Select\n</code></pre>\n\n<p>I've tried doing the following, but Excel inserts single parens around H2 and H221, which results in a #name? error.</p>\n\n<pre><code> Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = _\n        \"=CORREL(HIIK!H2:H221,Data!R[19777]C[5]:R[19996]C[5])\"\n    ActiveCell.Offset(1, 0).Range(\"A1\").Select\n</code></pre>\n\n<p>My second question is how do I get it to start the next correlation function 220 cells below the one it started from last time, for the second array in the CORREL function?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "excel-2010", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1490219909, "post_id": 42957035, "comment_id": 73020911, "body": "Why not to try <code>ChartObj.CopyPicture xlScreen, xlPicture</code> and <code>myDoc.Paragraphs(1).Range.PasteSpecial</code>?"}, {"owner": {"reputation": 21, "user_id": 7640265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2eed84983ccb611bbee22659cd58fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Aston", "link": "https://stackoverflow.com/users/7640265/jim-aston"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1490256606, "post_id": 42957035, "comment_id": 73033298, "body": "Perfect!! Thank you! worked great."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1490297442, "post_id": 42957035, "comment_id": 73062325, "body": "Posted the solution as answer, please click to accept it, if that helps."}], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1490256909, "creation_date": 1490256909, "answer_id": 42970498, "question_id": 42957035, "link": "https://stackoverflow.com/questions/42957035/copy-and-paste-an-excel-chart-into-word-without-linking-or-saving-as-a-gif/42970498#42970498", "title": "Copy and paste an excel chart into word without linking or saving as a GIF", "body": "<p>Use <code>.CopyPicture</code> and <code>.PasteSpecial</code> methods:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Copy_Paste_Report_1_Graph_to_new_word_document()\n\n    Dim ChartObj As ChartObject\n    Dim WordApp As Word.Application\n    Dim myDoc As Word.Document\n\n    Set ChartObj = Worksheets(\"External Dashboard\").ChartObjects(\"Chart 1\")\n    Set WordApp = CreateObject(class:=\"Word.Application\")\n    WordApp.Visible = True\n    WordApp.Activate\n    Set myDoc = WordApp.Documents.Add\n    ChartObj.CopyPicture xlScreen, xlPicture\n    myDoc.Paragraphs(1).Range.PasteSpecial\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7640265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2eed84983ccb611bbee22659cd58fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Aston", "link": "https://stackoverflow.com/users/7640265/jim-aston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1100, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1490256909, "creation_date": 1490198772, "last_edit_date": 1531161705, "question_id": 42957035, "link": "https://stackoverflow.com/questions/42957035/copy-and-paste-an-excel-chart-into-word-without-linking-or-saving-as-a-gif", "title": "Copy and paste an excel chart into word without linking or saving as a GIF", "body": "<p>I am a total VBA novice, but I've managed to cobble together some code which allows me to export an excel 2010 chart into a new Word 2010 document.  The only problem I have is that I would like to unlink the chart from excel once it is exported, so that it doesn't change when excel is updated.  I've looked everywhere, but nothing seems to work.  </p>\n\n<p>The only other code which seems to fit the bill takes the chart and saves it as an image prior to pasting it, but this would not work as I have nowhere to save the image - users in our organisation do not have access to the C:\\ drive, and without knowing everyone's user details, I cannot write code which will do the job.</p>\n\n<p>The code I've written so far is this, which does work, but does not unlink:</p>\n\n<pre><code> Sub Copy_Paste_Report_1_Graph_to_new_word_document()\n'\n'Copy/Paste An Excel Chart Into a New Word Document\n'(VBE &gt; Tools &gt; References &gt; Microsoft Word 12.0 Object Library)\n\n'Excel Objects\nDim ChartObj As ChartObject\n\n'Word Objects\nDim WordApp As Word.Application\nDim myDoc As Word.Document\nDim WordTable As Word.Table\n\n'Optimize Code\n  Application.ScreenUpdating = False\n  Application.EnableEvents = False\n\n\n\n'Copy Chart from Excel\n  Set ChartObj = Worksheets(\"External Dashboard\").ChartObjects(\"Chart 1\")\n\n'Create an Instance of MS Word\n  On Error Resume Next\n\n    'Is MS Word already opened?\n      Set WordApp = GetObject(class:=\"Word.Application\")\n\n    'Clear the error between errors\n      Err.Clear\n\n    'If MS Word is not already open then open MS Word\n      If WordApp Is Nothing Then Set WordApp = CreateObject(class:=\"Word.Application\")\n\n    'Handle if the Word Application is not found\n      If Err.Number = 429 Then\n        MsgBox \"Microsoft Word could not be found, aborting.\"\n        GoTo EndRoutine\n      End If\n\n  On Error GoTo 0\n\n'Make MS Word Visible and Active\n  WordApp.Visible = True\n  WordApp.Activate\n\n'Create a New Document\n  Set myDoc = WordApp.Documents.Add\n\n'Copy Excel Chart\n  ChartObj.Copy\n\n'Paste Chart into MS Word\n  myDoc.Paragraphs(1).Range.PasteSpecial Link:=False _\n\nEndRoutine:\n'Optimize Code\n  Application.ScreenUpdating = True\n  Application.EnableEvents = True\n\n'Clear The Clipboard\n  Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>I've probably included more than I need to, but like I said, I'm a novice. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 1, "creation_date": 1490198808, "post_id": 42956999, "comment_id": 73008500, "body": "You can add similar search function with or operator for the other values you want to search"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490198866, "post_id": 42956999, "comment_id": 73008543, "body": "Try this <code>&quot;=AND(SUMPRODUCT(--(ISNUMBER(SEARCH({&quot;&quot;CTC&quot;&quot;,&quot;&quot;critical tc&quot;&quot;,&quot;&quot;critical to close&quot;&quot;},$S2))))&gt;0,$I2&gt;=10000,$N2&gt;=30)&quot;</code>"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1490198947, "post_id": 42956999, "comment_id": 73008606, "body": "<a href=\"http://stackoverflow.com/questions/14803944/excel-searching-for-multiple-terms-in-a-cell\" title=\"excel searching for multiple terms in a cell\">stackoverflow.com/questions/14803944/&hellip;</a> check out this link"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490199354, "post_id": 42956999, "comment_id": 73008908, "body": "you could add an OR, so <code>=AND(OR(cond1,cond2),cond3,cond4)</code>"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490198668, "creation_date": 1490198668, "question_id": 42956999, "link": "https://stackoverflow.com/questions/42956999/excel-conditional-formatting-to-add-multiple-words-to-search", "title": "Excel conditional formatting to add multiple words to SEARCH", "body": "<p>I'm currently using this code to add some conditional formatting to column A:</p>\n\n<pre><code>Range(\"A2:A5000\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:= _\n    \"=AND(SEARCH(\"\"CTC\"\",$S2),$I2&gt;=10000,$N2&gt;=30)\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n</code></pre>\n\n<p>Unfortunately I just found out that sometimes instead of \"CTC\" I need to search for \"critical to close\", or \"critical tc\", etc. Is there a way I can easily modify that SEARCH function to include more criteria, perhaps by creating an array?</p>\n\n<p>My fear is completely overhauling how I write it because I use that SEARCH function in many other places as well. I'd like to be able to do a simple find and replace in my code to prevent having to make many, many changes...</p>\n\n<p>Thanks for the help-</p>\n"}, {"tags": ["vba", "excel", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 0, "last_activity_date": 1490215876, "creation_date": 1490215876, "answer_id": 42962423, "question_id": 42956874, "link": "https://stackoverflow.com/questions/42956874/get-data-points-in-web-page-via-vba/42962423#42962423", "title": "Get data points in web page via vba", "body": "<p>The below example shows how to retrieve necessary data from the webpage via XHR and RegEx:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Test()\n\n    Dim QueryString As String\n    Dim PageURL As String\n    Dim PageContent As String\n    Dim Match As Variant\n    Dim a() As Variant\n\n    QueryString = \"david hill\"\n    PageURL = \"http://www.securities-administrators.ca/nrs/nrsIndvSearchResults.aspx?mode=QS&amp;type=I&amp;indv=\" &amp; EncodeUriComponent(QueryString)\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", PageURL, False\n        .send\n        PageContent = .responseText\n    End With\n    With CreateObject(\"Scripting.Dictionary\")\n        For Each Match In RegExMatches(PageContent, \"&lt;a id=\"\"ctl00_bodyContent_gvIndividuals_ctl\\d{2}_lbtnIndDetail\"\"[^&gt;]*&gt;([^&lt;]*)\")\n            .Item(.Count) = Match.SubMatches(0)\n        Next\n        a = WorksheetFunction.Transpose(.Items())\n    End With\n    Output2DArray Sheets(1).Cells(1, 1), a\n\nEnd Sub\n\nFunction EncodeUriComponent(strText As String) As String\n    Static objHtmlfile As Object\n\n    If objHtmlfile Is Nothing Then\n        Set objHtmlfile = CreateObject(\"htmlfile\")\n        objHtmlfile.parentWindow.execScript \"function encode(s) {return encodeURIComponent(s)}\", \"jscript\"\n    End If\n    EncodeUriComponent = objHtmlfile.parentWindow.encode(strText)\nEnd Function\n\nFunction RegExMatches(sText, sPattern, Optional bGlobal = True, Optional bMultiLine = True, Optional bIgnoreCase = True)\n    With CreateObject(\"VBScript.RegExp\")\n        .Global = bGlobal\n        .MultiLine = bMultiLine\n        .IgnoreCase = bIgnoreCase\n        .Pattern = sPattern\n        Set RegExMatches = .Execute(sText)\n    End With\nEnd Function\n\nSub Output2DArray(oDstRng As Range, aCells As Variant)\n\n    With oDstRng\n        .Parent.Select\n        With .Resize( _\n                UBound(aCells, 1) - LBound(aCells, 1) + 1, _\n                UBound(aCells, 2) - LBound(aCells, 2) + 1)\n            .NumberFormat = \"@\"\n            .Value = aCells\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7752354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1538b05d47f340991c8e7927eea9761?s=128&d=identicon&r=PG&f=1", "display_name": "sharkxii", "link": "https://stackoverflow.com/users/7752354/sharkxii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1490215876, "creation_date": 1490198335, "last_edit_date": 1531164843, "question_id": 42956874, "link": "https://stackoverflow.com/questions/42956874/get-data-points-in-web-page-via-vba", "title": "Get data points in web page via vba", "body": "<p>I need to get specific values on this webpage. How do I get just those values into Excel?</p>\n\n<p><a href=\"http://www.securities-administrators.ca/nrs/nrsIndvSearchResults.aspx?mode=QS&amp;type=I&amp;indv=david+hill\" rel=\"nofollow noreferrer\">http://www.securities-administrators.ca/nrs/nrsIndvSearchResults.aspx?mode=QS&amp;type=I&amp;indv=david+hill</a></p>\n\n<p>Below is the fragment of HTML content for the results, I would need the value \"BOOTH, David (Arthur)\" for example to be imported into Excel.</p>\n\n<pre><code>&lt;div&gt;\n    &lt;table border=\"1\" cellspacing=\"0\" class=\"gridview_style\" id=\"ctl00_bodyContent_gvIndividuals\" rules=\"all\" style=\"width:100%;border-collapse:collapse;\"&gt;\n        &lt;tr&gt;\n            &lt;th scope=\"col\" style=\"width:50%;\"&gt;&lt;span id=\"ctl00_bodyContent_gvIndividuals_ctl01_lbl_ind\"&gt;Name&lt;/span&gt;&lt;/th&gt;\n            &lt;th scope=\"col\" style=\"width:50%;\"&gt;Firm(s)&lt;/th&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td class=\"articleText\"&gt;\n                &lt;a href=\"javascript:__doPostBack(&amp;#39;ctl00$bodyContent$gvIndividuals$ctl02$lbtnIndDetail&amp;#39;,&amp;#39;&amp;#39;)\" id=\"ctl00_bodyContent_gvIndividuals_ctl02_lbtnIndDetail\"&gt;BOOTH, David (Arthur)&lt;/a&gt;\n            &lt;/td&gt;\n            &lt;td class=\"articleText\"&gt;&lt;span id=\"ctl00_bodyContent_gvIndividuals_ctl02_lblFirmName\"&gt;SCOTIA CAPITAL INC. / SCOTIA CAPITAUX INC.&lt;/span&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td class=\"articleText\"&gt;\n                &lt;a href=\"javascript:__doPostBack(&amp;#39;ctl00$bodyContent$gvIndividuals$ctl03$lbtnIndDetail&amp;#39;,&amp;#39;&amp;#39;)\" id=\"ctl00_bodyContent_gvIndividuals_ctl03_lbtnIndDetail\"&gt;HILL, David (Adam)&lt;/a&gt;\n            &lt;/td&gt;\n            &lt;td class=\"articleText\"&gt;&lt;span id=\"ctl00_bodyContent_gvIndividuals_ctl03_lblFirmName\"&gt;RBC DIRECT INVESTING INC./RBC PLACEMENTS EN DIRECT INC.&lt;/span&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td class=\"articleText\"&gt;\n                &lt;a href=\"javascript:__doPostBack(&amp;#39;ctl00$bodyContent$gvIndividuals$ctl04$lbtnIndDetail&amp;#39;,&amp;#39;&amp;#39;)\" id=\"ctl00_bodyContent_gvIndividuals_ctl04_lbtnIndDetail\"&gt;HILL, David (Lowell)&lt;/a&gt;\n            &lt;/td&gt;\n            &lt;td class=\"articleText\"&gt;&lt;span id=\"ctl00_bodyContent_gvIndividuals_ctl04_lblFirmName\"&gt;STATE FARM INVESTOR SERVICES (CANADA) CO.&lt;/span&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;/div&gt;                                    \n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490202076, "post_id": 42956796, "comment_id": 73010827, "body": "Look into finding the last row and column used,loading everything into an array, do your changes and then put the values back.  It will speed it up.  As it is you are cycling through every cell testing it and changing it.  That is going to take a long time.  Arrays woulds speed it up exponentially."}, {"owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490206222, "post_id": 42956796, "comment_id": 73013440, "body": "This would definitely help I imagine. As I know my data won&#39;t go beyond a certain point, my update works for me. However, if I find time, I will update the code to simply find the last row and column and post it here. Thanks!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490206310, "post_id": 42956796, "comment_id": 73013497, "body": "instead of putting it in the question, please put the new code as an answer, as it is such."}, {"owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490280849, "post_id": 42956796, "comment_id": 73051056, "body": "Sorry about that! I&#39;m pretty new and haven&#39;t had the opportunity to provide my own answer yet. Thanks for the heads up!"}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490198652, "post_id": 42956828, "comment_id": 73008389, "body": "&quot;&quot; and vbNullstring are the same, so it would be best to use &#39;If r.Value &lt;&gt; vbNullString then&#39;."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490199671, "post_id": 42956828, "comment_id": 73009132, "body": "@BrandonBarney actually they&#39;re not. Null values versus white space are two different things and get handled differently. This is especially true with excel."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490199815, "post_id": 42956828, "comment_id": 73009251, "body": "whitespace and &quot;&quot; are two different things. vbNullString is a constant expression for &quot;&quot;. You can even use the immediate window to check for equality between the two (Debug.Print &quot;&quot; = vbNullString returns True). Now, a whitespace character is a whole different story, and certainly is handled differently, but &quot;&quot; is not whitespace. You may be interested in this: <a href=\"http://stackoverflow.com/questions/32435320/is-there-any-difference-between-vbnullstring-and\" title=\"is there any difference between vbnullstring and\">stackoverflow.com/questions/32435320/&hellip;</a>."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490199938, "post_id": 42956828, "comment_id": 73009333, "body": "@BrandonBarney please see <a href=\"http://stackoverflow.com/questions/32435320/is-there-any-difference-between-vbnullstring-and\" title=\"is there any difference between vbnullstring and\">stackoverflow.com/questions/32435320/&hellip;</a>"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490200115, "post_id": 42956828, "comment_id": 73009443, "body": "It seems we shared the same page with eachother. As that post explains though, they are treated the same but the memory usage is different. As noted before, checking for quality between vbNullString and &quot;&quot; returns true. As we can see from the MSDN page as well (<a href=\"https://msdn.microsoft.com/en-us/library/microsoft.visualbasic.constants.vbnullstring(v=vs.110).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>) vbNullstring is literally a 0 length string (as is &quot;&quot;)."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490200222, "post_id": 42956828, "comment_id": 73009521, "body": "Also, for clarity I am not trying to argue and I am certainly not saying your advice was wrong. I am simply recommending that it is redundant due to the way the two are treated. It took me months before I discovered that &quot;&quot; and vbNullstring were the same, but that the latter was better for memory management and so now I do my best to point others in the right direction. The way I see it, there is no use in using a less effective alternative."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490200260, "post_id": 42956828, "comment_id": 73009549, "body": "Okay lets assume they are different as Doug states, doing an or on a negative will result in it returning true.  for example if the cell has <code>&quot;&quot;</code> then the vbnullstring will return true and vice versa, I think you want AND if they are truly different"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490200390, "post_id": 42956828, "comment_id": 73009638, "body": "No, you would want Or, assuming you want to skip either type. The whole thing is a useless argument as is given that SpecialCells(xlCellTypeConstants) wont return any null cells. It only returns cells with values. Additionally, any cells that did have data but were whitespace would also be skipped by the &quot;IsNumeric()&quot; statement."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490200964, "post_id": 42956828, "comment_id": 73010054, "body": "@BrandonBarney think about it Or returns true if either is true.  Lets change it to <code>A</code> and <code>B</code>, <code>If r.value&lt;&gt;&quot;A&quot; or r.value&lt;&gt;&quot;B&quot; then</code> would fire if the cell is A or B.  If <code>r.value</code> = A then the If would resolve to <code>If False or True then</code> which would be <code>True</code>, if we want to not do the If block when it does not equal either then we need and <code>If r.value&lt;&gt;&quot;A&quot; And r.value&lt;&gt;&quot;B&quot; then</code> which would resolve to in the previous example <code>If False And True then</code> which would return <code>False</code>.  But you are correct in this instance both will either resolve to true or false together so the Or/And is the same."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1490201143, "post_id": 42956828, "comment_id": 73010172, "body": "This got lively in my short absence. We&#39;ve put more effort into this than the OP has even bothered reviewing, which i find humorous."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490201162, "post_id": 42956828, "comment_id": 73010188, "body": "@ScottCraner I know the difference between Or and And, but in this case (assuming they are different) then AND would never evaluate to true. A cell value can&#39;t be two constant values. There are many applications for AND (of course), but in this case replacing the Or with AND would break the logic of the comparison (again, assuming that the two are different. In actuality, the comparison would work just fine since both statements would evaluate as true given that they both evaluate the same)."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490201236, "post_id": 42956828, "comment_id": 73010235, "body": "@DougCoats Agreed. Admittedly I only really spend the time on discussion in the comments in case anyone comes back to this thread in the future in hopes of solving a problem of their own. I know there were many times where I wouldn&#39;t have solved a particular task if someone hadnt provided the comment that ended up being the silver bullet."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490201648, "post_id": 42956828, "comment_id": 73010559, "body": "@ScottCraner Scratch my statement about using AND versus OR. For some reason, in all the confusion, I was thinking of checking for inequality on both sides and not the reverse. You are correct in that AND should be used since, if they were evaluated differently, it could present an issue if one was used over the other."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1490201833, "post_id": 42956828, "comment_id": 73010675, "body": "@BrandonBarney man, I was just about to post a picture proving my point and you had to ruin my moment by taking the higher road. :)"}, {"owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "edited": false, "score": 1, "creation_date": 1490201839, "post_id": 42956828, "comment_id": 73010676, "body": "OP here, I have actually been reading this exchange as I&#39;ve been testing both of the proposed solutions. The distinction between &#39;&quot;&quot;&#39; and &#39;vbNullString&#39; is certainly interesting. To my predicament though, it seems this solution does exactly what mine does without actually taking less time. I think I may just have to skip making this change. Thanks for trying!"}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "edited": false, "score": 0, "creation_date": 1490202145, "post_id": 42956828, "comment_id": 73010877, "body": "@WillClein You can see the other solution to see if it helps at all. Unfortunately, any time you are modifying values on the sheet directly you will see a performance decrease. My usual advice is to use an array if possible. You can load all the data into memory, modify them in memory, then overwrite. There may be other events that can be disables as well, but the performance cost will increase with the size of the data."}, {"owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1490202400, "post_id": 42956828, "comment_id": 73011022, "body": "@BrandonBarney Ultimately my ideal solution is to get our IT department to not have those fields be formatted as text when I&#39;m pulling reports from one of our SQL servers, but that&#39;s a low priority issue for them right now so I&#39;m having to take care of it myself in this manner."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "edited": false, "score": 0, "creation_date": 1490202994, "post_id": 42956828, "comment_id": 73011406, "body": "@WillClein Makes perfect sense. That&#39;s how I got started in VBA as well. We use so many different reports and I was tired of having to do legwork to make the reports useful (since they were designed for hundreds or more people to use, and not tailored for my use). Hopefully you can still get them to do it even though it is automated now :)."}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 0, "last_activity_date": 1490198226, "creation_date": 1490198226, "answer_id": 42956828, "question_id": 42956796, "link": "https://stackoverflow.com/questions/42956796/converting-numbers-stored-as-text-to-numbers-with-for-each-statement/42956828#42956828", "title": "Converting Numbers Stored as Text to Numbers with For Each Statement", "body": "<p>Well this is because your loop is literally going through every cell. Best to make some checks for blank values</p>\n\n<pre><code> IF r.Value &lt;&gt; \"\" or r.value &lt;&gt; vbnullstring then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "edited": false, "score": 1, "creation_date": 1490202225, "post_id": 42957223, "comment_id": 73010927, "body": "I tried it without putting Calculation to manual and disabling events, and it took just as long, but with the addition of those two, it now runs in about 30 secs which is light years better. Thanks for your help! Also, I kept the Debug.Print option. I don&#39;t typically use it, but this is for an end-user so giving them dialogs about issues is great advice."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "edited": false, "score": 1, "creation_date": 1490202311, "post_id": 42957223, "comment_id": 73010968, "body": "Glad to hear it! The calculation event is likely the main performance increase. Keep in mind though that your end user will likely never see the debug.print unless they are writing VBA as well. You can overcome this by using a messagebox, but your sheetnames are hard coded so this is less than ideal."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": true, "score": 1, "last_activity_date": 1490202036, "last_edit_date": 1490202036, "creation_date": 1490199257, "answer_id": 42957223, "question_id": 42956796, "link": "https://stackoverflow.com/questions/42956796/converting-numbers-stored-as-text-to-numbers-with-for-each-statement/42957223#42957223", "title": "Converting Numbers Stored as Text to Numbers with For Each Statement", "body": "<p>Try the code below. I used an index number instead of trying to loop through the array using a variant. I could be wrong, but I think For Each only works on collections. Someone please correct me if I am mistaken. (EDIT: I am indeed mistaken. For Each works just fine here.)</p>\n\n<p>In any event, index numbers on arrays is best practice.</p>\n\n<p>I also removed your Resume Next and properly handled it. I highly advise not using Resume Next. I cant think of any event that Resume Next can't be replaced by good logic. </p>\n\n<pre><code>Sub ConvertTextToNumber()\n    Application.ScreenUpdating = False\n\n    ' These two statements should further improve processing time.\n    ' The first prevents formulas from calculating. The second prevents\n    ' any background events from firing (mostly for Event triggered macros).\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n    Dim WshtNames As Variant\n    Dim i as Long\n    Dim r As Range\n\n    WshtNames = Array(\"Financial Data\", \"Site Data \", \"Org Data\", \"Program Data\")\n\n    ' When looping over an array use an index number.\n    ' I this case, 'i' will go from the lowest range of the array\n    ' all the way through to the highest range of the array.\n    For i = LBound(WshtNames) to Ubound(WshtNames)\n        'On Error Resume Next ' It is best to catch the errors, dont just skip them.\n        If Not Worksheets(WshtNames(i)) Is Nothing Then\n            For Each r In Worksheets(WshtNames(i)).UsedRange.SpecialCells(xlCellTypeConstants)\n                ' No need to check for an empty string here since\n                ' IsNumeric() will return false for non-numbers.\n                If IsNumeric(r) Then r.Value = Val(r.Value)\n            Next\n        Else\n            ' Put your error handling in here, or you can just skip it\n            ' I tend to use debug.print just to keep track.\n            Debug.Print WshtNames(i) &amp; \" doesn't exist.\"\n        End If\n    Next\n    Application.ScreenUpdating = True\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "is_accepted": false, "score": 1, "last_activity_date": 1490280793, "creation_date": 1490280793, "answer_id": 42979611, "question_id": 42956796, "link": "https://stackoverflow.com/questions/42956796/converting-numbers-stored-as-text-to-numbers-with-for-each-statement/42979611#42979611", "title": "Converting Numbers Stored as Text to Numbers with For Each Statement", "body": "<p>I initially used Brandon's answer, but upon his suggestion I looked into using an array to store the values and make changes in memory. Below is the updated code I am now using:</p>\n\n<pre><code>Sub ConvertTextToNumber()\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n    Dim WshtNames As Variant\n    Dim DataRange As Variant\n    Dim r As Range\n    Dim i As Long\n    Dim lrow As Long\n    Dim lcol As Integer\n    Dim MyVar\n\n    WshtNames = Array(\"Financial Data\", \"Site Data \", \"Org Data\", \"Program Data\")\n    DataRange = Range(\"A1:FZ6000\").Formula\n\n    For lrow = 1 To 6000\n        For lcol = 1 To 156\n        MyVar = DataRange(lrow, lcol)\n        If IsNumeric(MyVar) Then\n            MyVar = Val(MyVar)\n            DataRange(lrow, lcol) = MyVar\n        End If\n        Next lcol\n    Next lrow\n    Range(\"A1:FZ6000\").Formula = DataRange\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationAutomatic\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This works for me because I know that my sheets will never get beyond the ranges I've selected based on the nature of my data. This has effectively reduced my calculation time to ~2 secs. Thanks for everyone's input and happy coding!</p>\n"}], "owner": {"reputation": 79, "user_id": 7654922, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10210318182283419/picture?type=large", "display_name": "Will Clein", "link": "https://stackoverflow.com/users/7654922/will-clein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 42957223, "answer_count": 3, "score": 0, "last_activity_date": 1490280793, "creation_date": 1490198143, "last_edit_date": 1490280710, "question_id": 42956796, "link": "https://stackoverflow.com/questions/42956796/converting-numbers-stored-as-text-to-numbers-with-for-each-statement", "title": "Converting Numbers Stored as Text to Numbers with For Each Statement", "body": "<p>I'm trying to convert numbers that have been stored in text to numbers on multiple worksheets. My issue is that the code I've cobbled together seems to be taking an inordinate amount of time. I'm using a For Each statement that loops through the necessary worksheets and ranges. It doesn't crash Excel, it just keeps running seemingly forever.</p>\n\n<pre><code>Sub ConvertTextToNumber()\n    Application.ScreenUpdating = False\n    Dim WshtNames As Variant\n    Dim WshtNameCrnt As Variant\n    Dim r As Range\n\n    WshtNames = Array(\"Financial Data\", \"Site Data \", \"Org Data\", \"Program Data\")\n\n    For Each WshtNameCrnt In WshtNames\n    On Error Resume Next\n        For Each r In Worksheets(WshtNameCrnt).UsedRange.SpecialCells(xlCellTypeConstants)\n            If IsNumeric(r) Then r.Value = Val(r.Value)\n        Next\n    Next\n    Application.ScreenUpdating = False\nEnd Sub\n</code></pre>\n\n<p>When I stop the script from running and click Debug, it seems to be getting caught up at the first Next statement. I think that the method I'm using to convert the values is simply more time intensive than necessary, and thus running it on multiple sheets is even worse.</p>\n\n<p>I'm open to any and all suggestions to make this process run faster. Thanks in advance!</p>\n"}, {"tags": ["excel", "vba", "dictionary"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1490198552, "post_id": 42956707, "comment_id": 73008318, "body": "Dictionaries are case-sensitive -- could that be the problem? Also, note possible leading/trailing spaces, etc."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 2, "creation_date": 1490198576, "post_id": 42956707, "comment_id": 73008333, "body": "For debugging purposes you can create an array and set the array equal to Dictionary.Keys. This will show you all the keys within the dictionary. Same for Dictionary.Items. My best bet (assuming the dictionary is loading items in as expected) is that there is case sensitivity. The dictionary will look for exact match unless otherwise specified."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490198649, "post_id": 42956707, "comment_id": 73008387, "body": "@DavidZemens  The cases match, leading and trailing spaces are taken care of during the data import."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1490198688, "post_id": 42956707, "comment_id": 73008423, "body": "Step through your code line-by-line, using F8 in debug mode. This is probably something you need to identify on your own, as we don&#39;t have your data to test with."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1490198812, "post_id": 42956707, "comment_id": 73008504, "body": "What should I look for when I step through? Everything runs fine, just on that first &quot;If velocityLookup.Exists(conUD)&quot; always shoots back FALSE and so it skips the rest. This is my first time using dictionaries so I wasn&#39;t sure if there was something I might not know to check. (For example I didn&#39;t know it was case sensitive)."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490198865, "post_id": 42956707, "comment_id": 73008540, "body": "When you get to that line (set a breakpoint on that line), examine the contents of your dictionary, and the value of your key/lookup in the Locals window of the VBE."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1490199075, "post_id": 42956707, "comment_id": 73008715, "body": "What&#39;s the best way to &#39;examine the contents of your dictionary&#39; by doing a Debug.Print?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1490199291, "post_id": 42956707, "comment_id": 73008865, "body": "You can view the first 255 <i>keys</i> in the Locals window of the VBE. If you need to see more than that, then I think as Brandon mentions, declare a variant like <code>Dim dictVals</code> and then do <code>dictVals = velocityLookup.Keys()</code>, and you&#39;ll be able to see each of those in the Locals pane. Can do the same with the <code>.Items</code> if needed."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 3, "creation_date": 1490199344, "post_id": 42956707, "comment_id": 73008901, "body": "To bring up the Locals window in the VBE it&#39;s under View &gt; Locals Window. If you&#39;re not also using the <i>Immediate</i> pane (you can enter simple statements and queries here), you can activate that from View menu as well."}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "edited": false, "score": 0, "creation_date": 1490199568, "post_id": 42956707, "comment_id": 73009065, "body": "Thanks. I hadn&#39;t activated either of those. I don&#39;t see velocityLookup in the Locals window. That is probably the problem."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490199653, "post_id": 42956707, "comment_id": 73009127, "body": "Can you screenshot what you do see in Locals?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1490199681, "post_id": 42956707, "comment_id": 73009137, "body": "velocityLookup is a module-level variable, so it might be nested under something like <code>Module1</code>, or is this a sheet/userform module?"}, {"owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1490199782, "post_id": 42956707, "comment_id": 73009215, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/138751/discussion-between-emily-alden-and-david-zemens\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 3, "last_activity_date": 1490200506, "creation_date": 1490200506, "answer_id": 42957657, "question_id": 42956707, "link": "https://stackoverflow.com/questions/42956707/dictionary-exists-always-false/42957657#42957657", "title": "Dictionary.Exists Always False", "body": "<p>From chat we identified a capitalization error. You can avoid these (assuming they are false errors) by forcing a consistent case (either using <code>LCASE</code> or <code>UCASE</code> functions, a matter of personal preference just be consistent throughout!). </p>\n\n<p>You can also make your dictionary case-insensitive at instantiation:</p>\n\n<pre><code>Set lookup = New Scripting.Dictionary\nlookup.CompareMode = 1 'TextCompare\n</code></pre>\n\n<p>You have to do this prior to adding any items, though.</p>\n\n<p>One thing you <em>might</em> also consider, not sure about the use-case here, is to wrap your <code>BuildVelocityLookup</code> procedure with some logic to avoid re-writing the dictionary every time the <code>Click</code> event fires.</p>\n\n<pre><code>Sub BuildVelocityLookup(target As Worksheet, keyCol As Long, lookup As Scripting.Dictionary)\n    If Not lookup Is Nothing Then Exit Sub '## Get out of here if the dict is already instantiated\n    Set lookup = New Scripting.Dictionary\n    With target\n        Dim lastRow As Long\n        lastRow = .Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n        Dim keys As Variant\n        keys = .Range(.Cells(2, keyCol), .Cells(lastRow, keyCol)).Value\n        Dim j As Long\n        For j = LBound(keys) To UBound(keys)\n            'Note that the row is offset from the array.\n            lookup.Add keys(j, 1), j + 1\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>And also, since the entire purpose of <code>BuildVelocityLookup</code> is to merely instantiate your dictionary, you might consider changing it to a <code>Function</code>, which would be more standard use.</p>\n\n<p>In general: <em>function</em> return values to objects/variables, whereas <em>subroutines</em> perform some action(s), modifying objects, environment, etc.  Passing objects <code>ByRef</code> allows a <code>Sub</code> to behave like a <code>Function</code>, but unless you have a specific reason for designing it this way, a Function is probably better:</p>\n\n<pre><code>Function BuildVelocityLookup(target As Worksheet, keyCol As Long) As Scripting.Dictionary\n    Dim lookup as New Scripting.Dictionary\n    With target\n        Dim lastRow As Long\n        lastRow = .Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n        Dim keys As Variant\n        keys = .Range(.Cells(2, keyCol), .Cells(lastRow, keyCol)).Value\n        Dim j As Long\n        For j = LBound(keys) To UBound(keys)\n            'Note that the row is offset from the array.\n            lookup.Add keys(j, 1), j + 1\n        Next\n    End With\n    Set BuildVelocityLookup = lookup\nEnd Sub\n</code></pre>\n\n<p>And then call it like (omit the <code>If</code> condition if you don't mind re-writing the dict every time user clicks):</p>\n\n<pre><code>If velocityLookup Is Nothing Then\n    Set velocityLookup = BuildVelocityLookup(wsVelocity, Velocity_Key_Col)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11538979, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rO4UWDJlerI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rftwOw0qGXd623Cq_6qg_0_7ysjlA/mo/photo.jpg?sz=128", "display_name": "ismail", "link": "https://stackoverflow.com/users/11538979/ismail"}, "is_accepted": false, "score": 0, "last_activity_date": 1590566159, "creation_date": 1590566159, "answer_id": 62038082, "question_id": 42956707, "link": "https://stackoverflow.com/questions/42956707/dictionary-exists-always-false/62038082#62038082", "title": "Dictionary.Exists Always False", "body": "<p>For anyone else still stuck on this error, i had been running into a similar issue but the cause was that i was adding a Range object to my dictionary rather than the Range.Value property.</p>\n\n<p>e.g. </p>\n\n<pre><code>For Each part In Selection\n    dict.Add part, part.Address\nNext part\n\n'this returns false\nDebug.Print dict.Exists(\"some text in range\")\n</code></pre>\n\n<p>but if i add the value property it works as expected:</p>\n\n<pre><code>For Each part In Selection\n    Debug.Print part\n    dict.Add part.Value, part.Address\nNext part\n\n'this returns true\nDebug.Print dict.Exists(\"some text in range\")\n</code></pre>\n"}], "owner": {"reputation": 605, "user_id": 6510724, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b03c3a176706015b1868a736981c4bb8?s=128&d=identicon&r=PG&f=1", "display_name": "Emily Alden", "link": "https://stackoverflow.com/users/6510724/emily-alden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1290, "favorite_count": 0, "accepted_answer_id": 42957657, "answer_count": 2, "score": 5, "last_activity_date": 1594192386, "creation_date": 1490197938, "last_edit_date": 1594192386, "question_id": 42956707, "link": "https://stackoverflow.com/questions/42956707/dictionary-exists-always-false", "title": "Dictionary.Exists Always False", "body": "<p>I cannot for the life of my figure out why my dictionary is always returning false. </p>\n\n<p>Notes: </p>\n\n<ul>\n<li>I Debug.Printed the BuildVelocityLookup at lookup.Add and it is reading in the whole range.</li>\n<li>I Debug.Printed conUD and it is also holding the proper value.</li>\n<li>The conUD value exists in the 10th column of velocity. </li>\n<li>Values are strings, alpha numeric with no special characters. </li>\n<li>Values are unique, there are no duplicate values in the Scripting.Dictionary. </li>\n</ul>\n\n<p>Any/All Help is greatly appreciated. </p>\n\n<p>Top of Module: </p>\n\n<pre><code>Dim velocityLookup As Scripting.Dictionary\nConst Velocity_Key_Col As Long = 10\nOption Explicit\n</code></pre>\n\n<p>Build Dictionary Code: </p>\n\n<pre><code>Sub BuildVelocityLookup(target As Worksheet, keyCol As Long, lookup As Scripting.Dictionary)\n    Set lookup = New Scripting.Dictionary\n    With target\n        Dim lastRow As Long\n        lastRow = .Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n        Dim keys As Variant\n        keys = .Range(.Cells(2, keyCol), .Cells(lastRow, keyCol)).Value\n        Dim j As Long\n        For j = LBound(keys) To UBound(keys)\n            'Note that the row is offset from the array.\n            lookup.Add keys(j, 1), j + 1\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>Main Code: See 'xxxxxxxxxx Line for first call on dictionary. </p>\n\n<pre><code>Sub Calculate_Click()\n\n'******************* Insert a line to freeze screen here.\n\n    Dim wsMain As Worksheet\n    Dim wsQuantity As Worksheet\n    Dim wsVelocity As Worksheet\n    Dim wsParameters As Worksheet\n    Dim wsData As Worksheet\n    Dim lrMain As Long 'lr = last row\n    Dim lrQuantity As Long\n    Dim lrVelocity As Long\n    Dim lrParameters As Long\n    Dim lrData As Long\n    Dim i As Long 'Row Counter\n\n    'For Optimization Testing Only.\n    Dim MainTimer As Double\n    MainTimer = Timer\n\n    Set wsMain = Worksheets(\"Main Tab\")\n    Set wsQuantity = Worksheets(\"Quantity Available\")\n    Set wsVelocity = Worksheets(\"Velocity\")\n    Set wsParameters = Worksheets(\"Parameters\")\n    Set wsData = Worksheets(\"Data Input by Account\")\n\n    lrMain = wsMain.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n    lrQuantity = wsQuantity.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n    lrVelocity = wsVelocity.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n    lrParameters = wsParameters.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n    lrData = wsData.Cells.Find(What:=\"*\", SearchOrder:=xlByRows, Searchdirection:=xlPrevious).Row\n\n    Dim calcWeek As Long\n    calcWeek = wsParameters.Range(\"B3\").Value\n\n    For i = 2 To 5 'lrQuantity\n        With wsQuantity\n            .Cells(i, 5) = .Cells(i, 1) &amp; .Cells(i, 2)\n            .Cells(i, 6) = .Cells(i, 1) &amp; UCase(.Cells(i, 2).Value) &amp; .Cells(i, 3)\n        End With\n    Next i\n\n    wsData.Range(wsData.Cells(2, 1), wsData.Cells(lrData, 4)).Sort _\n    key1:=wsData.Range(\"A2\"), order1:=xlAscending, Header:=xlNo\n\n    Dim tempLookup As Variant\n    For i = 2 To 5 'lrData\n        tempLookup = Application.VLookup(wsData.Cells(i, 2), wsParameters.Range(\"Table5\"), 2, False)\n        If IsError(tempLookup) Then\n            wsData.Cells(i, 3).Value = \"Missing\"\n        Else\n            wsData.Cells(i, 3).Value = tempLookup\n        End If\n    Next i\n\n    For i = 2 To 5 'lrVelocity\n        With wsVelocity\n            .Cells(i, 10) = .Cells(i, 1) &amp; .Cells(i, 4) &amp; .Cells(i, 5) &amp; .Cells(i, 9)\n            .Cells(i, 10).Value = CStr(Trim(.Cells(i, 10).Value))\n            .Cells(i, 11) = .Cells(i, 6)\n            .Cells(i, 12) = .Cells(i, 7)\n            .Cells(i, 13) = .Cells(i, 8)\n            .Cells(i, 14) = .Cells(i, 3)\n            .Cells(i, 22) = .Cells(i, 1) &amp; .Cells(i, 9)\n        End With\n    Next i\n\n    wsVelocity.Range(wsVelocity.Cells(2, 1), wsVelocity.Cells(lrVelocity, 10)).Sort _\n    key1:=wsVelocity.Range(\"J2\"), order1:=xlAscending, Header:=xlNo\n\n    BuildVelocityLookup wsVelocity, Velocity_Key_Col, velocityLookup\n\n    Dim indexVelocity1 As Range\n    Dim indexVelocity2 As Range\n    Dim matchVelocity1 As Range\n    Dim matchVelocity2 As Range\n\n    With wsVelocity\n        Set indexVelocity1 = .Range(.Cells(2, 7), .Cells(lrVelocity, 7))\n        Set indexVelocity2 = .Range(.Cells(2, 3), .Cells(lrVelocity, 3))\n        Set matchVelocity1 = .Range(.Cells(2, 1), .Cells(lrVelocity, 1))\n        Set matchVelocity2 = .Range(.Cells(2, 22), .Cells(lrVelocity, 22))\n    End With\n\n    Dim indexQuantity As Range\n    Dim matchQuantity As Range\n    With wsQuantity\n        Set indexQuantity = .Range(.Cells(2, 4), .Cells(lrQuantity, 4))\n        Set matchQuantity = .Range(.Cells(2, 6), .Cells(lrQuantity, 6))\n    End With\n\n    Dim ShipMin As Long\n    ShipMin = wsParameters.Cells(7, 2).Value\n\n    wsMain.Activate\n    With wsMain\n        .Range(.Cells(2, 9), .Cells(lrMain, 20)).ClearContents\n        .Range(.Cells(2, 22), .Cells(lrMain, 47)).ClearContents\n    End With\n\n    For i = 2 To lrMain\n        With wsMain\n            Dim conUD As String 'con=concatenate\n            conUD = .Cells(i, 21) &amp; .Cells(i, 4) &amp; calcWeek\n            Debug.Print conUD\n\n            .Cells(i, 21) = .Cells(i, 5) &amp; .Cells(i, 3)\n\n            If .Cells(i, 8) &lt;&gt; 0 Then\n                .Cells(i, 9) = .Cells(i, 6) / .Cells(i, 8)\n            End If\n 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n            Dim velocityRow As Long\n            If velocityLookup.Exists(conUD) Then\n                velocityRow = velocityLookup.Item(conUD)\n                tempLookup = wsVelocity.Cells(velocityRow, 11)\n            End If\n            .Cells(i, 10).Value = tempLookup\n\n            tempLookup = wsVelocity.Cells(velocityRow, 14)\n            .Cells(i, 11).Value = tempLookup\n\n            If .Cells(i, 9) &gt; .Cells(i, 11) Then\n                .Cells(i, 12).Value = Round((.Cells(i, 6) / .Cells(i, 11)) / .Cells(i, 10), 0.1)\n            End If\n\n            If .Cells(i, 6) &gt; 0 Then\n                If .Cells(i, 12) &lt;&gt; \"\" Then\n                    .Cells(i, 13).Value = .Cells(i, 12) - .Cells(i, 8)\n                End If\n            End If\n\n            Dim conECD As String\n            conECD = .Cells(i, 5) &amp; .Cells(i, 3) &amp; .Cells(i, 4) &amp; calcWeek\n            If velocityLookup.Exists(conECD) Then\n            velocityRow = velocityLookup.Item(conECD)\n            tempLookup = wsVelocity.Cells(velocityRow, 12)\n            End If\n\n            If .Cells(i, 13) &lt;&gt; \"\" Then\n                If tempLookup &lt;&gt; 0 Then\n                    .Cells(i, 14).Value = Int(.Cells(i, 13) / tempLookup)\n                End If\n            End If\n\n            If velocityLookup.Exists(conECD) Then\n                velocityRow = velocityLookup.Item(conECD)\n                tempLookup = wsVelocity.Cells(velocityRow, 13)\n            End If\n            If .Cells(i, 14) &gt; tempLookup Then\n                If .Cells(i, 14) &lt;&gt; \"\" Then\n                    .Cells(i, 15).Value = tempLookup\n                End If\n            Else\n                .Cells(i, 15).Value = .Cells(i, 14).Value\n            End If\n\n            If .Cells(i, 14) = \"\" Then\n                If .Cells(i, 11) = \"\" Then\n                    .Cells(i, 26) = \"\"\n                Else\n                    .Cells(i, 26).Value = Round(.Cells(i, 14).Value * .Cells(i, 11).Value, 0)\n                End If\n            End If\n\n            tempLookup = Application.Index(indexQuantity, Application.Match((.Cells(i, 21).Value &amp; \"LIBERTY\") _\n                , matchQuantity, False))\n            .Cells(i, 24).Value = tempLookup\n\n            .Cells(i, 18).Value = .Cells(i, 24) - Application.SumIf(.Range(.Cells(1, 21), .Cells(i, 21)), _\n                .Cells(i, 21).Value, .Range(.Cells(1, 26), .Cells(i, 26)))\n\n            If velocityLookup.Exists(conUD) Then\n                velocityRow = velocityLookup.Item(conUD)\n                tempLookup = wsVelocity.Cells(velocityRow, 13)\n            End If\n            If .Cells(i, 26) &gt; tempLookup Then\n                .Cells(i, 28).Value = tempLookup\n            Else\n                .Cells(i, 28).Value = .Cells(i, 26).Value\n            End If\n\n            If .Cells(i, 18).Value &lt; 0 Then\n                .Cells(i, 29).Value = \"C\"\n                .Cells(i, 27).Value = \"\"\n            Else\n                .Cells(i, 27) = .Cells(i, 28)\n            End If\n\n        .Cells(i, 31).Value = Application.SumIf(.Range(.Cells(2, 1), .Cells(lrMain, 1)), _\n            .Cells(i, 1).Value, .Range(.Cells(2, 27), .Cells(lrMain, 27)))\n\n            If .Cells(i, 5) = \"\" Then\n                .Cells(i, 35) = \"\"\n            Else\n                .Cells(i, 35).Value = Application.Index(indexVelocity1, _\n                Application.Match(.Cells(i, 5), matchVelocity1, False))\n            End If\n\n            If .Cells(i, 6).Value = 0 Then\n                .Cells(i, 44).Value = 0\n            Else\n                .Cells(i, 44).Value = Round(((((.Cells(i, 6).Value / .Cells(i, 11).Value) _\n                    / .Cells(i, 10).Value) - .Cells(i, 8).Value) / .Cells(i, 35).Value), 0.1)\n            End If\n\n            If .Cells(i, 6).Value = 0 Then\n                .Cells(i, 34).Value = 0\n                .Cells(i, 33) = 0\n            Else\n                .Cells(i, 34).Value = Round(((((.Cells(i, 6) / .Cells(i, 11)) / _\n                .Cells(i, 10)) - .Cells(i, 8)) / .Cells(i, 35)) * .Cells(i, 11), 0.1)\n                If .Cells(i, 34) &gt; 0 Then\n                    .Cells(i, 33) = .Cells(i, 34)\n                Else\n                    .Cells(i, 33) = 0\n                End If\n            End If\n\n            .Cells(i, 37) = 1 + calcWeek\n            .Cells(i, 38) = .Cells(i, 5) &amp; .Cells(i, 37)\n            .Cells(i, 39).Value = Application.Index(indexVelocity2, _\n                Application.Match(.Cells(i, 38), matchVelocity2, False))\n            .Cells(i, 40) = Round(((((.Cells(i, 6) / .Cells(i, 11)) * .Cells(i, 39)) _\n                - .Cells(i, 6)) - (.Cells(i, 8) - .Cells(i, 6))) / .Cells(i, 35), 0.1)\n\n            If .Cells(i, 40) &lt; 0 Then\n                .Cells(i, 41) = 0\n            Else\n                .Cells(i, 41) = .Cells(i, 40)\n            End If\n\n            .Cells(i, 42) = .Cells(i, 41) - .Cells(i, 33)\n\n            If .Cells(i, 11) &lt; .Cells(1, 44) Then\n                .Cells(i, 45) = 0\n                .Cells(i, 32) = .Cells(i, 45)\n            Else\n                .Cells(i, 32) = Application.Max(.Cells(i, 33), .Cells(i, 41))\n                If .Cells(i, 44) &lt; 0 Then\n                    .Cells(i, 45) = \"\"\n                Else\n                    .Cells(i, 45) = .Cells(i, 44)\n                End If\n            End If\n\n            If .Cells(i, 31) &lt; ShipMin Then\n                .Cells(i, 47) = 0\n            Else\n                .Cells(i, 47) = .Cells(i, 27)\n            End If\n\n            .Cells(i, 46) = .Cells(i, 1) &amp; .Cells(i, 22) &amp; .Cells(i, 47)\n\n\n        End With\n\n        If (i Mod 100) = 0 Then\n            Debug.Print \"Got to row \"; i; \" in \"; Timer - MainTimer; \" seconds.\"\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1490198291, "post_id": 42956667, "comment_id": 73008113, "body": "Can you post what your data looks like now, and an example of desired outcome."}, {"owner": {"reputation": 79, "user_id": 5839516, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87c2ae439003dc226cb846ff985323f4?s=128&d=identicon&r=PG&f=1", "display_name": "Le Coder", "link": "https://stackoverflow.com/users/5839516/le-coder"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1490200189, "post_id": 42956667, "comment_id": 73009496, "body": "added picture. I also wish excel to advise me the number of palets that would be required"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490200489, "post_id": 42956667, "comment_id": 73009701, "body": "You would need to also know the max per pallet, in your third line, how is Excel to know you want 100,100,92 and not 98,98,96"}, {"owner": {"reputation": 79, "user_id": 5839516, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87c2ae439003dc226cb846ff985323f4?s=128&d=identicon&r=PG&f=1", "display_name": "Le Coder", "link": "https://stackoverflow.com/users/5839516/le-coder"}, "edited": false, "score": 0, "creation_date": 1490200717, "post_id": 42956667, "comment_id": 73009876, "body": "true. If I add the max size of a palet, how can I implement it then?"}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5839516, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87c2ae439003dc226cb846ff985323f4?s=128&d=identicon&r=PG&f=1", "display_name": "Le Coder", "link": "https://stackoverflow.com/users/5839516/le-coder"}, "edited": false, "score": 0, "creation_date": 1490200940, "post_id": 42957635, "comment_id": 73010035, "body": "This helps, but as @Scott said, I need to distribute it. based on a criteria. Thank you!"}, {"owner": {"reputation": 79, "user_id": 5839516, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87c2ae439003dc226cb846ff985323f4?s=128&d=identicon&r=PG&f=1", "display_name": "Le Coder", "link": "https://stackoverflow.com/users/5839516/le-coder"}, "edited": false, "score": 0, "creation_date": 1490201815, "post_id": 42957635, "comment_id": 73010661, "body": "pallet can be max 100. Or I dont understand what do you mean by specify even more?"}, {"owner": {"reputation": 250, "user_id": 3884538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AN4kC.png?s=128&g=1", "display_name": "Mike Powell", "link": "https://stackoverflow.com/users/3884538/mike-powell"}, "edited": false, "score": 0, "creation_date": 1490202378, "post_id": 42957635, "comment_id": 73011004, "body": "What should happen if you only had 2 pallets in the above example (i.e. more packets that the number of available pallets)?"}], "tags": [], "owner": {"reputation": 250, "user_id": 3884538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AN4kC.png?s=128&g=1", "display_name": "Mike Powell", "link": "https://stackoverflow.com/users/3884538/mike-powell"}, "is_accepted": false, "score": 3, "last_activity_date": 1490201075, "last_edit_date": 1490201075, "creation_date": 1490200459, "answer_id": 42957635, "question_id": 42956667, "link": "https://stackoverflow.com/questions/42956667/excel-distribute-value/42957635#42957635", "title": "Excel distribute value", "body": "<p>Hope this helps .... formulas are below each cell </p>\n\n<p><a href=\"https://i.stack.imgur.com/scMtk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/scMtk.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1490202809, "creation_date": 1490202809, "answer_id": 42958419, "question_id": 42956667, "link": "https://stackoverflow.com/questions/42956667/excel-distribute-value/42958419#42958419", "title": "Excel distribute value", "body": "<p>To get the number of pallets needed Use this formula, put in B3 and copy down:</p>\n\n<pre><code>=ROUNDUP(A3/($B$1*$D$1),0)\n</code></pre>\n\n<p>Then to get the disbursement table, in C3:</p>\n\n<pre><code>=IF(COLUMN(A:A)&lt;$B3,$D$1,IF(COLUMN(A:A)=$B3,($A3/$B$1)-(COLUMN(A:A)-1)*$D$1,\"\"))\n</code></pre>\n\n<p>Then copy drag over and down</p>\n\n<p><a href=\"https://i.stack.imgur.com/F91hl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F91hl.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 79, "user_id": 5839516, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87c2ae439003dc226cb846ff985323f4?s=128&d=identicon&r=PG&f=1", "display_name": "Le Coder", "link": "https://stackoverflow.com/users/5839516/le-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 42958419, "answer_count": 2, "score": 0, "last_activity_date": 1490202809, "creation_date": 1490197871, "last_edit_date": 1592644375, "question_id": 42956667, "link": "https://stackoverflow.com/questions/42956667/excel-distribute-value", "title": "Excel distribute value", "body": "<p>I would like to divide a number X into possibly N equal values. I explain it in the following scenario. Let's say I have 8000 copies of newspaper and they are wrapped by N (lets say 20, and this can vary). So now I have 400 packets each containing 20 paper. Assume I have X pallets. I want to distribute the 400 packets equally between the pallets where possible. Because sometimes there are more/less paletts I cannot do it with a simple divison function, in excel. Can anyone help?</p>\n<p><a href=\"https://i.stack.imgur.com/QNC08.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QNC08.jpg\" alt=\"enter image description here\" /></a></p>\n"}, {"tags": ["excel", "vba", "interpolation", "series"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1490198229, "post_id": 42956447, "comment_id": 73008078, "body": "Let me guess - you enter an endless loop on the first row that you work with? That is because of this -  <code>Set rng = .Cells(8, 4).End(xlToRight)</code> Probably instead you should set the <code>rng</code> to the next row.  <code>Set rng = .Cells(rng.row+2, 4)</code> or something similar."}, {"owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1490262127, "post_id": 42956447, "comment_id": 73036835, "body": "I made the change you suggested, and it no longer runs infinitely, however zeros each row whereas I want it to interpolate between points."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1490262277, "post_id": 42956447, "comment_id": 73036948, "body": "Then start using F8 and debug to see what is going wrong. :) And compare with the idea of Microsoft - <a href=\"https://support.microsoft.com/en-us/help/214096/method-to-calculate-interpolation-step-value-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/214096/&hellip;</a>"}, {"owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1490282200, "post_id": 42956447, "comment_id": 73052175, "body": "I couldn&#39;t get that way to work, so I ended up creating a macro that found the data point column positions and using the equation of the line, calculated the value for each cell inbetween. It runs quick enough so I&#39;m happy with that solution and it gives me more parameters to play around with. Thank you for your help though!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1490282795, "post_id": 42956447, "comment_id": 73052703, "body": "Welcome :) The idea of F8 is that it goes step by step, thus it is easy to debug and to understand what is happening."}], "owner": {"reputation": 55, "user_id": 5159982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/94a441744ea8d627e117cc77470d6ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Gurdeep", "link": "https://stackoverflow.com/users/5159982/gurdeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 241, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490197822, "creation_date": 1490197422, "last_edit_date": 1490197822, "question_id": 42956447, "link": "https://stackoverflow.com/questions/42956447/data-interpolation-using-range-dataseries-vba", "title": "Data interpolation using Range.DataSeries [VBA]", "body": "<p>I have some date based data that I'm trying to interpolate between (horizontally). See image below, I found some code on a similar answer however when I've adapted it, it isn't interpolating. I also have start and end points for each row which are equal to 0. e.g. Row 3, Sept 15.</p>\n\n<p>Where am I going wrong with this?</p>\n\n<pre><code>Sub interpolateData()\nDim rng As Range\n\nWith Sheets(\"Timeline\")\n\n    Set rng = .Cells(8, 4)\n    Do While CBool(Application.CountIf(.Rows(8), 0))\n        With .Range(rng, rng.End(xlToRight))\n                .DataSeries rowCol:=xlRows, Type:=xlLinear, _\n                    Step:=(.Cells(.Cells.Count).Value2 - .Cells(1).Value2) / (.Columns.Count - 1)\n        End With\n        Set rng = .Cells(8, 4).End(xlToRight)\n    Loop\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/tBKMG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tBKMG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 4, "creation_date": 1490197375, "post_id": 42956374, "comment_id": 73007443, "body": "Remove the <code>For Each</code> loop and add <code>set sht = ActiveWorkbook.Sheets(&quot;Refined1&quot;)</code>."}, {"owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1490197418, "post_id": 42956374, "comment_id": 73007476, "body": "@PeterT - Ok I will try this , thank you !"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1490197886, "post_id": 42956374, "comment_id": 73007835, "body": "One would think <code>&#39;Loop through each worksheet in ActiveWorkbook</code> is clear enough..."}, {"owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1490211149, "post_id": 42956374, "comment_id": 73016283, "body": "@PeterT  - Why is it <code>&quot;Refined1&quot;</code> and not just <code>&quot;Refined&quot;</code> ?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1490211275, "post_id": 42956374, "comment_id": 73016370, "body": "I picked off &#39;Refined1&#39; from the bottom of the OP. It could be either way, but should match his worksheet name."}], "answers": [{"tags": [], "owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "is_accepted": true, "score": 3, "last_activity_date": 1490197493, "creation_date": 1490197493, "answer_id": 42956492, "question_id": 42956374, "link": "https://stackoverflow.com/questions/42956374/in-vba-for-excel-how-do-i-limit-the-following-code-to-only-run-in-one-single-ta/42956492#42956492", "title": "In VBA for Excel, how do I limit the following code to only run in one single Tab?", "body": "<p>Replace:</p>\n\n<pre><code>'Loop through each item in Array lists\nFor x = LBound(fndList) To UBound(fndList)\n\n    'Loop through each worksheet in ActiveWorkbook\n    For Each sht In ActiveWorkbook.Worksheets '&lt;-- This line is looping through worksheets\n        sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n        SearchFormat:=False, ReplaceFormat:=False\n    Next sht\n\nNext x\n</code></pre>\n\n<p>With this:</p>\n\n<pre><code>Set sht = ActiveWorkbook.Sheets(\"Refined1\")\n\n'Loop through each item in Array lists\nFor x = LBound(fndList) To UBound(fndList)\n\n    sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n    LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n    SearchFormat:=False, ReplaceFormat:=False\n\nNext x\n</code></pre>\n"}], "owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 42956492, "answer_count": 1, "score": -1, "last_activity_date": 1594030349, "creation_date": 1490197235, "last_edit_date": 1594030349, "question_id": 42956374, "link": "https://stackoverflow.com/questions/42956374/in-vba-for-excel-how-do-i-limit-the-following-code-to-only-run-in-one-single-ta", "title": "In VBA for Excel, how do I limit the following code to only run in one single Tab?", "body": "<p>I am working with the following Excel VBA script :</p>\n<pre><code>Sub Multi_FindReplace()\n'PURPOSE: Find &amp; Replace a list of text/values throughout entire workbook\n'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\nDim sht As Worksheet\nDim fndList As Variant\nDim rplcList As Variant\nDim x As Long\n\nfndList = Array(&quot;Mostly satisfied&quot;, &quot;Completely satisfied&quot;, &quot;N/A&quot;, &quot;Not at all satisfied&quot;)\nrplcList = Array(&quot;Satisfied&quot;, &quot;Satisfied&quot;, &quot;Satisfied&quot;, &quot;Not satisfied&quot;)\n\n\n'Loop through each item in Array lists\n  For x = LBound(fndList) To UBound(fndList)\n    'Loop through each worksheet in ActiveWorkbook\n      For Each sht In ActiveWorkbook.Worksheets\n        sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n          LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n          SearchFormat:=False, ReplaceFormat:=False\n      Next sht\n  \n  Next x\n\nEnd Sub\n</code></pre>\n<p>But the issue is that it is operating on all 3 tabs of my worksheet, when I only want it to work on one single tab - called &quot;Refined&quot; .</p>\n<p>How do I change the code so that it will only loop on the &quot;Refined &quot; Tab ?</p>\n<p>Do I need to remove the line <code>Dim sht As Worksheet</code> and make it to :</p>\n<p><code>Dim sht as &quot;Refined1&quot;</code> ?</p>\n"}, {"tags": ["vba", "excel", "conditional-formatting"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 1, "creation_date": 1490197831, "post_id": 42956349, "comment_id": 73007779, "body": "AFAIK there is not VBA code to check if a cell has conditional formatting applied to it. Hence, you have to try to get it and use at the same time <code>On Error Resume Next</code> to circumvent this shortcoming. Similarly, there is no way to determine how many conditional formats are currently in place for any given cell. Once again, you&#39;ll have to <b>try</b> to grab them an use <code>On Error Resume Next</code>. In short: I agree with @Jeeped and the best way is to delete them and redo them rather than trying to write some indirect code with horrible coding practices to overcome VBA&#39;s shortcomings in that respect."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1490197892, "post_id": 42956349, "comment_id": 73007836, "body": "Where is your list of changes? e.g. original color, new color, etc"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490199117, "post_id": 42956349, "comment_id": 73008745, "body": "I spoke out of turn in an earlier comment. You cannot change the <code>Formula1</code> parameter of a CFR but you can adjust the color without destroying and reconstructing it. See below. (@Ralph)"}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "edited": false, "score": 0, "creation_date": 1490205309, "post_id": 42957143, "comment_id": 73012862, "body": "Thanks guys.  Jeeped:  The code example appears to be what I want to do.  I just need to adjust a color programmatically in all it&#39;s instances.  From one to another.  It&#39;s the text color in some cases so what does .Interior change to?"}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "edited": false, "score": 0, "creation_date": 1490205557, "post_id": 42957143, "comment_id": 73013029, "body": "Does the code (Sub wqwqty()) change only the display condition?  I mean:  If I have a condition that results in green text and green interior, and another condition that is red text.  I set up and run the code to change formatconditions of green text to white text.   I have a cell that&#39;s condition makes it&#39;s text red.  After I run the code, that cell&#39;s value changes making it fit the green condition.  Is that cell going to change to the desired green fill with white text or back to the original green on green.  Hopefulyl I worded that clear enough."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490210035, "post_id": 42957143, "comment_id": 73015679, "body": "I hope I don&#39;t get banned from this site for giving you too many votes per day / week. I heard that one provokes that sort of action when one user push the reputation of another user on this site too much. But then again.. it is not my fault that almost all of your answers are good and worth voting for. Is it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "edited": false, "score": 0, "creation_date": 1490215259, "post_id": 42957143, "comment_id": 73018583, "body": "@shorton - <code>.Interior</code> would be changed to <code>.Font</code> if you are changing the font color and not the background color. You would need to stack two Select ... Case statements one after the other&#39;s End Select. One would be for <code>Interior</code> the other for <code>.Font</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1490215621, "post_id": 42957143, "comment_id": 73018782, "body": "@Ralph - I don&#39;t think it will be too long before the SO vote-count algorithm develops sentience and takes over the whole operation in which case we are all doomed anyway. :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1490199028, "creation_date": 1490199028, "answer_id": 42957143, "question_id": 42956349, "link": "https://stackoverflow.com/questions/42956349/edit-existing-conditional-formats-with-code/42957143#42957143", "title": "Edit Existing Conditional Formats with Code", "body": "<p>If all you want to do is modify the Fill color, cycle through all of the <code>.FormatConditions</code> on the worksheet and use a <code>Select ... Case</code> to modify the color ordinal.</p>\n\n<pre><code>Option Explicit\n\nSub wqwqty()\n    Dim cfr As Long\n    With Worksheets(\"Sheet1\").Cells\n        For cfr = 1 To .FormatConditions.Count\n            With .FormatConditions(cfr).Interior\n                Debug.Print .Color\n                Select Case .Color\n                    Case 255                'dark red\n                        .Color = 192        'light red\n                    Case 192                'dark red\n                        .Color = 255        'light red\n                    Case 5287936            'dark green\n                        .Color = 5296274    'light green\n                    Case 12611584           'dark blue\n                        .Color = 15773696   'light blue\n                    Case 49407              'orange\n                        .Color = 65535      'yellow\n                End Select\n                Debug.Print .Color\n            End With\n        Next cfr\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1618, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490199263, "creation_date": 1490197169, "last_edit_date": 1490199263, "question_id": 42956349, "link": "https://stackoverflow.com/questions/42956349/edit-existing-conditional-formats-with-code", "title": "Edit Existing Conditional Formats with Code", "body": "<p>(Excel 2016) I have several large spreadsheets with existing conditional formatting.  On any particular sheet I have several tables each with it's own set of conditional formatting.  The tables change in size so the ranges vary.  And there are lots of them (100's).  The same rules apply to each set, that is, the conditional formatting I want to edit is consistent, with the same \"set\" of 4 formats that apply to each range/table (e.g. Red/Yellow/Green/Blue).</p>\n\n<p>I'm trying to figure out how to edit a color value in the existing formatting.  For example change a text color that is currently green, to light green.  Right now I have to manually edit hundreds of formula entries.</p>\n\n<p>I've seen lots of examples on applying conditional formatting via VBA, but I don't see how I can step through these tables and edit the existing formats, without changing their order or precedence.</p>\n"}, {"tags": ["vba", "excel", "average", "missing-data"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 1132458, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2eb4bf134b0497b2ce1e597dfe757168?s=128&d=identicon&r=PG", "display_name": "Algeron", "link": "https://stackoverflow.com/users/1132458/algeron"}, "edited": false, "score": 0, "creation_date": 1490213312, "post_id": 42957618, "comment_id": 73017558, "body": "Thanks. It does the trick, although as I have 30000+ rows, then it&#39;s really slow. After like an hour of calculating excel finally crashed. :) Also, thanks for the linear calculation, actually that&#39;s even better.  Now I&#39;m trying to figure out if it&#39;s possible to exclude more than 20 blanks in a row."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 259, "user_id": 1132458, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2eb4bf134b0497b2ce1e597dfe757168?s=128&d=identicon&r=PG", "display_name": "Algeron", "link": "https://stackoverflow.com/users/1132458/algeron"}, "edited": false, "score": 0, "creation_date": 1490215026, "post_id": 42957618, "comment_id": 73018437, "body": "I&#39;ll have a think on doing this in a 2-D variant array so that all processing is in memory. That is the best solution for any looped processing greater than a couple thousand rows."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 259, "user_id": 1132458, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2eb4bf134b0497b2ce1e597dfe757168?s=128&d=identicon&r=PG", "display_name": "Algeron", "link": "https://stackoverflow.com/users/1132458/algeron"}, "edited": false, "score": 0, "creation_date": 1490218754, "post_id": 42957618, "comment_id": 73020395, "body": "In the interim,see <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/5925/switch-off-properties-during-macro-execution\">VBA Best Practices - Switch off properties during macro execution</a>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1506010927, "last_edit_date": 1506010927, "creation_date": 1490200412, "answer_id": 42957618, "question_id": 42956300, "link": "https://stackoverflow.com/questions/42956300/automatically-calculating-and-filling-excel-missing-values-based-on-previous-and/42957618#42957618", "title": "Automatically calculating and filling excel missing values based on previous and next available data", "body": "<p>Beyond locating the blank cells in columns X and Y, this is just simple maths.</p>\n\n<pre><code>Option Explicit\n\nSub missingGazePoints()\n    Dim blnk As Range\n\n    With Worksheets(\"Sheet3\")\n        For Each blnk In .Columns(\"X:Y\").SpecialCells(xlCellTypeBlanks)\n            blnk = blnk.End(xlUp).Value2 + _\n                  (blnk.End(xlDown).Value2 - blnk.End(xlUp).Value2) / _\n                  (blnk.End(xlDown).Row - blnk.End(xlUp).Row)\n        Next blnk\n    End With\nEnd Sub\n</code></pre>\n\n<p>Note that I have filled every missing point in a linear manner; not used a static average for all missing points.\n<a href=\"https://i.stack.imgur.com/ScdKG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ScdKG.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Addendum: Working with Arrays</strong></p>\n\n<p>Looping through rows with repetitive worksheet lookup is going to slow things down; possibly to the point of a crash. Stuffing all of the values (including blanks) into a 2-D variant array and performing all processing within memory before returning the values to the worksheet will speed things up\u00b9.</p>\n\n<pre><code>Sub qwuirwqwq()\n    Dim rsz As Long, x As Long, y As Long\n    Dim vals As Variant, bd As Double, ed As Double\n\n    On Error GoTo bm_Safe_Exit  'uncomment this line when you have finished debugging\n    appTGGL bTGGL:=False        'uncomment this line when you have finished debugging\n\n    With Worksheets(\"Sheet3\")\n        With .Cells(2, \"X\").Resize(Application.Min(.Cells(.Rows.Count, \"X\").End(xlUp).Row - 1, _\n                                                   .Cells(.Rows.Count, \"Y\").End(xlUp).Row - 1), 2)\n            vals = .Cells.Value2\n\n            For x = LBound(vals, 1) + 1 To UBound(vals, 1)\n                If vals(x, 1) = vbNullString Then\n                    y = x + 1\n                    Do While vals(y, 1) = vbNullString\n                        y = y + 1\n                    Loop\n                    vals(x, 1) = vals(x - 1, 1) + _\n                                (vals(y, 1) - vals(x - 1, 1)) / (y - x + 1)\n                End If\n                If vals(x, 2) = vbNullString Then\n                    y = x + 1\n                    Do While vals(y, 2) = vbNullString\n                        y = y + 1\n                    Loop\n                    vals(x, 2) = vals(x - 1, 2) + _\n                                (vals(y, 2) - vals(x - 1, 2)) / (y - x + 1)\n                End If\n            Next x\n\n            .Cells = vals\n            ReDim vals(0)\n        End With\n    End With\n\nbm_Safe_Exit:\n    appTGGL\n\nEnd Sub\n\nPublic Sub appTGGL(Optional bTGGL As Boolean = True)\n    Application.ScreenUpdating = bTGGL\n    Application.EnableEvents = bTGGL\n    Application.DisplayAlerts = bTGGL\n    Application.Calculation = IIf(bTGGL, xlCalculationAutomatic, xlCalculationManual)\n    Debug.Print Timer\nEnd Sub\n</code></pre>\n\n<p>Note the 'helper' <strong>appTGGL</strong> sub procedure that temporarily suspends various environment settings that tax processing until processing has completed.</p>\n\n<p>You can also gain some benefits (execution speed, reduced file size) by saving your workbook as an .XLSB instead of an .XLSM.</p>\n\n<hr>\n\n<p>\u00b9 <sub>I ran the latter memory-based routine through 300,000 rows with ~16,000 blanks cells in 0.6 seconds on a tablet with an i5 and 8Gbs. Yes... that's correct. zero-point-six-seconds.</sub></p>\n"}], "owner": {"reputation": 259, "user_id": 1132458, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2eb4bf134b0497b2ce1e597dfe757168?s=128&d=identicon&r=PG", "display_name": "Algeron", "link": "https://stackoverflow.com/users/1132458/algeron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 42957618, "answer_count": 1, "score": 1, "last_activity_date": 1506010927, "creation_date": 1490197056, "last_edit_date": 1490200501, "question_id": 42956300, "link": "https://stackoverflow.com/questions/42956300/automatically-calculating-and-filling-excel-missing-values-based-on-previous-and", "title": "Automatically calculating and filling excel missing values based on previous and next available data", "body": "<p>I'm doing eye tracking study, but the eye tracker did not always catch the eye. One excel file has ~30k-40k rows and I would like to fill the missing values with average of the previous available and next available data points. But doing it manually would take forever.</p>\n\n<p>I attached an example of the table. So the missing values in the X column should be: 359.5 or rounded to 360. And Y column missing values should be 134.</p>\n\n<p>Additionally, if possible, to add controlling mechanism that it would only fill the missing values if there are maximum of N values in row. The idea behind is that if the eye tracker didn't catch the eye for short periods then it's okay to calculate the average that way, but if it's for longer periods then it would not be correct.</p>\n\n<p><a href=\"https://i.stack.imgur.com/XoKkr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XoKkr.png\" alt=\"Excel table example\"></a></p>\n"}, {"tags": ["vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 0, "creation_date": 1490265716, "post_id": 42956235, "comment_id": 73039511, "body": "why declaring all arguments as variant? Function oikotie(i, IE2, ie, linkki, y)"}, {"owner": {"reputation": 131, "user_id": 2004053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/0f19b00ae01bde7f880808ec01fb5659?s=128&d=identicon&r=PG", "display_name": "tsolina", "link": "https://stackoverflow.com/users/2004053/tsolina"}, "edited": false, "score": 0, "creation_date": 1490265753, "post_id": 42956235, "comment_id": 73039533, "body": "instead ie object you can use msxml 6.0"}], "owner": {"reputation": 137, "user_id": 5568140, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a1fad6aea9c3b86c3f26c30a1f3a076d?s=128&d=identicon&r=PG&f=1", "display_name": "Joonas", "link": "https://stackoverflow.com/users/5568140/joonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490206730, "creation_date": 1490196871, "last_edit_date": 1531164843, "question_id": 42956235, "link": "https://stackoverflow.com/questions/42956235/vba-after-a-couple-of-iterations-internet-explorer-hangs", "title": "VBA after a couple of iterations internet explorer hangs", "body": "<p>I have a problem with Intenet Explorer hanging up on loading.\nI wrote a code that opens up two Internet Explorer objects. One object loads house listings the macro pulls the url these listings and the other browser object (IE2) goes through these listings loading them in the browser. Here's the site: <a href=\"http://asunnot.oikotie.fi/myytavat-asunnot?previousSearchId=25\" rel=\"nofollow noreferrer\">https://asunnot.oikotie.fi/myytavat-asunnot?previousSearchId=25</a>.</p>\n\n<p>I used this macro on my work computer (windows 7) and it works fine. However, when I try using this macro on my laptop IE2 loads about 10 listings after which when IE2 tries to load another listing url (linkki2) it just keeps on loading the webpage without anything appearing in the browser. If I close the macro and restart it at the same listing it loads fine and works for about another ten loads until failing again. I tried to avoid using ie by using MSXML2.XMLHTTP but this doesn't load all of the required code. I need the following part <code>&lt;a href =\"https://asunnot.oikotie.fi/myytavat-asunnot/tampere/13665769\"</code>but using </p>\n\n<pre><code>xml_obj.Open \"GET\", url, False\nxml_obj.send\nhtml_doc.body.outerHTML = xml_obj.responseText\n</code></pre>\n\n<p>Doesn't get me the full code of the site.</p>\n\n<p>Here's the code in question.</p>\n\n<pre><code>Function oikotie(i, IE2, ie, linkki, y)\nk = 0\n\nie.navigate (linkki &amp; y)\nDo While ie.ReadyState &lt;&gt; 4 And ie.Busy: DoEvents: Loop\nApplication.Wait (Now + TimeValue(\"0:00:04\"))\np = 0\n'i = 784\nDo While k &lt;= 23\n    'kaynnistaIE2\n    If p = 9 Then\n        ActiveWorkbook.Save\n        p = 0\n    End If\n    linkki2 = ie.document.body.getelementsbyclassname(\"small-12 medium-4 large-3 columns left\")(k).getelementsbytagname(\"a\")(0).href\n\n    IE2.navigate (linkki2)\n    Do While IE2.ReadyState &lt;&gt; 4 And IE2.Busy: DoEvents: Loop\n    Application.Wait (Now + TimeValue(\"0:00:10\"))\n    t = 0\n\n    Do While t &lt;= 6\n        If InStr(IE2.document.body.getelementsbyclassname(\"collapse target-properties ng-isolate-scope collapsable expanded\")(2).getelementsbyclassname(\"row accordion_padding\")(t).innertext, \"Taloyhti\u00f6n nimi\") &lt;&gt; 0 Then\n            Cells(i, 5).Value = IE2.document.body.getelementsbyclassname(\"collapse target-properties ng-isolate-scope collapsable expanded\")(2).getelementsbyclassname(\"row accordion_padding\")(2).getelementsbyclassname(\"large-8 medium-9 columns left-align property\")(0).innertext\n            i = i + 1\n            Exit Do\n        End If\n        t = t + 1\n    Loop\n    p = p + 1\n    k = k + 1\nLoop\n\noikotie = i\n\nEnd Function\n</code></pre>\n\n<p>I'd like to know how to solve the problem of IE2 loading and never finishing, or a workaround that didn't require using a browser at all.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1490196930, "post_id": 42956202, "comment_id": 73007095, "body": "Thats not VB.NET code.  The tags contain <i>words</i> to help you select only the relevant ones."}, {"owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "reply_to_user": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 0, "creation_date": 1490197385, "post_id": 42956202, "comment_id": 73007453, "body": "Okay my bad. I have removed it"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1490213659, "post_id": 42956202, "comment_id": 73017721, "body": "Not sure, but may be <code>LookAt:=xlPart</code> is what you need."}], "owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490197367, "creation_date": 1490196782, "last_edit_date": 1490197367, "question_id": 42956202, "link": "https://stackoverflow.com/questions/42956202/vb-userform-how-to-search-for-a-word-in-a-column", "title": "VB Userform: How to search for a word in a column", "body": "<p>I have a search criteria based on a column, but I have to type in every single word within that cell, but I would like to search on a word or a few words within that cell. Is this possible?</p>\n\n<pre><code>Public CallDetails As Collection\n\nPublic Function Find_CallNumbers(NumberToFind As String) As Collection\n\nDim rng_to_search As Range\nDim rFound As Range\nDim FirstAddress As String\nDim FoundItem As clsCallDetails\n\nSet CallDetails = New Collection\n\nWith ThisWorkbook.Worksheets(\"Database\")\n    Set rng_to_search = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\nEnd With\n\nWith rng_to_search\n    'Look for the first instance.\n    Set rFound = .Find(what:=NumberToFind, _\n                       after:=.Cells(1, 1), _\n                       LookIn:=xlValues, _\n                       LookAt:=xlWhole, _\n                       SearchDirection:=xlNext)\n    If Not rFound Is Nothing Then\n        FirstAddress = rFound.Address\n        Do\n            Set FoundItem = New clsCallDetails 'Create a new instance of the class to hold the details.\n            With FoundItem\n                .Title = rFound.Offset(, 5)\n                .LoggedBy = rFound.Offset(, 1) 'Offset from column A by 1 column, so column B.\n                .CallNumber = rFound.Offset(, 2)\n                .DateField = rFound.Offset(, 3)\n                .OwnerField = rFound.Offset(, 4)\n                .Description = rFound.Offset(, 6)\n                .Solution = rFound.Offset(, 7)\n                .URLImage = rFound.Offset(, 8)\n\n            End With\n            CallDetails.Add FoundItem 'Add the class instance to our collection.\n            Set rFound = .FindNext(rFound) 'Look for the next value.\n\n        'Continue searching until we reach the top again.\n        Loop While Not rFound Is Nothing And rFound.Address &lt;&gt; FirstAddress\n    End If\nEnd With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 244, "user_id": 808773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eefe6a6781022cc852a8d4ac56bfa5d?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/808773/sergey"}, "edited": false, "score": 0, "creation_date": 1490197901, "post_id": 42956159, "comment_id": 73007842, "body": "If form has a datasource then when you will press next record button then Form_Current() even will be raised."}, {"owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "reply_to_user": {"reputation": 244, "user_id": 808773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eefe6a6781022cc852a8d4ac56bfa5d?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/808773/sergey"}, "edited": false, "score": 0, "creation_date": 1490198690, "post_id": 42956159, "comment_id": 73008426, "body": "Well I added a dummy MessageBox to check if that happens. The Message gets displayed when the form loads for the first time. When I click the Next Record button and it goes from say record no 1 to record no 2, I don&#39;t see the MessageBox being displayed. Nor is my record source updated. Am I missing anything?"}, {"owner": {"reputation": 244, "user_id": 808773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eefe6a6781022cc852a8d4ac56bfa5d?s=128&d=identicon&r=PG", "display_name": "Sergey", "link": "https://stackoverflow.com/users/808773/sergey"}, "edited": false, "score": 0, "creation_date": 1490198881, "post_id": 42956159, "comment_id": 73008559, "body": "I don&#39;t see your code."}], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490199317, "post_id": 42957073, "comment_id": 73008880, "body": "Here&#39;s my code:Private Sub Form_Current()      MsgBox (&quot;hello&quot;)                 Dim strSQL As String           strSQL = &quot;SELECT DISTINCTROW StudentTeachingStatusTbl.ID, StudentTeachingStatusTbl.SuccessStatus FROM StudentTeachingStatusTbl WHERE Active = -1&quot; &amp; _             &quot;or ID IN (Select SuccessID from StudentTeachingExperiencesTbl where StuId = &quot; &amp; Me.Text2.Value &amp; &quot; and SemesterID = &quot; &amp; Me.StudentTeachExp_SubF.Controls(&quot;SemesterID&quot;).Value &amp; &quot;)&quot;                                          Me.StudentTeachExp_SubF.Controls(&quot;SuccessID&quot;).RowSource = strSQL                    End Sub"}, {"owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490199384, "post_id": 42957073, "comment_id": 73008927, "body": "I don&#39;t see any message box being triggered on Form Current."}, {"owner": {"reputation": 66, "user_id": 7735412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a8f19b1d8a9b7736f669d4c96bf5ec?s=128&d=identicon&r=PG&f=1", "display_name": "robv", "link": "https://stackoverflow.com/users/7735412/robv"}, "reply_to_user": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490199753, "post_id": 42957073, "comment_id": 73009190, "body": "Is the form definitely bound to a record source?  Try making a copy of the form and strip it back to basics leaving just the dropdown ( Combo Box ? ) and the &quot;On Current&quot; event."}, {"owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490200031, "post_id": 42957073, "comment_id": 73009392, "body": "Well the record source for this form is a query say something like: Select * from Students where ID = &lt;current student ID&gt;"}, {"owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490200581, "post_id": 42957073, "comment_id": 73009772, "body": "The student ID is a filter from a previous form. Basically there&#39;s a form which has a button. When we click that button, it opens this form. And on this form, the current event is getting triggered only once for some reason."}, {"owner": {"reputation": 66, "user_id": 7735412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a8f19b1d8a9b7736f669d4c96bf5ec?s=128&d=identicon&r=PG&f=1", "display_name": "robv", "link": "https://stackoverflow.com/users/7735412/robv"}, "reply_to_user": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490200615, "post_id": 42957073, "comment_id": 73009803, "body": "If you only have one record in the form as that SELECT statement implies then the &quot;On Current&quot; event may only be triggered when opening the form. Can you go to a new/empty record by clicking in the record navigator at the bottom of the form?  If you have &quot;Allow Additions : No&quot; this not possible."}, {"owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490204688, "post_id": 42957073, "comment_id": 73012463, "body": "Looks like there was a confusion from my side. I&#39;m a novice w.r.t MS Access. Actually this form is a &quot;sub form&quot; within the parent form. I was trying to execute the &quot;Form Current&quot; event in the main form. I&#39;ve updated my code to now handle the sub form &quot;Current&quot; event."}], "tags": [], "owner": {"reputation": 66, "user_id": 7735412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a8f19b1d8a9b7736f669d4c96bf5ec?s=128&d=identicon&r=PG&f=1", "display_name": "robv", "link": "https://stackoverflow.com/users/7735412/robv"}, "is_accepted": true, "score": 3, "last_activity_date": 1490198888, "creation_date": 1490198888, "answer_id": 42957073, "question_id": 42956159, "link": "https://stackoverflow.com/questions/42956159/trigger-an-event-while-navigating-to-next-record/42957073#42957073", "title": "Trigger an event while navigating to next record", "body": "<p>The \"On Current\" event is triggered when the form focuses on a new record.\nThis does happen when opening a form as a consequence the form having a record on it.</p>\n\n<p>The \"On Load\" and \"On Open\" are triggered once when opening the form.</p>\n\n<p>Try adding a MsgBox to your \"On Current\" event code for testing purposes.</p>\n\n<p>Good Luck.</p>\n"}, {"comments": [{"owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "edited": false, "score": 0, "creation_date": 1490204876, "post_id": 42958457, "comment_id": 73012585, "body": "I was changing the main form event which was the problem. I&#39;m now handling the event in the main form. Thanks for that observation!"}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 1, "last_activity_date": 1490202909, "creation_date": 1490202909, "answer_id": 42958457, "question_id": 42956159, "link": "https://stackoverflow.com/questions/42956159/trigger-an-event-while-navigating-to-next-record/42958457#42958457", "title": "Trigger an event while navigating to next record", "body": "<p>Looking at your code you are changing a sub form record source, so are you changing record on the subform or the main form? </p>\n\n<p>If it's the sub form you need to use the subforms OnChange event, not the parent forms event.</p>\n"}], "owner": {"reputation": 414, "user_id": 6922847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6629f84515a7a77713b98a92d876f968?s=128&d=identicon&r=PG&f=1", "display_name": "paratrooper", "link": "https://stackoverflow.com/users/6922847/paratrooper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6632, "favorite_count": 0, "accepted_answer_id": 42957073, "answer_count": 2, "score": 2, "last_activity_date": 1490202909, "creation_date": 1490196664, "last_edit_date": 1490199488, "question_id": 42956159, "link": "https://stackoverflow.com/questions/42956159/trigger-an-event-while-navigating-to-next-record", "title": "Trigger an event while navigating to next record", "body": "<p>I need to set the record source of a particular dropdown in a form based on the current record i.e when I click the next record, the record source should get updated.</p>\n\n<p>But I'm unable to find any event for doing so. This needs to be done without adding any extra/new buttons.</p>\n\n<p>I tried using the \"Form Current\" event but apparently it gets triggered only once when the form is loaded, and not when I move to the next record within the same form.</p>\n\n<p>Any suggestions?</p>\n\n<p>Sample Code:</p>\n\n<pre><code>Private Sub Form_Current()\n\n MsgBox (\"hello\")\n\n Dim strSQL As String\n\n strSQL = \"SELECT DISTINCTROW StudentTeachingStatusTbl.ID, StudentTeachingStatusTbl.SuccessStatus FROM StudentTeachingStatusTbl WHERE Active = -1\" &amp; _\n        \"or ID IN (Select SuccessID from StudentTeachingExperiencesTbl where StuId = \" &amp; Me.Text2.Value\n\n If Not IsNull(Me.StudentTeachExp_SubF.Controls(\"SemesterID\")) Then\n    strSQL = strSQL &amp; \" and SemesterID = \" &amp; Me.StudentTeachExp_SubF.Controls(\"SemesterID\").Value\n End If\n\n strSQL = strSQL &amp; \")\"\n\n Me.StudentTeachExp_SubF.Controls(\"SuccessID\").RowSource = strSQL               \n End Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1490264404, "post_id": 42971992, "comment_id": 73038511, "body": "Pretty sure CASE isn&#39;t part of Access SQL."}], "tags": [], "owner": {"reputation": 17, "user_id": 7689778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887e0815ede7757037c18e9f272c91cf?s=128&d=identicon&r=PG&f=1", "display_name": "fosjo", "link": "https://stackoverflow.com/users/7689778/fosjo"}, "is_accepted": false, "score": 0, "last_activity_date": 1490261361, "creation_date": 1490261361, "answer_id": 42971992, "question_id": 42956138, "link": "https://stackoverflow.com/questions/42956138/need-to-find-all-columns-with-null-values-for-every-record-access-sql-or-vba/42971992#42971992", "title": "Need to find all columns with null values for every record - Access SQL or vba", "body": "<p>I think you're looking for a CASE statement. </p>\n\n<pre><code>SELECT CASE WHEN TBL_Cumulative.[ScreeningDate] IS NULL THEN 'ScreeningDate Missing' \n            WHEN TBL_Cumulative.[ScreeningLocation] IS NULL THEN 'ScreeningLocation Missing'\n            WHEN TBL_Cumulative.[Source] IS NULL THEN 'Source Missing',\n            WHEN TBL_Cumulative.[FirstName] IS NULL THEN 'FirstName Missing',\n            WHEN TBL_Cumulative.[LastName] IS NULL THEN 'LastName Missing',\n            WHEN TBL_Cumulative.[DOB] IS NULL THEN 'DOB Missin',\n            WHEN TBL_Cumulative.[Female] IS NULL THEN 'Female Missing',\n            WHEN TBL_Cumulative.[Male] IS NULL THEN 'Male Missing',\n            WHEN TBL_Cumulative.[Height_FT] IS NULL THEN 'Height_FT Missing',\n            WHEN TBL_Cumulative.[Height_IN] IS NULL THEN 'Height_IN Missing',\n            WHEN TBL_Cumulative.[Weight] IS NULL THEN 'Weight Missing',\n            WHEN TBL_Cumulative.[Fasting_Y] IS NULL THEN 'Fasting_Y Missing',\n            WHEN TBL_Cumulative.[Fasting_N] IS NULL THEN 'Fasting_N Missing',\n            WHEN TBL_Cumulative.[Pregnant_Y] IS NULL THEN 'Pregnant_Y Missing',\n            WHEN TBL_Cumulative.[Pregnant_N] IS NULL THEN 'Pregnant_N Missing',\n            WHEN TBL_Cumulative.[Tobacco_Y] IS NULL THEN 'Tobacco_Y Missing',\n            WHEN TBL_Cumulative.[Tobacco_N] IS NULL THEN 'Tobacco_N Missing',\n            WHEN TBL_Cumulative.[hbA1c] IS NULL THEN 'hbA1c Missing',\n            WHEN TBL_Cumulative.[Cotinine] IS NULL THEN 'Cotinine Missing',\n            WHEN TBL_Cumulative.[TSH] IS NULL THEN 'TSH Missing' \n        END AS ERROR\nFROM TBL_Cumulative\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1490264530, "creation_date": 1490264530, "answer_id": 42973248, "question_id": 42956138, "link": "https://stackoverflow.com/questions/42956138/need-to-find-all-columns-with-null-values-for-every-record-access-sql-or-vba/42973248#42973248", "title": "Need to find all columns with null values for every record - Access SQL or vba", "body": "<p>This should create the query for you.  It will throw an error if the query already exists.</p>\n\n<pre><code>Public Sub Test()\n\n    CreateQuery \"TBL_Cumulative\"\n\nEnd Sub\n\nPublic Sub CreateQuery(TableName As String)\n\n    Dim db As DAO.Database\n    Dim qdf As DAO.QueryDef\n    Dim rst As DAO.Recordset\n    Dim fld As DAO.Field\n    Dim SQL_Select As String\n    Dim SQL_Where As String\n    Dim SQL As String\n\n    Set db = CurrentDb\n    Set rst = db.OpenRecordset(TableName)\n\n    SQL_Select = \"SELECT \"\n    SQL_Where = \"WHERE \"\n    For Each fld In rst.Fields\n        SQL_Select = SQL_Select &amp; \"[\" &amp; fld.Name &amp; \"], \"\n        SQL_Where = SQL_Where &amp; \"[\" &amp; fld.Name &amp; \"] Is Null OR \"\n    Next fld\n\n    SQL_Select = Left(SQL_Select, Len(SQL_Select) - 2) &amp; \" FROM [\" &amp; TableName &amp; \"]\"\n    SQL_Where = Left(SQL_Where, Len(SQL_Where) - 4)\n\n    SQL = SQL_Select &amp; SQL_Where\n\n    Set qdf = db.CreateQueryDef(\"SQL_\" &amp; TableName, SQL)\n\n    rst.Close\n    Set rst = Nothing\n    Set qdf = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7618053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09e955d92480887bcd40a5fa504c43c1?s=128&d=identicon&r=PG&f=1", "display_name": "L. Welch", "link": "https://stackoverflow.com/users/7618053/l-welch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593956414, "creation_date": 1490196618, "last_edit_date": 1593956414, "question_id": 42956138, "link": "https://stackoverflow.com/questions/42956138/need-to-find-all-columns-with-null-values-for-every-record-access-sql-or-vba", "title": "Need to find all columns with null values for every record - Access SQL or vba", "body": "<p>I apologize if this question already exists - I've tried looking for a solution and have not found one yet. </p>\n\n<p>I have a database template that is used to set up individual databases to process client data that is not always in the same format or sometimes has additional fields. I am trying to build a query that will test the results of a cumulative table and ensure that the analyst who set up the new database did not miss anything. Ultimately I just need a way to show if there are any fields in the cumulative table that are NULL for every record and tell me the field names.</p>\n\n<p>I've tried setting up a query using SWITCH and IIF but there are too many fields involved so invariably I get the Expression Too Complex error. </p>\n\n<p>This is an example of the query, though my database will ultimately have 70 fields that need to be tested for null values after setup. </p>\n\n<pre><code>SELECT SWITCH(\nTBL_Cumulative.[ScreeningDate] IS NULL, \"ScreeningDate Missing\",\nTBL_Cumulative.[ScreeningLocation] IS NULL, \"ScreeningLocation Missing\",\nTBL_Cumulative.[Source] IS NULL, \"Source Missing\",\nTBL_Cumulative.[FirstName] IS NULL, \"FirstName Missing\",\nTBL_Cumulative.[LastName] IS NULL, \"LastName Missing\",\nTBL_Cumulative.[DOB] IS NULL, \"DOB Missing\",\nTBL_Cumulative.[Female] IS NULL, \"Female Missing\",\nTBL_Cumulative.[Male] IS NULL, \"Male Missing\",\nTBL_Cumulative.[Height_FT] IS NULL, \"Height_FT Missing\",\nTBL_Cumulative.[Height_IN] IS NULL, \"Height_IN Missing\",\nTBL_Cumulative.[Weight] IS NULL, \"Weight Missing\",\nTBL_Cumulative.[Fasting_Y] IS NULL, \"Fasting_Y Missing\",\nTBL_Cumulative.[Fasting_N] IS NULL, \"Fasting_N Missing\",\nTBL_Cumulative.[Pregnant_Y] IS NULL, \"Pregnant_Y Missing\",\nTBL_Cumulative.[Pregnant_N] IS NULL, \"Pregnant_N Missing\",\nTBL_Cumulative.[Tobacco_Y] IS NULL, \"Tobacco_Y Missing\",\nTBL_Cumulative.[Tobacco_N] IS NULL, \"Tobacco_N Missing\",\nTBL_Cumulative.[hbA1c] IS NULL, \"hbA1c Missing\",\nTBL_Cumulative.[Cotinine] IS NULL, \"Cotinine Missing\",\nTBL_Cumulative.[TSH] IS NULL, \"TSH Missing\",\nTBL_Cumulative.[PSA] IS NULL, \"PSA Missing\") AS Error FROM TBL_Cumulative\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1490196468, "post_id": 42955407, "comment_id": 73006705, "body": "The most simple thing you can do is to make a SUMIF() formula and to record it with VBA. Or make a pivot table."}, {"owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1490196498, "post_id": 42955407, "comment_id": 73006733, "body": "@Vityata - thank you for the tips.  I will work on those and record some VBA to get it."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1490196809, "creation_date": 1490196809, "answer_id": 42956217, "question_id": 42955407, "link": "https://stackoverflow.com/questions/42955407/excel-vba-to-take-details-to-totals-sheet/42956217#42956217", "title": "Excel VBA To Take Details To Totals Sheet", "body": "<p>Probably the most simple example:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n    Range(\"C1\") = WorksheetFunction.SumIf(Range(\"A1:A4\"), \"Joe\", Range(\"B1:B4\"))\nEnd Sub\n</code></pre>\n\n<p>Further, you may try to set the ranges in the WorksheetFunction to variables and to make it flexible. </p>\n\n<p><a href=\"https://i.stack.imgur.com/wvcKc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wvcKc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 12253, "user_id": 16473, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d2588c9db71e7201288ff9f74ba219ca?s=128&d=identicon&r=PG", "display_name": "Gordon Bell", "link": "https://stackoverflow.com/users/16473/gordon-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1490199809, "last_edit_date": 1490199809, "creation_date": 1490198673, "answer_id": 42957001, "question_id": 42955407, "link": "https://stackoverflow.com/questions/42955407/excel-vba-to-take-details-to-totals-sheet/42957001#42957001", "title": "Excel VBA To Take Details To Totals Sheet", "body": "<p>Like Vityata suggested, you can simply use a PivotTable.</p>\n\n<p>Select your table.  On Insert tab, select PivotTable.</p>\n\n<p>In the Create PivotTable dialog, your table range should already be selected, so just click OK.</p>\n\n<p>In the PivotTable Fields pane (on right), check Employee, then Amt.  This should put Employee in the Rows area and Amt in the Values area.</p>\n\n<p>In the PivotTable results, rename the \"Row Labels\" title to \"Employee\" and \"Sum of Amt\" To \"Total Sales\".  Format the Sales column as needed.  Add a Title to cell A1.</p>\n\n<p>When your data is updated, click the \"Refresh\" button on the PivotTable Analyze tab to refresh the PivotTable.  You also may need to grow the source range using the \"Change Data Source\" button.  Sometimes it's easier to just set the Table/Range to something like Sheet1!$A:$D, then click the dropdown next to \"Employee\", select Sort A-Z and for Label Filters select \"Does Not Equal\" to \"(blank)\"</p>\n"}], "owner": {"reputation": 967, "user_id": 6860396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2335c5b5ac2454a5b20ba41ab74f95f0?s=128&d=identicon&r=PG&f=1", "display_name": "BellHopByDayAmetuerCoderByNigh", "link": "https://stackoverflow.com/users/6860396/bellhopbydayametuercoderbynigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 42956217, "answer_count": 2, "score": 1, "last_activity_date": 1490199809, "creation_date": 1490194891, "question_id": 42955407, "link": "https://stackoverflow.com/questions/42955407/excel-vba-to-take-details-to-totals-sheet", "title": "Excel VBA To Take Details To Totals Sheet", "body": "<p>I have an Excel workbook that has a detail sheet.  I want to from the button press event convert that to a Total sheet, but I am not sure how.  This is how the detail sheet is set-up</p>\n\n<pre><code>Employee -- Item -- Amt -- Sale Date\nJoe         Hat     10     2017-01-01\nJoe         Ball    04     2017-01-02\nJoe         Socks   06     2017-01-04\nJoe         Cap     11     2017-01-06\n</code></pre>\n\n<p>And I would want the Totals sheet to only show</p>\n\n<pre><code>Employee -- Total Sales\nJoe         31\n</code></pre>\n\n<p>What VBA would achieve this?</p>\n"}, {"tags": ["excel", "for-loop", "vba"], "comments": [{"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1490197757, "post_id": 42955331, "comment_id": 73007730, "body": "Because the range &quot;r&quot; is only one cell &quot;I2&quot;, you are looping throw one cell. so your code will run one time only. And you don&#39;t need to set range(&quot;I2&quot;) in r to check if it is empty, only write : if range(&quot;I2&quot;).value &lt;&gt; &quot;&quot; then ...  And Notempty is not a propriety of a range"}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1490198036, "post_id": 42955331, "comment_id": 73007932, "body": "To loop until I2 is empty use &quot;While&quot; : While Range(&quot;I2&quot;) &lt;&gt; &quot;&quot; .... wend"}, {"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "reply_to_user": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1490206661, "post_id": 42955331, "comment_id": 73013755, "body": "Thanks!! this works great, except it takes a while even when I add a macro to run everything fast... If there is another solution to run faster, I&#39;m all ears. But for now it will do :-) Thanks"}, {"owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "reply_to_user": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1490271722, "post_id": 42955331, "comment_id": 73043667, "body": "Any ideas to have the macro run faster. I think the WHILE ... WEND is making the macros really slow. I did add all the normal macro to have the macros runs faster and still it is slow. Thank you for helping."}, {"owner": {"reputation": 526, "user_id": 7164307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b469705184f2479532aec6bc97f25b46?s=128&d=identicon&r=PG&f=1", "display_name": "D. O.", "link": "https://stackoverflow.com/users/7164307/d-o"}, "edited": false, "score": 0, "creation_date": 1490281475, "post_id": 42955331, "comment_id": 73051599, "body": "I think it is slow because you are using a lot of &quot;Select&quot; and &quot;Selection&quot; in your code. You can do better by using &quot;set&quot; objects, for example : set rng=Sheets(&quot;Value Imported Data&quot;).Range(&quot;I2:Q2&quot;). Set it one time before the while loop, so you have not to select it every loop."}], "owner": {"reputation": 99, "user_id": 7594277, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fa052c1884d88c2db4558b8bec0e8038?s=128&d=identicon&r=PG&f=1", "display_name": "Val S", "link": "https://stackoverflow.com/users/7594277/val-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 645, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490194709, "creation_date": 1490194709, "last_edit_date": 1531164843, "question_id": 42955331, "link": "https://stackoverflow.com/questions/42955331/looping-until-cell-is-empty", "title": "Looping until cell is empty", "body": "<p>I have my macro written but now I need it to run in a loop until cell I2 is empty.</p>\n\n<p>Can anyone help with this?</p>\n\n<pre><code>Sheets(\"Value Imported Data\").Select\nRange(\"I2:Q2\").Select\nSelection.Copy\nSheets(\"Good data\").Select\nRange(\"I1\").Select\nSelection.End(xlDown).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nSheets(\"Value Imported Data\").Select\nActiveCell.Resize(40, 9).Select\nApplication.CutCopyMode = False\n    Selection.Delete Shift:=xlUp\n</code></pre>\n\n<p>I assumed it would be something like this but it does not work at all</p>\n\n<pre><code>Sub CandidatesInfo()\n    Dim r As Range\n    Dim Cell As Range\nSheets(\"Value Imported Data\").Select\n\n    Set r = Range(\"I2\")\n\n    For Each Cell In r\n    If r.Notempty Then\n\n\n        Range(\"I2:Q2\").Select\n        Selection.Copy\n        Sheets(\"Good data\").Select\n        Range(\"I1\").Select\n        Selection.End(xlDown).Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n\n        Sheets(\"Value Imported Data\").Select\n        ActiveCell.Resize(40, 9).Select\n        Application.CutCopyMode = False\n            Selection.Delete Shift:=xlUp\n    End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Basically what I want to do is if I2 is empty do nothing but if it is not empty copy I2 to Q2 into another sheet and once copied go back in the sheet where the information was copied and delete the next 40 information down and 9 to the right and start over again. As I said the top macro works perfectly, now it is just a matter of starting over and over until I2 is empty.</p>\n\n<p>Any help is appreciated.\nThank you very much</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1490194497, "post_id": 42955159, "comment_id": 73005099, "body": "You may need to declare <code>CASarray</code> as a Range."}, {"owner": {"reputation": 1, "user_id": 6020126, "user_type": "registered", "profile_image": "https://graph.facebook.com/1141812569184831/picture?type=large", "display_name": "Aanandh Chandrasekar", "link": "https://stackoverflow.com/users/6020126/aanandh-chandrasekar"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1490194631, "post_id": 42955159, "comment_id": 73005216, "body": "I tried that earlier - wasn&#39;t working. That&#39;s why I went generic, to Object. As far as my understanding goes, that shouldn&#39;t throw anything off though?"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490249391, "post_id": 42956367, "comment_id": 73030065, "body": "@ShaiRado - My code was just fixing the specific problems with the original code - your code gives the better way to achieve the underlying goal, so hopefully the OP will accept it.  (P.S.  Another way of testing the code is <code>=countUniqueCols(&quot;Ian&quot;,Sheet1!A1:D1000)</code> - it&#39;s a valid UDF, and I suspect that&#39;s how the OP is using it.)"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490249445, "post_id": 42956367, "comment_id": 73030087, "body": "Your explanations about the errors are better, I was just giving you credit and upvoted (on my side)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1490197914, "last_edit_date": 1490197914, "creation_date": 1490197216, "answer_id": 42956367, "question_id": 42955159, "link": "https://stackoverflow.com/questions/42955159/user-defined-type-not-defined-error-no-lines-highlighted-whats-the-error/42956367#42956367", "title": "\u201cUser-defined type not defined\u201d error, no lines highlighted - what&#39;s the error?", "body": "<p>Doh!!!  I was scratching my head for a while on this, even resorting to attempting to step through the code - and then I suddenly spotted it - <strong>Text</strong>:</p>\n\n<pre><code>Function countUniqueCols(toFind As Text, CASarray As Object) As Integer\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>Function countUniqueCols(toFind As String, CASarray As Range) As Integer\n</code></pre>\n\n<p><code>Text</code> is not a valid VBA data type.</p>\n\n<p>And then, just when I thought that I had the problem solved, I tried running it again, and found <code>Column</code>, which will need to be <code>Range</code>, i.e.</p>\n\n<pre><code>Dim currentCol As Column\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Dim currentCol As Range\n</code></pre>\n\n<p>And then I found that <code>currentRow</code> wasn't defined.  And that the <code>Cells(currentRow, currentCol)</code> was wrong.</p>\n\n<p>The following code should work:</p>\n\n<pre><code>Function countUniqueCols(toFind As String, CASarray As Range) As Integer\n    Dim numCols As Integer\n    numCols = 0\n    Dim currentCol As Range\n    Dim currentRow As Range\n    For Each currentCol In CASarray.Columns\n        For Each currentRow In currentCol.Rows\n            If InStr(1, currentRow.Value, toFind) Then\n                numCols = numCols + 1\n                Exit For\n            End If\n        Next currentRow\n    Next currentCol\n    countUniqueCols = numCols\nEnd Function\n</code></pre>\n\n<p>But Shai's code would be better, so I am only leaving this here so that you can see the subtle errors that existed in the existing code.</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490360187, "post_id": 42956627, "comment_id": 73089788, "body": "@Aanandh Chandrasekar have you tested my code above ? is it working ? if it does the mark as &quot;ANSWSER&quot; , click on the check mark next to my answer (it will turn green)"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1490198146, "last_edit_date": 1490198146, "creation_date": 1490197800, "answer_id": 42956627, "question_id": 42955159, "link": "https://stackoverflow.com/questions/42955159/user-defined-type-not-defined-error-no-lines-highlighted-whats-the-error/42956627#42956627", "title": "\u201cUser-defined type not defined\u201d error, no lines highlighted - what&#39;s the error?", "body": "<p>Since it doesn't matter (according to your post) how many times <code>toFind</code> is found within a column (as long as it's >= 1), then you can loop through the <code>CASarray</code> range's columns, and for each column use the <code>Application.Match</code> to find a single match.</p>\n\n<p>In this case, if <code>If Not IsError(Application.Match(toFind, currentCol, 0)) Then</code> means a match was found within this column, so add a count of 1 to <code>numCols</code>.</p>\n\n<p>The second <code>Sub</code> I've added is to make sure you use the right parameters (and fully qualified) when you call this function.</p>\n\n<p><strong><em>Function countUniqueCols</em> Code</strong></p>\n\n<pre><code>Option Explicit\n\nFunction countUniqueCols(toFind As String, CASarray As Range) As Long\n\n    Dim numCols As Long, currentCol As Range\n\n    numCols = 0\n\n    For Each currentCol In CASarray.Columns\n        If Not IsError(Application.Match(toFind, currentCol, 0)) Then\n            numCols = numCols + 1\n        End If\n    Next currentCol\n    countUniqueCols = numCols\n\nEnd Function\n</code></pre>\n\n<p><strong><em>Sub Test_countUniqueCols</em> Code</strong> (to test the Function)</p>\n\n<pre><code>Sub Test_countUniqueCols()\n\nDim Res As Long\n\nRes = countUniqueCols(\"Shai\", Worksheets(\"Sheet1\").Range(\"A1:D1000\"))    \nMsgBox Res\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6020126, "user_type": "registered", "profile_image": "https://graph.facebook.com/1141812569184831/picture?type=large", "display_name": "Aanandh Chandrasekar", "link": "https://stackoverflow.com/users/6020126/aanandh-chandrasekar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490198146, "creation_date": 1490194358, "last_edit_date": 1490194649, "question_id": 42955159, "link": "https://stackoverflow.com/questions/42955159/user-defined-type-not-defined-error-no-lines-highlighted-whats-the-error", "title": "\u201cUser-defined type not defined\u201d error, no lines highlighted - what&#39;s the error?", "body": "<p>I'm fairly new to VBA. I'm trying to write a function that will return the number of columns that contain a value.</p>\n\n<p>So for instance, if \"37\" is present 2x in column A, 3x in column B, and 0x in ColumnC, the function will return 2.</p>\n\n<p>When I run this, it gives me an error - \"user-defined type not defined.\" VBA doesn't indicate a particular line that has the issue.</p>\n\n<pre><code>Function countUniqueCols(toFind As Text, CASarray As Object) As Integer\n    Dim numCols As Integer\n    numCols = 0\n    Dim currentCol As Column\n    For Each currentCol In CASarray.Columns\n        For Each currentRow In currentCol.Rows\n            If InStr(1, Cells(currentRow, currentCol).value, toFind) Then\n                numCols = numCols + 1\n                Exit For\n            End If\n        Next currentRow\n    Next currentCol\n    countUniqueCols = numCols\nEnd Function\n</code></pre>\n\n<p>Thoughts? Thanks so much!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1490194897, "post_id": 42955104, "comment_id": 73005452, "body": "I have it in the cells. But sometimes accidents happen and i delete the formule. It s safer with vba I think"}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1490195030, "post_id": 42955104, "comment_id": 73005566, "body": "You can do something like <code>Range(&quot;H10&quot;).formula = &quot;=YOUR FUNCTION&quot;</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1490195155, "post_id": 42955104, "comment_id": 73005668, "body": "You can protect cells which contain a formula to guard against accidental deletion. If you want to go the VBA route, it would make more sense to throw the formula away and create an equivalent but more readable VBA function. The chief advantage of VBA is that it allows you to clearly spell out the logic of a computation without needing to use deeply nested, not very readable worksheet formulas. Why pass up on the chief advantage of VBA? Protection against accidental deletion doesn&#39;t seem like an adequate motivation IMHO."}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490195304, "post_id": 42955104, "comment_id": 73005770, "body": "I ve tried for 2 day&#39;s now. Yes I want the same calculation but in vba. But how hard I search, I can t find anything."}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490195411, "post_id": 42955104, "comment_id": 73005866, "body": "I&#39;ve tried if else statement with conditions. How much I try, how messy it becomes. So asked for help o you guy&#39;s"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1490196936, "post_id": 42955104, "comment_id": 73007098, "body": "What value if false do you have for <code>IF(B4&gt;7,&quot;&quot;)</code> at the end of the first formula?"}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490197243, "post_id": 42955104, "comment_id": 73007345, "body": "I don&#39;t know. I don&#39;t get an error. I just changed the formula to my needs."}, {"owner": {"reputation": 3333, "user_id": 6609896, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Zhi35.jpg?s=128&g=1", "display_name": "Greedo", "link": "https://stackoverflow.com/users/6609896/greedo"}, "edited": false, "score": 0, "creation_date": 1490198180, "post_id": 42955104, "comment_id": 73008036, "body": "As a side note on formulae like this, I would advise use of the new Excel function <code>IFS</code> to replace all those nested IF functions. It&#39;s not backwards compatible (only 2016 onwards has the formula, and only with a 365 subscription, or Excel online) - but if you have it, I&#39;d recommend it as it is much more readable."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490198683, "post_id": 42956417, "comment_id": 73008417, "body": "Thank you very much. I ll try the suggestions when I get home. Can I use a dynamic range in place of referring to a cell?"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490200125, "post_id": 42956417, "comment_id": 73009451, "body": "@Erol with my approach you would need to do something like use offsets from <code>Application.Caller</code> (the cell that contains the formula). A more straight-forward idea is to make the function take arguments, so that things like <code>G10</code> wouldn&#39;t be hard-wired but instead would be passed to the function. You would then enter these cells into the formula by clicking on them. I&#39;ll edit my question to show how this works."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490212709, "post_id": 42956417, "comment_id": 73017221, "body": "The circular reference isn&#39;t in the VBA -- it is in how you are using the formulas. You must have <i>formulas</i> in e.g. <code>A4</code> which depends on the cell (either directly or indirectly) that you have the formulas entered in."}, {"owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490212880, "post_id": 42956417, "comment_id": 73017311, "body": "Range(&quot;H10&quot;).formula = &quot;=(IF(B4=&quot;Gr&quot;,(A4*1),IF(B4=&quot;Ml&quot;,    (A4*1),IF(B4=&quot;Paket&quot;,  (A4*D4),IF(B4=&quot;Yk&quot;,  (A4*12),IF(B4=&quot;Ck&quot;,  (A4*8),IF(B4=&quot;Adet&quot;,(A4*1),  IF(B4=&quot;Kg&quot;,(A4*1000),IF(B4=&quot;Lt&quot;,  (A4*1),IF(B4&gt;7,&quot;&quot;))))))))*D4))&quot;   this one gave me the error."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "reply_to_user": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "edited": false, "score": 0, "creation_date": 1490213084, "post_id": 42956417, "comment_id": 73017431, "body": "That looks like some VBA you were using to try to implement @VBAPete&#39;s idea. If so, that won&#39;t work like that since 1) you have a stray = in <code>==</code> and 2) you are not escaping the quote marks."}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 1, "last_activity_date": 1490214183, "last_edit_date": 1490214183, "creation_date": 1490197344, "answer_id": 42956417, "question_id": 42955104, "link": "https://stackoverflow.com/questions/42955104/excel-vba-cell-value-depending-other-cell/42956417#42956417", "title": "Excel vba cell value depending other cell", "body": "<p>The VBA function <code>IIf</code> is the function which directly corresponds to the worksheet function <code>IF</code>. Thus if you want a literal VBA transcription of those exact formulas it would look something like this:</p>\n\n<pre><code>Function FirstFormula() As Variant\n    FirstFormula = (IIf(Range(\"B4\").Value = \"Gr\", (Range(\"A4\").Value * 1), IIf(Range(\"B4\").Value = \"Ml\", _\n        (Range(\"A4\").Value * 1), IIf(Range(\"B4\").Value = \"Paket\", _\n        (Range(\"A4\").Value * Range(\"D4\").Value), IIf(Range(\"B4\").Value = \"Yk\", _\n        (Range(\"A4\").Value * 12), IIf(Range(\"B4\").Value = \"Ck\", _\n        (Range(\"A4\").Value * 8), IIf(Range(\"B4\").Value = \"Adet\", (Range(\"A4\").Value * 1), _\n        IIf(Range(\"B4\").Value = \"Kg\", (Range(\"A4\").Value * 1000), IIf(Range(\"B4\").Value = \"Lt\", _\n        (Range(\"A4\").Value * 1), IIf(Range(\"B4\").Value &gt; 7, \"\", False)))))))) * Range(\"D4\").Value))\nEnd Function    \n\nFunction SecondFormula() As Variant\n    SecondFormula = IIf(Range(\"G10\").Value = \"Gr\", ((Range(\"F10\").Value * 1) * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"Ml\", ((Range(\"F10\").Value / 16) * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"Paket\", (Range(\"F10\").Value * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"Yk\", ((Range(\"F10\").Value / 32) * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"Ck\", ((Range(\"F10\").Value / 128) * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"Adet\", ((Range(\"F10\").Value * 1) * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"Kg\", ((Range(\"F10\").Value / 1000) * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"Lt\", ((Range(\"F10\").Value / 1000) * Range(\"E10\").Value), _\n        IIf(Range(\"G10\").Value = \"\", \"0\", False)))))))))\nEnd Function\n</code></pre>\n\n<p>Putting <code>=FirstFormula()</code> in a cell should be functionally equivalent to placing that exact formula in the cell, and similarly for the second formula. Note if you go this route, then the references to the formula don't automatically update when you copy the formula down, the cell references \"B4\", etc. are hard-wired into it.</p>\n\n<p>I haven't tested the above, but it compiles nicely and it follows your logic exactly. If it doesn't suit your needs, consider using the excellent suggestion of @VBAPete.</p>\n\n<p><strong>On Edit</strong> Here is a more flexible version:</p>\n\n<pre><code>Function FirstFormula(A As Range, B As Range, D As Range) As Variant\n    FirstFormula = (IIf(B.Value = \"Gr\", (A.Value * 1), IIf(B.Value = \"Ml\", _\n        (A.Value * 1), IIf(B.Value = \"Paket\", _\n        (A.Value * D.Value), IIf(B.Value = \"Yk\", _\n        (A.Value * 12), IIf(B.Value = \"Ck\", _\n        (A.Value * 8), IIf(B.Value = \"Adet\", (A.Value * 1), _\n        IIf(B.Value = \"Kg\", (A.Value * 1000), IIf(B.Value = \"Lt\", _\n        (A.Value * 1), IIf(B.Value &gt; 7, \"\", False)))))))) * D.Value))\nEnd Function\n\n\nFunction SecondFormula(E As Range, F As Range, G As Range) As Variant\n    SecondFormula = IIf(G.Value = \"Gr\", ((F.Value * 1) * E.Value), _\n        IIf(G.Value = \"Ml\", ((F.Value / 16) * E.Value), _\n        IIf(G.Value = \"Paket\", (F.Value * E.Value), _\n        IIf(G.Value = \"Yk\", ((F.Value / 32) * E.Value), _\n        IIf(G.Value = \"Ck\", ((F.Value / 128) * E.Value), _\n        IIf(G.Value = \"Adet\", ((F.Value * 1) * E.Value), _\n        IIf(G.Value = \"Kg\", ((F.Value / 1000) * E.Value), _\n        IIf(G.Value = \"Lt\", ((F.Value / 1000) * E.Value), _\n        IIf(G.Value = \"\", \"0\", False)))))))))\nEnd Function\n</code></pre>\n\n<p>Then in a worksheet, for example, you could use</p>\n\n<pre><code>=FirstFormula(A4,B4,D4)\n</code></pre>\n\n<p>and it will be equivalent. Furthermore, the references to <code>A4</code>, <code>B4</code>, <code>D4</code> would update as expected when the formula is copied down a range.</p>\n\n<p><strong>On Further Edit</strong> If you want to pursue the idea of using VBA to <em>insert</em> the formulas directly in a cell, you would use something like:</p>\n\n<pre><code>Dim form As String\nform = \"=IF(G10=\"\"Gr\"\", ((F10*1)*E10),\"\nform = form &amp; \"IF(G10=\"\"Ml\"\",((F10/16)*E10),\"\nform = form &amp; \"IF(G10=\"\"Paket\"\",(F10*E10),\"\nform = form &amp; \"IF(G10=\"\"Yk\"\",((F10/32)*E10),\"\nform = form &amp; \"IF(G10=\"\"Ck\"\",((F10/128)*E10),\"\nform = form &amp; \"IF(G10=\"\"Adet\"\",((F10*1)*E10),\"\nform = form &amp; \"IF(G10=\"\"Kg\"\",((F10/1000)*E10),\"\nform = form &amp; \"IF(G10=\"\"Lt\"\",((F10/1000)*E10),\"\nform = form &amp; \"IF(G10=\"\"\"\",\"\"0\"\")))))))))\"\n\nRange(\"H10\").Formula = form\n</code></pre>\n\n<p>In the above I built up the formula string in stages in the interest of readability. You don't need to do that, but the result would be, well, less readable.</p>\n\n<p>Not that if you want quote marks to appear <em>inside</em> a string you have to double them up (use <code>\"\"</code> rather than <code>\"</code>) so that VBA can tell that the overall string isn't supposed to end there.</p>\n"}], "owner": {"reputation": 57, "user_id": 6542837, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d6ba1a6da4d1959a6bd24a229d032c1e?s=128&d=identicon&r=PG&f=1", "display_name": "Erol", "link": "https://stackoverflow.com/users/6542837/erol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490214183, "creation_date": 1490194218, "last_edit_date": 1531161705, "question_id": 42955104, "link": "https://stackoverflow.com/questions/42955104/excel-vba-cell-value-depending-other-cell", "title": "Excel vba cell value depending other cell", "body": "<p>H\u0131 all,</p>\n\n<p>I am trying to figure out how I can put a formule to do this.\n    Cell a  quantity\n    Cell b  unit\n    Cell c  unit price \n    Cell d   unit of cell b. \nSo\n    Cell a.   Cell b.    Cell c.   Cell d.    Cell e\n    100.       gram.     200.       kg.          20\n   If in cell b is gram chosen and cell d is.     kg then cell e must be cell c isdeviced by 1000 multiplied withcell a\n I have the formule in Excel, but want to put it in vba. Is more secure for accidents like deleting.</p>\n\n<p>This is the code I have and works well.\nHow can I put this in the vba editor? </p>\n\n<pre><code>=(IF(B4=\"Gr\",(A4*1),IF(B4=\"Ml\",\n   (A4*1),IF(B4=\"Paket\",\n (A4*D4),IF(B4=\"Yk\",\n (A4*12),IF(B4=\"Ck\",\n (A4*8),IF(B4=\"Adet\",(A4*1),\n IF(B4=\"Kg\",(A4*1000),IF(B4=\"Lt\",\n (A4*1),IF(B4&gt;7,\"\"))))))))*D4))\n\n\n=IF(G10=\"Gr\", ((F10*1)*E10),\nIF(G10=\"Ml\",((F10/16)*E10),\nIF(G10=\"Paket\",(F10*E10),\nIF(G10=\"Yk\",((F10/32)*E10),\nIF(G10=\"Ck\",((F10/128)*E10),\nIF(G10=\"Adet\",((F10*1)*E10),\nIF(G10=\"Kg\",((F10/1000)*E10),\nIF(G10=\"Lt\",((F10/1000)*E10),\nIF(G10=\"\",\"0\")))))))))\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 5, "creation_date": 1490194356, "post_id": 42954962, "comment_id": 73004963, "body": "<code>Me.Controls(&quot;Account&quot; &amp; number).Visible = True</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1490194452, "post_id": 42954962, "comment_id": 73005063, "body": "Consider <i>creating</i> textboxes at run-time instead of hiding/unhiding them."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5613056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-D7tQxylox_8/AAAAAAAAAAI/AAAAAAAAANA/aPXN-HMXtSU/photo.jpg?sz=128", "display_name": "Jon Chan", "link": "https://stackoverflow.com/users/5613056/jon-chan"}, "is_accepted": true, "score": 1, "last_activity_date": 1510034474, "creation_date": 1510034474, "answer_id": 47150959, "question_id": 42954962, "link": "https://stackoverflow.com/questions/42954962/vba-function-to-hide-userform-controls/47150959#47150959", "title": "VBA Function to Hide Userform Controls", "body": "<p>Adding to @Comintern's answer, solution is:</p>\n\n<pre><code>For i = 1 To 10\n    Me.Controls(\"Account\" &amp; i).Visible = True\nNext i\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5613056, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-D7tQxylox_8/AAAAAAAAAAI/AAAAAAAAANA/aPXN-HMXtSU/photo.jpg?sz=128", "display_name": "Jon Chan", "link": "https://stackoverflow.com/users/5613056/jon-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "accepted_answer_id": 47150959, "answer_count": 1, "score": 1, "last_activity_date": 1510034474, "creation_date": 1490193882, "question_id": 42954962, "link": "https://stackoverflow.com/questions/42954962/vba-function-to-hide-userform-controls", "title": "VBA Function to Hide Userform Controls", "body": "<p>I have 10 UserForm Controls with Names Account1 to Account10 that are defaulted as Visible = False. I am trying to create a Function to unhide the Controls in ascending numeric order.</p>\n\n<pre><code>Private Sub AddButton_Click()\nSelect Case CountTextBox.Value\nCase 1\n    Account1.Visible = True\nCase 2\n    Account2.Visible = True\nCase 3\n    Account3.Visible = True\nCase 4\n    Account4.Visible = True\nCase 5\n    Account5.Visible = True\nCase 6\n    Account6.Visible = True\nCase 7\n    Account7.Visible = True\nCase 8\n    Account8.Visible = True\nCase 9\n    Account9.Visible = True\nCase 10\n    Account10.Visible = True\nEnd Select\nEnd Sub\n</code></pre>\n\n<p>How can I simplify this VBA code?</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "conditional-formatting"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1490193667, "post_id": 42954665, "comment_id": 73004364, "body": "Change it to <code>Formula1:=&quot;=AND($N4=19, $R4=&quot;&quot;OR&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "edited": false, "score": 0, "creation_date": 1490209093, "post_id": 42954665, "comment_id": 73015137, "body": "Works perfectly and was able to further modify it to my needs.  Thanks!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1490194109, "creation_date": 1490194109, "answer_id": 42955056, "question_id": 42954665, "link": "https://stackoverflow.com/questions/42954665/multiple-conditional-formatting-variables-in-vba/42955056#42955056", "title": "Multiple Conditional Formatting Variables in VBA", "body": "<p>I believe the formula adjustment I made in comments above should solve your problem but here is how I clean up recorded Conditional Formatting code.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    With .Range(\"G4:R1000\")\n        With .FormatConditions.Add(Type:=xlExpression, Formula1:=\"=AND($N4=19, $R4=\"\"OR\"\")\")\n            With .Interior\n                .PatternColorIndex = xlAutomatic\n                .Color = 255\n                .TintAndShade = 0\n            End With\n            .SetFirstPriority\n        End With\n        .FormatConditions(1).StopIfTrue = True\n    End With\nEnd With\n</code></pre>\n\n<p>Removing the verbose qualifying code (e.g. <code>Selection.FormatConditions(Selection.FormatConditions.Count)...</code>) makes it much more readable.</p>\n"}], "owner": {"reputation": 87, "user_id": 4392011, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NxQlI.png?s=128&g=1", "display_name": "TKE-439", "link": "https://stackoverflow.com/users/4392011/tke-439"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 597, "favorite_count": 0, "accepted_answer_id": 42955056, "answer_count": 1, "score": 0, "last_activity_date": 1490200818, "creation_date": 1490193215, "last_edit_date": 1490200818, "question_id": 42954665, "link": "https://stackoverflow.com/questions/42954665/multiple-conditional-formatting-variables-in-vba", "title": "Multiple Conditional Formatting Variables in VBA", "body": "<p>Here's what I've got at the moment:</p>\n\n<pre><code>'Highlight If N=19 &amp; R=OR\nRange(\"G4:R1000\").Select\nSelection.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$N4=19\"\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 255\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = True\n</code></pre>\n\n<p>I am trying to highlight a few cells based on multiple criteria. If N=19 and if R=OR.  I can only get the N=19 portion to work.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1490193751, "post_id": 42954350, "comment_id": 73004439, "body": "First, is your Survey_InvoiceNumber&quot; column a string or a long? If you really want a leading zero (08..,05...,04...) its better to make a string, however it looks like a long as your dmax returns 8884 (no leading zero). Then, do you have a column storing the customer type, or do you rely only on the first digit of your invoice number to determine it (bad idea) ?"}, {"owner": {"reputation": 23, "user_id": 7435440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154232346208302/picture?type=large", "display_name": "Amy", "link": "https://stackoverflow.com/users/7435440/amy"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1490194180, "post_id": 42954350, "comment_id": 73004806, "body": "@Thomas G,  I&#39;ve got an attribute for the &#39;Customer_Type&#39; which is stored in &#39;Customer_tbl&#39;. I made the Survey_InvoiceNumber column short text to allow the number to start with 0, but it doesn&#39;t seem to have any affect in the form"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1490194229, "creation_date": 1490194229, "answer_id": 42955109, "question_id": 42954350, "link": "https://stackoverflow.com/questions/42954350/vba-access-dmax-invoice-number-criteria/42955109#42955109", "title": "VBA Access DMAX invoice number criteria", "body": "<p>Try this skeleton:</p>\n\n<pre><code>Me.txt_InvoiceNumber.Value = \"08\" &amp; Right(Format(Val(Nz(DMax(\"Survey_InvoiceNumber\", \"Survey_tbl\", \"Survey_InvoiceNumber Like '08*'\")) + 1), \"00000\"), 3)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7435440, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154232346208302/picture?type=large", "display_name": "Amy", "link": "https://stackoverflow.com/users/7435440/amy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 42955109, "answer_count": 1, "score": 0, "last_activity_date": 1490194229, "creation_date": 1490192492, "question_id": 42954350, "link": "https://stackoverflow.com/questions/42954350/vba-access-dmax-invoice-number-criteria", "title": "VBA Access DMAX invoice number criteria", "body": "<p>I'm trying to add an invoice number through using DMAX function to populate a textbox with the next consecutive invoice number. Depending on the estate agents name chosen in the combobox Me.cmb_CustomerType.Value, the invoice number (Survey_InvoiceNumber, Survey_tbl) will start with a different number e.g. Elmhurst will start with 08, Bridgfords will start with 05 and Harringtons durham will start with 04. \nI've tried using select statements, left, dmax, dlookup from various forums but can't get it to work and i'm at my wits end with it!</p>\n\n<pre><code>If cmb_CustomerType.Value = \"Elmhurst\" Then\nMe.txt_InvoiceNumber.Value = DMax(\"Survey_InvoiceNumber\", \"Survey_tbl\", \"08\") + 1\nEnd If\n\nIf cmb_CustomerType.Value = \"Bridgfords\" Then\n    Me.txt_InvoiceNumber = Nz(DMax(\"Survey_InvoiceNumber\", \"Survey_tbl\", \"05\") + 1)\nEnd If\n\nIf cmb_CustomerType.Value = \"Harringtons Durham\" Then\n    Me.txt_InvoiceNumber = Nz(DMax(\"Survey_InvoiceNumber\", \"Survey_tbl\", \"04\") + 1)\nEnd If\n</code></pre>\n\n<p>It's only returning '8884' for all of the estate agents as that is the highest number in that column. </p>\n\n<p>Results should be: Elmhurst - 08884, Harringtons Durham - 04048</p>\n\n<p>There's currently no value in for bridgfords, therefore it should start with 05000.</p>\n\n<p>Thanks in advance :) </p>\n"}, {"tags": ["excel", "directory", "subdirectory", "vba"], "comments": [{"owner": {"reputation": 1230, "user_id": 4064372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225de4472e4e944d85254f42f778d20d?s=128&d=identicon&r=PG&f=1", "display_name": "Edd", "link": "https://stackoverflow.com/users/4064372/edd"}, "edited": false, "score": 0, "creation_date": 1490193115, "post_id": 42954322, "comment_id": 73003882, "body": "you forgot to close the string"}, {"owner": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "reply_to_user": {"reputation": 1230, "user_id": 4064372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225de4472e4e944d85254f42f778d20d?s=128&d=identicon&r=PG&f=1", "display_name": "Edd", "link": "https://stackoverflow.com/users/4064372/edd"}, "edited": false, "score": 0, "creation_date": 1490195895, "post_id": 42954322, "comment_id": 73006223, "body": "Thanks, Edd.  I changed  &quot;False&quot; to &quot;True&quot; and it is working."}, {"owner": {"reputation": 1230, "user_id": 4064372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/225de4472e4e944d85254f42f778d20d?s=128&d=identicon&r=PG&f=1", "display_name": "Edd", "link": "https://stackoverflow.com/users/4064372/edd"}, "edited": false, "score": 0, "creation_date": 1490196786, "post_id": 42954322, "comment_id": 73006970, "body": "Cool, but the string is still left open :) I would suggest you edit your question  with the following (review it, make sure it works):  Len(Dir(&quot;E:xxx_xxSolutions\\xxx - xx Governance\\xxx Controls\\xxx Monitoring\\Monthly xxx Review\\&quot; &amp; MonthName(Month(Now()), True), vbDirectory))"}], "owner": {"reputation": 37, "user_id": 7690933, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-FUM7--pD4-o/AAAAAAAAAAI/AAAAAAAAACk/Rdqa2Wp8xmE/photo.jpg?sz=128", "display_name": "Eric ", "link": "https://stackoverflow.com/users/7690933/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 217, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490192762, "creation_date": 1490192413, "last_edit_date": 1531164843, "question_id": 42954322, "link": "https://stackoverflow.com/questions/42954322/select-current-month-folder-in-filepath", "title": "Select Current Month folder in filepath", "body": "<p>I am looking for a way to select the current month's folder and open a specific file where the current month folder is located in a folder named \"2017\" and includes all 12 months' folders.</p>\n\n<p>I can already go directly to a specific folder but trying to write a code that let's a user go to the 2017 folder then the code locates the current month's folder and Calls Reject_Review.  File type is not important as it may be a .csv, .xlsx, .xlsm depending on what we decide.   </p>\n\n<p>The code below is what I'm using to try to locate the current month folder.  This a folder path on a shared drive.</p>\n\n<pre><code>Sub CurrentMonthFolderOpenFile() \n\n\nApplication.DisplayAlerts = False \n\nIf Len(Dir(\"E:xxx_xxSolutions\\xxx - xx Governance\\xxx Controls\\xxx Monitoring\\Monthly xxx Review\\MonthName(Month(Date), False), vbDirectory)) = 0 Then Call Reject_Review\n\nEnd If \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "edited": false, "score": 0, "creation_date": 1490193211, "post_id": 42954254, "comment_id": 73003973, "body": "as far as i know you must open the work book to have access then wb. Sheets(&quot;your sheet name&quot;). cells(2,3). search open and close excel workbook."}, {"owner": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "edited": false, "score": 0, "creation_date": 1490193952, "post_id": 42954254, "comment_id": 73004621, "body": "The main issue that I have is each job will have a different basin name. Sometimes its a1, a2, a3 sometimes its g1, g2, g3, etc.  I am able to make excel copy all the content from a workbook in order to export it, but I would need it to be the paths and not the content, so that if there are changes in the future, I don&#39;t need to re-export everything.   the fact that each file will have a different name, I&#39;m not exactly sure how to have it open all the excel sheets in the folder, no matter the name, to copy the content using a path.   If not i&#39;d do a macro always searching the same ones."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1490197832, "post_id": 42954254, "comment_id": 73007780, "body": "@KevinFoster the documentation page has enough code samples to get you up and running. Check this link and come back when you run into a brick wall <a href=\"http://stackoverflow.com/documentation/excel-vba/1144/loop-through-all-sheets-in-active-workbook#t=201703221549492727315\">stackoverflow.com/documentation/excel-vba/1144/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 4764774, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-o02MjCOpEz0/AAAAAAAAAAI/AAAAAAAAAGc/tHgCE3X7Hck/photo.jpg?sz=128", "display_name": "Kevin Foster", "link": "https://stackoverflow.com/users/4764774/kevin-foster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490195567, "creation_date": 1490192234, "last_edit_date": 1490195567, "question_id": 42954254, "link": "https://stackoverflow.com/questions/42954254/macro-to-grab-data-from-various-excel-sheets", "title": "Macro to grab data from various excel sheets", "body": "<p>I am trying to make a macro that will grab data from closed excel sheets in a specific folder. </p>\n\n<p>Background: I have a job that is split into sections, but each section is quoted the same way but in a different file. Meaning the cells with the important data are always exactly the same. Ie: C16 is the square footage, C3 is the job cost, etc. </p>\n\n<p>What I want is a blank spreadsheet with one button that will pull the data from each sheet and make a table compiling all the data. </p>\n\n<p>Is it possible to have Excel search the folder where this \"blank spreadsheet\" is located and pull the data from a sheet Basin 1, then go down one line and do it for the sheet Basin 2, until there are no files left in the folder. </p>\n\n<p>Ie :</p>\n\n<p>Basin 1 xxxx</p>\n\n<p>Basin 2 xxxx</p>\n\n<p>Basin 3 xxxx</p>\n\n<p>Etc.</p>\n\n<p>Thanks a lot ! </p>\n"}, {"tags": ["excel", "vba", "formatting"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 1, "creation_date": 1490190053, "post_id": 42953291, "comment_id": 73001416, "body": "Are the <code>dd-mmm-yyy</code> cells&#39; values actually stored as strings or are they dates?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1490190108, "post_id": 42953291, "comment_id": 73001453, "body": "Are you using an English version of Excel or a different one? E.g. German/French/Bulgarian?"}, {"owner": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "edited": false, "score": 0, "creation_date": 1490193208, "post_id": 42953291, "comment_id": 73003972, "body": "- the cells are stored as &quot;custom&quot;, type is TT. MMM JJ"}, {"owner": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "edited": false, "score": 0, "creation_date": 1490193227, "post_id": 42953291, "comment_id": 73003985, "body": "- my excel is German"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "edited": false, "score": 0, "creation_date": 1490193555, "post_id": 42953664, "comment_id": 73004270, "body": "Oh, thank you very much! I see, yes, my excel is in German. I checked the user defined lists and there is indeed no English version of the months. I added the English ones, but this did not help to get the VBA working. Do I need to do more than adding it there...? I cannot manually change all the upper case, there are too many I get an updated list with these dates regularly, so I would need to find a permanent solution ie a working VBA."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "edited": false, "score": 0, "creation_date": 1490193771, "post_id": 42953664, "comment_id": 73004462, "body": "Replace <code>JAN</code> to <code>Jan</code>, <code>FEB</code> to <code>Feb</code> etc everywhere and it should work. You can automatize the replacement as well."}, {"owner": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "edited": false, "score": 0, "creation_date": 1490199274, "post_id": 42953664, "comment_id": 73008854, "body": "hm, I see, let me see whether I&#39;m able to do that. thank you very much."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "edited": false, "score": 0, "creation_date": 1490199429, "post_id": 42953664, "comment_id": 73008950, "body": "You just need 12 times replace. See here - <a href=\"http://stackoverflow.com/questions/8550240/access-vba-how-to-replace-parts-of-a-string-with-another-string\" title=\"access vba how to replace parts of a string with another string\">stackoverflow.com/questions/8550240/&hellip;</a>  or here  <a href=\"http://stackoverflow.com/questions/8571192/access-vba-to-trim-space-around-a-specific-character-or-wordss-in-a-column/8571442#8571442\" title=\"access vba to trim space around a specific character or wordss in a column\">stackoverflow.com/questions/8571192/&hellip;</a> for example."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1490190816, "creation_date": 1490190816, "answer_id": 42953664, "question_id": 42953291, "link": "https://stackoverflow.com/questions/42953291/vba-does-not-change-format-of-all-cells/42953664#42953664", "title": "VBA does not change format of all cells", "body": "<p>This happens, when you are using a non-English version of Excel.</p>\n\n<p>E.g., in the German version, 22.03.2016 is presented as <code>22.Mrz 16</code>. Thus, in your case, Excel does not understand that you are giving a date, when you give <code>22-MAR-2016</code>. The <code>UPPERCASE</code> is a bit problematic.</p>\n\n<p>Probably it is a good idea to change it to <code>22-Mar-2016</code> and try again, in my Excel it gets it quite ok. </p>\n\n<p>To see what your Excel understands, go to File>Options>Advanced>User defined lists. There you will see the following:\n<a href=\"https://i.stack.imgur.com/MYLuy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MYLuy.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 7751613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd7c75845359b8de8475fea1a9ed576?s=128&d=identicon&r=PG&f=1", "display_name": "Spring2017", "link": "https://stackoverflow.com/users/7751613/spring2017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 408, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1490190930, "creation_date": 1490189871, "last_edit_date": 1490189995, "question_id": 42953291, "link": "https://stackoverflow.com/questions/42953291/vba-does-not-change-format-of-all-cells", "title": "VBA does not change format of all cells", "body": "<p>I have a column (col. I) with dates that are in different formats: </p>\n\n<pre><code>16. Jul 98 // 22-MAR-2016 // 04-MAY-2015 //\n17. Jul 10 // 13-DEC-2011 // 25. Aug 98  // 12. Sep 11\n</code></pre>\n\n<p>I used the following code to change the format: </p>\n\n<pre><code>Sub numberformats()\n    Range(\"I:I\").NumberFormat = \"dd. mmm yyyy\"\nEnd Sub\n</code></pre>\n\n<p>However, while this worked fine on the cells with format dd. mmm yy, it did not work on the cells with format dd-mmm-yyy. Changing the format with a simply right-click - format cell did not help neither (this was my very first step, before moving over to VBA). </p>\n\n<p>I did an internet search, but all answers I found on similar problems were far too complex for me to adjust it to my problem. I'd be very glad to get some advise (I'm an absolute beginner with this...). </p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 2, "creation_date": 1490190297, "post_id": 42953199, "comment_id": 73001622, "body": "You are likely getting tripped up because you&#39;re heavily using <code>Select</code> and <code>Activate</code> when you don&#39;t need to. Look at <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/3554/always-use-option-explicit#t=201703221343556120854\">this</a>, <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/11274/always-define-and-set-references-to-all-workbooks-and-sheets#t=201703221343556120854\">this</a>, and <a href=\"http://stackoverflow.com/documentation/excel-vba/1107/vba-best-practices/9292/avoid-using-select-or-activate#t=201703221343556120854\">this</a>."}, {"owner": {"reputation": 49, "user_id": 7720775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87fa03ae77fd00c72d0ddcc0ace87014?s=128&d=identicon&r=PG&f=1", "display_name": "LBishop", "link": "https://stackoverflow.com/users/7720775/lbishop"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1490192956, "post_id": 42953199, "comment_id": 73003764, "body": "Thanks for the tips - new to all this so appreciate the advice"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7720775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87fa03ae77fd00c72d0ddcc0ace87014?s=128&d=identicon&r=PG&f=1", "display_name": "LBishop", "link": "https://stackoverflow.com/users/7720775/lbishop"}, "edited": false, "score": 0, "creation_date": 1490192827, "post_id": 42954007, "comment_id": 73003645, "body": "Breaks down on last line - &quot;object doesn&#39;t support property or method&quot;"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1490193092, "post_id": 42954007, "comment_id": 73003864, "body": "You need to use <code>PasteSpecial</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1490193114, "last_edit_date": 1490193114, "creation_date": 1490191613, "answer_id": 42954007, "question_id": 42953199, "link": "https://stackoverflow.com/questions/42953199/runtime-error-1004-paste-method-of-worksheet-class-failed/42954007#42954007", "title": "Runtime error 1004 : paste method of worksheet class failed", "body": "<p>Can you try it like this?</p>\n\n<pre><code>Range(\"A1:K2\").Copy\nWindows(\"EIL Depannage Register.xlsm\").Activate\nSheets(\"Raising Depannage\").Unprotect\nSheets(\"Import_Sheet\").Unprotect\nSheets(\"Import_Sheet\").Range(\"A1\").Paste\n</code></pre>\n\n<p>Edit:\nHow about like this:</p>\n\n<pre><code>Dim wb As Workbook\nDim ws As Worksheet\n\nset wb = activeworkbook\nset ws = activesheet\n\nWindows(\"EIL Depannage Register.xlsm\").Activate\nSheets(\"Raising Depannage\").Unprotect\nSheets(\"Import_Sheet\").Unprotect\n\nwb.ws.Range(\"A1:K2\").Copy\nWindows(\"EIL Depannage Register.xlsm\").Activate\nSheets(\"Import_Sheet\").Range(\"A1\").Paste\n</code></pre>\n\n<p>Play a bit, it should work.</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 7720775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87fa03ae77fd00c72d0ddcc0ace87014?s=128&d=identicon&r=PG&f=1", "display_name": "LBishop", "link": "https://stackoverflow.com/users/7720775/lbishop"}, "edited": false, "score": 0, "creation_date": 1490194574, "post_id": 42954649, "comment_id": 73005167, "body": "Thanks so much this work perfectly - sorry about the poor practices but i am new to vba and constantly learning... Thanks again :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 49, "user_id": 7720775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87fa03ae77fd00c72d0ddcc0ace87014?s=128&d=identicon&r=PG&f=1", "display_name": "LBishop", "link": "https://stackoverflow.com/users/7720775/lbishop"}, "edited": false, "score": 0, "creation_date": 1490194962, "post_id": 42954649, "comment_id": 73005508, "body": "No worries, it is common practice for novices as that is the way that recorded code shows up. Many of the answers here will try and steer you away from the Select and Activate methods. The recommended reading from <a href=\"http://stackoverflow.com/questions/42953199/runtime-error-1004-paste-method-of-worksheet-class-failed#comment73001622_42953199\">PeterT&#39;s comment</a> above is a good starting point."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1490193187, "creation_date": 1490193187, "answer_id": 42954649, "question_id": 42953199, "link": "https://stackoverflow.com/questions/42953199/runtime-error-1004-paste-method-of-worksheet-class-failed/42954649#42954649", "title": "Runtime error 1004 : paste method of worksheet class failed", "body": "<p>The <code>.Unprotect</code> commands are cancelling your <code>.CutCopyMode</code> so there is essentially nothing to paste. You will have to unprotect the worksheets <strong>before</strong> initiating a Copy and Paste operation.</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveSheet\n\nWindows(\"EIL Depannage Register.xlsm\").Activate\nWith ActiveWorkbook\n    .Worksheets(\"Raising Depannage\").Unprotect\n    With .Worksheets(\"Import_Sheet\")\n        .Unprotect\n        ws.Range(\"A1:K2\").Copy Destination:=.Range(\"A1\")\n    End With\nEnd With\n</code></pre>\n\n<p>I don't like using <code>ActiveSheet</code> to qualify the original worksheet but your code did not specify the workbook or worksheet and that left me little choice.</p>\n"}, {"tags": [], "owner": {"reputation": 2847, "user_id": 382588, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f52bc4ad81523f13d2275097f925a367?s=128&d=identicon&r=PG", "display_name": "Asaf", "link": "https://stackoverflow.com/users/382588/asaf"}, "is_accepted": false, "score": 0, "last_activity_date": 1490194656, "last_edit_date": 1490194656, "creation_date": 1490194291, "answer_id": 42955134, "question_id": 42953199, "link": "https://stackoverflow.com/questions/42953199/runtime-error-1004-paste-method-of-worksheet-class-failed/42955134#42955134", "title": "Runtime error 1004 : paste method of worksheet class failed", "body": "<p>try</p>\n\n<pre><code>dim shSrc as worksheet\ndim shTarget as worksheet\nset shSrc =Workbooks(\"EIL Depannage Register.xlsm\").Sheets(\"Raising Depannage\")\nset shTarget =Workbooks(\"EIL Depannage Register.xlsm\").Sheets(\"Raising Depannage\")\nshSrc.unprotect\nshTarget.unprotect\nshSrc.Range(\"A1:K2\").Copy\nshTarget. Range(\"A1\").Paste   \nshSrc.protect\nshTarget.protect\nset shsrc=nothing\nset shtarget=nothing`\n</code></pre>\n\n<p>just fix the source and target and verify the ranges</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11253883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2939c0a45e9cff94d45a4277f3d549fc?s=128&d=identicon&r=PG&f=1", "display_name": "Yuan Liu", "link": "https://stackoverflow.com/users/11253883/yuan-liu"}, "is_accepted": false, "score": 0, "last_activity_date": 1558433179, "last_edit_date": 1558433179, "creation_date": 1558424895, "answer_id": 56233571, "question_id": 42953199, "link": "https://stackoverflow.com/questions/42953199/runtime-error-1004-paste-method-of-worksheet-class-failed/56233571#56233571", "title": "Runtime error 1004 : paste method of worksheet class failed", "body": "<p>The last line of the code should be:</p>\n\n<pre><code>Sheets(\"Import_Sheet\").paste Range(\"A1\")\n</code></pre>\n\n<p>as paste is a method of worksheet, and <code>range(\"A1\")</code> is the destination argument.</p>\n"}], "owner": {"reputation": 49, "user_id": 7720775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87fa03ae77fd00c72d0ddcc0ace87014?s=128&d=identicon&r=PG&f=1", "display_name": "LBishop", "link": "https://stackoverflow.com/users/7720775/lbishop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3127, "favorite_count": 0, "accepted_answer_id": 42954649, "answer_count": 4, "score": 1, "last_activity_date": 1558433179, "creation_date": 1490189680, "last_edit_date": 1490193435, "question_id": 42953199, "link": "https://stackoverflow.com/questions/42953199/runtime-error-1004-paste-method-of-worksheet-class-failed", "title": "Runtime error 1004 : paste method of worksheet class failed", "body": "<p>There is lots of info on this error and how to fix but I've tried so many of them and nothing has worked: see below the problem chunk of code</p>\n\n<pre><code>Range(\"A1:K2\").Select\nSelection.Copy\nWindows(\"EIL Depannage Register.xlsm\").Activate\nSheets(\"Raising Depannage\").Select\nActiveSheet.Unprotect\nSheets(\"Import_Sheet\").Select\nActiveSheet.Unprotect\nRange(\"A1\").Select\nApplication.Wait (Now + TimeValue(\"00:00:10\"))\nActiveSheet.Paste    &lt;&lt;&lt;&lt;&lt;error happens at this line\n</code></pre>\n\n<p>Error occurring on the last line with .Paste.</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "edited": false, "score": 0, "creation_date": 1490188977, "post_id": 42952824, "comment_id": 73000600, "body": "Try enabling &quot;allow multiple selection&quot; in the page-filter"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "reply_to_user": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "edited": false, "score": 0, "creation_date": 1490189235, "post_id": 42952824, "comment_id": 73000785, "body": "I have enabled the allow multiple selection in the filter but it prompts the same error for the application.username."}, {"owner": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "edited": false, "score": 1, "creation_date": 1490189819, "post_id": 42952824, "comment_id": 73001229, "body": "Could it be that Application.UserName is not available in the &quot;Caretaker&quot;-List?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "reply_to_user": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "edited": false, "score": 0, "creation_date": 1490191081, "post_id": 42952824, "comment_id": 73002242, "body": "it&#39;s not available. Because application.username will get the name of the user in File &gt; General &gt; User name. But it seems it&#39;s not getting it and prompting me an error of &quot;Application-defined or object-defined error&quot;. I am not sure what causes this error. Maybe this is not allowed."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490193309, "post_id": 42952824, "comment_id": 73004065, "body": "Maybe you mean to use Environ(&quot;USERNAME&quot;) ?"}, {"owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "edited": false, "score": 0, "creation_date": 1490199264, "post_id": 42952824, "comment_id": 73008849, "body": "I also tried to replace application.username to Environ(&quot;USERNAME&quot;) but gives the same error."}], "owner": {"reputation": 173, "user_id": 6777535, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/hF0eY.jpg?s=128&g=1", "display_name": "Sevpoint", "link": "https://stackoverflow.com/users/6777535/sevpoint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490188718, "creation_date": 1490188718, "last_edit_date": 1531164843, "question_id": 42952824, "link": "https://stackoverflow.com/questions/42952824/username-fullname-as-filter-in-pivot-table", "title": "UserName / FullName as Filter in Pivot Table", "body": "<p>I have created a pivot table which the source is in another sheet called database and this is connected to a sharepoint list. </p>\n\n<p>In the pivot table, I wanted to set / filter the Caretaker to whoever opened the macro file instead of \"All\".All of the users open the macro file can be found in the database sheet. I have set the .currentPage = Application.UserName. So whenever they open the file, only their processed items will be displayed. but it gives me an error \"Application-defined or object-defined error\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/sqBda.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sqBda.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is my code: </p>\n\n<pre><code>Sub RefreshQuery()\n\n Dim timestamp As String\n\n timestamp = UCase(Format(Now(), \"dd-mmm-yyyy hh:mm:ss\"))\n\n With Sheets(\"DATABASE\")\n\n    .Range(\"Table_owssvr\").ListObject.QueryTable.Refresh\n    .Range(\"Table_owssvr_returned\").ListObject.QueryTable.Refresh\n\n End With\n\n\nWith Sheets(\"SUMMARY\")\n    With .PivotTables(\"PivotTable1\")\n        .PivotCache.Refresh\n        .PivotFields(\"CARETAKER\").ClearAllFilters\n        .PivotFields(\"CARETAKER\").CurrentPage = Application.UserName\n        .PivotFields(\"CARETAKER\").PivotItems(\"CARETAKER\").Visible = False\nEnd With\n.Shapes(\"Rectangle 1\").TextFrame.Characters.Text = \"LAST UPDATED:    \" &amp; timestamp\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>Is it possible that the .currentPage in pivot table will be equal to the Full Name of the user opened the file? </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 524, "user_id": 7648526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b54db50ad2bfd167b85f1686dd47b28d?s=128&d=identicon&r=PG&f=1", "display_name": "SteveES", "link": "https://stackoverflow.com/users/7648526/stevees"}, "edited": false, "score": 1, "creation_date": 1490191585, "post_id": 42952818, "comment_id": 73002647, "body": "Copy and paste the cells on Sheet1, deleting extra columns on the right afterwards. If you cut and paste, Excel will automatically update the formulas on Sheet2."}, {"owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "edited": false, "score": 0, "creation_date": 1490257060, "post_id": 42952818, "comment_id": 73033530, "body": "I was thinking a about some VBA code, but this is a good solution. Thanks!"}], "tags": [], "owner": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1490188705, "creation_date": 1490188705, "answer_id": 42952818, "question_id": 42952661, "link": "https://stackoverflow.com/questions/42952661/massive-offset-to-entire-excel-sheet/42952818#42952818", "title": "Massive offset to entire Excel sheet", "body": "<p>If you want to do it just once, a simple solution would be to insert 3 columns on Sheet1 before column A. The formulas on Sheet2 will be offset as you requested.\nAfter that, simply cut everything on Sheet1 starting at D1 and Paste it into A1.</p>\n"}], "owner": {"reputation": 1756, "user_id": 1008588, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ijUnZ.jpg?s=128&g=1", "display_name": "Nicolaesse", "link": "https://stackoverflow.com/users/1008588/nicolaesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 42952818, "answer_count": 1, "score": 3, "last_activity_date": 1490188737, "creation_date": 1490188315, "last_edit_date": 1490188737, "question_id": 42952661, "link": "https://stackoverflow.com/questions/42952661/massive-offset-to-entire-excel-sheet", "title": "Massive offset to entire Excel sheet", "body": "<p>I have one MS Excel file with 2 sheets. The first Sheet contains user input and the second one contains formula.</p>\n\n<p><strong>Sheet1</strong></p>\n\n<pre><code>+---+---+---+---+---+---+\n|   | A | B | C | D | E |\n+---+---+---+---+---+---+\n| 1 | 1 |   | 0 | 9 |   |\n| 2 | 9 | 7 |   | 3 | 2 |\n| 3 | 8 |   |   | 4 |   |\n| 4 | 4 |   |   | 8 |   |\n+---+---+---+---+---+---+\n</code></pre>\n\n<p><strong>Sheet2</strong></p>\n\n<pre><code>+---+--------------------------------+\n|   |               A                |\n+---+--------------------------------+\n| 1 | =SUM(Sheet1!A1:A2)             |\n| 2 | =PRODUCT(Sheet1!A4*Sheet11!B2) |\n| 3 | =MEAN(Sheet1!A1:A3)            |\n+---+--------------------------------+\n</code></pre>\n\n<p>I would like that every formula in the <em>Sheet2</em> takes an offset of three cell to the right. So, the example, would became:</p>\n\n<p><strong>Sheet2 (after offset)</strong></p>\n\n<pre><code>+---+--------------------------------+\n|   |               A                |\n+---+--------------------------------+\n| 1 | =SUM(Sheet1!D1:D2)             |\n| 2 | =PRODUCT(Sheet1!D4*Sheet11!E2) |\n| 3 | =MEAN(Sheet1!D1:D3)            |\n+---+--------------------------------+\n</code></pre>\n\n<p>How could I do that?\nI know that I could use the OFFSET formula but it would be a very ugly solution applied to an entire sheet (with 36000 rows and more than 200 columns).</p>\n\n<p>I don't have any code to post because I don't know how to start solving the problem.</p>\n"}, {"tags": ["vba", "excel", "file-browser"], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1490188491, "creation_date": 1490188491, "answer_id": 42952738, "question_id": 42952546, "link": "https://stackoverflow.com/questions/42952546/how-do-i-use-excel-vba-to-copy-a-worksheet-from-a-workbook-selected-using-a-file/42952738#42952738", "title": "How do I use Excel VBA to copy a worksheet from a workbook selected using a file browser?", "body": "<p>Try this. Use the string result from the <code>GetOpenFileName</code> and pass it directly to the <code>Workbooks.Open</code> method, handling the return value as an object (workbook) which assigns to <code>yesterdayWB</code> object. </p>\n\n<p>Also, you have an error:</p>\n\n<pre><code>yesterdayWB(1).Copy After:=todayWB.Sheets(1)\n</code></pre>\n\n<p>The workbook object is not subscriptable, what you meant (I think) was <code>yesterdayWB.Worksheets(1).Copy ...</code></p>\n\n<pre><code>Sub Macro5()\n\n    Dim yesterdayWB As Workbook\n    Dim yesterdayWBName As String\n    Dim todayWB As Workbook\n\n    Set todayWB = ActiveWorkbook\n\n    'open file from last business day\n    yesterdayWBName = Application.GetOpenFilename( _\n                      Title:=\"Select backorder file from last business day\", _\n                      MultiSelect:=False)\n    If yesterdayWBName = False Then\n        Exit Sub\n    End If\n    Set yesterdayWB = Workbooks.Open(yesterdayWBName)\n\n    'copy in yesterday's info\n    yesterdayWB.Worksheets(1).Copy After:=todayWB.Sheets(1)\n    yesterdayWB.Close\n    ' the sheet you copied is at index \"2\" because you put it after Sheets(1)\n    todayWB.Sheets(2).Name = \"YesterdayResolution\"\n    todayWB.Sheets(1).Activate\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7751433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577bdb76658878dfb77d3af215079efb?s=128&d=identicon&r=PG&f=1", "display_name": "mmcgill", "link": "https://stackoverflow.com/users/7751433/mmcgill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 42952738, "answer_count": 1, "score": 0, "last_activity_date": 1490195591, "creation_date": 1490188026, "last_edit_date": 1490195591, "question_id": 42952546, "link": "https://stackoverflow.com/questions/42952546/how-do-i-use-excel-vba-to-copy-a-worksheet-from-a-workbook-selected-using-a-file", "title": "How do I use Excel VBA to copy a worksheet from a workbook selected using a file browser?", "body": "<p>I'm trying to create what I thought should be a really simple Macro.  I deal with the same report every day, which is updated each morning.  That said, it would be really nice for me to be able to have the data I worked with yesterday in the same workbook as the new data from a given morning.</p>\n\n<p>Basically, all I want to do is copy a worksheet from a different workbook (the one with yesterday's report) into my active workbook (the one with today's report) using a file browser.</p>\n\n<p>The Application.GetOpenFilename method opens up a file browser like what I want, but I can't figure out how to use the directory string that it returns to copy in the worksheet I want.</p>\n\n<p>Here's the code I've been using:</p>\n\n<pre><code>Sub Macro5()\n\nDim todayWBName As String\nDim yesterdayWB As Workbook\nSet todayWB = ActiveWorkbook\ntodayWBName = todayWB.Name\n\n'open file from last business day\n    yesterdayWBName = Application.GetOpenFilename( _\n                      Title:=\"Select backorder file from last business day\", _\n                      MultiSelect:=False)\n    If yesterdayWBName = False Then\n        Exit Sub\n    Else\n        End If\n    Workbooks.Open yesterdayWBName\n    Set yesterdayWB = ActiveWorkbook\n    todayWB.Activate\n\n'copy in yesterday's info\n    yesterdayWB(1).Copy After:=todayWB.Sheets(1)\n    yesterdayWB.Close\n    Sheets(\"Sheet 1 (2)\").Name = \"YesterdayResolution\"\n    Sheets(1).Activate\n\nEnd Sub\n</code></pre>\n\n<p>If anyone could tell me what I'm doing wrong here, I'd really appreciate it.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel", "recursion"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1490187338, "post_id": 42952050, "comment_id": 72999404, "body": "Unless there&#39;s a built-in property of the range object to do this I can only imagine headache due to named ranges, sheet references, workbook references, connections, etc.  But are you assuming all of your cell values are only of the form A1 or $A$1 ?"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1490187463, "post_id": 42952050, "comment_id": 72999507, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/office/ff197707.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff197707.aspx</a> perhaps?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1490187593, "post_id": 42952050, "comment_id": 72999601, "body": "Cough - don&#39;t you mean <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196936.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/ff196936.aspx</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": true, "score": 2, "last_activity_date": 1490190825, "last_edit_date": 1490190825, "creation_date": 1490189339, "answer_id": 42953079, "question_id": 42952050, "link": "https://stackoverflow.com/questions/42952050/recursively-extract-values-from-formula-in-vba/42953079#42953079", "title": "Recursively extract values from Formula in VBA", "body": "<p>This code will work for your example - but YMMV for how it will scale to more complex formulas in real life. However, it will get you started - and then some- with how to recurse over the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196936.aspx\" rel=\"nofollow noreferrer\"><code>Precedents</code></a> collection of a <code>Range</code>. I've commented the code but the easiest way to understand it is to step through in debug mode with F8.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim strOutput As String\n\n    'your test case from the original question    \n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    With ws\n        .Range(\"A1\").Formula = \"=+B1\"\n        .Range(\"B1\").Formula = \"=+C1-C2\"\n        .Range(\"C1\").Value = \"10\"\n        .Range(\"C2\").Formula = \"=+D1-D2\"\n        .Range(\"D1\").Value = \"20\"\n        .Range(\"D2\").Value = \"30\"\n    End With\n\n    'the cell you want to start from\n    Set rng = Sheet1.Range(\"A1\")\n\n    'get the output from calling the recursive function\n    'note we pass the original formula in to kick off the function\n    strOutput = rng.Address(0, 0) &amp; GetFullFormula(rng, rng.Formula)\n\n    'show user\n    MsgBox strOutput\n\nEnd Sub\n\nFunction GetFullFormula(rng As Range, strFormula As String) As String\n\n    Dim rngPrecedents As Range\n    Dim rngPrecedent As Range\n    Dim strPrecedentAddress As String\n    Dim strPrecedentFormula As String\n\n    If rng.HasFormula Then\n        Set rngPrecedents = rng.Precedents\n        For Each rngPrecedent In rngPrecedents\n            'get the precedent cell address to check if in current formula (without $)\n            strPrecedentAddress = rngPrecedent.Address(0, 0)\n            'Debug.Print strFormula\n            'substiute into formula if matching a range address\n            If rngPrecedent.HasFormula Then\n                If InStr(1, strFormula, strPrecedentAddress, vbBinaryCompare) Then\n                    'strip = from formula and put in brackets to preserve ordering\n                    strPrecedentFormula = \"(\" &amp; Mid(rngPrecedent.Formula, 2, Len(rngPrecedent.Formula) - 1) &amp; \")\"\n                    'replace our formula with precedent formula\n                    strFormula = Replace(strFormula, strPrecedentAddress, strPrecedentFormula)\n                End If\n                'carry on with recursion - passes formula back into function for expansion\n                GetFullFormula rngPrecedent, strFormula \n            Else\n                'just a value\n                If InStr(1, strFormula, strPrecedentAddress, vbBinaryCompare) Then\n                    'replace the address with the value\n                    strFormula = Replace(strFormula, strPrecedentAddress, rngPrecedent.Value)\n                End If\n            End If\n        Next rngPrecedent\n    End If\n\n    GetFullFormula = strFormula\n\nEnd Function\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>=+(+10-(+20-30))\n</code></pre>\n\n<p>There will be a problem with this code if you are using cell references like <code>$A$1</code> because the function expects plain cell references. The code could be extended to handle these cases, and named ranges too, but this is just a basic example.</p>\n"}], "owner": {"reputation": 75, "user_id": 4981298, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211364685986051/picture?type=large", "display_name": "Franco", "link": "https://stackoverflow.com/users/4981298/franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 42953079, "answer_count": 1, "score": 1, "last_activity_date": 1490192827, "creation_date": 1490186787, "last_edit_date": 1490192827, "question_id": 42952050, "link": "https://stackoverflow.com/questions/42952050/recursively-extract-values-from-formula-in-vba", "title": "Recursively extract values from Formula in VBA", "body": "<p>I would like to recursively look in a formula of a range object until I find every single value of which it is composed of. \nSince I'm not so sure about the grammatical correctness of the previous sentence (in any case, I apologize for my English) I will try to explain what I would like to accomplish by an example (hoping this could be the simplest one):</p>\n\n<pre><code>    mysheet = \"Sheet1\"\n    Sheets(mysheet).Range(\"A1\").Formula = \"=+B1\"\n    Sheets(mysheet).Range(\"B1\").Formula = \"=+C1-C2\"\n    Sheets(mysheet).Range(\"C1\").Value = \"value:val1\" \n    Sheets(mysheet).Range(\"C2\").Formula = \"=+D1-D2\"\n    Sheets(mysheet).Range(\"D1\").Value = \"value:val2\"\n    Sheets(mysheet).Range(\"D2\").Value = \"value:val3\"\n</code></pre>\n\n<p>Can you give me a hint (or better a draft of code) on what kind of function (a recursive one, maybe?) can return a string (let's call it my_formula) such that the command </p>\n\n<pre><code>    MsgBox(my_formula) \n</code></pre>\n\n<p>will return the following: </p>\n\n<pre><code>    A1 = +value:val1 - value:val2 + value:val3\n</code></pre>\n\n<p>? Please help me</p>\n\n<p>Thank you</p>\n\n<p>UPDATE AFTER LESS THAN ONE HOUR</p>\n\n<p>Hi to all and many thanks for your answers. I would point out that the values in cells are effectively strings + I have just simple operations (+ and -) + All the dependencies are in the same sheet + I don't have ranges such as $X$1. However, I am aware of the methods/properties posted by some of you (precedent, NavigateArrow...) but what I asked is an idea on how to use in the best way this kind of method/properties without getting headaches.</p>\n\n<p>Thank you again</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 1, "creation_date": 1490186944, "post_id": 42952002, "comment_id": 72999100, "body": "You should post the full code including the logic for <code>cond1</code>, <code>cond2</code> and <code>cond3</code>"}, {"owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490188081, "post_id": 42952002, "comment_id": 72999922, "body": "The exact conditions have nothing to do with my question and including them would clutter up the code a lot, so I decided to leave them out and include an example instead."}], "answers": [{"tags": [], "owner": {"reputation": 578, "user_id": 5953505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T8OeQ.png?s=128&g=1", "display_name": "UberDoodles", "link": "https://stackoverflow.com/users/5953505/uberdoodles"}, "is_accepted": true, "score": 1, "last_activity_date": 1490187216, "creation_date": 1490187216, "answer_id": 42952227, "question_id": 42952002, "link": "https://stackoverflow.com/questions/42952002/condition-evaluating-to-type-mismatch-on-empty-row/42952227#42952227", "title": "Condition evaluating to type mismatch on empty row", "body": "<p>Give this a go :</p>\n\n<pre><code>row = 2\n\nDo Until Range(\"A\" &amp; row).Value = \"\"\n    If (row satisfies cond1 And cond2 And cond 3) Then Exit Do\n    row = row + 1\nLoop\n\nIf Range(\"A\" &amp; row).Value = \"\" Then\n    myval = 0\nElse\n    myval = something taken from row\nEnd If\n</code></pre>\n\n<p>So basically, loop until you get to the end of the table, but break out of the loop if you find an appropriate value.</p>\n"}], "owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 42952227, "answer_count": 1, "score": 0, "last_activity_date": 1490187216, "creation_date": 1490186664, "last_edit_date": 1531164843, "question_id": 42952002, "link": "https://stackoverflow.com/questions/42952002/condition-evaluating-to-type-mismatch-on-empty-row", "title": "Condition evaluating to type mismatch on empty row", "body": "<p>I'm writing a macro that searches a large table of data to find a row that satisfies several conditions and take some values from it. Sometimes there will be no row to find and in such cases I want my values to be 0. The algorithm I use is:</p>\n\n<pre><code>row = 2\n\nDo Until (row satisfies cond1 And cond2 And cond 3) Or Range(\"A\" &amp; row).Value = \"\"\n    row = row + 1\nLoop\n\nIf Range(\"A\" &amp; row).Value = \"\" Then\n    myval = 0\nElse\n    myval = something taken from row\nEnd If\n</code></pre>\n\n<p>I get a problem whenever one of my conditions evaluates to type mismatch when tested on an empty row* - if no row is found and the code arrives at the end, I get an error and the macro never checks that it indeed is at the end of the data.</p>\n\n<p>*Example: one of my conditions tests a Date variable against a date stored as text, so I use <code>mydate = Datevalue(text in row)</code> to test and this leads to type mismatch if text is empty.</p>\n\n<p>Do you know a simple solution to this problem? The easiest thing I can think of is calculating number of rows before and switching to a <code>For</code> loop, but this definitely will add some extra variables and calculations. </p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490186282, "post_id": 42951801, "comment_id": 72998624, "body": "what <code>Range</code> are you tyring to get to <code>Set agentRange</code> ? if you add a line after this line of <code>Debug.Print agentRange.Address</code> , what do you get ?"}, {"owner": {"reputation": 3865, "user_id": 584994, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e71ae3bdea74b68a3f7abcdd8155fcc1?s=128&d=identicon&r=PG", "display_name": "Mytheral", "link": "https://stackoverflow.com/users/584994/mytheral"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490186639, "post_id": 42951801, "comment_id": 72998884, "body": "That part returns the correct range. That particular statement lets you crop what chunk of the data you generate a report for. The range set is C1 to BN1. col then returns 3 as expected."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 2, "creation_date": 1490186722, "post_id": 42951801, "comment_id": 72998940, "body": "the in your error you mean <code>Set cellStart = ThisWorkbook.Worksheets(&quot;OtherSheet&quot;).Cells(3, col))</code>, right ? you are missing the <code>Set</code> for setting the <code>Range</code>"}, {"owner": {"reputation": 3865, "user_id": 584994, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e71ae3bdea74b68a3f7abcdd8155fcc1?s=128&d=identicon&r=PG", "display_name": "Mytheral", "link": "https://stackoverflow.com/users/584994/mytheral"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1490187085, "post_id": 42951801, "comment_id": 72999215, "body": "@ShaiRado that was it. Thanks Much! You should make that an answer so I can accept it."}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1490187193, "creation_date": 1490187193, "answer_id": 42952213, "question_id": 42951801, "link": "https://stackoverflow.com/questions/42951801/excel-issue-with-using-only-ints-to-get-range/42952213#42952213", "title": "Excel - Issue with using only ints to get range", "body": "<p>The reason for the error is <code>cellStart</code> is a <code>Range</code>.</p>\n\n<p>Therefore, you need to <code>Set</code> it with:</p>\n\n<pre><code>Set cellStart = ThisWorkbook.Worksheets(\"OtherSheet\").Cells(3, col)\n</code></pre>\n\n<p><em>Note</em>: you have one \"extra\" closing bracket at the end, you have 2 <code>))</code> instead of just <code>)</code></p>\n"}], "owner": {"reputation": 3865, "user_id": 584994, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/e71ae3bdea74b68a3f7abcdd8155fcc1?s=128&d=identicon&r=PG", "display_name": "Mytheral", "link": "https://stackoverflow.com/users/584994/mytheral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 42952213, "answer_count": 1, "score": 1, "last_activity_date": 1490187193, "creation_date": 1490186102, "question_id": 42951801, "link": "https://stackoverflow.com/questions/42951801/excel-issue-with-using-only-ints-to-get-range", "title": "Excel - Issue with using only ints to get range", "body": "<pre><code>    Dim cell As Range\n    Dim agentRange As Range\n\n    Set agentRange = ThisWorkbook.Worksheets(\"OtherSheet\").Range(Range(\"S9\").value, Range(\"T9\").value)\n\n    For Each cell In agentRange\n\n        Dim col As Long\n        col = cell.column\n\n        Dim cellStart As Range\n        ***cellStart = ThisWorkbook.Worksheets(\"OtherSheet\").Cells(3, col))***\n\n       'Do Stuff\n\n    Next cell\n</code></pre>\n\n<p>So I'm having problems with my cellStart assignment. When I attempt to use the code as written I'm receiving an error. </p>\n\n<pre><code>Run-time error '91'\n\nObject Variable or With block variable not set\n</code></pre>\n"}, {"tags": ["excel", "image", "vba", "mousehover"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7080769, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-i--4HIxruxc/AAAAAAAAAAI/AAAAAAAAC3I/5tTLHLWNei8/photo.jpg?sz=128", "display_name": "Tramyer", "link": "https://stackoverflow.com/users/7080769/tramyer"}, "edited": false, "score": 0, "creation_date": 1490239097, "post_id": 42951640, "comment_id": 73027006, "body": "Hi Basslo, Thank you i did add image1.picture = loadpicture (picpath)"}], "tags": [], "owner": {"reputation": 885, "user_id": 1758897, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hMoc1.png?s=128&g=1", "display_name": "basslo", "link": "https://stackoverflow.com/users/1758897/basslo"}, "is_accepted": false, "score": 0, "last_activity_date": 1490185642, "creation_date": 1490185642, "answer_id": 42951640, "question_id": 42951473, "link": "https://stackoverflow.com/questions/42951473/change-image-when-mouse-hovers-on-buttons/42951640#42951640", "title": "Change image when mouse hovers on buttons", "body": "<p>you should implement the mouseMove event of your Button.</p>\n\n<pre><code>Private Sub YourButtonName_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n  'your Code Here \n\nEnd Sub\n</code></pre>\n\n<p>But watch out this is called each time you move the mouse on the button. So You should check whenever you draw the image or not.</p>\n"}], "owner": {"reputation": 13, "user_id": 7080769, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-i--4HIxruxc/AAAAAAAAAAI/AAAAAAAAC3I/5tTLHLWNei8/photo.jpg?sz=128", "display_name": "Tramyer", "link": "https://stackoverflow.com/users/7080769/tramyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 512, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490192684, "creation_date": 1490185192, "last_edit_date": 1490192684, "question_id": 42951473, "link": "https://stackoverflow.com/questions/42951473/change-image-when-mouse-hovers-on-buttons", "title": "Change image when mouse hovers on buttons", "body": "<p>I just wanna ask. What will be the code if the mouse will hover on the buttons and then suddenly the image in the userform will instantly change.</p>\n\n<p>Btw this is Excel VBA.</p>\n\n<p>Please see below the image.</p>\n\n<p>[<img src=\"https://i.stack.imgur.com/oolyu.jpg\" alt=\"enter image description here[1]\"></p>\n\n<p>Thank you and regards,</p>\n"}, {"tags": ["excel", "vba", "copy", "formulas"], "answers": [{"tags": [], "owner": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1490185791, "creation_date": 1490185791, "answer_id": 42951680, "question_id": 42951375, "link": "https://stackoverflow.com/questions/42951375/copy-worksheet-to-multiple-workbooks-formula-references/42951680#42951680", "title": "Copy worksheet to multiple workbooks - formula references", "body": "<p>You could just deleted the inserted references after you have copied the sheet. For example, if your source workbook is named \"Source.xlsx\":</p>\n\n<pre><code>Cells.Replace What:=\"=[Source.xlsx]\", Replacement:=\"=\", LookAt:=xlPart _\n, SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _ \nReplaceFormat:=False\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 7750913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd86d967985cc008d20b5c15b6460135?s=128&d=identicon&r=PG&f=1", "display_name": "ArtyK", "link": "https://stackoverflow.com/users/7750913/artyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1566, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1490185791, "creation_date": 1490184942, "question_id": 42951375, "link": "https://stackoverflow.com/questions/42951375/copy-worksheet-to-multiple-workbooks-formula-references", "title": "Copy worksheet to multiple workbooks - formula references", "body": "<p>I have used the following Macro, that I found on another forum to copy one sheet into multiple other worksheets:</p>\n\n<pre><code>    Option Explicit\nPublic Sub CopySheetToAllWorkbooksInFolder()\n\n    Dim sourceSheet As Worksheet\n    Dim folder As String, filename As String\n    Dim destinationWorkbook As Workbook\n\n    'Worksheet in active workbook to be copied as a new sheet to the destination woorkbook\n\n    Set sourceSheet = ActiveWorkbook.Worksheets(\"Sheet1\")\n\n    'Folder containing the destination workbooks\n\n    folder = \"F:\\temp\\excel\\\"\n\n    filename = Dir(folder &amp; \"*.xls\", vbNormal)\n    While Len(filename) &lt;&gt; 0\n        Debug.Print folder &amp; filename\n        Set destinationWorkbook = Workbooks.Open(folder &amp; filename)\n        sourceSheet.Copy before:=destinationWorkbook.Sheets(1)\n        destinationWorkbook.Close True\n        filename = Dir()  ' Get next matching file\n    Wend\n End Sub\n</code></pre>\n\n<p>The source worksheet, that I want to copy into the other destination worksheets has formulas (related to other worksheets in the source file). \nAfter running the macro, the formulas in the destination worksheet, still have references to the source worksheet instead of the destination worksheet.</p>\n\n<p>How could I modify the macro in order to to adjust the references to the new workbook?</p>\n\n<p>Thanks a lot in advance!</p>\n\n<p>Best,\nArthur</p>\n"}, {"tags": ["excel", "modeling", "vba"], "comments": [{"owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "edited": false, "score": 0, "creation_date": 1490185600, "post_id": 42951103, "comment_id": 72998131, "body": "What formula you are using in cell <code>E25</code>? In case of <code>K22:K25</code> from where data will come? Means data source?"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 0, "last_activity_date": 1490186777, "creation_date": 1490186777, "answer_id": 42952048, "question_id": 42951103, "link": "https://stackoverflow.com/questions/42951103/changing-cells-dynamically-from-the-results-of-a-drop-down-list-in-excel/42952048#42952048", "title": "Changing cells dynamically from the results of a drop down list in excel", "body": "<p>You might use a formula like this in K22:K24. </p>\n\n<pre><code>=Index($J$22:$J$24, MATCH($C$2, $I$22:$I$24, 0), 1)\n</code></pre>\n\n<p>This will give you one of the values in J22:J24, depending upon what was chosen in C2. I presume you would want to multiply that value with something. That might be a value you extract from another range using a similar function. </p>\n\n<p>J22:J24 must contain the same values as the dropdown. Normally, you would do all of this with named ranges and use the same named range to feed the dropdown as you use for determining the choice the user made.</p>\n\n<p>Try the MATCH function independently to get a better feel for it.</p>\n\n<pre><code>= MATCH($C$2, $I$22:$I$24, 0)\n</code></pre>\n\n<p>It will return a number between 1 and 3, depending on the choice in A3.</p>\n"}], "owner": {"reputation": 51, "user_id": 7472522, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c3d164b58f08e99da54db01ac33be9?s=128&d=identicon&r=PG&f=1", "display_name": "keysersoze977", "link": "https://stackoverflow.com/users/7472522/keysersoze977"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1107, "favorite_count": 0, "accepted_answer_id": 42952048, "answer_count": 1, "score": 0, "last_activity_date": 1490186777, "creation_date": 1490184199, "last_edit_date": 1531161705, "question_id": 42951103, "link": "https://stackoverflow.com/questions/42951103/changing-cells-dynamically-from-the-results-of-a-drop-down-list-in-excel", "title": "Changing cells dynamically from the results of a drop down list in excel", "body": "<p>I was building a financial model and ran into this problem. Cell C2 contains the dropdown list and the value E25 changes according to the dropdown list. What I want is for the present value column in K22:K25 to change automatically. FOr example, if I choose normal in the dropdown list, I want the value of E25 to update automatically in K22. Thanks in advance! <a href=\"https://i.stack.imgur.com/XDrkn.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XDrkn.jpg\" alt=\"This is the excel file\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7361, "user_id": 579895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf1b4bf925a10e6387c4960c979ca535?s=128&d=identicon&r=PG", "display_name": "Pikoh", "link": "https://stackoverflow.com/users/579895/pikoh"}, "edited": false, "score": 0, "creation_date": 1490182941, "post_id": 42950578, "comment_id": 72996218, "body": "You should give more information. Edit yout question and paste the complete exception so we can see exactly where is the error"}, {"owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "reply_to_user": {"reputation": 7361, "user_id": 579895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf1b4bf925a10e6387c4960c979ca535?s=128&d=identicon&r=PG", "display_name": "Pikoh", "link": "https://stackoverflow.com/users/579895/pikoh"}, "edited": false, "score": 0, "creation_date": 1490183198, "post_id": 42950578, "comment_id": 72996386, "body": "Sorry, this line gets highlighted &quot;.txtLoggedBy.Value = CallDetails(Index).Value&quot; not sure why"}, {"owner": {"reputation": 7361, "user_id": 579895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf1b4bf925a10e6387c4960c979ca535?s=128&d=identicon&r=PG", "display_name": "Pikoh", "link": "https://stackoverflow.com/users/579895/pikoh"}, "edited": false, "score": 0, "creation_date": 1490183257, "post_id": 42950578, "comment_id": 72996424, "body": "Paste the <code>CallDetails</code> code. We don&#39;t know what that method does"}, {"owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "reply_to_user": {"reputation": 7361, "user_id": 579895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf1b4bf925a10e6387c4960c979ca535?s=128&d=identicon&r=PG", "display_name": "Pikoh", "link": "https://stackoverflow.com/users/579895/pikoh"}, "edited": false, "score": 0, "creation_date": 1490183495, "post_id": 42950578, "comment_id": 72996594, "body": "The callDetails code is above"}, {"owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "reply_to_user": {"reputation": 7361, "user_id": 579895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cf1b4bf925a10e6387c4960c979ca535?s=128&d=identicon&r=PG", "display_name": "Pikoh", "link": "https://stackoverflow.com/users/579895/pikoh"}, "edited": false, "score": 0, "creation_date": 1490183585, "post_id": 42950578, "comment_id": 72996676, "body": "I would like to search on the &#39;Title&#39; column to bring up the rows that match"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1490185025, "post_id": 42950578, "comment_id": 72997665, "body": "On what line do you get the error?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1490185132, "post_id": 42950578, "comment_id": 72997755, "body": "You have posted the code for Find_CallNumbers  not CallDetails."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1490186310, "post_id": 42950578, "comment_id": 72998638, "body": "You create a <code>Collection</code> called <code>CallDetails</code> in <code>Find_CallNumbers</code> and then try to refer to it in <code>PlaceValues</code>. But the <code>CallDetails</code> variable has gone out of scope... you need to have a variable in <code>PlaceValues</code> that accepts the return of <code>Find_CallNumbers</code> and then iterate the collection and set the textboxes and whatever. Also <code>PlaceValues</code> seems to assume that there will only be one <i>set</i> of values - so why not just return the <code>clsCallDetails</code> object ?"}, {"owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "edited": false, "score": 0, "creation_date": 1490188611, "post_id": 42950578, "comment_id": 73000325, "body": "Just a quick one. I am trying to search on the &quot;Title&quot; field. At the moment, I have to put every single word within the cell to bring up a result. Is there a way there, where I can type only a word or a few words contained within that cell, which is unique and that it will bring up a result."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "edited": false, "score": 0, "creation_date": 1490186580, "post_id": 42951563, "comment_id": 72998849, "body": "Just a quick one. I am trying to search on the &quot;Title&quot; field. At the moment, I have to put every single word within the cell to bring up a result. Is there a way there, where I can type only a word or a few words contained within that cell, which is unique and that it will bring up a result."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "edited": false, "score": 0, "creation_date": 1490207307, "post_id": 42951563, "comment_id": 73014162, "body": "Um, that is not really a quick one. Best to ask it in a separate question."}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 0, "last_activity_date": 1490185418, "creation_date": 1490185418, "answer_id": 42951563, "question_id": 42950578, "link": "https://stackoverflow.com/questions/42950578/userform-to-search-find-and-return-data/42951563#42951563", "title": "userform to search find and return data", "body": "<p>You are passing a variable of type Long to a function expecting a type String. Change</p>\n\n<pre><code>Public Function Find_CallNumbers(NumberToFind As String) As Collection\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Public Function Find_CallNumbers(NumberToFind As Long) As Collection\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3528873, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0f3a5fab04b09ae59d41b24aebd099ae?s=128&d=identicon&r=PG&f=1", "display_name": "user3528873", "link": "https://stackoverflow.com/users/3528873/user3528873"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1054, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490185418, "creation_date": 1490182725, "last_edit_date": 1531164843, "question_id": 42950578, "link": "https://stackoverflow.com/questions/42950578/userform-to-search-find-and-return-data", "title": "userform to search find and return data", "body": "<p>I get a error (<em>Invalid procedure call or argument</em>) when trying to search and return all the data within my spread sheet. Can anyone help. Thanks in advance!!!</p>\n\n<p>Code is below:</p>\n\n<pre><code>Private Sub PlaceValues(Index As Long)\nWith Me\n    .txtLoggedBy.Value = CallDetails(Index).Value\n    .txtCallNumber.Value = CallDetails(Index).CallNumber\n    .txtDateField.Value = CallDetails(Index).DateField\n    .txtTitle.Value = CallDetails(Index).Title\n    .cmbOwnerField.Value = CallDetails(Index).OwnerField\n    .txtDescription.Value = CallDetails(Index).Description\n    .txtSolution.Value = CallDetails(Index).Solution\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Kind regards.</p>\n\n<p>CallDetails code is:</p>\n\n<pre><code>Public Function Find_CallNumbers(NumberToFind As String) As Collection\n\nDim rng_to_search As Range\nDim rFound As Range\nDim FirstAddress As String\nDim FoundItem As clsCallDetails\n\nSet CallDetails = New Collection\n\nWith ThisWorkbook.Worksheets(\"Database\")\n    Set rng_to_search = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp))\nEnd With\n\nWith rng_to_search\n    'Look for the first instance.\n    Set rFound = .Find(what:=NumberToFind, _\n                       after:=.Cells(1, 1), _\n                       LookIn:=xlValues, _\n                       LookAt:=xlWhole, _\n                       SearchDirection:=xlNext)\n    If Not rFound Is Nothing Then\n        FirstAddress = rFound.Address\n        Do\n            Set FoundItem = New clsCallDetails 'Create a new instance of the class to hold the details.\n            With FoundItem\n                .Title = rFound.Offset(, 1)\n                .LoggedBy = rFound.Offset(, 2) 'Offset from column A by 1 column, so column B.\n                .CallNumber = rFound.Offset(, 3)\n                .DateField = rFound.Offset(, 4)\n                .OwnerField = rFound.Offset(, 6)\n                .Description = rFound.Offset(, 7)\n                .Solution = rFound.Offset(, 8)\n\n            End With\n            CallDetails.Add FoundItem 'Add the class instance to our collection.\n            Set rFound = .FindNext(rFound) 'Look for the next value.\n\n        'Continue searching until we reach the top again.\n        Loop While Not rFound Is Nothing And rFound.Address &lt;&gt; FirstAddress\n    End If\nEnd With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "variables", "module", "subroutine"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1490182127, "post_id": 42950265, "comment_id": 72995630, "body": "You cannot do that directly, there is no functional/delegate type in VBA (and if there were your attempt would be an invocation not an assignment).  Perhaps consider encapsulating the logic within a class <a href=\"http://www.cpearson.com/excel/classes.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/classes.aspx</a>"}], "answers": [{"comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1490182681, "post_id": 42950526, "comment_id": 72996032, "body": "I prepared this, you went faster. Turning the sub into a function returning a worksheet object is the right thing to do"}, {"owner": {"reputation": 21, "user_id": 678085, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bf55ffe3a4e6d5238266463fc6a8e15a?s=128&d=identicon&r=PG", "display_name": "paynod", "link": "https://stackoverflow.com/users/678085/paynod"}, "edited": false, "score": 0, "creation_date": 1490183324, "post_id": 42950526, "comment_id": 72996467, "body": "Thanks very much makes perfect sense."}], "tags": [], "owner": {"reputation": 105, "user_id": 2707658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cbbdf9db2a8ac8f002d165c0d491c1f?s=128&d=identicon&r=PG&f=1", "display_name": "Stefan", "link": "https://stackoverflow.com/users/2707658/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1490182544, "creation_date": 1490182544, "answer_id": 42950526, "question_id": 42950265, "link": "https://stackoverflow.com/questions/42950265/vba-assigning-sub-routine-to-variable/42950526#42950526", "title": "vba assigning sub routine to variable", "body": "<p>You shoud use a function like this.</p>\n\n<pre><code>Function varWorksheet(wksht As String) As Worksheet\n    On Error Resume Next\n    Set varWorksheet = ThisWorkbook.Sheets(wksht)\nEnd Function\n</code></pre>\n\n<p>It will return nothing if the worksheet doesn't exist. This works fine.</p>\n\n<pre><code>Sub Test()\n    Dim ws As Worksheet\n\n    Set ws = Modul10.varWorksheet(\"Tabelle4\")\n    If ws Is Nothing Then\n        Debug.Print \"No worksheet\"\n    Else\n        ' what ever you want\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 678085, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bf55ffe3a4e6d5238266463fc6a8e15a?s=128&d=identicon&r=PG", "display_name": "paynod", "link": "https://stackoverflow.com/users/678085/paynod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490182544, "creation_date": 1490181877, "question_id": 42950265, "link": "https://stackoverflow.com/questions/42950265/vba-assigning-sub-routine-to-variable", "title": "vba assigning sub routine to variable", "body": "<p>I have the following sub routine (in module10). </p>\n\n<pre><code>Sub varWorksheet(wksht As String)\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Sheets(wksht)\n\nSet ws = Nothing\nEnd Sub\n</code></pre>\n\n<p>I want to be able to pass this sub routine as a reference to a variable with something like this rather than have to declare it explicitly in each routine:</p>\n\n<pre><code>Set ws = module10.varWorksheet(\"Sheet1\") \n</code></pre>\n\n<p>I'm getting a compilation error -> expected Function or Variable.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1490184795, "post_id": 42950153, "comment_id": 72997497, "body": "Would another pivot table be able to summarise by date?"}], "answers": [{"tags": [], "owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "is_accepted": false, "score": 0, "last_activity_date": 1490184070, "creation_date": 1490184070, "answer_id": 42951054, "question_id": 42950153, "link": "https://stackoverflow.com/questions/42950153/automate-adding-daily-updated-pivottable-data-to-a-new-cell-in-a-table/42951054#42951054", "title": "Automate adding daily-updated PivotTable data to a new cell in a table", "body": "<p>Your case seems to be an application of a broader idea in excel - getting to the bottom end of a block of information. There are a few different methods (summarised <a href=\"https://www.rondebruin.nl/win/s9/win005.htm\" rel=\"nofollow noreferrer\">here</a>) each with their own pros and cons.</p>\n\n<p>The one that is simplest for your case is probably .End. I don't know the exact structure of your sheet, but something like the following</p>\n\n<pre><code>Range(\"A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row - 1).Copy\n</code></pre>\n\n<p>will copy the cell in the penultimate row of Column A of your table (just before \"TOTAL\" - if you have subtotals, make it -2, or whatever).</p>\n\n<p>Then, to copy to your standard table, do something like</p>\n\n<pre><code> Range(\"F\" &amp; Cells(Rows.Count, \"F\").End(xlUp).Row + 1).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>where \"F\" is the second column of your table (or wherever you want to paste it).</p>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "is_accepted": false, "score": 0, "last_activity_date": 1490199606, "creation_date": 1490199606, "answer_id": 42957350, "question_id": 42950153, "link": "https://stackoverflow.com/questions/42950153/automate-adding-daily-updated-pivottable-data-to-a-new-cell-in-a-table/42957350#42957350", "title": "Automate adding daily-updated PivotTable data to a new cell in a table", "body": "<p>That's how I've solved the issue (many thanks to people who posted the similar questions &amp; solution to them in internet):    </p>\n\n<pre><code>Sub VlookupFunction()\n\n   Dim S_Name As String\n   Dim Lookup_Range As Range  \n   Dim S_Value As Single\n\n   Dim c As Long 'column\n   Dim r As Long 'row\n\n   S_Name = \"OpenState\"\n   Set Lookup_Range = Range(\"A1:B10\")\n\n   S_Value = Application.WorksheetFunction.VLookup(S_Name, Lookup_Range, 2, False)\n\nWith Sheet1\n\n  r = .Columns(3).Find(what:=\"\", after:=.Cells(14, 3)).Row\n    .Cells(r, 3) = Date 'today \n\n  r = .Columns(4).Find(what:=\"\", after:=.Cells(14, 4)).Row\n    .Cells(r, 4) = S_Value\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 6103869, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/601370fce3736ca87e66c9294ade50f1?s=128&d=identicon&r=PG&f=1", "display_name": "Slava32", "link": "https://stackoverflow.com/users/6103869/slava32"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490199606, "creation_date": 1490181552, "question_id": 42950153, "link": "https://stackoverflow.com/questions/42950153/automate-adding-daily-updated-pivottable-data-to-a-new-cell-in-a-table", "title": "Automate adding daily-updated PivotTable data to a new cell in a table", "body": "<p>I'm trying to automate Excel report following the <a href=\"http://blog.velingeorgiev.pro/automated-excel-report-task-scheduler-and-simple-vba-functions\" rel=\"nofollow noreferrer\">tutorial</a> of Velin Georgiev.</p>\n\n<p>It's a daily report, and I have a table where I add a total value from everyday-updated PivotTable into a new cell (both Pivot and standard tables are on the same worksheet). </p>\n\n<p>In standard table the column <strong>Date</strong> contains \"today\" date and <strong>Total</strong> takes data from the PivotTable. Every day this table should increase on one row.</p>\n\n<p><a href=\"https://i.stack.imgur.com/KrPzo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KrPzo.png\" alt=\"enter image description here\"></a></p>\n\n<p>So far it was done manually. Is it possible to do it with VBA and how?</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1490181992, "post_id": 42950141, "comment_id": 72995546, "body": "Did you try using the After parameter of Find?"}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1490182123, "post_id": 42950141, "comment_id": 72995626, "body": "BTW, you don&#39;t need to select that Range, and you don&#39;t need CutCopyMode = False because you simply assign the value of one cell to another."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "edited": false, "score": 0, "creation_date": 1490186365, "post_id": 42950457, "comment_id": 72998675, "body": "Sorry I copy elsewhere in the code, I just forgot to remove it when I was cutting things down for the post. Thank you, this is certainly a better way, however I am still not getting the values I should be. I am getting the same value from the first worksheet 5 times when there are 5 different values on five qualifying worksheets that I need to see..."}], "tags": [], "owner": {"reputation": 21753, "user_id": 3978545, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jmQsw.png?s=128&g=1", "display_name": "Wolfie", "link": "https://stackoverflow.com/users/3978545/wolfie"}, "is_accepted": false, "score": 0, "last_activity_date": 1490186987, "last_edit_date": 1495539982, "creation_date": 1490182381, "answer_id": 42950457, "question_id": 42950141, "link": "https://stackoverflow.com/questions/42950141/finding-and-selecting-data-from-many-sheets-and-workbooks-in-a-directory/42950457#42950457", "title": "Finding and selecting data from many sheets and workbooks in a directory", "body": "<p>You should try and avoid using <code>Select</code>. See this post on how and why:\n<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n\n<p>As for your code, the <code>Find</code> command will return nothing if nothing was found. My prediction is that nothing is found, so nothing <em>new</em> is selected, so the previous selection is still used. This is one problem from using <code>Select</code>! </p>\n\n<p>Instead you should directly assign the result of <code>Find</code> to your range, then test if that range is nothing, like so</p>\n\n<pre><code>' Your Code\nCells.Find(What:=\"*Herstellkosten*\", LookIn:=xlFormulas).Offset(1, 0).Select\nSet rngMyRange = Selection\nThisWorkbook.Worksheets(\"Data\").Range(\"O\" &amp; OutputRow) = rngMyRange\n\n' Revised code, without using Select\nSet rngMyRange = Cells.Find(What:=\"*Herstellkosten*\", LookIn:=xlFormulas).Offset(1, 0)      \nIf Not rngMyRange = Nothing Then\n    ' Note the use of Value to assign values, rather than making ranges equal (I assume this is your aim?)\n    ThisWorkbook.Worksheets(\"Data\").Range(\"O\" &amp; OutputRow).Value = rngMyRange.Value\nElse\n    ' Some code here for what to do if Data value wasn't found\nEnd If\n</code></pre>\n\n<p>Also, I'm not sure why you did <code>Application.CutCopyMode = False</code> when you haven't copied anything? This is used to clear the clipboard...</p>\n\n<hr>\n\n<p>Edit:</p>\n\n<p>You should also fully qualify your objects. For instance, the <code>Find</code> statement is currently</p>\n\n<pre><code>Cells.Find(What:=\"*Herstellkosten*\", LookIn:=xlFormulas).Offset(1, 0)   \n</code></pre>\n\n<p>But where are the <code>Cells</code>?? It would be much better to use</p>\n\n<pre><code>ThisWorkbook.Sheets(\"SheetName1\").Cells.Find(What:=\"*Herstellkosten*\", LookIn:=xlFormulas).Offset(1, 0) \n</code></pre>\n\n<p>In your case, you're cycling over sheet objects, called <code>sht</code>, so it would be</p>\n\n<pre><code>sht.Cells.Find(What:=\"*Herstellkosten*\", LookIn:=xlFormulas).Offset(1, 0)   \n</code></pre>\n\n<p>See this SO question for another example of fully qualifying objects: <a href=\"https://stackoverflow.com/questions/18962890/2-ways-for-clearcontents-on-vba-excel-but-1-work-fine-why\">Qualifying range objects</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7534021, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/638df90a1458515b2e0a79688ca66342?s=128&d=identicon&r=PG&f=1", "display_name": "brianabrownesq", "link": "https://stackoverflow.com/users/7534021/brianabrownesq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490186987, "creation_date": 1490181530, "question_id": 42950141, "link": "https://stackoverflow.com/questions/42950141/finding-and-selecting-data-from-many-sheets-and-workbooks-in-a-directory", "title": "Finding and selecting data from many sheets and workbooks in a directory", "body": "<p>I am creating a macro that will open each workbook in a directory and pull data into my new workbook based on a few factors like file type and sheet names. Most all of this data I can pull in based on its location on the sheet, however I have one where I need to pull the value directly below a header that has changed position many times between versions. Currently, it will successfully find the correct value and put it where it is intended to go in my original workbook. However, when multiple sheets exists in the workbook that match my criteria, it will just repeat the first value found on the first sheet rather than executing the search and giving me the value from each individual sheet. Code below with the section in question marked. Any ideas how I can solve this would be much appreciated!</p>\n\n<pre><code>Option Explicit\nDim strMasterWorkbook As String\nDim strLinkWbk As String\nDim strImportSheet As String\nDim strQueryPath As String\nDim strCurrentFilePath As String\nDim strFileName As String\nDim strCurrentFile As String\nDim intLine As Integer\nDim intExtLine As Integer\nDim intFound As Integer\nDim intSheets As Integer\nDim intLastLine As Integer\nDim dtCurrentFileModified As Date\nDim intLastLine2 As Integer\nDim intLine2 As Integer\nDim intImport As Integer\nDim intLoc As Integer\nDim strCurrentLocation As String\nDim countentry, countfound, n As Integer\nDim count_intLastLine_n1, intFound_n1, intLastLine_n1 As Integer\nDim fst_Del_Date, Org_Date, MufCost_Part, MufCost_Tool, Hours_PPP, Part_num, Planer_name, Description As Variant\nDim strFirstAddress As String\nDim searchlast As Range\nDim sht As Worksheet\nDim lastRow As Long\nDim search As Range\nDim FolderNme As String\nDim filepath As String\nDim rngFindValue As Variant\n'Yellow\nSub Marine()\n\nMsgBox \"Update may take several minutes. Select OK to continue.\"\n\n'On Error Resume Next\nApplication.CutCopyMode = False\n\n'Clear Old Data\n    Sheets(\"Data\").Select\n    Range(\"A2:I100000\").Select\n    Selection.ClearContents\n    Sheets(\"Data\").Select\n    Range(\"K2:Z100000\").Select\n    Selection.ClearContents\n    Range(\"A2\").Select\n\nDim Worksheet As Object\nDim Workbook As Object\nDim FldrWkbk As Object\nDim FolderNme As String\nDim filepath As String\nDim OutputRow As Integer\nDim StartRange As String\nDim EndRange As String\nDim ManuCost As Range\nDim searchlast As Range\nDim header As Range, headers As Range\nDim rngMyRange As Object\nDim I As Integer\nDim WS_Count As Integer\n\nWS_Count = ThisWorkbook.Worksheets.Count\nstrMasterWorkbook = ActiveWorkbook.Name\nstrImportSheet = \"QueryPaths\"\nstrQueryPath = Sheets(\"QueryLocation\").Range(\"QueryLocation\").Value\n\nSheets(strImportSheet).Select\nIf Not Range(\"A1\").Value = \"\" Then\n    Cells.Select\n    Selection.ClearContents\nEnd If\n\nWorkbooks.Open strQueryPath\n\nstrLinkWbk = ActiveWorkbook.Name\n\n    Selection.Copy\n\nThisWorkbook.Activate\nSheets(strImportSheet).Select\nSheets(strImportSheet).Range(\"A1\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\nWorkbooks(strLinkWbk).Close SaveChanges:=False\n'Data--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\nWith Sheets(strImportSheet)\n\nfilepath = strCurrentFilePath\nOutputRow = 1\nThisWorkbook.ActiveSheet.Range(\"A\" &amp; OutputRow).Activate\nOutputRow = OutputRow + 1\n    For intLine = 2 To .Cells(.Rows.Count, 1).End(xlUp).Row\n        If VBA.Right(.Cells(intLine, 1), 4) = \"xlsm\" Then\n            strCurrentFilePath = \"https://fect/\" &amp; .Cells(intLine, 5) &amp; \"/\" &amp; .Cells(intLine, 1)\n            dtCurrentFileModified = .Cells(intLine, 2)\n            intLoc = 0\n            strFileName = ThisWorkbook.Worksheets(\"QueryPaths\").Cells(intLine, 1)\n            Set FldrWkbk = Workbooks.Open(strCurrentFilePath, False, True)\n\n            For Each sht In FldrWkbk.Sheets\n            ActiveWorkbook.ActiveSheet.Unprotect\n\n              If sht.Name Like \"Cal Sheet*\" Then\n                ThisWorkbook.Worksheets(\"Data\").Range(\"M\" &amp; OutputRow) = WorksheetFunction.Max(Range(\"Y:Y\"))\n                ThisWorkbook.Worksheets(\"Data\").Range(\"N\" &amp; OutputRow) = sht.Range(\"C12\")\n                ThisWorkbook.Worksheets(\"Data\").Range(\"T\" &amp; OutputRow) = sht.Range(\"I4\")\n'------------------------------------CODE IN QUESTION------------------------------------------------------------------------------\n                Cells.Find(What:=\"*Herstellkosten*\", LookIn:=xlFormulas).Offset(1, 0).Select\n                Set rngMyRange = Selection\n                ThisWorkbook.Worksheets(\"Data\").Range(\"O\" &amp; OutputRow) = rngMyRange\n                Application.CutCopyMode = False\n'------------------------------------CODE IN QUESTION------------------------------------------------------------------------------\n\n              End If\n\n            Next sht\n            FldrWkbk.Close SaveChanges:=False\n        End If\n    Next\nEnd With\n'--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n' Starting Position\n    Sheets(\"PlannerData\").Select\n    Range(\"B2\").Select\nMsgBox \"Update Complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1956, "user_id": 4429015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqxqf.png?s=128&g=1", "display_name": "B001\u16e6", "link": "https://stackoverflow.com/users/4429015/b001%e1%9b%a6"}, "edited": false, "score": 2, "creation_date": 1490181287, "post_id": 42950020, "comment_id": 72995079, "body": "Never ask for (free) code. on SO...You won&#39;t get any. Please visit <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask a good question</a>"}, {"owner": {"reputation": 11, "user_id": 7534545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ajpYLXoepQw/AAAAAAAAAAI/AAAAAAAAABw/xJgKm6GTSq0/photo.jpg?sz=128", "display_name": "Anshuman saini", "link": "https://stackoverflow.com/users/7534545/anshuman-saini"}, "reply_to_user": {"reputation": 1956, "user_id": 4429015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqxqf.png?s=128&g=1", "display_name": "B001\u16e6", "link": "https://stackoverflow.com/users/4429015/b001%e1%9b%a6"}, "edited": false, "score": 0, "creation_date": 1490181355, "post_id": 42950020, "comment_id": 72995117, "body": "Dim Rng3 As Range Dim Rng5 As Range  For Each Rng3 In CurCell_1      For Each Rng5 In CurCell_3            lLFs = VBA.Len(Rng3) - VBA.Len(VBA.Replace(Rng3, vbLf, &quot;&quot;))       If lLFs &gt; 0 Then          Range(&quot;B27&quot;).Select         Selection.Copy          Sheets(&quot;AccountModule&quot;).Select         Range(&quot;AY2&quot;).Select         Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _         False, Transpose:=False        End If    Next Next"}, {"owner": {"reputation": 11, "user_id": 7534545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ajpYLXoepQw/AAAAAAAAAAI/AAAAAAAAABw/xJgKm6GTSq0/photo.jpg?sz=128", "display_name": "Anshuman saini", "link": "https://stackoverflow.com/users/7534545/anshuman-saini"}, "reply_to_user": {"reputation": 1956, "user_id": 4429015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqxqf.png?s=128&g=1", "display_name": "B001\u16e6", "link": "https://stackoverflow.com/users/4429015/b001%e1%9b%a6"}, "edited": false, "score": 0, "creation_date": 1490181398, "post_id": 42950020, "comment_id": 72995146, "body": "this code I have tried but not wroking"}, {"owner": {"reputation": 31066, "user_id": 2704659, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wObcB.jpg?s=128&g=1", "display_name": "rory.ap", "link": "https://stackoverflow.com/users/2704659/rory-ap"}, "edited": false, "score": 3, "creation_date": 1490181414, "post_id": 42950020, "comment_id": 72995157, "body": "I&#39;m voting to close this question as off-topic because SO is not a coding service."}, {"owner": {"reputation": 11, "user_id": 7534545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ajpYLXoepQw/AAAAAAAAAAI/AAAAAAAAABw/xJgKm6GTSq0/photo.jpg?sz=128", "display_name": "Anshuman saini", "link": "https://stackoverflow.com/users/7534545/anshuman-saini"}, "edited": false, "score": 0, "creation_date": 1490182321, "post_id": 42950020, "comment_id": 72995770, "body": "code added in the section"}, {"owner": {"reputation": 11, "user_id": 7534545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ajpYLXoepQw/AAAAAAAAAAI/AAAAAAAAABw/xJgKm6GTSq0/photo.jpg?sz=128", "display_name": "Anshuman saini", "link": "https://stackoverflow.com/users/7534545/anshuman-saini"}, "edited": false, "score": 0, "creation_date": 1490182853, "post_id": 42950020, "comment_id": 72996156, "body": "rory.ap can you please look into this code"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1490196418, "post_id": 42950020, "comment_id": 73006666, "body": "Where are you setting <code>CurrCell_1</code> and <code>CurCell_3</code>?  I&#39;m not sure how those ranges(?) correspond to the data you have shown.  And how do the cells B27 and AY2 fit into things?  And what do you mean when you say that the code &quot;is not working&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 16103, "user_id": 2610061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa4474d4e3352d1f9da8f52df42db95?s=128&d=identicon&r=PG", "display_name": "cars10m", "link": "https://stackoverflow.com/users/2610061/cars10m"}, "is_accepted": false, "score": 1, "last_activity_date": 1490189668, "creation_date": 1490189668, "answer_id": 42953192, "question_id": 42950020, "link": "https://stackoverflow.com/questions/42950020/code-for-copy-data-using-vba-code-in-excel/42953192#42953192", "title": "Code for copy data using VbA code in Excel", "body": "<p>I suggest you use a different kind of routine like this one:</p>\n\n<pre><code>Sub separ8(src, trg)\n Dim r As Range, ar\n For Each r In src.Rows\n   ar = Split(r.Cells(1, 2), Chr(10))\n   For Each el In ar\n     trg.Value = r.Cells(1, 1)\n     trg.Offset(0, 1) = el\n     Set trg = trg.Offset(1)\n   Next el\n Next r\nEnd Sub\n</code></pre>\n\n<p>My sub assumes that your input data is in a range given by <code>src</code> and the results should be written into a range starting at <code>trg</code>.</p>\n\n<p>So, when there is data like this </p>\n\n<pre><code>  A   B      C\n1\n2     abc    123\n             456\n             789\n3     xyz    1234\n             456789\n             78941\n</code></pre>\n\n<p>The procedure call</p>\n\n<pre><code>separ8 [b2:c3],[b7]\n</code></pre>\n\n<p>will get you this result:</p>\n\n<pre><code>   A    B    C\n 6\n 7      abc  123\n 8      abc  456\n 9      abc  789\n10      xyz  1234\n11      xyz  456789\n12      xyz  78941\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7534545, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ajpYLXoepQw/AAAAAAAAAAI/AAAAAAAAABw/xJgKm6GTSq0/photo.jpg?sz=128", "display_name": "Anshuman saini", "link": "https://stackoverflow.com/users/7534545/anshuman-saini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -9, "last_activity_date": 1490195629, "creation_date": 1490181187, "last_edit_date": 1490195629, "question_id": 42950020, "link": "https://stackoverflow.com/questions/42950020/code-for-copy-data-using-vba-code-in-excel", "title": "Code for copy data using VbA code in Excel", "body": "<p>How can I fix the below code for below snapshots?</p>\n\n<p>I have tried below code </p>\n\n<pre><code>Dim Rng3 As Range\nDim Rng5 As Range\n\nFor Each Rng3 In CurCell_1\n\n\n   For Each Rng5 In CurCell_3\n\n          lLFs = VBA.Len(Rng3) - VBA.Len(VBA.Replace(Rng3, vbLf, \"\"))\n\n     If lLFs &gt; 0 Then\n\n        Range(\"B27\").Select\n        Selection.Copy\n\n        Sheets(\"AccountModule\").Select\n        Range(\"AY2\").Select\n        Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n        False, Transpose:=False\n\n      End If\n   Next\nNext\n</code></pre>\n\n<p>but the same is not working.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AgX6l.jpg\" rel=\"nofollow noreferrer\">Input</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/spTJ2.jpg\" rel=\"nofollow noreferrer\">Output</a></p>\n"}, {"tags": ["vba", "excel", "dataset"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5526530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3399d3c1ced542d8a5b94b7686fc9cef?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/5526530/jeroen"}, "edited": false, "score": 0, "creation_date": 1490187925, "post_id": 42951272, "comment_id": 72999820, "body": "Thank u very much!! I am almost there, I&#39;ve replied in my own post, so I could post a picture! I hope you can help me with the last bit :-)"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": false, "score": 0, "last_activity_date": 1490184652, "creation_date": 1490184652, "answer_id": 42951272, "question_id": 42949978, "link": "https://stackoverflow.com/questions/42949978/peak-over-treshold-method-vba-excel/42951272#42951272", "title": "Peak over treshold method - VBA - Excel", "body": "<p>You will have to iterate over all the values in column i. For every storm, find the highest value. A storm starts when a 0 is followed by a positive value, and ends when a positive value is followed by a 0. So something like this:</p>\n\n<pre><code>Sub FindHighestValue()\n\n    Dim vData As Variant\n    Dim Storms As Collection\n    Dim ndx As Long\n    Dim ndxStorm As Long\n    Dim MaxValue As Double\n    Dim Previous As Double\n    Dim InStorm As Boolean\n\n    vData = Sheet1.Range(\"I8:I21\").Value   'Change this to whatever range your wave heights are in\n    Set Storms = New Collection\n    Previous = 0\n    InStorm = False\n\n    For ndx = LBound(vData, 1) To UBound(vData, 1)\n\n        If vData(ndx, 1) &gt; 0 And Previous = 0 Then\n            'A storm has started\n            MaxValue = vData(ndx, 1)\n            InStorm = True\n        End If\n\n        If InStorm And vData(ndx, 1) &gt; MaxValue Then\n            MaxValue = vData(ndx, 1)\n        End If\n\n        If (vData(ndx, 1) = 0 And Previous &gt; 0) Or (ndx = UBound(vData, 1)) Then\n            'A storm has ended\n            InStorm = False\n            Storms.Add MaxValue\n        End If\n\n        Previous = vData(ndx, 1)\n    Next\n\n    If Storms.Count &gt; 0 Then\n        For ndx = 1 To Storms.Count\n            Debug.Print ndx &amp; \": \" &amp; Storms(ndx)\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5526530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3399d3c1ced542d8a5b94b7686fc9cef?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen", "link": "https://stackoverflow.com/users/5526530/jeroen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490187867, "creation_date": 1490181078, "last_edit_date": 1490187867, "question_id": 42949978, "link": "https://stackoverflow.com/questions/42949978/peak-over-treshold-method-vba-excel", "title": "Peak over treshold method - VBA - Excel", "body": "<p>I really hope you can help me with the following question. \nI have a dataset and I need to filter for some values. This is a dataset for wave analysis, and I need to filter out for the higstest values. The so called peak over treshold method. I want to filter out the storms in de wave dataset. </p>\n\n<p>I can do this with the following: A storm is defined when the waveheight is above a certain value, for example 2.5 meters. The waveheight is measured every 3 hours. </p>\n\n<p>So in the dataset I can do an If(B3>$A$1; B3;0). A1 = 2,5 m. Now I have filtered for waveheights. So now I can see in my dataset rows straight after each other with values higher than 2,5 meters, because a storm last serveral hours. See picture 1 as example:\n[Picture 1][1]</p>\n\n<p>So if a certain value is above X, then return that value, otherwise return zero. Now comes the hard part:</p>\n\n<p>Now I need the highest value of that strip for values above 2,5 meters. As this is a big(!) dataset, I have a lot of datapoints. So I have several 'storms', which don't always last as long. So the values that are higher than 2,5 meters aren't always 3 rows, sometimes more. See picture 2<a href=\"https://i.stack.imgur.com/ijFse.png\" rel=\"nofollow noreferrer\">picture 2</a></p>\n\n<p>I need to compute the highst value in Column i, for each storm. Because each storm doens't last as long, I probally need to write code in VBA. Could anybody help me with this? I've been stuck for 6 days, but my VBA code doens't work and I do not have much experience with VBA. If anybody could help me that would be very much appreciated!</p>\n\n<p>Kind regards,</p>\n\n<p>Jeroen</p>\n\n<hr>\n\n<p>EDIT as a reply on -Excel Developers-\nI think I'm almost there, thank u very much for replying!! I am probably misreading the code, but a I have still a slight difficulty in computing the highstest value <strong>for each storm</strong> I think it should look something like this, as seen in picture 3.<a href=\"https://i.stack.imgur.com/f99wR.png\" rel=\"nofollow noreferrer\">Picture 3</a></p>\n\n<p>The highest value of each storm should be printed in the next column, as seen in picture 3. It probably says it all in the code, but I am misreading it. </p>\n\n<p>Thank u very much for you answer! I really hope you can help me with the last part :-)</p>\n\n<p>Kind regards,</p>\n\n<p>Jeroen</p>\n"}, {"tags": ["vba", "outlook", "msxml6"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1490191332, "post_id": 42949855, "comment_id": 73002445, "body": "The response is in unicode, you&#39;ll need to convert it. See: <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264628.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg264628.aspx</a>. Debug.print supports ASCII more or less, for unicode you&#39;ll need a different container."}], "owner": {"reputation": 175, "user_id": 1587839, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/4CuF3.jpg?s=128&g=1", "display_name": "modzsi", "link": "https://stackoverflow.com/users/1587839/modzsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1593076528, "creation_date": 1490180776, "last_edit_date": 1593076528, "question_id": 42949855, "link": "https://stackoverflow.com/questions/42949855/vba-xmlhttp60-request-not-showing-all-accents-in-hungarian", "title": "VBA XMLHTTP60 request not showing all accents in hungarian", "body": "<p>I am using Outlook (2010 + 2013) VBA using MS XML 6.0 reference to load up a web page. I am having trouble to get the page with Hungarian accented characters. I tried to manipulate the charset to no avail.</p>\n\n<pre><code>Sub TEST()\n Dim url As String\n url = \"https://hu.wikipedia.org/wiki/Magyar_%C3%A1b%C3%A9c%C3%A9\"\n Dim dictObj As Object: Set dictObj = CreateObject(\"Scripting.Dictionary\")\n Dim ie As MSXML2.XMLHTTP60\n Set ie = New MSXML2.XMLHTTP60\n ie.Open \"GET\", url, False\n ie.Send\n While ie.ReadyState &lt;&gt; 4\n DoEvents\n Wend\n Dim HTMLDoc As MSHTML.HTMLDocument\n Dim HTMLBody As MSHTML.HTMLBody\n Set HTMLDoc = New MSHTML.HTMLDocument\n Set HTMLBody = HTMLDoc.Body\n HTMLBody.innerHTML = ie.responseText\n Debug.Print HTMLBody.innerText\nEnd Sub\n</code></pre>\n\n<p>Looking at the Hungarian Alphabet two of all characters are not shown properly:</p>\n\n<blockquote>\n  <p>A, \u00c1, B, C, Cs, D, Dz, Dzs, E, \u00c9, F, G, Gy, H, I, \u00cd, J, K, L, Ly, M,\n  N, Ny, O, \u00d3, \u00d6, <strong>O</strong>, P, R, S, Sz, T, Ty, U, \u00da, \u00dc, <strong>U</strong>, V, Z, Zs</p>\n</blockquote>\n\n<p>They should look like this: <strong>\u0150</strong> and <strong>\u0170</strong></p>\n\n<p>I tried adding these line to the request, but it did not change anything:</p>\n\n<pre><code>    ie.setRequestHeader \"Accept\", \"text/html;charset=UTF-8\"\n    ie.setRequestHeader \"Accept-Encoding\", \"identity\"\n    ie.setRequestHeader \"Accept-Charset\", \"UTF-8\"\n</code></pre>\n\n<p>Anyone knows why?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1490214004, "post_id": 42949533, "comment_id": 73017874, "body": "That is much clearer.  Except for this - does each customer have 100 rows in a table on this sheet?  And what are in columns B through X of the sheet you are writing to.  Is each column a sales item?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 3707844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9ee95f8b42bc910a72b35073dab633?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3707844/peter"}, "edited": false, "score": 0, "creation_date": 1490367794, "post_id": 42952953, "comment_id": 73094926, "body": "It seems to work (no debugging errors) after a few adjustments for names etc, but it doesn&#39;t add any quantity&#39;s to the salesBook."}, {"owner": {"reputation": 23, "user_id": 3707844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9ee95f8b42bc910a72b35073dab633?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3707844/peter"}, "edited": false, "score": 0, "creation_date": 1490367894, "post_id": 42952953, "comment_id": 73095000, "body": "The range on the salesbook where items are listed is row B4:AV4, I updated the names so they fit the exact description rather than generalising them."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 23, "user_id": 3707844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9ee95f8b42bc910a72b35073dab633?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3707844/peter"}, "edited": false, "score": 0, "creation_date": 1490443014, "post_id": 42952953, "comment_id": 73120578, "body": "Ok.  I assumed the item names were in the top row of your salesSheet. You just need to change &quot;set colrange=salesSheet.range(&quot;B1:X1&quot;)&quot; to the following code: set colrange = salesSheet.range(&quot;B4:AV4&quot;)"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 0, "last_activity_date": 1490276534, "last_edit_date": 1490276534, "creation_date": 1490189041, "answer_id": 42952953, "question_id": 42949533, "link": "https://stackoverflow.com/questions/42949533/using-an-excel-invoice-template-to-consecutively-add-items-to-sales-data-book-k/42952953#42952953", "title": "Using an excel invoice template to consecutively add items to sales data book, keeping individual customers on their own specific row", "body": "<p>Now your question involves everything we need to know.  </p>\n\n<p>I don't know your workbook names or worksheets that you are using, so you will have to change those to suit your particular set up.</p>\n\n<p>Paste the following code into a regular (not class) module of your invoice workbook.  At the end of your pdf button macro (but before the \"End Sub\") put a call to this macro by the command \"Call salesBookUpdate.\"</p>\n\n<p>If your sales book is not open it will open it.  It will find your customer row on the salesbook.  If the customer name from invoice A7 is not found in the salesbook, it will create a new row for him at the first unused row.  It will then look up the items he purchased and add them to any existing previous purchases of the same object according to column.</p>\n\n<p>It might take some tweaking to work on your particular set up.</p>\n\n<pre><code>Sub salesBookUpdate()\nDim custID As String\nDim item1() As Variant\nDim wbInvoice As Workbook\nDim salesBook As Workbook\nDim salesSheet As Worksheet\nDim lastRow As Long\nDim salesBookRow As Long\nDim colrange As Range\nDim columnNumber As Long\n\n    Set wbInvoice = ThisWorkbook\n    Sheet1.Activate                         ' change to your correct data sheet\n    item1 = Range(\"A23:B27\")\n    custID = UCase(Sheet1.Range(\"A7\").Value)\n    If IsFileOpen(\"C:\\Temp\\salesBook.xlsx\") Then\n        Set salesBook = Workbooks(\"salesBook.xlsx\"): salesBook.Activate\n    Else\n        Set salesBook = Workbooks.Open(\"C:\\Temp\\salesBook.xlsx\") ' change directory and filename to yours\n    End If\n\n    salesBook.Activate\n\n    Set salesSheet = salesBook.Sheets(\"Sales Sheet\")                           ' change worksheet to correct one\n\n    lastRow = salesSheet.Cells.Find(What:=\"*\", _\n        After:=Range(\"A1\"), _\n        LookAt:=xlPart, _\n        LookIn:=xlFormulas, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlPrevious, _\n        MatchCase:=False).Row\n\n\nWith salesSheet.Range(\"a1:a\" &amp; lastRow)\n    Set c = .Find(custID, LookIn:=xlValues, MatchCase:=False)\n    If Not c Is Nothing Then\n            salesBookRow = c.Row\n    Else\n        salesBookRow = lastRow + 1\n        salesSheet.Range(\"A\" &amp; salesBookRow).Value = custID ' new customer\n    End If\nEnd With\n\nSet colrange = salesSheet.Range(\"B1:X1\")\nFor i = LBound(item1) To UBound(item1)\n    If item1(i, 1) &lt;&gt; \"\" Then\n        With colrange\n            Set c = .Find(item1(i, 1), LookIn:=xlValues, MatchCase:=False)\n            If Not c Is Nothing Then\n                    columnNumber = c.Column\n                    Cells(salesBookRow, columnNumber).Value = Cells(salesBookRow, columnNumber).Value + item1(i, 2)\n            End If\n        End With\n\n    End If\nNext i\n\n\n\nEnd Sub\n\nFunction IsFileOpen(filename As String)\n    Dim filenum As Integer, errnum As Integer\n\n    On Error Resume Next   ' Turn error checking off.\n    filenum = FreeFile()   ' Get a free file number.\n    ' Attempt to open the file and lock it.\n    Open filename For Input Lock Read As #filenum\n    Close filenum          ' Close the file.\n    errnum = err           ' Save the error number that occurred.\n    On Error GoTo 0        ' Turn error checking back on.\n\n    ' Check to see which error occurred.\n    Select Case errnum\n\n        ' No error occurred.\n        ' File is NOT already open by another user.\n        Case 0\n         IsFileOpen = False\n\n        ' Error number for \"Permission Denied.\"\n        ' File is already opened by another user.\n        Case 70\n            IsFileOpen = True\n\n        ' Another error occurred.\n        Case Else\n            Error errnum\n    End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 3707844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea9ee95f8b42bc910a72b35073dab633?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/3707844/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 42952953, "answer_count": 1, "score": 0, "last_activity_date": 1490276534, "creation_date": 1490180058, "last_edit_date": 1490216993, "question_id": 42949533, "link": "https://stackoverflow.com/questions/42949533/using-an-excel-invoice-template-to-consecutively-add-items-to-sales-data-book-k", "title": "Using an excel invoice template to consecutively add items to sales data book, keeping individual customers on their own specific row", "body": "<p>I need to have certain data copied to another book, called Customer Sales, which every time an invoice is saved (using the already present Save and Print activeX button, vba), it adds the quantity of certain items consecutively to the customers row in the table. So 100 rows, to accommodate existing and new customers. Column A is the customers. Then from Column B:X is different items as a header. So each row is reserved for a customer, whereas each column, except A, is reserved for items. </p>\n\n<p>The data from the invoice i need copied is A23:A27 (items), B23:B27 (Quantities); data in a23:a27 is rows of different items. The b23:b27 is quantities of those items, same row for item:quantity.</p>\n\n<p>The customers name is in a drop down list in A7, but I want the customer to stay on the same row in the sales book, so all items are increased based on quantity bought.</p>\n\n<p>the A23-B23 is item-quantity, then same for rows to A,B27. So on the sales log, it'll be Customer (A7 in invoice) matched to column A in sales, then A23 item plus B23 quantity in invoice goes to Sales column B:X depending on which item, and the quantity increases the cell in these columns.</p>\n\n<p>So I have no idea how to implement this. Maybe an If/Else statement, like if customer buys 10 apples increase total of apple column by quantity bought on customers row (based on cells in the invoice).</p>\n\n<p>I have very little knowledge of coding, but can do it when I know what it is I am trying to do if that makes sense...What is the best method of doing this? </p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "edited": false, "score": 0, "creation_date": 1490181515, "post_id": 42949508, "comment_id": 72995226, "body": "We don&#39;t understand what you want to do exactly. Moreover, the code you took from somewhere else is already complete enough to do what you wish. Just try to understand the code and I&#39;m sure you just have to change it a bit to suit your needs..."}, {"owner": {"reputation": 1, "user_id": 4421116, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Fu0OwWGRAk/AAAAAAAAAAI/AAAAAAAAACQ/z_Y1KmhShYI/photo.jpg?sz=128", "display_name": "syed ayub", "link": "https://stackoverflow.com/users/4421116/syed-ayub"}, "reply_to_user": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "edited": false, "score": 0, "creation_date": 1490182836, "post_id": 42949508, "comment_id": 72996147, "body": "thanks for replying  JiheL , my requirement is what ever iam copying, that data i wnt to insert into same sheet rows from the top"}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 7570039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70cf200384eb5bd832aaa403bd3d66d?s=128&d=identicon&r=PG&f=1", "display_name": "JiheL", "link": "https://stackoverflow.com/users/7570039/jihel"}, "is_accepted": false, "score": 0, "last_activity_date": 1490189125, "creation_date": 1490189125, "answer_id": 42952990, "question_id": 42949508, "link": "https://stackoverflow.com/questions/42949508/how-to-insert-the-copied-visible-rows-from-the-top-into-in-exsisting-data/42952990#42952990", "title": "How to insert the copied visible rows from the top into in exsisting data", "body": "<p>I just took your code and changed some stuff</p>\n\n<pre><code>Sub Referral()\n\nApplication.ScreenUpdating = False\n\nWith Activesheet\n    .range(.cells(2,1),.cells(.cells(.rows.count,1).end(xlup).row,.cells(1,.columns.count).end(xltoleft).column)).Copy\n    .Cells(2, 1).PasteSpecial xlPasteValues\nEnd With\n\nApplication.ScreenUpdating = True \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4421116, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6Fu0OwWGRAk/AAAAAAAAAAI/AAAAAAAAACQ/z_Y1KmhShYI/photo.jpg?sz=128", "display_name": "syed ayub", "link": "https://stackoverflow.com/users/4421116/syed-ayub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1490189125, "creation_date": 1490179972, "last_edit_date": 1531164843, "question_id": 42949508, "link": "https://stackoverflow.com/questions/42949508/how-to-insert-the-copied-visible-rows-from-the-top-into-in-exsisting-data", "title": "How to insert the copied visible rows from the top into in exsisting data", "body": "<p>how to insert the Copied rows into same exsisting data , i want to insert that rows which i copied in the code given below in exsisting data and same sheet only</p>\n\n<pre><code>Name    Location    Salary\nSy      Hyd         12,000\nAy      Hyd         13,000\nRaju    Hyd         15,000\n</code></pre>\n\n<p>i want to copy name location and salary from above table and insert the copied data into same above table from the top (Below header)</p>\n\n<pre><code>Sub Referral()\n\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Sheet3\")\n\n    'this is generic, you may need to adjust this based on your sheet and data needs\n    Intersect(.UsedRange, .UsedRange.Offset(1)).SpecialCells(xlCellTypeVisible).Copy\n\nEnd With\n\n'goes to cell below last used cell in column A\nSheets(\"Sheet4\").Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial xlPasteValues\n\n\nApplication.ScreenUpdating = True 'don't forget to turn on your ScreenUpdating again!\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 250, "user_id": 3884538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AN4kC.png?s=128&g=1", "display_name": "Mike Powell", "link": "https://stackoverflow.com/users/3884538/mike-powell"}, "edited": false, "score": 0, "creation_date": 1490193759, "post_id": 42954596, "comment_id": 73004444, "body": "Connection is quick and the code is used on many PC&#39;s and laptops on a daily basis."}], "tags": [], "owner": {"reputation": 250, "user_id": 3884538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AN4kC.png?s=128&g=1", "display_name": "Mike Powell", "link": "https://stackoverflow.com/users/3884538/mike-powell"}, "is_accepted": true, "score": 1, "last_activity_date": 1490193799, "last_edit_date": 1490193799, "creation_date": 1490193077, "answer_id": 42954596, "question_id": 42949485, "link": "https://stackoverflow.com/questions/42949485/mariadb-2-0-13-vs-mysql-5-3-odbc-drivers-vba-connection/42954596#42954596", "title": "MariaDB 2.0.13 vs MySQL 5.3 ODBC Drivers (VBA Connection)", "body": "<p>I know it's not the driver that you are using ... but I use the following connection in my VBA code to connect to SQL Servers:</p>\n\n<p>Reference File: Microsoft DAO 3.6 Object Library</p>\n\n<pre><code>'*************************************\n'* SQL Server database connection    *\n'*************************************\n    Dim db As ADODB.Connection\n    Set db = New ADODB.Connection\n    db.Open \"Provider=sqloledb; Data Source = 192.168.0.10; Database = [your DB Name];User Id = xxxxxx; Password = xxxxxxxx\"\n</code></pre>\n\n<p>if a command takes longer than 45 seconds to execute ... use this to extend the execution default time</p>\n\n<pre><code>db.CommandTimeout = 1200 '(1200/60 = 20 minutes)\n</code></pre>\n\n<p>Sample Simple Commands</p>\n\n<pre><code>Set rst = db.execute(\"Select * from [your table name]\")\ndb.execute(\"Delete from [your table name] where [your criteria]\")\n</code></pre>\n"}], "owner": {"reputation": 28, "user_id": 7103589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1848223e9dfa9f6292f53e07d43d429?s=128&d=identicon&r=PG&f=1", "display_name": "Berco", "link": "https://stackoverflow.com/users/7103589/berco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1516, "favorite_count": 0, "accepted_answer_id": 42954596, "answer_count": 1, "score": 0, "last_activity_date": 1490193799, "creation_date": 1490179912, "question_id": 42949485, "link": "https://stackoverflow.com/questions/42949485/mariadb-2-0-13-vs-mysql-5-3-odbc-drivers-vba-connection", "title": "MariaDB 2.0.13 vs MySQL 5.3 ODBC Drivers (VBA Connection)", "body": "<p>In Excel-VBA We used to have a sql database connection using MySQL drivers. Since this wasn't working for everyone we decided to install MariaDB drivers at every pc and use these drivers. The speed of opening an connection however, has decreased dramatically. Here is the code of the new and old vba script. </p>\n\n<pre><code>    p_dbConn.ConnectionString = _\n          \"DRIVER={MariaDB ODBC 2.0 Driver};\" &amp; _\n          \"SERVER=xx;\" &amp; _\n          \"DATABASE=xx;\" &amp; _\n          \"UID=xx;PASSWORD=xx;OPTION=3\"\n    p_dbConn.Open\n\n    p_dbConn.ConnectionString = _\n          \"DRIVER={MySQL ODBC 5.3 ANSI Driver};\" &amp; _\n          \"SERVER=xx;\" &amp; _\n          \"DATABASE=xx;\" &amp; _\n          \"UID=xx;PASSWORD=xx;OPTION=3\"\n    p_dbConn.Open\n</code></pre>\n\n<p>I ran the script in debug mode and the .open statement takes way longer with the mariadb driver. Anyone has any idea why?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "edited": false, "score": 0, "creation_date": 1490180006, "post_id": 42949457, "comment_id": 72994181, "body": "I did it before the code I posted. Sorry for not show it before. Editing main post now. i willl test inside  the loop."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "edited": false, "score": 2, "creation_date": 1490180104, "post_id": 42949457, "comment_id": 72994247, "body": "@AngelMdez : I wasn&#39;t clear enough, I knew that you had this line, but it needs to be inside the loop to create multiple mails! ;)"}, {"owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "edited": false, "score": 0, "creation_date": 1490180340, "post_id": 42949457, "comment_id": 72994422, "body": "I test it. For some reason the first time it loops, It doesnt display anything. 2nd and 3rd time It does.  The result is 2 emails with xxxxx.part2.rar and xxxx.part3.rar attached ready to send but no email with xxx.part1.rar."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "edited": false, "score": 0, "creation_date": 1490180810, "post_id": 42949457, "comment_id": 72994726, "body": "@AngelMdez : Very strange that you don&#39;t have the part1... Try placing breakpoints or do a step-by-step debug to see how the code flow, but you should have the 1st mail with part1."}, {"owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "edited": false, "score": 0, "creation_date": 1490181688, "post_id": 42949457, "comment_id": 72995339, "body": "It is very strange indeed. If i start the loop with i = 0 to times, first iteration doesnt creat/display anything and the other 3 does it. That solves it but I still dont know why it happens."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "edited": false, "score": 1, "creation_date": 1490182189, "post_id": 42949457, "comment_id": 72995670, "body": "@AngelMdez : Very strange indeed, I can&#39;t think of anything that would cause that... Especially with you waiting 30 seconds for Outlook to open... Anyhow, glad I could help! ;)"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1490180117, "last_edit_date": 1490180117, "creation_date": 1490179849, "answer_id": 42949457, "question_id": 42949278, "link": "https://stackoverflow.com/questions/42949278/loop-vba-display-various-emails-at-the-same-time/42949457#42949457", "title": "Loop vba display various emails at the same time", "body": "<p>You simply missed the part where you create a new mail <br>\n<code>Set OutMail = OutApp.CreateItem(0)</code><br>\n<strong>inside the loop</strong>, like this :</p>\n\n<pre><code>For i = 1 To times\n    Set OutMail = OutApp.CreateItem(0)\n\n    With OutMail\n        .To = wb1.Sheets(\"MAIL\").Cells(4, 3).value\n        .CC = wb1.Sheets(\"MAIL\").Cells(5, 3).value\n        .BCC = \"\"\n        .Subject = wb1.Sheets(\"MAIL\").Cells(6, 3).value\n        .Body = wb1.Sheets(\"MAIL\").Cells(9, 3).value\n        'You can add other files also like this\n\n            If (times &gt; 1) Then\n                .Attachments.Add Source &amp; \"part\" &amp; i &amp; \".rar\"\n            Else\n                .Attachments.Add Source &amp; \"rar\"\n            End If\n        '.Send   'or use .Display\n\n        .Display\n    End With\nNext i\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 5435587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aa38ec898802e66c319eb0e476a99ee?s=128&d=identicon&r=PG&f=1", "display_name": "AngelMdez", "link": "https://stackoverflow.com/users/5435587/angelmdez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 42949457, "answer_count": 1, "score": 0, "last_activity_date": 1593413911, "creation_date": 1490179394, "last_edit_date": 1593413911, "question_id": 42949278, "link": "https://stackoverflow.com/questions/42949278/loop-vba-display-various-emails-at-the-same-time", "title": "Loop vba display various emails at the same time", "body": "<p>Im compressing a file in parts of 10MB with WINRAR. I want to loop and create 1 email attaching each part and display all the emails before send them. </p>\n\n<pre><code>Set OutApp = CreateObject(\"Outlook.Application\")\n\nApplication.Wait (Now + TimeValue(\"0:00:30\"))\nOn Error GoTo 0\nSet OutMail = OutApp.CreateItem(0)\nFor i = 1 To times\n    With OutMail\n        .To = wb1.Sheets(\"MAIL\").Cells(4, 3).Value\n        .CC = wb1.Sheets(\"MAIL\").Cells(5, 3).Value\n        .BCC = \"\"\n        .Subject = wb1.Sheets(\"MAIL\").Cells(6, 3).Value\n        .Body = wb1.Sheets(\"MAIL\").Cells(9, 3).Value\n        'You can add other files also like this\n\n            If (times &gt; 1) Then\n                .Attachments.Add source &amp; \"part\" &amp; i &amp; \".rar\"\n            Else: .Attachments.Add source &amp; \"rar\"\n            End If\n        '.Send   'or use .Display\n\n        .Display\n    End With\nNext i\n</code></pre>\n\n<ol>\n<li>If i run it with \".Send\" it sends 1 email without anything attached.</li>\n<li>If i use \".Display\" it shows 1 email in outlook ready to send with\nall the parts attached. (3 parts in my example).</li>\n</ol>\n\n<p>I want either:</p>\n\n<ul>\n<li>To send 3 email with 1 part of the file each atached \nOR</li>\n<li>Display 3 emails, each one with 1 part attached ready to click \"send\"\nin Outlook.</li>\n</ul>\n\n<p>I Hope I explained myself.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 2015846, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c5ee968c30ae9cfb0ac5940ba3773301?s=128&d=identicon&r=PG", "display_name": "Mikk", "link": "https://stackoverflow.com/users/2015846/mikk"}, "edited": false, "score": 0, "creation_date": 1490189879, "post_id": 42951845, "comment_id": 73001278, "body": "Thanks for the help Brandon, I did try your variant2 but it didn&#39;t make a difference. About Variant1 i am also not sure about passing a nonstring parameter, I will try to search about this but I think its not whats the problem here.  Actually the DoSave Sub doesnt get triggered anymore after I change documents, its not the saving that fails. It looks like the OnTime somehow gets cancelled completely."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 211, "user_id": 2015846, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c5ee968c30ae9cfb0ac5940ba3773301?s=128&d=identicon&r=PG", "display_name": "Mikk", "link": "https://stackoverflow.com/users/2015846/mikk"}, "edited": false, "score": 0, "creation_date": 1490194432, "post_id": 42951845, "comment_id": 73005047, "body": "I created a test routine within word and I am unable to reproduce the problem. I set the same kind of loop and just had it print to the console every five seconds. After opening, saving, and closing a document I didnt have any issues. I also didnt have any issues if I overwrote the document I opened, saved and closed. This leads me to believe that there is something we are missing within your code, and not within the OnTime method."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 211, "user_id": 2015846, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c5ee968c30ae9cfb0ac5940ba3773301?s=128&d=identicon&r=PG", "display_name": "Mikk", "link": "https://stackoverflow.com/users/2015846/mikk"}, "edited": false, "score": 0, "creation_date": 1490195675, "post_id": 42951845, "comment_id": 73006068, "body": "See my edit. The problem is that the file with the code was being overwritten and thus the code no longer existed to run. I added code to create a new instance of the document and debugging it worked just fine."}], "tags": [], "owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "is_accepted": false, "score": 0, "last_activity_date": 1490195634, "last_edit_date": 1490195634, "creation_date": 1490186243, "answer_id": 42951845, "question_id": 42949165, "link": "https://stackoverflow.com/questions/42949165/application-ontime-stops-firing-after-changing-the-active-document/42951845#42951845", "title": "Application.OnTime stops firing after changing the active document", "body": "<p>Shot in the dark here, but you are dimming doc within the scope of the module (from what I can tell). It is possible that opening the new document causes this to go out of scope. It would be best to just pass the document between routines.</p>\n\n<p>Something like this:</p>\n\n<pre><code>' This will declare count within the scope of the module\nPrivate count As Integer\n\nPrivate Sub Document_Open()\n    count = 1\n    SaveTime ActiveDocument\nEnd Sub\n\nSub SaveTime(doc as Document)\n    Application.OnTime When:=Now + TimeValue(\"00:00:15\"), \"'DoSave doc'\"\nEnd Sub\n\nSub DoSave(doc as Document)\n    doc.SaveAs2 \"c:\\test\\testsave\" &amp; count &amp; \".docx\"\n    count = count + 1\n    SaveTime\nEnd Sub\n</code></pre>\n\n<p>I haven't used OnTime much, so if the syntax above doesnt allow arguments to be passed, here is a version using a Private doc variable.</p>\n\n<pre><code>' This will declare count and doc within the scope of the module\nPrivate count As Integer\nPrivate doc as Document\n\nPrivate Sub Document_Open()\n    count = 1\n    SaveTime\nEnd Sub\n\nSub SaveTime()\n    Application.OnTime When:=Now + TimeValue(\"00:00:15\"), \"DoSave\"\nEnd Sub\n\nSub DoSave()\n    doc.SaveAs2 \"c:\\test\\testsave\" &amp; count &amp; \".docx\"\n    count = count + 1\n    SaveTime\nEnd Sub\n</code></pre>\n\n<p>I hope this helps. I mostly work within Excel for VBA so I apologize if I am way off the mark here.</p>\n\n<p>EDIT:</p>\n\n<p>I figured it out. What is happening is every time your save event fires it is saving the active document as a new file, but it is not creating a new instance. For example, if test is your first document then:</p>\n\n<p>Test Opens > Event Fires > Test becomes Test2.docx ( Event Fires > Test2 becomes Test3 etc.</p>\n\n<p>Since the code is still stored in memory somehow (this is the part I dont fully understand, but it is, from what I can tell, is what's happening) the event still fires. The problem is, opening a new document somehow refreshes this and the event cancels.</p>\n\n<p>There is a simple workaround, see below:</p>\n\n<pre><code>Option Explicit\nPrivate doc As Document\nPrivate count As Integer\nPrivate Sub Document_Open()\n    count = 1\n    Set doc = ActiveDocument\n    SaveTime\nEnd Sub\nSub SaveTime()\n    Application.OnTime Now + TimeValue(\"00:00:15\"), \"DoSave\"\nEnd Sub\n\nSub DoSave()\n    doc.Save\n    Application.Documents.Add doc.FullName\n\n    ActiveDocument.SaveAs2 \"c:\\test\\testsave\" &amp; count &amp; \".docx\"\n    ActiveDocument.Close\n\n    count = count + 1\n    SaveTime\nEnd Sub\n</code></pre>\n\n<p>This creates a new instance of the document, saves this new instance, and then closes it. This leaves the old instance in-tact and running.</p>\n\n<p>I hope that all makes sense. Admittedly, I am not clear on why the code remains in memory even when the document holding the code no longer exists.</p>\n"}], "owner": {"reputation": 211, "user_id": 2015846, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/c5ee968c30ae9cfb0ac5940ba3773301?s=128&d=identicon&r=PG", "display_name": "Mikk", "link": "https://stackoverflow.com/users/2015846/mikk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490195634, "creation_date": 1490179106, "last_edit_date": 1490179978, "question_id": 42949165, "link": "https://stackoverflow.com/questions/42949165/application-ontime-stops-firing-after-changing-the-active-document", "title": "Application.OnTime stops firing after changing the active document", "body": "<p>I am trying to implement an autosave function for all documents created from a certain template. In this template I have created the following for tests:</p>\n\n<pre><code>Dim doc As Document\nDim count As Integer\n\nPrivate Sub Document_Open()\ncount = 1\nSet doc = ActiveDocument\nSaveTime\nEnd Sub\n\nSub SaveTime()\nApplication.OnTime When:=Now + TimeValue(\"00:00:15\"), _\nname:=\"DoSave\"\nEnd Sub\n\nSub DoSave()\ndoc.SaveAs2 \"c:\\test\\testsave\" &amp; count &amp; \".docx\"\ncount = count + 1\nSaveTime\nEnd Sub\n</code></pre>\n\n<p>Now if I open a document thats created by this template the autosaving works every 15 seconds as intended (15sec + the counter with different name is just for testing).</p>\n\n<p>BUT as soon as I create a new document in Word or open another file the autosaving in the first document stops working and also doesnt come back if I continue to work in the document. </p>\n\n<p>How can I make the autosave work no matter of which document is active? Like this the feature would only work if only one Document is open at a time, which I can not garantuee of course.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1490178726, "post_id": 42948825, "comment_id": 72993224, "body": "You could created a named range instead and refer to that in your code, or use a proper table"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 7690917, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/b9e7b42a2a7abd3dd2ea0f8896c56fd2?s=128&d=identicon&r=PG&f=1", "display_name": "bub", "link": "https://stackoverflow.com/users/7690917/bub"}, "edited": false, "score": 0, "creation_date": 1490182926, "post_id": 42949357, "comment_id": 72996200, "body": "It&#39;s working, but the issue is that I have other stuff going on down below the area that I want this VBA to format, leading to my user defined function being inserted into cells they&#39;re not supposed to."}], "tags": [], "owner": {"reputation": 1233, "user_id": 6903997, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJ1mr.png?s=128&g=1", "display_name": "Tim Schmidt", "link": "https://stackoverflow.com/users/6903997/tim-schmidt"}, "is_accepted": false, "score": 0, "last_activity_date": 1490179552, "creation_date": 1490179552, "answer_id": 42949357, "question_id": 42948825, "link": "https://stackoverflow.com/questions/42948825/vba-making-range-also-include-inserted-rows/42949357#42949357", "title": "VBA Making range also include inserted rows", "body": "<p><code>Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row</code> can be used to find the last used row, so once u insert a new row, the result is incremented by one.\n<br></p>\n\n<p>So try something like :</p>\n\n<p><code>If Not Intersect(Range(\"D9:D\" &amp; Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row), Target) Is Nothing Then</code></p>\n"}], "owner": {"reputation": 329, "user_id": 7690917, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/b9e7b42a2a7abd3dd2ea0f8896c56fd2?s=128&d=identicon&r=PG&f=1", "display_name": "bub", "link": "https://stackoverflow.com/users/7690917/bub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490179552, "creation_date": 1490178276, "question_id": 42948825, "link": "https://stackoverflow.com/questions/42948825/vba-making-range-also-include-inserted-rows", "title": "VBA Making range also include inserted rows", "body": "<p>I am using the following code to update the date if someone changes some text. The problem is if I want to insert more rows, as I have defined my range as \"D9:D16\". </p>\n\n<p>Is there way to make it so that this code is observant of new rows being inserted?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'Hvis du p\u00e5 noget tidspunkt tilf\u00f8jer flere rows, s\u00e5 sig til.\nApplication.EnableEvents = False\n\nIf Not Intersect(Range(\"D9:D16\"), Target) Is Nothing Then\n    Target.Offset(, -2).Formula = \"=UDF_Now()\"\n        Select Case MsgBox(\"Er \"\"Updated by\"\" den rigtige?\", vbYesNo)\n        Case Is = vbNo\n            Target.Offset(, -1).Activate\n        End Select\nEnd If\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 1, "creation_date": 1490179395, "post_id": 42948703, "comment_id": 72993710, "body": "Welcome to StackOverflow, please format your code, it is not readable this way."}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1490180000, "post_id": 42949499, "comment_id": 72994172, "body": "This is not an answer. Please use comments"}, {"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1490181259, "post_id": 42949499, "comment_id": 72995060, "body": "It is an answer to the problem he raised, namely that his code sends all of the workbook instead of skipping a sheet. You can answer a question without supplying code that is ready to copy paste. I&#39;d use a comment when I&#39;m not directly answering a question, for example a suggestion not to use.Select or to format the code properly."}], "tags": [], "owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "is_accepted": false, "score": -1, "last_activity_date": 1490179953, "creation_date": 1490179953, "answer_id": 42949499, "question_id": 42948703, "link": "https://stackoverflow.com/questions/42948703/how-to-attach-all-sheets-but-first-in-email-using-vba/42949499#42949499", "title": "How to attach all sheets but first in email using VBA", "body": "<ol>\n<li>Save a copy of your workbook</li>\n<li>Open it</li>\n<li>Remove the sheet from the copy</li>\n<li>Save</li>\n<li>Send this edited workbook</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 816, "user_id": 5143876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36f1aaff08162453b0791065c9a44b14?s=128&d=identicon&r=PG&f=1", "display_name": "Jbjstam", "link": "https://stackoverflow.com/users/5143876/jbjstam"}, "edited": false, "score": 0, "creation_date": 1490181349, "post_id": 42949507, "comment_id": 72995115, "body": "DisplayAlerts is set to False twice in a row. You might consider reusing the same Outlook.Application for every iteration too. Upvoted"}, {"owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "edited": false, "score": 0, "creation_date": 1490182487, "post_id": 42949507, "comment_id": 72995901, "body": "Hello Tom, your modifications don&#39;t solve my problems. The attched files in each email cannot be open. And the &#39;loop&#39; again considers the first empty row and proposes it into new blank email."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1490181391, "last_edit_date": 1490181391, "creation_date": 1490179962, "answer_id": 42949507, "question_id": 42948703, "link": "https://stackoverflow.com/questions/42948703/how-to-attach-all-sheets-but-first-in-email-using-vba/42949507#42949507", "title": "How to attach all sheets but first in email using VBA", "body": "<p>Have a look at this. This takes a copy of your workbook and saves it to the users \"temp\" location. It then does the modifications that you want to the copy of the workbook before attaching that.</p>\n\n<pre><code>Sub ICO_Emails()\n    Dim VSEApp As Object\n    Dim VSEMail As Object\n    Dim VSEText As String\n    Dim Email_Send_To, Email_Cc, Email_Subject As String\n    Dim wb As Workbook, nwb As Workbook\n\n    Application.ScreenUpdating = False\n\n    Set wb = ThisWorkbook\n    wb.SaveCopyAs (Environ(\"temp\") &amp; \"\\temp_\" &amp; wb.Name)\n\n    Set nwb = Workbooks.Open(Environ(\"temp\") &amp; \"\\temp_\" &amp; wb.Name)\n    With nwb\n        Application.DisplayAlerts = False\n        ' Delete relevant sheet\n        .Sheets(1).Delete\n        Application.DisplayAlerts = True\n        .Save\n    End With\n\n    row_number = 1\n\n    Do\n        DoEvents\n        row_number = row_number + 1\n        Email_Send_To = Sheet1.Range(\"A\" &amp; row_number)\n        Email_Cc = Sheet1.Range(\"B\" &amp; row_number)\n        Email_Subject = Sheet1.Range(\"C\" &amp; row_number)\n        On Error GoTo debugs\n        Set VSEApp = CreateObject(\"Outlook.Application\")\n        Set VSEMail = VSEApp.CreateItem(0)\n        'Email Body script\n        VSEText = \"&lt;BODY style=font-size:14pt;font-family:Times New Roman&gt;Dear all,&lt;p&gt;Test.&lt;p&gt;&lt;/BODY&gt;\"\n        'Email Signature\n        With VSEMail\n            .Display\n        End With\n        Signature = VSEMail.HTMLBody\n        With VSEMail\n            .To = Email_Send_To\n            .CC = Email_Cc\n            .Subject = Email_Subject\n            .HTMLBody = VSEText &amp; Signature\n            .Attachments.Add nwb.FullName\n            .Display\n        End With\ndebugs:\n    Loop Until Email_Send_To = \"\"\n    nwb.Close\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7126348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b63088bae9f0a0a044883655973483?s=128&d=identicon&r=PG&f=1", "display_name": "VSE", "link": "https://stackoverflow.com/users/7126348/vse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 42949507, "answer_count": 2, "score": 0, "last_activity_date": 1490198214, "creation_date": 1490177956, "last_edit_date": 1490198214, "question_id": 42948703, "link": "https://stackoverflow.com/questions/42948703/how-to-attach-all-sheets-but-first-in-email-using-vba", "title": "How to attach all sheets but first in email using VBA", "body": "<p>I have got a workbook with 4 sheets:</p>\n\n<p>1st - recipients email data such as <code>TO</code>, <code>CC</code>, <code>Subject</code>, from 2nd to 4th\n the sheets which I need to send as an attachment to the recipients.</p>\n\n<p>I made up the following script. But I faced 2 issues as a VBA beginner:</p>\n\n<ol>\n<li>The 'loop' proposes for sending the 1st empty row from the 1st sheet\nas well (I would like to stop with the last email details);</li>\n<li>The 'ActiveWorkbook' sends all sheets (I would like to skip the 1st\none where the recipients &amp; the VBA script are located);</li>\n</ol>\n\n<p>I appreciate every advice/remark because I have been studying VBA for 3 months.\n Thank you in advance!</p>\n\n<pre><code>Sub ICO_Emails()\n    Dim VSEApp As Object\n    Dim VSEMail As Object\n    Dim VSEText As String\n    Dim Email_Send_To, Email_Cc, Email_Subject As String\n\n    row_number = 1\n\n    Do\n        DoEvents\n        row_number = row_number + 1\n        Email_Send_To = Sheet1.Range(\"A\" &amp; row_number)\n        Email_Cc = Sheet1.Range(\"B\" &amp; row_number)\n        Email_Subject = Sheet1.Range(\"C\" &amp; row_number)\n        On Error GoTo debugs\n        Set VSEApp = CreateObject(\"Outlook.Application\")\n        Set VSEMail = VSEApp.CreateItem(0)\n        'Email Body script\n        VSEText = \"&lt;BODY style=font-size:14pt;font-family:Times New Roman&gt;Dear all,&lt;p&gt;Test.&lt;p&gt;&lt;/BODY&gt;\"\n        'Email Signature\n        With VSEMail\n            .Display\n        End With\n        Signature = VSEMail.HTMLBody\n        With VSEMail\n            .To = Email_Send_To\n            .CC = Email_Cc\n            .Subject = Email_Subject\n            .HTMLBody = VSEText &amp; Signature\n            .Attachments.Add ActiveWorkbook.FullName\n            .Display\n        End With\ndebugs:\n    Loop Until Email_Send_To = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "filter"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "edited": false, "score": 0, "creation_date": 1490180747, "post_id": 42949294, "comment_id": 72994684, "body": "Thanks for the input Josh! I keep on trying but i would also like to hear if someone has a VBAish way around this."}], "tags": [], "owner": {"reputation": 6569, "user_id": 6220759, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/0yuve.jpg?s=128&g=1", "display_name": "Josh Friedlander", "link": "https://stackoverflow.com/users/6220759/josh-friedlander"}, "is_accepted": false, "score": 0, "last_activity_date": 1490183168, "last_edit_date": 1490183168, "creation_date": 1490179435, "answer_id": 42949294, "question_id": 42948465, "link": "https://stackoverflow.com/questions/42948465/dynamic-selection-of-visible-rows-after-advanced-filtering/42949294#42949294", "title": "Dynamic selection of visible rows after advanced filtering", "body": "<p>Excel doesn't seem to allow you to delete rows in a filtered table. In a situation like this, I think you have to only filter with the macro, then select all visible rows and click OK <a href=\"https://i.stack.imgur.com/MbSHJ.png\" rel=\"nofollow noreferrer\">on the prompt</a>. Happy to hear if anyone has found a VBAish way around this.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "is_accepted": false, "score": 0, "last_activity_date": 1490184013, "creation_date": 1490184013, "answer_id": 42951033, "question_id": 42948465, "link": "https://stackoverflow.com/questions/42948465/dynamic-selection-of-visible-rows-after-advanced-filtering/42951033#42951033", "title": "Dynamic selection of visible rows after advanced filtering", "body": "<p>I think i got it!!</p>\n\n<p>My code results are as follow,</p>\n\n<pre><code>Sub notWanted()\n\n\nWith ThisWorkbook.Worksheets(\"GD\")\n\nRange(\"TabellInDataPivot[[#All],[Projekt]]\").AdvancedFilter Action:= _\n    xlFilterInPlace, CriteriaRange:=Sheets(\"Groupfiles\").Range(\"C8:E9\"), Unique _\n    :=False\n\n    lastrow0 = .Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\nRange(\"D2\", Cells(Rows.Count, \"D\").End(xlUp)).SpecialCells(xlCellTypeVisible).Cells(2, 52).Select\n.Range(Cells(3, 1), Cells(lastrow0, 55)).Rows.EntireRow.Select\nSelection.EntireRow.Delete\nActiveSheet.ShowAllData\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I added a lastrow statement and thereafter entirerow.delete. It seems to work so i hope it will do its thing!</p>\n"}], "owner": {"reputation": 181, "user_id": 7494999, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a63802a30fa3b20a36b1843de6adb821?s=128&d=identicon&r=PG&f=1", "display_name": "DL1", "link": "https://stackoverflow.com/users/7494999/dl1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 584, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490184013, "creation_date": 1490177358, "last_edit_date": 1490180155, "question_id": 42948465, "link": "https://stackoverflow.com/questions/42948465/dynamic-selection-of-visible-rows-after-advanced-filtering", "title": "Dynamic selection of visible rows after advanced filtering", "body": "<p>I have a code that first trough advanced filtering, filters a table. After this i want to select all rows in the table except the headers and delete this. In my table i have 20 columns of data and it some rows have data in the first 10 columns and empty cells between column 11 and 20 so i cant really use selection.end(xldown, xlright).select etc because som rows have empty cells. </p>\n\n<p>I cant get my head around how to fix this selection. DO u pros have any tips for this?</p>\n\n<pre><code>Sub notWanted()\n\nRange(\"TabellInDataPivot[[#All],[Projekt]]\").AdvancedFilter Action:= _\n    xlFilterInPlace, CriteriaRange:=Sheets(\"Groupfiles\").Range(\"C8:E9\"),   Unique _\n    :=False\n\n    lastrow = ThisWorkbook.Worksheets(\"GruppData\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n     .Range(.Cells(4, 3).Offset(rowoffset:=1), .Cells(lastrow, 20)).SpecialCells(xlCellTypeVisible).Select\n\n     Selection.EntireRow.Delete\n     ActiveSheet.ShowAllData\nEnd Sub\n</code></pre>\n\n<p>I get an invalid or unqualifed reference error with the code line .Range**(.Cells**(4, 3) Altough this works fine at earlier filter and delete segments. </p>\n\n<p>Thanks in advance\n/D</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1490262029, "post_id": 42951560, "comment_id": 73036760, "body": "The link you gave is to leave the blank cell at the bottom. Is there any direct way without the needs to create another column? Currently I am using the combo box, but I want to change to data validation if there is a way to do that."}, {"owner": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "reply_to_user": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "edited": false, "score": 0, "creation_date": 1490262547, "post_id": 42951560, "comment_id": 73037153, "body": "Later in the link there is information on how to skip blank cells (<a href=\"http://blog.contextures.com/archives/2014/02/27/dynamic-list-with-blank-cells/\" rel=\"nofollow noreferrer\">blog.contextures.com/archives/2014/02/27/&hellip;</a>) but it involves adding additional columns."}], "tags": [], "owner": {"reputation": 441, "user_id": 6061679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/122a95ad47d3d3668f7fe58e11b4e540?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian B", "link": "https://stackoverflow.com/users/6061679/sebastian-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1490185415, "last_edit_date": 1495541864, "creation_date": 1490185415, "answer_id": 42951560, "question_id": 42948218, "link": "https://stackoverflow.com/questions/42948218/excel-data-validation-not-include-blank-cell-error/42951560#42951560", "title": "Excel data validation not include blank cell error", "body": "<p>There is a length restriction of 256 characters if you use a manual list. If you want more entries in your drop-down, you should refer to a range.</p>\n\n<p>You can for example use your already existing column and ignore blank cells by following this:\n<a href=\"https://stackoverflow.com/questions/31969520/simple-way-to-remove-blank-cells-dynamic-dropdown-list-excel\">Simple way to remove blank cells dynamic dropdown list Excel</a></p>\n"}], "owner": {"reputation": 23, "user_id": 7435713, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/233b1182ebcce6b975c7d24bd1f02cbb?s=128&d=identicon&r=PG&f=1", "display_name": "mfo_28", "link": "https://stackoverflow.com/users/7435713/mfo-28"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 512, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1490185415, "creation_date": 1490176744, "question_id": 42948218, "link": "https://stackoverflow.com/questions/42948218/excel-data-validation-not-include-blank-cell-error", "title": "Excel data validation not include blank cell error", "body": "<p>I need to populate the data in data validation. I use below code for it.</p>\n\n<pre><code>Dim IntRow As Integer, IntLastRow As Integer\nDim Txt As String\n\nWith Sheet2\n\nIntLastRow = .Cells(Rows.Count, 6).End(xlUp).Row\n\n\nFor IntRow = 10 To IntLastRow\n\n    If Not IsEmpty(.Cells(IntRow, 6)) Then\n\n\n        Txt = Txt &amp; .Cells(IntRow, 6) &amp; \",\"\n    End If\nNext IntRow\nEnd With\n\nTxt = Left(Txt, Len(Txt) - 1)\n\n\nWith Sheet1.Range(\"E4\").Validation\n\n.Delete\n.Add _\nType:=xlValidateList, _\nAlertStyle:=xlValidAlertStop, _\nOperator:=xlBetween, _\nFormula1:=Txt\nEnd With\n</code></pre>\n\n<p>There are hundreds of data to insert in the drop down list. However there are blank cells between the data. This code works fine until I save it and reopen it again it will give an error. It automatically removes the data validation when repaired the workbook.</p>\n"}, {"tags": ["vba", "excel", "sharepoint", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1490176282, "post_id": 42947922, "comment_id": 72991415, "body": "You would probably have to change all the <code>&#47;</code> to <code>\\ </code> also"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1490180804, "post_id": 42947922, "comment_id": 72994725, "body": "Hi CLR: Thank you for taking the time to respond, I tried the code you supplied but now I am getting another error. Run Time error &#39;438&#39; Have I done something wrong. I also changed the / to / as suggested by Macro Man I get the same error."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1490180988, "post_id": 42947922, "comment_id": 72994860, "body": "Can you update the question with your coding as you have it now?"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1490183310, "post_id": 42947922, "comment_id": 72996460, "body": "CLR I have added the new coding to the question please note that i removed  <code>_</code> from the piece of code you supplied me <code>&#47;[FILENAME.xlsx]&quot; _ , FileFormat:</code> as that line of code became red if the <code>_</code> remained in. Thank you again for the assistance I also to Macro mans advice and replaced <code>\\ with </code>/"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1490183531, "post_id": 42947922, "comment_id": 72996626, "body": "But you&#39;ve replaced the <code>[FILENAME.xlsx]</code> with the actual filename (and extension) yes?"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1490184274, "post_id": 42947922, "comment_id": 72997156, "body": "ah no I will try that now. sorry."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1490185189, "post_id": 42947922, "comment_id": 72997800, "body": "Don&#39;t forget, if you&#39;re using <code>FileFormat:=xlOpenXMLWorkbookMacroEnabled</code> then the filename should end <code>.xlsm</code>"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1490185573, "post_id": 42947922, "comment_id": 72998103, "body": "Hi CLR I think I may of misunderstood your last comment. put the file name <code>ThisFile</code>and the location into the line that was bugging. This line is now red. have I done something wrong the line now looks like this <code>Application.SaveAs Filename:=&quot;\\\\teamspace.merck.com\\sites\\emea_efpia\\Shared%20D&zwnj;&#8203;ocuments\\EFPIA%20Reg&zwnj;&#8203;ional%20Reporting%20&zwnj;&#8203;Team%2FDispute%20Man&zwnj;&#8203;agement\\Dispute%20re&zwnj;&#8203;ports%20per%20market&zwnj;&#8203;\\Global%20Reporting\\&zwnj;&#8203;[&quot;C:\\Users\\CONNELLP\\&zwnj;&#8203;Desktop\\Claire Macro\\CRO Countries\\&quot; &amp; ThisFile &amp; Format(Now(), &quot;DD-MMM-YYYY hh mm AMPM&quot;)]&quot;, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False</code>"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1490186257, "post_id": 42947922, "comment_id": 72998614, "body": "I&#39;m assuming from the above that you have a function or variable called <code>ThisFile</code> which contains the name of the file you want to write, <i>without</i> the file extension. If that&#39;s the case then I think this will work - <code>Application.SaveAs Filename:=&quot;\\\\teamspace.merck.com\\sites\\emea_efpia\\Shared%20D&zwnj;&#8203;ocuments\\EFPIA%20Reg&zwnj;&#8203;ional%20Reporting%20&zwnj;&#8203;Team%2FDispute%20Man&zwnj;&#8203;agement\\Dispute%20re&zwnj;&#8203;ports%20per%20market&zwnj;&#8203;\\Global%20Reporting\\&zwnj;&#8203;&quot; &amp; ThisFile &amp; Format(Now(), &quot;DD-MMM-YYYY hh mm AMPM&quot;) &amp; &quot;.xlsm&quot;, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False</code>"}, {"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1490192538, "post_id": 42947922, "comment_id": 73003416, "body": "Hi CLR: Nope sorry I entered the code you supplied above without the file extension and still I have the same error. and yes <code>ThisFile</code> is a variable declared earlier in the code. It takes the vale in A2 and names the worksheet after it."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "reply_to_user": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1490192788, "post_id": 42947922, "comment_id": 73003609, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/138739/discussion-between-clr-and-philip-connell\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1490176374, "last_edit_date": 1490176374, "creation_date": 1490176050, "answer_id": 42947922, "question_id": 42947654, "link": "https://stackoverflow.com/questions/42947654/vba-to-upload-excel-file-to-sharepoint-run-time-error-1004/42947922#42947922", "title": "VBA to upload Excel File to Sharepoint. Run Time error &#39;1004&#39;", "body": "<p>You're trying to save to a page, not a folder.Try changing the saveas line to:</p>\n\n<pre><code>Application.SaveAs Filename:=\"//teamspace.merck.com/sites/emea_efpia/Shared%20Documents/EFPIA%20Regional%20Reporting%20Team%2FDispute%20Management/Dispute%20reports%20per%20market/Global%20Reporting/[FILENAME.xlsx]\" _\n , FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1482, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1490185703, "creation_date": 1490175473, "last_edit_date": 1490185703, "question_id": 42947654, "link": "https://stackoverflow.com/questions/42947654/vba-to-upload-excel-file-to-sharepoint-run-time-error-1004", "title": "VBA to upload Excel File to Sharepoint. Run Time error &#39;1004&#39;", "body": "<p>Hi all I hope you can help. I have a piece of code and what it does is if cell A2 is changed to anything other than \"Enter Your Country Here\" it finds and replaces all the \"Enter Your Country Here\" in the workbook with the new value in A2. This part works fine. The issue I am having is that once the cell change happens I also want the workbook to save to our Sharepoint environment. But I keep getting <strong>Run Time error '1004'</strong> on the following line </p>\n\n<pre><code>SaveAs Filename:=\"http://teamspace.merck.com/sites/emea_efpia/Shared%20Documents/Forms/AllItems.aspx?RootFolder=%2Fsites%2Femea%5Fefpia%2FShared%20Documents%2FEFPIA%20Regional%20Reporting%20Team%2FDispute%20Management%2FDispute%20reports%20per%20market%2FGlobal%20Reporting&amp;FolderCTID=0x012000FA7F4E9565D6274DAF9E871EA008299B&amp;View=%7BB6EF0397-E24C-49DF-92EF-CB7015B60539\"\n</code></pre>\n\n<p>If I replace the Sharepoint address with a C drive or local address it works perfectly. Am I missing something? Can my code be amended to allow the workbook to be saved to Sharepoint? My code is below and as always any and all help is greatly appreciated. </p>\n\n<p>CODE </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  ThisFile = Range(\"A2\").Value\n  Dim cell As Range\n  Dim sht As Worksheet\n  Dim fnd As Variant\n  Dim rplc As Variant\n\n  fnd = \"Enter Your Country Here\"\n  rplc = Worksheets(\"SearchCasesResults\").Range(\"A2\").Value\n  For Each sht In ActiveWorkbook.Worksheets\n  sht.Cells.Replace what:=fnd, Replacement:=rplc, _\n  LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n  SearchFormat:=False, ReplaceFormat:=False\n  Next sht\n  For Each cell In Range(\"A2\")\n  If cell.Value &lt;&gt; \"Enter Your Country Here\" Then\n  SaveAs Filename:=\"http://teamspace.merck.com/sites/emea_efpia/Shared%20Documents/Forms/AllItems.aspx?RootFolder=%2Fsites%2Femea%5Fefpia%2FShared%20Documents%2FEFPIA%20Regional%20Reporting%20Team%2FDispute%20Management%2FDispute%20reports%20per%20market%2FGlobal%20Reporting&amp;FolderCTID=0x012000FA7F4E9565D6274DAF9E871EA008299B&amp;View=%7BB6EF0397-E24C-49DF-92EF-CB7015B60539\"\n  End If\n  Next cell\n  Worksheets(\"SearchCasesResults\").Activate\n  ActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n\n<p>As requested new coding</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n\n  ThisFile = Range(\"A2\").Value\n  Dim cell As Range\n  Dim sht As Worksheet\n  Dim fnd As Variant\n  Dim rplc As Variant\n\n  fnd = \"Enter Your Country Here\"\n  rplc = Worksheets(\"SearchCasesResults\").Range(\"A2\").Value\n  For Each sht In ActiveWorkbook.Worksheets\n  sht.Cells.Replace what:=fnd, Replacement:=rplc, _\n  LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n  SearchFormat:=False, ReplaceFormat:=False\n  Next sht\n  For Each cell In Range(\"A2\")\n  If cell.Value &lt;&gt; \"Enter Your Country Here\" Then\n  Application.SaveAs Filename:=\"\\\\teamspace.merck.com\\sites\\emea_efpia\\Shared%20Documents\\EFPIA%20Regional%20Reporting%20Team%2FDispute%20Management\\Dispute%20reports%20per%20market\\Global%20Reporting\\[\"C:\\Users\\CONNELLP\\Desktop\\Claire Macro\\CRO Countries\\\" &amp; ThisFile &amp; Format(Now(), \"DD-MMM-YYYY hh mm AMPM\").xlsm]\", FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n  End If\n  Next cell\n  Worksheets(\"SearchCasesResults\").Activate\n  ActiveWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1490175920, "post_id": 42947174, "comment_id": 72991167, "body": "you can add a function which checks whether the CA-code exists in the lookup value and if department is BIB"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490176914, "post_id": 42948118, "comment_id": 72991922, "body": "Thanks for your reply. Does this mean i&#39;d have to check it for all the ca-codes as well using if check_dep(&quot;ca00813&quot;,&quot;BiB&quot;) then ?"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490177075, "post_id": 42948118, "comment_id": 72992052, "body": "It checks for the ca_code you pass as argument in the argument and checks the department is the value you passed.....If you want to check for different ca_code in a different department you just have to pass those values as argument"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490177160, "post_id": 42948118, "comment_id": 72992115, "body": "If you have a range of ca_codes to be checked whether they are in BIB department...You can have a for loop for the cell pass those values one by one"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490177647, "post_id": 42948118, "comment_id": 72992452, "body": "Yeah, the thing is there&#39;s a lot of CA-codes, and i&#39;m really only interested in the ones belonging to BIB. The CA-codes should read from rawdata, check in lookup workbook, then if the department is BIB, do something. So i&#39;m looking for a way to compare the two (i already got a macro for if it doesn&#39;t exist), then if it&#39;s department BIB continue"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490186961, "post_id": 42948118, "comment_id": 72999115, "body": "If you can upload a sample file, I ll check what i can do"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490189503, "post_id": 42948118, "comment_id": 73000977, "body": "Thank you very much. I had to remove a lot of data, as it&#39;s not something i can share publicly. The file is here; <a href=\"https://expirebox.com/download/a9e70479d468ff267a3c9ecd049bca8a.html\" rel=\"nofollow noreferrer\">expirebox.com/download/a9e70479d468ff267a3c9ecd049bca8a.html</a> .. It&#39;s only the &quot;PasStat&quot; modules in this case, and the listed code is under &quot;PasStat_C_Open&quot;  The other file, 0217 is the rawdata that the user is prompted to select"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490191462, "post_id": 42948118, "comment_id": 73002558, "body": "i cant find the department column in the raw data...can you tell which one is it?"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490191699, "post_id": 42948118, "comment_id": 73002741, "body": "there are sheets in the code that i cant find in the workbook...you have the value of ca_code and you want to lookup its department and do something if the value is BIB....this is what you want, Right?"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490193266, "post_id": 42948118, "comment_id": 73004028, "body": "Oh, right. The &quot;Afd&quot; in the other workbook is the Department column, in sheet &quot;CA-koder&quot;. Sorry, did not change it to English :( And for the other question, that is right. I want it to find out if the CA-code in 0217 matches one in Sheet &quot;CA-koder&quot;, and then IF it&#39;s BIB do the I&#197; and U&#197; thing"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490196328, "post_id": 42948118, "comment_id": 73006593, "body": "<a href=\"https://ufile.io/2e37d1\" rel=\"nofollow noreferrer\">ufile.io/2e37d1</a>    i have uploaded the file here...i might have changed the indeks and sammmelign functions to english change them back and check if it works"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490251692, "post_id": 42948118, "comment_id": 73031010, "body": "Thanks a lot Sivaprasath!  It doesn&#39;t seem to count the U&#197; now though?"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490255489, "post_id": 42948118, "comment_id": 73032721, "body": "After the function, which does return val1, &quot;BIB&quot;, it just skips the whole &quot;If .value = Monday&quot; etc."}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490259190, "post_id": 42948118, "comment_id": 73034709, "body": "So the function must be returning false....Try msgbox the check_dep value in the function....To check if it&#39;s true"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490259852, "post_id": 42948118, "comment_id": 73035176, "body": "I stepped it step by step, and it is returning true. The val1 and &quot;BIB&quot;-parts are correct, and the check_dep_res is set to true before ending the function. When it ends, it just skips the weekday-IF&#39;s completely"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490260083, "post_id": 42948118, "comment_id": 73035352, "body": "Could it be related to the  &quot;If check_dep(val1, &quot;BIB&quot;) Then&quot; not being &quot; If check_dep(CA_code, &quot;BIB&quot;) Then&quot; ?? It jumps directly down to &quot;Else&quot;-part after the function is run"}, {"owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "reply_to_user": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "edited": false, "score": 0, "creation_date": 1490260292, "post_id": 42948118, "comment_id": 73035496, "body": "It&#39;s just passing the value....If you want inside the function print ca_code and select whether it&#39;s passed"}, {"owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "reply_to_user": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "edited": false, "score": 0, "creation_date": 1490261141, "post_id": 42948118, "comment_id": 73036092, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/138800/discussion-between-thiil-and-sivaprasath-v\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 543, "user_id": 7509720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4d2fbdc56f25a806cb48e04b1ecf582?s=128&d=identicon&r=PG&f=1", "display_name": "Sivaprasath Vadivel", "link": "https://stackoverflow.com/users/7509720/sivaprasath-vadivel"}, "is_accepted": true, "score": 1, "last_activity_date": 1490178774, "last_edit_date": 1490178774, "creation_date": 1490176494, "answer_id": 42948118, "question_id": 42947174, "link": "https://stackoverflow.com/questions/42947174/compare-2-cells-then-read-a-3rd/42948118#42948118", "title": "Compare 2 cells, then read a 3rd", "body": "<pre><code>public function check_dep(CA_code as variant,dep as varaint) as boolean\nval1=CA_code\nlr=workbook(\"Rawdata\").sheets(1).range(\"A\"&amp; rows.count).end(xlup).row\nfor i=2 to lr\nval2=workbook(\"Rawdata\").sheets(1).cells(i,1).value\nif val==val2 then\ndep1=workbook(\"Rawdata\").sheets(1).cells(i,4).value\nif dep1=dep then\ncheck_dep=True\nelse\ncheck_dep=False\nend if\nend if\nnext i\nreturn checK_dep\nend function\n</code></pre>\n\n<p>you can use this function to check if the CA code belongs the required department you can use it in a if condition as</p>\n\n<pre><code>if check_dep(\"ca00813\",\"BiB\") then\n'statements to be executed\nend if\n</code></pre>\n\n<p>If a range of ca_codes needs to be checked use:</p>\n\n<pre><code>Dim cell as range\nDim ca_rng as range\nLr2= workbooks(\"Main workbook\").Sheets(1). range(\"A\"&amp; rows.count).end(xlup).row\nSet ca_rng= workbooks(\"Main workbook\").Sheets(1). range(\"A2:A\" &amp; lr2)\nFor each cell in ca_rng\nCa_code= cell.vlaue\n IF Check_dep(ca_code,\"BIB\") then\n ' statements\n End if\n Next\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 5271784, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-NcqM_27RtQM/AAAAAAAAAAI/AAAAAAAABnI/aEr7QEEh2n0/photo.jpg?sz=128", "display_name": "Thiil", "link": "https://stackoverflow.com/users/5271784/thiil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 42948118, "answer_count": 1, "score": 0, "last_activity_date": 1490178774, "creation_date": 1490174218, "last_edit_date": 1490175336, "question_id": 42947174, "link": "https://stackoverflow.com/questions/42947174/compare-2-cells-then-read-a-3rd", "title": "Compare 2 cells, then read a 3rd", "body": "<p>I have 2 workbooks. 1 used as a lookup, and 1 as raw data. There's CA-codes (employee codes) in both these workbooks. The CA-codes do not belong to the same departments however, and that is listed in the lookup workbook. </p>\n\n<p>I need my macro to be able to </p>\n\n<ol>\n<li><p>Check if CA-code exists in Rawdata workbook </p></li>\n<li><p>Check the department</p></li>\n<li>Continue if department is \"BIB\"</li>\n</ol>\n\n<p>As you can see below, it currently only looks for the specific CA-codes, which means that i have to update that value in the lookup as well as the code. </p>\n\n<p>I have not yet tried to get it to look for \"BIB\", as i have no clue how i would go about it. </p>\n\n<p><strong>lookup data looks like this in the cells:</strong></p>\n\n<p>CA-code | Org. level    | Name  | Department</p>\n\n<p>ca00813 | 530040 | Employee employeeson |   BIB</p>\n\n<p>BIB could be other departments. </p>\n\n<p>Note that this is a sub being called mid-operation to validate the opening hours, IF the CA-code is a BIB Employee</p>\n\n<pre><code>Sub PS_Open() Dim LastRow4 As Long Application.Calculation = xlCalculationAutomatic Sheets(\"TempRaw\").Activate LastRow4 = Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nRange(\"J2\").Formula = \"=Weekday(D2)\"\n\nRange(\"J2\").AutoFill Destination:=Range(\"J2:J\" &amp; LastRow4)\n\nRange(\"K2\").FormulaLocal = \"=INDEKS(Opslag_ugedage!$B$1:$B$7;SAMMENLIGN(J2;Opslag_ugedage!$A$1:$A$7;0))\" Range(\"K2\").AutoFill Destination:=Range(\"K2:K\" &amp; LastRow4)\n\nRange(\"L2\").FormulaLocal = \"=TIME(D2)\" Range(\"L2\").AutoFill Destination:=Range(\"L2:L\" &amp; LastRow4)\n\n\n Dim rng As Range, rng2 As Range, x As Long  Dim Man As Integer, Tirs As Integer, Ons As Integer, Tors As Integer, Fre As Integer, L\u00f8r As Integer, S\u00f8n As Integer, I\u00c5 As Integer\n    Set rng = Range(Range(\"K2\"), Range(\"K\" &amp; Rows.Count).End(xlUp))\n    Set rng2 = Range(Range(\"L2\"), Range(\"L\" &amp; Rows.Count).End(xlUp)) U\u00c5 = 0 I\u00c5 = 0 i = 0\n    For x = rng.Cells.Count To 1 Step -1\n        With rng.Cells(x)  **' IF it's a BIB employee If** rng.Cells(x).Offset(0, -6).Value = \"ca00813\" Or rng.Cells(x).Offset(0,\n-6).Value = \"ca00815\" Or rng.Cells(x).Offset(0, -6).Value = \"ca00818\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca6b101\" Or rng.Cells(x).Offset(0, -6).Value = \"ca6b60\" Or rng.Cells(x).Offset(0,\n-6).Value = \"ca6b61\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca6b87\" Or rng.Cells(x).Offset(0, -6).Value = \"ca6b92\" Or rng.Cells(x).Offset(0, -6).Value = \"ca6b95\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca6b97\" Or rng.Cells(x).Offset(0,\n-6).Value = \"ca6svs7\" Or rng.Cells(x).Offset(0, -6).Value = \"ca00816\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca01404\" Or rng.Cells(x).Offset(0, -6).Value = \"ca014041\" Or rng.Cells(x).Offset(0, -6).Value = \"ca6b63\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca00781\" Or rng.Cells(x).Offset(0,\n-6).Value = \"ca00783\" Or rng.Cells(x).Offset(0, -6).Value = \"ca00785\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca00787\" Or rng.Cells(x).Offset(0, -6).Value = \"ca00789\" Or rng.Cells(x).Offset(0,\n-6).Value = \"ca00790\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca00821\" Or rng.Cells(x).Offset(0, -6).Value = \"ca00928\" Or rng.Cells(x).Offset(0, -6).Value = \"ca00999\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca01083\" Or rng.Cells(x).Offset(0,\n-6).Value = \"ca01267\" Or rng.Cells(x).Offset(0, -6).Value = \"ca01312\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca01313\" Or rng.Cells(x).Offset(0, -6).Value = \"ca01361\" Or rng.Cells(x).Offset(0,\n-6).Value = \"ca01363\" _ Or rng.Cells(x).Offset(0, -6).Value = \"ca01364\" Or rng.Cells(x).Offset(0, -6).Value = \"ca00795\" Or rng.Cells(x).Offset(0, -6).Value = \"ca1f601\" Then\n\n    ' S\u00e5 m\u00e5l om det er indenfor \u00e5bningstiden i BSC og t\u00e6l antal U\u00c5 (Udenfor\u00c5bningstid)\n\n\n            If .Value = \"Mandag\" Then\n                    If rng.Cells(x).Offset(0, 1) &lt; 17 And rng.Cells(x).Offset(0, 1) &gt;= 9 Then I\u00c5 = I\u00c5 + 1 Else U\u00c5 = U\u00c5 + 1\n                    End If\n            If .Value = \"Tirsdag\" Then\n                    If rng.Cells(x).Offset(0, 1) &lt; 13 And rng.Cells(x).Offset(0, 1) &gt;= 9 Then I\u00c5 = I\u00c5 + 1 Else U\u00c5 = U\u00c5 + 1\n                    End If\n            If .Value = \"Onsdag\" Then\n                    If rng.Cells(x).Offset(0, 1) &lt; 13 And rng.Cells(x).Offset(0, 1) &gt;= 9 Then I\u00c5 = I\u00c5 + 1 Else U\u00c5 = U\u00c5 + 1\n                    End If\n            If .Value = \"Torsdag\" Then\n                    If rng.Cells(x).Offset(0, 1) &lt; 17 And rng.Cells(x).Offset(0, 1) &gt;= 9 Then I\u00c5 = I\u00c5 + 1 Else U\u00c5 = U\u00c5 + 1\n                    End If\n            If .Value = \"Fredag\" Then\n                    If rng.Cells(x).Offset(0, 1) &lt; 13 And rng.Cells(x).Offset(0, 1) &gt;= 9 Then I\u00c5 = I\u00c5 + 1 Else U\u00c5 = U\u00c5 + 1\n                    End If\n            If .Value = \"L\u00f8rdag\" Or .Value = \"S\u00f8ndag\" Then U\u00c5 = U\u00c5 + 1\n\n        Else\n        ' Ellers (Hvis det ikke er BIB medarbejder), s\u00e5 t\u00e6l I\u00c5 (Indenfor \u00c5bningstid)\n            I\u00c5 = I\u00c5 + 1\n            ' I\u00c5 = I\u00c5 + 1 Fre = Fre + 1 'And cell.Offset(0, 6).Value = \"Mandag\"\n            'If Weekday = vbFriday Then Fre = Fre + 1 'And cell.Offset(0, 6).Value = \"Mandag\"\n\n            End If\n        End With\n    i = i + 1\n    Next x\n\nSheets(\"Ark1\").Range(\"N13\").Value = U\u00c5\n    'MsgBox \"Inden for \u00e5bningstid: \" &amp; I\u00c5 &amp; \"   Udenfor \u00e5bningstid: \" &amp; U\u00c5\n\n\nApplication.Calculation = xlCalculationManual\n\n'Slet TempRaw efter validering af tal ActiveWorkbook.Worksheets(\"TempRaw\").Activate Application.DisplayAlerts = False ActiveSheet.Delete Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1490174769, "post_id": 42947097, "comment_id": 72990344, "body": "please see this answer <a href=\"http://stackoverflow.com/questions/42760029/call-sub-not-working-but-code-works-when-placed-in-sub-that-is-doing-the-calling/42762561#42762561\" title=\"call sub not working but code works when placed in sub that is doing the calling\">stackoverflow.com/questions/42760029/&hellip;</a>"}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490237407, "post_id": 42947097, "comment_id": 73026574, "body": "Thanks for the reply, is this solution for all textboxes in my userform or I can modify it for the specific boxes I want?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490261160, "post_id": 42947097, "comment_id": 73036115, "body": "You can do what ever you want, set the names to be something like stdTbx# and custTbx#, then check the start of the names and only do it to text boxes on the form where the <code>.name</code> starts with custTbx say."}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490349767, "post_id": 42947097, "comment_id": 73082880, "body": "Thanks for that,"}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490349834, "post_id": 42947097, "comment_id": 73082936, "body": "I have used Left( .name, 9) = &quot;Iteminput&quot; to make it happened :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490352303, "post_id": 42947097, "comment_id": 73084604, "body": "Good.  Did you put this in the add to the collection part, or within the class?  It will work in either, but in the class you could make certain events happen based on it&#39;s name, if you just want standard or one function handled like this, then just do it at the collection adding part."}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490353466, "post_id": 42947097, "comment_id": 73085366, "body": "Yes, I am working on that."}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490353474, "post_id": 42947097, "comment_id": 73085374, "body": "Thanks for making my day easy :)"}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490353563, "post_id": 42947097, "comment_id": 73085443, "body": "Btw I have another Problem, that I want to loop the textbox like : For i = 1 To 4  frmDataEntry.Control(&quot;TextBox&quot; &amp; i).Value = frmDataEntry.Control(&quot;Box&quot; &amp; i).Value  Next i, but it doesnt work @Nathan_Sav"}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490353965, "post_id": 42947097, "comment_id": 73085737, "body": "loop when event change"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1490353966, "post_id": 42947097, "comment_id": 73085738, "body": "<code>controls</code>  its a collection of <code>control</code>&#39;s in the class you&#39;ll need to pass in the form as with the textbox, so <code>INIT(tb as textbox,frm as userform)</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490354407, "post_id": 42947097, "comment_id": 73086029, "body": "thinking on it, you can get the form from the control I believe to."}, {"owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490354410, "post_id": 42947097, "comment_id": 73086031, "body": "Done , thanks a lot :)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490356647, "post_id": 42947097, "comment_id": 73087468, "body": "Good man.  Use this as a spring board to the world of classes, will reduce coding a lot also."}], "owner": {"reputation": 25, "user_id": 3669978, "user_type": "registered", "profile_image": "https://graph.facebook.com/557637491/picture?type=large", "display_name": "Simone Rene", "link": "https://stackoverflow.com/users/3669978/simone-rene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1163, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490174010, "creation_date": 1490174010, "last_edit_date": 1531164843, "question_id": 42947097, "link": "https://stackoverflow.com/questions/42947097/same-code-for-multi-textboxes-excel-vba", "title": "Same code for multi textboxes Excel VBA", "body": "<p>There are about 100 textboxes in my Userform, and I hope to make 10 of those textboxes to call sub after event change, and I have tried to avoid to make a code for each of the boxes like: </p>\n\n<pre><code>Private Sub ItemInput1_1_Change()\nOriItemCode = ItemInput1_1.Value\nCall IndexMatchItem\nItemInput1_5.Value = MatchItemCodeOutput\nEnd Sub\n\nPrivate Sub ItemInput2_1_Change()\nOriItemCode = ItemInput2_1.Value\nCall IndexMatchItem\nItemInput2_5.Value = MatchItemCodeOutput\nEnd Sub\n\nPrivate Sub ItemInput3_1_Change()\nOriItemCode = ItemInput3_1.Value\nCall IndexMatchItem\nItemInput3_5.Value = MatchItemCodeOutput\nEnd Sub\n</code></pre>\n\n<p>so I ended up have a silly thought and come up with the few lines of code below for the specific boxes event change, but it doesnt work. </p>\n\n<p>I did some research on that but unfortunately, those tutorial are only for all textboxes which I couldnt applied them in my excel. </p>\n\n<p>It would be much appropriated if any VBA pros can give me a hand to change the codes below to make it works, so that I dont have to create event change for each textbox.  </p>\n\n<p>Thanks</p>\n\n<pre><code>Private Sub Box2Box3Box4Changeevent()\n\nDim i\nDim j\n\nFor i = 1 To 10\n\nIf Me.Controls(\"ItemInput\" &amp; i &amp; \"_\" &amp; 1 &amp; \"_\" &amp; \"Afterupdate\") Then\nCall Box2ChangeBox4\nEnd If\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490174084, "post_id": 42946901, "comment_id": 72989907, "body": "this may help <a href=\"http://www.vbforums.com/showthread.php?13798-Modal-Shell-App\" rel=\"nofollow noreferrer\">vbforums.com/showthread.php?13798-Modal-Shell-App</a>, or a touch simpler maybe <code>do until i=fol.files.count:doevents:loop</code>"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1490176809, "post_id": 42946901, "comment_id": 72991825, "body": "ignore the 2nd idea, it still wouldn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 65, "user_id": 4883545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10206462846310953/picture?type=large", "display_name": "Wannes Demaeght", "link": "https://stackoverflow.com/users/4883545/wannes-demaeght"}, "is_accepted": true, "score": 2, "last_activity_date": 1490180388, "creation_date": 1490180388, "answer_id": 42949681, "question_id": 42946901, "link": "https://stackoverflow.com/questions/42946901/make-excel-vba-wait-until-operation-is-finished/42949681#42949681", "title": "Make Excel VBA wait until operation is finished", "body": "<p>Thanks Nathan, you've put me on the right path:</p>\n\n<pre><code>Sub SplitFiles()\n\n'This needs PDFTK installed\n\nDim fso As New FileSystemObject\nDim fol As Folder\nDim fil As File\nDim i As Integer\nDim command As String\nDim number As Long\n\nOn Error Resume Next\n\nSet fol = fso.GetFolder(\"C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Splitsen\\\")\nnumber = fol.Files.Count\n\ni = 1\nFor Each fil In fol.Files\n    command = (\"C:\\Program Files (x86)\\PDFtk\\bin\\pdftk.exe \" &amp; fil &amp; \" burst output C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Klaar\\Klaar\" &amp; i &amp; \"-%d.pdf\")\n    Shell command\n    If i = number Then\n        Application.Wait (Now + TimeValue(\"0:00:02\"))\n        Kill \"C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Splitsen\\*.*\"\n        Kill \"C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Klaar\\*.txt\"\n        Shell (\"C:\\Program Files (x86)\\View and Rename PDF\\viewAndRename.exe\")\n    Else\n    i = i + 1\n    End If\nNext fil\n\nEnd Sub\n</code></pre>\n\n<p>This code works, but I hade to declare a variable as long first, or it would get stuck in a loop.</p>\n\n<p>Still a timeout of 2 seconds, because not all files got deleted without the delay (probably because they were still being processed by pdftk)</p>\n"}], "owner": {"reputation": 65, "user_id": 4883545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/10206462846310953/picture?type=large", "display_name": "Wannes Demaeght", "link": "https://stackoverflow.com/users/4883545/wannes-demaeght"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6045, "favorite_count": 0, "accepted_answer_id": 42949681, "answer_count": 1, "score": 0, "last_activity_date": 1581019626, "creation_date": 1490173319, "last_edit_date": 1581019626, "question_id": 42946901, "link": "https://stackoverflow.com/questions/42946901/make-excel-vba-wait-until-operation-is-finished", "title": "Make Excel VBA wait until operation is finished", "body": "<p>I have made a macro in VBA to split PDF files into single pages.</p>\n\n<pre><code>Sub SplitFiles()\n\n'This needs PDFTK installed\n\nDim fso As New FileSystemObject\nDim fol As Folder\nDim fil As File\nDim i As Integer\nDim command As String\n\nOn Error Resume Next\n\nSet fol = fso.GetFolder(\"C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Splitsen\\\")\n\ni = 1\n\nFor Each fil In fol.Files\n    command = (\"C:\\Program Files (x86)\\PDFtk\\bin\\pdftk.exe \" &amp; fil &amp; \" burst output C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Klaar\\Klaar\" &amp; i &amp; \"-%d.pdf\")\n    Shell command\n    i = i + 1\nNext fil\n\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\nKill \"C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Splitsen\\*.pdf\"\nKill \"C:\\Users\\wanne\\OneDrive\\Documents\\Bijberoep\\Scans\\Klaar\\*.txt\"\n\nEnd Sub\n</code></pre>\n\n<p>The problem is that I had to give a timeout of 5 seconds, or else the files get deleted immediately, and no output is created.</p>\n\n<p>How can I make excel wait until all files are processed?</p>\n"}]