[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11407867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4da71597a848eca46c98e702cd06fe?s=128&d=identicon&r=PG&f=1", "display_name": "TIVBA", "link": "https://stackoverflow.com/users/11407867/tivba"}, "edited": false, "score": 0, "creation_date": 1556203837, "post_id": 55839943, "comment_id": 98365968, "body": "Thank you, this worked perfectly. It is helping with the learning, in that I&#39;m trying to understand the code. What I didn&#39;t seem to think of was a loop within a loop.  Much appreciated!"}], "tags": [], "owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "is_accepted": true, "score": 0, "last_activity_date": 1556149703, "last_edit_date": 1556149703, "creation_date": 1556149307, "answer_id": 55839943, "question_id": 55839687, "link": "https://stackoverflow.com/questions/55839687/transposing-in-particular-format/55839943#55839943", "title": "Transposing In Particular Format", "body": "<p>This will do it for you ...</p>\n\n<pre><code>Public Sub TransformData()\n    Dim lngRow As Long, lngEndRow As Long, objSrcSheet As Worksheet, objDestSheet As Worksheet\n    Dim strLetter As String, strNumber As String, lngCol As Long, lngWriteRow As Long\n\n    Set objSrcSheet = Sheet1\n    Set objDestSheet = Sheet2\n\n    lngEndRow = objSrcSheet.Range(\"A\" &amp; objSrcSheet.Rows.Count).End(xlUp).Row\n\n    With objSrcSheet\n        For lngRow = 1 To lngEndRow\n            strLetter = .Cells(lngRow, 1)\n\n            If strLetter &lt;&gt; \"\" Then\n                For lngCol = 2 To .Columns.Count\n                    strNumber = .Cells(lngRow, lngCol)\n\n                    If strNumber = \"\" Then Exit For\n\n                    lngWriteRow = lngWriteRow + 1\n\n                    objDestSheet.Cells(lngWriteRow, 1) = strLetter\n                    objDestSheet.Cells(lngWriteRow, 2) = strNumber\n                Next\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n\n<p>... I decided to give you an entire solution.  Right or wrong, best or worst, that's how I would do it and given you're learning, I hope it helps you.  It also takes an approach where SELECT is not being used, that will do nothing more than slow you down and is considered to be extremely bad practice.</p>\n\n<p>It assumes my source worksheet looks like the below image.  I hope that helps.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ASW25.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ASW25.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1556151324, "creation_date": 1556151324, "answer_id": 55840146, "question_id": 55839687, "link": "https://stackoverflow.com/questions/55839687/transposing-in-particular-format/55840146#55840146", "title": "Transposing In Particular Format", "body": "<p>A simple Excel related method is to use <code>Power Query</code> aka <code>Get&amp;Transform</code>. Select the first column and then <code>unpivot</code> the <code>Other</code> columns.  All that can be done from the User Interface.</p>\n\n<p>If you want to have a macro that uses loops to accomplish the same end result, I would do as below.  Note that I do the looping in VBA arrays rather than using repeated calls to/from the worksheet.  This is a much faster method.</p>\n\n<pre><code>Option Explicit\nSub due()\n    'Declare the variables\n    Dim WS1 As Worksheet, WS2 As Worksheet\n    Dim rSrc As Range, rRes As Range\n    Dim vSrc As Variant, vRes As Variant\n    Dim lRC() As Long\n    Dim I As Long, J As Long, K As Long\n\n'Set Worksheet and Range variables\n'Determine Last Row and Column of the range, assuming starts in A1\nSet WS1 = Sheet1\nSet WS2 = Sheet2\n    Set rRes = WS2.Cells(1, 1)\nlRC = LastRowCol(WS1.Name)\n\n'Read the source data into a VBA array\n'much faster than operating on the worksheet\nWith WS1\n    Set rSrc = .Range(.Cells(1, 1), .Cells(lRC(0), lRC(1)))\n    vSrc = rSrc\nEnd With\n\n'size the results array\n'note that `Count` will only count the numeric entries, which is what we want\n'might have to use a different computation if there is not a nice text/number\n'differentiation between column 1 and the rest of the data\nReDim vRes(1 To WorksheetFunction.Count(rSrc), 1 To 2)\n\n'Here is the loop\n'we go through the source data one row at a time\n'writing to the results array as you can see\n'Need to check for blank entries since not all rows are the\n' same length.\nK = 0\nFor I = 1 To UBound(vSrc, 1)\n    For J = 2 To UBound(vSrc, 2)\n        If vSrc(I, J) &lt;&gt; \"\" Then\n            K = K + 1\n            vRes(K, 1) = vSrc(I, 1)\n            vRes(K, 2) = vSrc(I, J)\n        End If\n    Next J\nNext I\n\n'write the results to the destination worksheet\nSet rRes = rRes.Resize(UBound(vRes, 1), UBound(vRes, 2))\nWith rRes\n    .EntireColumn.Clear\n    .Value = vRes\nEnd With\n\nEnd Sub\n\nFunction LastRowCol(Worksht As String) As Long()\nApplication.Volatile\n    Dim WS As Worksheet, R As Range\n    Dim LastRow As Long, LastCol As Long\n    Dim L(1) As Long\nSet WS = Worksheets(Worksht)\nWith WS\n    Set R = .Cells.Find(what:=\"*\", after:=.Cells(1, 1), _\n                    LookIn:=xlFormulas, lookat:=xlPart, searchorder:=xlByRows, _\n                    searchdirection:=xlPrevious)\n\n    If Not R Is Nothing Then\n        LastRow = R.Row\n        LastCol = .Cells.Find(what:=\"*\", after:=.Cells(1, 1), _\n                    LookIn:=xlFormulas, lookat:=xlPart, searchorder:=xlByColumns, _\n                    searchdirection:=xlPrevious).Column\n    Else\n        LastRow = 1\n        LastCol = 1\n    End If\nEnd With\n\nL(0) = LastRow\nL(1) = LastCol\nLastRowCol = L\nEnd Function\n</code></pre>\n\n<p><strong>Source Data</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/KzQD7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KzQD7.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Results</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/2QgPm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2QgPm.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11408315"}, "is_accepted": false, "score": 0, "last_activity_date": 1556160407, "creation_date": 1556160407, "answer_id": 55841094, "question_id": 55839687, "link": "https://stackoverflow.com/questions/55839687/transposing-in-particular-format/55841094#55841094", "title": "Transposing In Particular Format", "body": "<p>It may be easier to navigate (and certainly faster) to work within arrays.</p>\n\n<pre><code>Option Explicit\n\nSub stackTranspose()\n\n    Dim i As Long, j As Long, k As Long, vals As Variant, arr As Variant\n\n    'collect original values into source array\n    With Worksheets(1)\n        vals = .Cells(1, \"A\").CurrentRegion.Value2\n    End With\n\n    'redimension target array and set k for first 'row'\n    ReDim arr(1 To Application.Count(vals), 1 To 2)\n    k = 1\n\n    'loop through source and transfer transposed values\n    For i = LBound(vals, 1) To UBound(vals, 1)\n        For j = LBound(vals, 2) + 1 To UBound(vals, 2)\n            'is there a value to transfer?\n            If vals(i, j) &lt;&gt; vbNullString Then\n                arr(k, 1) = vals(i, LBound(vals, 2))\n                arr(k, 2) = vals(i, j)\n                'increment target 'row'\n                k = k + 1\n            Else\n                'blank value; move to next source 'row'\n                Exit For\n            End If\n        Next j\n    Next i\n\n    'put target values into Sheeet2\n    With Worksheets(2)\n        .Cells(1, \"A\").Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1556183572, "last_edit_date": 1556183572, "creation_date": 1556182804, "answer_id": 55845505, "question_id": 55839687, "link": "https://stackoverflow.com/questions/55839687/transposing-in-particular-format/55845505#55845505", "title": "Transposing In Particular Format", "body": "<p>I know you ask for a macro, but just wanted to give you an alternative through formulas:</p>\n\n<p>Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LeC47.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LeC47.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/sfng6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sfng6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formula in <code>A1</code>:</p>\n\n<pre><code>{=INDEX(Sheet1!$A$1:$A$3,SMALL((Sheet1!$B$1:$G$3&gt;0)*ROW(Sheet1!$B$1:$G$3),ROW()+COUNTBLANK(Sheet1!$B$1:$G$3)))}\n</code></pre>\n\n<p>Formula in <code>B1</code>:</p>\n\n<pre><code>=INDEX(Sheet1!$A$1:$G$3,MATCH(A1,Blad1!$A$1:$A$3,0),COUNTIF($A$1:A1,A1)+1)\n</code></pre>\n\n<p>Notice the first formula needs to be entered through <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd></p>\n\n<p>Drag formulas down....</p>\n\n<p>Good luck, ps. there are probably other formulas as well.</p>\n"}], "owner": {"reputation": 33, "user_id": 11407867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff4da71597a848eca46c98e702cd06fe?s=128&d=identicon&r=PG&f=1", "display_name": "TIVBA", "link": "https://stackoverflow.com/users/11407867/tivba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 55839943, "answer_count": 4, "score": 3, "last_activity_date": 1556183572, "creation_date": 1556146999, "last_edit_date": 1556172576, "question_id": 55839687, "link": "https://stackoverflow.com/questions/55839687/transposing-in-particular-format", "title": "Transposing In Particular Format", "body": "<p>Today I finished the loops section of by VBA course and have been doing a few practices, but I've come across a problem I cannot seem to figure out.</p>\n\n<p>I want to transpose data from sheet 1 to sheet to sheet 2. </p>\n\n<p>Sheet 1</p>\n\n<pre><code>a   1   2   3\nb   1   2   3   4   5   6\nc   1   2   3   4\n</code></pre>\n\n<p>I am trying to write a macro which will transpose the data into Sheet 2 like this:</p>\n\n<pre><code>a   1\na   2\na   3\nb   1\nb   2\nb   3\nb   4\nb   5\nb   6\nc   1\nc   2\nc   3\nc   4\n</code></pre>\n\n<p>I tried to write some VBA code, but I have no idea how to approach this particular problem. I tried using Do Until Loops, but the issue I run into is how I get the the letters in sheet 1, column 1 to paste with their corresponding numbers in sheet 2.</p>\n\n<p>A friend did some code for me to analyse, but it confused me even more. It works for this data set, but fails to do this with a larger data set (one where the letters go up to 'z').</p>\n\n<p>Here is his code:</p>\n\n<pre><code>Sub transpose()\n    Sheets(1).Select\n\n    lrow1 = Cells(Rows.Count, 1).End(xlUp).Row\n\n    For i = 1 To lrow1\n        nums = 2\n\n        Cells(i, nums).Select\n\n        Do Until IsEmpty(ActiveCell)\n            nums = nums + 1\n            Cells(i, nums).Select\n        Loop\n\n        Range(Cells(i, 2), Cells(i, nums)).Copy\n        Sheets(2).Select\n\n        lrow2 = Cells(Rows.Count, 2).End(xlUp).Row\n\n        Cells(lrow2 + 1, 2).Select\n\n        Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n            False, transpose:=True\n\n        Sheets(1).Select\n\n        Cells(i, 1).Copy\n\n        Sheets(2).Select\n\n        Cells(lrow2 + 1, 1).Select\n\n        Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _\n            False, transpose:=False\n\n        lrow3 = Cells(Rows.Count, 2).End(xlUp).Row\n\n        Cells(lrow2 + 1, 1).Select\n\n        Selection.AutoFill Destination:=Range(Cells(lrow2 + 1, 1), Cells(lrow3, 1)), Type:=xlFillDefault\n\n        Sheets(1).Select\n    Next i\n\n    Sheets(2).Select\n\n    Rows(\"1:1\").Select\n\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://pastebin.com/J45fmYKj\" rel=\"nofollow noreferrer\">https://pastebin.com/J45fmYKj</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 0, "creation_date": 1556148491, "post_id": 55839629, "comment_id": 98343346, "body": "Have you wrapped your code in the Worksheet_Change event?  Can you add an image or something that shows the before state and what you want as the after state?  I&#39;m confused by the specifics of what you&#39;re wanting to achieve.  Also, this ... ActiveSheet.Paste Destination:=Worksheets(&quot;Links&quot;).Range(&quot;lastCell,A3&quot;) ... simply won&#39;t work.  Look up the usage of the Range object for more help."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556152105, "post_id": 55839629, "comment_id": 98343895, "body": "There is insufficient information in your post to reproduce your problem. Please read the HELP topics for <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>, and also <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>, and then edit your question to provide additional information, so we may better help you."}, {"owner": {"reputation": 3, "user_id": 11388488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2ed5eb5af18e3e66d8bbc6de519f1a?s=128&d=identicon&r=PG&f=1", "display_name": "Shanell", "link": "https://stackoverflow.com/users/11388488/shanell"}, "edited": false, "score": 0, "creation_date": 1556318853, "post_id": 55839629, "comment_id": 98411288, "body": "I have updated my post with most of my code. Since most of it is in a loop I couldn&#39;t really make it any smaller. I am thinking that it may be easier to implement a copy line within the loop, but I am now having issues with new selections overwriting values already on the new worksheet."}], "owner": {"reputation": 3, "user_id": 11388488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2ed5eb5af18e3e66d8bbc6de519f1a?s=128&d=identicon&r=PG&f=1", "display_name": "Shanell", "link": "https://stackoverflow.com/users/11388488/shanell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556219220, "creation_date": 1556146541, "last_edit_date": 1556219220, "question_id": 55839629, "link": "https://stackoverflow.com/questions/55839629/how-to-combine-multiple-dynamic-columns-into-a-single-column-on-a-new-sheet", "title": "How to combine multiple dynamic columns into a single column on a new sheet", "body": "<p>I am trying to combine multiple dynamic columns into a single column on a new sheet. I have written code that transfers choices made from multiple drop down menus in which the user can select multiple options into their own cell. I am trying to create a function that transfers these selections into a single column on a new sheet. If anyone could tell me how to transfer this changing range of rows within about 8 columns into a new sheet that would be great, or if it is easier to directly put the selections on the new sheet that would work as well.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim Oldvalue As String\nDim Newvalue As String\nApplication.EnableEvents = True\nOn Error GoTo Exitsub\nIf Target.Row = 11 Then\n  Dim rng As Range, cell As Range\n  Set rng = Range(\"A11:H11\")\n  For Each cell In rng\n    If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n        GoTo Exitsub\n    Else: If Target.Value = \"\" Then GoTo Exitsub Else\n     Application.EnableEvents = False\n     Newvalue = Target.Value\n     Application.Undo\n     Oldvalue = Target.Value\n       If Oldvalue = \"\" Then\n        Target.Value = Newvalue\n        Dim val As String\n        val = ActiveCell.Value\n        ActiveCell.Offset(0, 9).Value = val\n       Else\n        If InStr(1, Oldvalue, Newvalue) = 0 Then\n            Target.Value = Oldvalue &amp; \"; \" &amp; Newvalue\n            'below begins addition from Shanell\n            Dim txt As String\n            Dim i As Integer\n            Dim FullName As Variant\n\n            txt = ActiveCell.Value\n\n            FullName = Split(txt, \";\")\n\n            For i = 0 To UBound(FullName)\n                ActiveCell.Offset(i, 9).Value = FullName(i)\n            Next i\n      Else:\n        Target.Value = Oldvalue\n      End If\n    End If\n  End If\n  Next cell\nEnd If\nSet rng = ActiveCell.CurrentRegion\nlastCell = rng.Columns(1).Rows.Count + 1\n'Attempt to copy to new sheet'\nFor iCol = 11 To rng.Columns.Count\n    Range(Cells(11, iCol), Cells(rng.Columns(iCol).Rows.Count, iCol)).Cut\n    ActiveSheet.Paste Destination:=Worksheets(\"Links\").Range(\"lastCell,A3\")\n    lastCell = lastCell + rng.Columns(iCol).Rows.Count\n\nNext iCol\n\n</code></pre>\n\n<p>I have tried this code and there are no errors, but the values do not show up on the new sheet. I have added a comment where I attempt to copy the values to a new sheet. </p>\n\n<p>I also tried a line of code like this:</p>\n\n<pre><code>Range(\"J11\", Range(\"Q11\").End(xlDown)).Copy Worksheets(\"Links\").Range(\"A3:A\")\n</code></pre>\n\n<p>However, this did not work either. </p>\n"}, {"tags": ["excel", "vba", "loops", "for-loop"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11397601"}, "edited": false, "score": 3, "creation_date": 1556146873, "post_id": 55839569, "comment_id": 98343041, "body": "a) Your <code>&quot;1&#47;15&#47;&quot; &amp; n</code> style date constructions should be <code>DateSerial(n, 1, 15)</code> and <code>DateSerial(j, 1, 15)</code> in cells formatted as dates. b) It seems you have formulas in Inputs!E7, Inputs!E11 and Inputs!S8. You should have included those since your results are dependent on them."}, {"owner": {"reputation": 11, "user_id": 11407252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188dbaa48b2d6c8f54869f0ddbab83a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sirsleepsalot", "link": "https://stackoverflow.com/users/11407252/sirsleepsalot"}, "edited": false, "score": 0, "creation_date": 1556287021, "post_id": 55839569, "comment_id": 98398377, "body": "(1/2) Hi! Thank you for your comment and I apologize for not getting back to you earlier on this. a.) I updated the formula to use the DateSerial function. After applying this change there are still errors in the output. b.) The portion of the spreadsheet that I&#39;m using VBA on is small part of a much bigger file. Therefore, the formulas in Inputs!E7,11 and S8 are linking other parts of the spreadsheet so the formulas themselves are not useful unless you&#39;re looking at the spreadsheet as a whole."}, {"owner": {"reputation": 11, "user_id": 11407252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188dbaa48b2d6c8f54869f0ddbab83a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sirsleepsalot", "link": "https://stackoverflow.com/users/11407252/sirsleepsalot"}, "edited": false, "score": 0, "creation_date": 1556287271, "post_id": 55839569, "comment_id": 98398542, "body": "(2/2) I manually tested the errors by playing around with the year inputs that&#39;s giving me the wrong error. Inputs!E7, Inputs!E11 and Inputs!S8 all produced the right results during the manual test so I don&#39;t think the formula in those cells is what&#39;s producing the error. Just by looking at the logic of the code, can you spot any logic errors? Is it possible that Excel&#39;s VBA run &quot;too fast&quot; for the formulas to process the change and that&#39;s what&#39;s resulting in the wrong value?"}, {"owner": {"reputation": 11, "user_id": 11407252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188dbaa48b2d6c8f54869f0ddbab83a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sirsleepsalot", "link": "https://stackoverflow.com/users/11407252/sirsleepsalot"}, "edited": false, "score": 0, "creation_date": 1556289856, "post_id": 55839569, "comment_id": 98399936, "body": "To clarify: formula in Inputs!E7 calculates Person N&#39;s Age. Formula in Inputs!E11 calculates person J&#39;s Age. Formula in Inputs!S8 calculates a value based on the two person&#39;s age. I hope this adds clarity."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 14249147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/441642bc5882cdc46653e5db57ac429f?s=128&d=identicon&r=PG", "display_name": "Lucas Figueiredo", "link": "https://stackoverflow.com/users/14249147/lucas-figueiredo"}, "is_accepted": false, "score": 0, "last_activity_date": 1607031463, "creation_date": 1607031463, "answer_id": 65134547, "question_id": 55839569, "link": "https://stackoverflow.com/questions/55839569/excel-vba-nested-for-loop-outputs-replicated-wrong-results/65134547#65134547", "title": "Excel VBA nested for-loop outputs replicated/wrong results", "body": "<p>I think I had the exact same problem, your question was the only one I found that seemed like its answer could help me. Too bad there weren't any answers.</p>\n<p>I ended up fixing it, so hopefully this will help others:</p>\n<p>I have a Workbook that calculates product prices based on 4 variables (that are themselves divided among different sheets and other workbooks). Variable <code>a</code> has 25 possibilities, <code>b</code> has 52, <code>c</code> has 3, and <code>d</code> has 6. That gives me 22,464 different price possibilities. My code has 4 nested loops to print each possibility in a different row, so I can import the output to a different system.<br />\nThe problem I was running into was that, besides taking almost 30 minutes to run on a high end computer, I would randomly get rows with the wrong data.</p>\n<p>My (unconfirmed) diagnosis was that, because within the <code>For</code> loops there was a lot of calculation going on elsewhere in the sheet (actually, anywhere within Excel), sometimes VBA would continue iterating and would fill out the next row before the source had had a chance to update.<br />\nThat is why when I'd step debug the error wouldn't show up, and why it was intermittent and seemingly random even when running the code as a whole.</p>\n<p>I started by using <code>With</code> to streamline my code and avoid VBA going through the whole <code>Workbooks</code> and <code>Worksheets</code> arrays with each line of code. I also created <code>Excel.Workbook</code>, <code>Excel.Worksheet</code>, and <code>Excel.Range</code> variables for each of my many references.</p>\n<p>What ultimately seems to have fixed it, though, was adding <code>Application.Calculation = xlCalculationManual</code> to the beginning of the sub, and <code>Application.Calculate</code> to the appropriate point in the nested loops. I added a check for <code>Application.CalculationState</code> and then a <code>DoEvents</code>, but I'm not even sure how to test if that works.</p>\n<p>Here's the relevant part of the code:</p>\n<pre><code>Sub test()\n    '\n    ' (Variable declarations suppressed)\n    '\n    \n    Application.ScreenUpdating = False\n        \n    'Set to manual\n    Application.Calculation = xlCalculationManual\n        \n    For a = 0 To 22464\n        rngTabCusto.Value = wksCalculos.Cells(a / 936 + 23, 28).Value\n        For b = 0 To 918\n            rngFrete.Value = wksFrete.Cells(b / 18 + 4, 1).Value\n            For c = 0 To 12\n                rngTipoFat.Value = wksCalculos.Cells(c / 6 + 3, 3).Value\n\n                '\n                ' Calculate sheets after changing variables\n                '\n                Application.Calculate\n                \n                '\n                ' Waits until calculations are done\n                '\n                If Not Application.CalculationState = xlDone Then\n                    DoEvents\n                End If\n                \n                '\n                ' Prints calculation results\n                '\n                With wksDescontos\n                    For d = 0 To 5\n                        .Cells(a + b + c + d + 2, 1).Value = rngEstab.Value\n                        .Cells(a + b + c + d + 2, 2).Value = wksOrcamento.Cells(2, d + 2).Value\n                        .Cells(a + b + c + d + 2, 3).Value = rngContrib.Value\n                        .Cells(a + b + c + d + 2, 4).Value = wksRegiao.Cells(b / 18 + 2, 1).Value\n                        .Cells(a + b + c + d + 2, 5).Value = wksRegiao.Cells(b / 18 + 2, 2).Value\n                        .Cells(a + b + c + d + 2, 6).Value = wksOrcamento.Cells(4, d + 2).Value\n                        .Cells(a + b + c + d + 2, 7).Value = rngTabOrc.Value\n                        .Cells(a + b + c + d + 2, 8).Value = data\n                        .Cells(a + b + c + d + 2, 11).Value = rngFat.Value\n                    Next d\n                End With\n            c = c + 5\n            Next c\n        b = b + 17\n        Next b\n    a = a + 935\n    Next a\n    \n    'Reset\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11407252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/188dbaa48b2d6c8f54869f0ddbab83a0?s=128&d=identicon&r=PG&f=1", "display_name": "Sirsleepsalot", "link": "https://stackoverflow.com/users/11407252/sirsleepsalot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1607031463, "creation_date": 1556146180, "last_edit_date": 1556289940, "question_id": 55839569, "link": "https://stackoverflow.com/questions/55839569/excel-vba-nested-for-loop-outputs-replicated-wrong-results", "title": "Excel VBA nested for-loop outputs replicated/wrong results", "body": "<p>I have a nested for loop that iterates through the birthday years ( year 1919 to 2001) for two different people. </p>\n\n<p>The purpose is to find every age combination (based on the birth dates) for the two people.</p>\n\n<p>The issue I have is that the age of the person in the nested loop (the loop with variable j) seems to repeat sometimes and randomly with no pattern. </p>\n\n<p>For example, every combination when person N is ages 100-20 works fine with no repeated age value for person J. Then all the sudden, when person N is aged 19 person J would go from age 100-50 then would be aged 49 twice and then go to age 47.</p>\n\n<p>The following is my code:</p>\n\n<pre><code>Sub ChangeDOB()\nApplication.ScreenUpdating = False\nDim n As Long\nDim i As Long\nDim j As Long\ni = 2\n\nFor n = 1919 To 2001\n    Sheets(\"Inputs\").Range(\"E6\").FormulaR1C1 = \"1/15/\" &amp; n\n    'j = 1919\n\n    For j = 1919 To 2001\n        Sheets(\"FF Tool Rates\").Range(\"B\" &amp; i).Value = Sheets(\"Inputs\").Range(\"E7\").Value\n        Sheets(\"Inputs\").Range(\"E10\").FormulaR1C1 = \"1/15/\" &amp; j\n\n        Sheets(\"FF Tool Rates\").Range(\"C\" &amp; i).Value = Sheets(\"Inputs\").Range(\"E11\").Value\n        Sheets(\"FF Tool Rates\").Range(\"D\" &amp; i).Value = Sheets(\"Inputs\").Range(\"S8\").Value\n        i = i + 1\n    Next j\nNext n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The formula in Inputs!E7 calculates Person N's Age. Formula in Inputs!E11 calculates person J's Age. Formula in Inputs!S8 calculates a value based on the two person's age. I hope this adds clarity.</p>\n\n<p>The following is an example of the expected result:</p>\n\n<pre><code>Person N Age   Person J Age\n90             90\n90             89\n90             88\n90             87\n90             86\n90             85\n90             84\n90             83\n90             82\n90             81\n</code></pre>\n\n<p>The following is an example of an error result (see how age 85 appears twice):</p>\n\n<pre><code>Person N Age   Person J Age\n33             90\n33             89\n33             88\n33             87\n33             85 &lt;-should've been 86\n33             85 \n33             84\n33             83\n33             82\n33             81\n</code></pre>\n\n<p>Initially I thought it was the way I set up Excel that calculates the age based on birth dates. But if I manually inputted the year in the cells, Excel produces non-repeated results. So age 85 does not appear twice with manual input.</p>\n\n<p>There seems to be no pattern regarding when this error appears and if I re-run the code sometimes there will be no error and sometimes the error appears somewhere else. That is why it's been difficult for me to debug this. </p>\n\n<p>Any suggestions or advice on where I might have missed something or if I messed up any logic in my code?</p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556208088, "post_id": 55840382, "comment_id": 98368461, "body": "well the macro copy values from column (&quot;B&quot;, &quot;E&quot;, &quot;H&quot;, &quot;K&quot;, &quot;N&quot;). it varies because sometime all 5 columns will have data and sometime it will not, depends on the day. So some days only 2/5 or 3/5 columns will get filled. so those blank columns will have N/A when copy over \u2013 thanh1211 1 hour ago   @ ahmed au"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556210227, "post_id": 55840382, "comment_id": 98369477, "body": "@thanh1211 answer Added with Edit to skip the copying the whole column if it contains #N/A within."}, {"owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556215496, "post_id": 55840382, "comment_id": 98371810, "body": "thank you! it works!. I have one more question...what if I have data from &quot;wsCopy&quot; worksheet in  array (&quot;C&quot;, &quot;F&quot;, &quot;I&quot;, &quot;L&quot;, &quot;O&quot;). and I want to copy this data into column H in &quot;wsDest&quot; worksheet. how do i nest that into the code I have now?"}, {"owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556301450, "post_id": 55840382, "comment_id": 98405400, "body": "sorry im new to VBA , what If I want to add a code to the loop that basically does the same thing except this time copy data in one single cell instead of multiple rows in the &quot;wsCopy&quot;  and paste it down to the last row in the the &quot;wsDest&quot;  in column I this time."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556415362, "post_id": 55840382, "comment_id": 98430442, "body": "Could not quite understand your latest comment. is it regarding last edit (if solution in last edit worked as intended) ?"}, {"owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556547579, "post_id": 55840382, "comment_id": 98466122, "body": "apology should&#39;ve been clearer, but no its regarding a different code"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1556223344, "last_edit_date": 1556223344, "creation_date": 1556153540, "answer_id": 55840382, "question_id": 55839460, "link": "https://stackoverflow.com/questions/55839460/delete-cells-with-na-using-if-statement-in-vba-code/55840382#55840382", "title": "Delete cells with #NA using if statement in VBA code", "body": "<p>Though i could not understand the requirement clearly, i assumed #NA is to be deleted from destination only. I would prefer to do the deletion  after completion of copy paste task only.</p>\n\n<pre><code>Sub Copy_Paste_Below_Last_Cell()\n'Find the last used row in both sheets and copy and paste data below existing data.\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lCopyLastRow As Long\nDim lDestLastRow As Long\nDim CopyColumns() As Variant\nCopyColumns = Array(\"B\", \"E\", \"H\", \"K\", \"N\")\nDim Col As Variant\n\nDim FinalStartRow As Long\nDim FinalEndRow As Long\nDim Cel As Range\n\nSet wsCopy = ThisWorkbook.Worksheets(\"Ba pricing\")\nSet wsDest = ThisWorkbook.Worksheets(\"Loader\")\n\nFinalStartRow = wsDest.Cells(wsDest.Rows.Count, \"C\").End(xlUp).Offset(1).Row\nFinalEndRow = 0\n\n        For Each Col In CopyColumns\n          lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"C\").End(xlUp).Offset(1).Row\n          lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, Col).End(xlUp).Row\n          wsCopy.Range(Col &amp; \"30:\" &amp; Col &amp; lCopyLastRow).Copy\n          wsDest.Range(\"C\" &amp; lDestLastRow).PasteSpecial xlPasteValues\n          FinalEndRow = FinalEndRow + lCopyLastRow - 30 + 1\n         Next Col\n\n\n    For Each Cel In wsDest.Range(\"C\" &amp; FinalStartRow &amp; \":C\" &amp; FinalEndRow).Cells\n        If Application.WorksheetFunction.IsNA(Cel) Then\n        Cel.Delete xlShiftUp   ' if required to delete cell\n        'Cel.ClearContents     ' if required to delete contents only\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Edit: If You want to skip the copying the whole column if it contains #N/A then simply modify your code  Like this</p>\n\n<pre><code>For Each Col In CopyColumns\n  lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"C\").End(xlUp).Offset(1).Row\n  lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, Col).End(xlUp).Row\n    If wsCopy.Range(Col &amp; \"30:\" &amp; Col &amp; lCopyLastRow).Find(\"#N/A\", LookIn:=xlValues) Is Nothing Then\n    wsCopy.Range(Col &amp; \"30:\" &amp; Col &amp; lCopyLastRow).Copy\n    wsDest.Range(\"C\" &amp; lDestLastRow).PasteSpecial xlPasteValues\n    End If\n Next Col\n</code></pre>\n\n<p>Edit2: added to copy 2nd Set of columns into Column H</p>\n\n<pre><code>Dim CopyRng As Range, CopyRng2 As Range\n\n        For Each Col In CopyColumns\n          lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"C\").End(xlUp).Offset(1).Row\n          lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, Col).End(xlUp).Row\n          Set CopyRng = wsCopy.Range(Col &amp; \"30:\" &amp; Col &amp; lCopyLastRow)\n          'Since the 2nd set of columns specified is just at the right of columns specified in the 1st set\n          Set CopyRng2 = wsCopy.Range(CopyRng(1, 1).Offset(0, 1), CopyRng(CopyRng.Rows.Count, 1).Offset(0, 1))\n\n            If CopyRng.Find(\"#N/A\", LookIn:=xlValues) Is Nothing Then\n            CopyRng.Copy\n            wsDest.Range(\"C\" &amp; lDestLastRow).PasteSpecial xlPasteValues\n            CopyRng2.Copy\n            wsDest.Range(\"H\" &amp; lDestLastRow).PasteSpecial xlPasteValues\n            End If\n         Next Col\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556201243, "post_id": 55846210, "comment_id": 98364297, "body": "well the macro copy values from column (&quot;B&quot;, &quot;E&quot;, &quot;H&quot;, &quot;K&quot;, &quot;N&quot;). it varies because sometime all 5 columns will have data and sometime it will not, depends on the day. So some days only 2/5 or 3/5 columns will get filled. so those blank columns will have N/A when copy over"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11408315"}, "is_accepted": false, "score": 0, "last_activity_date": 1556185147, "creation_date": 1556185147, "answer_id": 55846210, "question_id": 55839460, "link": "https://stackoverflow.com/questions/55839460/delete-cells-with-na-using-if-statement-in-vba-code/55846210#55846210", "title": "Delete cells with #NA using if statement in VBA code", "body": "<p>If you are going to delete #N/A errors after copying the values from the formulas in a set of columns, why not simply skip copying the #N/A errors to begin with?</p>\n\n<pre><code>Sub valueOnlyCopy()\n\n    Dim a As Long\n    Dim copyColumns As Variant, col As Variant\n    Dim valRng As Range, wsCopy As Worksheet, wsDest As Worksheet\n\n    copyColumns = Array(\"B\", \"E\", \"H\", \"K\", \"N\")\n    Set wsCopy = ThisWorkbook.Worksheets(\"Ba pricing\")\n    Set wsDest = ThisWorkbook.Worksheets(\"Loader\")\n\n    For Each col In copyColumns\n\n        With wsCopy\n            With .Range(.Cells(30, col), .Cells(.Rows.Count, col).End(xlUp))\n                Set valRng = .SpecialCells(xlCellTypeFormulas, xlNumbers + xlTextValues + xlLogical)\n            End With\n        End With\n\n        With wsDest\n            For a = 1 To valRng.Areas.Count\n                .Cells(.Rows.Count, \"C\").End(xlUp).Offset(1).Resize(valRng.Areas(a).Rows.Count, 1) = _\n                  valRng.Areas(a).Value\n            Next a\n        End With\n\n    Next col\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55840382, "answer_count": 2, "score": 0, "last_activity_date": 1556223344, "creation_date": 1556145259, "last_edit_date": 1556172507, "question_id": 55839460, "link": "https://stackoverflow.com/questions/55839460/delete-cells-with-na-using-if-statement-in-vba-code", "title": "Delete cells with #NA using if statement in VBA code", "body": "<p>I want to delete #NA within this code, I know you suppose to a if statement but I don't know where and how i should write it within my code</p>\n\n<pre><code>Sub Copy_Paste_Below_Last_Cell()\n'Find the last used row in both sheets and copy and paste data below existing data.\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lCopyLastRow As Long\nDim lDestLastRow As Long\nDim CopyColumns() As Variant\nCopyColumns = Array(\"B\", \"E\", \"H\", \"K\", \"N\")\nDim Col As Variant\n\n\n  Set wsCopy = ThisWorkbook.Worksheets(\"Ba pricing\")\n  Set wsDest = ThisWorkbook.Worksheets(\"Loader\")\n\n        For Each Col In CopyColumns\n\n          lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"C\").End(xlUp).Offset(1).Row\n\n          lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, Col).End(xlUp).Row\n\n          wsCopy.Range(Col &amp; \"30:\" &amp; Col &amp; lCopyLastRow).Copy\n          wsDest.Range(\"C\" &amp; lDestLastRow).PasteSpecial xlPasteValues\n\n\n\n         Next Col\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1556173103, "post_id": 55839281, "comment_id": 98348365, "body": "I don&#39;t understand what a &quot;print job for a given cell&quot; is. Do you want to print one cell?"}, {"owner": {"reputation": 11, "user_id": 11407726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gvbwm5S-dd0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8jYmV3KlhBKPmZnWVpBPhIiS7xg/mo/photo.jpg?sz=128", "display_name": "Josh Cayton", "link": "https://stackoverflow.com/users/11407726/josh-cayton"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1556219463, "post_id": 55839281, "comment_id": 98373667, "body": "Yes, that is correct; after the formula is applied and the result populates the cell, I want just that cell to print on a 2&quot; x 1/2&quot; label.  The user will then proceed to the next line, enter the wifi test values, formula is applied, another cell printed, ect,ect. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "is_accepted": false, "score": 0, "last_activity_date": 1556266080, "last_edit_date": 1556266080, "creation_date": 1556247535, "answer_id": 55860219, "question_id": 55839281, "link": "https://stackoverflow.com/questions/55839281/how-to-create-macro-to-conditionally-print-single-cell-contents-row-by-row/55860219#55860219", "title": "How to create Macro to conditionally print single cell contents row-by-row", "body": "<p>You can put your printing code in the change event of the worksheet (Worksheet_Change):</p>\n\n<p><a href=\"https://i.stack.imgur.com/MxPD1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MxPD1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Remember to set the printing area to the cell you want to print.\nRemember that the Target parameter is the cell that was changed.</p>\n\n<p>See example below. You will have to set the PrintArea to the correct cell. Here I'm using the changed cell address which, if I understood correctly, is not the cell you want to print.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.DisplayAlerts = False\n    Application.EnableEvents = False\n\n    Target.Value = Target.Address\n\n    Me.PageSetup.PrintArea = Target.Address\n    Me.PrintOut Copies:=1, Collate:=True, IgnorePrintAreas:=False\n\n   Application.EnableEvents = True\n   Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11407726, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Gvbwm5S-dd0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd8jYmV3KlhBKPmZnWVpBPhIiS7xg/mo/photo.jpg?sz=128", "display_name": "Josh Cayton", "link": "https://stackoverflow.com/users/11407726/josh-cayton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556266080, "creation_date": 1556144022, "last_edit_date": 1556172220, "question_id": 55839281, "link": "https://stackoverflow.com/questions/55839281/how-to-create-macro-to-conditionally-print-single-cell-contents-row-by-row", "title": "How to create Macro to conditionally print single cell contents row-by-row", "body": "<p>Performing wifi antennae testing in manufacturing facility where values are recorded in a row for each part; I need to create an Excel Macro to print the cell contents to label based on true/false condition.  </p>\n\n<p>I've recording Macro just for printing step but unsure how to trigger the print job for a given cell in each row after data is entered. </p>\n\n<p>I created one cell where if ALL the recorded values for each test are within tolerance, a resulting \"PASS\" or \"FAIL\" is entered.  What I want actually printed is an abbreviation of the serial number, so this formula is the basis of what SHOULD print after each part's values are recorded: \n=IF(K26=\"PASS\", RIGHT(A26, 53), \"FAIL\"), which outputs C26-1-09-00194-12-0e.01.12.0c.0b-02.02.03.00.84.94.86, for instance.  </p>\n\n<p>for each row, based on result of PASS or FAIL, I need a label to print the serial number.  Basically just need to know how to trigger Macro for each row and the code for printing.</p>\n"}, {"tags": ["excel", "vba", "global-variables", "excel-2019"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1556143892, "post_id": 55839176, "comment_id": 98342327, "body": "Are your global constants located in a normal module (not a code, userform, worksheet, or workbook module)? Are you using <code>Option Private Module</code> then attempting to use these constants in a different module? Are these located in the declaration area at the very top of the module, just under <code>Option Explicit</code>?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1556144027, "post_id": 55839176, "comment_id": 98342370, "body": "To build on the above, I have a feeling that you are not placing in the declarations area of the module, because you can&#39;t use a function to set a value to a constant. <code>CStr()</code> and <code>ChrW()</code> are both functions."}, {"owner": {"reputation": 17786, "user_id": 120888, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1bc4ef3a499a15e9d6b5a27b02ddeb46?s=128&d=identicon&r=PG", "display_name": "Giffyguy", "link": "https://stackoverflow.com/users/120888/giffyguy"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1556144109, "post_id": 55839176, "comment_id": 98342385, "body": "@K.D\u1d00\u1d20\u026as <code>... located in a normal module?</code> Yes. <code>... using Option Private Module?</code> I don&#39;t know what that is. I haven&#39;t used it that I know of, but maybe I can if needed? <code>... attempting to use these constants in a different module</code> No, just using them in the same module. <code>... located at the very top</code> No, there are some other type declarations and a couple other functions above these. <code>... can&#39;t use a function to set a value to a constant.</code> OHH, yeah, that&#39;s probably a red flag. I guess that means I&#39;ll have to let them be &quot;variables&quot; then, and just be careful to never overwrite them?"}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556144954, "post_id": 55839176, "comment_id": 98342581, "body": "Since they are declared as <code>Const</code>, you can&#39;t overwrite them"}], "answers": [{"comments": [{"owner": {"reputation": 17786, "user_id": 120888, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1bc4ef3a499a15e9d6b5a27b02ddeb46?s=128&d=identicon&r=PG", "display_name": "Giffyguy", "link": "https://stackoverflow.com/users/120888/giffyguy"}, "edited": false, "score": 1, "creation_date": 1556151423, "post_id": 55839435, "comment_id": 98343783, "body": "I followed your advice, and it&#39;s all working great now! Statics won&#39;t work in my case, because there are multiple functions that need to use these string values (and I&#39;m not using classes, sticking with procedural programming). So I used your final alternative, and declared non-const private global variables, and wrote a sub to initialize them, then invoked the init sub at the beginning of every function that needs access to the globals. I added a global boolean variable called <code>GlobalsInitialized</code> so my initialization sub will skip the assignments if invoked multiple times."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 5, "last_activity_date": 1556145121, "creation_date": 1556145121, "answer_id": 55839435, "question_id": 55839176, "link": "https://stackoverflow.com/questions/55839176/vba-global-constant-strings/55839435#55839435", "title": "VBA: Global Constant Strings", "body": "<p>Unfortunately, you cannot use functions to set values to constants. The purpose of a <code>Const</code> is that the value of the constant is set <em>prior to runtime</em>, and functions can only return values during runtime.</p>\n\n<p>Your issue appears that your constants weren't declared in the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/how-to/enter-a-declaration-in-code\" rel=\"noreferrer\">declarations section</a> of the module, which is why you do not get a compile error when running any code.</p>\n\n<p>There are some alternatives, however.</p>\n\n<p>You can create a function for each of your variables:</p>\n\n<pre><code>Function STRPOWER0() As String\n    STRPOWER0 = CStr(ChrW(&amp;H2070))\nEnd Function\n\nSub Main()\n    Msgbox STRPOWER0\nEnd Sub\n</code></pre>\n\n<p>You made a point that you were concerned running the <code>CStr()</code> and <code>ChrW()</code> functions every time you called <code>STRPOWER0</code>. While you would likely only take a very minimal performance hit - even when calling many times - you can use <code>Static</code> variables to only do the conversions on the first time during runtime.</p>\n\n<pre><code>Function STRPOWER0() As String\n    Static RetVal As String\n    If RetVal = \"\" Then RetVal = CStr(ChrW(&amp;H2070))\n    STRPOWER0 = RetVal\nEnd Function\n\nSub Main()\n    Msgbox STRPOWER0\nEnd Sub\n</code></pre>\n\n<p>Static allows the variable <code>RetVal</code> to keep it's data, even when the function falls out of scope, for the entire duration of the runtime.</p>\n\n<hr>\n\n<p>Another alternative is to use a sub to set all your variables at the beginning of runtime:</p>\n\n<pre><code>'This line in declarations section of module\nPublic STRPOWER0$, STRPOWER1$, STRPOWER2$ ', etc\n\nPrivate Sub SetPubVars\n\n    STRPOWER0 = CStr(ChrW(&amp;H2070))\n    STRPOWER1 = CStr(ChrW(&amp;HB9))\n    STRPOWER2 = CStr(ChrW(&amp;HB2))\n\n    ' So on\n\nEnd Sub\n\nSub MAIN()\n\n    ' Set the values\n    SetPubVars\n\n    MsgBox STRPOWER0\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17786, "user_id": 120888, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1bc4ef3a499a15e9d6b5a27b02ddeb46?s=128&d=identicon&r=PG", "display_name": "Giffyguy", "link": "https://stackoverflow.com/users/120888/giffyguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6790, "favorite_count": 1, "closed_date": 1556145374, "accepted_answer_id": 55839435, "answer_count": 1, "score": 3, "last_activity_date": 1556172166, "creation_date": 1556143229, "last_edit_date": 1556172166, "question_id": 55839176, "link": "https://stackoverflow.com/questions/55839176/vba-global-constant-strings", "closed_reason": "Duplicate", "title": "VBA: Global Constant Strings", "body": "<p>I'm working with special characters for mathematics in Excel.<br>\n(Exponents\u2074, GR\u03a3\u03a3K, and other misc Unicode characters.)</p>\n\n<p>I'd like to store commonly-used Unicode strings as global constants, since that would probably be significantly faster (and less bug-prone) than calling <code>CStr()</code> each time I need one.</p>\n\n<p>For example, I have these declarations outside all functions:</p>\n\n<pre><code>Public Const STRPOWER0        As String = CStr(ChrW(&amp;H2070)) '0th power\nPublic Const STRPOWER1        As String = \"\u00b9\" 'CStr(ChrW(&amp;HB9)) 1st power\nPublic Const STRPOWER2        As String = \"\u00b2\" 'CStr(ChrW(&amp;HB2)) 2nd power\nPublic Const STRPOWER3        As String = \"\u00b3\" 'CStr(ChrW(&amp;HB3)) 3rd power\nPublic Const STRPOWER4        As String = CStr(ChrW(&amp;H2074)) '4th power\nPublic Const STRPOWER5        As String = CStr(ChrW(&amp;H2075)) '5th power\nPublic Const STRPOWER6        As String = CStr(ChrW(&amp;H2076)) '6th power\nPublic Const STRPOWER7        As String = CStr(ChrW(&amp;H2077)) '7th power\nPublic Const STRPOWER8        As String = CStr(ChrW(&amp;H2078)) '8th power\nPublic Const STRPOWER9        As String = CStr(ChrW(&amp;H2079)) '9th power\nPublic Const STRPOWERNEGATIVE As String = CStr(ChrW(&amp;H207B)) 'Superscript negative sign\n</code></pre>\n\n<p>The problem is, whenever I try to reference one of these strings, the value is <code>Empty</code><br>\n(If I turn on <code>Option Explicit</code> I get an error for <code>Variable not defined</code>)</p>\n\n<p>What am I doing wrong?<br>\nDoes VBA not support global constants as strings?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1556143086, "post_id": 55839130, "comment_id": 98342083, "body": "Get rid of all the <code>.Select</code> and <code>.Activate</code> see here how to do that: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1556143192, "post_id": 55839130, "comment_id": 98342120, "body": "<code>Worksheets(&quot;Database&quot;).Cells(Rows.Count, 1).End(xlUp).Offset(1).Value = Worksheets(&quot;Survey Form&quot;).Range(&quot;C9&quot;).Value</code> Is all you need. and it will not flicker."}, {"owner": {"reputation": 1, "user_id": 11407706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f7a8d7481d222d7afe68d67f4d1c96?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Stone", "link": "https://stackoverflow.com/users/11407706/mark-stone"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556146069, "post_id": 55839130, "comment_id": 98342851, "body": "@ScottCraner, Thank you so much for your help it solved my issue"}], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1556185488, "creation_date": 1556185488, "answer_id": 55846314, "question_id": 55839130, "link": "https://stackoverflow.com/questions/55839130/worksheet-flickers/55846314#55846314", "title": "Worksheet flickers", "body": "<p>In addition to what was suggested in the comments, you should also try this:</p>\n\n<pre><code>Sub something()\n\nApplication.ScreenUpdating = False\n'\n'\n'the rest of your code here\n'\n'\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>This should actually make your code run both smoother and faster.</p>\n"}], "owner": {"reputation": 1, "user_id": 11407706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0f7a8d7481d222d7afe68d67f4d1c96?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Stone", "link": "https://stackoverflow.com/users/11407706/mark-stone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556185488, "creation_date": 1556142972, "last_edit_date": 1556172136, "question_id": 55839130, "link": "https://stackoverflow.com/questions/55839130/worksheet-flickers", "title": "Worksheet flickers", "body": "<p>I'm new with VBA, so I'm trying to create a macro button that can copy paste data from one worksheet to another but I think my code is flawed because the worksheet flickers whenever I run the code</p>\n\n<p>tried a simple code since I'm new with VBA </p>\n\n<pre><code>Worksheets(\"Survey Form\").Range(\"C9\").Copy\nWorksheets(\"Database\").Activate\nCells(Rows.Count, 1).End(xlUp).Select\nActiveCell.Offset(1).Select\nActiveCell.PasteSpecial xlPasteValues\nWorksheets(\"Survey Form\").Activate\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>I want the code to run smoothly without that flicker</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556142559, "post_id": 55839011, "comment_id": 98341926, "body": "you have a <code>$</code> where you should have <code>&amp;</code> but you should also have spaces on either side of the <code>&amp;</code>"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1556142616, "post_id": 55839011, "comment_id": 98341938, "body": "Not your problem but <code>LR</code> should be <code>Dim</code>ed as <code>Long</code>: there are more rows in Excel than <code>Integer</code>&#39;s limit. Do you really have all those spaces in the sheet name?  Do you have curly quotes in your code? All that said, you have a typo:  <code>\u201d$LR&amp;\u201d</code> should be <code>&quot; &amp; LR &amp; &quot;</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556142853, "post_id": 55839011, "comment_id": 98342020, "body": "You are also missing a closing <code>&quot;</code>"}, {"owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "edited": false, "score": 0, "creation_date": 1556142876, "post_id": 55839011, "comment_id": 98342029, "body": "Now it is giving me an error on the line beginning with LR. When I click to debug, it highlights the whole line. How do I fix this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556145522, "post_id": 55839011, "comment_id": 98342726, "body": "&quot;Now it is giving me an error&quot; - if you changed something in your code you can update your question to add it, along with a description of any error you&#39;re getting..."}], "owner": {"reputation": 79, "user_id": 11385750, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rn_1Ha_ZydE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re_k5YfmZaWr7QgmmbK4SRwaqw15A/mo/photo.jpg?sz=128", "display_name": "Djhans26 ", "link": "https://stackoverflow.com/users/11385750/djhans26"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556172001, "creation_date": 1556142381, "last_edit_date": 1556172001, "question_id": 55839011, "link": "https://stackoverflow.com/questions/55839011/i-need-help-using-a-vlookup-in-vba", "title": "I need help using a Vlookup in vba", "body": "<pre><code>Sub vlookup()\n\nDim LR as Integer\nLR = Range(\u201cA\u201d &amp; Row.Count).End(xlUp).Row\nRange(\u201cD2\u201d).Formula=\u201c=Vlookup(A2,\u2019[yGL dcs.xlsx]GL       ENTERED INV raw data\u2019!C$4:C$\u201d$LR&amp;\u201d,1,false)\nRange(\u201cD2\u201d).Copy\nRange(\u201cD2:D\u201d &amp; LR).PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\n\nEnd sub\n</code></pre>\n\n<p>I need to perform a vlookup in column D in workbook1 and compare it to column C in workbook2. My code gives me an error stating \u201cend of statement on the vlookup line. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1556171975, "post_id": 55838810, "comment_id": 98347962, "body": "Welcome to Stack Overflow. Please note that because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question. \u2022 Start with the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.open\" rel=\"nofollow noreferrer\">Workbook.Open event</a> and work out something on your own first. If you get stuck or errors come back and show your code."}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 11041807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d83c2ccba076256fb7c599c30835ac85?s=128&d=identicon&r=PG&f=1", "display_name": "P. Dev", "link": "https://stackoverflow.com/users/11041807/p-dev"}, "is_accepted": false, "score": 0, "last_activity_date": 1556172599, "creation_date": 1556172599, "answer_id": 55842832, "question_id": 55838810, "link": "https://stackoverflow.com/questions/55838810/private-sub-cell-value/55842832#55842832", "title": "Private Sub cell value", "body": "<p>The code for what you asked for it goes like this</p>\n\n<pre><code>Sub Auto_Open()\n\nSheet1.Cells(10, 4) = \"James\"\n\nEnd Sub\n</code></pre>\n\n<p>using this format for specify the cell \"Sheet1.Cells(row, column)\".\ni recommend you to visit the next website for more information <a href=\"https://www.excel-easy.com/vba.html\" rel=\"nofollow noreferrer\">https://www.excel-easy.com/vba.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11407645, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-N-ryxeyy5RA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf2o5rs3V0Xn8soJorpjto2njUqWg/mo/photo.jpg?sz=128", "display_name": "Mohammed Tanzeer", "link": "https://stackoverflow.com/users/11407645/mohammed-tanzeer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1556172599, "creation_date": 1556141237, "last_edit_date": 1556171867, "question_id": 55838810, "link": "https://stackoverflow.com/questions/55838810/private-sub-cell-value", "title": "Private Sub cell value", "body": "<p>I am new to VBA and trying to work something out. So, I want cell (Ex: D10) on the Sheet1 to auto fill a string (Ex: James) every time I open the workbook. Can anyone help with the code please?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 3, "creation_date": 1556141181, "post_id": 55838771, "comment_id": 98341489, "body": "<code>=IF(A2=A1,C1&amp;&quot;,&quot;,&quot;&quot;)&amp;TEXT(B2,&quot;00000000&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11385436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f66e264a649267011b27f6dd60c01b?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/11385436/rodrigo"}, "is_accepted": false, "score": 0, "last_activity_date": 1556247224, "last_edit_date": 1556247224, "creation_date": 1556166345, "answer_id": 55841779, "question_id": 55838771, "link": "https://stackoverflow.com/questions/55838771/excel-how-to-add-leading-zero-to-string-of-numbers-separated-by-comma-if-the-n/55841779#55841779", "title": "Excel: How to add leading zero to string of numbers separated by comma, if the number is less than 8 digits?", "body": "<p>You could just change the cell formatting to a custom 00000000 if it's a visual thing.</p>\n"}, {"tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": false, "score": 0, "last_activity_date": 1556193014, "creation_date": 1556193014, "answer_id": 55848655, "question_id": 55838771, "link": "https://stackoverflow.com/questions/55838771/excel-how-to-add-leading-zero-to-string-of-numbers-separated-by-comma-if-the-n/55848655#55848655", "title": "Excel: How to add leading zero to string of numbers separated by comma, if the number is less than 8 digits?", "body": "<p>Similar to tigeravatar's comment which will return a string instead of a number but will have the lead zero:</p>\n\n<pre><code>=RIGHT(\"00000000\"&amp;B2,8)\n\nor\n\n=RIGHT(\"00000000\"&amp;MAX(len(B2),8))\n</code></pre>\n\n<p>Basically it adds 8 zeros to the front then takes the last 8 characters.  Or in the case of the second formula it will take a minimum of 8 characters and a maximum of the length of what is already in the cell.  If you know you only have a minimum of 7 characters, then you could just add 1 zero.</p>\n\n<p>Alternatively you could add the zeros using a REPT function:</p>\n\n<pre><code>=REPT(\"0\",MAX(8-LEN(B2),0))&amp;B2\n</code></pre>\n\n<p>The max is in there in case you have a number longer which would wind up with a negative value for REPT.  In that case, MAX would return 0 instead avoiding the error with REPT.  The result of this formula is also a string.</p>\n\n<p>If you want to see a leading zero, but keep the cell value as a number, then you would need to apply custom formatting to the cell.  Just remember though the zero is not really there if you go that route, the cell is just displaying things as 8 digits long.</p>\n"}], "owner": {"reputation": 25, "user_id": 11347883, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lJzzq8_AylY/AAAAAAAAAAI/AAAAAAAAABI/yLUMcC4yrRg/photo.jpg?sz=128", "display_name": "ianmko", "link": "https://stackoverflow.com/users/11347883/ianmko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556247224, "creation_date": 1556141062, "question_id": 55838771, "link": "https://stackoverflow.com/questions/55838771/excel-how-to-add-leading-zero-to-string-of-numbers-separated-by-comma-if-the-n", "title": "Excel: How to add leading zero to string of numbers separated by comma, if the number is less than 8 digits?", "body": "<p>I used <code>=IF(A2=A1,C1&amp;\",\"&amp;B2,B2)</code> to concatenate a string of associated SKUs across multiple rows into one cell. The problem is some of the SKUs start with 0, and this got removed with the formula. (Also, some of the rows are showing up as error cells with the red text and fill. The error message says they are a number being stored as text. But it's not like that with every one, and I don't know why.)</p>\n\n<p>All the SKUs have 8 digits, so the incorrect ones will have 7 digits. For example:</p>\n\n<p>Looks like: 4286000,4286800,4310001,4310801,14872001,14872801,14877001,14877801</p>\n\n<p>Should be: 04286000,04286800,04310001,04310801,14872001,14872801,14877001,14877801</p>\n\n<p>I tried the <code>=TEXT</code> function, and got a funny (wrong) result. For example, in a string where all six SKUs need a leading zero, I added 48 zeros in the format_text section of the function, with commas after every 8 zeros. It put the commas in every three digits, basically outputting as a large single number.</p>\n\n<p>Is this something that can be solved with formulas, or does it require VBA?</p>\n"}, {"tags": ["excel", "vba", "do-while"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556138252, "post_id": 55837984, "comment_id": 98340411, "body": "<code>eventTime</code> being a <code>Range</code>, <code>eventTime = whatever</code> is implicitly doing <code>eventTime.Value = whatever</code>, i.e. &quot;it changes the eventTime&quot; (writes to <code>C2</code>). Do you mean to <code>Set eventTime = eventTime.Offset(1)</code> or similar?"}, {"owner": {"reputation": 1, "user_id": 11407362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51be260598db4a4af00bd0b8e762ffda?s=128&d=identicon&r=PG&f=1", "display_name": "dingwalr", "link": "https://stackoverflow.com/users/11407362/dingwalr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556138853, "post_id": 55837984, "comment_id": 98340640, "body": "Ya I have seen that it is changing the event time in C2. My intent though is for it to read the event time in C2 (12:00 AM), then after populating the associated row with 0&#39;s, I want it to move to the next event time (1:00 AM) and populate that row with 0&#39;s. And continue this until the Event Time is equal to the Start Time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556139393, "post_id": 55837984, "comment_id": 98340852, "body": "Yes, that&#39;s quite literally what <code>Set eventTime = eventTime.Offset(1)</code> would do: instead of writing to the <code>eventTime</code> range (<code>C2</code>), you&#39;d be setting it to the cell underneath it, at each iteration."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556139663, "post_id": 55837984, "comment_id": 98340961, "body": "Note that the loop expressions probably need to be adjusted too; I&#39;d think the <code>Do While {expression}</code> expression gets re-evaluated every time, so that might be setting you up for an infinite loop (or a rather indirect bail-out when <code>startTime</code> is &quot;greater than&quot; what gets evaluated as a <code>Variant&#47;Empty</code> at the first empty row). Consider a more straightforward approach instead, like a <code>For</code> loop that runs from <code>2</code> to the last row in that sheet."}, {"owner": {"reputation": 1, "user_id": 11407362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51be260598db4a4af00bd0b8e762ffda?s=128&d=identicon&r=PG&f=1", "display_name": "dingwalr", "link": "https://stackoverflow.com/users/11407362/dingwalr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556139770, "post_id": 55837984, "comment_id": 98340995, "body": "Wow, that Is an exceptionally easy solution. I just got lost in my own head. Thank you for setting me straight."}], "owner": {"reputation": 1, "user_id": 11407362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51be260598db4a4af00bd0b8e762ffda?s=128&d=identicon&r=PG&f=1", "display_name": "dingwalr", "link": "https://stackoverflow.com/users/11407362/dingwalr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556137317, "creation_date": 1556137317, "question_id": 55837984, "link": "https://stackoverflow.com/questions/55837984/looping-through-a-variable-range", "title": "Looping through a variable range", "body": "<p>I'm quite new to writing Excel VBA scripts, but I am trying to create a script that truncates attendance for an event based on its start and end time. Right now I have a sheet that shows the attendance for an event split among all rooms involved, but the attendance is shown to be for 24 hours of the day. So I am creating a Do While loop that will set attendance to zero for times that are outside of the start and end times, and populate a table with the attendance numbers while within that event time.</p>\n\n<p>The issue is that I am having trouble moving through a range of event times. This is the Table I am trying to populate for reference.</p>\n\n<pre><code>Date    Useage  Event Time  Meeting Room 1  Meeting Room 2  Meeting Room 3\n01-01-18    3   12:00 AM                                        \n01-01-18    3   01:00 AM                                        \n01-01-18    3   02:00 AM                                        \n01-01-18    3   03:00 AM                                        \n01-01-18    3   04:00 AM                                        \n01-01-18    3   05:00 AM                                        \n01-01-18    3   06:00 AM                                        \n01-01-18    3   07:00 AM                                        \n01-01-18    3   08:00 AM                                        \n01-01-18    3   09:00 AM                                        \n01-01-18    3   10:00 AM                                        \n01-01-18    3   11:00 AM                                        \n01-01-18    3   12:00 PM                                        \n01-01-18    3   01:00 PM                                        \n01-01-18    3   02:00 PM                                        \n01-01-18    3   03:00 PM                                        \n01-01-18    3   04:00 PM                                        \n01-01-18    3   05:00 PM                                        \n01-01-18    3   06:00 PM                                        \n01-01-18    3   07:00 PM                                        \n01-01-18    3   08:00 PM                                        \n01-01-18    3   09:00 PM                                        \n01-01-18    3   10:00 PM                                        \n01-01-18    3   11:00 PM                                        \n01-02-18    3   12:00 AM                                        \n01-02-18    3   01:00 AM                                        \n</code></pre>\n\n<pre><code>Dim x As Double\nDim y As Double\n\nDim startTime As Double\nDim eventTime As Range\n\nx = 0\ny = 0\n\nstartTime = ActiveWorkbook.Sheets(\"Attendance\").Range(\"H3\")\nSet eventTime = ActiveWorkbook.Sheets(\"Time Occupancy Analysis\").Range(\"C2\")\n\n            Do While (startTime &gt;= eventTime) And y &lt;= 24\n                Do While (startTime &gt;= eventTime) And x &lt;= 36\n                    eventTime.Offset(0, x + 1) = 0\n                    x = x + 1\n                    Loop\n                x = 0\n                Sheets(\"Time Occupancy Analysis\").Range(\"D2\").Offset(y + 1, 0) = 0\n                y = y + 1\n                eventTime = eventTime + 0.04167 'This is where the problem exists'\n                Loop\n</code></pre>\n\n<p>I am hoping for the code to output 0's for attendance until the startTime for the event is equal to the eventTime. When it is run, it changes the eventTime instead of moving through the range of event times (12:00 AM, 1:00 AM, 2:00 AM, etc.)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1556137795, "post_id": 55837954, "comment_id": 98340177, "body": "In your example, should site_curr_position be Range(&quot;A4&quot;)?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1556137849, "post_id": 55837954, "comment_id": 98340209, "body": "In general, you should always try to avoid using <code>.Activate</code> and <code>.Select</code>.  Relying on those is largely considered bad practice.  See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?rq=1\">here</a> for why.  To answer your question however, it would simply be <code>Set site_curr_position = Selection</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556139936, "post_id": 55837954, "comment_id": 98341078, "body": "<code>ActiveCell</code> gets you the cell that&#39;s currently active... but please read the link @tigeravatar posted. FWIW the second assignment is voiding the first."}], "owner": {"reputation": 2206, "user_id": 1175788, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/ed6991f13be59c3996322a3afd84708e?s=128&d=identicon&r=PG", "display_name": "simplycoding", "link": "https://stackoverflow.com/users/1175788/simplycoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556139878, "creation_date": 1556137180, "last_edit_date": 1556139878, "question_id": 55837954, "link": "https://stackoverflow.com/questions/55837954/how-do-i-assign-the-current-cells-address-to-a-range-variable", "title": "How do I assign the current cell&#39;s address to a Range variable?", "body": "<p>I'm confused on how to update a Range variable with the current cell. Say I have the following:</p>\n\n<pre><code>Dim site_curr_position As Range\nSet site_curr_position = Worksheets(\"newsheet\").Range(\"D14\")\nSet site_curr_position = Worksheets(\"newsheet\").Range(\"E14\")\nWorksheets(\"newsheet\").Range(\"A4\").Select\n'Set site_curr_position = ?\n</code></pre>\n\n<p>How do I get the range of that cell where the cursor is now placed?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556134644, "post_id": 55837331, "comment_id": 98338879, "body": "<code>rFound.EntireRow.Interior.Color</code>"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556134761, "post_id": 55837331, "comment_id": 98338918, "body": "how would I implement the scrolling to that active row where the value on sheet2 matched the msg box value?"}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1556135078, "post_id": 55837331, "comment_id": 98339047, "body": "<code>rFound.Select</code> will select it, jumping to that position in the Excel doc"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1556134908, "creation_date": 1556134908, "answer_id": 55837448, "question_id": 55837331, "link": "https://stackoverflow.com/questions/55837331/how-to-highlight-whole-row-and-scroll-to-it-if-matched-value/55837448#55837448", "title": "how to highlight whole row and scroll to it if matched value?", "body": "<p>Something like this:</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Sheet2\").Columns(\"C\")\n    Set rFound = .Find(lemployee, .Cells(.Cells.Count), xlValues, xlWhole)\n    If Not rFound Is Nothing Then\n        rFound.EntireRow.Interior.Color = VBA.RGB(255, 255, 0)\n        Application.Goto rFound\n    End If\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 1, "accepted_answer_id": 55837448, "answer_count": 1, "score": 0, "last_activity_date": 1556135802, "creation_date": 1556134478, "last_edit_date": 1556135802, "question_id": 55837331, "link": "https://stackoverflow.com/questions/55837331/how-to-highlight-whole-row-and-scroll-to-it-if-matched-value", "title": "how to highlight whole row and scroll to it if matched value?", "body": "<p>I have sheet 1 with range of names. I have a msg box input where I can just click the cell referencing the value. If it matches, it finds where that value lies in column C of sheet 2. It works how I want it to, but I need to figure out how to highlight the <em>whole</em> row. Also, is there a scroll to indexing I can do to make sure it moves down sheet 2 to where that row was highlighted?</p>\n\n<p>Code:</p>\n\n<pre><code>Sub tgr()\nDim rFound As Range\nDim lemployee As String\nDim sh As Worksheet\nDim rw As Long\nDim matched As Boolean\n\nlemployee = Application.InputBox(\"Please selct an employee\", \"Employee Name\", Type:=2)\n\nIf lemployee = \"False\" Then Exit Sub\nSet sh = Sheets(\"Sheet1\")\nrw = 2\n\nWith ThisWorkbook.Worksheets(\"Sheet2\").Columns(\"C\")\n    Set rFound = .Find(lemployee, .Cells(.Cells.Count), xlValues, xlWhole)\n            If ThisWorkbook.Worksheets(\"Sheet2\").Cells(rFound.Row, 3).Value = lemployee Then\n                .Cells(rFound.Row).Interior.Color = VBA.RGB(255, 255, 0)\n            End If\n\n\n\n\nEnd With\n\n\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: As for the scroll, I would just need something like: </p>\n\n<pre><code>Application. Goto ActiveCell.EntireRow,True\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1556134099, "post_id": 55837179, "comment_id": 98338664, "body": "Have you verified that the cells are not empty (no spaces) and that the exact string is &quot;Result&quot; not <code>Like &quot;Result&quot;</code>?"}, {"owner": {"reputation": 3, "user_id": 9806167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4039ba4d156845e244ffa2d614093337?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/9806167/john-d"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556134276, "post_id": 55837179, "comment_id": 98338737, "body": "Hi Cyril, yes have checked that the cells are totally empty.   Even used formula in excel frontend to check isblank = true.  Thanks"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556134882, "post_id": 55837179, "comment_id": 98338960, "body": "Instead of involving the clipboard, you can do <code>Range(Cells(planPt, calCol), Cells(planPt, LC)).Value = Range(Cells(refPt, calCol), Cells(refPt, LC)).Value</code>. Note that unless this code is written in some worksheet module&#39;s code-behind, it&#39;s implicitly referring to the <code>ActiveSheet</code>. Unqualified <code>Cells</code> and <code>Range</code> calls should be preceded by a <code>Worksheet</code> object and a dot, e.g. <code>Sheet1.Cells(...)</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556135022, "post_id": 55837179, "comment_id": 98339018, "body": "Is <code>On Error Resume Next</code> anywhere in that procedure? If so, remove it: if <code>Cells(i, prodCol).Value</code> contains a worksheet error, the <code>&lt;&gt; &quot;Result&quot;</code> comparison is throwing a <i>type mismatch</i> error and <code>Resume Next</code> is interfering with the condition and making the whole block unconditional in these occurrences."}, {"owner": {"reputation": 3, "user_id": 9806167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4039ba4d156845e244ffa2d614093337?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/9806167/john-d"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556135215, "post_id": 55837179, "comment_id": 98339103, "body": "@MathieuGuindon thanks.  the function being called works on the active sheet, but I take your point.  Don&#39;t have On Error Resume Next."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1556135597, "post_id": 55837179, "comment_id": 98339263, "body": "There&#39;s not really enough information here to be able to point to something and say &quot;that&#39;s the problem.&quot;  This really would benefit from providing sample data and expected results.  It would also be very helpful if you posted the full code instead of just the snippet since the snippet appears valid as is."}, {"owner": {"reputation": 3, "user_id": 9806167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4039ba4d156845e244ffa2d614093337?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/9806167/john-d"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556136629, "post_id": 55837179, "comment_id": 98339719, "body": "@tigeravatar thanks.  The entirety of the code is huge, so can&#39;t put it all here.  Seems to me this is the part that goes wrong.    Guess what I need to make happen is instead of copying the array of cells, it should test each individually and then copy if the test is passed"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556136673, "post_id": 55837179, "comment_id": 98339737, "body": "(1) Are you saying the If evaluates to True on every iteration? (2) What is the value of <code>LR</code>? (3) What is the value of <code>prodCol</code>?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556136752, "post_id": 55837179, "comment_id": 98339769, "body": "It looks like the block of &quot;Overall Result&quot; / &quot;Plan&quot; / &quot;Reference&quot; repeats itself, is that correct?  Is there always only one &quot;Plan&quot; row and one &quot;Reference&quot; row per block?"}, {"owner": {"reputation": 3, "user_id": 9806167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4039ba4d156845e244ffa2d614093337?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/9806167/john-d"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556136923, "post_id": 55837179, "comment_id": 98339816, "body": "@tigeravatar yes it loops over multiple blocks as many times as needed till the sheet is completed.  One of each per block right.  Thanks"}, {"owner": {"reputation": 3, "user_id": 9806167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4039ba4d156845e244ffa2d614093337?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/9806167/john-d"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556137308, "post_id": 55837179, "comment_id": 98339966, "body": "@SJR yes seems to eval to true regardless of data in the reference range.  LR is the last row, so the final block.  prodCol is a cell 4 columns back contains a product description"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1556137360, "creation_date": 1556137360, "answer_id": 55837993, "question_id": 55837179, "link": "https://stackoverflow.com/questions/55837179/how-to-loop-through-individual-cells-of-array/55837993#55837993", "title": "How to loop through individual cells of array", "body": "<p>Something like this perhaps?</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rPlan As Range\n    Dim rReference As Range\n    Dim sHeadersCol As String\n    Dim sFirst As String\n    Dim lCol As Long\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    sHeadersCol = \"A\"\n\n    Set rPlan = ws.Columns(sHeadersCol).Find(\"Plan\", ws.Cells(ws.Rows.Count, sHeadersCol), xlValues, xlWhole)\n    If Not rPlan Is Nothing Then\n        sFirst = rPlan.Address\n        Do\n            Set rReference = ws.Range(rPlan, rPlan.End(xlDown)).Find(\"Reference\", rPlan, xlValues, xlWhole)\n            If Not rReference Is Nothing Then\n                For lCol = rPlan.Column + 1 To rPlan.Column + rPlan.CurrentRegion.Columns.Count - 1\n                    If Len(Trim(ws.Cells(rReference.Row, lCol).Value)) &gt; 0 Then ws.Cells(rPlan.Row, lCol).Value = ws.Cells(rReference.Row, lCol).Value\n                Next lCol\n            End If\n            Set rPlan = ws.Columns(sHeadersCol).Find(\"Plan\", rPlan, xlValues, xlWhole)\n        Loop Until rPlan.Address = sFirst\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9806167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4039ba4d156845e244ffa2d614093337?s=128&d=identicon&r=PG&f=1", "display_name": "John D", "link": "https://stackoverflow.com/users/9806167/john-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1556137360, "creation_date": 1556133747, "last_edit_date": 1556136548, "question_id": 55837179, "link": "https://stackoverflow.com/questions/55837179/how-to-loop-through-individual-cells-of-array", "title": "How to loop through individual cells of array", "body": "<p>Have inherited a macro that I'm not 100% on, and I need to fix it.  Essentially it should check if each of the reference cells are populated, if true - copy to plan cell, if isEmpty, do nothing.  However seems it copies regardless.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/DbF4y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DbF4y.png\" alt=\"enter image description here\"></a></p>\n\n<p>Have tried adding for each loop but doesn't seem to be taking effect.</p>\n\n<pre><code>refGap = findRefGap(refCol, LR, valToCopy)\nplanGap = findPlanGap(refCol, LR)\n\n\n\nFor i = 23 To LR\n    'Checks to see if the cell is actually referencing a product.\n    If IsEmpty(Cells(i, prodCol).value) = False And Cells(i, prodCol).value &lt;&gt; \"Result\" Then\n'        RefPt is the row where ref demand is found, same with planPt to planned non-promoted volume.\n        refPt = i + refGap\n        planPt = i + planGap\n\n        Range(Cells(refPt, calCol), Cells(refPt, LC)).copy\n        Range(Cells(planPt, calCol), Cells(planPt, LC)).PasteSpecial xlPasteValues\n\n    End If\nNext\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1556137281, "post_id": 55837054, "comment_id": 98339959, "body": "Save the Import Steps to copy the tables from the Back End to their database. Have them Run the Saved Import when they connect to the VPN so the tables are copied. This way you never link them and it should not ask for Trust Center stuff."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5977022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac11214a51d40a22b1932c6c45ebe72?s=128&d=identicon&r=PG&f=1", "display_name": "MGaddict", "link": "https://stackoverflow.com/users/5977022/mgaddict"}, "edited": false, "score": 0, "creation_date": 1556199583, "post_id": 55843604, "comment_id": 98363185, "body": "I fought to put this in a SQL database but couldn&#39;t get it authorized. If I had a SQL database I had access to, I wouldn&#39;t be using Access at all."}], "tags": [], "owner": {"reputation": 868, "user_id": 1321707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e64dedac8fa02cae04b5c29e520925d?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/1321707/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1556175899, "creation_date": 1556175899, "answer_id": 55843604, "question_id": 55837054, "link": "https://stackoverflow.com/questions/55837054/how-to-force-close-access-application-when-user-lost-connection-to-back-end/55843604#55843604", "title": "How to force close Access application when user lost connection to back-end", "body": "<p>Access doesn't play well with remote BE..if you want to be on the Remote Side with Access you have 2 options :</p>\n\n<ul>\n<li>Connect via RDS..the user connects to the server via Remote Desktop ..everything is \"local\" ..so now issues on lost connections ...as long the RDP connection hold everything is smooth and more importantly you don't have BE disconnects that cause corruption or loosing data (hint : Using the RemoteApp technology it will seem to the end user like he/she is working locally...i am using it and its great)</li>\n<li>Switch BE...as i said , is not wise to use Access BE via remote connection..in order to do that switching to MsSQL/MySQL/PostGre ...etc will give you the true remote connection capability</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5977022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac11214a51d40a22b1932c6c45ebe72?s=128&d=identicon&r=PG&f=1", "display_name": "MGaddict", "link": "https://stackoverflow.com/users/5977022/mgaddict"}, "is_accepted": false, "score": 0, "last_activity_date": 1556199784, "creation_date": 1556199784, "answer_id": 55850727, "question_id": 55837054, "link": "https://stackoverflow.com/questions/55837054/how-to-force-close-access-application-when-user-lost-connection-to-back-end/55850727#55850727", "title": "How to force close Access application when user lost connection to back-end", "body": "<p>After playing with all the settings for a few days, I finally figured out what my problem was.\nIn an effort to test different settings to see if I could reduce file size at one point I turned on \"clear cache on exit\" in the Current Database settings. Turning this off fixed the problem. I had forgotten that was on, so it turned out to not be a programming issue after all.</p>\n"}], "owner": {"reputation": 11, "user_id": 5977022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ac11214a51d40a22b1932c6c45ebe72?s=128&d=identicon&r=PG&f=1", "display_name": "MGaddict", "link": "https://stackoverflow.com/users/5977022/mgaddict"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556199784, "creation_date": 1556133112, "question_id": 55837054, "link": "https://stackoverflow.com/questions/55837054/how-to-force-close-access-application-when-user-lost-connection-to-back-end", "title": "How to force close Access application when user lost connection to back-end", "body": "<p>The Question:\nIs there some way to force close access so it doesn't need access to the back-end server in order to exit?</p>\n\n<p>The Situation:\nI have an Access 2016 DB. The back-end is on a networked share drive which is only accessible when connected to the lan or on VPN. On load there is a ping test to the server, if found it copies the tables to local tables, if not, it just tells the user can't connect and continues on using the old data. The users travel a lot and can't always be on the VPN so the idea is that the data they have isn't more than a few days old. BTW, did I mention the users are only consumers of information and not contributors so I don't care that they can't write to the back-end. The tables contain a few 100k records, the application just puts it in nice easy to search and cross-reference reports.</p>\n\n<p>The Problem:\nWhile this loads and runs really nicely regardless of them being connected to the lan or not, it will NOT close if they don't have a connection to the server. It doesn't produce an error which I could easily handle, it just hangs. Task Manager won't even close it.</p>\n\n<p>Attempted Solutions:\nI tried to unlink the tables and just use a temporary connection to the backend to load the tables when I need them at the beginning, however this meant the user was prompted by the Microsoft Trust Center about 8 times every single time they loaded this unless I have each of them actually open the back-end DB themselves, give them the password to do that, and none of that is practical.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10796191, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156964425666967/picture?type=large", "display_name": "Michael Martin", "link": "https://stackoverflow.com/users/10796191/michael-martin"}, "edited": false, "score": 0, "creation_date": 1556132426, "post_id": 55836867, "comment_id": 98337983, "body": "Cause I am an idiot, but you just saved me. Thank you, good sir. I focused on the copying/pasting aspect and did not even think just to set the cell value equal to the found string."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1556145638, "last_edit_date": 1556145638, "creation_date": 1556132308, "answer_id": 55836867, "question_id": 55836674, "link": "https://stackoverflow.com/questions/55836674/excel-vba-code-fails-inconsistently-when-trying-to-copy-paste-strings-from-mswor/55836867#55836867", "title": "Excel VBA Code Fails Inconsistently When Trying to Copy/Paste Strings from MSWord to MSExcel", "body": "<p>Why do this:</p>\n\n<pre><code>refnumber = Right(c.Text, 10)\nSet myData = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\nmyData.SetText refnumber\nmyData.PutInClipboard\nEDS.Sheets(\"Monthly Usage\").Range(\"A\" &amp; N).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>and not this:</p>\n\n<pre><code>EDS.Sheets(\"Monthly Usage\").Range(\"A\" &amp; N).Value = Right(c.Text, 10)\n</code></pre>\n\n<p>?</p>\n\n<p>PS - do yourself a favor and abstract out the repeated parts of your code.</p>\n\n<p>Untested, but you get the idea:</p>\n\n<pre><code>Sub Work()\n\n    Dim WD As Object\n    Dim ED As Object\n    Dim EDS As Object, EDSSheet As Object\n\n    Set WD = ActiveDocument\n    Set ED = CreateObject(\"excel.application\")\n    ED.Visible = True\n    Set EDS = ED.Workbooks.Open(FileName:=\"\\\\Ecdccesms01\\bu\\CES\\Choice\\Operations\\Transactions\\SOCAL\\Manual Usage Files\\Loads\\2019\\April 2019\\Test.xlsm\")\n    Set EDSSheet = EDS.Sheets(\"Monthly Usage\")\n\n    CopyHits WD, \"ACCOUNT#:\", 10, EDSSheet.Range(\"A2\")\n    CopyHits WD, \"FROM: \", 8, EDSSheet.Range(\"B2\")\n    CopyHits WD, \"TO: \", 8, EDSSheet.Range(\"C2\")\n\nEnd Sub\n\nSub CopyHits(doc As Document, findWhat As String, numChars As Long, copyTo As Object)\n    Dim c As Range\n    Set c = doc.Content\n    With c.Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .Text = findWhat &amp; \"[A-Z0-9]{\" &amp; numChars &amp; \"}\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = False\n        .MatchWildcards = True\n        Do Until Not .Execute()\n            copyTo.Value = Right(c.Text, numChars)\n            Set copyTo = copyTo.Offset(1, 0) '&lt;&lt; move to next cell down\n        Loop\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10796191, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156964425666967/picture?type=large", "display_name": "Michael Martin", "link": "https://stackoverflow.com/users/10796191/michael-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 55836867, "answer_count": 1, "score": 0, "last_activity_date": 1556171849, "creation_date": 1556131564, "last_edit_date": 1556171849, "question_id": 55836674, "link": "https://stackoverflow.com/questions/55836674/excel-vba-code-fails-inconsistently-when-trying-to-copy-paste-strings-from-mswor", "title": "Excel VBA Code Fails Inconsistently When Trying to Copy/Paste Strings from MSWord to MSExcel", "body": "<p>I am trying to write a VBA code that will search a word document for certain strings and copy and paste them to an Excel file. When I run the code, it will inconsistently bug out at the line \"EDS.Sheets(\"Monthly Usage\").Range(\"A\" &amp; N:).PasteSpecial Paste:=xlPasteValues\". It will sometimes not paste anything at all, only a percentage of the account numbers in question, or everything perfectly. The errors can be one of a couple:\nError 1004: PasteSpecial method out of Range class failed or \"Run-time error '-2147221036 (800401d4)'\nDataObject:PutInClipboard CloseClipboard Failed\"</p>\n\n<p>I have tried resetting the Clipboard each loop, and as I do not know any VBA coding that well, I tried finding an alternative solution to copy the variable but could not find anything concrete.</p>\n\n<pre><code>Sub Work()\n    Dim c As Range\n    Dim startword As String\n    Dim refnumber As String\n    Dim WD As Object\n    Dim ED As Object\n    Dim EDS As Object\n    Dim myData As Object\n    Set WD = ActiveDocument\n    Set ED = CreateObject(\"excel.application\")\n    ED.Visible = True\n    Set EDS = ED.Workbooks.Open(FileName:=\"\\\\Ecdccesms01\\bu\\CES\\Choice\\Operations\\Transactions\\SOCAL\\Manual Usage Files\\Loads\\2019\\April 2019\\Test.xlsm\")\n    Dim N  As Integer\n    N = 2\n\n    startword = \"ACCOUNT#:                    \"\n    Set c = ActiveDocument.Content\n\n    c.Find.ClearFormatting\n    c.Find.Replacement.ClearFormatting\n\n    With c.Find\n        .Text = startword &amp; \"[A-Z0-9]{10}\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = False\n        .MatchWildcards = True\n\n\n        Do Until Not .Execute()\n            refnumber = Right(c.Text, 10)\n            Set myData = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n            myData.SetText refnumber\n            myData.PutInClipboard\n            EDS.Sheets(\"Monthly Usage\").Range(\"A\" &amp; N).PasteSpecial Paste:=xlPasteValues\n            N = N + 1\n            Set myData = Nothing\n        Loop\n\n    End With\n\n    N = 2\n    startword1 = \"FROM: \"\n    Set c = ActiveDocument.Content\n    Set myData = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    c.Find.ClearFormatting\n    c.Find.Replacement.ClearFormatting\n\n    With c.Find\n        .Text = startword1 &amp; \"[A-Z0-9/]{8}\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = False\n        .MatchWildcards = True\n\n\n        Do Until Not .Execute()\n            refnumber = Right(c.Text, 8)\n            Set myData = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n            myData.SetText refnumber\n            myData.PutInClipboard\n            EDS.Sheets(\"Monthly Usage\").Range(\"B\" &amp; N).PasteSpecial Paste:=xlPasteValues\n            N = N + 1\n            Set myData = Nothing\n        Loop\n\n    End With\n\n    N = 2\n    startword2 = \"TO: \"\n    Set c = ActiveDocument.Content\n    Set myData = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    c.Find.ClearFormatting\n    c.Find.Replacement.ClearFormatting\n\n    With c.Find\n        .Text = startword2 &amp; \"[A-Z0-9/]{8}\"\n        .Forward = True\n        .Wrap = wdFindStop\n        .Format = False\n        .MatchWildcards = True\n\n\n        Do Until Not .Execute()\n            refnumber = Right(c.Text, 8)\n            Set myData = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n            myData.SetText refnumber\n            myData.PutInClipboard\n            EDS.Sheets(\"Monthly Usage\").Range(\"c\" &amp; N).PasteSpecial Paste:=xlPasteValues\n            N = N + 1\n            Set myData = Nothing\n        Loop\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "is_accepted": false, "score": 0, "last_activity_date": 1556132027, "creation_date": 1556132027, "answer_id": 55836793, "question_id": 55836631, "link": "https://stackoverflow.com/questions/55836631/vba-excel-countdown-timer-showing-incorrect-number-of-hours/55836793#55836793", "title": "VBA\\Excel countdown timer showing incorrect number of hours", "body": "<p>Well, on  a whim I entered the number of days in the target cell and it's now counting down from the correct number of hours:minutes:seconds.</p>\n"}], "owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556132027, "creation_date": 1556131333, "last_edit_date": 1556131549, "question_id": 55836631, "link": "https://stackoverflow.com/questions/55836631/vba-excel-countdown-timer-showing-incorrect-number-of-hours", "title": "VBA\\Excel countdown timer showing incorrect number of hours", "body": "<p>I am trying different code for a countdown timer.  This one does countdown, but I'm unable to get it to countdown from the correct number of hours:minutes:seconds.</p>\n\n<p>when I click on the target cell, it shows in correct hhhhhhh:mm:ss format, and when I click in the editing bar, it shows the correct date\\time, but the number of hours is way off in the actual counter text box.</p>\n\n<p>Target date is 12:01:2021 (22,824 hours) but the countdown is displaying 1068743:32:09 hours:minutes:seconds.</p>\n\n<p>I tried the Excel serial number (41244) but it didn't change anything.</p>\n\n<p>Any ideas why I'm not getting the correct value?</p>\n\n<p>I'm guessing it's in the \"Dim gcount As Date\" statement but am not sure.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Dim gCount As Date\n'Update 20211201' \n\nSub Timer()\n    gCount = Now + TimeValue(\"00:00:01\")\n    Application.OnTime gCount, \"ResetTime\"\nEnd Sub\n\nSub ResetTime()\n   Dim xRng As Range\n   Set xRng = Application.ActiveSheet.Range(\"C1\")\n   xRng.Value = xRng.Value - TimeSerial(0, 0, 1)\n   If xRng.Value &lt;= 0 Then\n      MsgBox \"Countdown complete.\"\n      Exit Sub\n   End If\n   Call Timer\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1556130521, "post_id": 55836386, "comment_id": 98337138, "body": "Please don&#39;t SHOUT when asking your question. Text in ALL CAPS is difficult to read and understand, and it&#39;s somewhat rude to SHOUT for attention. Thanks."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1556130917, "post_id": 55836386, "comment_id": 98337346, "body": "Is the named range definitely on that sheet? Your code works for me."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1556132055, "post_id": 55836386, "comment_id": 98337817, "body": "What are the dimensions of QTY_Range ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556132557, "post_id": 55836386, "comment_id": 98338048, "body": "Never refer to a form&#39;s default instance in that form&#39;s code-behind. If <code>CombQTY</code> is a control on that userform, the only correct qualifier to use is <code>Me</code>. Otherwise you are assigning the <code>List</code> property of the <code>CombQTY</code> combobox <i>on the default instance</i> of the form, ....which may or may not be <i>that</i> instance. Unqualified <code>Worksheets</code> is implicitly referring to whatever the <code>ActiveWorkbook</code> is; a proper <code>Workbook</code> object qualifier would be needed here."}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556134336, "post_id": 55837162, "comment_id": 98338763, "body": "Postscript:  i also changed how to reference your named range, whcih doesn&#39;t require the sheet name (in case you have it wrong)... <code>Names().RefersToRange</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556134598, "post_id": 55837162, "comment_id": 98338862, "body": "Upvoted - only needs some error handling to avoid blowing up with a type mismatch when <code>arr(ubound(arr))</code> contains a worksheet error and that error value is being compared to <code>&quot;&quot;</code>, but that wasn&#39;t in scope."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556134730, "post_id": 55837162, "comment_id": 98338906, "body": "@MathieuGuindon  Very true.  I think the only truly in scope thing I could add would be the single line code that reads:  <code>Me.CombQTY.List = ThisWorkbook.Names(&quot;QTE_range&quot;).RefersToRange.Value</code>"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 2, "last_activity_date": 1556133666, "creation_date": 1556133666, "answer_id": 55837162, "question_id": 55836386, "link": "https://stackoverflow.com/questions/55836386/error-1004-initializing-a-userform-object/55837162#55837162", "title": "Error 1004 Initializing a UserForm object?", "body": "<p>Not directly answering your question, but relative to what you're doing (we don't see what <code>QTE_range</code> address is).</p>\n\n<hr>\n\n<p>I tend to loop and collect a list, so i don't have to worry about the dimensions of my named range (more columns than rows).. .example code (untested):</p>\n\n<pre><code>dim i as range, a as range, arr as variant\nset a = thisworkbook.names(\"QTE_range\").referstorange\nfor each i in a\n    if arr(ubound(arr)) &lt;&gt; \"\" then redim preserve arr(ubound(arr)+1)\n    arr(ubound(arr)) = i.value\nnext \nMe.CombQTY.List = arr\n</code></pre>\n\n<p>Note the references... userform is <code>Me</code> and workbook is <code>thisworkbook</code>, which could be antoher ref, or to a sheet name, etc.</p>\n"}], "owner": {"reputation": 3, "user_id": 11406954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd020e6f877f0ab62b260617b0f9c03a?s=128&d=identicon&r=PG&f=1", "display_name": "Adogen", "link": "https://stackoverflow.com/users/11406954/adogen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556285499, "creation_date": 1556130265, "last_edit_date": 1556285499, "question_id": 55836386, "link": "https://stackoverflow.com/questions/55836386/error-1004-initializing-a-userform-object", "title": "Error 1004 Initializing a UserForm object?", "body": "<p>I can't figure out why this line is throwing the \"Error 1004: Application Defined or Object Defined error\"? Can someone help?</p>\n\n<p>The object \"CombQTY\" is a combo box in a userform \"MASTER\". I am trying to populate the drop down menu of this combo box with the range \"QTY_range\" (size is 31 rows of numbers in a column = 0,1,2,3,..30).</p>\n\n<p>I have tried swapping the \"Userform\" with \"MASTER\" and vice versa.</p>\n\n<pre><code>Private Sub Userform_Initialize()\n\nMASTER.CombQTY.List = Worksheets(\"RANGES\").Range(\"QTY_range\").Value\n\nEnd Sub\n</code></pre>\n\n<p>I can't understand why its throwing that error because I don't see any problem with this code. Please help</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1556131908, "creation_date": 1556131908, "answer_id": 55836765, "question_id": 55836250, "link": "https://stackoverflow.com/questions/55836250/embedded-html-text-within-vba-to-write-email-body/55836765#55836765", "title": "Embedded HTML text within VBA to write email body", "body": "<p>You can add a new line using <code>&lt;br&gt;</code></p>\n\n<pre><code>StrBody:=\"&lt;body&gt;Hello \" &amp; Name &amp; \",&lt;br&gt;\" &amp; _\n         \"Here is the weekly update. Quotes are current through yesterday. \" &amp; _\n         \"&lt;br&gt;&lt;br&gt; &lt;/body&gt;\"*\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2462, "user_id": 639580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/21b3041d664dd92d697bd3e0bca40fb7?s=128&d=identicon&r=PG", "display_name": "Tony", "link": "https://stackoverflow.com/users/639580/tony"}, "is_accepted": true, "score": 2, "last_activity_date": 1556134879, "last_edit_date": 1556134879, "creation_date": 1556134336, "answer_id": 55837292, "question_id": 55836250, "link": "https://stackoverflow.com/questions/55836250/embedded-html-text-within-vba-to-write-email-body/55837292#55837292", "title": "Embedded HTML text within VBA to write email body", "body": "<p>I can't tell if your email call will work because you're not showing your complete code.  Your StrBody contains HTML <code>&lt;body&gt;</code> tags that aren't necessary.  If the salutation appears in the body of the email, it's also considered part of the body.</p>\n\n<p>Let's say you have two variables that you want to use, <code>Name</code> and <code>Email_Body</code>.  Define those before your call to email. </p>\n\n<pre><code>Name = \"Jim\"\nEmail_Body = \"Here is the weekly update. Quotes are current through yesterday.\"\n</code></pre>\n\n<p>They could also be in a cell on one of your sheets if you want to easily change the values.  If you had a sheet called \"Control\" that contained these values, you could retrieve them as follows:</p>\n\n<pre><code>Name = ThisWorkbook.Sheets(\"Control\").Range(\"A2\").Value\nEmail_Body = ThisWorkbook.Sheets(\"Control\").Range(\"B2\").Value\n</code></pre>\n\n<p>When you create the StrBody portion in your email command, it should look like the following:</p>\n\n<pre><code>StrBody:=\"Hello \" &amp; Name &amp; \",&lt;br&gt;&lt;br&gt;\" &amp; Email_Body\n</code></pre>\n\n<p>The <code>&lt;br&gt;</code> tags are line breaks, so your text will appear as follows:</p>\n\n<pre><code>Hello Jim,\n\nHere is the weekly update. Quotes are current through yesterday.\n</code></pre>\n"}], "owner": {"reputation": 333, "user_id": 6322284, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9eb44f00a59f8d34f5f0fb490313afd1?s=128&d=identicon&r=PG&f=1", "display_name": "TonyP", "link": "https://stackoverflow.com/users/6322284/tonyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 55837292, "answer_count": 2, "score": 0, "last_activity_date": 1556171761, "creation_date": 1556129696, "last_edit_date": 1556171761, "question_id": 55836250, "link": "https://stackoverflow.com/questions/55836250/embedded-html-text-within-vba-to-write-email-body", "title": "Embedded HTML text within VBA to write email body", "body": "<p>My code is currently populating text into the body of an email in HTML format from my understanding. I am trying to replace the text with a variable so I don't have to edit the text before running each time. There is currently a variable in the beginning called Name which populate the email body with a \"Hello Jim,\" but I want the actual body to start on the next line so I can't just add an &amp; then the other variable. The code is currently:</p>\n\n<pre><code>                         StrTo:=Email, _\n                         StrCC:=\"\", _\n                         StrBCC:=SDLEmail, _\n                         StrSubject:=Email_Subject, _\n                         Signature:=True, _\n                         Send:=False, _\n                         StrBody:=\"Hello \" &amp; Name &amp; \",\" &amp; _\n                         *\"&lt;body&gt; Here is the weekly update. Quotes are current through yesterday. \" &amp; _\n                                  \"&lt;br&gt;&lt;br&gt;\" &amp; \" &lt;/body&gt;\"*\n</code></pre>\n\n<p>and the variable I want to add is Email_Body</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1556129064, "post_id": 55835892, "comment_id": 98336486, "body": "You havent qualified the Sheet and Range that needs to meet the condtion for the formatting to take place.  I wouldnt use the <code>InputBox</code> to tell what range the code needs to look at; i would use a loop or an array to define the cells that need to be changed to &quot;&lt;30&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11396880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e847a3ecf9b4043335d1cafe806a157?s=128&d=identicon&r=PG&f=1", "display_name": "tGRU", "link": "https://stackoverflow.com/users/11396880/tgru"}, "edited": false, "score": 0, "creation_date": 1556130288, "post_id": 55836282, "comment_id": 98337040, "body": "Tigeravatar that solves my issue. Thank you so much. I will dive in now to understand it better."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 0, "last_activity_date": 1556129813, "creation_date": 1556129813, "answer_id": 55836282, "question_id": 55835892, "link": "https://stackoverflow.com/questions/55835892/suppress-values-under-x-and-copy-to-new-sheet/55836282#55836282", "title": "Suppress Values Under &quot;X&quot; and Copy to New Sheet", "body": "<p>Give this a try:</p>\n\n<pre><code>Sub SuppressLessThan()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim Rng As Range\n    Dim WorkRng As Range\n    Dim dTargetNum As Double\n    Dim sDefault As String\n\n    dTargetNum = 30\n\n    If TypeName(Selection) = \"Range\" Then sDefault = Selection.Address\n    On Error Resume Next\n    Set WorkRng = Application.InputBox(\"Select the cells you are working with:\", \"Select Range\", sDefault, Type:=8)\n    On Error GoTo 0\n    If WorkRng Is Nothing Then Exit Sub 'Pressed cancel\n\n    Set wb = WorkRng.Worksheet.Parent\n    Set ws = wb.Worksheets.Add(After:=wb.Worksheets(wb.Worksheets.Count))\n\n    WorkRng.Copy\n    ws.Range(\"A1\").PasteSpecial xlPasteValues\n    ws.Range(\"A1\").PasteSpecial xlPasteFormats\n    ws.Range(\"A1\").PasteSpecial xlPasteValuesAndNumberFormats\n    Application.CutCopyMode = False\n\n    For Each Rng In ws.UsedRange.Cells\n        If Rng.Value &lt; dTargetNum Then Rng.Value = \"&lt; \" &amp; dTargetNum\n    Next Rng\n\n    ws.UsedRange.EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11396880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e847a3ecf9b4043335d1cafe806a157?s=128&d=identicon&r=PG&f=1", "display_name": "tGRU", "link": "https://stackoverflow.com/users/11396880/tgru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 55836282, "answer_count": 1, "score": 0, "last_activity_date": 1556129813, "creation_date": 1556128355, "question_id": 55835892, "link": "https://stackoverflow.com/questions/55835892/suppress-values-under-x-and-copy-to-new-sheet", "title": "Suppress Values Under &quot;X&quot; and Copy to New Sheet", "body": "<p>I am trying to create a VBA template that can be used to suppress all data values under a certain amount. I have found/updated some code I found online that does successfully create a new sheet, transfer the selected data, and replace all numeric values 30 and under with \"&lt; 30\" as desired. However, it also updates the original data source, replacing the data selected instead of only updating the data on the new sheet. How can I prevent it from modifying the original data and only modifying the data copied to the new sheet?</p>\n\n<p>I've tried this code here, but am not getting the desired results and have been unable to figure out how to modify it to achieve them:</p>\n\n<pre><code>Sub SuppressLessThan()\n\nDim Rng As Range\nDim WorkRng As Range\nDim ws As Worksheet\n\nOn Error Resume Next\n\n    Set WorkRng = Application.Selection\n    Set WorkRng = Application.InputBox(\"Select the cells you are working with:\", \"Select Range\", WorkRng.Address, Type:=8)\n\nSet ws = Worksheets.Add\n\nWorkRng.Copy\n\nFor Each Rng In WorkRng\n\nIf Rng.Value &lt; 30 Then\n        Rng.Value = \"&lt; 30\"\n\n    End If\nNext\n\nWith ws.Range(\"A1\")\n        .PasteSpecial xlPasteValues\n        .PasteSpecial xlPasteFormats\n        .PasteSpecial xlPasteValuesAndNumberFormats\nEnd With\n\nws.Columns(\"A\").AutoFit\n\nApplication.CopyCutMode = False\n\nEnd Sub\n</code></pre>\n\n<p>It currently copies the selected range and updates both the original data source and new sheet with the suppressed values. How can I prevent it from modifying the original data and only transform the copied data?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556128259, "post_id": 55835727, "comment_id": 98336156, "body": "Always helps to provide more than a single line of your code - all of the relevant VBA would be useful."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556130571, "post_id": 55835727, "comment_id": 98337154, "body": "In Sub PREPGRAPH(), you have the code line that you say causes an error several times <code>ActiveSheet.ChartObjects(&quot;Chart 17&quot;).Activate</code>. I think this is because you are using a recorded macro. Your Chart name will change if you keep running the code to make the chart. Maybe read through the code and think about what you actually want to keep, so you can delete unnecessary lines and focus on cleaning up the remaining lines."}], "answers": [{"comments": [{"owner": {"reputation": 235, "user_id": 10197838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecc20ac9100643705c47c6ddad237a6?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Barber", "link": "https://stackoverflow.com/users/10197838/kenny-barber"}, "edited": false, "score": 0, "creation_date": 1556132454, "post_id": 55836050, "comment_id": 98337997, "body": "Hi Jessi, thanks for your reply. When you say &#39;do whatever with your chart here&#39; did you mean cut and paste from ActiveSheet.ChartObjects(&quot;Chart 17&quot;).Activate to the end but replace 17 with i?"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 235, "user_id": 10197838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecc20ac9100643705c47c6ddad237a6?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Barber", "link": "https://stackoverflow.com/users/10197838/kenny-barber"}, "edited": false, "score": 1, "creation_date": 1556132897, "post_id": 55836050, "comment_id": 98338188, "body": "i would not do that. Your code has a lot of <code>Activate</code> instances, so I think it is doing more than you actually want. However, yes. In there, you would put your code. It may be easier to store a reference to that chart. At the beginning of your sub, <code>Dim myChart As ChartObject</code> then, after you define i, you can <code>myChart = ActiveSheet.ChartObjects(i)</code> and then, you can <code>With myChart</code> and do all of the changes that you need to. ChartObject has these functions: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.chartobject\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.chartobject</a>"}], "tags": [], "owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "is_accepted": false, "score": 0, "last_activity_date": 1556128966, "creation_date": 1556128966, "answer_id": 55836050, "question_id": 55835727, "link": "https://stackoverflow.com/questions/55835727/how-do-i-change-a-reference-to-a-chart-objects-in-excel-vba/55836050#55836050", "title": "How do I change a reference to a chart objects in excel vba", "body": "<p>You will want to use the index of the Chart Object. If it will always be the 1st one, the code is different than if it is always the second to last one. </p>\n\n<pre><code>Dim i As Integer\nIf ActiveSheet.ChartObjects.Count &gt; 0 Then\n        i = ActiveSheet.ChartObjects.Count -1 'second to last\n        ' if always want i = 1, you can just use 1 instead of i\n        ActiveSheet.ChartObjects(i).Activate\n        'do whatever with your chart here\nElse\n        MsgBox \"no charts\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 235, "user_id": 10197838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecc20ac9100643705c47c6ddad237a6?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny Barber", "link": "https://stackoverflow.com/users/10197838/kenny-barber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556171722, "creation_date": 1556127602, "last_edit_date": 1556171722, "question_id": 55835727, "link": "https://stackoverflow.com/questions/55835727/how-do-i-change-a-reference-to-a-chart-objects-in-excel-vba", "title": "How do I change a reference to a chart objects in excel vba", "body": "<p>I have a problem with a macro I've recorded in excel.</p>\n\n<p>The macro:</p>\n\n<ol>\n<li><p>inserts 2 graphs</p></li>\n<li><p>selects the 1st graph</p></li>\n<li><p>Puts certain data on a secondary vertical axis</p></li>\n</ol>\n\n<p>The macro works up to the below line and gives the error:</p>\n\n<p>ActiveSheet.ChartObjects(\"Chart 17\").Activate</p>\n\n<p>Does anyone know a way I can get rid of the \"Chart 17\" part of it and replace it with something that does not need to reference Chart 17 or any numbered chart?</p>\n\n<p>Thanks in Advance </p>\n\n<p>EDIT - Apologies, below is the code for creating the graph which works and the graph editing which doesnt</p>\n\n<pre><code>Sub PLOTGraph()\nRange(\"B:B,D:D,F:F,H:H,J:J,L:L\").Select\nRange(\"L1\").Activate\nActiveWindow.SmallScroll ToRight:=9\nRange(\"B:B,D:D,F:F,H:H,J:J,L:L,N:N,P:P,R:R,T:T\").Select\nRange(\"T1\").Activate\nActiveWindow.SmallScroll ToRight:=10\n  Range(\"B:B,D:D,F:F,H:H,J:J,L:L,N:N,P:P,R:R,T:T,V:V,X:X,Z:Z,AB:AB,AD:AD\").Select\nRange(\"AD1\").Activate\nActiveWindow.SmallScroll ToRight:=7\nRange( _\n     \"B:B,D:D,F:F,H:H,J:J,L:L,N:N,P:P,R:R,T:T,V:V,X:X,Z:Z,AB:AB,AD:AD,AF:AF,AH:AH,A     J:AJ,AL:AL\" _\n).Select\nRange(\"AL1\").Activate\nActiveWindow.SmallScroll ToRight:=8\nRange( _\n\"B:B,D:D,F:F,H:H,J:J,L:L,N:N,P:P,R:R,T:T,V:V,X:X,Z:Z,AB:AB,AD:AD,AF:AF,AH:AH,A    J:AJ,AL:AL,AN:AN,AP:AP,AR:AR,AT:AT\" _\n).Select\nRange(\"AT1\").Activate\nActiveWindow.SmallScroll ToRight:=7\nRange( _\n\"B:B,D:D,F:F,H:H,J:J,L:L,N:N,P:P,R:R,T:T,V:V,X:X,Z:Z,AB:AB,AD:AD,AF:AF,AH:AH,A    J:AJ,AL:AL,AN:AN,AP:AP,AR:AR,AT:AT,AV:AV\" _\n).Select\nRange(\"AV1\").Activate\nActiveSheet.Shapes.AddChart2(240, xlXYScatterLinesNoMarkers).Select\nEnd Sub\n\n    Sub PREPGRAPH()\n\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveSheet.Shapes(\"Chart 17\").IncrementLeft 307.4175590551\nActiveSheet.Shapes(\"Chart 17\").IncrementTop -7.4175590551\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveSheet.Shapes(\"Chart 17\").ScaleWidth 2.2901131822, msoFalse, _\nmsoScaleFromTopLeft\nActiveSheet.Shapes(\"Chart 17\").ScaleHeight 2.4446731852, msoFalse, _\nmsoScaleFromTopLeft\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveChart.Legend.Select\nActiveChart.Legend.LegendEntries(13).Select\nActiveChart.Legend.LegendEntries(12).Select\nActiveChart.FullSeriesCollection(12).Select\nActiveChart.FullSeriesCollection(12).AxisGroup = 2\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveChart.FullSeriesCollection(12).Select\nActiveChart.Legend.Select\nActiveChart.Legend.LegendEntries(12).Select\nActiveChart.FullSeriesCollection(13).Select\nActiveChart.FullSeriesCollection(13).AxisGroup = 2\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveChart.FullSeriesCollection(13).Select\nActiveChart.Legend.Select\nActiveChart.Legend.LegendEntries(12).Select\nActiveChart.FullSeriesCollection(14).Select\nActiveChart.FullSeriesCollection(14).AxisGroup = 2\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveChart.FullSeriesCollection(14).Select\nActiveChart.Legend.Select\nActiveChart.Legend.LegendEntries(12).Select\nActiveChart.FullSeriesCollection(15).Select\nActiveChart.FullSeriesCollection(15).AxisGroup = 2\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveChart.FullSeriesCollection(15).Select\nActiveChart.Legend.Select\nActiveChart.Legend.LegendEntries(12).Select\nActiveChart.FullSeriesCollection(16).Select\nActiveChart.FullSeriesCollection(16).AxisGroup = 2\nActiveSheet.ChartObjects(\"Chart 17\").Activate\nActiveChart.FullSeriesCollection(16).Select\nActiveChart.SetElement (msoElementPrimaryCategoryAxisTitleAdjacentToAxis)\nActiveChart.SetElement (msoElementPrimaryValueAxisTitleAdjacentToAxis)\nActiveChart.SetElement (msoElementSecondaryValueAxisTitleAdjacentToAxis)\nActiveChart.Axes(xlValue).AxisTitle.Select\nActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = _\n\"Voltage (V) &amp; Temperature (?)\"\nSelection.Format.TextFrame2.TextRange.Characters.Text = _\n\"Voltage (V) &amp; Temperature (?)\"\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 29).ParagraphFormat\n.TextDirection = msoTextDirectionLeftToRight\n.Alignment = msoAlignCenter\n End With\n With Selection.Format.TextFrame2.TextRange.Characters(1, 7).Font\n.BaselineOffset = 0\n .Bold = msoFalse\n.NameComplexScript = \"+mn-cs\"\n.NameFarEast = \"+mn-ea\"\n.Fill.Visible = msoTrue\n.Fill.ForeColor.RGB = RGB(89, 89, 89)\n.Fill.Transparency = 0\n.Fill.Solid\n.Size = 10\n.Italic = msoFalse\n.Kerning = 12\n.Name = \"+mn-lt\"\n.UnderlineStyle = msoNoUnderline\n.Strike = msoNoStrike\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(8, 20).Font\n.BaselineOffset = 0\n.Bold = msoFalse\n.NameComplexScript = \"+mn-cs\"\n.NameFarEast = \"+mn-ea\"\n.Fill.Visible = msoTrue\n.Fill.ForeColor.RGB = RGB(89, 89, 89)\n.Fill.Transparency = 0\n.Fill.Solid\n.Size = 10\n.Italic = msoFalse\n.Kerning = 12\n.Name = \"+mn-lt\"\n.UnderlineStyle = msoNoUnderline\n.Strike = msoNoStrike\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(28, 2).Font\n.BaselineOffset = 0\n.Bold = msoFalse\n.NameComplexScript = \"Times New Roman\"\n.NameFarEast = \"+mn-ea\"\n.Fill.Visible = msoTrue\n.Fill.ForeColor.RGB = RGB(89, 89, 89)\n.Fill.Transparency = 0\n.Fill.Solid\n.Size = 10\n.Italic = msoFalse\n.Kerning = 12\n.Name = \"Times New Roman\"\n.UnderlineStyle = msoNoUnderline\n.Strike = msoNoStrike\nEnd With\nActiveChart.Axes(xlCategory).AxisTitle.Select\nActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Text = \"Time (s)\"\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"Time (s)\"\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 8).ParagraphFormat\n.TextDirection = msoTextDirectionLeftToRight\n.Alignment = msoAlignCenter\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 8).Font\n.BaselineOffset = 0\n.Bold = msoFalse\n.NameComplexScript = \"+mn-cs\"\n.NameFarEast = \"+mn-ea\"\n.Fill.Visible = msoTrue\n.Fill.ForeColor.RGB = RGB(89, 89, 89)\n.Fill.Transparency = 0\n.Fill.Solid\n.Size = 10\n.Italic = msoFalse\n.Kerning = 12\n.Name = \"+mn-lt\"\n.UnderlineStyle = msoNoUnderline\n.Strike = msoNoStrike\nEnd With\nActiveChart.Axes(xlValue, xlSecondary).AxisTitle.Select\nActiveChart.Axes(xlValue, xlSecondary).AxisTitle.Text = \"Voltage (V)\"\nSelection.Format.TextFrame2.TextRange.Characters.Text = \"Voltage (V)\"\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).ParagraphFormat\n.TextDirection = msoTextDirectionLeftToRight\n.Alignment = msoAlignCenter\nEnd With\nWith Selection.Format.TextFrame2.TextRange.Characters(1, 11).Font\n.BaselineOffset = 0\n.Bold = msoFalse\n.NameComplexScript = \"+mn-cs\"\n.NameFarEast = \"+mn-ea\"\n.Fill.Visible = msoTrue\n.Fill.ForeColor.RGB = RGB(89, 89, 89)\n.Fill.Transparency = 0\n.Fill.Solid\n.Size = 10\n.Italic = msoFalse\n.Kerning = 12\n.Name = \"+mn-lt\"\n.UnderlineStyle = msoNoUnderline\n.Strike = msoNoStrike\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1556128074, "post_id": 55835699, "comment_id": 98336070, "body": "Read this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a> You can&#39;t select a cell on a non-active sheet so you have to either activate the sheet first or use <code>application.goto</code>."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 1, "creation_date": 1556128283, "post_id": 55835699, "comment_id": 98336167, "body": "Since these are named ranges, you can also get their data directly to an array in vba, like &#39;ThisWorkbook.Names(&quot;SignupPairs)..RefersToRange.Value`"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556133560, "post_id": 55835699, "comment_id": 98338476, "body": "@jessi that would make a great, upvote-worthy answer!"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556136892, "post_id": 55835699, "comment_id": 98339806, "body": "I created an answer from my comment. I hope that it helps the op move forward with this project. I appreciate the encouragement @MathieuGuindon"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556141585, "post_id": 55837834, "comment_id": 98341635, "body": "Thank you jessi.  I need to go back through my code and figure out how to use signUps instead of Range(&quot;SignupPairs&quot;).  As I have been working through this code I have been using meaningful range names to help keep track of what I am doing.  Using signUps is a lot simpler than using Range(&quot;SignupPairs&quot;) but it would help to know why signUps is functionally better.  My gut reaction is that multiple levels of abstraction risks more unintended consequences.  Can I hand off signUps to a Sub?  If I redimension signUps in the Sub, will that apply in the calling routine and in other Subs?"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556141826, "post_id": 55837834, "comment_id": 98341718, "body": "You can change the dimensions of a named range in your Sub. Whether or not it impacts other subs depends on when Subs are called and what scope you give it. I&#39;d be hesitant to change the shape of a named range a bunch unless you know what impacts you are having. You could make the range large to begin with and have code that checks for empty. Or, you could dynamically name the range at the start of your sub. You can definitely pass arrays around Subs and Functions for more work."}, {"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556142896, "post_id": 55837834, "comment_id": 98342033, "body": "OK Thanks for the help.  I think I am starting to see part of the problem: A named rang is a property of the worksheet while signUps is a VBA variable that works better in the VBA environment."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556142992, "post_id": 55837834, "comment_id": 98342057, "body": "Yes! A named range is an easy way to refer to a group of cells. signUps (in my example) is an array that is not on a worksheet. You can do a lot with arrays quickly."}, {"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556143425, "post_id": 55837834, "comment_id": 98342191, "body": "What does .Value2 mean?  Is it the same as .Value?  Does anyone have a suggestion for a reference where I can look this up so I don&#39;t have to take people&#39;s time with simple questions?"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556143600, "post_id": 55837834, "comment_id": 98342235, "body": "I always go to the Docs <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.value2\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.range.value2</a>"}, {"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556143705, "post_id": 55837834, "comment_id": 98342261, "body": "Never mind.  I just &quot;F1&quot; Value2 and found the explanation.  Sometimes that works well."}, {"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556145248, "post_id": 55837834, "comment_id": 98342657, "body": "It is still broken.  At the top of my program I Dim newMem as Variant and set it equal to the name &quot;NewMem&quot; per your example.  MsgBox  newMem(1,1) works, the next statement; newMem(1,1).Select does not.  Is there something I need to learn about addressing this array?"}, {"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556229899, "post_id": 55837834, "comment_id": 98377672, "body": "Fixed it!  I needed to Activate Sheet2."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556242139, "post_id": 55837834, "comment_id": 98380175, "body": "I&#39;m glad you solved this @Don - be very cautious with Activate. This is switching between the sheets you are using. You can accidentally overwrite things if you now output to that sheet."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556242344, "post_id": 55837834, "comment_id": 98380214, "body": "also, regarding the comment before it worked for you. I apologize for pasting in <code>newMem(1,1).Select</code> - that would not work. If you want to do something with <code>newMem(1,1)</code> it is just there. My mistake as I was trying to translate your code to an array."}, {"owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "edited": false, "score": 0, "creation_date": 1556575325, "post_id": 55837834, "comment_id": 98477732, "body": "OK  Thanks for your help."}], "tags": [], "owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "is_accepted": false, "score": 1, "last_activity_date": 1556136578, "creation_date": 1556136578, "answer_id": 55837834, "question_id": 55835699, "link": "https://stackoverflow.com/questions/55835699/select-method-of-range-class-failed-a-range-address-is-found-by-msgbox-but-won/55837834#55837834", "title": "Select method of Range class failed. A range address is found by msgBox, but won&#39;t &quot;.Select&quot;", "body": "<p>Since you are new to VBA, I highly recommend always writing down what you intend to do as comments in your code. This will help helpers and future you.</p>\n\n<p>I am not sure what you want to do with the data in your summary sheet. I recommend that you create a reference to your summary sheet and then you can use arrays from your named ranges. </p>\n\n<p>Here's a way that you can get both Sign Up Pairs and New Mem into arrays and then msg box out what you were looking at (but I assume that you want to match them or do something else)</p>\n\n<pre><code>Sub doSomethingWithSignups()\n    Dim ws As Worksheet, signUps As Variant, newMems As Variant\n    ' these arrays will have whatever data you have identified in the Named Ranges\n    signUps = ThisWorkbook.Names(\"SignupPairs\").RefersToRange.Value2\n    newMems = ThisWorkbook.Names(\"NewMems\").RefersToRange.Value2\n\n    ' you can do anything with these arrays now\n    MsgBox(\"SignupPairs 2,1 \" &amp; signUps(2, 1))\n    MsgBox(\"NewMem 1,1 \" &amp; newMems(1, 1))\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11342669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839da7cc6a9316fba8d59dbe32c3ebca?s=128&d=identicon&r=PG&f=1", "display_name": "Don", "link": "https://stackoverflow.com/users/11342669/don"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556136578, "creation_date": 1556127504, "question_id": 55835699, "link": "https://stackoverflow.com/questions/55835699/select-method-of-range-class-failed-a-range-address-is-found-by-msgbox-but-won", "title": "Select method of Range class failed. A range address is found by msgBox, but won&#39;t &quot;.Select&quot;", "body": "<p>I am working with named ranges (mostly in Sheet 2) and am in the process of creating a summary in a sheet named \"Signups\".  I am mostly cutting and pasting code that has worked in other parts of the program.  For some reason VBA will not Select a range in Sheet 2.</p>\n\n<p>In the code below, \"SignupPairs\" is a range in sheet \"Signups\" and \"NewMem\" is a range in \"Sheet2\".</p>\n\n<pre><code>''''''''''\nMsgBox \"SignupPairs 2,1 \" &amp; Range(\"SignupPairs\")(2, 1)\nRange(\"SignupPairs\")(2, 1).Select\nMsgBox \"NewMem 1,1 \" &amp; Range(\"NewMem\")(1, 1)\n'Sheets(\"Sheet2\").Range(\"NewMem\")(1, 1).Select  'Doesn't work.\nRange(\"NewMem\")(1, 1).Select\n''''''''''\n</code></pre>\n\n<p>The first four lines have been added for debugging purposes.  The last line is the one that brought me to a screeching halt.  Line four was an attempt to be specific about the sheet I wanted to use; it didn't work.  MsgBox correctly reports the contents of cells in \"SignupPairs\" and \"NewMem\" but I can't select NewMem(1,1) in order to do a \"Range(Selection, Selection.End(xlDown)).Rows.Count.</p>\n\n<p>For bonus points: Does anyone have a link, or a reference, for a good primer or manual on VBA so I can educate myself and not have to ask these simple questions?  VBA for Dummies only got me into this mess.</p>\n\n<p>P.S. Clicking \"F1\" on \"Select\" in VBA Editor sends me to a page on Select Case which seems like a dead end.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1556128396, "creation_date": 1556128396, "answer_id": 55835901, "question_id": 55835654, "link": "https://stackoverflow.com/questions/55835654/how-to-split-the-2nd-dimension-of-a-for-loop/55835901#55835901", "title": "How to split the 2nd dimension of a for loop?", "body": "<pre><code>For j = 3 to 9\n    if j&lt;&gt;6 Then\n        'do stuff\n    end if\nnext j\n</code></pre>\n"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 55835901, "answer_count": 1, "score": 0, "last_activity_date": 1556128965, "creation_date": 1556127308, "last_edit_date": 1556128965, "question_id": 55835654, "link": "https://stackoverflow.com/questions/55835654/how-to-split-the-2nd-dimension-of-a-for-loop", "title": "How to split the 2nd dimension of a for loop?", "body": "<p>If I have a for/next loop, but have a column splitting up the range I need to apply the array print to, how would I go about splitting that? </p>\n\n<p>Example:</p>\n\n<pre><code>For i = 0 To 4 '5 rows\n    For j = 3 To 5 'apply across 3 columns\n        Set c = wsA.Cells(fndRow + i, j + 43)\n        c.Interior.Color = VBA.RGB(255, 255, 0)\n        wsA.Cells(fndRow + i, j + 43).Value = rIterator.Offset(, j - 1).Value * multplr(i)\n    Next j\nNext I\n</code></pre>\n\n<p>I want to split my array print between 3 columns skip over a column and then the next three columns like: </p>\n\n<pre><code>For j = 3 to 5, 7 to 9 \n</code></pre>\n\n<p>I know this isn't the correct syntax, but it conveys my point in the question. Any thoughts? Would I need to create another for loop?</p>\n"}, {"tags": ["sql", "sql-server", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556125739, "post_id": 55835191, "comment_id": 98334993, "body": "Why is INSERT action needed? Are you not using bound forms? Step debug, which variable is throwing the error?"}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556125940, "post_id": 55835191, "comment_id": 98335079, "body": "@June7 There are multiple tables involved in the insert this is just one of them that is having issues. I also need to use unbound columns since I am changing the format of the microsoft time code to the unix time code which, as far as I am aware, you cannot display as a date."}, {"owner": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 1, "creation_date": 1556126256, "post_id": 55835191, "comment_id": 98335202, "body": "That error means that a primary key field, or required field, is trying to be assigned a NULL value and it&#39;s not happy.  I would start debugging with ensuring the keys you&#39;re INSERTing are all populated with values, then work your way to required fields."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556126279, "post_id": 55835191, "comment_id": 98335216, "body": "Does ideaID feed projectID variable? projectID expects a string yet you say ideaID is Null. Only Variant type can hold null. Advise again, step debug."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 3101, "user_id": 167478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f77f8328db85911cfbfba4662bb73?s=128&d=identicon&r=PG", "display_name": "Fink", "link": "https://stackoverflow.com/users/167478/fink"}, "edited": false, "score": 0, "creation_date": 1556126399, "post_id": 55835191, "comment_id": 98335272, "body": "@Fink I have gone through all of the fields in the table that I am inserting to and made sure that all of the values that are required (NOT NULL)  are being inserted."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556126641, "post_id": 55835191, "comment_id": 98335383, "body": "@June7 Not quite, projectID is fed by a another method which gets values from another table that contains the counter for each idea."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556127365, "post_id": 55835191, "comment_id": 98335751, "body": "You can pinpoint the problem value if you use the DAO <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/recordset-addnew-method-dao\" rel=\"nofollow noreferrer\">Recordset.AddNew method</a>.  And <a href=\"https://stackoverflow.com/a/20332327/77335\">here is an example</a> from a Stack Overflow answer."}, {"owner": {"reputation": 379, "user_id": 6210991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Y6nJN.jpg?s=128&g=1", "display_name": "KySoto", "link": "https://stackoverflow.com/users/6210991/kysoto"}, "edited": false, "score": 0, "creation_date": 1556127481, "post_id": 55835191, "comment_id": 98335801, "body": "I had a similar problem, i ended up using DAO.recordsets to load data in, and it worked that way. i never figured out why i was getting the error."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556127525, "post_id": 55835191, "comment_id": 98335828, "body": "@HansUp So replace QDF.Execute with Set Recordset = QDF.openrecordset and then add recordset.addnew?  Oh the link you gave is for adding data using Recordset. my bad."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1556127695, "post_id": 55835191, "comment_id": 98335895, "body": "What does ConvertDateToUnix do with a Null input value? Does it return Null?"}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1556127731, "post_id": 55835191, "comment_id": 98335917, "body": "@donPablo Yes, The function itself is set as Variant so if it receives null it returns null."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556129301, "post_id": 55835191, "comment_id": 98336591, "body": "@HansUp I have tested what you recommended and found that it is the projectCanceledDate variable in the InsertProject function that is giving me grief. The issue is it says it needs to be a Variant data type but it already is."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556130373, "post_id": 55835191, "comment_id": 98337077, "body": "@June7 Using HansUp&#39;s method (using RecordSet.AddNew) I was able to pinpoint the variable causing the error. It is projectCanceledDate in InsertProject. Issues is it is already set to Variant."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556130431, "post_id": 55835191, "comment_id": 98337098, "body": "OK, at least you&#39;ve pinpointed the problem field and value;  that&#39;s progress.  :-)  Unfortunately, I can&#39;t say why it&#39;s a problem.  Can you add the row if you substitute a non-Null value for that field?  If so, can you then update that new row replacing the field value with Null?"}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556130850, "post_id": 55835191, "comment_id": 98337308, "body": "@HansUp Yes it is progress. I am able to insert it when it is not null. However I am unable to update it to null afterwards. This seems to be pointing to the actual table column not allowing nulls. However I have checked to make sure that it does."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556131094, "post_id": 55835191, "comment_id": 98337414, "body": "@HansUp There are no constrains added to the table other then a few foreign keys, none of which point to the project_canceleddate column. I can also update it or insert it if I am directly in MSSMS."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1556132495, "post_id": 55835191, "comment_id": 98338018, "body": "<code>BIGINT</code>? Which version of Access are you using? That&#39;s only supported on recent updates of Access 2016 and on Access 2019. Also, which ODBC driver? And have you refreshed the linked table?"}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1556132814, "post_id": 55835191, "comment_id": 98338157, "body": "@ErikA I am running on the latest version from office 365 (I believe). The database itself is also located in a SQL-Server if that has any implication on it."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1556138278, "post_id": 55835191, "comment_id": 98340421, "body": "@HansUp Thank you for all your help. :-) Turns out it was just that the access table link needed to be refreshed. Still not sure why since I don&#39;t think I ever set the table to be NOT NULL."}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556233161, "post_id": 55835191, "comment_id": 98378520, "body": "@HansUp Ah, my apologies. I am still pretty new to Stack overflow. Thank you again for your help, It was a pleasure. :)"}], "answers": [{"comments": [{"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "edited": false, "score": 0, "creation_date": 1556129848, "post_id": 55836100, "comment_id": 98336833, "body": "projectID is based on another method which pulls values from a counter table that I have. It concatenates different values Prefix + Counter + Suffix and then returns that string.  I can add that function to the question if you want to see it.  CancelDate is set to either Now() or Null depending on values entered in the form. I have provided that logic in the question right under &quot;Here is where I am calling the function:&quot;"}, {"owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "edited": false, "score": 1, "creation_date": 1556130090, "post_id": 55836100, "comment_id": 98336946, "body": "I do like that loop to view a QueryDef&#39;s params. Thank you for posting that."}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1556129103, "creation_date": 1556129103, "answer_id": 55836100, "question_id": 55835191, "link": "https://stackoverflow.com/questions/55835191/access-not-allowing-insert-or-update-of-null-values-in-sql-server-column-access/55836100#55836100", "title": "Access Not allowing INSERT or UPDATE of null values in SQL-Server column (Access Run-time Error 3162)", "body": "<p>In the Call InsertProject, the fields  projectID and CancelDate are not given any values. What is used for them?</p>\n\n<p>Add this simple code to look at what is there in the parameters.</p>\n\n<pre><code>Dim parm As DAO.Parameter\nFor Each parm In QDF.Parameters\n    Debug.Print parm.Name, parm.Value\nNext parm\n</code></pre>\n\n<p>Here is what I got</p>\n\n<pre><code>  @projectID                  MyProjId\n  @projectGroup               1\n  @projectType                1\n  @projectHasMilestones       0\n  @projectHasGantt            0\n  @projectCategory            2\n  @projectDifficulty          1\n  @projectNotes               Null\n  @projectCompletionDetails   Null\n  @projectStatus              1\n  @projectDateInProgress      Null\n  @projectDateComplete        Null\n  @projectDateCreated         1556103601\n  @projectDateUpdated         1556103601\n  @projectCanceledDate        Null\n  @projectIsActive            1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "is_accepted": true, "score": 1, "last_activity_date": 1556137944, "creation_date": 1556137944, "answer_id": 55838128, "question_id": 55835191, "link": "https://stackoverflow.com/questions/55835191/access-not-allowing-insert-or-update-of-null-values-in-sql-server-column-access/55838128#55838128", "title": "Access Not allowing INSERT or UPDATE of null values in SQL-Server column (Access Run-time Error 3162)", "body": "<p>After doing some more experimentation I found the problem. It seems that a change in the SQL server had not been reflected in the access database (namely making the <code>project_canceleddate</code> accept nulls). After refreshing the link on the <code>ci_project</code> table everything worked fine.</p>\n"}], "owner": {"reputation": 88, "user_id": 7442012, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tFCKJS-gHl0/AAAAAAAAAAI/AAAAAAAAAhI/hOiuxfuwtVA/photo.jpg?sz=128", "display_name": "EliSauder", "link": "https://stackoverflow.com/users/7442012/elisauder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 55838128, "answer_count": 2, "score": 1, "last_activity_date": 1556227474, "creation_date": 1556125340, "last_edit_date": 1556227474, "question_id": 55835191, "link": "https://stackoverflow.com/questions/55835191/access-not-allowing-insert-or-update-of-null-values-in-sql-server-column-access", "title": "Access Not allowing INSERT or UPDATE of null values in SQL-Server column (Access Run-time Error 3162)", "body": "<p>Hello the wide world of stackoverflow,</p>\n\n<p>ISSUE: <br/>\nI am currently working on developing a sql-server database that uses access forms to get and insert data.\nPrior to yesterday everything was working fine. The issue now is that I am getting the following error when trying to run my insert query.</p>\n\n<p><code>Access Runtime Error '3162': You tried to assign the Null value to a variable that is not a Variant data type.</code></p>\n\n<p>ISSUE DETAILS: <br/>\nThis seems to be a result of Access not letting me INSERT or UPDATE null values in a SQL table column that does allow nulls. <br/> Further supporting this if I run the same queries in Microsoft SQL Server Management Studio I am able to INSERT and UPDATE Null values.<br/>\nYou can see the INSERT query I am currently using under OLD ISSUE DETAILS. </p>\n\n<p>SOLUTION 4/24/19 1:35 PM PST: <br/>\nIt seems that the access table link was not using the latest version of the SQL table. After refreshing the link everything worked as it should</p>\n\n<hr>\n\n<p>OLD ISSUE DETAILS: <br/>\nUPDATE: 4/24/19, 10:33 AM PST: Realized I forgot to provide where the error happens. The error occurs in the InsertProject function at <code>QDF.Execute</code></p>\n\n<p>As far as I have seen I am not doing this. All of the table columns that can be null are set as such and the variables inside of vba seem to be set correctly from what I can see.</p>\n\n<p>I have provided the code, queries, and other information that are involved with this issue.</p>\n\n<p>Here is the query I am using:</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>\n    INSERT INTO ci_project \n    (project_id, \n    project_group, \n    project_projecttype, \n    project_hasmilestones, \n    project_hasgantt, \n    project_category, \n    project_difficulty, \n    project_notes, \n    project_completiondetails, \n    project_statuscode, \n    project_inprogressdate, \n    project_completeddate, \n    project_datecreated, \n    project_lastupdated, \n    project_canceleddate, \n    project_isActive) \n    VALUES (@projectID\n    ,@projectGroup\n    ,@projectType\n    ,@projectHasMilestones\n    ,@projectHasGantt\n    ,@projectCategory\n    ,@projectDifficulty\n    ,@projectNotes\n    ,@projectCompletionDetails\n    ,@projectStatus\n    ,@projectDateInProgress\n    ,@projectDateComplete\n    ,@projectDateCreated\n    ,@projectDateUpdated\n    ,@projectCanceledDate\n    ,@projectIsActive);\n\n</code></pre>\n\n<p>Here is the function I made to make it easier to call it multiple times:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\n    'This is located in another Module called OtherFunctions\n    Dim dbs as DAO.Database\n\n    Public Function InsertProject(projectID As String, _\n                                  projectGroup As Integer, _\n                                  projectType As Integer, _\n                                  projectHasMilestones As Boolean, _\n                                  projectHasGantt As Boolean, _\n                                  projectCategory As Integer, _\n                                  projectDifficulty As Integer, _\n                                  projectNotes As Variant, _\n                                  projectCompletionDetails As Variant, _\n                                  projectStatus As Integer, _\n                                  projectDateInProgress As Variant, _\n                                  projectDateComplete As Variant, _\n                                  projectCanceledDate As Variant, _\n                                  projectIsActive As Integer)\n\n        OtherFunctions.Initialize\n\n        Dim QDF As DAO.QueryDef\n\n        If FindQuery(\"InsertProject\") = True Then OtherFunctions.dbs.QueryDefs.Delete \"InsertProject\"\n\n        Set QDF = OtherFunctions.dbs.CreateQueryDef(\"InsertProject\", SQLInsertProject)\n\n        QDF.Parameters(\"@projectID\").Value = projectID\n        QDF.Parameters(\"@projectGroup\").Value = projectGroup\n        QDF.Parameters(\"@projectType\").Value = projectType\n        QDF.Parameters(\"@projectHasMilestones\").Value = projectHasMilestones\n        QDF.Parameters(\"@projectHasGantt\").Value = projectHasGantt\n        QDF.Parameters(\"@projectCategory\").Value = projectCategory\n        QDF.Parameters(\"@projectDifficulty\").Value = projectDifficulty\n        QDF.Parameters(\"@projectNotes\").Value = projectNotes\n        QDF.Parameters(\"@projectCompletionDetails\").Value = projectCompletionDetails\n        QDF.Parameters(\"@projectStatus\").Value = projectStatus\n        QDF.Parameters(\"@projectDateInProgress\").Value = ConvertDateToUnix(projectDateInProgress)\n        QDF.Parameters(\"@projectDateComplete\").Value = ConvertDateToUnix(projectDateComplete)\n        QDF.Parameters(\"@projectDateCreated\").Value = ConvertDateToUnix(Now())\n        QDF.Parameters(\"@projectDateUpdated\").Value = ConvertDateToUnix(Now())\n        QDF.Parameters(\"@projectIsActive\").Value = projectIsActive\n        QDF.Parameters(\"@projectCanceledDate\").Value = ConvertDateToUnix(projectCanceledDate)\n\n        QDF.Execute\n\n        If FindQuery(\"InsertProject\") = True Then OtherFunctions.dbs.QueryDefs.Delete \"InsertProject\"\n\n        Set QDF = Nothing\n\n    End Function\n\n</code></pre>\n\n<p>Here is where I am calling the function:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\n    'These are set in the same sub as the insert project call\n    Dim projectID As String\n    Dim CancelDate As Variant\n    Dim canceledStatus As Integer\n\n    'These are located in a different module called OtherFunctions\n    Public IDEASUGGESTION_HASGANT As Boolean\n    Public IDEASUGGESTION_HASMILESTONES As Boolean\n    Public IDEASUGGESTION_PROJECTTYPE As Integer\n\n\n    ' /\\/\\/\\ THERE IS CODE ABOVE THIS /\\/\\/\\\n        canceledStatus = 12\n    If Me.IdeaStatus = canceledStatus And DatabaseQueries.CheckIdeaSuggestion(Me.IdeaID) = True Then\n       CancelDate = Now()\n       If MsgBox(\"Are you sure you want to do this? Canceling a idea will make it un-editable.\", vbYesNo) = vbYes Then\n           GoTo IdeaCancel\n       Else\n           GoTo GotoEnd\n       End If\n    ElseIf Me.IdeaStatus = canceledStatus And DatabaseQueries.CheckIdeaSuggestion(Me.IdeaID) = False Then\n       MsgBox \"You cannot cancel an idea that does not exist.\", vbExclamation\n       CancelDate = Null\n       GoTo GotoEnd\n    Else\n       'other code run here not pertaining to the insert\n    End If\n\n    Call DatabaseQueries.InsertProject(\n         projectID, _\n         Me.IdeaGroup, _\n         OtherFunctions.IDEASUGGESTION_PROJECTTYPE, _\n         OtherFunctions.IDEASUGGESTION_HASMILESTONES, _\n         OtherFunctions.IDEASUGGESTION_HASGANT, _\n         Me.IdeaCategory, _\n         Me.IdeaDifficulty, _\n         Null, _\n         Null, _\n         Me.IdeaStatus, _\n         Me.IdeaInprogressDate, _\n         Me.IdeaCompleteDate, _\n         CancelDate, _\n         1)\n\n    ' \\/\\/\\/ THERE IS CODE BELOW THIS \\/\\/\\/\n\n</code></pre>\n\n<p>When I am running this, these are the form values:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\n    Me.ideaID = Null\n    Me.IdeaGroup = 1\n    Me.IdeaCategory = 2\n    Me.IdeaDifficulty = 1\n    Me.IdeaStatus = 1\n    Me.IdeaInprogressDate = Null\n    Me.IdeaCompleteDate = Null\n    OtherFunctions.IDEASUGGESTION_PROJECTTYPE = 1\n    OtherFunctions.IDEASUGGESTION_HASMILESTONES = False\n    OtherFunctions.IDEASUGGESTION_HASGANT = False\n\n</code></pre>\n\n<p>The Table structure is:</p>\n\n<pre><code>    Column Name                 Data Type   Can be Null\n    project_id                  varchar(45) No\n    project_group               int         No\n    project_projecttype         int         No\n    project_hasmilestones       bit         No\n    project_hasgantt            bit         No\n    project_category            int         No\n    project_difficulty          int         No\n    project_notes               text        Yes\n    project_completiondetails   text        Yes\n    project_statuscode          int         No\n    project_inprogressdate      bigint      Yes\n    project_completeddate       bigint      Yes\n    project_datecreated         bigint      No\n    project_lastupdated         bigint      No\n    project_canceleddate        bigint      Yes\n    project_isActive            int         No\n</code></pre>\n\n<p>My apologies for the wall of code blocks. </p>\n\n<p>If anyone knows why or can figure out why this error is happening I would be very grateful.</p>\n\n<p>UPDATE 4/24/19 11:10 AM PST: Based on commends from HansUp I created an alternate insert method using the RST.AddNew method <a href=\"https://stackoverflow.com/a/20332327/7442012\">More details can be found here</a>. After doing this I found that the variable that is causing grief is projectCanceledDate in the InsertProject function. Only issue is I don't know why, the variable is defined as a Variant.</p>\n\n<p>UPDATE 4/24/19 11:43 AM PST: After doing some more testing. I have discovered that I am able to insert and update NULL values for project_cancleddate inside of the Microsoft SQL Server Management Studio.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 1, "creation_date": 1556143655, "post_id": 55834650, "comment_id": 98342245, "body": "Cross-posted and answered at: <a href=\"https://www.excelforum.com/excel-programming-vba-macros/1273563-copy-data-to-word-with-cell-value-and-cell-colour.html#post5108700\" rel=\"nofollow noreferrer\">excelforum.com/excel-programming-vba-macros/&hellip;</a>. For cross-posting etiquette, please read: <a href=\"http://www.excelguru.ca/content.php?184\" rel=\"nofollow noreferrer\">excelguru.ca/content.php?184</a>. Also, your code <i>DOES NOT</i> delete any bookmarks."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 7851952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c102e5b939211543abb3b92fdfcd983b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Ellis", "link": "https://stackoverflow.com/users/7851952/chris-ellis"}, "edited": false, "score": 0, "creation_date": 1556124658, "post_id": 55834861, "comment_id": 98334507, "body": "Thanks Tim. My current code is assigned to a Command Button, so could I do the same with the code you have posted above?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1556125371, "last_edit_date": 1556125371, "creation_date": 1556124032, "answer_id": 55834861, "question_id": 55834650, "link": "https://stackoverflow.com/questions/55834650/my-current-code-deletes-bookmarks-in-word-is-there-a-way-to-keep-the-bookmarks/55834861#55834861", "title": "My current code deletes bookmarks in word, is there a way to keep the bookmarks?", "body": "<p>I've used this in the past:</p>\n\n<pre><code>'Replace the text in a bookmark or insert text into an empty (zero-length) bookmark\nSub SetBookmarkText(oDoc As Word.Document, sBookmark As String, sText As String)\n\n    Dim BMRange As Word.Range\n\n    If oDoc.Range.Bookmarks.Exists(sBookmark) Then\n      Set BMRange = oDoc.Range.Bookmarks(sBookmark).Range\n      BMRange.Text = sText\n      oDoc.Range.Bookmarks.Add sBookmark, BMRange\n    Else\n      MsgBox \"Bookmark '\" &amp; sBookmark &amp; \"' not found in document '\" &amp; oDoc.Name &amp; \"'\" &amp; _\n              vbCrLf &amp; \"Content not updated\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>    Dim ws As Worksheet, doc as object\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet6\")\n\n    Set objWord = CreateObject(\"Word.Application\")\n\n    objWord.Visible = True\n\n    Set doc = objWord.Documents.Open(\"C:\\GR1 CPA Test1.docx\")\n\n    SetBookmarkText doc, \"CN1\", ws.Range(\"C25\").Value\n    SetBookmarkText doc, \"CN2\", ws.Range(\"C25\").Value\n    'etc etc\n\n    doc.Save\n    doc.Close\n    Set objWord = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7851952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c102e5b939211543abb3b92fdfcd983b?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Ellis", "link": "https://stackoverflow.com/users/7851952/chris-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1556125371, "creation_date": 1556123198, "question_id": 55834650, "link": "https://stackoverflow.com/questions/55834650/my-current-code-deletes-bookmarks-in-word-is-there-a-way-to-keep-the-bookmarks", "title": "My current code deletes bookmarks in word, is there a way to keep the bookmarks?", "body": "<p>I have a code which copies data from a spreadsheet into specific bookmarks on a particular document. When it is run it works fine, but the bookmarks are deleted from the spreadsheet. Is there a way I can keep the bookmarks in the document</p>\n\n<pre><code>Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet6\")\n\n    Set objWord = CreateObject(\"Word.Application\")\n\n    objWord.Visible = True\n\n    objWord.Documents.Open \"C:\\GR1 CPA Test1.docx\" ' change as required\n\n    With objWord.ActiveDocument\n        .Bookmarks(\"CN1\").Range.Text = ws.Range(\"C25\").Value\n        .Bookmarks(\"CN2\").Range.Text = ws.Range(\"C25\").Value\n        .Bookmarks(\"CNo\").Range.Text = ws.Range(\"C26\").Value\n        .Bookmarks(\"CL1\").Range.Text = ws.Range(\"C27\").Value\n        .Bookmarks(\"Ex1\").Range.Text = ws.Range(\"C28\").Value\n        .Bookmarks(\"Ex2\").Range.Text = ws.Range(\"C28\").Value\n        .Bookmarks(\"Su1\").Range.Text = ws.Range(\"C29\").Value\n        .Bookmarks(\"Su2\").Range.Text = ws.Range(\"C29\").Value\n        .Bookmarks(\"Su3\").Range.Text = ws.Range(\"C29\").Value\n\n    .Save\n    .Close\n\n    End With\n\n    Set objWord = Nothing\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listobject"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8821445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-omNWPMM2W-E/AAAAAAAAAAI/AAAAAAAAASU/vysGUbXbLiM/photo.jpg?sz=128", "display_name": "Eric Lendrum", "link": "https://stackoverflow.com/users/8821445/eric-lendrum"}, "is_accepted": false, "score": 0, "last_activity_date": 1556135126, "creation_date": 1556135126, "answer_id": 55837497, "question_id": 55834462, "link": "https://stackoverflow.com/questions/55834462/problem-with-update-function-on-a-listobject/55837497#55837497", "title": "Problem with Update function on a ListObject", "body": "<p>Ok, so them answer seems to be that I need a local variable to pass the value of the userForm controls thru. When I used the listObjects .Add function and passed data durectly from the controls(TextBoxs) it works great. But, When Updating if I pass values directly from the control it invokes the listbox's _Click() event function. If I 'Dim myArg1 As Variant' and assign the controls value to it and them when updating the ListObject Cell value from that, presto it takes the value with no issues. I'm note sure why this works, but, I get to code on! I hate my answer more than I hated my problem. I spent days on trouble shooting this issue before deciding to post it. My Answer is not very elegant but it seems to be functional. Thanks for reading.  </p>\n"}], "owner": {"reputation": 1, "user_id": 8821445, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-omNWPMM2W-E/AAAAAAAAAAI/AAAAAAAAASU/vysGUbXbLiM/photo.jpg?sz=128", "display_name": "Eric Lendrum", "link": "https://stackoverflow.com/users/8821445/eric-lendrum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556135126, "creation_date": 1556122475, "last_edit_date": 1556124084, "question_id": 55834462, "link": "https://stackoverflow.com/questions/55834462/problem-with-update-function-on-a-listobject", "title": "Problem with Update function on a ListObject", "body": "<p>This is was supposed to be a prof of concept, I have a much larger project with the same issue and have retied different approaches and always end up with the same results. I was creating additional errors in my main code so I wrote this to test myself on the functionality of what I am doing. So just a heads up, I am coming back into programming after a 8 Year stint doing Engineering/Tech Stuff in the field. And therefor I am making some Newbie mistakes again. I need help seeing my error.</p>\n\n<p>When I attempt to update the .Value of a Cell in a listObject it evokes a  event function on the UserForm.</p>\n\n<p>To explain a bit more:</p>\n\n<p>I have a table - Table1 with ID|Arg1|Arg2|Arg3|Arg4</p>\n\n<p>I put a simple Int in ID ie 1, and simple text(string) Data in Arg1-Arg4 ie Test1, Data1, Data2, Data3</p>\n\n<p>I created a Simple UserForm1(Default Name) to put a listBox and 4 TextBoxes</p>\n\n<p>I have a Function ListBox1_Click() that populates the UserFrom1 Textboxes with the data from the ListObject(Table1). This function works just fine.</p>\n\n<p>I also have a function that Updates the ListObject(Table1).\nHere is the Problem. When you reference the ListObject(Table1)'s Cell Value to change it, Then ListBox1_Click() Event Function gets evoked and my TextBoxes Revert. I have Destructers for the my Object that I 'Set', But I have no idea why/how the function is called.</p>\n\n<pre><code>Private Sub cbUpdate_Click()\n\n    Dim myListObj As ListObject\n    Dim myRange As Range\n\n    Set myListObj = ActiveSheet.ListObjects(\"Table1\")\n    Set myRange = myListObj.ListColumns(1).DataBodyRange.Find(What:= _ \n      Trim(Me.ListBox1), SearchDirection:=xlNext, MatchCase:=False)\n\n    myRange.Offset(, 1).Value = Me.tbArg1\n    myRange.Offset(, 2).Value = Me.tbArg2\n    myRange.Offset(, 3).Value = Me.tbArg3\n    myRange.Offset(, 4).Value = Me.tbArg4\n\n    Set myRange = Nothing\n    Set myListObj = Nothing\nEnd Sub\n\nPrivate Sub ListBox1_Click()\n\n    Dim myListObj As ListObject\n    Dim myRange As Range\n\n    Set myListObj = ActiveSheet.ListObjects(\"Table1\")\n    Set myRange = myListObj.ListColumns(1).DataBodyRange.Find(What:= _ \n      Trim(Me.ListBox1), SearchDirection:=xlNext, MatchCase:=False)\n\n    Me.tbArg1 = myRange.Offset(, 1).Value\n    Me.tbArg2 = myRange.Offset(, 2).Value\n    Me.tbArg3 = myRange.Offset(, 3).Value\n    Me.tbArg4 = myRange.Offset(, 4).Value\n\n    Set myRange = Nothing\n    Set myListObj = Nothing\nEnd Sub\n</code></pre>\n\n<p>I need to understand how to get the ListObject(Table1) Cells to receive updated values without evoking uncalled functions/Methods.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1556121819, "post_id": 55834227, "comment_id": 98333060, "body": "Please show your code.  There are numerous ways to go about this and to go through that explanation exercise would be subjective leading to closure of your post; the goal is to provide an objective answer to your particular issue."}, {"owner": {"reputation": 11, "user_id": 5337024, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206413058958279/picture?type=large", "display_name": "hammer4", "link": "https://stackoverflow.com/users/5337024/hammer4"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556122290, "post_id": 55834227, "comment_id": 98333329, "body": "Code added. The value variable is a object property."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1556122715, "post_id": 55834227, "comment_id": 98333540, "body": "Let value.  What is the type of value.  Also, the .value method of excel is not guaranteed to return a number"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1556128875, "post_id": 55834227, "comment_id": 98336408, "body": "Would help to also show the class code for <code>DailyTotal</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556128964, "post_id": 55834227, "comment_id": 98336441, "body": "<code>Dim val as double</code> then <code>val = ws.Range(cellAddress).Offset(27, colOffset).value</code> should pull the number, unless there is an error where the value is non-numeric... in regard to ensuring a value is there, use <code>IsNumber()</code> to check (returns boolean)"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556129065, "post_id": 55834227, "comment_id": 98336487, "body": "In general, your post is relatively cryptic, where the new info we get leads to more questions... would you please try to provide some more context around what is being presented, while presenting with adequate transparency (it is understood that some items may not be appropriate for a public forum, however we need enough to work with)."}, {"owner": {"reputation": 11, "user_id": 5337024, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206413058958279/picture?type=large", "display_name": "hammer4", "link": "https://stackoverflow.com/users/5337024/hammer4"}, "edited": false, "score": 0, "creation_date": 1556188848, "post_id": 55834227, "comment_id": 98356755, "body": "Problem solved. The DailyTotal Get value property was set as string, though the field f_value which this property returns is set to double. After changing the property type to double it behaves correctly."}], "owner": {"reputation": 11, "user_id": 5337024, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206413058958279/picture?type=large", "display_name": "hammer4", "link": "https://stackoverflow.com/users/5337024/hammer4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556122204, "creation_date": 1556121713, "last_edit_date": 1556122204, "question_id": 55834227, "link": "https://stackoverflow.com/questions/55834227/saving-a-decimal-number-to-a-cell-gives-unwanted-result", "title": "Saving a decimal number to a cell gives unwanted result", "body": "<p>I read a double from one sheet, store it in a Double variable and write this variable as a .Value2 in another sheet. The used decimal separator in excel and system is \",\" comma. When the number has less than 3 digits after the decimal separator the result in the destination sheet is ok. If there are three digits the problem shows up. The destination sheet does not have any \ncells formatting.</p>\n\n<p>Examples:</p>\n\n<pre><code>120 -&gt; 120 OK\n12,2 -&gt; 12,2 OK\n1,22 -&gt; 1,22 OK\n120,233 -&gt; 120 233 Bad\n</code></pre>\n\n<p>This is how I save the value:</p>\n\n<pre><code>Let value = ws.Range(cellAddress).Offset(27, colOffset).value\n\nSet element = New DailyTotal\nelement.Init name, EIC, value\n</code></pre>\n\n<p>And this is how I write it to the destination:</p>\n\n<pre><code>ws.Cells(targetRow, targetCol).Value2 = el.value\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556121426, "post_id": 55833933, "comment_id": 98332836, "body": "Does your current formula work?  That&#39;s a significant point missing from your post.  Regarding the discussion of &quot;if VBA is a better option,&quot; that would be subjective and leading this post to be Closed due to being <code>Too Broad</code>.  Please ask objective questions, preferably related to issues in your specific coding example."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556126267, "post_id": 55833933, "comment_id": 98335208, "body": "Looks like you just need to remove the <code>INDEX</code> function in that formula."}, {"owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556180658, "post_id": 55833933, "comment_id": 98352028, "body": "Thanks Tiger but that doesn&#39;t work - that means it doesn&#39;t return anything."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556180553, "post_id": 55838756, "comment_id": 98351960, "body": "No i tried this. Returns a &quot;N&quot; when it should return a &quot;Y&quot;"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "reply_to_user": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556242210, "post_id": 55838756, "comment_id": 98380189, "body": "It worked for me, even when the strings in &#39;broking&#39; were substrings of the items in the cell."}], "tags": [], "owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "is_accepted": false, "score": 0, "last_activity_date": 1556140972, "creation_date": 1556140972, "answer_id": 55838756, "question_id": 55833933, "link": "https://stackoverflow.com/questions/55833933/interrogating-a-cell-to-see-whether-any-of-the-strings-are-present-in-a-referenc/55838756#55838756", "title": "Interrogating a cell to see whether any of the strings are present in a reference table", "body": "<p>If your 'broking' is a Named Range, you can use this formula\nI'm interrogating cell 'C2' here</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(broking, C2)), \"Y\",\"N\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556199445, "post_id": 55848156, "comment_id": 98363081, "body": "I&#39;m not sure- I&#39;m having difficulty getting it to reference the Rows in the Broking sheet rather than the current sheet. I&#39;ve tried the usual but it&#39;s not liking it."}, {"owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "reply_to_user": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556204511, "post_id": 55848156, "comment_id": 98366428, "body": "Can you give examples of the content of the cells to interrogate, and of the text strings in the reference table? And what should match or not match? Also, you have used the &quot;vba&quot; tag, have you tried a vba code? if so, can you show us the code and where exactly it doesn&#39;t work?"}, {"owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556263366, "post_id": 55848156, "comment_id": 98385649, "body": "Hi Panda, I used VBA to simply enter the formula and copy it down to the last row. Thats easy enough and that bit works. Example of a cell: &quot;John, Tim Doug Jim&quot;, Table is simply a list of all the broker names in a column &quot;Hardy, Doug, Jim&quot;. I&#39;m trying to get it to return a Y if the cells contains one of the names in the broker name table"}, {"owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "reply_to_user": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556271713, "post_id": 55848156, "comment_id": 98389849, "body": "I don&#39;t see how to do this with a formula. However, I will edit my answer with a vba code that seems to do the job. Just let me know whether it works for you."}], "tags": [], "owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "is_accepted": true, "score": 1, "last_activity_date": 1556272580, "last_edit_date": 1556272580, "creation_date": 1556191509, "answer_id": 55848156, "question_id": 55833933, "link": "https://stackoverflow.com/questions/55833933/interrogating-a-cell-to-see-whether-any-of-the-strings-are-present-in-a-referenc/55848156#55848156", "title": "Interrogating a cell to see whether any of the strings are present in a reference table", "body": "<p>Here is the code, with some clarification in comment (example of data below) :</p>\n\n<pre><code>Sub StringsAttached()\n    ' looks in each cell in sheet \"Base\" col A for any names in sheet \"Broking\"\n    ' if found, writes 'Y' in sheet \"Base\" col B, 'N' if not found\n\n    Dim TotalRows As Long       ' last row in sheet \"Base\"\n    Dim StrToFind As Variant    ' will be an array\n    Dim i As Integer            ' to iterate on each row of sheet \"Base\"\n    Dim strToCheck As String    ' string to check\n    Dim item As Variant         ' string from sheet \"Broking\"\n    Dim ispresent As Integer    ' result of InStr (search in string)\n\n    TotalRows = Sheets(\"Base\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    StrToFind = Worksheets(\"Broking\").Range(\"A2:A6\") ' range with brokers names\n\n    For i = 2 To TotalRows  ' Loop 1: iterates each row, omitting heading row (1)\n        strToCheck = Sheets(\"Base\").Range(\"A\" &amp; i)\n        For Each item In StrToFind  ' Loop 2: look for each broker names in turn\n            ispresent = InStr(strToCheck, item)  ' search in string\n            If ispresent &lt;&gt; 0 Then\n                Sheets(\"Base\").Range(\"B\" &amp; i) = \"Y\"\n                GoTo exitWhenFound  ' when one name is found, exit Loop 2\n            Else\n                Sheets(\"Base\").Range(\"B\" &amp; i) = \"N\"\n            End If\n        Next item\nexitWhenFound:\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>I have two sheets in a workbook, \"Base\" and \"Broking\".</p>\n\n<p>In \"Base\", the table looks like this :</p>\n\n<pre><code>Strings to check            Yes or No\nJohn, Paul, George, Ringo   Y\nHarry, Hermione, Ron        N\nDoug, Vanessa, Jim, Claire  Y\nVanessa, Claire             N\nOrnella, Renzo, Alberto     N\nRenzo, Ornella              N\nTim, Bruno, Doug            Y\nMary, Renzo                 Y\nJean, Pierre, Donald        N\nJim, Jean, Bruno            Y\nRenzo, Mike Johnson         Y\nOrnella, Mike Smith         N\n</code></pre>\n\n<p>And in sheet \"Broking\" :</p>\n\n<pre><code>Names\nDoug\nJim\nMary\nJohn\nMike Johnson\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 55848156, "answer_count": 2, "score": 0, "last_activity_date": 1556272580, "creation_date": 1556120646, "last_edit_date": 1556185693, "question_id": 55833933, "link": "https://stackoverflow.com/questions/55833933/interrogating-a-cell-to-see-whether-any-of-the-strings-are-present-in-a-referenc", "title": "Interrogating a cell to see whether any of the strings are present in a reference table", "body": "<p><strong>Background:</strong> I'm trying to Interrogate a cell to see whether any of the text strings (Names) within it are present in a reference table of text strings (Names) in another sheet. </p>\n\n<p>I want to then return a Y or N depending on if any of the table strings are found in the cell</p>\n\n<p><em>Note:</em> Broking is a list i created which is the reference table.</p>\n\n<p><strong>Current problem:</strong></p>\n\n<p>It's pulling the found name from the string but i can't work how to add an expression that simply returns \"Y\" or \"N\" based on whether one of the strings in table is present in the cell</p>\n\n<p>I've tried:</p>\n\n<pre><code>=IF(INDEX(Broking,SUMPRODUCT(ISNUMBER(SEARCH(Broking,AE7))*ROW($2:$8)),\"Y\", \"N\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot"], "comments": [{"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "edited": false, "score": 0, "creation_date": 1556121157, "post_id": 55833821, "comment_id": 98332682, "body": "All the &quot;calls&quot;, they just change the color of the graph btw"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556122261, "post_id": 55833821, "comment_id": 98333320, "body": "Which line do you get the error on? for all buttons. Also, you said it works on the second click of &quot;All Year&quot;. If you click a specific year button twice in a row, does it also work on the second click?"}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556125238, "post_id": 55833821, "comment_id": 98334780, "body": "Ok, so I would have click on &quot;All Year&quot; first. Even if the first click there an error. But after that click, ALL of the buttons works. Just figured that out"}, {"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556125285, "post_id": 55833821, "comment_id": 98334806, "body": "So the lines starting with &quot;For Each pf In pt.DataFields  If pf.Name &lt;&gt; &quot;Values&quot; Then    pf.Orientation = xlHidden  End If  Next pf&quot; It would skip this whole code really since nothing would happen. But it would say the error would be &quot;ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;Sum of &quot; &amp; SField).Caption = &quot;Year &quot; &amp; SField&quot;"}], "owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556129649, "creation_date": 1556120234, "last_edit_date": 1556129649, "question_id": 55833821, "link": "https://stackoverflow.com/questions/55833821/macro-button-only-work-on-the-second-click", "title": "Macro Button only work on the second click", "body": "<p>So I created a pivot table and buttons for it. Each button represents a field that will go into the value part of the pivot table. \nEach of those fields is the years 2016, 2017, 2018, and 2019. I also created a button to represent all the years at once too. \nI also apply slicer for the other fields and filters. \n-for the filter, I would just copy the pivot table and put the selected field in the filter tab of the pivot table. (Hope that makes sense) </p>\n\n<p>I want to know why is it that when I first launch the excel. None of the buttons works. It only works if I click on the \"All Year\" button the second time, meaning the first time it says that object not found. But the second time I clicked it, it would work like normal. All the other buttons would work too.</p>\n\n<p>This problem occurs once I added in the filter for the slicers. </p>\n\n<pre><code>Sub Add_Value_MasterCode()\n\nDim pt As PivotTable\nDim pf As PivotField\nDim SField As String\n\n'Set Variable\n Set pt = ActiveSheet.PivotTables(1)\n SField = ActiveSheet.Shapes(Application.Caller).TextFrame.Characters.Text\n\n\n'Remove Existing Fields\nFor Each pf In pt.DataFields\nIf pf.Name &lt;&gt; \"Values\" Then\n    pf.Orientation = xlHidden\nEnd If\nNext pf\n\n'Add fields that button was clicked for\npt.PivotFields(SField).Orientation = xlDataField\n\n'Set title and color for each fields\nActiveSheet.ChartObjects(\"Chart 1\").Chart.ChartTitle.Text = SField &amp; \" Revenue\"\nActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Sum of \" &amp; SField).Caption = \"Year \" &amp; SField\nIf SField = \"2016\" Then\n    Call year2016\nElseIf SField = \"2017\" Then\n    Call year2017\nElseIf SField = \"2018\" Then\n    Call year2018\nElseIf SField = \"2019\" Then\n    Call year2019\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This is the other code.</p>\n\n<pre><code>Sub Add_All()\n\n\nDim pt As PivotTable\nDim pf As PivotField\nDim SField As String\n\n'Set Variable\nSet pt = ActiveSheet.PivotTables(1)\nSField = ActiveSheet.Shapes(Application.Caller).TextFrame.Characters.Text\n\n'Remove Existing Fields\nFor Each pf In pt.DataFields\nIf pf.Name &lt;&gt; \"Values\" Then\n    pf.Orientation = xlHidden\nEnd If\nNext pf\n\nWith ActiveSheet.PivotTables(\"pivottable1\")\n            .AddDataField ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"2016\"), \"Year 2016\", xlSum\n            .AddDataField ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"2017\"), \"Year 2017\", xlSum\n            .AddDataField ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"2018\"), \"Year 2018\", xlSum\n            .AddDataField ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"2019\"), \"Year 2019\", xlSum\nEnd With\n\n\nActiveSheet.ChartObjects(\"Chart 1\").Chart.ChartTitle.Text = \"All Years Revenue\"\n\nEnd Sub\n</code></pre>\n\n<p>It seems like it not reading the code</p>\n\n<pre><code> For Each pf In pt.DataFields\n If pf.Name &lt;&gt; \"Values\" Then\n   pf.Orientation = xlHidden\n End If\n Next pf\n</code></pre>\n\n<p>Until I clicked on \"All Year\" for the second time.</p>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556121186, "post_id": 55833588, "comment_id": 98332702, "body": "Sorry I should&#39;ve been clearer. what I&#39;m trying to do is copy the dates from each columns in array B30:B, E30:E, H30:H, K30:K, N30:N  in &quot;wsCopy&quot; and paste it all in column C the &quot;wsDest&quot;. is that possible? @P\u1d07\u029c"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556121540, "post_id": 55833588, "comment_id": 98332894, "body": "@thanh1211 See my edit. Note that <code>Col</code> contains the column name like <code>&quot;B&quot;</code> \u2026"}, {"owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556131452, "post_id": 55833588, "comment_id": 98337561, "body": "thank you! it work! I have one more question.... is there a way to do the same exact thing where it populate column C but this time populate column H with a different data along with it?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "edited": false, "score": 0, "creation_date": 1556137338, "post_id": 55833588, "comment_id": 98339977, "body": "The range in column H (same rows as populated in column C) would be <code>wsDest.Range(&quot;H&quot; &amp; lDestLastRow, &quot;H&quot; &amp; lDestLastRow + lCopyLastRow - 29)</code> just populate your data there"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1556121484, "last_edit_date": 1556121484, "creation_date": 1556119440, "answer_id": 55833588, "question_id": 55833438, "link": "https://stackoverflow.com/questions/55833438/copy-and-paste-to-the-next-cell-using-a-loop-with-the-datas-in-different-columns/55833588#55833588", "title": "copy and paste to the next cell using a loop with the datas in different columns", "body": "<p>Here is an example how to loop through columns</p>\n\n<pre><code>Dim CopyColumns() As Variant\nCopyColumns = Array(\"B\", \"E\", \"H\", \"K\", \"N\")\n\nDim Col As Variant\nFor Each Col In CopyColumns\n\n    lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"C\").End(xlUp).Offset(1).Row\n    lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, Col).End(xlUp).Row\n\n    wsCopy.Range(Col &amp; \"30:\" &amp; Col &amp; lCopyLastRow).Copy\n    wsDest.Range(\"C\" &amp; lDestLastRow).PasteSpecial xlPasteValues\n\nNext Col\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11380470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1745625a7994ca79f7ea0db10de54392?s=128&d=identicon&r=PG&f=1", "display_name": "thanh1211", "link": "https://stackoverflow.com/users/11380470/thanh1211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 55833588, "answer_count": 1, "score": 0, "last_activity_date": 1556121484, "creation_date": 1556118980, "last_edit_date": 1556119059, "question_id": 55833438, "link": "https://stackoverflow.com/questions/55833438/copy-and-paste-to-the-next-cell-using-a-loop-with-the-datas-in-different-columns", "title": "copy and paste to the next cell using a loop with the datas in different columns", "body": "<p>Hi I'm fairly new to VBA and I want to loop this code. as of right now this code is copying data in Range (\"B30:B\") from the \"Ba Pricing\" to the destination worksheet and it will copy the same data to the last cell. What I wanted this to do is loop this code where it will copy the data in columns (E, H, K and N) and paste it to last cell of the \"Loader\" worksheet. with the condition if there is no data in each column then don't copy.</p>\n\n<p>Thanks    </p>\n\n<pre><code>Sub Copy_Paste_Below_Last_Cell()\n'Find the last used row in both sheets and copy and paste data below existing data.\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lCopyLastRow As Long\nDim lDestLastRow As Long\n\n  'Set variables for copy and destination sheets\n  Set wsCopy = ThisWorkbook.Worksheets(\"Ba pricing\")\n  Set wsDest = ThisWorkbook.Worksheets(\"Loader\")\n\n  '1. Find last used row in the copy range based on data in column A\n  lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, \"B\").End(xlUp).Row\n\n  '2. Find first blank row in the destination range based on data in column A\n  'Offset property moves down 1 row\n  lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"C\").End(xlUp).Offset(1).Row\n\n  '3. Copy &amp; Paste Data\n  wsCopy.Range(\"B30:B\" &amp; lCopyLastRow).Copy\n    wsDest.Range(\"C\" &amp; lDestLastRow).PasteSpecial xlPasteValues\n\n\nEnd Sub\n</code></pre>\n\n<p>It should look something like this...</p>\n\n<pre><code>PriceDate\n4/23/2019\n4/24/2019\n4/25/2019\n4/26/2019\n4/27/2019\n4/28/2019\n4/29/2019\n4/30/2019\n5/1/2019\n5/2/2019\n5/3/2019\n5/4/2019\n5/5/2019\n5/6/2019\n5/7/2019\n5/8/2019\n5/9/2019\n5/10/2019\n5/11/2019\n5/12/2019\n5/13/2019\n5/14/2019\n5/15/2019\n5/16/2019\n4/23/2019\n4/24/2019\n4/25/2019\n4/26/2019\n4/27/2019\n4/28/2019\n4/29/2019\n4/30/2019\n5/1/2019\n5/2/2019\n5/3/2019\n5/4/2019\n5/5/2019\n5/6/2019\n4/23/2019\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1556120096, "post_id": 55833050, "comment_id": 98332069, "body": "I&#39;ve had a similar issue, and it turn out to be a piece of javascript handling that drop down selection. Calling the javascript was the solution for me, maybe it points you in the right direction? Here is the shortened code I&#39;ve used: <code>IE.Navigate &quot;javascript:NewItem(&#39;\\....\\u002520Validation\\u002520Reports\\&zwnj;&#8203;u002fForms\\u002fUplo&zwnj;&#8203;ad.aspx?....\\u002520&zwnj;&#8203;Validation\\u002520Re&zwnj;&#8203;ports\\u0026Type=1&#39;)&quot;</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556122899, "post_id": 55833050, "comment_id": 98333636, "body": "is the url public?"}, {"owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556126625, "post_id": 55833050, "comment_id": 98335376, "body": "@ DarXyde: Thank you for the comments. Anything that led you to the javascript, was there anything in the tag information or maybe the header?"}, {"owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556126677, "post_id": 55833050, "comment_id": 98335395, "body": "@QHarr: Thank you no the url is not public it is hosted intranet and is part of the Remedy system"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1556126809, "post_id": 55833050, "comment_id": 98335472, "body": "I&#39;m gonna post something to try in a sec"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556147208, "post_id": 55835595, "comment_id": 98343104, "body": "Thank you I was hopeful this would work as this code is new approach. unfortunately it did not   Dim myHTMLFrame2 As HTMLDocument     Set myHTMLFrame2 = HTMLDoc.frames(3).document     Dim dropdown As Object, onChange As Object     Set dropdown = myHTMLFrame2.querySelector(&quot;select[overwrite=&#39;1&#39;]&quot;)     Set onChange = myHTMLFrame2.createEvent(&quot;htmlevents&quot;)     onChange.initEvent &quot;change&quot;, True, False     myHTMLFrame2.document.querySelector(&quot;[value=&#39;New User(s)&#39;]&quot;).Selected = True     Links.dispatchEvent onChange (this resulted in an object not supported)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556147453, "post_id": 55835595, "comment_id": 98343143, "body": "please post the exact error message and the line it occurs on"}, {"owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556204555, "post_id": 55835595, "comment_id": 98366457, "body": "Dim dropdown As Object, onChange As Object    Set dropdown = myHTMLFrame2.querySelector(&quot;select[overwrite=&#39;1&#39;]&quot;)    Set onChange = myHTMLFrame2.document.createEvent(&quot;htmlevents&quot;)   &#39;document results in &quot;object doesn&#39;t support this property or method&quot; removed document then no error    onChange.initEvent &quot;change&quot;, True, False    myHTMLFrame2.querySelector(&quot;[value=&#39;New User(s)&#39;]&quot;).Selected = True    Links.dispatchEvent onChange   &#39;error &quot;object required&quot; so I changed to   myHTMLFrame2.Links.dispatchEvent onChange   &#39;Above line error &quot;object doesn&#39;t support this property or method&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556205210, "post_id": 55835595, "comment_id": 98366877, "body": "This line myHTMLFrame2.querySelector(&quot;[value=&#39;New User(s)&#39;]&quot;).Selected = True  is producing the error?"}, {"owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556207644, "post_id": 55835595, "comment_id": 98368238, "body": "Set onChange = myHTMLFrame2.document.createEvent(&quot;htmlevents&quot;)     &#39;document results in error &quot;object doesn&#39;t support this property or method&quot; removed document then no error   Set onChange = myHTMLFrame2.createEvent(&quot;htmlevents&quot;)  Links.dispatchEvent onChange   &#39;error &quot;object required&quot; so I changed to   myHTMLFrame2.Links.dispatchEvent onChange   &#39;Above line error &quot;object doesn&#39;t support this property or method&quot;"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1556127025, "creation_date": 1556127025, "answer_id": 55835595, "question_id": 55833050, "link": "https://stackoverflow.com/questions/55833050/select-option-using-excel-automation-with-internet-explorer/55835595#55835595", "title": "Select option using Excel Automation with Internet explorer", "body": "<p>You could try attaching an event to the select element. I have targeted using tag and attribute in case id is dynamic. If id static then use that. If it is inside the iframe then add the appropriate syntax in front to access.</p>\n\n<pre><code>Dim dropDown As Object, onChange As Object\nSet dropDown = ie.document.querySelector(\"select[overwrite='1']\")\nSet onChange = ie.document.createEvent(\"htmlevents\")\nonChange.initEvent \"change\", True, False\nie.document.querySelector(\"[value='New User(s)']\").Selected = True\nlinks.dispatchEvent onChange\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556203596, "post_id": 55840664, "comment_id": 98365810, "body": "thanks but nothing happens  myHTMLFrame2.getElementById(&quot;QSGAA5V0GAFRWAOL34D8OK78W2ZUJO&quot;&zwnj;&#8203;).Value = &quot;New User(s)&quot;"}, {"owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "reply_to_user": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "edited": false, "score": 0, "creation_date": 1556611210, "post_id": 55840664, "comment_id": 98487019, "body": "I suggest you to first check that your object for HTML document is properly assigned  and it refers to the correct page. after that you can try to find the element in document."}], "tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 0, "last_activity_date": 1556156268, "creation_date": 1556156268, "answer_id": 55840664, "question_id": 55833050, "link": "https://stackoverflow.com/questions/55833050/select-option-using-excel-automation-with-internet-explorer/55840664#55840664", "title": "Select option using Excel Automation with Internet explorer", "body": "<p>Try to make test with code below may help to solve the issue.</p>\n\n<p>Code:</p>\n\n<pre><code>     Sub demo()\n\n            Dim URL As String\n            Dim IE As Object\n\n            Set IE = CreateObject(\"InternetExplorer.Application\")\n\n            IE.Visible = True\n\n            URL = \"C:\\Users\\Administrator\\Desktop\\107.html\"\n\n            IE.Navigate URL\n\n            Do While IE.ReadyState = 4: DoEvents: Loop   'Do While\n            Do Until IE.ReadyState = 4: DoEvents: Loop   'Do Until\n\n             IE.Document.GetElementByID(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO\").Value = \"Modify User Details or Applications\"\n\n            Set IE = Nothing  \n\n\nEnd Sub\n</code></pre>\n\n<p>Output in IE 11:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2IbFo.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2IbFo.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "is_accepted": true, "score": 0, "last_activity_date": 1556652654, "creation_date": 1556652654, "answer_id": 55927575, "question_id": 55833050, "link": "https://stackoverflow.com/questions/55833050/select-option-using-excel-automation-with-internet-explorer/55927575#55927575", "title": "Select option using Excel Automation with Internet explorer", "body": "<p>@Qharr &amp; @Deepak -- Thank You  </p>\n\n<p>I examined the element and turns out the code creates an \"input\" element at run time. In order to execute the event I am using send keys. Not very elegant but it works.  </p>\n\n<pre><code>myHTMLFrame2.all.Item(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO_input\").Focus\nmyHTMLFrame2.all.Item(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO_input\").Value = \"New User(s)\"\nmyHTMLFrame2.all.Item(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO_input\").Click\nApplication.SendKeys \"{DOWN}\"\nApplication.SendKeys \"{DOWN}\"\nApplication.SendKeys \"~\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8833729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3737129f7ae27fa24e3eb37da65d6045?s=128&d=identicon&r=PG&f=1", "display_name": "BrownBear", "link": "https://stackoverflow.com/users/8833729/brownbear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 55927575, "answer_count": 3, "score": 1, "last_activity_date": 1556652654, "creation_date": 1556117809, "last_edit_date": 1556127104, "question_id": 55833050, "link": "https://stackoverflow.com/questions/55833050/select-option-using-excel-automation-with-internet-explorer", "title": "Select option using Excel Automation with Internet explorer", "body": "<p>I have been trying for days. I can update the value of text boxes and click on option buttons however I am unable to select the option from a drop down list</p>\n\n<p>To select the drop down option I have tried:</p>\n\n<pre><code> myHTMLFrame2.all.Item(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO\").Focus\n    myHTMLFrame2.all.Item(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO\").selectedIndex = 1\n    myHTMLFrame2.all.Item(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO\").FireEvent \"onchange\"\n</code></pre>\n\n<p>Nothing happens with the above</p>\n\n<pre><code>Dim myHTMLFrame2 As HTMLDocument\n    Set myHTMLFrame2 = HTMLDoc.frames(3).document\n    Dim elem As Object\n\n    Set elem = myHTMLFrame2.document.getElementById(\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO\")\n(results in \"object not supported error\")\n    elem.Focus\n    elem.selectedIndex = 2\n</code></pre>\n\n<p>This is the HTML Code:</p>\n\n<pre><code>&lt;div id=\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO-answer-body\"&gt;\n                    &lt;div class=\"select_holder select_jquery\"&gt;\n                        &lt;select id=\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO\" overwrite=\"1\" level=\"0\"\n                            val=\"$escapeTool.html($!{answerValue})\" required=\"true\" questionid=\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO\" totalorder=\"0\" questiondefid=\"QDGAA5V0GAFRWAOL34D8OK78W2ZUJP\"\n                            responsetype=\"STATIC_MENU\" autocomplete=\"off\"\n                            aria-activedescendant=\"\" aria-labelledby=\"QSGAA5V0GAFRWAOL34D8OK78W2ZUJO-label\" tabindex=\"0\"&gt;\n                            &lt;option value=\"\"&gt;&lt;/option&gt;\n                            &lt;option value=\"New User(s)\" ps=\"0\" aria-selected=\"false\"&gt;New User(s)&lt;/option&gt;\n                            &lt;option value=\"Modify User Details or Applications\" ps=\"1\" aria-selected=\"false\"&gt;Modify User Details or Applications&lt;/option&gt;\n                            &lt;option value=\"Add/Modify User By Attachment\" ps=\"2\" aria-selected=\"false\"&gt;Add/Modify User By Attachment&lt;/option&gt;\n                            &lt;option value=\"clear\"&gt;(clear)&lt;/option&gt;\n                        &lt;/select&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "duplicates"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556118140, "post_id": 55833040, "comment_id": 98330890, "body": "In your provided sample data, are there any duplicates?  It looks like each section would be considered unique (since the SSID #s are all different) so nothing would be deleted."}, {"owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556119951, "post_id": 55833040, "comment_id": 98331989, "body": "The duplicates I&#39;m looking for are based on the string after the &#39;:&#39; so essentially both SSID 18 : NewThermostat_552845 and SSID 11 : NewThermostat_552845 are duplicates."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1556120800, "post_id": 55833040, "comment_id": 98332479, "body": "I would probably try to do some ETL in Excel first, then if it all needs to be in VBA, replicate that in VBA. Do the column split at <code>:</code> (though that could pose a problem in certain rows, but there are ways around it), flag all your sections with a unique value in a separate column (ie the headers name), and another flag for each header row. Now you should be able to search for duplicates, and use the extra information to eliminate them... Obviously not a full proof solution, but that&#39;s what I would look at first."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556122444, "post_id": 55833040, "comment_id": 98333403, "body": "@ToddCoplien For those entries, there is a slight difference in their &quot;blocks&quot;, the <code>Signal</code> is 78% for the first one and 94% for the second.  Which one should be retained?  I&#39;m guessing only the first one since it was encountered first?"}, {"owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556123341, "post_id": 55833040, "comment_id": 98333847, "body": "@tigeravatar Yes, the signal is different based on where I was in the building when I was grabbing the data. And yes, I would like to keep the first entry only no matter the signal strength. Unless that helps parsing through the data."}, {"owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556655968, "post_id": 55833040, "comment_id": 98510041, "body": "@tigeravatar and anyone else, I have another question based on this as it has come to light that I should be keeping the duplicate that has the highest signal strength. Not sure what I was thinking. Should I ask a new question or can we add to this one? I don&#39;t mind either way! TY"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1556656785, "post_id": 55833040, "comment_id": 98510355, "body": "@ToddCoplien See updated answer."}, {"owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1559149665, "post_id": 55833040, "comment_id": 99334117, "body": "@tigeravatar sorry for not responding sooner. didn&#39;t realize you replied. thank you very much. way cleaner than what I came up! thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1556656769, "last_edit_date": 1556656769, "creation_date": 1556125361, "answer_id": 55835198, "question_id": 55833040, "link": "https://stackoverflow.com/questions/55833040/remove-duplicate-dynamic-range-keeping-first-using-split-based-on-specific-str/55835198#55835198", "title": "Remove Duplicate Dynamic Range, Keeping First, Using Split Based on Specific String", "body": "<p>Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rData As Range\n    Dim rAllRegions As Range\n    Dim rRegion As Range\n    Dim rDel As Range\n    Dim hSSID As Object\n    Dim sSSID As String\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    Set rData = ws.Range(\"A1\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp))\n    Set rAllRegions = GetAllPopulatedCells(, rData)\n    Set hSSID = CreateObject(\"Scripting.Dictionary\")\n\n    If rAllRegions Is Nothing Then\n        MsgBox \"No populated cells found in '\" &amp; ws.Name &amp; \"'. Exiting Macro.\", , \"Error\"\n        Exit Sub\n    End If\n\n    For Each rRegion In rAllRegions.Areas\n        sSSID = LCase(Trim(Split(rRegion.Cells(1).Value, \":\")(1)))\n        If Not hSSID.exists(sSSID) Then\n            hSSID.Add sSSID, sSSID\n        Else\n            If rDel Is Nothing Then Set rDel = rRegion.Resize(rRegion.Rows.Count + 1) Else Set rDel = Union(rDel, rRegion.Resize(rRegion.Rows.Count + 1))\n        End If\n    Next rRegion\n\n    If Not rDel Is Nothing Then rDel.Delete xlShiftUp\n\nEnd Sub\n\nPublic Function GetAllPopulatedCells(Optional ByRef arg_ws As Worksheet, Optional ByVal arg_rSearchRange As Range) As Range\n\n    Dim ws As Worksheet\n    Dim rSearch As Range\n    Dim rConstants As Range\n    Dim rFormulas As Range\n\n    If arg_ws Is Nothing Then Set ws = ActiveWorkbook.ActiveSheet Else Set ws = arg_ws\n    If arg_rSearchRange Is Nothing Then Set rSearch = ws.Cells Else Set rSearch = arg_rSearchRange\n\n    On Error Resume Next\n    Set rConstants = rSearch.SpecialCells(xlCellTypeConstants)\n    Set rFormulas = rSearch.SpecialCells(xlCellTypeFormulas)\n    On Error GoTo 0\n\n    Select Case Abs(rConstants Is Nothing) + 2 * Abs(rFormulas Is Nothing)\n        Case 0: Set GetAllPopulatedCells = Union(rConstants, rFormulas)\n        Case 1: Set GetAllPopulatedCells = rFormulas\n        Case 2: Set GetAllPopulatedCells = rConstants\n        Case 3: Set GetAllPopulatedCells = Nothing\n    End Select\n\n    Set ws = Nothing\n    Set rSearch = Nothing\n    Set rConstants = Nothing\n    Set rFormulas = Nothing\n\nEnd Function\n</code></pre>\n\n<p><strong>UPDATE</strong>: This version will keep only the highest signal strength blocks for each region (note you will still need the GetAllPopulatedCells function)</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rData As Range\n    Dim rAllRegions As Range\n    Dim rRegion As Range\n    Dim rDel As Range\n    Dim rTemp as Range\n    Dim hSSID As Object\n    Dim sSSID As String\n    Dim lSSIDRow as Long\n    Dim lSignalRow as Long\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    Set rData = ws.Range(\"A1\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp))\n    Set rAllRegions = GetAllPopulatedCells(, rData)\n    Set hSSID = CreateObject(\"Scripting.Dictionary\")\n    lSSIDRow = 1\n    lSignalRow = 6\n\n    If rAllRegions Is Nothing Then\n        MsgBox \"No populated cells found in '\" &amp; ws.Name &amp; \"'. Exiting Macro.\", , \"Error\"\n        Exit Sub\n    End If\n\n    For Each rRegion In rAllRegions.Areas\n        sSSID = LCase(Trim(Split(rRegion.Cells(lSSIDRow, 1).Value, \":\")(1)))\n        If Not hSSID.exists(sSSID) Then\n            Set hSSID(sSSID) = rRegion\n        Else\n            If --Trim(Split(hSSID(sSSID).Cells(lSignalRow, 1).Value, \":\")(1)) &gt; --Trim(Split(rRegion.Cells(lSignalRow, 1).Value, \":\")(1)) Then\n                Set rTemp = rRegion.Resize(rRegion.Rows.Count + 1)\n            Else\n                Set rTemp = hSSID(sSSID)\n                Set hSSID(sSSID) = rRegion\n            End If\n            If rDel Is Nothing Then Set rDel = rTemp Else Set rDel = Union(rDel, rTemp)\n        End If\n    Next rRegion\n\n    If Not rDel Is Nothing Then rDel.Delete xlShiftUp\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4528918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/767965513293486/picture?type=large", "display_name": "Todd Coplien", "link": "https://stackoverflow.com/users/4528918/todd-coplien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 55835198, "answer_count": 1, "score": 0, "last_activity_date": 1556656769, "creation_date": 1556117783, "question_id": 55833040, "link": "https://stackoverflow.com/questions/55833040/remove-duplicate-dynamic-range-keeping-first-using-split-based-on-specific-str", "title": "Remove Duplicate Dynamic Range, Keeping First, Using Split Based on Specific String", "body": "<p>I have some somewhat unique data(yes, all data is unique) that I'm trying to parse through and remove duplicate ranges but keeping the first unique range. I don't see anyway to sort the data as it is all single column but sectioned. An example of the data is below:</p>\n\n<pre><code>SSID 18 : NewThermostat_552845\nNetwork type            : Infrastructure\nAuthentication          : Open\nEncryption              : None \nBSSID 1                 : 00:d0:2d:55:28:45\n     Signal             : 78%  \n     Radio type         : 802.11n\n     Channel            : 6 \n     Basic rates (Mbps) : 1 2 5.5 6 11 12 24\n     Other rates (Mbps) : 9 18 36 48 54\n\nSSID 24 : \nNetwork type            : Infrastructure\nAuthentication          : Open\nEncryption              : None \nBSSID 1                 : f8:bb:bf:59:56:89\n     Signal             : 35%  \n     Radio type         : 802.11n\n     Channel            : 1 \n     Basic rates (Mbps) : 1 2 5.5 11\n     Other rates (Mbps) : 6 9 12 18 24 36 48 54\n\nSSID 11 : NewThermostat_552845\nNetwork type            : Infrastructure\nAuthentication          : Open\nEncryption              : None \nBSSID 1                 : 00:d0:2d:55:28:45\n     Signal             : 94%  \n     Radio type         : 802.11n\n     Channel            : 6 \n     Basic rates (Mbps) : 1 2 5.5 6 11 12 24\n     Other rates (Mbps) : 9 18 36 48 54\n</code></pre>\n\n<p>The SSID ## is the beginning of each new section. By my code below, you can see the various things I've tried. I've commented out things that didn't work but might work in a different combination. I used the MsgBox and copy/paste for debugging so that is not needed in the final code. </p>\n\n<p>Here's the code I'm working with. </p>\n\n<pre><code>'need to split the cell\ndRow = newSht.Cells(Rows.Count, \"A\").End(xlUp).Row\nSet dString = newSht.Range(\"A1:A\" &amp; dRow)\nFor Each cel In dString\n    If cel.Value Like \"SSID ## : *\" Then\n        'If cel.Value = cel.Value Then\n        theSplit = Split(cel.Value, \":\")(0)(1)\n        'If theSplit(1) = theSplit(1) Then\n        If theSplit(0) Like theSplit(-1) Then 'And cel.Value(0) = cel.Value(0) Then\n            'cel.Value(1).Copy\n            'Range(\"F1\").PasteSpecial Paste:=xlPasteValues\n            MsgBox cel.Value\n\n            'Range(cel, cel.End(xlDown)).Delete\n            'cel.Value(1).Copy Range(\"F1\")\n            'Range(cel, cel.End(xlDown)).Delete\n        End If\n    End If\n    'End If\nNext cel\n</code></pre>\n\n<p>I'm thinking the best approach is to split each instance of SSID ## at the : sign. Then if any of the 2nd part of the string matches, delete the range from SSID ## down to the blank cell. Currently my code deletes everything! Thanks in advance for your insight! Much appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556118318, "post_id": 55832845, "comment_id": 98330998, "body": "Why not save it without, and then rename the file (use the <code>Name</code> instruction)"}, {"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1556125604, "post_id": 55832845, "comment_id": 98334942, "body": "It&#39;s discussed here too: <a href=\"https://stackoverflow.com/questions/31559498/vba-save-as-special-character-error\" title=\"vba save as special character error\">stackoverflow.com/questions/31559498/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11405945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a4b9a5b449de5fc27fadda02d10334?s=128&d=identicon&r=PG&f=1", "display_name": "J Jones", "link": "https://stackoverflow.com/users/11405945/j-jones"}, "edited": false, "score": 0, "creation_date": 1556176308, "post_id": 55832845, "comment_id": 98349821, "body": "Hello I found the link mentioned whereby the workaround was to save the file as a temporary name.csv and then rename it back to the original name with the brackets and whilst this worked in terms of saving the file name with brackets, it didn&#39;t save the data as text (csv). Perhaps I did that step wrong? I tried the following:-"}, {"owner": {"reputation": 1, "user_id": 11405945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a4b9a5b449de5fc27fadda02d10334?s=128&d=identicon&r=PG&f=1", "display_name": "J Jones", "link": "https://stackoverflow.com/users/11405945/j-jones"}, "edited": false, "score": 0, "creation_date": 1556176911, "post_id": 55832845, "comment_id": 98350090, "body": "Sorry, it cut off some text in the last comment."}, {"owner": {"reputation": 1, "user_id": 11405945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a4b9a5b449de5fc27fadda02d10334?s=128&d=identicon&r=PG&f=1", "display_name": "J Jones", "link": "https://stackoverflow.com/users/11405945/j-jones"}, "edited": false, "score": 0, "creation_date": 1556177003, "post_id": 55832845, "comment_id": 98350147, "body": "I tried     ActiveWorkbook.SaveAs Replace(xSPath &amp; &quot;\\&quot; &amp; &quot;TEMP_file_only.csv&quot;, &quot;.xls&quot;, &quot;.csv&quot;, vbTextCompare)    ActiveWorkbook.SaveAs FileName:=xCSVFile, FileFormat:=xlCSVMSDOS but the saving to temporary file hasn&#39;t saved the file with no formatting (text). The name statement has worked though and the brackets are there! How do i remove the xls formatting and just save as text in the Replace statement? thanks v much"}, {"owner": {"reputation": 1, "user_id": 11405945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a4b9a5b449de5fc27fadda02d10334?s=128&d=identicon&r=PG&f=1", "display_name": "J Jones", "link": "https://stackoverflow.com/users/11405945/j-jones"}, "edited": false, "score": 0, "creation_date": 1556274752, "post_id": 55832845, "comment_id": 98391471, "body": "Got this to work by doing the following:- Saving the file with [ ] in the name to a temporary file, with no brackets, in CSV MSDOS format  ActiveWorkbook.SaveAs FileName:=xSPath &amp; &quot;\\&quot; &amp; &quot;TEMP_file_only.csv&quot;, FileFormat:=xlCSVMSDOS.  Then using Name to rename the file to the original file name with [ ] in the name.  Tempfilename = xSPath &amp; &quot;\\&quot; &amp; &quot;TEMP_file_only.csv&quot; OldFileAsCSV = xcsvfileonly &amp; &quot;csv&quot;   Name Tempfilename As OldFileAsCSV Thanks very much"}], "owner": {"reputation": 1, "user_id": 11405945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a4b9a5b449de5fc27fadda02d10334?s=128&d=identicon&r=PG&f=1", "display_name": "J Jones", "link": "https://stackoverflow.com/users/11405945/j-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556117193, "creation_date": 1556117119, "last_edit_date": 1556117193, "question_id": 55832845, "link": "https://stackoverflow.com/questions/55832845/converting-xls-files-to-csv-where-the-filename-includes", "title": "Converting xls files to csv where the filename includes [ ]", "body": "<p>XLS files need converting to CSV (with all formatting removed), so they can be read via a VBA macro. Unfortunately, the xls filenames include [ ] so when i try to save them within vba, it fails with a  run-time error '1004' standard error \"Make sure the file name does not contain ...[ ]\nIf i save the xls file manually (file-save as csv), it says the formatting will be lost but it saves the file. Is there a way i can get my VBA to do the same and effectively ignore the Run-Time error '1004' that gets shown?</p>\n\n<p>i've tried a Replace to save the file to a temporary filename.\nActiveWorkbook.SaveAs Replace(xSPath &amp; \"\\\" &amp; \"TEMP_file_only.csv\", \".xls\", \".csv\", vbTextCompare)</p>\n\n<p>I then opened the temp file and used Name to rename it to CSV\n     Name Tempfilename As OldFileAsCSV</p>\n\n<p>Unfortunately, this preserves the xls formatting so the csv file isn't any good for the macro. It doesn't remove the formatting.</p>\n\n<p>If i try to save the xls as a csv, i get the run-time error because there are [ ] in the filename, which are unfortuantely needed.</p>\n\n<pre><code>  ActiveWorkbook.SaveAs FileName:=xCSVFile, FileFormat:=xlCSVMSDOS, Local:=True\n</code></pre>\n\n<p>I hoped Application.DisplayAlerts = false would ignore the 1004 error but because the filename contains [ ]  i guess it's a valid failure. however, if i save the file manually to csv it works and removes the formatting. Is there anyway in vba to save an xls to csv with [ ] in the filename?\nMany thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1556116962, "post_id": 55832579, "comment_id": 98330176, "body": "Include either the relevant code of the batch file and your VBA code or better build an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so the issue can be reproduced. From what you posted we cannot see why your code does not work as expected."}, {"owner": {"reputation": 3, "user_id": 11405888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c69c2b402b17f3313358e8e9991c791?s=128&d=identicon&r=PG&f=1", "display_name": "Sakthi", "link": "https://stackoverflow.com/users/11405888/sakthi"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556195398, "post_id": 55832579, "comment_id": 98360447, "body": "Hello, I have used the below code in text document  open aaa.bbb.ccc.com (Next Row) user (Next Row) pass (Next Row) ascii (Next Row) lcd C:\\Users\\sakthi\\Desktop (Next Row) cd inflow/docs (Next Row) get document.zip (Next Row) bye (Next Row)  I have entered the text in separate rows but not reflecting in this comment box. so i have added a note where i have line break as (Next Row)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556195716, "post_id": 55832579, "comment_id": 98360609, "body": "Please add everything into your original question (<a href=\"https://stackoverflow.com/posts/55832579/edit\">edit</a>) and format it as code block (Ctrl + K), code in comments is not readable. Include a full <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and explain it as detailed as possible. A one line comment will probably not be enough information to understand what exactly you did."}, {"owner": {"reputation": 3, "user_id": 11405888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c69c2b402b17f3313358e8e9991c791?s=128&d=identicon&r=PG&f=1", "display_name": "Sakthi", "link": "https://stackoverflow.com/users/11405888/sakthi"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556518334, "post_id": 55832579, "comment_id": 98451746, "body": "I have added the required details in the question. Could someone help me on this?"}], "owner": {"reputation": 3, "user_id": 11405888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c69c2b402b17f3313358e8e9991c791?s=128&d=identicon&r=PG&f=1", "display_name": "Sakthi", "link": "https://stackoverflow.com/users/11405888/sakthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556199014, "creation_date": 1556116339, "last_edit_date": 1556199014, "question_id": 55832579, "link": "https://stackoverflow.com/questions/55832579/running-bat-file-using-excel-vba", "title": "Running .bat file using excel vba", "body": "<p>I have a batch file which runs when i directly double click on it. But it is not running when i run it thorough excel vba. Below is the code which i have used.</p>\n\n<pre><code>Dim RetVal\n    RetVal = Shell(\"C:\\Script.bat\", 1)\nEnd Sub\n</code></pre>\n\n<p>I have the script in text file and created a batch file and entered the code as <code>ftp -i -s:script.txt</code>. It runs fine when i clicked on the batch file.</p>\n\n<p>script entered in text file is,</p>\n\n<pre><code>open aa123.aa1.aaa.com\nuser\npwd\nascii\nlcd C:\\Users\\sakthi\\Desktop\ncd data/folder\nget filename.zip\nbye\n</code></pre>\n\n<ol>\n<li>When i run the bat file, by default CMD is checking for the related text file from My Documents but i have the associated text file in the same folder. How to change it to an specific folder?</li>\n<li>It takes only 20 seconds to complete the run when i clicked directly on the batch file. But it takes more than a minute when i run the batch file using macro and gets timeout error in CMD screen. How to resolve it?</li>\n</ol>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1556116397, "post_id": 55832529, "comment_id": 98329773, "body": "You mention wanting a <code>dictionary</code>, but i see nothing in your code where you have tried to use a dictionary.  Would you please update to show your efforts in that regard?  Note that StackOverflow generally helps with <i>specific</i> coding issues that have <i>objective</i> answers."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1556116495, "post_id": 55832529, "comment_id": 98329841, "body": "Alternative: Use a helper column with eg <code>=COUNTIF(A:A, A1)</code> then filter on that column. Everything <code>&gt;1</code> is a duplicate, everything <code>=1</code> is unique. If multiple criteria at once are needed check <code>=COUNTIFS()</code>. \u2022 For VBA have a look at <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.countif\" rel=\"nofollow noreferrer\">WorksheetFunction.CountIf method</a>. Use it to loop throug data and union."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1556116615, "post_id": 55832529, "comment_id": 98329930, "body": "<code>Match()</code> would help find existing item and outputs a row number which would provide easier deletion."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 11121578, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fAYaV27c8tQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3L0O99XX0GZ3FFSCdqmD-pR92Zg/mo/photo.jpg?sz=128", "display_name": "Kyle", "link": "https://stackoverflow.com/users/11121578/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1556117061, "creation_date": 1556117061, "answer_id": 55832828, "question_id": 55832529, "link": "https://stackoverflow.com/questions/55832529/copy-the-unique-items-to-other-sheet-and-delete-the-item-in-the-sheet-in-excel-v/55832828#55832828", "title": "Copy the unique items to other sheet and delete the item in the sheet in Excel VBA", "body": "<p>I believe your asking if you can move values from one worksheet to another? </p>\n\n<p>See:\n<a href=\"https://stackoverflow.com/questions/6977807/how-do-i-activate-a-specific-workbook-and-a-specific-sheet\">How do i activate a specific workbook and a specific sheet?</a></p>\n\n<ul>\n<li>Keep a counter to record which row is open (for the next value)</li>\n<li>If its an individual then:</li>\n</ul>\n\n<pre><code>wb1.Sheets(\"SourceSheet\").Cells(row, columnNumber).Value = wb1.Sheets(\"OutputSheet\").Cells(counter, columnNumber).Value\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11258056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/378c8f08d9614cdc95681bf521c90e6d?s=128&d=identicon&r=PG&f=1", "display_name": "John Pattrick", "link": "https://stackoverflow.com/users/11258056/john-pattrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556117061, "creation_date": 1556116182, "question_id": 55832529, "link": "https://stackoverflow.com/questions/55832529/copy-the-unique-items-to-other-sheet-and-delete-the-item-in-the-sheet-in-excel-v", "title": "Copy the unique items to other sheet and delete the item in the sheet in Excel VBA", "body": "<p>I have created a excel vba which compares two sheets ( Interface  , Steps ) . Whenever a unique record is found in the steps . It will be deleted . I wanted to edit the exist code in such manner that instead of deleting the records , it should be copied to new sheet ( Steps2 ) first and delete it next . I am pretty new to VBA , I have included the code below. I don't want to use copy and paste function as it takes long time to execute. I am looking to create with scripting dictionary . Any help me in achieving the result would help me.</p>\n\n<pre><code>Option Explicit\n\nFunction UpdateOLD() As Long\n'     This Sub will do the Following Update\n'     Run through all records in OLD\n'        if found in Interface  ---&gt; Do nothing\n'        if not found in Interface ----&gt; Delete it from Steps.\nApplication.ScreenUpdating = False\nDim Rng As Range\nDim WSO As Worksheet\nDim WSN As Worksheet\nDim MaxRowO As Long, MaxRowN As Long, I As Long, J As Long, lDel As Long\nDim sJob As String, sOps As String, sFirstAddress As String\nDim cCell As Range\nDim bNotFound As Boolean\n\n\n'---&gt; Disable Events\nWith Application\n    .EnableEvents = False\n    .DisplayAlerts = False\n    .ScreenUpdating = False\nEnd With\n\n'---&gt; Set Variables\nSet WSO = Sheets(\"Steps\")\nSet WSN = Sheets(\"Interface\")\nMaxRowO = WSO.Range(\"A\" &amp; WSO.Rows.Count).End(xlUp).Row\nMaxRowN = WSN.Range(\"C\" &amp; WSN.Rows.Count).End(xlUp).Row\nWSO.Range(\"N2:N\" &amp; MaxRowO).ClearContents\n\n'---&gt; Loop thruough all rows in sheet New\nFor I = 2 To MaxRowO\n    bNotFound = False\n    sJob = WSO.Cells(I, \"B\")\n    sOps = WSO.Cells(I, \"C\")\n    Set cCell = WSN.Range(\"D6:D\" &amp; MaxRowN).Find(what:=sJob, LookIn:=xlValues, lookat:=xlWhole, MatchCase:=False)\n    If Not cCell Is Nothing Then\n        bNotFound = True\n        sFirstAddress = cCell.Address\n        Do\n            '---&gt; Check to See if Ops if found for that Job\n            If WSN.Cells(cCell.Row, \"E\") = sOps Then\n                bNotFound = False\n                Exit Do\n            End If\n            Set cCell = WSN.Range(\"D6:D\" &amp; MaxRowN).FindNext(cCell)\n        Loop While Not cCell Is Nothing And cCell.Address &lt;&gt; sFirstAddress\n    Else\n        bNotFound = True\n    End If\n\n    '---&gt; Del Record from OLD if Not Found\n    If bNotFound Then\n        If Rng Is Nothing Then\n        Set Rng = WSO.Range(\"A\" &amp; I)\n        Else\n        Set Rng = Union(Rng, WSO.Range(\"A\" &amp; I))\n        lDel = lDel + 1\n        End If\n    End If\nNext I\n\nIf Not Rng Is Nothing Then Rng.EntireRow.Delete\n\n'---&gt; Enable Events\nWith Application\n    .EnableEvents = True\n    .DisplayAlerts = True\n    .ScreenUpdating = True\nEnd With\n\nUpdateOLD = lDel\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1556115334, "post_id": 55832186, "comment_id": 98329030, "body": "FYI, as you have it, <code>create</code>  and <code>delete</code> are variables. If you&#39;re trying to see if the value is the strings, then you need to wrap those in quotes, e.g. <code>... = &quot;create&quot;</code>, or <code>... = &quot;delete&quot;</code>."}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1556115466, "post_id": 55832186, "comment_id": 98329134, "body": "@BruceWayne, those strings are already assigned to those variables... var create = &quot;Create&quot; and var delete = &quot;Delete&quot;"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1556115506, "post_id": 55832186, "comment_id": 98329165, "body": "That&#39;s not the problem here  :)"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1556115530, "post_id": 55832186, "comment_id": 98329182, "body": "Are all the values unique? If so you could use a <code>Collection</code> or <code>Dictionary</code> of values"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1556115873, "post_id": 55832186, "comment_id": 98329405, "body": "@Tom, that would be hard for this purpose I think... Isn&#39;t there any way I can assign a value (in this case the column = Long) to something like this:  &quot;Namex&quot; &amp; &quot;1&quot; ?"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "edited": false, "score": 0, "creation_date": 1556115958, "post_id": 55832186, "comment_id": 98329459, "body": "Because that &quot;Namex&quot; will vary with the worksheet, and that way I can always know what&#39;s assign to it... This would be the perfect solution, but I don&#39;t know how to do it."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1556116087, "post_id": 55832186, "comment_id": 98329552, "body": "Using dynamic variables in <code>VBA</code> would be a lot more complex. You would need to Trust access to the VBA project object model to be able to create vba code on the fly. <code>VBA</code> won&#39;t allow you to create dynamic variables like some other languages. You&#39;d have to programatically write the code before executing it."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1556116227, "post_id": 55832186, "comment_id": 98329660, "body": "If I&#39;m understanding correctly, you&#39;re wondering if you can indirectly create and reference variables. i.e. in the loop, assign a value to a variable named &quot;Name1c&quot; (sheet name = &quot;Name1&quot;) or a variable named &quot;Name1d&quot;, etc for each sheet. @Tom is right. There isn&#39;t a simple solution using dynamic variables. However, it sounds like for the dynamic variables to work, you&#39;re already assuming that the sheet names are unique. From your existing code, I do believe either a dictionary or collection may be the easiest solution."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1556116293, "post_id": 55832186, "comment_id": 98329710, "body": "@tom: I know exactly what you <a href=\"http://www.siddharthrout.com/index.php/2019/03/22/create-a-new-variable-object-at-runtime/\" rel=\"nofollow noreferrer\">MEAN</a> :P"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1556116397, "post_id": 55832186, "comment_id": 98329775, "body": "Also, if the dynamic variable idea had worked, with the way the code is set up, at the end of the <code>For</code>-loop each of the variables would only have a single value. If there is more than one create or destroy per sheet, the code would only save the <code>w</code> value for the last one."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556116453, "post_id": 55832186, "comment_id": 98329816, "body": "@SiddharthRout haha thanks - that&#39;s exactly what I meant :P"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "edited": false, "score": 0, "creation_date": 1556116590, "post_id": 55832186, "comment_id": 98329911, "body": "Oh... I thought this would be easier to do, since it looks so simple. And using a <code>Collection</code>, would I have do create one for each worksheet? Or use one with all the columns values saved?"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "edited": false, "score": 0, "creation_date": 1556116717, "post_id": 55832186, "comment_id": 98330002, "body": "Or something like this would work? &#180;With collectionx     .Value = ws.Name  &amp; &quot;c&quot; End With&#180;"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556116840, "post_id": 55832186, "comment_id": 98330096, "body": "@Mistella, but there&#39;s only one value per create and per delete, that&#39;s why I though about this solution!  :)"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1556116998, "post_id": 55832186, "comment_id": 98330200, "body": "Also, some sources I have found helpful for <a href=\"https://excelmacromastery.com/excel-vba-collections/\" rel=\"nofollow noreferrer\">collections</a> and <a href=\"https://excelmacromastery.com/vba-dictionary/\" rel=\"nofollow noreferrer\">dictionaries</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556116827, "post_id": 55832709, "comment_id": 98330081, "body": "Further explanation: This will only keep the first instance of each create/delete in a worksheet. If the last is desired, the existing value could be replaced with the newest found."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556116847, "post_id": 55832709, "comment_id": 98330100, "body": "Tip: reference the <i>Microsoft Scripting Runtime</i> library, then you can declare <code>dict As Dictionary</code>, do <code>Set dict = New Dictionary</code>, and get intellisense &amp; autocompletion as you type. Every single Windows box built this century has the same version of that library, there&#39;s no reason to systematically late-bind it."}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556117255, "post_id": 55832709, "comment_id": 98330375, "body": "@Mistella, and to get the values from the dictKeys i just have to do &#180;x = dict(&quot;Namec&quot;) right?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "reply_to_user": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "edited": false, "score": 0, "creation_date": 1556117287, "post_id": 55832709, "comment_id": 98330403, "body": "@FranciscaParenteCambra exactly"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556117889, "post_id": 55832709, "comment_id": 98330756, "body": "Just one more thing @Mistella, the &#180;If Not&#180; is adding the value of w to the respective dictKey, but only if the key doesn&#39;t exist in the dictionary? Is not it the other way around?"}, {"owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "edited": false, "score": 0, "creation_date": 1556117906, "post_id": 55832709, "comment_id": 98330763, "body": "Or @Tom, if you know the answer pls"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "reply_to_user": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "edited": false, "score": 0, "creation_date": 1556118602, "post_id": 55832709, "comment_id": 98331153, "body": "@FranciscaParenteCambra <code>dict.exists(dictKey)</code> returns True if <code>dictKey</code> is an existing key in the dictionary, False if it isn&#39;t. Therefore, <code>Not dict.exists(dictKey)</code> is equal to True if the dictionary does not have any keys matching <code>dictKey</code>. The reason for the <code>If statement</code> is because trying to <code>Add</code> a key that already exists causes an error; all keys are required to be unique. A dictionary is initially blank - no keys, no values. Information is always added in pairs: key and value. However, if a key already exists, the value can still be updated/edited."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 1, "last_activity_date": 1556116726, "creation_date": 1556116726, "answer_id": 55832709, "question_id": 55832186, "link": "https://stackoverflow.com/questions/55832186/how-to-define-dynamic-variables-in-excel-vba/55832709#55832709", "title": "How to define dynamic variables in Excel VBA?", "body": "<p>Example of using a dictionary</p>\n\n<pre><code>Dim dict As Object\nDim dictKey As String\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nFor Each ws In ThisWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" And ws.Name &lt;&gt; concepts Then\n        For w = 1 To ws.Name.Cells(1, Columns.Count).End(xlToLeft).Column\n            If ws.Name.Cells(1, w).Value = Create Then\n                dictKey = ws.Name &amp; c\n            ElseIf ws.Name.Cells(1, w).Value = Delete Then\n                dictKey = ws.Name &amp; d\n            End If\n\n            If Not dict.exists(dictKey) Then\n                dict.Add dictKey, w\n            Else\n                MsgBox dictKey &amp; \" already exists\"\n            End If\n         Next w\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11166005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210437257566904/picture?type=large", "display_name": "Francisca Parente Cambra", "link": "https://stackoverflow.com/users/11166005/francisca-parente-cambra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 55832709, "answer_count": 1, "score": 1, "last_activity_date": 1556116916, "creation_date": 1556115178, "last_edit_date": 1556116916, "question_id": 55832186, "link": "https://stackoverflow.com/questions/55832186/how-to-define-dynamic-variables-in-excel-vba", "title": "How to define dynamic variables in Excel VBA?", "body": "<p>I'm a beginner with <code>VBA</code> Excel and I'm trying to do an application for my thesis, that has to manipulate excel files during the process.</p>\n\n<p>I will basically have a workbook composed by many worksheets, and I want to save effectively some data, using only one FOR to save some time. The problem is that I don't know which are going to be the names of the worksheets imported (already done this importation part). </p>\n\n<p>So, I want to save the columns where I found some data (strings 'Create' and 'Delete'), but I can't assign them to a static variable, because they'll be overwritten. So my idea was to put them on dynamic variables, according to the name of the sheet, but I don't know how to do that. </p>\n\n<p>My first try was the following, but the code doesn't work... <code>ws.Name &amp; c = w</code> and <code>ws.Name &amp; d = w</code> are giving error. </p>\n\n<pre><code>For Each ws In ThisWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" And ws.Name &lt;&gt; concepts Then\n         For w = 1 To ws.Name.Cells(1, Columns.Count).End(xlToLeft).Column\n             If ws.Name.Cells(1, w).Value = create Then\n                 ws.Name &amp; \"c\" = w\n             ElseIf ws.Name.Cells(1, w).Value = delete Then\n                 ws.Name &amp; \"d\" = w\n             End If\n         Next w\n    EndIf\nNext\n</code></pre>\n\n<p>Can someone please help me?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1556114382, "post_id": 55831764, "comment_id": 98328353, "body": "You seem to have lots of issues with Objects and Variables (e.g. using <code>Set</code> with <code>.Row</code>, which is a <code>Long</code> variable) - make sure that <code>Option Explicit</code> is at the top of your module, and then use the &quot;Compile Project&quot; option in the &quot;Debug&quot; menu"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1556114694, "post_id": 55831764, "comment_id": 98328563, "body": "Your Excel is crashing due to recursion as you don&#39;t change your <code>i</code> value in your <code>Do</code> <code>Loop</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 0, "last_activity_date": 1556115318, "creation_date": 1556115318, "answer_id": 55832233, "question_id": 55831764, "link": "https://stackoverflow.com/questions/55831764/how-to-find-a-cell-value-on-another-worksheet-and-place-a-value-on-another-colum/55832233#55832233", "title": "How to find a cell value on another worksheet and place a value on another column for the row where the first value was found", "body": "<p>Have a look at the <code>Find</code> example below</p>\n\n<pre><code>Sub demo()\n    Dim wal As Worksheet: Set wal = Worksheets(\"Altera\u00e7\u00f5es\")\n    Dim wsc As Worksheet: Set wsc = Worksheets(\"Schedule\")\n    Dim rng As Range, UserRow As Range\n    Dim UserEmail As String\n\n    With wal\n        Set rng = .Columns(5).Find(\"Remove from the Schedule - Vacation\")\n        If Not rng Is Nothing Then\n            UserEmail = rng.Offset(0, 11).Value2\n            Debug.Print rng.Address, UserEmail\n            With wsc\n                Set UserRow = .Columns(1).Find(what:=UserEmail)\n                If Not UserRow Is Nothing Then\n                    UserRow.Offset(0, Columns(\"AI\").Column - UserRow.Column).Value2 = 1\n                End If\n            End With\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11400182, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pci0cNW7b7A/AAAAAAAAAAI/AAAAAAAABvQ/PJShsVBGyO8/photo.jpg?sz=128", "display_name": "Bruna Espejo", "link": "https://stackoverflow.com/users/11400182/bruna-espejo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556115968, "creation_date": 1556113954, "last_edit_date": 1556115968, "question_id": 55831764, "link": "https://stackoverflow.com/questions/55831764/how-to-find-a-cell-value-on-another-worksheet-and-place-a-value-on-another-colum", "title": "How to find a cell value on another worksheet and place a value on another column for the row where the first value was found", "body": "<p>(I admit that I'm a newbie with vba, so I'm sorry if it's a silly question - I'm also sorry for any english mistakes)</p>\n\n<p>Some background:</p>\n\n<p>I'm responsible for the activities schedule of the support agents on my company. Their leaders can send requests to remove them from the schedule, for example. And there can be more than one request per agent for the same day. (the schedule is daily)</p>\n\n<p>So, I have two spreadsheets, \"Requests\" and \"Schedule\"</p>\n\n<p>On the request worksheet:\nI need to check on the column for each type of requests (Vacations, Day Off..) (\"E\" Column)\nIf I find this request, I need the agent email from another row (P Column), search this email on the \"Schedule\" worksheet (\"A\" Column) and place an \"1\" on ther \"AI\" column (I have to report the amout of each request)</p>\n\n<p>I've been having a problem mostly to find the agent on the \"schedule\" worksheet and place the \"1\", and I've tried other codes, but this is the last one I've been working on (a work colleague sugested using  the \"Do While\" and \"Find\")</p>\n\n<p>(for now the excel just crash)</p>\n\n<p>Some of what I've tried:</p>\n\n<pre><code>If wal.Cells(row, 5) = \"Remove from the Schedule - Vacation\" Then\n    'Application.WorksheetFunction.Match(wal.Cells(row, 16).Value, wsc.Range(\"A:A\"), 0).row\n    wsc.Cells(Application.WorksheetFunction.Match(wal.Cells(row, 16).Value, wsc.Range(\"A:A\"), 0).row, 35) = 1\n</code></pre>\n\n<p>And</p>\n\n<pre><code>ElseIf Cells(row, 5) = \"Remove from the Schedule - Vacation\" Then\n    row = Application.WorksheetFunction.Match(wal.Cells(row, 16), sc.Range(\"A:A\"), 0)\n    wsc.Cells(row, 35) = 1\n\n    Set wal = Worksheets(\"Altera\u00e7\u00f5es\")\n    Set wsc = Worksheets(\"Schedule\")\n\n    i = 5\n    j = 41\n\n    Do While wal.Range(\"E\" &amp; i) &lt;&gt; 0\n        If wal.Range(\"E\" &amp; i) = \"Remover do Schedule - F\u00e9rias\"  Then        \n            Set agent = wal.Range(\"P\" &amp; i).Find(wsc.Range(\"A\" &amp; j).Value).row                \n            Range(\"AI\" &amp; agent) = 1\n        End If\n    Loop\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 5, "creation_date": 1556114018, "post_id": 55831745, "comment_id": 98328082, "body": "1 Thing, if you pass an object as variable to another sub, you don&#39;t need to turn the variable to global. Second thing: <code>Public data, summary_month, summary_item, summary_charge, summary_pro As Worksheet</code> here you are only declaring <code>summary_pro</code> as worksheet, the others are variants."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1556114424, "post_id": 55831745, "comment_id": 98328384, "body": "Try <code>change_colors summary_month</code>. <a href=\"https://stackoverflow.com/questions/5413765/what-are-the-rules-governing-usage-of-brackets-in-vba-function-calls\" title=\"what are the rules governing usage of brackets in vba function calls\">stackoverflow.com/questions/5413765/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 11033044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202a4d298f9e40a318173bc8d3c66086?s=128&d=identicon&r=PG&f=1", "display_name": "Phl3bas", "link": "https://stackoverflow.com/users/11033044/phl3bas"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1556114625, "post_id": 55831745, "comment_id": 98328521, "body": "@Damian and SJR thanks alot! i had tried SJR solution earlier which didn&#39;t work but soon as i did it with Damian suggestion it solved the problem!! thanks alot"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 11033044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202a4d298f9e40a318173bc8d3c66086?s=128&d=identicon&r=PG&f=1", "display_name": "Phl3bas", "link": "https://stackoverflow.com/users/11033044/phl3bas"}, "is_accepted": false, "score": 0, "last_activity_date": 1556114896, "creation_date": 1556114896, "answer_id": 55832087, "question_id": 55831745, "link": "https://stackoverflow.com/questions/55831745/passing-worksheet-object-to-another-sub-getting-object-doesnt-support-this-pro/55832087#55832087", "title": "Passing worksheet object to another sub getting &quot;object doesn&#39;t support this property or method&quot;", "body": "<p>declared worksheets separately rather than inline</p>\n\n<pre><code>Option Explicit\n\nPublic wb As Workbook\n\nPublic i, n, x, y, z As Variant\n\nPublic libName(), itype(), tcharge(), tprofile() As Variant\n\nPublic profile, pay_lib, item_auth, total_paid, month, \nitem_type, chr_type As Variant\n\nPublic Sub main()\n\nDim data As Worksheet\nDim summary_month As Worksheet\nDim summary_item As Worksheet\nDim summary_charge As Worksheet\nDim summary_pro As Worksheet\n\nSet wb = ThisWorkbook\nSet data = wb.Sheets(1)\nSet summary_month = wb.Sheets(2)\nSet summary_item = wb.Sheets(3)\nSet summary_charge = wb.Sheets(4)\nSet summary_pro = wb.Sheets(5)\n</code></pre>\n\n<p>and also made sure the subroutine was called as below rather than in parenthesis </p>\n\n<pre><code>change_colors summary_month\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11033044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/202a4d298f9e40a318173bc8d3c66086?s=128&d=identicon&r=PG&f=1", "display_name": "Phl3bas", "link": "https://stackoverflow.com/users/11033044/phl3bas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556115974, "creation_date": 1556113920, "last_edit_date": 1556115974, "question_id": 55831745, "link": "https://stackoverflow.com/questions/55831745/passing-worksheet-object-to-another-sub-getting-object-doesnt-support-this-pro", "title": "Passing worksheet object to another sub getting &quot;object doesn&#39;t support this property or method&quot;", "body": "<p>I'm writing a macro that along other things formats a bunch of much sheets, one subroutine I've written needs to accept a worksheet object I've defined and used earlier. When i try and call the subroutine with the worksheet object as a parameter i get an \"object doesn't not support this property or method\"</p>\n\n<pre><code>Option Explicit\n\nPublic wb As Workbook\n\nPublic data, summary_month, summary_item, summary_charge, summary_pro As Worksheet\n\nPublic i, n, x, y, z As Variant\n\nPublic libName(), itype(), tcharge(), tprofile() As Variant\n\nPublic profile, pay_lib, item_auth, total_paid, month, item_type, chr_type As Variant\n\nPublic Sub main()\n\nSet wb = ThisWorkbook\nSet data = wb.Sheets(1)\nSet summary_month = wb.Sheets(2)\nSet summary_item = wb.Sheets(3)\nSet summary_charge = wb.Sheets(4)\nSet summary_pro = wb.Sheets(5)\n\nWith data\n    Set pay_lib = .Range( _\n                    .Cells(2, 2), _\n                    .Cells(2, 2).End(xlDown))\n    Set item_auth = .Range( _\n                    .Cells(2, 4), _\n                    .Cells(2, 4).End(xlDown))\n    Set month = .Range( _\n                    .Cells(2, 3), _\n                    .Cells(2, 3).End(xlDown))\n    Set total_paid = .Range( _\n                    .Cells(2, 10), _\n                    .Cells(2, 10).End(xlDown))\n    Set item_type = .Range( _\n                    .Cells(2, 5), _\n                    .Cells(2, 5).End(xlDown))\n    Set chr_type = .Range( _\n                    .Cells(2, 6), _\n                    .Cells(2, 6).End(xlDown))\n    Set profile = .Range( _\n                    .Cells(2, 8), _\n                    .Cells(2, 8).End(xlDown))\n\nEnd With\n\n\n'''''''''''''''''''''''''''''''''''''''''''''\n''''''''''some other stuff'''''''''''''''''''\n'''''''''''''''''''''''''''''''''''''''''''''\n\n\nchange_colors (summary_month)\n\nEnd Sub\n</code></pre>\n\n<pre><code>Sub change_colors(wksheet As Worksheet)\n\nWith wksheet\n    For Each i In .Range(.Cells(2, 1), .Cells(2, 1).End(xlDown))\n        If i.Row Mod 2 = 0 Then\n            .Range(.Cells(i.Row, i.Column), .Cells(i.Row, i.Column).End(xlToRight)).Interior.ColorIndex = 31\n        Else\n            .Range(.Cells(i.Row, i.Column), .Cells(i.Row, i.Column).End(xlToRight)).Interior.ColorIndex = 2\n        End If\n    Next i\nEnd With\n\n</code></pre>\n\n<p>when the subroutine is called the 'with' statement should alternate colors based on row, and from my testing there doesn't seem to be anything round with that, i get the error when the subroutine is being called. both subs are in the same module.</p>\n\n<p>Clearly there is something i'm not fully understanding with how worksheet objects work any help would be greatly appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 1, "creation_date": 1556113275, "post_id": 55831460, "comment_id": 98327608, "body": "Welcome to Stack Overflow. There&#39;s no such thing as &quot;US time&quot; - there are multiple time zones in the US. For example, most of the time the West coast (e.g. California) is 3 hours behind the East coast (e.g. New York). Do you have a specific time zone you need to use?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1556113393, "post_id": 55831460, "comment_id": 98327680, "body": "Add <code>TZones</code> to the Watch window. Place a breakpoint on <code>Set sourceTZ = TZones.Item(TZfrom)</code>. Examine the <code>TZones</code> in the Watch window for keywords."}, {"owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 0, "creation_date": 1556113642, "post_id": 55831460, "comment_id": 98327824, "body": "Look up the options for the <code>DateAdd</code> function..."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "edited": false, "score": 1, "creation_date": 1556114358, "post_id": 55831460, "comment_id": 98328332, "body": "@Dave <code>DateAdd</code> is not concerned with time zones, nor is the data type <code>Date</code> in general."}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556117095, "post_id": 55831460, "comment_id": 98330262, "body": "&quot;European Central Time&quot;? <a href=\"https://www.timeanddate.com/time/zones/\" rel=\"nofollow noreferrer\">timeanddate.com/time/zones</a>"}, {"owner": {"reputation": 1, "user_id": 11280434, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7IDhfO7mWo/AAAAAAAAAAI/AAAAAAAAALY/HoL2I0dMA4Y/photo.jpg?sz=128", "display_name": "Rajat Gupta", "link": "https://stackoverflow.com/users/11280434/rajat-gupta"}, "reply_to_user": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1556174978, "post_id": 55831460, "comment_id": 98349165, "body": "@JonSkeet I want to use GMT -4 time zone"}, {"owner": {"reputation": 1253974, "user_id": 22656, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6d8ebb117e8d83d74ea95fbdd0f87e13?s=128&d=identicon&r=PG", "display_name": "Jon Skeet", "link": "https://stackoverflow.com/users/22656/jon-skeet"}, "edited": false, "score": 0, "creation_date": 1556175284, "post_id": 55831460, "comment_id": 98349308, "body": "@RajatGupta: Regardless of whether anywhere in the world actually observes that at the time? For example, New York varies between UTC-5 and UTC-4. I&#39;d have to check whether there <i>are</i> any time zones that are permanently UTC-4. If you actually want &quot;the time in New York&quot; then &quot;Eastern Standard Time&quot; is probably the Windows ID you want. (Don&#39;t be fooled - it still observes DST.)"}], "owner": {"reputation": 1, "user_id": 11280434, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-W7IDhfO7mWo/AAAAAAAAAAI/AAAAAAAAALY/HoL2I0dMA4Y/photo.jpg?sz=128", "display_name": "Rajat Gupta", "link": "https://stackoverflow.com/users/11280434/rajat-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 224, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556113274, "creation_date": 1556113176, "last_edit_date": 1556113274, "question_id": 55831460, "link": "https://stackoverflow.com/questions/55831460/how-to-convert-time-into-us-time-zone-in-excel-vba", "title": "How to convert time into US time zone in Excel VBA?", "body": "<p>I am writing a code that converts the current time into US time (GMT -4).<br>\nI am not able to find the right keyword to do so. I have the code to convert time into Europe Standard Time.<br>\nCan anyone please tell the right phrase to use in place of \"W. Europe Standard Time\" in Function declaration line.</p>\n\n<p>------TRUNCATED CODE-----------</p>\n\n<pre><code>Function ConvertTime(DT As Date, Optional TZfrom As String = \"Central Standard Time\", _\n                                 Optional TZto As String = \"W. Europe Standard Time\") As Date\n    Dim TZones As Object\n    Dim sourceTZ As Object\n    Dim destTZ As Object\n    Dim seconds As Single\n    Dim DT_SecondsStripped As Date\n    If GetOutlook Then\n        'fix for ConvertTime stripping the seconds\n        seconds = Second(DT) / 86400    'save the seconds as DateTime (86400 = 24*60*60)\n        DT_SecondsStripped = DT - seconds\n        Set TZones = oOutl.TimeZones\n        Set sourceTZ = TZones.Item(TZfrom)\n        Set destTZ = TZones.Item(TZto)\n        ConvertTime = TZones.ConvertTime(DT_SecondsStripped, sourceTZ, destTZ) + seconds    'add the stripped seconds\n    End If\nEnd Function\n\nSub test_ConvertTime()\n    Dim t As Date\n\n    t = Now()\n    Debug.Print t, ConvertTime(t)\n'    Debug.Print t, ConvertTime(t), Format(t - ConvertTime(t), \"h\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1556113615, "post_id": 55831264, "comment_id": 98327809, "body": "are you shure that you using VBA?"}, {"owner": {"reputation": 87, "user_id": 9599690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q81wP.png?s=128&g=1", "display_name": "izzatd", "link": "https://stackoverflow.com/users/9599690/izzatd"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1556114025, "post_id": 55831264, "comment_id": 98328087, "body": "I am using vba. I assume you are asking due to the syntax that I used in my code block example. They are not in vba syntax, rather just to represent my points. Do you think I should modify them to be exactly in vba syntax to avoid confusion?"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1556114082, "post_id": 55831264, "comment_id": 98328135, "body": "i think you must post a piece of code so we can understand that you want to do, also you can read this first <a href=\"https://bettersolutions.com/vba/arrays/index.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/vba/arrays/index.htm</a>"}, {"owner": {"reputation": 87, "user_id": 9599690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q81wP.png?s=128&g=1", "display_name": "izzatd", "link": "https://stackoverflow.com/users/9599690/izzatd"}, "reply_to_user": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1556114109, "post_id": 55831264, "comment_id": 98328158, "body": "Noted. Let me edit my question."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 9599690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q81wP.png?s=128&g=1", "display_name": "izzatd", "link": "https://stackoverflow.com/users/9599690/izzatd"}, "edited": false, "score": 0, "creation_date": 1556115119, "post_id": 55831936, "comment_id": 98328860, "body": "is <code>vaTest</code> a 2d array, or 1d array of 1d array elements? My requirement is that accessing the <code>vaTest</code> should be like <code>vaTest(0, 1)</code> instead of <code>vaTest(0)(1)</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556173187, "post_id": 55831936, "comment_id": 98348399, "body": "@DmitrijHolkin Actually he <i>must not</i> accept the first answer. While it is a good practice to accept the first correct answer (if there are 2 equal answers) he is free to decide which answer fits better to his question and choose the one which gave the best explanation to the question. This makes people answering not only correct answers but also good anwser with good explanations. \u2022 So it is a common practice to accept the answer that you think fits best (even if it came later) and upvote for the other ones that are correct too. This decision is completely up to the OP."}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1556114476, "creation_date": 1556114476, "answer_id": 55831936, "question_id": 55831264, "link": "https://stackoverflow.com/questions/55831264/how-to-pass-vector-to-a-row-in-an-array-in-excel-vba/55831936#55831936", "title": "How to pass vector to a row in an array in Excel vba?", "body": "<p>It sound like you want something like this</p>\n\n<pre><code>  Sub test()\n  Dim vaTest As Variant\n\n    vaTest = Array(Array(1, 2, 3), Array(4, 5, 6))\n        Debug.Print vaTest(0)(1) ' Prints 2\n    vaTest(0) = Array(7, 8, 9) ' changing first array\n        Debug.Print vaTest(0)(1) ' Prints 8\n  End Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 9599690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q81wP.png?s=128&g=1", "display_name": "izzatd", "link": "https://stackoverflow.com/users/9599690/izzatd"}, "edited": false, "score": 0, "creation_date": 1556115630, "post_id": 55832220, "comment_id": 98329247, "body": "It works, thanks. Ps/ note that @dmitrij also giving the same answer. Credit to both of you. Upvote this answer for the diagram aid."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1556116138, "last_edit_date": 1556116138, "creation_date": 1556115279, "answer_id": 55832220, "question_id": 55831264, "link": "https://stackoverflow.com/questions/55831264/how-to-pass-vector-to-a-row-in-an-array-in-excel-vba/55832220#55832220", "title": "How to pass vector to a row in an array in Excel vba?", "body": "<p>I recommend to use array counting 0 based because you can easily use <code>Array(1, 2)</code> to create a vector.</p>\n\n<pre><code>Sub test()     \n    Dim Vectors() As Variant\n\n    'fill it with 3 vectors (0 to 2)\n    Vectors = Array(Array(1, 2), Array(3, 4), Array(\"a\", \"b\"))\n\n    'replace third vector with another one\n    Vectors(2) = Array(5, 6)\nEnd Sub\n</code></pre>\n\n<p><strong>Before</strong>\n<a href=\"https://i.stack.imgur.com/OCK9g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OCK9g.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>After</strong>\n<a href=\"https://i.stack.imgur.com/eRFAq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eRFAq.png\" alt=\"enter image description here\"></a></p>\n\n<p>To directly access one of these vectors use:</p>\n\n<pre><code>Debug.Print Vectors(2)(0) '=5\nDebug.Print Vectors(2)(1) '=6\n</code></pre>\n\n<p>Or to extract eg the second vector use</p>\n\n<pre><code>Dim SecondVector() As Variant\nSecondVector = Vectors(1)\n\nDebug.Print SecondVector(0) '=3\n</code></pre>\n\n<p>For further information about using arrays I recommend reading:<br>\n<a href=\"https://excelmacromastery.com/excel-vba-array/\" rel=\"nofollow noreferrer\">The Complete Guide to Using Arrays in Excel VBA</a></p>\n"}], "owner": {"reputation": 87, "user_id": 9599690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q81wP.png?s=128&g=1", "display_name": "izzatd", "link": "https://stackoverflow.com/users/9599690/izzatd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 55831936, "answer_count": 2, "score": 0, "last_activity_date": 1556116138, "creation_date": 1556112573, "last_edit_date": 1556115777, "question_id": 55831264, "link": "https://stackoverflow.com/questions/55831264/how-to-pass-vector-to-a-row-in-an-array-in-excel-vba", "title": "How to pass vector to a row in an array in Excel vba?", "body": "<p>I have an array, and a vector. I want to pass/replace a row in the array with the vector.</p>\n\n<pre><code>2d array, as below\narr = [[1, 2],\n       [3, 4],\n       [a, b]]       &lt;--- replace with vct here\n\n...where vct = [[5, 6]]\n</code></pre>\n\n<p>While it can be done unsophisticatedly using the naive looping, I wonder if there is any creative workaround for it. Example as below.</p>\n\n<p>Using naive looping:</p>\n\n<pre><code>For i = 1 to 2\n    arr(3, i) = vct(i)\nNext i\n</code></pre>\n\n<p>...or some clever workaround:</p>\n\n<pre><code>arr(3, :) = vct    ...where \":\" represents \"all columns\"\n</code></pre>\n\n<p>Result expected:</p>\n\n<pre><code>arr = [[1, 2],\n       [3, 4],\n       [5, 6]]\n</code></pre>\n\n<p>Tbh I have low expectation for vba since even the simple array indexing isn't actually a thing. I just hope if anybody wanna take a stab on this to provide a solution. Tq</p>\n\n<hr>\n\n<p>Edit to improve question clarity by adding vba code block. See below</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim arr(1 to 3, 1 to 2) as Integer\n    Dim vct(1 to 2) as Integer\n    Dim i as Integer\n\n    ' filling in arr\n    arr(1, 1) = 1\n    arr(1, 2) = 2\n    arr(2, 1) = 3\n    arr(2, 2) = 4\n    arr(3, 1) = 10\n    arr(3, 2) = 20\n\n    ' filling in vct\n    vct(1) = 5\n    vct(2) = 6\n\n    ' passing the vector vct into last row of arr using for loop\n    For i = 1 to 2\n        arr(3, i) = vct(i)\n    Next i\n\n    ' as a result,\n    ' arr(3, 1) = 5, and\n    ' arr(3, 2) = 6\n    ' which does its work perfectly\n    ' but I am looking if there is any possibility\n    ' to have a non-looping approach such as below\n    ' arr(3, :) = vct\n    '  \n    ' this is because I am too accustomed to python syntax\n    ' where it can be done as using \":\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "edited": false, "score": 0, "creation_date": 1556117494, "post_id": 55830953, "comment_id": 98330536, "body": "Except for indentations and some red fonts, this appears to be the same code.  Am I missing something?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1556118517, "post_id": 55830953, "comment_id": 98331111, "body": "<a href=\"https://i.stack.imgur.com/QBSFj.gif\" rel=\"nofollow noreferrer\">Unable to reproduce the issue</a>"}, {"owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556118856, "post_id": 55830953, "comment_id": 98331307, "body": "So you&#39;re saying it works for you?"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556119568, "post_id": 55830953, "comment_id": 98331768, "body": "Check the link (gif)"}, {"owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556126142, "post_id": 55830953, "comment_id": 98335147, "body": "at work...it&#39;s blocked"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "edited": false, "score": 0, "creation_date": 1556114136, "post_id": 55831062, "comment_id": 98328176, "body": "The format of the cell was already hh;mm:ss.  I tried h:mm:ss and m:ss.  Same error."}, {"owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "edited": false, "score": 0, "creation_date": 1556126392, "post_id": 55831062, "comment_id": 98335265, "body": "That isn&#39;t what I&#39;m looking for.  I want the counter to display hhhhh:mm:ss"}, {"owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "edited": false, "score": 0, "creation_date": 1556126441, "post_id": 55831062, "comment_id": 98335286, "body": "Custom formatting doesn&#39;t seem to help...the cell shows mm/dd/yyyy hh:mm under pretty much all formats."}], "tags": [], "owner": {"reputation": 399, "user_id": 7355277, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5pwQ.png?s=128&g=1", "display_name": "Zamar", "link": "https://stackoverflow.com/users/7355277/zamar"}, "is_accepted": false, "score": 1, "last_activity_date": 1556111969, "creation_date": 1556111969, "answer_id": 55831062, "question_id": 55830953, "link": "https://stackoverflow.com/questions/55830953/type-mis-match-error-in-vba-for-excel-countdown-timer/55831062#55831062", "title": "Type mis-match error in VBA for Excel countdown timer", "body": "<pre><code>Sheet1.Range(\"B1\").Value\n</code></pre>\n\n<p>Is returning a value that's most probably a string. You need to change the Format of the cell to the custom format at the beggining of the video. </p>\n\n<p>Click the cell, press Ctrl + 1 -> Custom Format -> write \"m:ss\"</p>\n"}], "owner": {"reputation": 11, "user_id": 9753747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09f2e6756b7fbba0f4af9a37b10ed4ff?s=128&d=identicon&r=PG&f=1", "display_name": "JKoppel", "link": "https://stackoverflow.com/users/9753747/jkoppel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556117664, "creation_date": 1556111674, "last_edit_date": 1556111759, "question_id": 55830953, "link": "https://stackoverflow.com/questions/55830953/type-mis-match-error-in-vba-for-excel-countdown-timer", "title": "Type mis-match error in VBA for Excel countdown timer", "body": "<p>I'm trying to create a simple timer in Excel using VBA code.  However, I'm receiving a run-time error type mismatch in one of the applications.</p>\n\n<p>Included in the timer are stop and start buttons.  All code below.  </p>\n\n<p>The error occurs in this line:  </p>\n\n<pre><code>Sheet1.Range(\"B1\").Value = Sheet1.Range(\"B1\").Value - TimeValue(\"00:00:01\")\n</code></pre>\n\n<p>The error is type mismatch variant\\string vs variant\\integer.  </p>\n\n<p>The code is exactly what is shown on an youtube video.  In the video it worked just fine.</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=sbJeGG_Xv8M\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=sbJeGG_Xv8M</a></p>\n\n<p>Here is the code for the buttons and the routines.  </p>\n\n<p>Can someone please advise a fix?  I'd be very appreciative.</p>\n\n<p>Thanks!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n   starttimer\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n   stoptimer\nEnd Sub\n\nSub starttimer()\n   Application.OnTime Now + TimeValue(\"00:00:01\"), \"nexttick\"\nEnd Sub\n\nSub nexttick()\n   Sheet1.Range(\"B1\").Value = Sheet1.Range(\"B1\").Value - TimeValue(\"00:00:01\")\n   starttimer\nEnd Sub\n\nSub stoptimer()\n   Application.OnTime Now + TimeValue(\"00:00:01\"), \"nexttick\", , False\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web"], "comments": [{"owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "edited": false, "score": 0, "creation_date": 1556112555, "post_id": 55830883, "comment_id": 98327165, "body": "Not sure if this is the issue but I usually don&#39;t see this with the CALL keyword.  The pattern I&#39;m used to is targetElement = doc.getElementById(...)  [new line] if(Not targetElement Is Nothing) Then targetElement.Value = &quot;...&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 74, "user_id": 11334657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a1d1e108366422e8078b0e0bdd9859?s=128&d=identicon&r=PG&f=1", "display_name": "Flaw98", "link": "https://stackoverflow.com/users/11334657/flaw98"}, "edited": false, "score": 0, "creation_date": 1556112988, "post_id": 55831333, "comment_id": 98327427, "body": "Now it does work, can you explain me a bit what was wrong or explain me some rows of your code in the second part so I can learn. Thank you very much!! Appreciate it,"}, {"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "reply_to_user": {"reputation": 74, "user_id": 11334657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a1d1e108366422e8078b0e0bdd9859?s=128&d=identicon&r=PG&f=1", "display_name": "Flaw98", "link": "https://stackoverflow.com/users/11334657/flaw98"}, "edited": false, "score": 0, "creation_date": 1556113296, "post_id": 55831333, "comment_id": 98327626, "body": "problem that you loop range and dont change elements id"}], "tags": [], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "is_accepted": true, "score": 1, "last_activity_date": 1556113250, "last_edit_date": 1556113250, "creation_date": 1556112779, "answer_id": 55831333, "question_id": 55830883, "link": "https://stackoverflow.com/questions/55830883/complete-online-form-vba/55831333#55831333", "title": "Complete online form VBA", "body": "<p>I think somethink like that must be</p>\n\n<pre><code>Sub test()\n\n    Dim IeApp As Object\n    Dim IeDoc As Object\n    Dim ieEL As Object\n\n    Set IeApp = CreateObject(\"InternetExplorer.Application\")\n        IeApp.Visible = True ' make Explorer visible\n            IeApp.Navigate \"https://form.jotformeu.com/91133129129351\"\n        Do While IeApp.Busy: DoEvents: Loop ' wait for page load\n        'Do Until IeApp.readyState = READYSTATE_COMPLETE: DoEvents: Loop\n\n        Set IeDoc = IeApp.Document ' set loaded content to variable\n            For Each ieEL In IeDoc.getElementsByTagName(\"input\") ' loop all inputs\n                If InStr(ieEL.Name, \"activitate\") &gt; 0 Then ' check if inputs name has activate name\n                    i = i + 1 ' increment for pick up valaues from sheet\n                    ieEL.Value = ThisWorkbook.ActiveSheet.Cells(2, i).Value ' set value from sheets 2 row and i column\n                End If\n            Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 74, "user_id": 11334657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30a1d1e108366422e8078b0e0bdd9859?s=128&d=identicon&r=PG&f=1", "display_name": "Flaw98", "link": "https://stackoverflow.com/users/11334657/flaw98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 55831333, "answer_count": 1, "score": 1, "last_activity_date": 1556113250, "creation_date": 1556111470, "last_edit_date": 1556112383, "question_id": 55830883, "link": "https://stackoverflow.com/questions/55830883/complete-online-form-vba", "title": "Complete online form VBA", "body": "<p>I have created a test form <a href=\"https://form.jotformeu.com/91133129129351\" rel=\"nofollow noreferrer\">here</a> and I am trying to fill it out with values I have in an excel file.</p>\n\n<p>My code stops at the line: 'Call ie.Document.getelementbyid(\"input_11\").setAttribute(\"value\", activity)' and it does not copy the data from the first cell, this is how my excel file looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9XbDh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9XbDh.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>'Sub internet()\n\nDim ie As Object\nDim activitate As String\nDim LastRow As Long\nDim i, j As Integer\ni = 1\nLastRow = Cells.Find(What:=\"*\", SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row - 1\nj = 0\n\n'open page\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\nie.Navigate \"https://form.jotformeu.com/91133129129351\"\nDo\nDoEvents\nLoop Until ie.ReadyState = 4\n\nWhile i &lt; 11\nFor Each c In Range(\"2:2\")\nactivity = c.Value\nCall ie.Document.getelementbyid(\"input_11\").setAttribute(\"value\", activity)\nNext c\nWend\n\n\nEnd Sub'\n</code></pre>\n\n<p>I'm trying to get past this code error, thank you for your time!</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 1, "creation_date": 1556113118, "post_id": 55830821, "comment_id": 98327505, "body": "Can you share what happens when this runs and what (if any) error message you get?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1556123419, "post_id": 55830821, "comment_id": 98333886, "body": "Be careful when referencing both disc folders and outlook folders.  <code>Name</code> moves the saved attachment.  You need <code>olItem.Move DestinationFolder</code>.  You have not defined the destination folder.  <code>wdApp</code> is an Excel application but you are using Word commands.  Are you sure you still have workbooks with the extension &quot;xls&quot; which was used with Excel 2003.  &quot;xlsm&quot; is the extension for a macro-enabled workbook which seems more likely.  You have no &quot;\\&quot; between the root folder name and the subfolder name."}], "answers": [{"tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": true, "score": 1, "last_activity_date": 1556133425, "creation_date": 1556133425, "answer_id": 55837117, "question_id": 55830821, "link": "https://stackoverflow.com/questions/55830821/search-for-text-in-attachments/55837117#55837117", "title": "Search for text in attachments", "body": "<p>I had a quick glance at your code and noticed an error so reported it in a comment.  I then noticed another error and another and another all of which I reported in the comment.  It was only after posting the comment that I wondered how much sense my comment would make to the author of this code.  This answer is an enlarged version of the comment.  It should help you improve your code but there is too much missing to provide a complete answer.</p>\n\n<ol>\n<li><p>In <code>Set wdApp = GetObject(, \"Excel.Application\")</code>, <code>wdApp</code> is the sort of name given to a Word application.  My guess is you found some code that used Word to do something and adapted it.  <code>Set wdDoc = wdApp.Documents.Open(strFilename)</code> is invalid for an Excel application.  I suggest using the name <code>xlApp</code>.  The workbook open and the search code will have to be rewritten for Excel.</p></li>\n<li><p>You do not include the code for <code>FolderExists</code> and <code>CreateFolders</code> but I would be surprised if they did not use <code>FileSystemObject</code>.  Both <code>FileSystemObject</code> and <code>Outlook</code> have a data type <code>Folder</code>.  If all this code is within Outlook, <code>Folder</code> is interpreted as <code>Outlook.Folder</code> and <code>FolderExists</code> and <code>CreateFolders</code> may not work.  If necessary, you need to replace data type <code>Folder</code> within these routines with <code>Scripting.Folder</code>.</p></li>\n<li><p><code>Set olItems = Session.GetDefaultFolder(olFolderInbox).Items</code> does not work on my system.  I am a home user with two email addresses each with its own store and Inbox.  The default Inbox is not used.  If you are a corporate user with a single email address then your default Inbox is probably the Inbox you want.</p></li>\n<li><p>You write: \u201cIf this \"string\" exists I want the mails move to another folder.\u201d  I interpreted this to mean you wanted to move the Outlook <code>MailItem</code> to a different Outlook folder.  This is why I criticised you for using <code>Name</code> which renames a disc file or moves it to a different disc folder with, optionally, a new name.  I now wonder if you meant you wanted to move the saved attachment.</p></li>\n<li><p>This answer need a paragraph here explaining how to move a <code>MailItem</code> or moved the saved attachment whichever it is you want.  Please add a comment to this answer explaining which you want.</p></li>\n<li><p>In <code>Const strPath As String = \" my_root \"</code>, I appreciate that \u201cmy_root\u201d is just a place holder so you do not have to reveal something that might be confidential.  Let us assume the true value is \u201cC:\\Users\\Georg\\Documents\u201d.  If this were true, you are creating a path of \u201cC:\\Users\\Georg\\Documentsmy_string\u201d.  If the true value is \u201cC:\\Users\\Georg\\Documents\\\u201d, you are creating a path of \u201cC:\\Users\\Georg\\Documents\\my_string\u201d.  Either way, you are assuming the true value of \u201cmy_string\u201d does not contain characters that are invalid within a folder name.  I do not understand why you need the folder name to include the search string.  This is just a temporary folder for use in testing attachments.  Why not call it \u201cC:\\Users\\Georg\\Documents\\SavedAttachments\u201d or some other temporary folder?    </p></li>\n<li><p>Please be careful delimiting folder and file names.  You use <code>Chr(32)</code> and <code>Chr(92)</code>.  I assume <code>Chr(32)</code> is a mistake.  Why not write \u201c\\\u201d instead of <code>Chr(92)</code> which is so much clearer?  I use <code>Chr()</code> when necessary but normally writing the character is clearer.  Anyone who has used File Explorer will know about \u201c\\\u201d but how many know what <code>Chr(92)</code> means without looking it up. </p></li>\n<li><p>I do not understand the complex filename you give to the saved attachments.  If the attachment is wanted to move it to a different folder with a different name.  If the attachment is not wanted, you should delete it using <code>Kill</code>.  Either way some simple. Fixed filename is all you need.</p></li>\n<li><p>Do you know how to search a workbook for a particular string?  All your existing code is for opening and searching a Word document.</p></li>\n</ol>\n\n<p>I have numbered my paragraphs so you can reference them easily if you need to ask a question.</p>\n"}], "owner": {"reputation": 92, "user_id": 11183691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a68336a9fb6db28e3c757148aedda95?s=128&d=identicon&r=PG&f=1", "display_name": "Georg", "link": "https://stackoverflow.com/users/11183691/georg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 55837117, "answer_count": 1, "score": 0, "last_activity_date": 1592554764, "creation_date": 1556111297, "last_edit_date": 1592554764, "question_id": 55830821, "link": "https://stackoverflow.com/questions/55830821/search-for-text-in-attachments", "title": "Search for text in attachments", "body": "<p>I want to search for \"string = my_string\" in my attachments in outlook Inbox folder. If this \"string\" exists i want the mails move to another folder. I found a code, i tried to improve it, but it's still not working. Any help would be much appreciated.</p>\n\n<p><strong>EDIT</strong>\nHere is the code : </p>\n\n<pre><code> Sub test2()\n Const strFindText As String = \"Completed\"\n Const strFileType As String = \"xlsx|xls\"\n Const strPath As String = \"C:\\Users\\PC2\\Documents\\Georg\\Attachment\\\"\nDim vFileType As Variant\n Dim strFilename As String\n Dim strName As String\n Dim olItems As Outlook.Items\n Dim olItem As Outlook.MailItem\n Dim wb As Object\n Dim xlApp As Object\n Dim olAttach As Outlook.Attachment\n Dim strFolder As String\n Dim bStarted As Boolean\n Dim bFound As Boolean\n Dim i As Long, i_V As Long\nDim fdObj As FileSystemObject\n    Set fdObj = CreateObject(\"Scripting.FileSystemObject\")\n\n    On Error Resume Next\n    Set xlApp = GetObject(, \"Excel.Application\")\n    If Err Then\n        Set xlApp = CreateObject(\"Excel.Application\")\n        bStarted = True\n    End If\n    On Error GoTo 0\n    xlApp.Visible = True\n\nIf Not fdObj.FolderExists(strPath &amp; strFindText) \n Then fdObj.CreateFolder strPath &amp; strFindText\nEnd If\n\nSet olItems = Session.GetDefaultFolder(olFolderInbox).Items\nFor i = olItems.Count To 1 Step -1\n   Set olItem = olItems(i)\n   If olItem.Attachments.Count &gt; 0 Then\n   vFileType = Split(strFileType, \"|\")\n   For Each olAttach In olItem.Attachments\n   For i_V = 0 To UBound(vFileType)\n   If Right(LCase(olAttach.FileName), Len(vFileType(i_V))) = vFileType(i_V)\n Then strFilename = strPath &amp; \n Format(olItem.ReceivedTime, \"yyyymmdd-HHMMSS\") &amp; _\" \" &amp; olAttach.FileNameolAttach.SaveAsFile strFilename\n\n    Set wb = xlApp.Workbooks.Open(strFilename)\n    With xlApp.Find(strFilename, xlValues, xlWhole)\n        bFound = False\n    Do While .Find(strFindText).Activate    '&lt;-I have problem here\n        bFound = True\n    Loop\n    strName = wb.Name\n    wb.Close 0\n        If bFound Then\n        Name strFilename As strPath &amp; strFindText &amp; \"\\\" &amp; strName\n        End If\n    End With\nEnd If\nNext i_V\nNext olAttach\nEnd If\n\nNext i\n    If bStarted Then xl.App.Quit\n    Set wb = Nothing\n    Set xlApp = Nothing\n    Set olItem = Nothing\n    Set olItems = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1556111954, "post_id": 55830704, "comment_id": 98326701, "body": "I&#39;ve done similar and found it much easier to <i>delete</i> the unneeded slides from a copy of the template of all slides, then <code>.SaveAs</code> than it was to copy them into a new, blank PPT. Without care, you end up losing a lot of formatting, especially if you&#39;re using any sort of custom template in the slides. I&#39;m sure it&#39;s possible to retain it, but I found it easier to go the other way."}, {"owner": {"reputation": 11, "user_id": 11405416, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211534154162602/picture?type=large", "display_name": "Steffen Hartmann", "link": "https://stackoverflow.com/users/11405416/steffen-hartmann"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1556112690, "post_id": 55830704, "comment_id": 98327266, "body": "Thanks! That would also work for me. Do you have code that you can perhaps share from your similar efforts?"}], "owner": {"reputation": 11, "user_id": 11405416, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211534154162602/picture?type=large", "display_name": "Steffen Hartmann", "link": "https://stackoverflow.com/users/11405416/steffen-hartmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556111787, "creation_date": 1556110963, "last_edit_date": 1556111787, "question_id": 55830704, "link": "https://stackoverflow.com/questions/55830704/extracting-certain-powerpoint-slides-based-on-an-excel-table-and-combine-to-new", "title": "Extracting certain Powerpoint slides based on an Excel table and combine to new presentation", "body": "<p>I have a huge PPT presenation (>400 slides) and want to extract certain pages based on an Excel table and create a new, smaller presentation. \nI created an Excel table which includes the page numbers as well as the title of each slide in the PPT presentation. </p>\n\n<p>The goal now is, to have a macro that allows me to create a new PPT with all the slides that are mentioned in my (sorted) Excel table.</p>\n\n<p>As I am new with VBA (I am only able to copy/paste code and run it afterwards), I was not able to try anything.\nThanks for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 0, "creation_date": 1556111531, "post_id": 55830594, "comment_id": 98326373, "body": "Are you hoping to store strings or decimals in your table based on these inputs?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1556111626, "post_id": 55830594, "comment_id": 98326440, "body": "You can check for numeric input"}, {"owner": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "reply_to_user": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "edited": false, "score": 0, "creation_date": 1556112161, "post_id": 55830594, "comment_id": 98326866, "body": "@MichaelMurphy i&#39;d say strings. The information on the table will later be printed to a word document that requires Hours and minutes."}, {"owner": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1556112290, "post_id": 55830594, "comment_id": 98326970, "body": "@JvdV I tried <code>if not Isnumeric</code> but it triggers on the colon and tells me it&#39;s not a number."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1556112368, "post_id": 55830594, "comment_id": 98327034, "body": "@RappaportXXX, you could first check for the colon, and right after check both the left and right for numeric values?"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "edited": false, "score": 0, "creation_date": 1556121545, "post_id": 55831341, "comment_id": 98332898, "body": "i&#39;m not great with functions where would i place this? inside my sub or replace the sub altogether?"}, {"owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "reply_to_user": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "edited": false, "score": 1, "creation_date": 1556123814, "post_id": 55831341, "comment_id": 98334093, "body": "Functions can be really valuable to figure out and I believe you&#39;re already partway to understanding how they work given you have <code>Sub FormatHHMM(textbox As Object)</code> in your code. I will edit shortly to provide you with the <code>Sub</code> version of my method."}, {"owner": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "edited": false, "score": 0, "creation_date": 1557497148, "post_id": 55831341, "comment_id": 98796571, "body": "Sorry for the delay in coming back to this, played around with this and got it to work based off your code. Just in time to be told my project isn&#39;t needed anymore but i learned something anyways lol. Thanks."}], "tags": [], "owner": {"reputation": 341, "user_id": 8826022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebb38589eec35643089af93724c1d9b3?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Murphy", "link": "https://stackoverflow.com/users/8826022/michael-murphy"}, "is_accepted": true, "score": 1, "last_activity_date": 1556124115, "last_edit_date": 1556124115, "creation_date": 1556112793, "answer_id": 55831341, "question_id": 55830594, "link": "https://stackoverflow.com/questions/55830594/restrict-userform-textbox-input-to-hmm/55831341#55831341", "title": "Restrict Userform Textbox input to [H]:MM", "body": "<p>Have you tried using the <code>Like</code> operator? That allows checking for numeric values in each character-position. I would do it like this:</p>\n\n<pre><code>Function FormatCheck(ByVal strEntered As String)\n\nDim correctformat As Boolean\n\nIf strEntered Like \"*#:##\" And IsNumeric(Mid(strEntered, 1, InStr(1, strEntered, \":\", 1) - 1)) Then\n    If Mid(strEntered, InStr(1, strEntered, \":\", 1) + 1, 999) &lt;= 59 Then\n        correctformat = True\n    End If\nEnd If\n\nIf Not correctformat Then FormatCheck = \"Incorrect format\"\n\nEnd Function\n</code></pre>\n\n<p>This requires at least one number before the \":\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/O2zeb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O2zeb.png\" alt=\"Testing\"></a></p>\n\n<p>Edit: Below is a <code>Sub</code> version instead of using a <code>Function</code>. This will pop up a <code>MsgBox</code> like you were using originally. You could probably replace your whole <code>FormatHHMM</code> sub with this without any adverse effect.</p>\n\n<pre><code>Sub FormatCheck(ByVal strEntered As String)\n\nDim correctformat As Boolean\n\nIf strEntered Like \"*#:##\" And IsNumeric(Mid(strEntered, 1, InStr(1, strEntered, \":\", 1) - 1)) Then\n    If Mid(strEntered, InStr(1, strEntered, \":\", 1) + 1, 999) &lt;= 59 Then\n        correctformat = True\n    End If\nEnd If\n\nIf Not correctformat Then MsgBox \"Incorrect format\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11405663, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/814339ec32ceece15d2106daa2cb900d?s=128&d=identicon&r=PG", "display_name": "lospyrosmrgyros", "link": "https://stackoverflow.com/users/11405663/lospyrosmrgyros"}, "is_accepted": false, "score": 2, "last_activity_date": 1556112969, "creation_date": 1556112969, "answer_id": 55831399, "question_id": 55830594, "link": "https://stackoverflow.com/questions/55830594/restrict-userform-textbox-input-to-hmm/55831399#55831399", "title": "Restrict Userform Textbox input to [H]:MM", "body": "<p>How about you split hours and minutes into two seperate input fields on the same inputbox.\nSo the user has to type in hours and in the next field minutes. This way you can check the input for isnumeric and >60 for seconds.\nI know this is not ideal, but it would be a way to evade the given problems.</p>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1556117449, "last_edit_date": 1556117449, "creation_date": 1556113380, "answer_id": 55831528, "question_id": 55830594, "link": "https://stackoverflow.com/questions/55830594/restrict-userform-textbox-input-to-hmm/55831528#55831528", "title": "Restrict Userform Textbox input to [H]:MM", "body": "<p>i think this may be helpful:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim str As String\n\n    str = TextBox.Value\n\n    'Test string lenght. Maximun lenght number 4\n    If Len(str) &lt;&gt; 4 Then\n        MsgBox \"Enter a valid time. Proper number of digits are 4.\"\n        Exit Sub\n    End If\n\n    'Test if string includes only one \":\"\n    If (Len(str) - Len(Replace(str, \":\", \"\"))) / Len(\":\") &lt;&gt; 1 Then\n        MsgBox \"Use only one \"\":\"\" to separate time.\"\n        Exit Sub\n    End If\n\n    'Test how many digits are before and after \":\"\n    If InStr(1, str, \":\") &lt;&gt; 2 Then\n        MsgBox \"\"\":\"\" position should be place 2.\"\n        Exit Sub\n    End If\n\n    'Test if number 1,3 &amp; 4 are number\n    If IsNumeric(Mid(str, 1, 1)) = False Or IsNumeric(Mid(str, 1, 1)) = False Or IsNumeric(Mid(str, 1, 1)) = False Then\n        MsgBox \"Enter number in position 1,3 and 4.\"\n        Exit Sub\n    End If\n\n   'Test 2 last to digits\n    If Right(str, 2) &lt;= 60 Then\n        MsgBox \"Second limit is 60.\"\n        Exit Sub\n    End If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 114, "user_id": 3294310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dgtaj.jpg?s=128&g=1", "display_name": "PonderingPanda", "link": "https://stackoverflow.com/users/3294310/ponderingpanda"}, "is_accepted": false, "score": 0, "last_activity_date": 1556117958, "creation_date": 1556117958, "answer_id": 55833097, "question_id": 55830594, "link": "https://stackoverflow.com/questions/55830594/restrict-userform-textbox-input-to-hmm/55833097#55833097", "title": "Restrict Userform Textbox input to [H]:MM", "body": "<p>You could use regular expressions :</p>\n\n<pre><code>Sub inputTimeFormat()\n    Dim userInput As String\n    Dim strPattern As String\n    Dim msgBoxText As String\n    Dim regEx As New RegExp\n    Dim objRegex As Object\n\n    strPattern = \"(^[0-9]+):([0-5])([0-9])$\"\n    msgBoxText = \"Insert time in HH:mm, or hit Cancel to escape\"\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n\n    With regEx\n        .ignorecase = True\n        .Pattern = strPattern\n        Do\n            If userInput &lt;&gt; vbNullString Then msgBoxText = \"PLEASE RETRY\" &amp; Chr(13) &amp; msgBoxText\n            userInput = Application.InputBox(msgBoxText, Default:=\"17:01\")\n            If userInput = \"False\" Then\n                MsgBox \"User hit cancel, exiting code\", vbCritical\n                Exit Sub\n            End If\n        Loop Until .Test(userInput)\n    End With\n\n    MsgBox \"Format OK\"\n\nEnd Sub\n</code></pre>\n\n<p>(you need to activate regular expressions : in VBA, \"Tools\" > \"References\" > Check the box \"Microsoft VBScript Regular Expressions 5.5\" > \"OK\")\nMore details on <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">How to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</a></p>\n"}], "owner": {"reputation": 119, "user_id": 7580965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d3711f1a3520364b06d499d4059e033?s=128&d=identicon&r=PG&f=1", "display_name": "RappaportXXX", "link": "https://stackoverflow.com/users/7580965/rappaportxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 55831341, "answer_count": 4, "score": 0, "last_activity_date": 1556124115, "creation_date": 1556110617, "question_id": 55830594, "link": "https://stackoverflow.com/questions/55830594/restrict-userform-textbox-input-to-hmm", "title": "Restrict Userform Textbox input to [H]:MM", "body": "<p>I have multiple textboxes on multiple userforms that are for time allocations. For simplicity say userform1 &amp; userform2, with textbox1 &amp; textbox2 on each. \nUserform1 is for user input, which places values into a table and userform2 pulls the values from this table and displays in the relevant textbox. I need to restrict both the input of these boxes and the display to the [H]:mm format where minutes cannot exceed 59 but hours can be 25+ i.e 125:59 but not 4:67</p>\n\n<p>I tried a combination of code from both of these threads as well as others but can't seem to get it to work.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/36719179/excel-vba-textbox-time-validation-to-hmm\">Excel VBA Textbox time validation to [h]:mm</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/42374948/time-format-of-text-box-in-excel-user-form\">Time format of text box in excel user form</a></p>\n\n<p>eventually i just tried to manipulate user input with message boxes but this still leaves entries open to error</p>\n\n<pre><code>Sub FormatHHMM(textbox As Object)\n\nDim timeStr As String\n\nWith textbox\n\n'Check if user put in a colon or not\n     If InStr(1, .Value, \":\", vbTextCompare) = 0 And Len(.Value) &gt; 1 Then\n\n        MsgBox \"Please use HH:mm Format\"\n\n        textbox.Value = \"\"\n        textbox.SetFocus\n    Else\n        If Right(.Value, 2) &gt; 60 Then\n\n        MsgBox \"Minutes cannot be more than 59\"\n\n        textbox.Value = \"\"\n        textbox.SetFocus\n\n        End If\n\nEnd If\nEnd With\n\n\nEnd Sub\n</code></pre>\n\n<p>this allows users put alpha characters in and even if correctly input when called from the table is shows as a value instead i.e 5.234... instead of 125:59</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7418, "user_id": 2983632, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/IvTM4.png?s=128&g=1", "display_name": "ttaaoossuu", "link": "https://stackoverflow.com/users/2983632/ttaaoossuu"}, "edited": false, "score": 0, "creation_date": 1556109193, "post_id": 55829722, "comment_id": 98324926, "body": "Did you try to use <code>ActiveWorkbook.Names</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 10533391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yvqFL.jpg?s=128&g=1", "display_name": "NigelH", "link": "https://stackoverflow.com/users/10533391/nigelh"}, "edited": false, "score": 0, "creation_date": 1556139951, "post_id": 55835381, "comment_id": 98341082, "body": "Sorry this doesn&#39;t work with my application, it just duplicates the first formula found in all cells with a formula."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "reply_to_user": {"reputation": 87, "user_id": 10533391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yvqFL.jpg?s=128&g=1", "display_name": "NigelH", "link": "https://stackoverflow.com/users/10533391/nigelh"}, "edited": false, "score": 0, "creation_date": 1556144414, "post_id": 55835381, "comment_id": 98342457, "body": "Apologies for that published the old version, pls see the updated answer..."}], "tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": true, "score": 0, "last_activity_date": 1556144903, "last_edit_date": 1556144903, "creation_date": 1556126202, "answer_id": 55835381, "question_id": 55829722, "link": "https://stackoverflow.com/questions/55829722/how-to-resolve-range-names-without-selecting-cells/55835381#55835381", "title": "How to resolve Range Names without selecting cells", "body": "<p>Although I could not replicate the problem as created by a <em>\"copy\" of a worksheet</em>, I was able to generate <em>\"<code>Formula</code>s in <code>Error</code> due to missing <code>Names</code>\"</em>. </p>\n\n<p>The following procedure updated the <code>Formulas</code> in <code>Error</code> for which the <code>Names</code> were present in the <code>Workbook</code>, leaving the error only to the nonexistent <code>Name</code>.</p>\n\n<pre><code>Sub Formulas_InError_Refresh()\nDim wb As Workbook\nDim rErr As Range\nDim rArea As Range\n    Set wb = ActiveWorkbook 'Change to the required workbook\n    Set rErr = wb.Worksheets(\"Results\").UsedRange.SpecialCells(xlCellTypeFormulas, xlErrors)\n    For Each rArea In rErr.Areas\n        With rArea\n            .Formula = .Formula\n    End With: Next\n    End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Vz5vs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vz5vs.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 87, "user_id": 10533391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yvqFL.jpg?s=128&g=1", "display_name": "NigelH", "link": "https://stackoverflow.com/users/10533391/nigelh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 55835381, "answer_count": 1, "score": 2, "last_activity_date": 1556144903, "creation_date": 1556107751, "last_edit_date": 1556108903, "question_id": 55829722, "link": "https://stackoverflow.com/questions/55829722/how-to-resolve-range-names-without-selecting-cells", "title": "How to resolve Range Names without selecting cells", "body": "<p>Is it possible to force Excel to resolve All Range Names with VBA when importing a worksheet? In some instances the names do not resolve until individual cells are selected, highlighted in the formula bar then deselected.\nIt appears that if the sheet contains any name that does not exist in the name manager, all subsequent names are ignored. </p>\n\n<p>My application is running the VBA code in a 'manager' workbook, from there I open a second 'template' workbook for generating a test report. Report pages (worksheets) can be appended to the template with a ribbon control. These appended worksheets  have various cells with names to automatically fill-in the report from data already in the template workbook. \nSo for example when worksheet(\"Results\") is imported the view shows:</p>\n\n<pre><code>Address     Formula       Value     Display\nF18        =WeightAir     335        335\nF19        =WeightWater   Name missing in this workbook\nB39        =Length        1.1       #NAME?\nC47        =Author        N H       #NAME?\n</code></pre>\n\n<p>If I select cell C47, click in the Formula Bar and back out again the cell value is correctly displayed. Cell B39 remains in error. \nThere are other cells in the same worksheet not getting populated, this is just to show an example.\nI have tried using VBA to select a range of cells (including all that show #NAME? error) to force calculation but this seems to have no effect</p>\n\n<pre><code>DestWB.Worksheets(ShtCount).Range(\"A1\", \"Z65536\").Select\nDestWB.Worksheets(ShtCount).Calculate\nDestWB.Worksheets(ShtCount).Range(\"A1\").Select\n</code></pre>\n\n<p>I picked up a suggestion to use this which I apply before closing the 'source workbook'</p>\n\n<pre><code>DestWB.Worksheets(ShtCount).UsedRange.Formula = _\n          OrigWB.Worksheets(1).UsedRange.Formula\n</code></pre>\n\n<p>But if the sheet contains any name that does not exist in the name manager, for this workbook, all subsequent (i.e. cells with higher column,row address) names are ignored. \nIs there a way to force all <strong>known</strong> names to resolve, leaving only missing values?\nAny suggestions please?</p>\n"}, {"tags": ["sql", "sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 1819, "user_id": 1623043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f8874b8274fb3a663bd7a75cb7df80?s=128&d=identicon&r=PG", "display_name": "Kevin Cook", "link": "https://stackoverflow.com/users/1623043/kevin-cook"}, "edited": false, "score": 0, "creation_date": 1556106338, "post_id": 55829272, "comment_id": 98323242, "body": "If the data isn&#39;t changing, why do you need to update the table so many times per second?  I would write the code to only update if a change actually happens."}, {"owner": {"reputation": 1110, "user_id": 9940803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jooUR.jpg?s=128&g=1", "display_name": "Sanpas", "link": "https://stackoverflow.com/users/9940803/sanpas"}, "edited": false, "score": 0, "creation_date": 1556106612, "post_id": 55829272, "comment_id": 98323398, "body": "I have you try for SSIS Lot : (<a href=\"https://www.google.com/search?client=firefox-b-d&amp;q=SSIS+Excel+to+SQL+Server+datatable\" rel=\"nofollow noreferrer\">google.com/&hellip;</a>) or example (<a href=\"https://www.red-gate.com/simple-talk/sql/ssis/moving-data-from-excel-to-sql-server-10-steps-to-follow/\" rel=\"nofollow noreferrer\">red-gate.com/simple-talk/sql/ssis/&hellip;</a>)"}, {"owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "edited": false, "score": 0, "creation_date": 1556106743, "post_id": 55829272, "comment_id": 98323474, "body": "The data is changing, I measure every 10 milliseconds a current sample. I want to save the data in the sql database and visualize the actual data with software that reads the database. I think that if the data to the sql server updates 5 times /second it is good enough."}, {"owner": {"reputation": 2092, "user_id": 7926183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff222c5bfb610f85712e726ee7c5f93?s=128&d=identicon&r=PG&f=1", "display_name": "SMor", "link": "https://stackoverflow.com/users/7926183/smor"}, "edited": false, "score": 0, "creation_date": 1556116841, "post_id": 55829272, "comment_id": 98330097, "body": "Think again. Without knowing how you intend to represent this information, I can guess that it is likely (perhaps highly likely) that no one will be able to even recognize sub-second changes to your data. Not only does your &quot;application&quot; need to update the database but something &quot;pulling&quot; it must also recognize (or poll for) changes, retrieve that information, and then convert it into whatever graphical form you have (or intend). You should consider a more robust coding environment."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1556118028, "post_id": 55829272, "comment_id": 98330837, "body": "I think SMor is right and you should re-think and this is probably a <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">X-Y-Question</a>. You asked X but your actual problem is Y. Can you explain a bit more about the background of your task? I think you are on the wrong path. \u2022 Why is there a need for 5 times a second? If it is for visualisation even once a second would be hard to follow for humans. \u2022 I would push all the measurment data into SQL (including a timestamp) and then use any other tool to visualize by querying the database when needed."}, {"owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "edited": false, "score": 0, "creation_date": 1556169622, "post_id": 55829272, "comment_id": 98347273, "body": "I use a data acquisition device to sample a current of a servomotor. I measure every 10 milliseconds a sample. The servomotor have a moving cycle of 3.15 seconds. I get the data in excel and I want to transfer the data to a sql server. I can read the data with scada/hmi visualization software (Ignition Automation) in a trend. I want to have the data (including timestamp) of the last minute. I have made a FiFo (first in first out) in excel and I want to send the FiFo 5 times/second to the sql server. It is for the operator to see the actual servomotor currents to monitor them."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556173891, "post_id": 55829272, "comment_id": 98348699, "body": "Why don&#39;t you push <i>all</i> the measurements raw to the database (as they are measured) and let the visualization tool query only the last minute data? To ensure your database does not grow too fast you could easily delete everything that is older than eg 5 or 10 minutes (each time you push new data). I think that would be much easier than having a time critical process in VBA (which does not support multithreading and therefore makes time critical things quite hard). Actually I think values updating visually 5 times a second is a heavy load for a human brain, don&#39;t you?"}, {"owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "edited": false, "score": 0, "creation_date": 1556175297, "post_id": 55829272, "comment_id": 98349318, "body": "Yes that&#39;s possible but is it possible to send that fast? I have 8 measurements on 1 data acquisition device, so it means that I need to send 8 cells in excel to sql server every 10 milliseconds. the operator sees a trend line and not a decimal value that updates 5 times/second."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556178607, "post_id": 55829272, "comment_id": 98350990, "body": "@Mitchel Actually if you need data every 0.2 seconds then just measure every 0.2 seconds. What is the actual reason of measuring all the data and produce a heavy load and finally dump most of it? The issue here is VBA, if you need to do something every 0.2 seconds and the action to process it needs 0.21 then it doesn&#39;t work anymore because VBA does not support multi-threading. Therefore I would re-think to use VBA if it is time critical."}, {"owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "edited": false, "score": 0, "creation_date": 1556180374, "post_id": 55829272, "comment_id": 98351881, "body": "I need to have a sample every 10 milliseconds because I need to check the current profile. The movement of the servomotor is very fast (3,15 seconds) some peaks are from 1 to 8 amps within 80 milliseconds. To visualize the current in good resolution I need to sample the current every 10 ms. it is not enough to know the peak value. The operator can see on the current profile if the settings of the machine are good."}, {"owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "edited": false, "score": 0, "creation_date": 1556183014, "post_id": 55829272, "comment_id": 98353296, "body": "the data acquisition device update automatically the cell every 10ms, when I send the value to the sql server on cell change in excel it will work? then i create a fifo in the sql server."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556183690, "post_id": 55829272, "comment_id": 98353672, "body": "You could give it a try on cell change but I assume if your code needs more than 10ms to proceed the insert/update query it will probably disturb the update of the cell."}, {"owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "edited": false, "score": 0, "creation_date": 1556186650, "post_id": 55829272, "comment_id": 98355481, "body": "if it takes more time for the code to proceed I can buffer 10 values so the code have 100ms to proceed. But it brings me back to my first question, the code in my first post can only read from the database. can someone help my to modify the code that I can write to the sql database? Thanks for the help so far I appreciate it."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556194726, "post_id": 55829272, "comment_id": 98360009, "body": "@Mitchel <a href=\"https://stackoverflow.com/questions/3767879/insert-data-from-excel-into-sql-db\">INSERT data from Excel into SQL DB</a> If you reaseach you will find more tutorials for that task than you can read."}, {"owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "edited": false, "score": 0, "creation_date": 1556260675, "post_id": 55829272, "comment_id": 98384414, "body": "I have read a lot and tried a lot of codes but nothing will work. I tried to use the code in the link but I do something wrong with the columns."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556263238, "post_id": 55829272, "comment_id": 98385583, "body": "How do you expect us to help/explain you what you did wrong if you don&#39;t show us what you did. <i>&quot;Did not work&quot;</i> is not an error description. Please ask a new question for that. Show the code you have tried, include which errors you got and in which line. Explain what your raw data looks like and what your expected result should look like (screenshots can help to illustrate/explain). Please have a look at <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> this might help you to write a good question, that we are possible to answer."}], "owner": {"reputation": 1, "user_id": 11404892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed9e772a4fefde290be17c2f8952da88?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchel", "link": "https://stackoverflow.com/users/11404892/mitchel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556286381, "creation_date": 1556106145, "last_edit_date": 1556286381, "question_id": 55829272, "link": "https://stackoverflow.com/questions/55829272/send-column-from-excel-to-mssql-5-times-per-second", "title": "Send column from excel to MSSQL 5 times per second", "body": "<p>I need to transfer 5 times per second excel columns to an mssql server. I want to overwrite the existing data in the sql server. I have tried a lot of code on the internet but it will not work. I have a working code to read a sql table to a worksheet in excel. Is it possible to write the data to the sql server? I have not much experience with vba or a sql server. I hope someone can help with the code. </p>\n\n<p>I have post my working code to read the data out of the table in the SQL server, I have have deleted the password. Sorry for bad English.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ADOExcelSQLServer()\n\n\n   ' Carl SQL Server Connection\n  '\n   ' FOR THIS CODE TO WORK\n    ' In VBE you need to go Tools References and check Microsoft Active X Data Objects 2.x library\n\n    Dim cn As ADODB.Connection\n    Dim Server_Name As String\n    Dim Database_Name As String\n    Dim User_ID As String\n    Dim Password As String\n    Dim SQLStr As String\n    Dim rs As ADODB.Recordset\n    Set rs = New ADODB.Recordset\n\n    Server_Name = \"NLDONL0113\" ' Enter your server name here\n    Database_Name = \"Stroomwaarden\" ' Enter your database name here\n    User_ID = \"Admin\" ' enter your user ID here\n    Password = \"\" ' Enter your password here\n    SQLStr = \"SELECT * FROM [Stroomwaarde]\" ' Enter your SQL here\"\n\n    Set cn = New ADODB.Connection\n  cn.Open \"Driver={SQL Server};Server=\" &amp; Server_Name &amp; \";Database=\" &amp; Database_Name &amp; _\n   \";Uid=\" &amp; User_ID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\n   rs.Open SQLStr, cn, adOpenStatic\n    ' Dump to spreadsheet\n   With Worksheets(\"sheet1\").Range(\"M3:M500\") ' Enter your sheet name and range here\n       .ClearContents\n       .CopyFromRecordset rs\n   End With\n    '            Tidy up\n   rs.Close\n   Set rs = Nothing\n   cn.Close\n   Set cn = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "bloomberg"], "comments": [{"owner": {"reputation": 1145, "user_id": 3466329, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b2090db900c8e9809f08595aede453e?s=128&d=identicon&r=PG&f=1", "display_name": "Romain", "link": "https://stackoverflow.com/users/3466329/romain"}, "edited": false, "score": 0, "creation_date": 1556104098, "post_id": 55828392, "comment_id": 98321820, "body": "Welcome Marky Mark, could you show us your code ?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556104179, "post_id": 55828392, "comment_id": 98321875, "body": "<code>...or changes through a formula.</code> How are you tracking that?"}, {"owner": {"reputation": 11, "user_id": 11404720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a6227db3a078201b80e36de06dd9f2?s=128&d=identicon&r=PG&f=1", "display_name": "Marky Mark", "link": "https://stackoverflow.com/users/11404720/marky-mark"}, "edited": false, "score": 0, "creation_date": 1556104847, "post_id": 55828392, "comment_id": 98322321, "body": "Please see code..."}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 2, "creation_date": 1556108577, "post_id": 55828392, "comment_id": 98324554, "body": "Changes are done by the bloomberg API via a different route and it doesn&#39;t trigger the <code>Worskheet_Change</code> events. You could run a task every x seconds to check if the content has changed and do whatever you need if it has. A possibly better way would be to create a subscription in your code directly - you will then receive events directly in your code every time the value changes."}, {"owner": {"reputation": 11, "user_id": 11404720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a6227db3a078201b80e36de06dd9f2?s=128&d=identicon&r=PG&f=1", "display_name": "Marky Mark", "link": "https://stackoverflow.com/users/11404720/marky-mark"}, "reply_to_user": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1556109305, "post_id": 55828392, "comment_id": 98325004, "body": "@assylias thank you"}], "owner": {"reputation": 11, "user_id": 11404720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97a6227db3a078201b80e36de06dd9f2?s=128&d=identicon&r=PG&f=1", "display_name": "Marky Mark", "link": "https://stackoverflow.com/users/11404720/marky-mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556105306, "creation_date": 1556103193, "last_edit_date": 1556105306, "question_id": 55828392, "link": "https://stackoverflow.com/questions/55828392/excel-macro-not-recognizing-change-in-dynamic-bloomberg-data", "title": "Excel Macro not recognizing change in Dynamic Bloomberg Data", "body": "<p>I wrote a simple macro in Excel that records a change in a cell with a date.\nThe macro works when the value in the cell is typed or changes through a formula.</p>\n\n<p>When I use dynamic data from the Bloomberg API, and the data changes in Excel, the macro doesn't recognize the change in the cell and doesn't record it. </p>\n\n<pre><code>Dim xVal As String  \nDim iVal As Integer  \nPrivate Sub Worksheet_Change(ByVal Target As Range)  \n    Static xCount As Integer  \n      iVal = Application.WorksheetFunction.Count(Range(\"F:F\"), 1)  \n      xCount = iVal  \n    Application.EnableEvents = False  \n    If Target.Address = Range(\"C2\").Address Then  \n        Range(\"E3\").Offset(xCount, 0).Value = Range(\"C2\").Value  \n        Range(\"F3\").Offset(xCount, 0).Value = Now  \n        xCount = xCount + 1  \n    Else  \n        If xVal &lt;&gt; Range(\"C2\").Value Then  \n        Range(\"E3\").Offset(xCount, 0).Value = Range(\"C2\").Value  \n        Range(\"F3\").Offset(xCount, 0).Value = Now  \n        xCount = xCount + 1   \n        End If  \n    End If  \n    Application.EnableEvents = True  \nEnd Sub  \nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)  \n    xVal = Range(\"C2\").Value  \nEnd Sub  \n</code></pre>\n"}, {"tags": ["excel", "vba", "pdf"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 1, "last_activity_date": 1556102337, "creation_date": 1556102337, "answer_id": 55828111, "question_id": 55827436, "link": "https://stackoverflow.com/questions/55827436/force-quit-adobe-object-on-error-condition/55828111#55828111", "title": "force quit adobe object on error condition", "body": "<p>Incorporate Error handling in <code>SavePDFAsOtherFormatNoMsg</code>. This way the code will not break and will exit the sub gracefully. Also change it from a <code>Sub</code> to a <code>Function</code> which return a Boolean Value.</p>\n\n<p>Here is an example (<strong>Untested</strong>)</p>\n\n<pre><code>Dim tmpPath As String\n\nSub ExportAllPDFsText()\n    Dim success As Boolean\n    '\n    '~~&gt; Rest of the code\n    '\n\n    For i = 2 To LastRow\n        success = SavePDFAsOtherFormatNoMsg(Cells(i, 2).Value, Cells(i, 3).Value, FileFormat, i)\n\n        '~~&gt; I am taking Cells(i, 10) as an example\n        '~~&gt; Use some other cell where you want the output\n        If success = False Then\n            Cells(i, 10).Value = \"File Not Saved\"\n        Else\n            '~~&gt; Double check if the file was created\n            If Dir(tmpPath) &lt;&gt; \"\" Then _\n            Cells(i, 10).Value = \"File Saved Successfully\"\n        End If\n    Next i\n\n    '\n    '~~&gt; Rest of the code\n    '\nEnd Sub\n\nFunction SavePDFAsOtherFormatNoMsg(pdfPath As String, OutPath As String, _\nFileExtension As String, c As Integer) As Boolean\n    tmpPath = \"\"\n\n    On Error GoTo Whoa\n\n    '\n    '~~&gt; Rest of the code\n    '\n\n    tmpPath = NewFilePath\n    SavePDFAsOtherFormatNoMsg = True\n\n    Exit Function\nWhoa: \n    '&lt;~~ Exit function. If you wish you can show error message here\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 9808634, "user_type": "registered", "profile_image": "https://graph.facebook.com/1623520797684346/picture?type=large", "display_name": "isomericharsh", "link": "https://stackoverflow.com/users/9808634/isomericharsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556102337, "creation_date": 1556100227, "last_edit_date": 1556100928, "question_id": 55827436, "link": "https://stackoverflow.com/questions/55827436/force-quit-adobe-object-on-error-condition", "title": "force quit adobe object on error condition", "body": "<p>Hi I am using vba code to trigger acrobat object to convert PDF to Excel. The code largely runs fine, however in between we get OLE errors related to issues with file viz. <strong>\"unable to locate paper capture recognition service\"</strong> (at 507 iteration of loop) and others. How can i modify my code to skip in such cases where I am getting OLE error and go to next execution. Also, How to capture if a file is successfully converted and capture that in main sheet. I am reading the file path from column c and writing if the file was sucessfuly exported in D (please see the code)</p>\n\n<pre><code>Sub ExportAllPDFsText()\n\n\n\n    Dim FileFormat As String\n'    Dim gllyphpath As String\n    Dim LastRow As Long\n    Dim i As Integer\n    Dim j As Integer\n\n    'Change this according to your own needs.\n    'Available formats: eps html, htm jpeg, jpg, jpe jpf, jpx, jp2,\n    'j2k, j2c, jpc, docx, doc, png, ps, rft, xlsx, xls, txt, tiff, tif and xml.\n    'In this example the PDF file will be saved as text file.\n    FileFormat = \"txt\"\n\n    If FileFormat = \"\" Then\n        shPaths.Range(\"B2\").Select\n        MsgBox \"There are no file paths to convert!\", vbInformation, \"File paths missing\"\n        Exit Sub\n    End If\n\n    shPaths.Activate\n\n    'Find the last row.\n    With shPaths\n        LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    End With\n\n    'Check that there are available file paths.\n    If LastRow &lt; 2 Then\n        shPaths.Range(\"B2\").Select\n        MsgBox \"There are no file paths to convert!\", vbInformation, \"File paths missing\"\n        Exit Sub\n    End If\n\n    'For each cell in the range \"B2:B\" &amp; last row convert the pdf file\n    'into different format (here to text - txt).\n    For i = 2 To LastRow\n'    For i = 2 To 2\n\n        SavePDFAsOtherFormatNoMsg Cells(i, 2).Value, Cells(i, 3).Value, FileFormat,i\n        'PdfToText Cells(i, 2).Value, Cells(i, 3).Value, i\n\n        Next\n\n    'Inform the user that conversion finished.\n    MsgBox \"All files were converted successfully!\", vbInformation, \"Finished\"\n\nEnd Sub\n\nSub SavePDFAsOtherFormatNoMsg(pdfPath As String, OutPath As String, FileExtension As String, c As Integer)\n\n'C:\\Program Files (x86)\\Adobe\\Acrobat 11.0\\Acrobat\n\n    Dim objAcroApp      As Acrobat.AcroApp\n    Dim objAcroAVDoc    As Acrobat.AcroAVDoc\n    Dim objAcroPDDoc    As Acrobat.AcroPDDoc\n    Dim objJSO          As Object\n    Dim boResult        As Boolean\n    Dim ExportFormat    As String\n    Dim NewFilePath     As String\n\n    'Check if the file exists.\n    If Dir(pdfPath) = \"\" Then\n        Exit Sub\n    End If\n\n    'Check if the input file is a PDF file.\n    If LCase(Right(pdfPath, 3)) &lt;&gt; \"pdf\" Then\n        Exit Sub\n    End If\n    DeleteFile pdfPath\n    'Initialize Acrobat by creating App object.\n    Set objAcroApp = CreateObject(\"AcroExch.App\")\n\n    'Set AVDoc object.\n    Set objAcroAVDoc = CreateObject(\"AcroExch.AVDoc\")\n\n    'Open the PDF file.\n    boResult = objAcroAVDoc.Open(pdfPath, \"\")\n\n    'Set the PDDoc object.\n    Set objAcroPDDoc = objAcroAVDoc.GetPDDoc\n\n    'Set the JS Object - Java Script Object.\n    Set objJSO = objAcroPDDoc.GetJSObject\n\n    'Check the type of conversion.\n    Select Case LCase(FileExtension)\n        Case \"eps\": ExportFormat = \"com.adobe.acrobat.eps\"\n        Case \"html\", \"htm\": ExportFormat = \"com.adobe.acrobat.html\"\n        Case \"jpeg\", \"jpg\", \"jpe\": ExportFormat = \"com.adobe.acrobat.jpeg\"\n        Case \"jpf\", \"jpx\", \"jp2\", \"j2k\", \"j2c\", \"jpc\": ExportFormat = \"com.adobe.acrobat.jp2k\"\n        Case \"docx\": ExportFormat = \"com.adobe.acrobat.docx\"\n        Case \"doc\": ExportFormat = \"com.adobe.acrobat.doc\"\n        Case \"png\": ExportFormat = \"com.adobe.acrobat.png\"\n        Case \"ps\": ExportFormat = \"com.adobe.acrobat.ps\"\n        Case \"rft\": ExportFormat = \"com.adobe.acrobat.rft\"\n        Case \"xlsx\": ExportFormat = \"com.adobe.acrobat.xlsx\"\n        Case \"xls\": ExportFormat = \"com.adobe.acrobat.spreadsheet\"\n        Case \"txt\": ExportFormat = \"com.adobe.acrobat.accesstext\"\n        Case \"tiff\", \"tif\": ExportFormat = \"com.adobe.acrobat.tiff\"\n        Case \"xml\": ExportFormat = \"com.adobe.acrobat.xml-1-00\"\n        Case Else: ExportFormat = \"Wrong Input\"\n    End Select\n\n    'Check if the format is correct and there are no errors.\n    If ExportFormat &lt;&gt; \"Wrong Input\" And Err.Number = 0 Then\n\n        'Format is correct and no errors.\n\n        'Set the path of the new file. Note that Adobe instead of xls uses xml files.\n        'That's why here the xls extension changes to xml.\n        If LCase(FileExtension) &lt;&gt; \"xls\" Then\n            NewFilePath = WorksheetFunction.Substitute(OutPath, \".pdf\", \"_adobeConverted\" &amp; \".\" &amp; LCase(FileExtension))\n        Else\n            NewFilePath = WorksheetFunction.Substitute(OutPath, \".pdf\", \"_adobeConverted\" &amp; \".xml\")\n        End If\n\n        DeleteFile NewFilePath\n\n        'Save PDF file to the new format.\n        boResult = objJSO.SaveAs(NewFilePath, ExportFormat)\n\n        'Close the PDF file without saving the changes.\n        boResult = objAcroAVDoc.Close(True)\n\n        'Close the Acrobat application.\n        boResult = objAcroApp.exit\n\n        If FileExtension = \"xlsx\" Then\n        Cells(c, 4).Value = \"YES\"\n        ElseIf FileExtension = \"txt\" Then\n        Cells(c, 5).Value = \"YES\"\n        End If\n    Else\n\n        'Something went wrong, so close the PDF file and the application.\n\n        'Close the PDF file without saving the changes.\n        boResult = objAcroAVDoc.Close(True)\n\n        'Close the Acrobat application.\n        boResult = objAcroApp.exit\n        If FileExtension = \"xlsx\" Then\n        Cells(c, 4).Value = \"NO\"\n        ElseIf FileExtension = \"txt\" Then\n        Cells(c, 5).Value = \"NO\"\n        End If\n    End If\n\n    'Release the objects.\n    Set objAcroPDDoc = Nothing\n    Set objAcroAVDoc = Nothing\n    Set objAcroApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "mobile-application", "powerapps"], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 2071435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f43ae837ace5a6b119550eb9097dfc1?s=128&d=identicon&r=PG", "display_name": "user2071435", "link": "https://stackoverflow.com/users/2071435/user2071435"}, "is_accepted": false, "score": 0, "last_activity_date": 1603463930, "creation_date": 1603463930, "answer_id": 64502099, "question_id": 55827343, "link": "https://stackoverflow.com/questions/55827343/how-to-replace-request-date-with-a-variable-extract-from-combobox-value-in-power/64502099#64502099", "title": "How to replace request date with a variable extract from Combobox value in powerapps", "body": "<p>I don't think this is a variable and is actually a value. You may need to use a</p>\n<p>UpdateContext({RequestDate: Value}) command or a Set(RequestDate,&quot;&quot;)</p>\n<p>Are you using a button to fetch the data first if so you may need to select the data first and then feed it into the variable</p>\n"}], "owner": {"reputation": 456, "user_id": 4748578, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10203182029986693/picture?type=large", "display_name": "Jackaroo Ng", "link": "https://stackoverflow.com/users/4748578/jackaroo-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1603463930, "creation_date": 1556099928, "question_id": 55827343, "link": "https://stackoverflow.com/questions/55827343/how-to-replace-request-date-with-a-variable-extract-from-combobox-value-in-power", "title": "How to replace request date with a variable extract from Combobox value in powerapps", "body": "<p>How to replace request date with a variable extract from Combobox value</p>\n\n<p>Below code working</p>\n\n<pre><code>Sort(Filter(Install,(IsBlank('REQUEST DATE') &amp;&amp; ProjectComboBox.Selected.Title in Project )),'Room No.',Ascending)\n</code></pre>\n\n<p>But once replace with a variable as below not fetching the right data as it treats variable as a value</p>\n\n<pre><code>Sort(Filter(Install,(IsBlank(\"'\" &amp; UpdateTypeComboBox.SelectedItem.UpdateType &amp; \"'\") &amp;&amp; ProjectComboBox.Selected.Title in Project )),'Room No.',Ascending)\n</code></pre>\n"}, {"tags": ["vba", "listbox", "contextmenu", "right-click", "catia"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556099473, "post_id": 55826996, "comment_id": 98319183, "body": "There is no right click event for listboxes. You could likely create a custom listener, but that&#39;s beyond me. You may be better off adding one or more buttons to the UF or sheet holding these options"}, {"owner": {"reputation": 163, "user_id": 2348220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae46c39babdb23e91c449031b81fce0?s=128&d=identicon&r=PG", "display_name": "Tomislav Horvat", "link": "https://stackoverflow.com/users/2348220/tomislav-horvat"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556099593, "post_id": 55826996, "comment_id": 98319254, "body": "Thank you Tim, I was hoping there was some workaround. :("}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 2348220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae46c39babdb23e91c449031b81fce0?s=128&d=identicon&r=PG", "display_name": "Tomislav Horvat", "link": "https://stackoverflow.com/users/2348220/tomislav-horvat"}, "edited": false, "score": 0, "creation_date": 1556180765, "post_id": 55828795, "comment_id": 98352085, "body": "Thank you for input, unfortunately I am not that good with German language to understand your Win32 API call..I think I will make a simple double click that will open hidden edit form and buttons for adding a new line and removing selected line."}], "tags": [], "owner": {"reputation": 552, "user_id": 2381028, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1855097c6c29ed8c62fc4c78bccd967e?s=128&d=identicon&r=PG", "display_name": "Shmukko", "link": "https://stackoverflow.com/users/2381028/shmukko"}, "is_accepted": false, "score": 0, "last_activity_date": 1556104656, "creation_date": 1556104656, "answer_id": 55828795, "question_id": 55826996, "link": "https://stackoverflow.com/questions/55826996/vba-create-a-menu-list-when-you-right-click-a-listbox/55828795#55828795", "title": "VBA - Create a menu list when you right click a listbox", "body": "<p>Here's some code for the right click event:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9097525/select-listbox-item-on-rightclick-in-word-vba\">Select ListBox item on rightclick in Word VBA</a></p>\n\n<p>Replace this code with your context menu code:</p>\n\n<pre><code>Me.Caption = derivedIndex &amp; \" = \" &amp; ListBox1.List(derivedIndex)\n</code></pre>\n\n<p>Here's a example for the popup menu (you need skills to understand Win32 API calls...)\n<a href=\"https://www.vbarchiv.net/api/api_createpopupmenu.html\" rel=\"nofollow noreferrer\">https://www.vbarchiv.net/api/api_createpopupmenu.html</a></p>\n"}], "owner": {"reputation": 163, "user_id": 2348220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ae46c39babdb23e91c449031b81fce0?s=128&d=identicon&r=PG", "display_name": "Tomislav Horvat", "link": "https://stackoverflow.com/users/2348220/tomislav-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 980, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556104656, "creation_date": 1556098826, "question_id": 55826996, "link": "https://stackoverflow.com/questions/55826996/vba-create-a-menu-list-when-you-right-click-a-listbox", "title": "VBA - Create a menu list when you right click a listbox", "body": "<p>I would like to have a menu with two options when user right clicks listbox.\nWith that menu user would do some actions on selected data, e.g. add new line, change some columns data or delete row. I think I can manage that code but I can not grasp how to create a right click custom menu.</p>\n\n<p>I can not find a way to create such option. Does anyone has an idea?</p>\n\n<p><a href=\"https://i.stack.imgur.com/U9CnM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U9CnM.png\" alt=\"Simple right click example\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1556101098, "creation_date": 1556101098, "answer_id": 55827703, "question_id": 55826633, "link": "https://stackoverflow.com/questions/55826633/creating-an-outlook-appointment-30-days-before-a-specific-date/55827703#55827703", "title": "Creating an Outlook appointment 30 days before a specific date", "body": "<p>Assuming column G contains an actual date, rather than text representing a date, try:</p>\n\n<pre><code>.Start = ES.Cells(i, 7) - 30 + TimeValue(\"09:00:00\")\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11266530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3591dada908cad5bd69f1fc0d45a32a?s=128&d=identicon&r=PG&f=1", "display_name": "ffc2004", "link": "https://stackoverflow.com/users/11266530/ffc2004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 55827703, "answer_count": 1, "score": 0, "last_activity_date": 1556102714, "creation_date": 1556097764, "question_id": 55826633, "link": "https://stackoverflow.com/questions/55826633/creating-an-outlook-appointment-30-days-before-a-specific-date", "title": "Creating an Outlook appointment 30 days before a specific date", "body": "<p>I have some code set up to create an Outlook appointment, though I'm trying to set the start as 30 days before whatever date is in the cell in column G (i, 7)</p>\n\n<p>Is there any way to do this, or would I need to just add an additional column in Excel with this date in?</p>\n\n<pre><code>Option Explicit\nOption Compare Text 'ignore case sensitivity when comparing strings\n\nSub EventsReminders()\n\n    Dim OL As Outlook.Application, ES As Worksheet, _\n    r As Long, i As Long, wb As ThisWorkbook\n\n    Set wb = ThisWorkbook\n    Set ES = wb.Sheets(\"Events\")\n    Set OL = New Outlook.Application\n\n    r = ES.Cells(Rows.Count, 1).End(xlUp).Row\n    For i = 8 To r\n        With ES.Cells(i, 2)\n            If .Value = \"Yes\" And ES.Cells(i, 3) &lt;&gt; \"Yes\" Then\n                ES.Cells(i, 3) = \"Yes\"\n                With OL.CreateItem(olAppointmentItem)\n                    .Subject = \"Raise works order\"\n                    .Start = ES.Cells(i, 7) + TimeValue(\"09:00:00\")\n                    .ReminderSet = True\n                    .ReminderMinutesBeforeStart = 60\n                    .Body = ES.Cells(i, 5).Value + \"_\" + ES.Cells(i, 9).Value\n                    .Save\n                End With\n            End If\n        End With\n    Next i\n\n    Set OL = Nothing\n    Set wb = Nothing\n    Set ES = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556100368, "post_id": 55826576, "comment_id": 98319675, "body": "What is your actual goal? To perform an action on the table with VBA or <b>just</b> to open the property dialog box (and perform no action on the table with VBA)? \u2022 If you just want to open the dialog box try <code>Application.CommandBars.ExecuteMso &quot;PowerQueryQueryProperties&quot;</code> while a cell within the table is selected."}, {"owner": {"reputation": 79, "user_id": 4773876, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95cb8e5b5a165a8bed47a10769c9080?s=128&d=identicon&r=PG&f=1", "display_name": "Ana Ferreira", "link": "https://stackoverflow.com/users/4773876/ana-ferreira"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556101840, "post_id": 55826576, "comment_id": 98320527, "body": "My goal is just to open. Will try that."}, {"owner": {"reputation": 79, "user_id": 4773876, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95cb8e5b5a165a8bed47a10769c9080?s=128&d=identicon&r=PG&f=1", "display_name": "Ana Ferreira", "link": "https://stackoverflow.com/users/4773876/ana-ferreira"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556102816, "post_id": 55826576, "comment_id": 98321067, "body": "Gives the following error: Method &#39;ExecuteMso&#39; of object &#39;_CommandBars&#39; failed"}, {"owner": {"reputation": 79, "user_id": 4773876, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95cb8e5b5a165a8bed47a10769c9080?s=128&d=identicon&r=PG&f=1", "display_name": "Ana Ferreira", "link": "https://stackoverflow.com/users/4773876/ana-ferreira"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1588239054, "post_id": 55826576, "comment_id": 108824528, "body": "any help on this?"}], "owner": {"reputation": 79, "user_id": 4773876, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95cb8e5b5a165a8bed47a10769c9080?s=128&d=identicon&r=PG&f=1", "display_name": "Ana Ferreira", "link": "https://stackoverflow.com/users/4773876/ana-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1556099029, "creation_date": 1556097585, "last_edit_date": 1556099029, "question_id": 55826576, "link": "https://stackoverflow.com/questions/55826576/open-connection-properties-of-selected-table", "title": "Open connection properties of selected table", "body": "<p>I'm newbie to VBA so I will need your help.</p>\n\n<p><strong>What I want?</strong><br>\nA VBA code that opens the Data > Properties > Connection Properties > Definition of the selected table.</p>\n\n<p>Don't know if it's important but I'm trying with a table imported from SAS.</p>\n\n<p><strong>What I tried?</strong><br>\nRecord the macro to check the steps needed. </p>\n\n<p><strong>The problem I found?</strong><br>\nThe recorded macro shows the steps I need to the table I selected, but refers to specific name, not no \"active table\".</p>\n\n<p>The code of the recorded macro:</p>\n\n<pre><code>Sub teste()\n'\n' teste Macro\n'\n\n'\n    Range(\"D4\").Select\n    With ActiveWorkbook.Connections(\"(Default) MY_TABLE_NAME\").OLEDBConnection\n        .BackgroundQuery = True\n        .CommandText = Array(\"MY_TABLE_NAME\")\n        .CommandType = xlCmdTable\n        .Connection = Array( _\n        \"OLEDB;Provider=MY_PROVIDER_LOCATION;Mode=Read|Sha\" _\n        , _\n        \"re Deny None;Use TK Manager Search Path=False;SAS Data Set Creation Code Page=0;SAS ValidMemName Read Update=False;SAS Adjust St\" _\n        , \"arting Date 1900=False\")\n        .RefreshOnFileOpen = False\n        .SavePassword = False\n        .SourceConnectionFile = _\n        \"MY_ODC_LOCATION\"\n        .SourceDataFile = \"\"\n        .ServerCredentialsMethod = xlCredentialsMethodIntegrated\n        .AlwaysUseConnectionFile = False\n    End With\n    With ActiveWorkbook.Connections(\"(Default) MY_TABLE_NAME\")\n        .Name = \"(Default) MY_TABLE_NAME\"\n        .Description = \"\"\n    End With\n    ExecuteExcel4Macro _\n        \"(\"\"(Default) MY_TABLE_NAME\"\",TRUE,FALSE,FALSE,TRUE,FALSE,TRUE,1,FALSE,TRUE,FALSE,0,TRUE,\"\"MY_ODC_LOCATION\"\")\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556094969, "post_id": 55825549, "comment_id": 98316465, "body": "Note that this task can easily take <b>a lot</b> of calculation time depending on the amount of data you have. How many different <code>A, B, C, \u2026</code> do you plan to have (estimated maximum) and how many different numbers <code>A1, A2, A3, \u2026</code> each letter? \u2022 You should calculate first if this is possible to run in a reasonable amount of time with your data before you start coding this in VBA."}, {"owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556095468, "post_id": 55825549, "comment_id": 98316771, "body": "I added to my question the code I created for a fixed number of attributes. Note: filling the arrays from the Excel table isn&#39;t the problem, so I omitted that until I have a solution for the Cartesion product."}, {"owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556095738, "post_id": 55825549, "comment_id": 98316920, "body": "The maximum number of attributes is 12. The average number of attribute values per attribuge is about 4 or 5."}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1556099063, "post_id": 55825549, "comment_id": 98318957, "body": "You can find a few different solutions <a href=\"https://stackoverflow.com/questions/31472816\">here</a>"}], "owner": {"reputation": 53, "user_id": 11403673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6fa10a22ee699262576bfb6579a183e?s=128&d=identicon&r=PG&f=1", "display_name": "J. Vos", "link": "https://stackoverflow.com/users/11403673/j-vos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556100241, "creation_date": 1556094356, "last_edit_date": 1556095619, "question_id": 55825549, "link": "https://stackoverflow.com/questions/55825549/create-cartesian-product-of-attribute-values-in-one-excel-table", "title": "Create cartesian product of attribute values in one Excel table", "body": "<p>How to create in (Excel) VBA the Cartesian product of attributes values of several attributes, stored in one and the same table?</p>\n\n<p>The code should deal with a dynamic number of attributes (first column) and attribute values per attribute (second column).</p>\n\n<p>Input example:</p>\n\n<ul>\n<li>A | A1</li>\n<li>A | A2</li>\n<li>A | A3</li>\n<li>B | B1</li>\n<li>B | B2</li>\n<li>C | C1</li>\n</ul>\n\n<p>Result:</p>\n\n<ul>\n<li>A1, B1, C1</li>\n<li>A1, B2, C1</li>\n<li>A2, B1, C1</li>\n<li>A2, B2, C1</li>\n<li>A3, B1, C1</li>\n<li>A3, B2, C1</li>\n</ul>\n\n<p>A solution in Power Query for Excel is also OK for me.</p>\n\n<p>For a fixed number of attributes I could store the attribute values in an array per attribute and then use nested for loops. But I am looking for a solution with a dynamic number of attributes.</p>\n\n<p>This is the code I created for a fixed number of attributes. Note: filling the arrays from the Excel table isn't the problem, so I omitted that until I have a solution for the Cartesion product.</p>\n\n<pre><code>Sub GenerateItems()\n\nDim strAttributeValues1 As String\nDim strAttributeValues2 As String\nDim strAttributeValues3 As String\n\nDim arrAttributeValues1() As String\nDim arrAttributeValues2() As String\nDim arrAttributeValues3() As String\n\nDim strItemName As String\n\nstrAttributeValues1 = \"A1,A2,A3\"\narrAttributeValues1 = Split(strAttributeValues1, \",\")\n\nstrAttributeValues2 = \"B1,B2\"\narrAttributeValues2 = Split(strAttributeValues2, \",\")\n\nstrAttributeValues3 = \"C1\"\narrAttributeValues3 = Split(strAttributeValues3, \",\")\n\nDim a, b, c As Integer\n\nFor a = 0 To UBound(arrAttributeValues1)\n    For b = 0 To UBound(arrAttributeValues2)\n        For c = 0 To UBound(arrAttributeValues3)\n            strItemName = arrAttributeValues1(a) &amp; \" \" &amp; arrAttributeValues2(b) &amp; \" \" &amp; arrAttributeValues3(c)\n            Debug.Print strItemName\n        Next c\n    Next b\nNext a\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1556094039, "post_id": 55825359, "comment_id": 98315981, "body": "Have you searched on here for a vba method?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556094196, "post_id": 55825359, "comment_id": 98316060, "body": "Look into <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">worksheet_change events</a>"}, {"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556094963, "post_id": 55825359, "comment_id": 98316463, "body": "is there any vba sample code that I can use..? it would help me a lot."}, {"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556094983, "post_id": 55825359, "comment_id": 98316474, "body": "I searched vba method but didn&#39;t help"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556095162, "post_id": 55825359, "comment_id": 98316585, "body": "SO is not a free code writing service, therefore it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and improve your question to get the support you want."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1556095236, "post_id": 55825359, "comment_id": 98316618, "body": "if you add a line, is added at the end?"}, {"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556095567, "post_id": 55825359, "comment_id": 98316828, "body": "I simply tried to insert reference to sheet 1. Like in sheet 2 Cell A2 =Sheet1!A2"}, {"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556095622, "post_id": 55825359, "comment_id": 98316861, "body": "I filled whole sheet like that. but I want more like a vba code to do the job automatically."}, {"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1556096123, "post_id": 55825359, "comment_id": 98317173, "body": "@TimStack Check out this link. I can see some experts do help to simple questions like I asked. <a href=\"https://stackoverflow.com/questions/40686328/update-cell-automatically-copy-row-to-a-separate-sheet?rq=1\" title=\"update cell automatically copy row to a separate sheet\">stackoverflow.com/questions/40686328/&hellip;</a>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1556097068, "post_id": 55825359, "comment_id": 98317774, "body": "Apart from whether or not this type of question has been asked before: Why would you want to duplicate your data?That is not the best data architecture. If you need a subset of your data in a different sheet, with only a few specific columns from the original data, you don&#39;t need VBA to physically copy the data from the first sheet. There are better ways to do that."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556162219, "post_id": 55826397, "comment_id": 98345711, "body": "wow. this worked. thank you so much for the help. I am still learning. I am very new to these code stuffs."}, {"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556165351, "post_id": 55826397, "comment_id": 98346307, "body": "I have 1 more question. I have another worksheet with many columns. If I add this code to that worksheet, will it work..?"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556167317, "post_id": 55826397, "comment_id": 98346690, "body": "Check both sheet names and change them."}, {"owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556172376, "post_id": 55826397, "comment_id": 98348102, "body": "But this code doesn&#39;t work if I use it in a Right to Left sheet. Is there any changes that I need to alter for this to work on right to left sheets"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "edited": false, "score": 0, "creation_date": 1556173050, "post_id": 55826397, "comment_id": 98348341, "body": "does your code work for the question and does not work for the new senario?"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": true, "score": 1, "last_activity_date": 1556097054, "creation_date": 1556097054, "answer_id": 55826397, "question_id": 55825359, "link": "https://stackoverflow.com/questions/55825359/how-to-insert-new-row-to-sheet-2-automatically-when-a-new-row-is-inserted-to-she/55826397#55826397", "title": "How to insert new row to sheet 2 automatically when a new row is inserted to sheet 1 and copy values?", "body": "<p>You can use the below code in Sheet 1.</p>\n\n<pre><code>Option Explicit\nDim Old_lines As Long, New_Lines As Long, Row_Number As Long\nDim PrNo As String, PrNa As String, R2 As String, R3 As String, R5 As String\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        New_Lines = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        If Old_lines &lt; New_Lines Then\n\n            With Worksheets(\"Sheet2\")\n                .Rows(Row_Number).EntireRow.Insert\n                .Range(\"A\" &amp; Row_Number).Formula = \"=Sheet1!A\" &amp; Row_Number\n                .Range(\"B\" &amp; Row_Number).Formula = \"=Sheet1!B\" &amp; Row_Number\n                .Range(\"C\" &amp; Row_Number).Formula = \"=Sheet1!D\" &amp; Row_Number\n                .Range(\"D\" &amp; Row_Number).Formula = \"=Sheet1!E\" &amp; Row_Number\n                .Range(\"E\" &amp; Row_Number).Formula = \"=Sheet1!G\" &amp; Row_Number\n\n            End With\n\n        End If\n\n    End With\n\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Old_lines = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        Row_Number = Target.Row\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1556097622, "last_edit_date": 1556097622, "creation_date": 1556097296, "answer_id": 55826470, "question_id": 55825359, "link": "https://stackoverflow.com/questions/55825359/how-to-insert-new-row-to-sheet-2-automatically-when-a-new-row-is-inserted-to-she/55826470#55826470", "title": "How to insert new row to sheet 2 automatically when a new row is inserted to sheet 1 and copy values?", "body": "<p>You can do that without any VBA. Instead of VBA to duplicate the data, use Power Query. Query the data from Sheet1 as the source. Delete the columns you don't need. Load the query result into Sheet2.</p>\n\n<p>When new data is added to Sheet1, simply refresh the query by clicking Data > Refresh All. </p>\n\n<p>If you want to automate it with VBA, use a Worksheet_Change event on Sheet1 that does the equivalent of Data > Refresh All. The macro recorder will show you the command you need.</p>\n\n<p>This can be achieved with just clicking a few ribbon buttons. No coding nightmares. Data doesn't have to be duplicated.</p>\n\n<p>Life can be simple. A lot of things that were only doable with VBA a few years ago are now doable much faster and much easier with Power Query. Use current technologies instead of outdated concepts.</p>\n"}], "owner": {"reputation": 129, "user_id": 2857536, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e02fed53ed18a96e52850519604ee8b6?s=128&d=identicon&r=PG&f=1", "display_name": "Aroo", "link": "https://stackoverflow.com/users/2857536/aroo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 55826397, "answer_count": 2, "score": -2, "last_activity_date": 1556097622, "creation_date": 1556093782, "last_edit_date": 1556095128, "question_id": 55825359, "link": "https://stackoverflow.com/questions/55825359/how-to-insert-new-row-to-sheet-2-automatically-when-a-new-row-is-inserted-to-she", "title": "How to insert new row to sheet 2 automatically when a new row is inserted to sheet 1 and copy values?", "body": "<p>How to do the following:\nI have 2 sheets in a single Worksheet ie; Sheet 1 and Sheet 2.\nNow I want to insert a new row to Sheet 1 and fill that cells and when I insert this row, I want insert the same row automatically to Sheet 2 but without some columns. I have googled and searched many forums and website but couldn't find anything to work.</p>\n\n<p>Sheet 1</p>\n\n<p><a href=\"https://i.stack.imgur.com/F3HQQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F3HQQ.png\" alt=\"Sheet 1\"></a></p>\n\n<p>Sheet 2</p>\n\n<p><a href=\"https://i.stack.imgur.com/rRVis.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rRVis.png\" alt=\"Sheet 2\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1556094311, "post_id": 55825303, "comment_id": 98316109, "body": "Have you tried to you use <code>ThisWorkbook.Path</code>?"}, {"owner": {"reputation": 21, "user_id": 11403851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b184238e26b1523ace90102c5e7831e5?s=128&d=identicon&r=PG&f=1", "display_name": "Akanksha", "link": "https://stackoverflow.com/users/11403851/akanksha"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1556094612, "post_id": 55825303, "comment_id": 98316267, "body": "@FunThomas  Yes, I started with <code>ThisWorkbook.Path</code> but it didn&#39;t work either."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 11403851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b184238e26b1523ace90102c5e7831e5?s=128&d=identicon&r=PG&f=1", "display_name": "Akanksha", "link": "https://stackoverflow.com/users/11403851/akanksha"}, "is_accepted": false, "score": 0, "last_activity_date": 1556173960, "creation_date": 1556173960, "answer_id": 55843134, "question_id": 55825303, "link": "https://stackoverflow.com/questions/55825303/cannot-connect-to-access2016-file-stored-at-same-location-from-an-excel2016-user/55843134#55843134", "title": "Cannot connect to Access2016 file stored at same location from an Excel2016 userform", "body": "<p>I have solved this issue by storing the path of my workbook to a cell in <code>Workbook_Open()</code> and using the cell value as path later in userform.</p>\n"}], "owner": {"reputation": 21, "user_id": 11403851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b184238e26b1523ace90102c5e7831e5?s=128&d=identicon&r=PG&f=1", "display_name": "Akanksha", "link": "https://stackoverflow.com/users/11403851/akanksha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556173960, "creation_date": 1556093605, "last_edit_date": 1556094838, "question_id": 55825303, "link": "https://stackoverflow.com/questions/55825303/cannot-connect-to-access2016-file-stored-at-same-location-from-an-excel2016-user", "title": "Cannot connect to Access2016 file stored at same location from an Excel2016 userform", "body": "<p>I am using front end as Excel2016 and back end is Access2016.\nThis is a shared file to be used by multiple users for data entry, so after each function I release the connection object.</p>\n\n<p>I fetch the table data at <code>Workbook_Open()</code> event and it works absolutely fine.\nI have a userform for data entry. I have used the same code, and surprisingly this time <code>ActiveWorkbook.Path</code> works fine for me, but does not return same path for other users.</p>\n\n<p>I have also tried defining public variable in General Declaration area of my Userform (<code>Public strPath As String</code>), and in <code>Workbook_Open()</code> setting the value of variable ( Set strPath = ActiveWorkbook.Path ) but that won't work either.</p>\n\n<p>I am attaching my current code for reference. open_connection() is called via button click in userform.</p>\n\n<p><strong>Workbook_Open()</strong></p>\n\n<pre><code>strPath = ActiveWorkbook.Path\nstrDBName = \"Test Excel Access.accdb\"\nstrDB = strPath &amp; \"\\\" &amp; strDBName\n\nConnDB.Open ConnectionString:=\"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDB\n\nstrTable = \"Table01\"\n\nadoRecSet.Open Source:=strTable, ActiveConnection:=ConnDB, CursorType:=adOpenDynamic, LockType:=adLockOptimistic\n\n' perform init operations\n\nadoRecSet.Close\nSet adoRecSet = Nothing\nConnDB.Close\nSet ConnDB = Nothing\n\nApplication.DisplayAlerts = False\nThisWorkbook.Save\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p><strong>open_connection()</strong></p>\n\n<pre><code>strPath = ActiveWorkbook.Path\nstrDBName = \"Test Excel Access.accdb\"\nstrDB = strPath &amp; \"\\\" &amp; strDBName\n\nConnDB.Open ConnectionString:=\"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDB\n\nstrTable = \"Table01\"\n\nadoRecSet.Open Source:=strTable, ActiveConnection:=ConnDB, CursorType:=adOpenDynamic, LockType:=adLockOptimistic\n</code></pre>\n\n<p>Is there a way I can use value of strPath from Workbook_Open() in my userform? Or how can I get same path when I use the ActiveWorkbook.Path function in UserForm.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1556092427, "post_id": 55824903, "comment_id": 98315055, "body": "What is the error message with which data?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 2, "creation_date": 1556092632, "post_id": 55824903, "comment_id": 98315178, "body": "The <code>Cells</code> object needs to refer to a wb &amp; ws as well."}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 1, "creation_date": 1556092835, "post_id": 55824903, "comment_id": 98315294, "body": "Do both ranges belong to the same worksheet? Why you use  Cells(12, 2) with fix number an din the second formula you use iTotalRows?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11397601"}, "edited": false, "score": 0, "creation_date": 1556093589, "post_id": 55824903, "comment_id": 98315722, "body": "The first will work if iTotalRows is 12."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11403863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf2ee3fbca778b8bead85159c764d9e?s=128&d=identicon&r=PG&f=1", "display_name": "teerawat", "link": "https://stackoverflow.com/users/11403863/teerawat"}, "edited": false, "score": 0, "creation_date": 1556095279, "post_id": 55825043, "comment_id": 98316646, "body": "Thank you very much. It works perfectly"}, {"owner": {"reputation": 1, "user_id": 11403863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf2ee3fbca778b8bead85159c764d9e?s=128&d=identicon&r=PG&f=1", "display_name": "teerawat", "link": "https://stackoverflow.com/users/11403863/teerawat"}, "edited": false, "score": 0, "creation_date": 1556158441, "post_id": 55825043, "comment_id": 98345012, "body": "Sorry, I have one more question. From my above question, the code can copy source to destination file using range object. Can range object able to do some calculation at source file before copy to destination file? I have tried something like below but it is not working.                            ActiveSheet.Range(&quot;B2:B3&quot;).Value = Sheet1.Range(ActiveSheet.Cells(1,1),ActiveSheet.Cells(2,1)).&zwnj;&#8203;Value - Sheet1.Range(ActiveSheet.Cells(1,2),ActiveSheet.Cells(2,2)).&zwnj;&#8203;Value   Thank you for all of your help."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 1, "user_id": 11403863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf2ee3fbca778b8bead85159c764d9e?s=128&d=identicon&r=PG&f=1", "display_name": "teerawat", "link": "https://stackoverflow.com/users/11403863/teerawat"}, "edited": false, "score": 0, "creation_date": 1556175792, "post_id": 55825043, "comment_id": 98349565, "body": "@teerawat An interesting question!  Unfortunately not - that will give a &quot;Type Mismatch&quot; error.  However, if you were to <code>Set</code> your Ranges (<code>Dim output AS Range, leftVal AS Range, rightVal As Range: Set output = ActiveSheet.Range(&quot;B2:B3&quot;): Set leftVal = Sheet1.Range(ActiveSheet.Cells(1,1),ActiveSheet.Cells(2,1)): Set rightVal As Sheet1.Range(ActiveSheet.Cells(1,2),ActiveSheet.Cells(2,2))</code>) then you could use a loop:  <code>Dim x as Long: For x = 1 to output.Cells.Count: output.Cells(x) = leftVal.Cells(x) - rightVal.Cells(x): Next x</code> - if you can&#39;t get that to work, try posting a new question"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1556092715, "creation_date": 1556092715, "answer_id": 55825043, "question_id": 55824903, "link": "https://stackoverflow.com/questions/55824903/run-this-code-line-with-error-pls-comment/55825043#55825043", "title": "run this code line with error. pls comment", "body": "<p>You need to fully qualify your <code>Range</code> and <code>Cells</code> - try one of these</p>\n\n<pre><code>ActiveSheet.Range(\"C5:C\" &amp; iTotalRows + 1).Value = src.Worksheets(\"Loan\").Range(src.Worksheets(\"Loan\").Cells(4, 2), src.Worksheets(\"Loan\").Cells(12, 2))\n'Or\nWith src.Worksheets(\"Loan\")\n    ActiveSheet.Range(\"C5:C\" &amp; iTotalRows+1).Value = .Range(.Cells(4, 2), .Cells(iTotalRows, 2)).Value\nEnd With\n</code></pre>\n\n<p>If we simplify this, your current code is effectively this:</p>\n\n<pre><code>ActiveSheet.Range(\"B2:B3\").Value = Sheet1.Range(ActiveSheet.Cells(1,1),ActiveSheet.Cells(2,1)).Value\n</code></pre>\n\n<p>Which will <em>only</em> work if <code>Sheet1</code> is the <code>ActiveSheet</code> - otherwise, Excel can't find the cell <code>ActiveSheet.Cells(1,1)</code> in worksheet <code>Sheet1</code></p>\n"}, {"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1556095647, "last_edit_date": 1556095647, "creation_date": 1556094132, "answer_id": 55825480, "question_id": 55824903, "link": "https://stackoverflow.com/questions/55824903/run-this-code-line-with-error-pls-comment/55825480#55825480", "title": "run this code line with error. pls comment", "body": "<p>Understanding how to create and use workbook and worksheet variables will save you from lots of trouble.</p>\n\n<p>You should always <strong>explicitly</strong> refer to the workbooks and worksheets to whitch the objects or collections you want to use, belong. </p>\n\n<p>In this case you are using the <code>.cells</code> collection.</p>\n\n<p>If you don't specify which worksheet this collection belongs to, excel will try to figure it out on it's own which could lead to unwanted behavior or even errors. Errors are actually the good scenario because they are easily traceable.</p>\n\n<p>Using <code>ActiveSheet</code> references is a bad practice as well.</p>\n\n<p>I would do it like so:</p>\n\n<pre><code>Dim src As Workbook 'source workbook\nDim dest As Workbook 'destination workbook\nDim srcWs As Worksheet 'source worksheet\nDim destWs As Worksheet 'destination worksheet\nSet src = Application.Workbooks(\"Name of the source Workbook\")\nSet dest = Application.Workbooks(\"Name of the destination Workbook\")\nSet srcWs = src.Worksheets(\"Loan\") 'assign the worksheet named \"Loan\", which belongs to the source workbook, to the srcWs variable\nSet destWs = dest.Worksheets(\"Name of the destination Worksheet\")\n\ndestWs.Range(\"C5:C\" &amp; iTotalRows + 1).Value = srcWs.Range(srcWs.Cells(4, 2), srcwsCells(12, 2)).Value\n</code></pre>\n\n<p>Also a very useful way to refer to the workbook in which the code is located is <code>ThisWorkbook</code>.</p>\n\n<p>This way, you can get access to your workbook/worksheet properties and objects just by using the corresponding reference followed by a dot and then VBE's Intellisence will help you find what you're looking for. </p>\n\n<p>Finally, I am not sure what you're trying to achieve exactly, but you should keep in mind that this:</p>\n\n<pre><code>destWs.Range(\"C5:C\" &amp; iTotalRows + 1).Value = srcWs.Range(srcWs.Cells(4, 2), srcwsCells(12, 2)).Value\n</code></pre>\n\n<p>will only assign as many values from the source range to the destination range, as the <code>iTotalRows + 1</code> , will allow. So for example if <code>iTotalRows=9</code> then you would have the following result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SNh4h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SNh4h.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11403863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf2ee3fbca778b8bead85159c764d9e?s=128&d=identicon&r=PG&f=1", "display_name": "teerawat", "link": "https://stackoverflow.com/users/11403863/teerawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1557910528, "answer_count": 2, "score": -3, "last_activity_date": 1556095647, "creation_date": 1556092184, "last_edit_date": 1556092257, "question_id": 55824903, "link": "https://stackoverflow.com/questions/55824903/run-this-code-line-with-error-pls-comment", "closed_reason": "Duplicate", "title": "run this code line with error. pls comment", "body": "<p>Not working</p>\n\n<pre><code>Range(\"C5:C\" &amp; iTotalRows + 1).Value = src.Worksheets(\"Loan\").Range(Cells(4, 2), Cells(12, 2)).Value\n</code></pre>\n\n<p>is working</p>\n\n<pre><code>Range(\"D5:D\" &amp; iTotalRows + 1).Value=src.Worksheets(\"Loan\").Range(\"C4:C\" &amp; iTotalRows).Value\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "odbc", "ms-access-2010"], "comments": [{"owner": {"reputation": 705, "user_id": 10704949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-09DkROR4Hg0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jtCWCivJ4M2Wu_MwvDY74R2Mt38g/mo/photo.jpg?sz=128", "display_name": "Pratik Bhavsar", "link": "https://stackoverflow.com/users/10704949/pratik-bhavsar"}, "edited": false, "score": 0, "creation_date": 1556090577, "post_id": 55824328, "comment_id": 98314109, "body": "<a href=\"https://www.quackit.com/microsoft_access/microsoft_access_2016/howto/how_to_import_a_sql_server_database_into_access_2016.cfm\" rel=\"nofollow noreferrer\">quackit.com/microsoft_access/microsoft_access_2016/howto/&hellip;</a>"}, {"owner": {"reputation": 75, "user_id": 8769700, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10156011668317079/picture?type=large", "display_name": "Jext", "link": "https://stackoverflow.com/users/8769700/jext"}, "reply_to_user": {"reputation": 705, "user_id": 10704949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-09DkROR4Hg0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jtCWCivJ4M2Wu_MwvDY74R2Mt38g/mo/photo.jpg?sz=128", "display_name": "Pratik Bhavsar", "link": "https://stackoverflow.com/users/10704949/pratik-bhavsar"}, "edited": false, "score": 0, "creation_date": 1556090770, "post_id": 55824328, "comment_id": 98314200, "body": "Hi, thanks, but this imports and creates physical table in MS access. I am looking at loading the tables that are in sql as data into a table called MTT_Table in access. I have an ms access database that needs to store all table names - not sure if that makes more sense"}], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1556091135, "creation_date": 1556091135, "answer_id": 55824596, "question_id": 55824328, "link": "https://stackoverflow.com/questions/55824328/import-sql-tables-as-data-into-access-db/55824596#55824596", "title": "Import SQL tables as data into access Db", "body": "<p>Your question is a bit broad (<em>what</em> information do you want from tables), but generally can be achieved by querying the <code>INFORMATION_SCHEMA</code> meta-tables over ODBC.</p>\n\n<pre><code>SELECT * INTO MTT_Table\nFROM [ODBC;Driver={SQL Server};Server=my\\server;Database=myDb;Trusted_Connection=Yes;].INFORMATION_SCHEMA.TABLES\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 8769700, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10156011668317079/picture?type=large", "display_name": "Jext", "link": "https://stackoverflow.com/users/8769700/jext"}, "edited": false, "score": 0, "creation_date": 1556091435, "post_id": 55824633, "comment_id": 98314506, "body": "Thank you, will try this. Is there any other way to do it without creating a view? Reason that I am asking is I could potentially have to import 300 systems worth of tables, and not all of them will be in SQL, am testing the logic in access and sql, but ultimately the storage system will be a sql database, that needs to connect via odbc and extract this from other systems"}, {"owner": {"reputation": 705, "user_id": 10704949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-09DkROR4Hg0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jtCWCivJ4M2Wu_MwvDY74R2Mt38g/mo/photo.jpg?sz=128", "display_name": "Pratik Bhavsar", "link": "https://stackoverflow.com/users/10704949/pratik-bhavsar"}, "reply_to_user": {"reputation": 75, "user_id": 8769700, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10156011668317079/picture?type=large", "display_name": "Jext", "link": "https://stackoverflow.com/users/8769700/jext"}, "edited": false, "score": 1, "creation_date": 1556091544, "post_id": 55824633, "comment_id": 98314557, "body": "@Jext You should give a try to Erik A&#39;s solution."}], "tags": [], "owner": {"reputation": 705, "user_id": 10704949, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-09DkROR4Hg0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jtCWCivJ4M2Wu_MwvDY74R2Mt38g/mo/photo.jpg?sz=128", "display_name": "Pratik Bhavsar", "link": "https://stackoverflow.com/users/10704949/pratik-bhavsar"}, "is_accepted": true, "score": 0, "last_activity_date": 1556091284, "creation_date": 1556091284, "answer_id": 55824633, "question_id": 55824328, "link": "https://stackoverflow.com/questions/55824328/import-sql-tables-as-data-into-access-db/55824633#55824633", "title": "Import SQL tables as data into access Db", "body": "<p>Use information schema to create a view in SQL server: </p>\n\n<pre><code>CREATE VIEW dbo.Sample_View\nAS\n   SELECT TABLE_NAME \n   FROM [Your_Database].INFORMATION_SCHEMA.TABLES \n   WHERE TABLE_TYPE = 'BASE TABLE' \n</code></pre>\n\n<p>Now import this view to access following the steps in this <a href=\"https://www.quackit.com/microsoft_access/microsoft_access_2016/howto/how_to_import_a_sql_server_database_into_access_2016.cfm\" rel=\"nofollow noreferrer\">link</a></p>\n"}], "owner": {"reputation": 75, "user_id": 8769700, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/10156011668317079/picture?type=large", "display_name": "Jext", "link": "https://stackoverflow.com/users/8769700/jext"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 55824633, "answer_count": 2, "score": 0, "last_activity_date": 1556091284, "creation_date": 1556090094, "last_edit_date": 1556090841, "question_id": 55824328, "link": "https://stackoverflow.com/questions/55824328/import-sql-tables-as-data-into-access-db", "title": "Import SQL tables as data into access Db", "body": "<p>I have a SQL database (lets use northwind), that has a number of tables (unknown number of tables). I would like to import these tables into a MS access database as DATA (not tables) into a MTT_Table</p>\n\n<p>All standard imports, creates the table as a physical table within ms access and not as data.\nI have a table in MS Access that needs to store all the names of tables in other systems - not sure if that makes sense</p>\n\n<p>Is there any way to read an infinite number of tables and populate them as data, using an odbc connection all through VBA</p>\n\n<p>Expected output would be to see the table names as data values, and potentially able to populate the MS access row with metadata about the table</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556090591, "post_id": 55824320, "comment_id": 98314116, "body": "What difficulty are you facing.. Use <code>ElseIf Not Intersect(Target, Columns(3)) Is Nothing Then</code> with the code that I gave an combine them?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556091248, "post_id": 55824320, "comment_id": 98314413, "body": "@SiddharthRout <code>ElseIf</code> might fail if a range (not single cell) is changed that affects <i>both</i> ranges which need to be checked. This would happen if you copy/paste a entire row for example. Therefore I suggest to use a second <code>If</code> statment, so both are checked."}, {"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1556091394, "post_id": 55824320, "comment_id": 98314485, "body": "Thanks Siddharth...i updated the code with a WorksheetFunction. CountIf in Code 2 above. Is the instruction to separate the code with &#39;ElseIf Not Intersect(Target, Columns(3)) Is Nothing Then&#39;, removing the End Sub in the first piece of code and Private Sub Worksheet_Change(ByVal Target As Range)?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556091461, "post_id": 55824320, "comment_id": 98314521, "body": "@Vietman78 see my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1556092695, "post_id": 55824555, "comment_id": 98315214, "body": "Thank you both for taking your time to assist me on this. I simply missed of and End If statement. Basic i know but at least i am learning from the process."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1556096636, "post_id": 55824555, "comment_id": 98317509, "body": "Be aware that this incorporates the error handling from the first Sub , that if triggered will bypass the second sub.  May or may not be what the OP requires"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1556098209, "post_id": 55824555, "comment_id": 98318463, "body": "@chrisneilsen I guess the error handling is just incorporated to not leave <code>EnableEvents = False</code> in case of an error since I put the code 2 within <code>EnableEvents = False</code> it of course must also trigger the error handling. Otherwise he would need to put it outside the <code>EnableEvents = False</code>. \u2022 But anyway there is no reason to disable the events in this code since I see nothing that could cause another event in this code. Also he could skip error handling completely if  he checks for <code>NumA &lt;&gt; 0</code>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1556098334, "post_id": 55824555, "comment_id": 98318541, "body": "@Vietman78 Make sure you also check for <code>NumA &lt;&gt; 0</code> since you devide by <code>NumA</code>!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": -2, "last_activity_date": 1556090996, "creation_date": 1556090996, "answer_id": 55824555, "question_id": 55824320, "link": "https://stackoverflow.com/questions/55824320/combine-worksheet-events/55824555#55824555", "title": "Combine Worksheet Events", "body": "<p>What is the issue? Just put them together.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngToCheck As Range\n    Dim NumA As Variant, NumB As Variant\n    Dim i As Long\n\n    On Error GoTo Whoa\n\n    '~~&gt; Set the relevant range\n    Set rngToCheck = Union(Range(\"G12:G42\"), Range(\"J12:J42\"))\n\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, rngToCheck) Is Nothing Then\n        For i = 12 To 42 Step 2 '&lt;~~ Loop through only even rows\n            NumA = Range(\"G\" &amp; i).Value\n            NumB = Range(\"J\" &amp; i).Value\n\n            If IsNumeric(NumA) And IsNumeric(NumB) And NumB &lt;&gt; 0 Then\n                If ((NumB - NumA) / NumA) * 100 &lt; 50 Then\n                    MsgBox \"The Glass U-value and Total System U-value appear very similar. Please check the input values for accuracy!\"\n                    Exit For\n                End If\n            End If\n        Next i\n    End If\n\n\n    Dim AffectedRange As Range\n    Set AffectedRange = Intersect(Target, Me.Columns(3))\n\n    If Not AffectedRange Is Nothing Then\n        Dim Cell As Range\n        For Each Cell In AffectedRange\n\n            If Application.WorksheetFunction.CountIf(Me.Columns(3), Cell.Value) &gt; 1 Then\n                MsgBox \"This Wall Reference already exists. Please ensure you have a unique reference identifier less than 20 characters in length\", vbOKOnly + vbExclamation\n            End If\n\n        Next Cell\n    End If\n\n\nLetscontinue:\n    Application.EnableEvents = True\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume Letscontinue\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "is_accepted": true, "score": -1, "last_activity_date": 1556092979, "creation_date": 1556092979, "answer_id": 55825119, "question_id": 55824320, "link": "https://stackoverflow.com/questions/55824320/combine-worksheet-events/55825119#55825119", "title": "Combine Worksheet Events", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngToCheck As Range\n    Dim NumA As Variant, NumB As Variant\n    Dim i As Long\n\n    On Error GoTo Whoa\n\n    '~~&gt; Set the relevant range\n    Set rngToCheck = Union(Range(\"G12:G42\"), Range(\"J12:J42\"))\n\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, rngToCheck) Is Nothing Then\n        For i = 12 To 42 Step 2 '&lt;~~ Loop through only even rows\n            NumA = Range(\"G\" &amp; i).Value\n            NumB = Range(\"J\" &amp; i).Value\n\n            If IsNumeric(NumA) And IsNumeric(NumB) And NumB &lt;&gt; 0 Then\n                If ((NumB - NumA) / NumA) * 100 &lt; 50 Then\n                    MsgBox \"The Glass U-value and Total System U-value appear very similar. Please check the input values for accuracy!\"\n                    Exit For\n                End If\n            End If\n        Next i\n    End If\n\n    Dim AffectedRange As Range\n    Set AffectedRange = Intersect(Target, Me.Columns(3))\n\n    If Not AffectedRange Is Nothing Then\n        Dim Cell As Range\n        For Each Cell In AffectedRange\n\n            If Application.WorksheetFunction.CountIf(Me.Columns(3), Cell.Value) &gt; 1 Then\n                MsgBox \"This Glazing Reference already exists. Please ensure you have a unique reference identifier less than 20 characters in length\", vbOKOnly + vbExclamation\n            End If\n\n        Next Cell\n    End If\n\nLetscontinue:\n    Application.EnableEvents = True\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume Letscontinue\nEnd Su\n</code></pre>\n\n<p>b</p>\n"}], "owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 55825119, "answer_count": 2, "score": 0, "last_activity_date": 1556092979, "creation_date": 1556090068, "last_edit_date": 1556090758, "question_id": 55824320, "link": "https://stackoverflow.com/questions/55824320/combine-worksheet-events", "title": "Combine Worksheet Events", "body": "<p>I have challenged myself on this one but have failed so far. I have two Worksheet_Change events that are triggered on the same concept of the user adding data and receiving a pop up message if incorrect.</p>\n\n<p>I have tried to combine them but keep getting errors.</p>\n\n<p>Code 1</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngToCheck As Range\n    Dim NumA As Variant, NumB As Variant\n    Dim i As Long\n\n    On Error GoTo Whoa\n\n    '~~&gt; Set the relevant range\n    Set rngToCheck = Union(Range(\"G12:G42\"), Range(\"J12:J42\"))\n\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, rngToCheck) Is Nothing Then\n        For i = 12 To 42 Step 2 '&lt;~~ Loop through only even rows\n            NumA = Range(\"G\" &amp; i).Value\n            NumB = Range(\"J\" &amp; i).Value\n\n            If IsNumeric(NumA) And IsNumeric(NumB) And NumB &lt;&gt; 0 Then\n                If ((NumB - NumA) / NumA) * 100 &lt; 50 Then\n                    MsgBox \"The Glass U-value and Total System U-value appear very similar. Please check the input values for accuracy!\"\n                    Exit For\n                End If\n            End If\n        Next i\n    End If\n\nLetscontinue:\n    Application.EnableEvents = True\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume Letscontinue\nEnd Sub\n</code></pre>\n\n<p>Code 2</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim AffectedRange As Range\n    Set AffectedRange = Intersect(Target, Me.Columns(3))\n\n    If Not AffectedRange Is Nothing Then\n        Dim Cell As Range\n        For Each Cell In AffectedRange\n\n            If Application.WorksheetFunction.CountIf(Me.Columns(3), Cell.Value) &gt; 1 Then\n                MsgBox \"This Glazing Reference already exists. Please ensure you have a unique reference identifier less than 20 characters in length\", vbOKOnly + vbExclamation\n            End If\n\n        Next Cell\n    End If\nEnd Sub\n</code></pre>\n\n<p>I would like both <code>Worksheet_Change</code> events to run without them crashing.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 6, "creation_date": 1556088707, "post_id": 55823821, "comment_id": 98313232, "body": "Replace <code>.Address</code> with <code>.SubAddress</code>"}, {"owner": {"reputation": 1, "user_id": 11125426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d38e7d19872800da75f4e2ad1d5cdfd?s=128&d=identicon&r=PG&f=1", "display_name": "Kons21", "link": "https://stackoverflow.com/users/11125426/kons21"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556089682, "post_id": 55823821, "comment_id": 98313670, "body": "This worked perfectly. Thank you so much!"}], "owner": {"reputation": 1, "user_id": 11125426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d38e7d19872800da75f4e2ad1d5cdfd?s=128&d=identicon&r=PG&f=1", "display_name": "Kons21", "link": "https://stackoverflow.com/users/11125426/kons21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556091526, "creation_date": 1556088061, "last_edit_date": 1556091526, "question_id": 55823821, "link": "https://stackoverflow.com/questions/55823821/vba-to-replace-a-portion-of-a-hyperlink-to-another-sheet-in-the-same-workbook", "title": "VBA to Replace a Portion of a Hyperlink to Another Sheet In the Same Workbook", "body": "<p>I am trying to get a portion of a link to another sheet within the same workbook changed through VBA. </p>\n\n<p>I have a spreadsheet, where I want the user to be able to change select if they want to see \"Site1\" or \"Site2\" by changing the values in cells labeled \"Change From\" and \"Change To\". </p>\n\n<p>I have a separate sheets for \"Site1\" and for \"Site2\".</p>\n\n<p>So on my main sheet \nif \"Change from\" is in F4 = \"Site1\"\nand \"Change to\" is in F5 = \"Site2\"  </p>\n\n<p>I want the corresponding cells to change to reflect Site2 when I run the macro. </p>\n\n<p>So far I have figured out how to change all regular references and formulas to switch to the appropriate sheet. I however, cannot get it to change the portion of the hyperlink that links to the specific sheet:</p>\n\n<p>For example I need only the sheet name to change</p>\n\n<p>from:</p>\n\n<pre><code>C:\\Documents\\test.xlsm - Site1!A1\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>C:\\Documents\\test.xlsm - Site2!A1\n</code></pre>\n\n<p>I tried the following code but it did not work:</p>\n\n<p>I also tried the solutions give here, but they only seem to change the path names, but do not let me change the sheet name. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/2805046/excel-hyperlink-mass-update\">Excel Hyperlink mass update</a></p>\n\n<p>Any help would be greatly appreciated! </p>\n\n<pre><code>Sub test()\n    Dim hLink As Hyperlink\n    Dim wSheet As Worksheet\n\n    For Each wSheet In Worksheets\n       For Each hLink In wSheet.Hyperlinks\n            hLink.Address = Replace(hLink.Address, \"Site1\", \"Site2\")\n        Next hLink\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 1, "creation_date": 1556088036, "post_id": 55823595, "comment_id": 98312949, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556089913, "post_id": 55823595, "comment_id": 98313783, "body": "Your question is very unclear, because you didn&#39;t tell what <i>&quot;the first range&quot;</i> actually is. Please <a href=\"https://stackoverflow.com/posts/55823595/edit\">edit</a> your question and add a screenshot of your worksheet and explain it as detailed as possible. \u2022 Please also include the code you have tried."}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1556133578, "post_id": 55824471, "comment_id": 98338485, "body": "Need to qualify <code>.UsedRange</code>. Also is the intention is to exclude <code>Column(1)</code> from <code>UsedRange</code> then <code>Intersect </code> is not needed. This will set the range <code>Set UsedRangeExceptColumnA = Range(Columns(2), .Columns(.UsedRange.Columns.Count + .UsedRange.Column - 1))</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1556137894, "post_id": 55824471, "comment_id": 98340239, "body": "@EEM No, <code>Intersect</code> is needed because otherwise if you do what you suggest it will include the entire columns (not only the used rows). \u2022 <code>UsedRange</code> must only be qualified if used in a module otherwise it will automatically refer to the sheets scope (which I assumed). But of course full qualified references are preferable."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1556139513, "post_id": 55824471, "comment_id": 98340903, "body": "<i>Apologies you are absolutely correct on about the need to intersect.</i> Also, there was no indication that the procedure was written in a <code>Sheet.Module</code> which seldom happens. Btw be aware that the <code>UsedRange</code> not necessarily starts at A1\u2026"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1556139518, "post_id": 55824471, "comment_id": 98340904, "body": "@EEM Well, if he wants to exclude column A as stated in the question then the <code>UsedRange</code> <i>must</i> start in column A (or if not it doesn&#39;t matter, the code will work anyway). Also since <code>UsedRange.Select</code> worked for the OP, his code is within a sheet and not a module."}, {"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1556139631, "post_id": 55824471, "comment_id": 98340945, "body": "I also tested, but the rest of the rows were not showing in the screen, as I said before you are absolutely correct, about the need for intersect"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1556090590, "creation_date": 1556090590, "answer_id": 55824471, "question_id": 55823595, "link": "https://stackoverflow.com/questions/55823595/how-to-unselect-specific-data-in-excel-vba/55824471#55824471", "title": "How to unselect specific data in Excel VBA?", "body": "<p>You could use <code>Intersect</code> to intersect the <code>UsedRange</code> with columns 2 to x where <code>x</code> is the last column of the used range. This way column A is excluded.</p>\n\n<p>But you should really avoid using <code>Select</code> it is a very bad practice and makes your code slow and unreliable: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub SelectUsedRangeExceptColumnA()\n    Dim UsedRangeExceptColumnA As Range\n    Set UsedRangeExceptColumnA = Intersect(UsedRange, Range(Columns(2), Columns(UsedRange.Columns.Count + UsedRange.Column - 1)))\n\n    If Not UsedRangeExceptColumnA Is Nothing Then\n        UsedRangeExceptColumnA.Select\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9141511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bded4fcd96ad0d4e7fbfadf254494d35?s=128&d=identicon&r=PG&f=1", "display_name": "Divyam Sureka", "link": "https://stackoverflow.com/users/9141511/divyam-sureka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1556090590, "creation_date": 1556087069, "last_edit_date": 1556090007, "question_id": 55823595, "link": "https://stackoverflow.com/questions/55823595/how-to-unselect-specific-data-in-excel-vba", "title": "How to unselect specific data in Excel VBA?", "body": "<p>Ok so i need to select all the used up ranges except the first range(A range). So I selected all the used ranges using <code>UsedRange.Select</code>, and now i need to unselect the first range. Is there any way to do this?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1556088982, "post_id": 55823167, "comment_id": 98313354, "body": "You are a gentleman Siddharth...finally got this to work. Now just need to get Worksheet_Change events going and i am done."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1556084953, "creation_date": 1556084953, "answer_id": 55823167, "question_id": 55822865, "link": "https://stackoverflow.com/questions/55822865/worksheet-change-event-check-cells-in-column-for-difference/55823167#55823167", "title": "Worksheet Change Event - check cells in column for % difference", "body": "<p>No need to have a separate funciton. You can include it in the main code. Also use <code>Intersect</code> to work with the relevant range else the code will trigger if there is a change anywhere in that row range. One more thing. Check if the cell in column J is not <code>0</code> else you will get an Overflow error.</p>\n\n<p>You may also want to see <a href=\"https://stackoverflow.com/questions/13860894/why-ms-excel-crashes-and-closes-during-worksheet-change-sub-procedure/13861640#13861640\">Working with Worksheet_Change</a></p>\n\n<p>Is this what you are trying (<strong>Untested</strong>)?</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    Dim rngToCheck As Range\n    Dim NumA As Variant, NumB As Variant\n    Dim i As Long\n\n    On Error GoTo Whoa\n\n    '~~&gt; Set the relevant range\n    Set rngToCheck = Union(Range(\"G12:G42\"), Range(\"J12:J42\"))\n\n    Application.EnableEvents = False\n\n    If Not Intersect(Target, rngToCheck) Is Nothing Then\n        For i = 12 To 42 Step 2 '&lt;~~ Loop through only even rows\n            NumA = Range(\"G\" &amp; i).Value\n            NumB = Range(\"J\" &amp; i).Value\n\n            If IsNumeric(NumA) And IsNumeric(NumB) And NumB &lt;&gt; 0 Then\n                If ((NumA - NumB) / NumB) * 100 &gt; 10 Then\n                    MsgBox \"Please check the value of Col G and J Cells in row \" &amp; i\n                    Exit For\n                End If\n            End If\n        Next i\n    End If\n\nLetscontinue:\n    Application.EnableEvents = True\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n    Resume Letscontinue\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556085073, "creation_date": 1556083191, "last_edit_date": 1556085073, "question_id": 55822865, "link": "https://stackoverflow.com/questions/55822865/worksheet-change-event-check-cells-in-column-for-difference", "title": "Worksheet Change Event - check cells in column for % difference", "body": "<p>I am struggling to get a Worksheet_Change event to work with the goal of checking if there is a % difference greater than 10% between range G12:42 and range J12:42. I have a calculation in range G12:42, which seems to be causing me some of the headache.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim diffPercent\n    'Check that the data is changed between row 12 and 42 and it is even row. eg 12,14,16...42.\n    If (Target.Row &gt; 12 And Target.Row &lt; 42) And ((Target.Row Mod 2) = 0) Then  'And _\n            '(Target.Column = 7 Or Target.Column = 10) Then\n\n        'Get the values in J ang G columns of that particular row.\n        number1 = Range(\"G\" &amp; Target.Row).Value\n        number2 = Range(\"J\" &amp; Target.Row).Value\n\n        'Check for presence of both the inputs to calculate difference in percentage.\n        If Not chkInputs(number1, number2) Then\n            Exit Sub\n        End If\n        'Calculate the percentage difference.\n        diff = number2 - number1\n        diffPercent = (diff / number2) * 100\n\n        'Give alert if difference more than 10 percent\n        If diffPercent &gt; 10 Then\n            MsgBox \"Oppps. Your system is not working!\"\n        End If\n    End If\n\nEnd Sub\n\nFunction chkInputs(number1, number2)\nchkInputs = False\nIf IsNumeric(number1) And IsNumeric(number2) Then\n    chkInputs = True\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>The expected result is the triggering of a MsgBox providing a message.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556079506, "post_id": 55822176, "comment_id": 98310274, "body": "The editor is highlighting the word <code>Character</code> as it warns about the user-defined type not being defined..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556079542, "post_id": 55822176, "comment_id": 98310281, "body": "Note that <code>ByRef</code> is the implicit default: both parameters of that function are passed by reference. One explicitly, the other implicitly."}], "answers": [{"tags": [], "owner": {"reputation": 28480, "user_id": 1137199, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/41GR5.png?s=128&g=1", "display_name": "dotNET", "link": "https://stackoverflow.com/users/1137199/dotnet"}, "is_accepted": false, "score": 1, "last_activity_date": 1556079035, "creation_date": 1556079035, "answer_id": 55822296, "question_id": 55822176, "link": "https://stackoverflow.com/questions/55822176/how-to-pass-array-to-function/55822296#55822296", "title": "How to pass array to function", "body": "<p>IIRC, <code>Character</code> is not a VBA type. You should pass it as <code>String</code> or <code>Byte</code> instead. In Visual Basic, single characters can also be stored in fixed-length strings (<code>Dim myChar As String * 1</code>), but that syntax is not supported for method parameters.</p>\n\n<p>So your function declaration should look like this:</p>\n\n<pre><code>Function checkDevNo(ByRef aaray() As String, aa As String) As String\n    ...\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1556094710, "creation_date": 1556094710, "answer_id": 55825653, "question_id": 55822176, "link": "https://stackoverflow.com/questions/55822176/how-to-pass-array-to-function/55825653#55825653", "title": "How to pass array to function", "body": "<p>If we're talking Excel VBA, then you'll need to do the following:</p>\n\n<pre><code>Function checkDevNo(aaray As Variant, aa As String) As String\n\n    Select Case aa\n\n        Case \"1\"\n            For j = 1 To 6\n                If aaray(j, 1) = 6 Then\n                    checkDevNo = j\n                End If\n            Next j\n        Case \"2\"\n            For j = 1 To 6\n                If aaray(j, 1) = 7 Then\n\n                End If\n            Next j\n\n    End Select\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9551255, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Thana P.", "link": "https://stackoverflow.com/users/9551255/thana-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556094710, "creation_date": 1556077994, "last_edit_date": 1556079265, "question_id": 55822176, "link": "https://stackoverflow.com/questions/55822176/how-to-pass-array-to-function", "title": "How to pass array to function", "body": "<p>I try to pass array to function in VBA EXCEL. I cannot find proper example as I try to do</p>\n\n<p>I try to pass array to function\nIn function declaration\nI try set variable array as variant or ByRef but not work\nWhat's I am wrong?</p>\n\n<pre><code>Dim Retarray(1 To 6, 1 To 2) As String  \n</code></pre>\n\n<p>This is my array\nThen try to pass to function as </p>\n\n<pre><code>Smap = checkDevNo(Retarray, Right(CellArray(i, 1), 1))\n</code></pre>\n\n<p>This is my function declaration</p>\n\n<pre><code>Function checkDevNo(ByRef aaray() As String, aa As Character) As String\n\nSelect Case aa\n\nCase \"1\"\n    For j = 1 To 6\n        If aaray(j, 1) = 6 Then\n            checkDevNo = j\n        End If\n    Next j\nCase \"2\"\n    For j = 1 To 6\n        If aaray(j, 1) = 7 Then\n\n        End If\n    Next j\nEnd Select\nEnd Function\n</code></pre>\n\n<p>compile error user define type not define ??</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2440323"}, "edited": false, "score": 0, "creation_date": 1556090985, "post_id": 55823698, "comment_id": 98314289, "body": "Run-time error 438 on line  If Not IsNull(Me.Controls(CurrentTextbox).Value) Then"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1556091628, "post_id": 55823698, "comment_id": 98314606, "body": "Then your control referenced is not a textbox. A label?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2440323"}, "edited": false, "score": 0, "creation_date": 1556092118, "post_id": 55823698, "comment_id": 98314872, "body": "It is an unbound textbox named txtObs1 placed on a subform together with all other. Also, I couldn&#39;t use Private CurrentTextbox As String, Private gives me error. Probably this is the cause of the error"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1556095296, "post_id": 55823698, "comment_id": 98316665, "body": "<code>Private CurrentTextbox As String</code> goes into the Declarations&#39; section. See edited answer, please."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2440323"}, "edited": false, "score": 0, "creation_date": 1556096851, "post_id": 55823698, "comment_id": 98317639, "body": "That was the problem, everything is very well now. Thank you"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1556095236, "last_edit_date": 1556095236, "creation_date": 1556087544, "answer_id": 55823698, "question_id": 55821911, "link": "https://stackoverflow.com/questions/55821911/pseudo-pop-up-textbox-to-update-multiple-form-textbox/55823698#55823698", "title": "Pseudo pop-up textbox to update multiple form textbox", "body": "<p>Set a variable to hold the name of the textbox:</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nPrivate CurrentTextbox As String\n\n\nPrivate Sub txtAddData_AfterUpdate()\n\n    Me.Controls(CurrentTextbox).Value = Me.txtAddData\n    Me.Controls(CurrentTextbox).SetFocus\n    Me.txtAddData = Null\n    Me.txtAddData.Visible = False\n\nEnd Sub\n\n\nPrivate Sub txtObs1_Click()\n\n    CurrentTextbox = \"txtObs1\"\n    SetData\n\nEnd Sub\n\n\nPrivate Sub txtObs2_Click()\n\n    CurrentTextbox = \"txtObs2\"\n    SetData\n\nEnd Sub\n\n\nPrivate Sub SetData\n\n    txtAddData.Visible = True\n    txtAddData.SetFocus\n    If Not IsNull(Me.Controls(CurrentTextbox).Value) Then\n        Me.txtAddData = Me.Controls(CurrentTextbox).Value\n    Else\n        Me.txtAddData = Null\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2440323"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 55823698, "answer_count": 1, "score": 1, "last_activity_date": 1594570479, "creation_date": 1556075922, "last_edit_date": 1594570479, "question_id": 55821911, "link": "https://stackoverflow.com/questions/55821911/pseudo-pop-up-textbox-to-update-multiple-form-textbox", "title": "Pseudo pop-up textbox to update multiple form textbox", "body": "<p>I have a Form containing a checklist with several textboxes, txtObs1, txtObs2, txtObs3, etc. On click event on each textbox will pop-up (actually is a hidden textbox made visible) txtAddData. I can enter data in txtAddData and update the textbox with afterupdate event but I want to use the same txtAddData to update the rest of the textboxes on the form one by one.</p>\n\n<pre><code>Private Sub txtAddData_AfterUpdate()\nMe.txtObs1 = Me.txtAddData\nMe.txtObs1.SetFocus\nMe.txtAddData = \"\"\nMe.txtAddData.Visible = False\nEnd Sub\n\nPrivate Sub txtObs1_Click()\ntxtAddData.Visible = True\ntxtAddData.SetFocus\nIf Not IsNull(Me.txtObs1) Then\nMe.txtAddData = Me.txtObs1\nElse\nMe.txtAddData = \"\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1556073664, "post_id": 55821496, "comment_id": 98309212, "body": "Why don&#39;t you loop inside the click event n number of times?"}, {"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1556074566, "post_id": 55821496, "comment_id": 98309379, "body": "Just to make sure I&#39;m understanding, you&#39;re saying I should put the loop inside the Generate_data_button_Click() sub and just have n = data_points_textbox.Value?  My goal is to be able to input my data, have the macro input the data into &quot;n&quot; number of rows, change some of the textbox values, repeat the process, all within the same sheet."}, {"owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1556075265, "post_id": 55821496, "comment_id": 98309508, "body": "What I meant is that you can have a loop in the click event that iterates n number of times where n = data_points_textbox.Value. As for the rest - it&#39;s quite vague, you cannot tell the computer to change SOME values :) So you have to be specific."}, {"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "reply_to_user": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "edited": false, "score": 0, "creation_date": 1556076489, "post_id": 55821496, "comment_id": 98309720, "body": "Ohhh gotcha!! Yeah I don&#39;t plan on automating the change in values, it will be user derived based on the scenario they are building data for.  I see where my lack of specificity could be confusing :)  I&#39;ll start putting some brain bytes towards that and see what I can come up with.  Thanks for the suggestion!"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1557855889, "post_id": 55823677, "comment_id": 98902791, "body": "Sorry for the delayed response, I have been off of the internet for about a month.  I think this will work.  I was adapting it to the my code and it generates multiple rows with one click!  I literally threw my hands up in the air haha.  However, I am running into two issues I am trying to work through.  1.) I have a total of 17 arrays but its only looping the first 4.  2.) I can&#39;t seem to get it to output in date and time formats I have specified for the cells.  Prior to the loop, I was automating the format using Cells (emptyRow, 3).NumberFormat = &quot;&quot;"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1557863153, "post_id": 55823677, "comment_id": 98906160, "body": "I don&#39;t get the point about your arrays. My code populates 1 single array with values from, in this example, 6 imaginary textboxes. You&#39;ll have to change that to whatever your configuration is. The second issue comes probably from the way VBA wants to use US styled dates. Search on SO, plenty of threads on this matter"}, {"owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1557868907, "post_id": 55823677, "comment_id": 98908332, "body": "I apologize, that was a misspeak on my part.  Thank you very much for the assistance."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "edited": false, "score": 0, "creation_date": 1557869189, "post_id": 55823677, "comment_id": 98908440, "body": "Glad to have helped! <i>If</i> this was a helpful answer, please accept it :)"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": true, "score": 0, "last_activity_date": 1556087466, "creation_date": 1556087466, "answer_id": 55823677, "question_id": 55821496, "link": "https://stackoverflow.com/questions/55821496/is-there-a-way-to-loop-a-command-button-in-a-userform-based-off-of-a-number-inpu/55823677#55823677", "title": "Is there a way to loop a command button in a userform based off of a number input from a textbox?", "body": "<p>The way I understand the problem:</p>\n\n<ol>\n<li>A button on a UF currently outputs values from textboxes to a single row</li>\n<li>You want the output to an x amount of rows, based on the value of another textbox</li>\n</ol>\n\n<p>This could be achieved by looping the code inside the macro linked to the command button</p>\n\n<pre><code>Private Sub Generate_data_button_Click()\nDim arr(5) As String\nDim i As Long\nDim LRow As Long\nDim FEmptyRow As Long\n\n'Using 6 textboxes as an example. Change to your configuration \narr(0) = TextBox1.Value\narr(1) = TextBox2.Value\narr(2) = TextBox3.Value\narr(3) = TextBox4.Value\narr(4) = TextBox5.Value\narr(5) = TextBox6.Value\n\nWith Workbooks(REF).Sheets(REF)\n    For i = 1 To data_points_textbox.Value\n        LRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1 'determines the last filled row in column A\n        FEmptyRow = .Cells(1, \"A\").End(xlDown).Row + 1 'determines the first empty row as seen from the top row (using this can cause filled rows below it to be overwritten!)\n\n        .Range(\"A\" &amp; LRow &amp; \":F\" &amp; LRow).Value = arr\n        '.Range(\"A\" &amp; FEmptyRow &amp; \":F\" &amp; FEmptyRow).Value = arr  'Alternative with the first empty row\n    Next i\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11371306, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tD2mN8vFShQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc63TLMUNIivoxfvFBasorOU2Oixw/mo/photo.jpg?sz=128", "display_name": "ARCHER1919", "link": "https://stackoverflow.com/users/11371306/archer1919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 55823677, "answer_count": 1, "score": 0, "last_activity_date": 1556093279, "creation_date": 1556072554, "last_edit_date": 1556093279, "question_id": 55821496, "link": "https://stackoverflow.com/questions/55821496/is-there-a-way-to-loop-a-command-button-in-a-userform-based-off-of-a-number-inpu", "title": "Is there a way to loop a command button in a userform based off of a number input from a textbox?", "body": "<p>As with my other post, please forgive my lack of knowledge in this subject, I am very new to coding.</p>\n\n<p>I have a userform that has multiple textboxes where a user can input data.  Once that data is input into the form, the user clicks a command button and the code outputs the data to the first empty row it finds.  This part of the code works very well.  </p>\n\n<p>My question: How can I loop the command button to click itself \"n\" times where n = data_points_textbox.Value.  My goal is to be able to get the macro to generate large amounts of data with a single click. </p>\n\n<p>I've tried posts like this one \n<a href=\"https://stackoverflow.com/questions/49050223/vba-loop-through-buttons-on-userform\">VBA loop through buttons on UserForm</a></p>\n\n<p>and </p>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/en-US/bcb8b8b4-4bcf-404d-9fdb-a9d5f31f6b19/loop-through-excel-userform-textcombo-box-and-write-to-worksheet?forum=isvvba\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/bcb8b8b4-4bcf-404d-9fdb-a9d5f31f6b19/loop-through-excel-userform-textcombo-box-and-write-to-worksheet?forum=isvvba</a></p>\n\n<p>While helpful, I am not sure these posts quite apply to my situation and I'm not sure I honestly understand what they are doing.  </p>\n\n<pre><code>'Here is an excerpt of the code I am using, for various reasons I can't post all of it\n\nPrivate Sub Data_Generator_Initialize()\n\n'Empty Type_textbox\ntype_textbox.value = \"\"\n\nEnd Sub \n\nPrivate Sub Generate_data_button_Click()\n\n'Make sheet1 active\nSheet1.activate\n\n'Determine emptyRow\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\n\n'Transfer data to sheet1\nCells(emptyRow, 1).Value = type_textbox.Value \n\nEnd Sub \n\n'I have about 20 additional cells that are populated with data from various textboxes but I think this illustrates the point\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11342436, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kwL94RCjR40/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWi4InUcKvwaNNFf1vv3NxIU81-A/mo/photo.jpg?sz=128", "display_name": "Alex Sirbu", "link": "https://stackoverflow.com/users/11342436/alex-sirbu"}, "edited": false, "score": 0, "creation_date": 1556076601, "post_id": 55821937, "comment_id": 98309741, "body": "That&#39;s an interesting solution too, thanks Siddharth"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1556077798, "post_id": 55821937, "comment_id": 98309932, "body": "Brilliant Workaround.. up voted, may also use <code>For Each cel In Range(&quot;B2:B&quot; &amp; lRow).Cells : cel.Offset(0, -1).Value = cel.Font.Color : Next</code> instead of `  .<code>Range(&quot;A2:A&quot; &amp; lRow).Formula = &quot;=IF(RC[1]=&quot;&quot;enrolled&quot;&quot;,1,IF(RC[1]=&quot;&quot;waitlisted&quot;&quot;,2,3))&quot;</code> to process any color value."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1556076154, "creation_date": 1556076154, "answer_id": 55821937, "question_id": 55821366, "link": "https://stackoverflow.com/questions/55821366/sort-on-font-color-using-vba/55821937#55821937", "title": "Sort on font color using vba", "body": "<p>Since there are only 3 values, we use a helper column and then assign values to it. We then sort and then finally delete the helper column.</p>\n\n<p>Let's say, your data looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/Pznry.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Pznry.png\" alt=\"enter image description here\"></a></p>\n\n<p>Try this code. I have commneted the code so you should not have a problem in understanding it.</p>\n\n<pre><code>Sub Sample()\n    Dim ws As Worksheet\n    Dim lRow As Long, lCol As Long\n    Dim rng As Range\n    Dim ColName As String\n\n    '~~&gt; Change this to the relevant sheet\n    Set ws = Sheet1\n\n    With ws\n        '~~&gt; Insert a helper column in Col A\n        .Columns(1).Insert Shift:=xlToRight\n        .Cells(1, 1).Value = \"TmpHeader\"\n\n        '~~&gt; Get Last Row and last Column\n        '~~&gt; I am assuming that headers are in row 1\n        lRow = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n        lCol = .Cells(1, Columns.Count).End(xlToLeft).Column\n        ColName = Split(Cells(, lCol).Address, \"$\")(1)\n\n        '~~&gt; Insert the formula in Col A\n        .Range(\"A2:A\" &amp; lRow).Formula = \"=IF(RC[1]=\"\"enrolled\"\",1,IF(RC[1]=\"\"waitlisted\"\",2,3))\"\n\n        '~~&gt; Set your range\n        Set rng = .Range(\"A1:\" &amp; ColName &amp; lRow)\n\n        '~~&gt; Sort it\n        rng.Sort Key1:=.Range(\"A2\"), Order1:=xlAscending, Header:=xlYes, _\n        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _\n        DataOption1:=xlSortNormal\n\n        '~~&gt; Delete the helper column\n        .Columns(1).Delete\n    End With\nEnd Sub\n</code></pre>\n\n<p>When you run the above code, it inserts a helper column and then inserts a formula <code>=IF(B2=\"enrolled\",1,IF(B2=\"waitlisted\",2,3))</code> What this basically does is assigns a value of 1,2 and 3 based on the value whether it is enrolled, waitlisted or cancelled.</p>\n\n<p><a href=\"https://i.stack.imgur.com/9nhqo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9nhqo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Once the formula is inserted, we sort on Col A in ascending order and then finally delete the helper column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/N1UXd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N1UXd.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 11342436, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kwL94RCjR40/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWi4InUcKvwaNNFf1vv3NxIU81-A/mo/photo.jpg?sz=128", "display_name": "Alex Sirbu", "link": "https://stackoverflow.com/users/11342436/alex-sirbu"}, "is_accepted": false, "score": 0, "last_activity_date": 1556076506, "creation_date": 1556076506, "answer_id": 55821974, "question_id": 55821366, "link": "https://stackoverflow.com/questions/55821366/sort-on-font-color-using-vba/55821974#55821974", "title": "Sort on font color using vba", "body": "<p>Figured it out: </p>\n\n<pre><code>ActiveSheet.Range(\"A3\").CurrentRegion.Sort Key1:=Range(\"I3\"), Header:=xlYes\n\nActiveSheet.Sort.SortFields.Clear\nActiveSheet.Sort.SortFields.Add(Range(\"I3\"), _\nxlSortOnFontColor, xlDescending, , _\nxlSortNormal).SortOnValue.Color = RGB(192, 192, 192)\n\nWith ActiveSheet.Sort\n   .SetRange Range(\"A3\").CurrentRegion\n   .Header = xlYes\n   .MatchCase = False\n   .Orientation = xlTopToBottom\n   .SortMethod = xlPinYin\n   .Apply\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11342436, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kwL94RCjR40/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdWi4InUcKvwaNNFf1vv3NxIU81-A/mo/photo.jpg?sz=128", "display_name": "Alex Sirbu", "link": "https://stackoverflow.com/users/11342436/alex-sirbu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556076506, "creation_date": 1556071470, "last_edit_date": 1556074557, "question_id": 55821366, "link": "https://stackoverflow.com/questions/55821366/sort-on-font-color-using-vba", "title": "Sort on font color using vba", "body": "<p>I am trying to implement a button that, when pressed sorts an array first alphabetically, then based on font color. The column that I am using to sort has 3 possible values (enrolled, waitlisted, and cancelled). The font color for 'cancelled' is grey. I want to get enrolled at the top of the list, then waitlisted, then cancelled at the bottom. Shouldn't be that difficult, but I can't get the code to work. Here's the code I wrote. Many thanks!</p>\n\n<pre><code>Private Sub btnSort_Click()\nDim SortArray As Range\nDim SortColumn As Range\n\n\nSet SortArray = Range(\"A3\").CurrentRegion\nSet SortColumn = Range(Range(\"A3\").End(xlToRight), Range(\"A3\").End(xlToRight).End(xlDown))\n\nSortArray.Sort Key1:=SortColumn, Header:=xlYes\n\nWith SortArray.Sort\n    .SortFields.Clear\n    .SortFields.Add Key:=SortColumn\n    .xlSortOnFontColor\n    .SortOnValue.Color = RGB(192, 192, 192)\n    .SortOrder = xlAscending\n    .Header = xlYes\n    .Apply\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "variables"], "comments": [{"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 4, "creation_date": 1556069810, "post_id": 55820952, "comment_id": 98308460, "body": "Code such as this should be burnt with fire. Just saying."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 2, "creation_date": 1556073337, "post_id": 55820952, "comment_id": 98309163, "body": "<i>I have a hard time understanding the following code</i> - don&#39;t worry, that&#39;s completely normal: this is exactly why incrementing a <code>For</code> loop counter inside the loop&#39;s body is a bad practice and should be avoided at all costs, as @DeanOC kind of hinted at. It&#39;s great that you&#39;re experimenting and trying to understand things, keep it up!"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1556072166, "post_id": 55821018, "comment_id": 98308944, "body": "<i>&quot;You should note that typically it&#39;s bad practise to alter a For loop counter inside the loop&quot;</i> -- THIS!! Have an upvote! (++ for the rest of the answer as well =)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1556065025, "creation_date": 1556065025, "answer_id": 55821018, "question_id": 55820952, "link": "https://stackoverflow.com/questions/55820952/how-does-a-variable-refer-to-the-same-variable-in-vba/55821018#55821018", "title": "How does a variable refer to the same variable in vba?", "body": "<p>You should note that typically it's bad practise to alter a <code>For</code> loop counter inside the loop.</p>\n\n<p>Here's what's going on though:</p>\n\n<p>As the loop runs, <code>Next i</code> adds one to the value of <code>i</code> (even though you already added one...)  - if the value of <code>i</code> is outside of the <code>For</code> bounds then the loop terminates.</p>\n\n<p>So:</p>\n\n<p>Iteration 1: <code>i</code> enters the loop as 1, is incremented to 2, then again to 3 by the <code>Next i</code></p>\n\n<p>Iteration 2: <code>i</code> enters the loop as 3, is incremented to 4, then again to 5 by the <code>Next i</code></p>\n\n<p>5 is outside of 1-3, so <code>i</code> ends up as 5</p>\n"}, {"tags": [], "owner": {"reputation": 1375, "user_id": 8817027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJxo8.jpg?s=128&g=1", "display_name": "Emilio Lucas Ceroleni", "link": "https://stackoverflow.com/users/8817027/emilio-lucas-ceroleni"}, "is_accepted": false, "score": 0, "last_activity_date": 1556065334, "creation_date": 1556065334, "answer_id": 55821050, "question_id": 55820952, "link": "https://stackoverflow.com/questions/55820952/how-does-a-variable-refer-to-the-same-variable-in-vba/55821050#55821050", "title": "How does a variable refer to the same variable in vba?", "body": "<p>Saying <code>i = i + 1</code> has the same effect that <code>Next i</code>.  You basically are adding 1 to i within the <code>for</code> statement and once again when you increment it.</p>\n\n<pre><code>For i = 1 to 3 'starts with i = 1\n    i = i + 1 'adds 1 to i, i = 2 in the first loop\nNext i  'adds 1 to i, i = 3 at the end of the first loop. Thee second loop starts\n</code></pre>\n\n<p>i starts the secons loop with a value of 3 and you add 1 to it when \n <code>i = i + 1</code>  and once again when <code>Next i</code></p>\n\n<p>I hope this helps you understand it and sorry that my answer is a bit untidy, I'm answering from my mobile.</p>\n"}, {"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1556069942, "post_id": 55821067, "comment_id": 98308482, "body": "It&#39;ll run just once with the loop &quot;condition&quot; as <code>&lt;= 3</code>, it will never reach 5."}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "reply_to_user": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 1, "creation_date": 1556072675, "post_id": 55821067, "comment_id": 98309039, "body": "@EEM - Why is that? After the first iteration the value of <code>i</code> is <code>3</code> so it would iterate a second time."}], "tags": [], "owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "is_accepted": false, "score": 0, "last_activity_date": 1556065454, "creation_date": 1556065454, "answer_id": 55821067, "question_id": 55820952, "link": "https://stackoverflow.com/questions/55820952/how-does-a-variable-refer-to-the-same-variable-in-vba/55821067#55821067", "title": "How does a variable refer to the same variable in vba?", "body": "<p>Here's your <code>For</code> loop re-written using a <code>While</code> loop:</p>\n\n<pre><code>i = 1\nWhile i &gt;= 1 And i &lt;= 3\n    i = i + 1\n    i = i + 1\nEnd While\n</code></pre>\n\n<p>Note that <code>Next i</code> is directly translated as <code>i = i + 1</code> - so now for each iteration of the loop you are effectively performing <code>i = i + 2</code>.</p>\n\n<p>Since <code>i</code> is <code>1</code> at the start it matches the loop condition so we add <code>2</code> to <code>i</code>. It still matches the loop condition so we execute the loop again adding another <code>2</code>.</p>\n\n<p>This means that <code>i</code> is <code>1 + 2 + 2</code> or <code>5</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 11402528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EWNN8W2kRfg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc1rwB5FSM6Gk7EptHA9S5YyOxIYQ/mo/photo.jpg?sz=128", "display_name": "Ilan S", "link": "https://stackoverflow.com/users/11402528/ilan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1556072215, "creation_date": 1556064352, "last_edit_date": 1556072215, "question_id": 55820952, "link": "https://stackoverflow.com/questions/55820952/how-does-a-variable-refer-to-the-same-variable-in-vba", "title": "How does a variable refer to the same variable in vba?", "body": "<p>total beginner here. I have a hard time understanding the following code, or any code that operates the same variable.</p>\n\n<p>For example:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim i As Long\n\nFor i = 1 To 3\ni = i + 1\nNext i\n\nMsgBox (i)\n\nEnd Sub\n</code></pre>\n\n<p>Why does this return 5?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1556089494, "post_id": 55820737, "comment_id": 98313587, "body": "I recommend to use <code>WorksheetFunction.CountIf</code> instead of <code>Find</code> to determine if it is a duplicate or not."}], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "is_accepted": true, "score": 0, "last_activity_date": 1556088755, "last_edit_date": 1556088755, "creation_date": 1556079288, "answer_id": 55822335, "question_id": 55820737, "link": "https://stackoverflow.com/questions/55820737/worksheet-change-event-duplication-check-ignore-blanks/55822335#55822335", "title": "Worksheet_Change Event - Duplication Check, Ignore Blanks", "body": "<p>Thanks for the help K.Davis. I appreciate your time and effort.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Value = vbNullString Then Exit Sub\n    Dim cell As Range\n\n    On Error GoTo ws_exit\n\n    Application.EnableEvents = False\n\n    With Target\n\n    If .Column = 3 Then\n\n    With .EntireColumn\n\n    Set cell = .Find(What:=Target.Value, AFter:=.Cells(1, 1))\n    If cell.Address = Target.Address Then\n\n    Set cell = .FindNext()\n    End If\n\n    If Not cell.Address = Target.Address Then\n\n    MsgBox \"This Glazing Reference already exists. Please ensure you have a unique reference identifier less than 20 characters in length\", vbOKOnly\n    End If\n    End With\n    End If\n    End With\n\n    ws_exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "edited": false, "score": 0, "creation_date": 1556090899, "post_id": 55824137, "comment_id": 98314242, "body": "Thanks PEH. I cannot use conditional formatting as it is already being used for other requirements."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1556089431, "creation_date": 1556089431, "answer_id": 55824137, "question_id": 55820737, "link": "https://stackoverflow.com/questions/55820737/worksheet-change-event-duplication-check-ignore-blanks/55824137#55824137", "title": "Worksheet_Change Event - Duplication Check, Ignore Blanks", "body": "<p>First you must consider that <code>Target</code> is a range of multiple cells and not only one cell. Therefore it is necessary to use <code>Intersect</code> to get all the cell that are changed in column 3 and then you need to loop through these cells to check each of them.</p>\n\n<p>Also I recommend to use <code>WorksheetFunction.CountIf</code> to count how often this value occurs if it is <code>&gt;1</code> then it is a duplicate. This should be faster then using <code>Find</code>.</p>\n\n<p>Note that the following code looks for duplicates in column 3 only if you want to check if a duplicate exists anywhere in the worksheet replace <code>CountIf(Me.Columns(3), Cell.Value)</code> with <code>CountIf(Me.Cells, Cell.Value)</code></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim AffectedRange As Range\n    Set AffectedRange = Intersect(Target, Me.Columns(3))\n\n    If Not AffectedRange Is Nothing Then\n        Dim Cell As Range\n        For Each Cell In AffectedRange\n\n            If Application.WorksheetFunction.CountIf(Me.Columns(3), Cell.Value) &gt; 1 Then\n                MsgBox \"This Wall Reference already exists. Please ensure you have a unique reference identifier less than 20 characters in length\", vbOKOnly + vbExclamation\n            End If\n\n        Next Cell\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Instead of using VBA you could also use Conditional Formatting to highlight duplicates in red for example. Could be easier to archieve (use the <code>=CountIf</code> formula as condition). And also it will always highlight all duplicates immediately which makes it easy to determine them.</p>\n"}], "owner": {"reputation": 35, "user_id": 10724462, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a2a81605ddc9c1932a708db2bd97802?s=128&d=identicon&r=PG&f=1", "display_name": "Vietman78", "link": "https://stackoverflow.com/users/10724462/vietman78"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 55822335, "answer_count": 2, "score": 0, "last_activity_date": 1556091360, "creation_date": 1556062376, "last_edit_date": 1556091360, "question_id": 55820737, "link": "https://stackoverflow.com/questions/55820737/worksheet-change-event-duplication-check-ignore-blanks", "title": "Worksheet_Change Event - Duplication Check, Ignore Blanks", "body": "<p>I am using a VBA change event to look for duplicates in column C. The code below works but when i delete all values within the range, blanks are triggered as duplicates so i need to include a way to ignore duplicates from the code. Any ideas? </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim cell As Range\n\n    On Error GoTo ws_exit\n\n    Application.EnableEvents = False\n\n    With Target\n\n        If .Column = 3 Then\n\n            With .EntireColumn\n\n                Set cell = .Find(What:=Target.Value, AFter:=.Cells(1, 1))\n                If cell.Address = Target.Address Then\n\n                    Set cell = .FindNext()\n                End If\n\n                If Not cell.Address = Target.Address Then\n\n                    MsgBox \"This Wall Reference already exists. Please ensure you have a unique reference identifier less than 20 characters in length\", vbOKOnly\n                End If\n            End With\n        End If\n    End With\n\n    ws_exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>I expect to be able to ignore blanks but sill have the VBA run a duplication check to return a msgbox only if a duplication is found.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 2, "creation_date": 1556061512, "post_id": 55820590, "comment_id": 98307460, "body": "try changing <code>Sheet2</code> for <code>Sheets(2)</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556062311, "post_id": 55820590, "comment_id": 98307651, "body": "&quot;I keep getting an error&quot; - what error exactly?"}], "answers": [{"comments": [{"owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "edited": false, "score": 0, "creation_date": 1556065258, "post_id": 55820746, "comment_id": 98308243, "body": "suggest this: <code>With Sheet2.Range(&quot;D3:M20&quot;):    Set chtObj = Sheet2.ChartObjects.Add(.Left, .Top, .Width, .Height):     End With</code>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1556069951, "last_edit_date": 1556069951, "creation_date": 1556062479, "answer_id": 55820746, "question_id": 55820590, "link": "https://stackoverflow.com/questions/55820590/not-possible-to-make-this-reference/55820746#55820746", "title": "Not possible to make this reference", "body": "<p>Would be better written using a <code>With</code>, to ensure your ranges don't default to some other worksheet:</p>\n\n<pre><code>With Sheet2.Range(\"D3:M20\")\n    Set chtObj = .Parent.ChartObjects.Add(.Left, .Top, _\n                                          .Width, .Height)\nEnd With\n</code></pre>\n\n<p>You may need to adjust the worksheet reference (depending on exactly what error it is you're getting).</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6912617, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154642575502835/picture?type=large", "display_name": "Nicolas Lortie", "link": "https://stackoverflow.com/users/6912617/nicolas-lortie"}, "is_accepted": false, "score": 0, "last_activity_date": 1556062910, "creation_date": 1556062910, "answer_id": 55820795, "question_id": 55820590, "link": "https://stackoverflow.com/questions/55820590/not-possible-to-make-this-reference/55820795#55820795", "title": "Not possible to make this reference", "body": "<p>What exactly is the error you are getting ? The <code>Set</code> statement must be declared inside a procedure.</p>\n\n<p>I tried it quickly and the following code complile without problem.</p>\n\n<pre><code>Sub foo()\nDim chtObj As ChartObject\nSet chtObj = Worksheets(\"Sheet2\").ChartObjects.Add(Range(\"D3:M20\").Left, Range(\"D3:M20\").Top, Range(\"D3:M20\").Width, Range(\"D3:M20\").Height)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11260676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5671485d70f2ee0bccf63e348d88e7a8?s=128&d=identicon&r=PG&f=1", "display_name": "VBAuser12345", "link": "https://stackoverflow.com/users/11260676/vbauser12345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556069951, "creation_date": 1556061234, "last_edit_date": 1556061485, "question_id": 55820590, "link": "https://stackoverflow.com/questions/55820590/not-possible-to-make-this-reference", "title": "Not possible to make this reference", "body": "<p>For some reason I keep getting an error when i try this code</p>\n\n<pre><code>Set chtObj = ActiveWorkbook.Sheet2.ChartObjects.Add(Range(\"D3:M20\").Left, Range(\"D3:M20\").Top, Range(\"D3:M20\").Width, Range(\"D3:M20\").Height)\n</code></pre>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 517, "user_id": 10988123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5Gw0UI_qK9Q/AAAAAAAAAAI/AAAAAAAAAKA/VRhwKR3xJ5k/photo.jpg?sz=128", "display_name": "Nick", "link": "https://stackoverflow.com/users/10988123/nick"}, "edited": false, "score": 0, "creation_date": 1556069566, "post_id": 55820420, "comment_id": 98308411, "body": "Sounds like you&#39;re looking for a <code>do while findrownumberloan = True ... Loop</code>. Ill have a closer look later, but that should work in your case"}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556090779, "post_id": 55820420, "comment_id": 98314205, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.findnext\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.range.findnext</a>"}], "owner": {"reputation": 9, "user_id": 11314225, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MV3s8DBIIU0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdc6vZerxyUFXVnietmbp5rJZWbBA/mo/photo.jpg?sz=128", "display_name": "mendax88", "link": "https://stackoverflow.com/users/11314225/mendax88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556088578, "creation_date": 1556059808, "last_edit_date": 1556088578, "question_id": 55820420, "link": "https://stackoverflow.com/questions/55820420/find-and-find-next-function", "title": "find and find next function", "body": "<p>I am currently trying to finish this function that checks for values on another sheet but currently only checks for the first value only and not checking for the duplicates.</p>\n\n<p>sheet1 functions</p>\n\n<pre><code>Function Checkcollipotecaassente(row As Range)\n   Dim ndg As String\n   Dim loanid As String\n   Dim rowindex As Integer\n   ndg = extrapolatendg(row)\n   rowindex = Sheet6.findrownumberndg(ndg)\n   loanid = Sheet6.getloanid(rowindex)\n\n   If Sheet7.findrownumberloan(loanid) = True Then\n            If Sheet6.CheckDuplicate(ndg) = True Then\n               Do\n                rowindex = Sheet6.Findrownumberdg2(rowindex)\n                loanid = Sheet6.getloanid(rowindex)\n                Loop Until Sheet7.findrownumberloan(loanid) = False\n           End If\n\n       Checkcollipotecaassente = True\n   Else\n       Checkcollipotecaassente = False\n   End If\nEnd Function\n</code></pre>\n\n<p>sheet6 functions</p>\n\n<pre><code>Function CheckDuplicate(extrapolatendg As String) As Boolean\n\n    Set foundcell = Range(\"B:B\").Find(extrapolatendg, lookat:=xlWhole)\n    If foundcell Is Nothing Then\n        CheckDuplicate = False\n    Else\n        adrFirst = foundcell.Address\n        Set foundcell = Sheet6.Range(\"B:B\").FindNext(foundcell)\n        If foundcell.Address = adrFirst Then\n            CheckDuplicate = False\n        Else\n            CheckDuplicate = True\n        End If\n    End If\n\nEnd Function\nFunction Findrownumberdg2(findrownumberndg As Integer)\n\n        adrFirst = foundcell.Address\n        Set foundcell = Sheet6.Range(\"B:B\").FindNext(foundcell)\n        If foundcell.Address = adrFirst Then\n            Findrownumberdg2 = 0\n        Else\n            Findrownumberdg2 = foundcell.row\n        End If\n\n\nEnd Function\nFunction findrownumberndg(extrapolatendg As String) As Integer\n\n\nSet foundcell = Range(\"B:B\").Find(extrapolatendg, lookat:=xlWhole)\n\nIf Not foundcell Is Nothing Then\n\n findrownumberndg = foundcell.row\n\n\nElse\n\nfindrownumberndg = 0\n\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>So once the findrownumberndg finds the row number on sheet6 and the checkduplicate function finds duplicates i need the findrownumberndg2 to loop until the the findrownumberloan returns a false but it doesnt.</p>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1556057006, "post_id": 55819986, "comment_id": 98306400, "body": "Can you give an example of the formula in a cell? What should the formula look like after you have run the macro?"}, {"owner": {"reputation": 125, "user_id": 10431378, "user_type": "registered", "profile_image": "https://graph.facebook.com/2087996881252931/picture?type=large", "display_name": "Carlos Tellez", "link": "https://stackoverflow.com/users/10431378/carlos-tellez"}, "reply_to_user": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1556057130, "post_id": 55819986, "comment_id": 98306440, "body": "in this case is a simple formula, but i&#39;m trying to do for more complex formulas   =+IFERROR(VLOOKUP(C13,Cap_LoB!A2:C110,3,0),&quot;&quot;)"}, {"owner": {"reputation": 125, "user_id": 10431378, "user_type": "registered", "profile_image": "https://graph.facebook.com/2087996881252931/picture?type=large", "display_name": "Carlos Tellez", "link": "https://stackoverflow.com/users/10431378/carlos-tellez"}, "reply_to_user": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1556057194, "post_id": 55819986, "comment_id": 98306453, "body": "because my target is have a selection and do for all formulas in that selection range, but i don&#39;t know how can i put only left $"}, {"owner": {"reputation": 28264, "user_id": 2554537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc10039cfab30080c4b326033062f5c?s=128&d=identicon&r=PG", "display_name": "zedfoxus", "link": "https://stackoverflow.com/users/2554537/zedfoxus"}, "edited": false, "score": 0, "creation_date": 1556057228, "post_id": 55819986, "comment_id": 98306461, "body": "Once you run the Macro, what will the formula look like? What is your expected result?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1556059629, "last_edit_date": 1556059629, "creation_date": 1556057074, "answer_id": 55820032, "question_id": 55819986, "link": "https://stackoverflow.com/questions/55819986/how-to-put-only-left-or-right-in-formula/55820032#55820032", "title": "How to put only left or right $, in formula", "body": "<p>See:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlreferencetype\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.xlreferencetype</a></p>\n\n<p>for the alternatives to <code>xlAbsolute</code></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Name                Value   Description\nxlAbsolute          1       Convert to absolute row and column style.\nxlAbsRowRelColumn   2       Convert to absolute row and relative column style.\nxlRelative          4       Convert to relative row and column style.\nxlRelRowAbsColumn   3       Convert to relative row and absolute column style.\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 10431378, "user_type": "registered", "profile_image": "https://graph.facebook.com/2087996881252931/picture?type=large", "display_name": "Carlos Tellez", "link": "https://stackoverflow.com/users/10431378/carlos-tellez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55820032, "answer_count": 1, "score": 0, "last_activity_date": 1556059629, "creation_date": 1556056792, "question_id": 55819986, "link": "https://stackoverflow.com/questions/55819986/how-to-put-only-left-or-right-in-formula", "title": "How to put only left or right $, in formula", "body": "<p>i Want to create a Macro that put left $ in a cell if this have a formula\nbut now i only can do for both, for example A2 ---> $A$2,\nhow can i modify my code to only chose left or right symbol?\nThanks !</p>\n\n<p>This is my code</p>\n\n<pre><code>    Private Sub CommandButton3_Click()\n'Absolute Fomula'\nDim c As Variant\nApplication.ScreenUpdating = False\nFor Each c In Selection\n    If c.HasFormula = True Then\n        c.Value = Application.ConvertFormula(c.Formula, xlA1, , xlAbsolute)\n    End If\nNext c\nApplication.ScreenUpdating = True\nEnd\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1556057749, "post_id": 55819891, "comment_id": 98306620, "body": "Please tell us more about the &quot;team parameter&quot;.  Is it user supplied from a screen field?  And then can we match it to a column in PDQData table?    WHERE  &#39;&quot; &amp; [teamparam]  &amp; &#39;&quot;  = TeamColumn"}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556058637, "post_id": 55819891, "comment_id": 98306837, "body": "Add <code>Debug.print qdf.SQL</code> and run the output as a new query. How many records are returned?"}], "owner": {"reputation": 9, "user_id": 11402107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/072a106b5ca1ce33301a04b914cd45b8?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/11402107/lisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556093269, "creation_date": 1556056178, "last_edit_date": 1556056965, "question_id": 55819891, "link": "https://stackoverflow.com/questions/55819891/loop-through-a-parameter-query-to-create-pdf", "title": "Loop through a parameter query to create PDF", "body": "<p>I'm trying to loop through a parameter query in Access 2016. Currently, the parameters are supplied to the query using a form. That part all works good. I can set the <code>rs=CurrentDB.OpenRecordset(\"Select distinct [User_ID]</code> from PQData\",dbOpenSnapshot and the report will produce all of the reports regardless of which team I pick in the parameters. If I use Set <code>rs=qdf.OpenRecordset()</code> the code does not move to the next <code>UserID</code>. I need to the code to loop through the parameter query and only produce PDF's for the <code>UserID</code>s that match the team parameter. </p>\n\n<pre><code>Private Sub Command36_Click()\nDim db As DAO.Database\nDim rs As DAO.Recordset\n\nDim MyFileName As String\nDim mypath As String\nDim temp As String\nDim prm As DAO.Parameter\n'Dim SSQL As String\n\nmypath = \"S:\\Other\\ClaimantSurveyDatabase\\DB\\Leave and Life Audits\\Life  Audit Tool.accdb\"\n\nSet db = CurrentDb()\n\n\nSet qdf = CurrentDb.QueryDefs(\"PQData Query\")\n\nqdf(\"Forms!frmCriteria!Month\") = Forms!frmCriteria!Month\nqdf(\"Forms!frmCriteria!EnterTeam\") = Forms!frmCriteria!EnterTeam\n\n\nSet rs = qdf.OpenRecordset()\n\n'Set rs = CurrentDb.OpenRecordset(\"SELECT DISTINCT [USER_ID]  FROM [PQData]\", dbOpenSnapshot)\n With rs\n .MoveFirst\n  Do While Not .EOF\n    temp = rs(\"USER_ID\")\n  MyFileName = rs(\"USER_ID\") &amp; \".PDF\"\n\n\n    DoCmd.OpenReport \"LifeAuditSheets2019\", acViewReport, , \"[USER_ID]='\" &amp; temp &amp; \"'\"\n    DoCmd.OutputTo acOutputReport, \"\", acFormatPDF, mypath &amp; MyFileName\n\n    DoEvents\n\n    rs.MoveNext\n    Loop\n\n    rs.Close\n    End With\n    Set rs = Nothing\n    Set db = Nothing\n\n     DoCmd.Close acReport, \"LifeAuditSheets2019\"\n\n\n     End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1556054955, "post_id": 55819627, "comment_id": 98305753, "body": "Maybe use a pair of radio buttons for the selection of the text boxes?"}], "answers": [{"tags": [], "owner": {"reputation": 16352, "user_id": 107899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RCasx.png?s=128&g=1", "display_name": "Stewbob", "link": "https://stackoverflow.com/users/107899/stewbob"}, "is_accepted": false, "score": 0, "last_activity_date": 1556055953, "last_edit_date": 1556055953, "creation_date": 1556055516, "answer_id": 55819775, "question_id": 55819627, "link": "https://stackoverflow.com/questions/55819627/excel-vba-text-boxes/55819775#55819775", "title": "Excel VBA Text Boxes", "body": "<p>This is highly primitive but it should get you started in the right direction.  This would be the code-behind in your userform.</p>\n\n<pre><code>Dim currentTextBoxName As String\n\nPrivate Sub CommandButton1_Click()\n  Dim currentControl\n  Set currentControl = Controls(currentTextBoxName)\n  currentControl.Value = \"1\"\nEnd Sub\n\nPrivate Sub TextBox1_Enter()\n  currentTextBoxName = \"TextBox1\"\nEnd Sub\n\nPrivate Sub TextBox2_Enter()\n  currentTextBoxName = \"TextBox2\"\nEnd Sub\n</code></pre>\n\n<p>This assumes that your two textboxes are named 'TextBox1' and 'TextBox2'.  Obviously there are much better ways (more foolproof) to pass the names of the textboxes on the TextBox_Enter event, but this shows you the basic premise.</p>\n\n<p>And obviously, you would add code for the TextBox_Exit event to make sure values were not entered in the wrong textbox once the focus had left that TextBox.</p>\n\n<p>When learning to write VBA code in the VBA IDE, it helps to use the dropdowns at the top of the code window:\n<a href=\"https://i.stack.imgur.com/0rK7T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0rK7T.png\" alt=\"enter image description here\"></a></p>\n\n<p>Those two dropdowns give you access to all the objects on your userform and their associated events.  Super-helpful and often overlooked tool.</p>\n"}], "owner": {"reputation": 1, "user_id": 5781580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/436e42debf95f3f934a152ee76cd423a?s=128&d=identicon&r=PG&f=1", "display_name": "Shay", "link": "https://stackoverflow.com/users/5781580/shay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556055953, "creation_date": 1556054730, "last_edit_date": 1556054865, "question_id": 55819627, "link": "https://stackoverflow.com/questions/55819627/excel-vba-text-boxes", "title": "Excel VBA Text Boxes", "body": "<p>I am trying to create a Calculator in excel VBA using a userform with two text boxes, I have just created the numpad and when I click on 1 for instance, it will input number 1 in text box 1 but when I select text box two and then select the number 1 again it will enter it back in text box 1 instead of text box 2 where my cursor was on. Anyone know how I can use something like setFocus or anything along those lines to enter the number in whatever textbox the cursor is set on, Thanks.</p>\n\n<pre><code>Private Sub CmdBtn1_Click()\n    txt_Num1.Value = txt_Num1.Value + \"1\"\nEnd Sub\n</code></pre>\n\n<p>I am looking for for the number to be inputted into whichever text box the cursor was set on when the number is clicked.</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 4, "last_activity_date": 1556056425, "creation_date": 1556056425, "answer_id": 55819931, "question_id": 55818815, "link": "https://stackoverflow.com/questions/55818815/how-can-i-delete-all-transitions-in-ms-powerpoint-with-vba/55819931#55819931", "title": "How can I delete all transitions in MS Powerpoint with VBA?", "body": "<p>This'll do it:</p>\n\n<pre><code>sld.SlideShowTransition.EntryEffect=0\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 5474264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73d75181c369d4b544b0fbbeefc20a16?s=128&d=identicon&r=PG&f=1", "display_name": "tschuy", "link": "https://stackoverflow.com/users/5474264/tschuy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 55819931, "answer_count": 1, "score": 1, "last_activity_date": 1556056425, "creation_date": 1556050705, "question_id": 55818815, "link": "https://stackoverflow.com/questions/55818815/how-can-i-delete-all-transitions-in-ms-powerpoint-with-vba", "title": "How can I delete all transitions in MS Powerpoint with VBA?", "body": "<p>We prepare hundreds of Powerpoint documents per week for use with screen-reading software and need to remove all animations and transitions from each one. I'd like to write a Powerpoint add-in that automatically does this when the file is loaded. I've figured out how to delete all animations using the following code in an <code>auto_open()</code> sub which I've imported as an add-in:</p>\n\n<pre><code>'Loop Through Each Slide in ActivePresentation\n  For Each sld In ActivePresentation.Slides\n\n    'Loop through each animation on slide\n      For x = sld.TimeLine.MainSequence.Count To 1 Step -1\n\n        'Remove Each Animation\n          sld.TimeLine.MainSequence.Item(x).Delete           \n\n      Next x\n\n  Next sld\n</code></pre>\n\n<p>However, I'm not sure how to delete transitions with this method. I've essentially solved the problem <em>visually</em> by adding in this line,</p>\n\n<pre><code>sld.SlideShowTransition.Duration = 0\n</code></pre>\n\n<p>but I'd like to outright delete the transitions as they interfere with clients' screen-reading software. Deleting the object in the paradigmatic VBA way (<code>SlideShowTransition.Delete</code>) doesn't work.</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1556050063, "post_id": 55818625, "comment_id": 98303686, "body": "when it import it is importing as a string.  By doing the math it is being forced to a number.  You can do the same using text to columns."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556050717, "post_id": 55818625, "comment_id": 98303982, "body": "Looks like the numbers are pasted in with their thousands separators, which may or may not match the character Excel is using for this. Have the database export output unformatted numbers, and set the destination cells&#39; <code>NumberFormat</code> to <code>&quot;Currency&quot;</code>. The cell&#39;s <i>value</i> (as it appears in the formula bar) should read <code>10000</code>, not <code>10,000.00</code>; the number formatting is responsible for maknig the cells&#39; <i>text</i> (as it appears on the worksheet) read <code>$10,000.00</code>"}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556051711, "post_id": 55818625, "comment_id": 98304418, "body": "@Mathieu Guindon - Thank you, positive reply.  However, after DB exports, I get the numbers listed such as, 727.16, Legacy Database can not be adjusted for export output with unformatted numbers."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556052091, "post_id": 55818625, "comment_id": 98304587, "body": "Is the source a <i>view</i> or something? If so, you could connect the worksheet to the db and write your own SELECT statement that ensures numeric values are output as numbers. Otherwise... go with Scott&#39;s solution =)"}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556053523, "post_id": 55818625, "comment_id": 98305227, "body": "@Mathieu Guindon -   Yes source is a view."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556053639, "post_id": 55818625, "comment_id": 98305278, "body": "Good, then you can connect to it through the DATA Ribbon, and make a SELECT statement that selects from that view and casts the number-as-text values into actual numbers - do you know whata database engine you&#39;re dealing with? Are you familiar with SQL on any level?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556053743, "post_id": 55818625, "comment_id": 98305305, "body": "e.g. if the view has columns <code>foo</code> and <code>bar</code>, and is named <code>foobars</code>, you can get the records with <code>SELECT foo, bar FROM foobars</code> - and if <code>bar</code> is the number-as-text column, you should be able to cast it like <code>SELECT foo, bar=CAST(bar AS DECIMAL(18,6)) FROM foobars</code> (assuming SQL Server; different db engines might have different syntaxes)."}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556054090, "post_id": 55818625, "comment_id": 98305437, "body": "@Mathieu Guindon -  I utilize SSMS, front end."}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556054168, "post_id": 55818625, "comment_id": 98305465, "body": "@Mathieu Guindon - I am receiving the export from legacy system, not able to use DB for this flat file set as export Excel."}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556054234, "post_id": 55818625, "comment_id": 98305495, "body": "@Mathieu Guindon - I just ran it through Access and yes numbers can be changed to currency when export into Excel from Access."}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556054855, "post_id": 55818625, "comment_id": 98305724, "body": "@Mathieu Guindon -   Utilized DATA ribbon, get Data, File Workbook, then it does change text numbers into currency.  However, this would be okay for me, not for the macro process, or is there a Macro that will automate besides me recording step by step process as my described process?"}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556055036, "post_id": 55818625, "comment_id": 98305778, "body": "@Mathieu Guindon - Thank you!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556055094, "post_id": 55818625, "comment_id": 98305800, "body": "If your source is a view then you can just connect to it and no macro needs to get involved, next week you just right-click and refresh and poof done! ...unless I&#39;m missing something. Power Query can help too (&quot;Get &amp; Transform&quot;)"}, {"owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556055873, "post_id": 55818625, "comment_id": 98306053, "body": "@Mathieu Guindon - will review my Excel data sources, then see what process is most efficient with processes."}], "owner": {"reputation": 11, "user_id": 11286593, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vCs6T.png?s=128&g=1", "display_name": "Unicode", "link": "https://stackoverflow.com/users/11286593/unicode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1556055013, "creation_date": 1556049828, "last_edit_date": 1556055013, "question_id": 55818625, "link": "https://stackoverflow.com/questions/55818625/how-to-change-cells-to-currency", "title": "How to change cells to currency", "body": "<p>Database software system exports reports on Excel. Report sheet then gets inserted into a work book, copy paste.  Totals have decimals, after I select entire column for converting \"totals\" column into currency format \"$\", excel will not make include dollar symbol changes unless I multiply cell number by 1.  </p>\n\n<p>Is there another solution besides the following? </p>\n\n<p>Example:</p>\n\n<p>Cell <code>A1</code>:</p>\n\n<pre><code>=10,000.00*1\n\n=$10,000.00\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556049970, "post_id": 55818599, "comment_id": 98303640, "body": "<code>eqt</code> is a range and therfore one cannot equate a full range to one cell.  You will need another loop to loop the second range as well."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1556050079, "post_id": 55818599, "comment_id": 98303692, "body": "Your understanding of how to reference cells when using a For Each loop is incorrect with respect to your use of eqt.  The for each only relates to eqa.  You will be better served by reading the two ranges into VBA arrays and then iterating over the arrays from Lbound to Ubound."}, {"owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "edited": false, "score": 0, "creation_date": 1556050826, "post_id": 55818599, "comment_id": 98304027, "body": "You don&#39;t need VBA for this, Excel functions are sufficient."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556050990, "post_id": 55818599, "comment_id": 98304099, "body": "It may be easier to read these ranges into an array, like <code>arr_a = ActiveSheet.Range(&quot;D2&quot;, ActiveSheet.Range(&quot;D2&quot;).End(xlDown)).Value2</code> and <code>arr_t</code> similarly. Then, you can <code>Dim i As Integer</code> and do your loop over the values of <code>arr_a</code> and <code>arr_t</code> with <code>For i = LBound(arr_a, 1) To UBound(arr_a,1)</code>  and <code>If arr_a(i, 1) &gt;= arr_t(i, 1) Then</code> blah blah"}, {"owner": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "reply_to_user": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556898757, "post_id": 55818599, "comment_id": 98597358, "body": "@jessi So how exactly would I go about doing this?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "edited": false, "score": 0, "creation_date": 1556112663, "post_id": 55819799, "comment_id": 98327246, "body": "So the first snippet of code works partially as right now I am getting &quot;Under&quot; for every cell when they are not all under. The second snippet of code gives me a 1004 error."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "edited": false, "score": 0, "creation_date": 1556113289, "post_id": 55819799, "comment_id": 98327620, "body": "@tonytwotime - change <code>ThisWorkbook.Worksheets(1)</code> to <code>ActiveSheet</code> in the second snippet. Where is the error, btw?"}, {"owner": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "edited": false, "score": 0, "creation_date": 1556115315, "post_id": 55819799, "comment_id": 98329011, "body": "it is in this line <code>.Cells(cell.Row, &quot;F&quot;).Text = &quot;UNDER&quot;</code> prior to that it was in the line <code>.Cells(cell.Row, &quot;F&quot;).Text = &quot;ON TARGET&quot;</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "edited": false, "score": 0, "creation_date": 1556116755, "post_id": 55819799, "comment_id": 98330029, "body": "@tonytwotime - I removed the <code>.Text</code> part. Now it should be working."}, {"owner": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "edited": false, "score": 0, "creation_date": 1556119460, "post_id": 55819799, "comment_id": 98331709, "body": "Even with the changes it is still outputting only &quot;UNDER&quot; in column F"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "edited": false, "score": 0, "creation_date": 1556126263, "post_id": 55819799, "comment_id": 98335206, "body": "@tonytwotime - the condition is this one - <code>Application.Sum(eqt.Value) - 0.025</code>, Are you sure it is not the input? Try &quot;walking&quot; step-by-step with F8 and see the corresponding values."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1556116739, "last_edit_date": 1556116739, "creation_date": 1556055625, "answer_id": 55819799, "question_id": 55818599, "link": "https://stackoverflow.com/questions/55818599/is-there-a-way-to-output-the-value-in-one-column-based-on-two-others/55819799#55819799", "title": "Is there a way to output the value in one column based on two others?", "body": "<p>This one works:</p>\n\n<pre><code>Private Sub FormatcolumnF()\n\n    Dim eqa As Range, eqt As Range\n\n    Set eqa = ActiveSheet.Range(\"D2\", Range(\"D2\").End(xlDown))\n    Set eqt = ActiveSheet.Range(\"C2\", Range(\"C2\").End(xlDown))\n\n    Dim result As String, Cell As Range\n\n    For Each Cell In eqa.Cells\n        If IsNumeric(Cell) Then\n            If Cell.Value &gt;= Application.Sum(eqt.Value) + 0.025 Then\n                Cells(Cell.Row, \"F\") = \"OVER\"\n            ElseIf Cell &lt;= Application.Sum(eqt.Value) - 0.025 Then\n                Cells(Cell.Row, \"F\") = \"UNDER\"\n            ElseIf Cell &lt;= Application.Sum(eqt.Value) + 0.025 _\n            Or Cell &gt;= Application.Sum(eqt.Value) - 0.025 Then\n                Cells(Cell.Row, \"F\") = \"ON TARGET\"\n            End If\n        End If\n    Next Cell\n\nEnd Sub\n</code></pre>\n\n<p>The problem in the code was mainly that <code>eqt.Value</code> does not return value, because the <code>eqt</code> range is multiple cells. Thus, <code>Application.Sum(eqt.Value)</code> should be used. Furthermore, I have added an additional check for whether the cell is numeric in the loop here - <code>If IsNumeric(Cell) Then</code>. At the end, with the CElls(Cell.Row, \"F\") the corresponding cell in row \"F\" is updated with OVER and UNDER. The code could be improved further, with avoiding <code>ActiveSheet</code> and declaring the sheet, on which is worked. Take a look at the dots, before <code>Range</code> and <code>Cells</code>, they refer to the worksheet in the <code>With</code>.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub FormatcolumnF()\n\n    Dim eqa As Range, eqt As Range\n    Dim wks As Worksheet\n    Set wks = ThisWorkbook.Worksheets(1) \n    'or even better by name like \"Worksheets(Table1)\"\n\n    With wks\n        Set eqa = .Range(\"D2\", .Range(\"D2\").End(xlDown))\n        Set eqt = .Range(\"C2\", .Range(\"C2\").End(xlDown))\n    End With\n\n    Dim result As String, cell As Range\n\n    With wks\n        For Each cell In eqa.Cells\n            If IsNumeric(cell) Then\n                If cell.Value &gt;= Application.Sum(eqt.Value) + 0.025 Then\n                    .Cells(cell.Row, \"F\") = \"OVER\"\n                ElseIf cell &lt;= Application.Sum(eqt.Value) - 0.025 Then\n                    .Cells(cell.Row, \"F\") = \"UNDER\"\n                ElseIf cell &lt;= Application.Sum(eqt.Value) + 0.025 _\n                    Or cell &gt;= Application.Sum(eqt.Value) - 0.025 Then\n                    .Cells(cell.Row, \"F\")  = \"ON TARGET\"\n                End If\n            End If\n        Next cell\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11396343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c83249f20b9406959c0b0e82da24fd?s=128&d=identicon&r=PG&f=1", "display_name": "tony twotime", "link": "https://stackoverflow.com/users/11396343/tony-twotime"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557091580, "creation_date": 1556049724, "last_edit_date": 1557091580, "question_id": 55818599, "link": "https://stackoverflow.com/questions/55818599/is-there-a-way-to-output-the-value-in-one-column-based-on-two-others", "title": "Is there a way to output the value in one column based on two others?", "body": "<p>I am attempting to create output for one column in my table by basing it off of the values in two other columns. </p>\n\n<p>I've tried working with the variables and think I have gotten the loop to work. The issues I keep running into are \"Mismatch\" and \"Global\"</p>\n\n<pre><code>Private Sub formatcolumnF()\n\nDim eqa As Range, eqt As Range\n\nSet eqa = ActiveSheet.Range(\"D2\", Range(\"D2\").End(xlDown))\nSet eqt = ActiveSheet.Range(\"C2\", Range(\"C2\").End(xlDown))\n\nDim result As String, Cell As Range\n\nFor Each Cell In eqa\n     If Cell &gt;= eqt.Value + 0.025 Then\n            result = \"OVER\"\n     ElseIf Cell &lt;= eqt.Value - 0.025 Then\n            result = \"UNDER\"\n     ElseIf Cell &lt;= eqt.Value + 0.025 Or Cell &gt;= eqt.Value - 0.025 Then\n            result = \"ON TARGET\"\n     Else\n            result = \"\"\n     End If\nNext Cell\n\nRange(\"F2\", Range(\"F2\").End(xlDown)).Value = result\n\nEnd Sub\n</code></pre>\n\n<p>I expect the output in column F to be one of the string results. When I run it for a specific row in the table the code works but when I try to run it for the whole column it does not.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556048133, "post_id": 55818213, "comment_id": 98302908, "body": "What does your MsgBox display now? or do you get an error?"}, {"owner": {"reputation": 15, "user_id": 7082130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cX8gVY0-Ink/AAAAAAAAAAI/AAAAAAAAAFc/K-ksGAosbvI/photo.jpg?sz=128", "display_name": "Tetroy64", "link": "https://stackoverflow.com/users/7082130/tetroy64"}, "edited": false, "score": 0, "creation_date": 1556048510, "post_id": 55818213, "comment_id": 98303059, "body": "My message displays everything except it completely skips the userUnemployment number"}, {"owner": {"reputation": 15, "user_id": 7082130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cX8gVY0-Ink/AAAAAAAAAAI/AAAAAAAAAFc/K-ksGAosbvI/photo.jpg?sz=128", "display_name": "Tetroy64", "link": "https://stackoverflow.com/users/7082130/tetroy64"}, "edited": false, "score": 0, "creation_date": 1556048848, "post_id": 55818213, "comment_id": 98303181, "body": "The message displays &quot;The Year is 2005, and your race is  white&quot; It includes the extra space between race and white but it does not display the userUnemployment number"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1556049531, "post_id": 55818213, "comment_id": 98303462, "body": "Try changing <code>&amp;</code> to <code>And</code>. <code>&amp;</code> is primarily used for concatenating strings"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556051270, "post_id": 55818213, "comment_id": 98304242, "body": "The year is 2019, and we&#39;re apparently still putting humans in color-coded boxes."}], "answers": [{"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1556048395, "post_id": 55818268, "comment_id": 98303013, "body": "Is the equals sign a typo?"}, {"owner": {"reputation": 15, "user_id": 7082130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cX8gVY0-Ink/AAAAAAAAAAI/AAAAAAAAAFc/K-ksGAosbvI/photo.jpg?sz=128", "display_name": "Tetroy64", "link": "https://stackoverflow.com/users/7082130/tetroy64"}, "edited": false, "score": 0, "creation_date": 1556048574, "post_id": 55818268, "comment_id": 98303088, "body": "Removing the parenthesis does not change anything. It displays the whole message except for completely disregarding the userUnemployment number."}], "tags": [], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "is_accepted": false, "score": 0, "last_activity_date": 1556048209, "creation_date": 1556048209, "answer_id": 55818268, "question_id": 55818213, "link": "https://stackoverflow.com/questions/55818213/how-to-display-userunemployment-in-the-message-box-when-certain-choices-are-pi/55818268#55818268", "title": "How to display &#39;userUnemployment&#39; in the message box when certain choices are picked in the Userform", "body": "<p>I would use the msgbox like this:  \"Msgbox = \"The year is \" &amp; year &amp; \" and your race is \" &amp; usereunemployment\".  This should display the message that you want to see....</p>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1556050171, "creation_date": 1556050171, "answer_id": 55818709, "question_id": 55818213, "link": "https://stackoverflow.com/questions/55818213/how-to-display-userunemployment-in-the-message-box-when-certain-choices-are-pi/55818709#55818709", "title": "How to display &#39;userUnemployment&#39; in the message box when certain choices are picked in the Userform", "body": "<p>On a worksheet (I used Sheet1), create a table like this to hold your Unemployment Rates (Note that I only populated the values that you provided in your question):</p>\n\n<p><a href=\"https://i.stack.imgur.com/X38WD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/X38WD.png\" alt=\"enter image description here\"></a></p>\n\n<p>You haven't shown what your userform looks like, but I assume it's got Option Buttons (radio buttons) for selecting the Year and the Race.  In general, for this use case, a much cleaner solution would instead to use either Listboxes or Comboboxes.  I decided to use Listboxes for this example.  My userform looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tDYCC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tDYCC.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here is the full userform code.  The <code>UserForm_Initialize</code> code populates the listboxes based on the table.  Then the <code>btnOK_Click()</code> verifies that a Year and a Race have been selected and then finds the corresponding Unemployment Rate using a VLookup.  It then outputs a MsgBox displaying the results:</p>\n\n<pre><code>Private Sub btnCancel_Click()\n\n    Unload Me\n\nEnd Sub\n\nPrivate Sub btnOK_Click()\n\n    Dim ws As Worksheet\n    Dim sRace As String\n    Dim lYear As Long\n    Dim lRaceCol As Long\n    Dim dUnemployment As Double\n\n    If Me.listYear.ListIndex = -1 Then\n        Me.listYear.SetFocus\n        MsgBox \"Must select a year.\", , \"Error\"\n        Exit Sub\n    End If\n\n    If Me.listRace.ListIndex = -1 Then\n        Me.listRace.SetFocus\n        MsgBox \"Must select a race.\", , \"Error\"\n        Exit Sub\n    End If\n\n    Set ws = ThisWorkbook.Worksheets(1)\n    lYear = Me.listYear.List(Me.listYear.ListIndex)\n    sRace = Me.listRace.List(Me.listRace.ListIndex)\n\n    dUnemployment = WorksheetFunction.VLookup(lYear, ws.Range(\"A1\").CurrentRegion, WorksheetFunction.Match(sRace, ws.Rows(1), 0), False)\n\n    MsgBox \"Year: \" &amp; lYear &amp; Chr(10) &amp; _\n           \"Race: \" &amp; sRace &amp; Chr(10) &amp; _\n           \"Unemployment Rate: \" &amp; dUnemployment\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Worksheets(1)\n    Me.listYear.List = ws.Range(\"A2\", ws.Cells(ws.Rows.Count, \"A\").End(xlUp)).Value\n    Me.listRace.List = Application.Transpose(ws.Range(\"B1\", ws.Cells(1, ws.Columns.Count).End(xlToLeft)).Value)\n\nEnd Sub\n</code></pre>\n\n<p>Here's what it looks like in action:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uDIG5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uDIG5.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 15, "user_id": 7082130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cX8gVY0-Ink/AAAAAAAAAAI/AAAAAAAAAFc/K-ksGAosbvI/photo.jpg?sz=128", "display_name": "Tetroy64", "link": "https://stackoverflow.com/users/7082130/tetroy64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556050171, "creation_date": 1556047961, "last_edit_date": 1556049052, "question_id": 55818213, "link": "https://stackoverflow.com/questions/55818213/how-to-display-userunemployment-in-the-message-box-when-certain-choices-are-pi", "title": "How to display &#39;userUnemployment&#39; in the message box when certain choices are picked in the Userform", "body": "<p>I want to display the unemployment numbers for the specific year and race chosen by the user in a Userform. The userUnemployment will be static numbers that specific to certain conditions being met.</p>\n\n<p>I have tried various If and Else, If and ElseIfs </p>\n\n<pre><code>Private Sub buttonOk_Click()\nDim year, race As String\nDim userUnemployment As String\n</code></pre>\n\n<p>'first find the year</p>\n\n<pre><code>If five Then\n     year = \"2005\"\nElseIf six Then\n     year = \"2006\"\nElseIf seven Then\n     year = \"2007\"\nElseIf eight Then\n     year = \"2008\"\nElseIf nine Then\n     year = \"2009\"\nElseIf ten Then\n     year = \"2006\"\nElseIf eleven Then\n     year = \"2007\"\nElseIf twelve Then\n     year = \"2008\"\nElseIf thirteen Then\n     year = \"2009\"\nElseIf fourteen Then\n     year = \"2009\"\nElseIf fifteen Then\n     year = \"2006\"\nElseIf sixteen Then\n     year = \"2007\"\nElseIf seventeen Then\n     year = \"2008\"\nElseIf eighteen Then\n     year = \"2009\"\nEnd If\n</code></pre>\n\n<p>'now find the race for that year</p>\n\n<pre><code>If white Then\n    race = \"white\"\nElseIf black Then\n    race = \"black\"\nElseIf hispanic Then\n    race = \"hispanic\"\nElseIf asian Then\n    race = \"asian\"\nEnd If\n</code></pre>\n\n<p>'now find the unemployment rate for the things specified</p>\n\n<pre><code>If year = \"2005\" &amp; race = \"white\" Then\n         userUnemployment = \"3.48\"\nElseIf year = \"2005\" &amp; race = \"black\" Then\n         userUnemployment = \"5\"\n\nEnd If\n\n  MsgBox (\"The year is \" + year + \", and your race is \" + userUnemployment + \" \" + race)\n\n\n\n\n\n\n End Sub\n</code></pre>\n\n<p>I want the message to display the userUnemployment number specified. I only listed two choices because I have not found the other unemployment numbers I want to use yet. So as long as I can get it to work for those two then I can figure the rest out.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 855, "user_id": 3586517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oxKQc.png?s=128&g=1", "display_name": "Edney Holder", "link": "https://stackoverflow.com/users/3586517/edney-holder"}, "edited": false, "score": 2, "creation_date": 1556047980, "post_id": 55818105, "comment_id": 98302839, "body": "Can you post hat you have done so far for us to help you?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 2, "creation_date": 1556048300, "post_id": 55818105, "comment_id": 98302977, "body": "Work with <code>MailItem.ReceivedTime property</code>"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1556141469, "post_id": 55818105, "comment_id": 98341597, "body": "This is not your complete code; it a function that is called to save the attachments of a specific <code>MailItem</code>.  Some other code has selected that <code>MailItem</code>.  If you like 0m3r\u2019s suggestion of using <code>ReceivedTime</code> to identify interesting <code>MailItem</code>s, I would put that code in the outer routine."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1556141489, "post_id": 55818105, "comment_id": 98341607, "body": "You are saving these attachments using <code>DisplayName</code> as the filename?  Are these <code>DisplayName</code>s unique or are you happy to overwrite earlier files?  If they are unique, you could use the existence of a file to indicate this <code>MailItem</code>\u2019s attachments have already been saved.  Having said that, I would move the <code>MailItem</code> to another folder after I had saved the attachments, so it could never been found again."}], "answers": [{"tags": [], "owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "is_accepted": true, "score": 0, "last_activity_date": 1556210849, "creation_date": 1556210849, "answer_id": 55854130, "question_id": 55818105, "link": "https://stackoverflow.com/questions/55818105/download-csv-attachments-from-today/55854130#55854130", "title": "Download .csv attachments from Today", "body": "<p>I was able to answer my own question. Below is my modified code.</p>\n\n<pre><code>Public Sub SaveAutoAttach(item As Outlook.MailItem)\nDim olApp As Object\nDim olNS As Object\nDim myDate As Date\nDim olItems As Object\nDim olItem As Object\nDim olAttach As Object\n\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nErr.Clear: On Error GoTo 0\n\nIf olApp Is Nothing Then\nSet olApp = CreateObject(\"Outlook.Application\")\nFlg = True\nEnd If\n\nSet olNS = olApp.GetNamespace(\"MAPI\")\n\nSet olItems = olNS.GetDefaultFolder(olFolderInbox).Items\n\nFor Each olItem In olItems\n    If olItem.ReceivedTime &gt; Date Then\n    On Error GoTo Finished\n    Set olAttach = olItem.Attachments.item(1)\n    Err.Clear: On Error GoTo 0\n    If Not olAttach Is Nothing Then\n    If olAttach.FileName Like \"*.csv\" Then\n\n    On Error GoTo Finished\n    olAttach.SaveAsFile \"C:\\Desktop\\Automatic Outlook Downloads\" &amp; \"\\\" &amp; olAttach.FileName\n    Set olAttach = Nothing\n    Set olItem = Nothing\n    End If\n    End If\n    End If\nNext\n\n\n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 11401691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ebf01cf8746368323336aa1e5adcd52?s=128&d=identicon&r=PG&f=1", "display_name": "Computer_Nerd", "link": "https://stackoverflow.com/users/11401691/computer-nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 55854130, "answer_count": 1, "score": 1, "last_activity_date": 1592554778, "creation_date": 1556047478, "last_edit_date": 1592554778, "question_id": 55818105, "link": "https://stackoverflow.com/questions/55818105/download-csv-attachments-from-today", "title": "Download .csv attachments from Today", "body": "<p>I want to download 4 unique csv files that I receive daily. So I need to download these 4 automatically. As of now, I can download all csv files but I can't limit it to only today's date. </p>\n\n<p>This is my current code.</p>\n\n<pre><code>Public Sub SaveAutoAttach(item As Outlook.MailItem)\n\nDim object_attachment As Outlook.Attachment\n\nDim saveFolder As String\n\nsaveFolder = \"C:\\Desktop\\Automatic Outlook Downloads\"\nFor Each object_attachment In item.Attachments\n\n\nIf InStr(object_attachment.DisplayName, \".csv\") Then\n'If Int(object_attachment.ReceivedTime) = Date Then\n    object_attachment.SaveAsFile saveFolder &amp; \"\\\" &amp; object_attachment.DisplayName\n\nEnd If\n'End If\n\nNext\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556047512, "post_id": 55817884, "comment_id": 98302633, "body": "<a href=\"https://stackoverflow.com/q/46009985/1188513\">This should help</a> with locating content controls."}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1556095035, "post_id": 55817884, "comment_id": 98316505, "body": "If I understand you correctly you want to provide the user the possibility to remove paragraphs based on his selection of check boxes. So you want to show a check box on every paragraph and allow to check or uncheck it. It kind of sounds to me like Quick Parts. Are you aware of that feature of Microsoft Word? If you use Mircosoft Word 2016 there is a Building Blocks Organizer (for Quick Parts) as well. Maybe it&#39;s worth checking out this feature: <a href=\"https://support.office.com/en-us/article/use-quick-parts-and-autotext-in-word-7a527697-058f-4967-b8f1-aae0774e4813?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1556172721, "post_id": 55817884, "comment_id": 98348231, "body": "@BrunoBieri, I am familiar with Quick Parts, I use them frequently at work. I was thinking about a template with all the paragraphs needed. I want the user to pick only the ones that he uses and after this the document would be stripped of the unused paragraphs. With Quick Parts, it is easy to forget a paragraph and you have to do repetitive tasks (Click insert - Quick Parts for each paragraph) whereas, in my case, it will be faster and the user will have a glympse at all the available options."}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1556174195, "post_id": 55817884, "comment_id": 98348826, "body": "I see. Ok, in that case I recommend you to use a userform. I&#39;m not sure how your template looks like. I imagine you could create a template and add bookmarks on the parts the user needs to be able to choose. At template start up you show the userform. In the initialization of this userform you could access all bookmarks and list them in a listbox with style option selection and multi select set to multi. Then you provide a Ok button and there you check which of the boxes are NOT selected and delete the associated bookmarks."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1556263449, "post_id": 55817884, "comment_id": 98385694, "body": "@brunobieri I actually managed to do this with content control check boxes. Basically, every paragraph has a checkbox before. After I check the required paragraphs, I click a submit button and I put a formula to hide all the bookmarks that have the same name as the checkboxes which are not checked."}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1556269637, "post_id": 55817884, "comment_id": 98388710, "body": "@MarianV. ok glad you made it. You can add this as an answer to your question and mark it as solution so other people can benefit from it as well. Maybe add a screenshot for better understanding ;-)"}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1556272767, "post_id": 55817884, "comment_id": 98390433, "body": "@brunobieri, I&#39;ve added the response. Could you tell me if I&#39;ve explained it right? Thanks for the feedback!"}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1556279732, "post_id": 55817884, "comment_id": 98394033, "body": "@MarianV. Hehe, you&#39;re funny. As long as it works for you, you explained it right ;-). It&#39;s YOUR answer to YOUR question. So it MUST be right :-D"}], "answers": [{"tags": [], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "is_accepted": true, "score": 1, "last_activity_date": 1556272662, "creation_date": 1556272662, "answer_id": 55865164, "question_id": 55817884, "link": "https://stackoverflow.com/questions/55817884/what-is-the-best-approach-for-generating-a-word-document-based-on-a-user-selecti/55865164#55865164", "title": "What is the best approach for generating a Word document based on a user selection via checkboxes?", "body": "<p>I have managed to do what I intended. \nFirst of all, I've put content control checkboxes before every paragraph and I've set a unique tag for each one. \nThen, for each checkbox, I've selected the paragraph, including the checkbox, and added a bookmark named exactly like the checkbox. Next, I've selected only the checkbox and added a bookmark name hide_nameofthecheckbox.</p>\n\n<p>I've added an ActiveX button, with the following vba Code on click:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\nDim bookmark As String\nDim ctl As ContentControl\n    For Each ctl In ActiveDocument.ContentControls\n        If ctl.Type = wdContentControlCheckBox Then\n            If ctl.Checked = False Then\n            bookmark = ctl.Tag\n                 Bookmarks(bookmark).Range.Font.Hidden = True\n                 Else\n                 bookmark = \"hide_\" &amp; ctl.Tag\n                  Bookmarks(bookmark).Range.Font.Hidden = True\n\n                 ' DO NOTHING\n            End If\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Basically, when I click the Submit button, the code verifies each checkbox for value True or False. If it is checked, it hides the checkbox, If it is unchecked, it hides the entire paragraph, including the checkbox. \nThis way, after I click the submit button, there will be no checkboxes visible, so the document is print-ready.</p>\n"}], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55865164, "answer_count": 1, "score": 0, "last_activity_date": 1556272662, "creation_date": 1556046461, "last_edit_date": 1556089243, "question_id": 55817884, "link": "https://stackoverflow.com/questions/55817884/what-is-the-best-approach-for-generating-a-word-document-based-on-a-user-selecti", "title": "What is the best approach for generating a Word document based on a user selection via checkboxes?", "body": "<p>I am trying to create a form template to use at work that can be customized via check boxes.</p>\n\n<p>So far, I have been thinking about adding check boxes before every paragraph and at the end a button.\nWhen I click the button, my intention is to delete all the paragraphs that don't have the checkbox activated.</p>\n\n<p>The problem is that I don't know which is the most user friendly approach to this.\nI am thinking about making bookmarks for each paragraph and use an IF formula for each of the check boxes.\nThe most user friendly check boxes are the content control ones, but I don't know how to reference them in VBA code.</p>\n\n<p>All I can find is about form field check boxes, but I don't know how to make them clickable.</p>\n\n<p>Before I go studying about each of these two options, I am interested in finding out which of these two alternatives is more appropriate to fulfill my requirements.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1556056101, "post_id": 55817720, "comment_id": 98306130, "body": "<i>doesn&#39;t work</i> isn&#39;t very helpful. What exactly happens? <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 129, "user_id": 67187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6ef3b38f206b2f22ea14a40067190001?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/67187/peter"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1556101602, "post_id": 55817720, "comment_id": 98320383, "body": "No update takes place yet no error is indicated! I see the query bar advance and it shows the fields when it is completed but nothing is updated!"}], "answers": [{"tags": [], "owner": {"reputation": 129, "user_id": 67187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6ef3b38f206b2f22ea14a40067190001?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/67187/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1556104244, "creation_date": 1556104244, "answer_id": 55828682, "question_id": 55817720, "link": "https://stackoverflow.com/questions/55817720/problem-with-vba-update-query-with-inner-join/55828682#55828682", "title": "Problem with vba update query with inner join", "body": "<p>Found the problem which turned out to be my own stupidity!  I was hitting datasheet view and seeing the query bar show up and advance, I thought it was actually doing the update,\nbut you have to save a RUN the query for it to work! \nHadn't touched access in a few months and got fooled! </p>\n\n<p>Pete  </p>\n"}], "owner": {"reputation": 129, "user_id": 67187, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/6ef3b38f206b2f22ea14a40067190001?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/67187/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556109567, "creation_date": 1556045740, "last_edit_date": 1556109567, "question_id": 55817720, "link": "https://stackoverflow.com/questions/55817720/problem-with-vba-update-query-with-inner-join", "title": "Problem with vba update query with inner join", "body": "<p>Inner join update query has no errors but doesn't update. I've tried the many solutions offered but still doesn't work! \nI need to update status field from all records from CN99s  to [Report_LEC].[STATUSD]</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>UPDATE Report_LEC INNER JOIN CN99s ON Report_LEC.network = CN99s.nwk SET \n[Report_LEC].[STATUS] = CN99s.nwk_status;\n</code></pre>\n\n<p>If I do it manually via code it works!But very slow! </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>statstr = rs![nwk_status]\nnetstr = rs!nwk\nCAPSQL = \"UPDATE Report_LEC \" &amp; \"SET status = '\" &amp; statstr &amp; \"' \" &amp; \"WHERE NETWORK =\" &amp; netstr\n\nDoCmd.RunSQL (CAPSQL)\n</code></pre>\n\n<p>There are 357216 records in CN99s and  13756 records in Report_LEC. </p>\n\n<p>Thanks</p>\n\n<p>Pete</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1556044955, "post_id": 55817463, "comment_id": 98301596, "body": "Try <code>Application.ScreenUpdating = False</code>"}, {"owner": {"reputation": 2330, "user_id": 5772095, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153203000281945/picture?type=large", "display_name": "Skin", "link": "https://stackoverflow.com/users/5772095/skin"}, "edited": false, "score": 1, "creation_date": 1556062872, "post_id": 55817463, "comment_id": 98307774, "body": "It may be worth looking at using something like C# or VBScript to do what you want rather than invoking VBA directly from an Excel thread.  That way, you&#39;re not executing macros, you&#39;re executing external code that is talking to the workbook, it&#39;s worth a thought anyway."}], "owner": {"reputation": 61, "user_id": 5604959, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jINnUAJfobw/AAAAAAAAAAI/AAAAAAAAAAA/kSao16ZY6Sg/photo.jpg?sz=128", "display_name": "Joe Messingschlager", "link": "https://stackoverflow.com/users/5604959/joe-messingschlager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556554057, "creation_date": 1556044623, "last_edit_date": 1556045221, "question_id": 55817463, "link": "https://stackoverflow.com/questions/55817463/how-do-i-stop-vba-execution-interruptions-when-typing-in-a-different-application", "title": "How do I stop VBA execution interruptions when typing in a different application?", "body": "<p>I write complex VBA apps that automate report creation by running SAP queries and enhancing and combining their results in Excel. These macros run for a few minutes to hours. I found that if I am active in another application like Outlook while the Excel macro is running, my typing in an email can sometimes jump into the spreadsheet and interrupt the macro execution. </p>\n\n<p>Is there a way in VBA to lock out other windows apps from interfering with macro execution in Excel? Could this be related to use of DoEvents in macro loops?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11401391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59176a818cff8fb7db5f9adf2b9c0053?s=128&d=identicon&r=PG&f=1", "display_name": "MiriamLara", "link": "https://stackoverflow.com/users/11401391/miriamlara"}, "edited": false, "score": 0, "creation_date": 1556134116, "post_id": 55817524, "comment_id": 98338671, "body": "Thanks you so much :)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 13, "user_id": 11401391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59176a818cff8fb7db5f9adf2b9c0053?s=128&d=identicon&r=PG&f=1", "display_name": "MiriamLara", "link": "https://stackoverflow.com/users/11401391/miriamlara"}, "edited": false, "score": 0, "creation_date": 1556134212, "post_id": 55817524, "comment_id": 98338717, "body": "@MiriamLara if this worked for you, please mark as correct by clicking the check mark by the answer."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1556044900, "creation_date": 1556044900, "answer_id": 55817524, "question_id": 55817351, "link": "https://stackoverflow.com/questions/55817351/how-to-format-date-with-or-or-in-vba/55817524#55817524", "title": "How to format date with &quot;.&quot; or &quot;/&quot; or &quot;-&quot; in vba?", "body": "<p>replace the <code>.</code> with <code>/</code></p>\n\n<pre><code>With Range(\"C3\")\n    .Value = DateValue(Replace(.Value, \".\", \"/\"))\n    .NumberFormat = \"mm/dd/yyyy\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11401391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59176a818cff8fb7db5f9adf2b9c0053?s=128&d=identicon&r=PG&f=1", "display_name": "MiriamLara", "link": "https://stackoverflow.com/users/11401391/miriamlara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 55817524, "answer_count": 1, "score": 0, "last_activity_date": 1556088522, "creation_date": 1556044166, "last_edit_date": 1556088522, "question_id": 55817351, "link": "https://stackoverflow.com/questions/55817351/how-to-format-date-with-or-or-in-vba", "title": "How to format date with &quot;.&quot; or &quot;/&quot; or &quot;-&quot; in vba?", "body": "<p>In VBA,  I'm trying to format the date that I have in the cell C3 equal  \"01.30.18\" to \"MM/DD/YYYY\".</p>\n\n<p>Sometimes in the same cell I have the value like:\n\"01.30.18\" or \"01/30/18\" or \"01/30/2018\".</p>\n\n<p>I need to create a formula to format the values that I'll receive in this cell to \"mm/dd/yyyy\" . </p>\n\n<p>I tried cDate or Format function but didn't worked\n:</p>\n\n<pre><code>  Dim strBalancingBy As String\n\n  Range(\"C3\").Select\n\n  strBalancingBy = ActiveCell.Value\n\n   ActiveCell.Value = Format(DateValue(strBalancingBy), \"mm/dd/yyyy\")\n</code></pre>\n\n<p>Give me the wrong result = \"12/30/1899\".</p>\n\n<p>OR </p>\n\n<pre><code>ActiveCell.Value = CDate(strBalancingBy)\n</code></pre>\n\n<p>Give me the wrong result = \"1/0/1900  1:30:18 AM\"</p>\n\n<p>Someone Can help me with this formula in vba?</p>\n\n<p>I expect the result = \"01/30/2018\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556043697, "post_id": 55817189, "comment_id": 98301126, "body": "need to move your <code>debug.print</code> inside your loop."}, {"owner": {"reputation": 13, "user_id": 11263704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d14581c497a5f485c503e487e396c2?s=128&d=identicon&r=PG&f=1", "display_name": "PaulB", "link": "https://stackoverflow.com/users/11263704/paulb"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556044204, "post_id": 55817189, "comment_id": 98301329, "body": "@tigeravatar Ok, moved d.p inside, and it correctly matches FOR EACH user/address. I need to extract just 1 Match. I think i need an IF user(i) Then eName = eaddress, but i&#39;m not getting it right."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556044525, "post_id": 55817189, "comment_id": 98301452, "body": "Are you hard coding these username/addresses, or are they being pulled from a location in the file?  your code indicates these are hard coded, but that may be just for the example."}, {"owner": {"reputation": 13, "user_id": 11263704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d14581c497a5f485c503e487e396c2?s=128&d=identicon&r=PG&f=1", "display_name": "PaulB", "link": "https://stackoverflow.com/users/11263704/paulb"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1556045360, "post_id": 55817189, "comment_id": 98301792, "body": "@Cyril Names and emails are hardcoded. May eventually move to a hidden sheet in the workbook, but for now..."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1556045632, "post_id": 55817189, "comment_id": 98301895, "body": "I feel like the answers are good enough it doesn&#39;t warrant mine variant. But in a more robust project in the future, you might want to consider creating your own class of &#39;User&#39; and create a Collection of users."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11263704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d14581c497a5f485c503e487e396c2?s=128&d=identicon&r=PG&f=1", "display_name": "PaulB", "link": "https://stackoverflow.com/users/11263704/paulb"}, "edited": false, "score": 0, "creation_date": 1556044988, "post_id": 55817346, "comment_id": 98301612, "body": "Thanks @pankaj Jaju! Works like a charm. Just have to add all my users...but this is easy! (Sorry, i&#39;m too low a rep for my vote to count!)"}], "tags": [], "owner": {"reputation": 5000, "user_id": 2784816, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/3Vk34.png?s=128&g=1", "display_name": "Pankaj Jaju", "link": "https://stackoverflow.com/users/2784816/pankaj-jaju"}, "is_accepted": true, "score": 2, "last_activity_date": 1556044144, "creation_date": 1556044144, "answer_id": 55817346, "question_id": 55817189, "link": "https://stackoverflow.com/questions/55817189/match-username-array-to-email-array/55817346#55817346", "title": "Match username (array) to email (array)", "body": "<p>You can use a <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/dictionary-object\" rel=\"nofollow noreferrer\"><code>Dictionary</code></a> to make this easier</p>\n\n<pre><code>Private Sub UsereMail()\n    Dim dictInfo, fullName\n\n    fullName = Application.UserName\n\n    Set dictInfo = CreateObject(\"Scripting.Dictionary\")\n    dictInfo.Add \"John Smith\", \"jsmith@work.com\"\n    dictInfo.Add \"Debbie Adams\", \"dadams@work.com\"\n    dictInfo.Add \"Karen Jones\", \"kjones@work.com\"\n\n    If dictInfo.Exists(fullName) Then\n        Debug.Print \"User is \" &amp; fullName &amp; \" email to \" &amp; dictInfo(fullName)\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11263704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d14581c497a5f485c503e487e396c2?s=128&d=identicon&r=PG&f=1", "display_name": "PaulB", "link": "https://stackoverflow.com/users/11263704/paulb"}, "edited": false, "score": 0, "creation_date": 1556045483, "post_id": 55817429, "comment_id": 98301839, "body": "Thanks @Tim Williams! with the error catch is also great!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1556044503, "creation_date": 1556044503, "answer_id": 55817429, "question_id": 55817189, "link": "https://stackoverflow.com/questions/55817189/match-username-array-to-email-array/55817429#55817429", "title": "Match username (array) to email (array)", "body": "<p>Using your original array-based approach:</p>\n\n<pre><code>Sub tester()\n    Debug.Print \"John Smith\", UserEmail(\"John Smith\") '&gt;&gt; jsmith@work.com\n    Debug.Print \"John Brown\", UserEmail(\"John Brown\") '&gt;&gt; [blank]\nEnd Sub\n\n\nPrivate Function UserEmail(userName As String) As String\n\n    Dim user(1 To 3), eaddress(1 To 3), m\n\n    user(1) = \"John Smith\"\n    user(2) = \"Debbie Adams\"\n    user(3) = \"Karen Jones\"\n\n    eaddress(1) = \"jsmith@work.com\"\n    eaddress(2) = \"dadams@work.com\"\n    eaddress(3) = \"kjones@work.com\"\n\n    m = Application.Match(userName, user, 0)\n    If Not IsError(m) Then UserEmail = eaddress(m)\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1556045782, "creation_date": 1556045782, "answer_id": 55817730, "question_id": 55817189, "link": "https://stackoverflow.com/questions/55817189/match-username-array-to-email-array/55817730#55817730", "title": "Match username (array) to email (array)", "body": "<p>Another dictionary based approach where the list of users does not have to be in the same order as the email addresses.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\nDim user(1 To 3)            As String\nDim eaddress(1 To 3)        As String\nDim user_dic                As Scripting.Dictionary\n\nuser(1) = \"John Smith\"\nuser(2) = \"Debbie Adams\"\nuser(3) = \"Karen Jones\"\n\neaddress(1) = \"jsmith@work.com\"\neaddress(2) = \"dadams@work.com\"\neaddress(3) = \"kjones@work.com\"\n\nSet user_dic = MatchUsersToEmail(eaddress, user)\n\nDebug.Print eaddress(1), user_dic.Item(eaddress(1))\nDebug.Print eaddress(2), user_dic.Item(eaddress(2))\nDebug.Print eaddress(3), user_dic.Item(eaddress(3))\n\nEnd Sub\n\nPublic Function MatchUsersToEmail(ByRef email_array() As String, ByRef user_array() As String) As Scripting.Dictionary\n' Returns a scripting dictionary where the email address returns the user name\nDim my_users                As Scripting.Dictionary\nDim my_user                 As Variant\nDim my_email                As Variant\nDim my_name()               As String\nDim my_key                  As String\n    Set my_users = New Scripting.Dictionary\n\n    For Each my_email In email_array\n        ' Add the email address as the key\n        my_users.Add Key:=CStr(my_email), Item:=vbNullString\n\n    Next\n\n    For Each my_user In user_array\n        my_name = Split(LCase$(my_user))\n        my_key = Left$(my_name(0), 1) &amp; my_name(1) &amp; \"@work.com\"\n        my_users.Item(my_key) = my_user\n\n    Next\n\n    Set MatchUsersToEmail = my_users\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11263704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d14581c497a5f485c503e487e396c2?s=128&d=identicon&r=PG&f=1", "display_name": "PaulB", "link": "https://stackoverflow.com/users/11263704/paulb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 55817346, "answer_count": 3, "score": 1, "last_activity_date": 1556046495, "creation_date": 1556043491, "last_edit_date": 1556046495, "question_id": 55817189, "link": "https://stackoverflow.com/questions/55817189/match-username-array-to-email-array", "title": "Match username (array) to email (array)", "body": "<p>Using Excel 2013. My first post after years of finding and adapting. </p>\n\n<p>I'm trying to match the current App user, ie \"John Smith\", to his email address \"jsmith@work.com\".</p>\n\n<p>Using two strings: 1 for users (1 to 3), the other eaddress(1 To 3).\nI want to get the current user's email address for use in separate Sub that CCs the current user on an email.</p>\n\n<p>I tried a <code>For Each i In user</code>, and set eName to <code>eaddress(i)</code>.\nThis returned only the <em>last</em> listed user/email.</p>\n\n<pre><code>Private Sub (useremail)\nDim user (1 To 3), eaddress (1 To 3), fullName, eName As String\n\nfullName = Application.UserName\nuser(1) = \"John Smith\"\nuser(2) = \"Debbie Adams\"\nuser(3) = \"Karen Jones\"\n\neaddress(1) = \"jsmith@work.com\"\neaddress(2) = \"dadams@work.com\"\neaddress(3) = \"kjones@work.com\"\n\nFor i = 1 To 3\n    'For Each i In user\n        fullName = user(i)\n        eName = eaddress(i)\n    'Exit For\n    debug.print \"User is \" &amp; fullname &amp; \"email to \" &amp; eName\nNext i\n\n\n</code></pre>\n\n<p>Looking to get the eaddress/eName of the current user (for use in separate Sub to email file).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556043127, "post_id": 55817100, "comment_id": 98300859, "body": "What is the error?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1556043206, "post_id": 55817100, "comment_id": 98300900, "body": "I would guess you&#39;ve not added a reference to the Outlook object library in your VB project? (Tools &gt; References)"}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556044713, "post_id": 55817100, "comment_id": 98301508, "body": "@scottCraner I&#39;m not really sure, but when I click run the macro it highlights &quot;Sub outlook_email_save ()&quot; in yellow and will not let me proceed"}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556044785, "post_id": 55817100, "comment_id": 98301537, "body": "@TimWilliams I had &quot;Microsoft outlook 16.0 Object library&quot; checked before I wrote the code, but it will still not allow me to proceed"}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1556045852, "post_id": 55817100, "comment_id": 98301975, "body": "@ScottCraner more specifically it&#39;s a compile error: variable not defined"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1556045949, "post_id": 55817100, "comment_id": 98302013, "body": "you have a typo here <code>For Each omail In myfol.Items</code>, <code>myfol.Items</code> should be <code>myfold.Items</code>"}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "edited": false, "score": 0, "creation_date": 1556047469, "post_id": 55817100, "comment_id": 98302620, "body": "Ok, that worked. But now the debugger has opened and it&#39;s saying that this line is incorrect: Set myfold = ospace.GetDefaultFolder(olFolderInbox).Folders(Range(&quot;D2&quot;).V&zwnj;&#8203;alue)"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 1, "creation_date": 1556048395, "post_id": 55817100, "comment_id": 98303012, "body": "When you refer to <code>Range(&quot;D2&quot;)</code>, the program does not know where to look. Perhaps you can <code>Dim sht As Worksheet</code> and <code>Set sht = ThisWorkbook.Sheets(&quot;Sheet1&quot;)</code> then, you can refer to <code>sht.Range(&quot;D2&quot;)</code>"}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "reply_to_user": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556049122, "post_id": 55817100, "comment_id": 98303285, "body": "@Jessi OK, so how would that code look on that line? I&#39;m sorry, but when I say today is my first day, I literally started learning how to write macros today."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556050234, "post_id": 55817100, "comment_id": 98303770, "body": "I understand, @MattStapleton, Put the <code>Dim sht As Worksheet</code> and <code>Set sht= ThisWorkbook.Sheets(&quot;Sheet1&quot;)</code> on earlier lines (like just before you <code>Dim myfold</code>). Then, just change <code>Range(&quot;D2&quot;)</code> to <code>sht.Range(&quot;D2&quot;)</code>. Note that you will need to make sure that where I have &quot;Sheet1&quot;, you put the name of the tab that you want to work with."}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "edited": false, "score": 0, "creation_date": 1556051875, "post_id": 55817100, "comment_id": 98304489, "body": "Hmm, I think I added everything correctly:  Dim sht As Worksheet Set sht = ThisWorkbook.Sheets(&quot;Sheet1&quot;) Dim myfold As Outlook.Folder Set myfold = ospace.GetDefaultFolder(olFolderInbox).Folders(sht.Range(&quot;d2&zwnj;&#8203;&quot;).Value)  But I&#39;m still getting an error on this line when I debug:  Set myfold = ospace.GetDefaultFolder(olFolderInbox).Folders(sht.Range(&quot;d2&zwnj;&#8203;&quot;).Value)"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556053072, "post_id": 55817100, "comment_id": 98305046, "body": "What is in &quot;D2&quot;?"}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "reply_to_user": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556053728, "post_id": 55817100, "comment_id": 98305302, "body": "@jessi &quot;Billing&quot; folder in my outlook email that I&#39;m trying to extract the attachments from."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556055023, "post_id": 55817100, "comment_id": 98305772, "body": "I recommend (for testing purposes) that you try <code>Set myfold = ospace.GetDefaultFolder(olFolderInbox)</code> and then make sure &quot;Billing&quot; is in there by <code>For each subfolder In myfold.Folders </code> <code>Debug.Print subfolder.name</code> <code>Next subfolder</code> and you should see &quot;Billing&quot; in the Immediate window. Or, you can test hardcoding <code>(&quot;Billing&quot;)</code> in that line and see if it works. You may need to <code>Dim subfolder As Outlook.folder</code> first"}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "edited": false, "score": 0, "creation_date": 1556120699, "post_id": 55817100, "comment_id": 98332417, "body": "OK, to clarify, should it look like this?  Dim sht As Worksheet Set sht = ThisWorkbook.Sheets(&quot;invoiceextract&quot;) Dim subfold As Outlook.Folder Set myfold = ospace.GetDefaultFolder(olFolderInbox).Folders(&quot;Billing&quot;) For Each subfold In myfold.Folders Debug.Print subfold.Name Next subfolder Dim atmt As Attachment  If so, line 4 &quot;Set myfold =...&quot; has a compile error, &quot;variable not defined&quot;."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556129114, "post_id": 55817100, "comment_id": 98336507, "body": "You would want to do either or. So, either hard code your folder to Billing (inside inbox) OR set myfolder to inbox and have it print all folders. Essentially, I&#39;m suggesting that you make sure that Billing is inside of Inbox in Outlook (or Outlook thinks that it is) because that is one potential error."}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "reply_to_user": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556842847, "post_id": 55817100, "comment_id": 98574906, "body": "@jessi I got the debugger to go past <code>Set myfold = ospace.GetDefaultFolder(olFolderInbox).Folders(Range(&quot;D2&quot;).V&zwnj;&#8203;alue)</code> by using <code>Set myfold = deffold.Folders(&quot;Billing&quot;)</code> but now the debugger has stopped at the 16th line. I&#39;ve tried a bunch of different solutions, but nothing seems to wrk. This is what I have now <code>If omail.Subject Like &quot;*&quot; &amp; (Trim(Range(&quot;A2:A519&quot;).Value)) &amp; &quot;*&quot; Then</code> any suggestions??"}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1556909444, "post_id": 55817100, "comment_id": 98601791, "body": "What is in <code>Range(&quot;A2:A519&quot;)</code>? Excel is not likely to return a string here. You are saying, if the subject is <code>Like * ERROR *</code> and then nothing can work."}, {"owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "reply_to_user": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1557262165, "post_id": 55817100, "comment_id": 98704139, "body": "@jessi Email subject lines (i.e. Invoice CSF57796) I want the macro to reference in my outlook &quot;billing&quot; folder."}, {"owner": {"reputation": 1238, "user_id": 1259867, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d6024850fb5f66100e9530782a3853b1?s=128&d=identicon&r=PG", "display_name": "jessi", "link": "https://stackoverflow.com/users/1259867/jessi"}, "edited": false, "score": 0, "creation_date": 1557263057, "post_id": 55817100, "comment_id": 98704454, "body": "The issue is that the range is not a string. You cannot compare your email subject (a string) with <code>* ERROR *</code> because the range value returns a variant and not a string. You will want to replace that comparison to the range.value with a string - do something like (earlier) <code>Dim i As Integer, subs As String</code> Then, read in the subject lines as subs <code>subs = .Range(&quot;A2:A519&quot;).Value2</code> and you can (where you are trying) <code>For i = LBound(subs,1) to UBound(subs,1)</code> <code>If omail.Subject Like &quot;*&quot; &amp; Trim(subs(i,1)) &amp; &quot;*&quot; Then </code> yadda yadda."}], "owner": {"reputation": 13, "user_id": 11401340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8514b1a7925503cc3b5145821eac079?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Stapleton", "link": "https://stackoverflow.com/users/11401340/matt-stapleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1556043436, "creation_date": 1556043050, "last_edit_date": 1556043436, "question_id": 55817100, "link": "https://stackoverflow.com/questions/55817100/first-day-coding-a-vba-macro-why-is-my-2nd-line-showing-as-an-error", "title": "First Day coding a VBA Macro: Why is my 2nd line showing as an error?", "body": "<p>I wrote this code from a youtube video I watched, but despite following the directions exactly my 2nd line of code keeps showing as an error when I try to run the macro?</p>\n\n<p>-</p>\n\n<pre><code>Option Explicit\n\n'early binding\nSub outlook_email_save()\n\nDim olook As Outlook.Application\nSet olook = New Outlook.Application\n\nDim omail As Outlook.MailItem\nSet omail = olook.CreateItem(olMailItem)\n\nDim ospace As Outlook.Namespace\nSet ospace = olook.GetNamespace(\"MAPI\")\n\nDim myfold As Outlook.Folder\nSet myfold = ospace.GetDefaultFolder(olFolderInbox).Folders(Range(\"D2\").Value)\nDim atmt As Attachment\n\n\nFor Each omail In myfol.Items\n\n            If omail.Subject Like \"*\" &amp; Range(\"A2:A519\").Value &amp; \"*\" Then\n\n                    For Each atmt In omail.Attachments\n\n                        If atmt.Filename Like \"*\" &amp; Range(\"B2\").Value &amp; \"*\" Then\n                            atmt.SaveAsFile Range(\"C2\").Value &amp; atmt.Filename\n                        Else\n                    'do nothing\n                        End If\n                    Next\nElse\n            'do nothing\n            End If\n\n\nNext\n\n\n\nEnd Sub\n</code></pre>\n\n<p>Objective:\nDownload all attachments named \"INVOICE CSF57796, INVOICE CSF56381, INVOICE CSF55242...\" from outlook email with the subject line \"Invoice.pdf\" and store in a local desktop folder.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1556050460, "last_edit_date": 1556050460, "creation_date": 1556050054, "answer_id": 55818678, "question_id": 55816998, "link": "https://stackoverflow.com/questions/55816998/how-to-use-vba-excel-to-automate-a-data-entry-process-using-ie/55818678#55818678", "title": "How to use VBA/Excel to automate a data entry process using IE?", "body": "<p>Use a proper page load wait. Use ids as well as they are faster. I use css id selectors e.g. <code>#txtUserName</code>, which are equivalent to <code>getElementById</code> but faster.</p>\n\n<pre><code>Option Explicit\n'VBE &gt; Tools &gt; References: Microsoft Internet Controls\nPublic Sub Login()\n    Dim ie As InternetExplorer\n    Const URL As String = \"https://iapps.courts.state.ny.us/chrs/SignIn\"\n    Dim userName As String, password As String, loginData As Worksheet\n\n    Set ie = New InternetExplorer\n    Set loginData = ThisWorkbook.Worksheets(\"Sheet2\")\n    userName = loginData.Cells(1, \"B\").Value\n    password = loginData.Cells(2, \"B\").Value\n\n    With ie\n        .Visible = True\n        .Navigate2 URL\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"#txtUserName\").Value = userName\n            .querySelector(\"#pwPassword\").Value = password\n            .querySelector(\"#btnSubmit\").Click\n        End With\n\n        Stop\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11401175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d33ac6c2d1ceb98267ad2308999b71e2?s=128&d=identicon&r=PG&f=1", "display_name": "TempestChaserZ", "link": "https://stackoverflow.com/users/11401175/tempestchaserz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1559984445, "creation_date": 1556042612, "last_edit_date": 1559984445, "question_id": 55816998, "link": "https://stackoverflow.com/questions/55816998/how-to-use-vba-excel-to-automate-a-data-entry-process-using-ie", "title": "How to use VBA/Excel to automate a data entry process using IE?", "body": "<p>I am extremely green with VBA, and am attempting to set up a macro sheet in Excel using VBA to partially automate a manual data entry process for my company to help cut down on time and error costs.</p>\n\n<p>A successful script would accomplish the following:</p>\n\n<ol>\n<li>Launch IE and navigate to the specified website.</li>\n<li>Log in using provided credentials.</li>\n<li>Enter a value into a field with a unique ID and press the \"Next\" button</li>\n<li>Enter corresponding data into the 200 fields, each with unique ID's (Ex. LastName_0 would correspond to cell A2, LastName_1 Corresponds to A3, etc.)</li>\n</ol>\n\n<p>Currently I have only accomplished step 1, in which the script launches IE and navigates to the website in question (<a href=\"https://iapps.courts.state.ny.us/chrs/SignIn\" rel=\"nofollow noreferrer\">https://iapps.courts.state.ny.us/chrs/SignIn</a>), however, I am getting a Run-time error 438 (Object doesn't support this property or method) when attempting to insert the username and password for the site. </p>\n\n<p>I've attempted multiple different codes that I found in google searches, all which return the same error. Currently I have the Username and Password listed on sheet 2 of the macro workbook, as referenced in the code. Given my lack of knowledge, I am unsure where my error exists.</p>\n\n<p>For reference, we're running on VBA 7.1, Excel 2013, and IE 11.</p>\n\n<pre><code>Sub login()\n\n    Const Url$ = \"https://iapps.courts.state.ny.us/chrs/SignIn\"\n\n    Dim UserName As String, Password As String, LoginData As Worksheet\n    Set LoginData = ThisWorkbook.Worksheets(\"Sheet2\")\n    UserName = LoginData.Cells(1, \"B\").Value\n    Password = LoginData.Cells(2, \"B\").Value\n\n    Dim ie As Object\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n\n        .navigate Url\n        ieBusy ie\n        .Visible = True\n\n        Dim oLogin As Object, oPassword As Object\n        Set oLogin = .document.getElementsByName(\"txtUserName\")(0) \n{This is where the 438 error occurs ^}\n        Set oPassword = .document.getElementsByName(\"pwPassword\")(0)\n\n        oLogin.Value = UserName\n        oPassword.Value = Password\n        .document.forms(0).submit\n\n    End With\n\nEnd Sub\n\nSub ieBusy(ie As Object)\n    Do While ie.Busy Or ie.readyState &lt; 4\n        DoEvents\n    Loop\nEnd Sub\n</code></pre>\n\n<p>Currently, Sheet 2 is set up with the user ID in cell B1, and the Password in Cell B2.</p>\n\n<p>The expected results would be a successful login, at which point I would work towards figuring out the code for the page to follow, and for the actual data entry page.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556042266, "post_id": 55816795, "comment_id": 98300456, "body": "See if <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">indenting your code</a> reveals something about the structure of these nested <code>If</code> blocks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556042926, "post_id": 55816795, "comment_id": 98300768, "body": "You&#39;re not setting the <code>Cancel</code> parameter to <code>True</code> anywhere: the workbook will close regardless of whether or not any of the conditions are verified."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556042977, "post_id": 55816795, "comment_id": 98300779, "body": "That said this kind of validation is probably much better implemented with <i>Data Validation</i>."}, {"owner": {"reputation": 11, "user_id": 11401157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9e1609ae4f73882177ff9e3bd51481?s=128&d=identicon&r=PG&f=1", "display_name": "JeanMarie ", "link": "https://stackoverflow.com/users/11401157/jeanmarie"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556045250, "post_id": 55816795, "comment_id": 98301741, "body": "Thank you Mathieu Guindon!"}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1556042457, "creation_date": 1556042457, "answer_id": 55816961, "question_id": 55816795, "link": "https://stackoverflow.com/questions/55816795/need-beforeclose-to-work-with-multiple-conditions/55816961#55816961", "title": "Need BeforeClose to work with multiple conditions", "body": "<p>I believe you are missing the <code>ElseIf</code> component</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\nIf Range(\"CA1\").Value &gt; 0 Then\n    MsgBox Range(\"CA1\").Value &amp; \" - ITEM(S) NEED LIST PRICE CORRECTION.  There are  \" &amp; Range(\"CA1\").Value &amp; \"   item(s) that presently have DEALER COST &gt; LIST PRICE.  Please fix pricing for these item(s) as indicated in Column AA.\"\nElseIf Range(\"BO1\").Value &gt; 0 Then\n    MsgBox Range(\"BO1\").Value &amp; \" - ITEM(S) - PRICE JUSTIFICATION MISSING. There are  \" &amp; Range(\"BO1\").Value &amp; \"   item(s) that have a 0% price change to Dealer Cost or a negative price change.  These items are missing PLM price justification in the comments field. Please add your comments to Column T.\"\nElseIf Range(\"BQ1\").Value &gt; 0 Then\n    MsgBox Range(\"BQ1\").Value &amp; \"- ITEM(S) - NEGATIVE GROSS MARGIN IN DEALER COST. There are  \" &amp; Range(\"BQ1\").Value &amp; \"   item(s) that have negative GM and are missing price confirmation.  Please confirm price by selecting YES in Column S.\"\nElseIf Range(\"BS1\").Value &gt; 0 Then\n    MsgBox Range(\"BS1\").Value &amp; \" - ITEM(S) WHOSE INCREASE TO DEALER COST IS GREATER THAN 5 PERCENT.  There are  \" &amp; Range(\"BS1\").Value &amp; \"   item(s) that have a price increase to Dealer Cost greater than 5% and are missing price confirmation. Please confirm price by selecting YES in Column S.\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556042546, "post_id": 55816969, "comment_id": 98300584, "body": "I would opt for the <code>Select Case</code> method out of preference really"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556042741, "post_id": 55816969, "comment_id": 98300676, "body": "@urdearboy either works, really - if indeed all conditions are mutually exclusive, it&#39;s completely up to personal preference ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1556042887, "last_edit_date": 1556042887, "creation_date": 1556042500, "answer_id": 55816969, "question_id": 55816795, "link": "https://stackoverflow.com/questions/55816795/need-beforeclose-to-work-with-multiple-conditions/55816969#55816969", "title": "Need BeforeClose to work with multiple conditions", "body": "<p>You can restructure the conditions with an inverted <code>Select Case</code> statement:</p>\n\n<pre><code>Cancel = True\nSelect Case True\n\n    Case (Range(\"CA1\").Value &gt; 0)\n        '...\n\n    Case (Range(\"BO1\").Value &gt; 0)\n        '...\n\n    Case (Range(\"BQ1\").Value &gt; 0)\n        '...\n\n    Case (Range(\"BS1\").Value &gt; 0)\n        '...\n\n    Case True\n        Cancel = False ' let it close\n\nEnd Select\n</code></pre>\n\n<p>Or, un-nest the conditions and use <code>ElseIf</code>:</p>\n\n<pre><code>Cancel = True\nIf Range(\"CA1\").Value &gt; 0 Then\n    '...\nElseIf Range(\"BO1\").Value &gt; 0 Then\n    '...\nElseIf ...\n    '...\nElse\n    Cancel = False\nEnd If\n</code></pre>\n\n<p>Note that the <code>Cancel</code> parameter should be set to <code>True</code> before the procedure exits, if you mean to keep that workbook opened.</p>\n"}], "owner": {"reputation": 11, "user_id": 11401157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9e1609ae4f73882177ff9e3bd51481?s=128&d=identicon&r=PG&f=1", "display_name": "JeanMarie ", "link": "https://stackoverflow.com/users/11401157/jeanmarie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556042887, "creation_date": 1556041719, "last_edit_date": 1556041765, "question_id": 55816795, "link": "https://stackoverflow.com/questions/55816795/need-beforeclose-to-work-with-multiple-conditions", "title": "Need BeforeClose to work with multiple conditions", "body": "<p>I need to add some code to the BeforeClose event so that the user is updated with the number of missing/incomplete fields that are needed before they can return the worksheet to me.  The problem is if one of the conditions are false, the workbook closes rather than moving on to the next condition.</p>\n\n<p>I've looked into this issue and I can't find any examples anywhere with a BeforeClose event with multiple if conditions.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n\n\n\nIf Range(\"CA1\").Value &gt; 0 Then\n\nMsgBox Range(\"CA1\").Value &amp; \" - ITEM(S) NEED LIST PRICE CORRECTION.  There are  \" &amp; Range(\"CA1\").Value &amp; \"   item(s) that presently have DEALER COST &gt; LIST PRICE.  Please fix pricing for these item(s) as indicated in Column AA.\"\n\nElse\n\nIf Range(\"BO1\").Value &gt; 0 Then\n\nMsgBox Range(\"BO1\").Value &amp; \" - ITEM(S) - PRICE JUSTIFICATION MISSING. There are  \" &amp; Range(\"BO1\").Value &amp; \"   item(s) that have a 0% price change to Dealer Cost or a negative price change.  These items are missing PLM price justification in the comments field. Please add your comments to Column T.\"\n\nElse\n\nIf Range(\"BQ1\").Value &gt; 0 Then\n\nMsgBox Range(\"BQ1\").Value &amp; \"- ITEM(S) - NEGATIVE GROSS MARGIN IN DEALER COST. There are  \" &amp; Range(\"BQ1\").Value &amp; \"   item(s) that have negative GM and are missing price confirmation.  Please confirm price by selecting YES in Column S.\"\nElse\n\n\nIf Range(\"BS1\").Value &gt; 0 Then\n\nMsgBox Range(\"BS1\").Value &amp; \" - ITEM(S) WHOSE INCREASE TO DEALER COST IS GREATER THAN 5 PERCENT.  There are  \" &amp; Range(\"BS1\").Value &amp; \"   item(s) that have a price increase to Dealer Cost greater than 5% and are missing price confirmation. Please confirm price by selecting YES in Column S.\"\n\nElse\n\n\n\nEnd If\nEnd If\nEnd If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I need the macro to move to the next condition if the previous condition is false rather than closing the workbook.   Thanks in advance!!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1556041813, "post_id": 55816528, "comment_id": 98300287, "body": "FWIW I would strongly advise <i>against</i> using the string value <code>N&#47;A</code> if the error value means to have a semantic meaning elsewhere in the worksheet, or in other VBA code: the error value <code>#N&#47;A</code> (as returned by the <code>NA()</code> worksheet function, or by <code>CVErr(xlErrNA)</code> in VBA) is considered an error value (like <code>#VALUE!</code> and <code>#REF!</code> and others), which you can then locate with the <code>IsError</code> function in VBA; <code>#N&#47;A</code> error values work with <code>ISNA</code>, <code>ISERROR</code>, and <code>IFERROR</code> worksheet functions; the string value <code>N&#47;A</code> does not convey that meaning to the rest of the worksheet/code."}], "answers": [{"comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556041038, "post_id": 55816587, "comment_id": 98299922, "body": "++ Nice. I would prefer <code>Len(Trim(Sheets(i).Cells(r, c))) = 0</code> to <code>Sheets(i).Cells(r, c) = &quot;&quot;</code> though :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1556041345, "post_id": 55816587, "comment_id": 98300075, "body": "BTW another 6k for the coffee mug ;)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556041742, "post_id": 55816587, "comment_id": 98300260, "body": "@SiddharthRout we all need goals, and striving for a free coffee mug is mine. :)  As to the preference, will that also take into account formulas that return an empty string?  Seems like it should and would probably be better in case the formula returns <code>&quot; &quot;</code> with a space."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1556042038, "post_id": 55816587, "comment_id": 98300361, "body": "@SiddharthRout <a href=\"https://meta.stackoverflow.com/a/261514/1188513\">life goal: 200K</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556074597, "post_id": 55816587, "comment_id": 98309385, "body": "I like that T-Shirt @MathieuGuindon :P"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1556040725, "creation_date": 1556040725, "answer_id": 55816587, "question_id": 55816528, "link": "https://stackoverflow.com/questions/55816528/how-to-fix-macro-to-still-continue-after-value/55816587#55816587", "title": "How to fix macro to still continue after #value", "body": "<p>Test for the Error first:</p>\n\n<pre><code>IF iserror(Sheets(i).Cells(r, c)) Then\n    Sheets(i).Cells(r, c).Value = \"N/A\"\nElseIF Sheets(i).Cells(r, c) = \"\" Then\n    Sheets(i).Cells(r, c).Value = \"N/A\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10771477, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-byzvO3PKTmI/AAAAAAAAAAI/AAAAAAAAAq4/HQS-j6lqxWM/photo.jpg?sz=128", "display_name": "joe dauda", "link": "https://stackoverflow.com/users/10771477/joe-dauda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556040725, "creation_date": 1556040533, "last_edit_date": 1556040558, "question_id": 55816528, "link": "https://stackoverflow.com/questions/55816528/how-to-fix-macro-to-still-continue-after-value", "title": "How to fix macro to still continue after #value", "body": "<p>i created a macro where if the the cell if blank i put \"N/A\" in the empty cell. i do this through multiple worksheets. the problem i am coming across is some worksheets have formulas in it that lead to \"#value!\" which then leads to an error on my macro. Is there anyway around that, i tried something but it does not work. </p>\n\n<pre><code>Sub test()\n\nDim i As Integer\nDim r As Long, c As Long\n'Dim ws As Worksheet\n\nApplication.ScreenUpdating = False\nFor i = 6 To Worksheets.Count\n\n\n    For c = 1 To 14\n    For r = 5 To 1000\n        If Sheets(i).Cells(r, c) = \"\" Or \"#value!\" Then\n        Sheets(i).Cells(r, c).Value = \"N/A\"\n        End If\n\n    Next r\n    Next c\nNext i\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "azure", "azure-devops", "ms-project"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1556042419, "post_id": 55816259, "comment_id": 98300519, "body": "If your question is &quot;can I add tasks using VBA?&quot; the answer is yes. Here&#39;s an example: <a href=\"https://stackoverflow.com/questions/51136478/how-do-i-automatically-create-summary-and-subtasks-in-microsoft-project-using-vb\">stackoverflow.com/questions/51136478/how-do-i-automatically-&zwnj;&#8203;create-summary-and-s&zwnj;&#8203;ubtasks-in-microsoft&zwnj;&#8203;-project-using-vb</a>. As currently posted, your question will likely get closed as too broad/vague. Try to be more specific, show what you have done so far, and explain the specific areas of difficulty."}, {"owner": {"reputation": 141, "user_id": 5025076, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-92skV7T0QCM/AAAAAAAAAAI/AAAAAAAAFqg/qGuy9GNnO8Q/photo.jpg?sz=128", "display_name": "David Wagle", "link": "https://stackoverflow.com/users/5025076/david-wagle"}, "reply_to_user": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1556107375, "post_id": 55816259, "comment_id": 98323836, "body": "This is specifically in relationship to a connection to Azure DevOps . . . does that change anything?"}, {"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1556115283, "post_id": 55816259, "comment_id": 98328992, "body": "If you can query the data in vba and receive the results in a usable format, the source should not matter."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1561625796, "post_id": 55816259, "comment_id": 100129054, "body": "Do you want to write these tasks to DevOps or a Project document?"}], "owner": {"reputation": 141, "user_id": 5025076, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-92skV7T0QCM/AAAAAAAAAAI/AAAAAAAAFqg/qGuy9GNnO8Q/photo.jpg?sz=128", "display_name": "David Wagle", "link": "https://stackoverflow.com/users/5025076/david-wagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593558019, "creation_date": 1556039449, "last_edit_date": 1593558019, "question_id": 55816259, "link": "https://stackoverflow.com/questions/55816259/how-to-write-vba-macro-to-add-recuring-tasks-to-pbis-in-project-attached-to-azu", "title": "How to write VBA macro to add recuring tasks to PBI&#39;s in Project attached to Azure DevOps", "body": "<p>I am working on an Agile Scrum based project using Azure DevOps. I want an MS Project macro that will allow me to add a set of tasks to PBI's that are returned by a particular query. </p>\n\n<p>I can connect to Azure DevOps using the 'Team' plugin for Office, so I can get the query results in Microsoft Project. </p>\n\n<p>This will be used after every Sprint Planning to automate adding tasks to user stories in bulk rather than having to do it by hand. </p>\n\n<p>So if the query returns a PBI such as:</p>\n\n<pre><code>Work Item ID | Title        | Work Item Type | \n\n  1234       | PBI Name1    | Product Backlog Item |\n  1235       | PBI Name2    | Product Backlog Item |\n</code></pre>\n\n<p>After the macro is run, I'd have</p>\n\n<pre><code>Work Item ID | Title        | Work Item Type | \n\n  1234       | PBI Name1    | Product Backlog Item |\n             |     Task 1   | Task                 |\n             |     Task 2   | Task                 |\n  1235       | PBI Name2    | Product Backlog Item |\n             |     Task 1   | Task                 |\n             |     Task 2   | Task                 |\n</code></pre>\n\n<p>Is this possible to do in VBA?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1556039382, "post_id": 55816144, "comment_id": 98299202, "body": "You&#39;re calling <code>Create_WB</code> within your loop, this appears to creating new sheet each time. However, the code within the <code>Else</code> condition will raise some errors, as <code>wb</code> object instance is not assigned within scope of the <code>Check_CM</code> subroutine."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1556039460, "creation_date": 1556039460, "answer_id": 55816263, "question_id": 55816144, "link": "https://stackoverflow.com/questions/55816144/issue-with-conditionally-moving-records-to-new-wksheets/55816263#55816263", "title": "Issue with conditionally moving records to new wksheets", "body": "<p><em>--- Disclaimer ---</em></p>\n\n<p>Here is some code I wrote back when I first started learning VBA. </p>\n\n<p>Looking back I can see many opportunities for improvement. However, this has worked for me with no issues (although that could be because of that shameful <code>On Error Resume Next</code> line that I added). Since this works as is, I will leave the fine-tuning to you!</p>\n\n<hr>\n\n<p>This will create a new sheet (one for every unique value in <code>Column A</code>) and then move all of the associated data from each unique value to it's respective sheet. </p>\n\n<p>This assumes</p>\n\n<ol>\n<li>Raw Data is on <code>Sheet1</code></li>\n<li>Your unique values span <code>Column A</code></li>\n<li>You header is on <code>Row 1</code> and your data starts on <code>Row 2</code></li>\n</ol>\n\n<hr>\n\n<pre><code>Sub parse_data()\n\nDim lr As Long\nDim ws As Worksheet\nDim vcol, i As Integer\nDim icol As Long\nDim myarr As Variant\nDim title As String\nDim titlerow As Integer\nvcol = 1\nSet ws = Sheets(\"Sheet1\")\nlr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\n\n' A1:Q5000 only needs to be modified if more than 4999 rows of data exists.\n\ntitle = \"A1:Q5000\"\ntitlerow = ws.Range(title).Cells(1).Row\nicol = ws.Columns.Count\nws.Cells(1, icol) = \"Unique\"\n\nFor i = 2 To lr\n    On Error Resume Next\n        If ws.Cells(i, vcol) &lt;&gt; \"\" And Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\n            ws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\n        End If\nNext\n\nmyarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\nws.Columns(icol).Clear\n\nFor i = 2 To UBound(myarr)\n    ws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\n        If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\n            Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\n        Else\n            Sheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count)\n        End If\n    ws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\n    Sheets(myarr(i) &amp; \"\").Columns.AutoFit\nNext\n\nws.AutoFilterMode = False\nws.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11401086, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JVKlwYJUXUo/AAAAAAAAAAI/AAAAAAAAdHg/JJXGnldmeuk/photo.jpg?sz=128", "display_name": "Jaz Dosanjh", "link": "https://stackoverflow.com/users/11401086/jaz-dosanjh"}, "is_accepted": false, "score": 0, "last_activity_date": 1556043511, "creation_date": 1556043511, "answer_id": 55817195, "question_id": 55816144, "link": "https://stackoverflow.com/questions/55816144/issue-with-conditionally-moving-records-to-new-wksheets/55817195#55817195", "title": "Issue with conditionally moving records to new wksheets", "body": "<p>This is how i fixed it</p>\n\n<pre><code>Sub Create()\n'duplicate worksheet and assign it to variable 'wb'\nDim wb As Worksheet\nSheets(\"Template\").Copy After:=Sheets(Sheets.Count)\nSet wb = ActiveSheet\nEnd Sub\n\nSub Copy()\n'copy data over\nSet wb = ActiveSheet\nWorksheets(\"Summary\").Range(\"A2\").Copy wb.Range(\"A10\")\nWorksheets(\"Summary\").Range(\"B2\").Copy wb.Range(\"A11\")\nWorksheets(\"Summary\").Range(\"C2\").Copy wb.Range(\"C14\")\nWorksheets(\"Summary\").Range(\"D2\").Copy wb.Range(\"A14\")\nWorksheets(\"Summary\").Range(\"E2\").Copy wb.Range(\"E14\")\nWorksheets(\"Summary\").Range(\"F2\").Copy wb.Range(\"G14\")\n\nEnd Sub\n\n\n\nSub Del()\n'delete row from summary\nWorksheets(\"Summary\").Rows(2).Delete\n\n\n\n\n\n\nEnd Sub\n\nSub Update()\n\n\nEnd Sub\n\n\n\n\n\nSub Check_CM()\n\nCall Create\n\n\n'statement to check if next record has same c/m\n\n' while summary is not blank run pgm\nDo While Worksheets(\"Summary\").Range(\"A2\") &lt;&gt; \"\"\n'set active sheet\nSet wb = ActiveSheet\n'if c/m is not same as active sheet cm\nIf Worksheets(\"Summary\").Range(\"A2\") &lt;&gt; wb.Range(\"A10\") Then\n     Call Create\n     Call Copy\n     Call Del\n\n\n\n\nElse\n    ' Set active sheet\n    Set wb = ActiveSheet\n\n    'Shift Cells Down to add another row\n    Rows(14).Insert Shift:=xlDown\n\n    'copy data\n    Worksheets(\"Summary\").Range(\"A2\").Copy wb.Range(\"A10\")\n    Worksheets(\"Summary\").Range(\"B2\").Copy wb.Range(\"A11\")\n    Worksheets(\"Summary\").Range(\"C2\").Copy wb.Range(\"C14\")\n    Worksheets(\"Summary\").Range(\"D2\").Copy wb.Range(\"A14\")\n    Worksheets(\"Summary\").Range(\"E2\").Copy wb.Range(\"E14\")\n    Worksheets(\"Summary\").Range(\"F2\").Copy wb.Range(\"G14\")\n\n    'delete data from summary sheet\n    Call Del\n\n'\n'\n'\nEnd If\n\n\nLoop\n\n\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11401086, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JVKlwYJUXUo/AAAAAAAAAAI/AAAAAAAAdHg/JJXGnldmeuk/photo.jpg?sz=128", "display_name": "Jaz Dosanjh", "link": "https://stackoverflow.com/users/11401086/jaz-dosanjh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556043511, "creation_date": 1556038986, "last_edit_date": 1556039468, "question_id": 55816144, "link": "https://stackoverflow.com/questions/55816144/issue-with-conditionally-moving-records-to-new-wksheets", "title": "Issue with conditionally moving records to new wksheets", "body": "<p>I started making a script to help me create worksheets based on data. I have a summary sheet with data sorted by client name. If the client only has one record, then it needs to be on its own worksheet. If the client has multiple records all the records must be on 1 worksheet. I ran the code below, but it still puts all clients on their own sheet.</p>\n\n<p>Create_WB()</p>\n\n<pre><code>Sub Create_WB()\n    'duplicate worksheet and assign it to variable 'wb'\n    Dim wb As Worksheet\n    Sheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n    Set wb = ActiveSheet\n\n    'copy data over\n    Worksheets(\"Summary\").Range(\"A2\").Copy wb.Range(\"A10\")\n    Worksheets(\"Summary\").Range(\"B2\").Copy wb.Range(\"A11\")\n    Worksheets(\"Summary\").Range(\"C2\").Copy wb.Range(\"C14\")\n    Worksheets(\"Summary\").Range(\"D2\").Copy wb.Range(\"A14\")\n    Worksheets(\"Summary\").Range(\"E2\").Copy wb.Range(\"E14\")\n    Worksheets(\"Summary\").Range(\"F2\").Copy wb.Range(\"G14\")\n\n    'delete row from summary\n    Worksheets(\"Summary\").Rows(2).Delete\n\nEnd Sub\n</code></pre>\n\n<p>Check_CM()    </p>\n\n<pre><code>Sub Check_CM()\n\n    'statement to check if next record has same c/m\n    Do While Worksheets(\"Summary\").Range(\"A2\") &lt;&gt; \"\"\n    '\n    '\n    If Worksheets(\"Summary\").Range(\"A2\") &lt;&gt; Worksheets(\"Summary\").Range(\"A3\") Then\n         Call Create_WB\n\n\n    Else\n\n        Rows(14).Insert Shift:=xlDown\n        Worksheets(\"Summary\").Range(\"A2\").Copy wb.Range(\"A10\")\n        Worksheets(\"Summary\").Range(\"B2\").Copy wb.Range(\"A11\")\n        Worksheets(\"Summary\").Range(\"C2\").Copy wb.Range(\"C14\")\n        Worksheets(\"Summary\").Range(\"D2\").Copy wb.Range(\"A14\")\n        Worksheets(\"Summary\").Range(\"E2\").Copy wb.Range(\"E14\")\n        Worksheets(\"Summary\").Range(\"F2\").Copy wb.Range(\"G14\")\n    '\n    '\n    '\n    End If\n\n\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>I want all records with same client to be on same sheet but every record has its own sheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556038678, "post_id": 55816036, "comment_id": 98298882, "body": "Adding <code>+ 0</code> to the end is an easy trick to convert text to numbers (given the text should be converted to a number)"}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556039448, "post_id": 55816036, "comment_id": 98299237, "body": "@urdearboy    Where exactly should I put + 0 in the vba code? I am thinking about adding the following code: <code>cellTaxa = CellTaxa + 0</code>."}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556040078, "post_id": 55816036, "comment_id": 98299525, "body": "@urdearboy, I have tried adding the abovementioned code before <code>cellTaxa.Copy</code> but it didn&#39;t work. I still get the yellow excalamation mark."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556040107, "post_id": 55816036, "comment_id": 98299541, "body": "Try <code>i = i + 0</code> after you paste. Or <code>i.value = i.value = 0</code>. You could also use <code>Text to Columns</code>"}, {"owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556043290, "post_id": 55816036, "comment_id": 98300941, "body": "Thank you, it worked. The workaround was to put `cellTaxa = CellTaxa + 0. You were right."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1556055829, "post_id": 55816036, "comment_id": 98306043, "body": "@urdearboy Unlike on the Worksheet, there&#39;s no need for the <code>+0</code> in VBA.  You can simply do <code>cellTaxa=cellTaxa</code>. Of course, if the cell format is text, you may need to change that."}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1556055559, "post_id": 55818011, "comment_id": 98305953, "body": "With VBA, there&#39;s no need for the <code>+0</code>.  So long as the cell is not formatted as text, you can simply do <code>cellTaxa=cellTaxa</code> and a numeric string value will be converted to a number."}], "tags": [], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "is_accepted": true, "score": 0, "last_activity_date": 1556047043, "creation_date": 1556047043, "answer_id": 55818011, "question_id": 55816036, "link": "https://stackoverflow.com/questions/55816036/how-do-i-format-copied-cell-text-as-number/55818011#55818011", "title": "How do I format copied cell text as number?", "body": "<p>As @urdearboy has stated, an easy trick to convert text to numbers is to add <code>+0</code>. </p>\n\n<p>In my case, I have added <code>cellTaxa = CellTaxa + 0</code> before the line <code>cellTaxa.Copy</code> and it has solved my issue.</p>\n"}], "owner": {"reputation": 367, "user_id": 10468231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0CmZ7.png?s=128&g=1", "display_name": "Cosmin", "link": "https://stackoverflow.com/users/10468231/cosmin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 55818011, "answer_count": 1, "score": 1, "last_activity_date": 1556047043, "creation_date": 1556038494, "last_edit_date": 1556045951, "question_id": 55816036, "link": "https://stackoverflow.com/questions/55816036/how-do-i-format-copied-cell-text-as-number", "title": "How do I format copied cell text as number?", "body": "<p>I have a vba formula that copies a value (which consists in a number) of a cell to another cell. When the number is with decimals (ex: 25,50), the result is ok, but when the number is without decimals (ex: 50), I get an error checking flag suggesting me to convert that cell to number. </p>\n\n<p>I wouldn't have a problem with this error flagging, but I cannot use the result in a formula. For example, if I use <code>SUM(A:A)</code>, the formula adds all the numbers, except the flagged ones.</p>\n\n<p>So far, I have tried pasting using the <code>.xlPasteValuesAndNumberFormats</code> property, without any success.</p>\n\n<pre><code>Sub Adauga()\nDim i As Range\nDim cellTaxa As Range\n\nSet cellTaxa = ActiveSheet.Buttons(Application.Caller).TopLeftCell.Offset(1, -2) 'Here I set the range to the value of a cell that is related to the button I click. \n\nn = 2\nSet i = Sheets(\"TJT DETERMINABILA\").Cells(n, 10) 'Here I insert the first result\nDo While i &lt;&gt; \"\" 'Here I find the next empty cell in the same column to insert the value.\n    n = n + 1\n    Set i = Sheets(\"TJT DETERMINABILA\").Cells(n, 10)\nLoop\n\ncellTaxa.Copy 'Here I copy the cell\ni.PasteSpecial xlPasteValues 'Here I paste the cell. \n\nEnd Sub\n</code></pre>\n\n<p>I would like to be able to use the values that are pasted in the column I mentioned in the code with the <code>SUM</code> formula.\nThank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556038738, "post_id": 55815750, "comment_id": 98298901, "body": "What does &quot;messing up my results&quot; actually stand for? Note that unqualified <code>Worksheet</code> member calls (<code>Cells</code>, <code>Range</code>) are implicitly referring to whatever worksheet is the <code>ActiveSheet</code>. Are the results being written to the wrong sheet? Try qualifying <code>Cells</code> and <code>Range</code> calls with a specific <code>Worksheet</code> object reference. Or it&#39;s filling down to hidden rows? Try assigning to <code>.SpecialCells(xlCellTypeVisible).FormulaR1C1</code>."}, {"owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556090400, "post_id": 55815750, "comment_id": 98314022, "body": "I&#39;m picking up results from hidden cells when i want to avoid them. Does that make sense?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556039560, "post_id": 55816204, "comment_id": 98299289, "body": "This works to concatenate the values in visible cells, but changes OP&#39;s logic from computed/formula to plain values - which <i>might</i> work for OP&#39;s needs, but they should know that modifying any of the individual concatenated values will no longer recalculate the result column (i.e. macro needs to be re-executed to update the values)."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1556039703, "post_id": 55816204, "comment_id": 98299352, "body": "@MathieuGuindon That is a good point, I hadn&#39;t considered that.  I interpreted the formula going into column W as a placeholder for the concatenated values since that formula was being put on the same worksheet as the data it&#39;s joining, and in the question the OP specifies that he wants the results to be on a different sheet, so this just skips that (admittedly, interpreted) middle step.  If it does need to result in a formula, I&#39;ll definitely update the answer."}, {"owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556090632, "post_id": 55816204, "comment_id": 98314144, "body": "Thanks Tiger - will try this! Just so I&#39;m aware (as i&#39;m trying to get better) - which is the row that refines the cells to concatenate?"}, {"owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556090976, "post_id": 55816204, "comment_id": 98314285, "body": "Subscript out of range error - aResults(i, 1) = DataCell.Value &amp; &quot; &quot; &amp; DataCell.Offset(, 1).Value &amp; &quot; &quot; &amp; DataCell.Offset(, 2).Value &amp; &quot; &quot; &amp; DataCell.Offset(, 3).Value. Is this because DataCell isn&#39;t defined?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "reply_to_user": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "edited": false, "score": 0, "creation_date": 1556114191, "post_id": 55816204, "comment_id": 98328213, "body": "@SuperLoz I am unable to reproduce that error.  It should only happen if aResults isn&#39;t large enough for rData, but that should never be the case since it&#39;s defined based on rData.  I&#39;d need to see what your data looks like to try to reproduce that error.  In the meantime, you could try changing the <code>ReDim</code> line to be <code>ReDim aResults(1 to 65000, 1 to 1)</code> and see if that helps."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 2, "last_activity_date": 1556039194, "creation_date": 1556039194, "answer_id": 55816204, "question_id": 55815750, "link": "https://stackoverflow.com/questions/55815750/concatenate-using-vba-visible-cells-only/55816204#55816204", "title": "Concatenate using vba - visible cells only?", "body": "<p>Something like this should work for you based on code provided in your question:</p>\n\n<pre><code>Sub tgr()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rData As Range\n    Dim rDest As Range\n    Dim DataCell As Range\n    Dim aResults() As String\n    Dim i As Long\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Worksheets(\"Pipeline Simplified\")   'Sheet where you are getting the concatenated data\n    Set wsDest = wb.Worksheets(\"Sheet1\")                'Sheet where the results will be output\n    Set rDest = wsDest.Range(\"A2\")                      'Cell on destination sheet where output results will start\n\n    On Error Resume Next\n    Set rData = wsData.Range(\"G2\", wsData.Cells(wsData.Rows.Count, \"G\").End(xlUp)).SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n    If rData Is Nothing Then Exit Sub   'No visible cells\n    If rData.Row &lt; 2 Then Exit Sub      'No data\n\n    ReDim aResults(1 To rData.Cells.Count, 1 To 1)\n    For Each DataCell In rData.Cells\n        i = i + 1\n        aResults(i, 1) = DataCell.Value &amp; \" \" &amp; DataCell.Offset(, 1).Value &amp; \" \" &amp; DataCell.Offset(, 2).Value &amp; \" \" &amp; DataCell.Offset(, 3).Value\n    Next DataCell\n\n    rDest.Resize(UBound(aResults, 1)).Value = aResults\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 11400227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53c674e8d49703b16e7f453e6deb05c?s=128&d=identicon&r=PG&f=1", "display_name": "SuperLoz", "link": "https://stackoverflow.com/users/11400227/superloz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 55816204, "answer_count": 1, "score": 0, "last_activity_date": 1556039194, "creation_date": 1556037238, "last_edit_date": 1556038637, "question_id": 55815750, "link": "https://stackoverflow.com/questions/55815750/concatenate-using-vba-visible-cells-only", "title": "Concatenate using vba - visible cells only?", "body": "<p>I'm looking to concatenate a number of cells from one sheet into another and then copy that formula down to the last row.</p>\n\n<p>However the sheet that I'm looking to concatenate from has hidden cells. So currently this is messing up my results on the target sheet. </p>\n\n<p>Is there a way to fix this so it only picks up visible cells?</p>\n\n<pre><code>Dim FitRng As Range, Lastrowteam As Long\n\nLastrowteam = Cells(Rows.Count, \"H\").End(xlUp).Row\n\nSheets(\"Pipeline simplified\").Select\nRange(\"W7\").FormulaR1C1 = _\n\"=CONCATENATE(Pipeline!R[2]C[7],\"\" \"\",Pipeline!R[2]C[8],\"\" \"\",Pipeline!R[2]C[9],\"\" \"\",Pipeline!R[2]C[10])\"\n\nSet FitRng = Range(\"W7:W\" &amp; Lastrowteam).SpecialCells(xlCellTypeVisible)\nFitRng.FillDown\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11400877, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CXbqU6Jwu-0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHr_5yqdMGHCY0a5afPU20NljvIg/mo/photo.jpg?sz=128", "display_name": "IanGaryShepherd", "link": "https://stackoverflow.com/users/11400877/iangaryshepherd"}, "edited": false, "score": 0, "creation_date": 1556123077, "post_id": 55815867, "comment_id": 98333728, "body": "Thanks Ronan, It is helpful however I am too novice to put this together but I am still really interested. If you could give me an exact solution I would definetly learn from it."}], "tags": [], "owner": {"reputation": 567, "user_id": 11280012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/twb4R.png?s=128&g=1", "display_name": "Ronan Vico", "link": "https://stackoverflow.com/users/11280012/ronan-vico"}, "is_accepted": false, "score": 1, "last_activity_date": 1556037735, "creation_date": 1556037735, "answer_id": 55815867, "question_id": 55815731, "link": "https://stackoverflow.com/questions/55815731/how-to-define-range-around-activecell-based-on-a-criteria/55815867#55815867", "title": "How to define range around activecell based on a criteria", "body": "<p>Thats a recursive problem , you need to craete a recursive function i will answer for you</p>\n\n<p>I hope you can get some \"Logic\" about what i tried to do here , </p>\n\n<pre><code>Public Sub checkUntilItsHaveNumber(ByVal c As Range)\n    If c.Value = \"\" Then\n        c.Interior.TintAndShade = 0\n        Call checkUntilItsHaveNumber(c.Offset(1, 0))\n        Call checkUntilItsHaveNumber(c.Offset(-1,0))\n        Call checkUntilItsHaveNumber(c.Offset(0, 1))\n        Call checkUntilItsHaveNumber(c.Offset(0, -1))\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11400877, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CXbqU6Jwu-0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reHr_5yqdMGHCY0a5afPU20NljvIg/mo/photo.jpg?sz=128", "display_name": "IanGaryShepherd", "link": "https://stackoverflow.com/users/11400877/iangaryshepherd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556037735, "creation_date": 1556037174, "last_edit_date": 1556037448, "question_id": 55815731, "link": "https://stackoverflow.com/questions/55815731/how-to-define-range-around-activecell-based-on-a-criteria", "title": "How to define range around activecell based on a criteria", "body": "<p>Basically I am building a minesweeper game and I got everything right apart from 1 thing. I am struggle to excavate blanks (from activecell) until any number value is found in every direction. </p>\n\n<p>This is part of what I currently have. I tried declare offset values as variables but did not work. </p>\n\n<pre><code>If ActiveCell.Value = \"\" Then\n    ActiveCell.Interior.TintAndShade = 0\n    ActiveCell.Offset(1, 0).Interior.TintAndShade = 0\n    ActiveCell.Offset(1, -1).Interior.TintAndShade = 0\n    ActiveCell.Offset(0, -1).Interior.TintAndShade = 0\n    ActiveCell.Offset(-1, -1).Interior.TintAndShade = 0\n    ActiveCell.Offset(-1, 0).Interior.TintAndShade = 0\n    ActiveCell.Offset(-1, 1).Interior.TintAndShade = 0\n    ActiveCell.Offset(0, 1).Interior.TintAndShade = 0\n    ActiveCell.Offset(1, 1).Interior.TintAndShade = 0\nEnd If\n</code></pre>\n\n<p>How do I get every cell turn to white and expand until any value (1 to 9) is found.</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 2, "creation_date": 1556060413, "post_id": 55815618, "comment_id": 98307233, "body": "Stick with <code>.Export</code>, check out this link for an explanation of using a FileDialog (aka default browse) to select a file location to save to: <a href=\"https://software-solutions-online.com/vba-save-file-dialog-filedialogmsofiledialogsaveas/\" rel=\"nofollow noreferrer\">software-solutions-online.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 568, "user_id": 4630650, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/799739480117365/picture?type=large", "display_name": "Bhavesh Shaha", "link": "https://stackoverflow.com/users/4630650/bhavesh-shaha"}, "is_accepted": true, "score": 3, "last_activity_date": 1556087330, "creation_date": 1556087330, "answer_id": 55823652, "question_id": 55815618, "link": "https://stackoverflow.com/questions/55815618/browsing-location-to-save-and-name-while-exporting-ppt-slide-as-pdf-in-slideshow/55823652#55823652", "title": "Browsing location to save and name while exporting PPT Slide as PDF in SlideShow Mode", "body": "<pre><code>Application.FileDialog(msoFileDialogSaveAs).Show\nDim Location As String\nLocation = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)\n</code></pre>\n\n<p>You can use the above code to get the path and name which the user desires.</p>\n\n<p>This code will allow you to export: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.presentation.exportasfixedformat\" rel=\"nofollow noreferrer\">ActivePresentation.ExportAsFixedFormat</a></p>\n"}], "owner": {"reputation": 92, "user_id": 6944242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f6d3a7817db1cd3ea2a43b4d7f9942c4?s=128&d=identicon&r=PG&f=1", "display_name": "Kusa Shaha", "link": "https://stackoverflow.com/users/6944242/kusa-shaha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 55823652, "answer_count": 1, "score": 2, "last_activity_date": 1556087330, "creation_date": 1556036781, "question_id": 55815618, "link": "https://stackoverflow.com/questions/55815618/browsing-location-to-save-and-name-while-exporting-ppt-slide-as-pdf-in-slideshow", "title": "Browsing location to save and name while exporting PPT Slide as PDF in SlideShow Mode", "body": "<p>I want to save only 1 particular slide as .PDF (or image at the very least) whilst in SlideShow mode.</p>\n\n<p>I want to give the user the option to browse the location and pick the name using the default browse feature. I don't want them to write the path.</p>\n\n<pre><code>    Dim ExportPath As String   ' drive:\\path to export to\n    Dim Pixwidth As Integer    '  size in pixels of exported image\n    Dim Pixheight As Integer\n    Dim oSlide As Slide\n\n    ' Edit to suit\n    Pixwidth = 1920    '  arbitrarily ... set whatever value you like here\n\n    ' Set height proportional to slide height\n    Pixheight = 1080\n\n    ExportPath = ActivePresentation.Path &amp; \"\\\"\n\n    Set oSlide = ActivePresentation.SlideShowWindow.View.Slide\n    With oSlide\n        .Export ExportPath &amp; \"Slide\" &amp; CStr(.SlideIndex) &amp; \".JPG\", \"JPG\", Pixwidth, Pixheight\n    End With\n</code></pre>\n\n<p>I found the code in the web and it works well but doesn't allow the user to browse the location and choose the name.</p>\n\n<p>I then used the following code which worked wonderfully:</p>\n\n<pre><code>Dim CurrentSlide As Long\nCurrentSlide = ActivePresentation.SlideShowWindow.View.Slide.SlideNumber\nWith ActivePresentation.PrintOptions\nOutputType = ppPrintOutputSlides\nEnd With\n\nActivePresentation.PrintOut\n</code></pre>\n\n<p>However, this doesn't work in all devices.\nIn some, it just doesn't recognize the <code>PrintOut</code> function and in others it gets printed in OneNote.</p>\n\n<p>Is it possible for the user to browse and save as .PDF file (export option instead of Print option in case they don't have the PDF Printer)</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11400848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4bfe810f07d1854ee16d36a26fdad25?s=128&d=identicon&r=PG&f=1", "display_name": "Sumoshark", "link": "https://stackoverflow.com/users/11400848/sumoshark"}, "edited": false, "score": 0, "creation_date": 1556104074, "post_id": 55816287, "comment_id": 98321799, "body": "So yes to clarify, for every cell in Row A that matches a cell in Row B check Row C to confirm the status.    i.e. if cell A contains &quot;HPT1234&quot; and Row B has a cell that contains the same (&quot;Cell B&quot;), then it needs to check the cell to next to Cell B in row C (&quot;Cell C&quot;), which says the status i.e. &quot;vault&quot;.  If the status in Cell C is &quot;vault&quot; it can then be ignored and move onto the next one. If it is anything other than &quot;vault&quot; i would like it to copy Cell A or Cell B as they contain the same to a new Row, Row D.  I hope this helps clarify"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "reply_to_user": {"reputation": 1, "user_id": 11400848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4bfe810f07d1854ee16d36a26fdad25?s=128&d=identicon&r=PG&f=1", "display_name": "Sumoshark", "link": "https://stackoverflow.com/users/11400848/sumoshark"}, "edited": false, "score": 0, "creation_date": 1556120688, "post_id": 55816287, "comment_id": 98332411, "body": "I notice in 1st Objective the use of CountIf &gt; 0.   For 2nd Objective, is there a possiblity of &quot;HPT1234&quot; appearing multiple times in Range(&quot;E7:E500&quot;) ? If so, when should &quot;HPT1234&quot; be added to column &quot;O&quot;?  What if some but not all of &quot;HPT1234&quot; occurances are followed by &quot;vault&quot;?  Do we need to search each occurance of &quot;HPT1234&quot; to see if we find the first non-vault item?  Requirements need to be clarified."}, {"owner": {"reputation": 1, "user_id": 11400848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4bfe810f07d1854ee16d36a26fdad25?s=128&d=identicon&r=PG&f=1", "display_name": "Sumoshark", "link": "https://stackoverflow.com/users/11400848/sumoshark"}, "edited": false, "score": 0, "creation_date": 1556192522, "post_id": 55816287, "comment_id": 98358755, "body": "Well, I am very curious about how this could be written for the 2nd or 1st objective where HPT1234 could appear multiple times.  I can&#39;t think of an occurance in this scenario where HPT1234 could appear multiple times in Range(&quot;E7:E500&quot;). So it can be based of the only time HPT1234 appears."}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1556039618, "creation_date": 1556039618, "answer_id": 55816287, "question_id": 55815594, "link": "https://stackoverflow.com/questions/55815594/excel-vba-if-rngcell-and-next-cell-then-this-cell-and-next-cell/55816287#55816287", "title": "Excel VBA If rngcell= and next cell= then this cell= and next cell=", "body": "<p>Here is something to try...</p>\n\n<p>I like the Range/xlUp/Offset(1) to continuously add to the bottom of the list.</p>\n\n<p>(needs preceeding Columns(\"O:O\").ClearContents)</p>\n\n<p>Correct me if I am wrong.</p>\n\n<p>Lets clarify 2nd Objective --\n  all the cells that are in the first range and second but the next cell contains a specific value.</p>\n\n<pre><code>  If  rngCell(\"B6:B500\") IS in Range(\"H7:H500\") \n  AND rngCell(\"B6:B500\") IS in Range(\"E7:E500\") MATCH (not CountIf) to get the row number\n  AND if MatchedRowNum &gt; 0 then\n  AND \"vault\"            IS in Range(\"E7:E500\").Offset(MatchedRowNum + 1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11400848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4bfe810f07d1854ee16d36a26fdad25?s=128&d=identicon&r=PG&f=1", "display_name": "Sumoshark", "link": "https://stackoverflow.com/users/11400848/sumoshark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557231616, "creation_date": 1556036695, "last_edit_date": 1557231616, "question_id": 55815594, "link": "https://stackoverflow.com/questions/55815594/excel-vba-if-rngcell-and-next-cell-then-this-cell-and-next-cell", "title": "Excel VBA If rngcell= and next cell= then this cell= and next cell=", "body": "<p>I am looking to compare two ranges of cells, First objective is to see if there is any differences i.e. if this cell doesnt appear in this range. Second if the cell does appear has the next cell got this value.  </p>\n\n<p>Currently i have been able to output any cell in the first range that doesnt appear in the second:</p>\n\n<pre><code>For Each rngCell In Range(\"F7:F500\")\n    If WorksheetFunction.CountIf(Range(\"H7:H500\"), rngCell) = 0 Then\n        Range(\"O\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n    End If\nNext\n</code></pre>\n\n<p>I am very lost on how to approach the second part though so far I have tried the following:</p>\n\n<pre><code>For Each rngCell In Range(\"B6:B500\")\n    If WorksheetFunction.CountIf(Range(\"H7:H500\"), rngCell) = 0 Then\n    Set r2 = Range(\"E7:E500\")\n    Else If (Range(\"H7:H500\")) and WorksheetFunction.CountIf(r2(\"vault\")) Then\n    Range(\"O\" &amp; Rows.Count).End(xlUp).Offset(1) = rngCell\n</code></pre>\n\n<p>Essentially, I am looking for an output with all the cells which are in the first range but not the second and all the cells that are in the first range and second but the next cell contains a specific value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1556110832, "post_id": 55815207, "comment_id": 98325910, "body": "try getElementByID using the full id &quot;_id0:Logon:CMS:row&quot;"}, {"owner": {"reputation": 1, "user_id": 11114262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NuaYwMV5kCo/AAAAAAAAAAI/AAAAAAAAAAA/kfHGoNe7P-4/photo.jpg?sz=128", "display_name": "david sam", "link": "https://stackoverflow.com/users/11114262/david-sam"}, "reply_to_user": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 1, "creation_date": 1556123222, "post_id": 55815207, "comment_id": 98333792, "body": "thanks for looking into my request. The same issue again popping up. Run-time error 91  object variable or with block variable not set."}, {"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1558010340, "post_id": 55815207, "comment_id": 98964004, "body": "Assign the result to a Range and use the .Find() to set the range. If nothing is found, then the Range() would be Nothing. see link: <a href=\"https://stackoverflow.com/questions/52504282/excel-vba-how-to-solve-run-time-error-91\" title=\"excel vba how to solve run time error 91\">stackoverflow.com/questions/52504282/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "is_accepted": false, "score": 0, "last_activity_date": 1558010484, "creation_date": 1558010484, "answer_id": 56168827, "question_id": 55815207, "link": "https://stackoverflow.com/questions/55815207/unable-to-type-into-username-box-in-website/56168827#56168827", "title": "unable to type into username box in website", "body": "<p><strong>VBA Run-time error '91': Object variable or With block variable not set Internet Explorer Controls</strong></p>\n\n<p>Try something like this to wait until the element is available before clicking it. I've used HTMLGeneric element because I don't know what type of elements you are dealing with.</p>\n\n<pre><code>Dim element As HTMLGenericElement\n\nDo\n    Set element = HTMLdoc.all(\"eomSearchMain:advOrderSearch\")\n    DoEvents\nLoop While element Is Nothing\nelement.Click\n'IE busy And readyState wait here\n'Document.readyState wait here\n\nDo\n    Set element = HTMLdoc.getElementById(\"frmOrderListing:lOrderListing:0:optxtOrderNumberActionFocusLink\")\n    DoEvents\nLoop While element Is Nothing\nelement.Click\n'IE busy And readyState wait here\n'Document.readyState wait here\n</code></pre>\n\n<p>credit: <a href=\"https://www.mrexcel.com/forum/excel-questions/1051160-vba-run-time-error-91-object-variable-block-variable-not-set-internet-explorer-controls.html\" rel=\"nofollow noreferrer\">link</a></p>\n"}], "owner": {"reputation": 1, "user_id": 11114262, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NuaYwMV5kCo/AAAAAAAAAAI/AAAAAAAAAAA/kfHGoNe7P-4/photo.jpg?sz=128", "display_name": "david sam", "link": "https://stackoverflow.com/users/11114262/david-sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1558010484, "creation_date": 1556035329, "last_edit_date": 1556110632, "question_id": 55815207, "link": "https://stackoverflow.com/questions/55815207/unable-to-type-into-username-box-in-website", "title": "unable to type into username box in website", "body": "<p>There is a website, i have login. I am unable to type into the input box of the logon form.</p>\n\n<p>I tried to get the associated object with the tag name \"input\" but i am unable to retrieve it. </p>\n\n<pre><code>Dim ie As InternetExplorerMedium\nDim HTML As HTMLDocument\nDim HTML1, HTML2 As HTMLDocument\n\nURL = \"xxxx\"\nSet ie = New InternetExplorerMedium\nie.Visible = True\nie.navigate URL\nDo While ie.readyState &lt;&gt; READYSTATE_COMPLETE Or ie.Busy: DoEvents: Loop\nSet HTML = ie.document\nSet HTML1 = HTML.getElementById(\"_id0\")\n\nDebug.Print HTML.getElementByTagName()   '-----------------------------------------Not able to get the tag name\nCall HTML1.getElementById(\"logon:\").setAttribute(\"value\", \"username\")    '---------Neither able to update the username &amp; password too\n</code></pre>\n\n<hr>\n\n<p>Here is the inspect element of the page</p>\n\n<p>I should be able to populate user name &amp; password\n<a href=\"https://i.stack.imgur.com/4PffW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4PffW.png\" alt=\"picture of HTML Source\"></a></p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556035501, "post_id": 55815066, "comment_id": 98297218, "body": "Are all of the referenced forms open when you run this code?"}, {"owner": {"reputation": 3, "user_id": 10179029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8d081908ab8a1db3ce1a372060df85?s=128&d=identicon&r=PG&f=1", "display_name": "MaryLou", "link": "https://stackoverflow.com/users/10179029/marylou"}, "edited": false, "score": 0, "creation_date": 1556039577, "post_id": 55815066, "comment_id": 98299296, "body": "Yes there is only one form being referenced and it is open."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1556044341, "post_id": 55815066, "comment_id": 98301382, "body": "Debug.Print constructed SQL statement. Edit question to show this output. Form shows correct records after RecordSource is changed?"}, {"owner": {"reputation": 3, "user_id": 10179029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8d081908ab8a1db3ce1a372060df85?s=128&d=identicon&r=PG&f=1", "display_name": "MaryLou", "link": "https://stackoverflow.com/users/10179029/marylou"}, "edited": false, "score": 0, "creation_date": 1556044688, "post_id": 55815066, "comment_id": 98301502, "body": "I added the Debug.Print output. I ran this through a query before I posted and it returns the correct information. My form populates successfully with this string set as the recordsource."}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556047241, "post_id": 55815066, "comment_id": 98302523, "body": "Also, can you provide the SQL for the other two queries please? If one of those queries contains parameters, you can&#39;t use Database.OpenRecordset, you will have to use QueryDef.OpenRecordset and set the parameters manually. This would explain why the query is working in other places."}, {"owner": {"reputation": 3, "user_id": 10179029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8d081908ab8a1db3ce1a372060df85?s=128&d=identicon&r=PG&f=1", "display_name": "MaryLou", "link": "https://stackoverflow.com/users/10179029/marylou"}, "edited": false, "score": 0, "creation_date": 1556048432, "post_id": 55815066, "comment_id": 98303026, "body": "I added the SQL for the other queries. Is the problem that I&#39;m referencing a form in the requirements query? If so, how do I add the part no definition into that query in VBA?"}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556048854, "post_id": 55815066, "comment_id": 98303183, "body": "Yes, that parameter is the issue. I&#39;m trying a couple options and will let you know."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556051132, "post_id": 55815066, "comment_id": 98304171, "body": "Sorry, I don&#39;t really understand what you will do with <code>rs2</code> once you open it successfully.  But I wonder if this might suit: <code>Set rs2 = Me.RecordsetClone</code>"}], "answers": [{"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556050355, "post_id": 55818627, "comment_id": 98303832, "body": "Access SQL will not accept a parameter for <code>TOP</code> ... you must include a literal number in the statement text."}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1556051138, "post_id": 55818627, "comment_id": 98304174, "body": "Duh! Nice catch HansUp Thank you!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1556051824, "post_id": 55818627, "comment_id": 98304460, "body": "Yeah, I spent way too much time trying to find a way to get <code>TOP</code> to accept a parameter.  No luck!  Just curious ... why not a temporary <code>QueryDef</code>? <code>Set qdf = CurrentDb.CreateQueryDef(vbNullString, sqlstr)</code>  After <code>qdf</code> is closed, it&#39;s gone forever, but maybe keeping it isn&#39;t needed."}, {"owner": {"reputation": 3, "user_id": 10179029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8d081908ab8a1db3ce1a372060df85?s=128&d=identicon&r=PG&f=1", "display_name": "MaryLou", "link": "https://stackoverflow.com/users/10179029/marylou"}, "edited": false, "score": 0, "creation_date": 1556051960, "post_id": 55818627, "comment_id": 98304538, "body": "That makes sense. I&#39;m trying to use &quot;Select Top &quot; &amp; variable &amp; &quot; ....&quot;. That is the entire reason I&#39;m trying to do this in VBA rather than a straight query through the database. Is that not going to be possible? My application is for a skip lot inspection. I&#39;m using top x based on the inspection requirements for the product - some things I&#39;d like to inspect every 4, 9, or 15 lots. By selecting the most recent x lots I can see whether or not the next lot will need to be inspected"}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556052044, "post_id": 55818627, "comment_id": 98304570, "body": "MaryLou, see the changes I just made to the VBA code. You can use a regular expression to change the SQL text in the named query to update TOP n."}, {"owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "edited": false, "score": 0, "creation_date": 1556052169, "post_id": 55818627, "comment_id": 98304628, "body": "HansUp, good point on the temp QueryDef, I didn&#39;t think of that"}, {"owner": {"reputation": 3, "user_id": 10179029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8d081908ab8a1db3ce1a372060df85?s=128&d=identicon&r=PG&f=1", "display_name": "MaryLou", "link": "https://stackoverflow.com/users/10179029/marylou"}, "edited": false, "score": 0, "creation_date": 1556052224, "post_id": 55818627, "comment_id": 98304653, "body": "I&#39;m not familiar with the RegEx term but I will give it a try! Thank you"}], "tags": [], "owner": {"reputation": 326, "user_id": 7061680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22002c39dcc7e46b3beab7af3d0d2c80?s=128&d=identicon&r=PG&f=1", "display_name": "BankBuilder", "link": "https://stackoverflow.com/users/7061680/bankbuilder"}, "is_accepted": true, "score": 1, "last_activity_date": 1556052511, "last_edit_date": 1556052511, "creation_date": 1556049840, "answer_id": 55818627, "question_id": 55815066, "link": "https://stackoverflow.com/questions/55815066/open-recordset-with-nested-queries/55818627#55818627", "title": "Open Recordset with nested queries", "body": "<p>The issue you are encountering is due to the fact that <code>Database.OpenRecordset</code> cannot be used with named queries that contain parameters. Your Requirements query contains a reference to a form field, which is a parameter and must be set explicitly using a QueryDef object.</p>\n\n<p>This strange quirk is also why the query works in all other situations accept when you call it via <code>Database.OpenRecordset</code>.</p>\n\n<p><strong>The simplest solution</strong> would be to save the SQL in sqlstr as a named query, open it via a QueryDef object, set its parameters (vendor and [Forms]![Main Menu]![Part No]) and then open a recordset by calling <code>QueryDef.OpenRecordset</code>.</p>\n\n<p>Code would look similar to this:</p>\n\n<pre><code>    Dim qdf as QueryDef\n    Set qdf = CurrentDb.QueryDefs(\"namedQuery\") ' replace with name of new query\n\n' optionally, use this RegExp to replace \"SELECT TOP n\" dynamically\n' requires reference: Microsoft VBScript Regular Expressions 5.5\n'    Dim regex As New RegExp\n'    regex.IgnoreCase = True\n'    regex.Global = True\n'    regex.Pattern = \"(SELECT TOP )[0-9]+\"\n'    qdf.SQL = regex.Replace(qdf.SQL, \"SELECT TOP \" &amp; rs![skip lot qty])\n\n    qdf.Parameters(\"vendor\") = [Forms]![Main Menu]![Vendor No]\n    qdf.Parameters(\"[Forms]![Main Menu]![Part No]\") = [Forms]![Main Menu]![Part No]\n\n    Set rs2 = qdf.OpenRecordset\n    qdf.Close\n</code></pre>\n\n<p>New named query would look like this (notice vendor parameter):</p>\n\n<pre><code>SELECT TOP 4 [Vendor Log].[ID],[Vendors Query].[Vendor Name], [Vendor Log].[Vendor No], [Vendor Log].[Date], [Vendors Query].[Last Qtr Rating], [Vendor Log].[Part No] , [Requirements Query].[Skip Lot], [Requirements Query].[Plan No], [Vendor Log].[Inspection Req'd], [Vendor Log].[PO Number], [Vendor Log].[Qty Received], [Vendor Log].[Sample Qty], [Vendor Log].[Accept Lot], [Vendor Log].[Comments], [Vendor Log].[Inspector Clock No], [Vendor Log].[Counter], [Requirements Query].[Rev Date], [Requirements Query].[Rev Note], IIf([Accept Lot]=\"R\",1,0) AS [R Counter], IIf([Inspection Req'd]=\"Yes\",1,0) AS [Yes Counter], IIf([Dim A]=\"N/A\",\"No\",\"Yes\") AS [Dim Insp], IIf([Accept Lot] Is Null,1,0) AS [Null Counter], [Requirements Query].[skip lot qty] FROM [Vendors Query] INNER JOIN ([Requirements Query] INNER JOIN [Vendor Log] ON  [Requirements Query].[Part No] = [Vendor Log].[Part No]) ON [Vendors Query].[Vendor No] = [Vendor Log].[Vendor No] WHERE ((([Vendor Log].Date) &gt; (Date - 1095)) And (([Vendor Log].[Vendor No]) = vendor)) ORDER BY [Vendor Log].[ID] DESC;\n</code></pre>\n\n<p><strong>EDIT:</strong> As pointed out by HansUp, TOP only accepts literals and won't accept a parameter. You can either statically specify TOP n in your query or drop TOP altogether if your table isn't very large (10,000+ records). Or you can use the Regular Expression I included in code above</p>\n\n<p>Another excellent point by HansUp would remove the need for the RegExp. You could use the following code as well:</p>\n\n<pre><code>    Dim qdf as QueryDef\n    Set qdf = CurrentDb.CreateQueryDef(\"\") ' creates temporary querydef\n\n    qdf.SQL = \"SELECT TOP \" &amp; SLQ &amp; \"rest of sqlstr...\"    \n\n    qdf.Parameters(\"vendor\") = [Forms]![Main Menu]![Vendor No]\n    qdf.Parameters(\"[Forms]![Main Menu]![Part No]\") = [Forms]![Main Menu]![Part No]\n\n    Set rs2 = qdf.OpenRecordset\n    qdf.Close\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10179029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a8d081908ab8a1db3ce1a372060df85?s=128&d=identicon&r=PG&f=1", "display_name": "MaryLou", "link": "https://stackoverflow.com/users/10179029/marylou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 55818627, "answer_count": 1, "score": 0, "last_activity_date": 1556052511, "creation_date": 1556034798, "last_edit_date": 1556048405, "question_id": 55815066, "link": "https://stackoverflow.com/questions/55815066/open-recordset-with-nested-queries", "title": "Open Recordset with nested queries", "body": "<p>I am trying to open a recordset in Access VBA. I have written my SQL string in VBA as I am using Select Top with a variable. Currently I am getting run time error 3061 - too few parameters. expected 1</p>\n\n<p>My SQL string is populating a form as a RecordSource so I know that the string is functional. My problem comes when I try to open that recordset in order to further manipulate the data.</p>\n\n<p>I believe this error is due to the fact that my SQL string is referencing two other queries in the database. Is there a way to get around the parameters error?</p>\n\n<p>Here is my code. Apologies if the formatting is incorrect</p>\n\n<pre><code>Private Sub Form_Load()\n\nDim skip As String\nDim sqlstr As String\n\nskip = \"select [skip lot qty] from [Requirements] where [requirements].[part no] = eval('[forms]![main menu]![part no]')\"\n\n\nDim rs As DAO.Recordset\nSet rs = CurrentDb.OpenRecordset(skip)\n\n\nDim SLQ As Integer\n\nSLQ = rs![skip lot qty]\n\nDim vendor As String\nvendor = [Forms]![Main Menu]![Vendor No]\n\nsqlstr = \"SELECT TOP \" &amp; SLQ &amp; \" [Vendor Log].[ID],[Vendors Query].[Vendor Name], [Vendor Log].[Vendor No], [Vendor Log].[Date], [Vendors Query].[Last Qtr Rating], \"\n\nsqlstr = sqlstr &amp; \"[Vendor Log].[Part No] , [Requirements Query].[Skip Lot], [Requirements Query].[Plan No], [Vendor Log].[Inspection Req'd], [Vendor Log].[PO Number], \"\n\nsqlstr = sqlstr &amp; \"[Vendor Log].[Qty Received], [Vendor Log].[Sample Qty], [Vendor Log].[Accept Lot], [Vendor Log].[Comments], [Vendor Log].[Inspector Clock No], \"\n\nsqlstr = sqlstr &amp; \"[Vendor Log].[Counter], [Requirements Query].[Rev Date], [Requirements Query].[Rev Note], IIf([Accept Lot]=\"\"R\"\",1,0) AS [R Counter], \"\n\nsqlstr = sqlstr &amp; \"IIf([Inspection Req'd]=\"\"Yes\"\",1,0) AS [Yes Counter], IIf([Dim A]=\"\"N/A\"\",\"\"No\"\",\"\"Yes\"\") AS [Dim Insp], IIf([Accept Lot] Is Null,1,0) AS\"\n\nsqlstr = sqlstr &amp; \" [Null Counter], [Requirements Query].[skip lot qty] FROM [Vendors Query] INNER JOIN ([Requirements Query] INNER JOIN [Vendor Log] ON \"\n\nsqlstr = sqlstr &amp; \" [Requirements Query].[Part No] = [Vendor Log].[Part No]) ON [Vendors Query].[Vendor No] = [Vendor Log].[Vendor No]\"\n\nsqlstr = sqlstr &amp; \" WHERE ((([Vendor Log].Date) &gt; (Date - 1095)) And (([Vendor Log].[Vendor No]) = '\" &amp; vendor &amp; \"')) ORDER BY [Vendor Log].[ID] DESC;\"\n\nDebug.Print sqlstr\n''setting the record source of the form to the string\nMe.RecordSource = sqlstr\n\nDim rs2 As DAO.Recordset\nDim db As DAO.Database\n\n\nSet db = CurrentDb\n\n\nSet rs2 = db.OpenRecordset(sqlstr) &gt;&gt;this is the error\n</code></pre>\n\n<p>Vendor Log is a table while Requirements Query and Vendors Query are select queries that reference tables using information from the previous form.</p>\n\n<p>I would like to open this recordset in order to sum the different counters that are in the string.</p>\n\n<p>I have pasted the sqlstr into a new query and it runs fine. I have double checked all the table names and ran both requirements query and vendors queries through the database with no problems.</p>\n\n<p>Please help!</p>\n\n<p>Edit: Output of Debug.Print:</p>\n\n<pre><code>SELECT TOP 4 [Vendor Log].[ID],[Vendors Query].[Vendor Name], [Vendor Log].[Vendor No], [Vendor Log].[Date], [Vendors Query].[Last Qtr Rating], [Vendor Log].[Part No] , [Requirements Query].[Skip Lot], [Requirements Query].[Plan No], [Vendor Log].[Inspection Req'd], [Vendor Log].[PO Number], [Vendor Log].[Qty Received], [Vendor Log].[Sample Qty], [Vendor Log].[Accept Lot], [Vendor Log].[Comments], [Vendor Log].[Inspector Clock No], [Vendor Log].[Counter], [Requirements Query].[Rev Date], [Requirements Query].[Rev Note], IIf([Accept Lot]=\"R\",1,0) AS [R Counter], IIf([Inspection Req'd]=\"Yes\",1,0) AS [Yes Counter], IIf([Dim A]=\"N/A\",\"No\",\"Yes\") AS [Dim Insp], IIf([Accept Lot] Is Null,1,0) AS [Null Counter], [Requirements Query].[skip lot qty] FROM [Vendors Query] INNER JOIN ([Requirements Query] INNER JOIN [Vendor Log] ON  [Requirements Query].[Part No] = [Vendor Log].[Part No]) ON [Vendors Query].[Vendor No] = [Vendor Log].[Vendor No] WHERE ((([Vendor Log].Date) &gt; (Date - 1095)) And (([Vendor Log].[Vendor No]) = 'PO1296')) ORDER BY [Vendor Log].[ID] DESC;\n</code></pre>\n\n<p>Edit 2:\nSorry these are long queries! This is the Requirements query. [Part numbers] is a table, [requirements] is a table</p>\n\n<pre><code>SELECT DISTINCTROW TOP 1 [Part Numbers].[Part No], [Part Numbers].Description, [Part Numbers].[Matl Type], [Part Numbers].Illustration, [Part Numbers].Obsolete, [Part Numbers].UOM, Requirements.[Skip Lot], Requirements.[Plan No], Requirements.Material, Requirements.[ID Reference], Requirements.Comment, Requirements.Functional, Requirements.Finish, Requirements.Cosmetic, Requirements.[Packaging - General], Requirements.[Individual Label/Tag], Requirements.[UPC Code], Requirements.[Qty per Pack], Requirements.[Pack Label], Requirements.[I2of5 Pack], Requirements.[Qty per Case], Requirements.[Case Label], Requirements.[I2of5 Case], Requirements.[Case Check Req'd?], Requirements.[Case Length (In)], [Case Length (In)]-([Case Length (In)]*0.15) AS [Case L Min], [Case Length (In)]+([Case Length (In)]*0.15) AS [Case L Max], Requirements.[Case Width (In)], [Case Width (In)]-([Case Width (In)]*0.15) AS [Case W Min], [Case Width (In)]+([Case Width (In)]*0.15) AS [Case W Max], Requirements.[Case Height (In)], [Case Height (In)]-([Case Height (In)]*0.15) AS [Case H Min], [Case Height (In)]+([Case Height (In)]*0.15) AS [Case H Max], Requirements.[Case Weight], [Case Weight]-([Case Weight]*0.15) AS [Case Wt Min], [Case Weight]+([Case Weight]*0.15) AS [Case Wt Max], Requirements.Certs, Requirements.[Dim A], Requirements.[A Tolerance], Requirements.[Dim B], Requirements.[B Tolerance], Requirements.[Dim C], Requirements.[C Tolerance], Requirements.[Dim D], Requirements.[D Tolerance], Requirements.[Dim E], Requirements.[E Tolerance], Requirements.[Dim F], Requirements.[F Tolerance], Requirements.[Dim G], Requirements.[G Tolerance], Requirements.[Dim H], Requirements.[H Tolerance], Requirements.[Other Dim], Requirements.[Other Tol], Requirements.[WLL (lbs)], Requirements.[WLL (kg)], Requirements.[BF Test Data], Requirements.[Breaking Force (lbs)], Requirements.[BF Test Req'd?], Requirements.[BF Sample], Requirements.Elongation, Requirements.Comments, Requirements.[Rev Date], Requirements.[Rev Note], IIf([Dim A]=\"N/A\",\"No\",\"Yes\") AS [Dim Insp], Requirements.[Spec Ref], Requirements.[skip lot qty]\nFROM [Part Numbers] INNER JOIN Requirements ON [Part Numbers].[Part No] = Requirements.[Part No]\nWHERE ((([Part Numbers].[Part No])=[Forms]![Main Menu]![Part No]))\nORDER BY Requirements.[Rev Date] DESC;\n</code></pre>\n\n<p>Vendors query: Vendors and Ratings are both tables</p>\n\n<pre><code>SELECT Vendors.[Vendor No], Vendors.[Vendor Name], Vendors.Obsolete, Vendors.[Last Qtr Rating], Ratings.[Last Rating Score]\nFROM Ratings INNER JOIN Vendors ON Ratings.[Last Qtr Rating] = Vendors.[Last Qtr Rating]\nWHERE (((Vendors.Obsolete)=No))\nORDER BY Vendors.[Vendor Name];\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 4, "creation_date": 1556033915, "post_id": 55814781, "comment_id": 98296382, "body": "Welcome to Stack Overflow. Please note that we cannot <i>provide any code</i> because this is no free code writing service it is necessary to show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. If you show the code you have tried or provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> we can help you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might also help you to improve your question."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1556035817, "post_id": 55814781, "comment_id": 98297388, "body": "Why are you using <code>.CopyPicture</code>? Where do you want the copied information output to?  Right now it&#39;s all just being pasted on top of each other as images in cell <code>A16</code>..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1556036544, "post_id": 55814781, "comment_id": 98297784, "body": "Would help your question if you could explain roughly how your &quot;regions&quot; are arranged on the sheet.  All in a row/grid/column?  Randomly?"}, {"owner": {"reputation": 1, "user_id": 11400592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lre5B.jpg?s=128&g=1", "display_name": "ajjava", "link": "https://stackoverflow.com/users/11400592/ajjava"}, "edited": false, "score": 0, "creation_date": 1556039962, "post_id": 55814781, "comment_id": 98299460, "body": "All of the existing regions are currently side by side, going horizontally across (output from Biz Objects that way). My manager wants them a) copy/pasted as pictures b) arranged vertically on the spreadsheet. Yes, I know they are all being copied to the same cell. That&#39;s because I work in tiny steps, trying to get each &quot;section&quot; of code to work, before moving on to the next. My next step will be to rearrange all of the pasted pics in some organized fashion."}, {"owner": {"reputation": 1, "user_id": 11400592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lre5B.jpg?s=128&g=1", "display_name": "ajjava", "link": "https://stackoverflow.com/users/11400592/ajjava"}, "edited": false, "score": 0, "creation_date": 1556040035, "post_id": 55814781, "comment_id": 98299500, "body": "Also, if my code example above looks like crazy talk, that&#39;s because I cobble various things together until something &quot;works&quot;. Not the best for efficiency, I know."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1556082090, "post_id": 55814781, "comment_id": 98310871, "body": "Could you share the layout of your worksheet?"}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1556096157, "last_edit_date": 1556096157, "creation_date": 1556093988, "answer_id": 55825425, "question_id": 55814781, "link": "https://stackoverflow.com/questions/55814781/how-to-loop-through-several-regions-of-a-worksheet/55825425#55825425", "title": "How to loop through several regions of a worksheet?", "body": "<p>Something like that should work</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ProcessEachRegion()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\") 'define your sheet\n\n    Dim StartCell As Range\n    Set StartCell = ws.Range(\"A1\") 'define start cell\n\n    Do Until StartCell.Column = ws.Columns.Count 'loop until end of columns\n        With StartCell.CurrentRegion\n            'do all your copy stuff here!\n            '.Copy\n            'Destination.Paste\n\n\n            Set StartCell = .Resize(1, 1).Offset(ColumnOffset:=.Columns.Count - 1).End(xlToRight)\n        End With\n    Loop\nEnd Sub\n</code></pre>\n\n<p>It looks for the next region right to the previous one (regions 1 to 5 in the example below).</p>\n\n<p><a href=\"https://i.stack.imgur.com/aWFpV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aWFpV.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11400592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lre5B.jpg?s=128&g=1", "display_name": "ajjava", "link": "https://stackoverflow.com/users/11400592/ajjava"}, "edited": false, "score": 0, "creation_date": 1556122070, "post_id": 55832093, "comment_id": 98333211, "body": "Believe me, I don&#39;t understand why the copy/paste-as-pic, either. I am going to give this a try and see where I end up. I&#39;ll report back. Thanks!"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1556114922, "creation_date": 1556114922, "answer_id": 55832093, "question_id": 55814781, "link": "https://stackoverflow.com/questions/55814781/how-to-loop-through-several-regions-of-a-worksheet/55832093#55832093", "title": "How to loop through several regions of a worksheet?", "body": "<p>The main sub (I named it <code>tgr</code>) will call a function named <code>GetAllPopulatedCells</code> which defines a range for all populated cells in a worksheet.  The <code>.Areas</code> property will let your loop through each region.  It will then copy each Area/Region as a picture (still not sure why you want this) and put it in the destination cell, and then adjust the destination cell as needed so that all of the pasted images are stacked on top of each other.</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim rAllRegions As Range\n    Dim rRegion As Range\n    Dim rDest As Range\n\n    Set ws = ActiveWorkbook.ActiveSheet\n    Set rAllRegions = GetAllPopulatedCells(ws)\n    Set rDest = ws.Range(\"A16\")\n\n    If rAllRegions Is Nothing Then\n        MsgBox \"No populated cells found in '\" &amp; ws.Name &amp; \"'. Exiting Macro.\", , \"Error\"\n        Exit Sub\n    End If\n\n    For Each rRegion In rAllRegions.Areas\n        rRegion.CopyPicture\n        rDest.PasteSpecial\n        Set rDest = rDest.Offset(rRegion.Rows.Count)\n    Next rRegion\n\nEnd Sub\n\nPublic Function GetAllPopulatedCells(Optional ByRef arg_ws As Worksheet) As Range\n\n    Dim ws As Worksheet\n    Dim rConstants As Range\n    Dim rFormulas As Range\n\n    If arg_ws Is Nothing Then Set ws = ActiveWorkbook.ActiveSheet Else Set ws = arg_ws\n\n    On Error Resume Next\n    Set rConstants = ws.Cells.SpecialCells(xlCellTypeConstants)\n    Set rFormulas = ws.Cells.SpecialCells(xlCellTypeFormulas)\n    On Error GoTo 0\n\n    Select Case Abs(rConstants Is Nothing) + 2 * Abs(rFormulas Is Nothing)\n        Case 0: Set GetAllPopulatedCells = Union(rConstants, rFormulas)\n        Case 1: Set GetAllPopulatedCells = rFormulas\n        Case 2: Set GetAllPopulatedCells = rConstants\n        Case 3: Set GetAllPopulatedCells = Nothing\n    End Select\n\n    Set ws = Nothing\n    Set rConstants = Nothing\n    Set rFormulas = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11400592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Lre5B.jpg?s=128&g=1", "display_name": "ajjava", "link": "https://stackoverflow.com/users/11400592/ajjava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1556114922, "creation_date": 1556033822, "last_edit_date": 1556082143, "question_id": 55814781, "link": "https://stackoverflow.com/questions/55814781/how-to-loop-through-several-regions-of-a-worksheet", "title": "How to loop through several regions of a worksheet?", "body": "<p>I'm looking for some VBA that will allow me to loop through several different REGIONS on a worksheet. Not individual cells, necessarily, but to jump from \"currentregion\" to the next \"currentregion\". And once the region is located, it should be selected and copied.</p>\n\n<p>I've tried setting a StartCell (via Cells.Find(What:=\"*\") and then using that cell to select the corresponding 'currentregion'. The issue is how to move to the next 'currentregion', until all 'currentregions' on the worksheet have been copied/pasted.</p>\n\n<p>My results are inconsistent so far, where sometimes all the necessary regions are copied/pasted, but other times some of the regions are ignored (same exact worksheet, same exact data).</p>\n\n<pre><code>Set StartCell = Cells.Find(What:=\"*\", _\n                    After:=Cells(Rows.Count, Columns.Count), _\n                    LookAt:=xlPart, _\n                    LookIn:=xlFormulas, _\n                    SearchOrder:=xlByRows, _\n                    SearchDirection:=xlNext, _\n                    MatchCase:=False)Do\n\n            'Select Range and copy it\n              If StartCell &lt;&gt; \"\" Then\n              StartCell.currentregion.CopyPicture\n\n            'Select a cell to paste the picture in\n              Range(\"A16\").PasteSpecial\n\n            'Move to next range to be copied\n\n            Set StartCell = StartCell.End(xlToRight).End(xlToRight)\n           StartCell.Select\n            End If\n\n        Loop Until StartCell = \"\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1556033719, "post_id": 55814704, "comment_id": 98296255, "body": "<code>&quot; + opendate + : + enddate + &quot;</code> should be <code>opendate &amp; &quot;:&quot; &amp; enddate</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556033883, "post_id": 55814704, "comment_id": 98296356, "body": "Do you want to construct a range from two numbers?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1556034337, "post_id": 55814704, "comment_id": 98296596, "body": "In fact you can&#39;t construct a range from two numbers to 4dps!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11400550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973bf25afcec19a7aff1d8c42a055f31?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/11400550/andy"}, "edited": false, "score": 0, "creation_date": 1556039407, "post_id": 55815412, "comment_id": 98299214, "body": "Hi there and thank you for your answer! However i seem to encounter a problem by implementing it this way as instead of the actual numbers i get zero &quot;0&quot; as min and max values ;/"}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "reply_to_user": {"reputation": 1, "user_id": 11400550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973bf25afcec19a7aff1d8c42a055f31?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/11400550/andy"}, "edited": false, "score": 0, "creation_date": 1556105221, "post_id": 55815412, "comment_id": 98322555, "body": "Do you have a few samples of actual values you have there? assuming your values are 0.xxxx ... you need to find a way to translate those values in actual usable row numbers (i.e. rounding as I&#39;ve suggested)."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1556036060, "creation_date": 1556036060, "answer_id": 55815412, "question_id": 55814704, "link": "https://stackoverflow.com/questions/55814704/excel-vba-problem-with-assigning-dynamic-variables-to-range-function/55815412#55815412", "title": "Excel VBA: Problem with assigning dynamic variables to range function", "body": "<p>welcome to SO.</p>\n\n<p>You can build dynamic ranges, though you would need to change your aproach to it.</p>\n\n<p>If you want to use the Range object in the way you are using it at the moment, then you would need something similar along the lines:</p>\n\n<pre><code>Dim opendate as String, enddate as String 'Not as Double!\nopendate = \"D20\"\nenddate = \"D40\"\n\nSet Rng = ActiveSheet.Range(opendate &amp; \":\" &amp; enddate)\n</code></pre>\n\n<p>If you have a fixed column with this values, but only want to change the rows dynamically, you could change that into something like this:</p>\n\n<pre><code>Dim opendate As Long\n    activecell.offset(0, -7).Select\n    opendate = activecell.Value\n\nactivecell.offset(0, 7).Select\nSelection.End(xlDown).Select\nactivecell.offset(-1, 0).Select\n\nDim enddate As Long\n    activecell.offset(0, -7).Select\n    enddate = activecell.Value\n\nSet Rng = ActiveSheet.Range(\"D\" &amp; opendate &amp; \":D\" &amp; enddate)\n</code></pre>\n\n<p>It really all depends on the content of those cells you are getting those values from, and a range doesn't take any decimals as far as I`m aware, though I've never tried. If the values are with up to 4DPs, but your code still depends on them, i suggest using a formula to get the rounded value to the nearest full number, i.e.: 4.5744 = 4 or 5 (depending on your needs).</p>\n\n<p>That being said, I advise against using <code>.Select</code> and <code>activecell.</code> as your \"dynamic\" selections, it kind of defeats the purpose of making your code dynamic...</p>\n"}], "owner": {"reputation": 1, "user_id": 11400550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973bf25afcec19a7aff1d8c42a055f31?s=128&d=identicon&r=PG&f=1", "display_name": "Andy", "link": "https://stackoverflow.com/users/11400550/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556036060, "creation_date": 1556033566, "question_id": 55814704, "link": "https://stackoverflow.com/questions/55814704/excel-vba-problem-with-assigning-dynamic-variables-to-range-function", "title": "Excel VBA: Problem with assigning dynamic variables to range function", "body": "<p>I started of by assigning variables using the Dim function. These variables are dynamic and change every time the code is executed. The variables are \"opendate\" and \"enddate\". When i wanted to assign them in a range function so to get the max and min values within that range, it fails every time. I know how to get min and max values if the range is specified directly i.e range(\"D20:D41\") but i want the correction when it comes to a case such as this. Please see attached code below as i know im not fully coherent with this explanation. Thanks</p>\n\n<pre><code>Public sub aom()\n\n'This is a normal case scenario\n\nset rng=activesheet.range(\"D20:D40\")\n\nRange(\"L32\").Value = WorksheetFunction.Max(Rng)\nRange(\"L33\").Value = WorksheetFunction.Min(Rng)\n\nEnd sub\n\n</code></pre>\n\n<pre><code>\nPublic Sub aomhigh()\n\n'This is my case\n\n'Firstly i declare my variables(note that those variables are numbers up to 4 dp)\n\nDim opendate As Double\n    activecell.offset(0, -7).Select\n    opendate = activecell.Value\n\nactivecell.offset(0, 7).Select\nSelection.End(xlDown).Select\nactivecell.offset(-1, 0).Select\n\nDim enddate As Double\n    activecell.offset(0, -7).Select\n    enddate = activecell.Value\n\n'Then i think the way to declare them in the range function is something like this even though it seems i never get it right\n\nSet Rng = ActiveSheet.Range(\" + opendate + : + enddate + \") '&lt;- This is where the problem is\n\n'Then the normal finding for max and min values as usual\n\nRange(\"L32\").Value = WorksheetFunction.Max(Rng)\nRange(\"L33\").Value = WorksheetFunction.Min(Rng)\n\nEnd sub\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1556033548, "creation_date": 1556033548, "answer_id": 55814699, "question_id": 55814539, "link": "https://stackoverflow.com/questions/55814539/msgbox-does-not-pop-when-given-multiple-arguments-in-if-then-statement/55814699#55814699", "title": "MsgBox does not pop when given multiple arguments in If / Then statement", "body": "<p>Try:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Target.Address = \"$C$1\" And Range(\"A1\").Value = \"\" Then 'or IsEmpty(Range(\"A1\"))\n        MsgBox \"Please fill out previous fields to continue\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><code>Target.Address</code> would return <code>$C$1</code> - so that's needed there. And <code>Is Nothing</code> isn't used for determining if a cell is empty - that would be <code>IsEmpty()</code> or <code>.Value = \"\"</code> - <code>Is Nothing</code> is used more for determining if an <code>Object</code> has been <code>Set</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1556033678, "creation_date": 1556033678, "answer_id": 55814736, "question_id": 55814539, "link": "https://stackoverflow.com/questions/55814539/msgbox-does-not-pop-when-given-multiple-arguments-in-if-then-statement/55814736#55814736", "title": "MsgBox does not pop when given multiple arguments in If / Then statement", "body": "<p><code>Range(\"A1\")</code> returns a <code>Range</code> object that represents the cell at <code>A1</code> - this will never be <code>Nothing</code> because <code>A1</code> will always exist as a cell.</p>\n\n<p>You can <code>And IsEmpty(Range(\"A1\"))</code> to see if it has a value.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 2064588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09e87ae075499520960a257600efc984?s=128&d=identicon&r=PG", "display_name": "Francesco Giossi", "link": "https://stackoverflow.com/users/2064588/francesco-giossi"}, "is_accepted": false, "score": 0, "last_activity_date": 1556033706, "creation_date": 1556033706, "answer_id": 55814743, "question_id": 55814539, "link": "https://stackoverflow.com/questions/55814539/msgbox-does-not-pop-when-given-multiple-arguments-in-if-then-statement/55814743#55814743", "title": "MsgBox does not pop when given multiple arguments in If / Then statement", "body": "<p>Try this</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.Address = \"$C$1\" And Len(Range(\"A1\")) = 0 Then\n        MsgBox \"Please fill out previous fields to continue\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": false, "score": 0, "last_activity_date": 1556033742, "creation_date": 1556033742, "answer_id": 55814756, "question_id": 55814539, "link": "https://stackoverflow.com/questions/55814539/msgbox-does-not-pop-when-given-multiple-arguments-in-if-then-statement/55814756#55814756", "title": "MsgBox does not pop when given multiple arguments in If / Then statement", "body": "<p>This should work for You:</p>\n\n<p>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</p>\n\n<pre><code>If Target.Address(False, False) = \"C1\" And IsEmpty(Range(\"A1\")) = True Then\n    MsgBox \"Please fill out previous fields to continue\"\nEnd If\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 13, "user_id": 7255052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc210bba3aec234f292c217f605fbed7?s=128&d=identicon&r=PG&f=1", "display_name": "Hfee", "link": "https://stackoverflow.com/users/7255052/hfee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1556034228, "creation_date": 1556032981, "last_edit_date": 1556034228, "question_id": 55814539, "link": "https://stackoverflow.com/questions/55814539/msgbox-does-not-pop-when-given-multiple-arguments-in-if-then-statement", "title": "MsgBox does not pop when given multiple arguments in If / Then statement", "body": "<p>When i select cell C1, if A1 is empty, i want a message box to pop up. Though nothing actually happens (no error message either). Is my syntax wrong or am i going about it the wrong way?</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Target.Address = \"C1\" And Range(\"A1\") Is Nothing Then\n        MsgBox \"Please fill out previous fields to continue\"\n    End If\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 2, "creation_date": 1556032951, "post_id": 55814470, "comment_id": 98295815, "body": "The private type and function declarations need to be outside (above the first line) of your public function declaration."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1556033461, "last_edit_date": 1556033461, "creation_date": 1556033134, "answer_id": 55814586, "question_id": 55814470, "link": "https://stackoverflow.com/questions/55814470/compile-error-due-to-position-of-private-declare-statement/55814586#55814586", "title": "Compile error due to position of Private Declare statement", "body": "<p><code>Declare</code> statements belong at module level. Cut the two lines and move them at the very top of the module, just underneath where <code>Option Explicit</code> should be.</p>\n\n<p>The compile error is a bit clumsy / misleading: it's the same compile error you would be getting if you had <code>Declare</code> statements or variable declarations <em>between</em> two procedures in the module.</p>\n\n<pre><code>Option Explicit\n'legal here\nPrivate Declare PtrSafe Function CoCreateGuid Lib \"ole32.dll\" (guid As GUID_TYPE) As LongPtr\n\nPublic Sub Foo()\nEnd Sub\n\n'illegal here\nPrivate Declare PtrSafe Function CoCreateGuid Lib \"ole32.dll\" (guid As GUID_TYPE) As LongPtr\n\nPrivate Function Bar()\n    'illegal here\n    Private Declare PtrSafe Function CoCreateGuid Lib \"ole32.dll\" (guid As GUID_TYPE) As LongPtr\nEnd Sub\n</code></pre>\n\n<p><code>Declare</code> statements must live in the module's <code>(declarations)</code> section - watch the upper-left dropdown at the top of the code pane window: if it doesn't say <code>(declarations)</code>, then you're inside a procedure's scope; <code>Declare</code> statements can't be scoped at procedure level.</p>\n"}], "owner": {"reputation": 93, "user_id": 4364545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aecc9f5ab47f785e0ad793886181ce8?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4364545/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1592554791, "creation_date": 1556032775, "last_edit_date": 1592554791, "question_id": 55814470, "link": "https://stackoverflow.com/questions/55814470/compile-error-due-to-position-of-private-declare-statement", "title": "Compile error due to position of Private Declare statement", "body": "<p>I am trying to use the alternative to <code>CreateObject(\"Scriptlet.TypeLib\").GUID</code> provided on <a href=\"https://support.microsoft.com/en-gb/help/4036837/run-time-error-70-permission-denied-generate-guid-with-office-vba\" rel=\"nofollow noreferrer\">this Microsoft support page</a> (with some modification) but get \"Compile error: Only comments may appear after End Sub, End Function, or End Property\" on the <code>Private Declare PtrSafe Function CoCreateGuid Lib \"ole32.dll\" (guid As GUID_TYPE) As LongPtr</code> line. </p>\n\n<p>As can be seen in the code below, this line is within a function so I don't understand what is causing this compile error.</p>\n\n<p>I tried to move the two <code>Private Declare</code> lines around within the function to see if that would solve the issue but continued to get the same error.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Function GetGUID() As String\n  Private Type GUID_TYPE\n    Data1 As Long\n    Data2 As Integer\n    Data3 As Integer\n    Data4(7) As Byte\n  End Type\n\n  Private Declare PtrSafe Function CoCreateGuid Lib \"ole32.dll\" (guid As GUID_TYPE) As LongPtr\n  Private Declare PtrSafe Function StringFromGUID2 Lib \"ole32.dll\" (guid As GUID_TYPE, ByVal lpStrGuid As LongPtr, ByVal cbMax As Long) As LongPtr\n\n  Dim guid As GUID_TYPE\n  Dim strGuid As String\n  Dim retValue As LongPtr\n  Const guidLength As Long = 39 'registry GUID format with null terminator {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}\n  retValue = CoCreateGuid(guid)\n  If retValue = 0 Then\n    strGuid = String$(guidLength, vbNullChar)\n    retValue = StringFromGUID2(guid, StrPtr(strGuid), guidLength)\n    If retValue = guidLength Then\n      ' valid GUID as a string\n      GetGUID = strGuid\n    End If\n  End If\nEnd Function\n</code></pre>\n\n<p>This function is being used within a module meant to copy calendar events from the default calendar to another specified calendar. </p>\n\n<p>This code can be found <a href=\"https://blog.binarybits.net/programming/copy-new-appointments-one-calendar-another-calendar-using-vba/\" rel=\"nofollow noreferrer\">here</a>. Again, it replaces the <code>GetGUID = Mid$(CreateObject(\"Scriptlet.TypeLib\").GUID, 2, 36)</code> line within this code.</p>\n\n<p>What is causing this error and is there a solution?</p>\n"}]