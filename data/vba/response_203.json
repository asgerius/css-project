[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1543447649, "post_id": 53529471, "comment_id": 93927836, "body": "Seems to work fine for me. If you want to prevent copy you need to add <code>Application.OnKey &quot;^c&quot;, &quot;&quot;</code> - paste would be <code>Application.OnKey &quot;^v&quot;, &quot;&quot;</code> - the <code>^</code> in the first part stands for the <code>Control</code> key - the <code>p</code> is the key being pressed along with it."}, {"owner": {"reputation": 29, "user_id": 10439350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14a1800fe019ba2a5a5da54aec72a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Sarooj", "link": "https://stackoverflow.com/users/10439350/sarooj"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1543447974, "post_id": 53529471, "comment_id": 93927932, "body": "Thanks but where I must put them . I mean what is the event that I must put this code in to work ?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1543447991, "post_id": 53529471, "comment_id": 93927941, "body": "You&#39;re fine to put them in the <code>Workbook_Open()</code> event in <code>ThisWorkbook</code>"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1543448282, "post_id": 53529471, "comment_id": 93928033, "body": "I&#39;m writing up a sub for you - unfortunately it doesn&#39;t look like excel will let you just do <code>Application.OnKey &quot;^&quot;, &quot;&quot;</code> which would completely disable control - you have to walk it through the various keys."}, {"owner": {"reputation": 29, "user_id": 10439350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14a1800fe019ba2a5a5da54aec72a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Sarooj", "link": "https://stackoverflow.com/users/10439350/sarooj"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1543448362, "post_id": 53529471, "comment_id": 93928058, "body": "I try this code in all type of event and  the shortcut still works but ^p ."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10439350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14a1800fe019ba2a5a5da54aec72a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Sarooj", "link": "https://stackoverflow.com/users/10439350/sarooj"}, "edited": false, "score": 1, "creation_date": 1543515697, "post_id": 53529894, "comment_id": 93957193, "body": "First thank you a million , second I am sorry for not replying  immediately but I stay until Igot chance to try the code in a computer , it works like magic ."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "reply_to_user": {"reputation": 29, "user_id": 10439350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14a1800fe019ba2a5a5da54aec72a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Sarooj", "link": "https://stackoverflow.com/users/10439350/sarooj"}, "edited": false, "score": 0, "creation_date": 1543517109, "post_id": 53529894, "comment_id": 93957889, "body": "Np - happy to help \ud83d\ude42"}], "tags": [], "owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "is_accepted": true, "score": 3, "last_activity_date": 1543453598, "last_edit_date": 1543453598, "creation_date": 1543449319, "answer_id": 53529894, "question_id": 53529471, "link": "https://stackoverflow.com/questions/53529471/the-event-where-application-onkey-is-put/53529894#53529894", "title": "The event where application.onkey is put", "body": "<p>Try this - You can put this in the <code>ThisWorkbook</code> object.</p>\n\n<p>Just paste the whole thing in.</p>\n\n<p>This will go through (almost) every key and block the key's combination with control.</p>\n\n<p>This won't let you open the help menu (<code>CTRL + F1</code>), it won't let you select all cells (<code>CTRL + A</code>) - it won't let you do (most) anything with the control key.</p>\n\n<p>It's worth noting that this <strong>will not</strong> block things like <code>CTRL+SHIFT+DOWN</code> - only things like <code>CTRL+A</code>.</p>\n\n<p>It would be relatively trivial to add that functionality if you wanted though - you'd just add additional BlockKey requests for <code>\"^+\"</code> and <code>\"^%\"</code> and <code>\"^+%\"</code> - something like that.</p>\n\n<p>Edit: After writing this, I found similar code from someone else here <a href=\"https://www.rondebruin.nl/win/s4/win012.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s4/win012.htm</a></p>\n\n<pre><code>Private Sub Workbook_Open()\n'Call DisableControlKey '&lt;- Use this in production\nCall DisableControlKey(True) 'True means show in debug window what was blocked -\nEnd Sub\n\nSub DisableControlKey(Optional ShowInDebug As Boolean = False)\nDim Arr(), x\nArr = Array(\"{BS}\", \"{BREAK}\", \"{CAPSLOCK}\", \"{CLEAR}\", \"{DEL}\", \"{DOWN}\", \"{END}\", _\n            \"{ENTER}\", \"~\", \"{ESC}\", \"{HELP}\", \"{HOME}\", \"{INSERT}\", \"{LEFT}\", \"{NUMLOCK}\", _\n            \"{PGDN}\", \"{PGUP}\", \"{RETURN}\", \"{RIGHT}\", \"{SCROLLLOCK}\", \"{TAB}\", \"{UP}\")\n'Block all ascii characters from 0 to 127\nFor x = 0 To 127\n    If ShowInDebug Then\n        Debug.Print Chr(x) &amp; \": \" &amp; BlockKey(\"^\" &amp; Chr(x))\n    Else\n        BlockKey (\"^\" &amp; Chr(x))\n    End If\nNext x\n'Block all keys on this list: https://docs.microsoft.com/en-us/office/vba/api/excel.application.onkey\nFor x = LBound(Arr) To UBound(Arr)\n    If ShowInDebug Then\n        Debug.Print Arr(x) &amp; \": \" &amp; BlockKey(\"^\" &amp; Arr(x))\n    Else\n        BlockKey (\"^\" &amp; Chr(x))\n    End If\nNext x\n'Block all function keys\nFor x = 1 To 15\n    If ShowInDebug Then\n        Debug.Print \"F\" &amp; x &amp; \": \" &amp; BlockKey(\"^\" &amp; \"{F\" &amp; x &amp; \"}\")\n    Else\n        BlockKey (\"^\" &amp; \"{F\" &amp; x &amp; \"}\")\n    End If\nNext x\nEnd Sub\nFunction BlockKey(KeyCombo As String) As Boolean\nOn Error Resume Next\nApplication.OnKey KeyCombo, \"\"\nBlockKey = (Err.Number = 0)\nOn Error GoTo 0\nEnd Function\n</code></pre>\n\n<p>You can see what's being blocked in the immediate window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kbePD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kbePD.png\" alt=\"Output\"></a></p>\n\n<p>In theory, you'd really want to go through these combinations and clean up whatever you don't need for speed's sake - get rid of the for loops and just loop through a large array of whatever <code>CTRL+</code> key combinations you want to block.</p>\n\n<p>If you wanted to go completely crazy, you could actually install a low level key hook (this is ridiculous) and block CTRL from external applications too. (<strong>Hint: Don't do this.</strong>)</p>\n\n<p><a href=\"https://www.codeguru.com/vb/gen/vb_system/keyboard/article.php/c4829/Managing-LowLevel-Keyboard-Hooks-with-the-Windows-API.htm\" rel=\"nofollow noreferrer\">https://www.codeguru.com/vb/gen/vb_system/keyboard/article.php/c4829/Managing-LowLevel-Keyboard-Hooks-with-the-Windows-API.htm</a></p>\n"}], "owner": {"reputation": 29, "user_id": 10439350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c14a1800fe019ba2a5a5da54aec72a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Sarooj", "link": "https://stackoverflow.com/users/10439350/sarooj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 53529894, "answer_count": 1, "score": 1, "last_activity_date": 1543453598, "creation_date": 1543446459, "last_edit_date": 1543448506, "question_id": 53529471, "link": "https://stackoverflow.com/questions/53529471/the-event-where-application-onkey-is-put", "title": "The event where application.onkey is put", "body": "<p>I would like to disable the shortcut of Ctrl button and I've found <code>Application.onkeyMethod</code> but I didn't know where I can put them. </p>\n\n<p><code>Application.onkey \"^p\",\"\"</code>   works in workbook open event but that doesn't happen to copy shortcut, cut,  and so on.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1543446190, "post_id": 53529376, "comment_id": 93927513, "body": "Welcome to the site, Andy! Have you tried stepping through your code using <code>F8</code>? You may be able to pinpoint where issues are happening by starting there. Another suggestion is to remove the lines <code>Application.DisplayAlerts = False</code> and <code>Application.ScreenUpdating = False</code> so you can see - in real time - what exactly is happening."}, {"owner": {"reputation": 1, "user_id": 10205902, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xG9gdBuQjEI/AAAAAAAAAAI/AAAAAAAAAPU/UCvJvSXTKbI/photo.jpg?sz=128", "display_name": "Andy Williams", "link": "https://stackoverflow.com/users/10205902/andy-williams"}, "reply_to_user": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1543446343, "post_id": 53529376, "comment_id": 93927548, "body": "Hey! I have gone step by step, remote on my colleagues computer (F5 through the loops once I established each one looked correct). The end result matched what my computer produces. However, when I then ran the macro in full, it produced a different result"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1543447033, "post_id": 53529376, "comment_id": 93927700, "body": "Please see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  As is this too broad.  Try to find the offending part and create a smaller block of code that represents the error.  It should be something we can test."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1543448067, "post_id": 53529376, "comment_id": 93927966, "body": "You should be looping backward when deleting rows. Also, this line needs a worksheet qualifier: <code>Rows(r.Row + counter &amp; &quot;:&quot; &amp; r.Row + counter).Insert Shift:=xlDown</code>."}, {"owner": {"reputation": 1, "user_id": 10205902, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xG9gdBuQjEI/AAAAAAAAAAI/AAAAAAAAAPU/UCvJvSXTKbI/photo.jpg?sz=128", "display_name": "Andy Williams", "link": "https://stackoverflow.com/users/10205902/andy-williams"}, "edited": false, "score": 0, "creation_date": 1543448715, "post_id": 53529376, "comment_id": 93928143, "body": "Both are great shouts, thanks"}], "owner": {"reputation": 1, "user_id": 10205902, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-xG9gdBuQjEI/AAAAAAAAAAI/AAAAAAAAAPU/UCvJvSXTKbI/photo.jpg?sz=128", "display_name": "Andy Williams", "link": "https://stackoverflow.com/users/10205902/andy-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543528507, "creation_date": 1543445922, "last_edit_date": 1543528507, "question_id": 53529376, "link": "https://stackoverflow.com/questions/53529376/vba-process-runs-correctly-on-my-computer-but-not-on-another", "title": "VBA - process runs correctly on my computer, but not on another", "body": "<p>EDIT 2 - Solved by Comintern - the missed definition here - </p>\n\n<pre><code>Rows(r.Row + counter &amp; \":\" &amp; r.Row + counter).Insert Shift:=xlDown\n</code></pre>\n\n<p>Should read</p>\n\n<pre><code>ws.Rows(r.Row + counter &amp; \":\" &amp; r.Row + counter).Insert Shift:=xlDown\n</code></pre>\n\n<p>Original Post - \nI have a tool I'm trying to make with the main primary functions - </p>\n\n<ul>\n<li>Basic reformatting to a report</li>\n<li>Splitting rows where a single cell has a,b,c,d into 4 rows with one value each </li>\n<li>Row deletion or recolouring based on value in column H</li>\n<li>File saving</li>\n</ul>\n\n<p>It runs fine on my computer, and it runs fine on a colleagues computer when going step-by-step. However, running the code on my colleagues computer, everything runs but the output is different.\n<strong><em>~Edit</em></strong>  I was running step-by-step remote on a colleague's PC whilst going step-by-step on my own PC, to confirm output looked the same</p>\n\n<p>I've checked around, and not able to work out what is causing this issue. </p>\n\n<p>Code is run from a button, so don't believe it's an issue with activesheet. Additionally, I think I've linked every range/reference to a named worksheet. Also, I'm not hitting an error, simply it is giving a different output (specifically, more rows are deleted in the output)</p>\n\n<pre><code>Sub FDA_Macro_Clean()\n\nDim ws As Worksheet\nDim wb As Workbook, outputwb As Workbook\nDim lastrow As Integer, x As Integer, y As Integer\nDim rownum As Long, rownum2 As Long, string1 As Long, string2 As Long, counter As Long\nDim r As Range\nDim timeslot As String, shareddrive As String, savename As String\n\nApplication.DisplayAlerts = False 'turns off alerts\nApplication.ScreenUpdating = False 'turns off screen updates\n\n'###################################### - Defines Workbook and Sheets\nSet wb = Workbooks(\"FDA Macro Template - No GRID 11-28 2pm.xlsm\")\nSet ws = wb.Sheets(\"Import Declaration Report\")\n\n'###################################### - Delete unused cells\nws.Rows(\"1:56\").Delete\nws.Range(\"A:B,Q:Q\").Delete\n\n'###################################### - defines final active row (1 of 3 times we define)\n\nlastrow = ws.Range(\"a\" &amp; Rows.Count).End(xlUp).Row\n\n'###################################### - Delete s cells which are out of scope\n\nx = 2\nDo Until x = lastrow + 1\n\n    If ws.Range(\"H\" &amp; x).Value = \"APH - MAY PROCEED\" Or ws.Range(\"H\" &amp; x).Value = \"FDA - \" Then\n        ws.Range(\"H\" &amp; x).EntireRow.Delete 'Deletes rows with above 2 criteria values\n        x = x - 1\n    End If\n    x = x + 1\n\nLoop\n\n'###################################### - Creates new rows for anything where column A/B has different values\nrownum = 1\nDo Until ws.Range(\"A\" &amp; rownum) = \"\"\n    string1 = UBound(Split(ws.Range(\"A\" &amp; rownum), \",\")) 'counts instances of \",\" in Column A\n    string2 = UBound(Split(ws.Range(\"B\" &amp; rownum), \",\")) 'counts instances of \",\" in Column B\n\n    If string1 &lt;&gt; string2 Or string1 = 0 Then   'if the strings are 0, skip to next item. If strings mismatch, follow error path\n        If string1 &lt;&gt; string2 Then 'If strings mismatch, follow error path\n            ws.Range(\"A\" &amp; rownum &amp; \":N\" &amp; rownum).Interior.Color = RGB(236, 110, 212) 'ERROR PATH - Highlight Purple\n            ws.Range(\"M\" &amp; rownum).Value = ws.Range(\"M\" &amp; rownum).Value &amp; \"Bill/Container count mismatch\" 'ERROR PATH - Add comment in column M\n            y = y + 1 'Value of Y is used to determine if there is an error later in the macro\n        End If\n        rownum = rownum + 1 'Next row\n        GoTo NextRowLoop                                        'increases RowNum by 1 and skips the split\n    End If\n\n    'Part 2 - only for lines where String1 &lt;&gt; 0 and String1 = String2\n\n    Set r = ws.Range(\"a\" &amp; rownum)       'sets r to current cell - CBL column\n    Dim arr As Variant\n    arr = Split(r, \", \")                                             'fills array with each bill, removing the \", \"\n    r = arr(0)                                                          'puts the first array value in Range 'A&amp;r'\n    For counter = 1 To UBound(arr)              'adds a counter from 1 to UBound\n        Rows(r.Row + counter &amp; \":\" &amp; r.Row + counter).Insert Shift:=xlDown                  'inserts a new row\n        r.Offset(counter, 0) = arr(counter)      'puts each additional Array entry in a row added below (because location is tied to 'counter', the gap increases by one each loop)\n    Next counter\n    Erase arr                                                           'clears the array\n\n    Set r = ws.Range(\"b\" &amp; rownum)                  'sets range to current cell - Container column\n    arr = Split(r, \", \")                                              'fills array with each bill, removing the \", \"\n    r = arr(0)                                                            'puts the first array value in Range 'B&amp;r'\n    For counter = 1 To UBound(arr)\n        r.Offset(counter, 0) = arr(counter)         'puts each additional Array entry in a row added below (because location is tied to 'counter', the gap increases by one each loop)\n        ws.Range(r.Offset(counter, 1), r.Offset(counter, 12)).Value = ws.Range(r.Offset(counter - 1, 1), r.Offset(counter, 12)).Value 'fills all other report data down for columns C-N\n    Next counter\n    Erase arr            'clears the array\n\n    rownum = rownum + counter       'adds the counter value to the rownum value, so we don't look in the new lines we created\n\nNextRowLoop:                     'bookmark which links to the String1 / String2 IF argument\nLoop\n\n'###################################### - redefine lastrow (2 of 3 times we define)\n\nlastrow = ws.Range(\"a\" &amp; Rows.Count).End(xlUp).Row\n\n'###################################### - Delete rows, or recolour rows based on PGA Status Description\n\nx = 2\nDo Until x = lastrow + 1\n    If ws.Range(\"H\" &amp; x).Interior.Color = RGB(236, 110, 212) Then 'FInds rows already PURPLE\n        GoTo NextRowLoop2 'if row colour is purple, skip\n    ElseIf ws.Range(\"H\" &amp; x).Value = \"FDA - MAY PROCEED\" Or ws.Range(\"H\" &amp; x).Value = \"FDA - MAY PROCEED; APH - MAY PROCEED\" Or ws.Range(\"H\" &amp; x).Value = \"APH - MAY PROCEED; FDA - MAY PROCEED\" Then\n        ws.Range(\"A\" &amp; x &amp; \":N\" &amp; x).Interior.Color = RGB(129, 235, 111) 'sets rows with above criteria to GREEN\n    ElseIf Left(ws.Range(\"H\" &amp; x).Value, 20) = \"FDA - DATA UNDER PGA\" Then\n        ws.Range(\"A\" &amp; x &amp; \":N\" &amp; x).Interior.Color = RGB(255, 255, 0) 'sets rows with above criteria to YELLOW\n    ElseIf ws.Range(\"H\" &amp; x).Value = \"FDA - Hold Intact\" Then\n        ws.Range(\"A\" &amp; x &amp; \":N\" &amp; x).Interior.Color = RGB(255, 0, 0) 'sets rows with above criteria to RED\n    End If\nNextRowLoop2:\n    x = x + 1\nLoop\n\n'###################################### - sorts based on colour Purple &gt; Red &gt; Yellow &gt; Green\n\nWith ws.Sort\n    With .SortFields\n        .Clear\n        .Add(ws.Range(\"A2\"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(236, 110, 212)\n        .Add(ws.Range(\"A2\"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(129, 235, 111)\n        .Add(ws.Range(\"A2\"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(255, 255, 0)\n        .Add(ws.Range(\"A2\"), xlSortOnCellColor, xlAscending, , xlSortNormal).SortOnValue.Color = RGB(255, 0, 0)\n        .Add Key:=ws.Range(\"C2\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n    End With\n    .SetRange ws.Range(\"A1\").CurrentRegion\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n'###################################### - Reformatting for selected columns and autofits cells\nws.Range(\"C2:D\" &amp; lastrow, \"I2:J\" &amp; lastrow).NumberFormat = \"yyyy-mm-dd\" 'sets date format in date cells\nws.Range(\"E2:F\" &amp; lastrow).NumberFormat = \"General\" 'sets general format for Entry Port and Entry Number\nws.Columns(\"A:N\").AutoFit 'autofit columns\nws.Rows(\"1:\" &amp; lastrow).EntireRow.AutoFit 'autofit rows\n\n'###################################### - Creates a new workbook and moves just the output sheet\nSet outputwb = Workbooks.Add\nws.Copy Before:=outputwb.Sheets(1)\noutputwb.Sheets(\"Sheet1\").Delete\n\n'###################################### - Error Path - cleans the Macro workbook and promts user to fix Purple rows. Exit sub without saving file (needs manual saving)\nIf y &gt; 0 Then\n    Application.DisplayAlerts = True 'turns on alerts\n    Application.ScreenUpdating = True 'turns on screen updates\n\n    ws.Cells.ClearContents\n    ws.Cells.Interior.Color = xlNone\n\n    MsgBox \"Workbook has \" &amp; y &amp; \" lines where Number of Bills in Column A does not match Number of Containers in Column B. \" &amp; vbNewLine &amp; vbNewLine &amp; \"Rows still requiring rework are highlighted Purple, and comment added to Column M.\" _\n            &amp; vbNewLine &amp; vbNewLine &amp; \"All other rows have been processed\" &amp; vbNewLine &amp; vbNewLine &amp; \"Macro will now exit. Once reworked, please manually save.\"\n\n    Exit Sub\nEnd If\n\n'###################################### - Zero Error Path - cleans the Macro workbook\nws.Cells.ClearContents\nws.Cells.Interior.Color = xlNone\n\n'###################################### - 'Saves file based on the Time we're running it\n\nIf Time() &lt; TimeValue(\"13:29:00\") Then\n    timeslot = \"(Morning)\"\nElseIf Time() &lt; TimeValue(\"16:19:00\") Then\n    timeslot = \"(Midday)\"\nElse: timeslot = \"(Afternoon)\"\nEnd If\n\nshareddrive = \"X:\\HD Folders\\HD-FDA REPORTS\\DAILY FDA SHIPMENT REPORT\\\"\nsavename = \"DAILY FDA SHIPMENT REPORT \" &amp; Format(Now(), (\"mm.dd.yy\")) &amp; \" \" &amp; timeslot\noutputwb.SaveAs shareddrive &amp; savename &amp; \".xlsx\"\n\nApplication.DisplayAlerts = True 'turns on alerts\nApplication.ScreenUpdating = True 'turns on screen updates\n\nEnd Sub\n</code></pre>\n\n<p>Anyone able to save me?</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1543442295, "post_id": 53528721, "comment_id": 93926211, "body": "Sorry it&#39;s not a direct answer, but have you looked at the URL Yahoo returns when you do search for a stock?  <code>https:&#47;&#47;finance.yahoo.com&#47;quote&#47;AAPL</code> - why not just use <code>https:&#47;&#47;finance.yahoo.com&#47;quote&#47;</code> then just add the stock symbol you want to look up?"}, {"owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543442805, "post_id": 53528721, "comment_id": 93926383, "body": "I&#39;ve got exactly what you recommend to click search below but it doesn&#39;t click search...the code above only writes APPL in search box and leaves it there - no further action. IE.Document.forms(&quot;input&quot;).elements(&quot;search-button&quot;).Click"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543443089, "post_id": 53528721, "comment_id": 93926472, "body": "Hmm - that&#39;s odd.  I edited in a .gif of it working. Are you positive there&#39;s no other code running that may perhaps prevent it from loading?  What if you step through with <code>F8</code> (like I do in my example)?  EDIT: Ah! If I just run normally, it does the same. Fills in AAPL but no clicking. One second."}, {"owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543443670, "post_id": 53528721, "comment_id": 93926715, "body": "Agreed! Line by line works (F8) but not all in one go..."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543444009, "post_id": 53528721, "comment_id": 93926837, "body": "Okay, see my edited Answer."}, {"owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543446311, "post_id": 53528721, "comment_id": 93927540, "body": "Worked. Thanks a lot!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543451294, "post_id": 53528721, "comment_id": 93928715, "body": "Glad it worked! (You can mark it as the answer by clicking the check mark left of the post)"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 2, "last_activity_date": 1543443998, "last_edit_date": 1543443998, "creation_date": 1543442442, "answer_id": 53528763, "question_id": 53528721, "link": "https://stackoverflow.com/questions/53528721/how-do-i-click-the-search-button-in-yahoo-finance/53528763#53528763", "title": "How do I click the search button in Yahoo finance", "body": "<p>Okay, after testing, it looks like the issue is that Yahoo's page loads a <em>lot</em> of things.</p>\n\n<p>I added a ten second wait, before you add the Stock Symbol.  Play around with the timing, you can likely cut that down some.</p>\n\n<pre><code>Sub browsetosite() \n   Dim IE As New SHDocVw.InternetExplorer\n\n   IE.Visible = True\n   IE.navigate \"www.finance.yahoo.com\"\n\n   Do While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n   Loop\n   Application.Wait (Now + TimeValue(\"00:00:10\"))\n   IE.Document.forms(\"input\").elements(\"yfin-usr-qry\").Value = \"APPL\"\n   IE.Document.forms(\"input\").elements(\"search-button\").Focus\n   IE.Document.forms(\"input\").elements(\"search-button\").Click\nEnd Sub\n</code></pre>\n\n<p>But, as mentioned above, if you know the symbols you want to lookup, you would likely be better off instead just navigating directly to <code>https://finance.yahoo.com/quote/[SYMBOL]</code></p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1557406677, "post_id": 53539477, "comment_id": 98760300, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1543495826, "creation_date": 1543495826, "answer_id": 53539477, "question_id": 53528721, "link": "https://stackoverflow.com/questions/53528721/how-do-i-click-the-search-button-in-yahoo-finance/53539477#53539477", "title": "How do I click the search button in Yahoo finance", "body": "<p>I didn't find a requirement for any waiting or focus. Use IDs to target where possible as much faster and CSS selectors are much quicker than your current syntax. </p>\n\n<pre><code>Option Explicit\nPublic Sub BrowseToSite()\n    Dim IE As SHDocVw.InternetExplorer\n    Set IE = New SHDocVw.InternetExplorer\n    With IE\n        .Visible = True\n        .Navigate2 \"www.finance.yahoo.com\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"[name='yfin-usr-qry']\").Value = \"APPL\"\n            .querySelector(\"#search-button\").Click\n        End With\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 8958702, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/fdea540cc968d87f407c3e059637035b?s=128&d=identicon&r=PG&f=1", "display_name": "user8958702", "link": "https://stackoverflow.com/users/8958702/user8958702"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 53528763, "answer_count": 2, "score": 1, "last_activity_date": 1582335081, "creation_date": 1543442158, "last_edit_date": 1582335081, "question_id": 53528721, "link": "https://stackoverflow.com/questions/53528721/how-do-i-click-the-search-button-in-yahoo-finance", "title": "How do I click the search button in Yahoo finance", "body": "<p>I'm trying to simplify a spreadsheet and would like your help. I've got the following code where I search for APPL stock in Yahoo finance. How do I hit the click button? I believe the issue I have is \"search-button\" in last line of the code.</p>\n\n<pre><code>Sub browsetosite()\n\n    Dim IE As New SHDocVw.InternetExplorer\n\n    IE.Visible = True\n    IE.navigate \"www.finance.yahoo.com\"\n\n    Do While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    Loop\n    Debug.Print IE.LocationName, IE.LocationURL\n\n   IE.Document.forms(\"input\").elements(\"yfin-usr-qry\").Value = \"APPL\"\n   IE.Document.forms(\"input\").elements(\"**search-button**\").Click\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 2, "creation_date": 1543441672, "post_id": 53528513, "comment_id": 93925956, "body": "You try to open a workbook, ignore errors if that fails, and then proceed wordking on that workbook. That will of course fail, since it couldn&#39;t be opened! You need to catch the error, and then do something else. <code>If Err.Number &lt;&gt; 0 Then &#39;do something else</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1543441926, "post_id": 53528513, "comment_id": 93926053, "body": "Note that if you have an error when opening the file, the line <code>ActiveWorkbook.RemoveDocumentInformation (xlRDIAll)</code> will run <b>regardless</b>, and will be on that Activeworkbook.  You might want to switch that to <code>wb.RemoveDocumentInformation(...)</code>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 3, "creation_date": 1543442236, "post_id": 53528513, "comment_id": 93926179, "body": "@MichalRosa &quot;your code is correct&quot; - I beg to differ. <code>RemoveDocumentInformation</code> should run against <code>wb</code>, not <code>ActiveWorkbook</code>. And <code>On Error Resume Next</code> isn&#39;t proper error handling. &quot;Correct&quot; code doesn&#39;t merrily run in an unknown error state and happily report &quot;complete&quot; when everything caught fire. The hard-coded path is also a problem, <code>i</code> being <code>Variant</code> is highly questionable, <code>xlRDIAll</code> is forced-passed <code>ByVal</code> for no reason whatsoever, <code>Dir()</code> doesn&#39;t need the redundant parentheses, and the procedure name could be more meaningful, <code>PascalCase</code>, and explicitly <code>Public</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "edited": false, "score": 3, "creation_date": 1543442915, "post_id": 53528513, "comment_id": 93926411, "body": "@MichalRosa - The existence of a file does not mean that Excel can open it. Also, <i>anything</i> that hits the file system should be expected to be able to fail, because the code that&#39;s running is not the only IO consumer.  It&#39;s completely feasible that some other process deletes the file between the <code>Dir</code> call and the <code>Workbooks.Open</code> call."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1543446714, "post_id": 53528513, "comment_id": 93927637, "body": "An easy way to tell if Excel fails to open the file is to check if the <code>wb Is Nothing</code> after trying to open it."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543449648, "post_id": 53528513, "comment_id": 93928374, "body": "Very thorough answer to your &quot;update links&quot; problem - <a href=\"https://stackoverflow.com/questions/14908372/how-to-suppress-update-links-warning\" title=\"how to suppress update links warning\">stackoverflow.com/questions/14908372/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "edited": false, "score": 0, "creation_date": 1543451685, "post_id": 53529963, "comment_id": 93928802, "body": "Thank you very much. This was very helpful! Testing code you provided now and it looks to be working great"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 5, "last_activity_date": 1543449751, "creation_date": 1543449751, "answer_id": 53529963, "question_id": 53528513, "link": "https://stackoverflow.com/questions/53528513/vba-error-handling-when-trying-to-open-workbook/53529963#53529963", "title": "VBA Error Handling when trying to open Workbook", "body": "<p>OK, so there are a couple questions here. First, regarding the error handling. When you're using inline error handling (<code>On Error Resume Next</code>), the basic pattern is to turn off the automatic error handling, run the line of code that you want to \"catch\" the error for, then test to see if the <code>Err.Number</code> is zero:</p>\n\n<pre><code>On Error Resume Next\nProcedureThatCanError\nIf Err.Number &lt;&gt; 0 Then\n    'handle it.\nEnd If\nOn Error GoTo 0\n</code></pre>\n\n<hr>\n\n<p>The rest of the questions deal with dialogs you can encounter when you're opening workbooks. Most of this is documented on the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbooks.open\" rel=\"noreferrer\">MSDN page</a> for <code>Workbook.Open</code>, but you'll want to change the <code>Application.AutomationSecurity</code> property to deal with the macro prompts as appropriate. For the updates, you should pass the appropriate <code>UpdateLinks</code> parameter. I'd also recommend specifying <code>IgnoreReadOnlyRecommended</code>, <code>Notify</code>, and <code>CorruptLoad</code>. Something like this should work (untested), or at least get you a lot closer:</p>\n\n<hr>\n\n<pre><code>Sub TestScrubberNew() 'Underscores should be avoided in method names.\n\n    Dim directory As String, fileName As String, i As Variant, wb As Workbook\n    Application.DisplayAlerts = False\n    Application.ScreenUpdating = False\n\n    Dim security As MsoAutomationSecurity\n    security = Application.AutomationSecurity\n    Application.AutomationSecurity = msoAutomationSecurityForceDisable\n\n    directory = \"C:\\Users\\bayli\\Desktop\\excel files\\\"\n    fileName = Dir(directory &amp; \"*.xl??\")\n\n    i = 0\n    Do While fileName &lt;&gt; vbNullString\n        On Error Resume Next\n        Set wb = Workbooks.Open(fileName:=directory &amp; fileName, _\n                                UpdateLinks:=0, _\n                                IgnoreReadOnlyRecommended:=True, _\n                                Notify:=False, _\n                                CorruptLoad:=xlNormalLoad)\n        If Err.Number = 0 And Not wb Is Nothing Then\n            On Error GoTo 0\n            wb.RemoveDocumentInformation xlRDIAll\n            wb.Close True\n            i = i + 1\n            Application.StatusBar = \"Files Completed:  \" &amp; i\n            fileName = Dir()\n        Else\n            Err.Clear\n            On Error GoTo 0\n            'Handle (maybe log?) file that didn't open.\n        End If\n    Loop\n\n    Application.AutomationSecurity = security\n    Application.StatusBar = False\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    MsgBox \"Complete\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7775322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07da68c816c5ef0f3e024861484aa32c?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/7775322/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17634, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1582371957, "creation_date": 1543441093, "last_edit_date": 1582371957, "question_id": 53528513, "link": "https://stackoverflow.com/questions/53528513/vba-error-handling-when-trying-to-open-workbook", "title": "VBA Error Handling when trying to open Workbook", "body": "<p>I am trying to loop through all files in a folder, open them and remove document info. I am having trouble dealing with files that cannot be opened or when opened have a pop us regarding disabling macros. I tried to solve this using on error resume next and on error goto 0. But then I get a runtime failure because my workbook object (wb) has not been set when I was trying to close files that did open.</p>\n\n<p>I have read the documentation on \"On Error Resume Next\" &amp; \"On error goto 0\" but I do not believe I am using them correctly here.\nAny help is greatly appreciated, Thanks.</p>\n\n<pre><code>Option Explicit\nSub test_Scrubber_New()\n\nDim directory As String, fileName As String, i As Variant, wb As Workbook\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\n'directory = \"C:\\Users\\bayli\\Desktop\\Files for Testing\\\"\ndirectory = \"C:\\Users\\bayli\\Desktop\\excel files\\\"\nfileName = Dir(directory &amp; \"*.xl??\")\n\ni = 0\nDo While fileName &lt;&gt; \"\"\n    On Error Resume Next\n    Set wb = Workbooks.Open(directory &amp; fileName)\n    On Error GoTo 0\n        'remove info\n        ActiveWorkbook.RemoveDocumentInformation (xlRDIAll)\n    wb.Close True\n    i = i + 1\n    fileName = Dir()\n    Application.StatusBar = \"Files Completed:  \" &amp; i\nLoop\n\nApplication.StatusBar = False\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nMsgBox \"Complete\"\n\nEnd Sub\n</code></pre>\n\n<p>I updated my code to include: If Not wb Is Nothing Then remove the info  as @PatricK suggested and it is working however it keeps stopping with a pop up about updating links. If I click \"Do not update\" my code continues working as needed but is there a way to handle this problem. I am looping through over 5k files so as you can imagine it is taking a while. The time it is taking is not a problem but currently I am sitting here having to click \"dont update\" quite a few times. I thought Application.DisplayAlerts = False would prevent these pop ups however it is not.</p>\n"}, {"tags": ["excel", "vba", "pdf", "save-as"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1543440939, "post_id": 53528435, "comment_id": 93925671, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/33411063/select-folder-for-save-location\">Select folder for save location</a>"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1543443578, "post_id": 53528435, "comment_id": 93926675, "body": "I am going to roll back your question to the previous state, because your edit was due to the other answer and it somewhat invalidates your accepted answer. Just to let you know why I am doing it."}, {"owner": {"reputation": 149, "user_id": 2441245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/597c2fb23331c21662e5c22674ced342?s=128&d=identicon&r=PG", "display_name": "GoldFusion", "link": "https://stackoverflow.com/users/2441245/goldfusion"}, "edited": false, "score": 0, "creation_date": 1543444237, "post_id": 53528435, "comment_id": 93926911, "body": "understood and thanks"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 10322290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0de4dd1451a59ba27ce1a72087af6c9?s=128&d=identicon&r=PG", "display_name": "Professor Pantsless", "link": "https://stackoverflow.com/users/10322290/professor-pantsless"}, "is_accepted": false, "score": 2, "last_activity_date": 1543441075, "creation_date": 1543441075, "answer_id": 53528508, "question_id": 53528435, "link": "https://stackoverflow.com/questions/53528435/allow-user-to-choose-the-save-file-path-for-print-pdf/53528508#53528508", "title": "Allow user to choose the save file path for &quot;print PDF&quot;", "body": "<p>Use the <code>Application.GetSaveAsFilename</code> method. Use the returned value as the <code>Filename</code> attribute, but check to make sure it is not <code>False</code> before saving.</p>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 2, "last_activity_date": 1543442076, "creation_date": 1543442076, "answer_id": 53528710, "question_id": 53528435, "link": "https://stackoverflow.com/questions/53528435/allow-user-to-choose-the-save-file-path-for-print-pdf/53528710#53528710", "title": "Allow user to choose the save file path for &quot;print PDF&quot;", "body": "<p>Another method you can use is the <code>Application.FileDialog()</code> method. You will be able to set a default save location and even a default file name if you'd like.</p>\n\n<pre><code>Dim fileSave As FileDialog\nSet fileSave = Application.FileDialog(msoFileDialogSaveAs)\n\nWith fileSave\n    ' Your default save location here\n    .InitialFileName = \"C:\\Users\\sravi\\*.pdf\"\n\n    If .Show = -1 Then\n\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=.SelectedItems(1), _\n                Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n                IgnorePrintAreas:=False, openafterpublish:=True\n\n    End If\nEnd With\n</code></pre>\n\n<h1>Breaking it down</h1>\n\n<p>You can set the default save path using the <code>.InitialFileName</code> property. If you have a default file name, you can use that. Otherwise, set the default file type using <code>*.pdf</code></p>\n\n<pre><code>.InitialFileName = \"C:\\Users\\sravi\\*.pdf\"\n</code></pre>\n\n<p>The following line serves two purposes:</p>\n\n<ol>\n<li><p>Shows the dialog box with <code>.Show</code></p></li>\n<li><p>Ensures that the user accepted a save location with <code>.Show = -1</code></p></li>\n</ol>\n\n<p></p>\n\n<pre><code>If .Show = -1 Then\n</code></pre>\n\n<p>Then finally, you would return your file path to the method you're using with this line:</p>\n\n<pre><code>Filename:=.SelectedItems(1)\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 2441245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/597c2fb23331c21662e5c22674ced342?s=128&d=identicon&r=PG", "display_name": "GoldFusion", "link": "https://stackoverflow.com/users/2441245/goldfusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 53528710, "answer_count": 2, "score": 2, "last_activity_date": 1582371942, "creation_date": 1543440712, "last_edit_date": 1582371942, "question_id": 53528435, "link": "https://stackoverflow.com/questions/53528435/allow-user-to-choose-the-save-file-path-for-print-pdf", "title": "Allow user to choose the save file path for &quot;print PDF&quot;", "body": "<p>I have a commandbutton on the Excel file that allows the user to automate the \"Print PDF\" feature with a click. The issue being, at the moment I can only save the file to the specified location within the code. I want to let the user choose their save directory similar to the actual saving feature.</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Private Sub PrintPDF_Button_Click()\n\n    Dim mySheets As Variant, sh\n\n    mySheets = Array(\"COVER\", \"SCOPE\", \"SUMMARY\", \"Updated Hours EST\", \"RATES\")\n\n    Sheets(mySheets).Select\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"C:\\Users\\sravi\\test\" &amp; _\n        \".pdf\", Quality:=xlQualityStandard, IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, openafterpublish:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1543440787, "post_id": 53528434, "comment_id": 93925616, "body": "Well one thing, you have toggled off <code>ScreenUpdating</code> so maybe it is running."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1543440990, "post_id": 53528434, "comment_id": 93925697, "body": "<code>Application.ScreenUpdating = False</code> should really be toggled back to <code>True</code>"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543441054, "post_id": 53528434, "comment_id": 93925727, "body": "After declaring your variables, I was able to step through the code from start to end. Do you have a <code>Worksheet_Change</code> event on <code>Sheet1</code> by any chance?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543441101, "post_id": 53528434, "comment_id": 93925745, "body": "Does the code error out? What happens when you step through? Does it jump right to <code>End Sub</code>? Does it step to a line in a different sub/module?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543450878, "post_id": 53528434, "comment_id": 93928616, "body": "The calls to <code>.Activate</code> should be completely unnecessary - does it continue if you comment out the <code>.Clear</code> call?"}, {"owner": {"reputation": 9, "user_id": 7789531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3bc13cbfb1911a7c66c224d2f3107?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Power", "link": "https://stackoverflow.com/users/7789531/michael-power"}, "edited": false, "score": 0, "creation_date": 1543530168, "post_id": 53528434, "comment_id": 93963549, "body": "The debugger stopped running entirely after I stepped through the .Clear call so screen updating wouldn&#39;t affect it."}, {"owner": {"reputation": 9, "user_id": 7789531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3bc13cbfb1911a7c66c224d2f3107?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Power", "link": "https://stackoverflow.com/users/7789531/michael-power"}, "edited": false, "score": 0, "creation_date": 1543530393, "post_id": 53528434, "comment_id": 93963644, "body": "Code just stops running no error message no step to another line"}, {"owner": {"reputation": 9, "user_id": 7789531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3bc13cbfb1911a7c66c224d2f3107?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Power", "link": "https://stackoverflow.com/users/7789531/michael-power"}, "edited": false, "score": 0, "creation_date": 1543530603, "post_id": 53528434, "comment_id": 93963743, "body": "There is a worksheet selection event on sheets(&quot;formula&quot;) but my code doesn&#39;t touch that sheet"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1543535373, "post_id": 53528434, "comment_id": 93965094, "body": "Let&#39;s start with the &quot;Silly questions&quot;:  Do you actually have a sheet named &quot;Sheet 1&quot;?  Is the range you are clearing protected? Is the sheet protected?  Here&#39;s a &quot;less silly&quot; question:   Have you used &quot;Application.DisplayAlerts = False&quot; in any other places and not turned it back on (this could cause messages critical to this error to not be displayed)?"}, {"owner": {"reputation": 9, "user_id": 7789531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3bc13cbfb1911a7c66c224d2f3107?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Power", "link": "https://stackoverflow.com/users/7789531/michael-power"}, "edited": false, "score": 0, "creation_date": 1543623804, "post_id": 53528434, "comment_id": 93999006, "body": "I have not suppressed the alerts. The obvious culprits you mentioned are all fine. The weirdest part is that even when it fails to execute, it clears the range first"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1551999406, "post_id": 53528434, "comment_id": 96857769, "body": "This code is not the problem. Check for office updates. Then copy just this code to a new workbook for testing."}, {"owner": {"reputation": 9, "user_id": 7789531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3bc13cbfb1911a7c66c224d2f3107?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Power", "link": "https://stackoverflow.com/users/7789531/michael-power"}, "edited": false, "score": 0, "creation_date": 1552572101, "post_id": 53528434, "comment_id": 97068029, "body": "That seems to have worked. Since the error didn&#39;t occur every time in the past, it is hard to know for sure but I haven&#39;t run into it since."}], "owner": {"reputation": 9, "user_id": 7789531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8b3bc13cbfb1911a7c66c224d2f3107?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Power", "link": "https://stackoverflow.com/users/7789531/michael-power"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1582483487, "creation_date": 1543440709, "last_edit_date": 1582483487, "question_id": 53528434, "link": "https://stackoverflow.com/questions/53528434/using-excel-2010-vba-a-sub-was-just-not-running-after-the-line-sheetssheet1", "title": "Using excel 2010 VBA, a sub was just not running after the line: Sheets(&quot;Sheet1&quot;).Range(&quot;A4:AL60&quot;).Clear. Can this be fixed?", "body": "<p>publicColumn is declared in the module as</p>\n\n<pre><code>Public publicColumn As Range\n</code></pre>\n\n<p>The full sub was:</p>\n\n<pre><code>Sub DoAll()\n    'Stop\n    Sheets(\"Sheet1\").Range(\"A4:AL60\").Clear\n    If Sheets(\"Model\").Range(\"E1\") = \"KG\" Then\n        Set publicColumn = Sheets(\"Model\").Range(\"H7\")\n    Else\n        Set publicColumn = Sheets(\"Model\").Range(\"H6\")\n    End If\n    Application.ScreenUpdating = False\n    AddFlavors.Show\n    Sheets(\"Model\").Activate\nEnd Sub\n</code></pre>\n\n<p>I was able to get this to work by changing to the following:</p>\n\n<pre><code>Sub DoAll()\n    'Stop\n    Sheets(\"Sheet1\").Activate\n    Sheets(\"Sheet1\").Range(\"A4:AL60\").Clear\n    Sheets(\"Model\").Activate\n    If Sheets(\"Model\").Range(\"E1\") = \"KG\" Then\n        Set publicColumn = Sheets(\"Model\").Range(\"H7\")\n    Else\n        Set publicColumn = Sheets(\"Model\").Range(\"H6\")\n    End If\n    Application.ScreenUpdating = False\n    AddFlavors.Show\n    Sheets(\"Model\").Activate\nEnd Sub\n</code></pre>\n\n<p>Why would this just exit the sub/stop executing? Was it something wrong with my code?</p>\n\n<p>It was being run via a button on Sheet(\"Model\") but I also tried running it through the step through debugger which is how I found where it was exiting.</p>\n\n<hr>\n\n<p>Edit: The adjustments don't seem have fixed anything. I know since I can't specifically repeat the conditions in which the code fails it becomes very difficult to debug. If anyone has ideas as to what is causing this let me know.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1543437421, "post_id": 53527623, "comment_id": 93924168, "body": "<i>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</i> This is a site where programmers <i>write their own code</i> and share a <b><i>specific</i> problem</b> after trying to solve it on their own. Be sure to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn your 1st badge!) and see &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;, and also the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a> for more information about what&#39;s on topic on this site.  If you have a <i>specific</i> problem with a certain section of your code, you can <a href=\"https://stackoverflow.com/posts/53527623/edit\">edit</a> your post to share an <b><a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a></b> as well as sample data and some background info.  Here are some  <a href=\"//codeblog.jonskeet.uk/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">tips</a> from the site&#39;s top user."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1543440272, "post_id": 53527623, "comment_id": 93925416, "body": "Rats! The version of LendingLibrary I have uses macros. Did you convert to VBA? The variable must be declared global in a general module if you want to reference from various modules. Then setting it by code behind the Asset Details form would be simply: <code>SomeVariableName = Me.Category</code>. Don&#39;t use reserved words as names - <code>text</code> is a reserved word."}, {"owner": {"reputation": 13, "user_id": 10719220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c613605556e856ae7577fddd0c4ef2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Nai", "link": "https://stackoverflow.com/users/10719220/nai"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1543440777, "post_id": 53527623, "comment_id": 93925613, "body": "@June7 Yes, I converted to VBA because to be honest, I don&#39;t really understand how to control what macros do. I&#39;ll update the post to show what my code now looks like - but doing the Me.Category now generates a &quot;Object Required&quot; error."}, {"owner": {"reputation": 13, "user_id": 10719220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c613605556e856ae7577fddd0c4ef2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Nai", "link": "https://stackoverflow.com/users/10719220/nai"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1543441840, "post_id": 53527623, "comment_id": 93926022, "body": "@June7 UPDATE - Just realized I&#39;d put a . in the middle of Msgbox for some reason. The Me.Category code works. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": true, "score": 0, "last_activity_date": 1543442534, "creation_date": 1543442534, "answer_id": 53528787, "question_id": 53527623, "link": "https://stackoverflow.com/questions/53527623/ms-access-library-template-reference-category-value-in-vba/53528787#53528787", "title": "MS Access Library Template - Reference Category Value in VBA", "body": "<p>The variable must be declared global in a general module if you want to reference from various modules. Then setting it by code behind the Asset Details form would be simply: <code>SomeVariableName = Me.Category</code>. </p>\n\n<p>Don't use reserved words as names - text is a reserved word.</p>\n"}], "owner": {"reputation": 13, "user_id": 10719220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c613605556e856ae7577fddd0c4ef2f0?s=128&d=identicon&r=PG&f=1", "display_name": "Nai", "link": "https://stackoverflow.com/users/10719220/nai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53528787, "answer_count": 1, "score": 0, "last_activity_date": 1543442534, "creation_date": 1543437116, "last_edit_date": 1543441078, "question_id": 53527623, "link": "https://stackoverflow.com/questions/53527623/ms-access-library-template-reference-category-value-in-vba", "title": "MS Access Library Template - Reference Category Value in VBA", "body": "<p>Completely new to MS Access - I'm trying to do a simple modification to the MS Access Lending Library template using VBA. </p>\n\n<p>Going into the Asset List form and clicking New Asset pops up the Asset Details form, where I can click the Save and New button. This calls the VBA code cmdSaveandNew_Click(). </p>\n\n<p>My question is, within this VBA method, how do I reference the values of the fields in the Asset Details form - For example getting the value that the user entered in the Category field and storing it in a variable. </p>\n\n<p>I've tried several strings of code to try to get the value back, but I keep getting various errors, saying it can't find the referenced form, or Object Required, or this method is supported. I think it's likely just that I don't fully understand the structure of what I'm trying to reference or the syntax for specifying how to reference it. </p>\n\n<p>Right now (after I've been trying many different combinations of things, I have:<br>\n<code>text = Forms![Asset List].[Asset Details].Form.Category</code></p>\n\n<p>which is giving me the \"can't find the field '|1' referred to in your expression\" error. </p>\n\n<p>Edit - code currently looks like this: </p>\n\n<pre><code>Private Sub cmdSaveandNew_Click()\n'On Error GoTo cmdSaveandNew_Click_Err\n\nDim someVar As String\nDim num As Integer\nDim objtf\n'objtf = Forms![Asset List].[Asset Details].Form.Category\nobjtf = Me.Category\n'num = Form.Controls.Count\nMsg.Box (TypeName(objtf))\n\nsomeVar = InputBox(\"How many?\")\n\n\n\nOn Error Resume Next\nIf (Form.Dirty) Then\n    DoCmd.RunCommand acCmdSaveRecord\nEnd If\nIf (MacroError.Number &lt;&gt; 0) Then\n    Beep\n    MsgBox MacroError.Description, vbOKOnly, \"\"\n    Exit Sub\nEnd If\nOn Error GoTo 0\nDoCmd.GoToRecord , \"\", acNewRec\nDoCmd.GoToControl \"Item\"\n\n\nMsgBox someVar\n\n\ncmdSaveandNew_Click_Exit:\n    Exit Sub\n\ncmdSaveandNew_Click_Err:\n    MsgBox Error$\n    Resume cmdSaveandNew_Click_Exit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543435447, "post_id": 53527064, "comment_id": 93923310, "body": "Are you adding new columns then?"}, {"owner": {"reputation": 73, "user_id": 5661463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpY05.jpg?s=128&g=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/5661463/roy"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543439329, "post_id": 53527064, "comment_id": 93925008, "body": "Yes, I need to be adding new columns at the end of the table each time."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5661463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpY05.jpg?s=128&g=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/5661463/roy"}, "edited": false, "score": 0, "creation_date": 1543528235, "post_id": 53528600, "comment_id": 93962812, "body": "That worked perfectly! What code could I add to always copy a cell with data on top of the column headers? I&#180;m stuck at {Range(&quot;H2:H3&quot;).Select Selection.Copy}, I don&#180;t know how to paste it on top on the first copied column header."}, {"owner": {"reputation": 73, "user_id": 5661463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpY05.jpg?s=128&g=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/5661463/roy"}, "edited": false, "score": 0, "creation_date": 1543589496, "post_id": 53528600, "comment_id": 93985046, "body": "After messing up for a while this worked for me: Sub CopyPaste2LastCol()  Dim myList As ListObject Dim rng As Range Dim myListCols As Long  Dim lastRow As String Dim lastCol As String  Set myList = ActiveSheet.ListObjects(&quot;table_survey&quot;) myListCols = myList.Range.Columns.Count  Set rng = Range(&quot;table_survey[#All]&quot;).Resize(, myListCols + 4) myList.Resize rng  myList.ListColumns(myListCols - 3).Range.Resize(, 4).Copy myList.ListColumns(myListCols + 1).Range  Range(&quot;$M12:$M13&quot;).Select Selection.Copy  Cells(12, myListCols + 2).Select ActiveSheet.Paste      End Sub"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1543441536, "creation_date": 1543441536, "answer_id": 53528600, "question_id": 53527064, "link": "https://stackoverflow.com/questions/53527064/copy-and-paste-selected-columns-to-end-of-table-in-excel-with-vba/53528600#53528600", "title": "Copy and Paste Selected Columns to End of Table in Excel with VBA", "body": "<p>If you always want to copy just the last 4 columns, try this. Adjust table name as necessary.</p>\n\n<pre><code>Sub CopySelectionVisibleRowsEnd()\n\nDim myList As ListObject\nDim rng As Range\nDim myListCols As Long\n\nSet myList = ActiveSheet.ListObjects(\"Table1\")\nmyListCols = myList.Range.Columns.Count\nSet rng = Range(\"Table1[#All]\").Resize(, myListCols + 4)\nmyList.Resize rng\n\nmyList.ListColumns(myListCols - 3).Range.Resize(, 4).Copy myList.ListColumns(myListCols + 1).Range\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5661463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpY05.jpg?s=128&g=1", "display_name": "Roy", "link": "https://stackoverflow.com/users/5661463/roy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1931, "favorite_count": 0, "accepted_answer_id": 53528600, "answer_count": 1, "score": 0, "last_activity_date": 1543441536, "creation_date": 1543434606, "last_edit_date": 1543440577, "question_id": 53527064, "link": "https://stackoverflow.com/questions/53527064/copy-and-paste-selected-columns-to-end-of-table-in-excel-with-vba", "title": "Copy and Paste Selected Columns to End of Table in Excel with VBA", "body": "<p>Within the same worksheet I have a single table, and each time I add new data I need to copy the last 4 columns of this table to the right end of that same table so I can add new data. The main reason being I always want to keep the same format and some columns have dropdown lists and formulas.</p>\n\n<p>I found the next code in the website below. It works really well for copy/pasting \nrows, so I tried to modify the code to do it for columns but I couldn\u00b4t manage. </p>\n\n<p>I\u00b4m new to VBA and just starting to learn how to program macros, so any feedback on what I could do would be appreciated.</p>\n\n<p><a href=\"https://www.contextures.com/exceltablemacrocopyitems.html\" rel=\"nofollow noreferrer\">https://www.contextures.com/exceltablemacrocopyitems.html</a></p>\n\n<pre><code>Sub CopySelectionVisibleRowsEnd()\nDim ws As Worksheet\nDim mySel As Range\nDim lRow As Long\nDim lRowNew As Long\nDim lRowsAdd As Long\nDim myList As ListObject\nDim myListRows As Long\nDim myListCols As Long\n\nSet ws = ActiveSheet\nSet mySel = Selection.EntireRow\nSet myList = ActiveCell.ListObject\nmyListRows = myList.Range.Rows.Count\nmyListCols = myList.Range.Columns.Count\nlRow = ws.Cells.Find(What:=\"*\", _\n        SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, _\n        LookIn:=xlValues).Row + 1\n\nmySel.SpecialCells(xlCellTypeVisible).Copy\nws.Cells(lRow, 1).PasteSpecial Paste:=xlPasteAll\n\nlRowNew = ws.Cells.Find(What:=\"*\", _\n        SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, _\n        LookIn:=xlValues).Row + 1\nlRowsAdd = lRowNew - lRow\n\nWith myList\n    .Resize ws.Range(.Range.Resize(myListRows + lRowsAdd, myListCols).Address)\nEnd With\n\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1543434719, "post_id": 53527016, "comment_id": 93922987, "body": "Have you tried changing <code>ActiveWorkbook</code> to <code>ThisWorkbook</code>?"}, {"owner": {"reputation": 785, "user_id": 185084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9610436378d81a8b6d176905598b4b?s=128&d=identicon&r=PG", "display_name": "DoStuffZ", "link": "https://stackoverflow.com/users/185084/dostuffz"}, "reply_to_user": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1543434793, "post_id": 53527016, "comment_id": 93923016, "body": "Noted, that didn&#39;t come up in my research."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1543435664, "post_id": 53527016, "comment_id": 93923411, "body": "If you have an error handler, it would be useful to know if the code execution just fell into it, or it got there because there was an error.  Typically you&#39;d Exit Sub before the error handler, and reserve the code in that block for when there&#39;s actually a problem."}, {"owner": {"reputation": 785, "user_id": 185084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9610436378d81a8b6d176905598b4b?s=128&d=identicon&r=PG", "display_name": "DoStuffZ", "link": "https://stackoverflow.com/users/185084/dostuffz"}, "edited": false, "score": 0, "creation_date": 1543436394, "post_id": 53527016, "comment_id": 93923736, "body": "For all the ErrHandlers I found, it is the last thing that happens, used both to catch and handle error and also reset such things as EnableEvents."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1543437982, "post_id": 53527016, "comment_id": 93924421, "body": "Since it&#39;s crashing after <code>EnableEvents = yes</code>, that implies that there is an event with a coding problem.  In my experience crashes are almost always caused by mishandled objects.  It&#39;s a pain to troubleshoot someone else&#39;s work but I&#39;d suggest you start by making sure <code>Option Explicit</code> is the first line in every module, and then compile. This will raise an error with undeclared or mis-referenced variables/object/properties/etc. Also, why automatically re-enable events after a save error instead of finding the cause?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543438020, "post_id": 53527016, "comment_id": 93924450, "body": "If your code has errors then typically you want to know about it.  So I&#39;d suggest exiting before the error handler and doing clean-up such as re-enabling events) in the &quot;regular&quot; code.  Then put a Msgbox in your error handler so you know something isn&#39;t working as expected.   Why are error handlers disabled to begin with?  That would be a good place to begin."}, {"owner": {"reputation": 785, "user_id": 185084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9610436378d81a8b6d176905598b4b?s=128&d=identicon&r=PG", "display_name": "DoStuffZ", "link": "https://stackoverflow.com/users/185084/dostuffz"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1543438453, "post_id": 53527016, "comment_id": 93924635, "body": "@ashleedawg Option Explicit is in there. I have gone through the attributes."}, {"owner": {"reputation": 785, "user_id": 185084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9610436378d81a8b6d176905598b4b?s=128&d=identicon&r=PG", "display_name": "DoStuffZ", "link": "https://stackoverflow.com/users/185084/dostuffz"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543438465, "post_id": 53527016, "comment_id": 93924643, "body": "@Tim Williams It goes through the entire code, it does save, after the final line in the errHandler it crashes. There are no errors before that point. It just moves naturally into the ErrHandlers and resets the code.  The code does what is required, it just crashes after it completes 100% success rate."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543451188, "post_id": 53527016, "comment_id": 93928690, "body": "Is anything being written to the Windows event logs? If I understand what you mean by &quot;crashes&quot; correctly, you should be getting App crash events."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1543454258, "post_id": 53527016, "comment_id": 93929371, "body": "<code>If fileSaveName  False Then</code> won&#39;t compile. Try <code>If fileSaveName  = False Then</code>"}, {"owner": {"reputation": 785, "user_id": 185084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9610436378d81a8b6d176905598b4b?s=128&d=identicon&r=PG", "display_name": "DoStuffZ", "link": "https://stackoverflow.com/users/185084/dostuffz"}, "edited": false, "score": 0, "creation_date": 1543509160, "post_id": 53527016, "comment_id": 93953886, "body": "As I got into the project again, I went over the suggestions. Active vs Thisworkbook, no difference. Option explicit on everything, a few things changed. Found some entries in the Eventlog, an error 1000 and few apps tested (one could look like like those &#39;MS&#39; &#39;Windows&#39; Support call thingies). I worked once (maybe), then it went back to crashing. It said Excel and MSO.dll were crashing. An app I trust and use regularly didn&#39;t find anything wrong. Also I tested it on another PC, same result.  Some good news, and back at crashing.  Also thank you for bonking me over the head, I needed it."}, {"owner": {"reputation": 847, "user_id": 1827488, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b504f72af34abbdc5bcdd8f15527c07a?s=128&d=identicon&r=PG", "display_name": "rockhammer", "link": "https://stackoverflow.com/users/1827488/rockhammer"}, "edited": false, "score": 0, "creation_date": 1571253513, "post_id": 53527016, "comment_id": 103182817, "body": "@DoStuffZ I have identical problem crashing at <code>ActiveWorkbook.SaveAs Filename:=file_name,             FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False, ReadOnlyRecommended:=False</code>. Bizzarely, this macro works (no crashes) in Excel 365/Win 10 and initially worked when I started using it on Excel 2010/Win 7. But now it crashes everytime on Excel 2010/Win 7"}, {"owner": {"reputation": 785, "user_id": 185084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9610436378d81a8b6d176905598b4b?s=128&d=identicon&r=PG", "display_name": "DoStuffZ", "link": "https://stackoverflow.com/users/185084/dostuffz"}, "reply_to_user": {"reputation": 847, "user_id": 1827488, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/b504f72af34abbdc5bcdd8f15527c07a?s=128&d=identicon&r=PG", "display_name": "rockhammer", "link": "https://stackoverflow.com/users/1827488/rockhammer"}, "edited": false, "score": 0, "creation_date": 1571301419, "post_id": 53527016, "comment_id": 103197626, "body": "@rockhammer My contract with the company has ended. In the end the solution was abandoned, and is now done manually. I would expect the solution to work/crash by each iteration/version of Office 365/2010, pending updates and Q&amp;A. Last I heard they bugged the $A$1 locks, might be fixed again."}], "owner": {"reputation": 785, "user_id": 185084, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ab9610436378d81a8b6d176905598b4b?s=128&d=identicon&r=PG", "display_name": "DoStuffZ", "link": "https://stackoverflow.com/users/185084/dostuffz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 770, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1582487854, "creation_date": 1543434402, "last_edit_date": 1582487854, "question_id": 53527016, "link": "https://stackoverflow.com/questions/53527016/excel-crashes-after-saveas", "title": "Excel crashes after SaveAs", "body": "<p>I have inherited an excel project, which I\u2019ve been tasked to automate and develop further.</p>\n\n<p>Use case being  </p>\n\n<ul>\n<li>An order comes in</li>\n<li>User opens the base (root) excel file </li>\n<li>Types in the relevant info (customer, order, data, tasks, etc) </li>\n<li>And saves the new task file in a folder with tasks in progress </li>\n<li>Leaving the base (root) excel basic and ready for next order.  </li>\n</ul>\n\n<p>The new task file needs to have a certain file name structure, which has been sorted.</p>\n\n<p>My problem comes in on <code>ActiveWorkbook.SaveAs filename</code>.</p>\n\n<p>As I step through <kbd>F5</kbd> the lines, it goes through all the steps, creates the filename, shows the Save As UI, correctly shows the right folder and suggested filename, and actually saves the file. As I come out of ErrHandler and the last <code>Application.EnableEvents = yes</code> - it crashes. It seems to either be closing the base file, opening the new, or transfer active workbook to the new save file.</p>\n\n<p>Which is fine, if it could stop crashing.</p>\n\n<pre><code>If criticalInput then\n    Msgbox \u201cU been bad, U Shall not PASS!\u201d, vbCritical \u2018Not actual text or box showing, just for demo.\nElse\n    Dim fileSaveName As Variant\n\n    '### It Crashes after saving (possible at opening)\n    fileSaveName = Application.GetSaveAsFilename( _\n    InitialFileName:=tasksfolder &amp; \"\\\" &amp; suggestFilename, _\n    fileFilter:=\"Excel-projectmappe med aktive makroer (*.xlsm), *.xlsm\")\n\n    If fileSaveName &lt;&gt; False Then\n        '### here is where you would save your file\n        DoEvents \u2018 Debugging research tells this should be here. Not that is changes anything.\n        ActiveWorkbook.SaveAs fileSaveName \u2018 During dev this has been disabled.\n    End If ' SaveAs\nEnd If ' criticalInput\n\nErrHandler:\n    '## Reset back to default\n    Application.DefaultFilePath = strDefault\n\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Debugging  </p>\n\n<ul>\n<li>I can save the file just nicely, if I disable SaveAs and work only on the base (root) excel file. </li>\n<li>I can open the new task file and save it nicely. (Just being a bugger about overwriting, Y/N)  </li>\n<li>Debugging research said I needed a DoEvents prior to SaveAs  </li>\n<li>Debugging research also said only to have the most relevant references present (in my case unselect OLE Automation)  </li>\n<li>During debugging, I\u2019ve also created, AfterSave() and Open(). They triggers normally during normal operation, but fails when SaveAs has crashed. Eg as I disable SaveAs or when I open the excel book normally.</li>\n</ul>\n\n<pre><code>Private Sub Workbook_AfterSave(ByVal Success As Boolean)\n    On Error GoTo ErrHandler    \n    If Success Then\n        Application.EnableEvents = False\n        'MsgBox \"Success save\", vbInformation ' for debugging purposes.\n    End If    \n    ErrHandler:\n    Application.EnableEvents = True\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    'MsgBox \"I haz been opened, yehawww\", vbInformation ' debugging\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "fonts", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 4, "creation_date": 1543434575, "post_id": 53526833, "comment_id": 93922921, "body": "&quot;Doesn&#39;t work&quot; is not an accurate problem description. Unfortunately you don&#39;t give us an example of the text you&#39;re searching, the kind of thing the code should find and what is actually found. Without that information it&#39;s unlikely anyone can help you."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1543437677, "post_id": 53526833, "comment_id": 93924285, "body": "I don&#39;t think you are who you&#39;re claiming to be in your profile."}], "answers": [{"comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "reply_to_user": {"reputation": 37, "user_id": 4595085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153191879466834/picture?type=large", "display_name": "Keri", "link": "https://stackoverflow.com/users/4595085/keri"}, "edited": false, "score": 0, "creation_date": 1543571902, "post_id": 53528818, "comment_id": 93975708, "body": "That&#39;s because your original post implied you were looking for a single character surrounded by &#39;~~~&#39;.  If you want to search for any text surrounded by &#39;~~~&#39; then your search text will need to be &quot;(~~~)(*)(~~~)&quot;."}, {"owner": {"reputation": 37, "user_id": 4595085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153191879466834/picture?type=large", "display_name": "Keri", "link": "https://stackoverflow.com/users/4595085/keri"}, "edited": false, "score": 0, "creation_date": 1543600892, "post_id": 53528818, "comment_id": 93990933, "body": "BEAUTIFUL! THANK YOU!"}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 0, "last_activity_date": 1543442721, "creation_date": 1543442721, "answer_id": 53528818, "question_id": 53526833, "link": "https://stackoverflow.com/questions/53526833/how-can-i-macros-word-font/53528818#53528818", "title": "How can I macros Word font", "body": "<p>There are several problems with your find replace.</p>\n\n<ol>\n<li>You are trying to do a wildcard search without setting the\n.MatchWildcards to True.  We can tell this because you are using a wildcard range [a-xA-Z].</li>\n</ol>\n\n<p>Change</p>\n\n<pre><code>.MatchWildcards = False\n</code></pre>\n\n<p>to</p>\n\n<pre><code>.MatchWildcards = True\n</code></pre>\n\n<p>and your replace function should work.</p>\n\n<p>The character ranges in the [] need to be in ascending character value order so should be [A-Za-z].  Additionally, to give you more flexibility, you can put brackets around different parts of the find pattern and then refer to these() with \\n where n is a sequential number form 1-9.</p>\n\n<p>So your find text would be better expressed as \"(~~~)([A-Za-z])(~~~)\" and your replacement text as \"\\1\\2\\3\"</p>\n\n<ol start=\"2\">\n<li>You have specified that you want to search on format but don't supply any specific criteria for the find text.  This means that any text that matches your find pattern will be changed to Arial font.</li>\n</ol>\n\n<p>If you only want to change text in the normal style then you will have to specify the style</p>\n\n<p>e.g. add</p>\n\n<pre><code>.style = \"Normal\"\n</code></pre>\n\n<p>Try the changes suggested above and let us know how you get on.</p>\n"}], "owner": {"reputation": 37, "user_id": 4595085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153191879466834/picture?type=large", "display_name": "Keri", "link": "https://stackoverflow.com/users/4595085/keri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 53528818, "answer_count": 1, "score": -2, "last_activity_date": 1543442721, "creation_date": 1543433690, "last_edit_date": 1543434453, "question_id": 53526833, "link": "https://stackoverflow.com/questions/53526833/how-can-i-macros-word-font", "title": "How can I macros Word font", "body": "<p>Why does this VBA code not work? With this normal text. </p>\n\n<p>Unfortunately, my wildcard search is going to find these instances too. Is there a way to find text with different formatting, in a Word macro?</p>\n\n<pre><code>Sub test()\n    With ActiveDocument.Content.Find\n        .ClearFormatting\n        .Text = \"~~~\" &amp; \"[a-zA-Z]\" &amp; \"~~~\"\n        .Replacement.ClearFormatting\n        .Replacement.Font.Name = \"Arial\"\n        .Replacement.Text = \"^&amp;\"\n        .Format = True\n        .Forward = True\n        .Wrap = wdFindStop\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n        .Execute Replace:=wdReplaceAll\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1543433991, "post_id": 53526793, "comment_id": 93922635, "body": "<code>Set trade = New Stock</code> - you only do this once, so you only have a single object..."}, {"owner": {"reputation": 25, "user_id": 9365985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0fa4a89b7fefe5746d7c8f85e277a1c?s=128&d=identicon&r=PG&f=1", "display_name": "thenifthenif", "link": "https://stackoverflow.com/users/9365985/thenifthenif"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1543434161, "post_id": 53526793, "comment_id": 93922689, "body": "Holy f*ck, I have been staring at this for days. You fixed it in a minute. THANK YOU"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1543434432, "post_id": 53526793, "comment_id": 93922836, "body": "When the code is ready you should consider posting it on <a href=\"https://codereview.stackexchange.com/\">CodeReview</a>"}, {"owner": {"reputation": 25, "user_id": 9365985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0fa4a89b7fefe5746d7c8f85e277a1c?s=128&d=identicon&r=PG&f=1", "display_name": "thenifthenif", "link": "https://stackoverflow.com/users/9365985/thenifthenif"}, "edited": false, "score": 0, "creation_date": 1543434477, "post_id": 53526793, "comment_id": 93922867, "body": "I had not heard of that site, thank you!"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1543434659, "post_id": 53526793, "comment_id": 93922960, "body": "@thenifthenif use <code>@</code> to target a user in the comments."}, {"owner": {"reputation": 25, "user_id": 9365985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0fa4a89b7fefe5746d7c8f85e277a1c?s=128&d=identicon&r=PG&f=1", "display_name": "thenifthenif", "link": "https://stackoverflow.com/users/9365985/thenifthenif"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1543435893, "post_id": 53526793, "comment_id": 93923522, "body": "Thank you, @TinMan"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1543439867, "post_id": 53526793, "comment_id": 93925229, "body": "I thought that it would be interesting to create an ADODB Recordset from the file.    If you want to check it out, here is the code: <a href=\"https://docs.google.com/document/d/1CNsqQIOVo5MhuWO8pV348H_9M4ezQi6YwzspgccBpjM/edit?usp=sharing\" rel=\"nofollow noreferrer\">ADODB Recordset Pipe Delimited Text File</a>"}], "owner": {"reputation": 25, "user_id": 9365985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0fa4a89b7fefe5746d7c8f85e277a1c?s=128&d=identicon&r=PG&f=1", "display_name": "thenifthenif", "link": "https://stackoverflow.com/users/9365985/thenifthenif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543433486, "creation_date": 1543433486, "question_id": 53526793, "link": "https://stackoverflow.com/questions/53526793/summaries-a-data-file-into-a-dictionary-using-class-objects", "title": "Summaries a data file into a dictionary using class objects", "body": "<p>I have trade data in a file like:</p>\n\n<pre><code>TIME|DIRECTION|ORDERID|SYMBOL|ROUTE||QUANTITY|PRICE\n2012-05-29 11:17:18|B|1337|ZNGA|ARCA||6500|5.48\n2012-05-29 11:17:53|B|1389|AAPL|ARCA||200|569.85\n2012-05-29 11:18:22|S|1970|BRK/B|ARCA||600|77.48\n2012-05-29 11:18:24|B|2335|BRK/B|ARCA||600|79.3\n2012-05-29 11:19:27|B|2416|ZNGA|ARCA||4000|6.08\n2012-05-29 11:19:29|S|2997|LNKD|ARCA||500|91.27\n2012-05-29 11:19:40|S|3078|ZNGA|ARCA||3900|6.04\n</code></pre>\n\n<p>I am trying to write VBA code which will consume the data and return statistics based on ticker (cumulative quantity, price, etc.). I have written code using a dictionary object with a class object. This is for an assignment, so I have to do it that way.</p>\n\n<p>I want to end up with a dictionary where each key represents a different ticker (ie, AAPL, ZNGA, etc), and the values represent different statistics. Final price, final quantity etc.</p>\n\n<p>So, with the file snippet above, I should get:</p>\n\n<pre><code>ticker,cashVal,positionVal,endPriceVal,maxDateVal\nZNGA,39864,6600,6.04,2012-05-29 11:19:40\nAAPL,113970,200,569.85,2012-05-29 11:17:53 \n</code></pre>\n\n<p>...and so on.</p>\n\n<p>I have the following VBA Code:</p>\n\n<pre><code>Sub defineVar()\nmyFile = Range(\"$A$2\")\nEnd Sub\n\nPublic Sub test_everything()\n\nCall defineVar\n\n'Dim line As trade\nDim lines As Collection\nSet lines = New Collection\n\nOpen myFile For Input As #1\nDo Until EOF(1)\n    Line Input #1, file_line\n    lines.Add file_line\nLoop\nClose #1\n\n\nDim posTime As Byte\nDim posDirection As Byte\nDim posSymbol As Byte\nDim posQuantity As Byte\nDim posPrice As Byte\n\nposTime = getColPosByHeader(\"TIME\", lines(1))\nposDirection = getColPosByHeader(\"DIRECTION\", lines(1))\nposSymbol = getColPosByHeader(\"SYMBOL\", lines(1))\nposQuantity = getColPosByHeader(\"QUANTITY\", lines(1))\nposPrice = getColPosByHeader(\"PRICE\", lines(1))\n\nDim pos As Long\nDim ticker As String\n\nDim trades As Scripting.Dictionary\nSet trades = New Scripting.Dictionary\nDim trade As Stock\nSet trade = New Stock\n\npos = 2\n\nWhile pos &lt;= lines.Count\n    lineItems = Split(lines(pos), \"|\")\n    ticker = lineItems(posSymbol)\n    If Not trades.exists(ticker) Then\n        trade.symbol = ticker\n        trade.cashVal = 0\n        trade.positionVal = lineItems(posQuantity)\n        trade.endPriceVal = lineItems(posPrice)\n        trade.maxDateVal = lineItems(posTime)\n        trades.Add trade.symbol, trade\n        If InStr(1, lineItems(posDirection), \"B\") Then\n            trades(ticker).cashVal = trades(ticker).cashVal - lineItems(posQuantity) * lineItems(posPrice)\n        Else: trades(ticker).cashVal = trades(ticker).cashVal + lineItems(posQuantity) * lineItems(posPrice)\n        End If\n    Else:\n    If InStr(1, lineItems(posDirection), \"B\") Then\n        trades(ticker).cashVal = trades(ticker).cashVal - lineItems(posQuantity) * lineItems(posPrice)\n        trades(ticker).positionVal = trades(ticker).positionVal + lineItems(posQuantity)\n            If lineItems(posTime) &gt;= trades(ticker).maxDateVal Then\n                trades(ticker).maxDateVal = lineItems(posTime)\n                trades(ticker).endPriceVal = lineItems(posPrice)\n                End If\n    Else: trades(ticker).cashVal = trades(ticker).cashVal + lineItems(posQuantity) * lineItems(posPrice)\n        trades(ticker).positionVal = trades(ticker).positionVal - lineItems(posQuantity)\n        If lineItems(posTime) &gt;= trades(ticker).maxDateVal Then\n            trades(ticker).maxDateVal = lineItems(posTime)\n            trades(ticker).endPriceVal = lineItems(posPrice)\n        End If\n    End If\n    End If\n    Debug.Print trades(ticker).positionVal\n    pos = pos + 1\nWend\n\nDim k As Variant\nFor Each k In trades.Keys\n    Debug.Print k, trades(k).cashVal, trades(k).positionVal, trades(k).endPriceVal, trades(k).maxDateVal\nNext\n\nEnd Sub\n</code></pre>\n\n<p>This is what my class objects look like:</p>\n\n<pre><code>'Class Module: Stock\nPublic symbol As String\nPublic cashVal As Double\nPublic positionVal As Double\nPublic endPriceVal As Double\nPublic maxDateVal As Date\n</code></pre>\n\n<p>My problem is that the dictionary returns all the same values attached to different keys. It is not differentiating between keys.  I have been combing the code for a logical error, but I don't see one. What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba", "copy", "row"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1543431188, "post_id": 53525948, "comment_id": 93921285, "body": "To your title question, you have to do two conditional statements: <code>Worksheets(&quot;Sheet1&quot;).Cells(i, 3).Value &gt;50000 or Worksheets(&quot;Sheet1&quot;).Cells(i, 3).Value &lt; -50000 Then</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1543431315, "post_id": 53525948, "comment_id": 93921350, "body": "<code>Abs(Worksheets(&quot;Sheet1&quot;).Cells(i, 3).Value) &gt; 50000</code>"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1543431523, "post_id": 53525948, "comment_id": 93921442, "body": "The if statement you have in your code does not show a negative... it shows &lt;50000..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10718714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515e3e317e08f1b5e168d59bd472e96d?s=128&d=identicon&r=PG&f=1", "display_name": "Owain", "link": "https://stackoverflow.com/users/10718714/owain"}, "edited": false, "score": 0, "creation_date": 1543438728, "post_id": 53526439, "comment_id": 93924759, "body": "This worked perfectly for my purpose. Thank you for your help!"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 2, "last_activity_date": 1543432013, "creation_date": 1543432013, "answer_id": 53526439, "question_id": 53525948, "link": "https://stackoverflow.com/questions/53525948/specific-criteria-greater-than-50000-or-less-than-50000/53526439#53526439", "title": "Specific criteria &#39;Greater than 50000&#39; OR &#39;Less than -50000&#39;", "body": "<p>you could use <code>Abs()</code> function and have one check only:</p>\n\n<p>and use <code>Range</code> property of <code>Worksheet</code> object to <em>select</em> wanted columns in given row by means of <code>Intersect()</code> method:</p>\n\n<pre><code>Option Explicit\n\nSub main()\n    Dim a As Long, i As Long\n    Dim sht2 As Worksheet\n\n    Set sht2 = Worksheets(\"Sheet2\") ' set a worksheet object for destination sheet\n\n    With Worksheets(\"Sheet1\") ' reference Sheet1\n        a = .Cells(.Rows.Count, 1).End(xlUp).Row ' get referenced sheet column A row index of last not empty cell\n        For i = 2 To a\n            If Abs(.Cells(i, 3).Value) &gt; 50000 Then ' if cell value in current row index and column 3 is greater than 50000 or less then -500000\n                Intersect(.Rows(i), .Range(\"A:B , E:F, H:I, O:O, AG:AG\")).Copy\n                sht2.Cells(sht2.Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial\n                Application.CutCopyMode = False\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1543436488, "post_id": 53526830, "comment_id": 93923783, "body": "<code>Option Explicit</code> strikes again!"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1543437051, "post_id": 53526830, "comment_id": 93924026, "body": "@AJD lol... I should have mentioned that and a few other things"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1543437116, "post_id": 53526830, "comment_id": 93924055, "body": "Yeah, easy to miss after one has done it for the 1001th time :-)"}], "tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1543433681, "creation_date": 1543433681, "answer_id": 53526830, "question_id": 53525948, "link": "https://stackoverflow.com/questions/53525948/specific-criteria-greater-than-50000-or-less-than-50000/53526830#53526830", "title": "Specific criteria &#39;Greater than 50000&#39; OR &#39;Less than -50000&#39;", "body": "<p>You are using <code>x1Up</code> instead of <code>xlUp</code>.</p>\n\n<pre><code>Application.ScreenUpdating = False\nDim cell As Range\nWith Worksheets(\"Sheet1\")\n    For Each cell In .Range(\"A2\", .Cells(Rows.Count, 1).End(xlUp)).Offset(0, 2)\n        If cell.Value &gt; -50000 Or cell.Value &lt; 50000 Then\n            With Worksheets(\"Sheet2\")\n                cell.EntireRow.Range(\"A1:B1,E1:F1,H1,I1,O1,AG1\").Copy Destination:=.Cells(Rows.Count, 1).End(xlUp).Offset(1)\n            End With\n        End If\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10718714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/515e3e317e08f1b5e168d59bd472e96d?s=128&d=identicon&r=PG&f=1", "display_name": "Owain", "link": "https://stackoverflow.com/users/10718714/owain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53526439, "answer_count": 2, "score": 0, "last_activity_date": 1543475124, "creation_date": 1543430016, "last_edit_date": 1543475124, "question_id": 53525948, "link": "https://stackoverflow.com/questions/53525948/specific-criteria-greater-than-50000-or-less-than-50000", "title": "Specific criteria &#39;Greater than 50000&#39; OR &#39;Less than -50000&#39;", "body": "<p>This is what I have so far. There are a couple of amendments I want to make, that I don't completely understand how to do;</p>\n\n<ol>\n<li><p>On line 3, I want my 'Copying criteria' to be 'Greater than 50000' or 'Less than 50000'.</p></li>\n<li><p>How can I specify the cells on Sheet2 where the first item is copied to? For example, Sheet2! B10?</p></li>\n<li><p>How can I then restrict the columns copied from the row on Sheet 1 which meets my criteria to (for example) columns A, B, E, F, H, I, O, &amp; AG from Sheet1?</p></li>\n</ol>\n\n<p></p>\n\n<pre><code>    a = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(x1Up).Row\n\n    For i = 2 To a\n\n        If Worksheets(\"Sheet1\").Cells(i, 3).Value = **&gt;50000 OR &lt;50000** Then\n\n            Worksheets(\"Sheet1\").Rows(i).Copy\n            Worksheets(\"Sheet2\").Activate\n            b = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(x1Up).Row\n            Worksheets(\"Sheet2\").Cells(b + 1, 1).Select\n            ActivateSheet.Paste\n            Worksheets(\"Sheet1\").Activate\n\n        End if\n\n    Next\n\n    Application.CutCopyMode = False\n    ThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ole"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1543433158, "post_id": 53525849, "comment_id": 93922237, "body": "<code>x1Up</code> should be <code>xlUp</code>  You should always use <code>Option Explicit</code> for exactly this reason.   If you disable the add-in and all other code, including any event-handling routines, does it still error?"}, {"owner": {"reputation": 31, "user_id": 6263851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124171d45327fd28668c63c54ea01138?s=128&d=identicon&r=PG&f=1", "display_name": "SenorHoward", "link": "https://stackoverflow.com/users/6263851/senorhoward"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543434064, "post_id": 53525849, "comment_id": 93922658, "body": "@TimWilliams The only other code that I have in this workbook are 2 other manually triggered macros (one to add blank rows, one to undo row deletes), and variable declarations. With those (excepting the variables) deleted, the problem still persists."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543434416, "post_id": 53525849, "comment_id": 93922830, "body": "Sorry - I don&#39;t have any useful guesses."}, {"owner": {"reputation": 31, "user_id": 6263851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124171d45327fd28668c63c54ea01138?s=128&d=identicon&r=PG&f=1", "display_name": "SenorHoward", "link": "https://stackoverflow.com/users/6263851/senorhoward"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543434722, "post_id": 53525849, "comment_id": 93922988, "body": "@TimWilliams I&#39;m starting to think it might just be an issue with my computer OR my install of excel. I just got the same freeze and error without running anything, simply hitting &#39;enter&#39; on a cell with a simple numerical expression evaluation. <i>sigh</i> Will continue investigating."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543434886, "post_id": 53525849, "comment_id": 93923059, "body": "Try quitting Excel, then restart and see if that helps. If not, try re-booting Windows."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543434942, "post_id": 53525849, "comment_id": 93923087, "body": "Sounds like an add-in issue (at least, every time something like that has happened to me, that&#39;s what the problem turned out to be...)"}, {"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1543435759, "post_id": 53525849, "comment_id": 93923461, "body": "1.  Disable all other Add-ins, 2. Go into Task Manager and make sure that there no other instances of Excel running in the background."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1543452285, "post_id": 53525849, "comment_id": 93928946, "body": "Probably not related, but having an undeclared variable named <code>Worksheet</code> in an Excel project seems like it&#39;s asking for trouble."}, {"owner": {"reputation": 31, "user_id": 6263851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124171d45327fd28668c63c54ea01138?s=128&d=identicon&r=PG&f=1", "display_name": "SenorHoward", "link": "https://stackoverflow.com/users/6263851/senorhoward"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543521683, "post_id": 53525849, "comment_id": 93959957, "body": "@Comintern Yeah, I followed Tim&#39;s advice and added Option Explicit to all my macros and declared variables for the sheets instead."}, {"owner": {"reputation": 31, "user_id": 6263851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124171d45327fd28668c63c54ea01138?s=128&d=identicon&r=PG&f=1", "display_name": "SenorHoward", "link": "https://stackoverflow.com/users/6263851/senorhoward"}, "edited": false, "score": 0, "creation_date": 1543521909, "post_id": 53525849, "comment_id": 93960068, "body": "I&#39;m not sure if this helps explain the issue at all, but a &quot;fix&quot; so far has been to alt-tab to another window and then back any time excel seems to lock up. For the last two days that has avoided the error prompt with 100% success. Still no idea what is causing it to begin with though. Hard and soft restarts (of both the program and the computer) haven&#39;t prevented the issue either. I&#39;ll keep trying different combinations of things and report back with success/failure. Thank you for the input so far."}], "owner": {"reputation": 31, "user_id": 6263851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/124171d45327fd28668c63c54ea01138?s=128&d=identicon&r=PG&f=1", "display_name": "SenorHoward", "link": "https://stackoverflow.com/users/6263851/senorhoward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 231, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1582548354, "creation_date": 1543429642, "last_edit_date": 1582548354, "question_id": 53525849, "link": "https://stackoverflow.com/questions/53525849/why-does-excel-macro-crash-with-excel-is-waiting-for-another-application-to-com", "title": "Why does excel macro crash with &quot;excel is waiting for another application to complete an OLE action&quot; but doesn&#39;t utilize any other application/file?", "body": "<p>I've seen a lot of posts about this OLE action error, but the difference here is that the macro that I am running isn't importing/exporting any data and isn't triggering actions in any other program (at least not intentionally), which is what I've come to learn is generally the cause. Here is the VBA that generates the error:</p>\n\n<pre><code>Sub DeleteRows()\n    Dim varResponse As Variant\n\n    varResponse = MsgBox(\"This will permanently delete selected rows. Do you wish to continue?\", vbYesNo, \"WARNING\")\n    If varResponse &lt;&gt; vbYes Then Exit Sub\n\n    Set Rs = Selection\n\n    For i = 1 To Selection.Rows.Count\n        If Range(Rs.Address).EntireRow.Cells(i, 12) &lt;&gt; \"d\" Then\n            MsgBox \"Selection contains cells that can not be removed. Revise selection.\", vbExclamation, \"Invalid Selection\"\n            Exit Sub\n        End If\n    Next\n\n    For Each Worksheet In ActiveWorkbook.Worksheets\n        Worksheet.Unprotect\n    Next\n\n    ActiveWorkbook.Worksheets(\"backup_estimate\").Cells.Clear\n    ActiveWorkbook.Worksheets(\"backup_actual\").Cells.Clear\n    ActiveWorkbook.Worksheets(\"backup_invoice\").Cells.Clear\n\n    sourceOld = Selection(1).Row\n    sourceSize = Selection.Rows.Count\n\n    Worksheets(\"Estimate\").Range(Rs.Address).EntireRow.Copy Destination:=Worksheets(\"backup_estimate\").Range(\"A1\")\n    Worksheets(\"Actual Cost\").Range(Rs.Address).EntireRow.Copy Destination:=Worksheets(\"backup_actual\").Range(\"A1\")\n    Worksheets(\"Invoice Tracking\").Range(Rs.Address).EntireRow.Copy Destination:=Worksheets(\"backup_invoice\").Range(\"A1\")\n\n    Sheets(Array(\"Estimate\", \"Actual Cost\", \"Invoice Tracking\")).Select\n    Range(Rs.Address).EntireRow.Select\n    Selection.Delete Shift:=x1Up\n    ActiveSheet.Select\n\n    For Each Worksheet In ActiveWorkbook.Worksheets\n        Worksheet.Protect\n    Next\nEnd Sub\n</code></pre>\n\n<p>The purpose of the macro is to delete the same selection of data and rows across 3 of the 6 sheets in this specific workbook, and shift all remaining data up. </p>\n\n<p>When triggering the macro, it will more often than not freeze the instance of excel and give me that error about 10-20 seconds later (it doesn't happen every time). For reference, the \"backup_estimate\" and other backup sheets are strictly temporary data storage for use by another \"undo last action\" macro that I have set up.</p>\n\n<p>I do have a single plug-in that I use periodically (blue-beam), but I've encountered this error with the plugins all disabled AND the \"ignore other applications that use DDE\" option checked (one of the fixes suggested on another post).</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1543432360, "post_id": 53525658, "comment_id": 93921880, "body": "Awesome! Thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "edited": false, "score": 0, "creation_date": 1543433026, "post_id": 53525658, "comment_id": 93922176, "body": "No problem, easy solution."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1543428846, "creation_date": 1543428846, "answer_id": 53525658, "question_id": 53525599, "link": "https://stackoverflow.com/questions/53525599/how-to-reformat-a-displayed-date/53525658#53525658", "title": "How to reformat a displayed date?", "body": "<p>Consider using <code>Format$</code>:</p>\n\n<pre><code>Sub testdate()\n    'Get Friday's Date\n    Dim NextFriday As Date\n    NextFriday = Date + 8 - Weekday(Date, vbFriday)\n\n    'Popup\n    MsgBox \"Next Friday's Date is \" &amp; Format$(NextFriday, \"yyyy-mm-dd\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5327331, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/333cec14c2f7895f4681f18e3167ce76?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5327331/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53525658, "answer_count": 1, "score": 0, "last_activity_date": 1543527523, "creation_date": 1543428592, "last_edit_date": 1543527523, "question_id": 53525599, "link": "https://stackoverflow.com/questions/53525599/how-to-reformat-a-displayed-date", "title": "How to reformat a displayed date?", "body": "<p>I am working on saving emails and attachments.</p>\n\n<p>I need to figure out how to reformat the default date display my code is coming up with.  Currently it results in mm/dd/yyyy.</p>\n\n<p>This date is going to be in the file path for where the email or attachment will be saved. I need it to be in the format of yyyy-mm-dd since I cannot include slashes in file paths.</p>\n\n<p>My test code to learn to do this is as follows:</p>\n\n<pre><code>Sub testdate()\n'Get Friday's Date\nDim NextFriday As Date\nNextFriday = Date + 8 - Weekday(Date, vbFriday)\n\n'Popup\nMsgBox \"Next Friday's Date is \" &amp; NextFriday\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-2016", "data-import"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543426081, "post_id": 53524877, "comment_id": 93918893, "body": "Pro-tip, the VBE highlights the type that is missing..."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1543426174, "post_id": 53524877, "comment_id": 93918944, "body": "<a href=\"https://support.microsoft.com/en-us/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">Using early binding and late binding in Automation</a> | <a href=\"https://stackoverflow.com/questions/49789611/vba-early-vs-late-binding-real-life-performance-differences\" title=\"vba early vs late binding real life performance differences\">stackoverflow.com/questions/49789611/&hellip;</a> | <a href=\"https://stackoverflow.com/questions/50583705/late-binding-vs-early-binding-in-vba-createobject-vs-new\" title=\"late binding vs early binding in vba createobject vs new\">stackoverflow.com/questions/50583705/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 9183266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nEhiFl8tojg/AAAAAAAAAAI/AAAAAAAAAJg/IprzCQgBcaU/photo.jpg?sz=128", "display_name": "Dani", "link": "https://stackoverflow.com/users/9183266/dani"}, "edited": false, "score": 1, "creation_date": 1543426248, "post_id": 53524877, "comment_id": 93918979, "body": "Found the answer here! &lt;<a href=\"https://stackoverflow.com/questions/3233203/how-do-i-use-filesystemobject-in-vba\" title=\"how do i use filesystemobject in vba\">stackoverflow.com/questions/3233203/&hellip;</a>&gt;"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1543426438, "last_edit_date": 1543426438, "creation_date": 1543425874, "answer_id": 53524963, "question_id": 53524877, "link": "https://stackoverflow.com/questions/53524877/importing-multiple-txt-files-using-macro/53524963#53524963", "title": "Importing Multiple Txt files using macro", "body": "<p>FileSystemObject requires a reference to the <strong>Microsoft Scripting Runtime</strong> library. </p>\n\n<p>Look at the references in your previous workbook.</p>\n"}], "owner": {"reputation": 1, "user_id": 9183266, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nEhiFl8tojg/AAAAAAAAAAI/AAAAAAAAAJg/IprzCQgBcaU/photo.jpg?sz=128", "display_name": "Dani", "link": "https://stackoverflow.com/users/9183266/dani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "closed_date": 1543426639, "answer_count": 1, "score": -2, "last_activity_date": 1582499525, "creation_date": 1543425540, "last_edit_date": 1582499525, "question_id": 53524877, "link": "https://stackoverflow.com/questions/53524877/importing-multiple-txt-files-using-macro", "closed_reason": "Duplicate", "title": "Importing Multiple Txt files using macro", "body": "<p>I had previously asked this question in this post:\n<a href=\"https://stackoverflow.com/questions/48134634/importing-multiple-text-files-using-vba-macro\">Importing multiple text files using VBA Macro</a></p>\n\n<p>After a while, i created an entire new workbook and when i try to copy/paste this code to a macro module, <strong>i get a compile error: user-defined type not defined....</strong> The code is as following:</p>\n\n<pre><code>Sub ReadFilesIntoActiveSheet()\nDim fso As FileSystemObject\nDim folder As folder\nDim file As file\nDim FileText As TextStream\nDim TextLine As String\nDim Items() As String\nDim i As Long\nDim cl As Range\nDim sFolder As String, vDB, Ws As Worksheet\nDim rngT As Range\n' Get a FileSystem object\n  Set fso = New FileSystemObject\n\n' get the directory you want\n\nsFolder = \"C:\\Users\\danial.smith\\Documents\\Maintenance\\DataDump\\Reports\\RawData\\\"\nSet folder = fso.GetFolder(sFolder)\n' set the starting point to write the data to\nSet Ws = ActiveSheet\n'Set cl = ActiveSheet.Cells(1, 1)\n\n' Loop thru all files in the folder\nFor Each file In folder.Files\n    Workbooks.Open Filename:=sFolder &amp; file.Name, Format:=1\n    With ActiveWorkbook.ActiveSheet\n        vDB = .UsedRange.Offset(1)\n    End With\n    ActiveWorkbook.Close\n    Set rngT = Ws.Range(\"a\" &amp; Rows.Count).End(xlUp)(2)\n    rngT.Resize(UBound(vDB, 1), UBound(vDB, 2)) = vDB\nNext file\nSet FileText = Nothing\nSet file = Nothing\nSet folder = Nothing\nSet fso = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I have tried to include the Microsoft ActiveX Data Object Library as some suggest but still no luck....not sure what to do...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1543425662, "post_id": 53524862, "comment_id": 93918667, "body": "A1 and B2? is the date on another row?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1543425762, "post_id": 53524862, "comment_id": 93918725, "body": "<code>If .Value = &quot;31&quot; And .Offset(1,1) &gt; Offset(1,2) Then</code>"}, {"owner": {"reputation": 1, "user_id": 10718443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d625ca449e119c222fb5cd6f6ba9d8ae?s=128&d=identicon&r=PG&f=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/10718443/travis"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1543426896, "post_id": 53524862, "comment_id": 93919294, "body": "Sorry, I just used random cells for an example. My goal is if A1=31 and the date in B2 is &gt; C3, then delete the entire row."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1543427387, "post_id": 53524862, "comment_id": 93919501, "body": "A1, B2 and C3? three different rows? or all on the same row? A1, B1 and C1?"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1543427453, "post_id": 53524862, "comment_id": 93919530, "body": "<code>If .Value = &quot;31&quot; And .Offset(,1) &gt; Offset(,2) Then</code> for the same row"}, {"owner": {"reputation": 1, "user_id": 10718443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d625ca449e119c222fb5cd6f6ba9d8ae?s=128&d=identicon&r=PG&f=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/10718443/travis"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1543428192, "post_id": 53524862, "comment_id": 93919873, "body": "The B value is on the same row, but the C value is actually on another worksheet"}], "answers": [{"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1543434896, "creation_date": 1543434896, "answer_id": 53527127, "question_id": 53524862, "link": "https://stackoverflow.com/questions/53524862/vba-help-if-one-cell-contains-a-specific-value-and-another-cell-has-a-date-th/53527127#53527127", "title": "VBA Help- If one cell contains a specific value AND another cell has a date ? than another cell- delete entire row", "body": "<h1>Still Unclear</h1>\n\n<h2>This is not yet a working code!</h2>\n\n<p>If you are not going to run this code on different sheets you should change ActiveSheet to the index number like you did with Worksheets(2). It is preferred to use worksheet names and best to use code names though.</p>\n\n<p>You will have to define the 'OtherWorksheet' name (or index) I used and adjust its column and row. Uncomment the commented parts only after you got the code working.</p>\n\n<p>I make this code working, if you provide the names or the indexes of all the worksheets envolved and an exact 'series of 3' of data e.g. A1, B1 on Sheet1, worksheet(1),  Worksheet(\"Master\") or ActiveSheet and C2 on Sheet3, Worksheet(3) or Worksheet(\"Slave\"). </p>\n\n<pre><code>Option Explicit\n\nSub Remove_Future_Dates()\n\n    Dim Firstrow As Long\n    Dim LastRow As Long\n    Dim Lrow As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\n'    With Application\n'        CalcMode = .Calculation\n'        .Calculation = xlCalculationManual\n'        .ScreenUpdating = False\n'    End With\n\n    On Error GoTo SafeExit\n\n    With ThisWorkbook.Worksheets(2)\n        Firstrow = .UsedRange.Cells(1).Row\n        LastRow = .Worksheets(2).Cells(Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    With ActiveSheet\n        For Lrow = LastRow To Firstrow Step -1\n            With .Cells(Lrow, \"A\")\n                If Not IsError(.Value) Then\n                    If .Value = \"31\" _\n                        And .Offset(0, 1) &gt; _\n                        ThisWorkbook.Worksheets(\"OtherWorksheet\") _\n                            .Cells(Lrow + 1, \"C\") _\n                        Then .EntireRow.Delete\n                End If\n            End With\n        Next Lrow\n    End With\n\nSafeExit:\n\n'    With Application\n'        CalcMode = .Calculation\n'        .Calculation = xlCalculationManual\n'        .ScreenUpdating = True\n'    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10718443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d625ca449e119c222fb5cd6f6ba9d8ae?s=128&d=identicon&r=PG&f=1", "display_name": "Travis", "link": "https://stackoverflow.com/users/10718443/travis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543434896, "creation_date": 1543425491, "last_edit_date": 1543427289, "question_id": 53524862, "link": "https://stackoverflow.com/questions/53524862/vba-help-if-one-cell-contains-a-specific-value-and-another-cell-has-a-date-th", "title": "VBA Help- If one cell contains a specific value AND another cell has a date ? than another cell- delete entire row", "body": "<p>I am working on a spreadsheet that has data I need to remove based on three different cells. Here is my goal: </p>\n\n<p>If A1=31 AND B1 contains a date > than the date in C1, delete the entire row. I need to loop through the full data set and check each row. I have it removing the row if A1=31 and looping through the worksheet, but can't seem to add the date component. </p>\n\n<p>Here is my coding. It is probably kind of messy since mostly copied and pasted. I am not an a very experienced coder and don't really care what it looks like as long as it works. I am also not working with massive datasets so speed isn't an issue. </p>\n\n<pre><code>Sub Remove_Future_Dates()\n    Dim Firstrow As Long\n    Dim LastRow As Long\n    Dim Lrow As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\nFirstrow = ThisWorkbook.Worksheets(2).UsedRange.Cells(1).Row\nLastRow = ThisWorkbook.Worksheets(2).Cells(ThisWorkbook.Worksheets(2).Rows.Count, \"A\").End(xlUp).Row\n\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        '.ScreenUpdating = False\n    End With\n    With ActiveSheet\n        .Select\n        Firstrow = .UsedRange.Cells(1).Row\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        For Lrow = LastRow To Firstrow Step -1\n\n            With .Cells(Lrow, \"A\")\n\n                If Not IsError(.Value) Then\n\n                    If .Value = \"31\" Then .EntireRow.Delete\n                End If\n                End With\n\n        Next Lrow\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543431066, "post_id": 53524539, "comment_id": 93921226, "body": "The only way Word can turn its formatting into HTML tags is using a converter. One way is to save a file to HTML, the other is to copy onto the Clipboard. The problem with the latter, which is what you&#39;re trying, is that VBA can only get the <i>text</i> from the Clipboard - it won&#39;t contain the HTML. VBA does not have <code>Clipboard.getText</code> which is why that won&#39;t compile. It does have <code>DataObject</code> which belongs to the <code>MSForms</code> library. <code>DataObject</code> can only retrieve text, however, and won&#39;t deliver the HTML or RTF."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1543431275, "post_id": 53524539, "comment_id": 93921324, "body": "What you found is probably .NET code which isn&#39;t part of Office or VBA - doesn&#39;t matter how new or old your version is. Saving to HTML in Word probably also won&#39;t be satisfactory as it doesn&#39;t save to &quot;simple&quot; HTML. You may need to use Find/Replace to search for formatting and append the required tags to the &quot;found&quot; text."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 10869491, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-240ioPcJYRA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaPJI2MtMdrSG7nrE1JKWSQkA02gA/mo/photo.jpg?sz=128", "display_name": "Wayne Whittenberg", "link": "https://stackoverflow.com/users/10869491/wayne-whittenberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1547670906, "creation_date": 1547670906, "answer_id": 54224958, "question_id": 53524539, "link": "https://stackoverflow.com/questions/53524539/convert-a-word-range-to-a-string-with-html-tags-in-vba/54224958#54224958", "title": "Convert a Word Range to a String with HTML tags in VBA", "body": "<p>One way I know to get formatting in Word turned into html tags is to use Access. If you create an Access table with a field that has Long Text data type and Rich Text as the Text Format and import your Word text into it, when you query Access to put the Text back into Word it comes out as html tagged text.</p>\n"}, {"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1547673603, "creation_date": 1547673603, "answer_id": 54225552, "question_id": 53524539, "link": "https://stackoverflow.com/questions/53524539/convert-a-word-range-to-a-string-with-html-tags-in-vba/54225552#54225552", "title": "Convert a Word Range to a String with HTML tags in VBA", "body": "<p>You could use code like the following as a starting point. Obviously, though, you'll have to extend it to handle all the tags you're concerned with.</p>\n\n<pre><code>Sub ApplyHTML()\nApplication.ScreenUpdating = False\nWith ActiveDocument.Range\n  '.ListFormat.ConvertNumbersToText\n  With .Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Format = True\n    .Forward = True\n    .MatchWildcards = True\n    .Wrap = wdFindContinue\n    .Font.Underline = True\n    .Text = \"\"\n    .Replacement.Text = \"&lt;u&gt;^&amp;&lt;/u&gt;\"\n    .Execute Replace:=wdReplaceAll\n    .ClearFormatting\n    .Font.Bold = True\n    .Replacement.Text = \"&lt;b&gt;^&amp;&lt;/b&gt;\"\n    .Execute Replace:=wdReplaceAll\n    .ClearFormatting\n    .Font.Italic = True\n    .Replacement.Text = \"&lt;i&gt;^&amp;&lt;/i&gt;\"\n    .Execute Replace:=wdReplaceAll\n    .ClearFormatting\n    .Highlight = True\n    .Replacement.Text = \"&lt;h&gt;^&amp;&lt;/h&gt;\"\n    .Execute Replace:=wdReplaceAll\n  End With\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4350256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oZyMd.jpg?s=128&g=1", "display_name": "Edson", "link": "https://stackoverflow.com/users/4350256/edson"}, "is_accepted": false, "score": 0, "last_activity_date": 1597760687, "last_edit_date": 1597760687, "creation_date": 1597760315, "answer_id": 63470622, "question_id": 53524539, "link": "https://stackoverflow.com/questions/53524539/convert-a-word-range-to-a-string-with-html-tags-in-vba/63470622#63470622", "title": "Convert a Word Range to a String with HTML tags in VBA", "body": "<p>Just a couple of functions i usually use to create HTMLBody in outlook. It may help someone in the future. This process will check by character so it may take a little bit of time. I am using this in a pre-formatted cell in excel but should also work on word document.</p>\n<pre><code>Function Convert2HTML(myCell As Range) As String\n    Dim bldTagOn, itlTagOn, ulnTagOn, colTagOn, phaTagOn As Boolean\n    Dim i, chrCount, spaceCount As Integer\n    Dim chrCol, chrLastCol, htmlTxt As String\n    \n    bldTagOn = False\n    itlTagOn = False\n    ulnTagOn = False\n    colTagOn = False\n    phaTagOn = False\n    chrCol = &quot;NONE&quot;\n    htmlTxt = &quot;&lt;div&gt;&quot;\n    chrCount = myCell.Characters.Count\n    spaceCount = 0\n    For i = 1 To chrCount\n        With myCell.Characters(i, 1)\n        \n            If myCell.Characters(i, 4).Text = &quot;    &quot; And Not phaTagOn Then\n                htmlTxt = htmlTxt &amp; &quot;&lt;p style='text-indent: 40px'&gt;&quot;\n                phaTagOn = True\n            Else\n                If myCell.Characters(i, 4).Text = &quot;    &quot; And phaTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;/p&gt;&lt;p style='text-indent: 40px'&gt;&quot;\n                    phaTagOn = True\n                End If\n            End If\n                \n            If (.Font.Color) Then\n                chrCol = GetCol(.Font.Color)\n                If Not colTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;font color=#&quot; &amp; chrCol &amp; &quot;&gt;&quot;\n                    colTagOn = True\n                Else\n                    If chrCol &lt;&gt; chrLastCol Then htmlTxt = htmlTxt &amp; &quot;&lt;/font&gt;&lt;font color=#&quot; &amp; chrCol &amp; &quot;&gt;&quot;\n                End If\n            Else\n                chrCol = &quot;NONE&quot;\n                If colTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;/font&gt;&quot;\n                    colTagOn = False\n                End If\n            End If\n            chrLastCol = chrCol\n            \n            If .Font.Bold = True Then\n                If Not bldTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;b&gt;&quot;\n                    bldTagOn = True\n                End If\n            Else\n                If bldTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;/b&gt;&quot;\n                    bldTagOn = False\n                End If\n            End If\n    \n            If .Font.Italic = True Then\n                If Not itlTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;i&gt;&quot;\n                    itlTagOn = True\n                End If\n            Else\n                If itlTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;/i&gt;&quot;\n                    itlTagOn = False\n                End If\n            End If\n    \n            If .Font.Underline &gt; 0 Then\n                If Not ulnTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;u&gt;&quot;\n                    ulnTagOn = True\n                End If\n            Else\n                If ulnTagOn Then\n                    htmlTxt = htmlTxt &amp; &quot;&lt;/u&gt;&quot;\n                    ulnTagOn = False\n                End If\n            End If\n            \n            If (Asc(.Text) = 10) Then\n                htmlTxt = htmlTxt &amp; &quot;&lt;br&gt;&quot;\n            Else\n                htmlTxt = htmlTxt &amp; .Text\n            End If\n        End With\n    Next\n    \n    If colTagOn Then\n        htmlTxt = htmlTxt &amp; &quot;&lt;/font&gt;&quot;\n        colTagOn = False\n    End If\n    If bldTagOn Then\n        htmlTxt = htmlTxt &amp; &quot;&lt;/b&gt;&quot;\n        bldTagOn = False\n    End If\n    If itlTagOn Then\n        htmlTxt = htmlTxt &amp; &quot;&lt;/i&gt;&quot;\n        itlTagOn = False\n    End If\n    If ulnTagOn Then\n        htmlTxt = htmlTxt &amp; &quot;&lt;/u&gt;&quot;\n        ulnTagOn = False\n    End If\n    If phaTagOn Then\n        htmlTxt = htmlTxt &amp; &quot;&lt;/p&gt;&quot;\n        phaTagOn = False\n    End If\n    htmlTxt = htmlTxt &amp; &quot;&lt;/div&gt;&quot;\n    fnConvert2HTML = htmlTxt\nEnd Function\n\nFunction GetCol(strCol As String) As String\n    Dim rVal, gVal, bVal As String\n    strCol = Right(&quot;000000&quot; &amp; Hex(strCol), 6)\n    bVal = Left(strCol, 2)\n    gVal = Mid(strCol, 3, 2)\n    rVal = Right(strCol, 2)\n    GetCol = rVal &amp; gVal &amp; bVal\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9603937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cf5417ac09d359cde8a5321d7c95db0?s=128&d=identicon&r=PG&f=1", "display_name": "Astrid", "link": "https://stackoverflow.com/users/9603937/astrid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1398, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1597760687, "creation_date": 1543424393, "last_edit_date": 1583835120, "question_id": 53524539, "link": "https://stackoverflow.com/questions/53524539/convert-a-word-range-to-a-string-with-html-tags-in-vba", "title": "Convert a Word Range to a String with HTML tags in VBA", "body": "<p>I have a Word document and I need to copy some paragraph of it into a string in VBA. When doing so, the text formatting must be converted to HTML tags. For example if my paragraph looks like this:</p>\n\n<p>Hello I am <strong>Alice</strong>.</p>\n\n<p>I want to get a string that contains:</p>\n\n<pre><code>Hello I am &lt;b&gt;Alice&lt;/b&gt;\n</code></pre>\n\n<p>(And it would be great if it also work for bulleted list and other kind of formatting).</p>\n\n<p>I am using Microsoft Visual Basic for Applications 7.0.\nI am new to VBA and a lot of code I found on Internet does not work for me because my version is old. Unfortunately, downloading a more recent version is not an option in my case. </p>\n\n<p>Here is a code sample that works to convert a paragraph to a string without formatting:</p>\n\n<pre><code>Dim pParagraph As Paragraph\n'... at some point, pParagraph is set to a paragraph of the document\n\nDim pRange As Range\nDim pString As String\nSet pRange = ActiveDocument.Range(Start:=pParagraph.Range.Start, End:=pParagraph.Range.End - 1)\npString = Trim(pRange.Text)\n</code></pre>\n\n<p>I did some research on Internet and found the advise to copy the Range to the clipboard and to use <code>Clipboard.getText</code>. Unfortunately <code>Clipboard.getText</code> does not even compile for me.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1543424417, "post_id": 53524504, "comment_id": 93917941, "body": "&quot;Regular&quot; csv files don&#39;t care what the encoding is. What encoding does pandas expect them to be in?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1543425205, "post_id": 53524504, "comment_id": 93918373, "body": "You may use simple <code>ReadTextFile</code> and <code>WriteTextFile</code> functions from <a href=\"https://stackoverflow.com/a/43265363/2165759\">here</a> to read the content of the files in Unicode and then save them in ASCII."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3779318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a710f66d5b986a19b17f0e55222d31?s=128&d=identicon&r=PG&f=1", "display_name": "user3779318", "link": "https://stackoverflow.com/users/3779318/user3779318"}, "edited": false, "score": 0, "creation_date": 1543511425, "post_id": 53527889, "comment_id": 93955117, "body": "I found a solution. Thanks for the reply. I succeeded using the &#39;data.table&#39; package in R. It imports the files as tibbles which are easy to save as regular csv files. I&#39;m a Python fan esp Pandas but it falls down on reading irregular data types. I tried the encoding = &#39;utf-8&#39; argument but it did not work. R has much better data reading packages in my opinion."}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": false, "score": 0, "last_activity_date": 1543438188, "creation_date": 1543438188, "answer_id": 53527889, "question_id": 53524504, "link": "https://stackoverflow.com/questions/53524504/vba-to-onverting-multiple-unicode-text-files-to-regular-csv-these-text-files-ha/53527889#53527889", "title": "VBA to onverting multiple Unicode Text files to regular csv. These Text Files have a csv extension", "body": "<p>Before you modify the CSV (via VBA), try passing an argument to the <code>encoding</code> parameter of <code>pandas.read_csv()</code>.</p>\n\n<p>As I understand it, <code>encoding</code> defaults to your system's settings (which might be <code>'cp1252'</code> if your regional settings are some variant of English).</p>\n\n<p>To override this implicit behaviour, you can try passing <code>encoding='utf-8'</code> (or <code>encoding='utf-8-bom'</code> might be necessary instead), which should then allow <code>pandas</code> to decode/work with Unicode characters.</p>\n\n<p>Say you have imported <code>pandas</code> under the namespace <code>pd</code> and your file is at <code>C:\\some_folder\\ok.csv</code> (on Windows):</p>\n\n<pre><code>import pandas as pd\n\ndf = pd.read_csv('C:\\\\some_folder\\\\ok.csv', encoding='utf-8')\n\nprint(df.head())\n</code></pre>\n\n<p>Worth trying in my opinion, as it could be a quick fix.</p>\n\n<p>(Other option might be to import some Python library which can attempt to infer the file's encoding, then use that particular encoding, but this is obviously more work.</p>\n\n<p>Also, you may lose information/bytes when forcefully coercing Unicode to ASCII, depending on whether there are any non-ASCII characters.)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3779318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a710f66d5b986a19b17f0e55222d31?s=128&d=identicon&r=PG&f=1", "display_name": "user3779318", "link": "https://stackoverflow.com/users/3779318/user3779318"}, "is_accepted": false, "score": 0, "last_activity_date": 1543511645, "creation_date": 1543511645, "answer_id": 53544306, "question_id": 53524504, "link": "https://stackoverflow.com/questions/53524504/vba-to-onverting-multiple-unicode-text-files-to-regular-csv-these-text-files-ha/53544306#53544306", "title": "VBA to onverting multiple Unicode Text files to regular csv. These Text Files have a csv extension", "body": "<p>'This works in R'. I will switch back to Python/Pandas for further work now. R is excellent at reading messy data'</p>\n\n<p>install.packages('data.table') \nlibrary(data.table)</p>\n\n<p>fileNames &lt;- Sys.glob(\"C:/Users/fkean/TOS_csv/QCfiles/<em>.</em>\")</p>\n\n<p>for (f in fileNames) {</p>\n\n<p>sample &lt;- read_csv(f,skip=2)\n  write_csv(sample,f,append=FALSE)</p>\n\n<p>}</p>\n"}], "owner": {"reputation": 1, "user_id": 3779318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a710f66d5b986a19b17f0e55222d31?s=128&d=identicon&r=PG&f=1", "display_name": "user3779318", "link": "https://stackoverflow.com/users/3779318/user3779318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543511645, "creation_date": 1543424270, "last_edit_date": 1543424366, "question_id": 53524504, "link": "https://stackoverflow.com/questions/53524504/vba-to-onverting-multiple-unicode-text-files-to-regular-csv-these-text-files-ha", "title": "VBA to onverting multiple Unicode Text files to regular csv. These Text Files have a csv extension", "body": "<p>I have hours trying out code posted here on SO. They open the files successfully but when they are saved, they are still in Unicode Text format and Python pandas csv_reader won't read them. Here is my latest and greatest attempt. My files are in subfolder \"QCfiles\":</p>\n\n<pre><code>Sub LoopExample()\n\nDim MyFolder As String, MyFile As String\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .AllowMultiSelect = False\n    .Show\n    MyFolder = .SelectedItems(1)\n    Err.Clear\nEnd With\n\nApplication.ScreenUpdating = False\n\nMyFile = Dir(MyFolder &amp; \"\\\", vbReadOnly)\n\nDo While MyFile &lt;&gt; \"\"\n    Workbooks.Open FileName:=MyFolder &amp; \"\\\" &amp; MyFile, UpdateLinks:=False\n    MsgBox Cells(1, 1)\n    ActiveWorkbook.SaveAs FileName:=MyFile, FileFormat:=xlCSV\n    Workbooks(MyFile).Close savechanges:=True\n    MyFile = Dir\nLoop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "class", "events", "combobox"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543424562, "post_id": 53524350, "comment_id": 93918027, "body": "<code>Private customBox() As New DB_ComboBox</code> is rather suspicious, and has all ingredients for a nice memory leak. Drop the <code>As New</code> there. Why not just use a <code>Collection</code>?"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1543424751, "post_id": 53524350, "comment_id": 93918123, "body": "+You add a dropdown (form control) instead of an ActiveX control"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10670606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/422a2bd74f09afa57ded0a6056390dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Ftoso91", "link": "https://stackoverflow.com/users/10670606/ftoso91"}, "edited": false, "score": 0, "creation_date": 1543488643, "post_id": 53524679, "comment_id": 93942040, "body": "Thank you, I modified my code but I still have some problems as you can see. Regarding using a Collection instead of an array, I will surely change this if it is necessary, but first I would like to be sure that the remaining code works propoerly (my experience with VBA is very limited, and my experience with VBA Collections is null so far). Thanks also to @EvR"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 25, "user_id": 10670606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/422a2bd74f09afa57ded0a6056390dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Ftoso91", "link": "https://stackoverflow.com/users/10670606/ftoso91"}, "edited": false, "score": 1, "creation_date": 1543495404, "post_id": 53524679, "comment_id": 93945760, "body": "For object properties, you need a <code>Property Set</code>; property <code>Let</code> is for value assignments, not objects. Also change the type back to <code>MSForm.ComboBox</code>, since you&#39;re setting it to <code>OleObject.Object</code>, which is a msforms combobox."}, {"owner": {"reputation": 25, "user_id": 10670606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/422a2bd74f09afa57ded0a6056390dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Ftoso91", "link": "https://stackoverflow.com/users/10670606/ftoso91"}, "edited": false, "score": 0, "creation_date": 1543499804, "post_id": 53524679, "comment_id": 93948275, "body": "Thank you Mathieu, it works now. Thank you for the great explanation"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1543424835, "creation_date": 1543424835, "answer_id": 53524679, "question_id": 53524350, "link": "https://stackoverflow.com/questions/53524350/vba-handling-events-from-many-comboboxes-using-class/53524679#53524679", "title": "VBA - Handling Events from many Comboboxes, using class", "body": "<p>Implicit default member references strike again!</p>\n\n<p>You're missing a <code>Set</code> keyword:</p>\n\n<pre><code>Set customBox(IncCBoxes - DBRigaInizioErrori).Box = curCombo\n</code></pre>\n\n<p>Without the <code>Set</code> keyword, what you're assigning is <code>.Box.Value</code> on LHS, which can't be right.</p>\n\n<p>But there's another problem.</p>\n\n<pre><code>    Set curCombo = .Shapes.AddFormControl(xlDropDown, _\n                                      Left:=rng.Left, _\n                                      Top:=rng.Top, _\n                                      Width:=rng.Width, _\n                                      Height:=rng.Height)\n</code></pre>\n\n<p>That's not a <code>MSForm.ComboBox</code> control, that's an <code>Excel.ComboBox</code>. You need to add an ActiveX control, not a \"form control\". <a href=\"https://stackoverflow.com/a/38615563/1188513\">This answer</a> covers it.</p>\n"}], "owner": {"reputation": 25, "user_id": 10670606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/422a2bd74f09afa57ded0a6056390dc9?s=128&d=identicon&r=PG&f=1", "display_name": "Ftoso91", "link": "https://stackoverflow.com/users/10670606/ftoso91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 53524679, "answer_count": 1, "score": 0, "last_activity_date": 1543488202, "creation_date": 1543423717, "last_edit_date": 1543488202, "question_id": 53524350, "link": "https://stackoverflow.com/questions/53524350/vba-handling-events-from-many-comboboxes-using-class", "title": "VBA - Handling Events from many Comboboxes, using class", "body": "<p>I have the following issue.</p>\n\n<p>My VBA program generates dinamically many comboboxes as I expected.</p>\n\n<p>The problem comes when I try to handle their change-events. Searching on the web I saw that a class module is needed in these situations, so that's what I did.</p>\n\n<p>Here is my class-module-code (class name: DB_ComboBox)</p>\n\n<pre><code>    Private WithEvents DB_ComboBoxEvents As MSForms.ComboBox\n    Private DB_ComboBox_Line As Integer\n\n    Private Sub DB_ComboBoxEvents_Change()\n        MsgBox (\"Line : \" &amp; DB_ComboBox_Line)\n        'Here I will handle The comboboxes changes\n    End Sub\n\n    Public Property Let Box(value As MSForms.ComboBox)\n        Set DB_ComboBoxEvents = value\n    End Property\n    Public Property Get Box() As MSForms.ComboBox\n        Set Box = DB_ComboBoxEvents\n    End Property\n\n\n    Public Property Let Line(value As Integer)\n        DB_ComboBox_Line = value\n    End Property\n\n    Public Property Get Line() As Integer\n        Line = DB_ComboBox_Line\n    End Property\n</code></pre>\n\n<p>Here the (simplified) code-portion in which I generate the comboboxes. As you can see, I'm trying to insert all the comboboxes into the array \"customBox()\"</p>\n\n<pre><code>Option Explicit\n\nPrivate customBox() As New DB_ComboBox\n\nDim G_DBRigaInizioErrori As Integer\nDim G_IncBoxes As Integer\n\nG_DBRigaInizioErrori = 5\n\nFor G_IncBoxes = G_DBRigaInizioErrori To 10\n    CreateComboBox G_DBRigaInizioErrori, G_IncBoxes\nNext\n\n\nSub CreateComboBox(DBRigaInizioErrori, IncCBoxes)\n\n    Dim curCombo As Object\n    Dim ws As Worksheet\n    Dim rng As Range\n\n\n    ReDim Preserve customBox(IncCBoxes - DBRigaInizioErrori)\n\n\n    Set ws = ActiveSheet\n\n    With ws\n\n        Set rng = .Range(\"J\" &amp; IncCBoxes)\n\n\n        Set curCombo = .Shapes.AddFormControl(xlDropDown, _\n                                          Left:=rng.Left, _\n                                          Top:=rng.Top, _\n                                          Width:=rng.Width, _\n                                          Height:=rng.Height)\n\n\n        With curCombo\n\n            .ControlFormat.AddItem \"1\", 1\n            .name = \"myCombo\" &amp; IncCBoxes\n\n        End With\n\n        Set customBox(IncCBoxes - DBRigaInizioErrori) = New DB_ComboBox\n        customBox(IncCBoxes - DBRigaInizioErrori).Box = curCombo\n        customBox(IncCBoxes - DBRigaInizioErrori).Line = IncCBoxes\n\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>When I run this, I get the error \"13\" (not corresponding type) on the following line:</p>\n\n<pre><code>    customBox(IncCBoxes - DBRigaInizioErrori).Box = curCombo\n</code></pre>\n\n<p>How can I fix this?</p>\n\n<p>Thank you in advance</p>\n\n<p>EDIT</p>\n\n<p>Basing on the suggestions, I made the following changes:</p>\n\n<p>1) Class Module</p>\n\n<pre><code>        Private WithEvents DB_ComboBoxEvents As Excel.OLEObject\n    Private DB_ComboBox_Line As Integer\n\n    Private Sub DB_ComboBoxEvents_Change()\n        MsgBox (\"Line : \" &amp; DB_ComboBox_Line)\n        'Here I will handle The comboboxes changes\n    End Sub\n\n    Public Property Let Box(value As Excel.OLEObject)\n        Set DB_ComboBoxEvents = value\n    End Property\n    Public Property Get Box() As Excel.OLEObject\n        Set Box = DB_ComboBoxEvents\n    End Property\n\n\n    Public Property Let Line(value As Integer)\n        DB_ComboBox_Line = value\n    End Property\n\n    Public Property Get Line() As Integer\n        Line = DB_ComboBox_Line\n    End Property\n</code></pre>\n\n<p>(I'm not sure about \"Excel OLEObject\", but the compiler doesn't complain , so I guess it is compatible with \"WIthEvents\")</p>\n\n<p>\"Main\" Module:</p>\n\n<pre><code>    Option Explicit\n\n    Private customBox() As New DB_ComboBox\n\n    Dim G_DBRigaInizioErrori As Integer\n    Dim G_IncBoxes As Integer\n\n    G_DBRigaInizioErrori = 5\n\n    For G_IncBoxes = G_DBRigaInizioErrori To 10\n        CreateComboBox G_DBRigaInizioErrori, G_IncBoxes\n    Next\n\n\n    Sub CreateComboBox(DBRigaInizioErrori, IncCBoxes)\n\n        Dim curCombo As Object\n        Dim rng As Range\n        Dim tot_items As Integer\n        Dim incAddItem As Integer\n\n        ReDim Preserve customBox(IncCBoxes - DBRigaInizioErrori)\n\n\n        tot_items = 5\n\n        Set rng = ActiveSheet.Range(\"J\" &amp; IncCBoxes)\n        Set curCombo = ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.ComboBox.1\", Link:=False, DisplayAsIcon:=False, Left:=rng.Left, Top:=rng.Top, Width:=rng.Width, Height:=rng.Height).Object\n\n\n        For incAddItem = 1 To tot_items\n            curCombo.AddItem \"Hi\"\n        Next\n\n        Set customBox(IncCBoxes - DBRigaInizioErrori) = New DB_ComboBox\n        Set customBox(IncCBoxes - DBRigaInizioErrori).Box = curCombo\n        customBox(IncCBoxes - DBRigaInizioErrori).Line = IncCBoxes\n\n\n    End Sub\n</code></pre>\n\n<p>When I run this, I manage to create the first ComboBox (along with its items), but then I get an error \"91\" --> I verified that the execution  stops at the following line</p>\n\n<pre><code>Set customBox(IncCBoxes - DBRigaInizioErrori).Box = curCombo\n</code></pre>\n\n<p>Any further help would be really appreciated</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["vba", "dictionary"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 2, "creation_date": 1543422248, "post_id": 53523869, "comment_id": 93916722, "body": "You have to use \u201cSet\u201d keyword : Set dict = CreateObject(&quot;Scripting.Dictionary&quot;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543422900, "post_id": 53523869, "comment_id": 93917079, "body": "Are you 100% sure <code>dict</code> is declared <code>As Object</code>? The only way I can see a no-set assignment working is with <code>Dim dict</code> or <code>Dim dict As Variant</code>."}, {"owner": {"reputation": 2777, "user_id": 3406483, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8921851c87c9bf835ce733788720463a?s=128&d=identicon&r=PG", "display_name": "redOctober13", "link": "https://stackoverflow.com/users/3406483/redoctober13"}, "edited": false, "score": 0, "creation_date": 1543422902, "post_id": 53523869, "comment_id": 93917081, "body": "Sorry, I neglected that when I typed in the example. I have <code>Set</code> in my code. Again, it works for me and for many past clients, just this one dictionary for this one client. If I convert this one to using the <code>new Scripting.Dictionary</code> but leave the rest, it runs fine too, so it&#39;s not even the syntax that is a problem, just something hanging. Perhaps there&#39;s a race condition where the declaration isn&#39;t done quickly enough? But actually I tried making <code>dict</code> a global at the top of the module, and that didn&#39;t make a difference."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543422935, "post_id": 53523869, "comment_id": 93917098, "body": "Declarations aren&#39;t executable statements, it&#39;s not it"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1543424349, "post_id": 53523869, "comment_id": 93917911, "body": "I&#39;m not sure what you mean by &quot;it&#39;s not practical for me to tell every client user to add the runtime reference&quot;. <i>Your</i> workbook would have the reference, not the clients&#39;. That said, it might simply be a registry issue.  Try instantiating it from the clsid:  <code>Set dict = CreateObject(&quot;new:EE09B103-97E0-11CF-978F-00A02463E06F&quot;)</code>"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1543426792, "post_id": 53523869, "comment_id": 93919235, "body": "So, there are many lines <code>... = CreateObject(&quot;Scripting.Dictionary&quot;)</code> in the workbook, and the only one of them, only on one PC isn&#39;t working? You may open the workbook without enabling macro in the dialog on the top, save the workbook and close it. Then open again as usual."}, {"owner": {"reputation": 2777, "user_id": 3406483, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8921851c87c9bf835ce733788720463a?s=128&d=identicon&r=PG", "display_name": "redOctober13", "link": "https://stackoverflow.com/users/3406483/redoctober13"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543428683, "post_id": 53523869, "comment_id": 93920095, "body": "@Comintern References are set on the user&#39;s side via the VB Editor, they&#39;re not a per-file setting. That&#39;s why I&#39;m using late binding (<code>... as Object</code>). Interested about your CSID idea though; how did you find out which one to use?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543429683, "post_id": 53523869, "comment_id": 93920553, "body": "@redOctober13 No, references are per <i>project</i>, which makes them per file. Re the CLSID, I just popped scrrun.dll open in OLEView and pulled it from the TypeLib."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1543435267, "post_id": 53523869, "comment_id": 93923234, "body": "Can you post a link to the file?"}, {"owner": {"reputation": 2777, "user_id": 3406483, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8921851c87c9bf835ce733788720463a?s=128&d=identicon&r=PG", "display_name": "redOctober13", "link": "https://stackoverflow.com/users/3406483/redoctober13"}, "edited": false, "score": 0, "creation_date": 1543514825, "post_id": 53523869, "comment_id": 93956798, "body": "I can&#39;t unfortunately, it&#39;s proprietary"}], "owner": {"reputation": 2777, "user_id": 3406483, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8921851c87c9bf835ce733788720463a?s=128&d=identicon&r=PG", "display_name": "redOctober13", "link": "https://stackoverflow.com/users/3406483/redoctober13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543422759, "creation_date": 1543422009, "last_edit_date": 1543422759, "question_id": 53523869, "link": "https://stackoverflow.com/questions/53523869/vba-createobject-error-in-only-one-instance", "title": "VBA CreateObject error in only one instance", "body": "<p>I have a macro-enabled workbook I send to clients to do some light data processing, and at one point I have this code:</p>\n\n<pre><code>Dim dict as Object\nset dict = CreateObject(\"Scripting.Dictionary\")\n</code></pre>\n\n<p>This has worked for most clients for many years, but a recently client said the workbook wasn't doing its thing, so I discovered it was bombint at this line with an <code>Object not found</code> error. I had them add the reference via the Tools menu to the \"Microsoft Scripting Runtime\" and then changed the line to</p>\n\n<pre><code>dict = new Dictionary\n</code></pre>\n\n<p>and then it ran fine. </p>\n\n<p>But the weird thing is that there are multiple dictionaries used, all of them initialized with <code>CreateObject</code> yet it's only this one line that bombing. The workbook runs fine as-is on my computer, and on a colleague's computer. Versions of Excel amongst everyone is the same. I even made sure the client had saved the workbook to their desktop and not a protected Downloads folder, and that it didn't say \"Compatibility Mode\" when opened. So I'm about out of ideas as to why this is happening for this one client since I can't reproduce the error, but have tried to eliminate all the variables. It's not practical for me to tell every client user to add the runtime reference, hence the use of <code>CreateObject()</code>. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "putty"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543476203, "post_id": 53525991, "comment_id": 93935132, "body": "Hi! thanks! I&#39;m working on a citrix session within customer network and I have no access to any other tools than the ones already installed (I cannot install anything, not even can I run &quot;cmd&quot; directly, I had to invoke shell using vba in xls). So, I should stick to vba+putty."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543476358, "post_id": 53525991, "comment_id": 93935198, "body": "Plink comes with PuTTY. It&#39;s the same package."}, {"owner": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543479394, "post_id": 53525991, "comment_id": 93936553, "body": "Really, I tried many examples posted here and it would not work, somehow the customer disabled it. The Putty folder does show &quot;PLINK&quot; but whenever I click on it, it sends me a message saying the file cant be found and the shorcut will be removed. Or if I try to use a bat to execute plink (just to test if it&#39;s there somewhere), it wont even open the promt."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543479593, "post_id": 53525991, "comment_id": 93936647, "body": "OK. What about using the <code>-m</code> switch? Do you really have to wait between the commands?"}, {"owner": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543480477, "post_id": 53525991, "comment_id": 93937113, "body": "I tried too, but this is another detail: the initial connection to the host is done thru ssh, from there you have to go to a TL1 session and it is there where you have to send a new authentication and then the TL1 commands. So, TL1 interface does not really work like common CLIs, if I create a file witht he commands and then use the -m switch, when putty pulls them it will only &quot;paste&quot; them, but it wont be executed, so no useful output is received."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543480617, "post_id": 53525991, "comment_id": 93937183, "body": "OK, then as the last resort option, you can enable session output logging in PuTTY and monitor the log for some keywords, to decide when to send the next keystrokes."}, {"owner": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543482890, "post_id": 53525991, "comment_id": 93938419, "body": "Yes... well, as you can see, the resources are very limited and I do not have much operation margin. The way I&#39;m running it currently does not really allow me to open the putty log file to monitor it, because it&#39;s being used to save the current output: the script is writing on it as the commands are executed, so I cannot open the file and check if the command was already executed, because that would take me back to first stage (when should I look? how much time I should wait?). But I really appreciate you took the time to take a look at this. Thanks a bunch!"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543483112, "post_id": 53525991, "comment_id": 93938581, "body": "<i>&quot;the script is writing on it as the commands are executed, so I cannot open the file and check if the command was already executed&quot;</i> - I do not understand why you cannot."}, {"owner": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543562462, "post_id": 53525991, "comment_id": 93971504, "body": "Because I would have to open the log, right? but it&#39;s being written by putty, so: putty executes command and starts writing the log, if I open the log thru vba to monitor, for that fraction of time, putty wont be able to write on the log file, until I close it, correct? that&#39;s what happens when I manually open the log: while it&#39;s open, putty cannot write on it, even when the putty commands are executed. So I would need another timer to wait for the command to complete and then open the log and check. But timers is precisely what I&#39;m trying to avoid."}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "edited": false, "score": 0, "creation_date": 1543563162, "post_id": 53525991, "comment_id": 93971762, "body": "PuTTY has the log file open for writing for whole duration of the session. So there&#39;s no way you can prevent it from continuing with writing (of course, unless you open the log file with a write lock even before PuTTY starts logging)."}], "tags": [], "owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "is_accepted": false, "score": 0, "last_activity_date": 1543480629, "last_edit_date": 1543480629, "creation_date": 1543430206, "answer_id": 53525991, "question_id": 53523853, "link": "https://stackoverflow.com/questions/53523853/putty-output-trigers-vba-script-action/53525991#53525991", "title": "Putty output trigers vba script action", "body": "<p>Do not use PuTTY. That's a GUI application, not intended for automation.</p>\n\n<p>Use <a href=\"https://the.earth.li/~sgtatham/putty/latest/htmldoc/Chapter7.html\" rel=\"nofollow noreferrer\">Plink</a> from PuTTY package. Plink is a console application intended for automation. It uses standard input/output, so that you do not have to hack sending of command by simulating keystokes.</p>\n\n<p>Why do you even execute command this way? Why don't you specify a script file using <a href=\"https://the.earth.li/~sgtatham/putty/latest/htmldoc/Chapter3.html#using-cmdline-m\" rel=\"nofollow noreferrer\"><code>-m</code> switch</a>?</p>\n\n<p>See <a href=\"https://stackoverflow.com/q/39361444/850848\">Automating command/script execution using PuTTY</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10705245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2277500395633947/picture?type=large", "display_name": "Fingo", "link": "https://stackoverflow.com/users/10705245/fingo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1543480629, "creation_date": 1543421966, "question_id": 53523853, "link": "https://stackoverflow.com/questions/53523853/putty-output-trigers-vba-script-action", "title": "Putty output trigers vba script action", "body": "<p>some context first, Im using vba to automate putty into loging into many host with ssh retrieve info and save it.</p>\n\n<p>I can do that currently, however, each time I execute a command, I have to set some waiting time just so the command is correctly executed and then I can execute next command. Is there any way to feeback from Putty output into vba so vba knows when to send next command? that would reduce execution time </p>\n\n<pre><code>sub retrievinginfo() \n\nLines to ssh open putty to X host  \n</code></pre>\n\n<p><code>SendKeys \"first command for putty session\"</code></p>\n\n<p><code>Application.wait Now+Timeserial(0,0,\"estimated seconds\") '&lt;---- here the problem</code></p>\n\n<pre><code>SendKeys \"second command for putty session\"\n</code></pre>\n\n<p>end</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1543421237, "post_id": 53523570, "comment_id": 93916093, "body": "One way to do this is to select the cells that CAN be changed, right-click and choose Format Cells. On the protection tab, unchecked &quot;Locked.&quot; Then click on the Review tab, and choose Protect sheet, enter a password, and then save the file."}, {"owner": {"reputation": 39, "user_id": 10705813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dJCv8J4HiTQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hkEVhA6kzTNTllLC2P1UC2XneQJQ/mo/photo.jpg?sz=128", "display_name": "Devilhunter", "link": "https://stackoverflow.com/users/10705813/devilhunter"}, "reply_to_user": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1543421614, "post_id": 53523570, "comment_id": 93916327, "body": "Yes, the protection already crossed my mind but the values of this range would constantly change, and so once it would work, but other time it wouldn&#39;t."}, {"owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1543421733, "post_id": 53523570, "comment_id": 93916416, "body": "You&#39;re creating these puzzles with VBA, I&#39;m assuming? If you are, can&#39;t you use that to lock/unlock certain cells?"}, {"owner": {"reputation": 39, "user_id": 10705813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dJCv8J4HiTQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hkEVhA6kzTNTllLC2P1UC2XneQJQ/mo/photo.jpg?sz=128", "display_name": "Devilhunter", "link": "https://stackoverflow.com/users/10705813/devilhunter"}, "reply_to_user": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "edited": false, "score": 0, "creation_date": 1543422222, "post_id": 53523570, "comment_id": 93916700, "body": "Yes, that is correct I&#39;m using VBA. I was trying to do it like that in the first place, but couldn&#39;t find a solution unfortunately. I&#39;ll keep looking though."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10705813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dJCv8J4HiTQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hkEVhA6kzTNTllLC2P1UC2XneQJQ/mo/photo.jpg?sz=128", "display_name": "Devilhunter", "link": "https://stackoverflow.com/users/10705813/devilhunter"}, "edited": false, "score": 1, "creation_date": 1543423276, "post_id": 53524066, "comment_id": 93917308, "body": "Thank you for your clarification of the cell&#39;s behaviour in excel, extensionhelp! I used similar technique to solve the problem too, just right before you posted your answer. I appreciate your time and solution for solving this problem with me."}], "tags": [], "owner": {"reputation": 494, "user_id": 10581807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebae5a589919e09b87559b0a6f19ef2b?s=128&d=identicon&r=PG&f=1", "display_name": "extensionhelp", "link": "https://stackoverflow.com/users/10581807/extensionhelp"}, "is_accepted": false, "score": 0, "last_activity_date": 1543422705, "creation_date": 1543422705, "answer_id": 53524066, "question_id": 53523570, "link": "https://stackoverflow.com/questions/53523570/vba-validation-in-a-selected-range/53524066#53524066", "title": "VBA Validation in a selected range", "body": "<p>Based on the comments above, it sounds like Locking/Unlocking the cells with VBA is your best option. Every cell within a sheet is locked by default, but the locking doesn't take effect until you Protect the sheet. As you're generating the puzzle, unlock specific cells with something like:</p>\n\n<pre><code>ActiveSheet.Range(\"A1\").Locked = False\n</code></pre>\n\n<p>After you've generated the puzzle, protect the sheet with:</p>\n\n<pre><code>ActiveSheet.Protect Password:=\"SomePassword\", DrawingObjects:=True, Contents:=True, Scenarios:=True _\n, AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n</code></pre>\n\n<p>If, within the macro, you need to unprotect a sheet, you would use:</p>\n\n<pre><code>ActiveSheet.UnProtect Password:=\"YourPassword\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 10705813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dJCv8J4HiTQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hkEVhA6kzTNTllLC2P1UC2XneQJQ/mo/photo.jpg?sz=128", "display_name": "Devilhunter", "link": "https://stackoverflow.com/users/10705813/devilhunter"}, "is_accepted": true, "score": 1, "last_activity_date": 1543422741, "creation_date": 1543422741, "answer_id": 53524074, "question_id": 53523570, "link": "https://stackoverflow.com/questions/53523570/vba-validation-in-a-selected-range/53524074#53524074", "title": "VBA Validation in a selected range", "body": "<p>Inspired on extensionhelp's questions, I figured out a way to restrict the cells that contain values. Here is the code if anyone is wondering about it:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nDim Rng\nDim MyCell\n\nSet Rng = Range(\"B2:J10\")\nFor Each MyCell In Rng\n    If MyCell.Value = \"\" Then\n\n    Else: ActiveSheet.Unprotect\n        ActiveSheet.Protect Contents:=True\n    End If\nNext \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10705813, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dJCv8J4HiTQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hkEVhA6kzTNTllLC2P1UC2XneQJQ/mo/photo.jpg?sz=128", "display_name": "Devilhunter", "link": "https://stackoverflow.com/users/10705813/devilhunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 53524074, "answer_count": 2, "score": -1, "last_activity_date": 1543510043, "creation_date": 1543421030, "last_edit_date": 1543510043, "question_id": 53523570, "link": "https://stackoverflow.com/questions/53523570/vba-validation-in-a-selected-range", "title": "VBA Validation in a selected range", "body": "<p>I can't seem to get my validation working properly on the example below. I want to restrict the user so that he/she can't overwrite the numbers with any kind of number or letter which are already in the cells.(for example: if there is a 9 in a cell, and he/she wants to overwrite it to 8, don't let it, just pop an error message and reset it to the original value). I've tried several restrictions both in vba and in excel's data --> validation option and watched numerous videos, but i can't seem to figure it out, thought it must be some trivial command I just don't know it. The catch is, that the values would change constantly in the range, and so i can't just select the cells that do have value in them. </p>\n\n<p>The selected range of this would be B2:J10.</p>\n\n<p><a href=\"https://i.stack.imgur.com/QjGsE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QjGsE.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "number-formatting"], "comments": [{"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1543423263, "post_id": 53523557, "comment_id": 93917295, "body": "Your quotes are wrong <code>&quot;&amp;&quot;&quot;Times New Roman,Regular&quot;&quot;&amp;12Page &amp;U  &quot; &amp; pg &amp; &quot;  &amp;U          &quot;</code>"}, {"owner": {"reputation": 111, "user_id": 7762568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce580669a7517133e09ef7095f58171?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin", "link": "https://stackoverflow.com/users/7762568/dustin"}, "reply_to_user": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "edited": false, "score": 0, "creation_date": 1543423749, "post_id": 53523557, "comment_id": 93917595, "body": "thanks, I&#39;m almost certain that this would have worked for the thrust of the question I did the famous post a question then keep working on the problem and stumbled onto a usable solution. The use of white characters in my answer below is something that I&#39;ve seen other people struggling with."}], "answers": [{"tags": [], "owner": {"reputation": 111, "user_id": 7762568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce580669a7517133e09ef7095f58171?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin", "link": "https://stackoverflow.com/users/7762568/dustin"}, "is_accepted": false, "score": 1, "last_activity_date": 1543423438, "creation_date": 1543423438, "answer_id": 53524262, "question_id": 53523557, "link": "https://stackoverflow.com/questions/53523557/excel-vba-start-and-stop-underlining-within-a-footer-with-a-variable/53524262#53524262", "title": "Excel VBA Start and Stop Underlining within a footer with a Variable", "body": "<pre><code>With WS.PageSetup\n    .RightFooter = \"&amp;\"\"Times New Roman\"\"&amp;12 Page\" &amp; \"&amp;U  A-\" &amp; pg &amp; \"    \" &amp; \"&amp;U\" &amp; \"&amp;KFFFFFF PPPPPPPPPPPPPPPPPP\"\nEnd With\n</code></pre>\n\n<p>So I figured out the syntax and realized that trailing spaces would not reorient my text to the left so I had to switch to making some text white and using invisible characters to push the block that I wanted further left. This is what I came up with and its working for me, hope this can help some other soul in the future trying to align text within a footer.</p>\n"}], "owner": {"reputation": 111, "user_id": 7762568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce580669a7517133e09ef7095f58171?s=128&d=identicon&r=PG&f=1", "display_name": "Dustin", "link": "https://stackoverflow.com/users/7762568/dustin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582499518, "creation_date": 1543420995, "last_edit_date": 1582499518, "question_id": 53523557, "link": "https://stackoverflow.com/questions/53523557/excel-vba-start-and-stop-underlining-within-a-footer-with-a-variable", "title": "Excel VBA Start and Stop Underlining within a footer with a Variable", "body": "<p>I would like to have a footer in the Rightfooter that has a string of text with a variable in it, no issues there but what I am finding some difficulty on is the syntax to begin underlining and terminate underlining at a specific point in the footer string. Basically, I need the work \"Page\" then 2 spaces that are underlined, then my page number which is generated by a variable also underlined, then 5 more spaces underlined thereafter, finally I need 10 more spaces not underlined in order to orient the footer to the correct position in the report that I am duplicating. Here is the code that I am attempting.</p>\n\n<pre><code>DIM pg as integer, WS as worksheet\n\npg = 14\n\nWith WS.PageSetup\n    .RightFooter = \"&amp;Time New Roman\"\"&amp;12\" &amp; \"Page\" \"&amp;U,  \" &amp; pg &amp; \"   \" \"&amp;U           \"\nEnd With\n</code></pre>\n\n<p>For this the first \"&amp;U, is getting an \"Expected End Statment error. There is gobs of code in this thing that have been QC'd and this is the last QC element that is hanging me up, any assistance would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543422197, "post_id": 53523173, "comment_id": 93916683, "body": "<code>Application</code> in <code>Application.FileDialog</code> refers to the Excel instance. If you want to continue using dialog boxes within Excel (as opposed to leveraging the <code>WordApp</code> instance), perhaps try the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.getsaveasfilename\" rel=\"nofollow noreferrer\"><code>Application.GetSaveAsFilename</code></a> method, which gets a filename without saving any files. Then use the filename it returns to save <code>WordDoc</code> using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.saveas2\" rel=\"nofollow noreferrer\"><code>SaveAs2</code></a> method."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1543431434, "post_id": 53523173, "comment_id": 93921400, "body": "Try &#39;Set dlgSaveAs = WordApp.Application.FileDialog( _     FileDialogType:=msoFileDialogSaveAs)     dlgSaveAs.Show&#39; to use a filedialog.  To just save the word document to the same folder you got it from use WordDoc.SaveAs2."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "is_accepted": false, "score": 1, "last_activity_date": 1549468126, "last_edit_date": 1549468126, "creation_date": 1543875820, "answer_id": 53602873, "question_id": 53523173, "link": "https://stackoverflow.com/questions/53523173/opening-and-saving-word-document-to-new-file-location-from-excel/53602873#53602873", "title": "Opening and Saving Word Document to new File Location from Excel", "body": "<p>Thank you BigBen your suggestion works well as long as the a word document format is selected.</p>\n\n<pre><code>Option Explicit\nSub Test()\n    Dim WordApp As Object, WordDoc As Object, path As String\n    Dim dlgSaveAs As FileDialog, fileSaveName As Variant\n\n    ' To get the code to function I had to include the Microsoft Word 16 Object\n    'Library.\n\n    'From the excel VBA editor window. Tools &gt; References then ensure Microsoft Word\n    '16.0 Object Library is checked.\n\n    ' Allows word document to be selected and opened\n    With Application.FileDialog(msoFileDialogOpen)\n    .Show\n    If .SelectedItems.Count = 1 Then\n        path = .SelectedItems(1)\n    End If\n    End With\n\n    If path = \"\" Then\n        Exit Sub\n    End If\n\n\n    Set WordApp = CreateObject(\"Word.Application\")\n    Set WordDoc = WordApp.Documents.Open(path)\n    WordApp.Visible = False\n\n    ' Allows word document to be saved under a different file location and name\n    fileSaveName = Application.GetSaveAsFilename( _\n    fileFilter:=\"Word Documents (*.docx), *.docx\")\n    WordApp.ActiveDocument.SaveAs2 Filename:=fileSaveName, _\n        FileFormat:=wdFormatDocumentDefault\n\n    WordApp.ActiveDocument.Close\n    WordApp.Quit\n\n    Set WordApp = Nothing\n    Set WordDoc = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10647946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16ab2317938eb82f228deb1263ecfd03?s=128&d=identicon&r=PG&f=1", "display_name": "JHEngr", "link": "https://stackoverflow.com/users/10647946/jhengr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549468126, "creation_date": 1543419811, "last_edit_date": 1543429551, "question_id": 53523173, "link": "https://stackoverflow.com/questions/53523173/opening-and-saving-word-document-to-new-file-location-from-excel", "title": "Opening and Saving Word Document to new File Location from Excel", "body": "<p>I am trying to open a word document from excel and then save as to a new file location using a dialog box.  </p>\n\n<p><strong>The problem is it saves the excel file rather than the word file that was opened.</strong></p>\n\n<pre><code>Option Explicit\nSub SaveWordDoc()\n    Dim WordApp As Object, WordDoc As Object, path As String\n    Dim dlgSaveAs As FileDialog\n\n    ' Allows word document to be selected and opened\n    With Application.FileDialog(msoFileDialogOpen)\n    .Show\n    If .SelectedItems.Count = 1 Then\n        path = .SelectedItems(1)\n    End If\n    End With\n\n    If path = \"\" Then\n        Exit Sub\n    End If\n\n\n    Set WordApp = CreateObject(\"Word.Application\")\n    Set WordDoc = WordApp.Documents.Open(path)\n    WordApp.Visible = False\n\n    'Opens Save As dialog box\n    Set dlgSaveAs = Application.FileDialog( _\n    FileDialogType:=msoFileDialogSaveAs)\n    dlgSaveAs.Show\n\n    WordApp.ActiveDocument.Close\n    WordApp.Quit\n    Set WordApp = Nothing\n    Set WordDoc = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "date", "filter"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543418545, "post_id": 53522605, "comment_id": 93914169, "body": "Note that if you want to include today, change <code>&quot;&gt;&quot;</code> to <code>&quot;&gt;=&quot;</code>."}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 0, "creation_date": 1543418661, "post_id": 53522605, "comment_id": 93914255, "body": "That still hides all rows"}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543418733, "post_id": 53522605, "comment_id": 93914317, "body": "Both suggestions so far from BigBen and Nathan_Sav do not work"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543418773, "post_id": 53522605, "comment_id": 93914348, "body": "Maybe share a screenshot of your table? Are the dates actually dates or <i>text-that-looks-like-a-date</i>?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1543418788, "post_id": 53522605, "comment_id": 93914359, "body": "does this work?  <code>&quot;&gt;&quot; &amp; format(date,&quot;dd&#47;mm&#47;yyyy&quot;)</code>"}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 0, "creation_date": 1543418823, "post_id": 53522605, "comment_id": 93914385, "body": "They are dates:"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543418853, "post_id": 53522605, "comment_id": 93914404, "body": "Can&#39;t reproduce your error - as requested, a screenshot would help."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543419679, "post_id": 53522605, "comment_id": 93914987, "body": "You should be able to get 90% of the code you need with the macro recorder - you might have to replace today&#39;s date with <code>Date</code>, but otherwise you&#39;ll have what you need."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543421889, "post_id": 53522605, "comment_id": 93916505, "body": "Thanks for the screenshots. Looks like dates. Can you record a macro while manually adding a date filter to keep dates after or equal to today, and then inspect the recorded code?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543422690, "post_id": 53522605, "comment_id": 93916957, "body": "Also remove the <code>On Error Resume Next</code> - does the code throw any errors?"}], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 1, "creation_date": 1543420315, "post_id": 53522854, "comment_id": 93915444, "body": "Didn&#39;t work, I&#39;m beginning to think the problem is my table not VBA"}, {"owner": {"reputation": 46, "user_id": 10717892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VC4jA.jpg?s=128&g=1", "display_name": "Rocoders", "link": "https://stackoverflow.com/users/10717892/rocoders"}, "reply_to_user": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 0, "creation_date": 1543420594, "post_id": 53522854, "comment_id": 93915651, "body": "Everyone asked you to provide a screenshot because Excel is &quot;dumb&quot; when it comes to dates. Make sure the col containing dates is formated as &quot;Date&quot; otherwise Excel treats the data as a simple text (string)."}, {"owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "edited": false, "score": 0, "creation_date": 1543421008, "post_id": 53522854, "comment_id": 93915941, "body": "Photos attached"}], "tags": [], "owner": {"reputation": 46, "user_id": 10717892, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VC4jA.jpg?s=128&g=1", "display_name": "Rocoders", "link": "https://stackoverflow.com/users/10717892/rocoders"}, "is_accepted": false, "score": 0, "last_activity_date": 1543418787, "creation_date": 1543418787, "answer_id": 53522854, "question_id": 53522605, "link": "https://stackoverflow.com/questions/53522605/vba-filter-to-hide-fdates-in-the-past-not-working/53522854#53522854", "title": "VBA filter to hide fdates in the past not working", "body": "<p>You bring dates starting from today; in fact Date is not used that way.</p>\n\n<p>For the past dates your filter must be: </p>\n\n<p>Criteria1:=\"&lt;\" &amp; Now()</p>\n"}], "owner": {"reputation": 58, "user_id": 7491234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d12825bdda14c356c67c74f7e823fa2?s=128&d=identicon&r=PG&f=1", "display_name": "Bing", "link": "https://stackoverflow.com/users/7491234/bing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543420964, "creation_date": 1543418042, "last_edit_date": 1543420964, "question_id": 53522605, "link": "https://stackoverflow.com/questions/53522605/vba-filter-to-hide-fdates-in-the-past-not-working", "title": "VBA filter to hide fdates in the past not working", "body": "<p><a href=\"https://i.stack.imgur.com/0LiVT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0LiVT.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/3soSv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3soSv.png\" alt=\"enter image description here\"></a>This code seems to filter all dates    </p>\n\n<pre><code>Sub AdDate()\n\nOn Error Resume Next\nActiveSheet.ListObjects(\"TableAOrders\").Range.AutoFilter Field:=1, Criteria1:=\"&gt;\" &amp; Date    \nOn Error GoTo 0\n\nEnd Sub\n</code></pre>\n\n<p>All I want filtered are all dates in the past.\nAny suggestions?</p>\n"}, {"tags": ["excel", "vba", "runtime-error"], "comments": [{"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1543418055, "post_id": 53522473, "comment_id": 93913840, "body": "They are defined in my original code. I edited it now."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1543418086, "post_id": 53522473, "comment_id": 93913861, "body": "Is the empty <code>Address</code> intentional? It&#39;s required by <code>Hyperlinks.Add</code>."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1543418107, "post_id": 53522473, "comment_id": 93913879, "body": "<code>Dim c1, r1, c2, r2 as Integer</code>, only r2 is an integer"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543418228, "post_id": 53522473, "comment_id": 93913959, "body": "You also probably need <code>.Text</code> instead of passing the <code>Range</code> to SubAddress and TextToDisplay - those take variants, so they won&#39;t be let coerced before the function call."}, {"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "edited": false, "score": 0, "creation_date": 1543418330, "post_id": 53522473, "comment_id": 93914029, "body": "why should only r2 be an integer? They are all variables for cell column/row number."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543418354, "post_id": 53522473, "comment_id": 93914044, "body": "@Comintern <code>Adress:=&quot;&quot;</code> means this document."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1543418439, "post_id": 53522473, "comment_id": 93914115, "body": "@J.schmidt don&#39;t ask me, it&#39;s by design in VB. You have to specify the type for each variable, even on the same line, else the other are Variant by default."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1543418559, "post_id": 53522473, "comment_id": 93914183, "body": "Use <code>Dim c1 as Integer, r1 as Integer, c2 as Integer, r2 as Integer</code> if you want all <code>Interger</code>. And BTW, there is no gain in using <code>Integer</code> instead of <code>Long</code>."}, {"owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1543418701, "post_id": 53522473, "comment_id": 93914293, "body": "@VincentG Thank you, good to know!"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 3, "creation_date": 1543418750, "post_id": 53522473, "comment_id": 93914330, "body": "If a variable is for rows DON&#39;T declare it as integer (use Long instead) as you will get overflow errors past 32767 rows."}], "answers": [{"tags": [], "owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "is_accepted": true, "score": 0, "last_activity_date": 1543418596, "creation_date": 1543418596, "answer_id": 53522793, "question_id": 53522473, "link": "https://stackoverflow.com/questions/53522473/excel-vba-runtime-error-5-using-hyperlink-function/53522793#53522793", "title": "Excel VBA runtime error 5 using hyperlink function", "body": "<p>You're missing the .Address and .Value   </p>\n\n<pre><code>Sub createhyperlink()\n    Dim c1 As Long, r1 As Long, c2 As Long, r2 As Long\n    c1 = 2\n    r1 = 2\n    c2 = 3\n    r2 = 3\n        Firstsheet.Hyperlinks.Add Anchor:=Firstsheet.Cells(c1, r1), _\n            Address:=\"\", _\n            SubAddress:=Firstsheet.Cells(c1, r1).Address, _\n            TextToDisplay:=Secondsheet.Cells(c2, r2).Value\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 10592083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4de56871e4961d2cf0476cbbdcc3d18?s=128&d=identicon&r=PG&f=1", "display_name": "J.schmidt", "link": "https://stackoverflow.com/users/10592083/j-schmidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 53522793, "answer_count": 1, "score": 2, "last_activity_date": 1545041428, "creation_date": 1543417625, "last_edit_date": 1545041428, "question_id": 53522473, "link": "https://stackoverflow.com/questions/53522473/excel-vba-runtime-error-5-using-hyperlink-function", "title": "Excel VBA runtime error 5 using hyperlink function", "body": "<p>I'm working on a programme where I use hyperlinks to call macros. Therefore I use hyperlink.add function. The function should create a hyperlink on my first spreadsheet with the information of my second spreadsheet. </p>\n\n<p>My problem is that I get a runtime error 5 using following code in my \"create hyperlink sub\". I don't see where the problem is. Hope you can help me.</p>\n\n<pre><code>Sub createhyperlink() \nDim c1, r1, c2, r2 as Integer\nc1=2\nr1=2\nc2=3\nr2=3\n    FirstSheet.Hyperlinks.Add Anchor:=FirstSheet.Cells(c1, r1), _\n        Address:=\"\", _\n        SubAddress:=Firstsheet.Cells(c1, r1), _\n        TextToDisplay:=SecondSheet.Cells(c2, r2)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1543418084, "post_id": 53522467, "comment_id": 93913859, "body": "Which line errors?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543419524, "post_id": 53522467, "comment_id": 93914872, "body": "Is <code>wsDispatchButtonsSheet</code> a sheet codename?"}, {"owner": {"reputation": 11, "user_id": 10717817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e6579f65b72343a1d74a975f7591f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenzie Reed", "link": "https://stackoverflow.com/users/10717817/kenzie-reed"}, "edited": false, "score": 0, "creation_date": 1543420379, "post_id": 53522467, "comment_id": 93915486, "body": "Yes! The sheet itself is named DispatchButtonsSheet."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543420575, "post_id": 53522467, "comment_id": 93915639, "body": "Which line errors then?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1543420734, "post_id": 53522467, "comment_id": 93915738, "body": "<code>The sheet itself is named DispatchButtonsSheet</code> -  as opposed to <code>wsDispatchButtonsSheet</code>? Is there <code>Option Explicit</code> on top?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1543424261, "post_id": 53522467, "comment_id": 93917864, "body": "@BigBen - perhaps it&#39;s some strange ritual whereby we have to ask 3 times."}, {"owner": {"reputation": 11, "user_id": 10717817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e6579f65b72343a1d74a975f7591f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenzie Reed", "link": "https://stackoverflow.com/users/10717817/kenzie-reed"}, "edited": false, "score": 0, "creation_date": 1543424625, "post_id": 53522467, "comment_id": 93918053, "body": "The line with the error is                                                                     WeightValue = wsDispatchButtonsSheet.Range(&quot;PackageWeight&quot;).Value"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1543425972, "post_id": 53522467, "comment_id": 93918840, "body": "1) What is <code>wsDispatchButtonsSheet</code>? 2) Has <code>PackageWeight</code> correct spelling?"}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1543426472, "post_id": 53524335, "comment_id": 93919077, "body": "Each sheet has a codename. It acts like a predefined variable of type <code>Worksheet</code>, and it&#39;s a much better way to refer to sheets from code than using the display name that the user can easily edit."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1543436474, "post_id": 53524335, "comment_id": 93923777, "body": "@GSerg- can you explain how you came up with that conclusion with the information given to us?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543437839, "post_id": 53524335, "comment_id": 93924360, "body": "@Davesexcel not my downvote but I think it was from <a href=\"https://stackoverflow.com/questions/53522467/run-time-424-error-in-vba-when-attempting-to-use-a-button-to-calculate-a-formu/53522675#comment93915486_53522467\">this comment</a> in response to my comment right before. Of course I suspected your answer was the issue all along."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": -1, "last_activity_date": 1543423696, "creation_date": 1543423696, "answer_id": 53524335, "question_id": 53522467, "link": "https://stackoverflow.com/questions/53522467/run-time-424-error-object-required-when-referencing-a-sheet/53524335#53524335", "title": "Run time &#39;424&#39; error Object Required when referencing a sheet", "body": "<p>You need to use the actual sheet name since you did not set a variable for the sheet.</p>\n\n<pre><code>WeightValue = Sheets(\"DispatchButtonsSheet\").Range(\"PackageWeight\").Value\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10717817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e6579f65b72343a1d74a975f7591f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Kenzie Reed", "link": "https://stackoverflow.com/users/10717817/kenzie-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 53524335, "answer_count": 1, "score": 0, "last_activity_date": 1582544453, "creation_date": 1543417608, "last_edit_date": 1582544453, "question_id": 53522467, "link": "https://stackoverflow.com/questions/53522467/run-time-424-error-object-required-when-referencing-a-sheet", "title": "Run time &#39;424&#39; error Object Required when referencing a sheet", "body": "<p>I would like to use VBA to calculate the following linear formula: y = 0.0069x + 17.631</p>\n\n<p>My plan was to input a value that I assigned to the cell \"PackageWeight\", then when a button is clicked the formula yields \"DispatchMinutes\", or \"y\".</p>\n\n<pre><code>Private Sub TrucksDTButton_Click()\n\n    Dim WeightValue As Double\n    Dim MinutesValue As Double\n\n    WeightValue = wsDispatchButtonsSheet.Range(\"PackageWeight\").Value\n    MinutesValue = wsDispatchButtonsSheet.Range(\"DispatchMinutes\").Value\n\n    MinutesValue = 0.0069 * WeightValue + 17.631\n\nEnd Sub\n</code></pre>\n\n<p>When I run the code, it yields the \"Run time '</p>\n\n<blockquote>\n  <p>424' Error - Object Required\".</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1543416798, "post_id": 53522096, "comment_id": 93912994, "body": "You could use a loop, and call each ID in turn."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10166251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb19babb9c85bcfe6620fbb19d565e2?s=128&d=identicon&r=PG&f=1", "display_name": "lizfrinko", "link": "https://stackoverflow.com/users/10166251/lizfrinko"}, "edited": false, "score": 0, "creation_date": 1543417757, "post_id": 53522325, "comment_id": 93913609, "body": "Thanks for your response. I understand that I can do this as a regular excel formula, having 100 rows of this formula really slows down my workbook. And I&#39;ll always have a new workbook 1 and a template of workbook 2 to transfer between."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 15, "user_id": 10166251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb19babb9c85bcfe6620fbb19d565e2?s=128&d=identicon&r=PG&f=1", "display_name": "lizfrinko", "link": "https://stackoverflow.com/users/10166251/lizfrinko"}, "edited": false, "score": 0, "creation_date": 1543417983, "post_id": 53522325, "comment_id": 93913784, "body": "so, in the vba code you can <b>1)</b> turn calcs off <b>2)</b> place this formula <b>3)</b> calculate <b>4)</b> hard code the values <b>5)</b> turn calcs back on"}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 0, "creation_date": 1543420465, "post_id": 53522325, "comment_id": 93915546, "body": "Or use Evaluate in VBA: myvar = [SUM(IF(A1:A4=A7:D7,B1:B4))]"}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1543417180, "creation_date": 1543417180, "answer_id": 53522325, "question_id": 53522096, "link": "https://stackoverflow.com/questions/53522096/sumif-function-dynamic/53522325#53522325", "title": "Sumif Function Dynamic", "body": "<p>The following array formula works:</p>\n\n<pre><code>=SUM(IF($A$1:$A$4=A8:D8,$B$1:$B$4))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/L5m8V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L5m8V.png\" alt=\"enter image description here\"></a></p>\n\n<p>Make sure to press <code>Ctrl+Shift+Enter</code> before exiting the cell. Then drag down for the rest of the columns. It will even work if some of your columns on sheet 2 have more/less ids. No need for VBA, but if you need to have for other reasons, you can apply this formula directly into the code.</p>\n"}], "owner": {"reputation": 15, "user_id": 10166251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecb19babb9c85bcfe6620fbb19d565e2?s=128&d=identicon&r=PG&f=1", "display_name": "lizfrinko", "link": "https://stackoverflow.com/users/10166251/lizfrinko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 53522325, "answer_count": 1, "score": 0, "last_activity_date": 1543421482, "creation_date": 1543416406, "last_edit_date": 1543421482, "question_id": 53522096, "link": "https://stackoverflow.com/questions/53522096/sumif-function-dynamic", "title": "Sumif Function Dynamic", "body": "<p>I am having trouble writing a VBA code that will sum a column from one workbook to another based on multiple IDs. The data is setup like below.\nI want workbook 2 to read the id column of workbook 1 and sum that value column.</p>\n\n<pre><code>WORKBOOK 1\nID     |    VALUE\n2454         10\n6333          5\n3345         10\n5667         20\n\n\n\nWorkbook 2\nID 1  | ID2  | ID 3 | ID 4  |  Sum Value    \n2454   6333    3345    5667       45\n</code></pre>\n\n<p>I'm thinking I could use something like this:</p>\n\n<pre><code>Dim Rng As Range\nSet Rng = Range(\"workbook 2 sum value column\")\nRng.Formula = \"=SUMIF(workbook 1 ID column,workbook 2 ID 1,workbook 1 VALUE column)\"\nRng.Value = Rng.Value\n</code></pre>\n\n<p>But I think I would have to repeat this code for every row and every ID in workbook 2?</p>\n\n<p>I'm very new to this, and it's a little advanced for me. Any help is appreciated, thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1543416161, "post_id": 53521825, "comment_id": 93912575, "body": "Is there any pattern to the dates you&#39;re using? As a start, I would consider using a lookup to find the last occurrence of the customer, e.g. like this <a href=\"https://www.exceltip.com/excel-formula-and-function/vlookup-to-find-last-matching-value.html\" rel=\"nofollow noreferrer\">exceltip.com/excel-formula-and-function/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 5136391, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-50UWjTxrP64/AAAAAAAAAAI/AAAAAAAAABI/xUevMoG9h6s/photo.jpg?sz=128", "display_name": "Rigel Turdiu", "link": "https://stackoverflow.com/users/5136391/rigel-turdiu"}, "reply_to_user": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 0, "creation_date": 1543416392, "post_id": 53521825, "comment_id": 93912729, "body": "The dates on the left and the weekday listed always correspond to the day the report is run. The dates to the right are always the Friday of the relevant week."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5136391, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-50UWjTxrP64/AAAAAAAAAAI/AAAAAAAAABI/xUevMoG9h6s/photo.jpg?sz=128", "display_name": "Rigel Turdiu", "link": "https://stackoverflow.com/users/5136391/rigel-turdiu"}, "edited": false, "score": 0, "creation_date": 1543419051, "post_id": 53522706, "comment_id": 93914539, "body": "Perfect! Thank you so much. This is certainly a way less convoluted answer than what I was imagining."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 0, "last_activity_date": 1543418333, "creation_date": 1543418333, "answer_id": 53522706, "question_id": 53521825, "link": "https://stackoverflow.com/questions/53521825/how-can-i-create-a-formula-using-vba-to-reference-a-dynamically-offset-range-of/53522706#53522706", "title": "How can I create a formula using VBA to reference a dynamically offset range of cells?", "body": "<p>It can probably be optimised further by actually pre-calculating the range, but the naive version would be:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>=SUMIFS([Outstanding Mail],[Date],LOOKUP([@Date]-1,[Date]),[Customer],[@Customer])\n+SUMIFS([Outstanding Faxes],[Date],LOOKUP([@Date]-1,[Date]),[Customer],[@Customer])\n</code></pre>\n\n<p>Which relies on the fact that your dates are sorted, and that <code>LOOKUP</code> returns the last value that is not greater than the supplied value, so the <code>[@Date]-1</code> makes it look up the biggest date that is less than the provided date. Will not work on an unsorted range.</p>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1543420792, "post_id": 53523323, "comment_id": 93915784, "body": "No, the formula is fine with gaps in dates, as long as the list is sorted."}], "tags": [], "owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "is_accepted": false, "score": 0, "last_activity_date": 1543420260, "creation_date": 1543420260, "answer_id": 53523323, "question_id": 53521825, "link": "https://stackoverflow.com/questions/53521825/how-can-i-create-a-formula-using-vba-to-reference-a-dynamically-offset-range-of/53523323#53523323", "title": "How can I create a formula using VBA to reference a dynamically offset range of cells?", "body": "<p>@Gserg got an answer ahead of me, and his solution is one good elegant line, although i think it goes on the assumption there will be items every day there (if I`m not wrong?), and your screenshot suggest they may not be consecutive days all the time.</p>\n\n<p>If you are still looking at a VBA solution as well, I would do something like this:</p>\n\n<pre><code>Option Explicit    \nSub addOffsetFormula()\n\n    'Declare and set your workbook\n    Dim wb As Workbook: Set wb = ActiveWorkbook\n\n    'Declare and set your spreadsheet\n    Dim shData As Worksheet: Set shData = wb.Worksheets(\"Data\")\n\n    'Set your last row/column for a dynamic aproach\n    Dim lRow As Long: lRow = shData.Cells(1, 1).End(xlDown).Row\n    Dim lCol As Long: lCol = shData.Cells(1, shData.Columns.Count).End(xlToLeft).Column\n\n    'Declare some further variables to help\n    Dim R As Long, X As Long\n    Dim sumFormula As String\n\n    'Declare and set your array to hold your data - much faster to iterate through the array than spreadsheet itself\n    Dim tblData(): tblData = shData.Range(shData.Cells(1, 1), shData.Cells(lRow, lCol))\n\n    For R = LBound(tblData) + 1 To UBound(tblData)              'Iterate through your data\n        For X = LBound(tblData) + 1 To UBound(tblData)          'Iterate through the same data again\n            If tblData(R, 4) = tblData(X, 4) And X &gt; R Then     'Check for match with the next client found (assuming clients are unique)\n\n                'Set your formula to a variable, helps with debugging\n                sumFormula = \"=SUM(R[-\" &amp; X - R &amp; \"]C[-2]+R[-\" &amp; X - R &amp; \"]C[-1])\"\n\n                'Assign the formula to the respective cell _\n                    If the spreadsheet is massive, you might need to add some optimisation _\n                    (ie: assign everything to an array first, then dump into the spreadsheet)\n                shData.Cells(X, 7).FormulaR1C1 = sumFormula\n            End If\n        Next X\n    Next R\n\nEnd Sub\n</code></pre>\n\n<p>Note: It won't add anything to the first few lines or new clients, as there is nothing to match against previously, but i expect that should work the same with any formula too.</p>\n"}], "owner": {"reputation": 15, "user_id": 5136391, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-50UWjTxrP64/AAAAAAAAAAI/AAAAAAAAABI/xUevMoG9h6s/photo.jpg?sz=128", "display_name": "Rigel Turdiu", "link": "https://stackoverflow.com/users/5136391/rigel-turdiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53522706, "answer_count": 2, "score": 1, "last_activity_date": 1543420260, "creation_date": 1543415654, "last_edit_date": 1543415777, "question_id": 53521825, "link": "https://stackoverflow.com/questions/53521825/how-can-i-create-a-formula-using-vba-to-reference-a-dynamically-offset-range-of", "title": "How can I create a formula using VBA to reference a dynamically offset range of cells?", "body": "<p>This is a very strangely specific need, and the last thing I need to complete my suite of new macros.</p>\n\n<p><a href=\"https://i.stack.imgur.com/W5s2I.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W5s2I.jpg\" alt=\"Example Image\"></a></p>\n\n<p><em>Note: The '---' at the top of the sheet is there to represent several months of the same report going back in time</em></p>\n\n<p>As you can see in the image linked above, I have two highlighted sections. I need to make column G the sum of E and F from the <strong>previous</strong> report's numbers. Because there is a new set of data added every day, I can't reference specific cells and it must be dynamic. The larger problem here is that my number of customers will change every so often. It will <strong>only</strong> go up and it will <strong>always</strong> be in the same order; even if a lose a customer they stay on the report in the same spot.</p>\n\n<p>My only theories on how to get this done are: </p>\n\n<ol>\n<li>Find the second to last instance of customer A and define a rng based on the offset cells to the right. My problem with this is that\u2014to my understanding\u2014even filling that formula all the way down will just give me the one value.</li>\n<li>Adding <code>=SUM((INDIRECT(ADDRESS(ROW()-5,COLUMN()-2))):(INDIRECT(ADDRESS(ROW()-5,COLUMN()-1))))</code> to the blank cells. My problem with this is that the -5 in the offset is able to change, and even defining it by the number of blank cells will cause a mistake the first time a new customer comes on.</li>\n</ol>\n\n<p>Any insight would be very much appreciated. And please let me know if you have any clarifying questions; I'm happy to answer/edit the original post as needed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1543415419, "post_id": 53521655, "comment_id": 93912187, "body": "your <code>cell</code> variable is declared as a variant. Firstly, are you sure it has a value set? and Seconly try using <code>.SaveAs Filename:=&quot;C:\\Users\\kakka\\Desktop\\SymbolData\\&quot; &amp; cell.Value2 &amp; &quot;-v1.xls&quot;, FileFormat:=56</code>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543416121, "post_id": 53521655, "comment_id": 93912550, "body": "What error do you get when it &quot;fails on the following code line arbitrarily&quot;?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1543416832, "post_id": 53521655, "comment_id": 93913017, "body": "<code>wsI.Range(&quot;A1:H1&quot;).Copy</code> is a huge waste of resources. Instead of copying the entire column, only copy the range with data in it. This may be causing an overload especially because there&#39;s a long loop. You can also make it more efficient by removing copy/paste technique and setting <code>range.value = range.value</code>, directly."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1543416864, "post_id": 53521655, "comment_id": 93913046, "body": "@Tom your suggestion to add Value2 after Cell  solves the problem. Please make it as an answer so that I may tick it. Thanks a lot."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1543417065, "post_id": 53521655, "comment_id": 93913170, "body": "@skkakkar Glad it worked - added"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543417176, "post_id": 53521655, "comment_id": 93913240, "body": "@Comintern File opens up and I have to save manually. Problem stands solved by Tom&#39;s suggestion."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1543417355, "post_id": 53521655, "comment_id": 93913347, "body": "@Scott Holtzman I shall workout on your suggestion also and update later though problem stands resolved by Tom&#39;s suggestion."}], "answers": [{"comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1543417839, "post_id": 53522280, "comment_id": 93913674, "body": "It&#39;s also worth pointing out that writing <code>Dim cell</code> as <code>Dim cell as Range</code> would also solve the issue, because <code>.Value</code> is the default property of a range object. It&#39;s also a wiser solution because the code does not use a variant data type in an unnecessary way."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 0, "last_activity_date": 1543417051, "creation_date": 1543417051, "answer_id": 53522280, "question_id": 53521655, "link": "https://stackoverflow.com/questions/53521655/individual-files-making-program-erratic-performance/53522280#53522280", "title": "Individual files making program erratic performance", "body": "<p>You're using a range variant to concatenate your String FilePath</p>\n\n<p>Use <code>cell.Value2</code> to concatenate the cell value with your String FilePath.</p>\n\n<pre><code>.SaveAs Filename:=\"C:\\Users\\kakka\\Desktop\\SymbolData\\\" &amp; cell.Value2 &amp; \"-v1.xls\", FileFormat:=56\n</code></pre>\n"}], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 53522280, "answer_count": 1, "score": 0, "last_activity_date": 1582500891, "creation_date": 1543415114, "last_edit_date": 1582500891, "question_id": 53521655, "link": "https://stackoverflow.com/questions/53521655/individual-files-making-program-erratic-performance", "title": "Individual files making program erratic performance", "body": "<p>I am making individual daily price data files for Tickers from Daily Price Data file. Program code appended below is not working properly. Sometimes it runs and makes 60 files and then fails to save a file and subsequently it fails to paste the desired range data though it creates the files. Other times it may fail to save even after 5th file or may be after 30th file. I even introduced pause time .</p>\n\n<pre><code>     Application.Wait (Now + #12:00:03 AM#)\n</code></pre>\n\n<p>But it does not solve the problem. Program fails on the following code line arbitrarily.</p>\n\n<pre><code> .SaveAs Filename:=\"C:\\Users\\kakka\\Desktop\\SymbolData\\\" &amp; cell &amp; \"-v1.xls\", FileFormat:=56\n</code></pre>\n\n<p>Program code is appended below.</p>\n\n<pre><code>Sub number()\n\n    Dim wbI As Workbook, wbO As Workbook\n    Dim wsI As Worksheet, wsO As Worksheet\n    Dim cell, rng As Range\n    Dim stRw As Long\n    Set rng = Range(\"A2:A72\")\n    stRw = 2\n    For Each cell In rng\n        If cell.Value &lt;&gt; cell.Offset(1, 0).Value Then\n\n        Set wbI = ActiveWorkbook\n        Set wsI = wbI.Worksheets(\"Sheet1\")\n        Set wbO = Workbooks.Add\n\n            With wbO\n                 Set wsO = wbO.Sheets(\"Sheet1\")\n                 .SaveAs Filename:=\"C:\\Users\\kakka\\Desktop\\SymbolData\\\" &amp; cell &amp; \"-v1.xls\", FileFormat:=56\n                 wsI.Range(\"A1:H1\").Copy\n                 wsO.Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                 wsI.Rows(stRw &amp; \":\" &amp; cell.Row).Copy\n                 wsO.Range(\"A2\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                .Close SaveChanges:=True\n                stRw = cell.Row + 1\n            End With\n        Set wbI = Nothing\n        Set wsI = Nothing\n        Set wbO = Nothing\n        Set wsO = Nothing\n\n\n\n        End If\n    Application.Wait (Now + #12:00:03 AM#)\n    Next cell\n\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/18sbS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/18sbS.jpg\" alt=\"Data File Snapshot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/zFwLr.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zFwLr.jpg\" alt=\"Unsaved File Snapshot\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/sA2Nu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sA2Nu.jpg\" alt=\"Saved File Snapshot\"></a>\nRequest help in resolving this issue.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1543414742, "post_id": 53521182, "comment_id": 93911709, "body": "Isn&#39;t that a bit like cheating?  Chances are a plaigrised answer from SO will be detected by examiners are fairly high.  Find the time to learn what you need.  Or choose to FAIL."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1543484204, "post_id": 53521182, "comment_id": 93939269, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "reply_to_user": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1543484238, "post_id": 53521182, "comment_id": 93939287, "body": "I&#39;ve downvoted for the begging, and I&#39;ve reported your unfriendly tone to a moderator,  M. Kleanthous. This is not a good start for you here. @Mark is surely in earnest that this feels like cheating, even if you can supply reasons why it is not. At the very least it is a request for free work (&quot;I don&#39;t have time to learn this, please do it for me&quot;)."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1543484420, "post_id": 53521182, "comment_id": 93939411, "body": "Could Mark have been more friendly? Possibly, but if you understand that your question was skating on thin ice to start with, that will help your understand why you did not get an enthusiastic reception. It is important not to retaliate too. Please <a href=\"https://stackoverflow.com/conduct\">read the Code</a> when you get a moment."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10717435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d65984b98b7b5bf12fc599db53a854?s=128&d=identicon&r=PG&f=1", "display_name": "M. Kleanthous", "link": "https://stackoverflow.com/users/10717435/m-kleanthous"}, "edited": false, "score": 0, "creation_date": 1543419792, "post_id": 53522145, "comment_id": 93915069, "body": "So I opened VisualBasic and pasted the code for the whole workbook. I run the enterspecialmode macro , pressed a number and got the following error &quot;Cannot run the macro &#39;Book1color3&#39;. The macro may not be available in the workbook or all macros may be disabled&quot; I checked my macro security settings and it&#39;s all fine. What should I do?"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "reply_to_user": {"reputation": 7, "user_id": 10717435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d65984b98b7b5bf12fc599db53a854?s=128&d=identicon&r=PG&f=1", "display_name": "M. Kleanthous", "link": "https://stackoverflow.com/users/10717435/m-kleanthous"}, "edited": false, "score": 0, "creation_date": 1543419866, "post_id": 53522145, "comment_id": 93915118, "body": "@M.Kleanthous make sure you created a New Module by right-clicking and &quot;insert new module&quot; then put the code in there."}, {"owner": {"reputation": 7, "user_id": 10717435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d65984b98b7b5bf12fc599db53a854?s=128&d=identicon&r=PG&f=1", "display_name": "M. Kleanthous", "link": "https://stackoverflow.com/users/10717435/m-kleanthous"}, "edited": false, "score": 1, "creation_date": 1543420087, "post_id": 53522145, "comment_id": 93915290, "body": "Thank you Kubie, this works! And thank you for the fast replies!"}], "tags": [], "owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "is_accepted": true, "score": 1, "last_activity_date": 1543416560, "creation_date": 1543416560, "answer_id": 53522145, "question_id": 53521182, "link": "https://stackoverflow.com/questions/53521182/shading-selected-cell-with-a-certain-colour-at-key-press-in-excel/53522145#53522145", "title": "Shading selected cell with a certain colour at key press in Excel", "body": "<p>To enter this <strong><em>special</em></strong> mode you can run a macro to assign new purposes to those keys.</p>\n\n<p>In a module in the VBE Editor, you can add:</p>\n\n<pre><code>Sub EnterSpecialMode()\n    Call Application.OnKey(\"1\", \"color1\")\n    Call Application.OnKey(\"2\", \"color2\")\n    Call Application.OnKey(\"3\", \"color3\")\n    Call Application.OnKey(\"4\", \"color4\")\nEnd Sub\n\nSub ExitSpecialMode()\n    Call Application.OnKey(\"1\")\n    Call Application.OnKey(\"2\")\n    Call Application.OnKey(\"3\")\n    Call Application.OnKey(\"4\")\nEnd Sub\n\nSub color1()\n    Selection.Interior.Color = RGB(255, 0, 0)\nEnd Sub\n\nSub color2()\n    Selection.Interior.Color = RGB(0, 255, 0)\nEnd Sub\n\nSub color3()\n    Selection.Interior.Color = RGB(0, 0, 255)\nEnd Sub\n\nSub color4()\n    Selection.Interior.Color = RGB(255, 255, 0)\nEnd Sub\n</code></pre>\n\n<p>Self-explanatory, but to enter the special mode you have to run the <em>EnterSpecialMode</em>. And to exit run the <em>ExitSpecialMode</em> sub</p>\n"}], "owner": {"reputation": 7, "user_id": 10717435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d65984b98b7b5bf12fc599db53a854?s=128&d=identicon&r=PG&f=1", "display_name": "M. Kleanthous", "link": "https://stackoverflow.com/users/10717435/m-kleanthous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 53522145, "answer_count": 1, "score": -3, "last_activity_date": 1543493318, "creation_date": 1543413626, "last_edit_date": 1543493318, "question_id": 53521182, "link": "https://stackoverflow.com/questions/53521182/shading-selected-cell-with-a-certain-colour-at-key-press-in-excel", "title": "Shading selected cell with a certain colour at key press in Excel", "body": "<p>I'm a student and I have to learn a lot of stuff/questions, so I came up with an idea and I don't know how to realize it.</p>\n\n<p>So all I am asking is for someone <em>kind</em> to show me how I can program Excel to specifically shade the selected cell with a certain color with a press of a button, as the title suggests. </p>\n\n<p>I want to get in a <strong>special mode</strong>, where:</p>\n\n<ol>\n<li>I can move around the cells with the arrow keys</li>\n<li>by pressing 1 or 2 or 3 or 4, then the selected cell gets shaded with a specific color. (each number for a different color)</li>\n</ol>\n\n<p>The question is, how do I do it? Is something like that possible at all in Excel? I have some background with code, but not even close to a professional. I just did VB Stuff for my GCE A Levels in Computing. </p>\n\n<p>Macros are also possible as I can see but really don't know how to use them. </p>\n\n<p>So here I am, asking this question, hoping someone kind will maybe see it as a challenge and help me realize it. I would invest the time to learn how to do this myself, but with the free time I have now, something like that would take months, just because I'm thorough and I want to learn from the absolute basics.</p>\n"}, {"tags": ["vba", "loops", "variables"], "comments": [{"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1543413399, "post_id": 53520979, "comment_id": 93910825, "body": "Does it work if you add an <code>emails(4)</code> with a value of <code>&quot;&quot;</code> (and change to <code>Dim emails(1 To 4) As String</code>)?"}, {"owner": {"reputation": 15, "user_id": 10517860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fcf339db1e51ed22a32d385b298a2?s=128&d=identicon&r=PG&f=1", "display_name": "macu3", "link": "https://stackoverflow.com/users/10517860/macu3"}, "reply_to_user": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1543413984, "post_id": 53520979, "comment_id": 93911192, "body": "Yeah, it does indeed. All clear now, stupid mistake, thanks a lot :)"}, {"owner": {"reputation": 20736, "user_id": 1115360, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uMQGl.png?s=128&g=1", "display_name": "Andrew Morton", "link": "https://stackoverflow.com/users/1115360/andrew-morton"}, "edited": false, "score": 0, "creation_date": 1543414201, "post_id": 53520979, "comment_id": 93911349, "body": "Do you have <code>On Error Resume Next</code> somewhere in the code? Ignoring an error with that (such as trying to access an array element which doesn&#39;t exist) <i>could</i> give unexpected results."}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 10517860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fcf339db1e51ed22a32d385b298a2?s=128&d=identicon&r=PG&f=1", "display_name": "macu3", "link": "https://stackoverflow.com/users/10517860/macu3"}, "is_accepted": false, "score": 0, "last_activity_date": 1543413849, "creation_date": 1543413849, "answer_id": 53521253, "question_id": 53520979, "link": "https://stackoverflow.com/questions/53520979/vba-loop-losing-variable-value/53521253#53521253", "title": "VBA: loop losing variable value", "body": "<p>Actually, I've already solved the problem by using other loop type (For i = 1 To UBound(emails), Next i), but why the previous loop did not work is still quite mysterious to me... If anyone can explain, I'd appreciate it, as I prefer to understand things rather thank just do them correctly.</p>\n\n<p>W.</p>\n"}, {"comments": [{"owner": {"reputation": 106, "user_id": 9709187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63acda9cc082e30023c3d2301d48a68a?s=128&d=identicon&r=PG&f=1", "display_name": "Ruvox", "link": "https://stackoverflow.com/users/9709187/ruvox"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1543414314, "post_id": 53521296, "comment_id": 93911422, "body": "Yes, that&#39;s what it should do. He has already found the actual solution himself but by giving him an example of a little more simple code which results in the same error I hoped to make it easier for him to understand what his error was about."}], "tags": [], "owner": {"reputation": 106, "user_id": 9709187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63acda9cc082e30023c3d2301d48a68a?s=128&d=identicon&r=PG&f=1", "display_name": "Ruvox", "link": "https://stackoverflow.com/users/9709187/ruvox"}, "is_accepted": false, "score": 2, "last_activity_date": 1543414191, "last_edit_date": 1543414191, "creation_date": 1543413965, "answer_id": 53521296, "question_id": 53520979, "link": "https://stackoverflow.com/questions/53520979/vba-loop-losing-variable-value/53521296#53521296", "title": "VBA: loop losing variable value", "body": "<p>You should get a runtime error 9 since you index <code>i</code> will be 4 after you looped through your emails String array. As soon as it tries to compare the value of <code>emails(4)</code> with <code>\"\"</code> it should produce the \"index out of range\" since you have defined your Array to be only 3 elements long.</p>\n\n<p>For a little clarification try this example code, it should produce the same error:</p>\n\n<pre><code>Function littleTest()\n    Dim teststr(1 To 3) As String\n    Dim i As Integer\n\n    teststr(1) = \"abc\"\n    teststr(2) = \"def\"\n    teststr(3) = \"ghi\"\n\n    i = 1\n\n    Do While teststr(i) &lt;&gt; \"\"\n        Debug.Print \"i do it for the \" &amp; i &amp; \" time!\"\n        i = i + 1\n    Loop\n\nEnd Function\n</code></pre>\n\n<p>You have already found the solution yourself since <code>UBound()</code> is returning the actual length of your array which is in your case three so it will never search beyond the array.</p>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1543414363, "post_id": 53521321, "comment_id": 93911449, "body": "Either <code>Do While emails(i) &lt;&gt; &quot;&quot;</code> is always true, and then it&#39;s an useless check, or it is not and then the loop doesn&#39;t exit upon first empty string (as OP&#39;s intent seems to be)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1543414500, "post_id": 53521321, "comment_id": 93911542, "body": "@DisplayName Both true. I didn&#39;t attempt to match what the OP intended to do, because I have no clue what the intended output of the function was. This was simply showing the loop with the <code>While</code> test inside."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1543414032, "creation_date": 1543414032, "answer_id": 53521321, "question_id": 53520979, "link": "https://stackoverflow.com/questions/53520979/vba-loop-losing-variable-value/53521321#53521321", "title": "VBA: loop losing variable value", "body": "<p>You're indexing out of the array bounds. The condition <code>Do While emails(i) &lt;&gt; \"\"</code> is always true given your array, so the this fails on <code>emails(4)</code>. Just test the array bounds and loop over that:</p>\n\n<pre><code>For i = LBound(emails) To UBound(emails)\n    If emails(i) &lt;&gt; \"\" And i = indeks Then\n        dupa = dupa &amp; \";\" &amp; emails(i)\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1543414060, "creation_date": 1543414060, "answer_id": 53521332, "question_id": 53520979, "link": "https://stackoverflow.com/questions/53520979/vba-loop-losing-variable-value/53521332#53521332", "title": "VBA: loop losing variable value", "body": "<p>this should work (explanations in comments):</p>\n\n<pre><code>Function carbon_copy(indeks As Long) As String\n    Dim emails(1 To 3) As String\n    Dim i As Long\n    Dim dupa As String\n\n    emails(1) = \"abc@wp.pl\"\n    emails(2) = \"pabc@wp.pl\"\n    emails(3) = \"rabc@wp.pl\"\n\n    i = 1\n    Do While emails(i) &lt;&gt; \"\"\n        If i &lt;&gt; indeks Then dupa = dupa &amp; \";\" &amp; emails(i) ' update 'dupa' if current index doesn't natch passed 'indeks'\n        i = i + 1\n        If i &gt; UBound(emails, 1) Then Exit Do ' be sure to exit upon exceeding 'emails()' array size\n    Loop\n\n    carbon_copy = dupa\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10517860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd5fcf339db1e51ed22a32d385b298a2?s=128&d=identicon&r=PG&f=1", "display_name": "macu3", "link": "https://stackoverflow.com/users/10517860/macu3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 53521321, "answer_count": 4, "score": 0, "last_activity_date": 1543414191, "creation_date": 1543413046, "question_id": 53520979, "link": "https://stackoverflow.com/questions/53520979/vba-loop-losing-variable-value", "title": "VBA: loop losing variable value", "body": "<p>I've got a strange problem with a loop in VBA, as it seems to be losing the value of my variable. Any ideas why? If i delete the loop, debug.print shows \"test\", otherwise it's empty (unless I print the value of \"dupa\" inside the loop)... Seems very strange.</p>\n\n<pre><code>Function carbon_copy(indeks As String) As String\n\nDim emails(1 To 3) As String\nDim i As Integer\nDim dupa As String\n\nemails(1) = \"abc@wp.pl\"\nemails(2) = \"pabc@wp.pl\"\nemails(3) = \"rabc@wp.pl\"\n\ni = 1\ndupa = \"test\"\n\nDo While emails(i) &lt;&gt; \"\"\n\n    If i = indeks Then\n         GoTo NextIteration\n    End If\n\n    dupa = dupa &amp; \";\" &amp; emails(i)\n\n\n    NextIteration:\n    i = i + 1\n\nLoop\n\nDebug.Print dupa\n\ncarbon_copy = dupa\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofilter", "excel-tables"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 10619851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WrI6I.jpg?s=128&g=1", "display_name": "Ekfa", "link": "https://stackoverflow.com/users/10619851/ekfa"}, "edited": false, "score": 0, "creation_date": 1543413268, "post_id": 53520952, "comment_id": 93910744, "body": "YES! Works fine!! Thanks Rory!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 1, "last_activity_date": 1543412983, "creation_date": 1543412983, "answer_id": 53520952, "question_id": 53520839, "link": "https://stackoverflow.com/questions/53520839/excel-vba-showalldata-of-table-fails/53520952#53520952", "title": "Excel VBA - ShowAllData of table fails", "body": "<p>It should be:</p>\n\n<pre><code>Worksheets(\"Orders\").ListObjects(\"Orders\").Autofilter.showalldata\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 10619851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WrI6I.jpg?s=128&g=1", "display_name": "Ekfa", "link": "https://stackoverflow.com/users/10619851/ekfa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "accepted_answer_id": 53520952, "answer_count": 1, "score": 0, "last_activity_date": 1543412983, "creation_date": 1543412614, "question_id": 53520839, "link": "https://stackoverflow.com/questions/53520839/excel-vba-showalldata-of-table-fails", "title": "Excel VBA - ShowAllData of table fails", "body": "<p>I have this longer piece of VBA (see also my former question: <a href=\"https://stackoverflow.com/questions/53206850/copy-rows-which-match-criteria-into-two-or-more-different-sheets-in-excel-with-v\">https://stackoverflow.com/questions/53206850/copy-rows-which-match-criteria-into-two-or-more-different-sheets-in-excel-with-v)</a>.</p>\n\n<p>One particular piece doesn't work properly. I want a table to <strong>ShowAllData</strong> as soon as its former actions from the module have been taken.\nThis code I made so far, <strong>works fine</strong> as long as I <strong>run</strong> it when I'm <strong>from one of the cells of the table</strong>. As soon as I run it <strong>from another place on the worksheet</strong>, it <strong>won't show all data again</strong>. It keeps hanging in the filtermode of the table.</p>\n\n<pre><code>   Sub CopyOrders()\n\n'Sorting column STOCK in ORDERS from A-Z\n    Worksheets(\"Orders\").ListObjects(\"Orders\").Sort. _\n        SortFields.Clear\n    Worksheets(\"Orders\").ListObjects(\"Orders\").Sort. _\n        SortFields.Add2 Key:=Range(\"Orders[[#All],[STOCK]]\"), SortOn:= _\n        xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With Worksheets(\"Orders\").ListObjects(\"Orders\").Sort\n        .Apply\n    End With\n\n'Delete all rows from table NoStockOrders\nOn Error Resume Next\nWorksheets(\"NoStockOrders\").ListObjects(\"NoStockOrders\").DataBodyRange.EntireRow.Delete\n\n'Copy all orders which have no stock to\n'the sheet NoStockOrders\nWorksheets(\"Orders\").Range(\"ORDERS\").AutoFilter _\n    Field:=6, Criteria1:=\"0\", VisibleDropDown:=True\nOn Error Resume Next\nWorksheets(\"Orders\").Range(\"ORDERS\").SpecialCells _\n    (xlCellTypeVisible).Copy\n    Range(\"NoStockOrders\").PasteSpecial _\n    Paste:=xlPasteValues\n\nIf Worksheets(\"Orders\").ListObjects(\"Orders\").FilterMode Then\n    Worksheets(\"Orders\").AutoFilter.ShowAllData\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543411540, "post_id": 53520395, "comment_id": 93909575, "body": "You won&#39;t find any ready to use code for that. But if I google for <i>&quot;excel vba copy paste  range to powerpoint&quot;</i> I find many results how this can be achieved in general. Use one of this tutorials to start something on your own. If you get stuck or errors come back with your code and ask a question to it. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}, {"owner": {"reputation": 1, "user_id": 7437389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78aded10a882f16bc9bc5d255cd16f?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7437389/tristan"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543412321, "post_id": 53520395, "comment_id": 93910086, "body": "Thanks, I should have included that I have a code which copies a single sheet into powerpoint. Included in my original post now."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543412777, "post_id": 53520395, "comment_id": 93910411, "body": "Just check the value with <code>If Worksheets(&quot;RestWest&quot;).Range(&quot;CI8&quot;).Value &gt; 0 Then</code> put your copy/paste to PowerPoint here and end with an <code>End If</code>."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 5830541, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x1b_LjGWFv4/AAAAAAAAAAI/AAAAAAAAAD4/9WYASuwEBtk/photo.jpg?sz=128", "display_name": "virpericulosus", "link": "https://stackoverflow.com/users/5830541/virpericulosus"}, "is_accepted": false, "score": 2, "last_activity_date": 1543412776, "creation_date": 1543412776, "answer_id": 53520902, "question_id": 53520395, "link": "https://stackoverflow.com/questions/53520395/exporting-excel-tabs-into-powerpoint-slides-based-on-cell-value/53520902#53520902", "title": "Exporting Excel tabs into Powerpoint Slides based on cell value", "body": "<p><a href=\"https://www.thespreadsheetguru.com/blog/2014/3/17/copy-paste-an-excel-range-into-powerpoint-with-vba\" rel=\"nofollow noreferrer\">TheSpreadsheetGuru - Copy &amp; Paste An Excel Range Into PowerPoint With VBA</a></p>\n\n<p>I'm very novice also, but check out this link and maybe try something like:</p>\n\n<pre><code>For Each sht In Worksheets\nWith sht\n    If .Range(\"CI8\").Value2 &gt; 0 Then\n        .Range(\"Print_Area\").Copy\n        'use SpreadSheetGuru to show you how to insert new slide and paste\n        ' ...\n    End If\nEnd With\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7437389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a78aded10a882f16bc9bc5d255cd16f?s=128&d=identicon&r=PG&f=1", "display_name": "Tristan", "link": "https://stackoverflow.com/users/7437389/tristan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582548361, "creation_date": 1543411194, "last_edit_date": 1582548361, "question_id": 53520395, "link": "https://stackoverflow.com/questions/53520395/exporting-excel-tabs-into-powerpoint-slides-based-on-cell-value", "title": "Exporting Excel tabs into Powerpoint Slides based on cell value", "body": "<p>hope you can help.</p>\n\n<p>Complete novice in VBA and I've searched and searched for an answer to my question but cannot find what I'm looking for.</p>\n\n<p>What I have is a workbook with numerous tabs which hold different data and narrative. I need some way to to export these sheets (print view area) into separate PowerPoint slides only if cell \"CI8\" of those tabs are greater than 0. For example, I have tabs called \"RestWest\" \"RestCentre\" \"RestEast\" \"RestRS\" and if only RestWest and RestRS have their cell CI8 >0, only those two sheets would pull into Powerpoint. Pasting as a picture would be best.</p>\n\n<p>I have been able to do it to export into PDF but senior management like PowerPoint better.</p>\n\n<p>Hope you can help and give me some pointers.</p>\n\n<p>Thanks for your time</p>\n\n<p>Should have included the following code as it pulls a single sheet into PowerPoint but need to include the cell value criteria</p>\n\n<pre><code>Sub CopyRangeToPresentation()\n\n    Dim pp As PowerPoint.Application\n    Dim PPPres As PowerPoint.Presentation\n    Dim PPSlide As PowerPoint.Slide\n    Dim SlideTitle As String\n    Set pp = New PowerPoint.Application\n    Set PPPres = pp.Presentations.Add\n    pp.Visible = True\n    Set PPSlide = PPPres.Slides.Add(1, ppLayoutTitleOnly)\n    PPSlide.Select\n    Sheets(\"RestWest\").Range(\"A1:CV77\").CopyPicture _\n    Appearance:=xlScreen, Format:=xlPicture\n    PPSlide.Shapes.Paste.Select\n    pp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True\n    pp.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True\n    SlideTitle = \"My First PowerPoint Slide\"\n    PPSlide.Shapes.Title.TextFrame.TextRange.Text = SlideTitle\n    pp.Activate\n    Set PPSlide = Nothing\n    Set PPPres = Nothing\n    Set pp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1543411179, "post_id": 53520318, "comment_id": 93909366, "body": "Quickest way would be to include the code that you already have into your question and tell where you got stuck or errors. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543495692, "post_id": 53539087, "comment_id": 93945932, "body": "If you want to ask a question, please put everything into the question part. You cannot ask questions in the answer part, because we cannot answer follow-up questions here. I suggest you copy everything into your original question and delete this answer here."}], "tags": [], "owner": {"reputation": 5, "user_id": 10225132, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NCq5l_xiydk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHiMUi6iXPlXn6lbRM-Hyyqay1UQ/mo/photo.jpg?sz=128", "display_name": "Sam Shang", "link": "https://stackoverflow.com/users/10225132/sam-shang"}, "is_accepted": false, "score": 0, "last_activity_date": 1543494519, "creation_date": 1543494519, "answer_id": 53539087, "question_id": 53520318, "link": "https://stackoverflow.com/questions/53520318/how-to-insert-copy-in-excel-base-on-number-of-another-column-in-excel-vba-or-not/53539087#53539087", "title": "How to insert/copy in Excel base on number of another column in Excel VBA or not", "body": "<p>Below function and VBA solved my question above.</p>\n\n<p>Used below function to get the first column</p>\n\n<p>=INDEX(Sheet1!A:A,ROUNDUP(ROW()/5,0))</p>\n\n<p>Anyone know a corresponding VBA code for this part? The function works, however, it is not very convenient when there are too many lines. IT will be great to set range in VBA.</p>\n\n<p>The second column used VBA code as below (Tried multiple columns so be VBA is slightly different with the question) :</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n Dim lastRow As Long\n\n ' Subdivision total row number\n    a = Worksheets(\"sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n  ' Porject total row number\n    b = Worksheets(\"sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n        Sheets(\"Sheet1\").Select\n    ' Project total cell range\n    Range(\"B1:C5\").Copy\n    Range(\"F1\").Select\n    Sheets(\"Sheet1\").Paste\n    ' Row number need to -1 as the first copy is done above\n  For i = 1 To A - 1\n    lastRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"F\").End(xlUp).Row + 1\n    Range(\"F\" &amp; lastRow).Select\n    ActiveSheet.Paste\n  Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10225132, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NCq5l_xiydk/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qHiMUi6iXPlXn6lbRM-Hyyqay1UQ/mo/photo.jpg?sz=128", "display_name": "Sam Shang", "link": "https://stackoverflow.com/users/10225132/sam-shang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1582735630, "creation_date": 1543410891, "last_edit_date": 1582735630, "question_id": 53520318, "link": "https://stackoverflow.com/questions/53520318/how-to-insert-copy-in-excel-base-on-number-of-another-column-in-excel-vba-or-not", "title": "How to insert/copy in Excel base on number of another column in Excel VBA or not", "body": "<p>Basically, I would like a simple way to the following example scenario :\nNumber of times of A,B and C copied based on lines of numbers.\nNumber of lines are much more than below example in real cases of course.</p>\n\n<p>From </p>\n\n<pre><code>A  1\nB  2\nC  3\n   6\n   7\n</code></pre>\n\n<p>to</p>\n\n<pre><code>A  1\nA  2\nA  3\nA  6\nA  7\nB  1\nB  2\nB  3\nB  6\nB  7\nC  1\nC  2\nC  3\nC  6\nC  7\n</code></pre>\n\n<p>Any quick way?</p>\n\n<p>To follow up,</p>\n\n<p>Below function and VBA solved my question above.</p>\n\n<p>Used below function to get the first column</p>\n\n<pre><code>=INDEX(Sheet1!A:A,ROUNDUP(ROW()/5,0))\n</code></pre>\n\n<p>Anyone know a corresponding VBA code for this part? The function works, however, it is not very convenient when there are too many lines. It will be great to set range in VBA.</p>\n\n<p>The second column used VBA code as below (Tried multiple columns so be VBA is slightly different with the question) :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Macro1()\n    '\n    ' Macro1 Macro\n    '\n    Dim lastRow As Long\n\n    ' Subdivision total row number\n    a = Worksheets(\"sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n    ' Porject total row number\n    b = Worksheets(\"sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n    Sheets(\"Sheet1\").Select\n    ' Project total cell range\n    Range(\"B1:C5\").Copy\n    Range(\"F1\").Select\n    Sheets(\"Sheet1\").Paste\n    ' Row number need to -1 as the first copy is done above\n    For i = 1 To A - 1\n        lastRow = Sheets(\"Sheet1\").Cells(Rows.Count, \"F\").End(xlUp).Row + 1\n        Range(\"F\" &amp; lastRow).Select\n        ActiveSheet.Paste\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 4917, "user_id": 2320961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdwXN.png?s=128&g=1", "display_name": "Nic3500", "link": "https://stackoverflow.com/users/2320961/nic3500"}, "edited": false, "score": 0, "creation_date": 1543431080, "post_id": 53520184, "comment_id": 93921232, "body": "While this code may answer the question, providing additional context regarding how and/or why it solves the problem would improve the answer&#39;s long-term value."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 4917, "user_id": 2320961, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AdwXN.png?s=128&g=1", "display_name": "Nic3500", "link": "https://stackoverflow.com/users/2320961/nic3500"}, "edited": false, "score": 0, "creation_date": 1543434142, "post_id": 53520184, "comment_id": 93922683, "body": "@Nic3500 - Fair point. I made it a community wiki. Please add additional context as you see fit. At the moment, i do not have time to do that."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": false, "score": 0, "last_activity_date": 1543410406, "creation_date": 1543410406, "answer_id": 53520184, "question_id": 53520033, "link": "https://stackoverflow.com/questions/53520033/object-not-found-error-loop-that-will-find-the-cell-with-the-same-value-in-anot/53520184#53520184", "title": "Object not found Error: loop that will find the cell with the same value in another sheet, select the offset of the new found cell", "body": "<p>There's a lot of stuff that looks a little strange (according to what is valid syntax) in your code, so I re-wrote an example below.</p>\n\n<pre><code>Sub getOffsetValue()\n\n    Dim origWS as Worksheet\n    Dim dataWS as Worksheet\n\n    Set origWS = Worksheets(\"original\") 'change as needed\n    Set dataWS = Worksheets(\"DATA\")\n\n    Dim checkCell as Range\n\n    For each checkCell in origWS.Range(\"H2:H8\")\n\n        Dim foundIt as Range\n        Set foundIt = dataws.Range(\"A1:A13\").Find(checkCell.Value)\n\n        If Not foundIt is Nothing then\n\n            MsgBox foundIt.Offset(0, 1).Value\n            checkCell.Offset(0, 2).Value = foundIt.Offset(0, 1).Value\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 8258717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52a918937aa43687810cca7fc265e9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8258717/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1543420496, "last_edit_date": 1543420496, "creation_date": 1543414033, "answer_id": 53521324, "question_id": 53520033, "link": "https://stackoverflow.com/questions/53520033/object-not-found-error-loop-that-will-find-the-cell-with-the-same-value-in-anot/53521324#53521324", "title": "Object not found Error: loop that will find the cell with the same value in another sheet, select the offset of the new found cell", "body": "<p>ANSWER: I needed to add 'set' to the first cell loop</p>\n"}], "owner": {"reputation": 117, "user_id": 8258717, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52a918937aa43687810cca7fc265e9a1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/8258717/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1582612346, "creation_date": 1543409897, "last_edit_date": 1582612346, "question_id": 53520033, "link": "https://stackoverflow.com/questions/53520033/object-not-found-error-loop-that-will-find-the-cell-with-the-same-value-in-anot", "title": "Object not found Error: loop that will find the cell with the same value in another sheet, select the offset of the new found cell", "body": "<p>I am trying to create some vba that will do a loop on cells in a column on sheet 1, then check if the cell is apparent on sheet 2, if it is then i want the offset of the sheet 2 value pasted next to the original sheet 1 value. I get the error object required on the cell function or value to find.</p>\n\n<pre><code>Sub findValue()\n\nDim xlRange As Range\nDim xlCell As Range\nDim xlSheet As Worksheet\nDim valueToFind\n\nFor Each cell In Range(\"h2:h8\")\ncell.Select\ncell = ActiveCell\nMsgBox (cell)\n\nvalueToFind = ActiveCell\nSet xlSheet = ActiveWorkbook.Worksheets(\"DATA\")\nSet xlRange = xlSheet.Range(\"A1:A13\")\n\nFor Each xlCell In xlRange\n\n\n    If xlCell.Value = valueToFind Then\n        MsgBox (xlCell.Offset(0, 1).Value)\n  valueToFind.Offset(0, 2).Value = xlCell.Offset(0, 1).Value\n\n    End If\nNext xlCell\n</code></pre>\n"}, {"tags": ["sql-server", "vba"], "comments": [{"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1543409741, "post_id": 53519954, "comment_id": 93908485, "body": "Why not handle it all in SQL? Doing it in VBA, especially in a loop, is going to perform awfully compared to a set based approach."}, {"owner": {"reputation": 33, "user_id": 10717139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9569a3f6facee476fc600ea71b83db?s=128&d=identicon&r=PG", "display_name": "Tony Carter", "link": "https://stackoverflow.com/users/10717139/tony-carter"}, "reply_to_user": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1543409878, "post_id": 53519954, "comment_id": 93908574, "body": "As a stored procedure? Care to help how I can achieve that?"}, {"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1543410142, "post_id": 53519954, "comment_id": 93908738, "body": "Not without some DDL and expected behaviour/results, no. At the moment, all I know is that you have 2 tables called <code>tblBuyerCodes</code> and <code>tblStatistics</code> and another that <i>might</i> be called <code>tblResults</code>."}, {"owner": {"reputation": 33, "user_id": 10717139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9569a3f6facee476fc600ea71b83db?s=128&d=identicon&r=PG", "display_name": "Tony Carter", "link": "https://stackoverflow.com/users/10717139/tony-carter"}, "reply_to_user": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1543410522, "post_id": 53519954, "comment_id": 93908954, "body": "tblBuyerCodes have columns (id, buyercode). tblStatistics have columns (id,buyercode,goodsbought,total). tblResults have columns (id, buyercode,goodsbought,total,date). All I want to achieve is fetch results in tblStatistics and post them in tblResults basinf on buyer codes in the tblBUyerCodes table. I hope this makes sense, I am a newbie to this"}, {"owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1543411555, "post_id": 53519954, "comment_id": 93909580, "body": "Not in the comments please"}, {"owner": {"reputation": 33, "user_id": 10717139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9569a3f6facee476fc600ea71b83db?s=128&d=identicon&r=PG", "display_name": "Tony Carter", "link": "https://stackoverflow.com/users/10717139/tony-carter"}, "reply_to_user": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "edited": false, "score": 0, "creation_date": 1543412613, "post_id": 53519954, "comment_id": 93910303, "body": "I updated my question @Larnu"}], "answers": [{"tags": [], "owner": {"reputation": 59343, "user_id": 2029983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0118fb43d1ce086d768e295339cf0ff4?s=128&d=identicon&r=PG", "display_name": "Larnu", "link": "https://stackoverflow.com/users/2029983/larnu"}, "is_accepted": false, "score": 0, "last_activity_date": 1543414573, "creation_date": 1543414573, "answer_id": 53521479, "question_id": 53519954, "link": "https://stackoverflow.com/questions/53519954/fetch-data-in-one-table-and-use-it-to-fetch-more-data-in-another-table-in-sql-se/53521479#53521479", "title": "Fetch data in one table and use it to fetch more data in another table in SQL SERVER?", "body": "<p>Based on the limited detail we have, why not just?</p>\n\n<pre><code>INSERT INTO tblResult (id, buyercode,goodsbought,total,date)\nSELECT id,\n       buyercode,\n       goodsbought,\n       total,\n       {SomeDateValue} --Maybe GETDATE()?\nFROM tblStatistics;\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10717139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b9569a3f6facee476fc600ea71b83db?s=128&d=identicon&r=PG", "display_name": "Tony Carter", "link": "https://stackoverflow.com/users/10717139/tony-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543430917, "creation_date": 1543409617, "last_edit_date": 1543430917, "question_id": 53519954, "link": "https://stackoverflow.com/questions/53519954/fetch-data-in-one-table-and-use-it-to-fetch-more-data-in-another-table-in-sql-se", "title": "Fetch data in one table and use it to fetch more data in another table in SQL SERVER?", "body": "<p>I have two tables in SQL SERVER which are 1)<code>tblBuyerCodes</code> 2)<code>tblStatistics</code>.</p>\n\n<p>What I want to achieve in SQL Server is get a <code>buyer code</code> in the first table, fetch statistics in the second table of that buyer code and insert details in a 3rd table, let's call it <code>tblResults</code>. How can I achieve this in SQL Server stored procedure?</p>\n\n<p>Specs:</p>\n\n<pre><code>tblBuyerCodes have columns (id, buyercode). \ntblStatistics have columns (id,buyercode,goodsbought,total). \ntblResults have columns (id, buyercode,goodsbought,total,date). \n</code></pre>\n\n<p>All I want to achieve is fetch results in tblStatistics and post them in tblResults basing on buyer codes fetched from the tblBUyerCodes table</p>\n\n<pre><code>For example results will be:\nrow 1: dm6 23 45689\nrow 2: dm8 45 3456\n</code></pre>\n\n<p><code>dm6</code> and <code>dm8</code> being the buyer codes</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1543410826, "post_id": 53519901, "comment_id": 93909147, "body": "What&#39;s your desired behaviour? Do you want to create multiple tables, or overwrite/replace the existing <code>Table 0</code>?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1543410925, "post_id": 53519901, "comment_id": 93909208, "body": "I want to create new sheets for each table from web page.. Ref: Link 1: <a href=\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJAJFINSV&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17\" rel=\"nofollow noreferrer\">nseindia.com/marketinfo/sym_map/&hellip;</a> Ref:Link2: <a href=\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJAJ-AUTO&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17\" rel=\"nofollow noreferrer\">nseindia.com/marketinfo/sym_map/&hellip;</a>"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1543411054, "post_id": 53519901, "comment_id": 93909292, "body": "I have 100+ pages for downloading the tables!! Thank you for spending your time :)"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1543412822, "post_id": 53519901, "comment_id": 93910444, "body": "After downloading i don&#39;t need the query Table 0. Hence, i&#39;m deleting here ActiveWorkbook.Queries(&quot;Table 0&quot;).Delete"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1543414418, "post_id": 53519901, "comment_id": 93911489, "body": "@jsheeran updated the error snap please check.."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1543415108, "post_id": 53519901, "comment_id": 93911960, "body": "Are you downloading over 100 links?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543415182, "post_id": 53519901, "comment_id": 93912024, "body": "Yes from 100 pages 100 tables.."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1543415959, "post_id": 53519901, "comment_id": 93912473, "body": "@QHarr pattern will be the same please check the ref. links above. If possible kindly guide me"}], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 1, "creation_date": 1543425133, "post_id": 53522207, "comment_id": 93918340, "body": "Perfect!! Thank you so much :)"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543488532, "post_id": 53522207, "comment_id": 93941953, "body": "I&#39;m getting run time error &#39;- 2146697211 800c0005 )&#39;: the system cannot locate the resource specified. could you please tell me why?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543489875, "post_id": 53522207, "comment_id": 93942708, "body": "Does it only happen during long runs? Does it contunue to work over a few links?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543490176, "post_id": 53522207, "comment_id": 93942891, "body": "Yes it is.. Any idea to fix this?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543491841, "post_id": 53522207, "comment_id": 93943758, "body": "Which URL does it fail on please?"}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543492223, "post_id": 53522207, "comment_id": 93943957, "body": "<a href=\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=CANBK&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17\" rel=\"nofollow noreferrer\">nseindia.com/marketinfo/sym_map/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543492257, "post_id": 53522207, "comment_id": 93943973, "body": "I will have a look but it won&#39;t be until later."}, {"owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "edited": false, "score": 0, "creation_date": 1543492367, "post_id": 53522207, "comment_id": 93944020, "body": "That&#39;s absolutely fine.. Thanks!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1543417221, "last_edit_date": 1543417221, "creation_date": 1543416793, "answer_id": 53522207, "question_id": 53519901, "link": "https://stackoverflow.com/questions/53519901/downloading-table-from-web-from-multiple-pages/53522207#53522207", "title": "Downloading table from web from multiple pages", "body": "<p>You might consider XMLHTTP requests as a fast method to retrieve. I assume links are in column A of a sheet called <code>Links</code>, starting from row 1.</p>\n\n<p>You would adjust your range </p>\n\n<pre><code>Application.Transpose(ws.Range(\"A1:A3\").Value)\n</code></pre>\n\n<p>to ensure you have all your links included.</p>\n\n<p>I use the <code>symbol</code> to determine the sheet to write to. I use a slighty modified function by @Rory to test if sheet already exists, if not I create it. This assumes symbol doesn't repeat across URLs, otherwise you need to choose something unique for sheet naming.</p>\n\n<p>I target the table by its id using a css id selector of <code>#octable</code>. </p>\n\n<pre><code>Option Explicit    \nPublic Sub Test()\n    Dim sResponse As String, html As HTMLDocument, links(), hTable As HTMLTable\n    Dim symbol As String, i As Long, ws As Worksheet, wsTemp As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Links\")\n    links = Application.Transpose(ws.Range(\"A1:A3\").Value)\n\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        For i = LBound(links) To UBound(links)\n            If InStr(links(i), \"http\") &gt; 0 Then\n                .Open \"GET\", links(i), False\n                .send\n                sResponse = StrConv(.responseBody, vbUnicode)\n\n                Set html = New HTMLDocument\n                With html\n                    .body.innerHTML = sResponse\n                    Set hTable = .querySelector(\"#octable\")\n                End With\n                symbol = Split(Split(links(i), \"symbol=\")(1), \"&amp;\")(0)\n                If Not WorksheetExists(symbol) Then\n                    Set wsTemp = ThisWorkbook.Worksheets.Add\n                    wsTemp.NAME = symbol\n                Else\n                    Set wsTemp = ThisWorkbook.Worksheets(symbol)\n                End If\n                If Not hTable Is Nothing Then\n                    wsTemp.UsedRange.ClearContents\n                    wsTemp.Cells(1, 1) = \"CALLS\": wsTemp.Cells(1, 13) = \"PUTS\"\n                    WriteTable hTable, 2, wsTemp\n                End If\n            End If\n        Next\n    End With\nEnd Sub\nPublic Sub WriteTable(ByVal hTable As HTMLTable, Optional ByVal startRow As Long = 1, Optional ByVal ws As Worksheet)\n\n    If ws Is Nothing Then Set ws = ActiveSheet\n\n    Dim tSection As Object, tRow As Object, tCell As Object, tr As Object, td As Object, r As Long, C As Long, tBody As Object\n    r = startRow\n    With ws\n        Dim headers As Object, header As Object, columnCounter As Long\n        Set headers = hTable.getElementsByTagName(\"th\")\n        For Each header In headers\n            columnCounter = columnCounter + 1\n            If columnCounter &gt; 3 Then\n            .Cells(startRow, columnCounter - 3) = header.innerText\n            End If\n        Next header\n        startRow = startRow + 1\n        Set tBody = hTable.getElementsByTagName(\"tbody\")\n        For Each tSection In tBody               'HTMLTableSection\n            Set tRow = tSection.getElementsByTagName(\"tr\") 'HTMLTableRow\n            For Each tr In tRow\n                r = r + 1\n                Set tCell = tr.getElementsByTagName(\"td\")\n                C = 1\n                For Each td In tCell             'DispHTMLElementCollection\n                    .Cells(r, C).Value = td.innerText 'HTMLTableCell\n                    C = C + 1\n                Next td\n            Next tr\n        Next tSection\n    End With\nEnd Sub\n\nPublic Function WorksheetExists(ByVal sName As String) As Boolean  '&lt;== @Rory\n    WorksheetExists = Evaluate(\"ISREF('\" &amp; sName &amp; \"'!A1)\")\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>References (VBE > Tools > References):</strong></p>\n\n<ol>\n<li>Microsoft HTML Object Library</li>\n</ol>\n"}], "owner": {"reputation": 905, "user_id": 4546587, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/VXhNQ.jpg?s=128&g=1", "display_name": "Linga", "link": "https://stackoverflow.com/users/4546587/linga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 1, "accepted_answer_id": 53522207, "answer_count": 1, "score": 0, "last_activity_date": 1582522388, "creation_date": 1543409439, "last_edit_date": 1582522388, "question_id": 53519901, "link": "https://stackoverflow.com/questions/53519901/downloading-table-from-web-from-multiple-pages", "title": "Downloading table from web from multiple pages", "body": "<p>I'm trying to download table from multiple links via web.</p>\n\n<pre><code>Sub test()\n    cnt = 0\n\n    For i = 2 To 5\n        temp = Cells(i, 1)\n\n        lnk = Right(temp, Len(temp) - WorksheetFunction.Find(\"?\", temp))\n        ActiveWorkbook.Queries.Add Name:=\"Table 0\", Formula:= _\n            \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Web.Page(Web.Contents(\"\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?\"\" &amp; lnk)),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Data0 = Source{0}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Data0,{{\"\"CALLS Chart\"\", type text}, {\"\"CALLS OI\"\", type text}, {\"\"CALLS Chng in OI\"\", type text}, {\"\"CALLS Volume\"\", t\" &amp; _\n            \"ype text}, {\"\"CALLS IV\"\", type text}, {\"\"CALLS LTP\"\", type text}, {\"\"CALLS Net Chng\"\", type text}, {\"\"CALLS Bid Qty\"\", type text}, {\"\"CALLS Bid Price\"\", type text}, {\"\"CALLS Ask Price\"\", type text}, {\"\"CALLS Ask Qty\"\", type text}, {\"\"Strike Price\"\", type number}, {\"\"PUTS Bid Qty\"\", type text}, {\"\"PUTS Bid Price\"\", type text}, {\"\"PUTS Ask Price\"\", type text}, {\"\"PUTS\" &amp; _\n            \" Ask Qty\"\", type text}, {\"\"PUTS Net Chng\"\", type text}, {\"\"PUTS LTP\"\", type text}, {\"\"PUTS IV\"\", type text}, {\"\"PUTS Volume\"\", type text}, {\"\"PUTS Chng in OI\"\", type text}, {\"\"PUTS OI\"\", type text}, {\"\"PUTS Chart\"\", type text}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\"\"\n        ActiveWorkbook.Worksheets.Add\n        With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n            \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"Table 0\"\";Extended Properties=\"\"\"\"\" _\n            , Destination:=Range(\"$A$1\")).QueryTable\n            .CommandType = xlCmdSql\n            .CommandText = Array(\"SELECT * FROM [Table 0]\")\n            .RowNumbers = False\n            .FillAdjacentFormulas = False\n            .PreserveFormatting = True\n            .RefreshOnFileOpen = False\n            .BackgroundQuery = True\n            .RefreshStyle = xlInsertDeleteCells\n            .SavePassword = False\n            .SaveData = True\n            .AdjustColumnWidth = True\n            .RefreshPeriod = 0\n            .PreserveColumnInfo = True\n            .ListObject.DisplayName = \"Table\" &amp; cnt\n            .Refresh BackgroundQuery:=False\n            ActiveWorkbook.Queries(\"Table 0\").Delete\n            cnt = cnt + 1\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>I get<br>\n<a href=\"https://i.stack.imgur.com/teflv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/teflv.png\" alt=\"enter image description here\"></a></p>\n\n<p>As I got this code by recording a macro I'm stuck here in making the web page link dynamic. </p>\n\n<pre><code>ActiveWorkbook.Queries.Add Name:=\"Table 0\", Formula:= _\n        \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Web.Page(Web.Contents(\"\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJAJ-AUTO&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17\"\")),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Data0 = Source{0}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(Data0,{{\"\"CALLS Chart\"\", type text}, {\"\"CALLS OI\"\", type text}, {\"\"CALLS Chng in OI\"\", type text}, {\"\"CALLS Volume\"\", t\" &amp; _\n        \"ype text}, {\"\"CALLS IV\"\", type text}, {\"\"CALLS LTP\"\", type text}, {\"\"CALLS Net Chng\"\", type text}, {\"\"CALLS Bid Qty\"\", type text}, {\"\"CALLS Bid Price\"\", type text}, {\"\"CALLS Ask Price\"\", type text}, {\"\"CALLS Ask Qty\"\", type text}, {\"\"Strike Price\"\", type number}, {\"\"PUTS Bid Qty\"\", type text}, {\"\"PUTS Bid Price\"\", type text}, {\"\"PUTS Ask Price\"\", type text}, {\"\"PUTS\" &amp; _\n        \" Ask Qty\"\", type text}, {\"\"PUTS Net Chng\"\", type text}, {\"\"PUTS LTP\"\", type text}, {\"\"PUTS IV\"\", type text}, {\"\"PUTS Volume\"\", type text}, {\"\"PUTS Chng in OI\"\", type text}, {\"\"PUTS OI\"\", type text}, {\"\"PUTS Chart\"\", type text}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Changed Type\"\"\"\n</code></pre>\n\n<p>Links for your reference:</p>\n\n<ol>\n<li><a href=\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJAJ-AUTO&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17\" rel=\"nofollow noreferrer\">https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJAJ-AUTO&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17</a></li>\n<li><a href=\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJAJFINSV&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17\" rel=\"nofollow noreferrer\">https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJAJFINSV&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17</a></li>\n<li><a href=\"https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJFINANCE&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17\" rel=\"nofollow noreferrer\">https://www.nseindia.com/marketinfo/sym_map/symbolMapping.jsp?symbol=BAJFINANCE&amp;instrument=OPTSTK&amp;date=-&amp;segmentLink=17</a></li>\n</ol>\n"}, {"tags": ["excel", "vba", "indexing", "match"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543409194, "post_id": 53519660, "comment_id": 93908143, "body": "Try <code>.FormulaR1C1 = &quot;=INDEX(&quot; &amp; selRange.Address(ReferenceStyle:=xlR1C1, External:=True) &amp; &quot;,MATCH(&quot; &amp; Workbooks(&quot;Maptivexx&quot;).Worksheets(&quot;sheet1&quot;).Range(&quot;E2&quot;).Addr&zwnj;&#8203;ess(ReferenceStyle:=&zwnj;&#8203;xlR1C1, External:=True) &amp; &quot;,&quot; &amp; TRange.Address(ReferenceStyle:=xlR1C1, External:=True) &amp; &quot;,0))&quot;</code> as formula."}, {"owner": {"reputation": 47, "user_id": 10358672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6037bfc7ea69402f02339050d5f7044b?s=128&d=identicon&r=PG&f=1", "display_name": "Martinswe", "link": "https://stackoverflow.com/users/10358672/martinswe"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543410253, "post_id": 53519660, "comment_id": 93908800, "body": "Thanks, tried but I get &quot;application-defined or object-defined error&quot;  on this part                                                                                                                    &quot;Workbooks(&quot;Maptivexx&quot;).Worksheets(&quot;sheet1&quot;).Range    (&quot;F2&quot;).FormulaR1C1 = _        &quot;=INDEX(&quot; &amp; selRange.Address(ReferenceStyle:=xlR1C1, External:=True) &amp; &quot;,MATCH(&quot; &amp; Workbooks(&quot;Maptivexx&quot;).Worksheets(&quot;sheet1&quot;).Range(&quot;E2&quot;).Addr&zwnj;&#8203;ess(ReferenceStyle:=&zwnj;&#8203;xlR1C1, External:=True) &amp; &quot;,&quot; &amp; TRange.Address(ReferenceStyle:=xlR1C1, External:=True) &amp; &quot;,0))&quot;&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1543426994, "post_id": 53519660, "comment_id": 93919331, "body": "Some basic troubleshooting: Create the formula as a string and use <code>Debug.Print theFormula</code> to output it to the Immediate window in the VB editor.  Does it look as you expect? Can you manually enter that formula into the sheet?  If not, what error does it give you?"}], "owner": {"reputation": 47, "user_id": 10358672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6037bfc7ea69402f02339050d5f7044b?s=128&d=identicon&r=PG&f=1", "display_name": "Martinswe", "link": "https://stackoverflow.com/users/10358672/martinswe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543408912, "creation_date": 1543408651, "last_edit_date": 1543408912, "question_id": 53519660, "link": "https://stackoverflow.com/questions/53519660/index-match-referencing-to-column-name", "title": "Index/match referencing to column name", "body": "<p>I've tried to create a code wich could handle my complex set of data which will be highly dynamic. There are two workbooks, both will change in terms of numbers of rows and columns. However, the columns which is of my interest will have names which will not change over time. </p>\n\n<p>My aim is get the name from one workbooks/worksheet based on a code represented in both workbooks. </p>\n\n<p>So for I have named the columns of interest which will be included in the index/match formula but don't how to progress from that.\nProblem 1: How to setup the formula\nproblem 2 : How to reference to the matching cell </p>\n\n<p>Here the Code: </p>\n\n<pre><code>sub indeD()\n    Dim selRange As Range\n    Dim ColNum As Integer\n    Dim ColKod As Integer\n    Dim CWS As Worksheet\n    Dim wb As Workbook\n    Dim lastRow As Range\n\n    'Find the column number where the column header is\n    Set CWB = Workbooks(\"teknikersenast\")\n    Set CWS = CWB.Worksheets(\"Data\")\n    ColNum = Application.WorksheetFunction.Match(\"Efternamn\", CWS.Rows(1), 0)\n    ColKod = Application.WorksheetFunction.Match(\"Teknikerskod\", CWS.Rows(1), 0)\n\n    'Set the column range to work with\n    Set selRange = CWS.Columns(ColNum)\n    Set TRange = CWS.Columns(ColKod)\n\n    Workbooks(\"Maptivexx\").Worksheets(\"sheet1\").Range (\"F2\").FormulaR1C1 = _\n      \"=INDEX(selRange,MATCH(Workbooks(\"Maptivexx\").Worksheets(\"sheet1\").Range (\"E2\"),TRange,0))\"\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True    \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1543408723, "post_id": 53519562, "comment_id": 93907868, "body": "It&#39;s not clear which line produces the issue? Go through your code step by step using F8 and debug your values to see where the issue happens."}, {"owner": {"reputation": 13, "user_id": 10425527, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AZ5b6gKbHxA/AAAAAAAAAAI/AAAAAAAAAaM/v05QCA-HvZA/photo.jpg?sz=128", "display_name": "Loftyyy", "link": "https://stackoverflow.com/users/10425527/loftyyy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543412100, "post_id": 53519562, "comment_id": 93909928, "body": "the issue happens within table 3, after the rows are deleted as the rest of the code for this works fine"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543429322, "post_id": 53519562, "comment_id": 93920390, "body": "Could you please upload screen shots of the table before running the macro and of the result you&#39;re getting, indicating the &quot;empty lines&quot;. Make sure you turn on the display of non-printing characters so we can see what these &quot;empty lines&quot; are."}, {"owner": {"reputation": 13, "user_id": 10425527, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AZ5b6gKbHxA/AAAAAAAAAAI/AAAAAAAAAaM/v05QCA-HvZA/photo.jpg?sz=128", "display_name": "Loftyyy", "link": "https://stackoverflow.com/users/10425527/loftyyy"}, "edited": false, "score": 0, "creation_date": 1543922577, "post_id": 53519562, "comment_id": 94084495, "body": "Hi, Sorry for the delay, image is <a href=\"http://tinypic.com/r/2ugpftc/9\" rel=\"nofollow noreferrer\">tinypic.com/r/2ugpftc/9</a>. The image shows the email before, then the userform which is completed and it decides which one to display from the 3rd question and then the email after. Hope this helps"}], "owner": {"reputation": 13, "user_id": 10425527, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AZ5b6gKbHxA/AAAAAAAAAAI/AAAAAAAAAaM/v05QCA-HvZA/photo.jpg?sz=128", "display_name": "Loftyyy", "link": "https://stackoverflow.com/users/10425527/loftyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543413954, "creation_date": 1543408359, "last_edit_date": 1543413954, "question_id": 53519562, "link": "https://stackoverflow.com/questions/53519562/how-to-delete-line-breaks-within-certain-cell-of-word-table", "title": "How To Delete Line Breaks Within Certain Cell Of Word Table", "body": "<p>I am currently having trouble with my VBA code. I am currently working on a useform that once completed fills in all the details for an email so it is ready to be sent. I have all the code working perfectly and everything is working okay except for 1 little thing:</p>\n\n<p>In my code I have a <code>Case</code> where if you select a certain option it deletes rows of a table. The <code>Case</code> works fine but for some reason it leaves 4 line breaks after at the end. I wondered if there was anyway to delete these. </p>\n\n<p>Code for the Case is below: </p>\n\n<pre><code>Select Case .Range(\"B6\")\n        Case \"\"\n            MyDoc.tables(2).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(2).Cell(1, 1).Range.Text, \"[Name]\", .Range(\"B4\"))\n\n            MyDoc.tables(3).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(1, 1).Range.Text, \"[Policy]\", .Range(\"B9\"))\n            MyDoc.tables(3).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(1, 1).Range.Text, \"[RenewalDate]\", .Range(\"B10\"))\n            MyDoc.tables(3).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(1, 1).Range.Text, \"[Insurer]\", .Range(\"B11\"))\n            MyDoc.tables(3).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(1, 1).Range.Text, \"[Premium]\", .Range(\"B12\"))\n            MyDoc.tables(3).Rows(3).Delete\n            MyDoc.tables(3).Rows(2).Delete\n\n            MyDoc.tables(4).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(1, 1).Range.Text, \"[Differences]\", .Range(\"B14\"))\n            MyDoc.tables(4).Cell(5, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(5, 1).Range.Text, \"[Current]\", .Range(\"B7\"))\n            MyDoc.tables(4).Cell(7, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(7, 1).Range.Text, \"[Alternate]\", .Range(\"B8\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[NM]\", .Range(\"B43\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[InAd]\", .Range(\"B44\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[BD]\", .Range(\"B45\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[Turn]\", .Range(\"B46\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[Wages]\", .Range(\"B47\"))\n\n        Case \"Existing Unable To Offer\"\n            MyDoc.tables(2).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(2).Cell(1, 1).Range.Text, \"[Name]\", .Range(\"B4\"))\n\n            MyDoc.tables(3).Cell(2, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(2, 1).Range.Text, \"[Policy]\", .Range(\"B9\"))\n            MyDoc.tables(3).Cell(2, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(2, 1).Range.Text, \"[RenewalDate]\", .Range(\"B10\"))\n            MyDoc.tables(3).Cell(2, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(2, 1).Range.Text, \"[Insurer]\", .Range(\"B11\"))\n            MyDoc.tables(3).Cell(2, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(2, 1).Range.Text, \"[Premium]\", .Range(\"B12\"))\n            MyDoc.tables(3).Rows(3).Delete\n            MyDoc.tables(3).Rows(1).Delete\n\n            MyDoc.tables(4).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(1, 1).Range.Text, \"[Differences]\", .Range(\"B14\"))\n            MyDoc.tables(4).Cell(5, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(5, 1).Range.Text, \"[Current]\", .Range(\"B7\"))\n            MyDoc.tables(4).Cell(7, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(7, 1).Range.Text, \"[Alternate]\", .Range(\"B8\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[NM]\", .Range(\"B43\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[InAd]\", .Range(\"B44\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[BD]\", .Range(\"B45\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[Turn]\", .Range(\"B46\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[Wages]\", .Range(\"B47\"))\n\n        Case \"More Competitive Quotation\"\n            MyDoc.tables(2).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(2).Cell(1, 1).Range.Text, \"[Name]\", .Range(\"B4\"))\n\n            MyDoc.tables(3).Cell(3, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(3, 1).Range.Text, \"[Policy]\", .Range(\"B9\"))\n            MyDoc.tables(3).Cell(3, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(3, 1).Range.Text, \"[RenewalDate]\", .Range(\"B10\"))\n            MyDoc.tables(3).Cell(3, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(3, 1).Range.Text, \"[Insurer]\", .Range(\"B11\"))\n            MyDoc.tables(3).Cell(3, 1).Range.Text = VBA.Replace(MyDoc.tables(3).Cell(3, 1).Range.Text, \"[Premium]\", .Range(\"B12\"))\n            MyDoc.tables(3).Rows(1).Delete\n            MyDoc.tables(3).Rows(1).Delete\n\n            MyDoc.tables(4).Cell(1, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(1, 1).Range.Text, \"[Differences]\", .Range(\"B14\"))\n            MyDoc.tables(4).Cell(5, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(5, 1).Range.Text, \"[Current]\", .Range(\"B7\"))\n            MyDoc.tables(4).Cell(7, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(7, 1).Range.Text, \"[Alternate]\", .Range(\"B8\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[NM]\", .Range(\"B43\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[InAd]\", .Range(\"B44\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[BD]\", .Range(\"B45\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[Turn]\", .Range(\"B46\"))\n            MyDoc.tables(4).Cell(8, 1).Range.Text = VBA.Replace(MyDoc.tables(4).Cell(8, 1).Range.Text, \"[Wages]\", .Range(\"B47\"))\n\n    End Select\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "ms-word", "rtf"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1543409064, "post_id": 53519515, "comment_id": 93908060, "body": "I&#39;m using Word 2016 on Office 365 64 bit.  When I open the documents there is no difference between them."}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1543411854, "post_id": 53519515, "comment_id": 93909770, "body": "Did you check paragraph from screen? Thanks anyway."}, {"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1543414583, "post_id": 53519515, "comment_id": 93911594, "body": "Yes.  I specifically checked the paragraphs you showed in screen."}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "reply_to_user": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1543416382, "post_id": 53519515, "comment_id": 93912726, "body": "Thanks, but its very strange for me. Before save I have 0 when checking numbered items (Debug.Print ActiveDocument.CountNumberedItems) and after reopen ==15 (for rtf file). As I said - thanks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1543428749, "post_id": 53519515, "comment_id": 93920122, "body": "Since this is also happening when you save manually you might have better luck tracking this down in an end-user venue, rather than here on Stack Overflow. It&#39;s almost certainly an issue with the RTF converter or the styles or your specific environment and is not related to macro code. People who work more in the end-user area are more likely to have encountered this kind of thing..."}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "edited": false, "score": 0, "creation_date": 1543475076, "post_id": 53519515, "comment_id": 93934679, "body": "I know and understand. But often after my question users had said: &quot;show your code&quot;, even that wasn&#39;t necessary. I asked here beacuse prehaps someone had the same problem.  Because Freeflow didn&#39;t see difference between files that have to be enviroment+styles+rtf converter issue. Thanks."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1543483941, "post_id": 53519515, "comment_id": 93939113, "body": "So in DOCX you have a normal paragraph that looks like a list entry, but actually is not. When saving to RTF it gets converted to an actual list. Probably has to do something with automatic document formatting, you can try looking in the Word settings (your OneDrive link does not work, keeps displaying &quot;Something went wrong, please try to refresh the page&quot;)."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1543485764, "post_id": 53519515, "comment_id": 93940221, "body": "This looks like a Word bug to me. The problem is that in RTF the style <code>Ju_H_I_Roman (ECHR_Heading_1)</code> is based on the hidden style <code>Heading 1</code>, and that hidden style <i>effectively</i> has an additional &quot;Numbering&quot; rule (which is displayed in its style summary), but when you go to edit the numbering rules for that style, it&#39;s not there (&quot;None&quot; is selected). A workaround is to &quot;Modify&quot; the <code>Heading 1</code> in the style editor in the RTF file, and in its &quot;Numbering&quot; settings just click &quot;Ok&quot; to extra-confirm the &quot;None&quot; that appears to be already selected there."}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1543499429, "post_id": 53519515, "comment_id": 93948040, "body": "@GSerg - Thank you. this line of code solve my problem: <code>ActiveDocument.Styles(wdStyleHeading1).LinkToListTemplate ListTemplate:=Nothing</code> But it was possible with your solution."}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "edited": false, "score": 0, "creation_date": 1543499784, "post_id": 53519515, "comment_id": 93948261, "body": "<b>edit</b> haha, after re-open saved rtf still error in style..."}, {"owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "edited": false, "score": 0, "creation_date": 1543502981, "post_id": 53519515, "comment_id": 93950137, "body": "<b>edit once again</b> I&#39;ve to use <code>ECHR_Heading_1</code> instead of <code>wdStyleHeading1</code> enumeration in my piece of code.. and works!"}], "owner": {"reputation": 45, "user_id": 2923934, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41e3ed9f35f423009b1fffda70f87235?s=128&d=identicon&r=PG&f=1", "display_name": "deku", "link": "https://stackoverflow.com/users/2923934/deku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543482893, "creation_date": 1543408201, "last_edit_date": 1543482893, "question_id": 53519515, "link": "https://stackoverflow.com/questions/53519515/why-saveas-rtf-destroy-styles-in-document-word-2016", "title": "Why .SaveAs rtf destroy styles in document (Word 2016)", "body": "<p>I have a document (European jurisprudence) in the form of a DOCX file. When I save it to RTF, after re-opening it has different numbering styles. Why?</p>\n\n<p>My workflow:</p>\n\n<ol>\n<li>Open the file</li>\n<li>Macro SaveAsRtfTest - everything looks ok</li>\n<li>Close file</li>\n<li>Reopen the RTF file - not ok</li>\n</ol>\n\n<p>My simple macro:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub SaveAsRtfTest()\n  Dim fileName1 As String\n  fileName1 = Replace(ActiveDocument.fullName, \".docx\", \".rtf\", , , vbTextCompare)\n  ActiveDocument.SaveAs fileName:=fileName1, FileFormat:=wdFormatRTF, AddToRecentFiles:=False\nEnd Sub\n</code></pre>\n\n<p>But when I save manually there is the same issue.</p>\n\n<p>Very important! Numbering is visible only after closing and opening the RTF file.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w7R2f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w7R2f.png\" alt=\"screen\"></a></p>\n\n<p>Files (docx and rtf):\n<a href=\"https://1drv.ms/f/s!AnanHEI101rbhf8vgkipTUNwvXUQ4w\" rel=\"nofollow noreferrer\">https://1drv.ms/f/s!AnanHEI101rbhf8vgkipTUNwvXUQ4w</a></p>\n\n<p>edit____</p>\n\n<p>I've compared ActiveDocument.Range.xml content.</p>\n\n<p>This is the portion shown on the screenshot from the RTF file:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;w:p wsp:rsidR=\"0026237B\" wsp:rsidRPr=\"004F6791\" wsp:rsidRDefault=\"0026237B\" wsp:rsidP=\"0026237B\"&gt;\n    &lt;w:pPr&gt;\n        &lt;w:pStyle w:val=\"ECHRHeading1\"/&gt;\n        &lt;w:listPr&gt;\n            &lt;wx:t wx:val=\"Artyku\u0142 I.\"/&gt;\n            &lt;wx:font wx:val=\"Times New Roman\"/&gt;\n        &lt;/w:listPr&gt;\n    &lt;/w:pPr&gt;\n    &lt;w:r wsp:rsidRPr=\"004F6791\"&gt;\n        &lt;w:t&gt;I.\u00a0\u00a0THE CIRCUMSTANCES OF THE CASE&lt;/w:t&gt;\n    &lt;/w:r&gt;\n&lt;/w:p&gt;\n</code></pre>\n\n<p>as compared to DOCX:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;w:p wsp:rsidR=\"00A32B8B\" wsp:rsidRPr=\"004F6791\" wsp:rsidRDefault=\"00A32B8B\" wsp:rsidP=\"00A32B8B\"&gt;\n    &lt;w:pPr&gt;\n        &lt;w:pStyle w:val=\"ECHRHeading1\"/&gt;\n    &lt;/w:pPr&gt;\n    &lt;w:r wsp:rsidRPr=\"004F6791\"&gt;\n        &lt;w:t&gt;I.\u00a0\u00a0THE CIRCUMSTANCES OF THE CASE&lt;/w:t&gt;\n    &lt;/w:r&gt;\n&lt;/w:p&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1543407193, "post_id": 53518549, "comment_id": 93906985, "body": "Have you looked into <a href=\"https://support.office.com/en-us/article/conditional-formatting-6b6f7c2a-5d62-45a1-8f67-584a76776d67\" rel=\"nofollow noreferrer\">conditionnal formatting</a>?"}, {"owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1543478659, "post_id": 53518549, "comment_id": 93936246, "body": "cybernetic.nomad - Yes, the problem with the conditional formatting is that it works with some cells then suddenly wont with another, that&#39;s why im trying my luck with VBA code"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1543498191, "post_id": 53518549, "comment_id": 93947293, "body": "That should not be the case. I suggest you ask another question about that. For your VBA, you will probably want to loop through your rows -- a search should reveal several questions (and answers!) about that"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1544175289, "post_id": 53518549, "comment_id": 94191152, "body": "&quot;<i>when i select it in B15, D14:E15,G15 should be highlighted</i>&quot;  I take it that should be <code>D15:E15</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "edited": false, "score": 0, "creation_date": 1545811926, "post_id": 53667003, "comment_id": 94699380, "body": "Thank you everyone, i will try the code provided too"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1544176466, "last_edit_date": 1544176466, "creation_date": 1544176148, "answer_id": 53667003, "question_id": 53518549, "link": "https://stackoverflow.com/questions/53518549/applying-vba-code-to-each-cell-to-fomat-another-cell/53667003#53667003", "title": "Applying VBA code to each cell to fomat another cell", "body": "<p><strong>To do it with conditional formatting only:</strong>  </p>\n\n<ul>\n<li>Select cells <code>D15:E15, G15</code></li>\n<li>Select <em>New Rule</em> in <code>Conditional Formatting</code>.\n\n<ul>\n<li>Select <em>Use a formula to determine which cells to format</em></li>\n<li>Add the formula <code>=$B15=\"Add CCG/CC/PCG/PC\"</code><br>\n<strong>Note</strong> - no <code>$</code> before the row number. </li>\n<li>Set the desired format. </li>\n</ul></li>\n<li>Drag <code>D15:E15, G15</code> down to <code>D114:E115, G114</code>.  </li>\n</ul>\n\n<p><strong>To do it with VBA:</strong>  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    'Check the changed cell is in the range B15:B114.\n    'Not Is Nothing = it is something...\n    If Not Intersect(Target, Range(\"B15:B114\")) Is Nothing Then\n        With Target\n            If .Value = \"Add CCG/CC/PCG/PC\" Then\n                'Target is the changed cell.  Offset by 2 columns is column D.\n                'Resize by 2 columns is columns D:E.\n                'Union with Offset 5 columns (column G) to return cells to change.\n                With Union(.Offset(, 2).Resize(, 2), .Offset(, 5)).Interior\n                    .Pattern = xlSolid\n                    .PatternColorIndex = xlAutomatic\n                    .ThemeColor = xlThemeColorLight1\n                    .TintAndShade = 0\n                    .PatternTintAndShade = 0\n                End With\n            Else\n                With Union(.Offset(, 2).Resize(, 2), .Offset(, 5)).Interior\n                    .Pattern = xlNone\n                    .TintAndShade = 0\n                    .PatternTintAndShade = 0\n                End With\n            End If\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Further reading:  </p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.change\" rel=\"nofollow noreferrer\">Worksheet Change Event</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.intersect\" rel=\"nofollow noreferrer\">Intersect</a>  </li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.union\" rel=\"nofollow noreferrer\">Union</a>  </li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.offset\" rel=\"nofollow noreferrer\">Offset</a>  </li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.resize\" rel=\"nofollow noreferrer\">Resize</a>  </li>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/with-end-with-statement\" rel=\"nofollow noreferrer\">With...End With Statement</a></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 10716812, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rbeulL0yW5Q/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jX-R-np-PKvbEFmCzc6n7oY1pE2g/mo/photo.jpg?sz=128", "display_name": "Lois", "link": "https://stackoverflow.com/users/10716812/lois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1544176466, "creation_date": 1543404993, "last_edit_date": 1544162134, "question_id": 53518549, "link": "https://stackoverflow.com/questions/53518549/applying-vba-code-to-each-cell-to-fomat-another-cell", "title": "Applying VBA code to each cell to fomat another cell", "body": "<p>I'm still learning how to write VBA and it is quite challenging. Hope someone can help me.</p>\n\n<p>I want to highlight cell in column <code>D:E</code>,<code>G</code> when i select \"Add CCG/CC/PCG/PC\" in my column <code>B</code>. But i want to apply this from <code>B15:B114</code>. when i select it in <code>B15</code>, <code>D14:E15</code>,<code>G15</code> should be highlighted. if i select <code>B18</code> then <code>D18</code>,<code>E18</code> &amp; <code>G18</code> should be highlighted &amp; so on. i am only able to do it in one row but how can i apply it to my desired range without doing it one by one.\nthanks in advance</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Range(\"B15\").Value = \"Add CCG/CC/PCG/PC\" Then\n\n    Range(\"D15:E15,G15\").Select\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorLight1\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n    End With\n\n    ElseIf Range(\"B15\").Value = \"\" Then\n    Range(\"D15:E15,G15\").Select\n\n        With Selection.Interior\n        .Pattern = xlNone\n        .TintAndShade = 0\n        .PatternTintAndShade = 0\n\n    End With\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543403397, "post_id": 53517957, "comment_id": 93904763, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44749046/force-udf-in-vba-to-display-a-msgbox-when-the-user-enters-more-than-expected-arg\">Force UDF in VBA to display a MsgBox when the user enters more than expected arguments?</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1543403658, "post_id": 53517957, "comment_id": 93904892, "body": "Probably none of your functions throws a VBA exception. Note that <code>Application.MMult</code> will return an error code as result like <code>Error 2015</code> but it will return it to your function (and show up as result in your cell) and not throw an Exception. \u2022 Anyway I think it&#39;s no good idea to use a message box in a UDF. This could easily throw a box for each formula you have on the sheet -&gt; happy clicking."}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543413164, "post_id": 53518360, "comment_id": 93910681, "body": "In addition to this answer: Avoid using <code>MsgBox</code> in a UDF. Instead return an error value eg with <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/cverr-function\" rel=\"nofollow noreferrer\">CVErr Function</a> like <code>MyMatrix = CVErr(xlErrValue)</code>"}], "tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1543404343, "creation_date": 1543404343, "answer_id": 53518360, "question_id": 53517957, "link": "https://stackoverflow.com/questions/53517957/vba-message-box-not-working-for-in-the-on-error-goto/53518360#53518360", "title": "VBA message box not working for in the on error goto", "body": "<p>There are two ways of calling worksheet functions from VBA:</p>\n\n<p>1) Application.MInverse <br>\n2) Application.WorksheetFunction.MInverse</p>\n\n<p>When an error occurs 1) returns a variant containing an error, but 2) raises an error.\nSo you either need to use 1) with <code>If Iserror(M) Then</code> or 2) with your existing code.</p>\n\n<p>Note using 2) is faster than 1)</p>\n\n<p>See also my blog post on UDFs <a href=\"https://fastexcel.wordpress.com/2011/06/06/writing-efficient-vba-udfs-part-2/\" rel=\"nofollow noreferrer\">https://fastexcel.wordpress.com/2011/06/06/writing-efficient-vba-udfs-part-2/</a></p>\n"}], "owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543476095, "creation_date": 1543403028, "last_edit_date": 1543476095, "question_id": 53517957, "link": "https://stackoverflow.com/questions/53517957/vba-message-box-not-working-for-in-the-on-error-goto", "title": "VBA message box not working for in the on error goto", "body": "<p>Below is a function that I've written in VBA. </p>\n\n<pre><code>Option Explicit\n\nFunction MyMatrix(mtx As Range, vec As Range) As Variant\n    On Error GoTo Exception\n\n    Dim M\n    M = Application.MInverse(mtx)\n\n    MyMatrix = Application.MMult(M, vec)\n\n    Exit Function\nException:\n    MsgBox prompt:=\"Test\", Buttons:=[vbOKCancel,vbCritical], Title:=\"Two\"\nEnd Function\n</code></pre>\n\n<p>However, when I try to use it, the msgbox is not showing up for an error. \nBelow, is a matrix that has a determinate zero, which you can't multiple with another vector. I believe my code is recognizing that the determinate is zero because I get the error in the box on the spreadsheet, but my message box dosen't pop up. What would cause this error?   </p>\n\n<p>I've tried to read through some other examples, but they didn't help. And I don't want to use \"On Error Resume Next\" instead. </p>\n\n<p><a href=\"https://i.stack.imgur.com/3h3uu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3h3uu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "loops", "formatting", "conditional"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1543402527, "post_id": 53517698, "comment_id": 93904290, "body": "You can just format the entire range in one go, there is no need to loop. Just specify &gt;=$B20 and &lt;=$A20 as the values so that the column reference is absolute but the row reference is not."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1543402561, "post_id": 53517698, "comment_id": 93904317, "body": "Did you try formula based conditional formatting could achieve this?"}, {"owner": {"reputation": 1, "user_id": 10716507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216947755061365/picture?type=large", "display_name": "Anna", "link": "https://stackoverflow.com/users/10716507/anna"}, "edited": false, "score": 0, "creation_date": 1543403063, "post_id": 53517698, "comment_id": 93904574, "body": "Thank you so much, the specification of &gt;=$B20 and &lt;=$A20 was the charm!"}], "owner": {"reputation": 1, "user_id": 10716507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216947755061365/picture?type=large", "display_name": "Anna", "link": "https://stackoverflow.com/users/10716507/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543402159, "creation_date": 1543402159, "question_id": 53517698, "link": "https://stackoverflow.com/questions/53517698/conditional-formatting-for-each-individual-row", "title": "Conditional formatting for each individual row", "body": "<p>I am working with an excel sheet with numbers in several rows right below each other. I want to conditionally format each row, so that the all values of this row which are below the value in column A and above the value in column B of the same row are marked. E.g. in row 20, all values below the value of A20 are marked yellow and all values above B20 are marked red. In row 21, all values below A21 and B21...</p>\n\n<p>I created a loop through the rows 20-22 for now, the range will vary in later applications. The loop now is always referring back to A20 and B20 instead of referring to values i would like to use for each row (e.g A21 and B21 for row 21). I tried to use Ai and Bi, but that did not work. This is where i would need the main help - which syntax can i use to refer to the cells i want instead of A20 and B20? </p>\n\n<p>Additionally, is there a way to mark the conditionally formated cells with real colors? E.g conditionally yellow filled with yellow? At the moment I am selecting the conditionally formated cells by hand and add a fill. </p>\n\n<p>Thank you for your help!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim i As Integer\n\nFor i = 20 To 22\n\nRows(i).Select\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlGreater, _\n    Formula1:=\"=$B$20\"\n\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Font\n    .Color = -16383844\n    .TintAndShade = 0\nEnd With\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 13551615\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\nSelection.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, _\n    Formula1:=\"=$A$20\"\n\n\nSelection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority\nWith Selection.FormatConditions(1).Font\n    .Color = -16383844\n    .TintAndShade = 0\nEnd With\nWith Selection.FormatConditions(1).Interior\n    .PatternColorIndex = xlAutomatic\n    .Color = 13551615\n    .TintAndShade = 0\nEnd With\nSelection.FormatConditions(1).StopIfTrue = False\n\nNext i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "utf-8", "ms-word", "utf-16"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543406487, "post_id": 53517603, "comment_id": 93906529, "body": "Could you please provide some sample text that contains problem characters, and give us the corresponding Unicode values. Otherwise, only people who use Arabic can test, which severely limits the pool of possible helpers... Please use the <a href=\"https://stackoverflow.com/posts/53517603/edit\">edit</a> link to include the information <i>in</i> the question (not in a comment)."}, {"owner": {"reputation": 317, "user_id": 6227615, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TGvX5.jpg?s=128&g=1", "display_name": "Atef Wagih", "link": "https://stackoverflow.com/users/6227615/atef-wagih"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543407524, "post_id": 53517603, "comment_id": 93907179, "body": "@Cindy Meister. Thanks. I added examples, explanation and a link to the full unicode map."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 6227615, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TGvX5.jpg?s=128&g=1", "display_name": "Atef Wagih", "link": "https://stackoverflow.com/users/6227615/atef-wagih"}, "edited": false, "score": 0, "creation_date": 1543465982, "post_id": 53526480, "comment_id": 93931740, "body": "Thanks @Cindy. I am creating this macro to convert the text to hex code to be able to use it in Notepad++ macros. I don&#39;t have control to change the Notepad++ macro system from hex code to decimal. I was hoping for a solution that utilizes the hex code. Thanks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 317, "user_id": 6227615, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TGvX5.jpg?s=128&g=1", "display_name": "Atef Wagih", "link": "https://stackoverflow.com/users/6227615/atef-wagih"}, "edited": false, "score": 0, "creation_date": 1543494808, "post_id": 53526480, "comment_id": 93945408, "body": "If you search using the decimal you can still replace with the hex? Set it up in a dicationary or an array. Or use code to calculate the one from the other..."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 1, "last_activity_date": 1543432171, "creation_date": 1543432171, "answer_id": 53526480, "question_id": 53517603, "link": "https://stackoverflow.com/questions/53517603/macro-to-replace-characters-with-unicode-code-working-partially-only/53526480#53526480", "title": "Macro to replace Characters with Unicode Code working partially only", "body": "<p>Unicode can be represented in Word VBA using the hex codes such as <code>062A</code> or as a decimal number equivalent such as <code>1579</code>. </p>\n\n<p>One way to determine the decimal number equivalent is to select the character in Word then run in the Immediate Window (ctrl+G in the VBA Editor):</p>\n\n<pre><code>?AscW(Selection.text)\n</code></pre>\n\n<p>Another is to calculate it or use a converter.</p>\n\n<p>This value can then be used as the Find text:</p>\n\n<pre><code>With Selection.Find\n  .Text = ChrW(1579)\n  'and so on...\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 6227615, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TGvX5.jpg?s=128&g=1", "display_name": "Atef Wagih", "link": "https://stackoverflow.com/users/6227615/atef-wagih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1583835137, "creation_date": 1543401908, "last_edit_date": 1583835137, "question_id": 53517603, "link": "https://stackoverflow.com/questions/53517603/macro-to-replace-characters-with-unicode-code-working-partially-only", "title": "Macro to replace Characters with Unicode Code working partially only", "body": "<p>I wrote a macro to change Arabic letters to their corresponding UTF code, and add a prefix and suffix to them. I want to use this macro for further development.</p>\n\n<p>For example, the word <code>\u0643\u0644\u0645\u0629</code> will need to be changed:</p>\n\n<p><code>&amp;#x0643;&amp;#x0644;&amp;#x0645;&amp;#x0629;</code></p>\n\n<p>This means that every Arabic letter got a <code>&amp;#x</code> before its unicode number, and then got a <code>;</code> after it.</p>\n\n<p>I wrote the macro below, which works perfectly for the characters whose code is all numbers, e.g. <code>0627</code> or <code>0628</code>. But for the letters that has an English letter, the macro does not work. e.g. <code>062A</code> and <code>062B</code>. Whether I wrote it <code>062a</code> or <code>062A</code> both don't work.</p>\n\n<p>I need help to locate the error in the macro that makes it works only for the letters with all-numbers unicode block, while doesn't work with the other letters.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Sub test1()\n'\n' test1 Macro\n'\n'\nDim characters_to_find_list As String\ncharacters_to_find_list = \"0627,0623,0625,0628,062A,062B,062C\"\n\nDim characters_to_replace_list As String\ncharacters_to_replace_list = \"0627,0623,0625,0628,062A,062B,062C\"\n\nDim characters_to_find As Variant\ncharacters_to_find = Split(characters_to_find_list, \",\")\n\nDim characters_to_replace As Variant\ncharacters_to_replace = Split(characters_to_replace_list, \",\")\n\nFor i = 0 To UBound(characters_to_find)\n\nSelection.Find.ClearFormatting\nSelection.Find.Replacement.ClearFormatting\n\nWith Selection.Find\n\n.Text = ChrW(\"&amp;H\" &amp; Val(characters_to_find(i)))\n.Replacement.Text = \"&amp;#x\" &amp; (\"&amp;H\" &amp; Val(characters_to_replace(i)) &amp; \";\")\n.Forward = True\n.Wrap = wdFindContinue\n.Format = True\n.MatchCase = True\n.MatchWholeWord = False\n.MatchKashida = False\n.MatchDiacritics = False\n.MatchAlefHamza = True\n.MatchControl = False\n.MatchWildcards = False\n.MatchSoundsLike = False\n.MatchAllWordForms = False\n\nEnd With\n\nSelection.Find.Execute Replace:=wdReplaceAll\n\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT:</strong>\nHere is a sample text made up of the characters I have in the macro as a test (the full macro will contain all the Arabic Alphabet):</p>\n\n<p><code>\u0627 \u0623 \u0628 \u0627 \u062a \u0625 \u062b  \u0623 \u062c  \u0627 \u0623 \u0628 \u0627 \u062a \u0625 \u062b  \u0623 \u062c  \u0627 \u0623 \u0628 \u0627 \u062a \u0625 \u062b  \u0623 \u062c  \u0627 \u0623 \u0628 \u0627 \u062a \u0625 \u062b  \u0623 \u062c  \u0627 \u0623 \u0628 \u0627 \u062a \u0625 \u062b  \u0623 \u062c  \u0627 \u0623 \u0628 \u0627 \u062a \u0625 \u062b  \u0623 \u062c</code>.</p>\n\n<p>Here is the result after running my macro, you can see that some characters did not convert. The characters that did not convert are the ones with English letters in their Unicode block:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5ujAE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5ujAE.jpg\" alt=\"Test Results\"></a></p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Arabic_script_in_Unicode\" rel=\"nofollow noreferrer\">The Unicode block of each Arabic letter is present in this Wikipedia page. please click here to see it.</a> Any character with English Letters in it, will not convert using my macro. </p>\n\n<p>As an example:\nLetter <code>\u0627</code> (top left hand corner of the table) has unicode <code>0623</code>, it converts correctly, while letter <code>\u062a</code>(third row in the table) has unicode <code>062A</code>, it will not convert.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "image", "outlook", "size"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1543502750, "post_id": 53517484, "comment_id": 93949969, "body": "Now that there is an answer to one of the two questions you see why you should have two separate posts. As well it is easier for searchers to find relevant answers to their specific question. You could edit your post to remove the signature question and try a separate on-topic question."}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1543483752, "creation_date": 1543483752, "answer_id": 53535712, "question_id": 53517484, "link": "https://stackoverflow.com/questions/53517484/vba-picture-excel-to-outlook-with-image-resizeing/53535712#53535712", "title": "VBA - Picture Excel to Outlook with image resizeing", "body": "<p>You could refer to this code:</p>\n\n<pre><code> For Each shp In wordDoc.InlineShapes\n        shp.ScaleHeight = 90\n        shp.ScaleWidth = 90\n    Next\n</code></pre>\n\n<p>For more information, Please refer to this link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/45446208/resize-a-pasted-jpeg-in-a-mailitem\">Resize a pasted JPEG in a MailItem</a></p>\n"}], "owner": {"reputation": 1, "user_id": 1928767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfda57386bcfe16015a221eba6e55fda?s=128&d=identicon&r=PG", "display_name": "Magik Jukas", "link": "https://stackoverflow.com/users/1928767/magik-jukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543483752, "creation_date": 1543401567, "last_edit_date": 1543401686, "question_id": 53517484, "link": "https://stackoverflow.com/questions/53517484/vba-picture-excel-to-outlook-with-image-resizeing", "title": "VBA - Picture Excel to Outlook with image resizeing", "body": "<p>I put together a code which works pretty well, however the picture that is pasted on the email is a bit too small, I would like to make it bigger but I am struggling to find the right code.</p>\n\n<p>Another issue is that the signature is right next to the picture while I would like it to be a few rows below.</p>\n\n<p>Can anyone bring these two features to my code?</p>\n\n<pre><code>Sub Print_and_send()\nDim Sht As Excel.Worksheet\nSet Sht = ThisWorkbook.ActiveSheet\n\nDim rng As Range\nSet rng = Sht.Range(\"D3:Y42\")\n    rng.CopyPicture Appearance:=xlScreen, Format:=xlPicture\n\nDim OutApp As Object\nSet OutApp = CreateObject(\"Outlook.Application\")\n\nDim OutMail As Object\nSet OutMail = OutApp.CreateItem(0)\n\nDim vInspector As Object\nSet vInspector = OutMail.GetInspector\n\nDim wEditor As Object\nSet wEditor = vInspector.WordEditor\n\n\nWith OutMail\n    .To = \"youremail\"\n    .CC = \"youremail\"\n\n    .Subject = \"Test\"\n    .display\n\n\n     wEditor.Paragraphs(2).Range.Paste\n\n\n\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1543401899, "post_id": 53517274, "comment_id": 93903919, "body": "It does work as in it doesn&#39;t give a <code>#Name</code> error.  It doesn&#39;t take out the vowels either though."}], "answers": [{"tags": [], "owner": {"reputation": 5592, "user_id": 282694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c90896d42cfb5df3e088bb2173baf9b2?s=128&d=identicon&r=PG", "display_name": "sarh", "link": "https://stackoverflow.com/users/282694/sarh"}, "is_accepted": false, "score": 1, "last_activity_date": 1543558894, "last_edit_date": 1543558894, "creation_date": 1543401822, "answer_id": 53517576, "question_id": 53517274, "link": "https://stackoverflow.com/questions/53517274/vba-excel-calling-a-function-from-excel/53517576#53517576", "title": "VBA excel - Calling a function from excel", "body": "<p>Regardign the #NAME error (not about the logic) - most likely you've added function at Application of Sheet level in VBA. It must be added in separate module instead (Right click on VBAProject - Insert - Module)</p>\n"}, {"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1543402528, "post_id": 53517672, "comment_id": 93904294, "body": "Now that I think of it... Perhaps you are better off just adding a Replace function for each of the 5 vowels instead of looping through all characters in the string. What my code does now is replacing all of one vowel in the string anyway once it finds said vowel. Running the Replace function five times should not put a lot of strain on Excel"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1543402590, "post_id": 53517672, "comment_id": 93904327, "body": "I hadn&#39;t spotted the square bracket mistake. So the original code posted by OP does work if he uses <code>[]</code> instead of <code>()</code> and puts the code in the correct place.  But, as you say - <code>REPLACE</code> would be simpler."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1543403760, "post_id": 53517672, "comment_id": 93904951, "body": "That&#39;s right, I have added a more elegant solution that does not require the function to loop through all characters"}, {"owner": {"reputation": 31, "user_id": 9020604, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JVYd1HZh_II/AAAAAAAAAAI/AAAAAAAAB1w/n-bdEhJU86Y/photo.jpg?sz=128", "display_name": "user9020604", "link": "https://stackoverflow.com/users/9020604/user9020604"}, "edited": false, "score": 0, "creation_date": 1543404811, "post_id": 53517672, "comment_id": 93905553, "body": "Dr Mr Bartrup-Cook and Mr Stack. I copied your code and also inserted Square brackets to specify ranges. I have also placed this code in a new VBA module, I am still getting a #NAME error."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1543405367, "post_id": 53517672, "comment_id": 93905851, "body": "Are you pasting the code in the same workbook as the one you&#39;re using the formula in? What kind of strings are you adding to the formula?"}, {"owner": {"reputation": 31, "user_id": 9020604, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JVYd1HZh_II/AAAAAAAAAAI/AAAAAAAAB1w/n-bdEhJU86Y/photo.jpg?sz=128", "display_name": "user9020604", "link": "https://stackoverflow.com/users/9020604/user9020604"}, "edited": false, "score": 0, "creation_date": 1543409885, "post_id": 53517672, "comment_id": 93908578, "body": "Yes I have and the #NAME error doesn&#39;t appear. But I am not seeing the text without vowels. I used the code you had suggested. Another question is if the source text is in C2 for instance, =REMOVEVOWELS(c2) pasted in E2 should do the trick, right?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1543410389, "post_id": 53517672, "comment_id": 93908876, "body": "The example you provided specifies the function should only remove capitalised vowels. If you want all vowels removed, add them to the array in my code"}, {"owner": {"reputation": 31, "user_id": 9020604, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JVYd1HZh_II/AAAAAAAAAAI/AAAAAAAAB1w/n-bdEhJU86Y/photo.jpg?sz=128", "display_name": "user9020604", "link": "https://stackoverflow.com/users/9020604/user9020604"}, "edited": false, "score": 0, "creation_date": 1553175667, "post_id": 53517672, "comment_id": 97293291, "body": "Replace Code is excellent.Thanks.  Just one question. You have mentioned &quot;For Each a&quot;, in this example a is a pointer to a location? plus I can&#39;t use another Pointer such as x?"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1553176054, "post_id": 53517672, "comment_id": 97293569, "body": "<code>a</code> refers to the item in the array. Can be named anything sensible"}], "tags": [], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "is_accepted": false, "score": 2, "last_activity_date": 1543402879, "last_edit_date": 1543402879, "creation_date": 1543402095, "answer_id": 53517672, "question_id": 53517274, "link": "https://stackoverflow.com/questions/53517274/vba-excel-calling-a-function-from-excel/53517672#53517672", "title": "VBA excel - Calling a function from excel", "body": "<p>Rewritten, tested, and works! Insert this at the top of a Module</p>\n\n<pre><code>Function REMOVEVOWELS(Txt) As String\n'Removes all vowels from the Txt argument\n Dim i As Long\n For i = 1 To Len(Txt)\n    If Mid(Txt, i, 1) Like \"[AEIOU]\" Then\n        Txt = Replace(Txt, Mid(Txt, i, 1), \"\")\n    End If\n Next i\nREMOVEVOWELS = Txt\n End Function\n</code></pre>\n\n<p>EDIT</p>\n\n<p>A more elegant solution.</p>\n\n<pre><code>Function REMOVEVOWELS(Txt) As String\n'Removes all vowels from the Txt argument\nVowels = Array(\"A\", \"E\", \"I\", \"O\", \"U\")\n\nFor Each a In Vowels\n    Txt = Replace(Txt, a, \"\")\nNext a\nREMOVEVOWELS = Txt\n End Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9020604, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-JVYd1HZh_II/AAAAAAAAAAI/AAAAAAAAB1w/n-bdEhJU86Y/photo.jpg?sz=128", "display_name": "user9020604", "link": "https://stackoverflow.com/users/9020604/user9020604"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1543558894, "creation_date": 1543400889, "last_edit_date": 1543406692, "question_id": 53517274, "link": "https://stackoverflow.com/questions/53517274/vba-excel-calling-a-function-from-excel", "title": "VBA excel - Calling a function from excel", "body": "<p>I wrote a VBA program to remove vowels. I am not able to call the function from excel. i get a #NAME error. Code  below</p>\n\n<pre><code>Function REMOVEVOWELS(Txt) As String\n'Removes all vowels from the Txt argument\n Dim i As Long\n REMOVEVOWELS = \"\"\n For i = 1 To Len(Txt)\n     If Not UCase(Mid(Txt, i, 1)) Like \"(AEIOU)\" Then\n         REMOVEVOWELS = REMOVEVOWELS &amp; Mid(Txt, i, 1)\n     End If\n Next i\n End Function\n</code></pre>\n\n<p>Code tags inserted by Tim Stack</p>\n"}, {"tags": ["ms-access", "ftp", "vba", "winscp"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10294281, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2CCCnOGz70s/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO5XOelWoxIwM7D5IaApq_osWt8AQ/mo/photo.jpg?sz=128", "display_name": "Tristan King", "link": "https://stackoverflow.com/users/10294281/tristan-king"}, "edited": false, "score": 0, "creation_date": 1543412035, "post_id": 53517445, "comment_id": 93909887, "body": "Thanks for the answer, but the code in that link is long and confusing and I&#39;m not sure what parts exactly I need? Does my original Call Shell() code need to be changed entirely?"}, {"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "reply_to_user": {"reputation": 57, "user_id": 10294281, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2CCCnOGz70s/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO5XOelWoxIwM7D5IaApq_osWt8AQ/mo/photo.jpg?sz=128", "display_name": "Tristan King", "link": "https://stackoverflow.com/users/10294281/tristan-king"}, "edited": false, "score": 0, "creation_date": 1543413123, "post_id": 53517445, "comment_id": 93910655, "body": "You need to replace your <code>Shell</code> call with what the <code>RunApplication</code> function does in the linked code. There&#39;s no easier way in VBA. - If you do not explain us, what you find <i>&quot;confusing&quot;</i> about the code, we cannot help you on that."}], "tags": [], "owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "is_accepted": true, "score": 2, "last_activity_date": 1543403096, "last_edit_date": 1543403096, "creation_date": 1543401446, "answer_id": 53517445, "question_id": 53517262, "link": "https://stackoverflow.com/questions/53517262/ms-access-vba-get-result-of-winscp-transfer/53517445#53517445", "title": "MS Access VBA get result of WinSCP transfer", "body": "<p>WinSCP indicates a result with its exit code.<br>\nSee WinSCP FAQ <a href=\"https://winscp.net/eng/docs/faq_script_result\" rel=\"nofollow noreferrer\">How do I know that script completed successfully?</a></p>\n\n<p>So run WinSCP and make sure it returns 0 (success).<br>\nSee <a href=\"https://stackoverflow.com/q/1439200/850848\">VBA Shell and Wait with Exit Code</a></p>\n"}], "owner": {"reputation": 57, "user_id": 10294281, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2CCCnOGz70s/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaO5XOelWoxIwM7D5IaApq_osWt8AQ/mo/photo.jpg?sz=128", "display_name": "Tristan King", "link": "https://stackoverflow.com/users/10294281/tristan-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 53517445, "answer_count": 1, "score": 1, "last_activity_date": 1543403096, "creation_date": 1543400861, "last_edit_date": 1543401478, "question_id": 53517262, "link": "https://stackoverflow.com/questions/53517262/ms-access-vba-get-result-of-winscp-transfer", "title": "MS Access VBA get result of WinSCP transfer", "body": "<p>I have code that uploads a folder to an FTP server using WinSCP.</p>\n\n<pre><code>Dim strSFTPDir As String\nstrSFTPDir = \"C:\\Program Files (x86)\\WinSCP\\\"\nDim UploadsDir As String\nUploadsDir = DLookup(\"PathToPics\", \"Admin\") &amp; \"\\Uploads\\*\"\nCall Shell(strSFTPDir &amp; \"winscp.com /command \"\"open ftp://***/\"\" \"\"put -filemask=|*.ldb \"\"\"\"\" &amp; UploadsDir &amp; \"\"\"\"\" \"\" \"\"exit\"\" \", vbNormalFocus)\n</code></pre>\n\n<p>However I need to let Access know whether it's succeeded or failed.\nHow can I do that?</p>\n"}, {"tags": ["vba", "pivot-table", "excel-2016"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543419281, "post_id": 53517049, "comment_id": 93914712, "body": "Do you get any errors if you remove <code>On Error Resume Next</code>?"}, {"owner": {"reputation": 537, "user_id": 4874431, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1cd654e65715bdfd95fd1f4efe4549bd?s=128&d=identicon&r=PG&f=1", "display_name": "Pallavi Prasad", "link": "https://stackoverflow.com/users/4874431/pallavi-prasad"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1544173039, "post_id": 53517049, "comment_id": 94190014, "body": "yes. It gives out of memory error sometimes"}], "owner": {"reputation": 537, "user_id": 4874431, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/1cd654e65715bdfd95fd1f4efe4549bd?s=128&d=identicon&r=PG&f=1", "display_name": "Pallavi Prasad", "link": "https://stackoverflow.com/users/4874431/pallavi-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543400194, "creation_date": 1543400194, "question_id": 53517049, "link": "https://stackoverflow.com/questions/53517049/getting-n-a-when-changing-value-field-settings-in-pivot-table-using-vba", "title": "Getting #n/a when changing value field settings in Pivot table using vba", "body": "<p>I have a use case where I filter the column values in a pivot and then change the value field settings of the pivot table. I am creating the pivot table and the sheet every time while deleting the previous one. My problem is that I am unable to get one column to reflect in the pivot but the values are correct in the grand total. My code is below:</p>\n\n<pre><code>  Sub createPivotandFilter()\n    'Declare Variables\n    Dim PSheet As Worksheet\n    Dim DSheet As Worksheet\n    Dim PCache As PivotCache\n    Dim PTable As PivotTable\n    Dim PRange As Range\n    Dim LastRow As Long\n    Dim LastCol As Long\n    Dim pf As PivotField\n    Dim PItems As PivotItem\n\n    'Insert a New Blank Worksheet\n    On Error Resume Next\n    Application.DisplayAlerts = False\n    Worksheets(\"PivotTable\").Delete\n    Sheets.Add Before:=ActiveSheet\n    ActiveSheet.Name = \"PivotTable\"\n    Application.DisplayAlerts = True\n    Set PSheet = Worksheets(\"PivotTable\")\n    Set DSheet = Worksheets(\"Data_TB Detail\")\n\n    'Define Data Range\n    LastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\n    LastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n    Set PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n    'Define Pivot Cache\n    Set PCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=PRange). _\n    CreatePivotTable(TableDestination:=PSheet.Cells(3, 1), _\n    TableName:=\"VariancePivot\")\n\n    'Insert Blank Pivot Table\n    Set PTable = PCache.CreatePivotTable _\n    (TableDestination:=PSheet.Cells(1, 1), TableName:=\"VariancePivot\")\n\n    With ActiveSheet.PivotTables(\"VariancePivot\")\n        .InGridDropZones = True\n        .RowAxisLayout xlTabularRow\n    End With\n\n    'Insert Column Fields\n    With ActiveSheet.PivotTables(\"VariancePivot\").PivotFields(\"Period\")\n    .Orientation = xlColumnField\n    .Position = 1\n    End With\n\n    With ActiveSheet.PivotTables(\"VariancePivot\").PivotFields(\"LE\")\n    .Orientation = xlColumnField\n    .Position = 2\n    End With\n\n    'Insert Row Fields\n    With ActiveSheet.PivotTables(\"VariancePivot\").PivotFields(\"Mapped up 1st  level\")\n    .Orientation = xlRowField\n    .Position = 1\n    End With\n\n    With ActiveSheet.PivotTables(\"VariancePivot\").PivotFields(\"Account\")\n    .Orientation = xlRowField\n    .Position = 2\n    End With\n\n    With ActiveSheet.PivotTables(\"VariancePivot\").PivotFields(\"Description\")\n    .Orientation = xlRowField\n    .Position = 3\n    End With\n\n    'Insert Data Field\n     With ActiveSheet.PivotTables(\"VariancePivot\").PivotFields(\"USD\")\n    .Orientation = xlDataField\n    .Position = 1\n      .Function = xlSum\n      .NumberFormat = \"#,##0\"\n      .Name = \"Sum of USD\"\n      .Calculation = xlDifferenceFrom\n       .BaseField = \"Period\"\n       .BaseItem = \"Jun 30,2018\"\n      End With\n\n    'adding the filter\n    Set PTable = ActiveSheet.PivotTables(\"VariancePivot\")\n    Set pf = PTable.PivotFields(\"Period\")\n    PTable.RefreshTable\n\n    temp = pf.PivotItems.Count\n    For i = 1 To temp\n        If pf.PivotItems(i).Value = \"Jun 30,2018\" Or pf.PivotItems(i).Value =   \"Sep 30,2018\" Then\n            pf.PivotItems(i).Visible = True\n        Else\n            pf.PivotItems(i).Visible = False\n        End If\n    Next\n\n    End Sub\n</code></pre>\n\n<p>A screenshot of the result:\n<a href=\"https://i.stack.imgur.com/5YVC8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5YVC8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "edited": false, "score": 0, "creation_date": 1543400660, "post_id": 53517010, "comment_id": 93903156, "body": "Apologies I think I worded this wrong. I have a formula on Template which need to be copied from there and pasted into the other sheets"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "edited": false, "score": 0, "creation_date": 1543400864, "post_id": 53517010, "comment_id": 93903256, "body": "well that&#39;s precisely what my code is doing  provided that 1) the &quot;Template&quot; sheet is <code>Sheet1</code> 2) formulas to be copied from &quot;Template&quot; sheet are in &quot;AB1:AC5&quot; 3) formulas are to be pasted in range &quot;AB1:AC5&quot; of any other sheet but those listed in <code>worksheetsToSkip</code>"}, {"owner": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "edited": false, "score": 0, "creation_date": 1543401217, "post_id": 53517010, "comment_id": 93903487, "body": "for example I want to multiple whatever is in K3 with K4 in each worksheet and display it in AB1 of each worksheet respectively. When using this code I get =Template!A2 displayed in AB1"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1543400090, "creation_date": 1543400090, "answer_id": 53517010, "question_id": 53516807, "link": "https://stackoverflow.com/questions/53516807/copy-range-of-formulas-across-worksheets/53517010#53517010", "title": "Copy range of formulas across worksheets", "body": "<p>you were quite near, since you had to use <code>Formula</code> property of <code>Range</code> object and a reference to the \"source\" range <code>Address</code></p>\n\n<p>also, you had a variable name mismatch: declared <code>sh As Worksheet</code> but then you used <code>ws</code></p>\n\n<p>try this:</p>\n\n<pre><code>Sub FillSheets()\n    Dim sh As Worksheet\n    Dim rng As Range\n\n    Dim worksheetsToSkip As Variant\n\n    worksheetsToSkip = Array(\"Aggregated\", \"Collated Results\", \"Template\", \"End\")\n    Set rng = Sheet1.Range(\"AB1:AC5\")\n\n    For Each sh In Worksheets\n       If IsError(Application.Match(sh.Name, worksheetsToSkip, 0)) Then sh.Range(rng.Address).Formula = rng.Formula\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "is_accepted": false, "score": 0, "last_activity_date": 1543431799, "last_edit_date": 1543431799, "creation_date": 1543429562, "answer_id": 53525825, "question_id": 53516807, "link": "https://stackoverflow.com/questions/53516807/copy-range-of-formulas-across-worksheets/53525825#53525825", "title": "Copy range of formulas across worksheets", "body": "<h1>The Exclamation Mark Issue</h1>\n\n<h2>Cells Containing Sheet References</h2>\n\n<p>There is a worksheet named <code>Template</code>. You can write into cell <code>A1</code> the formula <code>=A2+A3</code>. You can also write <code>=Template!A2+A3</code> or <code>=Template!A2+Template!A3</code>. In all three cases the result is the same. But when you <code>Paste Special</code> the formulas into another sheet, you'll get different formulas in each case and therefore possibly different results. This code removes this possibility by pasting only the first scenario (<code>=A2+A3</code>).  </p>\n\n<h2>When does Excel write these sheet references to a sheet?</h2>\n\n<p>In our example the case <code>=Template!A2+A3</code> could have happened when the <code>Template</code> tab was selected, in the formula bar the equal sign (<code>=</code>) was entered, a different tab was clicked, then the <code>Template</code> tab was clicked, <code>A2+A3</code> was entered and <code>ENTER</code> was pressed.<br>\nThe case <code>=Template!A2+Template!A3</code> could have happened when the <code>Template</code> tab was selected, in the formula bar the equal sign (<code>=</code>) was entered, a different tab was clicked, then the <code>Template</code> tab was clicked, <code>A2</code> was selected, again a different tab was clicked, (<code>+</code>) was entered, again the <code>Template</code> tab was clicked, <code>A3</code> was selected and <code>ENTER</code> was pressed.</p>\n\n<pre><code>Option Explicit\n\n'*******************************************************************************\n' Purpose:  Pastes formulas from a range in an initial worksheet               *\n'           to the same range in all worksheets that are not included          *\n'           in a specified worksheet-names list of exceptions.                 *\n' Remarks:  There has to be a worksheet with the codename \"Sheet1\"             *\n'           in the workbook in which this code resides or it will not compile. *\n'*******************************************************************************\nSub FillSheetsWithRangeOfFormulas()\n\n  Const cStrRange = \"AB1:AC5\"                         ' Initial Range Address\n  Const cStrSkip = \"Aggregated,Collated Results,End\"  ' List of Exceptions\n  Const cStrSkipSeparator = \",\"                       ' List of Exceptions Sep.\n\n  Dim objWs As Worksheet      ' Worksheet Object to be Used in a For Each Loop\n  Dim vntSkip As Variant      ' List of Exceptions Array\n  Dim vntFormulas As Variant  ' Formulas Array\n  Dim lngRows As Long         ' Formulas Array Rows Counter\n  Dim intColumns As Integer   ' Formulas Array Columns Counter\n  Dim vntWb As Variant        ' Workbooks Array\n  Dim intWb As Integer        ' Workbooks Array Rows Counter\n  Dim strDel As String        ' Worksheet Reference String (\"!\" &amp; Sheet1.Name)\n  Dim strWb As String         ' Workbooks Array Split String (\"]\" &amp; strDel)\n  Dim strWbTemp As String     ' Workbooks Array Temporary String (\"\" or strWb)\n  Dim strWbResult As String   ' Workbooks Array Resulting String\n\n  With Sheet1\n    ' Paste Initial-Range formulas into (1-based 2-dimensional) Formulas Array.\n    vntFormulas = .Range(cStrRange).Formula\n    ' Define Worksheet Decalaration String\n    strDel = .Name &amp; \"!\"\n  End With\n\n  ' Define Workbooks Array Split String to use to not remove worksheet\n  ' references to sheets with the same name as Sheet1 in other workbooks.\n  strWb = \"]\" &amp; strDel\n\n  ' Remove worksheet(!) references from formulas in Formulas Array.\n\n  ' In the following For-Next loop, in the comments, \"Template\" for Sheet1's\n  ' name is used.\n\n  For intColumns = LBound(vntFormulas, 2) To UBound(vntFormulas, 2)\n    For lngRows = LBound(vntFormulas) To UBound(vntFormulas)\n\n      ' Check if element does not contain \"]Template!\" which would indicate that\n      ' it is linking to a sheet with the same name in another workbook.\n      If InStr(1, vntFormulas(lngRows, intColumns), strWb, _\n          vbTextCompare) = 0 Then   ' Does NOT contain \"]Template!\" (strWb).\n\n        ' Check if element contains just \"Template!\" (strDel).\n        If InStr(1, vntFormulas(lngRows, intColumns), strDel, _\n            vbTextCompare) &lt;&gt; 0 Then    ' DOES contain \"Template!\" (strDel).\n          ' Write resulting string to Formulas Array (overwriting).\n          vntFormulas(lngRows, intColumns) = Replace(vntFormulas(lngRows, _\n              intColumns), strDel, \"\", , , vbTextCompare)\n'         Else                          ' Does NOT contain \"Template!\" (strDel).\n        End If\n\n       Else                         ' DOES contain \"]Template!\" (strWb).\n\n        strWbResult = \"\"\n        ' Split the element's string by \"]Template!\" (strWb) into a 0-based\n        ' 1-dimensional array.\n        vntWb = Split(vntFormulas(lngRows, intColumns), strWb, , vbTextCompare)\n        ' Rebuild the string removing additional \"Template!\" (strDel) strings.\n        For intWb = LBound(vntWb) To UBound(vntWb)\n          If intWb &lt;&gt; 0 Then ' Is NOT first element of array.\n            strWbTemp = strWb\n           Else              ' IS first element of array.\n            strWbTemp = \"\"\n          End If\n          ' Check if element contains just \"Template!\" (strDel).\n          If InStr(1, vntWb(intWb), strDel, _\n              vbTextCompare) &lt;&gt; 0 Then  ' DOES contain \"Template!\" (strDel).\n            strWbResult = strWbResult &amp; strWbTemp &amp; Replace(vntWb(intWb), _\n                strDel, \"\", , , vbTextCompare)\n           Else                         ' Does NOT contain \"Template!\" (strDel).\n            strWbResult = strWbResult &amp; strWbTemp &amp; vntWb(intWb)\n          End If\n        Next\n        Erase vntWb\n        ' Write resulting string to Formulas Array (overwriting).\n        vntFormulas(lngRows, intColumns) = strWbResult\n\n      End If\n\n    Next\n  Next\n\n  With Sheet1\n    ' Populate (0-based 1 dimensional) List of Exceptions Array (vntSkip),\n    ' after adding Sheet1's name (.Name i.e. Sheet1.Name).\n    vntSkip = Split(cStrSkip &amp; cStrSkipSeparator &amp; .Name, cStrSkipSeparator)\n    ' Paste Formulas Array (vntFormulas) into the range (same size and position\n    ' as the Initial Range (cStrRange)) of each worksheet whose name is not\n    ' contained in the List of Exceptions (vntSkip) in the workbook\n    ' (.Parent.Name i.e. Sheet1.Parent.Name) where Sheet1 resides.\n    For Each objWs In Workbooks(.Parent.Name).Worksheets\n      If IsError(Application.Match(objWs.Name, vntSkip, 0)) Then _\n          objWs.Range(cStrRange).Formula = vntFormulas\n    Next\n  End With\n\n  Erase vntSkip\n  Erase vntFormulas\n\nEnd Sub\n'*******************************************************************************\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543431799, "creation_date": 1543399474, "question_id": 53516807, "link": "https://stackoverflow.com/questions/53516807/copy-range-of-formulas-across-worksheets", "title": "Copy range of formulas across worksheets", "body": "<p>I have a range of formulas which need to be copied across all worksheets. The range goes from AB1:AC5. The formulas need to work across the worksheets and are taken from a worksheet called \"Template\" which is the first sheet in the workbook. I believe I have already selected the range and it will continue to only copy from \"Template\". How would I get it to paste onto every other sheet?</p>\n\n<pre><code>Sub FillSheets()\n Dim sh As Worksheet\n Dim rng As Range\n\n Dim worksheetsToSkip As Variant\n\n worksheetsToSkip = Array(\"Aggregated\", \"Collated Results\", \"Template\", \"End\")\n Set rng = Sheet1.Range(\"AB1:AC5\")\n\n For Each ws In Worksheets\n    If IsError(Application.Match(ws.Name, worksheetsToSkip, 0)) Then\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1543397612, "post_id": 53515952, "comment_id": 93901249, "body": "in your question if condition made you change ws.Cells(i, 9) to &quot;0&quot;.After change take place which range do you want to sort, based on which column and how (ascending descending)?Also i think is better to use .VALUE if you refer to cell value."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10450222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bd9de5e4995b37b21d5770c5963a5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Joe", "link": "https://stackoverflow.com/users/10450222/j-joe"}, "edited": false, "score": 0, "creation_date": 1543405295, "post_id": 53516848, "comment_id": 93905817, "body": "Thanks for help but how can I but it in this Code"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1543399599, "creation_date": 1543399599, "answer_id": 53516848, "question_id": 53515952, "link": "https://stackoverflow.com/questions/53515952/find-and-change-value-in-excel-multiple/53516848#53516848", "title": "Find and change value in excel multiple", "body": "<p>just place and <code>Exit For</code> to exit the current <code>ws</code> sheet loop at first matching:</p>\n\n<pre><code>Sub replace_sales()\n\n    Dim ws As Worksheet\n    Dim i As Long\n\n    For Each ws In ActiveWorkbook.Worksheets\n        For i = 1 To 10000\n            If ws.Cells(i, 1) = \"1932597\" Then\n                ws.Cells(i, 9) = \"0\"\n                Exit For\n            End If\n        Next i\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10450222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/115bd9de5e4995b37b21d5770c5963a5?s=128&d=identicon&r=PG&f=1", "display_name": "J.Joe", "link": "https://stackoverflow.com/users/10450222/j-joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543405380, "creation_date": 1543396747, "last_edit_date": 1543398835, "question_id": 53515952, "link": "https://stackoverflow.com/questions/53515952/find-and-change-value-in-excel-multiple", "title": "Find and change value in excel multiple", "body": "<p>I have two same number I want to sort after, but I want to change only one of them.</p>\n\n<pre><code>Sub replace_sales()\n\nDim ws As Worksheet\n\nFor Each ws In ActiveWorkbook.Worksheets\n    For i = 1 To 10000\n        If ws.Cells(i, 1) = \"1932597\" Then\n            ws.Cells(i, 9) = \"0\"\n        End If\n    Next i\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1543394887, "post_id": 53515352, "comment_id": 93899679, "body": "did you put the function to a Module or in the Sheet VBA part?"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "reply_to_user": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1543395112, "post_id": 53515352, "comment_id": 93899801, "body": "In a module...."}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 2, "creation_date": 1543395218, "post_id": 53515352, "comment_id": 93899853, "body": "Works for me - what error do you get?"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "edited": false, "score": 1, "creation_date": 1543395286, "post_id": 53515352, "comment_id": 93899887, "body": "I get #NAME? when I try using the function on the Sheet in excel."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1543395328, "post_id": 53515352, "comment_id": 93899914, "body": "what is your selection range? rows count must equal column count in the selection"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1543395418, "post_id": 53515352, "comment_id": 93899978, "body": "Do you definitely have it in a standard module (not a class) and in the same workbook as the range?"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "edited": false, "score": 0, "creation_date": 1543395473, "post_id": 53515352, "comment_id": 93900012, "body": "For the selection range.. just the range of the matrix"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "edited": false, "score": 0, "creation_date": 1543395553, "post_id": 53515352, "comment_id": 93900061, "body": "Yes, it&#39;s just in a standard module in the same workbook."}, {"owner": {"reputation": 3078, "user_id": 8537807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2J8ds.png?s=128&g=1", "display_name": "EvR", "link": "https://stackoverflow.com/users/8537807/evr"}, "edited": false, "score": 1, "creation_date": 1543395684, "post_id": 53515352, "comment_id": 93900127, "body": "#name looks like a typo in your function call on sheet (?)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543395741, "post_id": 53515352, "comment_id": 93900155, "body": "@user6259845 how exactly do you use the function in your formula? It should be like <code>=determinate(A1:B2)</code>"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1543395853, "post_id": 53515352, "comment_id": 93900202, "body": "what happens if you try this in the Immediate window? ?determinate(range(&quot;A1:D4&quot;))"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "edited": false, "score": 0, "creation_date": 1543396003, "post_id": 53515352, "comment_id": 93900287, "body": "I typed it like =determinate(A1:B2) and it doesn&#39;t work.... but I just tried changing the name of my function in the VBA code to something else like &quot;test&quot; and it is now working. But it still doesn&#39;t work it I try it with the original function name I had. Does anyone know what would cause this?"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "edited": false, "score": 0, "creation_date": 1543396244, "post_id": 53515352, "comment_id": 93900438, "body": "If I renamed my module &quot;determinate&quot; would this cause the error?"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 2, "creation_date": 1543396349, "post_id": 53515352, "comment_id": 93900499, "body": "Yes: module name should not match function name"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "edited": false, "score": 2, "creation_date": 1543396406, "post_id": 53515352, "comment_id": 93900535, "body": "Ah, that fixed it. Thanks for your help!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543396464, "post_id": 53515352, "comment_id": 93900571, "body": "@user6259845 Try to avoid duplicate names anyway, this can confuse humans too ;)"}, {"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1543396506, "post_id": 53515352, "comment_id": 93900597, "body": "It would work if you used =determinate.determinate(A1:D4)"}, {"owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "edited": false, "score": 0, "creation_date": 1543396594, "post_id": 53515352, "comment_id": 93900650, "body": "That&#39;s good to know, thank you again all for the advice/help."}], "owner": {"reputation": 185, "user_id": 6259845, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fba0e10b5f9b8ee3664ca8735095c8ff?s=128&d=identicon&r=PG&f=1", "display_name": "user6259845", "link": "https://stackoverflow.com/users/6259845/user6259845"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1582610944, "creation_date": 1543394668, "last_edit_date": 1582610944, "question_id": 53515352, "link": "https://stackoverflow.com/questions/53515352/using-excel-function-in-created-vba-function", "title": "Using excel function in created VBA function", "body": "<p>I am trying to write a function in VBA, that I can then use in excel...</p>\n\n<p>This is not the exact function that I want to create, but I'm having a lot of trouble so I simplified it down a lot...</p>\n\n<p>Suppose I have the following matrix in my excel spreadsheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pWYap.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pWYap.png\" alt=\"enter image description here\"></a></p>\n\n<p>I know there is a built-in function in excel to find the determinate. Now, I want to use that in my function I define in VBA. Again there will be more stuff in my function, but I'm just trying to understand what I'm doing wrong. </p>\n\n<p>So suppose this is my function I've defined in VBA...</p>\n\n<pre><code>Option Explicit\n\nPublic Function determinate(mtx As Range)\n\ndeterminate = Application.MDeterm(mtx)\n\nEnd Function\n</code></pre>\n\n<p>However, when trying to use determinate() in excel it doesn't calculate. Why is this/How can I fix this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2327, "user_id": 4742570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0017a2bafead37c0b8dab5d6df77138c?s=128&d=identicon&r=PG&f=1", "display_name": "jsheeran", "link": "https://stackoverflow.com/users/4742570/jsheeran"}, "edited": false, "score": 0, "creation_date": 1543395509, "post_id": 53515344, "comment_id": 93900038, "body": "Will the pattern consistently be 1, 2, 3 for the whole column? You could just use <code>=MOD(ROW(),3)+1</code>."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 1, "creation_date": 1543395529, "post_id": 53515344, "comment_id": 93900046, "body": "could you please be more precise what you want to do?"}, {"owner": {"reputation": 13, "user_id": 9573630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4044c1c7aab40fd5ddf86f7c6fe27f59?s=128&d=identicon&r=PG&f=1", "display_name": "syahida", "link": "https://stackoverflow.com/users/9573630/syahida"}, "edited": false, "score": 0, "creation_date": 1543398802, "post_id": 53515344, "comment_id": 93902021, "body": "Thank You so muchh :) -jsheeran.. i got it."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10710896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe900a59eab543f4065254208eed21f2?s=128&d=identicon&r=PG&f=1", "display_name": "VFor", "link": "https://stackoverflow.com/users/10710896/vfor"}, "is_accepted": false, "score": 0, "last_activity_date": 1543399530, "creation_date": 1543399530, "answer_id": 53516823, "question_id": 53515344, "link": "https://stackoverflow.com/questions/53515344/paste-incremental-values-in-vba/53516823#53516823", "title": "Paste incremental values in VBA", "body": "<p>This may not be the cleanest way, but it will do the trick.</p>\n\n<pre><code>Sub InsertSequenceAndColours()\n    Dim ws As Worksheet\n    Dim rng As Range\n    Dim iLast As Integer\n    Dim i As Integer\n    Dim iSeq As Integer\n    Dim iColRGB(2, 3) As Integer\n    Dim iIncremColour As Integer 'used to determine the colour to use\n    Dim iColour As Integer\n\n    'set RGB Colours; change as needed\n    'colour 0 (green)\n    iColRGB(0, 1) = 146\n    iColRGB(0, 2) = 208\n    iColRGB(0, 3) = 80\n    'colour 1 (pink)\n    iColRGB(1, 1) = 255\n    iColRGB(1, 2) = 225\n    iColRGB(1, 3) = 236\n\n    'change to 0 if you want to start with colour 1 (pink)\n    iIncremColour = 1\n\n\n    'declare worksheet to work on\n    Set ws = ThisWorkbook.Worksheets(Sheet1.Name)\n\n    With ws\n        'find last row\n        iLast = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n        'loop through column C\n        For i = 2 To iLast\n            iSeq = iSeq + 1\n            If .Cells(i, 3).Value &lt;&gt; .Cells(i - 1, 3).Value Then\n                iSeq = 1\n                iIncremColour = iIncremColour + 1\n            End If\n\n            'assign Seq. No. to cell (column E)\n            .Cells(i, 5).Value = iSeq\n\n            'find if iIncremColor is odd or even. output: 0 or 1\n            iColour = iIncremColour Mod 2\n\n            'assign colour to col C D E\n            .Range(Cells(i, 3), Cells(i, 5)).Interior.Color = _\n                    RGB(iColRGB(iColour, 1), iColRGB(iColour, 2), iColRGB(iColour, 3))\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>It finds out the Seq \"1\" (Col E) by finding the first occurrence of \"No\" (Col C); Seq \"2, 3\" are just incremental (so it will work also with more than 3 occurrences).\nSame with colour. For each \"Seq 1\" it increments a number; by checking if this number is odd or even it assign one colour or the other.</p>\n\n<p>Please Note I use worksheet codename to work (if you're not familiar with it, please google it), which I strongly advise since it will work even if you decide to change the name of your worksheet in excel.\nWhen VBA requests to work with worksheet name or index, you can trick it by using <code>codename.Name</code> or <code>codename.Index</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1543400765, "creation_date": 1543400765, "answer_id": 53517231, "question_id": 53515344, "link": "https://stackoverflow.com/questions/53515344/paste-incremental-values-in-vba/53517231#53517231", "title": "Paste incremental values in VBA", "body": "<p><strong>Approach via array</strong></p>\n\n<p>You can fill an array and write it back to your target range:</p>\n\n<pre><code>Sub FlexibleRange()\nDim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Main\")    ' &lt;&lt; change to your     sheet name\nDim start As Long, last As Long, i As Long                       ' declare variables\nstart = 2: last = 100                                            ' &lt;~~ change to your individual rows\nDim v: ReDim v(start To last, 1 To 1)                            ' variant datafield array, counter\n\nFor i = start To last\n    v(i, 1) = (i - start) Mod 3 + 1                              ' assign values\nNext i \n\nws.Range(\"E\" &amp; start &amp; \":E\" &amp; last) = v                          ' write numbers to column E\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 9573630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4044c1c7aab40fd5ddf86f7c6fe27f59?s=128&d=identicon&r=PG&f=1", "display_name": "syahida", "link": "https://stackoverflow.com/users/9573630/syahida"}, "is_accepted": true, "score": 0, "last_activity_date": 1543970159, "creation_date": 1543970159, "answer_id": 53623493, "question_id": 53515344, "link": "https://stackoverflow.com/questions/53515344/paste-incremental-values-in-vba/53623493#53623493", "title": "Paste incremental values in VBA", "body": "<p>I got to solve it.</p>\n\n<p>i use this formula </p>\n\n<pre><code>=MOD(ROW()-2,3)+1.\n</code></pre>\n\n<p>Thank's you all..appreciate your help. &lt;3</p>\n"}], "owner": {"reputation": 13, "user_id": 9573630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4044c1c7aab40fd5ddf86f7c6fe27f59?s=128&d=identicon&r=PG&f=1", "display_name": "syahida", "link": "https://stackoverflow.com/users/9573630/syahida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 53623493, "answer_count": 3, "score": 0, "last_activity_date": 1557130912, "creation_date": 1543394632, "last_edit_date": 1557130912, "question_id": 53515344, "link": "https://stackoverflow.com/questions/53515344/paste-incremental-values-in-vba", "title": "Paste incremental values in VBA", "body": "<p>How can I run a loop in VBA so that the sequence looks like in green an pink color?</p>\n\n<p>Because when I use this code is actually just paste all number 1. not increase.</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Main\").Range(\"E2:E\" &amp; iLast).FillDown\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/x1Abq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x1Abq.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "infinite-loop", "after-save"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543394551, "post_id": 53515135, "comment_id": 93899487, "body": "You know that this <code>xlVeryHidden</code> kind of &quot;security&quot; is easily breakable? I can open your workbook (without running your code) and then I can easily unhide all your sheets."}, {"owner": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1591757102, "post_id": 53515135, "comment_id": 110174516, "body": "Im not so much trying to make it inaccessable to everyone, so much as inaccessable to the people I work with who think that im some kind of sorcerer because I hold alt and double tap = to sum the column above.  Though I&#39;m curious, given that all VBA code will be password protected, how would you unhide the xlveryhidden sheets without VBA?  this seems useful to know about"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1591769118, "post_id": 53515135, "comment_id": 110177637, "body": "You would just need to open up a second brand new workbook along with your workbook that conains the hidden sheet. And you can write VBA there. Then you can use <code>Workbooks(&quot;YourWbWithHiddenSheet.xlsm&quot;).Worksheets(&quot;YourHidd&zwnj;&#8203;enSheet&quot;).Visible = xlSheetVisible</code> to access your hidden sheet in the other workbook and it&#39;s visible. Nothing can prevent this."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1543395653, "creation_date": 1543395653, "answer_id": 53515622, "question_id": 53515135, "link": "https://stackoverflow.com/questions/53515135/endless-looping-with-an-aftersave-subroutine/53515622#53515622", "title": "Endless looping with an aftersave subroutine", "body": "<p>to avoid endless triggering loop:</p>\n\n<pre><code>    'Step 7: Save the workbook\n        Application.EnableEvents = False\n        ActiveWorkbook.Save\n        Application.EnableEvents = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "is_accepted": false, "score": 0, "last_activity_date": 1543407311, "creation_date": 1543407311, "answer_id": 53519259, "question_id": 53515135, "link": "https://stackoverflow.com/questions/53515135/endless-looping-with-an-aftersave-subroutine/53519259#53519259", "title": "Endless looping with an aftersave subroutine", "body": "<p>A slightly different strategy:</p>\n\n<ol>\n<li><code>Workbook_BeforeSave</code> to unhide START sheet and hide all the others which will fire</li>\n<li><code>Workbook_AfterSave</code> to hide START and unhide all the other sheets and</li>\n<li><code>Workbook_Open</code> to hide START and unhide all the other sheets.</li>\n</ol>\n\n<p>The code:</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n    Dim ws As Worksheet\n\n    Application.ScreenUpdating = False 'stops flicker and improves speed\n    Sheets(\"START\").Visible = xlSheetVisible\n    For Each ws In ThisWorkbook.Worksheets\n        If ws.Name &lt;&gt; \"Start\" Then\n            ws.Visible = xlVeryHidden\n        End If\n    Next ws\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub Workbook_AfterSave(ByVal Success As Boolean)\n    Dim ws As Worksheet\n\n    Application.ScreenUpdating = False 'stops flicker and improves speed\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Visible = xlSheetVisible\n    Next ws\n    Sheets(\"START\").Visible = xlVeryHidden\n    Application.ScreenUpdating = True\nEnd Sub\n\nPrivate Sub Workbook_Open()\n    Dim ws As Worksheet\n\n    Application.ScreenUpdating = False 'stops flicker and improves speed\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Visible = xlSheetVisible\n    Next ws\n    Sheets(\"START\").Visible = xlVeryHidden\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 6316529, "user_type": "registered", "profile_image": "https://graph.facebook.com/761439921356/picture?type=large", "display_name": "Kyle Cranfill", "link": "https://stackoverflow.com/users/6316529/kyle-cranfill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1582779443, "creation_date": 1543393835, "last_edit_date": 1582779443, "question_id": 53515135, "link": "https://stackoverflow.com/questions/53515135/endless-looping-with-an-aftersave-subroutine", "title": "Endless looping with an aftersave subroutine", "body": "<p>I am trying to maintain the security of my workbook using veryhidden to force users to enable macros.</p>\n\n<p>This works great except that users have complained about the lack of a dialog box to ask if they wish to save or not on close.</p>\n\n<p>I have added the save/notsave functionality in the form of a msgbox, however this has opened a specific case where security is breached:</p>\n\n<p>Namely, if the user opens the file, enables macros, gets past the splash screen, saves the workbook with the save function, then closes without saving, then the next time the workbook is opened it will not force the user to enable macros.</p>\n\n<p>I have tried to get around this with the following code set to run at the time of saving (i didnt have luck with before save because it was saving again after the code had run, which defeated the point of the code) but this code seems to generate an endless loop triggered by the save.  I tried placing a check at the beginning to check if the state was saved, but since the macro runs after the save this is always a true state for the macro.</p>\n\n<p>Similarly i tried adding a check at the bottom to see if its saved and if it did, then exit the subroutine, however the code never gets this far because it triggers again when it saves.</p>\n\n<p>Anyone have any ideas?  (code below)</p>\n\n<pre><code>Private Sub Workbook_AfterSave(ByVal Success As Boolean)\n\nIf Success = True Then\n    'Step 1: Define WS variable\n        Dim ws As Worksheet\n    'Step 2: Unhide the Starting Sheet\n        Sheets(\"START\").Visible = xlSheetVisible\n    'Step 3: Start looping through all worksheets\n        For Each ws In ThisWorkbook.Worksheets\n    'Step 4: Check each worksheet name\n        If ws.Name &lt;&gt; \"Start\" Then\n    'Step 5: Hide the sheet\n        ws.Visible = xlVeryHidden\n        End If\n    'Step 6: Loop to next worksheet\n        Next ws\n    'Step 7: Save the workbook\n        ActiveWorkbook.Save\n    'Step 8: Start looping through all worksheets\n        For Each ws In ThisWorkbook.Worksheets\n    'Step 9: Re-Unhide All Worksheets\n        ws.Visible = xlSheetVisible\n    'Step 10: Loop to next worksheet\n        Next ws\n    'Step 11: Re-Hide the Start Sheet\n        Sheets(\"START\").Visible = xlVeryHidden\n    'Step 12: Exit loop\n        If ThisWorkbook.Saved = True Then\n        Exit Sub\n        End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1543393121, "post_id": 53514890, "comment_id": 93898749, "body": "When you run this on sheet B, you want it to work on sheet B or sheet A? You have fixed it to work on sheet A..."}, {"owner": {"reputation": 1, "user_id": 10602882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e25d61c4ec8d2153e7bd49795274e141?s=128&d=identicon&r=PG&f=1", "display_name": "AVC", "link": "https://stackoverflow.com/users/10602882/avc"}, "reply_to_user": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1543393286, "post_id": 53514890, "comment_id": 93898821, "body": "I want the macro to work on Sheet A only even if I run it from any other sheet."}, {"owner": {"reputation": 543, "user_id": 3631482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/K2wBD.jpg?s=128&g=1", "display_name": "Jeanjean", "link": "https://stackoverflow.com/users/3631482/jeanjean"}, "edited": false, "score": 0, "creation_date": 1543396621, "post_id": 53514890, "comment_id": 93900669, "body": "Why don&#39;t you add a module and specify the sheet you want the macro to work on?"}, {"owner": {"reputation": 1, "user_id": 10602882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e25d61c4ec8d2153e7bd49795274e141?s=128&d=identicon&r=PG&f=1", "display_name": "AVC", "link": "https://stackoverflow.com/users/10602882/avc"}, "edited": false, "score": 0, "creation_date": 1543471147, "post_id": 53514890, "comment_id": 93933221, "body": "Hi, the issue is resolved. I was making a silly mistake. Thanks all for your help."}], "owner": {"reputation": 1, "user_id": 10602882, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e25d61c4ec8d2153e7bd49795274e141?s=128&d=identicon&r=PG&f=1", "display_name": "AVC", "link": "https://stackoverflow.com/users/10602882/avc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1543393389, "answer_count": 0, "score": 0, "last_activity_date": 1582777697, "creation_date": 1543392870, "last_edit_date": 1582777697, "question_id": 53514890, "link": "https://stackoverflow.com/questions/53514890/run-a-macro-specific-to-sheet-a-from-any-sheet", "closed_reason": "Duplicate", "title": "Run a macro specific to sheet A from any sheet", "body": "<p>I have a macro in Sheet A. It is running fine when I'm in sheet A but when I'm trying to run it from sheet B, it throws an error. </p>\n\n<pre><code>Sub BP_Clear()\n    Dim Lastrow_Data1 As Long\n    Dim Lastrow_Pivot1 As Long\n\n    Lastrow_Data1 = Sheets(\"A\").Range(\"G20000\").End(xlUp).row\n    Lastrow_Pivot1 = Sheets(\"A\").Range(\"B20000\").End(xlUp).row\n    Application.ScreenUpdating = False\n\n    Range(\"G10\").Select\n    Selection.End(xlDown).Select\n    Range(Cells(10, 7), Cells(Lastrow_Pivot1 + 10000, 7)).ClearContents\n\n    Application.CutCopyMode = False     \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 7689378, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-KDKh8umwaEc/AAAAAAAAAAI/AAAAAAAAABQ/tAdy1Fvjt4E/photo.jpg?sz=128", "display_name": "Max Ng", "link": "https://stackoverflow.com/users/7689378/max-ng"}, "edited": false, "score": 0, "creation_date": 1543394897, "post_id": 53515099, "comment_id": 93899684, "body": "Great Thanks!! really appreciate it. I don&#39;t think of a solution like this until now~~ Thanks again!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 15, "user_id": 7689378, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-KDKh8umwaEc/AAAAAAAAAAI/AAAAAAAAABQ/tAdy1Fvjt4E/photo.jpg?sz=128", "display_name": "Max Ng", "link": "https://stackoverflow.com/users/7689378/max-ng"}, "edited": false, "score": 0, "creation_date": 1543395723, "post_id": 53515099, "comment_id": 93900144, "body": "you are welcome. if my answer solved your question you may want to mark it as accepted. thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1543393682, "creation_date": 1543393682, "answer_id": 53515099, "question_id": 53514719, "link": "https://stackoverflow.com/questions/53514719/use-whereclause-within-a-if-condition/53515099#53515099", "title": "use whereclause within a if condition", "body": "<p>you could use a helper function</p>\n\n<pre><code>Function OkParameter(par As String, locVar As String) As Boolean\n    OkParameter = IIf(par = \"\", True, par = locVar)\nEnd Function\n</code></pre>\n\n<p>to be included in your code as follows:</p>\n\n<pre><code>Private Function XX(A As String, B As String, C As String, D As String, E As String) As Long\n\n    Dim AA As String\n    Dim BB As String\n    Dim CC As String\n    Dim DD As String\n    Dim EE As String\n\n    If OkParameter(A, AA) And OkParameter(B, BB) And OkParameter(C, CC) And OkParameter(D, DD) And OkParameter(E, EE) Then\n\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 7689378, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh5.googleusercontent.com/-KDKh8umwaEc/AAAAAAAAAAI/AAAAAAAAABQ/tAdy1Fvjt4E/photo.jpg?sz=128", "display_name": "Max Ng", "link": "https://stackoverflow.com/users/7689378/max-ng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 53515099, "answer_count": 1, "score": 0, "last_activity_date": 1582500846, "creation_date": 1543392120, "last_edit_date": 1582500846, "question_id": 53514719, "link": "https://stackoverflow.com/questions/53514719/use-whereclause-within-a-if-condition", "title": "use whereclause within a if condition", "body": "<p>I have 5  string parameter A,B,C,D,E, and I want to use them as a condition in a IF statement. </p>\n\n<p>I also have 5 local variable, to match the parameters</p>\n\n<p>The problem is, I don't know whether any of them is empty string. If it is empty string , I don't want them to be use in the if condition</p>\n\n<pre><code>Private Function XX(A As String, B As String, C As String, D As String, E As String) As Long\n\nDim AA As String\nDim BB As String\nDim CC As String\nDim DD As String\nDim EE As String\n\nIf A = AA &amp;&amp; B = BB &amp;&amp; C = CC &amp; D = DD &amp; E = EE Then\n.....\nEnd If\n</code></pre>\n\n<p>I know a whereclause in sql can do it, like:</p>\n\n<pre><code>Dim Whereclause As String\nIF B is NULL Then\nwhereclause = \" WHERE AA = \" + A + \"AND C = \" + C + \"AND D = \" + \nD ....\n</code></pre>\n\n<p>But seems I can't put it into an IF statement, as the query itself is a string.</p>\n\n<p>Is there anyways to use in the IF condition? I don't need to connect DB, just want to check records in a excel sheet with the rows matching all the parameter</p>\n\n<p>Thanks very much for helping~~</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543393924, "post_id": 53514372, "comment_id": 93899134, "body": "Have a look here <a href=\"https://stackoverflow.com/questions/35439099/how-to-split-a-single-cell-into-multiple-rows-and-add-another-row\">How to Split a single cell into multiple rows and add another row</a>. The technique you will need is very similar. To split by the linebreaks use <code>vbLf</code> as delimiter in the <code>Split()</code> function."}], "answers": [{"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1543415791, "last_edit_date": 1543415791, "creation_date": 1543411322, "answer_id": 53520441, "question_id": 53514372, "link": "https://stackoverflow.com/questions/53514372/split-text-to-rown/53520441#53520441", "title": "Split text to rown", "body": "<p>Try this.</p>\n\n<pre><code>Sub Test()\n    Dim vDB, vS, vR(), vHead()\n    Dim Ws As Worksheet\n    Dim n As Long, i As Long, j As Integer\n    Dim r As Long, c As Integer, k As Integer\n    Dim a As Integer, cnt As Integer\n\n    Set Ws = ActiveSheet\n    Ws.Cells.Replace \".\", \"\"\n    Ws.Cells.Replace \",\", \"\"\n\n    vDB = Ws.UsedRange\n    r = UBound(vDB, 1)\n    c = UBound(vDB, 2)\n\n    '@@ get colum's number of data\n    For i = 1 To c\n        If vDB(2, i) &lt;&gt; \"\" Then\n            k = k + 1\n            ReDim Preserve vHead(1 To k)\n            vHead(k) = i\n        End If\n    Next i\n    n = 0\n    '@@ Cycle the cell to see if chr(10) (vbNewline) is included.\n    For i = 1 To r\n        If InStr(vDB(i, 1), Chr(10)) Then '~~&gt; if includ  chr(10)\n            vS = Split(vDB(i, 1), Chr(10))\n            cnt = UBound(vS)\n            For a = 0 To cnt\n                n = n + 1\n                ReDim Preserve vR(1 To c, 1 To n)\n                For j = 1 To k\n                    vS = Split(vDB(i, vHead(j)), Chr(10))\n                    If j = 1 Then\n                        vR(vHead(j), n) = Split(vS(a))(0)\n                    Else\n                        vR(vHead(j), n) = Val(Trim(vS(a)))\n                    End If\n                Next j\n            Next a\n        Else '~~&gt; if don't include  chr(10)\n            n = n + 1\n            ReDim Preserve vR(1 To c, 1 To n)\n            vR(1, n) = vDB(i, 1)\n        End If\n    Next i\n    Sheets.Add\n    Range(\"a1\").Resize(n, c) = WorksheetFunction.Transpose(vR)\n    Range(\"J:O\").NumberFormatLocal = \"#,###\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5083, "user_id": 2847689, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3e38b913ff0c83b7824342f2a1d3354d?s=128&d=identicon&r=PG", "display_name": "Carol.Kar", "link": "https://stackoverflow.com/users/2847689/carol-kar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1582779479, "creation_date": 1543390634, "last_edit_date": 1582779479, "question_id": 53514372, "link": "https://stackoverflow.com/questions/53514372/split-text-to-rown", "title": "Split text to rown", "body": "<p>I am using Excel 2010 and I am having the following data:\n<a href=\"https://i.stack.imgur.com/DA5Vb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DA5Vb.png\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see in one row there is multiple data. </p>\n\n<p>My data for product one looks in the cell like that:</p>\n\n<pre><code>Product                                       1.600,00\nOther                               1.600,00\nEH-Price                                 3.200,00\nPos.-Price                               3.200,00\n</code></pre>\n\n<p>I would like to split the data the following way:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Iu5ZG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Iu5ZG.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried to transpose the data and then separate it by \"space\" and then transpose it back, however this does not work well as there are multiple lines.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 0, "last_activity_date": 1543386510, "creation_date": 1543386510, "answer_id": 53513391, "question_id": 53513192, "link": "https://stackoverflow.com/questions/53513192/excel-vba-subscript-out-of-range/53513391#53513391", "title": "Excel VBA - Subscript out of range", "body": "<p>Arr3 is never \nThe error is caused because <code>Arr3</code> was never initialized as an array.  <code>Arr1(i)</code> will also throw an error because <code>Arr1</code> is a 2 dimensional array; use <code>Arr1(i, 1)</code> instead.</p>\n\n<pre><code>ReDim Arr3(LBound(Arr1) To UBound(Arr1))\nFor i = LBound(Arr1) To UBound(Arr1)\n    Arr3(i) = Arr1(i, 1) + Arr2(i, 1)\nNext\n</code></pre>\n\n<blockquote>\n<pre><code>Dim W1, W2, R1, R2, R3, R4, R5 As Double\n</code></pre>\n</blockquote>\n\n<p>In the declaration above <code>R5</code>'s datatype is Double the rest are Variants.</p>\n\n<p><a href=\"https://i.stack.imgur.com/bWcqm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bWcqm.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here are a few videos that will help: <a href=\"https://www.youtube.com//watch?v=DlqKfYTgc9Q&amp;index=3&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 3 - What to do When Things Go Wrong (Errors and Debugging)</a>, <a href=\"https://www.youtube.com//watch?v=y9hnnfjTxUA&amp;index=38&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 34 - Type Declarations (User-Defined Types)</a> and <a href=\"https://www.youtube.com//watch?v=h9FTX7TgkpM&amp;index=28&amp;list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction Part 25 - Arrays</a></p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1543386542, "creation_date": 1543386542, "answer_id": 53513405, "question_id": 53513192, "link": "https://stackoverflow.com/questions/53513192/excel-vba-subscript-out-of-range/53513405#53513405", "title": "Excel VBA - Subscript out of range", "body": "<ol>\n<li>Use explicit sheet name for Range references</li>\n<li>You create a 2D array when reading a range into an array so use Transpose if planning on looping as shown as will generate a 1D array off the single column ranges being passed in</li>\n<li>Declare and Redim Arr3 so enough space for all items</li>\n</ol>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\nPublic Sub TEST()\n    Dim Arr1(), Arr2(), Arr3(), i As Long, ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Arr1 = Application.Transpose(ws.Range(\"M15:M30\").Value)\n    Arr2 = Application.Transpose(ws.Range(\"N15:N30\").Value)\n    ReDim Arr3(1 To UBound(Arr1))\n    For i = LBound(Arr1) To UBound(Arr1)\n        Arr3(i) = Arr1(i) + Arr2(i)\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1543387351, "creation_date": 1543387351, "answer_id": 53513579, "question_id": 53513192, "link": "https://stackoverflow.com/questions/53513192/excel-vba-subscript-out-of-range/53513579#53513579", "title": "Excel VBA - Subscript out of range", "body": "<p>you could use a 2D array</p>\n\n<pre><code>Public Sub TEST()    \n    Dim Arr(), Arr3(), i As Long\n    With ThisWorkbook.Worksheets(\"Sheet1\").Range(\"M15:N30\") ' reference wanted range in wanted sheet and workbook\n            Arr = .Value ' store referenced range values in an array\n            ReDim Arr3(1 To UBound(Arr, 1))\n            For i = 1 To UBound(Arr, 1)\n                Arr3(i) = Arr(i, 1) + Arr(i, 2)\n            Next\n        .Offset(18).Resize(, 1).Value = Application.Transpose(Arr3) ' paste array values to referenced range offsetted 18 rows down and resize to one column\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10715294, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6O7tFWLLcG4/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jl-5uorAz9bv6DrERxrp2E1FyBcA/mo/photo.jpg?sz=128", "display_name": "Sundaram Kanagaraj", "link": "https://stackoverflow.com/users/10715294/sundaram-kanagaraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1543387351, "creation_date": 1543385550, "last_edit_date": 1543386398, "question_id": 53513192, "link": "https://stackoverflow.com/questions/53513192/excel-vba-subscript-out-of-range", "title": "Excel VBA - Subscript out of range", "body": "<p>I need help. The below code is written to add to column data and store in another column. When I execute the code it says subscript out of range in for loop where it adds to array values.</p>\n\n<p>Kindly give an advice.</p>\n\n<p>Thanks</p>\n\n<pre><code>Sub test()\n\n    Dim W1, W2, R1, R2, R3, R4, R5 As Double\n    Dim i, j, T As Integer\n    Dim myRange As Double\n    Dim Arr1 As Variant, Arr2 As Variant, Arr3 As Variant\n\n    myRange1 = Worksheets(\"Sheet2\").Range(\"M15\", \"M30\")\n    myRange2 = Worksheets(\"Sheet2\").Range(\"N15\", \"N30\")\n    R1 = WorksheetFunction.Sum(myRange1)\n    R2 = WorksheetFunction.Sum(myRange2)\n    R3 = (R1 + R2)\n    R4 = (R1 / R3) * 100\n    R5 = (R2 / R3) * 100\n    Range(\"M31\") = R4\n    Range(\"N31\") = R5\n    Arr1 = Range(\"M15:M30\").Value\n    Arr2 = Range(\"N15:N30\").Value\n\n    For i = LBound(Arr1) To UBound(Arr1)\n        Arr3(i) = Arr1(i) + Arr2(i)\n    Next\n\n    T = 16\n    For j = 1 To T\n        Range(\"M\" &amp; 33 + j).Cells = Arr3\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox", "userform"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1543384923, "post_id": 53512897, "comment_id": 93895209, "body": "show your code in Initialize sub"}, {"owner": {"reputation": 273, "user_id": 6345434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eb3e9ae50c6e0e4648728745d3539ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Juneja", "link": "https://stackoverflow.com/users/6345434/ishan-juneja"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1543468097, "post_id": 53512897, "comment_id": 93932273, "body": "@DisplayName I have updated the code"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1543476632, "post_id": 53512897, "comment_id": 93935323, "body": "You could use the Userform_Activate Event, Put your code there and see if it works."}, {"owner": {"reputation": 273, "user_id": 6345434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eb3e9ae50c6e0e4648728745d3539ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Juneja", "link": "https://stackoverflow.com/users/6345434/ishan-juneja"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1543484357, "post_id": 53512897, "comment_id": 93939367, "body": "@LucasRaphaelPianegonda Already tried, but still the same issue. I think it is a bug bcoz if I open the same template in some PC it would work perfectly. If anyone faced a similar issue with listbox it would be a great help"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1543486573, "post_id": 53512897, "comment_id": 93940735, "body": "@IshanJuneja can you show how this would look like? Is it always the first element which si selected or alwys the same few? Have all laptops the same version of excel?"}, {"owner": {"reputation": 273, "user_id": 6345434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eb3e9ae50c6e0e4648728745d3539ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Juneja", "link": "https://stackoverflow.com/users/6345434/ishan-juneja"}, "reply_to_user": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1543491316, "post_id": 53512897, "comment_id": 93943458, "body": "@LucasRaphaelPianegonda I wont be able to show the data. The selection is random and also on random useforms. The template has 3 userforms. One lappi is showing randomly first two entries selected for 1st useform while the other lappi as 1st and 4th entry selected for 3rd userform"}, {"owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "edited": false, "score": 0, "creation_date": 1543503722, "post_id": 53512897, "comment_id": 93950602, "body": "@IshanJuneja My suggestion is to find the source of the random selection and not to patch it with the suggested code. Go through your code and try to find all instances where you alter some selection in the userform. Then debug accordingly. I&#39;m sorry that I cannot give a better advice, if you can find the source of the selection then the solution might be already obviouse."}], "owner": {"reputation": 273, "user_id": 6345434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4eb3e9ae50c6e0e4648728745d3539ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ishan Juneja", "link": "https://stackoverflow.com/users/6345434/ishan-juneja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543960331, "creation_date": 1543384015, "last_edit_date": 1543960331, "question_id": 53512897, "link": "https://stackoverflow.com/questions/53512897/how-to-initialize-userform-listbox-where-there-sometimes-is-a-default-selected-v", "title": "How to initialize Userform Listbox where there sometimes is a default selected value", "body": "<p>I am using a VBA userform in an Excel template with a list box with multiple selections allowed from the list.</p>\n\n<p>In some cases when we open the \"userform\" some values are already selected by default.</p>\n\n<p>I have tried to deselect all values in initialize() sub but still the values are selected by default.</p>\n\n<p>Initialize() code</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    For i = 0 To ListBox1.ListCount - 1\n          ListBox1.Selected(i) = False\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543380162, "post_id": 53511958, "comment_id": 93893812, "body": "Try changing <code>AWorksheet.Range</code> to <code>ws.Range</code>"}, {"owner": {"reputation": 11, "user_id": 10713201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z6P9bB4oxek/AAAAAAAAAAI/AAAAAAAABGs/xSPuHpCD4pY/photo.jpg?sz=128", "display_name": "KENNIV", "link": "https://stackoverflow.com/users/10713201/kenniv"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543380597, "post_id": 53511958, "comment_id": 93893925, "body": "Update: I changed  to      Worksheets(1).Range(&quot;A1&quot;).Resize(Cells.Find(What:=&quot;<i>&quot;, SearchOrder:=xlRows, _       SearchDirection:=xlPrevious, LookIn:=xlValues).Row, _       Cells.Find(What:=&quot;</i>&quot;, SearchOrder:=xlByColumns, _       SearchDirection:=xlPrevious, LookIn:=xlValues).Column).Select   but it&#39;s selecting the Column and Row Counts from the MASTER on the active workbook. (MASTER Sheet1 has 101 Rows and 2 Columns but I need it to do that on the Opened active workbook."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543380641, "post_id": 53511958, "comment_id": 93893941, "body": "So, did it work?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543380787, "post_id": 53511958, "comment_id": 93893975, "body": "You do know that if your code does loop through the workbook list in column B, your paste will over write  each previous paste."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543381108, "post_id": 53511958, "comment_id": 93894064, "body": "Also, get rid of <code>Activate</code> and <code>Select</code>. e.g. <code>ThisWorkbook.WorkSheets(&quot;Sheet3&quot;).Range(&quot;A1&quot;).Paste</code>."}, {"owner": {"reputation": 11, "user_id": 10713201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z6P9bB4oxek/AAAAAAAAAAI/AAAAAAAABGs/xSPuHpCD4pY/photo.jpg?sz=128", "display_name": "KENNIV", "link": "https://stackoverflow.com/users/10713201/kenniv"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543381147, "post_id": 53511958, "comment_id": 93894074, "body": "@GMalc thanks. Why change AWorkbook.Range to ws.Range? I&#39;m relatively new to VBA and yes I&#39;m aware it will paste over top of it&#39;s self in it&#39;s current state."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543381714, "post_id": 53511958, "comment_id": 93894229, "body": "Sorry you need to change it to <code>wb.Sheets(&quot;Sheet1&quot;).Range</code>. When you set Set <code>wb = Workbooks.Open(sFile)</code>, you set the workbook variable <code>ws</code> to the workbook file you opened. You don&#39;t need to reset it to <code>AWorkbook</code>. Also, you don&#39;t need to set the variable for <code>wkbSource</code> because <code>ThisWorkbook</code> is the workbook where you have the vba code."}, {"owner": {"reputation": 11, "user_id": 10713201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z6P9bB4oxek/AAAAAAAAAAI/AAAAAAAABGs/xSPuHpCD4pY/photo.jpg?sz=128", "display_name": "KENNIV", "link": "https://stackoverflow.com/users/10713201/kenniv"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1543382942, "post_id": 53511958, "comment_id": 93894560, "body": "@GMalc my current problem is that I&#39;m Counting the range calculated from &quot;ThisWorkbook&quot; and Selecting that Range Criteria on the AWorkbook. If i use wb.sheets(&quot;Sheet1&quot;).Range I get an error because I don&#39;t have the Sheet Name correct.. (The sheet name Changes with the Workbook)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543383332, "post_id": 53511958, "comment_id": 93894651, "body": "This will error out if any range.find instances don\u2019t find the value"}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1543386644, "creation_date": 1543386644, "answer_id": 53513430, "question_id": 53511958, "link": "https://stackoverflow.com/questions/53511958/select-specified-range-on-varying-sheet-names-from-another-workbook/53513430#53513430", "title": "Select Specified Range on Varying Sheet Names from another Workbook", "body": "<p>you could substitute your code from:</p>\n\n<pre><code>Set wb = Workbooks.Open(sFile)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Sheets(\"Sheet1\").Select\n</code></pre>\n\n<p>with the following (explanations in comments):</p>\n\n<pre><code>With Workbooks.Open(sFile) ' open and referecne your current workbook\n    With .Worksheets(Split(.Name, \".\")(0)) ' reference referenced workbook sheet named after it\n        .Range(\"A1\").Resize(.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n                                        SearchDirection:=xlPrevious, LookIn:=xlValues).Row, _\n                            .Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, _\n                                        SearchDirection:=xlPrevious, LookIn:=xlValues).Column) _\n                    .Copy Destination:=Workbooks(\"MASTER.xlsm\").Worksheets(\"Sheet3\").Range(\"A1\") ' copy and paste in one shot\n    End With\n\n    Application.EnableEvents = False\n    .Close savechanges:=False 'Will NOT save changes\n    Application.EnableEvents = True\n\n    '''FUTURE CODE\n\nEnd With\n\n''GO TO NEXT FILE\nSourceRow = SourceRow + 1 ' Move down 1 row for source sheet\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10713201, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z6P9bB4oxek/AAAAAAAAAAI/AAAAAAAABGs/xSPuHpCD4pY/photo.jpg?sz=128", "display_name": "KENNIV", "link": "https://stackoverflow.com/users/10713201/kenniv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 206, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582779501, "creation_date": 1543377915, "last_edit_date": 1582779501, "question_id": 53511958, "link": "https://stackoverflow.com/questions/53511958/select-specified-range-on-varying-sheet-names-from-another-workbook", "title": "Select Specified Range on Varying Sheet Names from another Workbook", "body": "<p>I've got a myself into a situation,\nI realize I'm new here and I hope I don't make too many mistakes.</p>\n\n<p>I have Workbooks with different names in a folder. I have my VBA list the paths of the .csv files. </p>\n\n<p>Each Workbook has a unique name, identical to the sheet within.</p>\n\n<p>Next I want to loop through the workbooks combining to a MASTER.xlsm</p>\n\n<p>The data is from a OBDII Car App so the Rows Count is always unknown.</p>\n\n<pre><code>Range(\"A1\").Resize(Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n  SearchDirection:=xlPrevious, LookIn:=xlValues).Row, _\n  Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, _\n  SearchDirection:=xlPrevious, LookIn:=xlValues).Column).Select\n</code></pre>\n\n<p>This code above, worked when I used it in one of the varying Workbooks manually. But I'm getting a </p>\n\n<blockquote>\n  <p>Run-Time error 1004 Application or Object Defined Error</p>\n</blockquote>\n\n<p>when I try and implement it from the MasterWorkbook.</p>\n\n<pre><code>Private Sub cmd_COPYpaste()\n\nApplication.ScreenUpdating = False\nApplication.CutCopyMode = False\nApplication.Calculation = xlCalculationManual\n\n''''DIMMENSIONS\n\nDim SourceRow As Long\nDim EditRow As Long\nDim sFile As String\nDim wb As Workbook\nDim FileName1 As String\nDim wksSource As Worksheet\nConst scWkbSourceName As String = \"MASTER.xlsm\"\n\nSet wkbSource = Workbooks(scWkbSourceName)\nSet wksSource = wkbSource.Sheets(\"Sheet1\") ' Replace Sheet1 with the sheet name\n\nConst wsOriginalBook As String = \"MASTER.xlsm\"\n\nSourceRow = 2\n\n''ENSURE SELECT SOURCE SHEET\nSheets(\"Sheet1\").Select\n\nDo While Cells(SourceRow, \"B\").Value &lt;&gt; \"\"\n\nFileName1 = wksSource.Range(\"B\" &amp; SourceRow).Value\n\nsFile = FileName1\n\nSet wb = Workbooks.Open(sFile)\n\n''CREATE TABLE1 ON AWORKBOOK\n\nDim AWorkbook As Workbook\nSet AWorkbook = ActiveWorkbook\n\n''CREATE a REFERENCE-ABLE Sheet\nDim AWorksheet As Worksheet\nSet AWorksheet = AWorkbook.ActiveSheet\n\n''SELECT DATA RANGE\n</code></pre>\n\n<p>next line is my Error</p>\n\n<pre><code>AWorksheet.Range(\"A1\").Resize(Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n  SearchDirection:=xlPrevious, LookIn:=xlValues).Row, _\n  Cells.Find(What:=\"*\", SearchOrder:=xlByColumns, _\n  SearchDirection:=xlPrevious, LookIn:=xlValues).Column).Select\n\nSelection.Copy\n\nWindows(\"MASTER.xlsm\").Activate\nSheets(\"Sheet3\").Select                 'IMPORT TO SHEET\nActiveSheet.Range(\"A1\").Select\nActiveSheet.Paste\n\n''CLOSE WORKBOOK W/O BEFORE SAVE\nAWorkbook.Activate\nApplication.EnableEvents = False\nActiveWorkbook.Close savechanges:=False 'Will NOT save changes\nApplication.EnableEvents = True\n\nWindows(\"MASTER.xlsm\").Activate\nSheets(\"Sheet1\").Select\n\n'''FUTURE CODE\n\n''GO TO NEXT FILE\nSourceRow = SourceRow + 1 ' Move down 1 row for source sheet\n\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>I plan on finishing the code in the future but for now I want it is to copy &amp; paste to A1 on Sheet3 over and over.</p>\n\n<p>I am stuck thinking I messed something up with the  </p>\n\n<pre><code>''Need to CREATE a REFERENCE-ABLE Sheet\nDim AWorksheet As Worksheet\nSet AWorksheet = AWorkbook.ActiveSheet\n</code></pre>\n\n<p>How Can I get around not knowing the sheet name and still have full control over the sheet from another Workbook?</p>\n\n<p>I thought I specified AWorkbook's Active Sheet</p>\n\n<p>Column A on Master Workbook Sheet 1 has the filename and filename1 is the Full Path in Column B.</p>\n\n<p>I appreciate you sticking in with me and I'd love to hear your thoughts and simplifications (props to everyone who has gotten me this far)?</p>\n"}, {"tags": ["excel", "vba", "hide", "rows"], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1543381433, "post_id": 53512022, "comment_id": 93894157, "body": "you are using implicit sheet references throughout and are you sure UsedRange is returning the right range? Only a personal opinion but I find If statement cleaner."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1543383774, "post_id": 53512022, "comment_id": 93894789, "body": "@QHarr good call. It should ref activesheet. I&#39;ll clean it up."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1543384324, "post_id": 53512022, "comment_id": 93895005, "body": "Better still tell them to used explicit sheet names if possible"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1543386563, "post_id": 53512022, "comment_id": 93895835, "body": "@TinMan I didn&#39;t qualify the table at the sheet level for that very reason. Your usedRange interect code is slightly off, but I&#39;ll use it. Give you a tick at it&#39;s a good concept."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1543387730, "post_id": 53512022, "comment_id": 93896325, "body": "Oh jeez, next thing I know you\u2019re going to say that the federal department of redundancy department isn\u2019t needed!  I gotta shut down. You\u2019re probably right \ud83d\ude42"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 1, "creation_date": 1543389199, "post_id": 53512022, "comment_id": 93896967, "body": "FDRD department. That&#39;s Good stuff :-)"}, {"owner": {"reputation": 1, "user_id": 10714770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675f0703a0f923249d8e64003a8b3ca2?s=128&d=identicon&r=PG&f=1", "display_name": "perthling", "link": "https://stackoverflow.com/users/10714770/perthling"}, "edited": false, "score": 0, "creation_date": 1543454174, "post_id": 53512022, "comment_id": 93929351, "body": "@PGCodeRider, I like this alternate solution. Definitely a few new things for me to read up on (IsEmpty, Offset, Union, Intersect). One part of my original question however... is there a way to take a Range and embed it into a string?"}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 2, "last_activity_date": 1543444801, "last_edit_date": 1543444801, "creation_date": 1543378412, "answer_id": 53512022, "question_id": 53511825, "link": "https://stackoverflow.com/questions/53511825/hide-table-rows-unless-any-of-3-columns-in-that-row-are-not-blank/53512022#53512022", "title": "Hide table rows *unless* any of 3 columns (in that row) are not blank", "body": "<p>There's no specific question/problem, but here's my suggested code improvements. </p>\n\n<ul>\n<li>Most notably, I wouldn't execute the <code>Hidden</code> procedure until you have all the rows. That way you don't have repeatedly do something that only need be completed once. This will always be the best practice when looping and manipulating data. <em>Make changes to the sheet AFTER you have identified the range.</em></li>\n<li>With the above change, you don't need to turn off <code>ScreenUpdating</code>. </li>\n<li>The <code>Evaluate</code> function is fine, but <code>isEmpty</code> is probably the best option. There are probably slightly faster methods, perhaps checking multiple if-statements, but that's getting into fractions of a second over thousands of rows (probably not worth researching).</li>\n<li>Technically you don't really need to loop by <code>rows</code>. You can get by with a single cell in a row, then checking the next two over, see utilization of <code>Offset</code> to generate that range. This also creates a more dynamic than using hard-coded columns (\"A\"/\"B\"...etc\")</li>\n<li><code>Long</code> is recommended over <code>Integer</code> but this is pretty small, and I'm only mentioning it <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long/51689021#51689021\">because I posted about it here.</a>. Technically you don't even need it with the above changes.</li>\n</ul>\n\n<p>Here's the code:</p>\n\n<pre><code>Sub HideTableRows()\n    Dim c As Range, hIdeRNG As Range, WS As Worksheet\n\n    'based on OP xlsm file.\n    Set WS = Sheet4\n\n\n    'used range outside of used range to avoid an if-statement on every row\n    Set hIdeRNG = WS.Cells(Rows.Count, 1)\n\n    'loops through range of single cells for faster speed\n    For Each c In Range(\"ForecastTable[Group]\").Cells\n\n        If IsEmpty(Range(c, c.Offset(0, 2))) = 0 Then\n            'only need a single member in the row.\n            Set hIdeRNG = Union(hIdeRNG, c)\n        End If\n\n    Next c\n\n    'Hides rows only if found more than 1 cell in loop\n    If hIdeRNG.Cells.Count &gt; 1 Then\n        Intersect(WS.UsedRange, hIdeRNG).EntireRow.Hidden = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p><strong>Final Thought:</strong> There's some major enhancements coming out to Excel supposedly in early 2019 that might be useful for this type of situation if you were looking for a non-VBA solution. <a href=\"https://www.excelcampus.com/functions/dynamic-array-formulas-spill-ranges/\" rel=\"nofollow noreferrer\">Click here for more info from MS.</a></p>\n"}, {"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1543382792, "last_edit_date": 1543382792, "creation_date": 1543382485, "answer_id": 53512628, "question_id": 53511825, "link": "https://stackoverflow.com/questions/53511825/hide-table-rows-unless-any-of-3-columns-in-that-row-are-not-blank/53512628#53512628", "title": "Hide table rows *unless* any of 3 columns (in that row) are not blank", "body": "<p>Flipping the logic a bit, why not just filter those three columns for blanks, then hide all the visible filtered blank rows in one go?</p>\n\n<p>Something like this:</p>\n\n<pre><code>Sub DoTheHide()\n\n    Dim myTable As ListObject\n    Set myTable = Sheet4.ListObjects(\"ForecastTable\")\n    With myTable.Range\n        .AutoFilter Field:=1, Criteria1:=\"=\"\n        .AutoFilter Field:=2, Criteria1:=\"=\"\n        .AutoFilter Field:=3, Criteria1:=\"=\"\n    End With\n\n    Dim rowsToHide As Range\n    On Error Resume Next\n        Set rowsToHide = myTable.DataBodyRange.SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    myTable.AutoFilter.ShowAllData\n\n    If Not rowsToHide Is Nothing Then\n        rowsToHide.EntireRow.Hidden = True\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 1, "last_activity_date": 1543384313, "creation_date": 1543384313, "answer_id": 53512979, "question_id": 53511825, "link": "https://stackoverflow.com/questions/53511825/hide-table-rows-unless-any-of-3-columns-in-that-row-are-not-blank/53512979#53512979", "title": "Hide table rows *unless* any of 3 columns (in that row) are not blank", "body": "<p>Since c is used to iterate over the rows and each row contains the 3 cells in question <code>(\"=COUNTA(B\" &amp; r &amp; \":D\" &amp; r &amp; \") = 0\")</code> is equivalent to <code>(\"=COUNTA(\" &amp; c.Address &amp; \") = 0\")</code>. But using the WorksheetFunction directly is a better appraoch.</p>\n\n<p>It should be noted that <code>Range(\"[Table]\") will return the proper result as long as the table is in the ActiveWorkbook.  It would be better to use</code>ThisWorkbook.Worksheets(\"Sheet1\").Range(\"[Table]\")`.</p>\n\n<pre><code>Sub HideTableRows()\n\n    Application.ScreenUpdating = False\n\n    Dim row As Range, target As Range\n\n    With Range(\"ForecastTable[[Group]:[Item]]\")\n        .EntireRow.Hidden = False\n        For Each row In .rows\n            If Application.WorksheetFunction.CountA(row) = 0 Then\n                If target Is Nothing Then\n                    Set target = row\n                Else\n                    Set target = Union(target, row)\n                End If\n            End If\n        Next\n    End With\n\n    If Not target Is Nothing Then target.EntireRow.Hidden = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10714770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675f0703a0f923249d8e64003a8b3ca2?s=128&d=identicon&r=PG&f=1", "display_name": "perthling", "link": "https://stackoverflow.com/users/10714770/perthling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1543444801, "creation_date": 1543376913, "last_edit_date": 1543391570, "question_id": 53511825, "link": "https://stackoverflow.com/questions/53511825/hide-table-rows-unless-any-of-3-columns-in-that-row-are-not-blank", "title": "Hide table rows *unless* any of 3 columns (in that row) are not blank", "body": "<p>I've built this code, and it's working fine. However I expect there must be a more elegant way to embed the range 'c' into the Evaluate function rather than how I've used 'r' to determine the row number, and build that into the reference.</p>\n\n<p>(I'm learning). Copy of (very stripped down) xlsm available here: <a href=\"https://www.dropbox.com/s/e6pcugqs4zizfgn/2018-11-28%20-%20Hide%20table%20rows.xlsm?dl=0\" rel=\"nofollow noreferrer\">https://www.dropbox.com/s/e6pcugqs4zizfgn/2018-11-28%20-%20Hide%20table%20rows.xlsm?dl=0</a></p>\n\n<pre><code>Sub HideTableRows()\n\nApplication.ScreenUpdating = False\n\nDim c As Range\nDim r As Integer\n\nFor Each c In Range(\"ForecastTable[[Group]:[Item]]\").Rows\n    r = c.Row\n    If Application.Evaluate(\"=COUNTA(B\" &amp; r &amp; \":D\" &amp; r &amp; \") = 0\") = True Then\n        c.EntireRow.Hidden = True\n    Else: c.EntireRow.Hidden = False\n    End If\nNext c\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3548, "user_id": 7742981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3ec6d8d493c843316a3435ce02b5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Simon.S.A.", "link": "https://stackoverflow.com/users/7742981/simon-s-a"}, "edited": false, "score": 1, "creation_date": 1543377908, "post_id": 53511740, "comment_id": 93893281, "body": "Welcome to stackoverflow. Please share code the demonstrate what you have already attempted. It is difficult for users to provide solutions without all the context."}, {"owner": {"reputation": 1, "user_id": 9367236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Scb2dwUSI3M/AAAAAAAAAAI/AAAAAAAAABs/qXC7S9Fzi90/photo.jpg?sz=128", "display_name": "Carissa", "link": "https://stackoverflow.com/users/9367236/carissa"}, "reply_to_user": {"reputation": 3548, "user_id": 7742981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3ec6d8d493c843316a3435ce02b5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Simon.S.A.", "link": "https://stackoverflow.com/users/7742981/simon-s-a"}, "edited": false, "score": 0, "creation_date": 1543404993, "post_id": 53511740, "comment_id": 93905665, "body": "I have an excel worksheet with a Master Tab and a Template Tab.  I want to create automatic tabs from the master list the the template tab created.  I am looking for a macro please.  Tab Name A1, hyperlink A1.  I also want A1-Z"}, {"owner": {"reputation": 1, "user_id": 9367236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Scb2dwUSI3M/AAAAAAAAAAI/AAAAAAAAABs/qXC7S9Fzi90/photo.jpg?sz=128", "display_name": "Carissa", "link": "https://stackoverflow.com/users/9367236/carissa"}, "reply_to_user": {"reputation": 3548, "user_id": 7742981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3ec6d8d493c843316a3435ce02b5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Simon.S.A.", "link": "https://stackoverflow.com/users/7742981/simon-s-a"}, "edited": false, "score": 0, "creation_date": 1543405044, "post_id": 53511740, "comment_id": 93905694, "body": "sorry.  I also want A1-O1 to be copied to the new tab."}, {"owner": {"reputation": 1, "user_id": 9367236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Scb2dwUSI3M/AAAAAAAAAAI/AAAAAAAAABs/qXC7S9Fzi90/photo.jpg?sz=128", "display_name": "Carissa", "link": "https://stackoverflow.com/users/9367236/carissa"}, "reply_to_user": {"reputation": 3548, "user_id": 7742981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3ec6d8d493c843316a3435ce02b5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Simon.S.A.", "link": "https://stackoverflow.com/users/7742981/simon-s-a"}, "edited": false, "score": 0, "creation_date": 1543405121, "post_id": 53511740, "comment_id": 93905736, "body": "This is the macro I started with"}, {"owner": {"reputation": 1, "user_id": 9367236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Scb2dwUSI3M/AAAAAAAAAAI/AAAAAAAAABs/qXC7S9Fzi90/photo.jpg?sz=128", "display_name": "Carissa", "link": "https://stackoverflow.com/users/9367236/carissa"}, "reply_to_user": {"reputation": 3548, "user_id": 7742981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3ec6d8d493c843316a3435ce02b5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Simon.S.A.", "link": "https://stackoverflow.com/users/7742981/simon-s-a"}, "edited": false, "score": 0, "creation_date": 1543405129, "post_id": 53511740, "comment_id": 93905740, "body": "Sub CreateAndNameWorksheets()     Dim c As Range      Application.ScreenUpdating = False     For Each c In Sheets(&quot;Master&quot;).Range(&quot;A1:A50&quot;)         Sheets(&quot;Template&quot;).Copy After:=Sheets(Sheets.Count)         With c             ActiveSheet.Name = .Value             .Parent.Hyperlinks.Add Anchor:=c, Address:=&quot;&quot;, SubAddress:= _                 &quot;&#39;&quot; &amp; .Text &amp; &quot;&#39;!A1&quot;, TextToDisplay:=.Text         End With     Next c     Application.ScreenUpdating = True  End Sub"}], "owner": {"reputation": 1, "user_id": 9367236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Scb2dwUSI3M/AAAAAAAAAAI/AAAAAAAAABs/qXC7S9Fzi90/photo.jpg?sz=128", "display_name": "Carissa", "link": "https://stackoverflow.com/users/9367236/carissa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1543452138, "creation_date": 1543376264, "last_edit_date": 1543429640, "question_id": 53511740, "link": "https://stackoverflow.com/questions/53511740/excel-vba-master-list", "title": "Excel VBA - Master List", "body": "<p>Need Excel VBA help.  </p>\n\n<p>have an excel worksheet with a Master Tab and a Template Tab. I want to create automatic tabs from the master list the the template tab created. I am looking for a macro please. Tab Name A1, hyperlink A1. I also want A1-O1 to be copied to the new tab. </p>\n\n<p>This is the macro I started with :</p>\n\n<pre><code>Sub CreateAndNameWorksheets()\n\n    Dim c As Range\n    Application.ScreenUpdating = False\n    For Each c In Sheets(\"Master\").Range(\"A1:A50\")\n        Sheets(\"Template\").Copy After:=Sheets(Sheets.Count)\n        With c\n            ActiveSheet.Name = .Value\n            .Parent.Hyperlinks.Add Anchor:=c, Address:=\"\", SubAddress:= _\n                    \"'\" &amp; .Text &amp; \"'!A1\", TextToDisplay:=.Text\n        End With\n    Next c\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 10397331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bb2408a82489edfd20a25213746d98?s=128&d=identicon&r=PG&f=1", "display_name": "caspian", "link": "https://stackoverflow.com/users/10397331/caspian"}, "edited": false, "score": 0, "creation_date": 1543453160, "post_id": 53514402, "comment_id": 93929136, "body": "I added the code that you wrote and changed the offsets and range. But I am getting Run Time error &#39;91&#39; - Object variable or with block variable not set. I am not sure what the error is. I feel like it is a minor error but not sure where it is coming from. It is pointing to CatToColor line."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 43, "user_id": 10397331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bb2408a82489edfd20a25213746d98?s=128&d=identicon&r=PG&f=1", "display_name": "caspian", "link": "https://stackoverflow.com/users/10397331/caspian"}, "edited": false, "score": 0, "creation_date": 1543517707, "post_id": 53514402, "comment_id": 93958142, "body": "Exactly which line?  Do you have a <code>Sheet1</code> in your workbook.  Maybe change that to <code>ThisWorkbook.Worksheets(&quot;Sheet1&quot;)</code> or whatever is the correct sheet name."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1543390758, "creation_date": 1543390758, "answer_id": 53514402, "question_id": 53511669, "link": "https://stackoverflow.com/questions/53511669/color-coding-stacked-bar-chart-using-keys/53514402#53514402", "title": "Color coding stacked bar chart using keys", "body": "<p>Example:</p>\n\n<pre><code>Sub ColorByCategory()\n\n    Dim cht As Chart, s As Long, p As Long, cat\n\n    Set cht = ActiveSheet.ChartObjects(1).Chart 'for example\n\n    'here a series corresponds to a row of data...\n    For s = 1 To cht.SeriesCollection.Count\n        With cht.SeriesCollection(s)\n            '...and points are grouped by data column\n            For p = 1 To .Points.Count\n                'find the category from the series and point numbers\n                cat = Range(\"c4\").Offset(s, (p - 1) * 2).Value\n                .Points(p).Format.Fill.ForeColor.RGB = CatToColor(cat)\n            Next p\n        End With\n    Next s\n\nEnd Sub\n\n'Map a category to a fill color using a lookup range\nFunction CatToColor(cat) As Long\n    CatToColor = Sheet1.Range(\"A1:A5\").Find(cat).Interior.Color\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/S47EF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S47EF.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 43, "user_id": 10397331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57bb2408a82489edfd20a25213746d98?s=128&d=identicon&r=PG&f=1", "display_name": "caspian", "link": "https://stackoverflow.com/users/10397331/caspian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 53514402, "answer_count": 1, "score": 1, "last_activity_date": 1557130946, "creation_date": 1543375693, "last_edit_date": 1557130946, "question_id": 53511669, "link": "https://stackoverflow.com/questions/53511669/color-coding-stacked-bar-chart-using-keys", "title": "Color coding stacked bar chart using keys", "body": "<p>We want to create a stacked bar chart using keys to format the color of each field. </p>\n\n<p><a href=\"https://i.stack.imgur.com/WgYp8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WgYp8.png\" alt=\"enter image description here\"></a></p>\n\n<p>On the left, we have the keys and on the right, we have the length of each bar segment. Here is what we have right now.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IOcyx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IOcyx.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem is that excel is not color coding the chart using keys assigned to it. Instead, it is just color coding them by row. </p>\n\n<p>For example:<br>\nWe need it to color code all administrative as red, introduction as yellow and so on. But in the current situation, excel is marking the first row as blue, second as yellow and so on.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1543374545, "post_id": 53511476, "comment_id": 93892482, "body": "<code>Exit</code> is a reserved word, you can&#39;t use it as a Label. But as already mentioned, this could use some rework. You&#39;re missing a couple instances of <code>End If</code>."}, {"owner": {"reputation": 1, "user_id": 10714442, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--Z_hPfnVIJM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jVCVwlEIh3i49Et9rOU5a9CfRoFg/mo/photo.jpg?sz=128", "display_name": "Night Fury", "link": "https://stackoverflow.com/users/10714442/night-fury"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543374601, "post_id": 53511476, "comment_id": 93892493, "body": "@urdearboy can you please suggest an alternate method-if i remove goto start what should i exchange it with ? i am new to vba and programming,kindly bear with me. Thankyou !"}, {"owner": {"reputation": 1, "user_id": 10714442, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--Z_hPfnVIJM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jVCVwlEIh3i49Et9rOU5a9CfRoFg/mo/photo.jpg?sz=128", "display_name": "Night Fury", "link": "https://stackoverflow.com/users/10714442/night-fury"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543374807, "post_id": 53511476, "comment_id": 93892539, "body": "@BigBen Thanks a lot. The issue seems to have been fixed once i changed my label :) Have a great day"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1543374888, "post_id": 53511476, "comment_id": 93892555, "body": "Now that your code works, feel free to post it on <a href=\"https://codereview.stackexchange.com\">Code Review</a> to get tips on restructuring the control flow, and avoiding <code>GoTo</code> jumps."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 1, "user_id": 10714442, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--Z_hPfnVIJM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jVCVwlEIh3i49Et9rOU5a9CfRoFg/mo/photo.jpg?sz=128", "display_name": "Night Fury", "link": "https://stackoverflow.com/users/10714442/night-fury"}, "edited": false, "score": 1, "creation_date": 1543375261, "post_id": 53511525, "comment_id": 93892640, "body": "@NightFury we take our thank you here&#39;s by way of accepting solutions that solved your problem ;)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1543374583, "creation_date": 1543374583, "answer_id": 53511525, "question_id": 53511476, "link": "https://stackoverflow.com/questions/53511476/i-am-getting-a-syntax-error-can-you-please-check-my-code/53511525#53511525", "title": "I am getting a syntax error can you please check my code?", "body": "<p><code>Exit</code> is a reserved keyword, illegal for an identifier.</p>\n\n<blockquote>\n<pre><code>Exit:\nEnd Sub\n</code></pre>\n</blockquote>\n\n<p>That <code>Exit</code> label needs to be renamed.</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1543375856, "post_id": 53511610, "comment_id": 93892781, "body": "Aaaah, this is what I hate about upvoting too early.... can&#39;t upvote again post-edit!"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 3, "last_activity_date": 1543375647, "last_edit_date": 1543375647, "creation_date": 1543375227, "answer_id": 53511610, "question_id": 53511476, "link": "https://stackoverflow.com/questions/53511476/i-am-getting-a-syntax-error-can-you-please-check-my-code/53511610#53511610", "title": "I am getting a syntax error can you please check my code?", "body": "<p>This is how I would go about re-structering your code. Notice that the code is not jumping from here to there due to instances of <code>GoTo</code>. Now, you can follow the logic from start to end without skipping a line. This goes a long way with readability which helps with debugging, modifying in future, and writing your script in the first place.  </p>\n\n<p>You can add a <code>Do Loop</code> if you would like to present the option to keep trying at names until they happen to enter one of your action names. You should look up that method, and if you decide to implement and have any issues,  post a new question with your code and problem!</p>\n\n<p>Here are a few random links on that topic that should help to get you started. <a href=\"https://stackoverflow.com/questions/18149375/inputbox-do-until-two-letters-are-entered\">Here</a>, or <a href=\"https://www.thespreadsheetguru.com/the-code-vault/2015/3/26/loop-input-box-until-receives-correct-valid-entry\" rel=\"nofollow noreferrer\">here</a></p>\n\n<hr>\n\n<pre><code>Sub Test()\n\nDim ws As Worksheet: Set ws = ThisWorkbook.Sheets(\"Sheet1\") '&lt;-- Update sheet name\nDim mm As String, Person As Range, Amount As Range\n\nSet Person = ws.Range(\"B6:B148\")\nSet Amount = ws.Range(\"C6:C148\")\n\nmm = InputBox(\"Enter the name of the sales person\")\n\nSelect Case mm\n    Case \"Jack\", \"Heather\", \"Jeff\", \"Mike\", \"Marty\", \"Peter\", \"Jack\", \"Lisa\"\n        ws.Range(\"H13\") = mm\n        ws.Range(\"H14\") = Application.WorksheetFunction.SumIfs(Amount, Person, mm)\n        ws.Range(\"H15\") = Application.WorksheetFunction.AverageIfs(Amount, Person, mm)\n        ws.Range(\"H16\") = Application.WorksheetFunction.Minifs(Amount, Person, mm)\n        ws.Range(\"H17\") = Application.WorksheetFunction.Maxifs(Amount, Person, mm)\n    Case Else\n        MsgBox \"Invalid Entry. Please re-run macro to try again\"\n\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10714442, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--Z_hPfnVIJM/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jVCVwlEIh3i49Et9rOU5a9CfRoFg/mo/photo.jpg?sz=128", "display_name": "Night Fury", "link": "https://stackoverflow.com/users/10714442/night-fury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543375647, "creation_date": 1543374174, "question_id": 53511476, "link": "https://stackoverflow.com/questions/53511476/i-am-getting-a-syntax-error-can-you-please-check-my-code", "title": "I am getting a syntax error can you please check my code?", "body": "<p>Kindly check the code, I think the mistake lies in exiting the error loop.</p>\n\n<pre><code>Option Explicit\nDim mm\nDim person As Range\nDim amount As Range\nDim ans\n\nSub Macro1()\n\nagain:\nmm = InputBox(\"Enter the name of the sales person\")\nIf mm = \"Jack\" Then\n    GoTo Start\nElseIf mm = \"Heather\" Then\n    GoTo Start\nElseIf mm = \"Jeff\" Then\n    GoTo Start\nElseIf mm = \"Stephanie\" Then\n    GoTo Start\nElseIf mm = \"Mike\" Then\n    GoTo Start\nElseIf mm = \"Marty\" Then\n    GoTo Start\nElseIf mm = \"Peter\" Then\n    GoTo Start\nElseIf mm = \"Jack\" Then\n    GoTo Start\nElseIf mm = \"Lisa\" Then\n    GoTo Start\nElse\nGoTo Error\nError:\nMsgBox (\"Error: invalid name,no match found\")\nans = MsgBox(\"Do you want to try again?\", vbYesNo)\nIf ans = 8 Then\nGoTo again\nElseIf ans = 7 Then\nGoTo Exit\n\nStart:\n    Set person = Range(Cells(6, 2), Cells(148, 2))\n    Set amount = Range(Cells(6, 3), Cells(148, 3))\n    Cells(13, 8) = mm\n    Cells(14, 8) = WorksheetFunction.SumIfs(amount, person, mm)\n    Cells(15, 8) = WorksheetFunction.AverageIfs(amount, person, mm)\n    Cells(16, 8) = WorksheetFunction.MinIfs(amount, person, mm)\n    Cells(17, 8) = WorksheetFunction.MaxIfs(amount, person, mm)\n    ans = MsgBox(\"Do you want to try again?\", vbYesNo)\nIf ans = 8 Then GoTo again\n    End If\nExit:\nEnd Sub\n</code></pre>\n\n<p>For some weird reason excel is not allowing me to enter Exit: it shows compile error, but i do not know why </p>\n\n<p>Thank you so much for helping</p>\n"}, {"tags": ["vba", "count", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1543373108, "creation_date": 1543373108, "answer_id": 53511346, "question_id": 53511306, "link": "https://stackoverflow.com/questions/53511306/count-the-number-of-vba-recipients-in-the-to-field/53511346#53511346", "title": "Count the number of VBA recipients in the TO field", "body": "<p>You can also read the To property and count the number of \";\" characters, but it is locale specific. What you have is the preferable way; is there a problem with it?</p>\n"}], "owner": {"reputation": 151, "user_id": 9622165, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Barok", "link": "https://stackoverflow.com/users/9622165/barok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543373108, "creation_date": 1543372815, "question_id": 53511306, "link": "https://stackoverflow.com/questions/53511306/count-the-number-of-vba-recipients-in-the-to-field", "title": "Count the number of VBA recipients in the TO field", "body": "<p>Is there a faster method to count the number of VBA recipients in the TO field?</p>\n\n<p>Please refer to the following pseudo code.</p>\n\n<pre><code>Dim myRecipients as Outlook.recipients\nDim Recip as Outlook.recipient\n\nDim olToCount as Long\n    olToCount = 0\nFor Each Recip In myRecipients\n    If Recip.Type = olTo Then\n        olToCount = olToCount + 1\n    End if\nNext\n</code></pre>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 10505498, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160892956530133/picture?type=large", "display_name": "Marko Manenica", "link": "https://stackoverflow.com/users/10505498/marko-manenica"}, "edited": false, "score": 0, "creation_date": 1543372656, "post_id": 53511217, "comment_id": 93892132, "body": "I tried that but because the current active task is below the first task the Tasks(1) is starting from that current active task.  I read that you need UniqueID to return a specific ID (that is not baselined from the current active task).  Or am I missing something?"}], "tags": [], "owner": {"reputation": 1375, "user_id": 8817027, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rJxo8.jpg?s=128&g=1", "display_name": "Emilio Lucas Ceroleni", "link": "https://stackoverflow.com/users/8817027/emilio-lucas-ceroleni"}, "is_accepted": false, "score": 0, "last_activity_date": 1543372110, "creation_date": 1543372110, "answer_id": 53511217, "question_id": 53511064, "link": "https://stackoverflow.com/questions/53511064/using-vba-to-return-a-field-value-of-a-given-task-id-in-ms-project/53511217#53511217", "title": "Using VBA to return a field value of a given task ID in MS Project", "body": "<p>You should try <code>ActiveProject.Tasks(1)...</code> to get the first task of the tasks collection:</p>\n\n<p>(<a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.tasks(object)\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/project.tasks(object)</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1543381481, "post_id": 53512453, "comment_id": 93894167, "body": "Note that Task ID and Task Unique ID are often different. Task ID represents the order of the tasks in the schedule whereas the Unique ID is assigned sequentially when tasks are added, regardless of position within the schedule."}, {"owner": {"reputation": 75, "user_id": 10505498, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160892956530133/picture?type=large", "display_name": "Marko Manenica", "link": "https://stackoverflow.com/users/10505498/marko-manenica"}, "edited": false, "score": 0, "creation_date": 1543386264, "post_id": 53512453, "comment_id": 93895721, "body": "Great thanks!  The ActiveSelection.Tasks... also solved another issue I was having"}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1543381359, "creation_date": 1543381359, "answer_id": 53512453, "question_id": 53511064, "link": "https://stackoverflow.com/questions/53511064/using-vba-to-return-a-field-value-of-a-given-task-id-in-ms-project/53512453#53512453", "title": "Using VBA to return a field value of a given task ID in MS Project", "body": "<p>To get the value of the Number2 field of a particular Task by <strong>ID</strong>:</p>\n\n<pre><code>ActiveProject.Tasks(3).Number2\n</code></pre>\n\n<p>To get the value by Task <strong>Unique ID</strong>:</p>\n\n<pre><code>ActiveProject.Tasks.UniqueID(3).Number2\n</code></pre>\n\n<p>To get the value of the Number2 field of the first <strong>selected task</strong>:</p>\n\n<pre><code>ActiveSelection.Tasks(1).Number2\n</code></pre>\n\n<p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/project.task.getfield\" rel=\"nofollow noreferrer\">GetField</a> method is useful if a <strong>variable field name</strong> is to be used:</p>\n\n<pre><code>ActiveProject.Tasks(3).GetField (pjTaskNumber2)\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 10505498, "user_type": "registered", "profile_image": "https://graph.facebook.com/10160892956530133/picture?type=large", "display_name": "Marko Manenica", "link": "https://stackoverflow.com/users/10505498/marko-manenica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2108, "favorite_count": 1, "accepted_answer_id": 53512453, "answer_count": 2, "score": 0, "last_activity_date": 1543381359, "creation_date": 1543370964, "last_edit_date": 1543371194, "question_id": 53511064, "link": "https://stackoverflow.com/questions/53511064/using-vba-to-return-a-field-value-of-a-given-task-id-in-ms-project", "title": "Using VBA to return a field value of a given task ID in MS Project", "body": "<p>This is probably really simple (I am new to VBA in MS Project - Excel is more my specialty) but I am just looking to return a value of selected field in MS Project based on a given Task ID.   I (unsuccessfully) tried this:</p>\n\n<pre><code>ActiveProject.Tasks.UniqueID(1).GetField(Number2)\n</code></pre>\n\n<p>...but hopefully that shows what I am trying to achieve which is finding the value of the Number2 field in the first Task of a project.</p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1543371543, "post_id": 53510922, "comment_id": 93891901, "body": "Your post does not have enough information for us to help you.  Are the hyperlinks always to the same sheet?  If there a criteria for adding the links and the &quot;OK&quot;s?  Please review site guidelines on <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and then <a href=\"https://stackoverflow.com/posts/53510922/edit\">edit</a> your post instead of adding information in a comment."}, {"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1543371680, "post_id": 53510922, "comment_id": 93891928, "body": "Also, was this actually recorded, <code>Range(RC26).Value() &amp; Range(R5C).Value()</code> , or did you add that to the recorded macro?"}, {"owner": {"reputation": 19, "user_id": 4573998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccf6a86aa953fb0932b18bace7cb8a1?s=128&d=identicon&r=PG&f=1", "display_name": "cokenol", "link": "https://stackoverflow.com/users/4573998/cokenol"}, "reply_to_user": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1543373342, "post_id": 53510922, "comment_id": 93892276, "body": "Yes. It is always applied to the same sheet. There is no criteria for adding the links.  Yes the <code>Range(RC26).Value() &amp; Range(R5C).Value()</code> was editted as I was trying to use absolute reference in the VBA code."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1543388953, "post_id": 53510922, "comment_id": 93896864, "body": "Note that in <code>Range(RC26)</code> the  <code>RC26</code> is considered as a variable name not as a value! I recommend to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i> so you don&#39;t run into such issues."}, {"owner": {"reputation": 13906, "user_id": 9814069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1mtoT.jpg?s=128&g=1", "display_name": "VBasic2008", "link": "https://stackoverflow.com/users/9814069/vbasic2008"}, "edited": false, "score": 0, "creation_date": 1543398797, "post_id": 53510922, "comment_id": 93902015, "body": "Will you apply the hyperlinks to the range &#39;AE7:AL14&#39;? if so, when clicking the OK in e.g. cell &#39;AI7&#39;,  what cell or range will it &#39;jump&#39; to? (guessing &#39;AI12&#39;) Where will e.g cells &#39;AF10&#39; or &#39;AH11&#39; point to? When I click on the OK in &#39;AL10&#39;, where will it &#39;jump&#39; to?"}, {"owner": {"reputation": 19, "user_id": 4573998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccf6a86aa953fb0932b18bace7cb8a1?s=128&d=identicon&r=PG&f=1", "display_name": "cokenol", "link": "https://stackoverflow.com/users/4573998/cokenol"}, "edited": false, "score": 0, "creation_date": 1543473916, "post_id": 53510922, "comment_id": 93934218, "body": "I would name AE7:AL14 as a named range. Then apply those hyperlinks to those named ranged. That way would be faster. I won&#39;t be applying hyperlinks to those cells in AL column."}], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1543388124, "creation_date": 1543388124, "answer_id": 53513764, "question_id": 53510922, "link": "https://stackoverflow.com/questions/53510922/vba-how-to-return-absolute-cell-reference-value-to-attach-to-a-hyperlink-referen/53513764#53513764", "title": "VBA How to return absolute cell reference value to attach to a hyperlink reference", "body": "<p>use <code>Cells</code> property of <code>Range</code> object whcih lets you use row and column indexes of wanted range:</p>\n\n<pre><code>Sub Hyperlink()\n    '\n    ' Hyperlink Macro\n    '\n    ' Keyboard Shortcut: Ctrl+q\n    '\n    ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n        \"'2RowFinCalc'!_\" &amp; Cells(Selection.Row, 26).Value &amp; Cells(5, Selection.Column).Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4573998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccf6a86aa953fb0932b18bace7cb8a1?s=128&d=identicon&r=PG&f=1", "display_name": "cokenol", "link": "https://stackoverflow.com/users/4573998/cokenol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 53513764, "answer_count": 1, "score": 0, "last_activity_date": 1543388789, "creation_date": 1543369965, "last_edit_date": 1543388789, "question_id": 53510922, "link": "https://stackoverflow.com/questions/53510922/vba-how-to-return-absolute-cell-reference-value-to-attach-to-a-hyperlink-referen", "title": "VBA How to return absolute cell reference value to attach to a hyperlink reference", "body": "<p>I am trying to record a macro to apply hyperlinks to the numbers and \"OK\"s by referencing to top row value and most left column value which represents a named range. </p>\n\n<p>It is always applied to the same sheet. There is no criteria for adding the links.</p>\n\n<p>My editted macro is as below, am I doing anything wrong?\n<a href=\"https://i.stack.imgur.com/iPkis.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iPkis.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Hyperlink()\n    '\n    ' Hyperlink Macro\n    '\n    ' Keyboard Shortcut: Ctrl+q\n    '\n    ActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n        \"'2RowFinCalc'!_\" &amp; Range(RC26).Value() &amp; Range(R5C).Value()\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1543390958, "post_id": 53510958, "comment_id": 93897778, "body": "Note that if you <code>Dim c, r As Integer</code> only <code>r</code> is of type <code>Integer</code> but <code>c</code> will be <code>Variant</code>. You must declare a type for <b>every</b> variable in VBA! Also you must use <code>Long</code> because Excel has more rows than <code>Integer</code> can handle: <code>Dim c As Long, r As Long</code>. I recommend <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA since there is no benefit in <code>Integer</code> at all."}], "tags": [], "owner": {"reputation": 140, "user_id": 4795359, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153158823210791/picture?type=large", "display_name": "Osman Wong", "link": "https://stackoverflow.com/users/4795359/osman-wong"}, "is_accepted": false, "score": 0, "last_activity_date": 1543370134, "creation_date": 1543370134, "answer_id": 53510958, "question_id": 53510832, "link": "https://stackoverflow.com/questions/53510832/i-need-to-copy-the-6-cells-next-to-an-active-cell/53510958#53510958", "title": "I need to copy the 6 cells next to an active cell", "body": "<p>first you should find the position of your active cell</p>\n\n<pre><code>  Dim c, r As Integer\n    r = ActiveCell.Row\n    c = ActiveCell.Column\nSet sht = ActiveSheet\n</code></pre>\n\n<p>then you can use range function to get them</p>\n\n<pre><code>with sht\nsht.range(.cells(c-7,r) , .cells(c-1,r)).copy\nend with\n</code></pre>\n\n<p>and rest of code below.</p>\n\n<p>P.S. i do not like to use .copy as it always run into error. I would prefer something like</p>\n\n<pre><code>Workbooks(\"Box 8.xlsm\").Sheets(\"Fentanyl\").Range(\"B4:B10\").value = sht.range(.cells(c-7,r) , .cells(c-1,r)).value\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10704562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb198fd1a617eee31df8a22293140f28?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff", "link": "https://stackoverflow.com/users/10704562/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582779526, "creation_date": 1543369365, "last_edit_date": 1582779526, "question_id": 53510832, "link": "https://stackoverflow.com/questions/53510832/i-need-to-copy-the-6-cells-next-to-an-active-cell", "title": "I need to copy the 6 cells next to an active cell", "body": "<p>I know this question has been asked in several different fashions but I'm unable to get the code to run. I'm very new to coding macros (2 whopping days of it now). Here is the part I'm looking for help with. </p>\n\n<pre><code>If Box = \"8\" Then Workbooks(\"Narc Log.xlsm\").Sheets(\"Fentanyl\").Range(\"B5:F5\").Copy _\n    Destination:=Workbooks(\"Box 8.xlsm\").Sheets(\"Fentanyl\").Range(\"B4\")\n</code></pre>\n\n<p>This copies a specific range of cells. I want to change it to copy the 6 cells to the left of the active cell and paste to the next available line in the other workbook \"Box8\"</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543367709, "post_id": 53510570, "comment_id": 93891026, "body": "yes it was, sorry about that!"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1543367892, "post_id": 53510570, "comment_id": 93891070, "body": "You <code>Select Case intRecordCount</code>, but your case statements use something else entirely (the <code>rsX.RecordCount</code>, which is not <code>intRecordCount</code>). You should read your code more carefully. It looks like you need a series of <code>If..Else</code> statements rather than a <code>Select Case</code>."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1543368043, "post_id": 53510570, "comment_id": 93891107, "body": "I&#39;m not exactly clear about what you&#39;re trying to test for. Should all of the recordsets have at least one record? It seems like you just need to make the tested fields required."}], "answers": [{"tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 3, "last_activity_date": 1543368528, "creation_date": 1543368528, "answer_id": 53510738, "question_id": 53510570, "link": "https://stackoverflow.com/questions/53510570/case-statement-not-evaluating-how-i-expect-it-to-ms-access-vba/53510738#53510738", "title": "Case Statement Not Evaluating How I expect it to MS Access VBA", "body": "<p>Note that your <code>intRecordCount</code> variable is never assigned a value.</p>\n\n<p>Each <code>Case</code> should be followed by a value against which <code>intRecordCount</code> can be compared. In your code example's <code>Case rs1.RecordCount = 0</code>, the <code>rs1.RecordCount = 0</code> first evaluates to a Boolean that will be True if there are no records in rs1; comparing <code>intRecordCount</code> and a Boolean doesn't make sense.</p>\n\n<p>You could simplify your code as follows:</p>\n\n<pre><code>If (rs1.RecordCount = 0) Or (rs2.RecordCount = 0) Or (rs3.RecordCount = 0) Or (rs4.RecordCount = 0) Or (rs5.RecordCount = 0) Then\n    MsgBox \"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "edited": false, "score": 0, "creation_date": 1543433140, "post_id": 53512034, "comment_id": 93922229, "body": "Thanks for your help, this works great!  I am actually noticing a way to potentially shorten the code significantly.  the entire procedure is supposed to determine if any of the 5 fields have no records in them.  So couldn;t I just say for instance  &#39;Set rs1 = db.OpenRecordset(&quot;SELECT [Dual Year Carrier Report].EE_ID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].EE_ID) Is Not Null));&quot;)     If rs1.EOF Then          MsgBox (&quot;Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type&quot;)     End If&#39;"}, {"owner": {"reputation": 66, "user_id": 10693656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348e31240329cd983a15b6b867205d25?s=128&d=identicon&r=PG", "display_name": "GraemeR", "link": "https://stackoverflow.com/users/10693656/graemer"}, "reply_to_user": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "edited": false, "score": 1, "creation_date": 1543445321, "post_id": 53512034, "comment_id": 93927275, "body": "Yes, &quot;If Not rs1.EOF Then ...&quot; works. The debug.print rs1.RecordCount, etc. statements are now [misleading] junk"}, {"owner": {"reputation": 66, "user_id": 10693656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348e31240329cd983a15b6b867205d25?s=128&d=identicon&r=PG", "display_name": "GraemeR", "link": "https://stackoverflow.com/users/10693656/graemer"}, "reply_to_user": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "edited": false, "score": 1, "creation_date": 1543446462, "post_id": 53512034, "comment_id": 93927578, "body": "My earlier note (on rewriting the queries) may give a better experience for the end user (note, I think I&#39;ve got the expressions the right way round to mirror your statements):  SELECT Sum(IIf([EE_ID] Is Not Null, 1, 0)) AS EE_ID_NotNullCount , Sum(IIf([PERSON_OID] Is Not Null, 1, 0)) AS PERSON_OID_NotNullCount , ... FROM [Dual Year Carrier Report]  One query result. Check each of the counts and concatinate instructions that the user should complete."}], "tags": [], "owner": {"reputation": 66, "user_id": 10693656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348e31240329cd983a15b6b867205d25?s=128&d=identicon&r=PG", "display_name": "GraemeR", "link": "https://stackoverflow.com/users/10693656/graemer"}, "is_accepted": true, "score": 2, "last_activity_date": 1543404713, "last_edit_date": 1543404713, "creation_date": 1543378494, "answer_id": 53512034, "question_id": 53510570, "link": "https://stackoverflow.com/questions/53510570/case-statement-not-evaluating-how-i-expect-it-to-ms-access-vba/53512034#53512034", "title": "Case Statement Not Evaluating How I expect it to MS Access VBA", "body": "<p>1) use Option Explicit</p>\n\n<p>2) declare variables</p>\n\n<p>3) vba Case statement doesn't work like that. Your statement looks a little bit like SQL Server syntax and a lot wrong.</p>\n\n<p>4) trick for young players: if you want to know how many records in your recordset then you need to access all the records.</p>\n\n<p>5) [not shown] consider rewriting your SQL statements as \"select count(*) as recCount from [Dual Year Carrier Report] where ...\" and checking the value of rs1(\"recCount\") , rs2(\"recCount\"), etc.</p>\n\n<pre><code>Option Compare Database\nOption Explicit\n\nSub CheckDataTypes()\n\n    Dim db As DAO.Database\n    Dim rs1 As DAO.Recordset, rs2 As DAO.Recordset, rs3 As DAO.Recordset, rs4 As DAO.Recordset, rs5 As DAO.Recordset\n\n    Set db = CurrentDb\n\n    Set rs1 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].EE_ID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].EE_ID) Is Not Null));\")\n    If Not rs1.EOF Then rs1.MoveLast    ' required to force MS Access to load records to recordset NOW\n    Set rs2 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].PERSON_OID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].PERSON_OID) Is Not Null));\")\n    If Not rs2.EOF Then rs2.MoveLast\n    Set rs3 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].SPONSOR_OID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].SPONSOR_OID) Is Not Null));\")\n    If Not rs3.EOF Then rs3.MoveLast\n    Set rs4 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].ZIP_CD FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].ZIP_CD) Is Not Null));\")\n    If Not rs4.EOF Then rs4.MoveLast\n    Set rs5 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].EP_PERSON_OID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].EP_PERSON_OID) Is Not Null));\")\n    If Not rs5.EOF Then rs5.MoveLast\n\n    Debug.Print rs1.RecordCount &amp; \", \" &amp; rs2.RecordCount &amp; \", \" &amp; rs3.RecordCount &amp; \", \" &amp; rs4.RecordCount &amp; \", \" &amp; rs5.RecordCount\n\n    If rs1.RecordCount = 0 Then\n        Debug.Print rs1.RecordCount\n        MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n    ElseIf rs2.RecordCount = 0 Then\n        MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n    ElseIf rs3.RecordCount = 0 Then\n        MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n    ElseIf rs4.RecordCount = 0 Then\n        MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n    ElseIf rs5.RecordCount = 0 Then\n        MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n    End If\n\n    Debug.Print rs1.RecordCount &amp; \", \" &amp; rs2.RecordCount &amp; \", \" &amp; rs3.RecordCount &amp; \", \" &amp; rs4.RecordCount &amp; \", \" &amp; rs5.RecordCount\n\nEnd Sub\n</code></pre>\n\n<p>Hope this helps,\nGraemeR</p>\n"}], "owner": {"reputation": 501, "user_id": 7129561, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8543be588e524cca7f2c217ac549771b?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck0185", "link": "https://stackoverflow.com/users/7129561/chuck0185"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 53512034, "answer_count": 2, "score": 0, "last_activity_date": 1543404713, "creation_date": 1543367028, "last_edit_date": 1543367790, "question_id": 53510570, "link": "https://stackoverflow.com/questions/53510570/case-statement-not-evaluating-how-i-expect-it-to-ms-access-vba", "title": "Case Statement Not Evaluating How I expect it to MS Access VBA", "body": "<p>I am trying to figure out why my case statement is not executing as I believe it should.  In the below sub, rs1.recordcount evaluates to 0, and the other 4 evaluate to 1.  To be sure of this I have printed the results of each recordset.recordcount both before the case statement is executed and also after it has executed.  However when I step through the code, I get the complete opposite of what I expect.  When I step through it, the second case statement <code>Case rs2.RecordCount = 0</code> is executed despite the fact that the statement evaluates to equal 1.  Any help would be much appreciated.  Thank you!</p>\n\n<pre><code>Option Compare Database\n\nSub CheckDataTypes()\n\n    Set db = CurrentDb\n    Set rs1 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].EE_ID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].EE_ID) Is Not Null));\")\n    Set rs2 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].PERSON_OID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].PERSON_OID) Is Not Null));\")\n    Set rs3 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].SPONSOR_OID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].SPONSOR_OID) Is Not Null));\")\n    Set rs4 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].ZIP_CD FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].ZIP_CD) Is Not Null));\")\n    Set rs5 = db.OpenRecordset(\"SELECT [Dual Year Carrier Report].EP_PERSON_OID FROM [Dual Year Carrier Report] WHERE ((([Dual Year Carrier Report].EP_PERSON_OID) Is Not Null));\")\n\nDebug.Print rs1.RecordCount &amp; \", \" &amp; rs2.RecordCount &amp; \", \" &amp; rs3.RecordCount &amp; \", \" &amp; rs4.RecordCount &amp; \", \" &amp; rs5.RecordCount\n\n\n\nSelect Case intRecordCount\n\nCase rs1.RecordCount = 0\n    Debug.Print rs1.RecordCount\n    MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n\nCase rs2.RecordCount = 0\n    MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n\nCase rs3.RecordCount = 0\n    MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n\nCase rs4.RecordCount = 0\n    MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n\nCase rs5.RecordCount = 0\n    MsgBox (\"Please import Dual Year Carrier Report again and make sure to change the proper fields to text data type\")\n\nEnd Select\n    Debug.Print rs1.RecordCount &amp; \", \" &amp; rs2.RecordCount &amp; \", \" &amp; rs3.RecordCount &amp; \", \" &amp; rs4.RecordCount &amp; \", \" &amp; rs5.RecordCount\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1543364903, "post_id": 53510158, "comment_id": 93890392, "body": "Your conditions could be improved. <code>if NewReportCell.Offset... and NewReportCell.Offset...Then if RowCount = 1 ... Else ... EndIf</code> No need to test the <code>NewReportCell.Offset</code> in two branches, since the offsets and their values are the same in both branches of your code. Start there and see where it takes you."}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "reply_to_user": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1543365267, "post_id": 53510158, "comment_id": 93890483, "body": "Will revise this. Would you know what to write after else so it looks at each row? can i write: else if RowCount &gt; 1 then for each  NewReportCell.Offset(0, -93).Value = &quot;-&quot; And _     NewReportCell.Offset(0, -142) = &quot;YES&quot; Do something?"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1543367863, "post_id": 53510158, "comment_id": 93891062, "body": "Since already you are using <code>Find</code> why not go for <code>Find</code> - <code>do</code> - <code>FindNext</code> - <code>Loop While</code> loop.Then testing for other conditions could be performed by an <code>If</code> branch inside the do loop. I think 1st RowCount using <code>SumIf</code> could also be eliminated."}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1543372635, "post_id": 53510158, "comment_id": 93892125, "body": "Can you give an example, struggling to visualize this because i want to stop the code when it hits &quot;-&quot; and &quot;YES&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1543417189, "post_id": 53514282, "comment_id": 93913244, "body": "let me try this and i will get back to you"}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1543419021, "post_id": 53514282, "comment_id": 93914519, "body": "So i do not want to copy the entire data, only specific columns, that means i can ignore this line  .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Copy Destination:=myOtherWorkbook.Worksheets(&quot;masterData&quot;).Range(&zwnj;&#8203;&quot;A2&quot;) ?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1543390328, "creation_date": 1543390328, "answer_id": 53514282, "question_id": 53510158, "link": "https://stackoverflow.com/questions/53510158/how-to-write-this-into-an-if-statement/53514282#53514282", "title": "How to write this into an IF statement", "body": "<p>look like a work for <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.autofilter\" rel=\"nofollow noreferrer\"><code>AutoFilter()</code></a>:</p>\n\n<pre><code>If loc.Offset(0, 2).Value = \"Not Available\" Then\n    loc.Offset(0, 80) = \"Y\"\nElse\n    loc.Offset(0, 80) = \"N\"\n\n    With NewReport 'reference NewReport sheet\n        With .Range(\"AK1:FW\" &amp; .Cells(.Rows.Count, \"FW\").End(xlUp).Row) ' reference referenced sheet range in columns AK:FW from row 1 down to FW column last not empty value\n            .AutoFilter Field:=1, Criteria1:=\"YES\" ' filter referenced sheet on it first column (i.e. column \"AK\") with \"YES\" content\n            .AutoFilter Field:=50, Criteria1:=\"-\" ' filter referenced sheet on it 50th column (i.e. column \"CH\") with \"-\" content\n            .AutoFilter Field:=143, Criteria1:=PK ' filter referenced sheet on it 143th column (i.e. column \"FW\") with PK content\n            If Application.WorksheetFunction.Subtotal(103, .Resize(, 1)) &gt; 1 Then ' uf any filtered values other than referenced range headers row\n                .Resize(.Rows.Count - 1).Offset(1).SpecialCells(xlCellTypeVisible).Copy Destination:=myOtherWorkbook.Worksheets(\"masterData\").Range(\"A2\") ' copy referenced range filtered values (skipping headers) to you destination workbook/worksheet\n            End If\n        End With\n        .AutoFilterMode = False\n    End With\nEnd If\n</code></pre>\n\n<p>this assumes that row 1 of <code>NewReport</code> worksheet is the header row of your database </p>\n"}], "owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 53514282, "answer_count": 1, "score": 1, "last_activity_date": 1582500835, "creation_date": 1543363739, "last_edit_date": 1582500835, "question_id": 53510158, "link": "https://stackoverflow.com/questions/53510158/how-to-write-this-into-an-if-statement", "title": "How to write this into an IF statement", "body": "<p>What i am trying to do is copy large amounts of data from a big report (called new report for this question) into the master report. </p>\n\n<p>The code below works fine when there is only one row to get the data from. However, not sure what to do when there are multiple rows with the same ID as its only looking at the <strong>first line and not all the rows</strong>. Why is this a problem? Because sometimes the below condition does not get fulfilled on the first line (shown in the code below)</p>\n\n<pre><code>NewReportCell.Offset(0, -93).Value = \"-\" And _\n\nNewReportCell.Offset(0, -142) = \"YES\" Then\n\nSub Interactv4(Optional ByDummy As Byte)\n\n    Dim PK As Variant\n    Dim Concat As String\n    Dim RowCount As Long\n    Dim nextrow As Long\n    Dim tC As String 'tC should represent the column with the concatenate in it\n    Dim col(1 To 8) As String\n    Dim loc As Range\n    Dim NewReportCell As Range\n\n    PK= loc.Offset(0, 2).Value\n\n    If loc.Offset(0, 2).Value = \"Not Available\" Then\n        loc.Offset(0, 80) = \"Y\"\n    Else\n        loc.Offset(0, 80) = \"N\"\n\n        'Line items from the new report\n        RowCount = WorksheetFunction.CountIf(NewReport.Range(\"FW:FW\"), PK)\n        Set NewReportCell = NewReport.Range(\"FW:FW\").Find(PK, lookat:=xlWhole)\n        If RowCount = 1 And _\n           NewReportCell.Offset(0, -93).Value = \"-\" And _\n           NewReportCell.Offset(0, -142) = \"YES\" Then\n\n            'A large amount of data is copied from the daily report based on the primary key given above\n</code></pre>\n\n<p>Now, to isolate those rows where there are multiple rows with the same ID, i add the following. However, it's not doing its job as in its still only copy pasting from the first row. Any help will be appreciated. </p>\n\n<pre><code>    Else\n        If RowCount &gt; 1 And _\n           NewReportCell.Offset(0, -93).Value = \"-\" And _\n           NewReportCell.Offset(0, -142) = \"YES\" Then\n</code></pre>\n"}, {"tags": ["vba", "utf-8", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 0, "creation_date": 1543363990, "post_id": 53509921, "comment_id": 93890185, "body": "I suspect you will need to explore language options in the .match methods of the .find method."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1543499549, "post_id": 53509921, "comment_id": 93948112, "body": "I&#39;m condensing comments, so moving this from below the answer to here... Just FYI :-) The additional macro code posted as an edit can&#39;t possibly give the described result: .Text = ChrW(&quot;&amp;H&quot; &amp; Val(strSearch(i))) makes no sense in this context. But the answer has been edited to include the additional request."}, {"owner": {"reputation": 317, "user_id": 6227615, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TGvX5.jpg?s=128&g=1", "display_name": "Atef Wagih", "link": "https://stackoverflow.com/users/6227615/atef-wagih"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543500898, "post_id": 53509921, "comment_id": 93948875, "body": "@CindyMeister, ok thanks a lot. Now if I need an array of words to be replaced all with the same link (e.g.:&quot;mango&quot; or &quot;mangoes&quot; or &quot;box of mangoes&quot; to be linked to <code>mangoes.com</code>, instead of having 3 macros for this, do I edit the same question, or start a new question? thanks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543501109, "post_id": 53509921, "comment_id": 93948996, "body": "I prefer you start a new question - thank you for asking :-)  It will help tremendously to see the code you have, to use as a starting point. But FWIW, in &quot;shorthand&quot;: Loop the array, performing a Find in each loop. The <code>Replacement.Text</code> would be the same throughout..."}, {"owner": {"reputation": 317, "user_id": 6227615, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TGvX5.jpg?s=128&g=1", "display_name": "Atef Wagih", "link": "https://stackoverflow.com/users/6227615/atef-wagih"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543503425, "post_id": 53509921, "comment_id": 93950406, "body": "@CindyMeister, thanks :). I created <a href=\"https://stackoverflow.com/q/53541729/6227615\">another question here</a>. I created an array, but the new function works on the last term only. I&#39;d appreciate if you have time to look at the other question. thanks."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1543495661, "last_edit_date": 1543495661, "creation_date": 1543434116, "answer_id": 53526940, "question_id": 53509921, "link": "https://stackoverflow.com/questions/53509921/vba-macro-to-search-a-text-string-and-replace-with-hyperlink-works-only-with-eng/53526940#53526940", "title": "VBA Macro to search a text string and replace with hyperlink works only with English text, but not Arabic", "body": "<p>You don't provide the code you used to search an Arabic term but based on the word posted in the question the issue appears to be related to Arabic being RTL in a LTR document. I wasn't able to test with Arabic characters in the macro code - even following the instructions in the link you provide my VBA editor only displays <code>?</code> - possibly because I don't have the Arabic IME installed...</p>\n\n<p>In any case, I was able to get it to work using the decimal number representation of the Unicode characters. The trick is to put them in reverse order (RTL) so:</p>\n\n<pre><code>strSearch = ChrW(1603) &amp; ChrW(1604) &amp; ChrW(1605) &amp; ChrW(1577) \n'instead of ChrW(1577) &amp; ChrW(1605) &amp; ChrW(1604) &amp; ChrW(1603)\n</code></pre>\n\n<p>The request has been changed to allowing the decimal number to be provided as a character-delimited string value. This can be split into an array, which is looped to put each value into the <code>ChrW</code> function and these concatenated into the search string:</p>\n\n<pre><code>Dim strSearch As String, Word1 As String\nDim valWord1 As Variant\nDim i As Long\nWord1 = \"1603,1604,1605,1577\"\nvalWord1 = Split(Word1, \",\")\nFor i = LBound(valWord1) To UBound(valWord1)\n    strSearch = strSearch &amp; ChrW(valWord1(i))\nNext\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 6227615, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/TGvX5.jpg?s=128&g=1", "display_name": "Atef Wagih", "link": "https://stackoverflow.com/users/6227615/atef-wagih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "accepted_answer_id": 53526940, "answer_count": 1, "score": 1, "last_activity_date": 1583030451, "creation_date": 1543361982, "last_edit_date": 1583030451, "question_id": 53509921, "link": "https://stackoverflow.com/questions/53509921/vba-macro-to-search-a-text-string-and-replace-with-hyperlink-works-only-with-eng", "title": "VBA Macro to search a text string and replace with hyperlink works only with English text, but not Arabic", "body": "<p>I have Arabic texts in Microsoft Word that I need to introduce hpyerlinks to some of its words. </p>\n\n<p><a href=\"https://superuser.com/a/1010293/722191\">The reply to this question here works</a> for me, but only for English words. When I replace the word \"google\" with any Arabic string (Whether one word or multiple words), the macro does not work.</p>\n\n<p>I can display the Arabic characters correctly in VBA, <a href=\"https://stackoverflow.com/a/32485700/6227615\">using the answer to this question here</a>, so there are no problems displaying the text in the macro.</p>\n\n<p>Can you please help me understanding what code modifications I need to have, in order to get the macro to recognize the arabic text?</p>\n\n<p>Needless to say, the Arabic language is a UTF-8 regulated language.</p>\n\n<p>Here is an Arabic word to test on:</p>\n\n<p>\u0643\u0644\u0645\u0629</p>\n\n<p>and here is the macro I am using, based on the link I provided above:</p>\n\n<pre><code>Sub FindAndHyperlink()\n    'define the style\n    Dim strStyle As String\n    strStyle = \"Subtle Emphasis\"\n    'set the search range\n    Dim rngSearch As Range\n    Set rngSearch = ActiveDocument.Range\n    'set the search string\n    Dim strSearch As String\n    strSearch = \"google\"\n    'set the target address for the hyperlink\n    Dim strAddress As String\n    strAddress = \"http:\\\\google.com\"\n\n    With rngSearch.Find\n        Do While .Execute(findText:=strSearch, MatchWholeWord:=True, Forward:=True) = True\n            With rngSearch 'we will work with what is found as it will be the selection\n                ActiveDocument.Hyperlinks.Add Anchor:=rngSearch, Address:=strAddress\n                .Style = ActiveDocument.Styles(strStyle) 'throw the style on it after the link\n            End With\n            rngSearch.Collapse Direction:=wdCollapseEnd\n            'keep it moving\n        Loop\n    End With\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance.</p>\n\n<p>Here is a screenshot of the outcome, after running the macro on a 3-word English phrase (worked), then changing it to one Arabic word (did not work).</p>\n\n<p><a href=\"https://i.stack.imgur.com/zs7c7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zs7c7.jpg\" alt=\"Macro results\"></a></p>\n\n<p><strong>EDIT 01</strong></p>\n\n<p>I modified my macro, based on @Cindy_Meister's answer below, but tried to group the characters in a list. The results are that the macro works, but on the decimal numbers, not the Arabic characters.</p>\n\n<p>so, to add links to the phrase <code>\u0627\u0644\u0623\u0646\u0628\u0627 \u063a\u0631\u064a\u063a\u0648\u0631\u064a\u0648\u0633</code>:</p>\n\n<p>Here is the updated macro:</p>\n\n<pre><code>Sub FindAndHyperlink2()\n'\n' FindAndHyperlink2 Macro\n'\n'\n'define the style\n    Dim strStyle As String\n    strStyle = \"Subtle Emphasis\"\n    'set the search range\n    Dim rngSearch As Range\n    Set rngSearch = ActiveDocument.Range\n    'set the search string\n    Dim strSearch_list As String\n    strSearch_list = \"01575&amp;01604&amp;01571&amp;01606&amp;01576&amp;01575&amp;00032&amp;01594&amp;01585&amp;01610&amp;01594&amp;01608&amp;01585&amp;01610&amp;01608&amp;01587\"\n    Dim strSearch As Variant\n    strSearch = Split(strSearch_list, \"&amp;\")\n\n    For i = 0 To UBound(strSearch)\n    With rngSearch.Find\n    .Text = ChrW(\"&amp;H\" &amp; Val(strSearch(i)))\n\n\n    'set the target address for the hyperlink\n    Dim strAddress As String\n    strAddress = \"http:\\\\google.com\"\n\n\n        Do While .Execute(findText:=strSearch_list, MatchWholeWord:=True, Forward:=True) = True\n            With rngSearch 'we will work with what is found as it will be the selection\n                ActiveDocument.Hyperlinks.Add Anchor:=rngSearch, Address:=strAddress\n            End With\n            rngSearch.Collapse Direction:=wdCollapseEnd\n            'keep it moving\n        Loop\n    End With\n\n    Selection.Find.Execute Replace:=wdReplaceAll\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>but when I apply this macro on an MS Word file that has both the decimal block and the Arabic text,  find that the decimal block is the one that was converted to a link, like the screenshots below:</p>\n\n<p>Screenshot <strong>before</strong> applying the macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/h2P4a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/h2P4a.png\" alt=\"Before applying the macro\"></a></p>\n\n<p>Screenshot <strong>after</strong> applying the macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/MslAx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MslAx.png\" alt=\"After applying the macro\"></a></p>\n\n<p><strong>What I want to achieve:</strong>\n<a href=\"https://i.stack.imgur.com/qOBOe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qOBOe.png\" alt=\"What I want to achieve\"></a></p>\n"}, {"tags": ["excel", "vba", "copy"], "comments": [{"owner": {"reputation": 352, "user_id": 3092495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/T4wqV.jpg?s=128&g=1", "display_name": "Rey Juna", "link": "https://stackoverflow.com/users/3092495/rey-juna"}, "edited": false, "score": 0, "creation_date": 1543366013, "post_id": 53509694, "comment_id": 93890644, "body": "Is the <code>anyCode.EntireRow.Copy</code> line the one where you want to only copy columns <code>B:AA</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10714171, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-awQaHipYIlE/AAAAAAAAAAI/AAAAAAAAAI8/U9lnPmSdY5I/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/10714171/brian"}, "edited": false, "score": 0, "creation_date": 1543394292, "post_id": 53511915, "comment_id": 93899314, "body": "Hello! That&#39;s helped with my range issue, but still get an error when trying to use the template. I get a runtime error. I think this might have something to do with the sheet size as it contains a number of formulas. Thanks for your help!"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 11, "user_id": 10714171, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-awQaHipYIlE/AAAAAAAAAAI/AAAAAAAAAI8/U9lnPmSdY5I/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/10714171/brian"}, "edited": false, "score": 0, "creation_date": 1543451336, "post_id": 53511915, "comment_id": 93928719, "body": "Could you share the error number and line.  If error no is 1004 and Template is protected. May use <code>Sheets(&quot;Template&quot;).Unprotect (pw)</code> before copy. Then use <code>Sheets(&quot;Template&quot;).Protect (pw)</code> after copy."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 1, "last_activity_date": 1543377595, "creation_date": 1543377595, "answer_id": 53511915, "question_id": 53509694, "link": "https://stackoverflow.com/questions/53509694/copy-and-paste-vba-from-master-to-template/53511915#53511915", "title": "Copy and Paste VBA from Master to Template", "body": "<p><strong>Welcome to SO</strong>. May try the modifications below </p>\n\n<pre><code>For Each anyCode In codesListRange\n    newWSName = Trim(anyCode.Text)\n\n    'may avoid using On Error if sheets count is not very high\n    have = False\n        For Each anyWS In ThisWorkbook.Worksheets\n        If anyWS.Name = newWSName Then have = True\n        Next\n\n        If have = False Then\n        'In your code Worksheet has been added instead of Copying Template\n        Sheets(\"Template\").Copy After:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count)\n        ActiveSheet.Name = newWSName\n        Set destWS = ThisWorkbook.Worksheets(newWSName)\n        srcWS.Range(\"A1:G1\").Copy Destination:=destWS.Range(\"A1:G1\")\n        Else\n        Set destWS = ThisWorkbook.Worksheets(newWSName)\n        End If\n\n    'as commented by @Rey Juna\n    srcWS.Range(\"B\" &amp; anyCode.Row &amp; \":AA\" &amp; anyCode.Row).Copy _\n     destWS.Range(dataCodeCol &amp; Rows.Count).End(xlUp).Offset(1, offsetToColA + 1)\n    ' 1 added to offsetToColA, Since  B to AA are to be  pasted in B to AA to keep dataCodeCol =AA\n    Application.CutCopyMode = False\n    Next anyCode\n</code></pre>\n\n<p>Hope further modification to your copy paste requirement may may solve the problem.   </p>\n"}], "owner": {"reputation": 11, "user_id": 10714171, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-awQaHipYIlE/AAAAAAAAAAI/AAAAAAAAAI8/U9lnPmSdY5I/photo.jpg?sz=128", "display_name": "Brian", "link": "https://stackoverflow.com/users/10714171/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543377595, "creation_date": 1543360630, "question_id": 53509694, "link": "https://stackoverflow.com/questions/53509694/copy-and-paste-vba-from-master-to-template", "title": "Copy and Paste VBA from Master to Template", "body": "<p>I've created a Master file, where I pull source data down into, but I now need to copy this information based on unique criteria in a column.</p>\n\n<p>Then I need to use the template that I have and paste the information into individual sheets, naming it based on the value.</p>\n\n<p>I've managed to get to this stage....</p>\n\n<pre><code>Sub MoveData()\n  'change these Const values to match your main data sheet setup\n  Const dataWSName = \"Master\"\n  Const dataCodeCol = \"AA\" ' column with the client names in it\n  Const dataFirstRow = 29 ' first row with data to copy\n\n  Dim srcWS As Worksheet\n  Dim destWS As Worksheet\n  Dim codesListRange As Range\n  Dim anyCode As Range\n  Dim newWSName As String\n  Dim lastRow As Long\n  Dim whereAmI As String\n  Dim offsetToColA As Integer\n  Dim ALC As Integer ' array loop counter\n  Dim anyWS As Worksheet\n  'change the \"To 1) part to match the number\n  'of sheets you need to keep\n  Dim keepSheetsList(1 To 2) As String\n  'put the list of sheets to keep into the array\n  keepSheetsList(1) = \"Master\"\n  keepSheetsList(2) = \"Template\"\n  'if you had more you would add them as (for 2 sheets)\n  'above redefine array as keepSheetsList(1 to 2) as string\n  'then fill them this way:\n  ' keepSheetsList(2) = \"another sheet name\"\n  '\n  'prompt user to make sure they didn't start this by accident.\n  If MsgBox(\"This will delete all old individual worksheets. Do you wish to continue?\", _\n   vbYesNo + vbQuestion, \"Rebuild Code Group Sheets?\") &lt;&gt; vbYes Then\n     Exit Sub ' exit without destroying anything!\n  End If\n\n  'select the Master sheet!\n  Worksheets(keepSheetsList(1)).Activate\n  For Each anyWS In ThisWorkbook.Worksheets\n    For ALC = LBound(keepSheetsList) To UBound(keepSheetsList)\n      If UCase(Trim(keepSheetsList(ALC))) = UCase(Trim(anyWS.Name)) Then\n        'this is a sheet in list of ones to keep\n        Exit For\n      End If\n    Next\n    If ALC &gt; UBound(keepSheetsList) Then\n      'sheet is not in list of ones to keep, delete it\n      Application.DisplayAlerts = False\n      anyWS.Delete\n      Application.DisplayAlerts = True\n    End If\n  Next ' examine next worksheet\n\n  whereAmI = ActiveSheet.Name\n  'begin by deleting ALL sheets in the workbook\n  'except for the one named Master\n  'set up so you could expand the list\n\n  offsetToColA = _\n   Range(\"A1\").Column - Range(dataCodeCol &amp; 1).Column ' -1 for now\n  Set srcWS = ThisWorkbook.Worksheets(dataWSName)\n  lastRow = srcWS.Range(dataCodeCol &amp; Rows.Count).End(xlUp).Row\n  If lastRow &lt; dataFirstRow Then\n    lastRow = dataFirstRow\n  End If\n  Set codesListRange = srcWS.Range(dataCodeCol &amp; dataFirstRow &amp; _\n   \":\" &amp; dataCodeCol &amp; lastRow)\n  Application.ScreenUpdating = False\n  For Each anyCode In codesListRange\n    newWSName = Trim(anyCode.Text)\n    On Error Resume Next\n    'see if needed sheet exists, if not create it\n    Set destWS = ThisWorkbook.Worksheets(newWSName)\n    If Err &lt;&gt; 0 Then\n      Err.Clear\n      On Error GoTo 0\n      'the sheet doesn't exist, create it\n      ThisWorkbook.Worksheets.Add _\n       after:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count)\n      ActiveSheet.Name = newWSName\n      Set destWS = ThisWorkbook.Worksheets(newWSName)\n      'add the header to it in row 1\n      srcWS.Range(\"A1:G1\").Copy Destination:=destWS.Range(\"A1:G1\")\n    End If\n    On Error GoTo 0\n    anyCode.EntireRow.Copy _\n     destWS.Range(dataCodeCol &amp; Rows.Count).End(xlUp).Offset(1, offsetToColA)\n    Application.CutCopyMode = False\n  Next\n  'back to the sheet you started on\n  ThisWorkbook.Worksheets(whereAmI).Activate\n  MsgBox \"Data has been copied to appropriate sheets.\", vbOKOnly, \"Done!\"\n  'good housekeeping cleanup\n  Set codesListRange = Nothing\n  Set destWS = Nothing\n  Set srcWS = Nothing\n End Sub\n</code></pre>\n\n<p>But...this doesn't use the template for the new worksheets and it copies the full rows where I only need B:AA.</p>\n\n<p>Any guidance would be appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1543434375, "post_id": 53509190, "comment_id": 93922811, "body": "I see you&#39;ve gotten an answer. FWIW the reason the code in the question probably doesn&#39;t work is because you&#39;re first activated the object. You might want to test that code without using either of the <code>Activate</code> lines."}, {"owner": {"reputation": 1500, "user_id": 3207478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kUyY1.png?s=128&g=1", "display_name": "gco", "link": "https://stackoverflow.com/users/3207478/gco"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1543447622, "post_id": 53509190, "comment_id": 93927829, "body": "This is such a simple answer, will try and might be the solution. I need to activate the shapes currently because I manipulate the tables massively too. But should run through a second loop after they have been deactivated again."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1543473207, "post_id": 53509190, "comment_id": 93933945, "body": "Or, if it works, put the scaling commands in before the activation."}], "answers": [{"comments": [{"owner": {"reputation": 1500, "user_id": 3207478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kUyY1.png?s=128&g=1", "display_name": "gco", "link": "https://stackoverflow.com/users/3207478/gco"}, "edited": false, "score": 0, "creation_date": 1543409786, "post_id": 53510137, "comment_id": 93908515, "body": "This works perfectly. I also have smaller tables and adapted <code>If .Width &gt; sWdth Then .Width = sWdth</code> to <code>If .Width &lt;&gt; sWdth Then .Width = sWdth</code>"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "reply_to_user": {"reputation": 1500, "user_id": 3207478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kUyY1.png?s=128&g=1", "display_name": "gco", "link": "https://stackoverflow.com/users/3207478/gco"}, "edited": false, "score": 1, "creation_date": 1543444653, "post_id": 53510137, "comment_id": 93927051, "body": "@gco In that case, you could just omit the test and use: .Width = sWdth"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 1, "last_activity_date": 1543363578, "creation_date": 1543363578, "answer_id": 53510137, "question_id": 53509190, "link": "https://stackoverflow.com/questions/53509190/in-word-2016-embedded-excel-tables-cant-be-scaled-via-vba/53510137#53510137", "title": "In Word 2016 embedded Excel tables can&#39;t be scaled via VBA", "body": "<p>It's not clear from your post whether the worksheets are embedded (perhaps with external referencing for which you might use code to update) or as linked objects. Your \"I use Inline Shapes instead of linked Excels\" doesn't exactly make this any clearer. For the resizing, try:</p>\n\n<pre><code>Sub Demo()\nApplication.ScreenUpdating = False\nDim Sctn As Section, iShp As InlineShape, sWdth As Single, sHght As Single\nFor Each Sctn In ActiveDocument.Sections\n  With Sctn\n    With .PageSetup\n      sWdth = .PageWidth - .LeftMargin - .RightMargin - .Gutter\n      sHght = .PageHeight - .TopMargin - .BottomMargin\n    End With\n    For Each iShp In .Range.InlineShapes\n      With iShp\n        .LockAspectRatio = True\n        If .Width &gt; sWdth Then .Width = sWdth\n        If .Height &gt; sHght Then .Height = sHght\n      End With\n    Next\n  End With\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The above macro will scale down and over-size inline shapes to fit the print area.</p>\n\n<p>As for your \"In some tables the last columns from Excel are not visible in Word\" issue, the solution really depends on whether the worksheets are embedded or linked.</p>\n"}], "owner": {"reputation": 1500, "user_id": 3207478, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/kUyY1.png?s=128&g=1", "display_name": "gco", "link": "https://stackoverflow.com/users/3207478/gco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53510137, "answer_count": 1, "score": -1, "last_activity_date": 1543409546, "creation_date": 1543357567, "last_edit_date": 1543409546, "question_id": 53509190, "link": "https://stackoverflow.com/questions/53509190/in-word-2016-embedded-excel-tables-cant-be-scaled-via-vba", "title": "In Word 2016 embedded Excel tables can&#39;t be scaled via VBA", "body": "<p><strong>Context</strong></p>\n\n<p>I have a Word with multiple embedded Excel tables. These Excel tables vary in width. I try to adjust the Excel spreadsheet widths with VBA code so that they are optimized for the page width of my Word document.</p>\n\n<p>The Excels have been embedded via Insert > Object > Microsoft Excel Worksheet</p>\n\n<p><strong>Problems</strong></p>\n\n<ol>\n<li>In the code example, the properties <code>.ScaleWidth</code> and <code>.ScaleHeight</code> have no effect on the size of the tables in Word.</li>\n<li>If I change the heights and widths with <code>.Width</code> and <code>.Height</code> the tables refresh back to their original sizes</li>\n</ol>\n\n<p><strong>Code Example 1</strong></p>\n\n<pre><code>For Each oShape In ActiveDocument.InlineShapes\n    If oShape.Type = wdInlineShapeEmbeddedOLEObject Then\n        If Left(oShape.OLEFormat.ProgID, 5) = \"Excel\" Then\n            oShape.OLEFormat.Activate\n            oShape.OLEFormat.Object.Application.Worksheets(1).Activate\n            oShape.ScaleWidth = x ' something calculated\n            oShape.ScaleHeight = y ' something calculated \n        End If\n   End If\nNext oShape\n</code></pre>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1543358326, "post_id": 53508868, "comment_id": 93888514, "body": "What does the SQL for the first request look like?"}], "answers": [{"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 2, "last_activity_date": 1543358795, "creation_date": 1543358795, "answer_id": 53509418, "question_id": 53508868, "link": "https://stackoverflow.com/questions/53508868/vba-sql-request-with-filter/53509418#53509418", "title": "VBA - SQL request with filter", "body": "<p>Assuming that your example object <code>a</code> is genuinely a <strong><em>table</em></strong> and not an <em>array</em> of values, there are a couple of ways to accomplish this:</p>\n\n<p><strong>Using a subquery in the <code>WHERE</code> clause:</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select c.nom_client\nfrom clients c\nwhere c.id not in (select a.id from a)\n</code></pre>\n\n<p><strong>Using a <code>LEFT JOIN</code>:</strong></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>select c.nom_client\nfrom clients c left join a on c.id = a.id\nwhere a.id is null\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7422943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40b0916b1c2235e6cb7449d4bc346348?s=128&d=identicon&r=PG&f=1", "display_name": "tony", "link": "https://stackoverflow.com/users/7422943/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1543358953, "creation_date": 1543356023, "last_edit_date": 1592644375, "question_id": 53508868, "link": "https://stackoverflow.com/questions/53508868/vba-sql-request-with-filter", "title": "VBA - SQL request with filter", "body": "<p>I would like to do a SQL request in VBA that avoids some values.</p>\n<ol>\n<li><p>First I do a request that give me the values I do not want:</p>\n<p>I put those values in a table <code>a</code> for example: <code>a = (1, 25, 3)</code></p>\n</li>\n<li><p>Then I would like to do a request like:</p>\n</li>\n</ol>\n<pre class=\"lang-vb prettyprint-override\"><code>    rst.Source = &quot;SELECT TableNumerosClients.NOM_CLIENT ,&quot; &amp; _\n                 &quot;FROM table.Clients WHERE NOT table.id in a ;&quot;\n</code></pre>\n<p>My problem here is a, I do not know how to make the query understand that <code>a = (1, 25, 3)</code></p>\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543356186, "post_id": 53508808, "comment_id": 93887612, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Don&#39;t use <code>ActiveSheet</code></a>. Refer to the specific worksheet, either with a loop (<code>For each ws in ThisWorkbook.Worksheets &#47;&#47; ws.ChartObjects(1).Chart ...do whatever... &#47;&#47; end With</code>) or just <code>Worksheets(&quot;SheetName&quot;).ChartObjects()...</code>.  It&#39;s hard to be more specific, without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 53, "user_id": 10713819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972f82ac3b4520e69003c185e8bbcec0?s=128&d=identicon&r=PG&f=1", "display_name": "JDugdale", "link": "https://stackoverflow.com/users/10713819/jdugdale"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1543356740, "post_id": 53508808, "comment_id": 93887829, "body": "BruceWayne Thank you, but I don&#39;t think either of those will be ideal. Ideally, I just want to enter the function in a cell and have it calculate the value for the chart in that specific sheet.  I will update the post to include the full code."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10713819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972f82ac3b4520e69003c185e8bbcec0?s=128&d=identicon&r=PG&f=1", "display_name": "JDugdale", "link": "https://stackoverflow.com/users/10713819/jdugdale"}, "edited": false, "score": 0, "creation_date": 1543360475, "post_id": 53509300, "comment_id": 93889224, "body": "Beautiful and perfect!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 53, "user_id": 10713819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972f82ac3b4520e69003c185e8bbcec0?s=128&d=identicon&r=PG&f=1", "display_name": "JDugdale", "link": "https://stackoverflow.com/users/10713819/jdugdale"}, "edited": false, "score": 0, "creation_date": 1543360486, "post_id": 53509300, "comment_id": 93889227, "body": "Great! Glad to help."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 9, "last_activity_date": 1543358172, "creation_date": 1543358172, "answer_id": 53509300, "question_id": 53508808, "link": "https://stackoverflow.com/questions/53508808/excel-vba-referencing-local-sheet-name/53509300#53509300", "title": "Excel VBA referencing local sheet name", "body": "<p>Sounds like you could use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.caller\" rel=\"noreferrer\"><code>Application.Caller</code></a>. Since this is a custom function entered in a cell, <code>Application.Caller</code> returns \"a <code>Range</code> object specifying that cell.\" The <code>Parent</code> of that <code>Range</code> is the worksheet in question.</p>\n\n<p>Change</p>\n\n<pre><code>Set c = ActiveSheet.ChartObjects(1).Chart\n</code></pre>\n\n<p>to </p>\n\n<pre><code>Set c = Application.Caller.Parent.ChartObjects(1).Chart\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10713819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972f82ac3b4520e69003c185e8bbcec0?s=128&d=identicon&r=PG&f=1", "display_name": "JDugdale", "link": "https://stackoverflow.com/users/10713819/jdugdale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "accepted_answer_id": 53509300, "answer_count": 1, "score": 5, "last_activity_date": 1543358172, "creation_date": 1543355756, "last_edit_date": 1543356985, "question_id": 53508808, "link": "https://stackoverflow.com/questions/53508808/excel-vba-referencing-local-sheet-name", "title": "Excel VBA referencing local sheet name", "body": "<p>I have a VBA function that outputs the trendline equation from a chart in the <code>ActiveSheet</code>. I use this function as an Add-in across multiple sheets though. In order to get the function to calculate, when I first open the workbook, I hit CTRL-ALT-F9. When I do this, the function calculates for the <code>ActiveSheet</code>, hence if I have used the function in multiple sheets, it is doing the calculation for whichever sheet is active, not the sheet in which the function is located. \nIdeally, I want the function to refer to whichever sheet it is located in, for that discrete instance. Since it should be broadly applicable to multiple sheets, I want to get away from calling out a specific sheet name. </p>\n\n<p>The current reference is: <code>ActiveSheet.ChartObjects(1).Chart</code> </p>\n\n<p>I tried <code>Worksheet.ChartObjects(1).Chart</code>, but that didn't compile. </p>\n\n<p>Thank you for any help/guidance.</p>\n\n<p>Full code: </p>\n\n<pre><code>Function TrendLineValue(x) As Double\n    Dim c As Chart\n    Dim t As Trendline\n    Dim e As String\n\n    ' Get the trend line object for activesheet\n    Set c = ActiveSheet.ChartObjects(1).Chart\n    Set t = c.SeriesCollection(1).Trendlines(1)\n\n    ' Display Equation\n    t.DisplayRSquared = False\n    t.DisplayEquation = True\n\n    'Number format for accuracy\n    t.DataLabel.NumberFormat = \"0.0000E+00\"\n\n    ' Get equation\n    e = t.DataLabel.Text\n\n    ' Create equation for use in cell\n    e = Replace(e, \"y =\", \"\")\n    e = Replace(e, \"x6\", \"x^6\")\n    e = Replace(e, \"x5\", \"x^5\")\n    e = Replace(e, \"x4\", \"x^4\")\n    e = Replace(e, \"x3\", \"x^3\")\n    e = Replace(e, \"x2\", \"x^2\")\n    e = Replace(e, \"x\", \" * \" &amp; x &amp; \" \")\n\n    ' Evaluate\n    TrendLineValue = Evaluate(e)\nEnd Function\n</code></pre>\n"}, {"tags": ["arrays", "vba", "list", "class", "userform"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9440305, "user_type": "registered", "profile_image": "https://graph.facebook.com/1281918971908516/picture?type=large", "display_name": "Gian Luca", "link": "https://stackoverflow.com/users/9440305/gian-luca"}, "edited": false, "score": 0, "creation_date": 1543417761, "post_id": 53514383, "comment_id": 93913612, "body": "Right.For some reasons I had stuck in my mind that arrays are objects. Thanks for your help!"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 5, "user_id": 9440305, "user_type": "registered", "profile_image": "https://graph.facebook.com/1281918971908516/picture?type=large", "display_name": "Gian Luca", "link": "https://stackoverflow.com/users/9440305/gian-luca"}, "edited": false, "score": 0, "creation_date": 1543421789, "post_id": 53514383, "comment_id": 93916445, "body": "You are welcome. If my answer solved your question you may then consider marking it as accepted. Thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1543390653, "creation_date": 1543390653, "answer_id": 53514383, "question_id": 53508734, "link": "https://stackoverflow.com/questions/53508734/what-is-the-best-strategy-in-vba-to-transfer-a-full-array-from-one-userform-list/53514383#53514383", "title": "What is the best strategy in VBA to transfer a full array from one userform lists to another?", "body": "<p>my understading is <code>arr</code> property of your class is an <code>array</code>, not an <code>object</code> </p>\n\n<p>hence don't use <code>Set</code> keyword:</p>\n\n<pre><code>Private pArr As Variant\n\nPublic Property Get arr() As Variant\n    arr = pArr\nEnd Property\n\nPublic Property Let arr(Value As Variant)\n    pArr = Value\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9440305, "user_type": "registered", "profile_image": "https://graph.facebook.com/1281918971908516/picture?type=large", "display_name": "Gian Luca", "link": "https://stackoverflow.com/users/9440305/gian-luca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 53514383, "answer_count": 1, "score": 0, "last_activity_date": 1543390653, "creation_date": 1543355473, "last_edit_date": 1543356091, "question_id": 53508734, "link": "https://stackoverflow.com/questions/53508734/what-is-the-best-strategy-in-vba-to-transfer-a-full-array-from-one-userform-list", "title": "What is the best strategy in VBA to transfer a full array from one userform lists to another?", "body": "<p>I am passing the content of a two dimensional array (first column header and than all column numbers) to a userform named Listbox1. Here the user selects items that are passed to Listbox2 and at last the user activates a process that sends data to a webservice. </p>\n\n<p>So far I have managed to populate Listbox1 with data headers only but have the problem to retain all values in listbox2, not only the header. I thought of creating a private variable at the userform level to store the full array but it seems to generate a type mismatch issue with the let/get properties.</p>\n\n<p>What is the best strategy to handle a full set of data with two lists?</p>\n\n<hr>\n\n<pre><code>Private pArr As Variant\nPublic Property Get arr() As Variant\n    Set arr = pArr\nEnd Property\nPublic Property Let arr(Value As Variant)\n    Set pArr = Value\nEnd Property\n\nPrivate Sub LoadModelData()\n\n    Dim i As Integer\n    Dim myArray As Variant\n    Dim v As Variant\n    Dim mystring As String\n\n    myArray = ReadModelData(this is the function returning the array data from a range)\n\n    Set pArr = myArray\n\n    For i = LBound(myArray) To UBound(pArr)\n        If pArr(i)(1, 1) &lt;&gt; vbNullString Then\n            frmListModelItms.List1.AddItem (pArr(i)(1, 1))\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "edited": false, "score": 0, "creation_date": 1543356467, "post_id": 53508475, "comment_id": 93887723, "body": "Great catch! Thanks much."}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": true, "score": 4, "last_activity_date": 1543354318, "creation_date": 1543354318, "answer_id": 53508475, "question_id": 53508342, "link": "https://stackoverflow.com/questions/53508342/why-does-vba-fail-to-sort-this-range/53508475#53508475", "title": "Why does VBA fail to sort this range?", "body": "<p><code>Range(\"C$2$:$E$\" &amp; LR)</code> - you have the dollar signs in wrong places - should be <code>Range(\"$C$2:$E$\" &amp; LR)</code>.</p>\n"}], "owner": {"reputation": 55, "user_id": 6737120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mtdAg.jpg?s=128&g=1", "display_name": "pawlactb", "link": "https://stackoverflow.com/users/6737120/pawlactb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 53508475, "answer_count": 1, "score": 0, "last_activity_date": 1543354318, "creation_date": 1543353768, "question_id": 53508342, "link": "https://stackoverflow.com/questions/53508342/why-does-vba-fail-to-sort-this-range", "title": "Why does VBA fail to sort this range?", "body": "<p>I have the following range (obviously not mine, but MWE):</p>\n\n<p><a href=\"https://i.stack.imgur.com/BwHGU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BwHGU.png\" alt=\"excel range description\"></a></p>\n\n<p>And I am looking to sort it using VBA. here is my code:</p>\n\n<pre><code>Sub test()\n    LR = ActiveWorkbook.Sheets(1).UsedRange.Rows.Count + ActiveSheet.UsedRange.Rows(1).Row - 1\n\n    Dim ws As Worksheet\n    Dim sort_range As Range\n\n    Set ws = ActiveWorksheet.Worksheets(1)\n    Set sort_range = ws.Range(\"C$2$:$E$\" &amp; LR)\n\n    Call sort_range.Sort(Key1:=sl_ws.Range(\"$C$2\"), Order1:=xlAscending, _\n                            Key2:=sl_ws.Range(\"$D$2\"), Order2:=xlAscending, _\n                            Key3:=sl_ws.Range(\"$E$2\"), Order3:=xlAscending, _\n                            Header:=xlYes)\nEnd Sub\n</code></pre>\n\n<p>This returns that the following error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/UBmO9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UBmO9.png\" alt=\"error\"></a>,</p>\n\n<p>directing me to this line:</p>\n\n<pre><code>    Set sort_range = ws.Range(\"C$2$:$E$\" &amp; LR)\n</code></pre>\n\n<p>What am I doing wrong? Any help is appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1543353020, "post_id": 53508080, "comment_id": 93886236, "body": "You had a typo on your <code>OAS = </code> line - you were missing a quotation mark for some reason. I&#39;ve edited it for you."}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1543686130, "post_id": 53508080, "comment_id": 94011178, "body": "This code seem unnecessarily complicated, it could be rewritten with a single for loop and without relative indices"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1543720589, "post_id": 53508080, "comment_id": 94018175, "body": "@UriGoren how could I do that?"}, {"owner": {"reputation": 11591, "user_id": 1097347, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/efffb39e9e98d002a5b9afe2fde7e50d?s=128&d=identicon&r=PG", "display_name": "Uri Goren", "link": "https://stackoverflow.com/users/1097347/uri-goren"}, "edited": false, "score": 0, "creation_date": 1543754453, "post_id": 53508080, "comment_id": 94024054, "body": "It looks like you&#39;re adding two matrices and then transposing. Why not write it explicitly in loop instead of creating the intermediate <code>R</code>, <code>M</code>, <code>O</code>, <code>Q</code> <code>SR</code> and <code>OAS</code> variables ?"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1543996712, "post_id": 53508080, "comment_id": 94114963, "body": "Added a later approach using the advanced filtering possibilites of the <code>Application.Index</code> function :-) @excelguy"}], "answers": [{"comments": [{"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1543353176, "post_id": 53508174, "comment_id": 93886299, "body": "Should I just use the one variable to store my values, aka <code>R</code> ?  then write it? Not sure if that works."}, {"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "reply_to_user": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1543411168, "post_id": 53508174, "comment_id": 93909361, "body": "Are you just trying to output a single value, or are you trying to output an array of values? If it&#39;s just a single value, then yes, just use one variable instead of an array of variables."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "edited": false, "score": 0, "creation_date": 1543414039, "post_id": 53508174, "comment_id": 93911223, "body": "I am trying to output values here, <code>.Range(&quot;B&quot; &amp; lastrow + 1 &amp; &quot;:&quot; &amp; &quot;H&quot; &amp; lastrow + 1).Value</code> So about 7 values across this row, all should be different values though."}], "tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": false, "score": 1, "last_activity_date": 1543353017, "creation_date": 1543353017, "answer_id": 53508174, "question_id": 53508080, "link": "https://stackoverflow.com/questions/53508080/adding-arrays-together-in-vba-for-output/53508174#53508174", "title": "Adding arrays together (in VBA) for output", "body": "<p>No, VBA does not support vector operations on arrays. You'll just need to loop through all the values in your arrays, add them together into a new output array, then set the value of your range to the new array.</p>\n"}, {"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1543870356, "post_id": 53596024, "comment_id": 94065891, "body": "While this seems an interesting approach, it&#39;s actually much slower than a simple <code>For</code> loop over the arrays - in this case by a factor of about 8"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1543911023, "post_id": 53596024, "comment_id": 94077972, "body": "@chrisneilsen Thank you for the warning. I didn&#39;t test it for speed (and I actually didn&#39;t expect it to be <i>that</i> slow). Nevertheless I added an approach for a loop, to complete the answer."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1543921994, "post_id": 53596024, "comment_id": 94084200, "body": "Despite speed considerations: one of the most instructive <code>MMult</code> illustrations +1 :-)"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 6, "last_activity_date": 1543910835, "last_edit_date": 1543910835, "creation_date": 1543848022, "answer_id": 53596024, "question_id": 53508080, "link": "https://stackoverflow.com/questions/53508080/adding-arrays-together-in-vba-for-output/53596024#53596024", "title": "Adding arrays together (in VBA) for output", "body": "<h3>Approach with matrix multiplication</h3>\n\n<p>To add up 2 arrays that are 1-dimensional you can do the following mathematical trick and multiply an array of your 4 arrays with an <code>Array(1, 1, 1, 1)</code> using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.mmult\" rel=\"nofollow noreferrer\">WorksheetFunction.MMult method</a> which results in the sum of that 4 arrays (due to matrix multiplication rules):</p>\n\n<pre><code>Option Explicit\n\nPublic Sub AddArrays()\n    Dim arr1 As Variant, arr2 As Variant, arr3 As Variant, arr4 As Variant\n    arr1 = Array(1, 3, 5, 5)\n    arr2 = Array(4, 0, 9, 1)\n    arr3 = Array(1, 2, 3, 4)\n    arr4 = Array(4, 3, 2, 1)\n    'result     10, 8, 19, 11\n\n    Dim MultArr As Variant\n    MultArr = Array(1, 1, 1, 1)  'a 1 for every arr variable that you sum (4 arrays = 4 ones)\n\n    Dim ResultArr As Variant\n    ResultArr = Application.WorksheetFunction.MMult(MultArr, Array(arr1, arr2, arr3, arr4))\n\n    'just an output example:\n    Debug.Print Join(ResultArr, \", \")\nEnd Sub\n</code></pre>\n\n<p>Because of the <a href=\"https://en.wikipedia.org/wiki/Matrix_multiplication#Linear_maps\" rel=\"nofollow noreferrer\">matrix multiplication rules</a> this is how it multiplies the matrix <code>MultArr</code> with the matrix that consists out of <code>arr1 \u2026 arr4</code>, which is the same result as adding <code>arr1 \u2026 arr4</code>:</p>\n\n<h2><a href=\"https://i.stack.imgur.com/65kAg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/65kAg.png\" alt=\"enter image description here\"></a></h2>\n\n<p>Since in your question the 2-dimensional arrays <code>ReDim R(1 To UBound(SR, 2), 1 To 1)</code> are almost 1-dimensional, they can be reduced to a 1D array <code>ReDim R(1 To UBound(SR, 2))</code> filled like <code>R(iSR) = SR(5, iSR)</code> and you can easily use that trick above to sum them: </p>\n\n<pre><code>.Range(\"B\" &amp; lastrow + 1 &amp; \":\" &amp; \"H\" &amp; lastrow + 1).Value = Application.WorksheetFunction.MMult(Array(1, 1, 1, 1), Array(R, M, O, Q))\n</code></pre>\n\n<h3>Approach with a loop</h3>\n\n<p>As chris neilsen mentioned that the approach shown above is about 8 times slower then a loop, I suggest the following:</p>\n\n<p>Since in your question the 2-dimensional arrays <code>ReDim R(1 To UBound(SR, 2), 1 To 1)</code> are almost 1-dimensional, they can be reduced to a 1D array which is easier to handle <code>ReDim R(1 To UBound(SR, 2))</code> filled like <code>R(iSR) = SR(5, iSR)</code></p>\n\n<p>And you can sum them up by a loop</p>\n\n<pre><code>Dim RestultArr As Variant\nReDim ResultArr(1 To UBound(SR, 2))\n\nDim i As Long\nFor i = LBound(ResultArr) To UBound(ResultArr)\n    ResultArr(i) = R(i) + M(i) + O(i) + Q(i)\nNext i\n</code></pre>\n\n<p>And write it to your range</p>\n\n<pre><code>.Range(\"B\" &amp; lastrow + 1 &amp; \":\" &amp; \"H\" &amp; lastrow + 1).Value = ResultArr\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1543956029, "creation_date": 1543956029, "answer_id": 53621068, "question_id": 53508080, "link": "https://stackoverflow.com/questions/53508080/adding-arrays-together-in-vba-for-output/53621068#53621068", "title": "Adding arrays together (in VBA) for output", "body": "<p><strong>Another way leading to Rome ...</strong></p>\n\n<p>Just for the sake of the art and in addition to the valid solutions above, I demonstrate a method how to <em>patch</em> the wanted array portions together in a one liner (instead of creating multiple arrays) using the advanced filtering features of the <code>Application.Index</code> function (cf. section <strong><code>1b</code></strong>). </p>\n\n<p>The resulting new variant array <code>v</code> is written back to <code>'Sheet B'</code> (cf. section <strong><code>2</code></strong>).</p>\n\n<p>Furthermore I show some examples to get column or row sums as well as totals (cf. section <strong><code>3</code></strong>).</p>\n\n<p><strong>Code example</strong></p>\n\n<p>I assume the columns in the data blocks belong to identical categories.</p>\n\n<pre><code>Option Explicit         ' declaration head of your code module\n\nSub AddDataBlocks()\n' [1a] create 2-dim data field array (1-based)\n  Dim v\n  v = ThisWorkbook.Worksheets(\"Sheet A\").Range(\"D3:J35\").Value2\n' [1b] filter rows to be maintained (omitting title row)\n  Dim MyRows(): MyRows = Array(5, 31, 32, 33)\n  v = Application.Transpose(Application.Index(v, MyRows, Evaluate(\"row(1:\" &amp; UBound(v, 2) &amp; \")\")))\n\n' [2]  write new array back to sheet B\n  Dim lastrow&amp;: lastrow = 1\n  ThisWorkbook.Worksheets(\"Sheet B\").Range(\"B\" &amp; lastrow + 1).Resize(UBound(v), UBound(v, 2)) = v\n\n' ~~&gt; Some arithmetics in examples\n' [3a] get total sum\n  Dim total#, i&amp;, j&amp;\n  For i = LBound(v) To UBound(v)\n      For j = LBound(v, 2) To UBound(v, 2)\n          total = total + v(i, j)\n      Next j\n  Next i\n  Debug.Print \"Total = \" &amp; total\n' [3b] display a row sum, e.g. 2nd row (no iM)\n  Const iR = 1, iM = 2, iO = 3, iQ = 4\n  Debug.Print \"M = \" &amp; WorksheetFunction.Sum(Application.Transpose(Application.Index(v, iM, 0)))\n' [3c] display a column sum, e.g. 3rd column\n  Debug.Print \"3rd column added = \" &amp; WorksheetFunction.Sum(Application.Transpose(Application.Index(v, 0, 3)))\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 1, "last_activity_date": 1544086151, "creation_date": 1544086151, "answer_id": 53647631, "question_id": 53508080, "link": "https://stackoverflow.com/questions/53508080/adding-arrays-together-in-vba-for-output/53647631#53647631", "title": "Adding arrays together (in VBA) for output", "body": "<p>The original code posted in the question uses too many for\u2026next and arrays, suggest to use the Match function to identify the field position and to sum the required values by field, before adding them to the array then post the resulting array.</p>\n\n<p>Requirements as I understand the problem:</p>\n\n<p>To add the values in row 5 from range <code>D3:J7</code> and the values in rows 6, 7 &amp; 8 from range <code>D28:J35</code> in worksheet <code>Sheet A</code> as they correspond to the fields in range <code>B1:H1</code> in worksheet <code>Sheet B</code>, using the first row of each range to identify the field position in relation to the range <code>B1:H1</code> in worksheet <code>Sheet B</code>. Then to post the resulting values for each field in the first blank row below range <code>B1:H1</code> in worksheet <code>Sheet B</code>.</p>\n\n<p>The code below uses the worksheet function <code>Match</code> to identify the field positions in each range instead of looping through each range\nThen after finding the position of the field in each range, adds the corresponding values to the output array </p>\n\n<p><em>Sample DATA before:</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/ndjEO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ndjEO.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Gk3QI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gk3QI.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub TEST()\nDim aOutput As Variant\nDim aHdr As Variant, aSR As Variant, aOAS As Variant\nDim bHdr As Byte, bSR As Byte, bOAS As Byte\nDim lastrow\n\n    lastrow = 1     'Value assigned for test purpose\n\n    Rem Set Arrays\n    With ThisWorkbook\n        aSR = .Worksheets(\"Sheet A\").Range(\"D3:J7\").Value     ' Array for CS01 Data\n        aOAS = .Worksheets(\"Sheet A\").Range(\"D28:J35\").Value  ' Array for MBS Data\n        aHdr = Worksheets(\"Sheet B\").Range(\"B1:H1\").Value\n    End With\n\n    Rem Redimensioning Header Array\n    aHdr = WorksheetFunction.Transpose(aHdr)\n    aHdr = WorksheetFunction.Transpose(aHdr)\n\n    Rem Create Output Array\n    aOutput = aHdr\n\n    Rem Fill Output Array\n    For bHdr = 1 To UBound(aHdr)\n\n        Rem Initiate Variables\n        bSR = 0\n        bOAS = 0\n        aOutput(bHdr) = 0\n\n        With WorksheetFunction\n\n            Rem Get Field Position\n            On Error Resume Next\n            bSR = .Match(aHdr(bHdr), .Index(aSR, 1, 0), 0)\n            bOAS = .Match(aHdr(bHdr), .Index(aOAS, 1, 0), 0)\n            On Error GoTo 0\n\n            Rem Add Field Values To Ouput Array\n            If bSR &lt;&gt; 0 Then aOutput(bHdr) = aSR(5, bSR)\n            If bOAS &lt;&gt; 0 Then aOutput(bHdr) = aOutput(bHdr) _\n                + aOAS(6, bOAS) + aOAS(7, bOAS) + aOAS(8, bOAS)\n\n    End With: Next\n\n    Rem Post Ouput Array\n    ThisWorkbook.Worksheets(\"Sheet B\").Cells(1 + lastrow, 2) _\n        .Resize(1, UBound(aOutput)).Value2 = aOutput\n\n    End Sub\n</code></pre>\n\n<p><em>Result:</em></p>\n\n<p><a href=\"https://i.stack.imgur.com/0w5H6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0w5H6.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Therefore there is no need to add several arrays as only one array is created.</em></p>\n\n<p>Note that in the original code these lines: </p>\n\n<pre><code>R(iSR, 1) = SR(5, iSR) \nM(iOAS, 1) = OAS(6, iOAS) \nO(iOAS, 1) = OAS(7, iOAS) \nQ(iOAS, 1) = OAS(8, iOAS) \n</code></pre>\n\n<p>Should have been: </p>\n\n<pre><code>R(iheaders, 1) = SR(5, iSR) \nM(iheaders, 1) = OAS(6, iOAS) \nO(iheaders, 1) = OAS(7, iOAS) \nQ(iheaders, 1) = OAS(8, iOAS) \n</code></pre>\n"}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3989, "favorite_count": 2, "accepted_answer_id": 53596024, "answer_count": 4, "score": 3, "last_activity_date": 1582500909, "creation_date": 1543352468, "last_edit_date": 1582500909, "question_id": 53508080, "link": "https://stackoverflow.com/questions/53508080/adding-arrays-together-in-vba-for-output", "title": "Adding arrays together (in VBA) for output", "body": "<p>Is it possible for me to add arrays together for an output?</p>\n\n<p>The code does match with headers and returns values to various arrays.\nwhen I try to output my arrays and add the values together I get </p>\n\n<blockquote>\n  <p>type mismatch</p>\n</blockquote>\n\n<p>on line </p>\n\n<pre><code>.Range(\"B\" &amp; lastrow + 1 &amp; \":\" &amp; \"H\" &amp; lastrow + 1).Value = Application.Transpose(R) + Application.Transpose(M) + Application.Transpose(O) + Application.Transpose(Q)\n</code></pre>\n\n<p>in the following code:</p>\n\n<pre><code>Const FirstMatch As Boolean = True\nDim SR As Variant\nDim OAS As Variant\nDim iSR As Integer\nDim iOAS As Integer\nDim R As Variant\nDim M As Variant\nDim O As Variant\nDim Q As Variant\nDim headers As Variant\nDim iheaders As Integer\n\nSR = Worksheets(\"Sheet A\").Range(\"D3:J7\").Value  ' Array for CS01 Data\nOAS = Worksheets(\"Sheet A\").Range(\"D28:J35\").Value 'Array for MBS Data\nheaders = Worksheets(\"Sheet B\").Range(\"B1:H1\").Value\n\nWith Worksheets(\"Sheet B\")\n    ReDim R(1 To UBound(SR, 2), 1 To 1)\n    ReDim M(1 To UBound(SR, 2), 1 To 1)\n    ReDim O(1 To UBound(SR, 2), 1 To 1)\n    ReDim Q(1 To UBound(SR, 2), 1 To 1)\n\n    For iheaders = 1 To UBound(headers, 2)\n        For iSR = 1 To UBound(SR, 2)\n            If headers(1, iheaders) = SR(1, iSR) Then\n                R(iSR, 1) = SR(5, iSR)\n                If FirstMatch Then\n                    Exit For\n                End If\n            End If\n        Next\n\n        For iOAS = 1 To UBound(OAS, 2)\n            If headers(1, iheaders) = OAS(1, iOAS) Then\n                M(iOAS, 1) = OAS(6, iOAS)\n                O(iOAS, 1) = OAS(7, iOAS)\n                Q(iOAS, 1) = OAS(8, iOAS)\n                If FirstMatch Then\n                    Exit For\n                End If\n            End If\n        Next\n    Next\n\n    .Range(\"B\" &amp; lastrow + 1 &amp; \":\" &amp; \"H\" &amp; lastrow + 1).Value = Application.Transpose(R) + Application.Transpose(M) + Application.Transpose(O) + Application.Transpose(Q)\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1543352048, "post_id": 53507979, "comment_id": 93885768, "body": "See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. You can also avoid using <code>AutoFill</code> by modifying the <code>FomulaR1C1</code> of the entire <code>Range</code> in question."}, {"owner": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1543353644, "post_id": 53507979, "comment_id": 93886504, "body": "Unfortunately i cannot post an actual answer, however please see the solution with comments: <a href=\"https://pastebin.com/WSMap6Bk\" rel=\"nofollow noreferrer\">pastebin.com/WSMap6Bk</a>"}, {"owner": {"reputation": 11, "user_id": 10713595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02be3d0718f379ff33f76a5eafcb4874?s=128&d=identicon&r=PG&f=1", "display_name": "user10713595", "link": "https://stackoverflow.com/users/10713595/user10713595"}, "reply_to_user": {"reputation": 2191, "user_id": 6373435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4RlNv.png?s=128&g=1", "display_name": "FAB", "link": "https://stackoverflow.com/users/6373435/fab"}, "edited": false, "score": 0, "creation_date": 1543453340, "post_id": 53507979, "comment_id": 93929174, "body": "Thanks so much @DarXyde . I will test your solution soon."}], "owner": {"reputation": 11, "user_id": 10713595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02be3d0718f379ff33f76a5eafcb4874?s=128&d=identicon&r=PG&f=1", "display_name": "user10713595", "link": "https://stackoverflow.com/users/10713595/user10713595"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1543352198, "answer_count": 0, "score": 0, "last_activity_date": 1582779540, "creation_date": 1543352013, "last_edit_date": 1582779540, "question_id": 53507979, "link": "https://stackoverflow.com/questions/53507979/how-can-i-make-this-macro-run-faster", "closed_reason": "Duplicate", "title": "How can I make this macro run faster?", "body": "<p>It takes about 3 minutes right now and I don't think it should take that long. What am I doing wrong?</p>\n\n<p>I am copying a column of dates and then extracting the time, date, month and year. </p>\n\n<pre><code>Sub Date_Conversion()\n'\n' Date_Conversion Macro\n'\n\n'\n    Sheets(\"PTP Calc\").Visible = True\n    Application.ScreenUpdating = False\n\n    Sheets(\"Agent Inbound Call Detail-Agent\").Select\n    Range(\"A3\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n\n    Sheets(\"PTP Calc\").Select\n    Range(\"A3\").Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    ' Columns(\"A:A\").EntireColumn.AutoFit\n    Range(\"B3\").Select\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = \"=MONTH(RC[-1])\"\n    Range(\"B3\").Select\n    'added line below\n    Selection.AutoFill Destination:=Range(\"B3:B4690\")\n    'Range(\"B3:B4690\").Select\n    Range(\"C3\").Select\n    ActiveCell.FormulaR1C1 = \"=DAY(RC[-2])\"\n    Range(\"C3\").Select\n    Selection.AutoFill Destination:=Range(\"C3:C4690\")\n\n    Range(\"D3\").Select\n    ActiveCell.FormulaR1C1 = \"=HOUR(RC[-3])\"\n    Range(\"D3\").Select\n    Selection.AutoFill Destination:=Range(\"D3:D4690\")\n\n    Range(\"E3\").Select\n    ActiveCell.FormulaR1C1 = \"=IF(RC[-1]&gt;=12,\"\"PM\"\",\"\"AM\"\")\"\n    Range(\"E3\").Select\n    Selection.AutoFill Destination:=Range(\"E3:E4690\")\n\n\n    Range(\"F3\").Select\n    ActiveCell.FormulaR1C1 = \"=TEXT(RC[-5],\"\"dddd\"\")\"\n    Range(\"F3\").Select\n    Selection.AutoFill Destination:=Range(\"F3:F4690\")\n\n\n    Sheets(\"PTP Calc\").Visible = False\n    Sheets(\"Per Tech Performance\").Select\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 1, "creation_date": 1543351996, "post_id": 53507889, "comment_id": 93885741, "body": "What DB are you using?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543352948, "post_id": 53507889, "comment_id": 93886198, "body": "Removing <code>Application.StatusBar</code> update and <code>DoEvents</code> could significantly trim the execution time already, but it wouldn&#39;t surprise me if bulk-inserting the records with an <code>INSERT INTO... SELECT</code> query, i.e. querying your worksheet through ODBC rather than generating one <code>INSERT</code> statement per row, would bring the whole thing down to under a minute."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543353004, "post_id": 53507889, "comment_id": 93886225, "body": "Also <code>query2</code> is redundant, just use a <code>_</code> line continuation, no need to concatenate <code>query &amp; query2</code>"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 9585960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ed82391a137bf3fed6fe2a74ca12a4?s=128&d=identicon&r=PG", "display_name": "user9585960", "link": "https://stackoverflow.com/users/9585960/user9585960"}, "edited": false, "score": 0, "creation_date": 1543354762, "post_id": 53508284, "comment_id": 93887019, "body": "Hi! Thanks for your answer! I&#39;m using Microsoft SQL SERVEr, I&#39;ll try the bulk insert solution, thanks."}], "tags": [], "owner": {"reputation": 894, "user_id": 10644878, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "D&#225;vid Laczk&#243;", "link": "https://stackoverflow.com/users/10644878/d%c3%a1vid-laczk%c3%b3"}, "is_accepted": false, "score": 1, "last_activity_date": 1543353552, "creation_date": 1543353552, "answer_id": 53508284, "question_id": 53507889, "link": "https://stackoverflow.com/questions/53507889/vba-speed-up-uploading-data-to-sql-from-vba/53508284#53508284", "title": "VBA - Speed Up Uploading Data to SQL from VBA", "body": "<p>The problem is that this loop sends the data to the server row-by-row and runs a query for each. You need to send the whole thing as one recordset and insert it with one query.<br>\nAs you did not provide what kind of SQL DB you have, I can only give you one suggestion for Microsoft SQL Server: first export your recordset to .csv file then instead of running the \"INSERT INTO \" query run a <a href=\"https://docs.microsoft.com/en-us/sql/t-sql/statements/bulk-insert-transact-sql?view=sql-server-2017\" rel=\"nofollow noreferrer\">BULK INSERT</a>.</p>\n"}], "owner": {"reputation": 111, "user_id": 9585960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68ed82391a137bf3fed6fe2a74ca12a4?s=128&d=identicon&r=PG", "display_name": "user9585960", "link": "https://stackoverflow.com/users/9585960/user9585960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543353552, "creation_date": 1543351620, "last_edit_date": 1543351775, "question_id": 53507889, "link": "https://stackoverflow.com/questions/53507889/vba-speed-up-uploading-data-to-sql-from-vba", "title": "VBA - Speed Up Uploading Data to SQL from VBA", "body": "<p>I\u2019m using a macro that writes data to a SQL Table everyday. Problem is that usually I have more than 300k rows to upload and Macro runs very slowly (more than 60 minutes). Is there anyway to speed up this process? Below part of the code, this is exactly where Macro spent most of time:</p>\n\n<pre><code> tb = \"[Table_Test]\"\n    Set Pos = ThisWorkbook.Sheets(\u201cSheet1\u201d)\n    For i = 3 To last_row\n\n        query = \"INSERT INTO \" &amp; tb &amp; \" ([DATE],[POSITION])\"\n        query2 = \" VALUES \" &amp; \"('\" &amp; Format(CDate(Pos.Cells(i, 1)), \"yyyy-mm-dd\") &amp; \"'\" &amp; \", '\" &amp; Pos.Cells(i, 2) &amp; \"'\" &amp;\");\"\n        query = query &amp; query2\n        Execute_SQL_218 (query)\n        query = False\n        Application.StatusBar = \"Uploading Data To SQL...\" &amp; i\n        DoEvents\n    Next i\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1543351904, "post_id": 53507903, "comment_id": 93885694, "body": "Ah, so that&#39;s why just adding chklst(i) just says subscript out of range. I was comparing it on my other array list code and I didn&#39;t have to declare the size at all and it was working without issues, so not sure why I have to declare it this time. But yeah, got it working now."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "edited": false, "score": 0, "creation_date": 1543352658, "post_id": 53507903, "comment_id": 93886062, "body": "@Basher look closer, because accessing an uninitialized array subscript throws error 9 <i>as per language specifications</i>, and those aren&#39;t changing between debugging sessions."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1543351653, "creation_date": 1543351653, "answer_id": 53507903, "question_id": 53507813, "link": "https://stackoverflow.com/questions/53507813/type-mismatch-13-error-13-on-setting-array-value/53507903#53507903", "title": "Type Mismatch 13 error 13 on setting array value", "body": "<p>You have not declared the size of the array. Without declaring the size there is no where to put anything.</p>\n\n<pre><code>Sub test()\n\n    With Worksheets(\"Select\")\n\n        Dim chklst() As String\n        ReDim chklst(1 To Application.CountIf(.Range(.Cells(15, 12), .Cells(24, 12)), \"True\"))\n\n\n        Dim i As Long\n        For i = 1 To 10\n            If .Cells(14 + i, 12).Value = \"True\" Then\n                chklst(i) = .Cells(14 + i, 13).Value 'This is where the error shows up\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 6850479, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7403e272dbfeb0588a3184d1a9fb4df2?s=128&d=identicon&r=PG&f=1", "display_name": "Basher", "link": "https://stackoverflow.com/users/6850479/basher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 53507903, "answer_count": 1, "score": 1, "last_activity_date": 1582520474, "creation_date": 1543351344, "last_edit_date": 1582520474, "question_id": 53507813, "link": "https://stackoverflow.com/questions/53507813/type-mismatch-13-error-13-on-setting-array-value", "title": "Type Mismatch 13 error 13 on setting array value", "body": "<p>I'm not sure what's going on, I though it'd be a simple code.</p>\n\n<p>Basically, I'm just creating an array list based whether or not a cell value is True. But I'm getting the error when setting the array to the cell value. Did I miss something?</p>\n\n<pre><code>Sub test()\n    Dim chklst() As String\n    Dim i As Long\n\n    With Worksheets(\"Select\")\n        For i = 1 To 10\n            If .Cells(14 + i, 12).Value = \"True\" Then\n                chklst() = .Cells(14 + i, 13).Value 'This is where the error shows up\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<p>When adding a watch, it found that  <code>.Cells(14 + i, 13).Value</code> is a Variant/String. Changing the variable to Variant doesn't work. Changing .Value to .Text doesn't work either.. Help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1543351224, "post_id": 53507741, "comment_id": 93885367, "body": "Worksheet_Change events should be in the worksheet code to which it runs, not a module."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1543391115, "post_id": 53507741, "comment_id": 93897857, "body": "<a href=\"http://idownvotedbecau.se/imageofcode\" rel=\"nofollow noreferrer\">An image of your code is not helpful</a> always include the code in your question and format it as code block."}], "owner": {"reputation": 11, "user_id": 10713701, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z8GfVEeFFNA/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hYdU7AECGX0PnGvoi0jMh4zYVE3g/mo/photo.jpg?sz=128", "display_name": "Julia_F", "link": "https://stackoverflow.com/users/10713701/julia-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1582779554, "creation_date": 1543351040, "last_edit_date": 1582779554, "question_id": 53507741, "link": "https://stackoverflow.com/questions/53507741/why-does-the-cell-not-revert-back-to-activecell-formular1c1", "title": "Why does the cell not revert back to ActiveCell.FormulaR1C1?", "body": "<p>Here is the Macro that I wrote. What I want is for the cell to pull in the results from the tab titled Results cell B3. When I run the macro, everything works except for when I override the value in cell B3 it doesn't revert back to the =Results!B3 like I want it to when I make a change to the C9 cell.</p>\n\n<p><img src=\"https://i.stack.imgur.com/VitXw.png\" alt=\"\"></p>\n"}, {"tags": ["excel", "vba", "excel-charts"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10713685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-It_HQUfP79k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g-NN20s_zdHyLzFJ-hgwmGlZvpcw/mo/photo.jpg?sz=128", "display_name": "Maciek Wojciechowski", "link": "https://stackoverflow.com/users/10713685/maciek-wojciechowski"}, "edited": false, "score": 0, "creation_date": 1543393123, "post_id": 53511947, "comment_id": 93898751, "body": "Great thanks. That workaround solved my problem on which I spent a lot of hours."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 41, "user_id": 10713685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-It_HQUfP79k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g-NN20s_zdHyLzFJ-hgwmGlZvpcw/mo/photo.jpg?sz=128", "display_name": "Maciek Wojciechowski", "link": "https://stackoverflow.com/users/10713685/maciek-wojciechowski"}, "edited": false, "score": 0, "creation_date": 1543448971, "post_id": 53511947, "comment_id": 93928211, "body": "@MaciekWojciechowski I&#39;m glad I could help. If this solves your question, please consider accepting it by clicking the check mark. This is not an obligation, but it indicates to the wider community that you&#39;ve found a solution and gives some reputation to both the answerer and yourself."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": false, "score": 1, "last_activity_date": 1543388496, "last_edit_date": 1543388496, "creation_date": 1543377840, "answer_id": 53511947, "question_id": 53507740, "link": "https://stackoverflow.com/questions/53507740/change-axis-label-font-size-in-a-funnel-chart-excel-2016/53511947#53511947", "title": "Change Axis Label font size in a funnel chart (Excel 2016)", "body": "<p>This is a very peculiar bug! </p>\n\n<p>I guess it has to do with the fact that the <em>XlCategory</em> axis becomes vertical when you are using the \"Funnel\" chart type:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rRjtC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rRjtC.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've tried all the standard VBA ways I could think of and this doesn't seem to work. I even tried to see if we could save a funnel chart as a template and then use VBA to apply this template, but \"Save as Template\" is not available for some reason...</p>\n\n<p><a href=\"https://i.stack.imgur.com/2beDW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2beDW.png\" alt=\"enter image description here\"></a></p>\n\n<p>So, the reason why I'm explaining all this instead of writing a solution is because there is a workaround, but this kind of thing should only be used as a last resort. And if you haven't guessed it, I'm talking about using the <strong><em>SendKeys</em></strong> method.</p>\n\n<p><em>Disclaimer</em>: As always, using <em>SendKeys</em> is somewhat tricky and can lead to unexpected results. I would recommend reading some articles to get yourself familiar with it before using it. <a href=\"https://www.contextures.com/excelvbasendkeys.html\" rel=\"nofollow noreferrer\">This article</a> would be a good starting point. </p>\n\n<p>Furthermore, to avoid any issues, don't run a macro that has the <em>SendKeys</em> method using the Run button <a href=\"https://i.stack.imgur.com/sKN5b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sKN5b.png\" alt=\"enter image description here\"></a> in the VBE since the keystroke must be sent to the Excel window and not the VBE window. I suggest launching the macro using a shortcut to launch your macro. For example, you could use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.onkey\" rel=\"nofollow noreferrer\"><em>Application.OnKey</em> method</a> by runnning a macro similar to this:</p>\n\n<pre><code>Sub SetShortcut()\n\n    'Set the shortcut for the macro to be CTRL+ALT+m\n    Application.OnKey \"^%m\", \"NameOfYourMacro\"\n\nEnd Sub\n</code></pre>\n\n<p><strong>An example using Sendkeys</strong></p>\n\n<p>The idea is to use Sendkeys to send the sequence of keystrokes that would give us the result we want. Here, we want to change the size and the font name of the <em>XlCategory</em> axis. By using the correct <a href=\"https://fasteratexcel.com/excel-alt-shortcuts/\" rel=\"nofollow noreferrer\">Alt key shortcut sequence</a> we can achieve this. I'm not sure if the sequence is the same for all versions of Excel, but with Office 365, if we wanted to change the font name, it would be:</p>\n\n<ol>\n<li>Type <em>Alt</em> - to initiate the Alt Key shortcut sequence.</li>\n<li>Type \"H\" - to get the Home tab</li>\n<li>Type \"FF\" - to select the Font Name text box</li>\n<li>Type \"Arial\" and then press <em>Enter</em> - to change the font to Arial.</li>\n</ol>\n\n<p>For this to apply to the <em>XlCategory</em> axis, we need to make sure that it is <strong>already selected before we run the macro</strong>. If it is selected, the following code should do the trick:</p>\n\n<pre><code>Sub ChangeCategoryAxisFont()\n\n    'Font Name\n    Application.SendKeys Keys:=\"%\", Wait:=True\n    Application.SendKeys Keys:=\"H\", Wait:=True\n    Application.SendKeys Keys:=\"FF\", Wait:=True\n    Application.SendKeys Keys:=\"Arial\", Wait:=True\n    Application.SendKeys Keys:=\"~\", Wait:=True 'Press Enter\n\n    'Size\n    Application.SendKeys Keys:=\"%\", Wait:=True\n    Application.SendKeys Keys:=\"H\", Wait:=True\n    Application.SendKeys Keys:=\"FS\", Wait:=True\n    Application.SendKeys Keys:=\"12\", Wait:=True\n    Application.SendKeys Keys:=\"~\", Wait:=True 'Press Enter\n\n    'Restore Numlock (which gets disabled when your macro runs at least one SendKeys command)\n    Application.SendKeys Keys:=\"{NUMLOCK}\", Wait:=True\n\nEnd Sub\n</code></pre>\n\n<p>If it is not already selected (even if the chart is selected), you might have another problem: if you include <code>ActiveChart.Axes(xlCategory).Select</code> in your macro, the options available in the ribbon won't be updated correctly and the macro above won't work. To let the ribbon update, we would need to end the execution of any macros for a brief second and proceed with our macro after.</p>\n\n<p>For instance, you could use the <em>Application.OnTime</em> method to schedule the macro to run one second later, like this:</p>\n\n<pre><code>Sub PreSelectAxisAndRunMainMacro()\n\n    ActiveChart.Axes(xlCategory).Select\n    Application.OnTime Now + TimeSerial(0, 0, 1), \"ChangeCategoryAxisFont\"\n\nEnd Sub\n</code></pre>\n\n<p>I know what you might think: \"All this just to make some font changes?!\". Yeah, I know, but at least if you become familiar with how to use the <em>SendKeys</em> method, you'll be able to use this in other contexts that require it...</p>\n"}], "owner": {"reputation": 41, "user_id": 10713685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-It_HQUfP79k/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-g-NN20s_zdHyLzFJ-hgwmGlZvpcw/mo/photo.jpg?sz=128", "display_name": "Maciek Wojciechowski", "link": "https://stackoverflow.com/users/10713685/maciek-wojciechowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1582779572, "creation_date": 1543351032, "last_edit_date": 1582779572, "question_id": 53507740, "link": "https://stackoverflow.com/questions/53507740/change-axis-label-font-size-in-a-funnel-chart-excel-2016", "title": "Change Axis Label font size in a funnel chart (Excel 2016)", "body": "<p>I want to change font size on axis <code>xlCategory</code>. I am running the code like below but it is failing. I am stuck in finding workarounds. Chart is \"Funnel\" type 123. On the other types of chart code is running fine.</p>\n\n<pre><code>With ActiveChart.Axes(xlCategory).TickLabels.font\n    .size = 12\n    .Name = \"Arial\"\nEnd With\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>\"object doesn't support this action\"</p>\n</blockquote>\n\n<p>I was also trying to run the othe code but also without any success.</p>\n\n<pre><code>ActiveChart.Axes(xlCategory).Select\nWith Selection.Format.TextFrame2.TextRange.font\n    .size = 12\nEnd With\n</code></pre>\n\n<p>I get the error:</p>\n\n<blockquote>\n  <p>\"method textframe2 of object chartformat failed\"</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1543350163, "post_id": 53507503, "comment_id": 93884909, "body": "I don&#39;t get it, You are trying to multiply 4 numbers by 100 and get the result?  Are you adding the 4 numbers up before multiplying or are you multiplying each by 100 then adding."}, {"owner": {"reputation": 1806, "user_id": 8754516, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7be49dad417bd035463828d197cfb7c?s=128&d=identicon&r=PG&f=1", "display_name": "natn2323", "link": "https://stackoverflow.com/users/8754516/natn2323"}, "edited": false, "score": 1, "creation_date": 1543355158, "post_id": 53507503, "comment_id": 93887190, "body": "To provide some clarification, please add an example input and an expected result."}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1543351793, "post_id": 53507886, "comment_id": 93885637, "body": "that is one problem, yes, but also the OP is trying to multiply an array by 100 which also will error with typemismatch."}, {"owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1543351976, "post_id": 53507886, "comment_id": 93885728, "body": "@ScottCraner Sorry, I missed that. Mobile app doesn&#39;t give me an option to delete my answer, but will try to delete via browser"}], "tags": [], "owner": {"reputation": 4001, "user_id": 8811778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/803575584f2d2d45fe01ee5d52c003dd?s=128&d=identicon&r=PG&f=1", "display_name": "chillin", "link": "https://stackoverflow.com/users/8811778/chillin"}, "is_accepted": true, "score": 2, "last_activity_date": 1543351609, "creation_date": 1543351609, "answer_id": 53507886, "question_id": 53507503, "link": "https://stackoverflow.com/questions/53507503/multiplying-a-column-based-on-another-column-value/53507886#53507886", "title": "Multiplying a column based on another column value", "body": "<p>If you start a new line after the <code>then</code> in your IF statement, then you must end the block with <code>End if</code> (let's ignore the line continuation character for now) -- else the syntax is not valid.</p>\n\n<p>So either do:</p>\n\n<pre><code>If 1 &gt; 0 then\n     Msgbox(\"True!\")\nEnd if\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>If 1 &gt; 0 then Msgbox(\"True!\")\n</code></pre>\n\n<p>But don't start a new line after <code>then</code>, and not include the <code>End if</code>.</p>\n\n<p>Also, it's better to put <code>Option Explicit</code> before your code and your <code>f</code> variable seems unused -- but that wasn't your question.</p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 10713586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76590c384b9ce3753114d27cfd01256?s=128&d=identicon&r=PG&f=1", "display_name": "Hayk", "link": "https://stackoverflow.com/users/10713586/hayk"}, "edited": false, "score": 0, "creation_date": 1543953853, "post_id": 53508210, "comment_id": 94101609, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1543353184, "creation_date": 1543353184, "answer_id": 53508210, "question_id": 53507503, "link": "https://stackoverflow.com/questions/53507503/multiplying-a-column-based-on-another-column-value/53508210#53508210", "title": "Multiplying a column based on another column value", "body": "<p>So... Whenever you have <code>For</code> you need <code>Next</code>. For <code>If</code> there is a need of <code>End If</code>, unless it is not on the same line. For <code>With</code> there is an <code>End With</code> needed.</p>\n\n<p>Thus, in general, just to get you started somewhere, this works somehow:</p>\n\n<pre><code>Option Explicit\n\nSub Macro()\n    Dim f As Range\n    Dim i As Long\n\n    Set f = Range(\"B2:B5\")\n\n    For i = 2 To 100000\n        With Worksheets(\"Sheet1\")\n            If .Range(\"A\" &amp; i).Value = \"Pavel\" Then\n                .Range(\"B\" &amp; i).Value = .Range(\"B\" &amp; i) * 100\n            End If\n        End With\n    Next i    \nEnd Sub\n</code></pre>\n\n<p>Take a look at the <code>Option Explicit</code> at the top of the code, it is really important and brings your code one level up - <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">MSDN Option Explicit</a>.</p>\n"}], "owner": {"reputation": 47, "user_id": 10713586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c76590c384b9ce3753114d27cfd01256?s=128&d=identicon&r=PG&f=1", "display_name": "Hayk", "link": "https://stackoverflow.com/users/10713586/hayk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53507886, "answer_count": 2, "score": 2, "last_activity_date": 1558295852, "creation_date": 1543350010, "last_edit_date": 1558295852, "question_id": 53507503, "link": "https://stackoverflow.com/questions/53507503/multiplying-a-column-based-on-another-column-value", "title": "Multiplying a column based on another column value", "body": "<p>I am trying to multiply a column of values by 100 based on another column value. I get an error.</p>\n\n<pre><code>Sub macro1()\nDim f As Range\n\nSet f = Range(\"B2:B5\").Value\n\nFor i = 2 To 100000\n    With Sheets(\"Sheet1\")\n        If .Range(\"A\" &amp; i).Value = \"Pavel\" Then\n            .Range(\"B\" &amp; i).Value = f * 100\nNext i\n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "edited": false, "score": 0, "creation_date": 1543349720, "post_id": 53507406, "comment_id": 93884692, "body": "objIE.document.getElementsByName(&quot;Login&quot;)[0].click();"}, {"owner": {"reputation": 162, "user_id": 8774443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34968cf2f584e23f5fe4f1ce0a6e9d68?s=128&d=identicon&r=PG&f=1", "display_name": "Ziggus", "link": "https://stackoverflow.com/users/8774443/ziggus"}, "reply_to_user": {"reputation": 191, "user_id": 10251509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74014bfe136c3d0e9e8eda36316922e6?s=128&d=identicon&r=PG&f=1", "display_name": "Darth Moon", "link": "https://stackoverflow.com/users/10251509/darth-moon"}, "edited": false, "score": 0, "creation_date": 1543350320, "post_id": 53507406, "comment_id": 93884979, "body": "@DarthMoon Syntax error my friend, this is run within Excel using VBA."}], "answers": [{"comments": [{"owner": {"reputation": 162, "user_id": 8774443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34968cf2f584e23f5fe4f1ce0a6e9d68?s=128&d=identicon&r=PG&f=1", "display_name": "Ziggus", "link": "https://stackoverflow.com/users/8774443/ziggus"}, "edited": false, "score": 0, "creation_date": 1543350403, "post_id": 53507450, "comment_id": 93885013, "body": "This worked perfectly and your answer provided multiple different ways to accomplish the task. I appreciate you giving multiple variances, I am sure this answer will help many in the future. Thanks!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1557859783, "last_edit_date": 1557859783, "creation_date": 1543349811, "answer_id": 53507450, "question_id": 53507406, "link": "https://stackoverflow.com/questions/53507406/vba-click-html-button-without-a-name/53507450#53507450", "title": "VBA click HTML button without a name?", "body": "<p>As you state: there is no <code>name</code> attribute in the HTML for the element you show. You can use an <code>attribute = value</code> CSS selector to target the attributes that are present:</p>\n\n<pre><code>objIE.document.querySelector(\"[onclick='submitForm();']\").click\n</code></pre>\n\n<p>Same idea means</p>\n\n<pre><code>objIE.document.querySelector(\"[value=Login]\").click\n</code></pre>\n\n<p>Or even</p>\n\n<pre><code>objIE.document.querySelector(\"[type=submit]\").click\n</code></pre>\n\n<p>Finally, you may be able to submit the form direct with</p>\n\n<pre><code>objIE.document.getElementsByTagName(\"form\")(0).submit\n</code></pre>\n\n<p>If there is more than one element that can be matched on the attribute selector then use <code>.querySelectorAll</code> to retrieve them all and index into the returned nodeList to get the right one e.g.</p>\n\n<pre><code>objIE.document.querySelectorAll(\"[type=submit]\").item(1).click\n</code></pre>\n\n<p>Where 1 in the above would be the second matched. 2 would be the third etc.</p>\n"}], "owner": {"reputation": 162, "user_id": 8774443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34968cf2f584e23f5fe4f1ce0a6e9d68?s=128&d=identicon&r=PG&f=1", "display_name": "Ziggus", "link": "https://stackoverflow.com/users/8774443/ziggus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 1, "accepted_answer_id": 53507450, "answer_count": 1, "score": 1, "last_activity_date": 1557859783, "creation_date": 1543349602, "last_edit_date": 1543350229, "question_id": 53507406, "link": "https://stackoverflow.com/questions/53507406/vba-click-html-button-without-a-name", "title": "VBA click HTML button without a name?", "body": "<p>I am attempting to click this login button on a website using VBA, here is the HTML for the button:</p>\n\n<pre><code>&lt;input type=\"submit\" value=\"Login\" onclick=\"submitForm();\"&gt;\n</code></pre>\n\n<p>I have already got it to the point where it enters my username and password as those fields had names but I am unable to get it to click this button as it does not have a name. I have been searching and either I do not know what I am looking for or this must not be that common of an issue. Here is my latest attempt:</p>\n\n<pre><code>objIE.document.getElementsByName(\"Login\")(0).Click\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5173, "user_id": 1981088, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Iicg.png?s=128&g=1", "display_name": "help-info.de", "link": "https://stackoverflow.com/users/1981088/help-info-de"}, "edited": false, "score": 0, "creation_date": 1543349684, "post_id": 53507360, "comment_id": 93884672, "body": "Welcome to Stack Overflow! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read through the <a href=\"http://stackoverflow.com/help\">help center</a>, in particular how to ask. Your best bet here is to do your research, search for related topics on SO, and give it a go. After doing more research and searching, post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> of your attempt and say specifically where you&#39;re stuck, which can help you get better answers."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543350486, "post_id": 53507360, "comment_id": 93885049, "body": "Are you looking for <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.hpagebreaks.add\" rel=\"nofollow noreferrer\"><code>HPageBreaks.Add</code></a>? <code>PageSetup</code> doesn&#39;t have a <code>HPageBreak</code> property."}, {"owner": {"reputation": 1, "user_id": 4174427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71a798b5e47508032e763c846d026c7?s=128&d=identicon&r=PG&f=1", "display_name": "GlenAllan", "link": "https://stackoverflow.com/users/4174427/glenallan"}, "edited": false, "score": 0, "creation_date": 1543350676, "post_id": 53507360, "comment_id": 93885134, "body": "yes. i am trying to use hpagebreaks property"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1543351167, "creation_date": 1543351167, "answer_id": 53507768, "question_id": 53507360, "link": "https://stackoverflow.com/questions/53507360/horizontal-page-break/53507768#53507768", "title": "horizontal page break", "body": "<p><code>PageSetup</code> doesn't have an <code>HPageBreak</code> property.</p>\n\n<p>If you're adding an <code>HPageBreak</code>, perhaps use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.hpagebreaks.add\" rel=\"nofollow noreferrer\"><code>HPageBreaks.Add</code></a>:</p>\n\n<pre><code>Sub test()\n    Dim numrows As Long, numrows2 As Long\n\n    numrows = 20\n    numrows2 = 10\n\n    With Sheets(\"offer_Sheet\")\n        .HPageBreaks.Add (.Range(\"A\" &amp; numrows2))\n\n        With .PageSetup\n            .PrintArea = (\"A2:H\" &amp; numrows)\n            .FitToPagesWide = 1\n            .FitToPagesTall = 2\n            .LeftMargin = Application.InchesToPoints(0.1)\n            .RightMargin = Application.InchesToPoints(0.1)\n            .TopMargin = Application.InchesToPoints(0.1)\n            .BottomMargin = Application.InchesToPoints(0.1)\n            .HeaderMargin = Application.InchesToPoints(0.1)\n            .FooterMargin = Application.InchesToPoints(0.1)\n            .Orientation = xlPortrait\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Or if you're modifying an existing <code>HPageBreak</code>, perhaps:</p>\n\n<pre><code>Sub test2()\n    Dim numrows As Long, numrows2 As Long\n\n    numrows = 20\n    numrows2 = 11\n\n    With Sheets(\"offer_Sheet\")\n        If .HPageBreaks.Count &gt; 0 Then\n            Set .HPageBreaks(1).Location = .Range(\"A\" &amp; numrows2)\n        End If\n\n        With .PageSetup\n            .PrintArea = (\"A2:H\" &amp; numrows)\n            .FitToPagesWide = 1\n            .FitToPagesTall = 2\n            .LeftMargin = Application.InchesToPoints(0.1)\n            .RightMargin = Application.InchesToPoints(0.1)\n            .TopMargin = Application.InchesToPoints(0.1)\n            .BottomMargin = Application.InchesToPoints(0.1)\n            .HeaderMargin = Application.InchesToPoints(0.1)\n            .FooterMargin = Application.InchesToPoints(0.1)\n            .Orientation = xlPortrait\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4174427, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71a798b5e47508032e763c846d026c7?s=128&d=identicon&r=PG&f=1", "display_name": "GlenAllan", "link": "https://stackoverflow.com/users/4174427/glenallan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543351167, "creation_date": 1543349335, "question_id": 53507360, "link": "https://stackoverflow.com/questions/53507360/horizontal-page-break", "title": "horizontal page break", "body": "<p>attempting to print PDF that are 2 pages tall, with page breaks at row number \"numrows2\" bu receiving </p>\n\n<pre><code>With Sheets(\"offer_Sheet\").PageSetup\n    .PrintArea = (\"A2:H\" &amp; numrows)\n    .HPageBreak.Location = (\"A: \" &amp; numrows2)\n    .FitToPagesWide = 1\n    .FitToPagesTall = 2\n    .LeftMargin = Application.InchesToPoints(0.1)\n    .RightMargin = Application.InchesToPoints(0.1)\n    .TopMargin = Application.InchesToPoints(0.1)\n    .BottomMargin = Application.InchesToPoints(0.1)\n    .HeaderMargin = Application.InchesToPoints(0.1)\n    .FooterMargin = Application.InchesToPoints(0.1)\n    .Orientation = xlPortrait\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "edited": false, "score": 0, "creation_date": 1543350034, "post_id": 53507325, "comment_id": 93884848, "body": "If i understood your question you can control the string also with length so you get only the desiderate value..."}], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 8081945, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21cee0e18913f91d944f3d90807f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "babz", "link": "https://stackoverflow.com/users/8081945/babz"}, "edited": false, "score": 0, "creation_date": 1543355594, "post_id": 53507484, "comment_id": 93887348, "body": "Thanks Scott- this works only for the cases that only have 1 value in the cell and fails (#VALUE! error) for cases where there are multiple entries in the same cell. Posting a better example in the answers*"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1543357313, "last_edit_date": 1543357313, "creation_date": 1543349953, "answer_id": 53507484, "question_id": 53507325, "link": "https://stackoverflow.com/questions/53507325/vba-splitting-cell-by-new-line-in-a-loop/53507484#53507484", "title": "VBA splitting cell by new line in a loop", "body": "<p>you can split the string and loop that.</p>\n\n<pre><code>Function newFunc(Search_string As String, Search_in_col As Range, Return_val_col As Range) As String\n\n\n    If Search_in_col.Cells.Count &lt;&gt; Return_val_col.Cells.Count Then Exit Function\n\n    Dim sptStr() As String\n    sptStr = Split(Search_string, Chr(10))\n\n    Dim srchArr() As Variant\n    srchArr = Search_in_col.Value\n\n    Dim RetArr() As Variant\n    RetArr = Return_val_col.Value\n\n    Dim i As Long\n    For i = LBound(sptStr) To UBound(sptStr)\n        Dim j As Long\n        For j = LBound(srchArr, 1) To UBound(srchArr, 1)\n            If srchArr(j, 1) = sptStr(i) Then\n                newFunc = newFunc &amp; RetArr(j, 1) &amp; \", \"\n            End If\n        Next j\n    Next i\n\n    newFunc = Left(newFunc, Len(newFunc) - 2)\n\n\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cT1kF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cT1kF.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>As per the new information:</p>\n\n<pre><code>Function newFunc(Search_string As String, Search_in_col As Range, Return_val_col As Range) As String\n\n    Search_string = \"|\" &amp; Search_string &amp; \"|\"\n\n    Dim srchArr() As Variant\n    srchArr = Search_in_col.Value\n\n    Dim RetArr() As Variant\n    RetArr = Return_val_col.Value\n\n    Dim i As Long\n    For i = LBound(srchArr, 1) To UBound(srchArr, 1)\n        Dim T As String\n        T = \"|\" &amp; Replace(srchArr(i, 1), Chr(10), \"|\") &amp; \"|\"\n\n        If InStr(T, Search_string) &gt; 0 Then\n              newFunc = newFunc &amp; RetArr(i, 1) &amp; \", \"\n        End If\n\n    Next i\n\n    newFunc = Left(newFunc, Len(newFunc) - 2)\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QnGXT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QnGXT.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1543358636, "post_id": 53509158, "comment_id": 93888626, "body": "The only issue is if the column order changes then the OP would need to change the code.  But otherwise short and simple."}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 2, "last_activity_date": 1543357457, "creation_date": 1543357457, "answer_id": 53509158, "question_id": 53507325, "link": "https://stackoverflow.com/questions/53507325/vba-splitting-cell-by-new-line-in-a-loop/53509158#53509158", "title": "VBA splitting cell by new line in a loop", "body": "<p>You can use regular expressions which have a word boundary token.\nThe following seems to reproduce what you show in your example:</p>\n\n<pre><code>Option Explicit\n'Set reference to Microsoft VBScript Regular Expressions 5.5\nFunction col_return(lookFor As String, lookIn As Range) As String\n    Dim RE As RegExp\n    Dim C As Range\n    Dim S As String\n\nSet RE = New RegExp\nWith RE\n    .Global = True\n    .IgnoreCase = True 'unless you want case sensitive searches\n    For Each C In lookIn\n        .Pattern = \"\\b(\" &amp; lookFor &amp; \")\\b\"\n        If .Test(C.Text) = True Then\n            S = S &amp; \",\" &amp; C.Offset(0, -1)\n        End If\n    Next C\nEnd With\n\ncol_return = Mid(S, 2)\n\nEnd Function\n</code></pre>\n\n<p>I used early binding, which means you set a reference in VBA as noted in the comments.</p>\n\n<p>You can use late-binding and avoid the reference.  To do that you would change to the DIM and Set lines for RE to:</p>\n\n<pre><code>DIM RE as Object\n\nSet RE = createobject(\"vbscript.regexp\")\n</code></pre>\n\n<p>You can read about early vs late-binding by doing an internet search.</p>\n\n<p>The formula I used and the layout is in the screenshot below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/J5lSc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J5lSc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 429, "user_id": 8081945, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21cee0e18913f91d944f3d90807f5a91?s=128&d=identicon&r=PG&f=1", "display_name": "babz", "link": "https://stackoverflow.com/users/8081945/babz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1582779583, "creation_date": 1543349181, "last_edit_date": 1582779583, "question_id": 53507325, "link": "https://stackoverflow.com/questions/53507325/vba-splitting-cell-by-new-line-in-a-loop", "title": "VBA splitting cell by new line in a loop", "body": "<p>New to VBA, trying to create a function that essentially searches a column for certain values. If it finds a hit then it returns a corresponding column, else returns a space. The way the worksheet is formatted, one cell can have multiple values (separated by ALT+ENTER, so each new value is on a separate line).</p>\n\n<p>The code I used currently works but has an issue:\nSince I am using inStr the code is returning partial matches as well (which I do not want).</p>\n\n<pre><code>Example:\n**Column to Search (one cell)**\nABC\nAB\nB\n</code></pre>\n\n<p>When I run the code to find AB, it will return hits for both AB and ABC since AB is part of it. </p>\n\n<p>Ideal solution would be to first split the cells based on ALT+ENTER and loop through all values per cell and then return the desired value. But not how the syntax would look. </p>\n\n<p><strong>Current Code</strong></p>\n\n<pre><code>Function newFunc(Search_string As String, Search_in_col As Range, Return_val_col As Range)\n\nDim i As Long\nDim result As String\nDim mRange As Range\nDim mValue As String\n\nFor i = 1 To Search_in_col.Count\n\n    If InStr(1, Search_in_col.Cells(i, 1).Text, Search_string) &lt;&gt; 0 Then\n          If (Return_val_col.Cells(i, 1).MergeCells) Then\n\n            Set mRange = Return_val_col.Cells(i, 1).MergeArea\n            mValue = mRange.Cells(1).Value\n\n            result = result &amp; mValue &amp; \", \"\n        Else\n            result = result &amp; Return_val_col.Cells(i, 1).Value &amp; \", \"\n        End If\n    End If\n\nNext \n</code></pre>\n\n<p>Example:\nAdding an example to better explain the situation</p>\n\n<p><a href=\"https://i.stack.imgur.com/JTpXa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JTpXa.png\" alt=\"example\"></a></p>\n"}, {"tags": ["vba", "ms-word", "highlight"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1543348415, "post_id": 53507112, "comment_id": 93884051, "body": "Your title and tags mention VBA. Have you tried anything yet, including the macro recorder? Even sharing recorded code will avoid others having to recreate from scratch."}, {"owner": {"reputation": 1, "user_id": 10713540, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U9YlYmsT_Ys/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j_4pLTkjL0D-W8AQPF3-FNgZ0VYw/mo/photo.jpg?sz=128", "display_name": "Mike Duffy", "link": "https://stackoverflow.com/users/10713540/mike-duffy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543359518, "post_id": 53507112, "comment_id": 93888936, "body": "No code yet, as I can&#39;t figure out where to insert the code for each piece of &quot;extracted&quot; text. I can run the macro recorder as I perform the above steps, but not sure how to format it here - as this is my first post."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543359842, "post_id": 53507112, "comment_id": 93889035, "body": "Just <a href=\"https://stackoverflow.com/posts/53507112/edit\">edit</a> your post with the code and use the braces or Ctrl-K to format."}, {"owner": {"reputation": 1, "user_id": 10713540, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U9YlYmsT_Ys/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j_4pLTkjL0D-W8AQPF3-FNgZ0VYw/mo/photo.jpg?sz=128", "display_name": "Mike Duffy", "link": "https://stackoverflow.com/users/10713540/mike-duffy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543430668, "post_id": 53507112, "comment_id": 93921028, "body": "Thanks BigBen... I have this noted for future posts."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10713540, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U9YlYmsT_Ys/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j_4pLTkjL0D-W8AQPF3-FNgZ0VYw/mo/photo.jpg?sz=128", "display_name": "Mike Duffy", "link": "https://stackoverflow.com/users/10713540/mike-duffy"}, "edited": false, "score": 0, "creation_date": 1543430607, "post_id": 53512761, "comment_id": 93920993, "body": "This is great! Thanks for the post... it almost works the way I&#39;m looking for - the only missing piece is the pipe at the end of each selection. Would you be able to post a code update? Thanks so much!"}, {"owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "reply_to_user": {"reputation": 1, "user_id": 10713540, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U9YlYmsT_Ys/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j_4pLTkjL0D-W8AQPF3-FNgZ0VYw/mo/photo.jpg?sz=128", "display_name": "Mike Duffy", "link": "https://stackoverflow.com/users/10713540/mike-duffy"}, "edited": false, "score": 0, "creation_date": 1543431770, "post_id": 53512761, "comment_id": 93921581, "body": "@MikeDuffy - just add &amp; &quot; | &quot; after rng.Text"}], "tags": [], "owner": {"reputation": 2320, "user_id": 4017932, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061853192/picture?type=large", "display_name": "Michal Rosa", "link": "https://stackoverflow.com/users/4017932/michal-rosa"}, "is_accepted": false, "score": -1, "last_activity_date": 1543383292, "creation_date": 1543383292, "answer_id": 53512761, "question_id": 53507112, "link": "https://stackoverflow.com/questions/53507112/how-to-insert-character-before-and-after-highlighted-text-in-word-with-vba/53512761#53512761", "title": "How to insert character before and after highlighted text in WORD with VBA", "body": "<p>You could try something like the following code:</p>\n\n<pre><code>Sub CopyHighlightedText()\n\n    Dim rng As Range\n    Dim str As String\n\n    Set rng = ActiveDocument.Range\n\n    With rng.Find\n\n        .ClearFormatting\n        .Highlight = True\n\n        While .Execute(Forward:=True, Format:=True)\n            str = str &amp; \" | \" &amp; rng.Text\n        Wend\n\n    End With\n\n    Documents.Add DocumentType:=wdNewBlankDocument\n    Selection.TypeText Text:=str\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10713540, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U9YlYmsT_Ys/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-j_4pLTkjL0D-W8AQPF3-FNgZ0VYw/mo/photo.jpg?sz=128", "display_name": "Mike Duffy", "link": "https://stackoverflow.com/users/10713540/mike-duffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1543406056, "creation_date": 1543348308, "last_edit_date": 1543406056, "question_id": 53507112, "link": "https://stackoverflow.com/questions/53507112/how-to-insert-character-before-and-after-highlighted-text-in-word-with-vba", "title": "How to insert character before and after highlighted text in WORD with VBA", "body": "<p>I have some highlighted sections in a WORD document that I'm looking to aggregate into a new document, but I'd like to insert a pipe (shift backslash) before and after each unique highlighted section to facilitate import into another program.</p>\n\n<p>I've been able to select and copy these highlighted sections into the new document with the following process:</p>\n\n<p>Find > Advanced Find > More > Format > Highlight > Find in > Main Document > Close > Ctl+C > Ctl+N > Ctl+V</p>\n\n<p>That process puts all of just my highlighted text into a new document.</p>\n\n<p>My end goal is to have those same highlighted sections surrounded by the pipe characters.</p>\n\n<p>I hope this clearly explains my \"end game\". Thanks in advance for the help!</p>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 2, "creation_date": 1543346417, "post_id": 53506583, "comment_id": 93883117, "body": "Choose debug and execute in Immediate window <code>? objDoc.getElementsByName([Name]).length</code> to check found nodes count."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1543346730, "post_id": 53506583, "comment_id": 93883250, "body": "Do you have a reference set to <code>Microsoft Internet Controls</code>?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1543350377, "post_id": 53506583, "comment_id": 93884997, "body": "Worth sharing relevant HTML if possible as well to make this more useful to future readers and aide in debugging."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10713321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1080e1cc90b93b76fbe9012776ea7e?s=128&d=identicon&r=PG&f=1", "display_name": "sifyoshi", "link": "https://stackoverflow.com/users/10713321/sifyoshi"}, "edited": false, "score": 0, "creation_date": 1543350415, "post_id": 53506915, "comment_id": 93885018, "body": "Thanks, looks like that is the issue, there isn&#39;t an element with that name in the document when getElementsbyName is called."}], "tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 0, "last_activity_date": 1543347445, "creation_date": 1543347445, "answer_id": 53506915, "question_id": 53506583, "link": "https://stackoverflow.com/questions/53506583/vba-for-each-and-with-block-object-variable-or-with-block-variable-not-set-error/53506915#53506915", "title": "VBA For Each and With Block Object Variable or With Block Variable not set Error 91", "body": "<p><code>objDoc</code> isn't the object variable causing the error. <code>getElementsByName</code> returns a <code>NodeList</code> object (a collection of <code>Nodes</code>) and <code>getElementByName(...)(0)</code> return a <code>Node</code> object. That's the object \"variable\" that's causing the error (very misleadingly as it's not a variable at all).</p>\n\n<p>@omegastripes comment to check the <code>.length</code> property of the <code>NodeList</code> is the correct first step. Then I think you'll find that you either misspelled the name or there isn't an element with that name in the document.</p>\n"}], "owner": {"reputation": 13, "user_id": 10713321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1080e1cc90b93b76fbe9012776ea7e?s=128&d=identicon&r=PG&f=1", "display_name": "sifyoshi", "link": "https://stackoverflow.com/users/10713321/sifyoshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 53506915, "answer_count": 1, "score": 1, "last_activity_date": 1582520489, "creation_date": 1543345897, "last_edit_date": 1582520489, "question_id": 53506583, "link": "https://stackoverflow.com/questions/53506583/vba-for-each-and-with-block-object-variable-or-with-block-variable-not-set-error", "title": "VBA For Each and With Block Object Variable or With Block Variable not set Error 91", "body": "<p>I am trying to use VBA to populate a HTML table in a webpage in Internet Explorer. I am using the following code to try and input one value; the fields have unique names:</p>\n\n<pre><code>Dim objShellWins As SHDocVw.ShellWindows\nDim objIE As InternetExplorer\nDim objDoc As Object\n\nFor Each objIE In objShellWins   'Look at IE &amp; Windows Explorer objects in shell\n    With objIE\n        'Look for URL matching strURL\n        If (InStr(1, .LocationURL, [URL], vbTextCompare)) Then\n            Set objDoc = .Document\n            If (InStr(1, objDoc.Title, [Title], vbTextCompare)) Then\n                objDoc.getElementsByName([Name])(0).Value = \"Value\"\n            End If\n        End If\n    End With\nNext\n</code></pre>\n\n<p>I am getting Error 91: Object Variable or With Block Variable Not Set on the objDoc.getElementsByName line, yet objDoc.Title returns the proper string. Any thoughts on how I can fix this? </p>\n"}, {"tags": ["arrays", "excel", "vba", "parameters", "interface"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543347615, "post_id": 53506562, "comment_id": 93883662, "body": "Typed arrays are a PITA. Pass them as <code>Variant</code>, validate the parameter with <code>IsArray</code>, then validate that each element <code>Is ITest1</code>. Interface is a red herring, you&#39;d get a &quot;byref argument type mismatch&quot; trying to pass a <code>String()</code> too."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543348544, "post_id": 53506562, "comment_id": 93884106, "body": "Another alternative (arguably more idiomatic) would be to implement a custom collection class. You&#39;ll need a default <code>Item</code> property (getter with <code>VB_UserMemId=0</code> attribute), and a <code>NewEnum As IUnknown</code> property getter with <code>VB_UserMemId=-4</code> attribute. That property is easier to implement when your collection class is wrapping a <code>Collection</code> though: you can just return <code>internalCollection.[_NewEnum]</code>, a hidden property that returns exactly what you need there."}, {"owner": {"reputation": 4944, "user_id": 6340948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddf99c24b0bebc05681a2119286b120?s=128&d=identicon&r=PG&f=1", "display_name": "Ister", "link": "https://stackoverflow.com/users/6340948/ister"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1543350612, "post_id": 53506562, "comment_id": 93885108, "body": "Thanks @MathieuGuindon . The funny part of the story is that I&#39;ve built an interfaceish solution without using interfaces, entirely based on Variants. It worked nicely but in a normal programming language an interface helps maintain a nice, clean code etc... I was stupid enough to think that a language claiming to be object oriented but without class inheritance can reasonably handle interfaces and refactoring is a good idea."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1543363585, "post_id": 53506562, "comment_id": 93890071, "body": "Food for thought: C# is fully OOP and doesn&#39;t let you pass a <code>List&lt;Foo&gt;</code> to a method that accepts a <code>List&lt;IFoo&gt;</code>. <a href=\"https://stackoverflow.com/q/6902157/1188513\">stackoverflow.com/q/6902157/1188513</a>"}], "owner": {"reputation": 4944, "user_id": 6340948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ddf99c24b0bebc05681a2119286b120?s=128&d=identicon&r=PG&f=1", "display_name": "Ister", "link": "https://stackoverflow.com/users/6340948/ister"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1543345807, "creation_date": 1543345807, "last_edit_date": 1592644375, "question_id": 53506562, "link": "https://stackoverflow.com/questions/53506562/passing-an-array-typed-with-a-class-implementing-an-interface-when-a-function-pr", "title": "Passing an array typed with a class implementing an interface when a function/procedure expects an array typed with the interface?", "body": "<p>Let's say I have an interface <em>ITest1</em> defined:</p>\n<pre><code>Option Explicit\n\nSub it1Test(cTest As ITest1)\nEnd Sub\n</code></pre>\n<p>And then I built a class <em>CTest1</em> that implements it:</p>\n<pre><code>Option Explicit\n\nImplements ITest1\n\nPrivate Sub ITest1_it1Test(cTest As ITest1)\nEnd Sub\n\nPrivate Sub Test1()\n    Dim cT1 As CTest1\n    cT1 = New CTest1\n    ITest1_it1Test cT1\nEnd Sub\n</code></pre>\n<p>If I try compiling this code everything works perfectly fine, which in general is what I expect.</p>\n<p>But then in my not so simple world, rather than passing a single element I want to pass a whole array.</p>\n<p>So my new interface <em>ITest2</em> looks like this</p>\n<pre><code>Option Explicit\n\nSub it2Test(cTest() As ITest2)\nEnd Sub\n</code></pre>\n<p>And a class <em>CTest2</em> implementing it:</p>\n<pre><code>Option Explicit\n\nImplements ITest1\n\nPrivate Sub ITest1_it1Test(cTest() As ITest1)\nEnd Sub\n\nPrivate Sub Test2()\n    Dim cT2(1 To 1) As CTest2\n    cT2(1) = New CTest2\n    ITest2_it2Test cT2\nEnd Sub\n</code></pre>\n<p>This time I am not able to compile with an error:</p>\n<blockquote>\n<p>Compile error:</p>\n<p>ByRef argument type mismatch</p>\n</blockquote>\n<p>with highlighted the cT2 parameter of function ITest2_it2Test as the source of error.</p>\n<p>Is there any way to pass an array of class implementing an interface if the function expects array of type of that interface. In other words does it make sense to use interface as a type of array parameter?</p>\n<p>I'm aware that it is possible to use Variant as an array type but it undermines plenty of benefits that I have thanks to the use of interface.</p>\n<p>I can't find anything related to such specific case. I have checked number of pages about ways to implement interfaces in general (from MS docs to CPearson page). I can't also find anything here on Stack Overflow. I have checked all 78 questions tagged vba and excel with keywords interface and array and some of the suggested questions.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1543345543, "post_id": 53506376, "comment_id": 93882693, "body": "should be <code>If headers(1, iheaders) = SR(1, iSR) Then</code> the problem is that the <code>headers</code> array only has a single row, but you put the variable in the row field instead of the column field."}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1543345980, "post_id": 53506376, "comment_id": 93882894, "body": "Thank you. That fixed it, although now I get a subscript error later on at <code>R(iSR, 1) = SR(5, iSR)</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1543346557, "post_id": 53506376, "comment_id": 93883183, "body": "you need to change how you redim <code>R</code>: <code>ReDim R(1 To UBound(SR, 2), 1 To 1)</code>"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1543346793, "post_id": 53506376, "comment_id": 93883280, "body": "Caught it :P, thanks. One last question.. I am assigning all these values to R.. then when I paste R (<code>.Range(&quot;B&quot; &amp; lastrow + 1 &amp; &quot;:&quot; &amp; &quot;H&quot; &amp; lastrow + 1).Value = R</code>) it only uses the first match value and pastes that across in this range."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1543346988, "post_id": 53506376, "comment_id": 93883350, "body": "<code>.Range(&quot;B&quot; &amp; lastrow + 1 &amp; &quot;:&quot; &amp; &quot;H&quot; &amp; lastrow + 1).Value = Application.Transpose(R)</code>"}, {"owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1543350922, "post_id": 53506376, "comment_id": 93885252, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/184349/discussion-between-excelguy-and-tigeravatar\">continue this discussion in chat</a>."}], "owner": {"reputation": 1245, "user_id": 8462962, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/78712f98200d7713ac696675bbb57d59?s=128&d=identicon&r=PG&f=1", "display_name": "excelguy", "link": "https://stackoverflow.com/users/8462962/excelguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1582779599, "creation_date": 1543344967, "last_edit_date": 1582779599, "question_id": 53506376, "link": "https://stackoverflow.com/questions/53506376/vba-for-loop-subscript-out-of-range-on-second-loop", "title": "VBA, For Loop , subscript out of range on second loop", "body": "<p>I am getting an error at <code>If headers(iheaders, 1) = SR(1, iSR) Then</code>   First loop works fine. Then Second loop I get <code>subscript out of range</code>. But I notice it always loops back to <code>For iSR = 1 To UBound(SR, 2)</code> instead of <code>For iheaders = 1 To UBound(headers, 2)</code>.</p>\n\n<p><strong>what the code does:</strong></p>\n\n<p>Headers on sheet A are supposed to match with those on Sheet B. They are both Horizontal headers.\n where there is a match , assign the 5th row of SR to my variable <code>R</code>. </p>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>Const FirstMatch As Boolean = True\nDim lastrow As Long\nDim SR As Variant\nDim iSR As Integer\nDim R As Variant\nDim headers As Variant\nDim iheaders As Integer\n\n    SR = Worksheets(\"Sheet A\").Range(\"D3:J7\").Value  \n    headers = Worksheets(\"Sheet B\").Range(\"B1:H1\").Value\n\n    With Worksheets(\"Sheet B\")\n\n        ReDim R(1 To UBound(SR), 1 To 1)\n\n    For iheaders = 1 To UBound(headers, 2)\n\n        For iSR = 1 To UBound(SR, 2)\n\n            If headers(iheaders, 1) = SR(1, iSR) Then\n\n            R(iSR, 1) = SR(5, iSR)\n\n                If FirstMatch Then\n\n                     Exit For\n\n                 End If\n\n            End If\n\n        Next\n\n    Next\n\n\n    'Populate R to where I want on Total Page\n\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543344989, "post_id": 53506256, "comment_id": 93882406, "body": "<a href=\"https://stackoverflow.com/questions/43548543/how-to-check-whether-connection-refresh-was-successful\">This question</a> might be helpful."}, {"owner": {"reputation": 11, "user_id": 10713218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/923369a71b967f39092c326beb80c678?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo C.", "link": "https://stackoverflow.com/users/10713218/lorenzo-c"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543345881, "post_id": 53506256, "comment_id": 93882849, "body": "Hey @BigBen, sorry but I don&#39;t have any <b>QueryTable</b> in my WorkBook. I have used the PowerQuery to bring the data, it&#39;s a different situation. I have tried that solution before, does not work."}, {"owner": {"reputation": 11, "user_id": 10713218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/923369a71b967f39092c326beb80c678?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo C.", "link": "https://stackoverflow.com/users/10713218/lorenzo-c"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543347287, "post_id": 53506256, "comment_id": 93883494, "body": "@BigBen can you uncheck the duplicate?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543347324, "post_id": 53506256, "comment_id": 93883514, "body": "I cannot, @Matthieu Guindon marked it as duplicate."}], "owner": {"reputation": 11, "user_id": 10713218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/923369a71b967f39092c326beb80c678?s=128&d=identicon&r=PG&f=1", "display_name": "Lorenzo C.", "link": "https://stackoverflow.com/users/10713218/lorenzo-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "closed_date": 1543345468, "answer_count": 0, "score": 1, "last_activity_date": 1582779610, "creation_date": 1543344485, "last_edit_date": 1582779610, "question_id": 53506256, "link": "https://stackoverflow.com/questions/53506256/check-if-query-connection-was-successfully-refreshed-on-vba", "closed_reason": "Duplicate", "title": "Check if Query Connection was successfully refreshed on VBA", "body": "<p>I'm using Excel 2016, and my WorkBook has several Queries connected to a SQL database in a server.</p>\n\n<p>I am refreshing all the connections of my workbook using the following code:</p>\n\n<pre><code>For Each objConnection In ThisWorkbook.Connections\n\n    objConnection.Refresh\n\nNext\n</code></pre>\n\n<p>And then I update a cell with the latest date that it was updated with the following:</p>\n\n<pre><code>worksheetControl.Range(\"UpdateDate\") = Format(Now(), \"yyyy-MM-dd\")\n</code></pre>\n\n<p>But sometimes Refresh fails because of a bad internet connection, VPN not properly set, or something else. So in this case I wouldn't want to update my cell.</p>\n\n<p>How can I check if my Refresh was successful for all the connections?</p>\n\n<p>The solution provided should use the method RefreshAll instead. Because it is faster than iterating over each connection, so it would be the preferred method.</p>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1543342280, "post_id": 53505583, "comment_id": 93881000, "body": "Try using <code>-4121</code> instead of <code>xlDown</code>."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1543350922, "post_id": 53505583, "comment_id": 93885251, "body": "@BigBen wouldn&#39;t encourage the use of &quot;magic numbers&quot;, just define the constant in the code <code>Const xlDown = -4121</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 2, "creation_date": 1543351047, "post_id": 53505583, "comment_id": 93885302, "body": "@Lankymart agreed, much cleaner."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1543342464, "post_id": 53505717, "comment_id": 93881104, "body": "@IGRACH Here&#39;s the specific <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xldirection\" rel=\"nofollow noreferrer\">link</a> for the <code>xlDirection</code> enum."}, {"owner": {"reputation": 3016, "user_id": 1926221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GafDJ.jpg?s=128&g=1", "display_name": "IGRACH", "link": "https://stackoverflow.com/users/1926221/igrach"}, "edited": false, "score": 0, "creation_date": 1543343575, "post_id": 53505717, "comment_id": 93881707, "body": "It&#39;s still not selecting.   <code>objExcel.Workbooks(File_Name).Activate   objExcel.Range(&quot;A5&quot;).select   objExcel.Range(Selection, Selection.End(-4121)).Select i</code>   Its not going passed <code>objExcel.Range(&quot;A5&quot;).select</code> line."}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 1, "creation_date": 1543350803, "post_id": 53505717, "comment_id": 93885203, "body": "Not the first time this has <a href=\"https://stackoverflow.com/a/14019338/692942\">been answered</a>. Even had to dup flag <a href=\"https://stackoverflow.com/a/39956808/692942\">one of my own</a> over two years ago. Not surprising seen as though VBScript has been around twenty plus years."}], "tags": [], "owner": {"reputation": 4190, "user_id": 6255978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd9f928c263c57925ad9f4703612e9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dave", "link": "https://stackoverflow.com/users/6255978/dave"}, "is_accepted": true, "score": 1, "last_activity_date": 1543342303, "creation_date": 1543342303, "answer_id": 53505717, "question_id": 53505583, "link": "https://stackoverflow.com/questions/53505583/selecting-excel-cells-with-data-in-vbscript/53505717#53505717", "title": "Selecting Excel Cells with data in VBScript", "body": "<p><code>VBScript</code> doesn't understand the constants used by the <code>VBA</code> setup such as <code>xlDown</code>.</p>\n\n<p>You need to reference the actual value for <code>xlDown</code> instead, which you can get from the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel(enumerations)\" rel=\"nofollow noreferrer\">MS Docs site</a></p>\n\n<p>In this specific instance you mention, the constant value is <code>-4121</code> so your command in <code>vbscript</code> would be:</p>\n\n<pre><code>objExcel.Range(Selection, Selection.End(-4121)).Select i\n</code></pre>\n\n<p>However, you should always try to avoid using Select in VBA/VBScript due to the performance hit, check <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a> for more info</p>\n"}, {"tags": [], "owner": {"reputation": 3016, "user_id": 1926221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GafDJ.jpg?s=128&g=1", "display_name": "IGRACH", "link": "https://stackoverflow.com/users/1926221/igrach"}, "is_accepted": false, "score": 1, "last_activity_date": 1543433655, "last_edit_date": 1543433655, "creation_date": 1543416587, "answer_id": 53522150, "question_id": 53505583, "link": "https://stackoverflow.com/questions/53505583/selecting-excel-cells-with-data-in-vbscript/53522150#53522150", "title": "Selecting Excel Cells with data in VBScript", "body": "<p>I figured it out when I used a test script. </p>\n\n<p>The problem was with xlDirection. The code started working when I started using numbers from the documentation. Also there was an issue was with the <code>Selection</code> keyword in <code>objExcel.Range(Selection, Selection.End(-4121)).Select</code>. It returned <code>Object required:'Selection'</code>. I added <code>objExel.</code> to both instances of <code>Selection</code>:</p>\n\n<p><code>objExcel.Range(objExcel.Selection, objExcel.Selection.End(-4121)).Select</code>. </p>\n\n<p>It's now working as it should.</p>\n"}], "owner": {"reputation": 3016, "user_id": 1926221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/GafDJ.jpg?s=128&g=1", "display_name": "IGRACH", "link": "https://stackoverflow.com/users/1926221/igrach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2722, "favorite_count": 0, "closed_date": 1543416645, "accepted_answer_id": 53505717, "answer_count": 2, "score": -2, "last_activity_date": 1582520501, "creation_date": 1543341732, "last_edit_date": 1582520501, "question_id": 53505583, "link": "https://stackoverflow.com/questions/53505583/selecting-excel-cells-with-data-in-vbscript", "closed_reason": "Duplicate", "title": "Selecting Excel Cells with data in VBScript", "body": "<p>I have been trying to manipulate Excel files with only VBScript code. It's a stand-alone VBScript that is opening and closing excel files. Problem is with <code>Range(Selection, Selection.End(xlDown)).Select</code> code. When I run this code in excel macro it is selecting all rows with continuous data in a particular cell. As I want it to do. Problem is when i try to run this code from VBScript. Type of file is <code>.vbs</code></p>\n\n<p>I have created Excel object: <code>Set objExcel = CreateObject(\"Excel.Application\")</code> inside the script. and code <code>objExcel.Range(\"A5\").select</code> is selecting the right cell. But <code>objExcel.Range(Selection, Selection.End(xlDown)).Select</code> is doing nothing. It is the same functionality when you hold <code>shift + ctrl</code> and press down arrow in excel. When I record macro in excel and run it there are also no problems, the same code is running in VBA normally. Rows are getting selected. Only issue is when I convert that code to stand-alone VBScript that nothing is happening.</p>\n\n<p>I need a way to select continuous cells with data in it. Same like <code>ctrl+shift</code> + down,up,left,right. If you know any other way of achieving it I'm OK with it.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1543343056, "post_id": 53505381, "comment_id": 93881435, "body": "Why are you using INSERT action? Is form bound to table? Are controls bound to fields? If yes, then data entered in controls is passed into table. And why do the INSERT before verifying data?"}, {"owner": {"reputation": 355, "user_id": 6871823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e9bb4ad1cfdd32e4a47b65ba53432d?s=128&d=identicon&r=PG&f=1", "display_name": "geeFlo", "link": "https://stackoverflow.com/users/6871823/geeflo"}, "edited": false, "score": 0, "creation_date": 1543590131, "post_id": 53505381, "comment_id": 93985472, "body": "Yes, that INSERT looks weird.  Why not just form.dirty (or move to next record, or however you save data) after the first IF is confirmed?"}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1543343212, "last_edit_date": 1543343212, "creation_date": 1543342716, "answer_id": 53505831, "question_id": 53505381, "link": "https://stackoverflow.com/questions/53505381/how-do-i-have-a-message-box-appear-when-something-is-entered-in-text-box-and-but/53505831#53505831", "title": "How do I have a message box appear when something is entered in text box and button is pressed?", "body": "<p>One way is to use + sign for concatenating the textboxes. This will result in Null if even one is Null. This approach requires setting text fields in table to not allow empty string.</p>\n\n<pre><code>If  IsNull(txtStudentFirst + txtStudentLast + txtParentFirst + txtParentLast + txtAddress + txtCity + txtState + txtZip + txtNumber) Then\n    MsgBox \"Student was not registered, please complete the form.\", vbOKOnly\nElse\n    MsgBox \"Student was successfully registered.\", vbOKOnly, \"\"\nEnd If\n</code></pre>\n\n<p>Alternatively, set fields as required in table and let Access nag the user to complete. Can also use ValidationRule and ValidationText properties to help ensure data is entered.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10707314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543343212, "creation_date": 1543341000, "question_id": 53505381, "link": "https://stackoverflow.com/questions/53505381/how-do-i-have-a-message-box-appear-when-something-is-entered-in-text-box-and-but", "title": "How do I have a message box appear when something is entered in text box and button is pressed?", "body": "<p>Is it possible to make a pop-up message box to appear when something is written in the textbox? It doesn't matter to me what the text box actually has I just want a message to appear when a button is pressed and there is text in the textbox.</p>\n\n<p>The following is what I currently have:</p>\n\n<pre><code>Private Sub cmdReg_Click()\n\nCurrentDb.Execute \"INSERT INTO qryShowAll(Student_FirstName, Student_LastName, Parent_FirstName, Parent_LastName, AddressLine, City, State, Zip, PhoneNumber) VALUES ('\" &amp; Me.txtStudentFirst &amp; \" ',' \" &amp; Me.txtStudentLast &amp; \"','\" &amp; Me.txtParentFirst &amp; \" ',' \" &amp; Me.txtParentLast &amp; \"','\" &amp; Me.txtAddress &amp; \" ',' \" &amp; Me.txtCity &amp; \"',' \" &amp; Me.txtState &amp; \"','\" &amp; Me.txtZip &amp; \"','\" &amp; Me.txtNumber &amp; \"')\"\n\nIf (txtStudentFirst,txtStudentLast,txtParentFirst,txtParentLast,txtAddress ,txtCity,txtState,txtZip,txtNumber) = \" \"\n\nMsgBox \"The student was successfully registered.\", vbOKOnly, \"Student Registered!\"\n\nElse\nMsgBox \"Student was not registered, please complete the form.\", vbOKOnly, \"\"\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 3, "creation_date": 1543343140, "post_id": 53505365, "comment_id": 93881488, "body": "I would recommend you remove the <code>On Error Resume Next</code> statement. It&#39;s completely masking any and all errors occurring in that section of code. After removing, try running the code again - and see if an actual error message appears."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1543343202, "post_id": 53505365, "comment_id": 93881523, "body": "Also, <code>On Error Resume Next</code> does a fall-through into the &quot;true&quot; section of the if-statement when the error occurs during the if-condition."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1543350443, "post_id": 53505365, "comment_id": 93885030, "body": "<a href=\"https://stackoverflow.com/a/31753321/1571407\">stackoverflow.com/a/31753321/1571407</a>"}, {"owner": {"reputation": 53, "user_id": 10486971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4aa35d576e31b5fd2603664b268f98?s=128&d=identicon&r=PG&f=1", "display_name": "Sharon", "link": "https://stackoverflow.com/users/10486971/sharon"}, "edited": false, "score": 0, "creation_date": 1543353595, "post_id": 53505365, "comment_id": 93886486, "body": "Thanks guys for your suggestion."}, {"owner": {"reputation": 53, "user_id": 10486971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4aa35d576e31b5fd2603664b268f98?s=128&d=identicon&r=PG&f=1", "display_name": "Sharon", "link": "https://stackoverflow.com/users/10486971/sharon"}, "edited": false, "score": 0, "creation_date": 1543354041, "post_id": 53505365, "comment_id": 93886670, "body": "Please look at the edit. The code shows no error but I am not getting the desired result."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1543360882, "post_id": 53505365, "comment_id": 93889332, "body": "Appears you do not know what (ByVal objItem As Object) does. objItem is what has been added to the folder. Refer to it by the correct name, not Item, nor a randomly newly created xMailItem"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 0, "last_activity_date": 1543425624, "creation_date": 1543425624, "answer_id": 53524898, "question_id": 53505365, "link": "https://stackoverflow.com/questions/53505365/how-to-save-outlook-emails-on-the-basis-of-subject-and-sender-name-using-vba/53524898#53524898", "title": "How to save Outlook emails on the basis of subject and sender name, using VBA?", "body": "<p>A suggested If/Else structure with appropriate mailitem.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub InboxItems_ItemAdd(ByVal objItem As Object)\n\n    Dim FSO\n    Dim xMailItem As MailItem\n    Dim xFilePath As String\n    Dim xRegEx\n    Dim xFileName As String\n\n    If objItem.Class = olMail Then\n\n        'objItem could be used directly but this is sometimes beneficial\n        Set xMailItem = objItem\n\n        If (xMailItem.subject Like \"RE:FOR REVIEW*\") Then\n\n            If ((xMailItem.senderName = \"Alpha\") Or _\n                (xMailItem.senderName = \"Beta\") Or _\n                (xMailItem.senderName = \"Gamma\")) Then\n\n                If MsgBox(\"Do you want to save this email?\", vbYesNo + vbQuestion, \"Reminder\") = vbYes Then\n\n                    xFilePath = \"C:\\Users\\abc\\Desktop\\Test\"\n\n                    Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n                    If FSO.FolderExists(xFilePath) = False Then\n                        FSO.CreateFolder (xFilePath)\n                    End If\n\n                    Set xRegEx = CreateObject(\"vbscript.regexp\")\n                    xRegEx.Global = True\n                    xRegEx.IgnoreCase = False\n                    xRegEx.Pattern = \"\\||\\/|\\&lt;|\\&gt;|\"\"|:|\\*|\\\\|\\?\"\n\n                    xFileName = xRegEx.Replace(xMailItem.subject, \"\")\n\n                    xMailItem.SaveAs xFilePath &amp; \"\\\" &amp; xFileName &amp; \".html\", olHTML\n\n                End If\n\n            End If\n\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10486971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a4aa35d576e31b5fd2603664b268f98?s=128&d=identicon&r=PG&f=1", "display_name": "Sharon", "link": "https://stackoverflow.com/users/10486971/sharon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 740, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546961957, "creation_date": 1543340916, "last_edit_date": 1546961957, "question_id": 53505365, "link": "https://stackoverflow.com/questions/53505365/how-to-save-outlook-emails-on-the-basis-of-subject-and-sender-name-using-vba", "title": "How to save Outlook emails on the basis of subject and sender name, using VBA?", "body": "<p>I need to save, in a desktop folder, emails which match the following conditions:</p>\n\n<ol>\n<li>Subject starts with RE: FOR REVIEW</li>\n<li>Sender Names are: Alpha, Beta or Gamma (example)</li>\n</ol>\n\n<p>If both of these conditions are met, a Yes/No MsgBox should pop up.</p>\n\n<p>Code:</p>\n\n<pre><code>Private WithEvents InboxItems As Outlook.Items\nSub Application_Startup()\nDim xNameSpace As Outlook.NameSpace\nSet xNameSpace = Outlook.Application.Session\nSet InboxItems = xNameSpace.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub InboxItems_ItemAdd(ByVal objItem As Object)\n Dim FSO\n Dim xMailItem As Outlook.MailItem\n Dim xFilePath As String\n Dim xRegEx\n Dim xFileName As String\n Dim Output As String\n Dim Item As Object\n On Error Resume Next\n\n  If (Item.Subject Like \"RE:FOR REVIEW*\") And ((Item.SenderName = \"Alpha\") Or (Item.SenderName = \"Beta\") or (Item.SenderName = \"Gamma\") ) Then\n   Output = MsgBox(\"Do you want to save this email?\", vbYesNo + vbQuestion, \"Reminder\")\n   If Output = vbNo Then Exit Sub\n    Else\n     xFilePath = CreateObject(\"WScript.Shell\").SpecialFolders(16)\n     xFilePath = \"C:\\Users\\ABC\\Desktop\\Test\"\n     Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n     If FSO.FolderExists(xFilePath) = False Then\n      FSO.CreateFolder (xFilePath)\n     End If\n     Set xRegEx = CreateObject(\"vbscript.regexp\")\n    xRegEx.Global = True\n    xRegEx.IgnoreCase = False\n    xRegEx.Pattern = \"\\||\\/|\\&lt;|\\&gt;|\"\"|:|\\*|\\\\|\\?\"\n    If objItem.Class = olMail Then\n     Set xMailItem = objItem\n    xFileName = xRegEx.Replace(xMailItem.Subject, \"\")\n    xMailItem.SaveAs xFilePath &amp; \"\\\" &amp; xFileName &amp; \".html\", olHTML\n    End If\n   End If\n\nExit Sub\nEnd Sub\n</code></pre>\n\n<p>Problem:<br>\nThe pop up comes up for all the subject line and all the users.</p>\n\n<p>I tried using nested If else but didn't get the correct output.</p>\n\n<p>The whole code is in ThisOutlookSession.</p>\n\n<p><strong>Edit 1</strong>,\n I removed the <code>On Error Resume Next</code> . </p>\n\n<p>The edited code is :</p>\n\n<pre><code>Private WithEvents InboxItems As Outlook.Items\nSub Application_Startup()\nDim xNameSpace As Outlook.NameSpace\nSet xNameSpace = Outlook.Application.Session\nSet InboxItems = xNameSpace.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub InboxItems_ItemAdd(ByVal objItem As Object)\n Dim FSO\n Dim xMailItem As Outlook.MailItem\n Dim xFilePath As String\n Dim xRegEx\n Dim xFileName As String\n Dim Output As String\n\n  If objItem.Class = olMail Then '**\n  Set xMailItem = Application.CreateItem(olMailItem) '**\n\n  If (xMailItem.Subject Like \"RE:FOR REVIEW*\") And ((xMailItem.SenderName = \"Alpha\") Or (xMailItem.SenderName = \"Beta\") or (xMailItem.SenderName = \"Gamma\") ) Then\n     Output = MsgBox(\"Do you want to save this email?\", vbYesNo + vbQuestion, \"Reminder\")\n    If Output = vbNo Then Exit Sub\n     Else\n      xFilePath = CreateObject(\"WScript.Shell\").SpecialFolders(16)\n      xFilePath = \"C:\\Users\\abc\\Desktop\\Test\"\n      Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n      If FSO.FolderExists(xFilePath) = False Then\n       FSO.CreateFolder (xFilePath)\n      End If\n      Set xRegEx = CreateObject(\"vbscript.regexp\")\n     xRegEx.Global = True\n     xRegEx.IgnoreCase = False\n     xRegEx.Pattern = \"\\||\\/|\\&lt;|\\&gt;|\"\"|:|\\*|\\\\|\\?\"\n     If objItem.Class = olMail Then\n      Set xMailItem = objItem\n     xFileName = xRegEx.Replace(xMailItem.Subject, \"\")\n     xMailItem.SaveAs xFilePath &amp; \"\\\" &amp; xFileName &amp; \".html\", olHTML\n     End If\n    End If\n  End If\nExit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543341028, "post_id": 53505315, "comment_id": 93880282, "body": "What are you trying to do? Open a file based on the contents of a cell in a closed workbook? Don&#39;t think that&#39;s possible."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543341143, "post_id": 53505315, "comment_id": 93880342, "body": "Or @SJR trying to open a specific file and then activate/select a certain cell on a certain sheet?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543341383, "post_id": 53505315, "comment_id": 93880473, "body": "@BigBen - yes possibly, but don&#39;t think that&#39;s possible either."}, {"owner": {"reputation": 60, "user_id": 10653130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-V9gxtli4xYA/AAAAAAAAAAI/AAAAAAAAAi4/E7LYr1h9KRk/photo.jpg?sz=128", "display_name": "B-Rye", "link": "https://stackoverflow.com/users/10653130/b-rye"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543343191, "post_id": 53505315, "comment_id": 93881514, "body": "@SJR That&#39;s what I was hoping for. I&#39;ll try and find another way.  Thanks guys."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543343765, "post_id": 53505315, "comment_id": 93881805, "body": "You can open the file and extract the value and then open the other file. If you turn off screenupdating it won&#39;t even be visible."}], "answers": [{"tags": [], "owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "is_accepted": true, "score": 1, "last_activity_date": 1543396435, "creation_date": 1543396435, "answer_id": 53515854, "question_id": 53505315, "link": "https://stackoverflow.com/questions/53505315/trying-to-open-a-file-into-a-specific-tab/53515854#53515854", "title": "Trying to open a file into a specific tab", "body": "<p>Does this work?</p>\n\n<pre><code>Sub openWB()\n\n    strPath = \"G:\\Budgets and Financial\\CLT Budget Templates\\\"\n    strFile = \"Belle Grove Manor.xlsx\"\n    strSheet = \"Sheet1\"\n    strRng = \"E2\"\n    strRef = strPath &amp; strFile\n\n    Dim newWB As Workbook\n    Set newWB = Workbooks.Open(strRef)\n    newWB.Sheets(strSheet).Select\n    newWB.Sheets(strSheet).Range(strRng ).Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1544659219, "creation_date": 1544659219, "answer_id": 53753199, "question_id": 53505315, "link": "https://stackoverflow.com/questions/53505315/trying-to-open-a-file-into-a-specific-tab/53753199#53753199", "title": "Trying to open a file into a specific tab", "body": "<p>Here's an additional answer that defends against the sheet being hidden.</p>\n\n<pre><code> Sub OpenAndSheet()\n\n        Dim strPath As String: strPath = \"G:\\Budgets and Financial\\CLT Budget Templates\\Belle Grove Manor.xlsx\"\"\"\n        Dim strSheet As String: strSheet = \"Sheet1\"\n        Dim strRng As String: strRng = \"E2\"\n\n        Dim WBK As Workbook: Set WBK = Workbooks.Open(strRef)\n\n        Dim WS As Worksheet: Set WS = WBK.Sheets(strSheet)\n\n        With WS\n            .Visible = xlSheetVisible\n            .Activate\n            .Range(strRng).Select\n        End With\n\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 10653130, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-V9gxtli4xYA/AAAAAAAAAAI/AAAAAAAAAi4/E7LYr1h9KRk/photo.jpg?sz=128", "display_name": "B-Rye", "link": "https://stackoverflow.com/users/10653130/b-rye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 53515854, "answer_count": 2, "score": 1, "last_activity_date": 1544672478, "creation_date": 1543340720, "last_edit_date": 1544672478, "question_id": 53505315, "link": "https://stackoverflow.com/questions/53505315/trying-to-open-a-file-into-a-specific-tab", "title": "Trying to open a file into a specific tab", "body": "<p>I'm trying to get a file to open into a specific tab but I'm struggling.  I know there's something wrong with the location. I've tried adding brackets and other formatting to fix the location but nothing's working.</p>\n\n<pre><code>strPath = \"G:\\Budgets and Financial\\CLT Budget Templates\\\"\nstrFile = \"Belle Grove Manor.xlsx\"\nstrSheet = \"Sheet1\"\nstrRng = Range(\"E2\").Address(2, 5, xlR1C1)\nstrRef = \"'\" &amp; strPath &amp; \"[\" &amp; strFile &amp; \"]\" &amp; strSheet &amp; \"'!\" &amp; strRng\nWorkbooks.Open (strRef)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543338635, "post_id": 53504684, "comment_id": 93879035, "body": "Is the final <code>s</code> in <code>Dim ws as Worksheets</code> a typo? Because it should be <code>As Worksheet</code>."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1543338791, "post_id": 53504684, "comment_id": 93879123, "body": "<code>Set rng = sh.Range(&quot;AH1:AX7200&quot;)</code> will set it to <code>AH1:AX7200</code> on the <code>sh</code> sheet and it will not change as you loop through worksheets. Is this your intent? (It would be helpful to know what your question is)"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543338942, "post_id": 53504684, "comment_id": 93879202, "body": "@BigBen - correct, edited my comment accordingly. Thanks for the catch"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543339106, "post_id": 53504684, "comment_id": 93879270, "body": "OP, can you explain what range you want to copy on each sheet and where you want the ranges to be pasted. It also looks like you are always grabbing the same range - do you actually want to do this? Or do you want to grab a dynamic range (from first row down to last used row)?"}, {"owner": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1543396725, "post_id": 53504684, "comment_id": 93900729, "body": "I have a template with equations in columns AH to AX, it will always go from AH1 to AX7200. I know I could just highlight the columns and the worksheets I want to copy into then use the fill across worksheets. But I want to add this into my automation.  @BigBen yes the s is a typo"}, {"owner": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1543396886, "post_id": 53504684, "comment_id": 93900833, "body": "@urdearboy Yes it is the same range from the same worksheet but copied across all worksheets"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "edited": false, "score": 0, "creation_date": 1543397127, "post_id": 53504824, "comment_id": 93900965, "body": "Would I have to enter the name of the sheet I want to paste into each time, as each time I use this there could be 100 sheets or there could be 5 and the names will change each time I use it only &quot;aggregated&quot; &quot;Collated Results&quot; &quot;Template&quot; will stay the same"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1543340034, "last_edit_date": 1543340034, "creation_date": 1543338790, "answer_id": 53504824, "question_id": 53504684, "link": "https://stackoverflow.com/questions/53504684/vba-to-copy-certain-columns-to-all-worksheets/53504824#53504824", "title": "VBA to copy certain columns to all worksheets", "body": "<p>This will</p>\n\n<ol>\n<li>Loop through sheets</li>\n<li>\"Copy\" data from <code>AH1 - AX1</code> down to the last used row that is determined by <code>Column AH</code> (Update column if needed)</li>\n<li>\"Paste\" data on a sheet named <code>Sheet1</code> (Update if needed). The data will be pasted in <code>Column AH</code> on the first available blank row. It's not clear what column you want to paste the data in. You just need to change <code>AH</code> to <code>Some Column</code> to modify</li>\n</ol>\n\n<p>\"Copy\" and \"Paste\" are in quotes because we are really just transferring values here since this is quicker. We are actually setting the values of two equal sized ranges equal to each other. </p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub AH_AX()\n\n'Update \"Sheet1\" to sheet where data is being pasted\nDim ms As Worksheet: Set ms = ThisWorkbook.Sheets(\"Sheet1\")\n\nDim ws As Worksheet, wsLR As Long, msLR As Long\nDim CopyRange As Range, PasteRange As Range\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Aggregated\" And ws.Name &lt;&gt; \"Collated Results\" Then\n\n        'Determine last rows\n        wsLR = ws.Range(\"AH\" &amp; ws.Rows.Count).End(xlUp).Row\n        msLR = ms.Range(\"AH\" &amp; ms.Rows.Count).End(xlUp).Offset(1).Row\n\n        'Set Ranges\n        Set CopyRange = ws.Range(\"AH1:AX\" &amp; LR)\n        Set PasteRange = ms.Range(\"AH\" &amp; msLR).Resize(CopyRange.Rows.Count, CopyRange.Columns.Count)\n\n        'Value Transfer (Quicker than copy/paste)\n        PasteRange.Value = CopyRange.Value\n\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10562088, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nS30nOd_EVA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCW42pJffeCgYaUpeOfT0qKpEz--A/mo/photo.jpg?sz=128", "display_name": "Phil Chamberlain", "link": "https://stackoverflow.com/users/10562088/phil-chamberlain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1543340034, "creation_date": 1543338301, "question_id": 53504684, "link": "https://stackoverflow.com/questions/53504684/vba-to-copy-certain-columns-to-all-worksheets", "title": "VBA to copy certain columns to all worksheets", "body": "<p>Hi I'm looking to create code for copying certain columns (AH to AX) across all worksheets then skipping worksheets named \"Aggregated\" &amp; \"Collated Results\"</p>\n\n<p>I have this already</p>\n\n<pre><code>Sub FillSheets()\n Dim ws As Worksheets\n Dim worksheetsToSkip As Variant\n Dim rng As Range\n Dim sh As Sheet1\n\n\n Set rng = sh.Range(\"AH1:AX7200\")\n\n\n worksheetsToSkip = Array(\"Aggregated\", \"Collated Results\")\n  For Each ws In Worksheets\n  If IsError(Application.Match(ws.Name, worksheetsToSkip, 0)) Then\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "vba", "replace", "find"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 9502397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d66cb738fde74de8d62945b74dfcdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/9502397/minh"}, "edited": false, "score": 0, "creation_date": 1543486695, "post_id": 53505659, "comment_id": 93940824, "body": "Thank you Alex, you understood what I meant. And thank you also for writing a new script which looks much better. However, for my purpose, I cannot use  ; as a delimiter in the new expanded text, but this is certainly something I can work on."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1543342065, "creation_date": 1543342065, "answer_id": 53505659, "question_id": 53504612, "link": "https://stackoverflow.com/questions/53504612/vba-find-a-string-that-has-range-of-value-in-it-with-regular-expression-and-repl/53505659#53505659", "title": "VBA Find a string that has range of value in it with Regular Expression and replace with each value in that range", "body": "<p>Letters have character codes that are ordinal (A &lt; B &lt; C ...) &amp; these can be accessed via asc()/chr$() - here is one way to do it:</p>\n\n<pre><code>inputStr = \"flat 10-14;Flat 18-19;unit 7-9;flat A-D;ABC;DEF;flat 6;flat T\"\n\nDim re As RegExp: Set re = New RegExp\n    re.Pattern = \"(flat|unit)\\s+((\\d+)-(\\d+)|([A-Z])-([A-Z]))\"\n    re.Global = True\n    re.IgnoreCase = True\n\nDim m As MatchCollection\nDim start As Variant, fin As Variant\nDim tokens() As String\nDim i As Long, j As Long\nDim isDigit As Boolean\n\ntokens = Split(inputStr, \";\")\n\nFor i = 0 To UBound(tokens) '// loop over tokens\n\n    Set m = re.Execute(tokens(i))\n\n    If (m.Count) Then\n        With m.Item(0)\n            start = .SubMatches(2) '// first match number/letter\n            isDigit = Not IsEmpty(start) '// is letter or number?\n\n            If (isDigit) Then '// number\n                fin = .SubMatches(3)\n            Else '// letter captured as char code\n                start = Asc(.SubMatches(4))\n                fin = Asc(.SubMatches(5))\n            End If\n\n            tokens(i) = \"\"\n\n            '// loop over items\n            For j = start To fin\n                 tokens(i) = tokens(i) &amp; .SubMatches(0) &amp; \" \" &amp; IIf(isDigit, j, Chr$(j)) &amp; \";\"\n            Next\n        End With\n    ElseIf i &lt;&gt; UBound(tokens) Then tokens(i) = tokens(i) &amp; \";\"\n    End If\nNext\n\nDebug.Print Join(tokens, \"\")\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>flat 10;flat 11;flat 12;flat 13;flat 14;Flat 18;Flat 19;unit 7;unit 8;unit 9;flat A;flat B;flat C;flat D;ABC;DEF;flat 6;flat T</p>\n</blockquote>\n"}], "owner": {"reputation": 47, "user_id": 9502397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d66cb738fde74de8d62945b74dfcdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/9502397/minh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 53505659, "answer_count": 1, "score": 2, "last_activity_date": 1543342065, "creation_date": 1543337979, "question_id": 53504612, "link": "https://stackoverflow.com/questions/53504612/vba-find-a-string-that-has-range-of-value-in-it-with-regular-expression-and-repl", "title": "VBA Find a string that has range of value in it with Regular Expression and replace with each value in that range", "body": "<p>First of all, sorry for the long title. I just don't know how to put it succinctly. I am trying to do this in VBA as normal Excel will not cut it.</p>\n\n<p>Basically, I have a column. Each cells may contain data in the format of something like</p>\n\n<pre><code>flat 10-14;Flat 18-19;unit 7-9;flat A-D;ABC;DEF;\n</code></pre>\n\n<p>What I need is to find the string that has \"-\" in it, and attempt to replace it with anything in between. so the above code will become</p>\n\n<pre><code>Flat 10, Flat 11; Flat 12, Flat 14;Flat 18, Flat 19;Unit 7, Unit 8, Unit 9;Flat A, Flat B, Flat C; ABC;DEF;\n</code></pre>\n\n<p>With the help of <a href=\"https://wellsr.com/vba/2018/excel/vba-regex-regular-expressions-guide/\" rel=\"nofollow noreferrer\">this article</a> on RegExpression, I have managed to work out how to expand the bits of data with number, which I will post the code below. However, I don't know a good way to expand the data with the letter. i.e from  <strong><code>Flat A-C</code></strong> to <strong><code>Flat A, Flat B, Flat C</code></strong></p>\n\n<p>My code is below, please feel free to give any pointers if you think it can be more efficient. I am very much an amateur at this. Thank you in advance.</p>\n\n<pre><code>Sub CallRegEx()\n    Dim r As Match\n    Dim mcolResults As MatchCollection\n    Dim strInput As String, strPattern As String\n    Dim test As String, StrOutput As String, prefix As String\n    Dim startno As Long, endno As Long\n    Dim myrange As Range\n\n    strPattern = \"(Flat|Unit) [0-9]+-+[0-9]+\"\n\nWith Worksheets(\"Sheet1\")\n    lrow = .Cells(Rows.Count, 9).End(xlUp).Row\n    For Each x In .Range(\"A2:A\" &amp; lrow)\n        strInput = Range(\"A\" &amp; x.Row).Value\n        Set mcolResults = RegEx(strInput, strPattern, True, , True)\n        If Not mcolResults Is Nothing Then\n\n        StrOutput = strInput\n\n        For Each r In mcolResults\n                    startno = Mid(r, (InStr(r, \"-\") - 2), 2)\n                    endno = Mid(r, (InStr(r, \"-\") + 1))\n                    prefix = Mid(r, 1, 4)\n                    test = \"\"\n                        For i = startno To endno - 1\n                        test = test &amp; prefix &amp; \" \" &amp; i &amp; \",\"\n                        Next i\n                        test = test &amp; prefix &amp; \" \" &amp; endno\n                    'this is because I don't want the comma at the end of the last value\n                    StrOutput = Replace(StrOutput, r, test)\n\n            Debug.Print r ' remove in production\n        Next r\n        End If\n    .Range(\"D\" &amp; x.Row).Value = StrOutput\n    Next x\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p>This function below is to support the Sub above</p>\n\n<pre><code>Function RegEx(strInput As String, strPattern As String, _\n    Optional GlobalSearch As Boolean, Optional MultiLine As Boolean, _\n    Optional IgnoreCase As Boolean) As MatchCollection\n\n    Dim mcolResults As MatchCollection\n    Dim objRegEx As New RegExp\n\n    If strPattern &lt;&gt; vbNullString Then\n\n        With objRegEx\n            .Global = GlobalSearch\n            .MultiLine = MultiLine\n            .IgnoreCase = IgnoreCase\n            .Pattern = strPattern\n        End With\n\n        If objRegEx.test(strInput) Then\n            Set mcolResults = objRegEx.Execute(strInput)\n            Set RegEx = mcolResults\n        End If\n    End If\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543337679, "post_id": 53504506, "comment_id": 93878451, "body": "Is the selection a single cell?"}, {"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1543342248, "post_id": 53504506, "comment_id": 93880979, "body": "The selection could be multiple cells. I figured out the part I questioned, however now I am actually having problems with it recognizing if a multiple selection is empty (&quot;&quot;). Is there a way to make it recognize this fact so that if someone highlights multiple cells in column A that are blank, it will run the msgbox?"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1543348160, "post_id": 53504506, "comment_id": 93883938, "body": "What does mean <i>only when selection has data</i>? Selection can span multiple columns - so, do you need strict one column or it&#39;s allowed to have several columns, but there must be intersection with column <code>A</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "is_accepted": false, "score": 2, "last_activity_date": 1543342417, "creation_date": 1543342417, "answer_id": 53505751, "question_id": 53504506, "link": "https://stackoverflow.com/questions/53504506/if-statement-that-only-performs-action-when-selection-is-within-a-specific-colum/53505751#53505751", "title": "If statement that only performs action when selection is within a specific column", "body": "<p>This seems to work for recognizing if the cells are within a certain column. </p>\n\n<pre><code>If Not Intersect(Selection, Range(\"A:A\")) Is Nothing Then\n'Proceed\nElse\nMsgBox (\"Please Select Your QN#s Before Running This Macro\")\nExit Sub\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1543342747, "creation_date": 1543342747, "answer_id": 53505839, "question_id": 53504506, "link": "https://stackoverflow.com/questions/53504506/if-statement-that-only-performs-action-when-selection-is-within-a-specific-colum/53505839#53505839", "title": "If statement that only performs action when selection is within a specific column", "body": "<p>Why not use a Worksheet_SelectionChange?</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Target.Column &lt;&gt; 1 Then\n        MsgBox \"Please Select Your QN#s Before Running This Macro\", vbOKOnly, \"Data Selection\"\n    Else\n        RunMacro\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 6700974, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IpF4tdyVQ-I/AAAAAAAAAAI/AAAAAAAABCE/SkmLGxCN144/photo.jpg?sz=128", "display_name": "lighthouselk", "link": "https://stackoverflow.com/users/6700974/lighthouselk"}, "is_accepted": false, "score": 0, "last_activity_date": 1543344420, "last_edit_date": 1543344420, "creation_date": 1543343614, "answer_id": 53506061, "question_id": 53504506, "link": "https://stackoverflow.com/questions/53504506/if-statement-that-only-performs-action-when-selection-is-within-a-specific-colum/53506061#53506061", "title": "If statement that only performs action when selection is within a specific column", "body": "<p>Use this pattern of codes. This is just dealing with the selection and not detecting changes.</p>\n\n<pre><code>Dim a As Integer\nDim b As Integer\nDim c As String\na = Selection.Row\nb = Selection.Rows.Count - 1\nc = \"A\" &amp; a &amp; \":\" &amp; \"A\" &amp; a + b\nIf ((Selection.Column = 1) And (WorksheetFunction.CountA(Range(c)) &gt; 0)) Then\n\nMsgBox \"ready to go\"\n\nEnd If\n</code></pre>\n\n<p>In the above code the hidden rows with data will be considered.\nMerged cells are considered as one cell with value and others are blanks( example: When you have merged A2:A5, then you have 3 blank cells)</p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1582779620, "creation_date": 1543337625, "last_edit_date": 1582779620, "question_id": 53504506, "link": "https://stackoverflow.com/questions/53504506/if-statement-that-only-performs-action-when-selection-is-within-a-specific-colum", "title": "If statement that only performs action when selection is within a specific column", "body": "<p>I am trying to finish this macro that will open another workbook, copy, and paste the selected cells into the other workbook. I want to do this only when the selection is in column A and only when the selection contains data.</p>\n\n<p>The if the selection contains data part is easy, however how can I make a statement that says if selection is not within column A, then <code>MsgBox(\"Please select data\")</code>?</p>\n\n<p>Here is the if statement so far, it still needs the part mentioned directly above.</p>\n\n<pre><code>'Warns if no QN#s are selected\nIf Selection = \"\" Then\nMsgBox (\"Please Select Your QN#s Before Running This Macro\")\nExit Sub\nEnd If\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 10713063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704c3347beecc23766f740138488f7b2?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Schapel", "link": "https://stackoverflow.com/users/10713063/steve-schapel"}, "is_accepted": false, "score": 0, "last_activity_date": 1543348584, "last_edit_date": 1543348584, "creation_date": 1543341086, "answer_id": 53505400, "question_id": 53504385, "link": "https://stackoverflow.com/questions/53504385/eliminate-error-when-i-run-the-code-vba-in-access/53505400#53505400", "title": "Eliminate #Error when I run the code vba in ACCESS", "body": "<p>It depends a bit where you are calling this function from within your database. Probably as a calculated field in a query? Something like this: \n<code>WorkingDays: WorkingDays3([YourDateField])</code>?</p>\n\n<p>Try this instead:\n<code>WorkingDays: WorkingDays3(Nz([YourDateField],Date())</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 10713063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704c3347beecc23766f740138488f7b2?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Schapel", "link": "https://stackoverflow.com/users/10713063/steve-schapel"}, "reply_to_user": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1543475665, "post_id": 53507881, "comment_id": 93934922, "body": "Ok, that makes more sense now.  And now, could you give some example of what circumstances you see the #Error in your query?"}, {"owner": {"reputation": 1, "user_id": 10713063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704c3347beecc23766f740138488f7b2?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Schapel", "link": "https://stackoverflow.com/users/10713063/steve-schapel"}, "reply_to_user": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "edited": false, "score": 0, "creation_date": 1543476157, "post_id": 53507881, "comment_id": 93935114, "body": "For example, is it when there is no data in one of the 2 date fields in the table that you base your query on?"}], "tags": [], "owner": {"reputation": 1, "user_id": 10713063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704c3347beecc23766f740138488f7b2?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Schapel", "link": "https://stackoverflow.com/users/10713063/steve-schapel"}, "is_accepted": false, "score": 0, "last_activity_date": 1543351599, "creation_date": 1543351599, "answer_id": 53507881, "question_id": 53504385, "link": "https://stackoverflow.com/questions/53504385/eliminate-error-when-i-run-the-code-vba-in-access/53507881#53507881", "title": "Eliminate #Error when I run the code vba in ACCESS", "body": "<p>Your original question included code for a function named WorkingDays3, which takes one date parameter.</p>\n\n<p>Your illustration shows a function named WorkingDays2, which takes two date parameters.</p>\n\n<p>I think you will need to give more detailed information about the data you are working with, and under which conditions you are seeing the #Error.</p>\n"}], "owner": {"reputation": 13, "user_id": 10280257, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-O6VSDiP4fao/AAAAAAAAAAI/AAAAAAAAAAo/O4ET8AyydwE/photo.jpg?sz=128", "display_name": "Lina Marcela Hern&#225;ndez Diaz", "link": "https://stackoverflow.com/users/10280257/lina-marcela-hern%c3%a1ndez-diaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1543352082, "creation_date": 1543337221, "last_edit_date": 1543352082, "question_id": 53504385, "link": "https://stackoverflow.com/questions/53504385/eliminate-error-when-i-run-the-code-vba-in-access", "title": "Eliminate #Error when I run the code vba in ACCESS", "body": "<p>I need help, because when I run de code, Error appears when some date field is empty. I have a table with information and I run this code since the generator.</p>\n\n<p>Eliminate #Error when I run the code vba in ACCESS</p>\n\n<p>I will grateful for you help.</p>\n\n<pre><code>Option Compare Database\n\nPublic Function WorkingDays2(FECHA_DE_VALIDACION_FA As Date, FECHA_IMPRESI\u00d3N As Date) As Integer\n'....................................................................\n' Name:     WorkingDays2\n' Inputs:   StartDate As Date\n'   EndDate As Date\n' Returns: Integer\n' Author: Arvin Meyer\n' Date:     May 5,2002\n' Comment: Accepts two dates and returns the number of weekdays between them\n' Note that this function has been modified to account for holidays. It requires a table\n' named tblHolidays with a field named HolidayDate.\n'....................................................................\n\nDim intCount As Integer\nDim rst As DAO.Recordset\nDim DB As DAO.Database\n\nSet DB = CurrentDb\nSet rst = DB.OpenRecordset(\"SELECT [DIAFESTIVO] FROM DIASFESTIVOS\", dbOpenSnapshot)\n\n'StartDate = StartDate + 1\n'To count StartDate as the 1st day comment out the line above\n\nintCount = 0\n\nDo While FECHA_DE_VALIDACION_FA &lt;= FECHA_IMPRESI\u00d3N\n\nrst.FindFirst \"[DIAFESTIVO] = #\" &amp; FECHA_DE_VALIDACION_FA &amp; \"#\"\nIf Weekday(FECHA_DE_VALIDACION_FA) &lt;&gt; vbSunday And Weekday(FECHA_DE_VALIDACION_FA) &lt;&gt; vbSaturday Then\nIf rst.NoMatch Then intCount = intCount + 1\nEnd If\n\nFECHA_DE_VALIDACION_FA = FECHA_DE_VALIDACION_FA + 1\n\n\n\nLoop\n\nWorkingDays2 = intCount\n\nExit_WorkingDays2:\nExit Function\n\nWorkingDays2 = intCount\n\nExit_WorkingDays2:\nExit Function\n\nErr_WorkingDays2:\nSelect Case Err\n\nCase Else\nMsgBox Err.Description\nResume Exit_WorkingDays2\nEnd Select\n\n\nEnd Function\n</code></pre>\n"}]