[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440629606, "post_id": 32237859, "comment_id": 52358214, "body": "Sorry, this isn&#39;t a free coding service. It&#39;s a help site - show us what you&#39;ve tried yourself and we will offer advice."}, {"owner": {"reputation": 11538, "user_id": 1592884, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ECDPt.jpg?s=128&g=1", "display_name": "Nerdroid", "link": "https://stackoverflow.com/users/1592884/nerdroid"}, "edited": false, "score": 1, "creation_date": 1440631438, "post_id": 32237859, "comment_id": 52358755, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/13528333/how-to-search-and-extract-certain-values-in-cells-vba\">How to search and extract certain values in cells - VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1440633695, "creation_date": 1440633695, "answer_id": 32238600, "question_id": 32237859, "link": "https://stackoverflow.com/questions/32237859/extract-employee-id-by-matching-name-and-email-address/32238600#32238600", "title": "extract employee id by matching name and email address", "body": "<p>You can use MATCH() and INDEX() for this.  Make sure to enter the formula using Ctrl+Shift+Enter</p>\n\n<p><a href=\"https://i.stack.imgur.com/YgOzb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YgOzb.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 4925747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f583043391bf139192c9eaf142bb7c0f?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet Soni", "link": "https://stackoverflow.com/users/4925747/puneet-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1440633695, "creation_date": 1440628765, "last_edit_date": 1531164843, "question_id": 32237859, "link": "https://stackoverflow.com/questions/32237859/extract-employee-id-by-matching-name-and-email-address", "title": "extract employee id by matching name and email address", "body": "<p>I have two sheets-Sheet1 has Last name,First name in one column and email address in one column.\nSheet2 also has Last name, First name in one column, email address in one column and Employee id in another.</p>\n\n<p>I want a macro to match names from sheet 1 with two columns - Last name, First name and also email address if both match than i wanted to extract Employee id and write adjacent to that name on Sheet 1</p>\n\n<p>Thanks\nPuneet</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 1, "creation_date": 1440629933, "post_id": 32237879, "comment_id": 52358324, "body": "The macro runs alot slower now, not sure if theres any quick fix to that. But gets the job done. Thanks"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440631254, "post_id": 32237879, "comment_id": 52358700, "body": "@odoc Very strange. This should have ZERO impact on execution speed. Regarding the UnMergeFill() procedure, is it critical that as the merged cells are un-merged that every individual cell that was just part of a merged one take on the value of the merged cell? That is adding a lot of overhead."}, {"owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440782610, "post_id": 32237879, "comment_id": 52431843, "body": "No not every cell, just every cell in columns B, C, and D need to be unmerged."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 4, "last_activity_date": 1440629103, "last_edit_date": 1440629103, "creation_date": 1440628933, "answer_id": 32237879, "question_id": 32237854, "link": "https://stackoverflow.com/questions/32237854/run-a-macro-every-time-sheet-is-changed/32237879#32237879", "title": "Run a Macro every time sheet is changed", "body": "<p>In the code module for that particular worksheet, just add this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Application.EnableEvents = False\n    UnMergeFill\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440782507, "post_id": 32238654, "comment_id": 52431782, "body": "Ok thanks I&#39;ll take a look at that. Another question, is there a way to run a macro in a sheet based on if a change occurs in <b>another</b> sheet? Basically I&#39;m trying to have a pivot table update automatically (already have the macro) once the cells in different sheet are updated by the user. I&#39;ll try making another thread if this doesn&#39;t make any sense."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440787957, "post_id": 32238654, "comment_id": 52434590, "body": "wadr, that does seem to be a new question. I&#39;ll keep an eye out for it."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 5, "last_activity_date": 1440634133, "last_edit_date": 1592644375, "creation_date": 1440634133, "answer_id": 32238654, "question_id": 32237854, "link": "https://stackoverflow.com/questions/32237854/run-a-macro-every-time-sheet-is-changed/32238654#32238654", "title": "Run a Macro every time sheet is changed", "body": "<p>You can boost the efficiency of your macro by locating the merged cells to process rather than looping through every cell in the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840732.aspx\" rel=\"noreferrer\">Worksheet.UsedRange property</a> and examining it for the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197310.aspx\" rel=\"noreferrer\">Range.MergeCells Property</a>.</p>\n<p>Within the worksheet's conventional <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"noreferrer\">Range.Find method</a>, there is an option to look for formatting. On this sub-dialog's <strong>Alignment</strong> tab, you'll find the option to locate <strong>Merged cells</strong>.</p>\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/rIt1e.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/rIt1e.png\" alt=\"Merged Cells Find\" /></a></p>\n<p>This can be incorporated into your VBA sub procedure using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"noreferrer\">Range.Find method</a> and the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194565.aspx\" rel=\"noreferrer\">Application object's</a> <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838023.aspx\" rel=\"noreferrer\">.FindFormat property</a>.</p>\n<p>Your sub procedure using FindFormat:</p>\n<pre><code>Sub UnMergeFill(Optional ws As Worksheet)\n    If ws Is Nothing Then Set ws = ActiveSheet\n    Dim fndMrg As Range, joinedCells As Range\n    \n    Application.FindFormat.MergeCells = True\n    With ws\n        On Error Resume Next\n        Set fndMrg = .Cells.Find(What:=vbNullString, SearchFormat:=True)\n        Do While Not fndMrg Is Nothing\n            Set joinedCells = fndMrg.MergeArea\n            fndMrg.MergeCells = False\n            'fndMrg.UnMerge   '???\n            joinedCells.Value = fndMrg.Value\n            Set fndMrg = .Cells.Find(What:=vbNullString, SearchFormat:=True)\n        Loop\n    End With\n    Application.FindFormat.MergeCells = False\n\nEnd Sub\n</code></pre>\n<p>Slightly revised <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839775.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"noreferrer\">Worksheet_Change</a> event macro with more environment shutdown during processing.</p>\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo bm_Safe_Exit\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n    \n    Call UnMergeFill(Target.Parent)\n    \nbm_Safe_Exit:\n    Application.DisplayAlerts = True\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n<p>I've opted to specify the worksheet to be processed rather than rely on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"noreferrer\">ActiveSheet property</a>. There is the possibility that the Worksheet_Change could be initiated by an outside process when it is NOT the active sheet.</p>\n<p>In short, opt for bulk operations whenever possible and avoid looping whenever you can. This is not blinding fast but it should be substantially quicker than looping through the cells.</p>\n"}], "owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6529, "favorite_count": 1, "accepted_answer_id": 32237879, "answer_count": 2, "score": 2, "last_activity_date": 1523798176, "creation_date": 1440628734, "last_edit_date": 1523798176, "question_id": 32237854, "link": "https://stackoverflow.com/questions/32237854/run-a-macro-every-time-sheet-is-changed", "title": "Run a Macro every time sheet is changed", "body": "<p>i'm still fairly new to macros, i've got a bit of code i need to run on a sheet every time it gets updated, changed, or whatever.</p>\n\n<p>Here is the code I need to run: How can i do this?</p>\n\n<pre><code>Sub UnMergeFill()\n\n    Dim cell As Range, joinedCells As Range\n\n    For Each cell In ThisWorkbook.ActiveSheet.UsedRange\n        If cell.MergeCells Then\n            Set joinedCells = cell.MergeArea\n            cell.MergeCells = False\n            joinedCells.Value = cell.Value\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word", "office-2013"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3643039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FC63i.png?s=128&g=1", "display_name": "Tao", "link": "https://stackoverflow.com/users/3643039/tao"}, "edited": false, "score": 0, "creation_date": 1440636172, "post_id": 32238515, "comment_id": 52359911, "body": "thanks Doug. I tried it, not work as expected. seems that <code>SetCompatibilityMode</code> handles how word opens/views a document, I want save a document with compatibility."}], "tags": [], "owner": {"reputation": 26278, "user_id": 293078, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5437f5b4fa32bd95e6825f93a2b91a50?s=128&d=identicon&r=PG", "display_name": "Doug Glancy", "link": "https://stackoverflow.com/users/293078/doug-glancy"}, "is_accepted": false, "score": 0, "last_activity_date": 1440633125, "creation_date": 1440633125, "answer_id": 32238515, "question_id": 32237729, "link": "https://stackoverflow.com/questions/32237729/ms-word-saveas-check-maintain-compatibility-via-vba/32238515#32238515", "title": "MS Word SaveAs, check &quot;Maintain Compatibility&quot; via VBA", "body": "<p>This <a href=\"https://msdn.microsoft.com/en-us/library/office/ff840359.aspx\" rel=\"nofollow\">MSDN page</a> discusses the related <code>SetCompatibilityMode</code> command, which looks like what you want.</p>\n\n<p><code>ActiveDocument.SetCompatibilityMode (wdWord2003)</code></p>\n\n<p>It's not tied to the Save, which seems like it will work better for you.</p>\n"}], "owner": {"reputation": 41, "user_id": 3643039, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FC63i.png?s=128&g=1", "display_name": "Tao", "link": "https://stackoverflow.com/users/3643039/tao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1058, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1565582225, "creation_date": 1440628040, "last_edit_date": 1440631353, "question_id": 32237729, "link": "https://stackoverflow.com/questions/32237729/ms-word-saveas-check-maintain-compatibility-via-vba", "title": "MS Word SaveAs, check &quot;Maintain Compatibility&quot; via VBA", "body": "<p>There's a check box \"Maintain compatibility with previous versions of Word\" in  \"SaveAs\" dialogue box, by recording a macro and have the check box ticked, I got</p>\n\n<pre><code>ActiveDocument.SaveAs2 FileName:= _\n   \"C:\\Users\\jondoe\\123.dotm\", _\n    FileFormat:=wdFormatXMLTemplateMacroEnabled, LockComments:=False, _\n    Password:=\"\", AddToRecentFiles:=True, WritePassword:=\"\", _\n    ReadOnlyRecommended:=False, EmbedTrueTypeFonts:=False, _\n    SaveNativePictureFormat:=False, SaveFormsData:=False, SaveAsAOCELetter:= _\n    False, CompatibilityMode:=12\n</code></pre>\n\n<p>tick it off, the only difference is</p>\n\n<pre><code>CompatibilityMode:=15\n</code></pre>\n\n<p>according to <a href=\"https://msdn.microsoft.com/en-us/library/office/ff192388.aspx\" rel=\"nofollow\">WdCompatibilityMode Enumeration</a>, 12 stands for Word2007, 15 for Word2013.</p>\n\n<p>But when I run the exact code in VBA, put it in</p>\n\n<pre><code>Public Sub App_DocumentBeforeSave(ByVal Doc As Document, SaveAsUI As Boolean, Cancel As Boolean)\n</code></pre>\n\n<p>the sub get called before word showing the save as dialogue, but no matter I set Compatibility to 12 or 15, the check box is not checked.Is it possible to check it via VBA? If not, I have to withdraw my theory \"everything can be done manually can be done programmatically\".</p>\n\n<p>Any ideas? </p>\n\n<p>And, when you do the save as manually, seems the status of that check box come form last save as action, </p>\n"}, {"tags": ["excel", "vba", "windows-8", "odbc", "dao"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440630030, "post_id": 32237704, "comment_id": 52358357, "body": "Are you using the same architecture across different OS? Also are you loading the dll via Tools-&gt;References or using <code>Declare</code> ?"}, {"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440696656, "post_id": 32237704, "comment_id": 52391840, "body": "It&#39;s not my code loading the DLL; it&#39;s dynamically loaded from within the DAO package (dao360.dll). It appears to be a COM DLL that needs to be registered."}], "answers": [{"tags": [], "owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "is_accepted": false, "score": 0, "last_activity_date": 1440696615, "creation_date": 1440696615, "answer_id": 32255880, "question_id": 32237704, "link": "https://stackoverflow.com/questions/32237704/excel-vba-dbengine-createworkspace-fails-saying-cannot-load-dll/32255880#32255880", "title": "Excel VBA DBEngine.CreateWorkspace fails saying cannot load DLL", "body": "<p>I had forgotten to run my command prompt as administrator when I used regsvr32. That's why VBA wasn't able to find the DLL.</p>\n"}, {"comments": [{"owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "edited": false, "score": 0, "creation_date": 1464088537, "post_id": 37383439, "comment_id": 62330243, "body": "Thank you so much! I had discovered I had to register MSRDO20.dll but I didn&#39;t know the proper way to download it (googling just led to dozens of spammy-looking sites)"}, {"owner": {"reputation": 567, "user_id": 1155724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c674082c55947815a8d636e64fc5bef2?s=128&d=identicon&r=PG", "display_name": "Michael Paesold", "link": "https://stackoverflow.com/users/1155724/michael-paesold"}, "edited": false, "score": 1, "creation_date": 1496147236, "post_id": 37383439, "comment_id": 75532403, "body": "Hint: Make sure to read <i><b>elevated</b> command prompt</i> in the answer above - that is run the command prompt as administrator! Took me some time to figure this out."}, {"owner": {"reputation": 477, "user_id": 4040068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ec4f6494657810aff1586dae56e46f?s=128&d=identicon&r=PG&f=1", "display_name": "bugybunny", "link": "https://stackoverflow.com/users/4040068/bugybunny"}, "edited": false, "score": 1, "creation_date": 1550060414, "post_id": 37383439, "comment_id": 96129960, "body": "The folder is called <code>SysWOW64</code> in Windows 10 (instead of <code>Sys64WOW</code>)"}], "tags": [], "owner": {"reputation": 331, "user_id": 2236081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dde56a31213e170ebf5f0c288969141?s=128&d=identicon&r=PG", "display_name": "takko", "link": "https://stackoverflow.com/users/2236081/takko"}, "is_accepted": true, "score": 3, "last_activity_date": 1580822947, "last_edit_date": 1580822947, "creation_date": 1463982767, "answer_id": 37383439, "question_id": 32237704, "link": "https://stackoverflow.com/questions/32237704/excel-vba-dbengine-createworkspace-fails-saying-cannot-load-dll/37383439#37383439", "title": "Excel VBA DBEngine.CreateWorkspace fails saying cannot load DLL", "body": "<p>This blog solved that problem for me:</p>\n\n<p><a href=\"http://pwaldman.com/unable-to-load-msrdo20-dll-or-rdocurs-dll/\" rel=\"nofollow noreferrer\">http://pwaldman.com/unable-to-load-msrdo20-dll-or-rdocurs-dll/</a></p>\n\n<p>Extract:</p>\n\n<p>Resolution</p>\n\n<ol>\n<li>Download Service Pack 6 for Visual Basic 6.0 (Vs6sp6.exe)</li>\n</ol>\n\n<p><a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=9183\" rel=\"nofollow noreferrer\">http://www.microsoft.com/en-us/download/details.aspx?id=9183</a></p>\n\n<ol start=\"2\">\n<li>Run Vs6sp6.exe and extract the files</li>\n<li>Open msrdo20.cab, it contains the following files: MSRDO20.DLL, MSRDO20.INF, and RDOCURS.DLL. Extract all three files and copy them to the C:\\Windows\\SysWOW64\\ directory.</li>\n<li><p>Open an elevated(admin) command prompt, navigate to C:\\Windows\\SysWOW64, and register MSRDO20.DLL. The RDOCURS.DLL does not need to be registered.</p>\n\n<pre><code> C:\\Windows\\System32&gt; cd C:\\Windows\\SysWOW64\n C:\\Windows\\SysWOW64&gt; regsvr32 MSRDO20.DLL \n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 770, "user_id": 1108056, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/db29ab9496d7cf1beed295ebdd1e5677?s=128&d=identicon&r=PG", "display_name": "AnotherParker", "link": "https://stackoverflow.com/users/1108056/anotherparker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5176, "favorite_count": 0, "accepted_answer_id": 37383439, "answer_count": 2, "score": 1, "last_activity_date": 1593589778, "creation_date": 1440627868, "last_edit_date": 1593589778, "question_id": 32237704, "link": "https://stackoverflow.com/questions/32237704/excel-vba-dbengine-createworkspace-fails-saying-cannot-load-dll", "title": "Excel VBA DBEngine.CreateWorkspace fails saying cannot load DLL", "body": "<p>I have a legacy business application written in VBA in Excel. It uses the VBA DAO library (installed at <code>c:\\program files (x86)\\Common Files\\Microsoft Shared\\DAO\\dao360.dll</code>) and the classes <code>Workspace</code>, <code>Database</code>, <code>DBEngine</code>, <code>Connection</code>) to connect to a SQL database via ODBC.</p>\n\n<p>It works properly up to Windows 7, but on Windows 8 /Server 2012, it doesn't work, on the very first call to DAO:</p>\n\n<pre><code>Set ws = DBEngine.CreateWorkspace(wsName, \"\", \"\", dbUseODBC)\n</code></pre>\n\n<p>raises a runtime error number 3633 description <code>\"Cannot load DLL: 'msrdo20.dll'\"</code>. This occurs both in the class library's <code>DBEngine.Errors</code> and the regular VBA <code>Err</code> object.</p>\n\n<p>This error occurs whether or not the file <code>msrdo20.dll</code> exists.</p>\n\n<p>I found\n<a href=\"https://support.microsoft.com/en-us/kb/260369\" rel=\"nofollow\">https://support.microsoft.com/en-us/kb/260369</a>\nwhich says to include ODBCDirect, but that doesn't seem to be relevant.</p>\n\n<p>I found\n<a href=\"http://www.xtremevbtalk.com/archive/index.php/t-172385.html\" rel=\"nofollow\">http://www.xtremevbtalk.com/archive/index.php/t-172385.html</a>\nwhich suggests removing Microsoft DAO 3.6 from the references and switching to DAO 3.5 -- but doing that breaks things even worse, I get run-time error 429, \"ActiveX component can't create object\".</p>\n\n<p>This is Windows Server 2012, Excel 2013.</p>\n"}, {"tags": ["c++", "macos", "vba", "gcc", "dylib"], "answers": [{"tags": [], "owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "is_accepted": true, "score": 0, "last_activity_date": 1440945149, "last_edit_date": 1440945149, "creation_date": 1440943680, "answer_id": 32297407, "question_id": 32237575, "link": "https://stackoverflow.com/questions/32237575/passing-c-c-dylib-function-taking-pointer-to-vba-on-mac/32297407#32297407", "title": "passing c/c++ dylib function taking pointer to VBA on mac", "body": "<p>Here is an answer (designed thank to <a href=\"https://support.microsoft.com/en-us/kb/205277\" rel=\"nofollow\">this</a>) in the case of arrays : to pass an array (of double) from c++ to excel-2011's (mac) VBA, the c++ function should have in its signature a <code>double *</code> representing the pointer to the first coefficient of the array, an <code>int</code> (or a <code>long</code> or etc) reprensenting the size of the array. For instance, a function taking an array and multiplying all its coefficients by a parameter value would be coded like this : the c++ code is :</p>\n\n<pre><code>extern \"C\"\n{\n      void multarray(double * array, int size, double coeff)\n      {\n            for (int i = 0 ; i &lt; size ; ++i)\n            {\n                  array[i]*=coeff;\n            }\n      }\n}\n</code></pre>\n\n<p>compiled with :</p>\n\n<pre><code>g++ -m32 -Wall -g -c ./tmp4.cpp\ng++ -m32 -dynamiclib ./tmp4.o -o ./tmp4.dylib\n</code></pre>\n\n<p>Now the VBA should reference the dylib as follows :</p>\n\n<pre><code>Declare Sub multarray Lib \"/Users/XXXXXX/Documents/GITHUBRepos/DYLIBS/MyFirstDylib/tmp4.dylib\" (ByRef firstcoeff As Double, ByVal size As Long, ByVal coeff As Double)\n</code></pre>\n\n<p>The first parameter of <code>multarray</code> represent the first coefficient of the array, <em>and must be passed by reference</em>. Here is an exemple of utilisation :</p>\n\n<pre><code>Public Sub DoIt()\n    Dim multarraofdoubles(3) As Double\n    multarraofdoubles(0) = -1.3\n    multarraofdoubles(1) = 4.6\n    multarraofdoubles(2) = -0.67\n    multarraofdoubles(3) = 3.13\n    Dim coeff As Double\n    coeff = 2#\n    Call multarray(multarraofdoubles(0), 4, coeff)\nEnd Sub\n</code></pre>\n\n<p>The aforementioned <a href=\"https://support.microsoft.com/en-us/kb/205277\" rel=\"nofollow\">link</a> contains many other interesting examples, for strings (with <code>BSTR</code>'s), array of strings, simple structs etc, that could be easily adapted to <code>gcc</code> and this mac OS (/linux) context. I am thinking of designing a simple <code>VARIANT</code>class handling all of this.</p>\n"}], "owner": {"reputation": 2053, "user_id": 1581875, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4c4820fbcdf16fb5aa890353e3198582?s=128&d=identicon&r=PG&f=1", "display_name": "Olorin", "link": "https://stackoverflow.com/users/1581875/olorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 32297407, "answer_count": 1, "score": 0, "last_activity_date": 1440945149, "creation_date": 1440627247, "last_edit_date": 1440764997, "question_id": 32237575, "link": "https://stackoverflow.com/questions/32237575/passing-c-c-dylib-function-taking-pointer-to-vba-on-mac", "title": "passing c/c++ dylib function taking pointer to VBA on mac", "body": "<p>I am actually playing with interfacing c/c++ and the VBA of Excel-2011 for mac. How could I design, in the dylib, functions taking pointers as parameters, or references ? Or arrays ? Or even simple structs ? Under windows, <code>VARIANT</code> let's me do everything, but I cannot resort to it under OS X (or even under linux).</p>\n\n<p>Just as comment, up to now, I can do things like these for (involving \"simple\" types) :</p>\n\n<p>I have the following code configuration : in tmp3class.h :</p>\n\n<pre><code>class TheClass\n{\n      public:\n            double mysum(double x ,double y);\n};\n</code></pre>\n\n<p>in tmp3class.cpp :</p>\n\n<pre><code>#include \"./tmp3class.h\"\n\ndouble TheClass::mysum(double x ,double y)\n{\n      return x+y ;\n}\n</code></pre>\n\n<p>and in tmp3.cpp :</p>\n\n<pre><code>#include \"./tmp3class.h\"\n\nextern \"C\"\n{\n      double THESUM(double x, double y)\n      {\n            TheClass TheObj ;\n            double res = TheObj.mysum(x,y);\n            return res ;\n      }\n}\n</code></pre>\n\n<p>I compile this with :</p>\n\n<pre><code>g++-5.2.0 -m32 -Wall -g -c ./tmp3class.cpp -o ./tmp3obj.o\ng++-5.2.0 -m32 -dynamiclib .tmp3.cpp ./tmp3obj.o -o ./tmp3.dylib\n</code></pre>\n\n<p>and then in the vba I do this :</p>\n\n<pre><code>Declare Function THESUM Lib \"/Users/XXXXXX/Documents/GITHUBRepos/DYLIBS/MyFirstDylib/tmp3.dylib\" (ByVal x As Double, ByVal y As Double) As Double\n\nFunction THESUM_VBA(x As Double, y As Double) As Double\n    THESUM_VBA = THESUM(x, y)\nEnd Function\n</code></pre>\n\n<p>and the function <code>THESUM_VBA</code> works perfectly well.</p>\n"}, {"tags": ["excel", "excel-2010", "excel-charts", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1440633473, "post_id": 32237442, "comment_id": 52359272, "body": "Screenshots will go 1000x farther than your macro enabled workbook. I can guarantee noone is going to download that. Shoot a screenshot out to imgur and include a link here. Someone can come along with enough points to add the pic directly to your question."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1440633539, "post_id": 32237442, "comment_id": 52359289, "body": "And... do you mean &quot;Bar AND Pie chart&quot; or is it correct that this is a &quot;Bar IN Pie chart&quot;?"}], "owner": {"reputation": 13, "user_id": 4581156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C4v6Z.png?s=128&g=1", "display_name": "Jonathan Smith", "link": "https://stackoverflow.com/users/4581156/jonathan-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1440626548, "creation_date": 1440626548, "last_edit_date": 1531164843, "question_id": 32237442, "link": "https://stackoverflow.com/questions/32237442/excel-2010-bar-in-pie-chart-points-in-pie-and-in-stack-bar-excel-or-vba", "title": "Excel 2010 Bar in Pie Chart - Points in Pie and in Stack Bar (Excel or VBA)", "body": "<p>I am trying to achieve a very specific format for a Bar in Pie Chart in Excel 2010.  I need the points that are aggregated in the Pie Chart and displayed individually in the Stack Bar to display in the Pie Chart as well. In other words, show the points individually (no aggregation) in the Pie Chart as well as the Stack Bar individually. I have attached a workbook with the format I am trying to achieve. </p>\n\n<p>Please keep in mind the chart you see in my workbook is just visual and is not dynamic.</p>\n\n<p>I consider myself fluent in Excel and VBA but have never had this much trouble trying to achieve a particular format for a chart.</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p><a href=\"https://arlcap.box.com/shared/static/os9bf56fi0dp7ptzxzh71447c00qradf.xlsm\" rel=\"nofollow\">Bar of Pie Stack Overflow Example.xlsm</a></p>\n"}, {"tags": ["vba", "excel", "csv"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1440625379, "post_id": 32237153, "comment_id": 52356635, "body": "I believe only the sheet can be saved as CSV, not part of it, you may have to transfer the used data to an empty sheet and then save as csv."}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1440625622, "post_id": 32237153, "comment_id": 52356738, "body": "You code won&#39;t compile. It looks like you&#39;ve messed up your code paste. Please edit your question and paste working code. Thanks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440626877, "post_id": 32237153, "comment_id": 52357252, "body": "It looks like you&#39;ve a couple of good starts that just didn&#39;t get completed. How were you planning to select the columns before launching the procedure?"}], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 23, "user_id": 5264348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199d1055bae653f7ad8cd84c2c6cf455?s=128&d=identicon&r=PG&f=1", "display_name": "JLSmith2118", "link": "https://stackoverflow.com/users/5264348/jlsmith2118"}, "edited": false, "score": 0, "creation_date": 1440680390, "post_id": 32237599, "comment_id": 52380544, "body": "No worries, don&#39;t forget to mark as the answer if it solved your problem."}, {"owner": {"reputation": 23, "user_id": 5264348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199d1055bae653f7ad8cd84c2c6cf455?s=128&d=identicon&r=PG&f=1", "display_name": "JLSmith2118", "link": "https://stackoverflow.com/users/5264348/jlsmith2118"}, "edited": false, "score": 0, "creation_date": 1440680672, "post_id": 32237599, "comment_id": 52380767, "body": "I have two more questions.  Is there any way you could comment out the code so I could learn exactly what the code is doing?  Also, how would i send the file to the same folder everytime?  Thanks again for your help.  Really awesome to see it done correctly."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 23, "user_id": 5264348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199d1055bae653f7ad8cd84c2c6cf455?s=128&d=identicon&r=PG&f=1", "display_name": "JLSmith2118", "link": "https://stackoverflow.com/users/5264348/jlsmith2118"}, "edited": false, "score": 0, "creation_date": 1440683472, "post_id": 32237599, "comment_id": 52382990, "body": "1) see edit above. 2) Not sure what you mean, are you going to run this code multiple times in succession and don&#39;t want to select a folder each time?"}, {"owner": {"reputation": 23, "user_id": 5264348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199d1055bae653f7ad8cd84c2c6cf455?s=128&d=identicon&r=PG&f=1", "display_name": "JLSmith2118", "link": "https://stackoverflow.com/users/5264348/jlsmith2118"}, "edited": false, "score": 0, "creation_date": 1440689194, "post_id": 32237599, "comment_id": 52387204, "body": "Thanks for the code comments.  I understand it better.  What I mean is that I am going to save the csv to my p:\\ drive everytime.  When the save as opens I would like for it to go straight to my p:\\ drive and then I navigate from there.  Does that make sense?  Thanks again for the help"}, {"owner": {"reputation": 23, "user_id": 5264348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199d1055bae653f7ad8cd84c2c6cf455?s=128&d=identicon&r=PG&f=1", "display_name": "JLSmith2118", "link": "https://stackoverflow.com/users/5264348/jlsmith2118"}, "edited": false, "score": 0, "creation_date": 1440708544, "post_id": 32237599, "comment_id": 52398251, "body": "Thanks again.  Works awesome!!"}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1440689306, "last_edit_date": 1440689306, "creation_date": 1440627329, "answer_id": 32237599, "question_id": 32237153, "link": "https://stackoverflow.com/questions/32237153/exporting-selection-to-csv/32237599#32237599", "title": "Exporting Selection to CSV", "body": "<p>Here you go:</p>\n\n<pre><code>Sub MacroMan()\n\nChDrive \"P:\" '// &lt;~~ change current drive to P:\\\nDim copyRng As Excel.Range\nDim ThisWB  As Excel.Workbook\nDim OtherWB As Excel.Workbook\nDim sName   As String\n\n'// set reference to the 'Master' workbook\nSet ThisWB = ActiveWorkbook\n\n'// assign selected range to 'copyRng'\nSet copyRng = Application.InputBox(Prompt:=\"Select range to convert to CSV\", Type:=8)\n\n'// If the user selected a range, then proceed with rest of code:\nIf Not copyRng Is Nothing Then\n    '// Create a new workbook with 1 sheet.\n    Set OtherWB = Workbooks.Add(1)\n\n    '// Get A1, then expand this 'selection' to the same size as copyRng. \n    '// Then assign the value of copyRng to this area (similar to copy/paste)\n    OtherWB.Sheets(1).Range(\"A1\").Resize(copyRng.Rows.Count, copyRng.Columns.Count).Value = copyRng.Value\n\n    '// Get save name for CSV file.\n    sName = Application.GetSaveAsFilename(FileFilter:=\"CSV files (*.csv), *.csv\")\n\n    '// If the user entered a save name then proceed:\n    If Not LCase(sName) = \"false\" Then\n        '// Turn off alerts\n        Application.DisplayAlerts = False\n        '// Save the 'copy' workbook as a CSV file\n        OtherWB.SaveAs sName, xlCSV\n        '// Close the 'copy' workbook\n        OtherWB.Close\n        '// Turn alerts back on\n        Application.DisplayAlerts = True\n    End If\n\n    '// Make the 'Master' workbook the active workbook again\n    ThisWB.Activate\n\n    MsgBox \"Conversion complete\", vbInformation\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This will allow you to manually select a range (including entire columns). It will then transfer said range onto a new sheet, save that sheet as a CSV, using the Save As dialog, and then close it afterwards.</p>\n"}], "owner": {"reputation": 23, "user_id": 5264348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/199d1055bae653f7ad8cd84c2c6cf455?s=128&d=identicon&r=PG&f=1", "display_name": "JLSmith2118", "link": "https://stackoverflow.com/users/5264348/jlsmith2118"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4532, "favorite_count": 0, "accepted_answer_id": 32237599, "answer_count": 1, "score": 2, "last_activity_date": 1440689306, "creation_date": 1440625172, "last_edit_date": 1440626268, "question_id": 32237153, "link": "https://stackoverflow.com/questions/32237153/exporting-selection-to-csv", "title": "Exporting Selection to CSV", "body": "<p>I've created a excel spreadsheet template for our customers to populate and send back to us.  I want to manually select their populated data and save it as a .csv to import into another piece of software.  I, first, attempted this by recording a macro.  This didn't work because different customers send different numbers of records.</p>\n\n<p>I've tried snippets of code from online research and came up with this.</p>\n\n<pre><code>Sub Select_To_CSV()\n   Dim rng As Range\n   Dim myrangearea()\n   Range(ActiveCell, ActiveCell.End(xlDown).End(xlToRight)).Select\n\n\n   Dim myPath As String, v\n   myPath = \"p:\\\" &amp; _\n     Format(Date, \"yyyymmdd\") &amp; \".csv\"\n   'myPath = \"x:\\\" &amp; Format(Date, \"yyyymmdd\") &amp; \".csv\"\n    v = SaveAs(myPath)\n    If v &lt;&gt; False Then ThisWorkbook.SaveAs v\nEnd Sub\n\nFunction SaveAs(initialFilename As String)\n  On Error GoTo EndNow\n  SaveAs = False\n  With Application.FileDialog(msoFileDialogSaveAs)\n    .AllowMultiSelect = False\n    .ButtonName = \"&amp;Save As\"\n    .initialFilename = initialFilename\n    .Title = \"File Save As\"\n    '.Execute\n    .Show\n    SaveAs = .SelectedItems(1)\n  End With\nEndNow:\nEnd Function\n\nSub Select_To_CSV()\n   Dim rng As Range\n   Dim myrangearea()\n   Range(ActiveCell, ActiveCell.End(xlDown).End(xlToRight)).Select\n\n\n   Dim myPath As String, v\n   myPath = \"p:\\\" &amp; _\n     Format(Date, \"yyyymmdd\") &amp; \".csv\"\n   'myPath = \"x:\\\" &amp; Format(Date, \"yyyymmdd\") &amp; \".csv\"\n    v = SaveAs(myPath)\n    If v &lt;&gt; False Then ThisWorkbook.SaveAs v\nEnd Sub\n</code></pre>\n\n<p>This worked really well except when I went back to look at the .csv in the folder it was the same worksheet not the selected columns.</p>\n\n<p>Ultimately what I am looking to do is,</p>\n\n<ol>\n<li>Manually select the columns I want</li>\n<li>Run a macro that converts the selected columns to a .csv</li>\n<li>Have the Save As Dialog Box appear</li>\n<li>Navigate to the certain folder I want.</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440624171, "post_id": 32236848, "comment_id": 52356117, "body": "Psst...its Rows() not Ows() ;)"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1440624205, "last_edit_date": 1440624205, "creation_date": 1440623801, "answer_id": 32236848, "question_id": 32236820, "link": "https://stackoverflow.com/questions/32236820/if-with-2-conditions-to-return-2-different-possible-values/32236848#32236848", "title": "if with 2 conditions to return 2 different possible values", "body": "<p>You can't use <code>And</code> to run two statements in a single line. Change this line:</p>\n\n<pre><code>Rows(i).EntireRow.Interior.ColorIndex = 0 And Sheets(\"Planilha\").CheckBox1.Value = False\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Rows(i).EntireRow.Interior.ColorIndex = 0\nSheets(\"Planilha\").CheckBox1.Value = False\n</code></pre>\n\n<p>If you really want to run two statements on a single line, you can use <code>:</code>. For example:</p>\n\n<pre><code>Rows(i).EntireRow.Interior.ColorIndex = 0 : Sheets(\"Planilha\").CheckBox1.Value = False\n</code></pre>\n\n<p>but it should be discouraged.</p>\n\n<p>Also, you can check both your conditions using a single <code>If</code>. That way, your <code>Else</code> will run if either fails:</p>\n\n<pre><code>If Rows(i).EntireRow.Interior.ColorIndex = 6 And Cells(i, 9).Value = \"TRUE\" Then\n    Rows(i).EntireRow.Interior.ColorIndex = 0\n    Sheets(\"Planilha\").CheckBox1.Value = False\nElse\n    Rows(i).EntireRow.Interior.ColorIndex = 6\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440624205, "creation_date": 1440623706, "last_edit_date": 1440623900, "question_id": 32236820, "link": "https://stackoverflow.com/questions/32236820/if-with-2-conditions-to-return-2-different-possible-values", "title": "if with 2 conditions to return 2 different possible values", "body": "<p>i am writing a code that checks if the row is yellow and if the value of a cell is true, if both are positive, it should return a blank row and uncheck the checkbox list. Otherwise, it should return a yellow row. I have written the following code, but it is not working. I would appreciate your help</p>\n\n<pre><code>Sub desmarcar_antigos()\n\n    Dim i As Integer\n    For i = 130 To 2 Step -1\n        If Rows(i).EntireRow.Interior.ColorIndex = 6 Then\n            If Cells(i, 9).Value = \"TRUE\" Then\n                Rows(i).EntireRow.Interior.ColorIndex = 0 And Sheets(\"Planilha\").CheckBox1.Value = False\n            Else\n                Rows(i).EntireRow.Interior.ColorIndex = 6\n            End If\n        End If\n    Next i\n    Application.ScreenUpdating = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440620888, "post_id": 32235934, "comment_id": 52354481, "body": "I would add that if the sentence has varying words (meaning the range wouldn&#39;t always be the 5th element) then use split and loop on the array, checking for a colon."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440620940, "post_id": 32235934, "comment_id": 52354514, "body": "@DavidG - Thanks. I included a regex example that should work if the string isn&#39;t very consistent."}, {"owner": {"reputation": 53, "user_id": 5270145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29aef9c84e23e147df46cfde894b8be?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Guill", "link": "https://stackoverflow.com/users/5270145/nathan-guill"}, "edited": false, "score": 0, "creation_date": 1440621642, "post_id": 32235934, "comment_id": 52354891, "body": "Thanks, regex is what I was trying to think of."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 0, "last_activity_date": 1440620902, "last_edit_date": 1440620902, "creation_date": 1440620177, "answer_id": 32235934, "question_id": 32235886, "link": "https://stackoverflow.com/questions/32235886/extract-range-from-string/32235934#32235934", "title": "Extract range from string", "body": "<p>Just use <code>Split()</code> to split your string into an array and then grab the 5th element (index = 4):</p>\n\n<pre><code>Const SOME_TEXT As String = \"Paste Data in range A1:K44 only. Data to come from \"\"History\"\" dump in Part Inquire.\"\n\nDim strRange As String\nstrRange = Split(SOME_TEXT)(4)\n\nDebug.Print strRange\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>A1:K44\n</code></pre>\n\n<p>If the text that appears isn't quite so consistent, you can use a regex to extract the first range that appears within your string:</p>\n\n<pre><code>Const SOME_TEXT As String = \"This string has A1:K44 in it but is inconsistent with the rest.\"\n\nDim re\nSet re = CreateObject(\"VBScript.RegExp\")\nre.Pattern = \"\\b[A-Z]{1,3}\\d+:[A-Z]{1,3}\\d+\\b\"\n\nIf re.Test(SOME_TEXT) Then\n    Debug.Print re.Execute(SOME_TEXT)(0)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5270145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a29aef9c84e23e147df46cfde894b8be?s=128&d=identicon&r=PG&f=1", "display_name": "Nathan Guill", "link": "https://stackoverflow.com/users/5270145/nathan-guill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 32235934, "answer_count": 1, "score": 2, "last_activity_date": 1440620902, "creation_date": 1440620021, "last_edit_date": 1440620389, "question_id": 32235886, "link": "https://stackoverflow.com/questions/32235886/extract-range-from-string", "title": "Extract range from string", "body": "<p>I have a report that exports to multiple Excel sheets.  The first row on each sheet has a similar statement to the below.</p>\n\n<blockquote>\n  <p>Paste Data in range A1:K44 only.  Data to come from \"History\" dump in\n  Part Inquire.</p>\n</blockquote>\n\n<p>I need to extract the range from that string.  I've tried to use the split and find functions, but the length of the range changes (i.e. <code>A1:AB53</code>, <code>A15:C20</code>, etc.).</p>\n\n<p>I welcome any input as to how to extract the range.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1440618082, "post_id": 32235325, "comment_id": 52353009, "body": "What line is the error occurring on?  What error are you getting?"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440618169, "post_id": 32235325, "comment_id": 52353052, "body": "When using ActiveSheet and ActiveWorkbook it will take the ones that are active, not the ones you put in your With."}, {"owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "edited": false, "score": 0, "creation_date": 1440618441, "post_id": 32235325, "comment_id": 52353196, "body": "Soulfire@ it gives me an error as Application-defined or object Defined error. Here &quot;Sheets(&quot;Sheet2&quot;).Range(&quot;B3:031&quot;).Clear&quot;"}, {"owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "edited": false, "score": 0, "creation_date": 1440618470, "post_id": 32235325, "comment_id": 52353213, "body": "David@: What can you suggest at this part can my code be amended."}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1440618703, "post_id": 32235325, "comment_id": 52353311, "body": "It looks like you have a <code>0</code> zero rather than on O <code>O</code> in <code>Range(&quot;B3:031)&quot;</code>.  Try changing the zero to the letter O."}, {"owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "edited": false, "score": 0, "creation_date": 1440618975, "post_id": 32235325, "comment_id": 52353477, "body": "It actually worked me i think i have to check up my eyes. Soulfire Rocks...!!!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440619100, "post_id": 32235325, "comment_id": 52353533, "body": "VBA has a <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223824%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">Range.Clear</a> and a <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223828%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">Range.ClearContents method</a>. Probably not a good idea to attempt to redefine them."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1440619918, "creation_date": 1440619918, "answer_id": 32235857, "question_id": 32235325, "link": "https://stackoverflow.com/questions/32235325/clear-range-from-sheet2/32235857#32235857", "title": "Clear Range from sheet2", "body": "<p>It isn't clear (:D) what the relationship between the Sheet2 Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx\" rel=\"nofollow\">.CodeName property</a> and the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">ActiveSheet property</a> is; nor even <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821871.aspx\" rel=\"nofollow\">ActiveWorkbook property</a> and the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa215773%28v=office.11%29.aspx\" rel=\"nofollow\">ThisWorkbook property</a> but I'm of a mind that they are mutliple attempts at the same thing.</p>\n\n<p>You need to take advantage of the parentage involed by your <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statements</a>. Simply stating <code>With ThisWorkbook</code> does not infer anything unless you subsequently preface all children with a period (aka <code>.</code> or <em>full stop</em>). The <code>.</code> is what references parentage to the object in the With... End With statement.</p>\n\n<pre><code>Sub Protected_Clear()\n    With ThisWorkbook\n        .Unprotect \"\"\n        With .Worksheets(\"Sheet2\")\n            .Unprotect \"\"\n            .Range(\"B3:O31\").Clear\n            .Protect \"\"\n        End With\n        .Protect \"\"\n        .Close savechanges:=True\n    End With\nEnd Sub\n</code></pre>\n\n<p>I've renamed your sub procedure <code>Protected_Clear</code> in order to avoid confusion and conflict with the VBA's own <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223824%28v=office.11%29.aspx\" rel=\"nofollow\">Range.Clear</a> function.</p>\n"}], "owner": {"reputation": 11, "user_id": 4572221, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2e09e6bffa49b6d1ba9417064fd90e09?s=128&d=identicon&r=PG&f=1", "display_name": "Changer", "link": "https://stackoverflow.com/users/4572221/changer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440619918, "creation_date": 1440617980, "last_edit_date": 1531164843, "question_id": 32235325, "link": "https://stackoverflow.com/questions/32235325/clear-range-from-sheet2", "title": "Clear Range from sheet2", "body": "<p>I am new to Visual basic below is the code to delete the data from sheet2 with the desired range it is not working and i am getting the error.</p>\n\n<pre><code>Sub Clear()\n\nWith ThisWorkbook\nWith .Worksheets(\"Sheet2\")\nActiveSheet.Unprotect \"\": ActiveWorkbook.Unprotect \"\"\nSheet2.Unprotect \"\": ActiveWorkbook.Unprotect \"\"\nSheets(\"Sheet2\").Range(\"B3:031\").Clear\nSheet2.Protect \"\": ActiveWorkbook.Protect \"\"\nActiveSheet.Protect \"\": ActiveWorkbook.Protect \"\"\nEnd With\nActiveWorkbook.Save\nActiveWorkbook.Close\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["powershell", "ms-access", "vbscript", "vba"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440622289, "post_id": 32235184, "comment_id": 52355222, "body": "Have you tried specifying <i>projectname.procedurename</i>? For example, <code>&quot;Project1.testRun&quot;</code>."}, {"owner": {"reputation": 2106, "user_id": 4317867, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/50002a9811ef5b968c6e76c835c0760c?s=128&d=identicon&r=PG&f=1", "display_name": "user4317867", "link": "https://stackoverflow.com/users/4317867/user4317867"}, "edited": false, "score": 0, "creation_date": 1440653103, "post_id": 32235184, "comment_id": 52363905, "body": "Is WinRM enabled and configured on the remote machine?  -edit, searched for the HRESULT and landed <a href=\"http://stackoverflow.com/questions/837754/call-routine-in-access-module-from-net\">here</a>"}, {"owner": {"reputation": 173, "user_id": 5041434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3a6702cbf9ca4296f3a76abc012c42f?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/5041434/heather"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440696048, "post_id": 32235184, "comment_id": 52391443, "body": "@Bond the script will not run if I put the module name and then the function."}, {"owner": {"reputation": 173, "user_id": 5041434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3a6702cbf9ca4296f3a76abc012c42f?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/5041434/heather"}, "reply_to_user": {"reputation": 2106, "user_id": 4317867, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/50002a9811ef5b968c6e76c835c0760c?s=128&d=identicon&r=PG&f=1", "display_name": "user4317867", "link": "https://stackoverflow.com/users/4317867/user4317867"}, "edited": false, "score": 0, "creation_date": 1440696214, "post_id": 32235184, "comment_id": 52391556, "body": "@user4317867 I can run other remote scripts on the machine, so unless their is a special setting to allow access functions to run I believe it&#39;s enabled. I also have the access file in a trusted location, so I don&#39;t believe that is the problem."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1440701285, "post_id": 32235184, "comment_id": 52394473, "body": "Is this page at all related? <a href=\"http://stackoverflow.com/questions/31518043/running-access-macro-in-powershell\" title=\"running access macro in powershell\">stackoverflow.com/questions/31518043/&hellip;</a>"}, {"owner": {"reputation": 2106, "user_id": 4317867, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/50002a9811ef5b968c6e76c835c0760c?s=128&d=identicon&r=PG&f=1", "display_name": "user4317867", "link": "https://stackoverflow.com/users/4317867/user4317867"}, "edited": false, "score": 0, "creation_date": 1440710750, "post_id": 32235184, "comment_id": 52399299, "body": "@Heather did you see the page I mentioned in my comment?  There was talk about a security setting within Access that might be worth looking at.  <a href=\"http://stackoverflow.com/questions/837754/call-routine-in-access-module-from-net\">Here is the link</a>"}], "owner": {"reputation": 173, "user_id": 5041434, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c3a6702cbf9ca4296f3a76abc012c42f?s=128&d=identicon&r=PG&f=1", "display_name": "Heather", "link": "https://stackoverflow.com/users/5041434/heather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 827, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1459426767, "creation_date": 1440617452, "last_edit_date": 1459426767, "question_id": 32235184, "link": "https://stackoverflow.com/questions/32235184/running-access-function-on-remote-machine-with-powershell", "title": "Running Access Function on remote machine with powerShell", "body": "<p>I have an access db set up with the following function in it:</p>\n\n<pre><code>Function testRun() As Boolean\n    If 1 = 1 Then\n        testRun = True\n    End If\nEnd Function\n</code></pre>\n\n<p>I then have a PowerShell script with this code it in:</p>\n\n<pre><code>$Access = New-Object -com \"Access.Application\"\n$Access.OpenCurrentDatabase(\"C:\\script\\Database11.accdb\", $false)\n$LASTEXITCODE = $Access.Run(\"testRun\")\n$Access.Quit()|Out-Null\nWrite-Host $LASTEXITCODE\nexit $LASTEXITCODE\n</code></pre>\n\n<p>When I execute the powerShell script on the local machine it works fine, I get True returned, however if I use the invoke command to run it remotely on another machine I'm getting the following error:\n<a href=\"https://i.stack.imgur.com/hvibF.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hvibF.gif\" alt=\"enter image description here\"></a></p>\n\n<p>My real script is more complicated, but I simplified my Access function to make sure that it wasn't the problem.  I've tried moving the location of my db around, it was originally on a network drive, but I then moved it to the C drive of the remote machine, I get the same error either way.  I also tried calling a VBScript to run the function and that too came back with an error.  I'm guessing it's some access security setting but I cannot figure out what it could be.  Please Help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440640367, "post_id": 32235182, "comment_id": 52360789, "body": "Did my solution work for you?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440704860, "post_id": 32235182, "comment_id": 52396318, "body": "Can I help you further?"}, {"owner": {"reputation": 15, "user_id": 5228513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X0FMeUcGguE/AAAAAAAAAAI/AAAAAAAAABE/kXZxoCdJDXs/photo.jpg?sz=128", "display_name": "Arseniy Kotov", "link": "https://stackoverflow.com/users/5228513/arseniy-kotov"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440776896, "post_id": 32235182, "comment_id": 52428865, "body": "That was perfect! You can help me a little further. I have another question on a related matter on my account page. Can you see if you can help with that one too?"}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1440620073, "last_edit_date": 1440620073, "creation_date": 1440618916, "answer_id": 32235559, "question_id": 32235182, "link": "https://stackoverflow.com/questions/32235182/changing-y-min-max-values/32235559#32235559", "title": "Changing y min max values", "body": "<p>Near the bottom of your code, just below where you assign the chart title, add this bit of code:</p>\n\n<pre><code>    With .Axes(xlValue)\n        .MinimumScale = 0\n        .MaximumScale = 100\n        .MajorTickMark = xlOutside\n        .MinorTickMark = xlOutside\n    End With\n</code></pre>\n\n<p>You can supply your own Min and Max axis scale values. If you do not want the tiny ticks just remove the MinorTickMarck line.</p>\n"}], "owner": {"reputation": 15, "user_id": 5228513, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-X0FMeUcGguE/AAAAAAAAAAI/AAAAAAAAABE/kXZxoCdJDXs/photo.jpg?sz=128", "display_name": "Arseniy Kotov", "link": "https://stackoverflow.com/users/5228513/arseniy-kotov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 32235559, "answer_count": 1, "score": 0, "last_activity_date": 1440620073, "creation_date": 1440617441, "question_id": 32235182, "link": "https://stackoverflow.com/questions/32235182/changing-y-min-max-values", "title": "Changing y min max values", "body": "<p>Hey guys Im trying to change my y-min and y-max values on my chart as well as make sure all of the tick labels are forced to be shown. Any suggestions on how to do that with this code in mind?</p>\n\n<p>This is part of a userform</p>\n\n<pre><code>Sub MakeFinanceChart()\n\nDim rX1 As Range rY1 As Range, rX2 As Range, rY2 As Range, rX3 As Range, rY3 As Range, rX4 As Range, rY4 As Range, rX5 As Range, rY5 As Range, rX6 As Range, rY6 As Range\nDim rChartPos As Range\nDim chtO As ChartObject\n\nSet rX1 = Worksheets(\"Finance\").Range(\"C5:C80\"): Set rY1 = Worksheets(\"Finance\").Range(\"F5:F80\")\nSet rX2 = Worksheets(\"Finance\").Range(\"C5:C80\"): Set rY2 = Worksheets(\"Finance\").Range(\"J5:J80\")\nSet rX3 = Worksheets(\"Finance\").Range(\"C5:C80\"): Set rY3 = Worksheets(\"Finance\").Range(\"L5:L80\")\nSet rX4 = Worksheets(\"Finance\").Range(\"C5:C80\"): Set rY4 = Worksheets(\"Finance\").Range(\"P5:P80\")\nSet rX5 = Worksheets(\"Finance\").Range(\"C5:C80\"): Set rY5 = Worksheets(\"Finance\").Range(\"T5:T80\")\nSet rX6 = Worksheets(\"Finance\").Range(\"C5:C80\"): Set rY6 = Worksheets(\"Finance\").Range(\"X5:X80\")\n\nSet rChartPos = Worksheets(\"PLOTS\").Range(\"O2:X28\") ' location and dimensions of the chart\nWith rChartPos\nSet chtO = .Parent.ChartObjects.Add(.Left, .Top, .Width, .Height)\nchtO.Name = \"Finance Plots\"\nEnd With\n\n'Plot the Whole Finance CHART\n\nWith chtO.Chart\n\n    .ChartType = xlXYScatterLines\n\n    ' First series\n    With .SeriesCollection.NewSeries\n        .XValues = rX1\n        .Values = rY1\n        .Name = \"A\"\n    End With\n\n    ' Second series\n    With .SeriesCollection.NewSeries\n        .XValues = rX2\n        .Values = rY2\n         .Name = \"B\"\n   End With\n\n    ' Third series\n    With .SeriesCollection.NewSeries\n        .XValues = rX3\n        .Values = rY3\n         .Name = \"C\"\n   End With\n\n   ' Fourth series\n    With .SeriesCollection.NewSeries\n        .XValues = rX4\n        .Values = rY4\n        .Name = \"D\"\n    End With\n\n    ' Fifth series\n    With .SeriesCollection.NewSeries\n        .XValues = rX5\n        .Values = rY5\n         .Name = \"E\"\n   End With\n\n    ' Sixth Series\n    With .SeriesCollection.NewSeries\n        .XValues = rX6\n        .Values = rY6\n         .Name = \"F\"\n   End With\n\n\n    .SetElement (msoElementChartTitleAboveChart)\n    .ChartTitle.Text = \"Finance Plot\"\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1440617369, "post_id": 32235108, "comment_id": 52352604, "body": "Which line causes the error?"}, {"owner": {"reputation": 11, "user_id": 5270056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ef2854a74fe10ec1297c6a99dc93eb?s=128&d=identicon&r=PG&f=1", "display_name": "MWill", "link": "https://stackoverflow.com/users/5270056/mwill"}, "reply_to_user": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "edited": false, "score": 0, "creation_date": 1440617580, "post_id": 32235108, "comment_id": 52352733, "body": "@Dportology &quot;Sub LateReports_Click()&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1440617821, "post_id": 32235108, "comment_id": 52352864, "body": "You&#39;ve use <code>Month</code> instead of <code>ThisMonth</code> in the actual filename portion. The error is because the <code>Month(...)</code> function expects a date to parse a numerical month from."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440618663, "post_id": 32235273, "comment_id": 52353285, "body": "Ha! Completely missed the <code>as Interior</code> bit."}], "tags": [], "owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "is_accepted": false, "score": 2, "last_activity_date": 1440617830, "creation_date": 1440617830, "answer_id": 32235273, "question_id": 32235108, "link": "https://stackoverflow.com/questions/32235108/excel-argument-not-optional/32235273#32235273", "title": "Excel Argument Not Optional", "body": "<p>Here you go:</p>\n\n<pre><code>Sub LateReports_Click()\n    Dim ThisYear As Integer\n    Dim ThisMonth As String\n\n' Create a new workbook for Late Tools in the current year and month folder\nThisYear = Year(Now())\nThisMonth = MonthName(Now())\nWorkbooks.Add\n\nActiveWorkbook.SaveAs Filename:=\"R:\\Tool Calibration\\\" &amp; ThisYear &amp; \"\\\" &amp; ThisMonth &amp; \"\\Late_Tools_\" &amp; ThisMonth &amp; \".xls\"\n\nEnd Sub\n</code></pre>\n\n<p>My guess is that you meant to declare ThisYear as an Integer, not an Interior, and in your ActiveWorkbook.SaveAs line, you refer to ThisMonth as simply Month</p>\n"}], "owner": {"reputation": 11, "user_id": 5270056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ef2854a74fe10ec1297c6a99dc93eb?s=128&d=identicon&r=PG&f=1", "display_name": "MWill", "link": "https://stackoverflow.com/users/5270056/mwill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440617830, "creation_date": 1440617188, "last_edit_date": 1440617391, "question_id": 32235108, "link": "https://stackoverflow.com/questions/32235108/excel-argument-not-optional", "title": "Excel Argument Not Optional", "body": "<p>Hey I am creating a form that has multiple buttons that trigger different subroutines. The first code works by for the second code </p>\n\n<pre><code>Sub LateReports_Click()\n    Dim ThisYear As Interior\n    Dim ThisMonth As String\n\n' Create a new workbook for Late Tools in the current year and month folder\nThisYear = Year(Now())\nThisMonth = MonthName(Now())\nWorkbooks.Add\n\nActiveWorkbook.SaveAs Filename:=\"R:\\Tool Calibration\\\" &amp; ThisYear &amp; \"\\\" &amp; ThisMonth &amp; \"\\Late_Tools_\" &amp; Month &amp; \".xls\"\n\nEnd Sub\n</code></pre>\n\n<p>I get a <code>Argument not optional</code> compile error. Any Suggestions?</p>\n"}, {"tags": ["vba", "class", "excel", "oop"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1440620488, "post_id": 32235106, "comment_id": 52354236, "body": "You may be interested in this too <a href=\"http://stackoverflow.com/questions/28817295/what-are-the-potential-consequences-of-setting-a-class-to-publicnotcreatable\" title=\"what are the potential consequences of setting a class to publicnotcreatable\">stackoverflow.com/questions/28817295/&hellip;</a>"}, {"owner": {"reputation": 125, "user_id": 4986687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33984acccb9b3208545055a839c2b6e6?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Rubin Capalbo", "link": "https://stackoverflow.com/users/4986687/francisco-rubin-capalbo"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1440621482, "post_id": 32235106, "comment_id": 52354803, "body": "@DickKusleika That cleared a lot of things up, the other solution seemed like a hack. Thanks a lot!"}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1440622203, "post_id": 32235106, "comment_id": 52355180, "body": "Glad to help. If you want to get even closer to a singleton, google <code>VB_PredeclaredID</code>. It&#39;s an attribute that you can set, but attributes in VBA are a bit of a hack themselves."}], "answers": [{"tags": [], "owner": {"reputation": 23769, "user_id": 98422, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/fGGLP.jpg?s=128&g=1", "display_name": "Gary McGill", "link": "https://stackoverflow.com/users/98422/gary-mcgill"}, "is_accepted": true, "score": 2, "last_activity_date": 1440618379, "creation_date": 1440618379, "answer_id": 32235429, "question_id": 32235106, "link": "https://stackoverflow.com/questions/32235106/excel-vba-public-scope-for-instance-of-user-defined-class/32235429#32235429", "title": "Excel VBA - Public Scope for Instance of User Defined Class", "body": "<p>Just change the instancing of the config class to public? Click on the Config class, and set the instancing via the properties window.</p>\n"}], "owner": {"reputation": 125, "user_id": 4986687, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33984acccb9b3208545055a839c2b6e6?s=128&d=identicon&r=PG&f=1", "display_name": "Francisco Rubin Capalbo", "link": "https://stackoverflow.com/users/4986687/francisco-rubin-capalbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "accepted_answer_id": 32235429, "answer_count": 1, "score": 2, "last_activity_date": 1440618379, "creation_date": 1440617184, "last_edit_date": 1592644375, "question_id": 32235106, "link": "https://stackoverflow.com/questions/32235106/excel-vba-public-scope-for-instance-of-user-defined-class", "title": "Excel VBA - Public Scope for Instance of User Defined Class", "body": "<p>I have recently started to program with Excel VBA.\nComing from a Java environment, I am trying to apply OOP principles to VBA, but I'm having a hard time doing so.</p>\n<p>I created a Config Class Module to encapsulate all the initial configuration and provide easy and controlled access to it.</p>\n<p>From Workbook_Open() Function I initialize the Config object.</p>\n<p>What I want to do is to keep that Instance in a Public Scope to allow access to the same instance from the complete program. (static variable or singleton in java)</p>\n<pre><code>Option Explicit\n\nDim conf As Config\n\nPrivate Sub Workbook_Open()\n    Set conf = New Config\n\nEnd Sub\n</code></pre>\n<p>Doing this works, but the scope is not public.</p>\n<p>When I put the Public keyword instead of Dim, I get the following error:</p>\n<blockquote>\n<p>Compile error:</p>\n<p>Private object modules cannot be used in public object modules as parameters or return types for public procedures, as public data members, or as fields of public user defined types</p>\n</blockquote>\n<p>So my question is, isn't there any way to keep an object instance public?</p>\n<p>And if not, what would be the best way of organizing the project in an object oriented way without keeping everything together in the Workbook module?</p>\n<p>Thanks for your time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1440616826, "post_id": 32234850, "comment_id": 52352305, "body": "Have you tried: ChangeFileOpenDirectory &quot;Path&quot;     ?"}, {"owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "edited": false, "score": 0, "creation_date": 1440616846, "post_id": 32234850, "comment_id": 52352316, "body": "You shouldn&#39;t try to get around the limit at all. <a href=\"http://answers.microsoft.com/en-us/office/forum/office_2007-office_install/unable-to-open-excelxls-files-with-very-long/290c6e39-929a-4788-95c4-d3364a7060f7\" rel=\"nofollow noreferrer\">Link.</a> A 260 character limit is immanent to Windows, Office programs have some variing shorter limits."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440617357, "post_id": 32234850, "comment_id": 52352598, "body": "Sounds like it&#39;s the path/directory names that are too long. Can you not shorten them? Even if you resolve the problem, tomorrow another file will have the same problem."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440629468, "post_id": 32234850, "comment_id": 52358169, "body": "Try <code>CurDir &amp; documentName</code>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1440652754, "post_id": 32234850, "comment_id": 52363799, "body": "Try <b><code>Application.DefaultFilePath = newSavePath</code></b> then <code>wrdDoc.SaveAs documentname</code>"}, {"owner": {"reputation": 55, "user_id": 5269959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c261adc4488400a80e9e73266d4451?s=128&d=identicon&r=PG&f=1", "display_name": "seb2704", "link": "https://stackoverflow.com/users/5269959/seb2704"}, "edited": false, "score": 0, "creation_date": 1440706538, "post_id": 32234850, "comment_id": 52397196, "body": "i couldnt shorten them, but i&#39;m mapped the folder now to a drive to shorten the path, that works fine. ChangeFileOpenDirectory works also fine for paths smaller then 255, I test tomorrow at work, if it works for paths bigger then 255 too. Thanks for help :)"}], "owner": {"reputation": 55, "user_id": 5269959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c261adc4488400a80e9e73266d4451?s=128&d=identicon&r=PG&f=1", "display_name": "seb2704", "link": "https://stackoverflow.com/users/5269959/seb2704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440616325, "creation_date": 1440616325, "question_id": 32234850, "link": "https://stackoverflow.com/questions/32234850/saveas-dont-save-at-the-current-folder-vba", "title": ".saveas dont save at the current folder VBA", "body": "<p>I Want to save a word document in a folder with a absolute path > 255 characters, but that doesn't work on vba. So I found a solution that I could change my current directory to this folder and then it should be possible to save the document in this folder.</p>\n\n<p>So I did it this way</p>\n\n<p><code>ChDir newSavePath\n wrdDoc.SaveAs documentname</code> </p>\n\n<p>the problem now is, that my word document get always saved in the Document folder of my homedirectory. \nAny ideas?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1440616554, "post_id": 32234784, "comment_id": 52352149, "body": "Try <code>instr()</code> and <code>mid()</code>"}, {"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440616979, "post_id": 32234784, "comment_id": 52352385, "body": "Never ever done anything like this beffore so these functions are new to me."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1440617058, "post_id": 32234784, "comment_id": 52352434, "body": "Excellent. Sounds like you have an opportunity to learn something new!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 1, "creation_date": 1440617061, "post_id": 32234784, "comment_id": 52352435, "body": "so type in google, MSDN Instr and MSDN Mid  and you will get a full detailed explanation for each"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1440617091, "post_id": 32234784, "comment_id": 52352451, "body": "Yes VBA would be the best choice. See this: <a href=\"https://msdn.microsoft.com/en-us/library/05e63829(v=VS.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/05e63829(v=VS.90).aspx</a> , <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/8460tsh1(v=vs.90).aspx</a> @Sorceri ahead of me i see ;)"}, {"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 1, "creation_date": 1440617179, "post_id": 32234784, "comment_id": 52352504, "body": "Thanks Chaps. I will get on this now ^_^. Will report back what I have done"}, {"owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "edited": false, "score": 2, "creation_date": 1440617214, "post_id": 32234784, "comment_id": 52352523, "body": "Why would a formula not be good in this circumstance?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1440617362, "post_id": 32234784, "comment_id": 52352600, "body": "Hint: use the position returned by the first <a href=\"https://msdn.microsoft.com/en-us/library/8460tsh1%28v=vs.90%29.aspx\" rel=\"nofollow noreferrer\">InStr function</a> to start the search with the second."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1440617403, "post_id": 32234784, "comment_id": 52352627, "body": "@neosegauk Theoretically a formula would work, but it would probably be a bit more complex. You&#39;d use the <code>Find</code> formula to find the instance of <code>Query Summery -</code> then use three more nested <code>Find</code> formulas to find the third instance of the delimiter &quot;====&quot;."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1440618021, "post_id": 32234784, "comment_id": 52352974, "body": "@pnuts touch&#233;! I assumed that the entries could be in any order, not necessarily <i>always</i> in the order submitted, so I accounted for that. If not, your approach makes more sense."}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1440618567, "post_id": 32234784, "comment_id": 52353250, "body": "@pnuts That&#39;s definitely a reasonable assumption. I&#39;m just a perpetual pessimist! :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440617513, "post_id": 32235136, "comment_id": 52352697, "body": "Does this trim out <code>vbCrLF</code> and <code>vbLF</code> extraneous (and likely undesired) characters?"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1440617881, "post_id": 32235136, "comment_id": 52352899, "body": "@Jeeped I specifically trimmed out <code>vbLF</code> using <code>Chr(10)</code> in the nested replace function. I suppose I could&#39;ve trimmed all of them, but I was waiting to see if that sufficed."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": false, "score": 0, "last_activity_date": 1440617278, "creation_date": 1440617278, "answer_id": 32235136, "question_id": 32234784, "link": "https://stackoverflow.com/questions/32234784/extract-text-after-charecter-and-string/32235136#32235136", "title": "Extract Text After Charecter and String", "body": "<p>I'd recommend using a custom function in VBA, if you're willing to go that route. The code below creates a User Defined Function with three parameters: input string, the delimiter (or separator), and the option to return.</p>\n\n<p>Assuming the string is in Cell <code>A1</code>, the formula would look like this:</p>\n\n<p><code>=CustomSplit(A1,\"============\", \"Query Summery -\")</code></p>\n\n<p>The code behind, to be inserted into a standard module, looks as follows:</p>\n\n<pre><code>Function CustomSplit(sInput As String, sDelimiter As String, sFind As String)\n    Dim sArray() As String\n\n    sArray() = Split(sInput, sDelimiter)\n\n    For i = LBound(sArray) To UBound(sArray)\n        If sArray(i) Like \"*\" &amp; sFind &amp; \"*\" Then\n            CustomSplit = Application.Trim(Replace(Replace(sArray(i), sFind, \"\"), Chr(10), \"\"))\n            Exit Function\n        End If\n    Next i\n    CustomSplit = CVErr(xlErrNull)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 2650824, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/GSZBl.jpg?s=128&g=1", "display_name": "neosegauk", "link": "https://stackoverflow.com/users/2650824/neosegauk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440617545, "creation_date": 1440616094, "last_edit_date": 1531161705, "question_id": 32234784, "link": "https://stackoverflow.com/questions/32234784/extract-text-after-charecter-and-string", "title": "Extract Text After Charecter and String", "body": "<p>Kind of lost on what to do here. I have a a cell in A2 that is in the format shown below. I need to extract all text after Query Summery - and to end at the ============ beffore Query. All it should pull through is New event testing in area 15. I have mutiple entries like this in the A column but in the same format. Not a clue on how I would extract this. Would VBA be the best choice? </p>\n\n<pre><code>============\nMain Data - Information on this is the main data\n============\nQuery Summery - New event testing in area 15\n============\nQuery - New mine created for testing in minecraft and brought forwards 15 times today\n============\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440616369, "post_id": 32234775, "comment_id": 52352032, "body": "Have you tried using VBA yourself? Please show your code thus far, including the areas you are having trouble with. This site is not intended for &#39;give me code&#39; requests, it is for specific Q&amp;A."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 3642399, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bff1861bb777e4d36ffb556ee06bb766?s=128&d=identicon&r=PG&f=1", "display_name": "user3642399", "link": "https://stackoverflow.com/users/3642399/user3642399"}, "edited": false, "score": 0, "creation_date": 1440697978, "post_id": 32237007, "comment_id": 52392664, "body": "Thanks for your input!!. Is there a way to do it without naming the hyperlink in the code?"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 3, "last_activity_date": 1440711958, "last_edit_date": 1440711958, "creation_date": 1440624452, "answer_id": 32237007, "question_id": 32234775, "link": "https://stackoverflow.com/questions/32234775/vba-to-count-of-clicks-on-a-hyperlink/32237007#32237007", "title": "vba to count # of clicks on a hyperlink", "body": "<p>You can try the FollowHyperlink event</p>\n\n<p>The Set up</p>\n\n<p><a href=\"https://i.stack.imgur.com/A1pxF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A1pxF.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The Result when clicking the HyperLink</p>\n\n<p><a href=\"https://i.stack.imgur.com/0bqTE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0bqTE.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is the code that goes into the worksheet Module</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n\n    Dim s As Range\n    Set s = Target.Range\n\n    s.Offset(0, 1) = s.Offset(0, 1) + 1\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 3642399, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bff1861bb777e4d36ffb556ee06bb766?s=128&d=identicon&r=PG&f=1", "display_name": "user3642399", "link": "https://stackoverflow.com/users/3642399/user3642399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462526464, "creation_date": 1440616065, "last_edit_date": 1462526464, "question_id": 32234775, "link": "https://stackoverflow.com/questions/32234775/vba-to-count-of-clicks-on-a-hyperlink", "title": "vba to count # of clicks on a hyperlink", "body": "<p>I have a tab in a workbook that has over 20 hyperlinks. I want keep track of clicks on a hyperlink to see which hyperlink is utilized the most. so lets say all the hyperlinks are in column \"A\" so ideally if I click on a hyperlink I want the number of clicks on cell \"B\". Hoping someone can help. I tried using some formulas but no luck.</p>\n\n<p>below is the code that I am using but doesn't work and there isn't a error message. </p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink) \n    ThisWorkbook.Activate \n    Selection.Offset(0, 3).FormulaR1C1 = Selection.Offset(0, 3).Value + 1 \nEnd Sub \n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1440616149, "creation_date": 1440616149, "answer_id": 32234801, "question_id": 32234717, "link": "https://stackoverflow.com/questions/32234717/error-in-a-macro-to-return-yellow-rows/32234801#32234801", "title": "error in a macro to return yellow rows", "body": "<p>I am guesssing it is the Rows(i) reference.  just use the cell and select the entire row</p>\n\n<pre><code>Sub pintar_amarelo()\n\nDim i As Integer\n\n    For i = 200 To 2 Step -1\n\n        If Cells(i, 6).Value = \"Pgto Proximo\" Then\n\n            Cells(i, 6).EntireRow.Interior.ColorIndex = 6\n\n         Else\n\n            Cells(i, 6).EntireRow.Interior.ColorIndex = 0\n\n         End If\n\n    Next i\n\nApplication.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1440616618, "post_id": 32234822, "comment_id": 52352190, "body": "Rows returns a range object.  Rows(i).EntireRow.Interior.ColorIndex = 6 does indeed work as long as i is a valid integer value."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1440616661, "post_id": 32234822, "comment_id": 52352211, "body": "@user7004  what line returns Type Mismatch?"}], "tags": [], "owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1440617104, "last_edit_date": 1440617104, "creation_date": 1440616211, "answer_id": 32234822, "question_id": 32234717, "link": "https://stackoverflow.com/questions/32234717/error-in-a-macro-to-return-yellow-rows/32234822#32234822", "title": "error in a macro to return yellow rows", "body": "<p><strong>Edited from prior attempt at answering through code correction [for which I was incorrect</strong></p>\n\n<p>Have you considered simply considered a conditional format?</p>\n\n<p>Something like:</p>\n\n<p>Select the entire workbook. Click Conditional Formatting -> New Rule.</p>\n\n<pre><code>=$F1=\"Pgto Proximo\"\n</code></pre>\n\n<p>Then make that highlight yellow; this will impact the entire row; all other rows will be highlighted blank.</p>\n"}], "owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1440617104, "creation_date": 1440615887, "last_edit_date": 1531164843, "question_id": 32234717, "link": "https://stackoverflow.com/questions/32234717/error-in-a-macro-to-return-yellow-rows", "title": "error in a macro to return yellow rows", "body": "<p>i have a macro to identify if a cell says \"Pgto Proximo\" and color the whole row if yes. There is a type mistmatch error and I can't figure out what is wrong. I would appreciate your help</p>\n\n<pre><code>Sub pintar_amarelo()\n\nDim i As Integer\n\n    For i = 200 To 2 Step -1\n\n        If Cells(i, 6).Value = \"Pgto Proximo\" Then\n\n            Rows(i).EntireRow.Interior.ColorIndex = 6\n\n         Else\n\n            Rows(i).EntireRow.Interior.ColorIndex = 0\n\n         End If\n\n    Next i\n\nApplication.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 921, "user_id": 5203628, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GwHC7.png?s=128&g=1", "display_name": "Rob S.", "link": "https://stackoverflow.com/users/5203628/rob-s"}, "edited": false, "score": 0, "creation_date": 1440617263, "post_id": 32234756, "comment_id": 52352553, "body": "I believe this response solves the issue you are having.  If so, please credit with a check mark.  If not, let me know what issues you have and I will attempt to address them."}, {"owner": {"reputation": 35, "user_id": 5194589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fbb23972c9df26d833f5808db088df?s=128&d=identicon&r=PG&f=1", "display_name": "K Hill", "link": "https://stackoverflow.com/users/5194589/k-hill"}, "edited": false, "score": 0, "creation_date": 1440617385, "post_id": 32234756, "comment_id": 52352614, "body": "Perfect! Thank you, that was a miss on my part."}], "tags": [], "owner": {"reputation": 921, "user_id": 5203628, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GwHC7.png?s=128&g=1", "display_name": "Rob S.", "link": "https://stackoverflow.com/users/5203628/rob-s"}, "is_accepted": true, "score": 1, "last_activity_date": 1440615999, "creation_date": 1440615999, "answer_id": 32234756, "question_id": 32234672, "link": "https://stackoverflow.com/questions/32234672/excel-vba-when-using-saveas-filename-strange-things-are-happening-to-the-file-e/32234756#32234756", "title": "Excel VBA When using SaveAs Filename, strange things are happening to the file extension?", "body": "<p>Your file extension in the code needs to be outside the Format function.  See the suggested approach below.</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=curPath &amp; cell.Value &amp; Format(Now, \"dmmmyyyy\") &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5194589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46fbb23972c9df26d833f5808db088df?s=128&d=identicon&r=PG&f=1", "display_name": "K Hill", "link": "https://stackoverflow.com/users/5194589/k-hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 32234756, "answer_count": 1, "score": 1, "last_activity_date": 1440615999, "creation_date": 1440615716, "question_id": 32234672, "link": "https://stackoverflow.com/questions/32234672/excel-vba-when-using-saveas-filename-strange-things-are-happening-to-the-file-e", "title": "Excel VBA When using SaveAs Filename, strange things are happening to the file extension?", "body": "<p>This is the line in my code:\nActiveWorkbook.SaveAs Filename:=curPath &amp; cell.Value &amp; Format(Now, \"dmmmyyyy\" &amp; \".xlsx\"), FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False</p>\n\n<p>Here's the extension from a couple of the files:\n.xl47x\n.xl35x</p>\n\n<p>I tried using \".xlsm\" and I got:\n.xl78\n.xl22</p>\n\n<p>I can force change the name and then the file will open - but why is it changing the extension? Does someone know what is going on? I've never seen this.  Thank you!</p>\n"}, {"tags": ["excel", "image", "vba", "export"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1440617356, "post_id": 32234039, "comment_id": 52352596, "body": "Is the <code>UserForm</code> open in modal mode? This might be interfering with the &#39;Appearance:=xlScreen&#39; parameter, maybe try &#39;Appearance:=xlPrinter&#39;?"}, {"owner": {"reputation": 1, "user_id": 5269868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b311e1569ed97769a501a9101873baa3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5269868/chris"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1440766207, "post_id": 32234039, "comment_id": 52421636, "body": "Hey, I tried that but it threw and error, &quot;Copy picture method of range class failed&quot;"}, {"owner": {"reputation": 1, "user_id": 5269868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b311e1569ed97769a501a9101873baa3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5269868/chris"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1440766364, "post_id": 32234039, "comment_id": 52421724, "body": "It is open in modal mode.  I tried switching them and it worked perfectly."}], "owner": {"reputation": 1, "user_id": 5269868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b311e1569ed97769a501a9101873baa3?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5269868/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 167, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1440613888, "creation_date": 1440613526, "last_edit_date": 1440613888, "question_id": 32234039, "link": "https://stackoverflow.com/questions/32234039/vba-code-giving-different-output-when-copy-and-pasting-an-image-into-a-chart", "title": "VBA code giving different output when copy and pasting an image into a chart", "body": "<p>I'm having an issue with code to copy an image of a range to a chart object.  The code works perfectly when run from <code>ThisWorkbook</code>. However, when I attempt to run the code via a <code>userform</code>, it only copies over a blank image. It is the exact same code.</p>\n\n<p>Below is the code:</p>\n\n<pre><code>Dim rng As Range\nDim imgName As String\n\nSet rng = Worksheets(\"Summary Stats\").Range(\"A1:U11\")\nimgName = \"C:\\Users\\************\\Desktop\\Temp Files\\SummaryPicture.gif\"\n\nrng.CopyPicture Appearance:=xlScreen, Format:=xlBitmap\n\nWith Worksheets(\"Summary Stats\").ChartObjects.Add(Left:=rng.Left, Top:=rng.Top, _\n    Width:=rng.Width, Height:=rng.Height)\n    .Name = \"ChartVolumeMetricsDevEXPORT\"\n    .Activate\nEnd With\n\nActiveChart.Paste\n\nWorksheets(\"Summary Stats\").ChartObjects(\"ChartVolumeMetricsDevEXPORT\").Chart.Export imgName\nWorksheets(\"Summary Stats\").ChartObjects(\"ChartVolumeMetricsDevEXPORT\").Delete\n</code></pre>\n"}, {"tags": ["excel", "visibility", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440624336, "post_id": 32236177, "comment_id": 52356180, "body": "Thanks for sharing your solution. If you wait 48 hours, you can return and mark it as the answer to your question."}], "tags": [], "owner": {"reputation": 11, "user_id": 5269647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63defdc6c4d2ea069f6cb1f0f84ed47?s=128&d=identicon&r=PG&f=1", "display_name": "Heidi W", "link": "https://stackoverflow.com/users/5269647/heidi-w"}, "is_accepted": false, "score": 1, "last_activity_date": 1440621098, "creation_date": 1440621098, "answer_id": 32236177, "question_id": 32233744, "link": "https://stackoverflow.com/questions/32233744/auto-filter-to-select-just-the-visible-rows/32236177#32236177", "title": "Auto filter to select just the visible rows", "body": "<p>I figured it out.... Here is what I did. Thanks all!</p>\n\n<p>I used this If ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible).Areas.Count &lt;= 2\ninstead of this (ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell)) = 2</p>\n\n<pre><code>Dim criteria As String\nDim F As Range\nSet Rng = Sheets(\"Reference\").Range(\"W2:W36\")\nFor Each F In Rng\n    criteria = F\n    ActiveSheet.Range(\"$AV$1\").AutoFilter Field:=48, Criteria1:=\"=*BULK SUBSERVIENT*\", Operator:=xlAnd\n    ActiveSheet.Range(\"$K$1\").AutoFilter Field:=11, Criteria1:=criteria\n    Range(\"A2:CM\" &amp; ActiveSheet.UsedRange.Rows.Count + 1) _\n        .Cells.SpecialCells(xlCellTypeVisible).Rows(1).Select\n    If ActiveCell.Value = vbNullString Then\n        ActiveSheet.ShowAllData\n        Else\n        If ActiveSheet.UsedRange.SpecialCells(xlCellTypeVisible).Areas.Count &lt;= 2 Then\n            'Range(Selection).Select\n            Selection.Copy\n            Sheets(\"Bulk Subservient\").Select\n            ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n            ActiveSheet.Paste\n            Call cleanup\n        Else\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"Bulk Subservient\").Select\n        ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n        ActiveSheet.Paste\n        Call cleanup\n    End If\n    End If\n  Next F\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3960, "user_id": 205034, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/63c343cb3c9ff329bd82fad33f1d59fb?s=128&d=identicon&r=PG", "display_name": "Makah", "link": "https://stackoverflow.com/users/205034/makah"}, "is_accepted": false, "score": 0, "last_activity_date": 1440621937, "creation_date": 1440621937, "answer_id": 32236402, "question_id": 32233744, "link": "https://stackoverflow.com/questions/32233744/auto-filter-to-select-just-the-visible-rows/32236402#32236402", "title": "Auto filter to select just the visible rows", "body": "<p>I think your code could be much cleaner than this. I prefer to use an auxiliar funcion to make this filter. Something like this:</p>\n\n<pre><code>Function MyFilter(criteria as string) as Range\n    Set tableRange = ActiveSheet.UsedRange\n\n  ' Filter \n    With tableRange\n        Call .AutoFilter(48, \"*BULK SUBSERVIENT*\")\n        Call .AutoFilter(11, criteria)\n    End With\n\n    On Error Resume Next\n      'This...\n      Set selectedRange = tableRange.SpecialCells(xlCellTypeVisible)\n\n      '...Or (how to remover title).\n      Set selectedRange = Intersect(tableRange.SpecialCells(xlCellTypeVisible), .[2:1000000]) \n    On Error GoTo 0\n\n    With tableRange\n        Call .AutoFilter(11)\n        Call .AutoFilter(48)\n    End With\n\n    'Empty Criteria\n    If WorksheetFunction.CountA(selectedRange) &lt; 2 Then\n        Exit Sub\n    End If\n\n    Set MyFilter = selectedRange        \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1440624172, "creation_date": 1440624172, "answer_id": 32236941, "question_id": 32233744, "link": "https://stackoverflow.com/questions/32233744/auto-filter-to-select-just-the-visible-rows/32236941#32236941", "title": "Auto filter to select just the visible rows", "body": "<p>Here is your original code rewritten using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow\">Range.CurrentRegion property</a> to define the range of cells to be filtered.</p>\n\n<pre><code>Dim criteria As String\nDim F As Range, rng As Range\n\nWith Worksheets(\"Reference\")\n    Set rng = .Range(.Cells(2, 23), .Cells(Rows.Count, 23).End(xlUp))\nEnd With\n\nWith ActiveSheet    '&lt;~~ set this to worksheets(\"Sheet1\") as appropriate\n    If .AutoFilterMode Then .AutoFilterMode = False\n    With .Cells(1, 1).CurrentRegion\n        For Each F In rng\n            criteria = F\n            .AutoFilter Field:=48, Criteria1:=\"*BULK SUBSERVIENT*\"\n            .AutoFilter Field:=11, Criteria1:=criteria\n            With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n                If CBool(Application.Subtotal(103, .Cells)) Then\n                    .Copy Destination:=Sheets(\"Bulk Subservient\").Cells(Rows.Count, 1).End(xlUp).Offset(1)\n                End If\n            End With\n        Next F\n    End With\n    If .AutoFilterMode Then .AutoFilterMode = False\nEnd With\n</code></pre>\n\n<p>Here is the same thing that collects all of the criteria terms from the Reference worksheet into a variant array and uses that to filter for all terms at once.</p>\n\n<pre><code>Dim rng As Range\nDim vCRITERIA As Variant, v As Long\n\nWith Worksheets(\"Reference\")\n    ReDim vCRITERIA(1 To 1)   '&lt;~~for alternate method\n    For Each rng In .Range(.Cells(2, 23), .Cells(Rows.Count, 23).End(xlUp))\n        vCRITERIA(UBound(vCRITERIA)) = rng.Value2\n        ReDim Preserve vCRITERIA(UBound(vCRITERIA) + 1)\n    Next rng\n    ReDim Preserve vCRITERIA(UBound(vCRITERIA) - 1)\nEnd With\n\nWith ActiveSheet    '&lt;~~ set this to worksheets(\"Sheet1\") as appropriate\n    If .AutoFilterMode Then .AutoFilterMode = False\n    With .Cells(1, 1).CurrentRegion\n        .AutoFilter Field:=48, Criteria1:=\"*BULK SUBSERVIENT*\"\n        .AutoFilter Field:=11, Criteria1:=(vCRITERIA), Operator:=xlFilterValues\n        With .Resize(.Rows.Count - 1, .Columns.Count).Offset(1, 0)\n            If CBool(Application.Subtotal(103, .Cells)) Then\n                .Copy Destination:=Sheets(\"Bulk Subservient\").Cells(Rows.Count, 1).End(xlUp).Offset(1)\n            End If\n        End With\n    End With\n    If .AutoFilterMode Then .AutoFilterMode = False\nEnd With\n</code></pre>\n\n<p>The latter is likely a few milli-seconds faster than the first.</p>\n\n<p>The worksheet's <a href=\"https://support.office.com/en-us/article/SUBTOTAL-function-e27c301c-be9a-458b-9d12-b9a2ce3c62af\" rel=\"nofollow\">SUBTOTAL function</a> never includes filtered or hidden rows so asking for a count will determine if there is anything to copy. Resizing and offsetting moves to the filtered range.</p>\n\n<p>You will need to reincorporate the Cleanup subroutine.</p>\n"}], "owner": {"reputation": 11, "user_id": 5269647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63defdc6c4d2ea069f6cb1f0f84ed47?s=128&d=identicon&r=PG&f=1", "display_name": "Heidi W", "link": "https://stackoverflow.com/users/5269647/heidi-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1440624172, "creation_date": 1440612608, "last_edit_date": 1531161705, "question_id": 32233744, "link": "https://stackoverflow.com/questions/32233744/auto-filter-to-select-just-the-visible-rows", "title": "Auto filter to select just the visible rows", "body": "<p>I have this code. It loops through a list for the filtering criteria, then if no data to select it shows all data again and loops to the next criteria. If it shows data it end(slDown) and selects all the data showing, copies it and pastes it into another worksheet. </p>\n\n<p>The cleanup script cleans any blank rows and columns and then returns to the original data sheet and deletes the data selected for the copy paste.</p>\n\n<p>The problem is when there is just one row. It moves to the row with data, but when I End(xlDown), it shoots all the way to the bottom and the paste then causes the macro to freeze up.</p>\n\n<p>I nested another if statement to capture if there is only one line of data visible, but I cannot get it to function correctly. Any Suggestions on the nested if statement? </p>\n\n<pre><code>Dim criteria As String\nDim F As Range\nSet Rng = Sheets(\"Reference\").Range(\"W2:W36\")\nFor Each F In Rng\n    criteria = F\n    ActiveSheet.Range(\"$AV$1\").AutoFilter Field:=48, Criteria1:=\"=*BULK SUBSERVIENT*\", Operator:=xlAnd\n    ActiveSheet.Range(\"$K$1\").AutoFilter Field:=11, Criteria1:=criteria\n    Range(\"A2:CM\" &amp; ActiveSheet.UsedRange.Rows.Count + 1) _\n        .Cells.SpecialCells(xlCellTypeVisible).Rows(1).Select\n    If ActiveCell.Value = vbNullString Then\n        ActiveSheet.ShowAllData\n        Else\n        If (ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell)) = 2 Then\n            'Range(Selection).Select\n            Selection.Copy\n            Sheets(\"Bulk Subservient\").Select\n            ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n            ActiveSheet.Paste\n            Call cleanup\n        Else\n        Range(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n        Sheets(\"Bulk Subservient\").Select\n        ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n        ActiveSheet.Paste\n        Call cleanup\n    End If\n    End If\n  Next F\n</code></pre>\n"}, {"tags": ["vba", "perl", "shell"], "answers": [{"comments": [{"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1440705669, "post_id": 32234506, "comment_id": 52396740, "body": "I am getting a windows can not find <code>&quot;c:\\cygwin\\bin\\bash.exe &#47;home&#47;cmccabe&#47;Run.sh&quot;</code> maybe it needs the full path <code>&quot;c:\\cygwin\\bin\\bash.exe c:\\cygwin\\home\\cmccabe\\Run.sh&#39;</code>, but then won&#39;t it try to read the full path as is and throw the same error? Thank you :)."}], "tags": [], "owner": {"reputation": 110113, "user_id": 168657, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f14e7610fca39322ebbf23530def15f8?s=128&d=identicon&r=PG", "display_name": "mob", "link": "https://stackoverflow.com/users/168657/mob"}, "is_accepted": false, "score": 0, "last_activity_date": 1440615139, "creation_date": 1440615139, "answer_id": 32234506, "question_id": 32233437, "link": "https://stackoverflow.com/questions/32233437/proper-way-to-call-a-shell-file-from-vba-written-in-excel-2010/32234506#32234506", "title": "proper way to call a shell file from VBA written in excel 2010", "body": "<p>Of course it is. And since it appears that you have Cygwin installed, you already have a shell script interpreter on your system:</p>\n\n<pre><code>Set objShell = CreateObject(\"Shell.Application\")\nobjShell.ShellExecute \"c:\\cygwin\\bin\\bash.exe /home/cmccabe/Run.sh\"\n</code></pre>\n"}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440615139, "creation_date": 1440611647, "question_id": 32233437, "link": "https://stackoverflow.com/questions/32233437/proper-way-to-call-a-shell-file-from-vba-written-in-excel-2010", "title": "proper way to call a shell file from VBA written in excel 2010", "body": "<p>I can call a <code>perl</code> script from <code>VBA</code> doing:</p>\n\n<pre><code>Set objShell = CreateObject(\"Shell.Application\")\n    objShell.ShellExecute \"c:\\cygwin\\bin\\perl.exe C:\\cygwin\\home\\cmccabe\\get_imagene_spikein_probe_values.pl\"\n</code></pre>\n\n<p>However, is it possible to call a .sh file instead?  The .sh is called Run.sh and within it is a reference to the <code>perl</code> script.  Thank you :).</p>\n"}, {"tags": ["sql", "database", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1440612892, "post_id": 32233355, "comment_id": 52349977, "body": "Hello Someguy welcome to StackOverflow, next time try to provide a  <a href=\"http://sqlfiddle.com/#!15/5368b/6\" rel=\"nofollow noreferrer\"><b>SqlFiddle</b></a> so we can understand the problem better and give you an answer  much faster \u2013 Also please read <a href=\"http://stackoverflow.com/help/how-to-ask\"><b>How to ask</b></a>  and <a href=\"http://stackoverflow.com/help/mcve\"><b>How to create a Minimal, Complete, and Verifiable example.</b></a>"}, {"owner": {"reputation": 3, "user_id": 5269713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f9d1a385cd3ee375f28e9dce4421f3?s=128&d=identicon&r=PG&f=1", "display_name": "someguy", "link": "https://stackoverflow.com/users/5269713/someguy"}, "reply_to_user": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1440773703, "post_id": 32233355, "comment_id": 52426847, "body": "Thank you, I didn&#39;t know about SqlFiddle."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5269713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f9d1a385cd3ee375f28e9dce4421f3?s=128&d=identicon&r=PG&f=1", "display_name": "someguy", "link": "https://stackoverflow.com/users/5269713/someguy"}, "edited": false, "score": 0, "creation_date": 1440768958, "post_id": 32233893, "comment_id": 52423500, "body": "That worked perfectly! Thank you very much for taking the time to help a beginner!"}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1440774049, "post_id": 32233893, "comment_id": 52427060, "body": "One thing <code>WHERE (([Contact]![CompanyID]=[Company]![ID]));</code> is redundant because you already making a <code>join on Company.ID = Contact.CompanyID </code>"}], "tags": [], "owner": {"reputation": 36, "user_id": 2084432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2jVyp.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/2084432/mike"}, "is_accepted": true, "score": 0, "last_activity_date": 1440613919, "last_edit_date": 1440613919, "creation_date": 1440613094, "answer_id": 32233893, "question_id": 32233355, "link": "https://stackoverflow.com/questions/32233355/update-query-in-access-2010-update-based-on-matching-fields/32233893#32233893", "title": "Update Query in Access 2010-Update based on matching fields", "body": "<p>Because in your join condition you are selecting the Contact.ContactCompany which already has same ContactCompany name.</p>\n\n<pre><code>AND (Company.ContactCompany = Contacts.ContactCompany)\n</code></pre>\n\n<p>Remove that \"AND\" part and your query should look something like this.</p>\n\n<pre><code>UPDATE Company \nINNER JOIN Contact ON Company.ID = Contact.CompanyID \nSET Contact.ContactCompany = [Company]![ContactCompany] \nWHERE (([Contact]![CompanyID]=[Company]![ID]));\n</code></pre>\n\n<p>P.S. Make sure you have backup of your database before updating</p>\n"}, {"tags": [], "owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "is_accepted": false, "score": 0, "last_activity_date": 1440613417, "creation_date": 1440613417, "answer_id": 32234000, "question_id": 32233355, "link": "https://stackoverflow.com/questions/32233355/update-query-in-access-2010-update-based-on-matching-fields/32234000#32234000", "title": "Update Query in Access 2010-Update based on matching fields", "body": "<p>I use the query assitance from Access</p>\n\n<p>You dont need <code>AND (Company.ContactCompany = Contacts.ContactCompany)</code> you are already saying those are different now.</p>\n\n<pre><code>UPDATE Company \nINNER JOIN Contact \n      ON Company.CompanyID = Contact.CompanyID \nSET Contact.CompanyName = [Company].[CompanyName];\n</code></pre>\n\n<p>You could add this line to only update those different </p>\n\n<pre><code>WHERE Contact.CompanyName &lt;&gt; = [Company].[CompanyName]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/nK011.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nK011.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 3, "user_id": 5269713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54f9d1a385cd3ee375f28e9dce4421f3?s=128&d=identicon&r=PG&f=1", "display_name": "someguy", "link": "https://stackoverflow.com/users/5269713/someguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1516, "favorite_count": 0, "accepted_answer_id": 32233893, "answer_count": 2, "score": 0, "last_activity_date": 1594651702, "creation_date": 1440611332, "last_edit_date": 1594651702, "question_id": 32233355, "link": "https://stackoverflow.com/questions/32233355/update-query-in-access-2010-update-based-on-matching-fields", "title": "Update Query in Access 2010-Update based on matching fields", "body": "<p>I'm an intern at a small company who is making some fixes to a 15 year old access database that is used to keep track of customers, jobs, etc. I'm trying to write an update query and can't seem to get to work the way I need it to. Here is my sitation.</p>\n\n<p>I have two tables. One contains Company information. The other contains Contact information. The primary key of the company table is also in the contact table, for a one-to-many relationship. E.g., if a company has 3 contacts, the CompanyID number that is from the primary key of the Company table is associated with the three contacts in the Contacts Table.</p>\n\n<p>Ok. Now the problem is that there is some legacy code in a form, called \"Company\", that searches simultaneously for both contacts and companies. The problem is that there is a field in the contacts table called \"ContactCompany\" that is being used by this old search function. If a user changes the Company name with the form, the Company name is updated on the Company table, but NOT in the Contacts table.</p>\n\n<p>I decided that an update query would be the way to go, to sync up the Company Name information on both forms. I tried to design it so that if the ID numbers matched between the tables, the company name in the Company table would get copied over to the contacts table. My code is below:</p>\n\n<pre><code>UPDATE Company INNER JOIN Contacts ON (Company.ID = Contacts.CompanyID) AND (Company.ContactCompany = Contacts.ContactCompany) SET Contacts.ContactCompany = [Company].[ContactCompany] WHERE (([Contacts].[CompanyID]=[Company].[ID]));\n</code></pre>\n\n<p>When I run the query Access tells me that it is updating X number of records, but the records do not update. </p>\n\n<p>Please note that I used query builder; the SQL code was auto-generated by access when I go into SQL view.</p>\n\n<p>I'm not very experienced with VB; all of my knowledge has been from googling stuff. If someone could give me some pointers on what I'm doing wrong or how to proceed I'd be grateful. Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1440612289, "post_id": 32233034, "comment_id": 52349636, "body": "Did you try <code>ws.UsedRange.Replace What:=&quot;-&quot;, Replacement:=&quot;&#39;@&quot;, LookAt:=xlPart</code> (or <code>Replacement:=&quot;&quot;&quot;@&quot;&quot;&quot;</code>)"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "edited": false, "score": 0, "creation_date": 1440612601, "post_id": 32233034, "comment_id": 52349827, "body": "Am I missing it? Is <code>aCell</code> declared anywhere in your code?"}, {"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1440612824, "post_id": 32233034, "comment_id": 52349943, "body": "<code>aCell</code> was a mistake I have changed my code to reflect this.  Sorry about that, still errors"}], "answers": [{"tags": [], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "is_accepted": true, "score": 0, "last_activity_date": 1442026781, "last_edit_date": 1442026781, "creation_date": 1440697551, "answer_id": 32256151, "question_id": 32233034, "link": "https://stackoverflow.com/questions/32233034/ultimatecleansheet-code-errors/32256151#32256151", "title": "UltimateCleanSheet Code errors", "body": "<p>After much ado I came up with</p>\n\n<p>Edit Addition and improvment</p>\n\n<pre><code>'Sheet Names To Clean\n'ID Column Number\n'Name (e.g John Doe) Column Number\n'Dilimiter to Replace carriage Returns with\nSub CleanSheets()\n\n  fCleanSheets Array(\"Elements\", \"Connections\"), 1, 2, \", \"\n\nEnd Sub\n</code></pre>\n\n<p>Sub:</p>\n\n<pre><code>Sub fCleanSheets(arrShtNames As Variant, IdColNub As Long, LabelColNub As Long,   Optional iDiliter As String = \", \")\nDim HL As Hyperlink\nDim MyArray As Variant\nDim ws As Worksheet\nDim CL As Range, Rng, aCell As Range\nDim txt As String\nDim x As Long, y As Long\n\nFor Each ws In Worksheets(arrShtNames)\n With ws\n  'IF Get error if sheet not selected then uncomment\n  'ws.Select\n\n  'Reset UsedRange\n  Application.ActiveSheet.UsedRange\n\n  'TextWrap\n   Application.ActiveSheet.UsedRange.WrapText = False\n\n  'Turn live hyperlinks to text\n  For Each HL In ws.Hyperlinks\n    Set CL = HL.Parent\n    txt = HL.Address &amp; HL.SubAddress\n    HL.Delete\n    CL.Value = txt\n  Next HL\n\n  'Remove all Formulas\n  With ws.UsedRange.Offset(1, 0)\n    .Value = .Value\n  End With\n\n  'Create Array\n  MyArray = .UsedRange.Offset(1, 0)\n\n For x = LBound(MyArray) To UBound(MyArray)\n     For y = LBound(MyArray, 2) To UBound(MyArray, 2)\n\n     If Not IsError(MyArray(x, y)) Then\n\n         'Remove unwanted Characters\n         'http://www.ascii-code.com/\n           MyArray(x, y) = RemoveChars_NEWHAB(MyArray(x, y))\n\n         'Trim Sheets(Will NOT error if LEN(string) &gt; 255 char's)\n           MyArray(x, y) = Trim(MyArray(x, y))\n\n         'Replace carriage Return with dilimiter\n           MyArray(x, y) = Replace(MyArray(x, y), Chr(13), iDiliter)\n           MyArray(x, y) = Replace(MyArray(x, y), Chr(10), iDiliter)\n\n     End If\n\n     Next y\n\n     'ONLY APPLYING ON CERTIN COLUMNS\n        'If FIRST char = \"-\" Replace it on ID Column ONLY\n           If Left(MyArray(x, IdColNub), 1) = \"-\" Then\n              MyArray(x, IdColNub) = \"@\" &amp; Right(MyArray(x, IdColNub), Len(MyArray(x, IdColNub)) - 1)\n           End If\n\n        'Convert Accented letters to NON Accented letters on Label Column ONLY\n          MyArray(x, LabelColNub) = ConvertAccent(MyArray(x, LabelColNub))\n\n        'Remove Mulutiple Spaces Between Names on Label Column ONLY\n          MyArray(x, LabelColNub) =  Application.WorksheetFunction.Trim(MyArray(x, LabelColNub))\n\n Next x\n\n'Postback to sheet\n.UsedRange.Offset(1, 0) = MyArray\nEnd With\n\nNext ws\n\nThisWorkbook.Sheets(1).Select\n\nEnd Sub\n</code></pre>\n\n<p>UDF: RemoveChars</p>\n\n<pre><code>Function RemoveChars(ByVal strSource As String) As String\n'http://stackoverflow.com/questions/15723672/how-to-remove-all-non-alphanumeric-characters-from-a-string-except-period-and-sp\nDim i As Integer\nDim strResult As String\n\nFor i = 1 To Len(strSource)\n    Select Case Asc(Mid(strSource, i, 1))\n        Case 2, 0, 9, 10, 12, 160, 161 To 255: 'http://www.ascii-code.com/\n\n        Case Else:\n            strResult = strResult &amp; Mid(strSource, i, 1)\n\n    End Select\nNext i\n\nRemoveChars = strResult\n\nEnd Function\n</code></pre>\n\n<p>UDF: ConvertAccent</p>\n\n<pre><code> Function ConvertAccent(ByVal inputString As String) As String\n ' http://www.vbforums.com/archive/index.php/t-483965.html\n Dim x As Long, Position As Long\n Const AccChars As String = _\n    \"\u0160\u017d\u0161\u017e\u0178\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c7\u00c8\u00c9\u00ca\u00cb\u00cc\u00cd\u00ce\u00cf\u00d0\u00d1\u00d2\u00d3\u00d4\u00d5\u00d6\u00d9\u00da\u00db\u00dc\u00dd\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e7\u00e8\u00e9\u00ea\u00eb\u00ec\u00ed\u00ee\u00ef\u00f0\u00f1\u00f2\u00f3\u00f4\u00f5\u00f6\u00f9\u00fa\u00fb\u00fc\u00fd\u00ff\"\n Const RegChars As String = _\n    \"SZszYAAAAAACEEEEIIIIDNOOOOOUUUUYaaaaaaceeeeiiiidnooooouuuuyy\"\n For x = 1 To Len(inputString)\n   Position = InStr(AccChars, Mid(inputString, x, 1))\n   If Position Then Mid(inputString, x) = Mid(RegChars, Position, 1)\nNext\nConvertAccent = inputString\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 32256151, "answer_count": 1, "score": 1, "last_activity_date": 1442026781, "creation_date": 1440610258, "last_edit_date": 1531164843, "question_id": 32233034, "link": "https://stackoverflow.com/questions/32233034/ultimatecleansheet-code-errors", "title": "UltimateCleanSheet Code errors", "body": "<p>Trying to write a <code>Clean sheet</code> Sub</p>\n\n<p>First:</p>\n\n<p>Some serial #'s from the data I get will start with <code>-</code> which is a problem in excel, I want to replace all cell content that <code>starts</code> with <code>-</code> and replace it with <code>@</code> <code>replace()</code> does <code>not</code> work </p>\n\n<p>This is erroring:</p>\n\n<pre><code>.Value = Evaluate(\"if(row(\" &amp; .Address &amp; \"),\"\"@\"\" &amp; Right(\" &amp; .Address &amp; \", Len(\" &amp; .Address &amp; \") - 2))\")\n</code></pre>\n\n<p>It turns all cells to <code>#NAME?</code></p>\n\n<p>2nd:</p>\n\n<p>I Changed this</p>\n\n<pre><code> MyArray(x, y) = RemoveChars(MyArray(x, y)\n</code></pre>\n\n<p>To this</p>\n\n<pre><code> If Not IsError(MyArray(x, y)) Then\n         MyArray(x, y) = RemoveChars(MyArray(x, y))\n End If\n</code></pre>\n\n<p>Because the code ran (Sans the line of code from Question 1) the first time but if I ran it a second time on the same data sheet it errored</p>\n\n<p>What would cause the code to error on the second run?</p>\n\n<p>Does adding the <code>If Not IsError(MyArray(x, y))</code> interfere with the removal of unwanted characters?</p>\n\n<p>The <code>UDF</code> came from Here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/32192616/alter-code-to-remove-instead-of-allow-characters\">Alter code to Remove instead of Allow characters</a></p>\n\n<pre><code>Sub UltimateCleanSheet()\nDim HL As Hyperlink\nDim MyArray As Variant\nDim ws As Worksheet\nDim CL As Range\nDim txt As String\nDim LastRow As Long, LastCol As Long, x As Long, y As Long\n\ngoFast False\nFor Each ws In Worksheets(Array(\"OriginalData\", \"NewData\"))\n With ws\n\n      'Get error if sheet not selected\n      ws.Select\n\n      'Reset UsedRange\n      Application.ActiveSheet.UsedRange\n\n      'Create Array\n      MyArray = ws.UsedRange.Offset(1, 0)\n\n     'Remove unwanted Characters\n     'http://www.ascii-code.com/\n     For x = LBound(MyArray) To UBound(MyArray)\n         For y = LBound(MyArray, 2) To UBound(MyArray, 2)\n\n         If Not IsError(MyArray(x, y)) Then\n               MyArray(x, y) = RemoveChars(MyArray(x, y))\n         End If\n\n         Next y\n     Next x\n\n    'Postback to sheet\n    .UsedRange.Offset(1, 0) = MyArray\n End With\n\n With ws.UsedRange.Offset(1, 0)\n\n    'Clear all formulas\n    .Value = .Value\n\n    'Replace \"Non-breaking space\" with \"\"\n    .Replace what:=Chr(160), replacement:=vbNullString, lookat:=xlPart\n\n    'Replace carriage Return with \", \"\n    .Replace what:=Chr(13), replacement:=\", \", lookat:=xlPart\n\n    'Replace hyphen if 1st char with \"@\"\n    .Value = Evaluate(\"if(row(\" &amp; .Address &amp; \"),\"\"@\"\" &amp; Right(\" &amp; .Address &amp; \", Len(\" &amp; .Address &amp; \") - 2))\")\n\n    'Clean, Trim\n    .Value = Evaluate(\"if(row(\" &amp; .Address &amp; \"),clean(trim(\" &amp; .Address &amp; \")))\")\nEnd With\n\n'Turn live hyperlinks to text\nFor Each HL In ws.Hyperlinks\n    Set CL = HL.Parent\n    txt = HL.Address &amp; HL.SubAddress\n    HL.Delete\n    CL.Value = txt\nNext HL\n\nNext ws\n\nThisWorkbook.Sheets(1).Select\ngoFast True\nEnd Sub\n</code></pre>\n\n<p>UDF:</p>\n\n<pre><code>Function RemoveChars(ByVal strSource As String) As String\nDim i As Integer\nDim strResult As String\n\nFor i = 1 To Len(strSource)\n    Select Case Asc(Mid(strSource, i, 1))\n        Case 0, 9, 10, 12, 33, 161 To 255:\n\n        Case Else:\n            strResult = strResult &amp; Mid(strSource, i, 1)\n\n    End Select\nNext i\n\nRemoveChars = strResult\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1549, "user_id": 544805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9033e3b0eb336d68604ef607d4851e8a?s=128&d=identicon&r=PG", "display_name": "Omar", "link": "https://stackoverflow.com/users/544805/omar"}, "edited": false, "score": 0, "creation_date": 1440610786, "post_id": 32232934, "comment_id": 52348787, "body": "I&#39;m not sure what you mean by &quot;In the cell it needs to take that middle value there is afterwards nothing, and I get REF! error.&quot;. Can you rephrase that sentence?"}, {"owner": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "reply_to_user": {"reputation": 1549, "user_id": 544805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9033e3b0eb336d68604ef607d4851e8a?s=128&d=identicon&r=PG", "display_name": "Omar", "link": "https://stackoverflow.com/users/544805/omar"}, "edited": false, "score": 0, "creation_date": 1440612722, "post_id": 32232934, "comment_id": 52349893, "body": "Well, basically what I&#39;m trying to do is following: I have a number of tables, and for each table I need to watch the last row, first of column A, and then of column B-meaning that in my table I have the first column-which is the name of the table- the second column is what I look in the table - column A, and third column is that what I look in the table but in column B..So basically, in that first column after the macro has finished its thing-there is nothing, basically blank (but when u click on the cell, in the formula bar you can see the formula) and in the next column there is error REF!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440615028, "post_id": 32234288, "comment_id": 52351271, "body": "No, this formula works perfectly fine..the problem lies in the above two.. I&#39;ve tried applying your proposal, but it&#39;s even worse-again an error &#39;1004&#39;-unable to set the FormulaArray property.."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440617873, "post_id": 32234288, "comment_id": 52352894, "body": "I have changed my answer."}, {"owner": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440617989, "post_id": 32234288, "comment_id": 52352950, "body": "No it is not.. im putting the formula into record_count_check.xlsm.. and taking the values from that other workbook.."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440618044, "post_id": 32234288, "comment_id": 52352986, "body": "Understood. The bit about R1C1 and including sheet name is still valid though."}, {"owner": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440618634, "post_id": 32234288, "comment_id": 52353277, "body": "Thanks for all the responses, but we&#39;re focusing on the wrong things here.. and as regards to sheet name-I&#39;ve tried it, and its returning and error...however, this counta forula is working fine..the problem is with the two array formulas..they are not working-meaning when I record them as a macro, they do not return values.."}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 1, "creation_date": 1440618849, "post_id": 32234288, "comment_id": 52353393, "body": "What do the array formulas look like if you type them manually into the sheet so that they work? Maybe add that to your original question."}, {"owner": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440619016, "post_id": 32234288, "comment_id": 52353493, "body": "It&#39;s the same as above in the code: =MID(INDEX(&#39;account-acc-std-mit-lineal.xlsx&#39;!C1,MAX((&#39;accoun&zwnj;&#8203;t-acc-std-mit-lineal&zwnj;&#8203;.xlsx&#39;!C1&lt;&gt;&quot;&quot;&quot;&quot;)*ROW&zwnj;&#8203;(&#39;account-acc-std-mi&zwnj;&#8203;t-lineal.xlsx&#39;!C1)))&zwnj;&#8203;,21,3)"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440624294, "post_id": 32234288, "comment_id": 52356165, "body": "Can you explain what this bit does? <code>MAX((&#39;account-acc-std-mit-lineal.xlsx&#39;!C2&lt;&gt;&quot;&quot;&quot;&quot;)*ROW(&#39;accoun&zwnj;&#8203;t-acc-std-mit-lineal&zwnj;&#8203;.xlsx&#39;!C1))</code> I don&#39;t understand why you are using MAX function when there is only one value."}, {"owner": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440654293, "post_id": 32234288, "comment_id": 52364351, "body": "the formula is OK, the formula works.. the question here is just how to use the data from other closed workbooks and not to get an error"}, {"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "reply_to_user": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "edited": false, "score": 0, "creation_date": 1440678840, "post_id": 32234288, "comment_id": 52379393, "body": "See <a href=\"http://stackoverflow.com/q/32148792/4243498\">this question</a> for similar question &amp; answer. I don&#39;t get how your functions work without the sheet name being included in the formula so cannot help further."}], "tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1440618156, "last_edit_date": 1440618156, "creation_date": 1440614445, "answer_id": 32234288, "question_id": 32232934, "link": "https://stackoverflow.com/questions/32232934/macro-for-taking-the-middle-value-of-a-string-from-a-closed-workbook-doesnt-wor/32234288#32234288", "title": "Macro for taking the middle value of a string from a closed workbook doesn&#39;t work", "body": "<p>If you are trying to ge values from another workbook, then you need to include the workbook and the sheet name in the formula. In your VBA, none of the functions include the name of the worksheet, just the workbook name and the cell address. </p>\n\n<p>Also you need to be using the same cell address mode, i.e. R1C1 style or A1 style. If you are using <code>FormulaR1C1</code> then you must use the R1C1 style.</p>\n\n<p>For example,</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=COUNTA('account-acc-std-mit-lineal.xlsx'!C2)\"\n</code></pre>\n\n<p>Should be something like:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=COUNTA([account-acc-std-mit-lineal.xlsx]sheet_name!R2C3)\"\n</code></pre>\n\n<p>EDIT: I've just realised that <code>account-acc-std-mit-lineal.xlsx</code> is the name of the workbook into which you are putting the formula. You can remove the the name of the workbook from the formula then.</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=COUNTA(R2C3)\"\n</code></pre>\n\n<p>You can always manually build the formula in the worksheet, select the cell and then in the Immediate window in the IDE enter \"?Selection.FormulaR1C1\" (without the quotes), press Enter to see what answer you get.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mHrPH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mHrPH.png\" alt=\"Immediate window in IDE\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 5269664, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207396536577801/picture?type=large", "display_name": "Lejla Hodzic", "link": "https://stackoverflow.com/users/5269664/lejla-hodzic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440618156, "creation_date": 1440609883, "last_edit_date": 1440610301, "question_id": 32232934, "link": "https://stackoverflow.com/questions/32232934/macro-for-taking-the-middle-value-of-a-string-from-a-closed-workbook-doesnt-wor", "title": "Macro for taking the middle value of a string from a closed workbook doesn&#39;t work", "body": "<p>One of problems I have is that, when I want to e.g. just map the middle of a string from other workbook, it doesn't work. In the cell it needs to take that middle value there is afterwards nothing, and I get REF! error. When I do the same thing without recording macro, it works perfectly.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Workbooks.Open (\"C:\\Data\\DA1\\Korr\\Makros\\akt_5.9\\Output\\account-acc-std-mit-lineal.xlsx\")\n    With ActiveWindow\n        .SplitColumn = 0\n        .SplitRow = 0\n    End With\n    Windows(\"record_count_check.xlsm\").Activate\n    Range(\"B2\").Select\n    Selection.FormulaArray = _\n        \"=MID(INDEX('account-acc-std-mit-lineal.xlsx'!C1,MAX(('account-acc-std-mit-lineal.xlsx'!C1&lt;&gt;\"\"\"\")*ROW('account-acc-std-mit-lineal.xlsx'!C1))),21,3)\"\n    Range(\"D2\").Select\n    Selection.FormulaArray = _\n        \"=RIGHT(INDEX('account-acc-std-mit-lineal.xlsx'!C2,MAX(('account-acc-std-mit-lineal.xlsx'!C2&lt;&gt;\"\"\"\")*ROW('account-acc-std-mit-lineal.xlsx'!C2))),10)\"\n    Range(\"E2\").Select\n    ActiveCell.FormulaR1C1 = \"=COUNTA('account-acc-std-mit-lineal.xlsx'!C2)\"\n</code></pre>\n\n<p>What I need to do? How is the best way to code so that I'm able to access data from other workbooks?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 526, "user_id": 470530, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zl7mE.jpg?s=128&g=1", "display_name": "V&#233;race", "link": "https://stackoverflow.com/users/470530/v%c3%a9race"}, "edited": false, "score": 0, "creation_date": 1440629748, "post_id": 32241483, "comment_id": 52364262, "body": "I think that this question would be better on StackOverflow - it appears to more about programming than databases per se. Voting to close."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5273933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6551323b35850e10b1f1f209b9e1bd0?s=128&d=identicon&r=PG&f=1", "display_name": "BIITS", "link": "https://stackoverflow.com/users/5273933/biits"}, "is_accepted": false, "score": 0, "last_activity_date": 1440614223, "creation_date": 1440614223, "answer_id": 32241484, "question_id": 32241483, "link": "https://stackoverflow.com/questions/32241483/how-to-update-multiple-tables-in-ms-access-from-multiple-excel-files/32241484#32241484", "title": "How to update multiple tables in MS Access from multiple excel files?", "body": "<p>If you know how to deal with a single excel file and convert it to acess table and all the rest of file will be treated the same way. You can use a bot which will automate the task and do  it quickfast. You just have to give it the \"instruction\" how to deal with single file and it will do the rest.</p>\n\n<p>The instruction can be as simple as a notepad file with table containing the mouse positions and the stroken keyboards key necessary to deal with one file.</p>\n\n<p>You may use \"Autoit V3 script\"</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1313521200, "open_beta_date": 1294686000, "closed_beta_date": 1294081200, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/dba/Img/apple-touch-icon@2.png", "twitter_account": "StackDBAs", "favicon_url": "https://cdn.sstatic.net/Sites/dba/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/dba/Img/apple-touch-icon.png", "audience": "database professionals who wish to improve their database skills and learn from others in the community", "site_url": "https://dba.stackexchange.com", "api_site_parameter": "dba", "logo_url": "https://cdn.sstatic.net/Sites/dba/Img/logo.png", "name": "Database Administrators", "site_type": "main_site"}, "on_date": 1440654071, "question_id": 112299}, "owner": {"reputation": 912, "user_id": 5082125, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63dcdfcc8b5d1d469fecd22e9f5819e1?s=128&d=identicon&r=PG&f=1", "display_name": "manu", "link": "https://stackoverflow.com/users/5082125/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440654071, "creation_date": 1440609842, "question_id": 32241483, "link": "https://stackoverflow.com/questions/32241483/how-to-update-multiple-tables-in-ms-access-from-multiple-excel-files", "title": "How to update multiple tables in MS Access from multiple excel files?", "body": "<p>Every month I have to UPDATE my MS Access db from approximately 30 excel files. They have all the same structure and format. I try to modify this code several times to update each tables in my db in once but i didn't succeed. (found in this forum)</p>\n\n<p>I have 3 questions:\nHow is it possible to say to the vba code to look at this range in the excel template which correspond to this column in the MS Access db?</p>\n\n<p>How can i make this vba code update all the tables in once based on the Primary Key?</p>\n\n<p>Then, Is it possible to select the Folder where all these excel files are and the code will loop through all files?</p>\n\n<pre><code>Public Sub UpdatePriceList()\nDim cn As ADODB.Connection, rs As ADODB.Recordset\nDim sProduct As String, sVariety As String, cPrice As Variant\n' connect to the Access database\nSet cn = New ADODB.Connection\ncn.Open \"Provider=Microsoft.ACE.OLEDB.12.0; \" &amp; _\n    \"Data Source=C:\\Users\\Gord\\Desktop\\Database1.accdb;\"\n' open a recordset\nSet rs = New ADODB.Recordset\nrs.Open \"PriceList\", cn, adOpenKeyset, adLockOptimistic, adCmdTable\n\nRange(\"A2\").Activate  ' row 1 contains column headings\nDo While Not IsEmpty(ActiveCell)\n    sProduct = ActiveCell.Value\n    sVariety = ActiveCell.Offset(0, 1).Value\n    cPrice = ActiveCell.Offset(0, 2).Value\n\n    rs.Filter = \"product='\" &amp; sProduct &amp; \"' AND variety='\" &amp; sVariety &amp; \"'\"\n    If rs.EOF Then\n        Debug.Print \"No existing record - adding new...\"\n        rs.Filter = \"\"\n        rs.AddNew\n        rs(\"product\").Value = sProduct\n        rs(\"variety\").Value = sVariety\n    Else\n        Debug.Print \"Existing record found...\"\n    End If\n    rs(\"price\").Value = cPrice\n    rs.Update\n    Debug.Print \"...record update complete.\"\n\n    ActiveCell.Offset(1, 0).Activate  ' next cell down\nLoop\nrs.Close\nSet rs = Nothing\ncn.Close\nSet cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>thank you in advance!</p>\n"}, {"tags": ["vba", "excel", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440609613, "post_id": 32232819, "comment_id": 52348066, "body": "I have tried this before but I get this error: Run-time error &#39;91&#39;:  Object variable or With block variable not set"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1440609502, "creation_date": 1440609502, "answer_id": 32232819, "question_id": 32232791, "link": "https://stackoverflow.com/questions/32232791/vba-compile-error-object-required-getting-greys-at-this-point/32232819#32232819", "title": "VBA Compile Error: Object Required (getting greys at this point)", "body": "<p>IF you are trying to compare them use an = instead of Is</p>\n\n<pre><code>If firstCaseVal = secondCaseVal Then\n    k = k + 1\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440609999, "post_id": 32232873, "comment_id": 52348290, "body": "adding a &quot;.&quot; to matchCountRows gives a compile error.  Removed the &quot;.&quot; and now the if statement with an &quot;=&quot; gives run-time error 91: object variable or with block variable not set"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440610047, "post_id": 32232873, "comment_id": 52348324, "body": "See my edit. I think the use of Asset is the problem."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440610154, "post_id": 32232873, "comment_id": 52348400, "body": "I changed the placement of the period too. You want to use the columns of ws2, so the period is before columns."}, {"owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440610255, "post_id": 32232873, "comment_id": 52348464, "body": "Asset is a user form label which is just a valued passed to it from another userform"}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440613764, "post_id": 32232873, "comment_id": 52350513, "body": "Numeric values, like strings, are not set. You&#39;d write SecondCaseVal = secondcase. Not Set secondcaseVal = secondcase. I suggest you dim the Values as integers/long/doubles to avoid confusion (but not necessary). I think the program considers it as a Range object because you set it equal to the cell in which you found your info."}], "tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1440610017, "last_edit_date": 1440610017, "creation_date": 1440609660, "answer_id": 32232873, "question_id": 32232791, "link": "https://stackoverflow.com/questions/32232791/vba-compile-error-object-required-getting-greys-at-this-point/32232873#32232873", "title": "VBA Compile Error: Object Required (getting greys at this point)", "body": "<p>Several problems with your code:</p>\n\n<pre><code>Dim i as integer 'Dim all your variables\n\nSet ws2 = Sheets(\"Sheet2\") 'Set the sheet before using it\n\nWith ws2 'You need to add a . before what you write in a With that is to be preceded with the With argument\n    matchCountRows = .Columns(1).Find(Asset, lookat:=xlWhole).Row\n'What is Asset? If it is a string, you need to write it like \"Asset\"\nEnd With\n\nIf firstCaseVal = secondCaseVal Then 'Use = to compare, not Is\n     k = k + 1\nEnd If\n</code></pre>\n\n<p>I believe it will work if you make these changes.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440611700, "post_id": 32233368, "comment_id": 52349294, "body": "No they do not always match... it is a check to see if the value of the cells in the desired row from column 1 through 9 are already there and if they are then they are not copied and disregarded, however if they are not present in <code>ws3</code> then they are copied into <code>ws3</code>"}, {"owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "edited": false, "score": 0, "creation_date": 1440613746, "post_id": 32233368, "comment_id": 52350498, "body": "Not that it solved the run-time error I was getting it is a more simple and elegant solution to my problem.  thank you very much"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1440612365, "last_edit_date": 1440612365, "creation_date": 1440611364, "answer_id": 32233368, "question_id": 32232791, "link": "https://stackoverflow.com/questions/32232791/vba-compile-error-object-required-getting-greys-at-this-point/32233368#32233368", "title": "VBA Compile Error: Object Required (getting greys at this point)", "body": "<p>It looks like you're using find() to locate a cell with a specific value, then comparing the value in that cell with the searched-for value, which of course would always match as long as there was a hit. </p>\n\n<p>Instead you can just test for </p>\n\n<pre><code>If Not secondCase Is Nothing Then \n</code></pre>\n\n<p>since Find() returns <code>Nothing</code> if it doesn't find a match (and that's what's causing your error \"object variable or with block variable not set\").</p>\n\n<p><strong>EDIT</strong>  - some suggested changes:</p>\n\n<pre><code>Function histMisMatch() As Boolean\n\n    Dim i As Integer\n    Dim matchCountRows As Long\n    Dim ws2 As Worksheet\n    Dim ws3 As Worksheet\n    Dim firstCase As Variant\n\n    Set ws2 = Sheets(\"Sheet2\")\n    Set ws3 = Sheets(\"Sheet3\")\n\n    matchCountRows = ws2.Columns(1).Find(Asset, lookat:=xlWhole).Row\n\n    For i = 1 To 9\n        firstCase = ws2.Cells(matchCountRows, i).Value\n        If ws3.Columns(i).Find(firstCase, lookat:=xlWhole) Is Nothing Then\n            histMisMatch = True\n            Exit Function 'you can stop looking here, since one value was not found...\n        End If\n    Next\n    'got here if no missing values...\n    histMisMatch = False\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5268912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/973d4a8e7ad742d1fcc7d62723801edf?s=128&d=identicon&r=PG&f=1", "display_name": "discolemonade", "link": "https://stackoverflow.com/users/5268912/discolemonade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 32233368, "answer_count": 3, "score": 0, "last_activity_date": 1440612365, "creation_date": 1440609399, "last_edit_date": 1440610620, "question_id": 32232791, "link": "https://stackoverflow.com/questions/32232791/vba-compile-error-object-required-getting-greys-at-this-point", "title": "VBA Compile Error: Object Required (getting greys at this point)", "body": "<p>Some background on myself: I have done some simple programming in my life but just C++ and simple VBA.  I am not very familiar with VBA syntax and I'm trying.</p>\n\n<p>I'm working on a functions to compare 2 sets of cells.  If the cells are the same then <code>False</code> is returned and <code>True</code> for not being the same.  Problem is I cannot get my if statement to work in order to create my count which will eventually give me my <code>True</code> or <code>False</code></p>\n\n<p>The line I'm having problems and receiving a run-time error 424: object required.</p>\n\n<pre><code>If firstCaseVal Is secondCaseVal Then\n    k = k + 1\nEnd If\n</code></pre>\n\n<p>Here is the complete function:</p>\n\n<pre><code>Function histMisMatch() As Boolean\nDim matchCountRows As Integer\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim k As Integer\nDim firstCaseVal As Variant, secondCaseVal As Variant, firstCase As Variant, secondCase As Variant        \n    With ws2\n        matchCountRows = Columns(1).Find(Asset, lookat:=xlWhole).Row\n    End With\n\n    Set ws2 = Sheets(\"Sheet2\")\n    Set ws3 = Sheets(\"Sheet3\")\n\n    k = 0\n\n    For i = 1 To 9\n        firstCase = ws2.Cells(matchCountRows, i).Value\n        firstCaseVal = firstCase\n\n        With ws3\n        Set secondCase = ws3.Columns(i).Find(firstCase, lookat:=xlWhole)\n        Set secondCaseVal = secondCase            \n        End With\n\n        If firstCaseVal Is secondCaseVal Then\n            k = k + 1\n        End If            \n    Next        \n\n    If k = 9 Then\n        histMisMatch = False\n    Else\n        histMisMatch = True\n    End If        \nEnd Function\n</code></pre>\n\n<p>Code with changes made but still received run-time error 91 on the if statement</p>\n\n<pre><code>Function histMisMatch() As Boolean\nDim i As Integer\nDim matchCountRows As Integer\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim k As Integer\nDim firstCaseVal As Variant, secondCaseVal As Variant, firstCase As Variant, secondCase As Variant\n\n    Set ws2 = Sheets(\"Sheet2\")\n    Set ws3 = Sheets(\"Sheet3\")\n\n    With ws2\n        matchCountRows = .Columns(1).Find(Asset, lookat:=xlWhole).Row\n    End With \n\n    k = 0\n\n    For i = 1 To 9\n        firstCase = ws2.Cells(matchCountRows, i).Value\n        firstCaseVal = firstCase\n\n        With ws3\n        Set secondCase = ws3.Columns(i).Find(firstCase, lookat:=xlWhole)\n        Set secondCaseVal = secondCase\n        End With\n\n        If firstCaseVal = secondCaseVal Then\n            k = k + 1\n        End If\n    Next\n\n\n    If k = 9 Then\n        histMisMatch = False\n    Else\n        histMisMatch = True\n    End If        \nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440609730, "post_id": 32232774, "comment_id": 52348133, "body": "Your question is not clear at all. Please provide more information about how your data is laid out and what your code looks like - and whether you want a VBA solution or a formula solution."}, {"owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440610255, "post_id": 32232774, "comment_id": 52348465, "body": "@Grade&#39;Eh&#39;Bacon I need a vba solution, what I would like to create is a userform with two textbox, for example when I key in 1 for the ID textbox, the Name textbox will display Sam NOT John because date of Sam is the latest"}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440611151, "post_id": 32232774, "comment_id": 52348986, "body": "<b>Please provide more information about how your data is laid out and what your code looks like</b>."}, {"owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "reply_to_user": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440613241, "post_id": 32232774, "comment_id": 52350181, "body": "@Grade&#39;Eh&#39;Bacon so as the picture, it shows name cc when I type 1 in the textbox of ID, what i like is to display name aa instead of cc since its date is more recent"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440616229, "post_id": 32232774, "comment_id": 52351929, "body": "Did my solution work for you?"}, {"owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440655193, "post_id": 32232774, "comment_id": 52364737, "body": "@ExcelHero not really...because when I type 1 in the ID textbox it shows ntg with your code, what i like to create is when I type 1 in the ID textbox it shows aa as the date is 7/6/15 which is more later"}, {"owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440656764, "post_id": 32232774, "comment_id": 52365487, "body": "@ExcelHero the textbox for name and date display nothing"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440657072, "post_id": 32232774, "comment_id": 52365634, "body": "There has to be something small that is different there than here. Could you send me a small workbook that has this in it? I&#39;m sure I could get it going right away. My email is daniel.ferry@gmail.com"}, {"owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440657566, "post_id": 32232774, "comment_id": 52365889, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/88065/discussion-between-green-and-excel-hero\">continue this discussion in chat</a>."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1440659260, "post_id": 32232774, "comment_id": 52366822, "body": "I just sent the workbook back to you. It works well now."}], "answers": [{"comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1440620920, "post_id": 32234189, "comment_id": 52354493, "body": "I think yours displays the largest row, not the one with the largest date. So you would have sort the worksheet first."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1440623987, "post_id": 32234189, "comment_id": 52356035, "body": "@DickKusleika  Yep. Brain fart. It&#39;s updated and does the right thing now."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1440627659, "last_edit_date": 1440627659, "creation_date": 1440614105, "answer_id": 32234189, "question_id": 32232774, "link": "https://stackoverflow.com/questions/32232774/find-roll-and-column-of-name-with-latest-date/32234189#32234189", "title": "Find Roll and Column of Name with latest Date", "body": "<p>This should do it for you. This routine goes in your userform code module:</p>\n\n<pre><code>Private Sub TextBox1_AfterUpdate()\n    TextBox2 = Evaluate(\"=INDEX(B2:B999,MATCH(MAX((IF(A2:A999=\" &amp; TextBox1 &amp; _\n                        \",1)*(C2:C999)),1),IF(A2:A999=\" &amp; TextBox1 &amp; _\n                        \",1)*(C2:C999),))\")\nEnd Sub\n</code></pre>\n\n<p>It assumes your data are in columns A, B, and C. It also assumes your data do not extend past row 999; if they do, then increase the 999's in the formula to what is appropriate.</p>\n\n<p>TextBox1 is for the ID.\nTextBox2 is for the Name.</p>\n\n<p>Note that this code is placed in the <code>AfterUpdate</code> event procedure. This is different than your sample code. You used the Change event procedure. The difference is that Change fires on each keystroke while AfterUpdate fires only after the full text is confirmed for the textbox.</p>\n\n<p>Note that you should still add error checking for the case where the ID is not numeric and also for the case where the numeric ID does not match. The code above is simply for demonstrating the technique to display the looked-up value. If you wish for me to flesh it out more, please let me know.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I went ahead and fleshed it out with the error checking:</p>\n\n<pre><code>Private Sub TextBox1_AfterUpdate()\n    GetData\nEnd Sub\n\nPublic Sub GetData()\n    Dim v, w\n    On Error Resume Next\n    v = Evaluate(\"=INDEX(B2:B999,MATCH(MAX((IF(A2:A999=\" &amp; TextBox1 &amp; _\n                 \",1)*(C2:C999)),1),IF(A2:A999=\" &amp; TextBox1 &amp; _\n                 \",1)*(C2:C999),))\")\n    w = Evaluate(\"MAX((IF(A2:A999=\" &amp; TextBox1 &amp; \",1)*(C2:C999)))\")\n    If IsArray(v) Or IsError(v) Then v = \"ID not found.\": w = \"\"\n    TextBox2 = v\n    TextBox3 = \"\": TextBox3 = CDate(w)\nEnd Sub\n</code></pre>\n\n<p><strong><em>UPDATE 2</em></strong>\nIn the fleshed out version directly above, I added support for the associated date in TextBox3.</p>\n"}, {"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 0, "last_activity_date": 1440621989, "creation_date": 1440621989, "answer_id": 32236416, "question_id": 32232774, "link": "https://stackoverflow.com/questions/32232774/find-roll-and-column-of-name-with-latest-date/32236416#32236416", "title": "Find Roll and Column of Name with latest Date", "body": "<p>You could read the whole range in when the userform opens, sort it, then find the first ID.</p>\n\n<pre><code>Private mvaData As Variant\n\nPrivate Sub TextBox1_AfterUpdate()\n    Me.TextBox2.Text = vbNullString\n    Me.TextBox3.Text = vbNullString\n    GetData\nEnd Sub\n\nPublic Sub GetData()\n\n    Dim i As Long\n\n    For i = LBound(mvaData, 1) To UBound(mvaData, 1)\n        If mvaData(i, 1) = Val(Me.TextBox1.Text) Then\n            Me.TextBox2.Text = mvaData(i, 2)\n            Me.TextBox3.Text = mvaData(i, 3)\n            Exit For 'stop after the first one - largest date\n        End If\n    Next i\n\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n\n    Dim i As Long, j As Long\n    Dim lId As Long, sDesc As String, dtDate As Date\n\n    'store the data in a variable when the forms opens\n    mvaData = Sheet1.Range(\"A1:C5\")\n\n    'sort with larger dates on top\n    For i = LBound(mvaData, 1) To UBound(mvaData, 1) - 1\n        For j = i To UBound(mvaData, 1)\n            If mvaData(i, 3) &lt; mvaData(j, 3) Then\n                lId = mvaData(j, 1)\n                sDesc = mvaData(j, 2)\n                dtDate = mvaData(j, 3)\n\n                mvaData(j, 1) = mvaData(i, 1)\n                mvaData(j, 2) = mvaData(i, 2)\n                mvaData(j, 3) = mvaData(i, 3)\n\n                mvaData(i, 1) = lId\n                mvaData(i, 2) = sDesc\n                mvaData(i, 3) = dtDate\n            End If\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 1867933, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4e2a219b9c028aefbda7bd59fca017eb?s=128&d=identicon&r=PG", "display_name": "green", "link": "https://stackoverflow.com/users/1867933/green"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "accepted_answer_id": 32234189, "answer_count": 2, "score": 1, "last_activity_date": 1462525019, "creation_date": 1440609339, "last_edit_date": 1462525019, "question_id": 32232774, "link": "https://stackoverflow.com/questions/32232774/find-roll-and-column-of-name-with-latest-date", "title": "Find Roll and Column of Name with latest Date", "body": "<p>I have a table with three columns,\nID, Name and Date</p>\n\n<p><a href=\"https://i.stack.imgur.com/tfiEB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tfiEB.png\" alt=\"enter image description here\"></a></p>\n\n<p>then I create a userform with textbox ID and Name.</p>\n\n<p>how could I display the Name of similar ID from the table with latest Date when I key in the ID in the userform? (similar ID will have different names, but I want to display the one with latest date in the table)</p>\n\n<p>thanks in advance for all the help</p>\n\n<p>coding for the textbox1</p>\n\n<pre><code>Private Sub TextBox1_Change()\ngetdata\nEnd Sub\n</code></pre>\n\n<p>coding for the getdata module</p>\n\n<pre><code>Sub getdata()\n\nIf IsNumeric(UserForm1.TextBox1.Value) Then\nflag = False\ni = 0\nid = UserForm1.TextBox1.Value\n\nDo While Cells(i + 1, 1).Value &lt;&gt; \"\"\n\n    If Cells(i + 1, 1).Value = id Then\n        flag = True\n        For j = 2 To 3\n            UserForm1.Controls(\"textbox\" &amp; j).Value = Cells(i + 1, j).Value\n        Next j\n    End If\n\n    i = i + 1\n\nLoop\n\nIf flag = False Then\n    For j = 2 To 3\n        UserForm1.Controls(\"TextBox\" &amp; j).Value = \"\"\n    Next j\nEnd If\n\nElse\n    ClearForm\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1440609595, "post_id": 32232739, "comment_id": 52348054, "body": "It&#39;s all &quot;regular&quot; XML - those pieces of information within the opening tags are called &quot;attributes&quot;, and you can use <code>getAttribute()</code> to access their values"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440609800, "post_id": 32232739, "comment_id": 52348170, "body": "Aha! That&#39;s it, thanks!!! (If you want you can put that in an Answer, and I&#39;ll mark it for ya)."}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1440610029, "post_id": 32232739, "comment_id": 52348312, "body": "There is no <code>&lt;GeocodeResponse&gt;</code> and no <code>&lt;geometry&gt;</code> in your sample XML. Are you sure that your code and your XML actually match?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 0, "creation_date": 1440611697, "post_id": 32232739, "comment_id": 52349291, "body": "@Tomalak - the <code>&lt;GeocodeResponse&gt; and &lt;geometry&gt;</code> are in <a href=\"http://maps.googleapis.com/maps/api/geocode/xml?address=1600%20Pennsylvania%20Avenue,%20Washington%20D.C.,%20USA&amp;sensor=false\" rel=\"nofollow noreferrer\">this XML</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440611787, "post_id": 32233203, "comment_id": 52349342, "body": "Thanks for this! Can you expand on the namespace part, and using <code>n1</code> with <code>.SetProperty &quot;SelectionNamespaces&quot;, &quot;xmlns:n1=&#39;http:&#47;&#47;xml.weather.yahoo.com&#47;ns&#47;rss&#47;1.0&#39;&quot;</code>?  That takes the place of <code>yweather</code>?"}, {"owner": {"reputation": 304952, "user_id": 18771, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/0ada184c98bf9073d15b2dc815be0170?s=128&d=identicon&r=PG", "display_name": "Tomalak", "link": "https://stackoverflow.com/users/18771/tomalak"}, "edited": false, "score": 1, "creation_date": 1440611988, "post_id": 32233203, "comment_id": 52349453, "body": "Yes. You can pick any namespace prefix you like, important is that the URI matches. The prefix is basically only there so that you don&#39;t have to write out the URI every time."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1440612090, "post_id": 32233203, "comment_id": 52349527, "body": "The <code>yweather</code> in <code>&lt;yweather:condition&gt;</code> and <code>&lt;yweather:forecast&gt;</code> is a namespace. If you look at your <code>&lt;rss&gt;</code> node, you&#39;ll see how the <code>yweather</code> namespace is declared. You need to use <code>setProperty</code> to define the namespace before you can access any nodes that use it. I&#39;m calling it <code>n1</code>, just because it&#39;s shorter."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440612348, "post_id": 32233203, "comment_id": 52349674, "body": "Ah okay, I think I follow.  Now, how would I get Wednesday&#39;s high and low from <code>yweather:forecast</code>? I tried <code>todayHigh = oXMLFile.SelectNodes(&quot;rss&#47;channel&quot;).SelectSingleNode(&quot;item&#47;n&zwnj;&#8203;1:forecast&quot;).getAttr&zwnj;&#8203;ibute(&quot;high&quot;)</code> but that returns <code>94</code> ...there is no &quot;94&quot; in that XML page..."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1440612412, "post_id": 32233203, "comment_id": 52349717, "body": "Not sure if you reloaded the page since my edit but I included a section on how to get each day along with their highs."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440612497, "post_id": 32233203, "comment_id": 52349772, "body": "How would I ask for a specific day? I.e. use <code>today()</code> to get Today&#39;s date, then how do I search for just the Wednesday &quot;n&quot;?  Would it have to be something like <code>if n.getAttribute(&quot;day&quot;) = weekday(today())</code>?  Of can I avoid an if statement and explicitly get today&#39;s only?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440612913, "post_id": 32233203, "comment_id": 52349992, "body": "Bam! That&#39;ll do it.  I also realized that if I don&#39;t specify a day, it seems to return the first in the list.  The <code>94</code> it was returning IS in the XML, I just hadn&#39;t refreshed it in my browser to notice.  Thanks a ton @Bond!!!"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 1, "last_activity_date": 1440612794, "last_edit_date": 1440612794, "creation_date": 1440610802, "answer_id": 32233203, "question_id": 32232739, "link": "https://stackoverflow.com/questions/32232739/get-attribute-from-xml-rss/32233203#32233203", "title": "Get attribute from XML RSS", "body": "<p>The node you're trying to access is prefixed with a namespace, so you may need to define that namespace before you can access the node. Also, the <code>@</code> operator accesses an attribute within an XPath query.</p>\n\n<p>The following should work to get the <code>temp</code> attribute from the <code>&lt;yweather:condition&gt;</code> node:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim doc\nSet doc = CreateObject(\"MSXML2.DOMDocument.6.0\")   \ndoc.Async = False\ndoc.Load \"c:\\path\\to\\your.xml\"\n\n' Specify the namespace being used (alias = \"n1\")...\ndoc.SetProperty \"SelectionNamespaces\", \"xmlns:n1='http://xml.weather.yahoo.com/ns/rss/1.0'\"\n\n' Get the text of the \"temp\" attribute (note the \"n1\" namespace here)...\nDebug.Print doc.SelectSingleNode(\"/rss/channel/item/n1:condition/@temp\").Text\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>84\n</code></pre>\n\n<p>If you want to get the forecast, you can use <code>selectNodes()</code> to get a nodelist and and then use <code>getAttribute()</code> to retrieve the value of a specific attribute for that particular node:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim n\nFor Each n In doc.selectNodes(\"/rss/channel/item/n1:forecast\")\n    Debug.Print n.getAttribute(\"day\"), n.getAttribute(\"high\")\nNext\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Wed           89\nThu           89\nFri           92\nSat           88\nSun           82\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong>, with respect to comments:</p>\n\n<p>To retrieve a single value for a specific day, you can use the <code>[@attr=value]</code> syntax to find the node matching your criteria along with <code>/@attr</code> to return the attribute you're interested in. For example, here's how you can grab the high for Wednesday: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Debug.Print doc.selectSingleNode(\"/rss/channel/item/n1:forecast[@day='Wed']/@high\").Text\n</code></pre>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 1, "accepted_answer_id": 32233203, "answer_count": 1, "score": 1, "last_activity_date": 1440612794, "creation_date": 1440609237, "last_edit_date": 1440610949, "question_id": 32232739, "link": "https://stackoverflow.com/questions/32232739/get-attribute-from-xml-rss", "title": "Get attribute from XML RSS", "body": "<p>I have an XML feed I'm trying to get some data from in Excel. Here's the <a href=\"http://xml.weather.yahoo.com/forecastrss?p=75240\" rel=\"nofollow\">XML</a>:</p>\n\n<pre><code>&lt;rss xmlns:yweather=\"http://xml.weather.yahoo.com/ns/rss/1.0\" xmlns:geo=\"http://www.w3.org/2003/01/geo/wgs84_pos#\" version=\"2.0\"&gt;\n&lt;channel&gt;\n&lt;title&gt;Yahoo! Weather - Los Angeles, CA&lt;/title&gt;\n&lt;link&gt;\nhttp://us.rd.yahoo.com/dailynews/rss/weather/Los_Angeles__CA/*http://weather.yahoo.com/forecast/USCA0638_f.html\n&lt;/link&gt;\n&lt;description&gt;Yahoo! Weather for Los Angeles, CA&lt;/description&gt;\n&lt;language&gt;en-us&lt;/language&gt;\n&lt;lastBuildDate&gt;Wed, 26 Aug 2015 9:47 am PDT&lt;/lastBuildDate&gt;\n&lt;ttl&gt;60&lt;/ttl&gt;\n&lt;yweather:location city=\"Los Angeles\" region=\"CA\" country=\"US\"/&gt;\n&lt;yweather:units temperature=\"F\" distance=\"mi\" pressure=\"in\" speed=\"mph\"/&gt;\n&lt;yweather:wind chill=\"84\" direction=\"0\" speed=\"0\"/&gt;\n&lt;yweather:atmosphere humidity=\"55\" visibility=\"7\" pressure=\"29.97\" rising=\"0\"/&gt;\n&lt;yweather:astronomy sunrise=\"6:20 am\" sunset=\"7:25 pm\"/&gt;\n&lt;image&gt;\n&lt;title&gt;Yahoo! Weather&lt;/title&gt;\n&lt;width&gt;142&lt;/width&gt;\n&lt;height&gt;18&lt;/height&gt;\n&lt;link&gt;http://weather.yahoo.com&lt;/link&gt;\n&lt;url&gt;\nhttp://l.yimg.com/a/i/brand/purplelogo//uh/us/news-wea.gif\n&lt;/url&gt;\n&lt;/image&gt;\n&lt;item&gt;\n&lt;title&gt;Conditions for Los Angeles, CA at 9:47 am PDT&lt;/title&gt;\n&lt;geo:lat&gt;34.05&lt;/geo:lat&gt;\n&lt;geo:long&gt;-118.23&lt;/geo:long&gt;\n&lt;link&gt;\nhttp://us.rd.yahoo.com/dailynews/rss/weather/Los_Angeles__CA/*http://weather.yahoo.com/forecast/USCA0638_f.html\n&lt;/link&gt;\n&lt;pubDate&gt;Wed, 26 Aug 2015 9:47 am PDT&lt;/pubDate&gt;\n&lt;yweather:condition text=\"Fair\" code=\"34\" temp=\"84\" date=\"Wed, 26 Aug 2015 9:47 am PDT\"/&gt;\n&lt;description&gt;\n&lt;![CDATA[\n&lt;img src=\"http://l.yimg.com/a/i/us/we/52/34.gif\"/&gt;&lt;br /&gt; &lt;b&gt;Current Conditions:&lt;/b&gt;&lt;br /&gt; Fair, 84 F&lt;BR /&gt; &lt;BR /&gt;&lt;b&gt;Forecast:&lt;/b&gt;&lt;BR /&gt; Wed - Mostly Sunny. High: 89 Low: 71&lt;br /&gt; Thu - Sunny. High: 89 Low: 72&lt;br /&gt; Fri - Sunny. High: 92 Low: 71&lt;br /&gt; Sat - Mostly Sunny. High: 88 Low: 69&lt;br /&gt; Sun - Mostly Sunny. High: 82 Low: 66&lt;br /&gt; &lt;br /&gt; &lt;a href=\"http://us.rd.yahoo.com/dailynews/rss/weather/Los_Angeles__CA/*http://weather.yahoo.com/forecast/USCA0638_f.html\"&gt;Full Forecast at Yahoo! Weather&lt;/a&gt;&lt;BR/&gt;&lt;BR/&gt; (provided by &lt;a href=\"http://www.weather.com\" &gt;The Weather Channel&lt;/a&gt;)&lt;br/&gt;\n]]&gt;\n&lt;/description&gt;\n&lt;yweather:forecast day=\"Wed\" date=\"26 Aug 2015\" low=\"71\" high=\"89\" text=\"Mostly Sunny\" code=\"34\"/&gt;\n&lt;yweather:forecast day=\"Thu\" date=\"27 Aug 2015\" low=\"72\" high=\"89\" text=\"Sunny\" code=\"32\"/&gt;\n&lt;yweather:forecast day=\"Fri\" date=\"28 Aug 2015\" low=\"71\" high=\"92\" text=\"Sunny\" code=\"32\"/&gt;\n&lt;yweather:forecast day=\"Sat\" date=\"29 Aug 2015\" low=\"69\" high=\"88\" text=\"Mostly Sunny\" code=\"34\"/&gt;\n&lt;yweather:forecast day=\"Sun\" date=\"30 Aug 2015\" low=\"66\" high=\"82\" text=\"Mostly Sunny\" code=\"34\"/&gt;\n&lt;guid isPermaLink=\"false\"&gt;USCA0638_2015_08_30_7_00_PDT&lt;/guid&gt;\n&lt;/item&gt;\n&lt;/channel&gt;\n&lt;/rss&gt;\n&lt;!--\n fan1591.sports.bf1.yahoo.com Wed Aug 26 10:09:26 PDT 2015 \n--&gt;\n</code></pre>\n\n<p>How do I get the elements for the <code>yweather:condition</code>, as I'm trying to get the value for <code>\"temp\"</code>.  Or, for that matter, how do I get any of the info between <code>&lt; ... &gt;</code>, like <code>yweather:forecast</code>'s \"high\", \"low\", etc?</p>\n\n<p>I know how to get child elements of more \"pure\" XML documents - for example, <a href=\"http://maps.googleapis.com/maps/api/geocode/xml?address=1600%20Pennsylvania%20Avenue,%20Washington%20D.C.,%20USA&amp;sensor=false\" rel=\"nofollow\">this XML</a> I am able to parse out info with the following:</p>\n\n<pre><code>Set resultnodes = oXMLFile.SelectNodes(\"/GeocodeResponse/result\")\nFor Each n In resultnodes\n            Set latitudenodes = n.SelectSingleNode(\"geometry/location/lat\")\n            Set LongitudeNodes = n.SelectSingleNode(\"geometry/location/lng\")\n            Set addressNodes = n.SelectSingleNode(\"formatted_address\")\n            Set countyNodes = n.SelectSingleNode(\"address_component[type='administrative_area_level_2']/long_name\")\n\nIf Not latitudenodes Is Nothing Then latitude = latitudenodes.Text\n            If Not LongitudeNodes Is Nothing Then longitude = LongitudeNodes.Text\n            If Not addressNodes Is Nothing Then altAddress = addressNodes.Text\n</code></pre>\n\n<p>But using something like that isn't working with the Yahoo one.  I think/know it's because their XML is laid out differently - they have text and quotes, whereas the Google one is just the tags with the value between (\"Pennsylvania Ave SE\").</p>\n\n<p>How can I do the same with the Yahoo one?  (What's that type of XML called, if it has a different technical name?).</p>\n\n<p>Thanks for any ideas!</p>\n\n<p>Edit: Note, I just tried and I <strong>can</strong> get the \"\" and \"\" values, since they follow my pattern I use with Google...it's the values that are inside <code>&lt; ... &gt;</code> that I'm unsure how to pull out.</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "edited": false, "score": 0, "creation_date": 1440610511, "post_id": 32232504, "comment_id": 52348614, "body": "While that is a good idea, the number of items in the array tops 3k. Also, the list is imported from an external program, which puts the items in Sheet 2 of the workbook."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": true, "score": 0, "last_activity_date": 1440615514, "last_edit_date": 1440615514, "creation_date": 1440608540, "answer_id": 32232504, "question_id": 32232309, "link": "https://stackoverflow.com/questions/32232309/copy-data-from-spreadsheet-into-array-for-filtering/32232504#32232504", "title": "Copy data from spreadsheet into Array for filtering", "body": "<p>You could create a form with a textbox that allows the user to enter the codes for the array separated by commas, then use the split function to populate your array. eg </p>\n\n<pre><code>Dim arrCriteria as Variant\nUserForm1.show vbModal\narrCriteria = Split(UserForm1.Textbox1.Text, \",\")\nUnload UserForm1\nCriteria1:=arrCriteria\n</code></pre>\n\n<p>On the Userform you just need your textbox and an Ok button. The Ok button should just hide userform1. If you unload it before you get the value of the textbox, the values entered into the textbox will be lost.</p>\n\n<hr>\n\n<p>Based on your comment, the elements of the array that are used as filter criteria get placed on another sheet. Assuming they are all on the same row, simply load your array by looping through the columns or rows. eg:</p>\n\n<pre><code>Dim arrCriteria() as Variant '(or String or Long or whatever your data type is)\nDim intArrLen as Integer\nDim c as Integer\nintArrLen = Sheet2.UsedRanged.Columns.Count\n'If your array criteria get placed in a column instead of a row use:\n'intArrLen = Sheet2.UsedRange.Rows.Count\n'And then update the code 5 line below to:\n'    arrCriteria(c) = Sheet2.Cells(c, 1).Value\nReDim arrCriteria (1 to intArrLen)\nFor c = 1 to intArrLen\n    'Presuming the array criteria get loaded to row 1\n    arrCriteria(c) = Sheet2.Cells(1, c).Value\nNext c\n</code></pre>\n\n<p>It seems your issue is manually editing your macro to contain all the elements in your array that you use to filter the data on your sheet. You haven't given the best description of where the criteria comes from (apparently it comes from another sheet) nor did you mention how much there was (your example code had 2 elements in your array but in your comment you state there are thousands of elements). Both code examples show you different methods of loading an array. Play around with them to come up with the best method that works for you. If you still get stuck, update your question with the code that is failing and someone on SO will happily help. :)</p>\n"}], "owner": {"reputation": 1637, "user_id": 4430536, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/51713a7c5ebbdcb411bb821889591145?s=128&d=identicon&r=PG&f=1", "display_name": "Clauric", "link": "https://stackoverflow.com/users/4430536/clauric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 32232504, "answer_count": 1, "score": 0, "last_activity_date": 1440615514, "creation_date": 1440607877, "last_edit_date": 1531161705, "question_id": 32232309, "link": "https://stackoverflow.com/questions/32232309/copy-data-from-spreadsheet-into-array-for-filtering", "title": "Copy data from spreadsheet into Array for filtering", "body": "<p>I have the following code in a macro that I wrote:</p>\n\n<pre><code>Columns(\"B:E\").Select\nApplication.CutCopyMode = False\nSelection.AutoFilter\nActiveSheet.Range(\"$B$1:$E$1000000\").AutoFilter Field:=3, Criteria1:=Array(\"90\", \"95\"), Operator:=xlFilterValues\nSelection.Copy\nSet WS = Sheets.Add(after:=Worksheets(\"ID Sheet\"), Type:=xlWorksheet)\nRange(\"B1\").Select\nActiveSheet.Paste\nColumns(\"B:E\").Select\nColumns(\"B:E\").EntireColumn.AutoFit\nActiveSheet.Name = \"Deals\"\n</code></pre>\n\n<p>Its purpose is to filter the data, and copy it to a different spreadsheet. It works well for its purpose, but as the codes in the array are hardcoded, it is time consuming to change.</p>\n\n<p>I am wondering is there any way to get data from a location in another spreadsheet to be entered in the array automatically?</p>\n\n<p>IE:</p>\n\n<pre><code>Columns(\"B:E\").Select\nApplication.CutCopyMode = False\nSelection.AutoFilter\nActiveSheet.Range(\"$B$1:$E$1000000\").AutoFilter Field:=3, _\nCriteria1:=Array(***CODE IN HERE TO REFER to RANGE IN SHEET 2***), _\nOperator:=xlFilterValues\nSelection.Copy\nSet WS = Sheets.Add(after:=Worksheets(\"ID Sheet\"), Type:=xlWorksheet)\nRange(\"B1\").Select\nActiveSheet.Paste\nColumns(\"B:E\").Select\nColumns(\"B:E\").EntireColumn.AutoFit\nActiveSheet.Name = \"Deals\"\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>To provide some more clarity. </p>\n\n<p>The list of values I am looking to enter into the array is 3k+. The list is imported from a different program, and stored in a specific location in Sheet2. Every time a user runs the program, the list of values imported will change, as will the number (range is from 300 - 30k). They will always be imported into the same location. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2197, "user_id": 2519073, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/71094909be9f40bd576b1974a74966aa?s=128&d=identicon&r=PG&f=1", "display_name": "ya_dimon", "link": "https://stackoverflow.com/users/2519073/ya-dimon"}, "is_accepted": false, "score": 0, "last_activity_date": 1440634109, "last_edit_date": 1495541176, "creation_date": 1440634109, "answer_id": 32238652, "question_id": 32232138, "link": "https://stackoverflow.com/questions/32232138/need-vba-code-to-display-multiple-slicer-selections-in-excel-cell/32238652#32238652", "title": "Need VBA code to display multiple slicer selections in excel cell", "body": "<p>first general suggestion,<br>\nuse F8 and SUB to test your code line by line, and watch window to see variable content<br>\ngoogle for \"vba debug\"<br>\nuse <code>option explicit</code> mode to check your variable types</p>\n\n<p>with it, you can find whats wrong easily.<br>\ne.g. i found, that <code>cache</code> has wrong type.<br>\nYou select just one <code>SlicerCache</code> of <code>ThisWorkbook.SlicerCaches</code> collection by <code>ThisWorkbook.SlicerCaches(\"Slicer_YR_MNTH_CD1\")</code>, so it should be:  </p>\n\n\n\n<pre><code>Dim cache As Excel.SlicerCache 'not SlicerCacheS\n</code></pre>\n\n<p>now you have your target cache in the variable <code>cache</code></p>\n\n<p>to be sure that you dont call your function recursive, i suggest to use a temp variable to any operations.<br>\ne.g. <code>Dim sSlicerItems as String</code></p>\n\n<p>i m not sure about right logic of this if/else statements, but anyway your corrected code could look like:  </p>\n\n<pre><code>Public Function GetSlicerItems() As String\n    Dim sSlicerItems As String\n\n    Dim cache As Excel.SlicerCache\n    Set cache = ThisWorkbook.SlicerCaches(\"Slicer_YR_MNTH_CD1\")\n\n    Dim sItm As Excel.SlicerItem\n    Dim ICt As Long\n\n    For Each sItm In cache.SlicerItems\n        If sItm.Selected = True Then sSlicerItems = sSlicerItems &amp; sItm.Name &amp; \", \"\n        ICt = ICt + 1\n        If sItm.HasData = False Then\n            ICt = ICt + 1\n        End If\n    Next\n    If Len(sSlicerItems) &gt; 0 Then\n        If ICt = cache.SlicerItems.Count Then\n            sSlicerItems = \"All Items\"\n        Else\n            sSlicerItems = Left(sSlicerItems, Len(sSlicerItems) - 2)\n        End If\n    Else\n        sSlicerItems = \"No items selected\"\n    End If\n\n    GetSlicerItems = sSlicerItems\nEnd Function\n</code></pre>\n\n<p>for process something on all slicers, or slicers of only one sheet,\nuse this loop-over-slicers example <a href=\"https://stackoverflow.com/a/20486330/2519073\">https://stackoverflow.com/a/20486330/2519073</a> and <code>.parent</code> property (its a worksheet) of <code>SlicerCache</code> item<br>\nmaybe you will need more <code>SlicerCache</code> properties for your solution.<br>\ncheck <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822652.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/ff822652.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9363255, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155627613627950/picture?type=large", "display_name": "Maria Jurado", "link": "https://stackoverflow.com/users/9363255/maria-jurado"}, "is_accepted": false, "score": 1, "last_activity_date": 1518673301, "last_edit_date": 1518673301, "creation_date": 1518672760, "answer_id": 48800513, "question_id": 32232138, "link": "https://stackoverflow.com/questions/32232138/need-vba-code-to-display-multiple-slicer-selections-in-excel-cell/48800513#48800513", "title": "Need VBA code to display multiple slicer selections in excel cell", "body": "<p>Great approach Thanks for Sharing. The True and False If statement weren't working for me, so I just move to next line and now it works </p>\n\n<pre><code>Public Function GetSlicerItems() As String\n    Dim sSlicerItems As String\n\n    Dim cache As Excel.SlicerCache\n    Set cache = ThisWorkbook.SlicerCaches(\"Slicer_AUTH_BHS_GROUP\")\n\n    Dim sItm As Excel.SlicerItem\n    Dim ICt As Long\n\n    For Each sItm In cache.SlicerItems\n        If sItm.Selected = True Then\n        sSlicerItems = sSlicerItems &amp; sItm.Name &amp; \", \"\n        ICt = ICt + 1\n        End If\n        If sItm.HasData = False Then\n            ICt = ICt + 1\n        End If\n    Next\n    If Len(sSlicerItems) &gt; 0 Then\n        If ICt = cache.SlicerItems.Count Then\n            sSlicerItems = \"All Items\"\n        Else\n            sSlicerItems = Left(sSlicerItems, Len(sSlicerItems) - 2)\n        End If\n    Else\n        sSlicerItems = \"No items selected\"\n    End If\n\n    GetSlicerItems = sSlicerItems\n\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4548014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/139d307d78c695b4e25ffcb01eff9ca5?s=128&d=identicon&r=PG&f=1", "display_name": "T Bro", "link": "https://stackoverflow.com/users/4548014/t-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1518673301, "creation_date": 1440607207, "question_id": 32232138, "link": "https://stackoverflow.com/questions/32232138/need-vba-code-to-display-multiple-slicer-selections-in-excel-cell", "title": "Need VBA code to display multiple slicer selections in excel cell", "body": "<p>This is my first shot using VBA.  I need to display slicer selections in excel spreadsheets.  There are 15-20 slicers in each sheet, with up to 50 possible selections, so I do not want to use the cube code to display one selection in each cell.  I'd like them all to be separated by comma in one cell if possible (or return \"all\" or \"none\").</p>\n\n<p>Here is what I have pieced together through research on this site and others, as well as attempting to edit it myself (so it is likely a complete mess).  </p>\n\n<p>I'm giving up searching and asking for help!  And if you can point me to a simple, \"crash course\" VBA basics site, I'd appreciate it as well.  Thank you. </p>\n\n<pre><code>Public Function GetSlicerItems()\nDim cache As Excel.SlicerCaches\nSet cache = ThisWorkbook.SlicerCaches(\"Slicer_YR_MNTH_CD1\")\nDim sItm As Excel.SlicerItem\nDim ICt As Long\n\nFor Each sItm In cache.SlicerItems\nIf sItm.Selected = True Then GetSlicerItems = GetSlicerItems &amp; sItm.Name &amp; \", \"\nICt = ICt + 1\nIf sItm.HasData = False Then\nICt = ICt + 1\nEnd If\nNext\nIf Len(GetSlicerItems) &gt; 0 Then\nIf ICt = cache.SlicerItems.Count Then\nGetSlicerItems = \"All Items\"\nElse\nGetSlicerItems = Left(GetSlicerItems, Len(GetSlicerItems) - 2)\nEnd If\nElse\nGetSlicerItems = \"No items selected\"\nEnd If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2058921, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/56648d3e64b44b9b79e4ab6e5ed2f43e?s=128&d=identicon&r=PG", "display_name": "lamcpp", "link": "https://stackoverflow.com/users/2058921/lamcpp"}, "edited": false, "score": 0, "creation_date": 1440620400, "post_id": 32234912, "comment_id": 52354195, "body": "And how to do it in vba?"}], "tags": [], "owner": {"reputation": 832, "user_id": 5137019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b5d97d531f0c8180ad9543cb5efc530?s=128&d=identicon&r=PG&f=1", "display_name": "dev1998", "link": "https://stackoverflow.com/users/5137019/dev1998"}, "is_accepted": false, "score": 0, "last_activity_date": 1440632911, "last_edit_date": 1440632911, "creation_date": 1440616534, "answer_id": 32234912, "question_id": 32232120, "link": "https://stackoverflow.com/questions/32232120/how-find-duplicate-values-and-corresponding-them-value-wchich-are-not-the-same/32234912#32234912", "title": "How find duplicate values and corresponding them value wchich are not the same", "body": "<p>Try this in cell D1:</p>\n\n<pre><code>=IF(COUNTIF(A$1:A$7,A1)&gt;1,IF(COUNTIF(C$1:C$7,C1)&gt;1,\"\",\"Bad\"),\"\")\n</code></pre>\n\n<p>Copy it down to D7.</p>\n\n<p>I got the idea from here:<a href=\"http://www.techrepublic.com/blog/windows-and-office/how-to-find-duplicates-in-excel-245163/\" rel=\"nofollow\">find duplicates in excel</a></p>\n\n<p>Here is some VBA that worked for me.  I looked at some of your other questions and I think you'll be able to see how it works and modify it in case it is not exactly what you are looking for. Basically it loops through the cells and inside the loop it uses the Find function. </p>\n\n<pre><code>Sub MacroFind()\nDim strAddress As String\nDim lastRow As Long\nDim strCell As String\nDim startingCellFoundAlready As Boolean\nDim colCValue As String\n\nWith ActiveSheet\n    lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).row\n\n    For Each cell In Range(\"A1:A\" &amp; lastRow)\n    strCell = cell.Address\n    colCValue = cell.Offset(0, 2).Value\n\n    startingCellFoundAlready = False\n\n            With Worksheets(\"SheetSomething\").Range(\"a:a\")\n\n                Set c = .Find(cell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n\n                If Not c Is Nothing Then\n                    Do\n                        strAddress = c.Address\n                        If ((strCell &lt;&gt; strAddress) And (c.Offset(0, 2).Value &lt;&gt; colCValue)) Then\n                            c.Offset(0, 5).Value = \"Bad\"\n                            c.Interior.ColorIndex = 37 ' Blue highlight\n                            c.Offset(0, 2).Interior.ColorIndex = 37 ' Blue highlight\n                        End If\n\n                        If (startingCellFoundAlready = True) Then\n                            Exit Do\n                        End If\n\n                        If ((strCell = strAddress) And (startingCellFoundAlready = False)) Then\n                            startingCellFoundAlready = True\n                        End If\n\n                        Set c = .FindNext(c)\n\n                    Loop While Not c Is Nothing\n                End If\n\n            End With\n\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 2058921, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/56648d3e64b44b9b79e4ab6e5ed2f43e?s=128&d=identicon&r=PG", "display_name": "lamcpp", "link": "https://stackoverflow.com/users/2058921/lamcpp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440632911, "creation_date": 1440607154, "last_edit_date": 1531164843, "question_id": 32232120, "link": "https://stackoverflow.com/questions/32232120/how-find-duplicate-values-and-corresponding-them-value-wchich-are-not-the-same", "title": "How find duplicate values and corresponding them value wchich are not the same", "body": "<p>I have the table in Excel:</p>\n\n<pre><code>     A    B        C\n    12   Novak    Bern\n    73   Bayda    Frankfurt\n    1    Schmidt  Koln\n    12   Novak    Bern\n    9    Beckhan  Paris\n    11   Youd     Warsaw\n    73   Dosed    Kiev\n</code></pre>\n\n<p>I'd like find and highlight all rows which:\n-value in column \"A\" are the same (duplicate values) like:\nCells(2,1) And Cells(7,1) \n- AND corresponding them value in column \"C\" are NOT the same</p>\n\n<p>How can I do that. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1440607383, "post_id": 32232015, "comment_id": 52346804, "body": "What do you mean &quot;it doesn&#39;t work&quot;? Does it produce an error or something?"}, {"owner": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1440607502, "post_id": 32232015, "comment_id": 52346860, "body": "Sorry I just edit it, No errors it just doesn&#39;t create the filter."}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1440615409, "post_id": 32232015, "comment_id": 52351477, "body": "hmm. The first time you run a range.autofilter command, it removes the previous autofilter. so maybe you need to run it twice?"}, {"owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1440615498, "post_id": 32232015, "comment_id": 52351522, "body": "Also, you might want to consider using <a href=\"https://support.office.com/en-ca/article/Overview-of-Excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c\" rel=\"nofollow noreferrer\">tables</a>. That way, you can have multiple autofilters on the same sheet. It has some other nice features too."}, {"owner": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "reply_to_user": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "edited": false, "score": 0, "creation_date": 1440621630, "post_id": 32232015, "comment_id": 52354884, "body": "I&#39;m using tables now, its seems it&#39;s the only solution....for now"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "edited": false, "score": 0, "creation_date": 1440621592, "post_id": 32235668, "comment_id": 52354870, "body": "Good answer but your method applies a filter, I want to create a filter, that means avoid for the user to select the headers of the table and the click filter"}, {"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "reply_to_user": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "edited": false, "score": 0, "creation_date": 1440621838, "post_id": 32235668, "comment_id": 52354994, "body": "The VBA macro does the job of creating and applying the filter, there is no need for the user to create the filter. What else does &quot;I want to create a filter&quot; mean?"}, {"owner": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "edited": false, "score": 0, "creation_date": 1440688697, "post_id": 32235668, "comment_id": 52386862, "body": "It doesn&#39;t create the filter because the arrows are not shown...&quot;I want to create a filter&quot; means, like I specified in the question, the user doesn&#39;t have to manually create a filter on the range but it is created automatically, that means, the user doesn&#39;t click in the Home tab, the select the range, then click filter, that means that the macro should display the arrows on the headers automaticly as I changed &quot;views&quot;"}, {"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "reply_to_user": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "edited": false, "score": 0, "creation_date": 1440706866, "post_id": 32235668, "comment_id": 52397359, "body": "that is exactly what my code does, as you describe. what&#39;s wrong with it?"}, {"owner": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "edited": false, "score": 0, "creation_date": 1448555825, "post_id": 32235668, "comment_id": 55645930, "body": "It&#39;s not worng, it&#39;s not what I&#39;m looking for, I want to display the filter icons on all the columns but not apply a criteria."}], "tags": [], "owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "is_accepted": false, "score": 0, "last_activity_date": 1440619278, "creation_date": 1440619278, "answer_id": 32235668, "question_id": 32232015, "link": "https://stackoverflow.com/questions/32232015/excel-vba-how-can-i-create-not-apply-a-filter-in-a-range/32235668#32235668", "title": "Excel VBA - How can I create (not apply) a filter in a range?", "body": "<p>This will filter the second column of the range and select all the values equal to <code>\"abc\"</code>?</p>\n\n<pre><code>Hoja1.Range(\"A2:P350\").AutoFilter Field:=2, Criteria1:=\"abc\"\n</code></pre>\n\n<p>You can record a macro while you manually apply the filter to see what the macro recorder does, then create your own macro using the recorded one as inspiration.</p>\n"}], "owner": {"reputation": 45, "user_id": 4204004, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/176589276fa715039b4b7fe3bdbdfdf7?s=128&d=identicon&r=PG&f=1", "display_name": "Jose", "link": "https://stackoverflow.com/users/4204004/jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440619278, "creation_date": 1440606734, "last_edit_date": 1531164843, "question_id": 32232015, "link": "https://stackoverflow.com/questions/32232015/excel-vba-how-can-i-create-not-apply-a-filter-in-a-range", "title": "Excel VBA - How can I create (not apply) a filter in a range?", "body": "<p>I have multiple \"tables\" in the same sheet, I have a dropdown list (Classes, students, teachers) that I use as a menu so when its changed it \"redirects\" to the cell where the table is in the same sheet, so if I select Classes it goes to cell A2, if I select students it goes to cell A200 and if I select teachers it goes to cell A400.\nSince I can create only one filter per sheet, how can I create a filter on the table that has been selected, so if I select Students, a filter is created on the range A2:P350.</p>\n\n<p>This is so when the user selects an option, he doesn't have to manually create a filter on the range but it is created automatically.</p>\n\n<p>I tried Hoja1.Range(\"A2:P350\").AutoFilter, but it doesn't create the filter.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440608490, "post_id": 32231968, "comment_id": 52347424, "body": "What do you mean by <code>&quot;Workbook2&quot;</code>? And why are you accessing your workbook through the <code>Workbooks</code> collection when you seemingly already have a workbook reference named <code>wb</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5269483, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/25c7fa905d06c74cdfbfe9a8855832f4?s=128&d=identicon&r=PG&f=1", "display_name": "Misha AM", "link": "https://stackoverflow.com/users/5269483/misha-am"}, "edited": false, "score": 0, "creation_date": 1440697587, "post_id": 32232093, "comment_id": 52392429, "body": "Will try.. btw, what is wrong with Activate and Select? without knowing any better, I wrote that in many of my spreadsheets."}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "reply_to_user": {"reputation": 117, "user_id": 5269483, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/25c7fa905d06c74cdfbfe9a8855832f4?s=128&d=identicon&r=PG&f=1", "display_name": "Misha AM", "link": "https://stackoverflow.com/users/5269483/misha-am"}, "edited": false, "score": 0, "creation_date": 1440702690, "post_id": 32232093, "comment_id": 52395197, "body": "Couple different things: 1. they slow things down tremendously (especially once you start selecting cells in loops, 2. they make it hard to track in macros where the object actually is, making complex procedures harder to maintain. There&#39;s probably a few others but those are the main ones that come to my mind."}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": false, "score": 1, "last_activity_date": 1440608090, "last_edit_date": 1440608090, "creation_date": 1440607069, "answer_id": 32232093, "question_id": 32231968, "link": "https://stackoverflow.com/questions/32231968/counting-the-number-of-rows-in-a-specific-worksheet/32232093#32232093", "title": "Counting the number of rows in a specific worksheet", "body": "<ol>\n<li>Avoid Activate and Select as much as possible</li>\n<li>I repeat, avoid Activate and Select as much as possible</li>\n<li>Your range refers to the active sheet, so it should be pulling wb.name / sheet 1. </li>\n</ol>\n\n<p>Try the following simplified code:</p>\n\n<pre><code>with wb.worksheets(\"sheet1\")\n    partII = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row \n\n    For Each myRecord In .Range(\"A1:A\" &amp; partII)\n        '...\n    Next myRecord\n\nend with\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5269483, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/25c7fa905d06c74cdfbfe9a8855832f4?s=128&d=identicon&r=PG&f=1", "display_name": "Misha AM", "link": "https://stackoverflow.com/users/5269483/misha-am"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1440608090, "creation_date": 1440606575, "question_id": 32231968, "link": "https://stackoverflow.com/questions/32231968/counting-the-number-of-rows-in-a-specific-worksheet", "title": "Counting the number of rows in a specific worksheet", "body": "<p>I launch the following code from workbook1, and want to count the number of rows in workbook2(wb.Name). Why does partII return the row count from workbook1? </p>\n\n<pre><code>Dim partII As String\nWorkbooks(wb.Name).Activate\nWorkbooks(wb.Name).Worksheets(\"sheet1\").Select\npartII = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor Each myRecord In Workbooks(wb.Name).Worksheets(\"sheet1\").Range(\"A1:A\" &amp; partII)\n</code></pre>\n"}, {"tags": ["macos", "vba", "excel"], "comments": [{"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 1, "creation_date": 1440608086, "post_id": 32231967, "comment_id": 52347201, "body": "&#39;pasting the wrong information&#39; what information did you expect it to paste? what actually pasted?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1440608400, "post_id": 32231967, "comment_id": 52347378, "body": "The data you are trying to paste, it&#39;s always in one row yes? Range A7 to CD7?"}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440609990, "post_id": 32231967, "comment_id": 52348285, "body": "The information in the range I&#39;m trying to paste is all located in one row, where the value in Column A = Variable A from the sub. After isolating the row with that value, it should copy the values (text and numbers) from Columns A through CD, though the row number may differ. I&#39;m still trying to figure out how to do that."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440610113, "post_id": 32231967, "comment_id": 52348373, "body": "Ohhhh uh then you realize your destination range isn&#39;t wide enough to hold your source range? Edit: 82 columns? Yikes XD"}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440610559, "post_id": 32231967, "comment_id": 52348648, "body": "/insert Slowpoke meme  The reason why I had it set like that was because the Macro Editor recorded it when I did it manually...and a large number of the columns are hidden and when the data is filtered out, a manual copy/paste fits perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440611103, "post_id": 32232962, "comment_id": 52348967, "body": "Thanks for your feedback! I&#39;m brand-new at this, but I try to do things well, and if I can&#39;t I want to get better.  Your idea to make the destination range = source range works because I only anticipate to find one instance of Variable A in Workbook X.   I&#39;m getting a runtime error 91 on this section:  <code>fRow = rng.Row</code>"}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440611433, "post_id": 32232962, "comment_id": 52349140, "body": "I tried to edit my previous comment: I&#39;m getting a run-time error 1004 (Method &#39;Find&#39; of object &#39;Range&#39; failed) on the <code>Set rng = ws.Range...</code> section.  I tried removing the portion &quot;ws.Range(&quot;A2:DQ11&quot;).&quot; before the Find string, and I&#39;m getting a runtime error 91 on this section:  <code>fRow = rng.Row</code>"}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440615814, "post_id": 32232962, "comment_id": 52351697, "body": "When I added the Address to that section, it came up with an Invalid Qualifier compile error. I also changed the range to Find to Column A (cells 3-1000), since that&#39;s the only column I need the macro to check for the value of Variable A. Didn&#39;t help, though. I can change the destination/source ranges later, right now I just need the thing to loop through and pull the right data"}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440617125, "post_id": 32232962, "comment_id": 52352473, "body": "I saw and made those three changes, still ending up with a runtime error 91 on <code>fRow = rng.Row</code>. How does an error 91 get resolved?"}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440618210, "post_id": 32232962, "comment_id": 52353073, "body": "Made your changes, it ran through with the <code>On Error Resume Next</code> added but didn&#39;t paste any data. I removed that line and re-ran it, and the runtime error 91 on <code>fRow = rng.Row</code> persists. I&#39;m starting to wonder if I need to focus on just writing the code to find the variable in the first place? I&#39;m not sure, still researching."}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440622453, "post_id": 32232962, "comment_id": 52355306, "body": "Is that line coming up with the runtime error 91 because fRow isn&#39;t &quot;Set&quot;? If so, what do you Set the variable fRow as?"}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "reply_to_user": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440628732, "post_id": 32232962, "comment_id": 52357941, "body": "Really sorry. I am bad at setting ranges as I anticipated XD No, frow isn&#39;t working because it&#39;s not found on every sheet so rng is empty. The on error resume next fixes that (poorly. There could be better error testing). For now, we need to get ranges to work. I should have more time tomorrow."}, {"owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "edited": false, "score": 0, "creation_date": 1440687681, "post_id": 32232962, "comment_id": 52386178, "body": "Made a new post here: <a href=\"http://stackoverflow.com/questions/32252879/excel-vba-update-find-data-loop-through-multiple-worksheets-copy-range\" title=\"excel vba update find data loop through multiple worksheets copy range\">stackoverflow.com/questions/32252879/&hellip;</a>, had a few ideas that helped? Maybe?"}], "tags": [], "owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "is_accepted": false, "score": 1, "last_activity_date": 1440617651, "last_edit_date": 1440617651, "creation_date": 1440609990, "answer_id": 32232962, "question_id": 32231967, "link": "https://stackoverflow.com/questions/32231967/excel-vba-find-data-loop-through-multiple-worksheets-copy-specific-range-of-c/32232962#32232962", "title": "Excel VBA: Find data, loop through multiple worksheets, copy specific range of cells", "body": "<p>This is NOT tested. I am taking a stab at what I think you want to do. You're filtering A2 to DQ11 so that's where I set the <code>find</code> range. And you're pasting to B2 to S2 and that's only 11 columns wide so that's the range of data I am grabbing. Since you're pasting values (no formatting needed), I am setting the destination range to the source range directly, instead of copy/paste.</p>\n\n<p>Again, untested but I can try to help with errors. I am anticipating range errors XD In short, make backups before you try my code.</p>\n\n<p>Also, not sure if you expect to find data in every sheet. If so, you can't set the destination range as a constant (B2:S2) because the newer data will just overwrite the existing (unless that's what you want). You might consider adding error checking.</p>\n\n<p>Finally, a tangent, but you've been really awesome taking comments and suggestions then doing the research to figure it all out and come back with new questions ^_^</p>\n\n<pre><code>Sub Pull_data_Click()    \nDim A As Variant 'defines name from first subroutine\nDim B As Workbook 'defines destination file\nDim X As Workbook 'defines existing report file as source\nDim Destination As Range 'defines destination range of data pulled from report\nDim wb As Workbook\nDim ws As Worksheet\nDim rng As Variant\nDim copyRng As Variant\nDim fRow As Long\n\nApplication.ScreenUpdating = False\n\nSet B = Workbooks(\"filenameB.xlsm\") 'constant variable, does not change\nSet X = Workbooks.Open(\"filenameX.xlsm\") 'dependent variable, new name for each new report\n'once you set a wordbook, you can use it ^_^\nA = B.Worksheets(\"Summary\").Range(\"A1\").Value 'constant variable, does not change\nSet Destination = B.Worksheets(\"Input\").Range(\"B2:S2\") 'Range changes for each iteration, rows increase by 1\n\n'check if name is entered\nIf A = \"\" Then\nMsgBox (\"Your name is not visible; please start from the Reference tab.\")\nB.Worksheets(\"Reference\").Activate\nExit Sub\nEnd If\n\n\nFor Each ws In X.Worksheets\nwith ws.range(\"A:A\")\nOn Error Resume Next '&lt;---add\nSet rng = .Find(What:=A, After:=ActiveCell, LookIn:=xlValues, _\n            LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n\n            fRow = rng.Row\n            Set copyRng = ws.Range(Cells(fRow, 1), Cells(fRow, 18)) 'i think you want 18 because you're pasting to a range that is 18 cols wide\n            Destination = copyRng\nend with '&lt;-- move it here            \nNext ws\n\nApplication.ScreenUpdating = True\nend sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 5261407, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/LSMDO.png?s=128&g=1", "display_name": "WhalesLarry", "link": "https://stackoverflow.com/users/5261407/whaleslarry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2582, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440617651, "creation_date": 1440606573, "question_id": 32231967, "link": "https://stackoverflow.com/questions/32231967/excel-vba-find-data-loop-through-multiple-worksheets-copy-specific-range-of-c", "title": "Excel VBA: Find data, loop through multiple worksheets, copy specific range of cells", "body": "<p>I am creating a macro for a file that will be distributed to a team of people; the function is supposed to be able to pull the person's name from a different cell (in Variable B), search for that value in another workbook with multiple sheets (Variable X), and if found copy a specific range of cells from Workbook X to Workbook B.</p>\n\n<p>I am having trouble with the following code:</p>\n\n<pre><code>Sub Pull_data_Click()\n\nDim A As Variant 'defines name from first subroutine\nDim B As Workbook 'defines destination file\nDim X As Workbook 'defines existing report file as source\nDim Destination As Range 'defines destination range of data pulled from report\nDim wb As Workbook\nDim ws As Worksheet\nDim rng As Range\n\nA = Workbooks(\"filenameB.xlsm\").Worksheets(\"Summary\").Range(\"A1\").Value 'constant variable, does not change\nSet B = Workbooks(\"filenameB.xlsm\") 'constant variable, does not change\nSet X = Workbooks.Open(\"filenameX.xlsm\") 'dependent variable, new name for each new report\nSet Destination = Workbooks(\"filenameB.xlsm\").Worksheets(\"Input\").Range(\"B2:S2\") 'Range changes for each iteration, rows increase by 1\n\n'check if name is entered\nIf A = \"\" Then\nMsgBox (\"Your name is not visible; please start from the Reference tab.\")\nB.Worksheets(\"Reference\").Activate\nExit Sub\nEnd If\n\nWith X.Worksheets\nFor Each ws In X.Worksheets\nSet rng = Cells.Find(What:=A, After:=ActiveCell, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)\n            ActiveCell.Activate\n            ActiveSheet.Range(\"$A$2:$DQ$11\").AutoFilter Field:=1, Criteria1:=A\n            Range(\"A7:CD7\").Select\n            Selection.Copy\n            B.Activate\n            Destination.Activate\n            Destination.PasteSpecial Paste:=xlPasteValues\n\nNext ws\nEnd With\n\n\nApplication.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n\n<p>It is able to compile successfully and has no run-time errors, and when it runs it seems to be looping through the worksheets correctly...but it is pasting the wrong information. Is there anything in this I haven't set up properly?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1440606259, "post_id": 32231786, "comment_id": 52346137, "body": "Have you tried checking for the file&#39;s existence and just deleting it if it exists, prior to your export?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440608280, "post_id": 32231786, "comment_id": 52347314, "body": "That is probably why you code will not overwrite it."}, {"owner": {"reputation": 27, "user_id": 3672858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55db9d5266a5fcbccc517a2d2c5462b1?s=128&d=identicon&r=PG&f=1", "display_name": "StoneLight", "link": "https://stackoverflow.com/users/3672858/stonelight"}, "edited": false, "score": 0, "creation_date": 1440608490, "post_id": 32231786, "comment_id": 52347423, "body": "Yes I tried it and realized that I was getting the error because the file was open in another program therefore it did not have permission to save. Thank you"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440608669, "post_id": 32231786, "comment_id": 52347512, "body": "That will do it. If you attempt to delete it yourself you can add some error handling to account for that condition. See change to my answer."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 0, "last_activity_date": 1440609259, "last_edit_date": 1440609259, "creation_date": 1440607821, "answer_id": 32232303, "question_id": 32231786, "link": "https://stackoverflow.com/questions/32231786/vba-failing-to-export-from-excel-to-pdf-if-the-file-already-exists/32232303#32232303", "title": "vba failing to export from excel to pdf if the file already exists", "body": "<p>Check if it exists and delete it.  In you VBA IDE go to the tools menu and selecte references.  Select \"Microsoft scripting runtime\"</p>\n\n<pre><code>Dim Response As Integer\nDim fs As FileSystemObject\n\n'We can come back to here after an error.\nTryAgain:\n\n If fs.FileExists(strFile) = True Then\n      On Error Goto DeleteError\n      fs.DeleteFile(strFile, True)     \n End If\n\n DeleteError:\n Response = MsgBox(\"Error deleting file. Do you have it open? Try again?\", vbYesNo)\n ' If statement to check if the yes button was selected.\n If Response = vbYes Then\n     Goto TryAgain\n Else\n     Exit sub\n End If\n On Error Goto 0\n\n ws.ExportAsFixedFormat _\n      Type:=xlTypePDF, _\n      Filename:=strFile, _\n      Quality:=xlQualityStandard, _\n      IncludeDocProperties:=True, _\n      IgnorePrintAreas:=False, _\n      OpenAfterPublish:=False\n Call closews\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3672858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55db9d5266a5fcbccc517a2d2c5462b1?s=128&d=identicon&r=PG&f=1", "display_name": "StoneLight", "link": "https://stackoverflow.com/users/3672858/stonelight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4464, "favorite_count": 0, "accepted_answer_id": 32232303, "answer_count": 1, "score": 1, "last_activity_date": 1440609259, "creation_date": 1440605972, "last_edit_date": 1531164843, "question_id": 32231786, "link": "https://stackoverflow.com/questions/32231786/vba-failing-to-export-from-excel-to-pdf-if-the-file-already-exists", "title": "vba failing to export from excel to pdf if the file already exists", "body": "<pre><code>Sub printPdf()\nDim strPath As String\nDim myFile As Variant\nDim strFile As String\n'On Error GoTo errHandler\nSet ws = Application.ActiveSheet\n\n'enter name and select folder for file\n' start in current workbook folder\nstrFile = Replace(Replace(ws.Name, \" \", \"_\"), \".\", \"_\") _\n            &amp; \".pdf\"\nstrfolder = ThisWorkbook.Path &amp; \"\\myPdfFiles\"\n\nIf Len(Dir(strfolder, vbDirectory)) = 0 Then\n  MkDir (strfolder)\nEnd If\n\nstrFile = strfolder &amp; \"\\\" &amp; strFile\n\n    ws.ExportAsFixedFormat _\n        Type:=xlTypePDF, _\n        Filename:=strFile, _\n        Quality:=xlQualityStandard, _\n        IncludeDocProperties:=True, _\n        IgnorePrintAreas:=False, _\n        OpenAfterPublish:=False\n    Call closews\n\n\nexitHandler:\n    Exit Sub\nerrHandler:\n    MsgBox \"Could not create PDF file \" &amp; Err &amp; \": \" &amp; Error(Err)\n    Resume exitHandler\nEnd Sub\n</code></pre>\n\n<p>I am having an issue with saving the pdf files.\nIf the file already exists  in the folder and has some changes made to it the macro will crash  with the debugger pointing at the openAfterPulish line and display the following runtime error.</p>\n\n<p>-2214701887(80071779)<br>\n \"Document not saved.\"</p>\n\n<p>My goal is that excel should automatically overwrite the old files. Excel will prompt me if I want to overwrite the file when I am saving it manually but crashes when I run the above code.</p>\n"}, {"tags": ["excel", "excel-formula", "cell", "pivot-table", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440607505, "post_id": 32231943, "comment_id": 52346862, "body": "That&#39;s nearly done it. Now I just need away to combine multiple data entries into one cell. Is there is a way to do it with the &#39;&amp;&#39; function?"}, {"owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "reply_to_user": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440608065, "post_id": 32231943, "comment_id": 52347191, "body": "you can, but not within the pivot. You can either copy the pivot data to another sheet (as paste values) or add columns to the right. A simple &amp; formula works, e.g. <code>=a6&amp;&quot; &quot;&amp;b6</code>"}, {"owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440608647, "post_id": 32231943, "comment_id": 52347496, "body": "I&#39;d need some sort of boolean statement though wouldn&#39;t I? Something with the logic: =if(&quot;the date&quot; has more than one value&quot;, plot value 1 &amp; value 2 into once cell.)"}, {"owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "edited": false, "score": 0, "creation_date": 1440609898, "post_id": 32231943, "comment_id": 52348236, "body": "Figured it out :)  =IF(A5=&quot;&quot;,B4&amp;&quot; ; &quot;&amp;B5,IF(A4=&quot;&quot;,&quot;&quot;,B4))"}], "tags": [], "owner": {"reputation": 5852, "user_id": 1690392, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/A3DKR.jpg?s=128&g=1", "display_name": "nutsch", "link": "https://stackoverflow.com/users/1690392/nutsch"}, "is_accepted": true, "score": 1, "last_activity_date": 1440606489, "creation_date": 1440606489, "answer_id": 32231943, "question_id": 32231665, "link": "https://stackoverflow.com/questions/32231665/extracting-data-from-a-pivot-table-to-a-table-with-two-columns-combining-two-ce/32231943#32231943", "title": "Extracting data from a Pivot table to a table with two columns. Combining two cells to one", "body": "<ul>\n<li>Select the Pivot table</li>\n<li>Go to the Ribbon: PivotTable Tools \\ Design</li>\n<li>Report Layout \\ Show in Tabular form</li>\n</ul>\n\n<p>This should do it. Look at the other options in Report Layout and Subtotals to test other layout options. </p>\n"}], "owner": {"reputation": 79, "user_id": 2498088, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a46cfa9473d9ab4025550a8b2138ef13?s=128&d=identicon&r=PG", "display_name": "odoc", "link": "https://stackoverflow.com/users/2498088/odoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 32231943, "answer_count": 1, "score": 0, "last_activity_date": 1440608515, "creation_date": 1440605632, "last_edit_date": 1531161705, "question_id": 32231665, "link": "https://stackoverflow.com/questions/32231665/extracting-data-from-a-pivot-table-to-a-table-with-two-columns-combining-two-ce", "title": "Extracting data from a Pivot table to a table with two columns. Combining two cells to one", "body": "<p>I'm trying to extrat data from a pivot table. See photo below. Basically I need an end product with <strong>two columns</strong>, one with the date, the other listing all it's associated labels in one cell. (i.e. for \"2015-06-14\" it would list both 875-7A and 875-8 in one cell one column over). Please help.</p>\n\n<p>EDIT:</p>\n\n<p>New table. Now just to combine the data into one cell if the date has more than one label. the logic: =if(\"the date\" has more than one value\", plot value 1 &amp; value 2 into once cell.)</p>\n\n<p><a href=\"https://i.stack.imgur.com/GlRNs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GlRNs.png\" alt=\"See photo below\"></a></p>\n"}, {"tags": ["vba", "excel", "excel-charts"], "comments": [{"owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1440605750, "post_id": 32231649, "comment_id": 52345813, "body": "Can you not change how you get the data so it is already summed/grouped?"}, {"owner": {"reputation": 1, "user_id": 5213322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f5118a13ecaef5acf8c136bcbd93d8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh Dply", "link": "https://stackoverflow.com/users/5213322/suresh-dply"}, "reply_to_user": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "edited": false, "score": 0, "creation_date": 1440643178, "post_id": 32231649, "comment_id": 52361364, "body": "SQL = &quot;SELECT * FROM Transactions t WHERE DATEPART(&#39;m&#39;, t.[DOT])= MONTH(DATE()) AND DATEPART(&#39;yyyy&#39;, t.[DOT])= YEAR(DATE())&quot; rs.Open SQL, cnn, above query returns the data in a partcular month, I want to show sum of the amount of a date  in chart"}], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1440678632, "creation_date": 1440678632, "answer_id": 32249479, "question_id": 32231649, "link": "https://stackoverflow.com/questions/32231649/create-chart-using-recordset-data-in-vba-excel-code/32249479#32249479", "title": "Create chart using RecordSet data in VBA Excel code", "body": "<p>You have two choices:</p>\n\n<ol>\n<li><p>Run another SQL query using SUM and GROUP BY to give you the totals. This is the data for your chart.</p></li>\n<li><p>Look at using Pivot Charts in Excel. This will calc the totals for you and also draw the chart.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 531, "user_id": 1946796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vd55i.jpg?s=128&g=1", "display_name": "Rafa Barragan", "link": "https://stackoverflow.com/users/1946796/rafa-barragan"}, "is_accepted": false, "score": 1, "last_activity_date": 1457652399, "creation_date": 1457652399, "answer_id": 35929374, "question_id": 32231649, "link": "https://stackoverflow.com/questions/32231649/create-chart-using-recordset-data-in-vba-excel-code/35929374#35929374", "title": "Create chart using RecordSet data in VBA Excel code", "body": "<p>I agree with @ChipsLetten</p>\n\n<p>1.- From SQL you could use something like this:</p>\n\n<pre><code> ---- This is the sum for each day\nSELECT \n    t.DOT, SUM(t.Amount)\n    ---- You can add an extra Column with the SUM by Dates\n    /*\n    t.Dot, t.Category, t.Item, t.Amount\n    , SUM(t.Amount) OVER(PARTITION BY t.Dot ORDER BY t.Dot) [SumTrans]\n    */\nFROM Transactions t\nGROUP BY t.DOT\n-- If you add the Column you must change \"GROUP BY\"\n-- GROUP BY t.Dot, t.Category, t.Item, t.Amount\n</code></pre>\n\n<p><em>Adding the column you could use the <strong>DOT</strong> and <strong>SumTrans</strong> series to create the Chart</em></p>\n\n<p>2.- With pivot table is even better, you can clone your Recordset to create a pivot table that allows you to SUM Amount by DOT</p>\n\n<pre><code>*Wkb is a Workbooks object, Wks is a Worksheet object*\n\nDim oRstChrt As ADODB.Recordset, oStrm As ADODB.Stream\nDim oChrt As Chart\n\n'' Copy Recordset for the pivot table cache\nSet oRstChrt = New ADODB.Recordset\nSet oStrm = New ADODB.Stream\n\n'' Create an alternative Recordset for the new pivot table\noRst.Save oStrm\noRstChrt.Open oStrm\n\n'' Set Recordset to cache for a pivot table\nSet objPivotCache = _\n    Wkb.PivotCaches.Create(SourceType:=xlExternal, Version:=xlPivotTableVersion14)\n'' Recordset with Data\nSet objPivotCache.Recordset = oRstChrt\n'' Assign Range for the pivot table and Name it.\nWith objPivotCache\n    .CreatePivotTable TableDestination:=Wks.Range([Cell]), TableName:=[PivotTable_Name]\nEnd With\n</code></pre>\n\n<p><em>Afterwards put the fields you need,</em>\n<em>in this case <strong>DOT</strong> and <strong>Amount</em></strong></p>\n\n<pre><code>With Wks.PivotTables([PivotTable_Name])\n\n    With .PivotFields(\"DOT\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    '' You can create a second level, but \n    '' if the field is not collapse, your chart will change, \n    '' so keep the field collapse\n    '' To Collapse the field put this\n    '' Wks.PivotTables([PivotTable_Name]). _\n    ''        PivotFields([PivotTableField]).ShowDetail = False\n    'With .PivotFields(\"Item\")\n        '.Orientation = xlRowField\n        '.Position = 2\n    'End With\n\n    '' This allows you to SUM the Amount field\n    .AddDataField .PivotFields(\"Amount\"), \"Total Amount\", xlSum\n\nEnd\n\n'' After the Pivot Table was created you can create your chart\n'' Set the object\nSet oChrt = Charts.Add\n'' Give a name and format\nWith oChrt\n    .Name = \"[Chart_Name]\"\n    .ChartType = xlColumnClustered  '' you could change to 3D\n    '' Source Range in this case from the pivot table\n    .SetSourceData Source:=Wks.PivotTables([PivotTable_Name]).TableRange2, _\n                                PlotBy:=xlRows\n    '' Format chart\n    .HasTitle = True\n    .ChartTitle.Text = \"Total Transactions\"\n    .Axes(xlCategory, xlPrimary).HasTitle = True\n    .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"Dates\"\n'    .Axes(xlValue, xlPrimary).HasTitle = True\n'    .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Transactions\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5213322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f5118a13ecaef5acf8c136bcbd93d8?s=128&d=identicon&r=PG&f=1", "display_name": "Suresh Dply", "link": "https://stackoverflow.com/users/5213322/suresh-dply"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1666, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1457652399, "creation_date": 1440605571, "last_edit_date": 1440608767, "question_id": 32231649, "link": "https://stackoverflow.com/questions/32231649/create-chart-using-recordset-data-in-vba-excel-code", "title": "Create chart using RecordSet data in VBA Excel code", "body": "<p>I am getting data from Access, copying into Excel sheet and creating a chart using Excel VBA. The data looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3egMO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3egMO.png\" alt=\"enter image description here\"></a></p>\n\n<p>And the chart looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EXxzB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EXxzB.png\" alt=\"http://s2.postimg.org/rpixiwb3d/chart.png\"></a></p>\n\n<p>I want to show all transactions in sheet but in chart I want to show sum of amount of dates. For example on 19/08/2015 total amount 2695, 20/08/2015 total amount 287.</p>\n\n<p>How can I create a chart in VBA Excel to show the sum of each day?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2861, "user_id": 4243498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37cb34e286b747e290c570d07fc914c6?s=128&d=identicon&r=PG&f=1", "display_name": "ChipsLetten", "link": "https://stackoverflow.com/users/4243498/chipsletten"}, "is_accepted": false, "score": 0, "last_activity_date": 1440607487, "creation_date": 1440607487, "answer_id": 32232216, "question_id": 32231362, "link": "https://stackoverflow.com/questions/32231362/find-next-and-previous-record-to-display-in-userform/32232216#32232216", "title": "Find next and previous Record to display in Userform", "body": "<p>You've got these tests at the <em>end</em> of your loop:</p>\n\n<pre><code>Loop While Not c Is Nothing And c.Address &lt;&gt; FirstAddress\n</code></pre>\n\n<p>This means that the code keeps finding new values, writing them to the controls (each new one overrides the previous value) and only stops <em>once</em> the first value has been found again. You should test to see if <code>FindNext</code> has looped back to the first cell before you write values to your controls.</p>\n\n<pre><code>With Worksheets(\"Sheet1\").Range(\"N:N\")\nSet c = .Find(What:=\"Pending\", LookIn:=xlValues)\n\nIf Not c Is Nothing Then\n    FirstAddress = c.Address\n\n    Do\n        Set c = .findnext(c)\n        If c.Address = FirstAddress Then\n            Exit Do\n        End If\n        a = c.Offset(0, -9).Value\n        ' Do the rest of your code here\n    Loop While Not c Is Nothing\n\nEnd If\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5269375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f822168923427fe4cc9af4c700676407?s=128&d=identicon&r=PG&f=1", "display_name": "Chand Khan", "link": "https://stackoverflow.com/users/5269375/chand-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 590, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1440780432, "creation_date": 1440604723, "last_edit_date": 1440780432, "question_id": 32231362, "link": "https://stackoverflow.com/questions/32231362/find-next-and-previous-record-to-display-in-userform", "title": "Find next and previous Record to display in Userform", "body": "<p>I have a <code>userform</code> in which I want to display records. However, the code is returning on the first found value:</p>\n\n<pre><code>Private Sub commandbutton3_click() \n\nDim c As Range\nDim a As String\n\nWith Worksheets(\"Sheet1\").Range(\"N:N\")\nSet c = .Find(What:=\"Pending\", LookIn:=xlValues)\n\nIf Not c Is Nothing Then\n   FirstAddress = c.Address\n\n   Do\n      Set c = .findnext(c)\n      a = c.Offset(0, -9).Value\n      Me.Control1.Value = c.Offset(0, -13)\n      Me.Control2.Value = c.Offset(0, -12)\n      Me.Control3.Value = c.Offset(0, -9) &amp; \" \" &amp; c.Offset(0, -8)\n      Me.Control4.Value = c.Offset(0, -7)\n      Me.Control5.Value = c.Offset(0, -6)\n      Me.Control6.Value = Format(c.Offset(0, -10), \"dd-mmm-yyyy\")\n      Me.Control7.Value = c.Offset(0, -5)\n      Me.Control8.Value = c.Offset(0, 10)\n      Me.Control9.Value = c.Offset(0, -4)\n      Me.Control10.Value = c.Offset(0, -3)\n      Me.Control11.Value = c.Offset(0, -2)\n      Me.Control12.Value = c\n      Me.Control13.Value = Format(c.Offset(0, -1), \"dd-mmm-yyyy\")    \n      Me.Control14.Value = c.Offset(0, 1)\n      Me.Control15.Value = c.Offset(0, 2)\n      Me.Control16.Value = Format(c.Offset(0, 3), \"dd-mmm-YYYY\")\n      Me.Control17.Value = c.Offset(0, 4)\n      Me.Control18.Value = c.Offset(0, 6)\n      Me.Control19.Value = Format(c.Offset(0, 5), \"dd-mmm-yyyy\")\n      Me.Control20.Value = c.Offset(0, 7)\n      Me.Control21.Value = c.Offset(0, 9)\n      Me.Control22.Value = Format(c.Offset(0, 8), \"dd-mmm-yyyy\")\n\n    Loop While Not c Is Nothing And c.Address &lt;&gt; FirstAddress\n\nEnd If\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Please help</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 4895956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d10d8e0960b99ec5eb12052fbd748b?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/4895956/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1440697774, "creation_date": 1440697774, "answer_id": 32256230, "question_id": 32231332, "link": "https://stackoverflow.com/questions/32231332/how-to-replace-value-in-field-with-value-from-another-field-if-incoming-data-is/32256230#32256230", "title": "How to replace value in field with value from another field if incoming data is null in vb for applications", "body": "<p>I am fairly new to this myself, but having has a similar issue, I think it would go something like this:</p>\n\n<pre><code>If IsNull(Me.ListAmount.Value) = True Then\nMe.ListAmount.Value = Me.Amount.Value\nEnd If\n</code></pre>\n\n<p>Where you put it depends on how ListAmount gets populated. If becomes populated when the form is loaded, then it should go in the On Load of the Form. If it is populated after another field is interacted with, you should put this code in as an AfterUpdate event of that control. </p>\n"}], "owner": {"reputation": 1, "user_id": 4107858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b85fee1223749f4ba6e1f7b684108380?s=128&d=identicon&r=PG&f=1", "display_name": "Keaki", "link": "https://stackoverflow.com/users/4107858/keaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459427933, "creation_date": 1440604621, "last_edit_date": 1459427933, "question_id": 32231332, "link": "https://stackoverflow.com/questions/32231332/how-to-replace-value-in-field-with-value-from-another-field-if-incoming-data-is", "title": "How to replace value in field with value from another field if incoming data is null in vb for applications", "body": "<p>Using: MS Access 2013 (Form)\nPieces:  tbListAmount (coming from a product description table/form)<br>\n         tbAmount (coming from a quote form, value is entered manually)<br>\n         tbDiscount (coming from a quote form, value is entered manually)<br></p>\n\n<p>What I am trying to accomplish is this:</p>\n\n<p><em>(ListAmount field on form)</em><br>\nIf the data coming into [ListAmount] is null, <br>\nThen populate [ListAmount] with value from [Amount]<br>\nEnd If</p>\n\n<p><em>(Amount field on form)</em><br>\n=[Amount]-([Amount]*[Discount]) <em>(to find the amount with discount applied)</em></p>\n\n<p>NB - I am a total newb to programming.  I have scoured both SO and the net for the answer, and couldn't make it go on my own.  So I am hoping the SO experts on here can help!</p>\n"}, {"tags": ["vba", "excel", "excel-2010", "standard-error"], "comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440604285, "post_id": 32231162, "comment_id": 52344892, "body": "It doesn&#39;t work because? Do you get an error, or does it not produce the right value, what happens?"}, {"owner": {"reputation": 53, "user_id": 5269356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205066900688462/picture?type=large", "display_name": "Trevor Caldwell", "link": "https://stackoverflow.com/users/5269356/trevor-caldwell"}, "reply_to_user": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "edited": false, "score": 0, "creation_date": 1440604360, "post_id": 32231162, "comment_id": 52344945, "body": "When I try to use the function on the Excel spreadsheet, it comes up as 0 regardless of what the data set is. Sorry for not clarifying."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1440604415, "post_id": 32231162, "comment_id": 52344977, "body": "Is there any reason that you are not using the worksheet function for standard deviation?"}, {"owner": {"reputation": 53, "user_id": 5269356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205066900688462/picture?type=large", "display_name": "Trevor Caldwell", "link": "https://stackoverflow.com/users/5269356/trevor-caldwell"}, "edited": false, "score": 0, "creation_date": 1440604470, "post_id": 32231162, "comment_id": 52345011, "body": "I&#39;m trying to calculate standard error, which can be done with existing worksheet functions, but can&#39;t be done in just one function."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1440604580, "post_id": 32231162, "comment_id": 52345088, "body": "But the numerator  <i>can</i> be so calculated. Also -- are you sure that you want to use the population size in your standard deviation calculation rather than the pop size - 1?"}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1440604557, "creation_date": 1440604557, "answer_id": 32231310, "question_id": 32231162, "link": "https://stackoverflow.com/questions/32231162/calculating-standard-error-vba/32231310#32231310", "title": "Calculating Standard Error Vba", "body": "<p>The reason you get zero is because of a typo.</p>\n\n<p><code>SrdErr =</code> at the end should be <code>StdErr =</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5269356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205066900688462/picture?type=large", "display_name": "Trevor Caldwell", "link": "https://stackoverflow.com/users/5269356/trevor-caldwell"}, "edited": false, "score": 0, "creation_date": 1440605080, "post_id": 32231442, "comment_id": 52345417, "body": "Thanks! After I fixed the typo the calculation was off, but now it works!"}], "tags": [], "owner": {"reputation": 72931, "user_id": 2538939, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/876f7ddaf27a16c17a62b8a9705b45f1?s=128&d=identicon&r=PG&f=1", "display_name": "Code Different", "link": "https://stackoverflow.com/users/2538939/code-different"}, "is_accepted": true, "score": 3, "last_activity_date": 1440604955, "creation_date": 1440604955, "answer_id": 32231442, "question_id": 32231162, "link": "https://stackoverflow.com/questions/32231162/calculating-standard-error-vba/32231442#32231442", "title": "Calculating Standard Error Vba", "body": "<p>Couple problems with your code: (1) the last statement misspells the function name <code>SrdErr</code> instead of <code>StdErr</code>. This is why you get 0. (2) The function definition itself isn't correct, according to <a href=\"https://support.microsoft.com/en-us/kb/214076\" rel=\"nofollow\">Microsoft documentation</a>.</p>\n\n<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nFunction StdErr(numbers As Range) As Double\n    Dim StdDev As Double\n    Dim Size As Integer\n\n    StdDev = WorksheetFunction.StDev_S(numbers)\n    Size = WorksheetFunction.Count(numbers)\n\n    StdErr = StdDev / Sqr(Size)\nEnd Function\n</code></pre>\n\n<p>It's a good idea to include <code>Option Explicit</code> so you can avoid silly spelling mistakes like this.</p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 2, "last_activity_date": 1440605014, "creation_date": 1440605014, "answer_id": 32231464, "question_id": 32231162, "link": "https://stackoverflow.com/questions/32231162/calculating-standard-error-vba/32231464#32231464", "title": "Calculating Standard Error Vba", "body": "<p>You could do it fairly directly:</p>\n\n<pre><code>Function StdErr(numbers As Range) As Double\n    StdErr = Application.WorksheetFunction.StDev_S(numbers) / (Sqr(numbers.Count))\nEnd Function\n</code></pre>\n\n<p>The formula you had seemed to have both an incorrect denominator and a missing square root in the over-all numerator, at least is you are trying to do <a href=\"https://en.wikipedia.org/wiki/Standard_error\" rel=\"nofollow\">this formula</a></p>\n"}], "owner": {"reputation": 53, "user_id": 5269356, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205066900688462/picture?type=large", "display_name": "Trevor Caldwell", "link": "https://stackoverflow.com/users/5269356/trevor-caldwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1313, "favorite_count": 0, "accepted_answer_id": 32231442, "answer_count": 3, "score": 3, "last_activity_date": 1440605014, "creation_date": 1440604125, "last_edit_date": 1440604403, "question_id": 32231162, "link": "https://stackoverflow.com/questions/32231162/calculating-standard-error-vba", "title": "Calculating Standard Error Vba", "body": "<p>I'm trying to add a standard error function into excel using VBA, what I have so far is just a variation of a standard deviation function. I got the function online and changed it so in the last line it's divided by the square root of the total data points. This doesn't seem to work for me. </p>\n\n<p>Edit: When I try to use the function on the Excel spreadsheet, it comes up as 0 regardless of what the data set is.</p>\n\n<pre><code>Function StdErr(numbers As Range) As Double\n    Dim i As Integer\n    Dim xbar As Double\n    Dim x As Double\n    xbar = WorksheetFunction.Average(numbers)\n    For i = 1 To numbers.Count\n        x = x + (numbers.Item(i).Value - xbar) ^ 2\n    Next i\n    SrdErr = (x / numbers.Count) / (Sqr(numbers.Count))\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "copy-paste"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440603988, "post_id": 32231013, "comment_id": 52344664, "body": "You will not be able to copy entire columns. You will have to go by range or row by row.  Have a test in there for the bottom of the sheet. At that point move to then next sheet. Maybe just loop through sheets and do your pasting in the loop."}, {"owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1440604294, "post_id": 32231013, "comment_id": 52344900, "body": "@MatthewD thanks for the reply. By next sheet I mean page on the same worksheet. Is there any function to detect the end of the page or do you suggest that I just tell it once it has counted a set amount move to next sheet?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440604905, "post_id": 32231013, "comment_id": 52345301, "body": "Activesheet has .VPageBreak and .HPageBreaks that will give you the rows to work with.  I have never used them though. <a href=\"http://stackoverflow.com/questions/28261092/ms-excel-vba-border-around-each-printed-page\" title=\"ms excel vba border around each printed page\">stackoverflow.com/questions/28261092/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1440605757, "last_edit_date": 1440605757, "creation_date": 1440604110, "answer_id": 32231160, "question_id": 32231013, "link": "https://stackoverflow.com/questions/32231013/moving-page-when-pasting-items/32231160#32231160", "title": "Moving page when pasting items", "body": "<p>Loop Horizontal page breaks. Something like this.</p>\n\n<pre><code>For x = 1 To .HPageBreaks.Count - 1\n\n    MsgBox .HPageBreaks(x).Location.Row\n\n    'Write your rows adding your \"sheet\" row value to the pagebreak rows.\n    ws.Range(\"D\" &amp; lRow + .HPageBreaks(x).Location.Row).Value = \"SomeValue\"\n\nNext\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 1329974, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f0e30723bd9f2047995e3a2da94a4f5d?s=128&d=identicon&r=PG", "display_name": "GBSingh", "link": "https://stackoverflow.com/users/1329974/gbsingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 18, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440605757, "creation_date": 1440603697, "question_id": 32231013, "link": "https://stackoverflow.com/questions/32231013/moving-page-when-pasting-items", "title": "Moving page when pasting items", "body": "<p>First of all sorry for not including any code from my attempts as I don't even know where to begin to start trial coding. What Im trying to do is I have a sheet which I have pre formatted to be my report. I then use a macro to copy certain columns from one sheet to the report sheet. I need to report sheet to be singed by somebody in the business and therefore need the bottom few rows for that. My question is how do I get the pasted columns to paste onto the next sheet if they reach a line that I decided is the last line I would like any information on. I apologise for the very vague question so please ask questions if you need any more info.</p>\n"}, {"tags": ["vba", "excel", "templates"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440603951, "post_id": 32230870, "comment_id": 52344629, "body": "You are dimming Omega as <code>Workbook</code> and then setting it as <code>Sheet</code>"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440605705, "post_id": 32230870, "comment_id": 52345789, "body": "changed workbook to worksheet, same error, I think im not referencing the template right. When a name.xltx file opens its name1. How do I reference it? is it just name.xlsx?"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1440607118, "post_id": 32230870, "comment_id": 52346664, "body": "I would advise to do the following: at the top of your code (all the way) put <code>Option Explicit</code> this makes you define every single object/string etc.. I notice you are referencing to things that I don&#39;t see being dimmed. After this see if it still throws the same error"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440619269, "post_id": 32230870, "comment_id": 52353638, "body": "Very helpful, I didn&#39;t realize i had so many mistakes... Fixed them all, updated above. Still throws the same code, same line"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440623500, "post_id": 32230870, "comment_id": 52355800, "body": "OK good :), you can also in Extra -&gt; Options -&gt; Editor check the box declare variables required &lt;- this will put <code>Option Explicit</code> in every module you create from that moment. Besides that: You Set Omega as Workbooks(&quot;FRF Data Graphs1.xls&quot;).Sheets(&quot;Location 1&quot;) &lt; is this workbook even open? As you open FRF Data Graphs.xltx not 1.xls?"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440678026, "post_id": 32230870, "comment_id": 52378759, "body": "Well the template file is named FRF Data Graphs (Alpha), but because its a template file xlfx it opens as FRF Data Graph1. So I&#39;m not sure how to reference it in the code"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440679267, "post_id": 32230870, "comment_id": 52379714, "body": "Ah, i missed that part, so it opens with 1 at the end. but its a <code>.xltx</code> file thus the corresponding file type is <code>.xlsx</code> not <code>.xls</code>"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440680961, "post_id": 32230870, "comment_id": 52380983, "body": "<code>Set Omega = Workbooks(&quot;FRF Data Graphs1.xlsx&quot;).Sheets(&quot;Location 1&quot;)</code> Same error"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440683752, "post_id": 32230870, "comment_id": 52383214, "body": "Could you upload the file for me to look at?"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440684006, "post_id": 32230870, "comment_id": 52383410, "body": "use <a href=\"http://www.wetransfer.com\" rel=\"nofollow noreferrer\">www.wetransfer.com</a> to upload then post the link in your question as an update"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440685650, "post_id": 32230870, "comment_id": 52384661, "body": "yeah so my company blocks that site.."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440742702, "post_id": 32230870, "comment_id": 52408017, "body": "I would suggest to check which site you can upload to and do it from there. There are many uploading sites where you can store your file."}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440768999, "post_id": 32230870, "comment_id": 52423524, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/88203/discussion-between-duraholiday-and-dragonsamu\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441186969, "post_id": 32230870, "comment_id": 52572719, "body": "Let me know if everything is ok now"}, {"owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441213043, "post_id": 32230870, "comment_id": 52590680, "body": "Its not liking a couple of things... I am breaking it apart. With what you gave me its giving me  Error &#39;9&#39; Subscript out of range for the `Set wbMain = Workbooks(&quot;FRF Data Export Graphs.xlsm&quot;)&#39; If I Dim wbMain as Workbooks instead of Workbook it passes that line and errors out at the next line.             <code>wbMain.Sheets(&quot;Sheet1&quot;).Copy</code> Method or data member not found. high lights Sheet"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1441217639, "post_id": 32230870, "comment_id": 52593395, "body": "I will send you the file back then as it works fine inside the file i got from you and adjusted"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": true, "score": 1, "last_activity_date": 1441010100, "last_edit_date": 1441010100, "creation_date": 1441008039, "answer_id": 32306500, "question_id": 32230870, "link": "https://stackoverflow.com/questions/32230870/referencing-a-template-file-in-a-code/32306500#32306500", "title": "Referencing a template file in a code", "body": "<p>The following problems were in your code:</p>\n\n<pre><code>Set Omega = Workbooks(\"FRF Data Graphs1.xls\").Sheets(\"Location 1\")\n</code></pre>\n\n<p>This gives an error as the <code>.xltx</code> file opens a new template and Excel doesn't give a File Type extension until its saved. Also the <code>Sheets(\"Location 1\")</code> reference was not correct, it should have been <code>Sheets(\"Location1 Raw Data\")</code>.  </p>\n\n<p>The solution:</p>\n\n<pre><code>Set Omega = Workbooks(ActiveWorkbook.Name).Sheets(\"Location1 Raw Data\")\n</code></pre>\n\n<p>This resolves the correct naming, and each time a new instance is opened by Excel (and Excel is still open) it will get a new number thus the reference to 1 would become useless.  </p>\n\n<p>The second problem is created by your <code>.SaveAs</code> this saves the workbook but the original workbook is not open anymore and because later on you open the <code>Location 1.xlsx</code> file read only your code stops.</p>\n\n<p>to solve this you <code>.Copy</code>  the <code>Sheet</code> and save it.</p>\n\n<p>Code:</p>\n\n<pre><code>Set wbMain = Workbooks(\"FRF Data Export Graphs.xlsm\")\nwbMain.Sheets(\"Sheet1\").Copy\nActiveWorkbook.SaveAs FileName:=FileCopyPath &amp; \"\\\" &amp; FileProject &amp; Space(1) &amp; FileD &amp; Space(1) &amp; FileTL &amp; Space(1) &amp; FileTimeDate &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook\nActiveWorkbook.SaveAs FileName:=FilePath &amp; \"\\\" &amp; FileTL &amp; \".xlsx\"\nActiveWorkbook.Close False\n</code></pre>\n\n<p>You will also need to define <code>dim wbMain as Workbook</code><br>\nThis <code>.Copy</code>'s the workbook and closes it after saving.  </p>\n\n<p>The final problem (assuming the Template is always empty)is setting your <code>rngDest</code> since its always a new template there is no need to find an empty range.</p>\n\n<pre><code>Set rngDest = Omega.Cells(3, 1).Resize(30000, 3)\n</code></pre>\n\n<p>This will do the trick.</p>\n"}], "owner": {"reputation": 111, "user_id": 5194981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d7f1fa25d44f5b402cd8fde058d84f92?s=128&d=identicon&r=PG&f=1", "display_name": "Duraholiday", "link": "https://stackoverflow.com/users/5194981/duraholiday"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 32306500, "answer_count": 1, "score": 1, "last_activity_date": 1441010100, "creation_date": 1440603224, "last_edit_date": 1440683502, "question_id": 32230870, "link": "https://stackoverflow.com/questions/32230870/referencing-a-template-file-in-a-code", "title": "Referencing a template file in a code", "body": "<p>I'm trying to develope a system of code and files to compare test reports of different parts using graphs. I get a test report back for the tested location on a part, 4 per part, that looks like this. (This is 25603 rows fyi)\n<a href=\"https://i.stack.imgur.com/d0yP6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d0yP6.png\" alt=\"Report\"></a></p>\n\n<p>When the testing software makes the report and this opens I have a Auto_Open macro that does the following: Saves 2 files, one is named based on whats in A1 (Location 1,2,3,4) and is saved in a folder for father data extraction,the other is a back up copy. Its then supposed to open up this template file called \"FRF Data Graphs\" which is a xltx.\n<a href=\"https://i.stack.imgur.com/AHJ2E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AHJ2E.png\" alt=\"Template\"></a></p>\n\n<p>The code is then supposed to copy the many cells and paste in the FRF Data Graphs1. I use select case for each location, to tell the code to copy from here and paste in this sheet, 4 sheets 1 per location, if case \"\". Because i'm comparing parts and this macro runs each time a new report is opened I am using a shift right to the next empty section (part 1,2,3,4). </p>\n\n<p>I'm getting 2 different error codes, first one only occurs when the graph is in the report. \n<a href=\"https://i.stack.imgur.com/670Yl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/670Yl.png\" alt=\"error\"></a> </p>\n\n<p>The second is Subscript out of range \nBoth errors are at the same line of code, under where all the * are.</p>\n\n<pre><code> Set Omega = Workbooks(\"FRF Data Graphs1.xltx\").Sheets(\"Location 1\")\n</code></pre>\n\n<p>So whats wrong with my code...? How do I reference the template file and can I not use data in cells that is used by a complex graph?</p>\n\n<p>Code</p>\n\n<pre><code>  Option Explicit\nSub ExportSave()\n\nDim Alpha           As Workbook 'Template\nDim Omega           As Worksheet 'Template\nDim FileTL          As String   'Test location\nDim FilePath        As String   'File save path\nDim FileProject     As String   'Project information\nDim FileTimeDate    As String   'Export Date and Time\nDim FileD           As String   'Drawing Number\nDim FileCopyPath    As String   'FileCopy save path\nDim FPATH           As String   'File Search Path\nDim Extract         As Workbook 'File Extract Data\nDim locs, loc                   'Location Search\nDim intLast         As Long     'EmptyCell Search\nDim intNext         As Long     'EmptyCell Seach\nDim rngDest         As Range\n\nWith Range(\"H30000\")\n            .Value = Format(Now, \"mmm-dd-yy   hh-mm-ss AM/PM\")\n        End With\n\nFilePath = \"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\"\nFileCopyPath = \"C:\\Users\\aholiday\\Desktop\\Backup\"\nFileTL = Sheets(\"Sheet1\").Range(\"A1\").Text\nFileProject = Sheets(\"Sheet1\").Range(\"G2\").Text\nFileTimeDate = Sheets(\"Sheet1\").Range(\"H30000\").Text\nFileD = Sheets(\"Sheet1\").Range(\"G3\").Text\nFPATH = \"C:\\Users\\aholiday\\Desktop\\FRF_Data_Macro_Insert_Test\\\"\n\nSelect Case Range(\"A1\").Value\n\n    Case \"Single Test Location\"\n\n    Case \"Location 1\"\n\n        Application.DisplayAlerts = False\n\n        ThisWorkbook.SaveAs FileName:=FileCopyPath &amp; \"\\\" &amp; FileProject &amp; Space(1) &amp; FileD &amp; Space(1) &amp; FileTL &amp; Space(1) &amp; FileTimeDate &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook\n        ThisWorkbook.SaveAs FileName:=FilePath &amp; \"\\\" &amp; FileTL &amp; \".xlsx\"\n\n            Set Alpha = Workbooks.Open(\"\\\\plymshare01\\Public\\Holiday\\FRF Projects\\Templates\\FRF Data Graphs.xltx\")\n\n\n\n                    locs = Array(\"Location 1.xlsx\")\n\n                    Set Omega = Workbooks(\"FRF Data Graphs1.xls\").Sheets(\"Location 1\")\n\n                    'set the first data block destination\n                        intLast = Omega.Cells(Columns.Count, \"1\").End(xlRight).Column\n                        intNext = intLast + 5 - (intLast + 5) Mod 5\n                        Set rngDest = Omega.Cells(intNext, \"A\").Resize(30000, 3)\n\n                    For Each loc In locs\n\n                    Set Extract = Workbooks.Open(FileName:=FPATH &amp; loc, ReadOnly:=True)\n\n                    rngDest.Value = Extract.Sheets(\"Sheet1\").Range(\"A3:A30000\", \"D3:D30000\").Value\n\n                    Extract.Close False\n\n                    Set rngDest = rngDest.Offset(0, 3) 'move over to the right 3 cols\n\n                    Next loc\n\n        Application.ScreenUpdating = True\n\n    Case \"Location 2\"\n    Case \"Location 3\"\n    Case \"Location 4\"\n    Case Else\n\n        MsgBox \"Export Failed!\"\n\n    End Select\n\n\n    Application.DisplayAlerts = True\n\n   End Sub\n</code></pre>\n"}, {"tags": ["sql-server", "vba", "excel", "database-connection"], "comments": [{"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1440603690, "post_id": 32230851, "comment_id": 52344437, "body": "Why are you opening <code>dbclass</code> twice? Also, you need to end your connection string with <code>&quot;...=&quot;&quot;Excel 12.0&quot;&quot;;&quot;</code>"}, {"owner": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440604376, "post_id": 32230851, "comment_id": 52344957, "body": "@Bond thanks for the tips. Now I deleted the first connection line <code>dbclass.Open</code>, and I added 2 quotation marks at the end as you showed <code>&quot;. . .=&quot;&quot;Excel 12.0&quot;&quot;;&quot;</code>. However, I still get the same error."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 1, "creation_date": 1440605427, "post_id": 32230851, "comment_id": 52345621, "body": "OK. Can you edit your question and update it with your new code? I&#39;m also not sure why you&#39;re assigning properties to <code>dbclass</code> <i>and</i> using a connection string. You would typically use one or the other. They may be causing conflict with one-another. It looks like maybe you&#39;re trying to create a SQL and an Excel connection? If so, you&#39;ll need two <code>ADODB.Connection</code> objects."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 1, "creation_date": 1440618672, "post_id": 32230851, "comment_id": 52353296, "body": "If you&#39;re writing this in Excel VBA, I don&#39;t think you gain anything by using ADO to get arrData. Just use <code>arrData = ValidSheet.Range(&quot;C22:G81&quot;).Value</code>. That will give you a transposition of what <code>rs.GetRows</code> gives you, but you&#39;re not doing anything with arrData anyway. Which brings up my next point: I was expecting to see an  INSERT INTO sql statement that puts the data into a table, but I don&#39;t see it."}, {"owner": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1440685872, "post_id": 32230851, "comment_id": 52384820, "body": "Thanks Dick and @Bond for the contributions, like I said, i might have done some bbasic mistakes as a newbee.  However, the same error for the connection query remains.  Now I edited my question, I added another coding try with dbclass. It doesn&#39;t give error at all, but It doesn&#39;t copy the table from the Excel to the server. Can you guys have a look please?"}], "answers": [{"tags": [], "owner": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "is_accepted": true, "score": 0, "last_activity_date": 1440690818, "creation_date": 1440690818, "answer_id": 32254178, "question_id": 32230851, "link": "https://stackoverflow.com/questions/32230851/application-defined-or-object-defined-error-in-vba-sql-connection/32254178#32254178", "title": "&quot;Application Defined or Object Defined&quot; error in VBA-SQL connection", "body": "<p>Finally I found the problem for my second code. As I wrote before, in my alternative code (second code), I didn't get any error at all in VBA, but it didn't save my table into the server. </p>\n\n<p>Now I know the reason, because my real value was in \"comma\" format, but the server saved the value in \"dot\" format. So I added <code>Str(value)</code> to convert the \"comma\" value to the \"dot\" value, and it works now:</p>\n\n<pre><code>....\nSQL = \"INSERT INTO Table_test (Column1) VALUES (\" &amp; Str(result(1)) &amp; \")\"\ndbclass.ExecuteSQL SQL\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 669, "user_id": 3714330, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb16b5e55634b7233dff3652e0613013?s=128&d=identicon&r=PG&f=1", "display_name": "user3714330", "link": "https://stackoverflow.com/users/3714330/user3714330"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2639, "favorite_count": 0, "accepted_answer_id": 32254178, "answer_count": 1, "score": 0, "last_activity_date": 1440690818, "creation_date": 1440603186, "last_edit_date": 1440687125, "question_id": 32230851, "link": "https://stackoverflow.com/questions/32230851/application-defined-or-object-defined-error-in-vba-sql-connection", "title": "&quot;Application Defined or Object Defined&quot; error in VBA-SQL connection", "body": "<p>I am trying to write an Exce-Vba code for SQL connection. The code, first will open the connection to the server, then it will copy a 4 columns of table (<code>Range(\"C22:G81\")</code>) from my Excel-sheet to the SQL-server (I am only trying to send numerical table now as a test, I don't send any column name)</p>\n\n<p>I have been trying to solve a \"Application Defined or Object Defined\" error quite long time. I get the error for the connection string <code>strCon = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; strName &amp; \";Extended Properties=\"\"Excel 12.0;\"</code></p>\n\n<p>I even tried with another version with password option like <code>strCon = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; strName &amp; \";Extended Properties=\"\"Excel 12.0; Jet OLEDB:Database Password='passwd';\"</code></p>\n\n<p>But I get the same error. I am quite new in SQL-coding. I wonder if I am missing something important.</p>\n\n<p>Lasly, I don't know if it is related to this error, but I manually created 4 columns in the SQL server for my 4 columns in the Excel. Do I need to write something specific that those 4 columns in the Excel-sheet will find the right columns in the SQL-server?</p>\n\n<p>Thanks in advance...</p>\n\n<p>The code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Private Sub inlasning()\n\n  Dim MyWorkBook As Workbook\n  Dim rs As New ADODB.Recordset\n  Dim conn As New ADODB.Connection\n  Dim ServerName As String, DataBaseName As String, strSQL As String\n\n  Set conn = New ADODB.Connection\n  ServerName = \"E45c7642\"\n  DataBaseName = \"Tables\"\n\n  ' Specify the OLE DB provider\n conn.Provider = \"sqloledb\"\n\n ' Set SQLOLEDB connection properties\n conn.Properties(\"Data Source\").Value = ServerName\n conn.Properties(\"Initial Catalog\").Value = DataBaseName\n\n ' Windows NT authentication.\n conn.Properties(\"Integrated Security\").Value = \"SSPI\"\n conn.Open\n\n\n  Dim ValidSheet As Worksheet\n  Dim HeaderRange As Range\n  Dim DataRange As Range\n  Dim ColRange As Range\n  Dim LastRange As Range\n  Dim strName As String, strCon As String\n\n strName = ThisWorkbook.FullName\n\n\n   Application.ScreenUpdating = False\n\n    Set ValidSheet = ThisWorkbook.Sheets(\"Sheet2\")  ' \n\n    Set HeaderRange = ValidSheet.Range(\"C20:G21\")  \n    Set ColRange = HeaderRange.Find(TheHeader, , , xlWhole)\n    Set LastRange = ColRange.End(xlDown)\n    Set DataRange = ValidSheet.Range(\"C22:G81\")  ' This is what I am trying to transfer, only numeric values without column names\n\n strCon = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; strName _\n    &amp; \";Extended Properties=\"\"Excel 12.0;\"\n\n conn.Open strCon\n\n strSQL = \"SELECT * FROM [\" &amp; ValidSheet.Name &amp; \"$\" &amp; Replace(DataRange, \"$\", \"\") &amp; \"];\"\n rs.Open strSQL, dbclass, adOpenStatic, adLockReadOnly\n\n arrData = rs.GetRows\n\n rs.Close\n conn.Close\n Set rs = Nothing\n Set conn= Nothing\n Set ValidSheet = Nothing\n\n\n End Sub\n</code></pre>\n\n<p>After getting the same error for the \"connection string\", I changed the strategy, and I used dbclass procedure to open a connection. So the new code is like below. (I found this coding from a guy, but he is on vacation now, so I can't ask him).</p>\n\n<p>It gets connection (dbclass) properties automatically, which are saved in the main ThisWorkbook.  This code doesn't give any error at all, but it doesn't copy the column from the Excel to the database. I tried different versions for the sql-query, like <code>SQL = .... VALUES('result')</code> or <code>SQL = .... VALUES(result)</code>, but there is no result again, without error.</p>\n\n<pre><code>Private Sub Testing_Click()\n\n Dim FindColValues() As Double\n Dim ValidBook As Workbook\n Dim ValidSheet As Worksheet\n\n Dim DataRange As Range\n\n Dim dataa  As Range \n\n    Application.ScreenUpdating = False\n\n       TheSheet = \"Sheet2\"\n       Set ValidSheet = Worksheets(TheSheet)\n\n       Set DataRange = ValidSheet.Range(\"C21:C81\")\n\n  ' Below creating an array \"result(it)\" from the seleced range.\n   For Each dataa In DataRange\n       ReDim Preserve result(it)\n       result(it) = dataa.Value\n       it = it + 1\n   Next\n\n ' Below is just an alternative array for \"in case\"  \n   arrData = ValidSheet.Range(\"C22:G81\").Value\n\n  SQL = \"INSERT INTO Table_test (Column1) VALUES ('result()');\"\n\n  dbclass.ExecuteSQL SQL\n\nEnd Sub\n</code></pre>\n\n<p>Below is dbclass connection properties which is read automatically by the other function:</p>\n\n<pre><code> Private Sub Workbook_Open()\n   Dim connOk As Boolean\n   Dim rs As New ADODB.Recordset\n   Dim MyWorkBook As Workbook\n   Dim CurSheet As Worksheet\n\n   Set dbclass = New clsDB\n\n   dbclass.Database = \"Tables\"\n   dbclass.ConnectionType = SqlServer\n   dbclass.DataSource = \"E45c7642\"\n   dbclass.UserId = Application.UserName\n\n   connOk = dbclass.OpenConnection(False, True)\n\n   If connOk = False Then\n   MsgBox \"Cannot connect\"\n\n   Else\n      MsgBox \"The server is connected\"\n\n   End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440603114, "post_id": 32230657, "comment_id": 52344029, "body": "How are your hyperlinks given? Is there a short name for them, or is it just <code>=Hyperlink(&quot;http:&#47;&#47;www.google.com&quot;)</code>? Edit: Ah, sorry - didn&#39;t see your first sentence :P"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1440605306, "last_edit_date": 1440605306, "creation_date": 1440604048, "answer_id": 32231138, "question_id": 32230657, "link": "https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula/32231138#32231138", "title": "Extract URL From Excel Hyperlink Formula", "body": "<p>Hm - playing around with it, I couldn't get <code>.Address</code> to work either.  </p>\n\n<p>You say you want to extract the URL only, I was able to do that with this macro:</p>\n\n<pre><code>Function hyperlinkText(pRange As Range) As String\nDim st1 As String, st2 As String\nDim tempSub1 As String, tempSub2 As String\n\nIf Left(pRange.Formula, 10) &lt;&gt; \"=HYPERLINK\" Then\n    hyperlinkText = \"not found\"\n    Exit Function\nElse\n    tempSub1 = WorksheetFunction.Substitute(pRange.Formula, \"\"\"\", \"[\", 1)\n    tempSub2 = WorksheetFunction.Substitute(tempSub1, \"\"\"\", \"]\", 1)\n    hyperlinkText = Mid(tempSub2, WorksheetFunction.Find(\"[\", tempSub2) + 1, WorksheetFunction.Find(\"]\", tempSub2) - WorksheetFunction.Find(\"[\", tempSub2) - 1)\nEnd If\n\nEnd Function\n</code></pre>\n\n<p>Note though, it doesn't get the \"Friendly Name\" of the <code>Hyperlink()</code> formula, just the URL.  </p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1440605133, "post_id": 32231431, "comment_id": 52345447, "body": "I need to learn more about Regex - it&#39;s a little intimidating, but man, can you make some nice, short, and to the point macros. (as opposed to mine, where I just substituted some quotes, and used <code>Mid</code>.)"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1440605258, "post_id": 32231431, "comment_id": 52345522, "body": "@BruceWayne - It&#39;s good to have options. Your answer may be more comfortable for many. BTW, check out <a href=\"https://msdn.microsoft.com/en-us/library/ms974570.aspx\" rel=\"nofollow noreferrer\">this page</a> for a good VBScript regex reference."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1440604925, "creation_date": 1440604925, "answer_id": 32231431, "question_id": 32230657, "link": "https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula/32231431#32231431", "title": "Extract URL From Excel Hyperlink Formula", "body": "<p>You could extract it with a regex:</p>\n\n<pre><code>Dim re\nSet re = CreateObject(\"VBScript.RegExp\")\nre.Pattern = \"^=HYPERLINK\\(\"\"([^\"\"]+)\"\"\"\n\nIf re.Test(pRange.Formula) Then\n    Debug.Print \"URL = \" &amp; re.Execute(pRange.Formula)(0).SubMatches(0)\nElse\n    Debug.Print \"URL not found\"\nEnd If\n</code></pre>\n\n<p>This just checks to see if the formula begins with:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>=HYPERLINK(\"\n</code></pre>\n\n<p>and, if so, grabs the text from that point until the following <code>\"</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 3, "last_activity_date": 1440610440, "creation_date": 1440610440, "answer_id": 32233083, "question_id": 32230657, "link": "https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula/32233083#32233083", "title": "Extract URL From Excel Hyperlink Formula", "body": "<p>Here is a method that will return the hyperlink text whether it has been created by a formula, or by the Insert/Hyperlink method.</p>\n\n<p>If the former, we merely have to parse the formula; if the latter, we need to iterate through the hyperlinks collection on the worksheet.</p>\n\n<p>The formula will return nothing if there is no hyperlink in cell_ref; change to suit.</p>\n\n<hr>\n\n<pre><code>Option Explicit\nFunction HyperLinkText(rg As Range)\n    Dim sFormula As String, S As String\n    Dim L As Long\n    Dim H As Hyperlink, HS As Hyperlinks\n\nsFormula = rg.Formula\nL = InStr(1, sFormula, \"HYPERLINK(\"\"\", vbBinaryCompare)\n\nIf L &gt; 0 Then\n    S = Mid(sFormula, L + 11)\n    S = Left(S, InStr(S, \"\"\"\") - 1)\nElse\n    Set HS = rg.Worksheet.Hyperlinks\n    For Each H In HS\n        If H.Range = rg Then\n            S = H.Address\n        End If\n    Next H\nEnd If\n\nHyperLinkText = S\n\nEnd Function\n</code></pre>\n\n<hr>\n"}, {"comments": [{"owner": {"reputation": 7706, "user_id": 4058484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/uQgA5.png?s=128&g=1", "display_name": "Chetabahana", "link": "https://stackoverflow.com/users/4058484/chetabahana"}, "edited": false, "score": 0, "creation_date": 1448111946, "post_id": 32234695, "comment_id": 55452044, "body": "I just try in my google spreadsheet but give <b>#VALUE!</b> Error Message: <i>In FIND evaluation cannot find <code>&quot;&quot;</code> within xxx.com.</i> What have I been missing?"}], "tags": [], "owner": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1448114712, "last_edit_date": 1448114712, "creation_date": 1440615823, "answer_id": 32234695, "question_id": 32230657, "link": "https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula/32234695#32234695", "title": "Extract URL From Excel Hyperlink Formula", "body": "<p>Non-VBA possibility:  </p>\n\n<p>Work on copies of the cells with links because the first step is to replace part of their content (specifically <code>=</code> with I suggest the not sign <code>\u00ac</code>). Then, assuming the copy is in A1:  </p>\n\n<pre><code>=SUBSTITUTE(LEFT(MID(A1,13,LEN(A1)),FIND(\"\"\"\",MID(A1,13,LEN(A1)))-1),\"\u00ac\",\"=\")  \n</code></pre>\n\n<p>and replace <code>\u00ac</code> with <code>=</code> where the link contains an equals sign.</p>\n"}, {"tags": [], "owner": {"reputation": 2978, "user_id": 956730, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/32bef284689d6c0cc38a977deef7ce5c?s=128&d=identicon&r=PG", "display_name": "Ash", "link": "https://stackoverflow.com/users/956730/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1509670726, "creation_date": 1509670726, "answer_id": 47086877, "question_id": 32230657, "link": "https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula/47086877#47086877", "title": "Extract URL From Excel Hyperlink Formula", "body": "<p>I ended up using Python:</p>\n\n<ol>\n<li>Download (or convert) the spreadsheet into xlsx format.</li>\n<li>Install <strong>openpyxl</strong> using pip or conda.</li>\n<li><p>Read the xlsx with a code similar to:</p>\n\n<pre><code>from openpyxl import load_workbook\nwb = load_workbook(filename = 'cities.xlsx')\nprint(wb.worksheets)\nprint(dir(wb))\nsheet_ranges = wb['Sheet1']\nfor c in sheet_ranges['B']:\n    print(c.hyperlink.target)\n</code></pre></li>\n</ol>\n\n<p>Note that the name 'Sheet1' or column names might be different case by case ('B' is the column with hyperlink in my case).</p>\n\n<ol start=\"4\">\n<li>After the links are printed copy them and paste them into a new column in your sheet.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 2535661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1cd8e5675c7a1069544dfba1ed485ff?s=128&d=identicon&r=PG", "display_name": "Shahid Saddique", "link": "https://stackoverflow.com/users/2535661/shahid-saddique"}, "is_accepted": false, "score": 0, "last_activity_date": 1611823682, "last_edit_date": 1611823682, "creation_date": 1512092717, "answer_id": 47585446, "question_id": 32230657, "link": "https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula/47585446#47585446", "title": "Extract URL From Excel Hyperlink Formula", "body": "<p>Here is an Excel formula that can extract URL from a hyperlink used into cell.</p>\n<p>A1= Excel Cell where you want to extract URL.</p>\n<pre><code>=MID(FORMULATEXT(A1),FIND(CHAR(34),FORMULATEXT(A1))+1,FIND(CHAR(34),FORMULATEXT(A1),FIND(CHAR(34),FORMULATEXT(A1))+1)-1-FIND(CHAR(34),FORMULATEXT(A1)))\n</code></pre>\n<p>Image for reference.</p>\n<p><a href=\"https://i.stack.imgur.com/kkIMc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kkIMc.png\" alt=\"Excel Formula to get URL from excel hyperlink\" /></a></p>\n"}], "owner": {"reputation": 53, "user_id": 5269184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea3be0d151682b270781749b7b1d2cde?s=128&d=identicon&r=PG", "display_name": "ekh64", "link": "https://stackoverflow.com/users/5269184/ekh64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12599, "favorite_count": 3, "accepted_answer_id": 32233083, "answer_count": 6, "score": 5, "last_activity_date": 1614933902, "creation_date": 1440602666, "last_edit_date": 1440603323, "question_id": 32230657, "link": "https://stackoverflow.com/questions/32230657/extract-url-from-excel-hyperlink-formula", "title": "Extract URL From Excel Hyperlink Formula", "body": "<p>I have an Excel file with hundreds of cells that use the Hyperlink formula <code>=HYPERLINK( &lt;targetURL&gt;, &lt;friendlyName&gt; )</code>. I need to extract the plain text URLs from these. Most examples that I've found rely on the cell using a different hyperlinking method.</p>\n\n<p>So a function like this:</p>\n\n<pre><code>Function HyperLinkText(pRange As Range) As String\n\n   Dim ST1 As String\n   Dim ST2 As String\n\n   If pRange.Hyperlinks.Count = 0 Then\n      HyperLinkText = \"not found\"\n      Exit Function\n   End If\n\n   ST1 = pRange.Hyperlinks(1).Address\n   ST2 = pRange.Hyperlinks(1).SubAddress\n\n   If ST2 &lt;&gt; \"\" Then\n      ST1 = \"[\" &amp; ST1 &amp; \"]\" &amp; ST2\n   End If\n\n   HyperLinkText = ST1\n\nEnd Function\n</code></pre>\n\n<p>results in cell text \"not found\". Alternatively, is there a way of converting these cells to the other hyperlink format so that the macro I have works?</p>\n"}, {"tags": ["vba", "excel", "collections"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1440601242, "post_id": 32230084, "comment_id": 52342685, "body": "would &#39;variant&#39; work it would allow numbers and strings."}, {"owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1440601565, "post_id": 32230084, "comment_id": 52342913, "body": "@ScottCraner I assume Variant is the right type for the sub but I don&#39;t know what to set <code>??</code> equal to in the sub MAIN() or if my notation will work with <code>v.X</code> in GetSplit because X would just be a variable, not a reference to the property"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1440608244, "creation_date": 1440608244, "answer_id": 32232419, "question_id": 32230084, "link": "https://stackoverflow.com/questions/32230084/passing-a-class-property-name-to-a-sub-to-search-a-collection/32232419#32232419", "title": "Passing a class property name to a sub to search a collection", "body": "<p>Here's a working example...</p>\n\n<p>clsTest:</p>\n\n<pre><code>Public Prop1\nPublic Prop2\nPublic Prop3\n</code></pre>\n\n<p>regular module:</p>\n\n<pre><code>Sub Tester()\n    Dim o, i\n    Dim col As New Collection\n    Dim colF As Collection\n\n    'populate some sample data...\n    For i = 1 To 10\n        Set o = New clsTest\n        o.Prop1 = i\n        o.Prop2 = i * 5\n        o.Prop3 = \"Test\"\n        col.Add o\n    Next i\n\n    Set colF = PropFilter(col, \"Prop1\", 2)\n    Debug.Print colF.Count '&gt;&gt; 1\n\n    Set colF = PropFilter(col, \"Prop3\", \"Test\")\n    Debug.Print colF.Count '&gt;&gt; 10\n\nEnd Sub\n\n\nFunction PropFilter(col As Collection, propName As String, propValue)\n    Dim o\n    Dim rv As New Collection\n    For Each o In col\n        If CallByName(o, propName, VbGet) = propValue Then\n            rv.Add o\n        End If\n    Next o\n    Set PropFilter = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 5172655, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ed146f261d8d135a743cd16b617dfd5e?s=128&d=identicon&r=PG&f=1", "display_name": "JChristen", "link": "https://stackoverflow.com/users/5172655/jchristen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 32232419, "answer_count": 1, "score": 0, "last_activity_date": 1440608244, "creation_date": 1440601106, "last_edit_date": 1531164843, "question_id": 32230084, "link": "https://stackoverflow.com/questions/32230084/passing-a-class-property-name-to-a-sub-to-search-a-collection", "title": "Passing a class property name to a sub to search a collection", "body": "<p>I have a collection of objects of the same class with a bunch of properties. I want to create a smaller collection that only contains the objects with a certain value for a specific property, and I want to be able to call the sub multiple times for different properties without making lots of versions of the sub. </p>\n\n<p>Here is the section of code which is relevant to the problem:</p>\n\n<pre><code>Sub MAIN()\n\n    Dim SplitArr(1 to 2) As Variant\n    SplitArr(1) = Y 'where Y is the value you are looking for\n    GetSplit arr:=SplitArr, X:=?? 'where ?? is the property you are looking at\"\n\nEnd Sub\n\nSub GetSplit(ByRef arr(), X as ??) 'unsure what type X should be\n    Dim collSplit As Collection\n    Set collSplit = New Collection\n    For Each v In coll\n        If v.X = arr(1) Then\n            collSplit.Add v\n        End If\n    Next v\n    Set arr(2) = collSplit\nEnd Sub\n</code></pre>\n\n<p>So what should happen is GetSplit searches through the main collection, coll, and if any of the objects there have the X property equal to Y it will add the object to the collection collSplit. At the end arr(2) is set to collSplit.</p>\n\n<p>The bit I'm not sure how to do is passing a property name to the sub, so any help would be greatly appreciated.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["sql", "vba", "excel", "db2"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 1, "creation_date": 1440600866, "post_id": 32229930, "comment_id": 52342406, "body": "you haven&#39;t set <code>objAbConn</code> and <code>objAbRecordset</code> with the <code>Dim</code> keyword"}, {"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 0, "creation_date": 1440600876, "post_id": 32229930, "comment_id": 52342412, "body": "Minimize the problem, i.e. remove one piece, try to execute, does it work? If not you&#39;ve find the problem part, otherwise remove something else etc."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1440600963, "post_id": 32229930, "comment_id": 52342477, "body": "In addition check the VBA library references, maybe someone is missing."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1440601030, "post_id": 32229930, "comment_id": 52342524, "body": "as to what psychicebola said look here: <a href=\"https://support.microsoft.com/en-us/kb/257819\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/kb/257819</a>"}, {"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 0, "creation_date": 1440601041, "post_id": 32229930, "comment_id": 52342536, "body": "Once you fix the problems above, you&#39;ll get the syntax error for the query -- make sure you put spaces where they are required."}], "answers": [{"tags": [], "owner": {"reputation": 788, "user_id": 2956665, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/M46L9.png?s=128&g=1", "display_name": "Dportology", "link": "https://stackoverflow.com/users/2956665/dportology"}, "is_accepted": false, "score": 1, "last_activity_date": 1440601345, "creation_date": 1440601345, "answer_id": 32230172, "question_id": 32229930, "link": "https://stackoverflow.com/questions/32229930/user-defined-type-not-defined-error-with-no-help-from-debugger/32230172#32230172", "title": "&quot;user defined type not defined&quot; error with no help from debugger", "body": "<p>I pasted your code into the vba editor and the line being highlighted is:</p>\n\n<pre><code>Set objAbConn = New ADODB.Connection\n</code></pre>\n\n<p>This needs to be declared differently:</p>\n\n<pre><code>Dim objAbConn As New ADODB.Connection\nDim objAbRecordset As New ADODB.Recordset\n</code></pre>\n\n<p>Remember to close the connection and recordset when done:</p>\n\n<pre><code>objAbRecordset.Close\nobjAbConn.Close\n</code></pre>\n\n<p>Also, I included the reference to \"Microsoft ActiveX Data Objects 2.8 Library\"</p>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 395, "user_id": 3169049, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9be7e02d44421c30df4611e53fc88574?s=128&d=identicon&r=PG", "display_name": "Moogle", "link": "https://stackoverflow.com/users/3169049/moogle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440601345, "creation_date": 1440600712, "last_edit_date": 1531164843, "question_id": 32229930, "link": "https://stackoverflow.com/questions/32229930/user-defined-type-not-defined-error-with-no-help-from-debugger", "title": "&quot;user defined type not defined&quot; error with no help from debugger", "body": "<p>I'm trying to create a macro to pull some data from a database. However when trying to run the following code I get a \"Compile error: User-defined type not defined\" error message. The debugger just highlights the Sub line so I have no idea where the offender is.</p>\n\n<pre><code>Sub PCA_test()\n'\n' PCA_test Macro\n'\n\n'\n'Declare variables'\nSet objAbConn = New ADODB.Connection\nSet objAbRecordset = New ADODB.Recordset\nDim strSQLProductSales As String\n\n'Open Connection'\nobjAbConn.ConnectionString = \"DSN=AWPROD;UID=abc;PWD=123;MODE=SHARE;DBALIAS=AWPROD;TXNISOLATION=1;\"\nobjAbConn.Open\n\n'Set and Excecute SQL Command'\nstrSQLProductSales = \"SELECT CELL_CODE, CONTROL_TREATMENT_FLAG, COUNT(DISTINCT A.ACCOUNT_NUMBER)AS CUSTS_MAILED,\" &amp; _\n\"COUNT(DISTINCT C.ACCOUNT_NUMBER)AS CUSTS_REDEEMED,\" &amp; _\n\"SUM(TXNS) AS TXNS, SUM(SALES) AS SALES, SUM(UNITS) AS UNITS, SUM(ONLINE_SALES) AS ONLINE_SALES\" &amp; _\n\"FROM    (SELECT ACCOUNT_NUMBER, CAMPAIGN_CODE, CELL_CODE, CONTROL_TREATMENT_FLAG\" &amp; _\n\"FROM CONTACT\" &amp; _\n\"WHERE CAMPAIGN_CODE = 'C000006816') A\" &amp; _\n\"LEFT JOIN\" &amp; _\n\"(SELECT ACCOUNT_NUMBER, COUNT(DISTINCT EPOS_TRANSACTION_KEY) AS TXNS,\" &amp; _\n\"SUM(SALES_AT_TISP) AS SALES, SUM(SALES_UNITS) AS UNITS,\" &amp; _\n\"SUM(CASE WHEN STORE_NUMBER = 4910 THEN SALES_AT_TISP ELSE 0 END) AS ONLINE_SALES\" &amp; _\n\"FROM TRANSACTIONS AA\" &amp; _\n\"INNER JOIN ITEMS BB\" &amp; _\n\"ON AA.ITEM_CODE = BB.ITEM_CODE\" &amp; _\n\"WHERE TILL_TRANSACTION_DATE BETWEEN '2015-06-22' AND '2015-07-20'\" &amp; _\n\"AND AA.ITEM_CODE IN (0000, 1111, 2222)\" &amp; _\n\"GROUP BY ACCOUNT_NUMBER) C\" &amp; _\n\"ON C.ACCOUNT_NUMBER =A.ACCOUNT_NUMBER\" &amp; _\n\"GROUP BY CELL_CODE, CONTROL_TREATMENT_FLAG\" &amp; _\n\"ORDER BY CELL_CODE;\"\n\n'Open Recordset'\nSet objAbRecordset.ActiveConnection = objAbConn\nobjAbRecordset.Open strSQLProductSales\n\n'Copy Data to Excel'\nSheet(\"ProductSales\").Range(\"A1\").CopyFromRecordset (objAbRecordset)\n\n\nEnd Sub\n</code></pre>\n\n<p>I believe I have the right references ticked. That's the only thing I can think of.</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440600849, "post_id": 32229822, "comment_id": 52342395, "body": "There will be a _change event on the combo box. Or you can monitor the keypress event for an enter."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440602181, "post_id": 32229822, "comment_id": 52343359, "body": "Can you explain why the ComboBox has 2 columns?"}, {"owner": {"reputation": 117, "user_id": 2218856, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26bb7d5824cfec32ab91e9caef08c859?s=128&d=identicon&r=PG", "display_name": "user2218856", "link": "https://stackoverflow.com/users/2218856/user2218856"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440609736, "post_id": 32229822, "comment_id": 52348138, "body": "@MatthewD I can use the_change or _keypress event, but I dont know how to get the actual value of what the user has inputted. The combobox.value just returns the latest selected item from the list. @ Dragon Samu its just for practical purposes that I have 2 coloumns. The 1st column holds a text and the 2nd column holds a DB id (hidden from the user). However, that should not change my problem of getting the value of the user input."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 2, "creation_date": 1440609980, "post_id": 32229822, "comment_id": 52348281, "body": "Look at the ComboBox2.Text vs the ComboBox2.Value  There is a difference. Not sure if it will return what you are looking for but take a look. <a href=\"http://stackoverflow.com/questions/2844193/distinction-between-using-text-and-value-in-vba-access\" title=\"distinction between using text and value in vba access\">stackoverflow.com/questions/2844193/&hellip;</a>"}, {"owner": {"reputation": 117, "user_id": 2218856, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26bb7d5824cfec32ab91e9caef08c859?s=128&d=identicon&r=PG", "display_name": "user2218856", "link": "https://stackoverflow.com/users/2218856/user2218856"}, "edited": false, "score": 0, "creation_date": 1440610738, "post_id": 32229822, "comment_id": 52348760, "body": "I just tested both .value and .text at a different computer, and both worked perfectly. Could that have something to do with the versions of excel? Anyway, thanks a lot for the feedback. It was driving me crazy :)"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1440667300, "post_id": 32229822, "comment_id": 52371538, "body": "@user2218856 the 2nd column is bound and linked to a cell by settings or by code?"}, {"owner": {"reputation": 117, "user_id": 2218856, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26bb7d5824cfec32ab91e9caef08c859?s=128&d=identicon&r=PG", "display_name": "user2218856", "link": "https://stackoverflow.com/users/2218856/user2218856"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441095081, "post_id": 32229822, "comment_id": 52527661, "body": "@MatthewD The .text solution is perfect. It gets me the user input. Thank you so much!"}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1441113690, "last_edit_date": 1495535363, "creation_date": 1440610514, "answer_id": 32233114, "question_id": 32229822, "link": "https://stackoverflow.com/questions/32229822/get-user-input-value-of-excel-combobox-vba/32233114#32233114", "title": "Get user input value of Excel ComboBox VBA", "body": "<p>Strange that the text or value. You will have to access them after update. But you could watch what is being entered and keep track of it that way.</p>\n\n<p>Declare a global variable to hold what is entered.</p>\n\n<pre><code>Private strComboEntry As String\n</code></pre>\n\n<p>Then watch what is being keyed in. </p>\n\n<pre><code>Private Sub ComboBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\n    Dim strKey As String\n    strKey = Chr(KeyAscii)\n    strComboEntry = strComboEntry &amp; strKey\nEnd Sub\n</code></pre>\n\n<p>We will have to handle the backspace and delete too.</p>\n\n<pre><code>Private Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n\n    If KeyCode = 8 Then\n        strComboEntry = Left(strComboEntry, Len(strComboEntry) - 1)\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: OP says this comment got him the answer.<br>\nLook at the ComboBox2.Text vs the ComboBox2.Value There is a difference. Not sure if it will return what you are looking for but take a look.\n<a href=\"https://stackoverflow.com/questions/2844193/distinction-between-using-text-and-value-in-vba-access\">Distinction between using .text and .value in VBA Access</a></p>\n"}], "owner": {"reputation": 117, "user_id": 2218856, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/26bb7d5824cfec32ab91e9caef08c859?s=128&d=identicon&r=PG", "display_name": "user2218856", "link": "https://stackoverflow.com/users/2218856/user2218856"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1572, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1484863036, "creation_date": 1440600432, "last_edit_date": 1484863036, "question_id": 32229822, "link": "https://stackoverflow.com/questions/32229822/get-user-input-value-of-excel-combobox-vba", "title": "Get user input value of Excel ComboBox VBA", "body": "<p>I have a combobox in Excel which is populated with values from a DB. \nThere are 2 columns with the 2nd column bound and linked to a cell. </p>\n\n<p>I want users to be able to input their own value. </p>\n\n<p>If a user selects an item from the list, everything works great. I get the value in the linked cell. </p>\n\n<p>However, if the user inputs their own data i get a #N/A value in the linked cell. </p>\n\n<p>Is there any way where I can retrieve the value inputted by the user?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1440600534, "post_id": 32229807, "comment_id": 52342144, "body": "why don&#39;t you use a loop to compare your worksheets?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1440600630, "post_id": 32229807, "comment_id": 52342225, "body": "Why not save the names into an array and pass that into your sub instead of a list.  Then iterate through each item in your array."}, {"owner": {"reputation": 25, "user_id": 5269048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40eaa59b46a65a381fdb5bf6539a4475?s=128&d=identicon&r=PG", "display_name": "Santi", "link": "https://stackoverflow.com/users/5269048/santi"}, "edited": false, "score": 0, "creation_date": 1440657469, "post_id": 32229807, "comment_id": 52365827, "body": "Your solution my work Scott, I&#39;ll have a look on how to use Arrays on vba"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5269048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40eaa59b46a65a381fdb5bf6539a4475?s=128&d=identicon&r=PG", "display_name": "Santi", "link": "https://stackoverflow.com/users/5269048/santi"}, "edited": false, "score": 0, "creation_date": 1440657360, "post_id": 32230142, "comment_id": 52365774, "body": "I think your solution won&#39;t work for me as I need two loops, one from 1 to 4 and another from 2 to 5."}, {"owner": {"reputation": 25, "user_id": 5269048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40eaa59b46a65a381fdb5bf6539a4475?s=128&d=identicon&r=PG", "display_name": "Santi", "link": "https://stackoverflow.com/users/5269048/santi"}, "edited": false, "score": 0, "creation_date": 1440662337, "post_id": 32230142, "comment_id": 52368493, "body": "Thank you very much, using this plus a few tweaks I managed to make it work. Finally, I used an Array and did the loop with index"}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1440657662, "last_edit_date": 1440657662, "creation_date": 1440601260, "answer_id": 32230142, "question_id": 32229807, "link": "https://stackoverflow.com/questions/32229807/concatenation-of-stringvariable-in-excel-macro/32230142#32230142", "title": "Concatenation of string+variable in Excel macro", "body": "<p>Use a ParamArray to pass the sheet names to your sub, and loop over them.</p>\n\n<pre><code>Sub compareSheets(ParamArray sheets() As Variant)\n\n    Dim vSheet As Variant \n    For Each vSheet In sheets\n        cnt = Worksheets(vSheet).Cells.SpecialCells(xlCellTypeLastCell).Row\n        ' ...\n    Next vSheet\n</code></pre>\n\n<p>Of course you can also work with indices:</p>\n\n<pre><code>    For i = 0 to 3\n        cnt1 = Worksheets(sheets(i)).Cells.SpecialCells(xlCellTypeLastCell).Row\n        ' ...\n    Next i\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5269048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40eaa59b46a65a381fdb5bf6539a4475?s=128&d=identicon&r=PG", "display_name": "Santi", "link": "https://stackoverflow.com/users/5269048/santi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 32230142, "answer_count": 1, "score": 0, "last_activity_date": 1440657662, "creation_date": 1440600397, "last_edit_date": 1440636319, "question_id": 32229807, "link": "https://stackoverflow.com/questions/32229807/concatenation-of-stringvariable-in-excel-macro", "title": "Concatenation of string+variable in Excel macro", "body": "<p>In the part of cnt1, I'm trying to use an integer (called A) that I'll increase in a loop so it goes from shtSheet1 to shtSheet5. In my code, I have shtSheet$A to clarify what I want to do but I don't know if visual basic allow that kind of concatenation. I'm only used to coding bash Scripts.</p>\n\n<pre><code>Sub RunCompare()\n\nCall compareSheets(\"PROD\", \"OSA\", \"UAT\", \"INT\", \"TEST\")\n\nEnd Sub\n\nSub compareSheets(shtSheet1 As String, shtSheet2 As String, shtSheet3 As String, shtSheet4 As String, shtSheet5 As String)\n\nDim c As Integer, j As Integer, i As Integer, mydiffs As Integer, cnt1 As Integer, cnt2 As Integer, A As Integer, B As Integer\nDim noexist As Integer\n\nA = 1\nB = 2\n\ncnt1 = Worksheets(shtSheet).Cells.SpecialCells(xlCellTypeLastCell).Row\ncnt2 = Worksheets(shtSheetB).Cells.SpecialCells(xlCellTypeLastCell).Row\n\n'For each cell in sheet2 that is not the same in Sheet1, color it yellow\n\nLoopStart:\n\nFor i = 1 To cnt2\n    For j = 1 To cnt1\n        If ActiveWorkbook.Worksheets(shtSheet2).Cells(i, 1).Value = ActiveWorkbook.Worksheets(shtSheet1).Cells(j, 1).Value Then\n            For c = 2 To 22\n                If Not ActiveWorkbook.Worksheets(shtSheetB).Cells(i, c).Value = ActiveWorkbook.Worksheets(shtSheet2).Cells(j, c).Value Then\n                    ActiveWorkbook.Worksheets(shtSheet2).Cells(i, c).Interior.Color = vbYellow\n                    mydiffs = mydiffs + 1\n                End If\n            Next\n        Exit For\n        End If\n        If j = cnt1 Then\n            ActiveWorkbook.Worksheets(shtSheet2).Cells(i, 1).Interior.Color = vbRed\n        End If\n    Next\nNext\n\nA = A + 1\nB = B + 1\n\nIf A &lt;= 4 Then\n    GoTo LoopStart\nEnd If \n\nEnd Sub\n\n\nSub Clear_Highlights_this_Sheet()\nActiveSheet.UsedRange. _\nInterior.ColorIndex = xlNone\nEnd Sub\n\nSub Clear_Highlights_All_Sheets()\nDim sht As Worksheet\nFor Each sht In sheets\nsht.UsedRange.Interior.ColorIndex = xlNone\nNext\nEnd Sub\n</code></pre>\n\n<p>I updated my full macro so it is easier to understand. It compares 2 sheets and I would like to modify it to compare 5 sheets but in a specific way, only comparing the sheets 1-2, 2-3, 3-4, 4-5.</p>\n\n<p>My idea was to use the A and B and a goto to do what I want.</p>\n"}, {"tags": ["php", "vba"], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 2524743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZFiSd.jpg?s=128&g=1", "display_name": "Joel Lewis", "link": "https://stackoverflow.com/users/2524743/joel-lewis"}, "edited": false, "score": 0, "creation_date": 1440615041, "post_id": 32230125, "comment_id": 52351278, "body": "Thank you! this was exactly the problem."}], "tags": [], "owner": {"reputation": 8169, "user_id": 2602732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFcDy.png?s=128&g=1", "display_name": "cmorrissey", "link": "https://stackoverflow.com/users/2602732/cmorrissey"}, "is_accepted": true, "score": 1, "last_activity_date": 1440601220, "creation_date": 1440601220, "answer_id": 32230125, "question_id": 32229396, "link": "https://stackoverflow.com/questions/32229396/translating-erlangb-formula-from-vba-to-php/32230125#32230125", "title": "Translating ErlangB formula from VBA to PHP", "body": "<p>Change this </p>\n\n<p><code>while($count &lt; $maxiterate){</code></p>\n\n<p>to</p>\n\n<p><code>while($count &lt;= $maxiterate){</code></p>\n"}], "owner": {"reputation": 474, "user_id": 2524743, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZFiSd.jpg?s=128&g=1", "display_name": "Joel Lewis", "link": "https://stackoverflow.com/users/2524743/joel-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 32230125, "answer_count": 1, "score": 3, "last_activity_date": 1440601220, "creation_date": 1440599248, "question_id": 32229396, "link": "https://stackoverflow.com/questions/32229396/translating-erlangb-formula-from-vba-to-php", "title": "Translating ErlangB formula from VBA to PHP", "body": "<p>I have the following in VBA that works flawlessly:</p>\n\n<pre><code>Private Function MinMax(Val As Single, Min As Single, Max As Single) As Single\n'Apply minimum and maximum bounds to a value\n    MinMax = Val\n    If Val &lt; Min Then MinMax = Min\n    If Val &gt; Max Then MinMax = Max\nEnd Function\n\n'-----------------------------------------------------------------------\nPublic Function ErlangB(Servers As Single, Intensity As Single) As Single\n'The Erlang B formula calculates the percentage likelyhood of the call\n' being blocked, that is that all the trunks are in use and the caller\n' will receive a busy signal.\n' Servers = Number of telephone lines\n' Intensity = Arrival rate of calls / Completion rate of calls\n'   Arrival rate = the number of calls arriving per hour\n'   Completion rate = the number of calls completed per hour\nDim Val As Single, Last As Single, B As Single\nDim Count As Long, MaxIterate As Long\nOn Error GoTo ErlangBError\n     If (Servers &lt; 0) Or (Intensity &lt; 0) Then\n          ErlangB = 0\n          Exit Function\n     End If\n     MaxIterate = Fix(Servers)\n     Val = Intensity\n     Last = 1 ' for server = 0\n     For Count = 1 To MaxIterate\n          B = (Val * Last) / (Count + (Val * Last))\n          Last = B\n     Next Count\nErlangBExit:\n     ErlangB = MinMax(B, 0, 1)\n     Exit Function\n\nErlangBError:\n     B = 0\n     Resume ErlangBExit\nEnd Function\n</code></pre>\n\n<p>I am attempting to recreate it in PHP with the following code:</p>\n\n<pre><code>function minmax($val, $min, $max)\n{\n    //Apply minimum and maximum bounds to a value\n    $minmax = $val;\n    if($val &lt; $min){ $minmax = $min;}\n    if($val &gt; $max) { $minmax = $max;}\n\n    Return $minmax;\n}\n\nfunction erlangb($servers, $intensity)\n{\n    //'The Erlang B formula calculates the percentage likelyhood of the call\n    //' being blocked, that is that all the trunks are in use and the caller\n    //' will receive a busy signal.\n    //' Servers = Number of telephone lines\n    //' Intensity = Arrival rate of calls / Completion rate of calls\n    //'   Arrival rate = the number of calls arriving per hour\n    //'   Completion rate = the number of calls completed per hour\n    if($servers &lt; 0 || $intensity &lt; 0) {\n        $erlangb = 0;\n        }\n    Else{\n        $maxiterate = floor($servers);\n        $val = $intensity;\n        $last = 1;\n        $count = 1;\n        while($count &lt; $maxiterate){\n            $b = ($val * $last) / ($count + ($val * $last));\n            $last = $b;\n            $count ++;\n        }\n    }\n    return minmax($b, 0, 1);\n}\n</code></pre>\n\n<p>However I am not always getting the same results.  For example a request like this:</p>\n\n<p>erlangb(10, 5) </p>\n\n<p>Produces a result of 0.01838457 in VBA, but in PHP a value of 0.037457785974194.</p>\n\n<p>What did I miss in my transition that is causing the vastly different values?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 1862778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e68ea1990f38f7baa5e79a28a6607847?s=128&d=identicon&r=PG", "display_name": "Cylen", "link": "https://stackoverflow.com/users/1862778/cylen"}, "edited": false, "score": 0, "creation_date": 1440599807, "post_id": 32229190, "comment_id": 52341599, "body": "How do I limit this effect to only the groupbox the &quot;all&quot; checkbox is in? I dont want the generated checkboxes to select all the options in the first one (and vice versa)"}, {"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "reply_to_user": {"reputation": 119, "user_id": 1862778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e68ea1990f38f7baa5e79a28a6607847?s=128&d=identicon&r=PG", "display_name": "Cylen", "link": "https://stackoverflow.com/users/1862778/cylen"}, "edited": false, "score": 0, "creation_date": 1440600097, "post_id": 32229190, "comment_id": 52341784, "body": "Are you saying for example you have three groups of checkboxes and the select/deselect all should only affect one of the groups?"}, {"owner": {"reputation": 119, "user_id": 1862778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e68ea1990f38f7baa5e79a28a6607847?s=128&d=identicon&r=PG", "display_name": "Cylen", "link": "https://stackoverflow.com/users/1862778/cylen"}, "edited": false, "score": 0, "creation_date": 1440600554, "post_id": 32229190, "comment_id": 52342165, "body": "So CheckBox 1 has options, Colours, Numbers and Shapes in it,   Checkbox 2 has Red Yellow Green, Checkbox 3 has One Two Three and Checkbox 4 has Square Triangle Circle,  I want each one to have the option of select all items within each checkbox separately. From the selections the user makes, appropriate tabs will be revealed (Red Circle One, for example), and also to toggle it off, so if they select all, then they can uncheck it to deselect all"}], "tags": [], "owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "is_accepted": false, "score": 0, "last_activity_date": 1440598659, "creation_date": 1440598659, "answer_id": 32229190, "question_id": 32229041, "link": "https://stackoverflow.com/questions/32229041/selecting-deselecting-all-checkboxes-inside-a-groupbox/32229190#32229190", "title": "Selecting/Deselecting all Checkboxes inside a GroupBox", "body": "<p>Untested but I believe this is what you're looking for</p>\n\n<pre><code>ActiveSheet.CheckBoxes.Value = xlOff\n\n\nActiveSheet.CheckBoxes.Value = xlOn\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 1, "last_activity_date": 1440608338, "creation_date": 1440608338, "answer_id": 32232442, "question_id": 32229041, "link": "https://stackoverflow.com/questions/32229041/selecting-deselecting-all-checkboxes-inside-a-groupbox/32232442#32232442", "title": "Selecting/Deselecting all Checkboxes inside a GroupBox", "body": "<p>GroupBoxes doesn't appear to have a Controls property to For Each. The only way I could see to determine if a CheckBox is within a GroupBox is to check if it's physically within it. I hope that's not the right answer and there's some more elegant way, but here's an example anyway</p>\n\n<pre><code>Public Sub TickAll()\n\n    Dim gb As GroupBox\n    Dim cb As CheckBox\n    Dim cbAll As CheckBox\n\n    Set gb = Sheet1.GroupBoxes(1)\n    Set cbAll = Sheet1.CheckBoxes(\"Check Box 6\")\n\n    For Each cb In Sheet1.CheckBoxes\n        If IsInGroupBox(cb, gb) Then\n            cb.Value = cbAll.Value\n        End If\n    Next cb\n\nEnd Sub\n\nPublic Function IsInGroupBox(ByRef cb As CheckBox, ByRef gb As GroupBox)\n\n    IsInGroupBox = cb.Top &gt; gb.Top And _\n        cb.Top &lt; gb.Top + gb.Height And _\n        cb.Left &gt; gb.Left And _\n        cb.Left &lt; gb.Left + gb.Width\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 1862778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/e68ea1990f38f7baa5e79a28a6607847?s=128&d=identicon&r=PG", "display_name": "Cylen", "link": "https://stackoverflow.com/users/1862778/cylen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 32232442, "answer_count": 2, "score": 2, "last_activity_date": 1440608338, "creation_date": 1440598283, "question_id": 32229041, "link": "https://stackoverflow.com/questions/32229041/selecting-deselecting-all-checkboxes-inside-a-groupbox", "title": "Selecting/Deselecting all Checkboxes inside a GroupBox", "body": "<p>I'm trying to build an Excel where the User selects from a range of checkboxes at the start (in a groupbox), each checkbox would reveal a new possible selection of checkboxes (either listbox or groupbox, whichever you think more appropriate) and then based on their final selections, generate/reveal the relevant tabs for them to read.</p>\n\n<p>I'm having difficulty getting a Select/Deselect all button in there. This is what I'm trying so far, without much luck. If anyone could help I'd be very grateful. </p>\n\n<pre><code>Sub Tickall()\n\nDim CB As CheckBox\nDim OB As OptionButton\nIf ActiveSheet.OB.GroupBox.GroupBox1.CheckBoxes(\"Check Box 21\").Value Then\n    For Each CB In ActiveSheet.OB.GroupBox1.GroupBox1.CheckBoxes\n        If CB.name &lt;&gt; ActiveSheet.OB.GroupBox1.CheckBoxes(\"Check Box 21\").name Then\n            CB.Value = True\n        End If\n    Next CB\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "field", "ado", "recordset"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440598060, "post_id": 32228839, "comment_id": 52340247, "body": "It is hard to say a database is secured if you are making a userform in Excel that is going to store a connection to that DB."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1440598221, "post_id": 32228839, "comment_id": 52340385, "body": "Please confirm what error you are getting. ie What does &quot;Does not work&quot; mean."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1440598308, "post_id": 32228839, "comment_id": 52340458, "body": "What do you get if you do rs.fields.Count?"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1440598740, "post_id": 32228839, "comment_id": 52340819, "body": "Please try the code in my answer"}], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1440598568, "creation_date": 1440598568, "answer_id": 32229149, "question_id": 32228839, "link": "https://stackoverflow.com/questions/32228839/max-fields-in-ado-recordset/32229149#32229149", "title": "Max fields in ADO recordset", "body": "<p>Please add this into your code after </p>\n\n<pre><code>countfields = .Fields.Count 'Returns 132\n</code></pre>\n\n<p>and see what happens</p>\n\n<pre><code>Dim intLoop  as long \n\n    For intLoop = 0 To (.fields.Count - 1)\n        With rs.fields.Item(intLoop) \n            Debug.Print .Name, .value, .type, .DefinedSize \n        End With \n    Next\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5268889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42c1c21f38ae4b9d6550dd563927ea2?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelUser", "link": "https://stackoverflow.com/users/5268889/exceluser"}, "is_accepted": false, "score": 0, "last_activity_date": 1440687007, "creation_date": 1440687007, "answer_id": 32252644, "question_id": 32228839, "link": "https://stackoverflow.com/questions/32228839/max-fields-in-ado-recordset/32252644#32252644", "title": "Max fields in ADO recordset", "body": "<p>Thanks for the replies but I was able to figure out why I was having issues. I am new to access and when I built the table the first 64 columns were formatted to text, but when I added more columns they were formatted as dates... therefore when I was trying to put text or number into the field it would just drop out and act like it was not able to access it. HarveyFrench your response would of helped me figure this out, I wish I would asked the question sooner...</p>\n\n<p>Thanks again! and I hope this helps the next person with similar issues.</p>\n"}], "owner": {"reputation": 13, "user_id": 5268889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f42c1c21f38ae4b9d6550dd563927ea2?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelUser", "link": "https://stackoverflow.com/users/5268889/exceluser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1530, "favorite_count": 0, "accepted_answer_id": 32229149, "answer_count": 2, "score": 1, "last_activity_date": 1440687007, "creation_date": 1440597726, "question_id": 32228839, "link": "https://stackoverflow.com/questions/32228839/max-fields-in-ado-recordset", "title": "Max fields in ADO recordset", "body": "<p>I am trying to make a secured database in access and a userform in excel. I understand all the VBA and most of the syntax for sending and receiving data from access to excel. My issue is that i can only write to 64 fields (0-63) I have over 75 columns I want to move back and forth between access and excel. Here is some of my code it that is not clear. </p>\n\n<pre><code>' open the database based on type of save\n    Set cn = New ADODB.Connection\n    cn.Open \"Provider=Microsoft.ace.OLEDB.12.0; Data Source=\" &amp; DBFullName &amp; \";\"\n    Set rs = New ADODB.Recordset\n    With rs\n        ' open the recordset\n'.MaxRecords = 70\n.Open \"SELECT * FROM \" &amp; TableName &amp; \" WHERE [Task_Number] = '\" &amp; MyCriteria &amp; \"'\", cn, adOpenKeyset, adLockOptimistic\ncountfields = .Fields.Count 'Returns 132\n.Fields(60).Value = \"60\" 'Works\n.Fields(61).Value = \"61\" 'Works\n.Fields(62).Value = \"62\" 'Works\n.Fields(63).Value = \"63\" 'Works\n.Fields(64).Value = \"64\" 'Does not work\n.Fields(65).Value = \"65\" 'Does not work\n.Fields(66).Value = \"66\" 'Does not work\n.Fields(80).Value = \"80\" 'Does not work\n.Update ' stores the new record\n            End With\n        rs.Close\n        Set rs = Nothing\n        cn.Close\n\n        Set cn = Nothing\n</code></pre>\n\n<p>the .MaxRecords is set to 0 (unlimited) but i have also tried to change it to the number of records i need and to how many fields i have in my recordset.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "oracle11g", "ms-access-2007"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1440597892, "post_id": 32228719, "comment_id": 52340115, "body": "You say it works very good in VBA but has an error.  Does it work &quot;except when&quot; you do something?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1440597969, "post_id": 32228719, "comment_id": 52340179, "body": "And can you post what it looks like as a string. So we can see if any of the variables are adding something causing an issue?"}, {"owner": {"reputation": 5789, "user_id": 2679750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W8CvF.jpg?s=128&g=1", "display_name": "Mark C.", "link": "https://stackoverflow.com/users/2679750/mark-c"}, "edited": false, "score": 0, "creation_date": 1440609304, "post_id": 32228719, "comment_id": 52347859, "body": "It looks very long. I think you should try to add line breaks/line continuation."}, {"owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440650170, "post_id": 32228719, "comment_id": 52363037, "body": "Hello, that vba code works well on my machine, but on others computers it does not work, giving oracle error-missing comma. So if values would be wrong here, it would not be working also on my machine. Even tried to change computer regional settings but it did not work"}], "answers": [{"comments": [{"owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440650153, "post_id": 32229350, "comment_id": 52363033, "body": "Hello, that vba code works well on my machine, but on others computers it does not work, giving oracle error-missing comma. So if values would be wrong here, it would not be working also on my machine. Even tried to change computer regional settings but it did not work"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440669656, "post_id": 32229350, "comment_id": 52373169, "body": "Do the other machines have a reference to the same ADO library? Do the other machine use the saem oracle account?  Are the oracle settings the same?  Is the SQl text generated the same?  (Can you post the SQl text that is created.)"}, {"owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440737056, "post_id": 32229350, "comment_id": 52406101, "body": "SQL text is posted at the top which i use to insert extra column, machines having same ADO library &amp; yes use same oracle account. Could it be because of access versions? Despite we do have installed Office 2010 plus, but when i open access it shows on my pc Access 2007-2010, while for others shows Access 2010"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440750708, "post_id": 32229350, "comment_id": 52412222, "body": "The access version might be the issue, but before further consideration I think furtehr investigation can be done - see part 2 of my answer"}, {"owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440753575, "post_id": 32229350, "comment_id": 52413851, "body": "Found a problem!!! In DSN options there are also regional settings, where should determine decimal symbol for float numbers. As regional setings of each pc could be different, so changing regional settings in dsn would solve  a problem;)"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440761601, "post_id": 32229350, "comment_id": 52418635, "body": "Ah. Worth knowing. Please post the code you used to fix this, so I can learn from it!"}, {"owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440766158, "post_id": 32229350, "comment_id": 52421603, "body": "When you go  to ODBC data source, and press configure User DSN, there is last step where you can put a tick on setting &quot;use regional settings when outputting currency,numbers dates and times&quot;."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "edited": false, "score": 0, "creation_date": 1440773877, "post_id": 32229350, "comment_id": 52426963, "body": "You might like to read this <a href=\"https://msdn.microsoft.com/en-us/library/ms690545(v=vs.85).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms690545(v=vs.85).aspx</a>"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1440750618, "last_edit_date": 1440750618, "creation_date": 1440599116, "answer_id": 32229350, "question_id": 32228719, "link": "https://stackoverflow.com/questions/32228719/missing-comma-error-error-inserting-sql-through-access-2010-vba/32229350#32229350", "title": "Missing comma error error inserting sql through access 2010 vba", "body": "<p>It might be that one of the rescordset fields that is a string data type, has a value that contains a comma but you have not treated it as string.</p>\n\n<p>eg </p>\n\n<pre><code>VALUES ( \" &amp; rst![minimumas] &amp; \",\n</code></pre>\n\n<p>For the above code to work minimumas CANNOT contain any commas.</p>\n\n<p>Are you certain that all the string fields int he recordset have been appended to the SQL string with a ' around them.</p>\n\n<p>We need to see the sql string is created which then causes the error.  Please provide this as requested.</p>\n\n<p>=========================================================</p>\n\n<p>PART 2  Viewing the SQL causing the error</p>\n\n<p>replace </p>\n\n<pre><code> insetSQL = con.Execute(\n</code></pre>\n\n<p>with \n    on error resume next \n    strMySQl = the string currently used in the execute statement\n    insetSQL = con.Execute(strMySQl)\n    if err.number &lt;> 0 then\n        stop\n        debug.print err.number, err.description\n        debug.print strMySQl\n    end if</p>\n\n<p>then post the sql string that is printed in the immediate window to this site.</p>\n\n<p>I would also suggest that you compare the SQL string generated on your machine with the other machines - just in case something weird is happening.</p>\n"}], "owner": {"reputation": 271, "user_id": 4332302, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d089a170155760ea42e087efb7891b52?s=128&d=identicon&r=PG&f=1", "display_name": "orangutangas", "link": "https://stackoverflow.com/users/4332302/orangutangas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440750618, "creation_date": 1440597431, "question_id": 32228719, "link": "https://stackoverflow.com/questions/32228719/missing-comma-error-error-inserting-sql-through-access-2010-vba", "title": "Missing comma error error inserting sql through access 2010 vba", "body": "<p>Having the weirdest problem ever. I do have an sql insert statement, that properly works in sql. When i put that sql into vba it works very good from my pc. However, it does not work and shows sql error: missing comma. Where can be the problem??? I use Access 2010 plus, others use same Access version and having same ODB connections (DSN servers) . Some code example:</p>\n\n<pre><code>   sql = \"Driver={Microsoft ODBC for Oracle}; \" &amp; _\n        \"CONNECTSTRING=(DESCRIPTION=\" &amp; _\n        \"(ADDRESS=(PROTOCOL=TCP)\" &amp; _\n        \"(HOST= ODB)(PORT=1520))\" &amp; _\n        \"(CONNECT_DATA=(SERVICE_NAME=ABTL))); uid=IN; pwd=XXX;\"\n\n  Set con = New ADODB.Connection\n  Set rec = New ADODB.Recordset\n  Set cmd = New ADODB.Command\n  con.Open sql\n\n        Set db = CurrentDb()\n        Set rst = db.OpenRecordset(strSQL)\n\nDo While Not rst.EOF\n\ninsetSQL = con.Execute(\" INSERT INTO STOCK (PNM_AUTO_KEY, PN, DESCRIPTION, HISTORICAL_FLAG, qty_oh, qty_adj, qty_available, CTRL_NUMBER, CTRL_ID, receiver_number, rec_date, serial_number,pcc_auto_key, cnc_auto_key, loc_auto_key, whs_auto_key, unit_cost, adj_cost, stc_auto_key, visible_mkt, remarks, ifc_auto_key, exp_date, unit_price, tagged_by, tag_date, owner, PART_CERT_NUMBER,ORIGINAL_PO_NUMBER, SHELF_LIFE, CTS_AUTO_KEY, MFG_LOT_NUM, AIRWAY_BILL )\" &amp; _\n                                    \"  VALUES ( \" &amp; rst![minimumas] &amp; \", '\" &amp; rst![pn] &amp; \"', '\" &amp; \"FROM_SCRIPT\" &amp; \"', '\" &amp; \"F\" &amp; \"',\" &amp; rst![qty_oh] &amp; \",\" &amp; rst![qty_oh] &amp; \",\" &amp; rst![qty_oh] &amp; \",\" &amp; \"G_STM_CTRL_NUMBER.nextval\" &amp; \",\" &amp; \"1\" &amp; \", '\" &amp; rst![receiver_number] &amp; \"', \" &amp; \" TO_DATE('\" &amp; rst![rec_date] &amp; \"','YYYY-MM-DD'), '\" &amp; rst![serial_number] &amp; \"',\" &amp; rst![pcc_auto_key] &amp; \",\" &amp; rst![cnc_auto_key] &amp; \",\" &amp; rst![loc_auto_key] &amp; \",\" &amp; rst![whs_auto_key] &amp; \",\" &amp; rst![unit_cost] &amp; \",\" &amp; rst![unit_cost] &amp; \",\" &amp; \"1\" &amp; \",'\" &amp; \"T\" &amp; \"', '\" &amp; rst![remarks] &amp; \"',\" &amp; _\n                                      \"1\" &amp; \", \" &amp; \" TO_DATE('\" &amp; rst![exp_date] &amp; \"','YYYY-MM-DD'), \" &amp; \"0\" &amp; \",'\" &amp; rst![TAGGED_BY] &amp; \"', \" &amp; \" TO_DATE('\" &amp; rst![tag_date] &amp; \"','YYYY-MM-DD'), '\" &amp; \"\" &amp; \"', '\" &amp; rst![PART_CERT_NUMBER] &amp; \"', '\" &amp; rst![ORIGINAL_PO_NUMBER] &amp; \"', '\" &amp; rst![SHELF_LIFE] &amp; \"', \" &amp; rst![CERT_SOURCE] &amp; \", '\" &amp; rst![MFG_LOT_NUM] &amp; \"', '\" &amp; rst![AIRWAY_BILL] &amp; \"'\" &amp; \" )\")\n\nLoop \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1440595721, "post_id": 32227710, "comment_id": 52338447, "body": "Hi Motorhead.  Can I just confirm what you are trying to achieve? Are you trying to loop through all filtered values and have all ranges one after another in &#39;Sheet1&#39; in the newbook - following on from each other. Or are you trying to create a new sheet for each in that book?"}, {"owner": {"reputation": 163, "user_id": 4186447, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K6T9O.jpg?s=128&g=1", "display_name": "Motorhead1308", "link": "https://stackoverflow.com/users/4186447/motorhead1308"}, "reply_to_user": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1441802837, "post_id": 32227710, "comment_id": 52820710, "body": "@Trum I have a macro that filters row K in 63 sheets for certain criteria. I want all of the filtered data to be copy and pasted to a new worksheet so I can apply a Pivot Table to it. The filtered data will always start on Row A15  and ends on AI"}, {"owner": {"reputation": 163, "user_id": 4186447, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K6T9O.jpg?s=128&g=1", "display_name": "Motorhead1308", "link": "https://stackoverflow.com/users/4186447/motorhead1308"}, "reply_to_user": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "edited": false, "score": 0, "creation_date": 1441802912, "post_id": 32227710, "comment_id": 52820774, "body": "@Trum the issue is that when work is done it becomes completed and I&#39;m only filtering for open work. Thus the amount of rows in each sheet will decrease. So somehow I need to select ONLY the filtered data that changes on any given bases."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 4186447, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K6T9O.jpg?s=128&g=1", "display_name": "Motorhead1308", "link": "https://stackoverflow.com/users/4186447/motorhead1308"}, "edited": false, "score": 0, "creation_date": 1440610373, "post_id": 32228039, "comment_id": 52348537, "body": "Hey Nic thanks for your response. I think that you&#39;re light years ahead of me here and I&#39;m not following what you posted as an answer could you provide an example ?"}], "tags": [], "owner": {"reputation": 31, "user_id": 2699212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57faf87ee86c248a7affa07ac396d921?s=128&d=identicon&r=PG&f=1", "display_name": "Nic Paul", "link": "https://stackoverflow.com/users/2699212/nic-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1443188742, "last_edit_date": 1443188742, "creation_date": 1440595777, "answer_id": 32228039, "question_id": 32227710, "link": "https://stackoverflow.com/questions/32227710/copy-all-previously-filtered-data-from-all-worksheets-to-another/32228039#32228039", "title": "Copy all previously filtered data from all worksheets to another", "body": "<p>You can use <code>Worksheet.UsedRange</code> to give you just the Range with data in, then you could apply your <code>Range.SpecialsCells</code> to give you just the filtered data.</p>\n\n<p>To help debug your code, set a breakpoint and use the Immediate Window to see what the range is, i.e.:</p>\n\n<pre><code>?rng.Address\n</code></pre>\n\n<p>(The question mark prints out whatever follows.)</p>\n\n<p>This function should do what you need:</p>\n\n<pre><code>Sub CopyFilteredDataToNewWorkbook()\n\n    Dim newBook As Excel.Workbook\n    Dim rng As Excel.Range\n    Dim sht As Excel.Worksheet\n    Dim rowoffsetcount As Long\n    Dim newsht As Excel.Worksheet\n\n    Set newBook = Workbooks.Add\n\n    ' ThisWorkbook.Worksheets is the same as the Sheets or Worksheets object, but more explicit\n    For Each sht In ThisWorkbook.Worksheets\n\n        ' Get the used rows and columns\n        Set rng = sht.UsedRange\n\n        ' Offset the range so it starts at row 15\n        rowoffsetcount = 15 - rng.Row\n        Set rng = rng.Offset(rowoffsetcount)\n\n        ' Check there will be something to copy\n        If (rng.Rows.Count - rowoffsetcount &gt; 0) Then\n\n            ' Reduce the number of rows in the range so it ends at the same row\n            Set rng = rng.Resize(rng.Rows.Count - rowoffsetcount)\n\n            ' Check that there is a sheet we can copy it to\n            On Error Resume Next\n            Set newsht = Nothing\n            Set newsht = newBook.Worksheets(sht.Index)\n            On Error GoTo 0\n\n            ' We have run out of sheets, add another at the end\n            If (newsht Is Nothing) Then\n                Set newsht = newBook.Sheets.Add(, newBook.Worksheets(newBook.Worksheets.Count))\n            End If\n\n            ' Give it the same name\n            newsht.Name = sht.Name\n\n            ' Get the range of visible (i.e. unfiltered) rows\n            ' (can't do this before the range resize as that doesn't work on disjoint ranges)\n            Set rng = rng.SpecialCells(xlCellTypeVisible)\n\n            ' Paste the visible data into the new sheet\n            rng.Copy newsht.Range(\"A1\")\n\n        End If\n\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 4186447, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/K6T9O.jpg?s=128&g=1", "display_name": "Motorhead1308", "link": "https://stackoverflow.com/users/4186447/motorhead1308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443188742, "creation_date": 1440594937, "last_edit_date": 1441802960, "question_id": 32227710, "link": "https://stackoverflow.com/questions/32227710/copy-all-previously-filtered-data-from-all-worksheets-to-another", "title": "Copy all previously filtered data from all worksheets to another", "body": "<p>I have a workbook with about 63 sheets. I'd like to take all filtered data (filtered by a macro) from all worksheets and paste them into a separate worksheet.</p>\n\n<p>Worksheets DON'T have the same data range. They all would start on Column A Row 15 IF there is any data there at all. The filter macro filters for specific values in one of the columns hence the differentiation between rows in each sheet.</p>\n\n<p>I need to copy all filtered data starting with a Range of A15 and the last row in the range would be AI. It's just a matter of how many rows if there are any rows to get the number for the AI in the range to copy over. </p>\n\n<p>I got it to copy an entire sheet, not the filtered data, to another sheet but it only copied sheet 1.</p>\n\n<pre><code>Sub rangeToNew_Try2()\nDim newBook As Excel.Workbook\nDim rng As Excel.Range\n\nSet newBook = Workbooks.Add\n\nSet rng = ThisWorkbook.Worksheets(\"Sheet1\").Cells.SpecialCells(xlCellTypeVisible)\n\nrng.Copy newBook.Worksheets(\"Sheet1\").Range(\"A1\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "multidimensional-array"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1440595062, "post_id": 32227677, "comment_id": 52337969, "body": "not as far as i know, if you have the values in a worksheet you can use loops to add the values to the array."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440595165, "post_id": 32227677, "comment_id": 52338042, "body": "Define &#39;On one row&#39;. Do you mean a row of Excel cells? You could do this using the Range command, which selects a cell based on row and column. Use a loop to loop through the columns, and change the Range.formula method to aryTitle(x,y)."}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 1, "creation_date": 1440595304, "post_id": 32227677, "comment_id": 52338138, "body": "if you need a two dimension array use the <code>library</code> object. It provides <code>key value</code> pairs and is easier to resize."}, {"owner": {"reputation": 3650, "user_id": 5090027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/904db949ae64fe1a63ea8b4c677e6d57?s=128&d=identicon&r=PG&f=1", "display_name": "Grade &#39;Eh&#39; Bacon", "link": "https://stackoverflow.com/users/5090027/grade-eh-bacon"}, "edited": false, "score": 0, "creation_date": 1440595389, "post_id": 32227677, "comment_id": 52338208, "body": "Sorry - I see now you mean &quot;set it in 1 line of code&quot; not &quot;set the values onto 1 row of Excel cells&quot;. My comment is not relevant. Note that if your values are already in a worksheet as a range [group of Excel cells], you can directly copy an entire range onto another, but I do not believe you can do this directly with an array of strings; a loop may be your only option."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 1, "creation_date": 1440595584, "post_id": 32227677, "comment_id": 52338343, "body": "<code>aryTitle = Array(Array(&quot;Desciption&quot;, &quot;Value&quot;), Array(&quot;Description2&quot;, &quot;Value2&quot;))</code> ... but this would give you <code>Debug.Print (aryTitle(0)(0) + &quot;:&quot; + aryTitle(0)(1))</code>."}, {"owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "edited": false, "score": 0, "creation_date": 1440665701, "post_id": 32227677, "comment_id": 52370500, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6938614/pre-defining-multi-dimensional-array-in-excel-vba\">Pre defining multi dimensional array in Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": true, "score": 3, "last_activity_date": 1440597447, "creation_date": 1440597447, "answer_id": 32228723, "question_id": 32227677, "link": "https://stackoverflow.com/questions/32227677/vba-setting-multidimensional-array-values-in-one-line/32228723#32228723", "title": "VBA - Setting multidimensional array values in one line", "body": "<p>Not natively, no. But you can write a function for it. The only reason Python can do that is someone wrote a function to do it. The difference is that they had access to the source so they could make the syntax whatever they like. You'll be limited to VBA function syntax.  Here's a function to create a 2-dim array. It's not technically 'one line of code', but throw it in your MUtilities module and forget about it and it will feel like one line of code.</p>\n\n<pre><code>Public Function FillTwoDim(ParamArray KeyValue() As Variant) As Variant\n\n    Dim aReturn() As Variant\n    Dim i As Long\n    Dim lCnt As Long\n\n    ReDim aReturn(0 To ((UBound(KeyValue) + 1) \\ 2) - 1, 0 To 1)\n\n    For i = LBound(KeyValue) To UBound(KeyValue) Step 2\n        If i + 1 &lt;= UBound(KeyValue) Then\n            aReturn(lCnt, 0) = KeyValue(i)\n            aReturn(lCnt, 1) = KeyValue(i + 1)\n            lCnt = lCnt + 1\n        End If\n    Next i\n\n    FillTwoDim = aReturn\n\nEnd Function\n\nSub test()\n\n    Dim vaArr As Variant\n    Dim i As Long\n    Dim j As Long\n\n    vaArr = FillTwoDim(\"Description\", \"Value\", \"Description2\", \"Value2\")\n\n    For i = LBound(vaArr, 1) To UBound(vaArr, 1)\n        For j = LBound(vaArr, 2) To UBound(vaArr, 2)\n            Debug.Print i, j, vaArr(i, j)\n        Next j\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>If you supply an odd number of arguments, it ignores the last one. If you use 3-dim arrays, you could write a function for that. You could also write a fancy function that could handle any dims, but I'm not sure it's worth it. And if you're using more than 3-dim arrays, you probably don't need my help writing a function.</p>\n\n<p>The output from the above</p>\n\n<pre><code> 0             0            Description\n 0             1            Value\n 1             0            Description2\n 1             1            Value2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 3, "last_activity_date": 1440597457, "creation_date": 1440597457, "answer_id": 32228726, "question_id": 32227677, "link": "https://stackoverflow.com/questions/32227677/vba-setting-multidimensional-array-values-in-one-line/32228726#32228726", "title": "VBA - Setting multidimensional array values in one line", "body": "<p>You can write a helper function:</p>\n\n<pre><code>Function MultiSplit(s As String, Optional delim1 As String = \",\", Optional delim2 As String = \";\") As Variant\n    Dim V As Variant, W As Variant, A As Variant\n    Dim i As Long, j As Long, m As Long, n As Long\n    V = Split(s, delim2)\n    m = UBound(V)\n    n = UBound(Split(V(0), delim1))\n    ReDim A(0 To m, 0 To n)\n    For i = 0 To m\n        For j = 0 To n\n            W = Split(V(i), delim1)\n            A(i, j) = Trim(W(j))\n        Next j\n    Next i\n    MultiSplit = A\nEnd Function\n</code></pre>\n\n<p>Used like this:</p>\n\n<pre><code>Sub test()\n    Dim A As Variant\n    A = MultiSplit(\"Desciption, Value; Description2, Value2\")\n    Range(\"A1:B2\").Value = A\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 3933207, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6122588582a190b804528b74d6cf2618?s=128&d=identicon&r=PG&f=1", "display_name": "Jos&#233;", "link": "https://stackoverflow.com/users/3933207/jos%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5582, "favorite_count": 0, "accepted_answer_id": 32228723, "answer_count": 2, "score": 5, "last_activity_date": 1440603444, "creation_date": 1440594871, "last_edit_date": 1440603444, "question_id": 32227677, "link": "https://stackoverflow.com/questions/32227677/vba-setting-multidimensional-array-values-in-one-line", "title": "VBA - Setting multidimensional array values in one line", "body": "<p>Right, so using Python I would create a multidimensional list and set the values on one line of code (as per the below). </p>\n\n<pre><code>aryTitle = [[\"Desciption\", \"Value\"],[\"Description2\", \"Value2\"]]\nprint(aryTitle[0,0] + aryTitle[0,1])\n</code></pre>\n\n<p>I like the way I can set the values on one line. In VBA I am doing this by: </p>\n\n<pre><code>Dim aryTitle(0 To 1, 0 To 1) As String\naryTitle(0, 0) = \"Description\"\naryTitle(0, 1) = \"Value\"\naryTitle(1, 0) = \"Description2\"\naryTitle(1, 1) = \"Value2\"\nMsgBox (aryTitle(0, 0) &amp; aryTitle(0, 1))    \n</code></pre>\n\n<p>Is there a way to set the values in one line of code? </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1440643374, "post_id": 32227046, "comment_id": 52361417, "body": "This is a concern. No where should users ever affect the design of any application object including forms, queries, reports, macros, modules during the runtime of application. So such a message should not appear in a well-designed app. Can you screenshot your form? I don&#39;t know what you mean by thumbnail.Are they simply buttons with labels?"}], "answers": [{"tags": [], "owner": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "is_accepted": false, "score": 0, "last_activity_date": 1440636509, "creation_date": 1440636509, "answer_id": 32238956, "question_id": 32227046, "link": "https://stackoverflow.com/questions/32227046/preventing-access-from-asking-to-save-the-form/32238956#32238956", "title": "Preventing Access from asking to Save the form", "body": "<p>If you are using Docmd.Close to close the form when you switch, you can choose not to save:</p>\n\n<pre><code>DoCmd.Close acForm, Me.Name, acSaveNo\n</code></pre>\n\n<p>The values are <code>acSaveNo</code>, <code>acSaveYes</code>, <code>acSavePrompt</code> with Prompt being the default</p>\n"}], "owner": {"reputation": 23, "user_id": 5193110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01e34c387be6f9b40672e739fd2fb125?s=128&d=identicon&r=PG&f=1", "display_name": "jbebar", "link": "https://stackoverflow.com/users/5193110/jbebar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440636509, "creation_date": 1440593119, "question_id": 32227046, "link": "https://stackoverflow.com/questions/32227046/preventing-access-from-asking-to-save-the-form", "title": "Preventing Access from asking to Save the form", "body": "<p>I have a navigation form with a research area and a thumbnail area showing differents details according to the criteria taped.</p>\n\n<p>For instance, the user taps the name of a company (let's say \"Abidas\") and press <em>search</em>, that creates a SQL query affected to a String. This SQL \"query\" is then assigned and adapted to the <em>RecordSource</em> variable of each thumbnail (one thumbnail for the contacts at \"Abidas\", another one with the finances of \"Abidas\"...).</p>\n\n<p>The SQL query works fine but each time the users moves from one thumbnail to another. For instance, if you are on the <em>\"contact\"</em> thumbnail and you go to the <em>\"Finances\"</em> thumbnail Access would ask <em>\"Would you want to save the Form \"contacts\"?\"</em> (translated from French UI). </p>\n\n<p>Does anyone knows a way to stop this message from appearing? Maybe there is an easier way to show the results of the search</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "forms", "vba"], "comments": [{"owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "edited": false, "score": 0, "creation_date": 1440593016, "post_id": 32226923, "comment_id": 52336353, "body": "run time error 1004. Method &#39;Range&#39; of object&#39;_Global&#39; failed"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 2, "creation_date": 1440593149, "post_id": 32226923, "comment_id": 52336454, "body": "If <code>lstRw</code> were 99, this is your range: <code>Range(&quot;A99:C99:I99:N99AW:BK99&quot;)</code>. See the issue yet?"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "edited": false, "score": 0, "creation_date": 1440593608, "post_id": 32227077, "comment_id": 52336859, "body": "still getting the same error code with    &quot;AW&quot; &amp; lstRw &amp; &quot;:BK&quot; &amp; lstRw"}, {"owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "edited": false, "score": 0, "creation_date": 1440593739, "post_id": 32227077, "comment_id": 52336977, "body": "I tried this am having the same error..  would setting a new range in a different sub address it? What would I have to change to do this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1442088984, "post_id": 32227077, "comment_id": 52943434, "body": "<code>Range(Replace(&quot;A0,C0,I0,N0,AW0:BK0&quot;, 0, LstRw))</code> tidies it up a bit."}], "tags": [], "owner": {"reputation": 34, "user_id": 4793377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uqjMb.png?s=128&g=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/4793377/bill"}, "is_accepted": true, "score": 2, "last_activity_date": 1440597113, "last_edit_date": 1440597113, "creation_date": 1440593205, "answer_id": 32227077, "question_id": 32226923, "link": "https://stackoverflow.com/questions/32226923/copying-down-a-range-from-cells-above-in-vba/32227077#32227077", "title": "Copying down a range from cells above in VBA", "body": "<p>Change <code>\"AW:BK\"</code> to <code>\"AW\" &amp; lstRw &amp; \":BK\" &amp; lstRw</code></p>\n\n<p>Say your last row is row 10, to reference multiple columns of row 10 you would have to write <code>AW10:BK10</code> your code just needs to replicate this. </p>\n\n<p>EDIT I only looked at the AW:BK portion initially. If you are trying to select columns A,C,I,N,AW:BK of the same row you need to separate them by commas not colons</p>\n\n<pre><code>range(\"A\" &amp; LstRw &amp; \",C\" &amp; LstRw &amp; \",I\" &amp; LstRw &amp; \",N\" &amp; LstRw &amp; \",AW\" &amp; LstRw &amp; \":BK\" &amp; LstRw)\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1187, "favorite_count": 0, "accepted_answer_id": 32227077, "answer_count": 1, "score": 1, "last_activity_date": 1440597113, "creation_date": 1440592722, "question_id": 32226923, "link": "https://stackoverflow.com/questions/32226923/copying-down-a-range-from-cells-above-in-vba", "title": "Copying down a range from cells above in VBA", "body": "<p>I have a formula that automatically populates cells by copying down from above and the following code works perfectly for the cell references that I require.</p>\n\n<pre><code>Dim lstRw As Long\nDim Rng As Range\nlstRw = Cells(Rows.Count, \"A\").End(xlUp).Row\nSet Rng = Range(\"A\" &amp; lstRw + 1)\nRange(\"A\" &amp; lstRw &amp; \":C\" &amp; lstRw &amp; \":I\" &amp; lstRw &amp; \":N\" &amp; lstRw).Copy Range(\"A\" &amp; lstRw + 1)\nWith Rng\n</code></pre>\n\n<p>However.. I also want the code to copy down a range from AW:BK..</p>\n\n<p>I have tried the following:</p>\n\n<pre><code>Dim lstRw As Long\nDim Rng As Range\nlstRw = Cells(Rows.Count, \"A\").End(xlUp).Row\nSet Rng = Range(\"A\" &amp; lstRw + 1)\nRange(\"A\" &amp; lstRw &amp; \":C\" &amp; lstRw &amp; \":I\" &amp; lstRw &amp; \":N\" &amp; lstRw &amp; \"AW:BK\" &amp; lstRw).Copy Range(\"A\" &amp; lstRw + 1)\nWith Rng\n</code></pre>\n\n<p>But I keep getting compile errors!</p>\n\n<p>Regards</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1440592835, "post_id": 32226784, "comment_id": 52336221, "body": "What SQL are you using to populate the combo boxes? Since they&#39;re all linked it&#39;s likely that this is where the issue may be."}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1440593018, "post_id": 32226784, "comment_id": 52336356, "body": "agree with jhTuppeny, problem sound like it could be in your source queies for the comboboxes. Are you using 4 individual recordsources? or one for all 4?  Can you show the queries?"}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440616299, "post_id": 32226784, "comment_id": 52351986, "body": "I know it may not be the most efficient (or correct) way but everything is based on one query. Query is based on one table using 4 of the table fields for the criteria. The SQL I believe shows all possible combinations the 4 comboboxes could have. This is not verified since I did not type SQL myself. I have no idea on how to use SQL either which might be part of the issue as well"}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "edited": false, "score": 0, "creation_date": 1440617284, "post_id": 32226784, "comment_id": 52352561, "body": "If it tells you anything, the WHERE portion of the SQL code is 23 lines long to accomodate"}, {"owner": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "edited": false, "score": 0, "creation_date": 1440636627, "post_id": 32226784, "comment_id": 52359991, "body": "Whatever the problem is, it looks like it&#39;s in the SQL. Posting that is the first stage to a fix."}, {"owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "reply_to_user": {"reputation": 1765, "user_id": 208465, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/67a9dcd74494c9684216ad2e1bb9d551?s=128&d=identicon&r=PG", "display_name": "Ben McIntyre", "link": "https://stackoverflow.com/users/208465/ben-mcintyre"}, "edited": false, "score": 0, "creation_date": 1440641773, "post_id": 32226784, "comment_id": 52361067, "body": "@BenMcIntyre SQL has been added to main question"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "is_accepted": true, "score": 0, "last_activity_date": 1440685935, "creation_date": 1440685935, "answer_id": 32252234, "question_id": 32226784, "link": "https://stackoverflow.com/questions/32226784/cascading-comboboxes-in-access-form-not-showing-all-available-options-after-sele/32252234#32252234", "title": "Cascading Comboboxes in Access Form Not Showing all available options after selections have been made", "body": "<p>In addition to having the AfterUpdate event for the comboboxes, I added a LostFocus event that will requery. Now when the user goes back into a combobox that already has a value and deletes it then clicks somewhere else all the wanted values are shown. It may not be full-proof but it works for now. Code is below. </p>\n\n<p><em>Note: cboChooseBodyNo does not have an AfterUpdate event since it is intended to be the last selection made before displaying the results in another form. Does not need to influence what is happening in the other comboboxes.</em></p>\n\n<pre><code>Private Sub cboChooseModelCode_AfterUpdate()\nMe.cboChooseBodyNo.Requery\nMe.cboSelectThreePanelStatus.Requery\nEnd Sub\n\nPrivate Sub cboChooseModelCode_LostFocus()\nMe.Requery\nEnd Sub\n\nPrivate Sub cboChooseSupplier_AfterUpdate()\nMe.cboChooseBodyNo.Requery\nMe.cboSelectThreePanelStatus.Requery\nEnd Sub\n\nPrivate Sub cboChooseSupplier_LostFocus()\nMe.Requery\nEnd Sub\n\nPrivate Sub cboSelectThreePanelStatus_AfterUpdate()\nMe.cboChooseBodyNo.Requery\nMe.cboChooseSupplier.Requery\nMe.cboChooseModelCode.Requery\nEnd Sub\n\nPrivate Sub cboSelectThreePanelStatus_LostFocus()\nMe.Requery\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5243777, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/246a40ecf0a7d921dd852334b81cd802?s=128&d=identicon&r=PG&f=1", "display_name": "Cole Stratton", "link": "https://stackoverflow.com/users/5243777/cole-stratton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 32252234, "answer_count": 1, "score": 0, "last_activity_date": 1440685935, "creation_date": 1440592313, "last_edit_date": 1440643187, "question_id": 32226784, "link": "https://stackoverflow.com/questions/32226784/cascading-comboboxes-in-access-form-not-showing-all-available-options-after-sele", "title": "Cascading Comboboxes in Access Form Not Showing all available options after selections have been made", "body": "<p>I was not entirely sure how to search for this question via Google or this site so let me apologize in advance if this a repeat question. </p>\n\n<p>I have an unbound Access Form with 4 cascading comboboxes that are criteria for a query which in turn will create a form and so on so forth. The cascading works beautifully like I would expect and the form generates like it is supposed on a button click. However, I have an issue where I make a selection in one combobox and then make a change in separate combobox, the full list of values no longer shows in the first combobox. Same thing occurs if I click in the combobox and backspace the text that is there.<br>\n<em>Edit</em><br>\nIf I make a selection in Combobox1 and then reclick into Combobox1 only the selection I made is shown instead of the whole list. It appears I did something wrong with making the comboboxes but not sure what property controls that.</p>\n\n<p>I am using a AfterUpdate event to requery the boxes to make them cascading. So it looks like    </p>\n\n<pre><code>Private Sub Combobox1 AfterUpdate()\nMe.Combobox2.Requery\nMe.Combobox3.Requery\nMe.Combobox4.Requery\n</code></pre>\n\n<p>And the code is repeated in the other boxes that will change as well. I want it so if the user changes their mind or mis-clicks then they would have the option to go back and fix it. </p>\n\n<p><strong>Edit</strong></p>\n\n<p>One solution I have tried is to set values to Null in the AfterUpdate event as well. However I realized if I needed to change just one selection I would not want the rest of my values to disappear and reselect them. </p>\n\n<p>I have also tried creating a Union query based on individual queries for the combobox to filter, Combobox1 is used in criteria for Query1 etc. I got it created but the union query still returns all results.</p>\n\n<p><strong>Edit2</strong></p>\n\n<pre><code>SELECT tblRawData.[Body No], tblRawData.Supplier, tblRawData.[Part Content], tblRawData.[Defect Desc], tblRawData.DateAdded, Left([tblRawData].[Body No],2) AS ModelCode, tblRawData.ThreePanelStatus, tblRawData.Location, tblRawData.Main, tblRawData.Responsibility2, tblRawData.Responsibility1, tblRawData.[Repair Job1], tblRawData.[Repair Job2], tblRawData.[Trim In Time], tblRawData.[S/OFF Date], tblRawData.[Repair Memo], tblRawData.Responsible, tblRawData.Note\nFROM tblRawData\nWHERE (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND ((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND ((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND ((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus])) OR (((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND ((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND ((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus]) AND (([Forms]![frmTest]![cboChooseBodyNo]) Is Null)) OR (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND ((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND ((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus]) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null)) OR (((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND ((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus]) AND (([Forms]![frmTest]![cboChooseBodyNo]) Is Null) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null)) OR (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND ((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND ((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus]) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null)) OR (((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND ((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus]) AND (([Forms]![frmTest]![cboChooseBodyNo]) Is Null) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null)) OR (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND ((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus]) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null)) OR (((tblRawData.ThreePanelStatus)=[Forms]![frmTest]![cboSelectThreePanelStatus]) AND (([Forms]![frmTest]![cboChooseBodyNo]) Is Null) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null)) OR (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND ((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND ((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null)) OR (((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND ((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND (([Forms]![frmTest]![cboChooseBodyNo]) Is Null) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null)) OR (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND ((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null)) OR (((Left([tblRawData].[Body No],2))=[Forms]![frmTest]![cboChooseModelCode]) AND (([Forms]![frmTest]![cboChooseBodyNo]) Is Null) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null)) OR (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND ((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null)) OR (((tblRawData.Supplier)=[Forms]![frmTest]![cboChooseSupplier]) AND (([Forms]![frmTest]![cboChooseBodyNo]) Is Null) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null)) OR (((tblRawData.[Body No])=[Forms]![frmTest]![cboChooseBodyNo]) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null)) OR ((([Forms]![frmTest]![cboChooseBodyNo]) Is Null) AND (([Forms]![frmTest]![cboChooseSupplier]) Is Null) AND (([Forms]![frmTest]![cboChooseModelCode]) Is Null) AND (([Forms]![frmTest]![cboSelectThreePanelStatus]) Is Null));\n</code></pre>\n\n<p>Not sure how to get that to show a little cleaner but there is the SQL that is currently being used.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 4, "last_activity_date": 1440588269, "creation_date": 1440588269, "answer_id": 32225336, "question_id": 32224885, "link": "https://stackoverflow.com/questions/32224885/excel-links-not-updating-with-vba/32225336#32225336", "title": "Excel - Links Not Updating with VBA", "body": "<p>This is a really easy one to fix!</p>\n\n<p>The code you wrote starts a new instance of Excel</p>\n\n<pre><code>Dim app As New Excel.Application\n</code></pre>\n\n<p>It is in this instance you are opening in the source workbook with your data.  The excel combo boxes in the output file will not be able to pick up the data from this output workbook unless it is open in the SAME instance of excel!</p>\n\n<p>So simply change you code to something like this:</p>\n\n<pre><code>Private Sub Workbook_Open()\nSet book =     Workbooks.Open(\"C:\\Users\\user_000\\Desktop\\ExampleFolder\\SourceFile.xlsm\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5268046, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/62f8e807647789a2b45a64ee7d83fdf1?s=128&d=identicon&r=PG&f=1", "display_name": "Freya", "link": "https://stackoverflow.com/users/5268046/freya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1529, "favorite_count": 1, "accepted_answer_id": 32225336, "answer_count": 1, "score": 3, "last_activity_date": 1440946807, "creation_date": 1440586912, "last_edit_date": 1440946807, "question_id": 32224885, "link": "https://stackoverflow.com/questions/32224885/excel-links-not-updating-with-vba", "title": "Excel - Links Not Updating with VBA", "body": "<p>I have searched far and wide for an answer to this issue, but nothing I try seems to work. Here is where I've got to so far.</p>\n\n<p>I have two Excel workbooks. The first workbook is a workbook that people can edit. It contains things such as drop-down menus which are only functional when linked to a source file. The second workbook is the source file. It contains information such as tables of data which are displayed in the drop-down menu lists in the first workbook. (E.g. A list of medical conditions, like asthma, diabetes, etc. and people can select a condition from the list.)</p>\n\n<p>The problem I'm having at the moment is that these links no longer update properly.</p>\n\n<p>To clarify, they will update if I open the source file and then the output file manually. In the name manager, the references will appear like this:</p>\n\n<p>SourceFile!NameRef1</p>\n\n<p>Because I didn't want people to have to open the files one at a time manually, I wrote some VBA which opens the source file automatically whenever you open the output file.</p>\n\n<pre><code>Dim app As New Excel.Application\nDim book As Excel.Workbook\nPrivate Sub Workbook_Open()\napp.Visible = True\nSet book = app.Workbooks.Open(\"C:\\Users\\user_000\\Desktop\\ExampleFolder\\SourceFile.xlsm\")\nEnd Sub\n</code></pre>\n\n<p>It works fine, but the links will not update, despite the fact that they are set to update automatically. At this point, when I go into the name manager, the links have now changed to the entire file path. For some reason, every time it has done this (for example, when I've moved the file to another location), it stops updating the links.</p>\n\n<p>I don't understand why Excel doesn't like you using file paths as links in the name manager. It always works when I refer to the file name only. I've tried everything I can think of in VBA, I've changed the macro security settings to enable just about everything, but it makes no difference.</p>\n\n<p>I tried: </p>\n\n<pre><code>ThisWorkbook.UpdateLink\n</code></pre>\n\n<p>But all I get is runtime error 1004: Method 'UpdateLink' of object '_Workbook' failed.</p>\n"}, {"tags": ["vba", "excel", "scope", "global-variables", "public"], "comments": [{"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1440588949, "post_id": 32224871, "comment_id": 52333552, "body": "Try using the code cleaner by AppsPro: <a href=\"http://www.appspro.com/Utilities/CodeCleaner.htm\" rel=\"nofollow noreferrer\">appspro.com/Utilities/CodeCleaner.htm</a>"}, {"owner": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "reply_to_user": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "edited": false, "score": 0, "creation_date": 1440590098, "post_id": 32224871, "comment_id": 52334301, "body": "I&#39;ve determined that whatever this is, it&#39;s at the office-wide application level, as opposed to my code."}], "answers": [{"tags": [], "owner": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1440610861, "creation_date": 1440610861, "answer_id": 32233222, "question_id": 32224871, "link": "https://stackoverflow.com/questions/32224871/all-public-variables-in-my-entire-office-suddenly-stopped-working-this-morning/32233222#32233222", "title": "All Public Variables in my entire office suddenly stopped working this morning", "body": "<p><strong>What happened:</strong> I opened up a macro this morning to work on expanding it. I ran it to check it was still working. it threw an \"automation error\".  </p>\n\n<p>[side note](I've always been used to being able to see my global variables in my locals window. In a nice pull down tab under the module name. It turns out, that only happens when you publicly declare them in the module you're viewing. I did not know this, and my new macro has all my public variables in their own separate module)[return]  </p>\n\n<p>So, I debugged my code, had a look for why this worksheet object was throwing an error and saw: <code>&lt;No Variables&gt;</code> in my locals window where my public variables always used to be. Naturally, I panicked. I figured the program must've stopped referencing public variables in other modules. I checked all the other computers in my office, same thing. I frantically searched the internet. Nothing on this. In desparation, I turned to Stack Overflow and Server Fault and Super User and the chat room at Code Review. No luck. </p>\n\n<p><strong>Then I really panicked. I willingly phoned Microsoft tech support.</strong></p>\n\n<p>Needless to say, this went so badly that I gave up. Went away for a bit and took out my frustrations on an empty floor of our building with my katana (LARP safe, so no actual damage to the building).</p>\n\n<p>Then I came back, went back to chat, talked to some more people, tried some more stuff and finally found out the thing about the locals window, which allowed me to find the actual problem with my code: </p>\n\n<p>My macro was closing a workbook before a point in the code where I was trying to reference its worksheets. That was it.</p>\n\n<p><strong>In all, I wasted an entire workday trying to fix a problem that didn't exist.</strong></p>\n\n<p><strong>So, here's a list of things I could have done / should have been doing that would have prevented this:</strong></p>\n\n<p><strong>Version Control:</strong> Specifically, being able to revert code to a previous point in time when it was known to be working. This would have immediately demonstrated that my code from e.g. the day before still ran as expected.</p>\n\n<p><strong>The Watch Window:</strong> in the VBA IDE this allows you to specify variables and track their status throughout the entire macro. this would have shown me that my variable still existed, it was still being referenced, it just suddenly got emptied at a point in the code.</p>\n\n<p><strong>Actually running the old macros:</strong> Because I thought the locals window showed public variables too, and they weren't there. all I did on other computers was step into a macro, see that they weren't there, and assumed the worst. If I had actually just run any of my macros from even a day before, this problem would have been averted.</p>\n\n<p><strong>TDD / Unit Testing:</strong> Would've caught my mistake almost the moment I introduced it, and certainly within minutes of writing it, which would have provided a big hint about what had gone wrong and prevented this whole thing before it even started.</p>\n\n<p><strong>Not Panicking:</strong> I forgot / didn't try a lot of really obvious things, any one of which would have proved my theory wrong. Instead, because I thought I had a problem, I went looking only for evidence that would confirm it, not for evidence that would disprove it.</p>\n\n<p>On the plus side, at least I am now much wiser than I was this morning.</p>\n"}], "owner": {"reputation": 1316, "user_id": 4169411, "user_type": "registered", "accept_rate": 82, "profile_image": "https://graph.facebook.com/724127205/picture?type=large", "display_name": "Kaz", "link": "https://stackoverflow.com/users/4169411/kaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 32233222, "answer_count": 1, "score": 0, "last_activity_date": 1440611148, "creation_date": 1440586882, "last_edit_date": 1440611148, "question_id": 32224871, "link": "https://stackoverflow.com/questions/32224871/all-public-variables-in-my-entire-office-suddenly-stopped-working-this-morning", "title": "All Public Variables in my entire office suddenly stopped working this morning", "body": "<p><strong>It turns out, I'm an idiot (or, at least, hopelessly inexperienced with this whole software development thing)</strong>. The below is what I spent my whole day panicking about. I'll write an answer detailing what I saw, what actions followed and what was actually going on.  </p>\n\n<p><strong>tl;dr:</strong> How I <em>thought</em> my IDE works and how it <em>actually</em> works are 2 separate things. There was, actually a bug in my code, but because of how I interpreted what I thought my IDE was telling me, I thought the problem was a much bigger one. And I'm an idiot for still not having implemented version control yet.</p>\n\n<p><strong>What I wrote Earlier:</strong></p>\n\n<p>The problem is bigger than I thought. As of right now, every piece of VBA code (including code that has been untouched for days/weeks/months) on every computer in my office (that I have checked so far [4]) is exhibiting this behaviour. </p>\n\n<p>Public variables <code>public variable as type</code> declared in a module are not appearing in other modules. Specifically, the locals window shows <code>&lt;No Variables&gt;</code>. As best I can tell, this occured sometime between 9pm GMT yesterday (25/August/2015) and 11am GMT this morning (26/august/2015).</p>\n\n<p>This has rendered inoperable most of the macros I've written in the past year. Please help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1440586076, "post_id": 32224520, "comment_id": 52331628, "body": "Instead of <code>Rng.Find...</code> use  <code>Rows(5).Find</code>.  Replace 5 with a variable or a range as necessary. Alternative, <code>Set Rng = Rows(5)</code> <code>Rng.Find...</code>  <code>Rows()</code> and <code>Columns()</code> are sub-types of <code>Range</code>."}], "answers": [{"tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1440586282, "creation_date": 1440586282, "answer_id": 32224660, "question_id": 32224520, "link": "https://stackoverflow.com/questions/32224520/excel-vba-limiting-a-search-or-using-find-within-a-single-row-or-a-range-of-r/32224660#32224660", "title": "Excel VBA Limiting a search (or using Find) within a single row, or a range of rows", "body": "<p>The <code>Find()</code> method should be qualified with a valid <code>Range</code> object. Rows and Columns are just a collection of cells and are therefore valid range objects too:</p>\n\n<pre><code>Sub Foo()\n\nDim foundMe As Excel.Range\nSet foundMe = Rows(1).Find(\"Bar\") '// Searches row 1 for \"Bar\"\n\nMsgBox foundMe.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 5244494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5557c477937e0ecca3f9885c31b3bc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Cats and Dogs", "link": "https://stackoverflow.com/users/5244494/cats-and-dogs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1581, "favorite_count": 0, "accepted_answer_id": 32224660, "answer_count": 1, "score": 2, "last_activity_date": 1440586282, "creation_date": 1440585908, "last_edit_date": 1531164843, "question_id": 32224520, "link": "https://stackoverflow.com/questions/32224520/excel-vba-limiting-a-search-or-using-find-within-a-single-row-or-a-range-of-r", "title": "Excel VBA Limiting a search (or using Find) within a single row, or a range of rows", "body": "<p><br>\nI know that I can limit a find to within specified columns using Range, but can I do the same with rows?<br>\n<br>\nI'm looking for specific data that can be found in a certain row and don't wish to slow my search process by allowing the scan of the entire sheet.<br>\nHow to go about it?</p>\n"}, {"tags": ["mysql", "sql", "sql-server", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5177436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0a87869c0a8da8f9050d8516118298?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam", "link": "https://stackoverflow.com/users/5177436/nizam"}, "edited": false, "score": 0, "creation_date": 1440587522, "post_id": 32224476, "comment_id": 52332633, "body": "Hi Jeeped, Thanks for the reply, Still I am getting the error message like &quot;Run-time Error &#39;1004&#39;     &quot;Application-defined or object-defined error&quot;  --Please do the needful.."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1440585784, "creation_date": 1440585784, "answer_id": 32224476, "question_id": 32224384, "link": "https://stackoverflow.com/questions/32224384/how-to-define-cell-excel-cell-reference-as-a-parameter-in-sql-query-on-vba/32224476#32224476", "title": "how to define cell excel cell reference as a parameter in SQL query on VBA?", "body": "<p>Typically, an employee's name is a text string. You should be able to combine single quotes (aka 'ticks') with the double quotes wrapped around your entire SQL statement in order that you do not have to deal with quotes inside quotes strings.</p>\n\n<pre><code>query = \"SELECT DISTINCT [Client Name] FROM [Execution Report$] WHERE [Employee Name] LIKE '\" &amp; Sheets(\"PDA\").Range(C3).value &amp; \"';\"\n</code></pre>\n\n<p>With <em>Bob</em> in Sheets(\"PDA\").Range(C3), this should read as,</p>\n\n<pre><code>SELECT DISTINCT [Client Name] FROM [Execution Report$] WHERE [Employee Name] LIKE 'Bob';\n</code></pre>\n\n<p>I usually 'pattern match' with the LIKE operator but for all intents and purposes, LIKE is the same as equals.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5177436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0a87869c0a8da8f9050d8516118298?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam", "link": "https://stackoverflow.com/users/5177436/nizam"}, "edited": false, "score": 0, "creation_date": 1440600403, "post_id": 32228078, "comment_id": 52342037, "body": "Hi Thanks for the reply, Still I am getting error message as &quot;Run-time error &#39;9&#39;: Subscript out of range&quot;. Please check"}, {"owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "reply_to_user": {"reputation": 1, "user_id": 5177436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0a87869c0a8da8f9050d8516118298?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam", "link": "https://stackoverflow.com/users/5177436/nizam"}, "edited": false, "score": 0, "creation_date": 1440609638, "post_id": 32228078, "comment_id": 52348079, "body": "@Nizam I caught it the second time. Your <code>Range</code> syntax is also wrong. It should be <code>Range(&quot;C3&quot;).Value</code> (notice the double quotations around the cell). If you incorporate that into my initial suggestion, it should work.  Let us know."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 0, "last_activity_date": 1440595901, "creation_date": 1440595901, "answer_id": 32228078, "question_id": 32224384, "link": "https://stackoverflow.com/questions/32224384/how-to-define-cell-excel-cell-reference-as-a-parameter-in-sql-query-on-vba/32228078#32228078", "title": "how to define cell excel cell reference as a parameter in SQL query on VBA?", "body": "<p>You are passing the query as a string. As it stands now, your query looks like this (assuming the name in cell C3 is <code>Tom Smith</code>:</p>\n\n<pre><code>SELECT DISTINCT [Client Name] FROM [Execution Report$] WHERE\n [Employee Name] = Tom Smith\n</code></pre>\n\n<p>Looking at that, you can probably see that it would fail in SQL because it should read (take note of the single quotes around the name): </p>\n\n<pre><code>SELECT DISTINCT [Client Name] FROM [Execution Report$] WHERE\n [Employee Name] = 'Tom Smith'\n</code></pre>\n\n<p>So, change the <code>query</code> declaration to:</p>\n\n<pre><code> query = \"SELECT DISTINCT [Client Name] FROM [Execution Report$] WHERE\n [Employee Name] ='\" &amp; Sheets(\"PDA\").Range(C3).value &amp; \"'\"\n</code></pre>\n\n<p>Does that fix the problem?</p>\n"}], "owner": {"reputation": 1, "user_id": 5177436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a0a87869c0a8da8f9050d8516118298?s=128&d=identicon&r=PG&f=1", "display_name": "Nizam", "link": "https://stackoverflow.com/users/5177436/nizam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 32228078, "answer_count": 2, "score": 0, "last_activity_date": 1440595901, "creation_date": 1440585547, "last_edit_date": 1531161705, "question_id": 32224384, "link": "https://stackoverflow.com/questions/32224384/how-to-define-cell-excel-cell-reference-as-a-parameter-in-sql-query-on-vba", "title": "how to define cell excel cell reference as a parameter in SQL query on VBA?", "body": "<p>It would be great if someone helps on this.</p>\n\n<p>I would like to provide cell reference from seperate sheet as a parameter in Where query I mean instead of a string \"Arunraj S\", I need to give reference from the range (\"c3\") of sheet1(\"PDA\").</p>\n\n<p>It is retrieving fine while giving the direct string through where query. </p>\n\n<p>But It's throwing syntax error when I tried to change the query like below;</p>\n\n<pre><code> query = \"SELECT DISTINCT [Client Name] FROM [Execution Report$] WHERE\n [Employee Name] =\" &amp; Sheets(\"PDA\").Range(C3).value\n</code></pre>\n\n<p>Here is my code :</p>\n\n<pre><code>Sub Pull_Data_from_Excel_with_ADODB()\n\n    Dim cnStr As String\n    Dim rs As ADODB.Recordset\n    Dim query As String\n\n    Dim fileName As String\n    fileName = \"C:\\Users\\nizamudeen.s\\Desktop\\PDA Template.xlsx\"\n\n\n    cnStr = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n               \"Data Source=\" &amp; fileName &amp; \";\" &amp; _\n               \"Extended Properties=Excel 12.0\"\n\n        query = \"SELECT DISTINCT [Client Name] FROM [Execution Report$] WHERE [Employee Name] = 'Arunraj S';\"\n\n\n            Set rs = New ADODB.Recordset\n    rs.Open query, cnStr, adOpenUnspecified, adLockUnspecified\n\n        Cells.Clear\n    Range(\"A2\").CopyFromRecordset rs\n    Dim cell As Range, i As Long\n        With Range(\"A1\").CurrentRegion\n        For i = 0 To rs.Fields.Count - 1\n            .Cells(1, i + 1).Value = rs.Fields(i).Name\n        Next i\n        .EntireColumn.AutoFit\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["image", "vba", "excel", "email"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440585490, "post_id": 32223633, "comment_id": 52331244, "body": "Add the file as an attachment and change the image source to the image file only: <code>&lt;img src=&#39;test.jpg&#39;&gt;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4227507"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440585640, "post_id": 32223633, "comment_id": 52331345, "body": "But I want the image to be in the body of the email so that it is seen when the email is opened, rather than as an attachment"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4227507"}, "edited": false, "score": 0, "creation_date": 1440593392, "post_id": 32224724, "comment_id": 52336655, "body": "Thanks for your suggestion, but that still has the same issue. It does not come up as an attachment (which is good) but in the email I don&#39;t see the image but the &quot;image cannot be displayed&quot; icon"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440593910, "post_id": 32224724, "comment_id": 52337098, "body": "Then there might be a problem with your Outlook. The code works perfectly fine for. Actually, I am using this already for years now and have used it at multiple international corporations (even in a Citrix server-farm setup). Make sure you have switched in Outlook the HTML-View on. Also, some international setups require two quotation marks <code>&quot;&quot;</code> instead of one apostrophe <code>&#39;</code>. This would yield <code>.HTMLBODY = .HTMLBODY + &quot;&lt;img src=&quot;&quot;test.jpg&quot;&quot;&gt;&quot;</code>. Other than that there is nothing I can think of."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4227507"}, "edited": false, "score": 0, "creation_date": 1440600905, "post_id": 32224724, "comment_id": 52342437, "body": "I&#39;ve tried this and it still isn&#39;t working, it&#39;s worth noting that if I just use the line <code>.Attachments.Add &quot;C:\\Users\\asfadsf\\Documents\\test.jpg&quot;1</code> and comment the line below out then I get the image attached, but if I uncomment the line below and use both it is not attached or shown."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440601220, "post_id": 32224724, "comment_id": 52342666, "body": "In this case you might want to continue trouble shooting using this line <code>.HTMLBODY = .HTMLBODY + &quot;&lt;img src=&quot;&quot;test.jpg&quot;&quot; alt=&quot;&quot;The picture is attached but cannot be displayed in the body of this email.&quot;&quot;&gt;&quot;</code>. This website might be able to help you do some more trouble shooting. <a href=\"http://www.w3schools.com/html/html_images.asp\" rel=\"nofollow noreferrer\">w3schools.com/html/html_images.asp</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4227507"}, "edited": false, "score": 0, "creation_date": 1440601403, "post_id": 32224724, "comment_id": 52342800, "body": "I now get the image attached and the same icon below, but no alternative text"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440601679, "post_id": 32224724, "comment_id": 52342996, "body": "Sounds like a typo. Are there any special characters in the name of the picture? Are there leading white spaces in the name of the file? Make sure that the file name is <b>exactly</b> the same within the source tags. You can also add a leading <code>.\\ </code> to the source like so: <code>.HTMLBODY = .HTMLBODY + &quot; &lt;img src=&quot;&quot;.\\test.jpg&quot;&quot;&gt;&quot; </code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4227507"}, "edited": false, "score": 0, "creation_date": 1440601745, "post_id": 32224724, "comment_id": 52343052, "body": "It is exactly the same, to be sure I have even copied and pasted the name from the attachment line which works but it still doesn&#39;t work"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440602683, "post_id": 32224724, "comment_id": 52343717, "body": "Create in Outlook an email with a picture in it (as you intend to do it). Then go into the VBE for Outlook at in the <code>direct window</code> type <code>? ActiveInspector.CurrentItem.HTMLbody</code>. Then Outlook will show you want it wants / expects as HTML source code to show the attachment within the body of the email. Sometimes it is <code>? ActiveExplorer.Selection.Item(1).HTMLbody</code> instead."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4227507"}, "edited": false, "score": 0, "creation_date": 1440605559, "post_id": 32224724, "comment_id": 52345697, "body": "Sorry for being a pain, but I haven&#39;t really used VBA in outlook much before. Can you please explain to me where to put the code <code>? ActiveInspector.CurrentItem.HTMLbody</code> and how I can get there?"}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440605608, "post_id": 32224724, "comment_id": 52345734, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/88023/discussion-between-ralph-and-benjs-1\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1440590706, "last_edit_date": 1440590706, "creation_date": 1440586453, "answer_id": 32224724, "question_id": 32223633, "link": "https://stackoverflow.com/questions/32223633/vba-excel-how-can-i-send-an-image-saved-in-excel-on-my-hard-drive-in-an-email/32224724#32224724", "title": "VBA Excel: How can I send an image saved in Excel on my hard drive in an email?", "body": "<p>Maybe these two lines I changed / added are better than the two lines of comment above to illustrate what I mean:</p>\n\n<pre><code> With objMail\n         .To = PrimaryRecipients\n         .Cc = SecondaryRecipients\n         .Subject = \"Information: \" &amp; RecipientNumber &amp; \" Updated Profiler\"\n\n         Dim Greeting As String\n         If Time &gt;= #12:00:00 PM# Then\n             Greeting = \"Afternoon\"\n         Else\n             Greeting = \"Morning\"\n         End If\n\n         Dim LastMonth As String\n         LastMonth = MonthName((Month(Date)) - 1)\n\n         Dim InsertImage As String\n         InsertImage = \"&lt;img src='\" &amp; FileLocation &amp; \"'&gt;\"\n\n         .HTMLBODY = \"&lt;font face=Arial&gt;&lt;p&gt;\" &amp; \"Good \" &amp; Greeting &amp; \" \" &amp; To_Name &amp; \",\" &amp; \"&lt;/p&gt;\"\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Email text.\" &amp; \"&lt;/p&gt;\"\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Email text.\" &amp; \"&lt;/p&gt;\"\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Email text.\" &amp; \"&lt;/p&gt;\"\n        ' .HTMLBODY = .HTMLBODY + RangetoHTML(rng)\n         .HTMLBODY = .HTMLBODY + InsertImage\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Kind Regards\" &amp; \"&lt;br&gt;\"\n         .Attachments.Add \"C:\\Users\\asfadsf\\Documents\\test.jpg\"\n         .HTMLBODY = .HTMLBODY + \"&lt;img src='test.jpg'&gt;\"\n         .Send\n       End With\n</code></pre>\n\n<p>The only thing I actually changed is this:</p>\n\n<pre><code> .Attachments.Add \"C:\\Users\\asfadsf\\Documents\\test.jpg\"\n .HTMLBODY = .HTMLBODY + \"&lt;img src='test.jpg'&gt;\"\n</code></pre>\n\n<p>You'll note that you don't see test.jpg as an attachment anymore but rather directly displayed in the body of the email.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4227507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440590706, "creation_date": 1440583565, "last_edit_date": 1440583906, "question_id": 32223633, "link": "https://stackoverflow.com/questions/32223633/vba-excel-how-can-i-send-an-image-saved-in-excel-on-my-hard-drive-in-an-email", "title": "VBA Excel: How can I send an image saved in Excel on my hard drive in an email?", "body": "<p>I have some code that copies cells from Excel, pastes them as a picture, saves the picture, and then sends an email with that picture in it's body. The problem is that because the image gets saved on my hard drive, when it gets sent out to the recipients cannot see the image. Is there a way  of getting around this?</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Sub Email()\n\nDim objOutlook As Object\nDim objMail As Object\nDim TempFilePath As String\nDim Location As String\nDim RecipientNumber As String\nDim rng As Range\nDim PrimaryRecipients As String\nDim SecondaryRecipients As String\nDim To_Name As String\n\n\n\nWorksheets(\"Contacts\").Activate\nRange(\"A2\").Select\n\nWhile ActiveCell &lt;&gt; \"\" And ActiveCell &lt;&gt; \"0\"\n\n    Set objOutlook = CreateObject(\"Outlook.Application\")\n    Set objMail = objOutlook.CreateItem(0)\n\n     ActiveCell.Offset(1, 0).Select\n     RecipientNumber = ActiveCell.Value\n     To_Name = ActiveCell.Offset(0, 4).Value\n     If To_Name = \"\" Or To_Name = \"0\" Then\n         To_Name = ActiveCell.Offset(0, 7).Value\n\n\n     Worksheets(\"Output 2\").Activate\n     Range(\"C2\").Value = RecipientNumber \n\n     Dim objChart As Chart\n     Call ActiveSheet.Range(\"A1:M28\").CopyPicture(xlScreen, xlPicture)\n     Sheets.Add.Name = \"Without Formatting\"\n     Worksheets(\"Without Formatting\").Shapes.AddChart\n     Worksheets(\"Without Formatting\").Activate\n     ActiveSheet.Shapes.Item(1).Select\n     Set objChart = ActiveChart\n     objChart.Paste\n\n     With ActiveChart.Parent\n      .Height = 300 ' resize\n      .Width = 750  ' resize\n      .Top = 100    ' reposition\n      .Left = 100   ' reposition\n      End With\n\n      Dim DayForLocation As String\n      Dim MonthForLocation As String\n      Dim YearForLocation As String\n      Dim DateForLocation As String\n      DayForLocation = Day(Now)\n      MonthForLocation = Month(Now)\n      YearForLocation = Year(Now)\n      DateForLocation = YearForLocation &amp; MonthForLocation &amp; DayForLocation\n\n      Dim FileLocation As String\n      FileLocation = \"C:\\Users\\asfadsf\\Documents\\\" &amp; DateForLocation\n\n      If Dir(\"C:\\Users\\asfadsf\\Documents\\\" &amp; DateForLocation) &lt;&gt; \"\" Then\n          MkDir (\"C:\\Users\\asfadsf\\Documents\\\" &amp; DateForLocation)\n      End If\n      FileLocation = FileLocation &amp; RecipientNumber &amp; \".jpeg\"\n      objChart.Export (FileLocation)\n\n      Set rng = ActiveSheet.Range(\"A1:M28\").Rows.SpecialCells(xlCellTypeVisible)\n      If rng Is Nothing Then\n          MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n                 vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n          Exit Sub\n      End If\n\n      'Keep_Format\n\n      With objMail\n         .To = PrimaryRecipients\n         .Cc = SecondaryRecipients\n         .Subject = \"Information: \" &amp; RecipientNumber &amp; \" Updated Profiler\"\n\n         Dim Greeting As String\n         If Time &gt;= #12:00:00 PM# Then\n             Greeting = \"Afternoon\"\n         Else\n             Greeting = \"Morning\"\n         End If\n\n         Dim LastMonth As String\n         LastMonth = MonthName((Month(Date)) - 1)\n\n         Dim InsertImage As String\n         InsertImage = \"&lt;img src='\" &amp; FileLocation &amp; \"'&gt;\"\n\n         .HTMLBODY = \"&lt;font face=Arial&gt;&lt;p&gt;\" &amp; \"Good \" &amp; Greeting &amp; \" \" &amp; To_Name &amp; \",\" &amp; \"&lt;/p&gt;\"\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Email text.\" &amp; \"&lt;/p&gt;\"\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Email text.\" &amp; \"&lt;/p&gt;\"\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Email text.\" &amp; \"&lt;/p&gt;\"\n        ' .HTMLBODY = .HTMLBODY + RangetoHTML(rng)\n         .HTMLBODY = .HTMLBODY + InsertImage\n         .HTMLBODY = .HTMLBODY + \"&lt;p&gt;\" &amp; \"Kind Regards\" &amp; \"&lt;br&gt;\"\n         .HTMLBODY = .HTMLBODY + \"&lt;img src='C:\\Users\\asfadsf\\Documents\\test.jpg'&gt;\"\n         .Send\n       End With\n       Worksheets(\"Contacts\").Activate\n       Application.DisplayAlerts = False\n       Sheets(\"Without Formatting\").Delete\n       Application.DisplayAlerts = True\nWend\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\nSet objOutlook = Nothing\nSet objMail = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>This is quite an issue, can someone please help?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1440583461, "post_id": 32223391, "comment_id": 52329905, "body": "do you also have a loop around your if-condition?"}, {"owner": {"reputation": 8753, "user_id": 185547, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/3iVy4.jpg?s=128&g=1", "display_name": "MikeD", "link": "https://stackoverflow.com/users/185547/miked"}, "edited": false, "score": 0, "creation_date": 1440768256, "post_id": 32223391, "comment_id": 52423035, "body": "if this is a one-off activity, consider to define auto filters, search for yahoo and delete all/some of the displayed/filtered rows"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1440583650, "post_id": 32223546, "comment_id": 52330043, "body": "it throwing an error as &quot;type mismatch&quot;. Is there any other alternative code"}, {"owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1440599292, "post_id": 32223546, "comment_id": 52341250, "body": "could you please explain the part of inside &quot;if statement&quot;. what exactly it do?"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "reply_to_user": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "edited": false, "score": 0, "creation_date": 1440599921, "post_id": 32223546, "comment_id": 52341667, "body": "search for the string &quot;@yahoo.com&quot; within the variable <code>UserName</code> start at the character position <code>1</code> and compare text only (no ascii code, no case sensitivity). Return is the character position where the search string <code>&quot;@yahoo.com&quot;</code> starts. If return value &gt; 0 =&gt; search string found. you can find the information here too: &lt;<a href=\"http://www.techonthenet.com/excel/formulas/instr.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/instr.php</a>&gt;"}], "tags": [], "owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "is_accepted": true, "score": 0, "last_activity_date": 1440584866, "last_edit_date": 1440584866, "creation_date": 1440583312, "answer_id": 32223546, "question_id": 32223391, "link": "https://stackoverflow.com/questions/32223391/search-part-of-string-in-a-column-and-delete-the-row-in-vba-code/32223546#32223546", "title": "Search part of string in a column and delete the row in vba code", "body": "<p>you have to use <code>instr</code> without your wildcards. Everything in \"\" is considered as part of the searchstring</p>\n\n<p>you do also require a loop. take this code, it's working for your problem.</p>\n\n<pre><code>Lastrow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor row_number = Lastrow To 1 Step -1\n    UserName = Sheets(\"sheet1\").Range(\"C\" &amp; row_number).Value\n    If InStr(1, UserName, \"@yahoo.com\", vbTextCompare) &gt; 0 Then\n       Sheets(\"sheet1\").Rows(row_number &amp; \":\" &amp; row_number).Delete           \n    End If\nNext row_number\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5247300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/a6b8dc977772caf6c7baec74aeebed10?s=128&d=identicon&r=PG&f=1", "display_name": "sreekanth", "link": "https://stackoverflow.com/users/5247300/sreekanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 32223546, "answer_count": 1, "score": 0, "last_activity_date": 1440584866, "creation_date": 1440582889, "last_edit_date": 1531164843, "question_id": 32223391, "link": "https://stackoverflow.com/questions/32223391/search-part-of-string-in-a-column-and-delete-the-row-in-vba-code", "title": "Search part of string in a column and delete the row in vba code", "body": "<p>I am searching for the part of the string and based on only the part of string it must delete the row.\nI have more than 10000 rows.please consider that and write the code\nThe sample data:</p>\n\n<pre><code>      A               B                C\n    Fname            Lname            Username\n1. Thomas            Frauen           thomas@gmail.com\n2. anne              schmidt          anne@rediff.com\n3. olaf              geissler         olaf@yahoo.com\n</code></pre>\n\n<p>I Know only the username string part i.e \"@yahoo.com\" . Would like to delete the row 3.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>lastRow = Cells(Rows.Count, 1).End(xlUp).Row\nrow_number = 1\n\nusername = sheets(\"sheet1\").Range(\"C\" &amp; row_number)\n\nif instr(username, \"*@yahoo.com*\") = true then\n   Sheets(\"sheet1\").Rows(row_number &amp; \":\" &amp; row_number).Delete\n   row_number = row_number - 1\nEnd If\n</code></pre>\n\n<p>can anyone help me out, pls.</p>\n"}, {"tags": ["excel", "xlsx", "vba"], "comments": [{"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1440585017, "post_id": 32223241, "comment_id": 52330952, "body": "If you save it as <code>.xlsx</code> then you are removing all VBA from the file. Try <code>.xls</code> instead. Alternatively, you can also save it with an invalid extension (for example <code>.xly</code>) and say in the email that they should change it."}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1440586661, "creation_date": 1440586661, "answer_id": 32224791, "question_id": 32223241, "link": "https://stackoverflow.com/questions/32223241/change-excel-file-extension-when-submitting-form/32224791#32224791", "title": "change excel file extension when submitting form", "body": "<p>The <code>SaveAs</code> method, unlike the <code>SaveCopyAs</code> method has an optional parameter for <code>FileFormat</code> (see <a href=\"http://www.rondebruin.nl/mac/mac020.htm\" rel=\"nofollow\">this</a> for a discussion). The following sub, which you can perhaps modify for your purposes, will, when run from a <code>.xlsm</code> file save a macro-free copy of the file with the same name (but with <code>.xlsx</code> instead of <code>.xlsm</code>) in the same directory as the file that contains the macro. It doesn't delete the <code>.xlsm</code> file -- though you might want to make sure that any work is saved before running this:</p>\n\n<pre><code>Sub StripMacros()\n    Dim fname As String\n    fname = ActiveWorkbook.FullName\n    fname = Replace(fname, \".xlsm\", \".xlsx\")\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs Filename:=fname, FileFormat:=xlOpenXMLWorkbook\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5267852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2821ff0a8afb48855fcb3f9eaf566f?s=128&d=identicon&r=PG&f=1", "display_name": "clivers", "link": "https://stackoverflow.com/users/5267852/clivers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440586661, "creation_date": 1440582449, "last_edit_date": 1531161705, "question_id": 32223241, "link": "https://stackoverflow.com/questions/32223241/change-excel-file-extension-when-submitting-form", "title": "change excel file extension when submitting form", "body": "<p>I have a form for users to submit a request for small moves, adds, changes etc.</p>\n\n<p>It has worked brilliantly for me for the last couple of years but now any external customers cannot use it because our corporate mail blocks .xlsm extensions.</p>\n\n<p>Clearly I need to use .xlsm to create the file but I need to change it to a .xlsx for the purposes of mailing it to me.</p>\n\n<p>THe code I am currently using is below. Can anyone help me modify it to change the extension to .xlsx?</p>\n\n<p><code>Sub Mail_workbook_Outlook_3()</code></p>\n\n<pre><code>Dim wb1 As Workbook\nDim wb2 As Workbook\nDim TempFilePath As String\nDim TempFileName As String\nDim FileExtStr As String\nDim Site As String\nDim ChangeType As String\nDim OutApp As Object\nDim OutMail As Object\nDim Requestor As String\nDim implementationDate As String\nDim notice As String\n\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\nSet wb1 = ActiveWorkbook\n\nSite = Range(\"d21\").Text\nChangeType = Range(\"D11\").Text\nRequestor = Range(\"d13\")\nimplementationDate = Range(\"n10\")\nnotice = DateDiff(\"d\", Now, implementationDate)\n\nTempFilePath = Environ$(\"temp\") &amp; \"\\\"\nTempFileName = \"SMAC Request \" &amp; \"Logged on \" &amp; Format(Now, \"dd-mmm-yy h-mm-ss\")\nFileExtStr = \".\" &amp; LCase(Right(wb1.Name, Len(wb1.Name) - InStrRev(wb1.Name, \".\", , 1)))\nwb1.SaveCopyAs TempFilePath &amp; TempFileName &amp; FileExtStr\nSet wb2 = Workbooks.Open(TempFilePath &amp; TempFileName &amp; FileExtStr)\n</code></pre>\n\n<p>I tried using the following line to change it but it throws an error saying Excel cannot open the file because the file format or extension is not valid, verify that the extension matches the format of the file. </p>\n\n<p><code>'FileExtStr = \".xlsx\": FileFormatNum = 51</code></p>\n\n<p>All help appreciated</p>\n"}, {"tags": ["excel", "vba", "odbc", "dsn"], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1440595220, "creation_date": 1440595220, "answer_id": 32227819, "question_id": 32222965, "link": "https://stackoverflow.com/questions/32222965/how-can-i-use-a-dsn-file-in-a-vba-connection-script/32227819#32227819", "title": "How can I use a DSN File in a VBA Connection Script?", "body": "<p>You can use the <code>File Name</code> qualifier to specify a <code>UDL</code> or <code>DSN</code> file. For example:</p>\n\n<pre><code>cn.Open \"File Name=c:\\path\\to\\my.dsn;\"\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5267717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c594d101ca089ee8f585567fe5e0e534?s=128&d=identicon&r=PG&f=1", "display_name": "Dauntless", "link": "https://stackoverflow.com/users/5267717/dauntless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6663, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1440762441, "creation_date": 1440581688, "last_edit_date": 1440762441, "question_id": 32222965, "link": "https://stackoverflow.com/questions/32222965/how-can-i-use-a-dsn-file-in-a-vba-connection-script", "title": "How can I use a DSN File in a VBA Connection Script?", "body": "<p>I have VBA code that uses a connection string to talk to an SQL Server. I would like to use an external DSN file for this connection, purely for the adaptability.</p>\n\n<p>The current code:</p>\n\n<pre><code>Set cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nstrConn = \"DRIVER=SQLServer;SERVER=x;APP=Microsoft Excel;DATABASE=x;Trusted_Connection=Yes\"\ncn.Open strConn\n</code></pre>\n\n<p>The code works, but for our users a dsn file would be more appropriate.</p>\n\n<p>The .DSN File:</p>\n\n<pre><code>[ODBC]\nDRIVER=SQL Server\nDatabase=x\nAPP=Microsoft Office 2013\nTrusted Connection=Yes\nSERVER=x\nDescription=x\n</code></pre>\n"}, {"tags": ["excel", "sorting", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440582121, "post_id": 32222686, "comment_id": 52328901, "body": "On the worksheet you would use a helper column. In VBA, you will have to put it into an array, split each element of the array into the largest number of pieces that any element has and then sort the arrays of arrays and put it back into the worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440582667, "post_id": 32222686, "comment_id": 52329318, "body": "btw, there is a <code>Header:=xlYes</code> or a <code>Header:=xlNo</code> option. It&#39;s probably not a good idea to let Excel guess since you should know if your data has a header or not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440583011, "post_id": 32222686, "comment_id": 52329558, "body": "Is <code>1</code> and <code>1.1</code> part of the complete series of the mutli-level list? What is the maximum number of &#39;pieces&#39;?"}, {"owner": {"reputation": 31, "user_id": 5267380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153272852963533/picture?type=large", "display_name": "Sumayya Khalid", "link": "https://stackoverflow.com/users/5267380/sumayya-khalid"}, "edited": false, "score": 0, "creation_date": 1440583275, "post_id": 32222686, "comment_id": 52329771, "body": "now my ids will be like 1.1.1 , 1.1.12 no levels, format of my test case ids is such, i tried  helper column it still sorts the same way."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1440584140, "creation_date": 1440584140, "answer_id": 32223856, "question_id": 32222686, "link": "https://stackoverflow.com/questions/32222686/sorting-in-excel-using-sub-sorting-not-proper/32223856#32223856", "title": "Sorting in excel using sub, sorting not proper", "body": "<p>The right formula in a helper column will make quick work of this.</p>\n\n<p>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0<a href=\"https://i.stack.imgur.com/al4ev.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/al4ev.png\" alt=\"Sorting with a Helper Column\"></a></p>\n\n<p>The formula in B2 is,</p>\n\n<pre><code>=TEXT(LEFT(A2, FIND(\".\", A2)-1), \"000\")&amp;TEXT(MID(A2, FIND(\".\", A2)+1, 9), \"000\")&amp;TEXT(MID(A2, FIND(\".\", A2, FIND(\".\", A2)+1)+1, 9), \"000\")\n</code></pre>\n\n<p>Fill down as necessary. This works because there is a static number of 'pieces' to the multi-level ordinals. The formula would be more complicated if it had to accommodate 1, 2 or 3 sections.</p>\n"}], "owner": {"reputation": 31, "user_id": 5267380, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153272852963533/picture?type=large", "display_name": "Sumayya Khalid", "link": "https://stackoverflow.com/users/5267380/sumayya-khalid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1440584140, "creation_date": 1440580902, "last_edit_date": 1531161705, "question_id": 32222686, "link": "https://stackoverflow.com/questions/32222686/sorting-in-excel-using-sub-sorting-not-proper", "title": "Sorting in excel using sub, sorting not proper", "body": "<p>I want to sort a particular column in my sheet which has my test case IDs, \nMy current sort sub (given below) is sorting it like </p>\n\n<pre><code> 1.1.1\n 1.1.12\n 1.1.15\n 1.1.2\n 1.1.22\n 1.1.3\n</code></pre>\n\n<p>is it because it is taking it as alphanumeric data?</p>\n\n<p>how to get it to sort properly like?</p>\n\n<pre><code>1.1.1\n1.1.2\n1.1.3\n1.1.12\n1.1.15\n1.1.22\n</code></pre>\n\n<p>My sub function:</p>\n\n<pre><code>    Function sortSheet(ByVal sheet As Excel.Worksheet)\n    Dim oneRange As Range\n    Dim aCell As Range\n    Dim lastRow As Long, lastCol As Integer\n\n   'Calculating the last row and column\n   lastRow = sheet.Cells(Rows.Count, 1).End(xlUp).row\n   lastCol = sheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n   'Setting the range in which sorting is to be done\n    Set oneRange = sheet.Range(sheet.Cells(2, 1), sheet.Cells(lastRow, lastCol))\n\n   'Setting the range according to which it will be sorted\n    Set aCell = sheet.Range(\"A2\")\n   'Sorting\n    oneRange.Sort Key1:=aCell, Order1:=xlAscending, Header:=xlGuess\n\n    End Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "session", "authentication"], "comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440580794, "post_id": 32222192, "comment_id": 52328008, "body": "There are no credentials in that request code?"}, {"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440580956, "post_id": 32222192, "comment_id": 52328130, "body": "No.  Excel automatically puts them in the HTTP Authentication header after the user fills in the details on the &#39;Windows Security&#39; modal that pops up.  This modal comes &#39;for free&#39; when Excel receives the 401 response. There is a &#39;Remember my credentials&#39; checkbox on this modal, which I do not check."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440581228, "post_id": 32222192, "comment_id": 52328302, "body": "Ah okay, I get what you mean now. I don&#39;t think this is actually Excel - I think this is a system event, not an application event so I don&#39;t think you&#39;re going to find an answer through VBA. AFAIK Excel doesn&#39;t have the facility to store credentials, this is handled by the OS."}, {"owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440583039, "post_id": 32222192, "comment_id": 52329571, "body": "Yeah, I wasn&#39;t sure it was Excel either, more of a Windows thing. The credentials are lost if I close Excel and reopen.  I was hoping I could somehow clear this manually using VBA.  It just seems ridiculous to not provide the user with this windows authentication feature, without providing the ability to clear authentication credentials."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440583338, "post_id": 32222192, "comment_id": 52329824, "body": "I experienced a similar thing not too long ago using SharePoint and VBA. There may be a windows API that could be used or perhaps use windows command line via VBA? Sorry I can&#39;t be of more help! :)"}], "answers": [{"tags": [], "owner": {"reputation": 161, "user_id": 5260805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a405bb9c79d074fe80f5063b5ddd1060?s=128&d=identicon&r=PG&f=1", "display_name": "Roxton", "link": "https://stackoverflow.com/users/5260805/roxton"}, "is_accepted": false, "score": 0, "last_activity_date": 1440764907, "last_edit_date": 1495535199, "creation_date": 1440764907, "answer_id": 32271112, "question_id": 32222192, "link": "https://stackoverflow.com/questions/32222192/how-do-i-tell-excel-vba-to-clear-the-security-credentials/32271112#32271112", "title": "How do I tell Excel/VBA to clear the security credentials?", "body": "<p>From <a href=\"https://stackoverflow.com/a/11615432/5260805\">this answer</a>:</p>\n\n<pre><code>myURL = \"http://my.domain.com/myscript.cgi\"\nDim oHttp As New MSXML2.XMLHTTP\noHttp.Open \"POST\", myURL, False\noHttp.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded'\"\noHttp.setRequestHeader(\u201cCache-Control\u201d, \u201cno-cache\u201d);\noHttp.setRequestHeader(\u201cPragma\u201d, \u201cno-cache\u201d);\noHttp.setRequestHeader(\u201cIf-Modified-Since\u201d, \u201cSat, 1 Jan 2000 00:00:00 GMT\u201d);\noHttp.setRequestHeader \"Authorization\",\"Basic \" &amp; Base64EncodedUsernamePassword\noHttp.send \"PostArg1=PostArg1Value\"\nResult = oHttp.responseText\n</code></pre>\n"}], "owner": {"reputation": 335, "user_id": 1033578, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae83783420d6e6d5baf9b13422f9a0d0?s=128&d=identicon&r=PG", "display_name": "Agent96", "link": "https://stackoverflow.com/users/1033578/agent96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1670, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1440764907, "creation_date": 1440579541, "last_edit_date": 1440585186, "question_id": 32222192, "link": "https://stackoverflow.com/questions/32222192/how-do-i-tell-excel-vba-to-clear-the-security-credentials", "title": "How do I tell Excel/VBA to clear the security credentials?", "body": "<p>I have written a VBA plugin for Excel, which provides login/logout functionality to a server. </p>\n\n<p>The way I have implemented it is to send a request to a URL on the server, which checks if the user has a session, if it does not, the server sends a 401 on the header response (unauthorised).  The 401 response makes Excel automatically pop up the 'windows style' login modal (this comes for free with Excel I guess).  I enter my credentials, and the server authenticates the user, and a session is created.</p>\n\n<p>My problem is now when I try to logout.  The server destroys the session as expected.  If the user now clicks login again, Excel sends a HEAD request to the server, the server responds with a 401, and Excel then automatically sends the same username and password credentials that were entered by the user before.  The user is now logged on again.  Just to be clear - this is NOT server side caching, this is Excel resending login credentials, using Basic Authentication in the HTTP Header, after receiving a 401 response.</p>\n\n<p>This is not the expected behaviour, I would not like Excel to store a copy of the credentials, and reuse them time after time.  If the user logs out, I would like this to be permanent, until they decide to log in again at which time they should re-enter their credentials.</p>\n\n<p>The problem I have is telling Excel/Windows/VBA? to clear whatever it is keeping, wherever it is keeping it.  My problem is, I don't really know what the choreography is on the Excel/VBA side, it's functionality that just seemed to come for free, so I do not know where this is stored.</p>\n\n<p>For what it's worth, here is my VBA</p>\n\n<pre><code> Dim req As MSXML2.XMLHTTP60\n Set req = New MSXML2.XMLHTTP60\n req.Open \"GET\", url, False\n req.send\n</code></pre>\n"}, {"tags": ["html", "excel", "drop-down-menu", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5267488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c17aeedb9a48df14a5cda99d1cba5b?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent K", "link": "https://stackoverflow.com/users/5267488/vincent-k"}, "edited": false, "score": 0, "creation_date": 1440611635, "post_id": 32228523, "comment_id": 52349261, "body": "Hi user3561813, your solution works! Thanks! Gosh it would be easier if it was &lt;select&gt; in HTML."}], "tags": [], "owner": {"reputation": 5345, "user_id": 3561813, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/958afeca6b11ffa0e83b97b516c88dc7?s=128&d=identicon&r=PG&f=1", "display_name": "basodre", "link": "https://stackoverflow.com/users/3561813/basodre"}, "is_accepted": true, "score": 1, "last_activity_date": 1440596974, "creation_date": 1440596974, "answer_id": 32228523, "question_id": 32221907, "link": "https://stackoverflow.com/questions/32221907/selecting-dropdown-list-in-ie-with-vba/32228523#32228523", "title": "Selecting Dropdown list in IE with VBA", "body": "<p>The dropdown isn't a dropdown (as you've mentioned). Instead, it's an unordered list with a number of links as clickable options. With that said, the <code>For Rent</code> option isn't contained in <code>str_listing-btn</code>. Notice how that tag closes before any of the options are available. Instead, it's contained in the list below it.</p>\n\n<p>Since I couldn't get into your link without creating an account, I tested out code to select the <code>For Rent</code> option on the main page. Take a look at my code, test it to see if it does what you need, then try to accommodate it into your code. Let us know if you need additional help.</p>\n\n<pre><code>Sub NavigateIt()\n    Dim oIE As Object\n\n    Set oIE = CreateObject(\"InternetExplorer.Application\")\n    oIE.navigate (\"http://www.propwall.my/classifieds\")\n    oIE.Visible = True\n\n    Do\n        DoEvents\n    Loop Until oIE.ReadyState = 4\n\n    Set AvailableLinks = oIE.document.getelementbyid(\"list-listing\").getelementsbytagname(\"a\")\n\n    For Each cLink In AvailableLinks\n        If cLink.innerhtml = \"For Rent\" Then\n            cLink.Click\n        End If\n    Next cLink\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530551090, "creation_date": 1530551090, "answer_id": 51140768, "question_id": 32221907, "link": "https://stackoverflow.com/questions/32221907/selecting-dropdown-list-in-ie-with-vba/51140768#51140768", "title": "Selecting Dropdown list in IE with VBA", "body": "<p><strong>CSS selector:</strong></p>\n\n<p>You could have used a CSS selector e.g.</p>\n\n<pre><code>a[data-value=For Sale] or a[data-value=For Rent]\n</code></pre>\n\n<p>This says first element with <code>a</code> tag that has attribute <code>data-value</code> whose value is <code>'For Sale'</code>; Or, <code>'For Rent'</code> in the subsequent example.</p>\n\n<hr>\n\n<p><strong>CSS query:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/xtVja.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xtVja.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p><strong>VBA:</strong></p>\n\n<p>You apply the CSS selector using the querySelector method of document</p>\n\n<pre><code>objIE1.Document.querySelector(\"a[data-value=For Sale]\").Click\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5267488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c17aeedb9a48df14a5cda99d1cba5b?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent K", "link": "https://stackoverflow.com/users/5267488/vincent-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15240, "favorite_count": 2, "accepted_answer_id": 32228523, "answer_count": 2, "score": 0, "last_activity_date": 1530551090, "creation_date": 1440578717, "last_edit_date": 1531164843, "question_id": 32221907, "link": "https://stackoverflow.com/questions/32221907/selecting-dropdown-list-in-ie-with-vba", "title": "Selecting Dropdown list in IE with VBA", "body": "<p>I have been trying to select a drop down list in a web page using VBA, which I'm new to. In HTML the drop down menu is stated as <strong>Button</strong> and not <strong>Select</strong>. Here is the HTML code:</p>\n\n<pre><code>&lt;span class='btn-group'&gt;\n  &lt;button id='str_listing-btn' name='str_listing-btn' type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown' data-value='For Sale'&gt;\n    For Sale\n    &lt;span class='caret' style='margin-left:5px;'&gt;\n    &lt;/span&gt;\n  &lt;/button&gt;\n  &lt;ul class='dropdown-menu wptk_crud_dropdown' id='str_listing' data-value='str_listing' role='menu'&gt;\n    &lt;li&gt;\n      &lt;a href='#' data-value='For Sale'&gt;For Sale&lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li&gt;\n      &lt;a href='#' data-value='For Rent'&gt;For Rent&lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li&gt;\n      &lt;a href='#' data-value='Wanted To Buy'&gt;Wanted To Buy&lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li&gt;\n      &lt;a href='#' data-value='Wanted To Rent'&gt;Wanted To Rent&lt;/a&gt;\n    &lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/span&gt;\n</code></pre>\n\n<p>I have tried a few VBA codes to select one of the options. Below is the latest code that I have used but after running it nothing seems to happen to the drop down menu:</p>\n\n<pre><code>Private Sub InsertPropwall_Click()\n\nDim objIE1 As Object\nobjIE1.navigate (\"http://www.propwall.my/classifieds/post_ad?action=add\")\n\nDo\nDoEvents\nLoop Until objIE1.ReadyState = 4\n\nobjIE1.Document.getElementById(\"str_listing-btn\").Value = \"For Rent\"\n\nDo\nDoEvents\nLoop Until objIE1.ReadyState = 4\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440579425, "post_id": 32222110, "comment_id": 52327086, "body": "Bonus for mentioning the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">AutoFilter Method</a>. Much quicker and there are lots of examples on this site and others."}, {"owner": {"reputation": 23, "user_id": 5267576, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153276416344118/picture?type=large", "display_name": "user5267576", "link": "https://stackoverflow.com/users/5267576/user5267576"}, "edited": false, "score": 0, "creation_date": 1440582578, "post_id": 32222110, "comment_id": 52329248, "body": "ok will do that... usually code in java thou. i think your rewrite is much cleaner and i got it to work except for the intersect part keeps returning an error"}], "tags": [], "owner": {"reputation": 4801, "user_id": 4713729, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/PL9tu.jpg?s=128&g=1", "display_name": "vacip", "link": "https://stackoverflow.com/users/4713729/vacip"}, "is_accepted": true, "score": 3, "last_activity_date": 1440579320, "creation_date": 1440579320, "answer_id": 32222110, "question_id": 32221634, "link": "https://stackoverflow.com/questions/32221634/search-for-item-in-workbook-a-if-found-copy-row-to-workbook-b/32222110#32222110", "title": "Search for item in workbook A, if found, copy row to workbook B", "body": "<p>Your code is redundant at some places. Though the biggest issue I think is going through every cell in the whole coloumn H, which takes a long time. Here is the code, cleaned up:</p>\n\n<pre><code>Set wbThis = ActiveWorkbook\nSet wsNewData = wbThis.Sheets(\"Sheet1\")\nlNextRow = 1\nSet wbData = Application.Workbooks.Open(FileName, ReadOnly:=True)\nThisWorkbook.Activate\nFor Each ws In wbData.Worksheets\n  For Each Cell In intersect(ws.Range(\"H:H\"),ws.usedrange)\n    If Cell.Value = fWhat Then\n        ws.Rows(Cell.Row).Copy wsNewData.Rows(lNextRow)\n        lNextRow = lNextRow + 1\n    End If\n  Next\nNext\nwbThis.Save\nwbData.Close 'you are closing this withouth saving. are you sure you want to do this???? just delete this line...\n</code></pre>\n\n<p>Another issue is that apparently you are really beginner in VBA, and in programming in general. Why don't you start with the macro recorder, and analyze the codes it records? Also, read up a bit on object oriented programming, and VBA too.\nI'm sorry, but I can't explain everything I did, sinece I think I'd have to start with  Adam and Eve...</p>\n\n<p>Hope this works.</p>\n\n<p>Also, next time, just do an autofilter, and record it with macro recorder. Will even be faster than this.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1440579335, "creation_date": 1440579335, "answer_id": 32222115, "question_id": 32221634, "link": "https://stackoverflow.com/questions/32221634/search-for-item-in-workbook-a-if-found-copy-row-to-workbook-b/32222115#32222115", "title": "Search for item in workbook A, if found, copy row to workbook B", "body": "<p>It looked like you were getting there but you had some methods mashed up and the copy seemed to be unclear as to the source and destinaton.</p>\n\n<pre><code>Dim wbThis As Workbook, wbData As Workbook\nDim ws As Worksheet, wsNewData As Worksheet\nDim cell As Range\nDim lNextRow As Long, matchRow As Long\nDim fWhat As String, fileName As String\n\nfWhat = \"thing to find\"\nfileName = Environ(\"TEMP\") &amp; Chr(92) &amp; \"myWorkBook.xlsb\"\n\nSet wbThis = ActiveWorkbook\nSet wsNewData = wbThis.Sheets(\"Sheet1\")\nSet wbData = Application.Workbooks.Open(fileName, ReadOnly:=True)\n\nlNextRow = 1\n\nFor Each ws In wbData.Worksheets\n    With ws\n        For Each cell In Intersect(.UsedRange, .Range(\"H:H\"))\n            If cell.Value = fWhat Then\n                matchRow = cell.Row\n                .Rows(matchRow).Copy wsNewData.Rows(lNextRow).Cells(1)\n                lNextRow = lNextRow + 1\n                wbThis.Save\n            End If\n        Next cell\n    End With\nNext ws\n\nwbData.Close SaveChanges:=False\nSet wbThis = Nothing\nSet wsNewData = Nothing\nSet wbData = Nothing\n</code></pre>\n\n<p>I've used a full row copy from the worksheet being examined to the next row on the wsNewData worksheet (Sheet1 of wbThis).</p>\n\n<p>When you are within a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a>, you do not have to keep referencing the object the With ... End With references. Just preceed the ranges/.Rows, etc with a period anf they will know that the parent worksheet is the only referenced by the With ... End With.</p>\n\n<p>I also had to invent a fileName and fWhat to look for. You will need to set hose yourself.</p>\n"}], "owner": {"reputation": 23, "user_id": 5267576, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153276416344118/picture?type=large", "display_name": "user5267576", "link": "https://stackoverflow.com/users/5267576/user5267576"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 32222110, "answer_count": 2, "score": 0, "last_activity_date": 1440579526, "creation_date": 1440577928, "last_edit_date": 1440579526, "question_id": 32221634, "link": "https://stackoverflow.com/questions/32221634/search-for-item-in-workbook-a-if-found-copy-row-to-workbook-b", "title": "Search for item in workbook A, if found, copy row to workbook B", "body": "<p>I need to copy from workbook A to B based on a search string. The searching part seems to be ok from debugging but the copying is not working. Is there something that i have done wrongly? </p>\n\n<pre><code>    Set wbThis = ActiveWorkbook\nSet wsNewData = wbThis.Sheets(\"Sheet1\")\nlNextRow = 1\nSet wbData = Application.Workbooks.Open(FileName, ReadOnly:=True)\nThisWorkbook.Activate\nFor Each ws In wbData.Worksheets\nWith ws\n    For Each Cell In ws.Range(\"H:H\")\n        If Cell.Value = fWhat Then\n            matchRow = Cell.Row\n            'ws.Rows(\"8:\" &amp; matchRow).Select\n            'Selection.Copy\n            ws.Rows(matchRow, \"8\").Copy wsNewData.Rows(lNextRow)\n            wsNewData.Select\n            wsNewData.Rows(lNextRow).Select\n\n            wsNewData.Paste\n            lNextRow = lNextRow + 1\n            wbThis.Save\n        End If\n    Next\nEnd With\nNext\nwbData.Close\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "edited": false, "score": 0, "creation_date": 1440584694, "post_id": 32223630, "comment_id": 52330742, "body": "My problem isn&#39;t creating the drop-down list, it is putting it automatically in all the rows, even the new ones that are yet to be created."}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "reply_to_user": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "edited": false, "score": 0, "creation_date": 1479833163, "post_id": 32223630, "comment_id": 68720353, "body": "@Zawarudio I have the same problem, did you make progress?"}, {"owner": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "reply_to_user": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1480867081, "post_id": 32223630, "comment_id": 69130125, "body": "@skatun Sadly, I didn&#39;t find a solution to my problem in VBA, but you can probably easily do it with C#, if you really need it"}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1440583549, "creation_date": 1440583549, "answer_id": 32223630, "question_id": 32221510, "link": "https://stackoverflow.com/questions/32221510/vba-word-table-default-value-and-combo-box/32223630#32223630", "title": "VBA - Word Table : default value and combo box", "body": "<p>In the GUI: </p>\n\n<ol>\n<li>Click the cell where you would like your dropdown.</li>\n<li>In menu, switch to \"Developer Tools\"</li>\n<li>Insert a Dropdown control (\"Controls\" are, the one in the middle)</li>\n<li>In the ribbon, click \"Design mode\" (I have German Word so the actual name might differ), \"Properties\"</li>\n<li>Now you can enter your options</li>\n</ol>\n\n<p>Alternatively via VBA, I got this with the macro recorder; should give you a start:</p>\n\n<pre><code>[Cell].Range.ContentControls.Add (wdContentControlComboBox)\nActiveDocument.ToggleFormsDesign\nSelection.ParentContentControl.DropdownListEntries.Clear\nSelection.ParentContentControl.DropdownListEntries.Add Text:=\"Yes\", Value _\n    :=\"Yes\"\nSelection.ParentContentControl.DropdownListEntries.Add Text:=\"No\", Value:= _\n    \"No\"\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4032407, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0627327a412f5f994a5888066d9d5fc0?s=128&d=identicon&r=PG&f=1", "display_name": "Zawarudio", "link": "https://stackoverflow.com/users/4032407/zawarudio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 593, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440583549, "creation_date": 1440577562, "question_id": 32221510, "link": "https://stackoverflow.com/questions/32221510/vba-word-table-default-value-and-combo-box", "title": "VBA - Word Table : default value and combo box", "body": "<p>I have Word Tables, and I don't find how to affect default values for certain columns...\nWhen inserting a new line, I would like a certain column to have a certain drop-down list without user having to do it himself.</p>\n\n<p>To illustrate my thoughts, here is a small image of what I'm looking for</p>\n\n<p><a href=\"https://i.stack.imgur.com/8WLPk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8WLPk.png\" alt=\"model\"></a></p>\n\n<p>I really don't find how to manipulate my table for it to ends up like this, so I would like to request your help.\nWhen looking on the web for this, I only find information about table default style and no default Value.</p>\n\n<p>So I would like to ask. Is this possible? <br/>If yes, how to do it?</p>\n\n<p>I am looking for either a VBA code to set my column default value <em>(which would be great)</em>, or even a way to do it in Word GUI at first. Or, obviously, an answer that would tell me that it is impossible to do in Word.</p>\n\n<p>PS: the extremely easy equivalent in Excel of what i'm looking for:</p>\n\n<p><a href=\"https://i.stack.imgur.com/g6zU2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g6zU2.png\" alt=\"Easy Excel\"></a></p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5227097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dac89de7af7ea18d3daa656932ae705?s=128&d=identicon&r=PG&f=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5227097/charles"}, "edited": false, "score": 0, "creation_date": 1440604094, "post_id": 32223202, "comment_id": 52344757, "body": "Thanks the solution works , I didn&#39;t anticipate so much code. 2 questions :- any reason why the protect method in vba doesn&#39;t have a parameter for the list object. Also is there a reason why the worksheet Change event in the above code is in the class rather than utilising the worksheet_change within excel? Thanks"}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 55, "user_id": 5227097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dac89de7af7ea18d3daa656932ae705?s=128&d=identicon&r=PG&f=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5227097/charles"}, "edited": false, "score": 0, "creation_date": 1440605535, "post_id": 32223202, "comment_id": 52345687, "body": "I don&#39;t know the answer to your first question. As for the second, if you used the worksheet_change event you would have to add the code to each sheet in the workbook that contains list objects. By placing it in the class event and storing an instance of the class for each list object in a global collection you require much less coding, and it works even if you don&#39;t know how many (and where) list objects there are."}, {"owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "reply_to_user": {"reputation": 55, "user_id": 5227097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dac89de7af7ea18d3daa656932ae705?s=128&d=identicon&r=PG&f=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5227097/charles"}, "edited": false, "score": 0, "creation_date": 1440605602, "post_id": 32223202, "comment_id": 52345728, "body": "You can also add new listobjects (in new sheets if desired) and it will still work, though you would have to close and open the workbook again."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1563295710, "post_id": 32223202, "comment_id": 100649425, "body": "Just for the sake of handling the cases where tables are empty, you could add <code>If Not lo.DataBodyRange Is Nothing Then</code> <code>lo.DataBodyRange.Locked = False</code> <code>End If</code> in the EnableProtectedTables procedure"}], "tags": [], "owner": {"reputation": 2685, "user_id": 1523914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/95939ded1fb2423fbe9ba7989a0006ab?s=128&d=identicon&r=PG", "display_name": "Excel Developers", "link": "https://stackoverflow.com/users/1523914/excel-developers"}, "is_accepted": true, "score": 0, "last_activity_date": 1440582354, "creation_date": 1440582354, "answer_id": 32223202, "question_id": 32221328, "link": "https://stackoverflow.com/questions/32221328/how-to-protect-a-worksheet-and-unprotect-a-list-object-in-vba/32223202#32223202", "title": "How to protect a worksheet and unprotect a list object in vba", "body": "<p>It is possible to do this though the answer is more complicated than you maybe expect. Jon van der Heyden used to have a good article about this on his site (exceldesignsolutions.com) but I think he has removed it. I adopted some of his code that will allow you to add rows to a listobject on a protected sheet. The nice thing about this is that it forces the user to only enter data in the row immediately below the listobject, which ensure that the listobject \"grows\" to include the new data.</p>\n\n<p>In a nutshell, the method used is to create a custom class that will contain a listobject and an event handler that listens for a change to the sheet containing it. If the change is in the row immediately below the listobject then undo the change, unprotect the sheet, redo the change and reprotect the sheet. In addition unlock the row immediately below the listobject.</p>\n\n<p>Here is what to do:</p>\n\n<p>In your workbook containing the listobjects, create a custom class module and name it cProtectedLO. Paste the following code into it:</p>\n\n<pre><code>Option Explicit\n\nPrivate m_loTable As ListObject\nPrivate m_strPassWord As String\nPrivate WithEvents m_appExcel As Excel.Application\n\nPublic Property Set Table(ByVal loTable As ListObject)\n    Set m_loTable = loTable\nEnd Property\n\nPublic Property Let Password(ByVal strPassword As String)\n    m_strPassWord = strPassword\nEnd Property\n\nPrivate Sub Class_Initialize()\n    Set m_appExcel = Excel.Application\nEnd Sub\n\nPrivate Sub m_appExcel_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    Dim rngTable As Excel.Range\n    Dim varValue As Variant\n\n    Set rngTable = m_loTable.Range\n\n    If Sh Is rngTable.Parent Then\n        If Not Intersect(Target.Offset(-1), rngTable) Is Nothing Then\n            If Intersect(Target, rngTable) Is Nothing Then\n                varValue = Target.Value\n                Sh.Unprotect Password:=IIf(Len(m_strPassWord), m_strPassWord, Null)\n                With Application\n                    .EnableEvents = False\n                    .Undo\n                    Target.Value = varValue\n                    Sh.Cells.Locked = True\n                    m_loTable.DataBodyRange.Locked = False\n                    m_loTable.Range(m_loTable.Range.Rows.Count, 1).Offset(1, 0).Resize(1, m_loTable.ListColumns.Count).Locked = False\n                    .EnableEvents = True\n                End With\n                Sh.Protect Password:=IIf(Len(m_strPassWord), m_strPassWord, Null)\n                Target.Offset(1).Select\n            End If\n        End If\n    End If\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set m_loTable = Nothing\n    Set m_appExcel = Nothing\nEnd Sub\n</code></pre>\n\n<p>Add a normal code module and paste this code in it:</p>\n\n<pre><code>Option Explicit\n\nPublic m_colProtectedLO As Collection\n\nPublic Sub EnableProtectedTables(Optional ByVal pw As Variant)\n\n    Dim clsProtectedLO As cProtectedLO\n    Dim wks As Worksheet, lo As ListObject\n\n    Set m_colProtectedLO = New Collection\n\n    For Each wks In ThisWorkbook.Worksheets\n\n        For Each lo In wks.ListObjects\n            Set clsProtectedLO = New cProtectedLO\n\n            With clsProtectedLO\n                Set .Table = lo\n\n                If Not IsMissing(pw) Then\n                    .Password = pw\n                End If\n\n            End With\n\n            wks.Unprotect Password:=pw\n            lo.DataBodyRange.Locked = False\n            lo.Range(lo.Range.Rows.Count, 1).Offset(1, 0).Resize(1, lo.ListColumns.Count).Locked = False\n            wks.Protect Password:=pw\n            m_colProtectedLO.Add Item:=clsProtectedLO\n        Next lo\n\n    Next wks\n\n End Sub\n</code></pre>\n\n<p>In the ThisWorkbook module, paste the following:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_Open()\n    EnableProtectedTables\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n    Set m_colProtectedLO = Nothing\nEnd Sub\n</code></pre>\n\n<p>Note that is the sheets are password protected you would have to include it as a value for the \"pw\" argument in the call to EnableProtectedTables, like this:</p>\n\n<pre><code>EnableProtectedTables pw:=\"YourPasswordHere\"\n</code></pre>\n\n<p>Save the workbook, close it and open it again and you should be all set.</p>\n"}], "owner": {"reputation": 55, "user_id": 5227097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dac89de7af7ea18d3daa656932ae705?s=128&d=identicon&r=PG&f=1", "display_name": "Charles", "link": "https://stackoverflow.com/users/5227097/charles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1774, "favorite_count": 0, "accepted_answer_id": 32223202, "answer_count": 1, "score": 1, "last_activity_date": 1597589975, "creation_date": 1440576962, "last_edit_date": 1531164843, "question_id": 32221328, "link": "https://stackoverflow.com/questions/32221328/how-to-protect-a-worksheet-and-unprotect-a-list-object-in-vba", "title": "How to protect a worksheet and unprotect a list object in vba", "body": "<p>I'm running excel 2010 and have developed a xlsm to roll out to a few users</p>\n\n<p>I have protected the workbook with the following routine which works well</p>\n\n<p>My problem is I have used listobjects in the workbook as mapping tables which require intervention by the users. The existing listobject rows can be manipulated but no new rows can be added - Any ideas on how I can get around this ?</p>\n\n<p>thanks</p>\n\n<pre><code>Public Sub ProtectAll(ByVal wbWorkbook As Workbook)\n\n  Dim wks As Worksheet\n\n  For Each wks In wbWorkbook.Worksheets\n                wks.Protect sPasswordToLock, True, True, False, True,     True,True, True, False, False, False, False, False, True, True, True\n                wks.EnableSelection = xlNoRestrictions\n\n  Next wks\n</code></pre>\n"}, {"tags": ["excel", "formulas", "vba"], "answers": [{"comments": [{"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440577482, "post_id": 32221474, "comment_id": 52325898, "body": "The column is already formatted to date - the OP wants to add apostrophes without losing the leading 0 values."}], "tags": [], "owner": {"reputation": 107, "user_id": 2978412, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/MLwGE.png?s=128&g=1", "display_name": "Json", "link": "https://stackoverflow.com/users/2978412/json"}, "is_accepted": false, "score": -1, "last_activity_date": 1440577430, "creation_date": 1440577430, "answer_id": 32221474, "question_id": 32221227, "link": "https://stackoverflow.com/questions/32221227/how-to-add-apostrophe-in-each-cell-in-particular-column-in-excel-without-loosing/32221474#32221474", "title": "How to add apostrophe in each cell in particular column in excel without loosing leading zeros", "body": "<p>Right click the column and Format the cell. Choose custom and type ddmmyyyy or mmyydddd. That should do the trick.</p>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 4483038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ce5c7a4d8d7aec9195af4784224b70?s=128&d=identicon&r=PG&f=1", "display_name": "thewilq", "link": "https://stackoverflow.com/users/4483038/thewilq"}, "edited": false, "score": 0, "creation_date": 1440580799, "post_id": 32221520, "comment_id": 52328014, "body": "I know that I don&#39;t need it but the requestor do not know and I cannot explain it to them(they are dumb).  Your solution is not what I am looking for though because the apostrophe is visible, I need to achieve something like you would get putting apostrophe manually(It&#39;s there but not visible with green mark in top left corner of the cell), but there is just too many records to do it manually."}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "reply_to_user": {"reputation": 15, "user_id": 4483038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ce5c7a4d8d7aec9195af4784224b70?s=128&d=identicon&r=PG&f=1", "display_name": "thewilq", "link": "https://stackoverflow.com/users/4483038/thewilq"}, "edited": false, "score": 0, "creation_date": 1440581834, "post_id": 32221520, "comment_id": 52328714, "body": "Okay, see VBA version above that will do it for you. Just run the code and select the range that you want to amend."}, {"owner": {"reputation": 15, "user_id": 4483038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ce5c7a4d8d7aec9195af4784224b70?s=128&d=identicon&r=PG&f=1", "display_name": "thewilq", "link": "https://stackoverflow.com/users/4483038/thewilq"}, "edited": false, "score": 0, "creation_date": 1440585164, "post_id": 32221520, "comment_id": 52331030, "body": "Thanks for your inputs but I found out very simple solution. I didn&#39;t know that invisible apostrophe is part of &quot;cell format&quot;. I just added one manually and then pasted format from that cell for whole column. Now all records are text with invisible apostrophes and leading zeros(if ther is any)."}], "tags": [], "owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "is_accepted": true, "score": 3, "last_activity_date": 1440581866, "last_edit_date": 1440581866, "creation_date": 1440577588, "answer_id": 32221520, "question_id": 32221227, "link": "https://stackoverflow.com/questions/32221227/how-to-add-apostrophe-in-each-cell-in-particular-column-in-excel-without-loosing/32221520#32221520", "title": "How to add apostrophe in each cell in particular column in excel without loosing leading zeros", "body": "<p>Try:</p>\n\n<pre><code>=\"'\"&amp;TEXT(A1,\"00000000\")\n</code></pre>\n\n<p>This will force a format of \"00000000\" which will allow leading zeros. In fact, if you use <code>=TEXT()</code> then you don't need the apostrophe to force the text value.</p>\n\n<hr>\n\n<p>VBA version:  </p>\n\n<pre><code>Sub MacroMan()\n\nDim rng As Excel.Range\n\nSet rng = Application.InputBox(\"Select range to amend:\", , , , , , , 8)\n\nIf Not rng Is Nothing Then\n    For Each cell In rng.Cells\n        cell.Value = \"'\" &amp; Format(cell.Value, \"00000000\")\n    Next\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9713444, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/92fa10673fc1edb3d0182abf04b1372b?s=128&d=identicon&r=PG", "display_name": "user9713444", "link": "https://stackoverflow.com/users/9713444/user9713444"}, "is_accepted": false, "score": 0, "last_activity_date": 1524897701, "creation_date": 1524897701, "answer_id": 50073697, "question_id": 32221227, "link": "https://stackoverflow.com/questions/32221227/how-to-add-apostrophe-in-each-cell-in-particular-column-in-excel-without-loosing/50073697#50073697", "title": "How to add apostrophe in each cell in particular column in excel without loosing leading zeros", "body": "<p>A way around is simply by changing the last digit of the year (assuming the data is all of the same year, for example 2018 replace with 201, using find and replace menu. Or if the case is multiple years, we could replace the first 2 digits of the year with 3 digits which the last digit is a particular digit, say 0. Thus the year /1988 would become /19088 after replacement.\nSecond phase is by adding aposthrope to the top cell, and simply paste its format to other cells.\nLast phase is replace the wrong year to its original data.\nHope could help. </p>\n"}], "owner": {"reputation": 15, "user_id": 4483038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ce5c7a4d8d7aec9195af4784224b70?s=128&d=identicon&r=PG&f=1", "display_name": "thewilq", "link": "https://stackoverflow.com/users/4483038/thewilq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5866, "favorite_count": 0, "accepted_answer_id": 32221520, "answer_count": 3, "score": 1, "last_activity_date": 1524897701, "creation_date": 1440576662, "last_edit_date": 1531161705, "question_id": 32221227, "link": "https://stackoverflow.com/questions/32221227/how-to-add-apostrophe-in-each-cell-in-particular-column-in-excel-without-loosing", "title": "How to add apostrophe in each cell in particular column in excel without loosing leading zeros", "body": "<p>I have column in excel with dates of birth of employees (in format DDMMYYYY) and for some reason I was asked to add apostrophe before each and every record (in a way that it is not visible). There is a lot of records.\nWhen I try to do It automatically it always removes leading zero.\nFor example from 01011900 I get 1011900.</p>\n\n<p>I tried find &amp; replace, concatenate, </p>\n\n<p>Nothing from these answers helped:\n<a href=\"https://stackoverflow.com/questions/8181749/adding-appostrophe-in-every-field-in-particular-column-for-excel\">Adding Appostrophe in every field in particular column for excel</a></p>\n\n<p>Each cell has to be formatted as a text, not date.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["vba", "excel", "copy", "range"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440571953, "post_id": 32219583, "comment_id": 52322649, "body": "Using ColA and End(xlUp) has the disadvantage that if a user leaves empty cells in the forst column of the copied range there&#39;s a chance that the next copy/paste may overwrite some of the previously-copied data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440571959, "post_id": 32219583, "comment_id": 52322655, "body": "if you have blank cells but not a complete blank row or column look at the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196678.aspx\" rel=\"nofollow noreferrer\">Range.CurrentRegion property</a>. Unfortunately, it is impossible to speculate further without seeing data."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440572094, "post_id": 32219583, "comment_id": 52322726, "body": "@tim - I believe the primary problem is that the OP is copying a static block (e.g. <code>Range(&quot;A76:J85&quot;)</code>) every time whether it is filled or not."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440572305, "post_id": 32219583, "comment_id": 52322851, "body": "@Jeeped - If there are blank rows at the end of the source range then they should get overwritten by the next paste..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440572778, "post_id": 32219583, "comment_id": 52323132, "body": "...unless of course the first source rows are empty - updated my answer..."}, {"owner": {"reputation": 245, "user_id": 5176996, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/135236738931eb8c49fa46b18abd6f6a?s=128&d=identicon&r=PG&f=1", "display_name": "PDG", "link": "https://stackoverflow.com/users/5176996/pdg"}, "edited": false, "score": 0, "creation_date": 1440572951, "post_id": 32219583, "comment_id": 52323216, "body": "Unfortunately I&#39;m not yet allowed to post attachments else I would attach the document. I have almost no knowledge of VBA but this technique I&#39;ve needed very much since many past registration files have been setup in block and its a way to keep people working in blocks but storing the data in tidy tables."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1440572751, "last_edit_date": 1440572751, "creation_date": 1440572257, "answer_id": 32219887, "question_id": 32219583, "link": "https://stackoverflow.com/questions/32219583/adjusting-macro-to-copy-range-in-table-but-placing-the-range-at-the-first-blank/32219887#32219887", "title": "Adjusting macro to copy range in table but placing the range at the first blank line in the table", "body": "<p>This will copy any row from the source range which has at least one value entered.</p>\n\n<pre><code>Sub Containersgeproduceerd()\n\n    Dim c As Range, rngCopy As Range, rw As Range\n\n    Set rngCopy = Worksheets(\"Production shift summary\").Range(\"A76:J85\")\n\n    'find empty cell in ColA\n    Set c = Worksheets(\"Production perform container\").Range( _\n                         \"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n\n    'make sure destination row is blank\n    Do While Application.CountA(c.Resize(1, rngCopy.Columns.Count)) &gt; 0\n        Set c = c.Offset(1, 0)\n    Loop\n\n    'copy any row in the source range which has at least one value entered...\n    For Each rw In rngCopy.Rows\n        If Application.CountA(rw) &gt; 0 Then\n            c.Resize(1, rw.Cells.Count).Value = rw.Value\n            Set c = c.Offset(1, 0)\n        End If\n    Next rw\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 5176996, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/135236738931eb8c49fa46b18abd6f6a?s=128&d=identicon&r=PG&f=1", "display_name": "PDG", "link": "https://stackoverflow.com/users/5176996/pdg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440947745, "creation_date": 1440571112, "last_edit_date": 1440947745, "question_id": 32219583, "link": "https://stackoverflow.com/questions/32219583/adjusting-macro-to-copy-range-in-table-but-placing-the-range-at-the-first-blank", "title": "Adjusting macro to copy range in table but placing the range at the first blank line in the table", "body": "<p>I'm using the following code to copy a block of data into another worksheet which holds all the data as a table. The code is used to copy after each time people fill in new data.</p>\n\n<pre><code>Sub Containersgeproduceerd()\n\n    Worksheets(\"Production shift summary\").Range(\"A76:J85\").Copy\n        Worksheets(\"Production perform container\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial Paste:=xlPasteValues, operation:=xlNone, skipblanks _\n        :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>The range of the block can be filled in totally or partially.\nWhe the range is filled in partially and I copy it to the table and do that multiple times, I get the effect that the next copy starts at end range of the copied block in the table, thus if the range is not totally filled it leaves blank lines in the table after multiple times copying a partially filled range in the table.</p>\n\n<p>What I want is that the data is copied into the first blank line.</p>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440569459, "post_id": 32219086, "comment_id": 52321490, "body": "If you are &#39;keen to see whether this can be done without using VBA&#39; then why the [vba] and [excel-vba] tags?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1440577811, "post_id": 32219086, "comment_id": 52326101, "body": "What you would like is called a <b>UDF</b> and it can be done quite readily in VBA. This question however is far too broad."}], "owner": {"reputation": 1, "user_id": 5267070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e02538591ca4982c1daf9f2ee17c29b?s=128&d=identicon&r=PG&f=1", "display_name": "MikeBassett", "link": "https://stackoverflow.com/users/5267070/mikebassett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1440569360, "creation_date": 1440569141, "last_edit_date": 1440569360, "question_id": 32219086, "link": "https://stackoverflow.com/questions/32219086/formula-to-pull-mysql-data", "title": "Formula to pull MySQL data", "body": "<p>I have data in MySQL that I'm trying to pull directly into a CELL in an Excel worksheet pursuant to parameters that I'll set out. I'm aware of how to import a complete MySQL table etc etc, however am not looking for that here. I can see VBA approaches however am keen to see whether this can be done without using VBA.</p>\n\n<p>The aim of what I'm doing is to ultimately make the cell formula dynamic by linking to other cells containing parameters - change those parameters, the cell calls MySQL and returns updated data.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440570199, "post_id": 32218954, "comment_id": 52321786, "body": "There appears to be at least one extra <code>End If</code> just before <code>Next cell</code>. Could you clarify?"}, {"owner": {"reputation": 779, "user_id": 4572953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc8f68cfd374df463d05e564c2ef0870?s=128&d=identicon&r=PG&f=1", "display_name": "psychicebola", "link": "https://stackoverflow.com/users/4572953/psychicebola"}, "edited": false, "score": 0, "creation_date": 1440570591, "post_id": 32218954, "comment_id": 52321967, "body": "if you lock the entire sheet you don&#39;t need to lock the ranges separately"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1440570679, "post_id": 32218954, "comment_id": 52322012, "body": "Locking cells and protecting the sheet are not the same thing - unlocked cells can be changed even when the sheet is protected."}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1502847727, "post_id": 32218954, "comment_id": 78366028, "body": "<a href=\"https://meta.stackexchange.com/a/5235/289619\">meta.stackexchange.com/a/5235/289619</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 4688869, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rx6AENr4YvE/AAAAAAAAAAI/AAAAAAAAACo/LpOvjID4Czg/photo.jpg?sz=128", "display_name": "Jiaxin He", "link": "https://stackoverflow.com/users/4688869/jiaxin-he"}, "edited": false, "score": 0, "creation_date": 1440747099, "post_id": 32219479, "comment_id": 52410161, "body": "Thank you so much!!!! It works fine now. Learnt something new. Shall use with statement to pass control to the next worksheet."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1440570729, "creation_date": 1440570729, "answer_id": 32219479, "question_id": 32218954, "link": "https://stackoverflow.com/questions/32218954/protect-worksheets-in-loop/32219479#32219479", "title": "Protect worksheets in loop", "body": "<p>There seemed to be an extra <code>End If</code> just before the close of the nested <code>For Each cell In .UsedRange</code>.</p>\n\n<p>I believe your primary problem was relying on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">ActiveSheet property</a>. The <code>For n = 2 To ws_count</code> wasn't really passing control over to the next worksheet. Focus and control was remaining with the ActiveSheet.</p>\n\n<pre><code>Sub selectnumbers()\n    Dim ws_count As Long, n As Long\n    Dim rng As Range, cell As Range, i As Range\n\n    ws_count = ActiveWorkbook.Worksheets.Count\n    For n = 2 To ws_count\n        With Worksheets(n)\n\n            Set rng = Nothing\n\n            For Each cell In .UsedRange\n                If Not IsNumeric(cell) Or cell.Interior.Pattern = xlLightUp Or cell = \"\" Then\n                    If rng Is Nothing Then\n                        Set rng = cell\n                    Else\n                        Set rng = Application.Union(rng, cell)\n                    End If\n                End If\n            Next cell\n\n            If Not rng Is Nothing Then\n                rng.Locked = True\n            End If\n\n            .Protect Password:=\"ADARS\", DrawingObjects:=True, Contents:=True, Scenarios:=True, _\n                AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n\n        End With\n    Next n\n\nEnd Sub\n</code></pre>\n\n<p>I've used a <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> to pass control along to the next worksheet.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 4688869, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rx6AENr4YvE/AAAAAAAAAAI/AAAAAAAAACo/LpOvjID4Czg/photo.jpg?sz=128", "display_name": "Jiaxin He", "link": "https://stackoverflow.com/users/4688869/jiaxin-he"}, "edited": false, "score": 0, "creation_date": 1440747126, "post_id": 32239766, "comment_id": 52410176, "body": "Thank you so much too! the With statement works very well now :)."}], "tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1440642741, "creation_date": 1440642741, "answer_id": 32239766, "question_id": 32218954, "link": "https://stackoverflow.com/questions/32218954/protect-worksheets-in-loop/32239766#32239766", "title": "Protect worksheets in loop", "body": "<p>The cell by cell testing looked slow to me, so I've tried a version below using <code>SpecialCells</code> and <code>Find</code> to speed it up.</p>\n\n<pre><code>Sub selectnumbers()\n    Dim ws_count As Long, n As Long\n    Dim rng As Range\n    Dim rng1 As Range\n    Dim rng2 As Range\n    Dim strAddress As String\n\n    ws_count = ActiveWorkbook.Worksheets.Count\n    For n = 2 To ws_count\n        With Worksheets(n)\n\n            Set rng = Nothing\n            .UsedRange\n\n            On Error Resume Next\n            Set rng = .UsedRange.SpecialCells(xlBlanks)\n            If Not rng Is Nothing Then\n                Set rng = Union(rng, .UsedRange.SpecialCells(xlCellTypeFormulas, 22))\n            Else\n              Set rng = .UsedRange.SpecialCells(xlCellTypeFormulas, 22)\n            End If\n            On Error GoTo 0\n\n\n            With Application.FindFormat\n                    .Clear\n                    .Interior.Pattern = xlLightUp\n            End With\n\n            Set rng1 = .UsedRange.Find(vbNullString, , xlFormulas, xlPart, xlByRows, xlNext, , True)\n            If Not rng1 Is Nothing Then\n                strAddress = rng1.Address\n                Set rng2 = rng1\n                Do\n                    Set rng1 = .UsedRange.Find(vbNullString, rng1, xlFormulas, xlPart, xlByRows, xlNext, , True)\n                    Set rng2 = Union(rng2, rng1)\n                Loop Until rng1.Address = strAddress\n            Set rng = Union(rng, rng2)\n            End If\n\n            If Not rng Is Nothing Then rng.Locked = True\n\n            .Protect Password:=\"ADARS\", DrawingObjects:=True, Contents:=True, Scenarios:=True, _\n                AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n        End With\n    Next n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4688869, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rx6AENr4YvE/AAAAAAAAAAI/AAAAAAAAACo/LpOvjID4Czg/photo.jpg?sz=128", "display_name": "Jiaxin He", "link": "https://stackoverflow.com/users/4688869/jiaxin-he"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1440642741, "creation_date": 1440568532, "last_edit_date": 1440569771, "question_id": 32218954, "link": "https://stackoverflow.com/questions/32218954/protect-worksheets-in-loop", "title": "Protect worksheets in loop", "body": "<p>The following code is to lock cells that meet the criteria in each worksheet of the workbook. The code works fine on single worksheet, but when I want to apply to the entire workbook, the error messgage \"unable to set the locked property to the range class\". </p>\n\n<p>The workbook loop procedure is also correct, can someone tell me what is causing the error? </p>\n\n<p>Much appreciated! Code as below and I'm sorry I don't know how to display the correct format here:</p>\n\n<pre><code>Sub selectnumbers()\n    Dim ws_count As Integer\n    Dim n As Integer\n    ws_count = ActiveWorkbook.Worksheets.Count\n    For n = 2 To ws_count\n\n        Dim rng As Range\n        Dim cell As Range\n        Dim i As Range\n        Set rng = Nothing\n\n        For Each cell In ActiveSheet.UsedRange\n          If IsNumeric(cell) = False Or cell.Interior.Pattern = xlLightUp Or cell = \"\" Then\n           If rng Is Nothing Then\n            Set rng = cell\n              Else\n              Set rng = Application.union(rng, cell)\n            End If\n          End If\n        End If\n        Next cell\n\n        If Not rng Is Nothing Then\n        rng.Select\n        End If\n\n        Selection.Locked = True\n\n        ActiveSheet.Protect Password:=\"ADARS\", DrawingObjects:=True, Contents:=True, Scenarios:=True _\n        , AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:=True\n\n    Next n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "runtime"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1440568458, "post_id": 32218646, "comment_id": 52321082, "body": "You have to fullfil all cells with date to be able to create chart/graph instead of creating string of cell adresses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440569207, "post_id": 32218646, "comment_id": 52321387, "body": "Your disregard for any mention of a parent worksheet to the cells holding the chart data troubles me. What is <code>debug.print range(s).address(external:=true)</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5266874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed17084a3ce17a8a310b6f1047ead539?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5266874/chris"}, "edited": false, "score": 0, "creation_date": 1440571365, "post_id": 32218941, "comment_id": 52322336, "body": "the thing is, i&#39;m trying to update the current seriescollection.Value, because its a dynamic graph that updates every time the user clicks a button. hence the  ActiveChart.SeriesCollection(1).Values"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 5266874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed17084a3ce17a8a310b6f1047ead539?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5266874/chris"}, "edited": false, "score": 0, "creation_date": 1440571619, "post_id": 32218941, "comment_id": 52322485, "body": "So did you try <code>ActiveChart.SeriesCollection(1).Values = cCell1</code> My code was intended as an example of how to set the values...  It doesn&#39;t require a new series."}, {"owner": {"reputation": 13, "user_id": 5266874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed17084a3ce17a8a310b6f1047ead539?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5266874/chris"}, "edited": false, "score": 0, "creation_date": 1440573132, "post_id": 32218941, "comment_id": 52323305, "body": "Sorry i was trying to edit the previous comment but it wasnt allowed. Anyway the thing is, everything is working fine if the range for the values is smaller than 255 characters? Not very sure about the number but if i reduced the range everything works fine. Once i&#39;ve exceeded a certain number of ranges, the error appears."}, {"owner": {"reputation": 13, "user_id": 5266874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed17084a3ce17a8a310b6f1047ead539?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5266874/chris"}, "edited": false, "score": 0, "creation_date": 1440573557, "post_id": 32218941, "comment_id": 52323552, "body": "for example, if these values are assigned to the address variable:  $D$2,$D$5,$D$8,$D$11,$D$14,$D$17,$D$20,$D$23,$D$26,$D$29,$D$&zwnj;&#8203;32,$D$35,$D$38,$D$41&zwnj;&#8203;,$D$44  it&#39;ll work, but if it continues to $D$242 as the example above, the error occurs due to the length of the variable"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 13, "user_id": 5266874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed17084a3ce17a8a310b6f1047ead539?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5266874/chris"}, "edited": false, "score": 0, "creation_date": 1440652453, "post_id": 32218941, "comment_id": 52363708, "body": "I successfully added 500 points using the approach above.  If you&#39;re still having problems then maybe update your question with your full current code."}, {"owner": {"reputation": 13, "user_id": 5266874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed17084a3ce17a8a310b6f1047ead539?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5266874/chris"}, "edited": false, "score": 0, "creation_date": 1440738428, "post_id": 32218941, "comment_id": 52406442, "body": "I&#39;ve found out the problem, I was using   ActiveChart.SeriesCollection(1).Values = Range(vCell1.address) instead of   ActiveChart.SeriesCollection(1).Values = vCell1   The variable is already a range, and removing the range(address) solved the problem. thank you!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1440568476, "creation_date": 1440568476, "answer_id": 32218941, "question_id": 32218646, "link": "https://stackoverflow.com/questions/32218646/vba-run-time-1004-error/32218941#32218941", "title": "VBA run-time 1004 error", "body": "<p>This worked for me...</p>\n\n<pre><code>Sub Tester()\n\n    Dim c As Range, cTot As Range, s As Series\n\n    'collect all values for \"40\"\n    For Each c In Range(\"D1:D27\").Cells\n        If c.Offset(0, -1) = 40 Then\n            If cTot Is Nothing Then\n                Set cTot = c\n            Else\n                Set cTot = Application.Union(cTot, c)\n            End If\n        End If\n    Next c\n\n    'create new series\n    Set s = ActiveSheet.ChartObjects(1).Chart.SeriesCollection.NewSeries()\n\n    s.Values = cTot  'set values\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5266874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed17084a3ce17a8a310b6f1047ead539?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/5266874/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 32218941, "answer_count": 1, "score": 1, "last_activity_date": 1440568476, "creation_date": 1440567061, "question_id": 32218646, "link": "https://stackoverflow.com/questions/32218646/vba-run-time-1004-error", "title": "VBA run-time 1004 error", "body": "<p>I've been getting a run-time 1004 error on VBA. I know what the problem is, but I just can't find a solution to this.</p>\n\n<p>I'm using Microsoft Excel 2013</p>\n\n<p>The sample data is as follows:</p>\n\n<pre><code>1   01/19/2015  40  0.250006538\n                52  0.052997791\n                58  0.010990106\n2   01/20/2015  40  0.250001126\n                52  0.052997369\n                58  0.010990412\n3   01/21/2015  40  0.250005088\n                52  0.052996605\n                58  0.010990819\n</code></pre>\n\n<p>And it goes on and on. What I intend to do is to extract the values of the data beside a certain number (e.g for 40, it'll be 0.250006538, 0.250001126, 0.250005088 etc.) and plot them on a graph.</p>\n\n<p>What i've done so far is to Union the range together as such:</p>\n\n<pre><code>'checks for number 40\nFor each c In rng1.Cells\n        Set cellRange = Range(\"D\" &amp; c.Row)\n        Set cCell1 = Union(cCell1, cellRange)\nNext\n</code></pre>\n\n<p>And i've also tried this method:</p>\n\n<pre><code> 'checks for number 40\n For each c In rng1.Cells\n    If Not s = vbNullString Then\n           s = s &amp; \",\" &amp; Range(\"D\" &amp; c.Row).address\n    Else\n           s = Range(\"D\" &amp; c.Row).address\n    End If\n Next\n</code></pre>\n\n<p>The end result i'll get is either a cCell1 variable or s variable with a list of addresses.</p>\n\n<pre><code> $D$2,$D$5,$D$8,$D$11,$D$14,$D$17,$D$20,$D$23,$D$26,$D$29,$D$32,$D$35,$D$38,$D$41,$D$44,$D$47,$D$50,$D$53,$D$56,$D$59,$D$62,$D$65,$D$68,$D$71,$D$74,$D$77,$D$80,$D$83,$D$86,$D$89,$D$92,$D$95,$D$98,$D$101,$D$104,$D$107,$D$110,$D$113,$D$116,$D$119,$D$122,$D$125,$D$128,$D$131,$D$134,$D$137,$D$140,$D$143,$D$146,$D$149,$D$152,$D$155,$D$158,$D$161,$D$164,$D$167,$D$170,$D$173,$D$176,$D$179,$D$182,$D$185,$D$188,$D$191,$D$194,$D$197,$D$200,$D$203,$D$206,$D$209,$D$212,$D$215,$D$218,$D$221,$D$224,$D$227,$D$230,$D$233,$D$236,$D$239,$D$242\n</code></pre>\n\n<p>The problem is when I try to plot the graph on a chart with</p>\n\n<pre><code> ActiveChart.SeriesCollection(1).Values = Range(cCell1.address)\n</code></pre>\n\n<p>or </p>\n\n<pre><code> ActiveChart.SeriesCollection(1).Values = Range(s)\n</code></pre>\n\n<p>It stops and gives me a runtime-error '1004'.</p>\n\n<p>I assume this is happening because the addresses in the variables are too long to be processed by the Range function... The datasheet i'm working with has hundreds to thousands of data, and the graph has to be plotted according to the number of points.</p>\n\n<p>Is there any workarounds to this? Thank you so much!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 0, "creation_date": 1440557719, "post_id": 32217238, "comment_id": 52318074, "body": "What is <code>bottom</code> set to, and why? That&#39;s a very confusing calculation."}, {"owner": {"reputation": 31, "user_id": 5229362, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-MJ5RC275ZHo/AAAAAAAAAAI/AAAAAAAAADo/pIp_BHC6ONk/photo.jpg?sz=128", "display_name": "Leean", "link": "https://stackoverflow.com/users/5229362/leean"}, "reply_to_user": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 0, "creation_date": 1440557925, "post_id": 32217238, "comment_id": 52318113, "body": "ah! the top/bottom is to identify the range for lookup in Temp sheet automatically, the IF(ISERROR(VLOOKUP(A3,Temp!$A$3:$A$595,1,FALSE)),A3,&quot;0&quot;) is to hard code for testing on the excel formula"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5229362, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-MJ5RC275ZHo/AAAAAAAAAAI/AAAAAAAAADo/pIp_BHC6ONk/photo.jpg?sz=128", "display_name": "Leean", "link": "https://stackoverflow.com/users/5229362/leean"}, "edited": false, "score": 0, "creation_date": 1440559252, "post_id": 32217378, "comment_id": 52318389, "body": "I just remove and correct the line, it works! thank you"}], "tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": false, "score": 1, "last_activity_date": 1440558581, "creation_date": 1440558581, "answer_id": 32217378, "question_id": 32217238, "link": "https://stackoverflow.com/questions/32217238/translate-a-worksheet-formula-in-vba/32217378#32217378", "title": "Translate a worksheet formula in VBA", "body": "<p>You have a concatenation problem in the second line of the <code>.Formula</code> line.</p>\n\n<p>To emulate the formula you have at the top of your question (which is wrong incidentally because you should be pointing to <code>$B$3:$B$595</code> or something like that because your look up cell <code>A3</code> should not be inside the <code>VLOOKUP</code> range).</p>\n\n<p>Try this new <code>.Formula</code> line:-</p>\n\n<pre><code>    .Formula = \"=IF(ISERROR(VLOOKUP(A\" &amp; top &amp; \",Temp!$B$\" &amp; top &amp; \":$B$\" &amp; bottom &amp; _\n               \",1,FALSE)),A\" &amp; top &amp; \", \" &amp; \"0)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5229362, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-MJ5RC275ZHo/AAAAAAAAAAI/AAAAAAAAADo/pIp_BHC6ONk/photo.jpg?sz=128", "display_name": "Leean", "link": "https://stackoverflow.com/users/5229362/leean"}, "edited": false, "score": 0, "creation_date": 1440570807, "post_id": 32217762, "comment_id": 52322086, "body": "i just check i saw the unnecessary reference to get total rows in sheet(&quot;temp&quot;)  while the loop just running in sheet(&quot;trash&quot;) only. Thank"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1440561576, "creation_date": 1440561576, "answer_id": 32217762, "question_id": 32217238, "link": "https://stackoverflow.com/questions/32217238/translate-a-worksheet-formula-in-vba/32217762#32217762", "title": "Translate a worksheet formula in VBA", "body": "<p>Are you sure you want to use <code>top</code> as both the starting row in column A and the column to get the bottom row from the Temp worksheet? The important column on the Temp worksheet is column B (i.e. 2) not C (i.e. 3).</p>\n\n<p>If you are putting formula(s) into Trash!A3:A595 that reference Trash!A3:A595 then these are circular references and cannot be resolved under normal conditions. I'll put the formulas into column Z.</p>\n\n<p>If you are operating with Excel 2007 or newer then I would humbly propose this alternate that uses the worksheet's <a href=\"https://support.office.com/en-us/article/IFERROR-function-F59BACDC-78BD-4924-91DF-A869D0B08CD5\" rel=\"nofollow\">IFERROR function</a> and does not attempt to make text out of the 0 returned value.</p>\n\n<pre><code>Const top As Integer = 3\nDim bottom As Long\nbottom = Sheets(\"Temp\").Cells(Rows.Count, \"B\").End(xlUp).Row  '&lt;~~change here\nWith ThisWorkbook.Sheets(\"trash\")\n    With .Range(\"Z\" &amp; top, .Cells(Rows.Count, \"A\").End(xlUp).Offset(0, 25))\n        .Formula = \"=IFERROR(VLOOKUP(A\" &amp; top &amp; \", Temp!$B$\" &amp; top &amp; \":$B$\" &amp; bottom &amp; _\n               \", 1, FALSE), 0)\"  '&lt;~~ big change here\n        .Value = .Value\n   End With\nEnd With\n</code></pre>\n\n<p>It is also curious as to why the number of rows of formulas in the Trash worksheet must be governed by the number of rows of data in the Temp worksheet. I would have thought that the number of values in column A of the Trash sheet should govern how many formulas go into the Trash worksheet.</p>\n"}], "owner": {"reputation": 31, "user_id": 5229362, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-MJ5RC275ZHo/AAAAAAAAAAI/AAAAAAAAADo/pIp_BHC6ONk/photo.jpg?sz=128", "display_name": "Leean", "link": "https://stackoverflow.com/users/5229362/leean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1440561760, "creation_date": 1440557419, "last_edit_date": 1531164843, "question_id": 32217238, "link": "https://stackoverflow.com/questions/32217238/translate-a-worksheet-formula-in-vba", "title": "Translate a worksheet formula in VBA", "body": "<p>Can somebody help me to write this formula in excel VBA?</p>\n\n<pre><code>=IF(ISERROR(VLOOKUP(A3,Temp!$A$3:$A$595,1,FALSE)),A3,\"0\")\n</code></pre>\n\n<p>My code is getting stuck with :\"syntax error\"</p>\n\n<pre><code>Sub checkDuplitems()\n\n    Application.ScreenUpdating = False\n    Const top As Integer = 3\n    Dim bottom As Long\n    bottom = Sheets(\"Temp\").Cells(Rows.Count, top).End(xlUp).row\n       With ThisWorkbook.Sheets(\"trash\").Range(\"A\" &amp; top &amp; \":A\" &amp; bottom)\n        .Formula = \"=IF(ISERROR(VLOOKUP(A\" &amp; top &amp; \",Temp!$B$\" &amp; top &amp; \":$B$\" &amp; bottom &amp; _\n                   \",1,FALSE)),A\" &amp; top &amp; \", &amp; '\" 0\" &amp; ,\" '\")\"\n        .Value = .Value\n        .SortSpecial\n    End With\n   'Call something...\nEnd Sub\n</code></pre>\n"}, {"tags": ["performance", "excel", "border", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "edited": false, "score": 0, "creation_date": 1440565958, "post_id": 32217592, "comment_id": 52320150, "body": "Thank you, this now completes instantly."}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1440560253, "creation_date": 1440560253, "answer_id": 32217592, "question_id": 32217234, "link": "https://stackoverflow.com/questions/32217234/excel-more-efficient-way-to-remove-specific-borders/32217592#32217592", "title": "Excel - More efficient way to remove specific borders", "body": "<p>There are several issues in your code:</p>\n\n<ol>\n<li>You don't need to, and should not <code>Select</code> to do these actions</li>\n<li>Your logic is flawed: <code>xlDiagonalUp</code> is not a <code>LineStyle</code> </li>\n<li>Because you are setting any Diagonal Up borders to none, you don't need to iterate the range, do it in one step</li>\n</ol>\n\n<p>So, replace</p>\n\n<pre><code>Cells.Range(\"G1:AO757\").Select\nFor Each Cell In Selection\n    If Cell.Borders(xlDiagonalUp).LineStyle = xlDiagonalUp Then\n        Cell.Borders(xlDiagonalUp).LineStyle = xlNone\n    End If\nNext\n</code></pre>\n\n<p>with</p>\n\n<pre><code>sh2.Range(\"G1:AO757\").Borders(xlDiagonalUp).LineStyle = xlNone\n</code></pre>\n\n<hr>\n\n<p>Similarly, </p>\n\n<pre><code>sh2.Select\nCells.Range(\"B1:F756\").Select\nFor Each Cell In Selection\n    If Cell.Interior.Color = Excel.XlRgbColor.rgbWhite Then\n        Cell.Value = \"\"\n    End If\nNext\n</code></pre>\n\n<p>can be reduced to</p>\n\n<pre><code>For Each Cell In sh2.Range(\"B1:F756\")\n    If Cell.Interior.Color = Excel.XlRgbColor.rgbWhite Then\n        Cell.ClearContents\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 4263698, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6c400b02d244c7ed663e2d1d3c7e64f6?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Jones", "link": "https://stackoverflow.com/users/4263698/bradley-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 32217592, "answer_count": 1, "score": 0, "last_activity_date": 1440560253, "creation_date": 1440557396, "last_edit_date": 1531164843, "question_id": 32217234, "link": "https://stackoverflow.com/questions/32217234/excel-more-efficient-way-to-remove-specific-borders", "title": "Excel - More efficient way to remove specific borders", "body": "<p>How can I make the below code more efficient, at the moment it takes roughly 30 seconds to complete</p>\n\n<p>The code will clear all cells within a selection which have a white background &amp; then clear all diagonal borders within a selection. </p>\n\n<p>With only the clear cells with white background code it finishes instantly but as soon as I added the remove borders code it became slow.</p>\n\n<pre><code>Sub ADULTClearOnly()\nSet sh2 = ThisWorkbook.Worksheets(\"ADULT Sign On Sheet\")\n\nsh2.Select\nCells.Range(\"B1:F756\").Select\n    For Each Cell In Selection\n    If Cell.Interior.Color = Excel.XlRgbColor.rgbWhite Then\n    Cell.Value = \"\"\n    End If\n    Next\n    Cells.Range(\"G1:AO757\").Select\n    For Each Cell In Selection\n    If Cell.Borders(xlDiagonalUp).LineStyle = xlDiagonalUp Then\n    Cell.Borders(xlDiagonalUp).LineStyle = xlNone\n    End If\n    Next\n\n    End Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "vbscript"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 3, "creation_date": 1440556504, "post_id": 32217005, "comment_id": 52317787, "body": "Of course there is; Access is a desktop database, and it would be pretty useless if you couldn&#39;t retrieve values from that data in your code. This is pretty basic stuff, and it seems like you should find an Access tutorial to learn those basics."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1440558798, "post_id": 32217005, "comment_id": 52318284, "body": "Look at the <i>Application.DCount Method</i> topic in Access&#39; help system."}, {"owner": {"reputation": 51, "user_id": 4665232, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-IcJwMoMVU2A/AAAAAAAAAAI/AAAAAAAAACM/hjuK3tdMkkM/photo.jpg?sz=128", "display_name": "Ian Fafard", "link": "https://stackoverflow.com/users/4665232/ian-fafard"}, "edited": false, "score": 0, "creation_date": 1440648603, "post_id": 32217005, "comment_id": 52362583, "body": "Thanks, im transitioning 90% of my reporting and knowledge functions to Access so the VBA transition is a bit hectic for the timeline I need to complete - waiting for my book to come in on it and I appreciate the on the spot help folks."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4665232, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-IcJwMoMVU2A/AAAAAAAAAAI/AAAAAAAAACM/hjuK3tdMkkM/photo.jpg?sz=128", "display_name": "Ian Fafard", "link": "https://stackoverflow.com/users/4665232/ian-fafard"}, "edited": false, "score": 0, "creation_date": 1440648371, "post_id": 32219499, "comment_id": 52362534, "body": "That&#39;s fantastic, I was getting the same results but with a lot more vba. I had been using excel and automating a macro that queries a particular table, using functional cells as variables outside of VBA, that way editing variables and such was much faster. However I don&#39;t see anything faster and as simple as the code above."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1440570801, "creation_date": 1440570801, "answer_id": 32219499, "question_id": 32217005, "link": "https://stackoverflow.com/questions/32217005/ms-access-vba-vba-command-based-on-query-result/32219499#32219499", "title": "MS Access VBA: VBA command based on Query Result", "body": "<p>Use DCount:</p>\n\n<pre><code>If DCount(\"*\", \"[table]\") &gt; 0 Then\n    ' Insert code to export and send email to a,b,c.\nElse\n    ' Don't.\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "is_accepted": false, "score": 1, "last_activity_date": 1440596389, "creation_date": 1440596389, "answer_id": 32228278, "question_id": 32217005, "link": "https://stackoverflow.com/questions/32217005/ms-access-vba-vba-command-based-on-query-result/32228278#32228278", "title": "MS Access VBA: VBA command based on Query Result", "body": "<p>DCount is clearly the way to go in Access. If you were not in Access, you would need to create a recordset and test its value</p>\n\n<pre><code>Sub TestRecordCount()\n\n    Dim cn As ADODB.Connection\n    Dim rs As ADODB.Recordset\n\n    Set cn = New ADODB.Connection\n    cn.Open msCONNSTRING\n\n    Set rs = cn.Execute(\"SELECT COUNT(*) FROM table\")\n\n    If rs.Fields(0).Value &gt; 0 Then\n        'do stuff\n    End If\n\n    rs.Close\n    cn.Close\n\nEnd Sub\n</code></pre>\n\n<p>Since the recordset only returns one record with one field, you can test .Fields(0).Value to see how many records are in the table.</p>\n"}], "owner": {"reputation": 51, "user_id": 4665232, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-IcJwMoMVU2A/AAAAAAAAAAI/AAAAAAAAACM/hjuK3tdMkkM/photo.jpg?sz=128", "display_name": "Ian Fafard", "link": "https://stackoverflow.com/users/4665232/ian-fafard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 32219499, "answer_count": 2, "score": 1, "last_activity_date": 1440596389, "creation_date": 1440555870, "last_edit_date": 1440557573, "question_id": 32217005, "link": "https://stackoverflow.com/questions/32217005/ms-access-vba-vba-command-based-on-query-result", "title": "MS Access VBA: VBA command based on Query Result", "body": "<p>Is there any way I can use the query result as a condition in a VBA module containing a dynamic sql statement??</p>\n\n<p>For example</p>\n\n<pre><code>if( count(user_id) from table &gt; 0, THEN xport and send email to a,b,c)\n</code></pre>\n\n<p>I am trying to make the condition rely on a specific query result.. so if a certain query has ANY results at all, I will have the module DO something to react to that result.</p>\n\n<p>The only other way I tried was to query the database from EXCEL, and have excel's VBA react to a certain cell's value (which would contain the same condition I am trying to get in access.. but id rather STAY in access as MUCH as possible)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 5266543, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-QjQe9l2QnUQ/AAAAAAAAAAI/AAAAAAAABbI/e6YUfZWuAiY/photo.jpg?sz=128", "display_name": "Prafulla Kumar Shahi", "link": "https://stackoverflow.com/users/5266543/prafulla-kumar-shahi"}, "edited": false, "score": 0, "creation_date": 1440558420, "post_id": 32217342, "comment_id": 52318211, "body": "My criteria range would be in the other sheet, not preporig. It doesn&#39;t need a &quot;.&quot; right? Can I use a thisworkbook.sheets().range()?"}, {"owner": {"reputation": 97, "user_id": 5266543, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-QjQe9l2QnUQ/AAAAAAAAAAI/AAAAAAAABbI/e6YUfZWuAiY/photo.jpg?sz=128", "display_name": "Prafulla Kumar Shahi", "link": "https://stackoverflow.com/users/5266543/prafulla-kumar-shahi"}, "edited": false, "score": 1, "creation_date": 1440558591, "post_id": 32217342, "comment_id": 52318248, "body": "I did what you mentioned and what I said above, now it&#39;s working. Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 97, "user_id": 5266543, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-QjQe9l2QnUQ/AAAAAAAAAAI/AAAAAAAABbI/e6YUfZWuAiY/photo.jpg?sz=128", "display_name": "Prafulla Kumar Shahi", "link": "https://stackoverflow.com/users/5266543/prafulla-kumar-shahi"}, "edited": false, "score": 0, "creation_date": 1440558914, "post_id": 32217342, "comment_id": 52318306, "body": "Glad to hear you got sorted and thanks for taking the time to share the combined solution."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1440558265, "creation_date": 1440558265, "answer_id": 32217342, "question_id": 32216761, "link": "https://stackoverflow.com/questions/32216761/extract-range-is-not-defined-advanced-filter/32217342#32217342", "title": "&quot;Extract range is not defined&quot;: advanced filter", "body": "<p>Once you are inside the <code>With perporig.Sheets(\"perpetual\") ... End With</code> block, preface all <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838238.aspx\" rel=\"nofollow\">Range objects</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196273.aspx\" rel=\"nofollow\">Range.Cells property</a> references with a period (aka <code>.</code> or <em>full stop</em>).</p>\n\n<pre><code>With perporig.Sheets(\"perpetual\")\n    .AutoFilterMode = False\n    RowLast = .Cells(Rows.count, \"A\").End(xlUp).row\n    'Set rng = .Range(\"C4:C\" &amp; RowLast)\n    .Range(\"A3:J\" &amp; RowLast).AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=.Range(\"N1:N6\"), Unique:=False\nEnd With\n</code></pre>\n\n<p>Note <code>.Range(\"C4:C\"...</code> and <code>.Range(\"N1:N6\")</code> prefaced with a period. This indicates that the parent worksheet of the range(s) are defined by the worksheet named in the <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a>. Without it, Excel is making a guess as to which worksheet the range belongs to; typically this would be the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">ActiveSheet property</a>.</p>\n"}], "owner": {"reputation": 97, "user_id": 5266543, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh4.googleusercontent.com/-QjQe9l2QnUQ/AAAAAAAAAAI/AAAAAAAABbI/e6YUfZWuAiY/photo.jpg?sz=128", "display_name": "Prafulla Kumar Shahi", "link": "https://stackoverflow.com/users/5266543/prafulla-kumar-shahi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 32217342, "answer_count": 1, "score": 1, "last_activity_date": 1440558265, "creation_date": 1440553824, "last_edit_date": 1440556262, "question_id": 32216761, "link": "https://stackoverflow.com/questions/32216761/extract-range-is-not-defined-advanced-filter", "title": "&quot;Extract range is not defined&quot;: advanced filter", "body": "<p>I am trying to run this simple code in VBA but it keeps giving me \"extract range is not defined\" error:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    'Dim rng As Range\n    Dim RowLast As Long\n    Dim perporig As Workbook\n    count = 0\n    Set perporig = Workbooks.Open(\"\\\\Etnfps02\\vol1\\DATA\\Inventory\\Daily tracking\\perpetual.xlsx\", , ReadOnly)\n    With perporig.Sheets(\"perpetual\")\n        .AutoFilterMode = False\n        RowLast = .Cells(Rows.count, \"A\").End(xlUp).row\n        'Set rng = .Range(\"C4:C\" &amp; RowLast)\n        Range(\"A3:J\" &amp; RowLast).AdvancedFilter Action:=xlFilterCopy, CriteriaRange:=Range(\"N1:N6\"), Unique:=False 'have also tried Range(\"A3:J3\"), doesn't work.\n\n    End With\n    ThisWorkbook.Sheets(\"myperpetual\").Range(\"A5\", \"J5\").PasteSpecial xlPasteValues\nEnd Sub\n</code></pre>\n\n<p>I am trying to copy from a file with data starting from A4:J4 to some A16000:J16000. I have to filter the values in column C to a range I have specified in the worksheet in range N1:N6.<br>\nFYI: Table header A4 is empty, and B4:J4 have relevant headers in them.<br>\nAlso please let me know if my copy-paste method is wrong, or for some reason wouldn't work as expected.  </p>\n\n<p>EDIT: I also tried adding a header in column A , i.e. cell A3. Still doesn't work.<br>\nMy range N1:N6 is a list of numbers, but I am sure the mistake lies there. It doesn't specify which column to apply filter on.</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1440551735, "post_id": 32216431, "comment_id": 52316749, "body": "IIRC, you cannot interchange fixed size arrays and dynamic arrays."}], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1440552521, "post_id": 32216551, "comment_id": 52316936, "body": "A UDF with array argument <code>{&quot;A&quot;,&quot;B&quot;,&quot;C&quot;}</code> does not pass as an static array in VBA. Variant is what should be used instead."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440552762, "post_id": 32216551, "comment_id": 52316984, "body": "What if the <code>arr</code> being passed in was zero-based, e.g. with an LBound(arr) of 0? Your For... Next is going to skip the first array element."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1440556550, "post_id": 32216551, "comment_id": 52317801, "body": "Well yes. So I fixed the post. I was assuming it was going to be used as an UDF only."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1440556325, "last_edit_date": 1440556325, "creation_date": 1440552129, "answer_id": 32216551, "question_id": 32216431, "link": "https://stackoverflow.com/questions/32216431/passing-excel-string-array-to-user-defined-vba-function/32216551#32216551", "title": "Passing Excel string array to user defined VBA function", "body": "<p>I was able to get what you want with:</p>\n\n<pre><code>Public Function ConcatString(ByVal arr As Variant) As String\n    ConcatString = vbNullString\n    Dim i As Long, n As Long, z as Long\n    z = LBound(arr) : n = UBound(arr)\n    For i = z To n\n        ConcatString = ConcatString + arr(i)\n    Next i\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/8hP34.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8hP34.png\" alt=\"use\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 5266471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfd9b49109aebcd4ee18fff251672db?s=128&d=identicon&r=PG&f=1", "display_name": "Lulu", "link": "https://stackoverflow.com/users/5266471/lulu"}, "edited": false, "score": 0, "creation_date": 1440555337, "post_id": 32216557, "comment_id": 52317532, "body": "Thank you all, much appreciated"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1440552431, "last_edit_date": 1440552431, "creation_date": 1440552179, "answer_id": 32216557, "question_id": 32216431, "link": "https://stackoverflow.com/questions/32216431/passing-excel-string-array-to-user-defined-vba-function/32216557#32216557", "title": "Passing Excel string array to user defined VBA function", "body": "<p>Declare, dim, assign and pass the array over as a variant.</p>\n\n<pre><code>Sub StrTest()\n    Dim StaticArray As Variant, Result As String\n\n    ReDim StaticArray(1 To 3)\n\n    StaticArray(1) = \"A\"\n    StaticArray(2) = \"B\"\n    StaticArray(3) = \"C\"\n\n    Result = ConcStr(Arr:=StaticArray)\n    MsgBox Result\n    Result = ConcStr2(Arr:=StaticArray)\n    MsgBox Result\n\nEnd Sub\n\nFunction ConcStr(Arr As Variant) As String\n    MsgBox \"started\"\n\n    Dim N As Long, Total As String\n\n    For N = LBound(Arr) To UBound(Arr)\n        MsgBox Arr(N)\n        Total = Total &amp; \",\" &amp; Arr(N)\n    Next N\n\n    ConcStr = Mid(Total, 2) 'Mid to get rid of the first comma\n\nEnd Function\n\nFunction ConcStr2(Arr As Variant) As String\n    'could just be like this,\n    ConcStr2 = Join(Arr, \",\")\nEnd Function\n</code></pre>\n\n<p>I've added an alternative <a href=\"https://msdn.microsoft.com/en-us/library/b65z3h4h%28v=vs.90%29.aspx\" rel=\"nofollow\">Join Function</a> version to simplfy things and modified your function with the <a href=\"https://msdn.microsoft.com/en-us/library/05e63829%28v=vs.90%29.aspx\" rel=\"nofollow\">Mid function</a> to remove the leading comma.</p>\n"}, {"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 1, "last_activity_date": 1440552182, "creation_date": 1440552182, "answer_id": 32216558, "question_id": 32216431, "link": "https://stackoverflow.com/questions/32216431/passing-excel-string-array-to-user-defined-vba-function/32216558#32216558", "title": "Passing Excel string array to user defined VBA function", "body": "<p>If you rewrite your UDF to accept a <code>Variant</code> instead, it should work. Also, you can just use the <code>Join</code> function to accomplish what you need:</p>\n\n<pre><code>Function ConcStr(arr As Variant) As String\n    ConcStr = Join(arr, \",\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5266471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dfd9b49109aebcd4ee18fff251672db?s=128&d=identicon&r=PG&f=1", "display_name": "Lulu", "link": "https://stackoverflow.com/users/5266471/lulu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1088, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1440556325, "creation_date": 1440551226, "last_edit_date": 1440552561, "question_id": 32216431, "link": "https://stackoverflow.com/questions/32216431/passing-excel-string-array-to-user-defined-vba-function", "title": "Passing Excel string array to user defined VBA function", "body": "<p>I wish to use an Excel array function to generate an array of strings and then pass this to a user defined function to strip blanks and concatenate the strings separated by a <code>\",\"</code>.</p>\n\n<p>I have a function that does this when called from a VBA macro.  When I try to use it as a user defined function, e.g. <code>=ConcStr({\"A\",\"B\",\"C\"})</code>, I get a <code>#Value!</code> error.</p>\n\n<p>Function is below:</p>\n\n<pre><code>Sub StrTest()\n    Dim StaticArray(1 To 3) As String\n    Dim Result As String\n    StaticArray(1) = \"A\"\n    StaticArray(2) = \"B\"\n    StaticArray(3) = \"C\"\n    Result = ConcStr(Arr:=StaticArray)\n    MsgBox Result\nEnd Sub\n\nFunction ConcStr(Arr() As String) As String\n    MsgBox \"started\"\n    Dim N As Long\n    Dim Total As String\n    For N = LBound(Arr) To UBound(Arr)\n        MsgBox Arr(N)\n        Total = Total &amp; \",\" &amp; Arr(N)\n    Next N\n    ConcStr = Total\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "edited": false, "score": 0, "creation_date": 1440557052, "post_id": 32216483, "comment_id": 52317918, "body": "Thanks Jeeped for the code and the explanation, it was helpful"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1440551561, "creation_date": 1440551561, "answer_id": 32216483, "question_id": 32216103, "link": "https://stackoverflow.com/questions/32216103/alter-sub-to-use-istext-to-istext-or-isnumber-excel-2013/32216483#32216483", "title": "Alter Sub to use IsText to IsText Or IsNumber excel 2013", "body": "<p>A cell containing a non-breaking space will never be considered a number no matter how many digits or decimal places it contains. Better to just replace all formulas with their returned values and remove all non-breaking spaces.</p>\n\n<pre><code>Sub Cleanup()\n\n    With ActiveSheet.UsedRange.offset(1,0)\n        .Value = .value\n        .replace what:=chr(160), replacement:=vbnullstring, lookat:=xlpart\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Additional cleanup could be performed by removing lingering worksheet errors like <code>#N/A</code> or <code>#VALUE!</code> with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow\">Range.SpecialCells method</a>. This is also a way to look for numbers in formulas or typed values throughout the worksheet but as stated, if a cell contains a non-breaking space it will never be considered a number.</p>\n\n<p>fwiw, your <a href=\"https://msdn.microsoft.com/en-us/library/office/ff193019.aspx\" rel=\"nofollow\">Application.Evaluate method</a> may be leaving zero-length strings, not truly blank cells like the above procedure.</p>\n"}], "owner": {"reputation": 1972, "user_id": 1304458, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/dc6ea084fbd20a88381173e9aaf4de00?s=128&d=identicon&r=PG", "display_name": "xyz", "link": "https://stackoverflow.com/users/1304458/xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 32216483, "answer_count": 1, "score": 1, "last_activity_date": 1440551561, "creation_date": 1440548182, "last_edit_date": 1531164843, "question_id": 32216103, "link": "https://stackoverflow.com/questions/32216103/alter-sub-to-use-istext-to-istext-or-isnumber-excel-2013", "title": "Alter Sub to use IsText to IsText Or IsNumber excel 2013", "body": "<p>This works fine but I want it to work on text or numbers</p>\n\n<pre><code>Sub Cleanup()\nWith ActiveSheet.UsedRange.offset(1,0)\n  .Value = Evaluate(\"IF(ISTEXT(\" &amp; .Address &amp; \"), _\n            TRIM(SUBSTITUTE(\" &amp; .Address &amp; \",CHAR(160),\"\"\"\")), _\n               REPT(\" &amp; .Address &amp; \",1))\")\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I have tried (not working)</p>\n\n<pre><code>.Value = Evaluate(\"IF(oR(ISTEXT(\" &amp; .Address &amp; \"), _\n          TRIM(SUBSTITUTE(\" &amp; .Address &amp; \",CHAR(160),\"\"\"\")), _\n          REPT(\" &amp; .Address &amp; \",1), _\n          IsNummeric((\" &amp; .Address &amp; \"),TRIM(SUBSTITUTE(\" &amp; .Address &amp; \",CHAR(160),\"\"\"\")), _\n          REPT(\" &amp; .Address &amp; \",1)))\")\n</code></pre>\n\n<p>But (after about an hour of trying) it just turns everything to <code>#value!</code></p>\n"}, {"tags": ["matlab", "excel", "com", "vba"], "answers": [{"comments": [{"owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "edited": false, "score": 0, "creation_date": 1440551496, "post_id": 32216163, "comment_id": 52316701, "body": "Thank you, Joehanna. I found the Excel.Application.Run command as well. The format Excel.Application.Run &quot;macroname&quot;; does not work though in Matlab though. It has to be Excel.Application.Run(&#39;macroname&#39;);"}, {"owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "reply_to_user": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "edited": false, "score": 1, "creation_date": 1440551990, "post_id": 32216163, "comment_id": 52316793, "body": "Great!  I will update my answer for future visitors."}], "tags": [], "owner": {"reputation": 1396, "user_id": 1337635, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVMWU.png?s=128&g=1", "display_name": "joehanna", "link": "https://stackoverflow.com/users/1337635/joehanna"}, "is_accepted": true, "score": 3, "last_activity_date": 1440551997, "last_edit_date": 1440551997, "creation_date": 1440548685, "answer_id": 32216163, "question_id": 32215697, "link": "https://stackoverflow.com/questions/32215697/how-can-i-invoke-an-excel-macro-in-excel-from-matlab/32216163#32216163", "title": "How can I invoke an Excel Macro in Excel from Matlab?", "body": "<p>You are almost there.  Make a call to <code>Application.Run(\"macroname\")</code> and you should be fine.  Make sure <code>macroname</code> is in a VBA <code>Module</code> in your Excel Workbook and has <code>Public</code> scope.</p>\n\n<pre><code>filename = './sampleWorkbook';\nExcel = actxserver('Excel.Application');\nworkbook = Excel.Workbooks.Open(filename);\nExcel.Application.Run(\"macroname\");\n</code></pre>\n\n<p>Here is a link to MSDN documentation for <code>Application.Run</code> : <a href=\"https://msdn.microsoft.com/en-us/library/office/ff197132.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff197132.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "is_accepted": false, "score": 1, "last_activity_date": 1440551850, "creation_date": 1440551850, "answer_id": 32216516, "question_id": 32215697, "link": "https://stackoverflow.com/questions/32215697/how-can-i-invoke-an-excel-macro-in-excel-from-matlab/32216516#32216516", "title": "How can I invoke an Excel Macro in Excel from Matlab?", "body": "<p>I have found the answer, coming very close to what joehanna has, but with the Run command in the correct Matlab format and closing the workbook previously opened and releasing the activeX server.</p>\n\n<pre><code>filename = 'C:\\Book1.xlsm';\nexcel = actxserver('Excel.Application');\n%excel.Visible = 1;\nexcel.Workbooks.Open(filename);\nretval = excel.Run('trial');\nexcel.Workbooks(1).Close\nexcel.Quit\nexcel.release\n</code></pre>\n"}], "owner": {"reputation": 981, "user_id": 2227222, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d80812002213736d9576158000e84d98?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/2227222/hans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2027, "favorite_count": 0, "accepted_answer_id": 32216163, "answer_count": 2, "score": 1, "last_activity_date": 1440574262, "creation_date": 1440545044, "last_edit_date": 1531164843, "question_id": 32215697, "link": "https://stackoverflow.com/questions/32215697/how-can-i-invoke-an-excel-macro-in-excel-from-matlab", "title": "How can I invoke an Excel Macro in Excel from Matlab?", "body": "<p>I would like to invoke an Excel Macro or an VBA function in Excel from Matlab. How should achieve this? I suppose I should create a handle with</p>\n\n<pre><code>filename = './sampleWorkbook';\nExcel = actxserver('Excel.Application');\nworkbook = Excel.Workbooks.Open(filename);\n</code></pre>\n\n<p>Then how should I proceed to invoke an VBA funciton in that Excel workbook filename?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1440545050, "creation_date": 1440545050, "answer_id": 32215699, "question_id": 32215222, "link": "https://stackoverflow.com/questions/32215222/find-sheet-name-with-table-on-it/32215699#32215699", "title": "Find Sheet Name with table on it", "body": "<p>This is not something I recommend but as you are referencing the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff821871.aspx\" rel=\"nofollow\">ActiveWorkbook</a>, you can drop the <code>ActiveWorkbook</code> and retrieve it simply as,</p>\n\n<pre><code>dim pws as worksheet, sws as string\nsws = range(\"ratetable\").parent.name\nset pws = range(\"ratetable\").parent\ndebug.print sws &amp; \" - \" &amp; pws.name\n</code></pre>\n\n<p>While a structured table (aka <a href=\"https://msdn.microsoft.com/en-us/library/office/aa174247(v=office.11).aspx\" rel=\"nofollow\">ListObject object</a>) is listed in the Formulas \u25ba Name Manager, it does not have all of the properties of a defined name. Unfortunately, everything you can do with a name you cannot always do with a ListObject as a ListObject's parent is the Worksheet object, not the workbook.</p>\n"}, {"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1440549414, "creation_date": 1440549414, "answer_id": 32216231, "question_id": 32215222, "link": "https://stackoverflow.com/questions/32215222/find-sheet-name-with-table-on-it/32216231#32216231", "title": "Find Sheet Name with table on it", "body": "<p>You can use error trapping to find the sheet containing a table with a given name:</p>\n\n<pre><code>Function FindTableSheet(TableName As String) As String\n    Dim ws As Worksheet\n    Dim LO As ListObject\n    Dim shName As String\n\n    For Each ws In Sheets\n        On Error Resume Next\n        Set LO = ws.ListObjects(TableName)\n        If Err.Number = 0 Then\n            FindTableSheet = ws.Name\n            Exit Function\n        Else\n            Err.Clear\n        End If\n    Next ws\n    FindTableSheet = \"Not Found\"\nEnd Function\n</code></pre>\n\n<p>To test it, I named one of my sheets \"Data\" and added a table called \"ratetable\" to that sheet. I didn't, however, create any table called \"table tennis\". I then ran:</p>\n\n<pre><code>Sub test()\n    Debug.Print FindTableSheet(\"ratetable\")\n    Debug.Print FindTableSheet(\"table tennis\")\nEnd Sub\n</code></pre>\n\n<p>With the output:</p>\n\n<pre><code>Data\nNot Found\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2162, "user_id": 5788429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0659ba97b8622faa531a2772249abd2d?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/5788429/anton"}, "edited": false, "score": 0, "creation_date": 1567670551, "post_id": 38000178, "comment_id": 102033994, "body": "You assume the table is located on the active sheet which is obviously not the case. OP is looking for the sheet."}], "tags": [], "owner": {"reputation": 1, "user_id": 6168203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e392d103a7ebea9145f2def7b846a4fe?s=128&d=identicon&r=PG&f=1", "display_name": "MacAbe", "link": "https://stackoverflow.com/users/6168203/macabe"}, "is_accepted": false, "score": -1, "last_activity_date": 1466709968, "creation_date": 1466709968, "answer_id": 38000178, "question_id": 32215222, "link": "https://stackoverflow.com/questions/32215222/find-sheet-name-with-table-on-it/38000178#38000178", "title": "Find Sheet Name with table on it", "body": "<p>I know this post is old, but for what it's worth, I think the OP was on the right track (looking for the parent name) with the initial code that you originally posted.  Calling the table's parent works for me:</p>\n\n<pre><code>ActiveSheet.ListObjects(\"TableName\").Parent.Name\n</code></pre>\n"}], "owner": {"reputation": 286, "user_id": 5261233, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/i5rHw.jpg?s=128&g=1", "display_name": "Histerical", "link": "https://stackoverflow.com/users/5261233/histerical"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3481, "favorite_count": 0, "accepted_answer_id": 32216231, "answer_count": 3, "score": 1, "last_activity_date": 1466709968, "creation_date": 1440542170, "last_edit_date": 1531161705, "question_id": 32215222, "link": "https://stackoverflow.com/questions/32215222/find-sheet-name-with-table-on-it", "title": "Find Sheet Name with table on it", "body": "<p>I am trying to find the sheet name that has a specific table name on it. For example:</p>\n\n<pre><code>Set sheetNM = ActiveWorkbook.Names(\"ratetable\").RefersToRange.Parent.Name\n</code></pre>\n\n<p>Something like that, but would pull the name of the sheet, so I can activate that sheet in order to pull information from it.</p>\n"}, {"tags": ["excel", "vba", "list", "cell"], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 0, "last_activity_date": 1440542096, "creation_date": 1440542096, "answer_id": 32215206, "question_id": 32215155, "link": "https://stackoverflow.com/questions/32215155/how-to-add-values-from-a-cell-list-to-existing-values-in-cells/32215206#32215206", "title": "How to add values from a cell list to existing values in cells", "body": "<p>You can retrieve the value from the cell in column A and pass it to <code>Range()</code> to address the cell in your other sheet.</p>\n\n<p>For example:</p>\n\n<pre><code>' Use A1 as an example...\nDim r As Range\nSet r = Range(\"A1\")\n\n' Use A1's value to address a cell on Sheet2 and assign the value from B1...\nSheet2.Range(r.Value).Value = r.Offset(, 1).Value\n</code></pre>\n"}], "owner": {"reputation": 68, "user_id": 5266230, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HD8Y-oeynXQ/AAAAAAAAAAI/AAAAAAAAABo/KnRIO92yzKs/photo.jpg?sz=128", "display_name": "aggelos garaleas", "link": "https://stackoverflow.com/users/5266230/aggelos-garaleas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 713, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440543918, "creation_date": 1440541877, "last_edit_date": 1440543918, "question_id": 32215155, "link": "https://stackoverflow.com/questions/32215155/how-to-add-values-from-a-cell-list-to-existing-values-in-cells", "title": "How to add values from a cell list to existing values in cells", "body": "<p>In Microsoft Excel, I have two columns in a sheet. The first column has values like <code>B2</code>,<code>A13</code>,<code>BB125</code> and the next column has some number values like <code>12</code>,<code>569</code>,<code>78</code>. </p>\n\n<p>I want to find the cell from the first column in another sheet and to that cell add the value from the second column.</p>\n\n<p>Does anyone know how to do that?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440541706, "post_id": 32214976, "comment_id": 52313926, "body": "I am not so sure op means &quot;unchecked&quot; as in string but perhaps a checkbox in the cell."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 2, "creation_date": 1440542125, "post_id": 32214976, "comment_id": 52314065, "body": "The OP showed no original effort. This a generic framework only and is specifically intended not to be a turn-key solution. As an avid <a href=\"http://stackoverflow.com/tour\">programming enthusiast</a>, the OP should welcome the challenge to create something of their own once given the basic tools."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440542257, "post_id": 32214976, "comment_id": 52314124, "body": "Not turn key solution from Jeeped??? Downvoted =P Btw, you know any reference material I can read up on <code>workbooks.open</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440542315, "post_id": 32214976, "comment_id": 52314146, "body": "Here is <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195811(v=office.11).aspx\" rel=\"nofollow noreferrer\">Workbooks.Open method</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837097.aspx\" rel=\"nofollow noreferrer\">Workbooks.OpenText method</a>."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440542454, "post_id": 32214976, "comment_id": 52314191, "body": "Thanks but I was reading <a href=\"https://msdn.microsoft.com/en-us/library/office/ff194819.aspx\" rel=\"nofollow noreferrer\">a more recent version</a> and it&#39;s not really helpful. Let me clarify. I need something very nuanced. Like discuss inner workings/memory swap/whatever jargon I don&#39;t know with regards to the function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 1, "creation_date": 1440542555, "post_id": 32214976, "comment_id": 52314232, "body": "Don&#39;t think I have anything off the top of my head at the moment but I will keep it (and you) in mind."}, {"owner": {"reputation": 1, "user_id": 5266145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/519590c56cfe8deb5a3baa2ecfebaa4e?s=128&d=identicon&r=PG&f=1", "display_name": "pantrygirl", "link": "https://stackoverflow.com/users/5266145/pantrygirl"}, "edited": false, "score": 0, "creation_date": 1441039966, "post_id": 32214976, "comment_id": 52507311, "body": "Thank you Jeeped. I am very new to this and your guidance is appreciated."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1440540883, "creation_date": 1440540883, "answer_id": 32214976, "question_id": 32214768, "link": "https://stackoverflow.com/questions/32214768/replace-cell-with-header-cell/32214976#32214976", "title": "Replace Cell with Header Cell", "body": "<p>Just cycle through the columns, replacing the term <em>\"unchecked\"</em> with the value found in the first row of that column.</p>\n\n<pre><code>dim c as long, rplc as string\nrplc = \"unchecked\"\nwith activesheet\n    with .cells(1, 1).currentregion\n        for c = 1 to .columns.count\n            with .columns(c)\n                .replace what:=rplc, replacement:=.cells(1, 1).value2, _\n                         lookat:=xlwhole, matchcase:=false\n            end with\n        next c\n    end with\nend with\n</code></pre>\n\n<p>This is a generic framework and is intended to give you something to get started with. Transcribe it for your own purposes and use debug (e.g. <code>F8</code>) to walk through the code to make sure it is doing what you want. If you run into trouble, come back and explain what you do not understand, what errors are occurring and what you have discovered through debug.</p>\n\n<p>You will want to change the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff822753.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">ActiveSheet property</a> reference to an actual worksheet name.</p>\n"}], "owner": {"reputation": 1, "user_id": 5266145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/519590c56cfe8deb5a3baa2ecfebaa4e?s=128&d=identicon&r=PG&f=1", "display_name": "pantrygirl", "link": "https://stackoverflow.com/users/5266145/pantrygirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1440540883, "creation_date": 1440539777, "last_edit_date": 1440540019, "question_id": 32214768, "link": "https://stackoverflow.com/questions/32214768/replace-cell-with-header-cell", "title": "Replace Cell with Header Cell", "body": "<p>I'm trying to figure out how to either substitute or replace a cell's data with existing data from a header cell.</p>\n\n<p>In the most succinct way to describe it:</p>\n\n<p><strong>If cell = 'unchecked', then replace with the cell's header cell.</strong></p>\n\n<p>There are numerous columns so I can't specifically say replace with a specific cell for all. It would vary depending on the cell.</p>\n\n<p>As in: <em>(not code but won't let me save request without indentation.)</em><br>\n    C3=unchecked, then pull C1.<br>\n    H18=unchecked, then pull H1.<br>\n    P4=unchecked, then pull P1.</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"reputation": 9, "user_id": 4531419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f63e8ecf710b3b2daba7245e457026?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4531419/viktor"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1440540123, "post_id": 32214741, "comment_id": 52313362, "body": "I have found examples of loops in VBA code on Stack Overflow. I have not found examples of loops in VBA code on Stack Overflow which involve selecting a range, copying that range, selecting a new range, filtering on that range, and then pasting special over that new range.  With the ranges being the variables, it appears to be a different dynamic than a simple loop example."}, {"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1440541514, "post_id": 32214741, "comment_id": 52313856, "body": "lol the likelihood of finding an example that fits your needs 100% is next to nil. pnuts was suggesting that you study some similar examples and apply them. You know, not asking to be spoon fed XD Hint: don&#39;t use range. Use <code>cells()</code>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1440541635, "post_id": 32214741, "comment_id": 52313897, "body": "Quite funny. I found <a href=\"http://stackoverflow.com/a/14816374/62576\">this answer</a> in the third item in the list of related questions to the right (over there -----&gt;&gt;&gt;&gt;&gt;&gt;) in about half a second, and it shows how to do <b>exactly</b> what you&#39;re asking here.. It doesn&#39;t seem like you tried very hard to find an answer before posting."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 4531419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f63e8ecf710b3b2daba7245e457026?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4531419/viktor"}, "edited": false, "score": 0, "creation_date": 1440595442, "post_id": 32226724, "comment_id": 52338247, "body": "Thanks for the reply! I will try the concatenate menthod.The problem lies in that I am selecting only cells which have numbers in them in the range <code>S3:B256</code> (i.e. I select the entire range, and then use the &#39;Go-to special&#39; function). From there, I paste special-add the data. Since the ranges are not the same size, I get the paste error."}, {"owner": {"reputation": 9, "user_id": 4531419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f63e8ecf710b3b2daba7245e457026?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4531419/viktor"}, "edited": false, "score": 0, "creation_date": 1440596179, "post_id": 32226724, "comment_id": 52338810, "body": "Concatenation with the longer range seems to be an issue. It won&#39;t accept <code>Range(&quot;S&quot; &amp; x : &quot;B&quot; &amp; x</code>"}, {"owner": {"reputation": 430, "user_id": 2062411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb35690c8349a6ac102b26378343981d?s=128&d=identicon&r=PG", "display_name": "Tyler StandishMan", "link": "https://stackoverflow.com/users/2062411/tyler-standishman"}, "reply_to_user": {"reputation": 9, "user_id": 4531419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f63e8ecf710b3b2daba7245e457026?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4531419/viktor"}, "edited": false, "score": 0, "creation_date": 1440596933, "post_id": 32226724, "comment_id": 52339384, "body": "Concatenation on the longer range works just fine, it&#39;s a typo in your implementation of it. Look at what you have written, and think of how it translates to a static range like I typed in: <code>Range(&quot;A1:B1&quot;)</code>"}, {"owner": {"reputation": 430, "user_id": 2062411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb35690c8349a6ac102b26378343981d?s=128&d=identicon&r=PG", "display_name": "Tyler StandishMan", "link": "https://stackoverflow.com/users/2062411/tyler-standishman"}, "reply_to_user": {"reputation": 9, "user_id": 4531419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f63e8ecf710b3b2daba7245e457026?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4531419/viktor"}, "edited": false, "score": 0, "creation_date": 1440597084, "post_id": 32226724, "comment_id": 52339509, "body": "In response to your first comment, I was able to copy my example directly out and run it with no problems. If you could perhaps provide sample data in your question, I could recreate your problem."}], "tags": [], "owner": {"reputation": 430, "user_id": 2062411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb35690c8349a6ac102b26378343981d?s=128&d=identicon&r=PG", "display_name": "Tyler StandishMan", "link": "https://stackoverflow.com/users/2062411/tyler-standishman"}, "is_accepted": false, "score": 0, "last_activity_date": 1440596753, "last_edit_date": 1440596753, "creation_date": 1440592162, "answer_id": 32226724, "question_id": 32214741, "link": "https://stackoverflow.com/questions/32214741/optimizing-recorded-macro-i-know-i-need-to-write-a-loop-but-am-unsure-how-to-d/32226724#32226724", "title": "Optimizing recorded macro; I know I need to write a loop, but am unsure how to do so", "body": "<p>To answer you conundrum about \"I can't just put x\", sure you can, with concatenation. <code>Range(\"C\" &amp; x)</code> would provide what you're looking for.</p>\n\n<p>But, based on your given example, you seem to know the range you're wanting to iterate through; why not just select the range once, and paste the range once?</p>\n\n<pre><code>Range(\"C3:C256\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"S3:BL256\").Select\nSelection.SpecialCells(xlCellTypeConstants, 1).Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _\n    False, Transpose:=False\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4531419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f63e8ecf710b3b2daba7245e457026?s=128&d=identicon&r=PG&f=1", "display_name": "Viktor", "link": "https://stackoverflow.com/users/4531419/viktor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1440596753, "creation_date": 1440539631, "last_edit_date": 1440541102, "question_id": 32214741, "link": "https://stackoverflow.com/questions/32214741/optimizing-recorded-macro-i-know-i-need-to-write-a-loop-but-am-unsure-how-to-d", "title": "Optimizing recorded macro; I know I need to write a loop, but am unsure how to do so", "body": "<p>I have a block of code that goes like this:</p>\n\n<pre><code>Range(\"C3\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"S3:BL3\").Select\nSelection.SpecialCells(xlCellTypeConstants, 1).Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _\n    False, Transpose:=False\nRange(\"C4\").Select\nApplication.CutCopyMode = False\nSelection.Copy\nRange(\"S4:BL4\").Select\nSelection.SpecialCells(xlCellTypeConstants, 1).Select\nSelection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _\n    False, Transpose:=False\n\n... and so on until row 257\n</code></pre>\n\n<p>The only part of the code that changes are the ranges I am selecting, so I know that I can write a loop to accomplish this without having to repeat myself on all of the other code, but I'm not really sure where to begin.</p>\n\n<p>I want to do some counter like this, but I know I can't just put the variable \"x\" next to the column letter to have it repeat the process:</p>\n\n<pre><code> For x = 3 to 256\n    Range(\"Cx\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Range(\"Sx:BLx\").Select\n    Selection.SpecialCells(xlCellTypeConstants, 1).Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlAdd, SkipBlanks:= _\n        False, Transpose:=False\n</code></pre>\n"}, {"tags": ["excel", "vba", "methods", "combobox", "member"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5200302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEP4c.jpg?s=128&g=1", "display_name": "notout50", "link": "https://stackoverflow.com/users/5200302/notout50"}, "edited": false, "score": 0, "creation_date": 1440546742, "post_id": 32214797, "comment_id": 52315530, "body": "Sorry I&#39;ve edited the post since then. My dummy program works when using an ActiveX combobox and extracting the value using the .combobox.value within the sheet&#39;s scope."}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 23, "user_id": 5200302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEP4c.jpg?s=128&g=1", "display_name": "notout50", "link": "https://stackoverflow.com/users/5200302/notout50"}, "edited": false, "score": 0, "creation_date": 1440550145, "post_id": 32214797, "comment_id": 52316383, "body": "You can&#39;t use a <code>Worksheet</code> object to access an <code>OLEObject</code> like you&#39;re doing in your first example. If you declare your worksheet as <code>Variant</code> or <code>Object</code> instead, it should work. Or, just use <code>OLEObjects()</code>, as I&#39;ve shown above, which is the recommended way to access ActiveX controls. Then it will work regardless."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 1, "last_activity_date": 1440539928, "creation_date": 1440539928, "answer_id": 32214797, "question_id": 32214701, "link": "https://stackoverflow.com/questions/32214701/activex-combobox-method-or-data-member-not-found/32214797#32214797", "title": "ActiveX ComboBox method or data member not found", "body": "<p>If it's an ActiveX control, you need to use the <code>OLEObjects</code> collection to access it:</p>\n\n<pre><code>Debug.Print ws.OLEObjects(\"userBox\").Object.Text\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5200302, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEP4c.jpg?s=128&g=1", "display_name": "notout50", "link": "https://stackoverflow.com/users/5200302/notout50"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1890, "favorite_count": 0, "accepted_answer_id": 32214797, "answer_count": 1, "score": 2, "last_activity_date": 1440552767, "creation_date": 1440539442, "last_edit_date": 1440552767, "question_id": 32214701, "link": "https://stackoverflow.com/questions/32214701/activex-combobox-method-or-data-member-not-found", "title": "ActiveX ComboBox method or data member not found", "body": "<p>I have a combobox (called <code>userBox</code>) within a sheet called <code>Home</code>. It has one of the options selected, let's say <code>\"User A\"</code>. All I'm trying to do is assign <code>\"User A\"</code> to string <code>usr</code>, but I keep getting the compile error:</p>\n\n<blockquote>\n  <p>Method or data member not found</p>\n</blockquote>\n\n<pre><code>Sub fixPls()\nDim row As Integer, col As Integer, usr As String, tbl As String, found  As Boolean, k As Integer, payType As String\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Home\")\nws.Activate\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nlastRow = Range(\"B16\").End(xlUp).row\nusr = ws.userBox.Value\ntbl = ws.tblBox.Value\npayType = ws.tpBox.Value\n....\n</code></pre>\n\n<p>EDIT: I tried a dummy program in a new workbook, and it worked. Using an activeX comboBox, why is it different?</p>\n\n<pre><code>Sub blah()\nDim rly As String\nrly = Sheets(1).ComboBox1.Value\nThisWorkbook.Sheets(1).Cells(1, 10) = rly \nEnd Sub\n</code></pre>\n\n<p>Cell J1 returns the value selecting in the comboBox.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 1, "creation_date": 1440538156, "post_id": 32214327, "comment_id": 52312520, "body": "Is the dropdown menu a data validation and what cell is it in?"}], "answers": [{"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 1, "last_activity_date": 1440538293, "creation_date": 1440538293, "answer_id": 32214468, "question_id": 32214327, "link": "https://stackoverflow.com/questions/32214327/use-dropdown-menu-choice-in-excel-vba-code/32214468#32214468", "title": "Use dropdown menu choice in Excel VBA code", "body": "<p>Change the range to what cell you require.</p>\n\n<pre><code>Sub Button2_Click()\n    Dim r As String\n    r = Range(\"A1\")\n    Sheets(r).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5266080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41e557448eb3fcf8fd426bb976753c6?s=128&d=identicon&r=PG", "display_name": "user5266080", "link": "https://stackoverflow.com/users/5266080/user5266080"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1440636615, "creation_date": 1440537698, "last_edit_date": 1531161705, "question_id": 32214327, "link": "https://stackoverflow.com/questions/32214327/use-dropdown-menu-choice-in-excel-vba-code", "title": "Use dropdown menu choice in Excel VBA code", "body": "<p>I have a sheet containing names of products and their categories. In a separate sheet I created a drop down menu of categories and right by the side of that drop down I inserted a \"go\" button.</p>\n\n<p>I want if I select Category 1 from the drop down menu and then click go, it should open a sheet containing products that are of category 1 only.</p>\n\n<p>I was able to do it by assigning a macro. But the problem occurred when after this I selected category 2 and pressed the button it showed me products of 1 (of course I assigned that).</p>\n\n<p>How do I make it dynamic? I want the button to redirect me with respect to the option I chose in drop down menu.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 10255, "user_id": 1024832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/954d8559c2d4cd308e4c2795423dd268?s=128&d=identicon&r=PG", "display_name": "Marc", "link": "https://stackoverflow.com/users/1024832/marc"}, "edited": false, "score": 1, "creation_date": 1440539311, "post_id": 32213886, "comment_id": 52313032, "body": "Seems like a candidate for Excel&#39;s built-in auto-filter capability.  Shouldn&#39;t require a macro at all."}], "answers": [{"comments": [{"owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "edited": false, "score": 0, "creation_date": 1440536829, "post_id": 32214008, "comment_id": 52311903, "body": "the results &quot;x&quot; and &quot;0&quot; are created using a formula. will still this work? if not, maybe i can change the &quot;0&quot; to just blank..?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440537962, "post_id": 32214008, "comment_id": 52312435, "body": "If the zeroes are returned as <code>0</code> and not <code>&quot;0&quot;</code> then this will work by changing <code>xlCellTypeConstants</code> to <code>xlCellTypeFormulas</code>. See <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196157.aspx\" rel=\"nofollow noreferrer\">Range.SpecialCells method</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1440538721, "post_id": 32214008, "comment_id": 52312777, "body": "fwiw, F5, Special, Formulas, Text is a quick way to test this method without writing a line of code."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 3, "last_activity_date": 1440538479, "last_edit_date": 1440538479, "creation_date": 1440536529, "answer_id": 32214008, "question_id": 32213886, "link": "https://stackoverflow.com/questions/32213886/find-all-instances-and-hide-rows/32214008#32214008", "title": "Find all instances and hide rows", "body": "<p>You can use the <code>SpecialCells()</code> function to find text values. Then, hide just those rows.</p>\n\n<p>Assuming you want to check column <code>A</code>, this should do the trick:</p>\n\n<pre><code>Range(\"A:A\").SpecialCells(xlCellTypeConstants, xlTextValues).EntireRow.Hidden = True\n</code></pre>\n\n<p><strong>Edit</strong>: Per @Jeeped's comment below</p>\n\n<p>If you're using formulas and you have your formula return <code>0</code> instead of <code>\"0\"</code>, then this should work:</p>\n\n<pre><code>Range(\"A:A\").SpecialCells(xlCellTypeFormulas, xlTextValues).EntireRow.Hidden = True\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1440536895, "creation_date": 1440536895, "answer_id": 32214109, "question_id": 32213886, "link": "https://stackoverflow.com/questions/32213886/find-all-instances-and-hide-rows/32214109#32214109", "title": "Find all instances and hide rows", "body": "<p>The following assumes a column header label in A1.</p>\n\n<pre><code>with activesheet\n    if .autofiltermode then .autofiltermode = false\n    with .range(.cells(1,1), .cells(rows.count, 1).end(xlup))\n        .autofilter field:=1, criteria1:=\"x\", VisibleDropDown:=False\n    end with\nend with\n</code></pre>\n\n<p>This is just an <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221844%28v=office.11%29.aspx\" rel=\"nofollow\">AutoFilter Method</a> with the little arrow hidden. You can unhide the rows with conventional unhide commands or Data \u25ba Sort &amp; Filter \u25ba Clear or simply turning off the AutoFilter.</p>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 1, "accepted_answer_id": 32214008, "answer_count": 2, "score": 1, "last_activity_date": 1440541452, "creation_date": 1440536102, "last_edit_date": 1440541452, "question_id": 32213886, "link": "https://stackoverflow.com/questions/32213886/find-all-instances-and-hide-rows", "title": "Find all instances and hide rows", "body": "<p>I have a column which can either take values of <code>x</code> or <code>0</code>:</p>\n\n<pre><code>x\nx\n0\n0\nx\n0\n</code></pre>\n\n<p>I am looking for a fast macro which will find all <code>x</code> values and hide these rows. I can do this by using <code>For each cell .. next</code> but I am thinking there must be a faster way using an array or something.</p>\n"}, {"tags": ["vba", "perl"], "comments": [{"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "edited": false, "score": 0, "creation_date": 1440535678, "post_id": 32213550, "comment_id": 52311350, "body": "Could you clarify in what VB environment this is running? Inside an Office application, or perhaps in old VB6?"}], "answers": [{"comments": [{"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1440536012, "post_id": 32213617, "comment_id": 52311522, "body": "Excel 2010 is the VB environment.  Thank you :)."}], "tags": [], "owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1440536251, "last_edit_date": 1440536251, "creation_date": 1440535139, "answer_id": 32213617, "question_id": 32213550, "link": "https://stackoverflow.com/questions/32213550/invoking-perl-script-via-shell-from-vba/32213617#32213617", "title": "Invoking PERL script via Shell from VBA", "body": "<p>Based on feedback from OP, the \"Shell\" statement should be adquate for invoking an external procedure. </p>\n\n<p>The issue is with the nested function. Move 'Function Chk()' such that it is at the same level in the source as any other function or sub. As declared, this is a nested function, which is not supported in VBA (or any other VB I'm aware of).</p>\n"}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 32213617, "answer_count": 1, "score": 0, "last_activity_date": 1440559331, "creation_date": 1440534852, "last_edit_date": 1440559331, "question_id": 32213550, "link": "https://stackoverflow.com/questions/32213550/invoking-perl-script-via-shell-from-vba", "title": "Invoking PERL script via Shell from VBA", "body": "<p>I am hoping that the VB below will run a perl script on a directory that changes based on user input. The issue I am having is I am a syntax error when calling the perl script (in bold). Is this not the right way to call a perl from VB? Thank you :).</p>\n\n<p>VB</p>\n\n<pre><code>Private Sub CommandButton3_Click()\n\nDim MyBarCode   As String      ' Enter Barcode\nDim MyScan      As String      ' Enter ScanDate\nDim MyDirectory As String\n\nMyBarCode = Application.InputBox(\"Please enter the barcode\", \"Bar Code\", Type:=2)\nIf MyBarCode = \"False\" Then Exit Sub   'user canceled\nDo\n    MyScan = Application.InputBox(\"Please enter scan date\", \"Scan Date\", Date, Type:=2)\n    If MyScan = \"False\" Then Exit Sub   'user canceled\n    If IsDate(MyScan) Then Exit Do\n    MsgBox \"Please enter a valid date format. \", vbExclamation, \"Invalid Date Entry\"\nLoop\n\nRange(\"B20\").Value = MyBarCode\nRange(\"B21\").Value = CDate(MyScan)\n\nMyDirectory = \"N:\\1_DATA\\MicroArray\\NexusData\\\" &amp; MyBarCode &amp; \"_\" &amp; Format(CDate(MyScan), \"m-d-yyyy\") &amp; \"\\\"\n' Create nexus directory and folder\nIf Dir(MyDirectory, vbDirectory) = \"\" Then MkDir MyDirectory\n\nIf MsgBox(\"The project file has been created. \" &amp; _\n          \"Do you want to create a template for analysis now?\", _\n          vbQuestion + vbYesNo) = vbYes Then\n\n    'Write to text file\n    Open MyDirectory &amp; \"sample_descriptor.txt\" For Output As #1\n    Print #1, \"Experiment Sample\" &amp; vbTab &amp; \"Control Sample\" &amp; vbTab &amp; \"Display Name\" &amp; vbTab &amp; \"Gender\" &amp; vbTab &amp; \"Control Gender\" &amp; vbTab &amp; \"Spikein\" &amp; vbTab &amp; \"SpikeIn Location\" &amp; vbTab &amp; \"Barcode\"\n    Print #1, MyBarCode &amp; \"_532Block1.txt\" &amp; vbTab &amp; MyBarCode &amp; \"_635Block1.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"B8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"B9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B12\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B20\").Value\n    Print #1, MyBarCode &amp; \"_532Block2.txt\" &amp; vbTab &amp; MyBarCode &amp; \"_635Block2.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"C8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"C9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"C12\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B20\").Value\n    Print #1, MyBarCode &amp; \"_532Block3.txt\" &amp; vbTab &amp; MyBarCode &amp; \"_635Block3.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"D8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"D9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"D12\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B20\").Value\n    Print #1, MyBarCode &amp; \"_532Block4.txt\" &amp; vbTab &amp; MyBarCode &amp; \"_635Block4.txt\" &amp; vbTab &amp; ActiveSheet.Range(\"E8\").Value &amp; \" \" &amp; ActiveSheet.Range(\"E9\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E10\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E5\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E11\").Value &amp; vbTab &amp; ActiveSheet.Range(\"E12\").Value &amp; vbTab &amp; ActiveSheet.Range(\"B20\").Value\n    Close #1\n\n    'Run ImaGene\n    If MsgBox(\"Please run the ImaGene analysis. \" &amp; _\n          \"and click yes after it completes to verify the spike-ins.\", _\n          vbQuestion + vbYesNo) = vbYes Then\n\n    **'Update folder structure and call perl\n    Function Chk()\n    Dim PathCrnt As String\n    Dim RetVal\n\n    PathCrnt = ActiveWorkbook.Path &amp; \"\\\" &amp; MyBarCode &amp; \"_\" &amp; MyScan\n       Chk = Shell(\"C:\\cygwin\\bin\\perl.exe C:\\cygwin\\home\\cmccabe\\get_imagene_spikein_probe_values.pl\", 1)\n       End Function\n    End If**\nElse\n    MsgBox \"Nothing has been done. \", vbExclamation, \"Goodbye!\"\nEnd If\n\nApplication.DisplayAlerts = False\nApplication.Quit\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1440534680, "post_id": 32213465, "comment_id": 52310874, "body": "you could load values into array and then paste those once into the new sheet."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5265917, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kUWVmPwmY8U/AAAAAAAAAAI/AAAAAAAATcI/-1HBZl84DCU/photo.jpg?sz=128", "display_name": "Jason Nalley", "link": "https://stackoverflow.com/users/5265917/jason-nalley"}, "edited": false, "score": 0, "creation_date": 1440620187, "post_id": 32220659, "comment_id": 52354099, "body": "Thanks, this works much much faster than I had previously.  I am still learning, but this was great help."}], "tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": true, "score": 1, "last_activity_date": 1440574763, "creation_date": 1440574763, "answer_id": 32220659, "question_id": 32213465, "link": "https://stackoverflow.com/questions/32213465/copy-cells-from-different-columns-on-same-row-and-paste-to-different-columns-on/32220659#32220659", "title": "Copy cells from different columns on same row, and paste to different columns on same row on another sheet", "body": "<p>Try this :</p>\n\n<pre><code>Sub Click()\n\nDim amattuid As String\nDim finalrow As Integer\nDim i As Integer\n\n\nApplication.ScreenUpdating = False\n\nSheets(\"Buckhalter VB\").Range(\"A6:G200\").ClearContents\n\namattuid = Sheets(\"Buckhalter VB\").Range(\"B3\").Value\nfinalrow = Sheets(\"Current Heirarchy\").Range(\"BM2000\").End(xlUp).Row\nrepattuid = Sheets(\"Buckhalter VB\").Range(\"A6\").Value\n\nFor i = 4 To finalrow\n    If Sheets(\"Current Heirarchy\").Cells(i, 65) = amattuid Then\n        Sheets(\"Buckhalter VB\").Range(\"A200\").End(xlUp).Offset(1, 0) = Sheets(\"Current Heirarchy\").Cells(i, 46).Value\n        Sheets(\"Buckhalter VB\").Range(\"B200\").End(xlUp).Offset(1, 0) = Sheets(\"Current Heirarchy\").Cells(i, 2).Value\n        Sheets(\"Buckhalter VB\").Range(\"C200\").End(xlUp).Offset(1, 0) = Sheets(\"Current Heirarchy\").Cells(i, 48).Value\n        Sheets(\"Buckhalter VB\").Range(\"G200\").End(xlUp).Offset(1, 0) = Sheets(\"Current Heirarchy\").Cells(i, 49).Value\n        End If\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 5265917, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kUWVmPwmY8U/AAAAAAAAAAI/AAAAAAAATcI/-1HBZl84DCU/photo.jpg?sz=128", "display_name": "Jason Nalley", "link": "https://stackoverflow.com/users/5265917/jason-nalley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "accepted_answer_id": 32220659, "answer_count": 1, "score": 4, "last_activity_date": 1440574763, "creation_date": 1440534580, "last_edit_date": 1440540901, "question_id": 32213465, "link": "https://stackoverflow.com/questions/32213465/copy-cells-from-different-columns-on-same-row-and-paste-to-different-columns-on", "title": "Copy cells from different columns on same row, and paste to different columns on same row on another sheet", "body": "<p>I have successfully written code that will copy a cell, paste into a cell on another page and then wash rinse repeat for 3 other columns.  See below:</p>\n\n<pre><code>Sub Click()\n\nDim amattuid As String\nDim finalrow As Integer\nDim i As Integer\n\n\nApplication.ScreenUpdating = False\n\nSheets(\"Buckhalter VB\").Range(\"A6:G200\").ClearContents\n\namattuid = Sheets(\"Buckhalter VB\").Range(\"B3\").Value\nfinalrow = Sheets(\"Current Heirarchy\").Range(\"BM2000\").End(xlUp).Row\nrepattuid = Sheets(\"Buckhalter VB\").Range(\"A6\").Value\n\nFor i = 4 To finalrow\n    If Sheets(\"Current Heirarchy\").Cells(i, 65) = amattuid Then\n        Sheets(\"Current Heirarchy\").Cells(i, 46).Copy\n        Sheets(\"Buckhalter VB\").Range(\"A200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        Sheets(\"Current Heirarchy\").Cells(i, 2).Copy\n        Sheets(\"Buckhalter VB\").Range(\"B200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        Sheets(\"Current Heirarchy\").Cells(i, 48).Copy\n        Sheets(\"Buckhalter VB\").Range(\"C200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        Sheets(\"Current Heirarchy\").Cells(i, 49).Copy\n        Sheets(\"Buckhalter VB\").Range(\"G200\").End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues\n        End If\nNext i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>This works, but I am wondering if there is a way to streamline it.  So it copies all of the cells at once, and then pastes them out at once into the designated locations.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 1, "creation_date": 1440533043, "post_id": 32213017, "comment_id": 52309979, "body": "What do you mean by &quot;does not work&quot;?  Do you get an error (if so, which error)?  Or do you get unexpected behavior?"}, {"owner": {"reputation": 343, "user_id": 4174968, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/671a0c813810066e24f67be94825af58?s=128&d=identicon&r=PG&f=1", "display_name": "rmdlp", "link": "https://stackoverflow.com/users/4174968/rmdlp"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1440533208, "post_id": 32213017, "comment_id": 52310073, "body": "I get the error:   &quot;Run-time error &#39;`004&#39;: Select method of Chart class failed&quot;"}, {"owner": {"reputation": 343, "user_id": 4174968, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/671a0c813810066e24f67be94825af58?s=128&d=identicon&r=PG&f=1", "display_name": "rmdlp", "link": "https://stackoverflow.com/users/4174968/rmdlp"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1440533250, "post_id": 32213017, "comment_id": 52310096, "body": "@Soulfire thanks for your response!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1440533448, "post_id": 32213017, "comment_id": 52310220, "body": "A sheet in the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa174306%28v=office.11%29.aspx\" rel=\"nofollow noreferrer\">Sheets collection</a> is NOT the same thing as a <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224506(v=office.11).aspx\" rel=\"nofollow noreferrer\">Worksheet object</a> in the <a href=\"https://msdn.microsoft.com/en-us/library/office/aa224508(v=office.11).aspx\" rel=\"nofollow noreferrer\">Worksheets collection</a>. Is there a reason you cannot refer to the worksheet by its Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196974.aspx\" rel=\"nofollow noreferrer\">.Name property</a>?"}, {"owner": {"reputation": 343, "user_id": 4174968, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/671a0c813810066e24f67be94825af58?s=128&d=identicon&r=PG&f=1", "display_name": "rmdlp", "link": "https://stackoverflow.com/users/4174968/rmdlp"}, "edited": false, "score": 0, "creation_date": 1440533600, "post_id": 32213017, "comment_id": 52310319, "body": "@Jeeped So by specifying &quot;Sheets(3).Select&quot; that is part of the Worksheet collection? It&#39;s just that I&#39;m reiterating this code to obtain the values and the titles of each sheet are quite long and specific."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1440533727, "post_id": 32213017, "comment_id": 52310384, "body": "By referencing <code>Sheets(3)</code> you get the third &#39;sheet&#39; (or third tab) in the sheets queue. That may or may not be a worksheet and if there was a chart sheet in sheets(1) or sheets(2) then Worksheets(3) is not the same thing as Sheets(3)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1440533982, "post_id": 32213017, "comment_id": 52310531, "body": "Relying on the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff836415.aspx\" rel=\"nofollow noreferrer\">Worksheet.Index property</a> to identify the correct worksheet is usually not problematic although any reordering will foul things up. If long worksheet names are giving your typing fingers cramps, consider using the Worksheet <a href=\"https://msdn.microsoft.com/en-us/library/office/ff837552.aspx\" rel=\"nofollow noreferrer\">.CodeName property</a> instead. (and <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">get away from Select</a> altogether)"}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 4, "creation_date": 1440534216, "post_id": 32213017, "comment_id": 52310646, "body": "I would also add that selecting, activating, etc. are unnecessary operations that take up resources.  Those 8 lines of code can be condensed into one line: <code>Sheets(3).Range(&quot;U56,U64,U75&quot;).Copy Destination:=Sheets(&quot;Graph Data Sheet&quot;).Range(&quot;B3&quot;)</code>"}], "owner": {"reputation": 343, "user_id": 4174968, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/671a0c813810066e24f67be94825af58?s=128&d=identicon&r=PG&f=1", "display_name": "rmdlp", "link": "https://stackoverflow.com/users/4174968/rmdlp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440540833, "creation_date": 1440532868, "last_edit_date": 1592644375, "question_id": 32213017, "link": "https://stackoverflow.com/questions/32213017/selecting-a-sheet-and-copying-from-it-does-not-work", "title": "Selecting a sheet and copying from it, does not work", "body": "<p>I'm simply trying to select the third sheet within the workbook, copy three values and past them within another. The code works when I specify the exact name of the worksheet as seen below:</p>\n<pre><code>Sheets(&quot;Jul 01 2014 1400h&quot;).Select\n        Range(&quot;U56,U64,U75&quot;).Select\n        Range(&quot;U75&quot;).Activate\n        Application.CutCopyMode = False\n        Selection.Copy\n        Sheets(&quot;Graph Data Sheet&quot;).Select\n        Range(&quot;B3&quot;).Select\n        ActiveSheet.Paste\n</code></pre>\n<p>But I get the error:</p>\n<p><em><strong>&quot;Run-time error '1004': Select method of Chart class failed&quot;</strong></em></p>\n<p>when I just want to specify the sheet order number like below:</p>\n<pre><code>Sheets(3).Select\n        Range(&quot;U56,U64,U75&quot;).Select\n        Range(&quot;U75&quot;).Activate\n        Application.CutCopyMode = False\n        Selection.Copy\n        Sheets(&quot;Graph Data Sheet&quot;).Select\n        Range(&quot;B3&quot;).Select\n        ActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["vba", "excel", "offset"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5265725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e609e74a5a69537de3ffe9f6f283fc?s=128&d=identicon&r=PG&f=1", "display_name": "D. Williams", "link": "https://stackoverflow.com/users/5265725/d-williams"}, "edited": false, "score": 0, "creation_date": 1440585734, "post_id": 32213344, "comment_id": 52331411, "body": "Thanks for the tip! Disabling the screen updating did help a bunch. Now I guess the main question is how to reference that specific cell without using a fixed cell, and then reference the rest of the data points off that original cell without calling it out directly."}, {"owner": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "reply_to_user": {"reputation": 1, "user_id": 5265725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e609e74a5a69537de3ffe9f6f283fc?s=128&d=identicon&r=PG&f=1", "display_name": "D. Williams", "link": "https://stackoverflow.com/users/5265725/d-williams"}, "edited": false, "score": 0, "creation_date": 1440688748, "post_id": 32213344, "comment_id": 52386906, "body": "don&#39;t forget the upvote if you liked the answer :). With regards to the rest, i strongly recommend you to do a vba excel tutorial. In the meanwhile, access your cells like this for example: worksheets(&quot;sheetname&quot;).Cells(y,x)  (instead of using &quot;range&quot;). then you also don&#39;t need to use &quot;select&quot;. These things help already a lot in optimizing..."}, {"owner": {"reputation": 1, "user_id": 5265725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e609e74a5a69537de3ffe9f6f283fc?s=128&d=identicon&r=PG&f=1", "display_name": "D. Williams", "link": "https://stackoverflow.com/users/5265725/d-williams"}, "edited": false, "score": 0, "creation_date": 1440701611, "post_id": 32213344, "comment_id": 52394644, "body": "I don&#39;t have enough rep points yet. I upvoted and it said I need 15 for my upvotes to publicly display. Thanks a bunch for your help, regarding the cell accessing, could I name the first cell a variable and reference the variable within (y,x)? Because its hard to reference something that isn&#39;t in a fixed location."}], "tags": [], "owner": {"reputation": 961, "user_id": 2697139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c2437120b3292f1340ad0100ac12d4?s=128&d=identicon&r=PG&f=1", "display_name": "AlexT82", "link": "https://stackoverflow.com/users/2697139/alext82"}, "is_accepted": false, "score": 1, "last_activity_date": 1440534089, "creation_date": 1440534089, "answer_id": 32213344, "question_id": 32212702, "link": "https://stackoverflow.com/questions/32212702/copy-pastespecial-offset-macro-is-slow-when-switching-between-worksheets/32213344#32213344", "title": "Copy/PasteSpecial Offset macro is slow when switching between worksheets", "body": "<p>o wow, this can use some MAJOR improvements. </p>\n\n<p>but to make it easy, you might want to put this at the start:</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n</code></pre>\n\n<p>and this at the end of your macro:</p>\n\n<pre><code>Application.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n</code></pre>\n\n<p>This will give it huge speed boost already. Next; you should try to reference to the cells without activating...</p>\n"}], "owner": {"reputation": 1, "user_id": 5265725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e609e74a5a69537de3ffe9f6f283fc?s=128&d=identicon&r=PG&f=1", "display_name": "D. Williams", "link": "https://stackoverflow.com/users/5265725/d-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1440541811, "creation_date": 1440531810, "last_edit_date": 1440541811, "question_id": 32212702, "link": "https://stackoverflow.com/questions/32212702/copy-pastespecial-offset-macro-is-slow-when-switching-between-worksheets", "title": "Copy/PasteSpecial Offset macro is slow when switching between worksheets", "body": "<p><strong>Intro:</strong> I've been working on this macro for quite awhile and have had success getting it to do what I need it to do, however I'm not doing it the most efficient way as my coding background is minimal. Because of this the macro is extremely slow due to switching back and forth from one worksheet \"FB MATE DATA\" to another \"Sheet 2 (2)\" copying and pasting data.</p>\n\n<p><strong>Background:</strong> A CMM machine spits out measurement data into a spreadsheet that I need to copy and paste from one sheet to another in neat X and Y columns to be overlayed in a scatter plot. The problem is that the data is in an unconventional pattern that requires the use of an offset, and different sheets have data that starts in different rows so the macro must account for that. The reason it is so slow is because the way i have achieved this is by constantly activating each worksheet back and forth, over and over to maintain control over the active cell instead of just referencing an offset from a fixed cell due to the offset changing occasionally in a row. The code i have now:</p>\n\n<ul>\n<li>cycles down through column A until it finds a blank cell</li>\n<li>shifts down to the cell immediately below it and starts copying data over. (This is very important because the first few rows are data irrelevant to me, and they are separated from the data i seek by a space.)</li>\n<li>copies data from the range (G:FZ) in an offset (e.g. G21, K21, O21, S21, W21, AA21, AE21, AI21, AM21, AQ21, AU21, AY21, BG21) into a neat X|Y table from D73:E:93. Notice the irregular pattern (due to info extraneous to my plot) </li>\n<li>Every two represent an X|Y pair (e.g. X: G21 pasted into D73 in Sheet 2, Y: K21 pasted into E73 in Sheet 2, etc.)</li>\n</ul>\n\n<p><strong>Problem:</strong> For each row of data, I need to copy certain columns in an interval that changes (first column, fourth column, ninth column, twelvth column, etc.) and paste it into two X|Y columns on another page. </p>\n\n<p>The data grab <em>will not</em> always start in G21. Sometimes the first data point may be G24, or G10, or G15, hence why the macro searches for a blank row first instead of pulling from a fixed position. Below is a sample of cycling through the first four columns.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code> Sub LocatorTest()\n\n'Select first row of eligible spare pallet data\n Range(\"B73\").Select\n Application.Goto (ActiveWorkbook.Sheets(\"FB MATE DATA\").Range(\"A1\"))\n Dim c\n For Each c In Range(\"A1:A100\").Cells\n    If c = \"\" Then\n        c.Select\n        Exit For\n    End If\nNext\nActiveCell.Offset(1, 6).Range(\"A1\").Select\nSelection.Copy\nSheets(\"Sheet2 (2)\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nRange(\"C73\").Select\nWorksheets(\"FB MATE DATA\").Activate\nActiveCell.Offset(rowOffset:=0, columnOffset:=4).Activate\nSelection.Copy\nSheets(\"Sheet2 (2)\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nRange(\"B74\").Select\nWorksheets(\"FB MATE DATA\").Activate\nActiveCell.Offset(rowOffset:=0, columnOffset:=8).Activate\nSelection.Copy\nSheets(\"Sheet2 (2)\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n    Range(\"C74\").Select\nWorksheets(\"FB MATE DATA\").Activate\nActiveCell.Offset(rowOffset:=0, columnOffset:=12).Activate\nSelection.Copy\nSheets(\"Sheet2 (2)\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>Any help you can provide into maybe a different way of achieving this or making it run quicker would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1440531710, "post_id": 32212530, "comment_id": 52309189, "body": "Can you tell me which line causes the error? Maybe we should check if A1 is a Date as well, shouldn&#39;t we? I&#39;ll add it to the answer."}, {"owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "reply_to_user": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "edited": false, "score": 0, "creation_date": 1440532075, "post_id": 32212530, "comment_id": 52309401, "body": "Also, I put application.screenupdating = False at the start so it doesn&#39;t show the changes one by one (although for 15 lines you would not see the difference). I made it go back to True at the end. I believe that&#39;s what you wanted."}], "tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1440531790, "last_edit_date": 1440531790, "creation_date": 1440531253, "answer_id": 32212530, "question_id": 32212364, "link": "https://stackoverflow.com/questions/32212364/how-to-color-cells-based-on-a-date-difference-criteria-in-a-loop/32212530#32212530", "title": "How to color cells based on a date difference criteria in a loop", "body": "<p>The line <code>If IsDate(Cells(i, 6).Value) - Range(\"A1\") &lt; 7 Then</code> is problematic because IsDate will return a True or False value, not a number. You can guess why <code>True - Range(\"A1\") &lt; 7</code> would cause an error.</p>\n\n<p>I check if there is a date, and if it is, THEN I try to make the substraction. Although I would be careful substracting dates like that.</p>\n\n<pre><code>Sub futurospgtos()\n\nDim i As Integer\n\nApplication.ScreenUpdating = False\n\n    For i = 15 To 1 Step -1\n        If IsDate(Cells(i, 6).Value) And IsDate(Range(\"A1\")) Then\n            If Cells(i, 6).Value - Range(\"A1\") &lt; 7 Then\n                 Rows(i).EntireRow.Interior.ColorIndex = 6\n            Else\n                 Rows(i).EntireRow.Interior.ColorIndex = 3\n            End If\n        End if\n    Next i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>If you have trouble, it will possibly be because of the date format. Let me know in the comments.</p>\n"}], "owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440535729, "creation_date": 1440530693, "last_edit_date": 1531164843, "question_id": 32212364, "link": "https://stackoverflow.com/questions/32212364/how-to-color-cells-based-on-a-date-difference-criteria-in-a-loop", "title": "How to color cells based on a date difference criteria in a loop", "body": "<p>I need to put the color yellow in all the lines which the difference between the values of column F and A1 is smaller than 7. So, if F4-A1 is &lt;7, line 4 should be yellow, then if F5-A1&lt;7, line 5 should be yellow.. until the end of my rows. If the difference is higher than 7, the line should be blank. I would really appreciate your help</p>\n\n<p>I tried to write the following code:</p>\n\n<pre><code>Sub futurospgtos()\n\nDim i As Integer\n    For i = 15 To 1 Step -1\n        If IsDate(Cells(i, 6).Value) - Range(\"A1\") &lt; 7 Then\n       Rows(i).EntireRow.Interior.ColorIndex = 6\n        Else\n       Rows(i).EntireRow.Interior.ColorIndex = 3\n        End If\n    Next i\n    Application.ScreenUpdating = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "wcf", "wsdl", "app-config", "moniker"], "comments": [{"owner": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1440770535, "post_id": 32212321, "comment_id": 52424627, "body": "What are you trying to do here? What is a <i>wsdl moniker string</i>? It sounds painful"}, {"owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "reply_to_user": {"reputation": 27873, "user_id": 569662, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DROcJ.png?s=128&g=1", "display_name": "tom redfern", "link": "https://stackoverflow.com/users/569662/tom-redfern"}, "edited": false, "score": 0, "creation_date": 1440771251, "post_id": 32212321, "comment_id": 52425109, "body": "Realized the problem...I think. I&#39;m using a Windows Service. This only works in IIS hosted Services."}], "owner": {"reputation": 4568, "user_id": 3685285, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/72b7ac073315a8da6956e2d7dce165b1?s=128&d=identicon&r=PG&f=1", "display_name": "user3685285", "link": "https://stackoverflow.com/users/3685285/user3685285"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440530552, "creation_date": 1440530552, "question_id": 32212321, "link": "https://stackoverflow.com/questions/32212321/what-is-the-wcf-service-moniker-for-this-configuration", "title": "What is the WCF service moniker for this configuration?", "body": "<p>I have the following app configuration file using my ip as a baseAddress:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;\n&lt;configuration&gt;\n  &lt;system.serviceModel&gt;\n    &lt;services&gt;\n      &lt;service name=\"HelloServiceExample.HelloService\" behaviorConfiguration=\"mexBehavior\"&gt;\n        &lt;endpoint\n          address=\"HelloService\"\n          binding=\"basicHttpBinding\"\n          contract=\"HelloServiceExample.IHelloService\"&gt;\n        &lt;/endpoint&gt;\n        &lt;endpoint\n          address=\"mex\"\n          binding=\"mexHttpBinding\"\n          contract=\"IMetadataExchange\"&gt;\n        &lt;/endpoint&gt;\n        &lt;host&gt;\n          &lt;baseAddresses&gt;\n            &lt;add baseAddress=\"http://{IP-ADDRESS}:{PORT}/\" /&gt;\n          &lt;/baseAddresses&gt;\n        &lt;/host&gt;\n      &lt;/service&gt;\n    &lt;/services&gt;\n    &lt;behaviors&gt;\n      &lt;serviceBehaviors&gt;\n        &lt;behavior name=\"mexBehavior\"&gt;\n          &lt;serviceMetadata httpGetEnabled=\"true\" /&gt;\n        &lt;/behavior&gt;\n      &lt;/serviceBehaviors&gt;\n    &lt;/behaviors&gt;\n  &lt;/system.serviceModel&gt;\n&lt;/configuration&gt;\n</code></pre>\n\n<p>I have written a corresponding wsdl-based moniker string in VBA:</p>\n\n<pre><code>wsdlMonikerString = _\n        \"service4:address='http://{IP-ADDRESS}:{PORT}/HelloService.svc' \" &amp; _\n        \", binding=BasicHttpBinding_IHelloService\" &amp; _\n        \", bindingNamespace='http://tempuri.org/'\" &amp; _\n        \", wsdl='\" &amp; wsdlText &amp; \"'\" &amp; _\n        \", contract=IHelloService\" &amp; _\n        \", contractNamespace='http://tempuri.org/'\"\n</code></pre>\n\n<p>Where wsdlText is the string respresentation of the wsdl service. Gotten from http://{IP-ADDRESS}:{PORT}/?singleWsdl. But it does not seem to work, and I can't figure out why. I always get the error: </p>\n\n<pre><code>Run-time error '-2147221020 (800401e4)':\n\nAutomation error\nInvalid syntax\n</code></pre>\n"}, {"tags": ["image", "excel", "hyperlink", "vba"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1440530038, "post_id": 32212109, "comment_id": 52308238, "body": "The <code>Workbooks.Open</code> method is for opening Workbooks, not pictures."}, {"owner": {"reputation": 105, "user_id": 2166950, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7051403f438cc8167808d9310925e4d9?s=128&d=identicon&r=PG", "display_name": "Pwoods", "link": "https://stackoverflow.com/users/2166950/pwoods"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1440530233, "post_id": 32212109, "comment_id": 52308360, "body": "Would it be &#39;applications.open&#39; then ?"}, {"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1440530285, "post_id": 32212109, "comment_id": 52308388, "body": "Technically it is <code>Application.Workbooks.Open</code>, but you don&#39;t need the Application qualifier."}], "answers": [{"tags": [], "owner": {"reputation": 2285, "user_id": 4916894, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/54ad102d504b32ad99085f6f6ab14d9d?s=128&d=identicon&r=PG&f=1", "display_name": "David G", "link": "https://stackoverflow.com/users/4916894/david-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1440530761, "last_edit_date": 1440530761, "creation_date": 1440530437, "answer_id": 32212288, "question_id": 32212109, "link": "https://stackoverflow.com/questions/32212109/using-vba-macro-to-open-link-to-picture/32212288#32212288", "title": "Using VBA Macro To open Link to picture", "body": "<p>ActiveRow is a Long, so you cannot select a row and say that is a number. You would simply write</p>\n\n<pre><code>ActiveRow = ActiveCell.Row\n</code></pre>\n\n<p>In the immediate window, if you write ?Rows(ActiveCell.Row).Select, it will return a Boolean Value, not a number.</p>\n\n<p>Also to open a file you should use the FollowHyperlink method:</p>\n\n<p>from msdn:</p>\n\n<pre><code>ActiveWorkbook.FollowHyperlink Address:=\"http://example.microsoft.com\"\n</code></pre>\n\n<p>Your link would replace the one in the example of course.</p>\n\n<pre><code>picture = \"P:\\926_TM\\03_LocalExchange\\Tracking_and_Labeling\\LabEquipment\\pictures\\\" &amp; Cells(ActiveRow, 6).Value\nActiveWorkbook.FollowHyperlink Address:=picture\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 1, "last_activity_date": 1440531211, "last_edit_date": 1440531211, "creation_date": 1440530466, "answer_id": 32212300, "question_id": 32212109, "link": "https://stackoverflow.com/questions/32212109/using-vba-macro-to-open-link-to-picture/32212300#32212300", "title": "Using VBA Macro To open Link to picture", "body": "<p>You can't open a picture with the <code>Workbooks.Open</code> method, as that method is exclusively for opening workbooks.</p>\n\n<p>One option is to use a <code>Shell</code> command to open the picture.  In this example, I will open a picture located on the the Pictures folder named <code>Test.png</code></p>\n\n<pre><code>Private Sub OpenPic()\n        Shell \"mspaint.exe C:\\Users\\USERNAME\\Pictures\\Test.png\"\nEnd Sub\n</code></pre>\n\n<p>This will open the picture in paint.</p>\n\n<p>Adapting this method to your code:</p>\n\n<pre><code>Sub Picture_Click()\n\n   Sheets(\"Master\").Unprotect Password:=\"Conti1\"\n   Sheets(\"Records\").Unprotect Password:=\"Conti1\"\n\n   Dim picture As String\n   Dim ActiveRow As Long\n\n\n   Worksheets(\"Master\").Activate\n\n   ActiveRow = ActiveCell.Row\n   picture = Cells(ActiveRow, 6).Value\n\n   Shell \"mspaint.exe P:\\926_TM\\03_LocalExchange\\Tracking_and_Labeling\\LabEquipment\\pictures\\\" &amp; picture\n\nEnd Sub\n</code></pre>\n\n<p>This assumes that the value in <code>Activerow, 6</code> includes the file extension.</p>\n\n<p>As an aside: I would add that you don't need to define ActiveRow at all and could just use it as-is.</p>\n\n<p>So this:</p>\n\n<pre><code>ActiveRow = ActiveCell.Row\npicture = Cells(ActiveRow, 6).Value\n</code></pre>\n\n<p>Can be rewritten as:</p>\n\n<pre><code>picture = Cells(ActiveCell.Row, 6).Value\n</code></pre>\n\n<p>And you can omit the ActiveRow variable altogether.</p>\n"}], "owner": {"reputation": 105, "user_id": 2166950, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7051403f438cc8167808d9310925e4d9?s=128&d=identicon&r=PG", "display_name": "Pwoods", "link": "https://stackoverflow.com/users/2166950/pwoods"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8552, "favorite_count": 0, "accepted_answer_id": 32212300, "answer_count": 2, "score": 0, "last_activity_date": 1440531211, "creation_date": 1440529715, "last_edit_date": 1531164843, "question_id": 32212109, "link": "https://stackoverflow.com/questions/32212109/using-vba-macro-to-open-link-to-picture", "title": "Using VBA Macro To open Link to picture", "body": "<p>My goal of this program is to open a picture in a folder by selecting a cells value in the active row which im using the line to do. </p>\n\n<pre><code>picture = Cells(ActiveRow, 6).Value\n</code></pre>\n\n<p>I am getting a Run time error '1004' Application-defined or object defined error</p>\n\n<p>Here is my full code</p>\n\n<pre><code>Sub Picture_Click()\n\n   Sheets(\"Master\").Unprotect Password:=\"Conti1\"\n   Sheets(\"Records\").Unprotect Password:=\"Conti1\"\n\n   Dim picture As String\n   Dim ActiveRow As Long\n\n\n   Worksheets(\"Master\").Activate\n\n        ActiveRow = Rows(ActiveCell.Row).Select\n        picture = Cells(ActiveRow, 6).Value\n\nChDir\"P:\\926_TM\\03_LocalExchange\\Tracking_and_Labeling\\LabEquipment\\pictures\"\n\n    Workbooks.Open picture\n\nEnd Sub\n</code></pre>\n\n<p>I am trying to use the value from the selected cell to be the name of the picture file in the selected folder, the picture I would like to open.</p>\n\n<p>also I am getting a value of -1 for ActiveRow</p>\n\n<p>Any help would be great!</p>\n"}, {"tags": ["sql-server", "excel", "vba", "batch-processing"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1440529768, "post_id": 32212077, "comment_id": 52308092, "body": "Why do you need to create functions on your sql server through VBA?"}], "answers": [{"comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1440529788, "post_id": 32212122, "comment_id": 52308106, "body": "Technically speaking is the default batch terminator. It can be changed too."}], "tags": [], "owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "is_accepted": false, "score": 4, "last_activity_date": 1457706746, "last_edit_date": 1592644375, "creation_date": 1440529752, "answer_id": 32212122, "question_id": 32212077, "link": "https://stackoverflow.com/questions/32212077/the-proper-use-of-mssql-go-in-vba/32212122#32212122", "title": "The proper use of MSSQL &quot;go&quot; in VBA", "body": "<p><a href=\"https://technet.microsoft.com/en-us/library/ms188037%28v=sql.110%29.aspx\" rel=\"nofollow noreferrer\">GO</a> is default batch terminator, it is not correct TSQL.</p>\n<blockquote>\n<p>&quot;Signals the end of a batch of Transact-SQL statements to the SQL Server utilities.&quot;</p>\n<p><strong>GO is not a Transact-SQL statement</strong>; it is a command recognized by the sqlcmd and osql utilities and SQL Server Management Studio Code editor.</p>\n</blockquote>\n<p>For your example make 2 calls to database or create these functions via SSMS.</p>\n"}], "owner": {"reputation": 11, "user_id": 5265678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879d954a9376a5c1141f72a35fde3a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Marta", "link": "https://stackoverflow.com/users/5265678/marta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 485, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1457706746, "creation_date": 1440529605, "last_edit_date": 1440531076, "question_id": 32212077, "link": "https://stackoverflow.com/questions/32212077/the-proper-use-of-mssql-go-in-vba", "title": "The proper use of MSSQL &quot;go&quot; in VBA", "body": "<p>I am about to run a batch what I programmed using MSSQL, like this:</p>\n\n<pre><code>create function xy ( \n.....\nend\ngo\n\ncreate function2 xy (\n...\nend\ngo\n</code></pre>\n\n<p>Then, I saved it in a file, what my macro reads it into a string and with ADO trying to run. Unfortunately, all the time I get the following error message: Incorrect syntax near 'go'. I have been reading about it, and only found the solution to split the batch, but I don't really want since I have it in one string variable. My connection string in vba is the following (first the public declared variables):</p>\n\n<pre><code>Public conn        As ADODB.Connection\nPublic rs          As ADODB.Recordset\nPublic cmd         As ADODB.Command\nPublic sConnString As String\n\nOn Local Error GoTo err\n    sConnString = \"Provider=SQLOLEDB.1;Data Source=localhost;\" &amp; _\n                  \"Initial Catalog=\" &amp; database &amp; \";\" &amp; _\n                  \"Integrated Security=SSPI;\"\n    Set conn = New ADODB.Connection\n    Set rs = New ADODB.Recordset\n    Set cmd = New ADODB.Command\n    conn.Open sConnString\n    conn.CursorLocation = adUseClient\n    cmd.ActiveConnection = conn\n\nset rs = conn.Execute(mysqlstring)\n</code></pre>\n\n<p>I have also checked the file what I read in with vba and no problem with it, if I copy it then paste to microsoft sql, it works. It does not, if I use ADO. </p>\n\n<p>Every help is much appreciated!</p>\n\n<p>Marta</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "edited": false, "score": 0, "creation_date": 1440550621, "post_id": 32213262, "comment_id": 52316488, "body": "Ahhh!  Use the Array(item1, item2....) function inside the Range property to identify the items I want to select. Brilliant. <i>That</i> is the piece I was missing.  Thank you!"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "edited": false, "score": 0, "creation_date": 1440550721, "post_id": 32213262, "comment_id": 52316514, "body": "Happy to help. Check <a href=\"https://msdn.microsoft.com/en-us/library/office/Ff746710.aspx\" rel=\"nofollow noreferrer\">this out</a> for more info on <code>Slides.Range()</code>."}, {"owner": {"reputation": 693, "user_id": 2149075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a179643fe18464a8499ecf75a59603fc?s=128&d=identicon&r=PG", "display_name": "Alexander H&#248;st", "link": "https://stackoverflow.com/users/2149075/alexander-h%c3%b8st"}, "edited": false, "score": 0, "creation_date": 1577660757, "post_id": 32213262, "comment_id": 105219134, "body": "It is absolutely critical that the thumbnails view is active when you run this code, or only the last slide in the array will be selected. You should call <code>ActiveWindow.Panes(1).Activate</code> before you create the <code>SlideRange</code>and call <code>Select</code> on it."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 3, "last_activity_date": 1440533754, "creation_date": 1440533754, "answer_id": 32213262, "question_id": 32211747, "link": "https://stackoverflow.com/questions/32211747/select-a-range-of-slides-in-powerpoint/32213262#32213262", "title": "Select a range of slides in PowerPoint", "body": "<p>You can get the active slide index by using:</p>\n\n<pre><code>Dim intIndex As Long\nintIndex = ActiveWindow.View.Slide.SlideIndex\n</code></pre>\n\n<p>Then, use the <code>Slides.Range()</code> function to select the slides before and after this index:</p>\n\n<pre><code>Dim r As SlideRange\nSet r = ActivePresentation.Slides.Range(Array(intIndex - 1, intIndex, intIndex + 1))\nr.Select\n</code></pre>\n\n<p>You may want to protect against indexes &lt; 1 or greater than the number of slides in your presentation. For example, if the first slide is selected before you run the macro, then there won't be a slide <code>0</code> and trying to select it will result in an error.</p>\n"}, {"tags": [], "owner": {"reputation": 1293, "user_id": 4152280, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AhQa0.jpg?s=128&g=1", "display_name": "SkyMaster", "link": "https://stackoverflow.com/users/4152280/skymaster"}, "is_accepted": false, "score": 1, "last_activity_date": 1440536061, "creation_date": 1440536061, "answer_id": 32213873, "question_id": 32211747, "link": "https://stackoverflow.com/questions/32211747/select-a-range-of-slides-in-powerpoint/32213873#32213873", "title": "Select a range of slides in PowerPoint", "body": "<p>An example of how to select a slide before and after. Then this selection is applied format.</p>\n\n<pre><code>Sub ExampleSlideRange()\n    Dim index, indexB, indexA, count As Integer\n    Dim sr As SlideRange\n    index = ActiveWindow.View.Slide.SlideIndex\n    count = ActivePresentation.Slides.count\n    indexB = index - 1\n    indexA = index + 1\n    If indexB = 0 Then indexB = 1\n    If indexA &gt; count Then indexA = count        \n    Set sr = ActivePresentation.Slides.Range(Array(indexB, index, indexA))\n    sr.Select\n    With Windows(1).Selection.SlideRange\n        .FollowMasterBackground = False\n        .Background.Fill.PresetGradient msoGradientHorizontal, 1, msoGradientLateSunset\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "is_accepted": false, "score": 1, "last_activity_date": 1540401015, "creation_date": 1540401015, "answer_id": 52974552, "question_id": 32211747, "link": "https://stackoverflow.com/questions/32211747/select-a-range-of-slides-in-powerpoint/52974552#52974552", "title": "Select a range of slides in PowerPoint", "body": "<p>One minor modification to the answers above is that you cannot select multiple slides if the corresponding Pane is not active (you CAN set a reference to them but the Select method implies a UI action). So, in the Normal view, if the slide or notes pane is active then only the last slide in the range is selected, being reflected in the thumbnail pane. To set a multi-slide range AND and see them selected in the thumbnail pane, you need to activate that pane first as follows:</p>\n\n<pre><code>ActiveWindow.Panes(1).Activate\nSet r = ActivePresentation.Slides.Range(Array(intIndex - 1, intIndex, intIndex + 1))\nr.Select\n</code></pre>\n\n<p>Trying to activate panes in other views may cause an issue so you should also check the ActiveWindow.ViewType first.</p>\n\n<p>Note too that the array can be an array of numerical slide indexes or an array of  strings containing the slide name.</p>\n"}], "owner": {"reputation": 469, "user_id": 3862163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3c044036e475ca103a3e5c233b1550ce?s=128&d=identicon&r=PG&f=1", "display_name": "DRC", "link": "https://stackoverflow.com/users/3862163/drc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5623, "favorite_count": 1, "accepted_answer_id": 32213262, "answer_count": 3, "score": 2, "last_activity_date": 1540401015, "creation_date": 1440528394, "last_edit_date": 1440533921, "question_id": 32211747, "link": "https://stackoverflow.com/questions/32211747/select-a-range-of-slides-in-powerpoint", "title": "Select a range of slides in PowerPoint", "body": "<p>I have scoured MSDN and the web for how to use VBA to select a range of slides in PowerPoint and cannot figure it out.  It seems like it should have something to do with <code>ActiveWindow.Selection.SlideRange</code>, but I cannot figure out how to set a starting and ending slide.  All I can find is how to use VBA to manipulate a range of slides that the user has already selected; I need to make VBA select the range.</p>\n\n<p>Specifically, I want to select the slide before and the slide after the currently selected slide and return those 3 slides as the <code>SlideRange</code>.</p>\n"}]