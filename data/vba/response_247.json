[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 4176681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab72c7656b424b83bdfe8f165dd8fa21?s=128&d=identicon&r=PG", "display_name": "Rohit Lodha", "link": "https://stackoverflow.com/users/4176681/rohit-lodha"}, "is_accepted": false, "score": 1, "last_activity_date": 1570059938, "creation_date": 1570059938, "answer_id": 58210661, "question_id": 58210574, "link": "https://stackoverflow.com/questions/58210574/highlight-cells-with-different-values-than-present-in-the-column/58210661#58210661", "title": "Highlight cells with different values than present in the column", "body": "<p>I can suggest a workaround. Not sure if this is the best way though.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PuQL1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PuQL1.png\" alt=\"enter image description here\"></a></p>\n\n<p>Step 1. Create a count if table which basically gives you the count of a value in the column. Ex: for cell F4 use formula =COUNTIF($B$4:$B$8,B4)</p>\n\n<p>Step 2. Create a row with max values of each column. Ex: Cell F11 =MAX(F4:F8)</p>\n\n<p>Step 3. For each cell, give a conditional formatting condition that if the value in the count table does not match the max value, color it. Ex: for cell B4, go to conditional formatting -> new rule -> use a formula and write this formula =F4&lt;>F$11. Then copy paste the format to all other cells.</p>\n\n<p>Note: this will not work when multiple values in a column have the same max count.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12156431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8992dc5ecae66dda7df88c1a806222?s=128&d=identicon&r=PG&f=1", "display_name": "user19673", "link": "https://stackoverflow.com/users/12156431/user19673"}, "edited": false, "score": 0, "creation_date": 1570123318, "post_id": 58211790, "comment_id": 102823283, "body": "Exactly what I was looking for but what if one of the columns is completely blank? It seems it won&#39;t work. If the majority of the column is Blank then everything else would have to be compared against Blank and flag what is not Blank."}, {"owner": {"reputation": 434, "user_id": 8783311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe3948e7f0f1a9e258e7eaa9c94a665?s=128&d=identicon&r=PG&f=1", "display_name": "jblack", "link": "https://stackoverflow.com/users/8783311/jblack"}, "reply_to_user": {"reputation": 3, "user_id": 12156431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8992dc5ecae66dda7df88c1a806222?s=128&d=identicon&r=PG&f=1", "display_name": "user19673", "link": "https://stackoverflow.com/users/12156431/user19673"}, "edited": false, "score": 0, "creation_date": 1570153288, "post_id": 58211790, "comment_id": 102832453, "body": "I&#39;ve updated the code above to take into account blanks. Note, if more than 1 value has a max frequency in a column then it will only select one as the most frequent and highlight all the others"}], "tags": [], "owner": {"reputation": 434, "user_id": 8783311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe3948e7f0f1a9e258e7eaa9c94a665?s=128&d=identicon&r=PG&f=1", "display_name": "jblack", "link": "https://stackoverflow.com/users/8783311/jblack"}, "is_accepted": true, "score": 0, "last_activity_date": 1570153081, "last_edit_date": 1570153081, "creation_date": 1570071825, "answer_id": 58211790, "question_id": 58210574, "link": "https://stackoverflow.com/questions/58210574/highlight-cells-with-different-values-than-present-in-the-column/58211790#58211790", "title": "Highlight cells with different values than present in the column", "body": "<p>Here is a VBA solution, I've commented the code so you can understand</p>\n\n<pre><code>    Sub HighlightNonFrequentInColumn()\n\n    Dim rng As Range\n    Dim col As Range\n    Dim cell As Range\n    Dim myVal As String\n    Dim colRng As String\n\n    Set rng = Selection '&lt;&lt;change range as required\n\n    For Each col In rng.Columns\n        'determine the most frequent value\n        colRng = col.Address\n        On Error Resume Next\n        myVal = Application.Evaluate(\"INDEX(\" &amp; colRng &amp; \",MODE(IF(\" &amp; colRng &amp; \"&lt;&gt;\"\"\"\",MATCH(\" &amp; colRng &amp; \",\" &amp; colRng &amp; \",0))))\")\n        If Application.countblanks(col) &gt; Application.CountIf(col, myVal) Then myVal = \"\" '&lt;&lt;if blanks are most frequent\n        'highlight all cells not equals to most frequent value\n        For Each cell In col.Cells\n            If Not cell = myVal Then cell.Interior.Color = vbYellow '&lt;&lt;change colour as desired\n        Next\n    Next\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12156431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b8992dc5ecae66dda7df88c1a806222?s=128&d=identicon&r=PG&f=1", "display_name": "user19673", "link": "https://stackoverflow.com/users/12156431/user19673"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 58211790, "answer_count": 2, "score": 0, "last_activity_date": 1570153081, "creation_date": 1570059142, "last_edit_date": 1592644375, "question_id": 58210574, "link": "https://stackoverflow.com/questions/58210574/highlight-cells-with-different-values-than-present-in-the-column", "title": "Highlight cells with different values than present in the column", "body": "<p>I need to go through a table (X by Y) where every column (X) should have the same value (string) and would like the cell to get highlighted if is not the same value. I'm stuck in building the comparison method, because I would like it to be dynamic. I would like to first determine what is the value that is present the most in the column and determine that is what everything else needs to be compared against and highlight the cell that is not equal to this value.</p>\n<p>Example (6x5 table) -</p>\n<blockquote>\n<p>A 3 4 C M R</p>\n<p>A 3 4 O M R</p>\n<p>8 3 T O M F</p>\n<p>8 3 4 O M G</p>\n<p>A 3 T O Y K</p>\n</blockquote>\n<p>In the first column, A is the most prevalent value therefore the (8s) are highlighted, second column nothing is highlighted, third both (T) are highlighted, fourth column (C), fifth column (Y) and sixth column (F),(G) and (K) are highlighted.</p>\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1570073647, "last_edit_date": 1570073647, "creation_date": 1570071769, "answer_id": 58211782, "question_id": 58210572, "link": "https://stackoverflow.com/questions/58210572/excel-vba-how-to-clear-contents-for-specified-cells-when-another-cell-contains/58211782#58211782", "title": "Excel VBA: How to clear contents for specified cells when another cell contains specific text or string", "body": "<blockquote>\n  <p>How to clear contents for specified cells when another cell contains specific text or string</p>\n</blockquote>\n\n<pre><code>Dim cellToClear As Range\nDim cellToCheck As Range\nDim specificText As String\nIf cellToCheck.Value = specificText Then cellToClear.ClearContents\n</code></pre>\n\n<blockquote>\n  <p>\"I'm having some trouble trying to find VBA code \"</p>\n</blockquote>\n\n<p>These links contain VBA code that you can use when you no longer have trouble trying.  They contain examples you can paste into your project and modify for your needs.</p>\n\n<p><a href=\"https://sitestory.dk/excel_vba/cell_testing.htm\" rel=\"nofollow noreferrer\">This link has examples of how to read the contents of a cell</a>.</p>\n\n<p>A range is a group of one or more cells in a worksheet.  You can perform an operation on a range and it will affect all the cells inside the range.  <a href=\"https://excelmacromastery.com/excel-vba-range-cells/\" rel=\"nofollow noreferrer\">This link has examples of how to work with a range</a>.</p>\n\n<p>A loop is when the program repeats the same sequence of steps, usually until a specific condition is met.  <a href=\"https://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">You can find examples of different loops here</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1570083407, "post_id": 58212025, "comment_id": 102803174, "body": "At +100k lines you&#39;re nested loop will iterate +1.1m times while changing +400k elements, is there any particular reason you chose this method?  Seems like the loop adds +700k iterations without providing value.  Easily avoided by replacing the flag with a call to a procedure that explicitly assigns vbNullString to those 4 elements. Not judging, just curious."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 1, "creation_date": 1570088759, "post_id": 58212025, "comment_id": 102805444, "body": "Valid question, but at 106k lines the <a href=\"https://i.stack.imgur.com/NWqbk.gif\" rel=\"nofollow noreferrer\">loop itself took only 0.22 seconds</a> to complete. The re-write back to the worksheet took longer. And with that being said, I haven&#39;t changed any significant hardware since I bought my PC, which is over a decade old at this point - most of which is no longer supported by the manufacturer and is using generic Windows 10 drivers."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1570089410, "post_id": 58212025, "comment_id": 102805716, "body": "And btw, judging or not, I am <i>always</i> open to constructive criticism and suggestions for improvement. So I really do appreciate your comment :-)."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1570074249, "creation_date": 1570074249, "answer_id": 58212025, "question_id": 58210572, "link": "https://stackoverflow.com/questions/58210572/excel-vba-how-to-clear-contents-for-specified-cells-when-another-cell-contains/58212025#58212025", "title": "Excel VBA: How to clear contents for specified cells when another cell contains specific text or string", "body": "<p>I prefer placing values into an array if you are going to be changing a bunch of cells in a routine. This generally makes the process much quicker.</p>\n\n<p>Start out by setting your worksheet and range objects. Please take note that the below code is currently using index 1 for the worksheet here: <code>Set ws = ThisWorkbook.Worksheets(1)</code>. If this is not the worksheet you are personally needing, then you will need to change this. </p>\n\n<p>Then place the cell contents of the entire range into an array. As I mentioned earlier, this process is quicker than making adjustments to individual cells 1 at a time.</p>\n\n<p>Loop the array, checking for either the specific error value <code>#N/A</code> or the other criteria. If this criteria is a match, you will enter another loop that quickly loops through the 'columns' in the row that will delete the values from only the columns you specified.</p>\n\n<p>Once finished, rewrite the array back to the worksheet.</p>\n\n<pre><code>Sub main()\n\n    Dim ws As Worksheet, rng As Range, dataArr() As Variant\n    Set ws = ThisWorkbook.Worksheets(1)\n    Set rng = ws.Range(\"J3:X\" &amp; ws.Cells(ws.Rows.Count, \"J\").End(xlUp).Row)\n\n    ' Place the entire contents of worksheet range into an array\n    dataArr = rng.Value\n\n    Dim i As Long, x As Long, clearRow As Boolean\n    For i = LBound(dataArr) To UBound(dataArr)\n\n        If IsError(dataArr(i, 1)) Then\n            If dataArr(i, 1) = CVErr(xlErrNA) Then clearRow = True\n        ElseIf dataArr(i, 1) = vbNullString Or dataArr(i, 1) = 0 Then\n            clearRow = True\n        End If\n\n        ' Loop thru the columns (x) of the current row (i)\n        If clearRow Then\n            For x = 1 To 15\n                Select Case x\n                Case 1, 2, 7 To 15\n                    dataArr(i, x) = \"\"\n                End Select\n            Next x\n            clearRow = False\n        End If\n\n    Next i\n\n    ' Re-write the entire array back to the worksheet in one step\n    rng.Value = dataArr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12156502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baf851f354620bcf1222e89a79f3abe1?s=128&d=identicon&r=PG&f=1", "display_name": "Josh L", "link": "https://stackoverflow.com/users/12156502/josh-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1818, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1607356817, "creation_date": 1570059133, "last_edit_date": 1570066602, "question_id": 58210572, "link": "https://stackoverflow.com/questions/58210572/excel-vba-how-to-clear-contents-for-specified-cells-when-another-cell-contains", "title": "Excel VBA: How to clear contents for specified cells when another cell contains specific text or string", "body": "<p>I'm having some trouble trying to find VBA code to delete multiple specific cells if a certain cell contains a specific text. This spreadsheet can run close to 100k rows as well, but will vary depending on the data pull. </p>\n\n<p>The specific VBA would be able to do the following: </p>\n\n<p>If Cell J3 equals #N/A, Blank, or 0, then clear contents of cells J3:K3 and P3:X3, and then repeat til it reaches the bottom of column J. </p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570071260, "post_id": 58210554, "comment_id": 102800621, "body": "Do you have some idea of how many combinations you would end up with given 50 lists each of two values?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1570071492, "post_id": 58210554, "comment_id": 102800660, "body": "Previously: <a href=\"https://stackoverflow.com/questions/19780016/vba-write-all-possible-combinations-of-4-columns-of-data/19780307#19780307\" title=\"vba write all possible combinations of 4 columns of data\">stackoverflow.com/questions/19780016/&hellip;</a>"}, {"owner": {"reputation": 43, "user_id": 4176681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab72c7656b424b83bdfe8f165dd8fa21?s=128&d=identicon&r=PG", "display_name": "Rohit Lodha", "link": "https://stackoverflow.com/users/4176681/rohit-lodha"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570117486, "post_id": 58210554, "comment_id": 102820728, "body": "@TimWilliams - I understand  that it will be more than what excel will be able to handle. But, 45 columns can have a single value with the other 5 having...let&#39;s say 2 values. Always remember, Use cases are industry specific.  Also, thanks for your answer."}], "answers": [{"tags": [], "owner": {"reputation": 14220, "user_id": 6366770, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6if5V.png?s=128&g=1", "display_name": "David Erickson", "link": "https://stackoverflow.com/users/6366770/david-erickson"}, "is_accepted": false, "score": 0, "last_activity_date": 1570063556, "creation_date": 1570063556, "answer_id": 58211013, "question_id": 58210554, "link": "https://stackoverflow.com/questions/58210554/generating-all-possible-combinations-for-values-in-n-columns-where-n-can-vary/58211013#58211013", "title": "Generating all possible combinations for values in n columns - where n can vary (VBA)", "body": "<p>Here is part 1 of 2 (a simple loop based on input with formatting). In the next step, the user would enter the data and maybe someone else can provide you part 2 of the macro!:</p>\n\n<pre><code>Sub VarCount()\n\nDim inp As Variant\ninp = InputBox(\"How many variables?\")\n\nIf IsNumeric(inp) And inp &gt; 0 And inp &lt;= 50 Then\n\n    Range(\"A1\").Value = \"Var Count\"\n    Range(\"A1\").Font.Bold = True\n    Range(\"A1\").Font.Italic = True\n\n    Range(\"A2\").Value = \"Var Name\"\n    Range(\"A2\").Font.Bold = True\n    Range(\"A2\").Font.Italic = True\n\n\n    For i = 2 To inp + 1:\n        Cells(1, i).Value = i - 1\n        Cells(1, i).HorizontalAlignment = xlCenter\n    Next\n\nElse: MsgBox (\"Please enter an integer between 1 and 50 and re-run the macro.\")\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 4176681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab72c7656b424b83bdfe8f165dd8fa21?s=128&d=identicon&r=PG", "display_name": "Rohit Lodha", "link": "https://stackoverflow.com/users/4176681/rohit-lodha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570084105, "creation_date": 1570058978, "last_edit_date": 1570084105, "question_id": 58210554, "link": "https://stackoverflow.com/questions/58210554/generating-all-possible-combinations-for-values-in-n-columns-where-n-can-vary", "title": "Generating all possible combinations for values in n columns - where n can vary (VBA)", "body": "<p>I want to generate all possible combinations for unique values in n columns. Please consider the scenario below:</p>\n\n<p>In one sheet i am taking an input from the user where he/she can input the number of columns for which they want to generate the combinations and then can enter the unique values in each of the columns. Let's say that the user entered <em>10</em> as input, he will automatically get 10 input columns as below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6uyTS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6uyTS.png\" alt=\"User input where column values need to be entered\"></a></p>\n\n<p>Now, in each of the columns, user will input the variable name and the unique values of that variable. Once this is done, they will click on a button, which will generate all possible combinations for these n variables in a separate tab.</p>\n\n<p>Need your help on how to generate these combinations using vba, considering n can vary upto 50.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-access", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 1, "creation_date": 1570086249, "post_id": 58210141, "comment_id": 102804243, "body": "Thanks, plus 1 and accepted. How on earth did you acquire that knowledge? I couldn&#39;t find anything about it in the documentation. Furthermore, it raises the question what to do if we have a semicolon <i>and</i> double quotes in that string. I&#39;ll play around and try to learn ... My actual goal is to have a function which &quot;encodes&quot; any arbitrary string so that it could be used as column value."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "edited": false, "score": 1, "creation_date": 1570122482, "post_id": 58210141, "comment_id": 102822938, "body": "You&#39;re welcome. I reverse engineered it using the MS Access Controls Wizard: created a combo box, specified a value list, entered some values containing semi-colons and then examined the resulting property string."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 3, "last_activity_date": 1570055467, "creation_date": 1570055467, "answer_id": 58210141, "question_id": 58210053, "link": "https://stackoverflow.com/questions/58210053/how-to-add-an-item-to-a-combobox-using-additem-which-contains-a-semicolon/58210141#58210141", "title": "How to add an item to a combobox (using AddItem()) which contains a semicolon?", "body": "<p>Surround the column value which contains the semi-colon with double-quotes, e.g.:</p>\n\n<pre><code>AddItem \"\"\"Column1;A\"\";Column2;Column3\"\n</code></pre>\n\n<p>Will yield:</p>\n\n<pre><code>+-----------+---------+---------+\n| Column1;A | Column2 | Column3 |\n+-----------+---------+---------+\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "is_accepted": false, "score": 0, "last_activity_date": 1570128414, "last_edit_date": 1570128414, "creation_date": 1570127208, "answer_id": 58224933, "question_id": 58210053, "link": "https://stackoverflow.com/questions/58210053/how-to-add-an-item-to-a-combobox-using-additem-which-contains-a-semicolon/58224933#58224933", "title": "How to add an item to a combobox (using AddItem()) which contains a semicolon?", "body": "<p>All credits go to @Lee Mac who answered my original question completely. However, the answer immediately raised the question how we should treat strings which already have quotes in them.</p>\n\n<p>Therefore, I have written the following function in VBA which seems to solve the problem completely. The comments should be self-explaining. Please comment if you find an error.</p>\n\n<p>I have posted this as separate answer because it's way too long for a comment, and because it seems that the community does not prefer such answers edited into the original question.</p>\n\n<pre><code>'Notes:\n'\n'The following function quotes an arbitrary string so that it can be\n'used as part of the parameter to the ComboBox.AddItem() method.\n'Writing that function was necessary because there is no easy way to\n'use strings which already contain the ; character as part of that\n'parameter, or which even contain the ; character as well as double\n'quotes; see also Microsoft's documentation.\n'\n'To construct the parameter for the AddItem() method, the following\n'must be done:\n'\n'For EACH column, the source string must be quoted using the following\n'function. Then, all QUOTED strings must be concatenated, separating\n'them only by one ; character.\n'\n'Successfully tested 2019-10-03 in Access 2019 / 64-bit / VBA with a\n'standard combobox on a form.\n\nPublic Function QuoteStringForValueList(sString As String) As String\n\n  Dim sTemp As String, sDDQ As String\n\n  'String containing two double quotes to make reading easier\n  sDDQ = Chr(34) &amp; Chr(34)\n\n  'Replace each double quote by four double quotes\n  sTemp = Replace(sString, Chr(34), sDDQ &amp; sDDQ)\n\n  'Add two leading and two trailing double quotes\n  QuoteStringForValueList = sDDQ &amp; sTemp &amp; sDDQ\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2997, "user_id": 3239842, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/43fb8ed63990c7b890667c0a6c5e4674?s=128&d=identicon&r=PG&f=1", "display_name": "Binarus", "link": "https://stackoverflow.com/users/3239842/binarus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 512, "favorite_count": 0, "accepted_answer_id": 58210141, "answer_count": 2, "score": 2, "last_activity_date": 1594421604, "creation_date": 1570054798, "last_edit_date": 1594421604, "question_id": 58210053, "link": "https://stackoverflow.com/questions/58210053/how-to-add-an-item-to-a-combobox-using-additem-which-contains-a-semicolon", "title": "How to add an item to a combobox (using AddItem()) which contains a semicolon?", "body": "<p>I have a multi-column combobox on an Access form (Access 2019 x64, if that matters) and would like to use its <code>AddItem()</code> method to populate it as described <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.combobox.additem?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaac10.chm11476)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">in this documentation</a>. Citing from it:</p>\n\n<blockquote>\n  <p>For multiple-column lists, use semicolons to delimit the strings for\n  each column (for example, \"1010;red;large\" for a three-column list).\n  If the Item argument contains fewer strings than columns in the\n  control, items will be added starting with the left-most column. If\n  the Item argument contains more strings than columns in the control,\n  the extra strings are ignored.</p>\n</blockquote>\n\n<p>So it is impossible to add a string for a certain column when the string itself already contains a semicolon?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570054230, "post_id": 58209909, "comment_id": 102797516, "body": "Maybe make a example data set for us to work with? Maybe with 4 columns and a few rows? Be sure to show the expected output as well using your sample data. Once the logic/code that is needed is found, you can extrapolate to your larger problem. I don&#39;t exactly follow what you need - at least not enough to provide a working solution"}, {"owner": {"reputation": 601, "user_id": 4906546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89e3e5182f580097b68f7f45dec5568?s=128&d=identicon&r=PG&f=1", "display_name": "Papa Kojo", "link": "https://stackoverflow.com/users/4906546/papa-kojo"}, "edited": false, "score": 0, "creation_date": 1570065290, "post_id": 58209909, "comment_id": 102799647, "body": "Sometimes it takes effort to visualize descriptions so maybe (next time) pictures of the sheets will help with question. As a suggestion, don&#39;t try to do everything at ones. I will use a for loop and a if statement to check if something exist on Sheet1 row 3 and if works fine then i will try incorporate Sheet2"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570073263, "post_id": 58209909, "comment_id": 102800902, "body": "With all this information... one approach will be: 1) Split the data on column CV on the following columns to have all the words you will search for. 2) If they are just a few, you should consider to use conditional formula <code>=IF(CV3=&quot;Word1&quot;,&quot;Do this&quot;,IF(CV3=&quot;Word2&quot;, ....)) 3)</code> Regarding the matching, it depends if there are some matches or just one."}], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 11699557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BtdFS.png?s=128&g=1", "display_name": "NSJacob1", "link": "https://stackoverflow.com/users/11699557/nsjacob1"}, "is_accepted": false, "score": 0, "last_activity_date": 1570129989, "last_edit_date": 1570129989, "creation_date": 1570121644, "answer_id": 58223694, "question_id": 58209909, "link": "https://stackoverflow.com/questions/58209909/using-two-values-in-a-sheet-to-filter-and-return-values-from-a-table-in-another/58223694#58223694", "title": "Using two values in a sheet to filter and return values from a table in another sheet", "body": "<p>My Excel subscription has expired an I've started using Google Sheets for most of my spreadsheet work, so I tested this there. Some conversion may be required. I did this using formulas, not VBA also, not sure if that changes things for you.</p>\n\n<p>If I understand correctly, you have two sheets with a shared key column, sheet 1 contains search terms across multiple columns, and sheet 2 contains search terms comma delimited in a single column.</p>\n\n<ol>\n<li>With this setup we want to bring the search term column of sheet 2 into the correct row of sheet 1 by key using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.vlookup\" rel=\"nofollow noreferrer\">VLOOKUP</a>. I made a named range in sheets which contained all my data on sheet 2 and called it \"dst\". My formula was then <code>=VLOOKUP(A2, dst, 7, true)</code> since my key in sheet 1 was in column A, dst was the range I was searching, my column with my delimited search terms was column 7 in relation to dst, and I had ordered sheet 2 by key. I pasted this formula relatively down all rows as needed.</li>\n<li>We want to construct a regex string using our search terms across multiple columns in sheet 1, into a single cell. I used <code>=JOIN(\"|\", B2:E2)</code> on sheet 1 since my search terms were in columns B:E, and this resulted in a regex that looked like this for me: <code>alligator|dog|rabbit|lizard</code> where alligator, dog, rabbit, and lizard, were all search terms in that row. Paste down relative as needed.</li>\n<li>We want to run our regex against our search target cell containing the comma delimited search terms. I ran <code>=REGEXMATCH(F2, G2)</code> where F2 was my delimited search terms from sheet 2, and G2 was my constructed regex for the row. Paste down relative as needed.</li>\n</ol>\n\n<p>A screenshot of my completed sheet 1:\n<img src=\"https://i.stack.imgur.com/aM3Cl.png\" alt=\"image\"></p>\n\n<p>Once you know which cells have matches you can do whatever you want.</p>\n"}], "owner": {"reputation": 9, "user_id": 12156231, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MA9OaJ_DUGQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfMgX_UyH_xm9lqW2I_W2uKbITauQ/photo.jpg?sz=128", "display_name": "Upcomingprogrammer", "link": "https://stackoverflow.com/users/12156231/upcomingprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570129989, "creation_date": 1570053720, "last_edit_date": 1570053978, "question_id": 58209909, "link": "https://stackoverflow.com/questions/58209909/using-two-values-in-a-sheet-to-filter-and-return-values-from-a-table-in-another", "title": "Using two values in a sheet to filter and return values from a table in another sheet", "body": "<p>I'm fairly new to coding and i've been googling around for the last few hours trying to solve this problem but it seems to be a little beyond what i'm able to do so i would be very grateful for some help</p>\n\n<p>In Sheet1, I have a table which has columns between M - CV (175 columbs). For each column, i have an \"ID number\" value in row 3. From Row 6 to the end of the table, i have several \"search terms\" separated by commas in the column CV</p>\n\n<p>In Sheet2, the corresponding \"ID Numbers\" are in column B. Column AN contains strings. </p>\n\n<p>For each ID Number value in sheet1, i'm looking to find find all the corresponding cells in sheet2 where the ID number in Column B is the same, and  Column AN of sheet2 contains at least one of the \"search terms\" in column CV</p>\n\n<p>For each ID number, i'm hoping to join the entries in Column AN of sheet2 which match the criteria above and paste them into Row 5 of the respective column in Sheet1</p>\n\n<p>I've gone around in quite a few circles trying to do this and i'm back to square 1 with no code to show for it. </p>\n\n<p>I've tried to research both the autofilter function, and using for loops. The research i've done indicates that for loops are rather slow to run for a large data set. </p>\n\n<p>I'm hoping to find a solution which is as easy to read and understand as possible </p>\n\n<p>I hope i've given enough information for everyone to understand and help</p>\n\n<p>THank you in advance</p>\n"}, {"tags": ["vba", "outlook", "mailitem"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 1656131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82864ea38a824baeed413157ebcc6231?s=128&d=identicon&r=PG", "display_name": "user1656131", "link": "https://stackoverflow.com/users/1656131/user1656131"}, "edited": false, "score": 0, "creation_date": 1570214004, "post_id": 58230152, "comment_id": 102855468, "body": "This is an Exchange mailbox. This seems plausible, is there a way around it? How would I make sure that the macro is referencing the latest version of the item?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 31, "user_id": 1656131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82864ea38a824baeed413157ebcc6231?s=128&d=identicon&r=PG", "display_name": "user1656131", "link": "https://stackoverflow.com/users/1656131/user1656131"}, "edited": false, "score": 0, "creation_date": 1570218185, "post_id": 58230152, "comment_id": 102856889, "body": "There is no much you can do - you can release the item as soon as you are done with it. If you need to open it in the future, reopen it by the (previously saved) entry id using Namespace.GetItemFromID. As a rule of thumb, do not keep Outlook items referenced for any prolonged periods of time (open. modify save, release) and avoid having to save the item multiple times - make all the changes in a single pass,."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1570165073, "creation_date": 1570165073, "answer_id": 58230152, "question_id": 58209827, "link": "https://stackoverflow.com/questions/58209827/outlook-vba-fails-to-save-changes-to-mailitem-on-older-items-only/58230152#58230152", "title": "Outlook VBA fails to save changes to MailItem on older items only", "body": "<p>Is this is an Exchange mailbox, it is possible that Exchange modified the item on the server side, that change was downloaded to the OST file, but since Outlook Object Model is not aware of the change, when you try to save the (stale) item, you get a conflict error. </p>\n"}], "owner": {"reputation": 31, "user_id": 1656131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82864ea38a824baeed413157ebcc6231?s=128&d=identicon&r=PG", "display_name": "user1656131", "link": "https://stackoverflow.com/users/1656131/user1656131"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570165073, "creation_date": 1570053102, "last_edit_date": 1570084162, "question_id": 58209827, "link": "https://stackoverflow.com/questions/58209827/outlook-vba-fails-to-save-changes-to-mailitem-on-older-items-only", "title": "Outlook VBA fails to save changes to MailItem on older items only", "body": "<p>I have a macro in Outlook VBA that is designed to set the category of the selected email and send a reply email to the sender when a user clicks a button on the \"Ribbon\". </p>\n\n<p>The below code will properly set the category on any newer emails, but throws \"Run-time error '440': Cannot save this item.\" when run on emails that have been sitting around for a while. I don't know what causes this, as it runs fine for a while and then no longer works.</p>\n\n<p>I tried restarting Outlook, logging in and logging out, and restarting the computer, and none of these seem to trigger the change in behavior, so I believe it is somehow related to the duration that the email has been sitting. This is rather confusing, as I don't see why length of time sitting in the folder should affect the ability to save, but not the ability to access the properties of the MailItem.</p>\n\n<p>A simplified version of the code (without the email-sending part, which works fine) is as follows:</p>\n\n<pre><code>Public Sub UpdateCategory\n    Dim objItem as Object\n\n    Set objItem = GetCurrentItem()\n\n    'Verify that selected item is an email and an engineering request\n    If TypeName(objItem) = \"MailItem\" And InStr(LCase(objItem.Subject), \"engineering request\") &gt; 0 Then\n        objItem.Categories = \"Test\"\n        objItem.Save\n    End If\n\n    Set objItem = Nothing\nEnd Sub\n\nFunction GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n\n    Set objApp = Application\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n        Case \"Explorer\"\n            Set GetCurrentItem = objApp.ActiveExplorer.Selection.Item(1)\n        Case \"Inspector\"\n            Set GetCurrentItem = objApp.ActiveInspector.CurrentItem\n    End Select\n\n    Set objApp = Nothing\nEnd Function\n</code></pre>\n\n<p>Any thoughts or suggestions would be greatly appreciated!!</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1570056717, "post_id": 58209744, "comment_id": 102798043, "body": "Apparently Excel cannot handle Access queries with custom functions. Putting function in Excel would not be helpful, query is still in Access."}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1570101075, "post_id": 58209744, "comment_id": 102811798, "body": "Have you tried to use the same VBA code to open the recordset (using ADO) in MS Access? Does that work?"}, {"owner": {"reputation": 21, "user_id": 10388103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb8656aeba75773e4ebe0aa8e440a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladytr0uble", "link": "https://stackoverflow.com/users/10388103/ladytr0uble"}, "edited": false, "score": 0, "creation_date": 1570121742, "post_id": 58209744, "comment_id": 102822661, "body": "Wolfgang Kais - Nope :("}], "owner": {"reputation": 21, "user_id": 10388103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb8656aeba75773e4ebe0aa8e440a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladytr0uble", "link": "https://stackoverflow.com/users/10388103/ladytr0uble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570099948, "creation_date": 1570052623, "last_edit_date": 1570099948, "question_id": 58209744, "link": "https://stackoverflow.com/questions/58209744/excel-does-not-recognize-function-in-access", "title": "Excel does not recognize Function in Access", "body": "<p>I wrote a public function in Access.  When I try to get data from a query that uses the function in Excel, I get an error: </p>\n\n<pre><code>Undefined function 'function_name' in expression.\n</code></pre>\n\n<p>I have pasted the same function into my Excel module.  And made sure both functions are public.</p>\n\n<p>Nothing fancy, just:</p>\n\n<pre><code>strSQL = \"Select Distinct Coordinator From vw_CDPAP_DOH_M11Q_Due;\"\nSet rs1 = Conn.Execute(strSQL)\n</code></pre>\n\n<p>If I use</p>\n\n<pre><code>Select Distinct Coordinator From vw_CDPAP_DOH_M11Q_Due; \n</code></pre>\n\n<p>in Access, I get the intended results.</p>\n\n<p>TIA!</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1570053218, "post_id": 58209615, "comment_id": 102797278, "body": "Yes, both of these return &quot;2739&quot; as expected."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1570053458, "post_id": 58209615, "comment_id": 102797330, "body": "Looking at the query results, there are no oddities, especially near record 2540..."}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1570053763, "post_id": 58209615, "comment_id": 102797402, "body": "After Loop, n = 2739"}, {"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1570055001, "post_id": 58209615, "comment_id": 102797677, "body": "Oddly, &quot;Debug.Print .Fields(&quot;DESC&quot;).Value&quot; returns 199 records (rather than the expected 2739)."}], "answers": [{"comments": [{"owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "edited": false, "score": 0, "creation_date": 1570055260, "post_id": 58210058, "comment_id": 102797718, "body": "Ouch!  Did not expect that.  In my current (real) function I was stepping thru a PAIR of tables (one a subset of records of the other).  I was seeing an unexpected EOF error which seemed to be supported by the missing rows in the debug window.  Going back to revisit that issue.  Thanks"}], "tags": [], "owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "is_accepted": true, "score": 2, "last_activity_date": 1570054833, "creation_date": 1570054833, "answer_id": 58210058, "question_id": 58209615, "link": "https://stackoverflow.com/questions/58209615/stepping-thru-a-dao-recordset-skips-past-the-first-2540-records-huh/58210058#58210058", "title": "Stepping thru a DAO.Recordset - skips past the first 2540 records - Huh?", "body": "<p>The immediate window has a line limit of 199. So it's only displaying the last 199 line results of your code.</p>\n"}], "owner": {"reputation": 1249, "user_id": 2145932, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d99eb67a4425e46fe138a73e0b72e8f?s=128&d=identicon&r=PG", "display_name": "Mark Pelletier", "link": "https://stackoverflow.com/users/2145932/mark-pelletier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 58210058, "answer_count": 1, "score": 0, "last_activity_date": 1594421614, "creation_date": 1570051740, "last_edit_date": 1594421614, "question_id": 58209615, "link": "https://stackoverflow.com/questions/58209615/stepping-thru-a-dao-recordset-skips-past-the-first-2540-records-huh", "title": "Stepping thru a DAO.Recordset - skips past the first 2540 records - Huh?", "body": "<p>Seems a straightforward enough task, but I am seeing an odd result.</p>\n\n<p>1) The Recordset is based on a valid query that returns 2739 records</p>\n\n<p>2) When I <code>.MoveFirst</code> then step thru with <code>.MoveNext</code>, sending output to debug.print, the loop seems to be skipping the first 2540 records.  The Index numbers align with the ID values from my query.</p>\n\n<p>3) The simplified code below reaches the EOF as expected</p>\n\n<p>Any suggestions what might be happening?</p>\n\n<pre><code>Dim rs1 As DAO.Recordset\nDim n As Integer\nDim db As Database\n\nSet db = CurrentDb\nSet rs1 = db.OpenRecordset(\"myQuery\")\n\nn = 0\n\nWith rs1\n    .MoveFirst\n    Do Until .EOF\n        n = n + 1\n        Debug.Print n &amp; \" - \" &amp; .Fields(\"INPUT_ID\")\n        .MoveNext\n    Loop\nEnd With\n</code></pre>\n\n<p>The debug results look like this:</p>\n\n<pre><code>2541 - 26023261\n2542 - 26023262\n2543 - 26023263\n&lt;&lt;snip&gt;&gt;\n2737 - 26023457\n2738 - 26023458\n2739 - 26023459\n</code></pre>\n\n<p>What happened to rows 1 thru 2540?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1570053528, "last_edit_date": 1570053528, "creation_date": 1570053124, "answer_id": 58209830, "question_id": 58209526, "link": "https://stackoverflow.com/questions/58209526/deleting-images-but-cant-avoid-deleting-command-button/58209830#58209830", "title": "Deleting images but can&#39;t avoid deleting command button", "body": "<blockquote>\n  <p>I need it to delete the images on the D column, but it deletes the images of the whole sheet.</p>\n</blockquote>\n\n<p>You are iterating all pictures on the sheet, and never verify <em>where on the sheet</em> the picture is before you invoke its <code>Delete</code> method.</p>\n\n<p>Interestingly, if you have one picture and one ActiveX command button on <code>Sheet1</code>, then <code>Sheet1.Pictures.Count</code> returns, unexpectedly, <code>2</code> - that's why the loop is also deleting command buttons.</p>\n\n<p>I'd suggest iterating the <code>Shapes</code> collection instead: a <code>Shape</code> object has an interface that makes it much easier to tell a picture apart from an ActiveX button, ...and to know where on the sheet it's at.</p>\n\n<p>Using <code>Shape.Type</code> we can know if we're looking at a <code>msoPicture</code>, and with <code>Shape.TopLeftCell</code> we can get a <code>Range</code> object representing the top-left cell the picture is located at; if the <code>Column</code> of that <code>Range</code> is <code>4</code>, then we're looking at a shape whose upper-left corner is located in column D. Thus:</p>\n\n<pre><code>Dim currentShape As Shape\nFor Each currentShape In ActiveSheet.Shapes\n    If currentShape.Type = msoPicture And currentShape.TopLeftCell.Column = 4 Then\n        currentShape.Delete\n    End If\nNext\n</code></pre>\n\n<p>Note how declaring an explicit type that isn't <code>Object</code> for our loop variable, we get compile-time validation, and autocomplete/intellisense for every single one of these member calls, whereas calls made against <code>Object</code> are all late-bound (i.e. compiles perfectly fine with typos, even if you have <code>Option Explicit</code> at the top of your module) and will only blow up at run-time if anything is wrong (e.g. error 438 if you try to invoke a member that doesn't exist).</p>\n"}, {"tags": [], "owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "is_accepted": false, "score": 0, "last_activity_date": 1570060097, "creation_date": 1570060097, "answer_id": 58210682, "question_id": 58209526, "link": "https://stackoverflow.com/questions/58209526/deleting-images-but-cant-avoid-deleting-command-button/58210682#58210682", "title": "Deleting images but can&#39;t avoid deleting command button", "body": "<p>The following compares the picture's range with your range and deletes it if they intersect:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n    Dim objPicture As Object\n    Dim objPictureRange As Object\n    Dim objRange As Object\n\n    Set objRange = Range(\"D20:D3000\")\n    objRange.ClearContents\n\n    For Each objPicture In ActiveSheet.Pictures\n\n        ' Get Picture's range\n        Set objPictureRange = Range(objPicture.TopLeftCell.Address &amp; \":\" &amp; objPicture.BottomRightCell.Address)\n\n        ' Check if Picture is in Range\n        If Not Intersect(objRange, objPictureRange) Is Nothing Then\n            ' Delete picture\n            objPicture.Delete\n        End If\n\n    Next Pic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12156156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d2f3011629ad718cfe959be2a9d63f?s=128&d=identicon&r=PG&f=1", "display_name": "BecaB", "link": "https://stackoverflow.com/users/12156156/becab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1570084126, "creation_date": 1570051269, "last_edit_date": 1570084126, "question_id": 58209526, "link": "https://stackoverflow.com/questions/58209526/deleting-images-but-cant-avoid-deleting-command-button", "title": "Deleting images but can&#39;t avoid deleting command button", "body": "<p>I'm not a regular user of vba, so when I started doing this code I was totally blank. I already deleted all the images on the worksheet, including command buttons and a logo I didn't meant to delete. </p>\n\n<p>This is my code </p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim Pic As Object\n\nRange(\"D20:D3000\").ClearContents\n\nFor Each Pic In ActiveSheet.Pictures\nPic.Delete\nNext Pic\n\n\nEnd Sub\n</code></pre>\n\n<p>As you can see I need it to delete the images on the D column, but it deletes the images of the whole sheet.\nI can't find a way to exclude command buttons (I'm using 2 on that sheet) of the deleting instruccion. Would some of you please, please, please help me? I'm a mess right now. </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1570082052, "post_id": 58209476, "comment_id": 102802759, "body": "There&#39;s some information missing... What triggers the code posted in the question? On Exit, On Enter of form fields? Something else? My inclincation is to say, clear those other drop-downs On Enter for the parent..."}, {"owner": {"reputation": 1, "user_id": 7504804, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zs5jxTXSsdA/AAAAAAAAAAI/AAAAAAAAAFc/45Yecj0OlHY/photo.jpg?sz=128", "display_name": "Ali Tahrei Sh.", "link": "https://stackoverflow.com/users/7504804/ali-tahrei-sh"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1571257774, "post_id": 58209476, "comment_id": 103184686, "body": "I meant when the user changes the department, the drive dropdown should get clear."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1571259629, "post_id": 58209476, "comment_id": 103185463, "body": "Well, form fields can&#39;t do anything when a selection is made. The only actions they have are OnEnter and OnExit. So code to re-set the drive dropdown would need to be run by the department field&#39;s On Exit property."}], "owner": {"reputation": 1, "user_id": 7504804, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Zs5jxTXSsdA/AAAAAAAAAAI/AAAAAAAAAFc/45Yecj0OlHY/photo.jpg?sz=128", "display_name": "Ali Tahrei Sh.", "link": "https://stackoverflow.com/users/7504804/ali-tahrei-sh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570084140, "creation_date": 1570050975, "last_edit_date": 1570084140, "question_id": 58209476, "link": "https://stackoverflow.com/questions/58209476/how-to-reset-a-drop-down-when-user-changes-the-parent-drop-down", "title": "How to reset a Drop-Down when user changes the parent Drop-Down?", "body": "<p>My boss wants me to make a form in MS Word for the user to request access to a shared drive based on their department. The form has three drop-down depended on one parent drop-down, so when the user selects a department the child drop-downs just show the shared drives that are for that specific department. \nI have written it but the problem is after they choose an option in any of the child drop-downs and then changed the parent, the child still is there, which is wrong. how can I reset the child drop-downs when the parent one is changed?\nhere is my code</p>\n\n<pre><code>Public xDivision As FormField\n\nSub ConditionalDrives()\n    Dim xDrives As FormField\n    Set xDivision = ActiveDocument.FormFields(\"ddDivisions\")\n    On Error Resume Next\n    Set xDrives = ActiveDocument.FormFields(\"ddDrives\")\n    If ((xDivision Is Nothing) And (xDrives Is Nothing)) Then Exit Sub\n        With xDrives.DropDown.ListEntries\n            Select Case xDivision.Result\n                Case \"Admin\"\n                    .Clear\n                    .Add \"(F:) \\\\SHEARDDRIVE1\\ADMIN\"\n                    .Add \"(H:) \\\\SHEARDDRIVE2(Confidential Staff)\"\n                    .Add \"(N:) \\\\SHEARDDRIVE3(Personnel)\"\n                Case \"IT\"\n                    .Clear\n                    .Add \"(F:) \\\\SHEARDDRIVE1\"\n                    .Add \"(Y:) \\\\SHEARDDRIVE2\"\n                Case \"HR\"\n                    .Clear\n                    .Add \"(F:) \\\\HRSHEARDDRIVE\"\n                    .Add \"(M:) \\\\SHEARDDRIVE2\"\n            End Select\n        End With\n End Sub\n\nSub ConditionalDrives2()\n    Dim xDrives2 As FormField\n    Set xDrives2 = ActiveDocument.FormFields(\"ddDrives2\")\n        With xDrives2.DropDown.ListEntries\n            Select Case xDivision.Result\n                Case \"Admin\"\n                    .Clear\n                    .Add \"(F:) \\\\SHEARDDRIVE1\\ADMIN\"\n                    .Add \"(H:) \\\\SHEARDDRIVE2(Confidential Staff)\"\n                    .Add \"(N:) \\\\SHEARDDRIVE3(Personnel)\"\n                Case \"IT\"\n                    .Clear\n                    .Add \"(F:) \\\\SHEARDDRIVE1\"\n                    .Add \"(Y:) \\\\SHEARDDRIVE2\"\n                Case \"HR\"\n                    .Clear\n                    .Add \"(F:) \\\\HRSHEARDDRIVE\"\n                    .Add \"(M:) \\\\SHEARDDRIVE2\"\n            End Select\n        End With\nEnd Sub\nSub ConditionalDrives3()\n    Dim xDrives3 As FormField\n    Set xDrives3 = ActiveDocument.FormFields(\"ddDrives3\")\n        With xDrives3.DropDown.ListEntries\n             Select Case xDivision.Result\n                Case \"Admin\"\n                    .Clear\n                    .Add \"(F:) \\\\SHEARDDRIVE1\\ADMIN\"\n                    .Add \"(H:) \\\\SHEARDDRIVE2(Confidential Staff)\"\n                    .Add \"(N:) \\\\SHEARDDRIVE3(Personnel)\"\n                Case \"IT\"\n                    .Clear\n                    .Add \"(F:) \\\\SHEARDDRIVE1\"\n                    .Add \"(Y:) \\\\SHEARDDRIVE2\"\n                Case \"HR\"\n                    .Clear\n                    .Add \"(F:) \\\\HRSHEARDDRIVE\"\n                    .Add \"(M:) \\\\SHEARDDRIVE2\"\n            End Select\n        End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "edited": false, "score": 0, "creation_date": 1570050308, "post_id": 58208832, "comment_id": 102796449, "body": "Welcome to Stack Overflow! Thanks for your question. Please edit your question and add the code or formulas you are using to update Sheet2."}], "answers": [{"comments": [{"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "reply_to_user": {"reputation": 1, "user_id": 12155899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7N7rLgMGOVQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRR5fTehnyGZeUIQntB98rI0fo4A/photo.jpg?sz=128", "display_name": "Tauseef Ahmad", "link": "https://stackoverflow.com/users/12155899/tauseef-ahmad"}, "edited": false, "score": 0, "creation_date": 1570200743, "post_id": 58209141, "comment_id": 102850131, "body": "@TauseefAhmad Would appreciate an up-vote on the answer if it is indeed solving your problem."}], "tags": [], "owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "is_accepted": false, "score": 0, "last_activity_date": 1570049236, "creation_date": 1570049236, "answer_id": 58209141, "question_id": 58208832, "link": "https://stackoverflow.com/questions/58208832/how-to-save-previous-date-data-and-move-to-the-next-date-data-in-one-sheet-refer/58209141#58209141", "title": "How to save previous date data and move to the next date data in one sheet reference to changing a date in another sheet", "body": "<p>Before you change the date and after you complete your work on sheet 1, copy sheet 2 (leaving the normal sheet 2 where it is) to a new location either in the same workbook or a new one then select all cells on the copied sheet2, copy them, and then paste special values.</p>\n\n<p>Then you should change the date in sheet1 (which apparently then clears all the cells in sheet2 according to your description).</p>\n"}], "owner": {"reputation": 1, "user_id": 12155899, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-7N7rLgMGOVQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRR5fTehnyGZeUIQntB98rI0fo4A/photo.jpg?sz=128", "display_name": "Tauseef Ahmad", "link": "https://stackoverflow.com/users/12155899/tauseef-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1570086202, "creation_date": 1570047547, "last_edit_date": 1570086202, "question_id": 58208832, "link": "https://stackoverflow.com/questions/58208832/how-to-save-previous-date-data-and-move-to-the-next-date-data-in-one-sheet-refer", "title": "How to save previous date data and move to the next date data in one sheet reference to changing a date in another sheet", "body": "<p>I`m working on a report, that has two worksheets, on a daily basis. In sheet1 I do my work and in sheet2 is the monthly summary of the sheet1 datewise, but when I change the date in sheet1, the data in sheet2 disappears and updates it with the current date. How can I keep my previous date data saved? For example, if today is 1/1/19 and I do my work in sheet1, in the summary it will show underneath date 1/1/2019 but the next day 1/2/19 it disappears from 1/1/19 and shows the result in 1/2/19. Please help thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570047051, "post_id": 58208653, "comment_id": 102795333, "body": "Is it in the <code>ThisWorkbook</code> module or a regular module?"}, {"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570047505, "post_id": 58208653, "comment_id": 102795475, "body": "It is in ThisWorkbook module"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570048091, "post_id": 58208653, "comment_id": 102795690, "body": "May I ask why? See for example <a href=\"http://www.cpearson.com/excel/writingfunctionsinvba.aspx\" rel=\"nofollow noreferrer\">here</a>: &quot;The code for a UDF should be placed in a standard code module, not one of the Sheet modules and not in the ThisWorkbook module.&quot;"}, {"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570048863, "post_id": 58208653, "comment_id": 102795955, "body": "Okay so would it just be \u201csheet1!ConvertDate(h1)\u201d?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1570049229, "post_id": 58208653, "comment_id": 102796097, "body": "<code>=ConvertDate(H1)</code>."}, {"owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570049569, "post_id": 58208653, "comment_id": 102796197, "body": "If I put the code in sheet one then it comes up as s 400 error. If I put it in ThisWorkbook then it does not retrieve the ConvertDate function"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570049595, "post_id": 58208653, "comment_id": 102796206, "body": "Don&#39;t put it in the sheet code module, but in a regular module. See my previous comment."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1570049853, "creation_date": 1570049853, "answer_id": 58209259, "question_id": 58208653, "link": "https://stackoverflow.com/questions/58208653/trying-to-get-a-function-formula-from-workbook/58209259#58209259", "title": "Trying to get a function formula from workbook", "body": "<p>Don't put it in the <code>ThisWorkbook</code> module or a <code>Sheet</code> module, but instead in a <em>regular</em> module. Then drop the <code>Personal.xlsb!</code>.</p>\n\n<pre><code>Sub tst\n    Range(\"A1\").Formula = \"=convertDate(H1)\"\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 11694280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/972206e0af51675ddd02675eb0bda038?s=128&d=identicon&r=PG&f=1", "display_name": "Djh006", "link": "https://stackoverflow.com/users/11694280/djh006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570086230, "creation_date": 1570046765, "last_edit_date": 1570086230, "question_id": 58208653, "link": "https://stackoverflow.com/questions/58208653/trying-to-get-a-function-formula-from-workbook", "title": "Trying to get a function formula from workbook", "body": "<pre><code>Sub tst\n    Range(\u201cA1\u201d).Formula = \u201c=Personal.xlsb!convertDate(H1)\u201d\nEnd sub\n</code></pre>\n\n<p>How do I change this formula to call the function when I put the macro in ThisWorkbook instead of my personal workbook?</p>\n"}, {"tags": ["excel", "vba", "compare", "worksheet"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570046875, "post_id": 58208599, "comment_id": 102795259, "body": "Depending on your version of Excel, you could probably use the Inquire add-in to do this."}, {"owner": {"reputation": 9, "user_id": 12135571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23fbcaf3e6461859b19723a09003bf85?s=128&d=identicon&r=PG&f=1", "display_name": "mollieda", "link": "https://stackoverflow.com/users/12135571/mollieda"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571592691, "post_id": 58208599, "comment_id": 103284059, "body": "Hi, thank you for your answer but could you be more precise on what I shall do. Thanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1571601296, "post_id": 58208599, "comment_id": 103286138, "body": "<a href=\"https://support.office.com/en-us/article/what-you-can-do-with-spreadsheet-inquire-ebaf3d62-2af5-4cb1-af7d-e958cc5fad42\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "owner": {"reputation": 9, "user_id": 12135571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23fbcaf3e6461859b19723a09003bf85?s=128&d=identicon&r=PG&f=1", "display_name": "mollieda", "link": "https://stackoverflow.com/users/12135571/mollieda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1571640116, "creation_date": 1570046519, "last_edit_date": 1571640116, "question_id": 58208599, "link": "https://stackoverflow.com/questions/58208599/vba-excel-macro-that-allows-to-compare-2-excel-worksheets-and-copy-differences-i", "title": "VBA Excel Macro that allows to compare 2 Excel worksheets and copy differences in a third worksheets?", "body": "<p>I'm beginner with VBA code. I'm looking for help in writing code that can compare 2 Excel worksheets and copy differences in a new worksheet. In the third worksheet, I would to add a column indicating if there is added data, removed data or change between sheet 1 and sheet 2. </p>\n\n<p>Here is an example of what I'm looking for given 2 sheets of data and the final output : </p>\n\n<p>Sheet1 \"Update\" :\n<a href=\"https://i.stack.imgur.com/8uEcy.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Sheet2 \"Original\" : \n<a href=\"https://i.stack.imgur.com/8MSup.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Sheet3 \"Result\"  : \n<a href=\"https://i.stack.imgur.com/Ru062.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>Many thanks in advance for your help. </p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1570046545, "post_id": 58208467, "comment_id": 102795129, "body": "You could repeatedly run an UPDATE query that will REPLACE([Vendor Name1], &quot;_X&quot;, &quot;X&quot;)"}, {"owner": {"reputation": 41, "user_id": 9236284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b771c70f436b776121e0d5267c44a95a?s=128&d=identicon&r=PG&f=1", "display_name": "Kato", "link": "https://stackoverflow.com/users/9236284/kato"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1570046766, "post_id": 58208467, "comment_id": 102795219, "body": "The point is to not have to repeat running the query."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1570046954, "post_id": 58208467, "comment_id": 102795295, "body": "Add your solution below as its own answer!"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1570047465, "post_id": 58208467, "comment_id": 102795462, "body": "Remember Access and Excel are very different softwares not to be confused or conflated. Likely, Access&#39; <code>TRIM</code> follows the <a href=\"https://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt\" rel=\"nofollow noreferrer\">SQL standard</a> to only remove leading and trailing spaces"}], "owner": {"reputation": 41, "user_id": 9236284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b771c70f436b776121e0d5267c44a95a?s=128&d=identicon&r=PG&f=1", "display_name": "Kato", "link": "https://stackoverflow.com/users/9236284/kato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1238, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1570047481, "creation_date": 1570045832, "last_edit_date": 1570047481, "question_id": 58208467, "link": "https://stackoverflow.com/questions/58208467/trim-all-extra-spaces-in-string-for-an-access-column", "title": "Trim all extra spaces in string for an Access column", "body": "<p>[SOLVED] I played around with my Update query this is what ended up working</p>\n\n<pre><code>UPDATE NewData SET NewData.[Vendor Name1] = \nTrim(replace(replace(Replace([Vendor Name1],' ','&lt;&gt;'),'&gt;&lt;',''),'&lt;&gt;',' '));\n</code></pre>\n\n<p>I have created an Update query to select an entire column in which I have to trim. However, I learned that Access's trim is different than Excel's trim. \nI want to be able to remove all extra spaces before and after the string, but also any extra spaces in between. </p>\n\n<p>For example \"__X_X__XXX____X_X_\" turns into \"A_A_AAA_A_A\"</p>\n\n<p>Is there a VBA function or UPDATE SQL code that can help me achieve this?\nThe fieldname is [Vendor Name1] (not the best column name, but it is what is being used at the moment)</p>\n\n<p>Other information that I think will help, the column is being pulled and updated from a querytable [NewData]</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570053722, "post_id": 58208306, "comment_id": 102797395, "body": "Sounds like your worksheet contains errors. A cell that contains an error value will be <code>Variant&#47;Error</code> - you should verify with <code>IsError</code> whether that&#39;s the case, <i>before</i> you try to treat that error value as a string or number. <code>CStr</code> against a <code>Variant&#47;Error</code> will probably not yield the result you&#39;re expecting. Also always validate with <code>IsNumeric</code> before doing math against values taken from a worksheet."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6664244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aef3825e2ba5138460b7f062aaacee?s=128&d=identicon&r=PG&f=1", "display_name": "dashton", "link": "https://stackoverflow.com/users/6664244/dashton"}, "edited": false, "score": 0, "creation_date": 1570049884, "post_id": 58208945, "comment_id": 102796307, "body": "I tried CInt, and then it threw a type mismatch error.  However, because of your answer I looked up CInt and found that Val() does something similar.  Using Val fixed the concatenation and type error issue.  The second issue with the calculation not performing is due to my lack of observation, as I failed to notice those values in that row actually contain some text in them so the subtraction doesnt make sense.  Im fixing that part now, thanks for the help!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570053831, "post_id": 58208945, "comment_id": 102797422, "body": "Sounds like the real problem is lack of validation. See what <code>IsError</code> and <code>IsNumeric</code> can do for you given any <code>Variant</code> value."}], "tags": [], "owner": {"reputation": 86, "user_id": 10772767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2ec6501aad428b9b9f0f4b07fdb4af0?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Strasser", "link": "https://stackoverflow.com/users/10772767/robert-strasser"}, "is_accepted": true, "score": 1, "last_activity_date": 1570048121, "creation_date": 1570048121, "answer_id": 58208945, "question_id": 58208306, "link": "https://stackoverflow.com/questions/58208306/unnecessary-value-concatenation-and-type-errors-in-excel-vba/58208945#58208945", "title": "Unnecessary value concatenation and Type Errors in Excel VBA", "body": "<p>Have you tried CSTRING or CINT functions?</p>\n\n<p>For example:\ntester(i) = CString(ActiveSheet.Cells(row, col_test).Value) </p>\n"}], "owner": {"reputation": 33, "user_id": 6664244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89aef3825e2ba5138460b7f062aaacee?s=128&d=identicon&r=PG&f=1", "display_name": "dashton", "link": "https://stackoverflow.com/users/6664244/dashton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58208945, "answer_count": 1, "score": 0, "last_activity_date": 1570048121, "creation_date": 1570045114, "last_edit_date": 1570045388, "question_id": 58208306, "link": "https://stackoverflow.com/questions/58208306/unnecessary-value-concatenation-and-type-errors-in-excel-vba", "title": "Unnecessary value concatenation and Type Errors in Excel VBA", "body": "<p>My VBA code takes a .txt file from a specific software output (Carlson Survey software) and does some calculations, then converts it into a .CSV file.  I am specifically having issues with the calculation component, where one of my columns of the text file (brought into excel using comma separators) isn't doing the calculation I tell it, and is seemingly concatenating itself (removes everything after the decimal point).  My assumption is, that because I am taking these values into an Array (which had to be set as string, or else I was getting type errors) which is set as a string, this is causing the concatenation after the decimal point.  I am at a loss as to why the calculation doesn't appear to be running though, as the program seemingly executes fine.  </p>\n\n<p>And the VBA script for quick reference (specific section with problem is the 'Do data conversion' section: </p>\n\n<pre><code>Private Sub Workbook_Open()\nSheets(\"Sheet1\").Cells.ClearContents\n'---------------------------------------------------------------------------------------\n'Choose and open the .TXT file for conversion\nDim answer As Integer\nanswer = MsgBox(\"Do you want to process a .TXT file for use in InfoSWMM?\", vbYesNo + vbQuestion, \"Select .TXT File\")\nIf answer = vbNo Then\n    Exit Sub\nEnd If\nDim Ret\nRet = Application.GetOpenFilename(\"Text Files (*.txt),*.txt\")\nIf Ret &lt;&gt; False Then\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; Ret, Destination:=Range(\"$A$1\") _\n        )\n        .Name = \"Sample\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd If\n'---------------------------------------------------------------------------------------\n'Do data conversion, SECTION NEEDS UPDATING LACKING FEATURES, BUGS\nDim row As Integer\nDim col As Integer\nDim i As Integer\nDim tester(3) As String 'Bug[1] related, type error (see below).  String type fixes type error, but causes undesired concatenation\nDim col_test As Integer\nDim rim As Integer\n\nFor row = 1 To ActiveSheet.UsedRange.Rows.Count\n    If IsEmpty(ActiveSheet.Cells(row, 1).Value) = True Then\n        Exit For\n    End If\n    'Change these values in case feature code library is changed in Carlson, also need to add extra fields\n    If ActiveSheet.Cells(row, 5).Value = \"SD\" Or ActiveSheet.Cells(row, 5).Value = \"WQ\" Then\n        col_test = 20\n        rim = ActiveSheet.Cells(row, 4).Value\n        For i = 0 To 3\n            tester(i) = ActiveSheet.Cells(row, col_test).Value 'Bug[1] here, type error if not a String.\n            col_test = col_test + 4\n        Next i\n        ActiveSheet.Cells(row, 37).Value = rim - Application.Max(tester) 'Bug[2] here, not performing calculation.\n    End If\nNext row\n'---------------------------------------------------------------------------------------\n'Save converted file as .CSV\nMsgBox \"Choose the desired save location for the .CSV file.\"\nDim InitialName As String\nDim PathName As Variant\nDim ws As Worksheet\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\nInitialName = \"sfm_output\"\nPathName = Application.GetSaveAsFilename(InitialFileName:=InitialName, fileFilter:=\"CSV (Comma delimited) (*.csv), *.csv\")\nws.Copy\nActiveWorkbook.SaveAs Filename:=PathName, _\n    FileFormat:=xlCSV, CreateBackup:=False\nMsgBox \"Process completed successfully.\" &amp; vbNewLine &amp; \"File saved to:\" &amp; vbNewLine &amp; PathName\n'---------------------------------------------------------------------------------------\n'Close all Workbooks\nApplication.DisplayAlerts = False\nApplication.Quit\nEnd Sub\n</code></pre>\n\n<p>Any help is greatly appreciated.  Thanks.  </p>\n"}, {"tags": ["excel", "vba", "excel-formula", "countif"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 2, "last_activity_date": 1570043159, "creation_date": 1570043159, "answer_id": 58207884, "question_id": 58207806, "link": "https://stackoverflow.com/questions/58207806/how-to-use-countif-and-vlookup-togther/58207884#58207884", "title": "How to use Countif and Vlookup togther", "body": "<p>use COUNTIFS()</p>\n\n<pre><code>=COUNTIFS(A:A,$D2,B:B,E$1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3064, "user_id": 11768364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kK8lw.png?s=128&g=1", "display_name": "Terry W", "link": "https://stackoverflow.com/users/11768364/terry-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1570065054, "creation_date": 1570065054, "answer_id": 58211157, "question_id": 58207806, "link": "https://stackoverflow.com/questions/58207806/how-to-use-countif-and-vlookup-togther/58211157#58211157", "title": "How to use Countif and Vlookup togther", "body": "<p><a href=\"https://i.stack.imgur.com/wNPkL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wNPkL.png\" alt=\"Examples\"></a></p>\n\n<p><strong>Method 1</strong></p>\n\n<p>Using the following <strong>SUMPRODUCT</strong> formula suppose you have <strong>named</strong> values in Column A as <code>NameList</code> and <strong>named</strong> values in Column B as <code>Value</code>:</p>\n\n<pre><code>=SUMPRODUCT((NameList=$D2)*(Value=E$1))\n</code></pre>\n\n<blockquote>\n  <p>If you want to use formula, I would recommend the <strong>COUNTIFS</strong> function suggested by Scott Craner as it is faster than <strong>SUMPRODUCT</strong> in a large scale.</p>\n</blockquote>\n\n<p><strong>Method 2</strong></p>\n\n<p>You can quickly insert a <strong>pivot table</strong> and set up as shown above to get the count per value per name with a few clicks. Pro is that you do not even need to find the names from the list first, Con is that it is not that flexible to do further calculations from the values within a pivot table. </p>\n"}], "owner": {"reputation": 11, "user_id": 12155593, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDQC2KVHCSgMTakg9MMS6sCv6jP-b6SWeO3eQhcmg=k-s128", "display_name": "Saif Alam", "link": "https://stackoverflow.com/users/12155593/saif-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1570517706, "creation_date": 1570042875, "last_edit_date": 1570517706, "question_id": 58207806, "link": "https://stackoverflow.com/questions/58207806/how-to-use-countif-and-vlookup-togther", "title": "How to use Countif and Vlookup togther", "body": "<p>I am trying to combine COUNTIF and VLOOKUP function so that I can use it to formulate my work and increase my efficiency.for better understanding suppose a column A has 4 people name like 1.jay 2.harry 3.ray . So i have assign them randomly \"0\" and \"1\" . SO ray might get multiple \"0\" and \"1\" and these can happen with everyone. So I want to know how may \"0\" and \"1\" each one get.    </p>\n\n<p><a href=\"https://i.stack.imgur.com/fgkaL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fgkaL.png\" alt=\"\"></a></p>\n\n<p>I have tried everything I know but its giving me wrong data</p>\n\n<pre><code>=COUNTIF(VLOOKUP(A2,A:B,2,0),\"0\")\n</code></pre>\n\n<p>after using the above code its giving me wrong output .</p>\n"}, {"tags": [".net", "vba", "range", "excel-interop"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570043018, "post_id": 58207712, "comment_id": 102793593, "body": "You might want to read up about the <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/general-naming-conventions\" rel=\"nofollow noreferrer\">General Naming Conventions in .NET</a>, particularly the part about &quot;Hungarian Notation&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1570043168, "post_id": 58207712, "comment_id": 102793656, "body": "Also FWIW <code>As New</code> is a bad idea in general, but more particularly so when .NET types are involved."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 2, "last_activity_date": 1570052267, "last_edit_date": 1570052267, "creation_date": 1570043604, "answer_id": 58207978, "question_id": 58207712, "link": "https://stackoverflow.com/questions/58207712/passing-a-range-object-from-vba-to-net-causes-runtime-error-91/58207978#58207978", "title": "Passing a range object from VBA to .NET causes &quot;Runtime Error 91&quot;", "body": "<blockquote>\n  <p>Is the .NET type of: <code>Microsoft.Office.Interop.Excel.Range</code> the same type as VBA: <code>Excel.Range</code>?</p>\n</blockquote>\n\n<p>No, it's not. The .NET type is a managed type, the VBA type is a COM object type. The COM-Interop type is wrapping a COM object, making the unmanaged object available through .NET.</p>\n\n<p>Still, the managed interop type should marshal to &amp; from one &amp; the other perfectly fine.</p>\n\n<p>Except this isn't doing what you think it does:</p>\n\n<blockquote>\n<pre><code>With clsAttempt1\n\n    .FirstProperty = rngObject\n\nEnd With\n</code></pre>\n</blockquote>\n\n<p>Without involving any .NET code, it's the same thing as this:</p>\n\n<pre><code>Public Sub test()\n    Dim foo As Range\n    foo = Sheet1.Range(\"A1\")\nEnd Sub\n</code></pre>\n\n<p>And this code gets flagged by <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a> as follows:</p>\n\n<blockquote>\n  <p><em>Assignment to 'foo' implicitly assigns to the default member '_Default' of class 'EXCEL.EXE:Excel.Range'.</em></p>\n</blockquote>\n\n<p>In other words, you're not assigning <code>.FirstProperty</code>, but to <code>.FirstProperty.[_Default]</code> (that's documented as \"let-coercion\" in the VBA specs, here involving a <em>hidden</em> default member), and if the range reference hasn't been set then that would be raising error 91, since you're making an implicit member call against <code>Nothing</code>.</p>\n\n<p>Try using the <code>Set</code> keyword:</p>\n\n<pre><code>With clsAttempt1\n\n    Set .FirstProperty = rngObject\n\nEnd With\n</code></pre>\n\n<p>The <code>Set</code> keyword is <strong>required</strong> in VBA, whenever you mean to assign an object reference: this is because in VBA, parameterless default members are perfectly legal (they're not in VB.NET).</p>\n"}], "owner": {"reputation": 23, "user_id": 12153610, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155869244515660/picture?type=large", "display_name": "Hein Vogel", "link": "https://stackoverflow.com/users/12153610/hein-vogel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 58207978, "answer_count": 1, "score": 2, "last_activity_date": 1570052267, "creation_date": 1570042438, "last_edit_date": 1570045929, "question_id": 58207712, "link": "https://stackoverflow.com/questions/58207712/passing-a-range-object-from-vba-to-net-causes-runtime-error-91", "title": "Passing a range object from VBA to .NET causes &quot;Runtime Error 91&quot;", "body": "<p>Is the .NET type of:\n<code>Microsoft.Office.Interop.Excel.Range</code>\nthe same type as VBA:\n<code>excel.range</code>\n?</p>\n\n<p>Passing it from VBA to .NET does not work.</p>\n\n<p>It causes:</p>\n\n<blockquote>\n  <p>Run-time error '91': Object variable or With block variable not set.</p>\n</blockquote>\n\n<p>The .NET code (VB.NET in this case) is:</p>\n\n<pre><code>Imports Microsoft.Office.Interop.Excel\n\nPublic Class clsDotNetClass\n\nprivate mRangeObject as Excel.Range\n\nPublic Property FirstProperty As Excel.Range\n\n        Get\n            Return mRangeObject\n\n        End Get\n\n        Set(value As Excel.Range)\n\n            mRangeObject = value\n\n        End Set\n\n    End Property\n\nEnd class\n\n</code></pre>\n\n<p>The VBA is:</p>\n\n<pre><code>Public sub DoesNotWork ()\n\nDim wkbObject As Workbook\nDim shtObject As Worksheet\nDim rngObject As Range\n\nSet wkbObject = ThisWorkbook\nSet shtObject = wkbObject.Worksheets(\"Sheet1\")\nSet rngObject = shtObject.Range(\"A1:B2\")\n\nDim clsAttempt1 as new clsDotNetClass \n\nWith clsAttempt1\n\n    .FirstProperty = rngObject\n\nEnd With\n\nEnd sub\n\n</code></pre>\n\n<p>The COM connection works fine otherwise.</p>\n\n<p>Would appreciate any ideas,</p>\n\n<p>Hein</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1570040255, "post_id": 58207067, "comment_id": 102792299, "body": "Why are you using bracketed identifiers? What is <code>Task</code>?"}, {"owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 0, "creation_date": 1570040520, "post_id": 58207067, "comment_id": 102792417, "body": "Did you use both space and linebreak after underscore?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 2, "creation_date": 1570040603, "post_id": 58207067, "comment_id": 102792448, "body": "@Phanti the line continuation token is defined as whitespace+underscore+linebreak. The problem is caused by the bracketed identifiers, not the line continuation."}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 5, "last_activity_date": 1570041832, "last_edit_date": 1570041832, "creation_date": 1570041360, "answer_id": 58207437, "question_id": 58207067, "link": "https://stackoverflow.com/questions/58207067/why-does-excel-vba-editor-change-line-continuation-word-wrapping/58207437#58207437", "title": "Why does Excel VBA editor change line continuation word wrapping?", "body": "<p>Stop using bracketed identifiers. This trick is good for throw-away code and quick debugger stuff in the immediate pane, not for actual production code.</p>\n\n<p>When you do <code>[Task]</code>, you're stepping out of VBA land and defer to the host application - Excel - which will do <code>Application.Evaluate(\"Task\")</code> and, presumably, get a <code>Range</code> object back.</p>\n\n<p>From the looks of your code, it sounds like <code>Task</code> is the name of some table. Why not be explicit about where that table is coming from, instead of making Excel work it out?</p>\n\n<pre><code>Dim taskTable As ListObject\nSet taskTable = Sheet1.ListObjects(\"Task\")\n</code></pre>\n\n<p>Not sure what you're trying to do exactly, but you could then leverage the powerful <code>ListObject</code> API instead of working with late-bound implicit code half resolved by Excel and half resolved by VBA.</p>\n\n<pre><code>Dim scheduleTimestampColumn As Long\nscheduleTimestampColumn = taskTable.ListColumns(\"SchedDateTime\").Index\n\nDim daysAllocColumn As Long\ndaysAllocColumn = taskTable.ListColumns(\"DaysAlloc\").Index\n\nDim currentRow As ListRow\nFor Each currentRow In taskTable.ListRows\n    If IsEmpty(currentRow.Range.Cells(ColumnIndex:=scheduleTimestampColumn).Value) And _\n       IsEmpty(currentRow.Range.Cells(ColumnIndex:=daysAllocColumn).Value) _\n    Then\n       '...do stuff...\n    End If\nNext\n</code></pre>\n\n<p>VBA supports bracketed expressions as a shorthand surrogate for <code>Application.Evaluate</code> (or <code>Worksheet.Evaluate</code>, depending on context... so, it's actually even more implicit than I wrote near the top of this answer). It also supports bracketed identifiers, in certain contexts, for names that can have whitespace in them, or otherwise make illegal VBA identifiers.</p>\n\n<p>But <code>[TableName[ColumnName]]</code> is completely Excel-land (table formula notation) - VBA has no idea what that means, and the square brackets <em>inside</em> the bracketed expression are thoroughly confusing it. Without the nested brackets, the VBE doesn't get confused and doesn't wreck your indent. But without bracketed expressions, you get a not-confused VBE <em>and</em> explicit code that says what it does, and does what it says - <em>plus</em> compile-time validation for everything!</p>\n"}], "owner": {"reputation": 21, "user_id": 7613945, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiBRcBdsW-g/AAAAAAAAAAI/AAAAAAAAABc/uNM2yxODhLY/photo.jpg?sz=128", "display_name": "Lars Bergeson", "link": "https://stackoverflow.com/users/7613945/lars-bergeson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1570087521, "creation_date": 1570039899, "last_edit_date": 1570087521, "question_id": 58207067, "link": "https://stackoverflow.com/questions/58207067/why-does-excel-vba-editor-change-line-continuation-word-wrapping", "title": "Why does Excel VBA editor change line continuation word wrapping?", "body": "<p>I have a line of code in Excel VBA that is long, and I want to use a line continuation to break it into two lines. However, after I move the cursor away from that line of code, the editor changes my preferred word wrapping. How do I make it stop doing that?</p>\n\n<pre><code>If IsEmpty([Task].Cells(rowNo, [Task[SchedDateTime]].Column)) And _\n   IsEmpty([Task].Cells(rowNo, [Task[DaysAlloc]].Column)) Then\n</code></pre>\n\n<p>gets changed by the editor to:</p>\n\n<pre><code>If IsEmpty([Task].Cells(rowNo, [Task[SchedDateTime]].Column)) And IsEmpty( _\n   [Task].Cells(rowNo, [Task[DaysAlloc]].Column)) Then\n</code></pre>\n\n<p>which I think is harder to read.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 1, "creation_date": 1570038868, "post_id": 58206747, "comment_id": 102791677, "body": "I think <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this</a> might be of use."}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1570038919, "post_id": 58206747, "comment_id": 102791700, "body": "It think <code>.Copy</code> and <code>.Paste</code> have to be consecutive lines in your code... so the way you have it above, cancelling the filter also cancels the effects of <code>.Copy</code>, therefore nothing to <code>.Paste</code>"}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1570039116, "post_id": 58206747, "comment_id": 102791795, "body": "yepp, as @MilesFett suggested the proper way to get it done is going to involve replacing <code>Selection, Active...</code>"}, {"owner": {"reputation": 5, "user_id": 11063198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462d1a77577d6eaca0b995bf3ff4da70?s=128&d=identicon&r=PG&f=1", "display_name": "YKC", "link": "https://stackoverflow.com/users/11063198/ykc"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1570041475, "post_id": 58206747, "comment_id": 102792859, "body": "Thanks for the tip @MilesFett , I&#39;ve read the article but I&#39;m trying to think of a way to replace the Selection to select only filtered cells with value = &quot;Add&quot; but I Can&#39;t set a range because it won&#39;t Always be the same, there might be more or less data"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1570042199, "post_id": 58206747, "comment_id": 102793188, "body": "After the filter action, you would select column DD, to the lastrow, and use something like this... <code>Range(&quot;DD16:DD&quot; &amp; lastrow).SpecialCells(xlCellTypeVisible).Copy</code>"}, {"owner": {"reputation": 81, "user_id": 12083178, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-j5Mb1gffpwQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdBEo9gz0R6Dl8LamhQ96TBq_4o5A/photo.jpg?sz=128", "display_name": "Walter Kloosterboer", "link": "https://stackoverflow.com/users/12083178/walter-kloosterboer"}, "edited": false, "score": 0, "creation_date": 1570091486, "post_id": 58206747, "comment_id": 102806682, "body": "@YKC you could also try to find the values in a range using the Range.Find(&quot;add&quot;) function. Then using an offset when the value is found to get to the right cells."}], "owner": {"reputation": 5, "user_id": 11063198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462d1a77577d6eaca0b995bf3ff4da70?s=128&d=identicon&r=PG&f=1", "display_name": "YKC", "link": "https://stackoverflow.com/users/11063198/ykc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570038548, "creation_date": 1570038548, "question_id": 58206747, "link": "https://stackoverflow.com/questions/58206747/copy-and-paste-through-specific-criteria-on-filter", "title": "Copy and paste through specific criteria on filter", "body": "<p>I'm new to VBA and I'm facing some problems with the code below:</p>\n\n<p>It just need to find all the cells with \"Add\" on column DE and paste the names which is on the left column DD to the last blank cell on column A. The macro runs ok until the paste line. I don't know if there is another way around it.</p>\n\n<pre><code>ActiveSheet.Range(\"$DD$16:$DE$200\").AutoFilter Field:=109,         Criteria1:=\"Add\"\nRange(\"DD16\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\n\n'unfilter Macro\nActiveSheet.Range(\"$A$13:$DE$133\").AutoFilter Field:=109\n\n'Paste names marked as \"Add\"\nRange(\"A14\").Select\nActiveCell.End(xlDown).Offset(1, 0).Select\nActiveSheet.Paste\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 1, "creation_date": 1570038824, "post_id": 58206718, "comment_id": 102791658, "body": "What line are you receiving the error on?"}, {"owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570038920, "post_id": 58206718, "comment_id": 102791702, "body": "@Mike --&gt;  Line: For Each c In Sheet1.Range(&quot;A2&quot;).Resize(Sheet1.Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row - 1)"}, {"owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570039149, "post_id": 58206718, "comment_id": 102791813, "body": "@Mike even if you have to rewrite it, it would not bother me, i just need to get this thing to work at this point."}, {"owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "reply_to_user": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1570040046, "post_id": 58206718, "comment_id": 102792204, "body": "@AndrasDorko you sly fox ;) thank you, as you can tell it has been a long day ... long week and only wednesday! if anyone needs the edit with the declaration.. see my edit"}, {"owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "reply_to_user": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1570040142, "post_id": 58206718, "comment_id": 102792251, "body": "@AndrasDorko hmm, not sure, because I did make it option explicit. See my edit above on the fix"}, {"owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "reply_to_user": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 0, "creation_date": 1570040436, "post_id": 58206718, "comment_id": 102792373, "body": "@AndrasDorko      With Worksheets(&quot;Sheet1&quot;)  .. End With"}, {"owner": {"reputation": 369, "user_id": 5620644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b70050e5c09ce3171441cb1f0edc3bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Andras", "link": "https://stackoverflow.com/users/5620644/andras"}, "edited": false, "score": 1, "creation_date": 1570040655, "post_id": 58206718, "comment_id": 102792478, "body": "Alright then, I guess now we are on the same page, one way or antoher but it is fixed now."}], "owner": {"reputation": 63, "user_id": 11775540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98415be18ba92a3759f3570eddd9cf65?s=128&d=identicon&r=PG&f=1", "display_name": "AlmondButterJoy", "link": "https://stackoverflow.com/users/11775540/almondbutterjoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 218, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570042610, "creation_date": 1570038421, "last_edit_date": 1570042610, "question_id": 58206718, "link": "https://stackoverflow.com/questions/58206718/moving-list-of-specific-files-from-folder-to-folder-in-vba", "title": "Moving List of Specific Files From Folder-to-Folder in VBA", "body": "<p>I am having to move 30,000+ files manually and am trying to figure out how I can do this by VBA. I managed to obtain all of the file names by a VBA directory name pull, but am struggling with the transfer process.</p>\n\n<p>My Excel file is as follows:</p>\n\n<p>Column A - \"File Name\"<br>\nExample --> \"File Title\".pdf  (Could be a different file ext.)</p>\n\n<p>Column B - \"Source Folder Directory\"<br>\nExample --> C:\\Users\\\"user\"\\folder\\folder\\folder\\EFT\\Countries_COMPLETE\\Wave 3\\folder\\SOURCEFOLDER</p>\n\n<p>Column C - \"Destination Folder Directory\"<br>\nExample --> C:\\Users\\\"user\"\\folder\\folder\\folder\\EFT\\Countries_COMPLETE\\Wave 3\\folder\\folder\\DESTINATIONFOLDER</p>\n\n<p>I keep on getting getting a runtime 1004 even though all my objects are specificed.</p>\n\n<pre><code>Sub FileTranspose()\n\n    Dim c As Excel.Range\n    Dim strName As String\n    Dim strDir As String\n\n    With Worksheets(\"Sheet1\")\n\n        '// Loop from row 2 to last used cell in Col A\n        For Each c In **Sheet1**.Range(\"A2\").Resize(**Sheet1**.Range(\"A\" &amp; Rows.Count).End(xlUp).Row - 1)\n\n            '// If the cell contains any text...\n            If c.Value &lt;&gt; vbNullString Then\n\n                '// And the 2 cells to the right contain some text...\n                If c.Offset(0, 1).Value &lt;&gt; vbNullString And c.Offset(0, 2).Value &lt;&gt; vbNullString Then\n\n                    '// Make up the full source file name, includes path.\n                    strName = c.Offset(0, 1).Value &amp; IIf(Right$(c.Offset(0, 1).Value, 1) &lt;&gt; \"\\\", \"\\\", vbNullString) &amp; c.Value\n                    '// Same for destination Directory name\n                    strDir = c.Offset(0, 2).Value &amp; IIf(Right$(c.Offset(0, 2).Value, 1) &lt;&gt; \"\\\", \"\\\", vbNullString)\n\n                    '// If the file to copy exists...\n                    If Dir(strName) &lt;&gt; vbNullString Then\n\n                        '// And the Destination directory exists...\n                        If Dir(strDir, vbDirectory) &lt;&gt; vbNullString Then\n                            '// Copy it.\n                            FileCopy strName, strDir &amp; c.Value\n\n                            '// Delete\n                            Kill strName\n\n                        End If\n\n                    End If\n                End If\n            End If\n\n        Next\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The goal would be to automatically pull up column B, look for the file in column A, then insert into column C.</p>\n\n<p>I would like to REMOVE the file from the original folder once copied over.</p>\n"}, {"tags": ["javascript", "html", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 2155, "user_id": 1745913, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ocSXH.jpg?s=128&g=1", "display_name": "jtate", "link": "https://stackoverflow.com/users/1745913/jtate"}, "edited": false, "score": 1, "creation_date": 1570039045, "post_id": 58206691, "comment_id": 102791762, "body": "Please do not post code as a screenshot.  Take your code and post it in the question directly so that someone can potentially replicate your issue on their machine."}, {"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "reply_to_user": {"reputation": 2155, "user_id": 1745913, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ocSXH.jpg?s=128&g=1", "display_name": "jtate", "link": "https://stackoverflow.com/users/1745913/jtate"}, "edited": false, "score": 0, "creation_date": 1570040537, "post_id": 58206691, "comment_id": 102792424, "body": "Noted, codes added."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570099393, "post_id": 58207760, "comment_id": 102810918, "body": "Thanks Qharr, I&#39;ve tried the code below, however It doesn&#39;t work..  <code>If waitElement(&quot;iframe&quot;, &quot;title&quot;, &quot;data visualization&quot;, 30) = True Then   For Each ele In ie.document.getElementsByTagName(&quot;iframe&quot;) If ele.getAttribute(&quot;title&quot;) = &quot;data visualization&quot; Then  ele.contentDocument.querySelector(&quot;[class=&#39;tabToolbarButton tab-widget download&#39;]&quot;).Click  Exit For End If Next ele Else MsgBox &quot;fail&quot; End If</code>"}, {"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570099767, "post_id": 58207760, "comment_id": 102811108, "body": "I can&#39;t use querySelector(&quot;.tabToolbarButtonText&quot;) as there&#39;s a lot of that kind that only differs on innertext."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570101309, "post_id": 58207760, "comment_id": 102811927, "body": "You mean that lots of items with the same class that only differ by innerText? No other attributes to differentiate or relationship to another element that uniquely identifies?"}, {"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570101804, "post_id": 58207760, "comment_id": 102812156, "body": "Yes, just like this one which is another buttom within the iframe.. <code>&lt;div tabindex=&quot;-1&quot; class=&quot;tabToolbarButton tab-widget share&quot; role=&quot;button&quot; style=&quot;width: 75px; -ms-touch-action: none;&quot; aria-label=&quot;Share&quot;&gt;&lt;span class=&quot;tabToolbarButtonImg tab-icon-share&quot;&gt;&lt;&#47;span&gt;&lt;span class=&quot;tabToolbarButtonText&quot;&gt;Share&lt;&#47;span&gt;&lt;&#47;div&gt;</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570123562, "post_id": 58207760, "comment_id": 102823381, "body": "Did you try ie.document.querySelector(&quot;[title=&#39;data visualization&#39;]&quot;).contentDocument.querySelector(&quot;.download&quot;)&zwnj;&#8203;.click by itself? No loop"}, {"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570201241, "post_id": 58207760, "comment_id": 102850388, "body": "I got an error : Run-Time error &#39;424&#39; Object Required"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570201291, "post_id": 58207760, "comment_id": 102850409, "body": "Even when stepping through slowly with F8?"}, {"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570348762, "post_id": 58207760, "comment_id": 102879960, "body": "Yes, tried to step thru the code but still the same, button not clicked.. I checked the element before the iframe, there&#39;s a <code>style=&quot;visibility: hidden</code>. do you think this might be the reason why I can&#39;t locate the element? btw, the site i&#39;m automating is a Tableau Dashboard."}, {"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570348806, "post_id": 58207760, "comment_id": 102879971, "body": "<code>&lt;div class=&quot;tb-viz ng-isolate-scope&quot; style=&quot;visibility: hidden; max-width: 1536px;&quot; tb-test-id=&quot;viz&quot; tb-window-max-width=&quot;tb-window-max-width&quot; tb-visible=&quot;vizInitialized&quot; on-viz-sized=&quot;onVizSized()&quot; viz=&quot;viz&quot;&gt;  &lt;iframe title=&quot;data visualization&quot; src=&quot;https:&#47;&#47;samplesite.com&quot; frameborder=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; scrolling=&quot;no&quot; allowfullscreen=&quot;true&quot; style=&quot;width: 100%; height: 100%; display: block; visibility: visible;&quot; allowtransparency=&quot;true&quot;&gt;&lt;&#47;iframe&gt;&lt;&#47;div&gt; </code>"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1570077336, "last_edit_date": 1570077336, "creation_date": 1570042648, "answer_id": 58207760, "question_id": 58206691, "link": "https://stackoverflow.com/questions/58206691/how-to-interact-with-ie-iframe-without-iframe-id/58207760#58207760", "title": "How to interact with IE iframe without iframe id", "body": "<p>Use one of it's attributes. For example,</p>\n\n<pre><code>ie.document.querySelector(\"[title='data visualization']\").contentDocument.querySelector(\".tabToolbarButtonText\").click 'change this end bit for the appropriate element to click\n</code></pre>\n\n<p>Perhaps</p>\n\n<pre><code>ie.document.querySelector(\"[title='data visualization']\").contentDocument.querySelector(\".download\").click 'change this end bit for the appropriate element to click\n</code></pre>\n\n<p>Or it's <code>src</code> attribute value direct:</p>\n\n<pre><code>ie.Navigate \"https://sample.com\"\n</code></pre>\n\n<p>Modern browsers are optimised for <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">css selectors</a> so this method is fast. Using <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector\" rel=\"nofollow noreferrer\">querySelector</a> also stops at first match which is again an efficiency gain here.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570099814, "post_id": 58211490, "comment_id": 102811130, "body": "Thanks! is there an easy way to get the index of an element? It&#39;s hard to navigate the HTML Document."}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "reply_to_user": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "edited": false, "score": 0, "creation_date": 1570176151, "post_id": 58211490, "comment_id": 102838281, "body": "If the Iframe count is fixed, you could use F12 developer tools DOM Explorer to find the Iframe and get the index. The screenshot like <a href=\"https://i.stack.imgur.com/NbQNU.png\" rel=\"nofollow noreferrer\">this</a>. Otherwise, you could try to add a different class name or id attribute for the iframes."}], "tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 0, "last_activity_date": 1570069012, "creation_date": 1570069012, "answer_id": 58211490, "question_id": 58206691, "link": "https://stackoverflow.com/questions/58206691/how-to-interact-with-ie-iframe-without-iframe-id/58211490#58211490", "title": "How to interact with IE iframe without iframe id", "body": "<p>You could also try to use the getElementsbyTagName method to get the Iframe first, then, according to the Iframe.contentDocument property to get the elements via the class Name.</p>\n\n<p>Sample code as below:</p>\n\n<pre><code>Sub Test()\n    Dim ie As Object\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    With ie\n        .Visible = True\n        .Navigate \"&lt;the website url&gt;\"\n\n        While ie.readyState &lt;&gt; 4\n            DoEvents\n        Wend\n\n        ie.Document.getElementsbyTagName(\"iframe\")(0).contentDocument.getElementsbyClassName(\"tabToolbarButton tab-widget download\")(0).Click\n    End With\n    Set ie = Nothing\nEnd Sub\n</code></pre>\n\n<p>[Note] Please note the element's index when you are using the getElementsbyTagName and getElementsbyClassName. It is starting from 0.</p>\n"}], "owner": {"reputation": 3, "user_id": 12155207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f185b8a17c053a801590aa5129ff5f8e?s=128&d=identicon&r=PG&f=1", "display_name": "WalterWhite", "link": "https://stackoverflow.com/users/12155207/walterwhite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570517726, "creation_date": 1570038316, "last_edit_date": 1570517726, "question_id": 58206691, "link": "https://stackoverflow.com/questions/58206691/how-to-interact-with-ie-iframe-without-iframe-id", "title": "How to interact with IE iframe without iframe id", "body": "<p>I need to click a div inside an iframe in order to trigger a download. I'm having a hard time trying to locate the iframe element as it doesn't have an ID.  Here is the iframe element:</p>\n\n<pre><code>&lt;iframe title=\"data visualization\" src=\"https://sample.com\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" allowfullscreen=\"true\" style=\"width: 100%; height: 100%; display: block; visibility: visible;\" allowtransparency=\"true\"&gt;&lt;/iframe&gt;\n</code></pre>\n\n<p>And this is the div element inside the iframe:</p>\n\n<pre><code>&lt;div tabindex=\"-1\" class=\"tabToolbarButton tab-widget download\" role=\"button\" style=\"width: 95px; -ms-touch-action: none;\" aria-label=\"Download\"&gt;\n    &lt;span class=\"tabToolbarButtonImg tab-icon-download\"&gt;&lt;/span&gt;\n    &lt;span class=\"tabToolbarButtonText\"&gt;Download&lt;/span&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1570042794, "post_id": 58206614, "comment_id": 102793488, "body": "What have you tried?, what columns contain the user names in both worksheets?"}, {"owner": {"reputation": 13, "user_id": 8915976, "user_type": "registered", "profile_image": "https://graph.facebook.com/710951890/picture?type=large", "display_name": "Tyler Ryan Gehring", "link": "https://stackoverflow.com/users/8915976/tyler-ryan-gehring"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1570108845, "post_id": 58206614, "comment_id": 102815903, "body": "So at this point I spent a while googling to understand all the excel specific macros, and I have a simple script that excludes the header and counts the number of rows in separate sheets and displays the results in a msgbox.  Its a bit more complicated than just usernames.  Because I deal with PHI, I need to also take fill # into account to see if its the same person, different fill, or if its a new user entirely.  Im looking into appending the data into a worksheet and doing a matching thing, as well as figuring out if my way is viable. Just trying to figure out the best way to get this done"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 10216038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8fcc4f138a985ec96cbe96abe95f06e?s=128&d=identicon&r=PG&f=1", "display_name": "user10216038", "link": "https://stackoverflow.com/users/10216038/user10216038"}, "is_accepted": false, "score": 0, "last_activity_date": 1570039564, "creation_date": 1570039564, "answer_id": 58207001, "question_id": 58206614, "link": "https://stackoverflow.com/questions/58206614/compare-users-in-different-sheets-and-add-user-to-sheet-a-if-not-present-in-a-bu/58207001#58207001", "title": "Compare users in different sheets and add user to sheet A if not present in A but present in B", "body": "<p>You can write a VBA script to do this, and probably should if this is a regular process.</p>\n\n<p>Alternatively a sorting approach will handle this and many similar problems. It works like this, given two sheets <strong>A</strong> &amp; <strong>B</strong> with mixed duplicate and unique entries:</p>\n\n<ol>\n<li>Append <strong>B</strong> to <strong>A</strong></li>\n<li>Sort by desired category (<em>User</em> in this case)</li>\n</ol>\n\n<p>This will have duplicates (<em>User</em>) next to each other</p>\n\n<ol start=\"3\">\n<li>Insert a match check column consisting of <em>If User EQ PreviousUser, True, False;</em></li>\n<li>Cut and paste <strong>Values</strong> to change from a function to simple content of True/False</li>\n<li>Sort by <em>True/False</em> column</li>\n<li>Delete the entire block of True's</li>\n</ol>\n\n<p>Done!</p>\n\n<p>This approach also works for more than two sheets. Append them all together, sort, mark dups, delete.</p>\n"}], "owner": {"reputation": 13, "user_id": 8915976, "user_type": "registered", "profile_image": "https://graph.facebook.com/710951890/picture?type=large", "display_name": "Tyler Ryan Gehring", "link": "https://stackoverflow.com/users/8915976/tyler-ryan-gehring"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1570198909, "creation_date": 1570038046, "last_edit_date": 1570198909, "question_id": 58206614, "link": "https://stackoverflow.com/questions/58206614/compare-users-in-different-sheets-and-add-user-to-sheet-a-if-not-present-in-a-bu", "title": "Compare users in different sheets and add user to sheet A if not present in A but present in B", "body": "<p>We use an Excel file as a support tracker.  Our main sheet (A) has a list of users and their data.  For daily support, we run the MYSQL stored procedure to get the data, then paste it into a blank sheet (B) that colors and filters the data.</p>\n\n<p>I am supposed to search the users in sheets A and B, and if a user is present in B but not A (scenario representing adding a user to our system) add the missing user to sheet A.</p>\n\n<p>Based on my past programming knowledge, the steps should be:</p>\n\n<ul>\n<li><p>count rows in sheets A and B<br>\nA has more data further down the sheet that is not raw user data, but it is in the same columns so looking for the first blank cell in A</p></li>\n<li><p>do a compare on those results</p></li>\n<li><p>if the results are different, do a vlookup to find the missing entry</p></li>\n<li><p>insert that entire row from sheet B to sheet A</p></li>\n</ul>\n\n<p>I assume this can be done with VBA code.</p>\n"}, {"tags": ["excel", "vba", "outlook", "format"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570037875, "post_id": 58206548, "comment_id": 102791258, "body": "<code>.HTMLBody</code> instead of <code>.Body</code>. For more, see the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.htmlbody\" rel=\"nofollow noreferrer\">docs</a>."}, {"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570038019, "post_id": 58206548, "comment_id": 102791322, "body": "This is perfect! So simple to miss. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "edited": false, "score": 0, "creation_date": 1570116702, "post_id": 58206673, "comment_id": 102820334, "body": "Works great! Thanks!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1570038237, "creation_date": 1570038237, "answer_id": 58206673, "question_id": 58206548, "link": "https://stackoverflow.com/questions/58206548/send-outlook-email-with-some-bold-text/58206673#58206673", "title": "Send Outlook Email with some Bold Text", "body": "<p>Use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.htmlbody\" rel=\"nofollow noreferrer\"><code>MailItem.HTMLBody</code></a> instead of <code>MailItem.Body</code>.</p>\n\n<blockquote>\n  <p>Returns or sets a String representing the <strong>HTML</strong> body of the specified item. Read/write.</p>\n</blockquote>\n\n<pre><code>With OutMail\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Email Subject\"\n    .HTMLBody = MailBody\n    .Display   'or use .Send\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 10000694, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-53fLHRuCyNg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3iMIpZz1wEFc0mt2kVJ43FMdrPlQ/mo/photo.jpg?sz=128", "display_name": "lexi", "link": "https://stackoverflow.com/users/10000694/lexi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "accepted_answer_id": 58206673, "answer_count": 1, "score": 0, "last_activity_date": 1570464389, "creation_date": 1570037814, "last_edit_date": 1570464389, "question_id": 58206548, "link": "https://stackoverflow.com/questions/58206548/send-outlook-email-with-some-bold-text", "title": "Send Outlook Email with some Bold Text", "body": "<p>I have code that opens up an Outlook email with the content of the mail body, but none of the format is working.</p>\n\n<p>In the email, it just shows up as a string Like:</p>\n\n<p><code>&lt;strong&gt;Bold this part&lt;/strong&gt;Unbold this text \n&lt;b&gt;This text bold&lt;/b&gt;Test</code></p>\n\n<p>I have been searching answers here, but none of them work.</p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>Sub Send_email()\nDim OutApp As Object\nDim OutMail As Object\nDim MailBody As String\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nMailBody = \"First line of email\" &amp; vbNewLine &amp; vbNewLine &amp; _\n          \"&lt;strong&gt;Bold this part&lt;/strong&gt;\" &amp; \"Unbold this text\" &amp; vbNewLine &amp; _\n           \"&lt;b&gt;This text bold&lt;/b&gt;\" &amp; \"Test\"\n\nOn Error Resume Next\nWith OutMail\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Email Subject\"\n    .Body = MailBody\n    .Display   'or use .Send\nEnd With\nOn Error GoTo 0\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1570629749, "post_id": 58206415, "comment_id": 102973848, "body": "I don&#39;t think you can hack the <code>HTMLBody</code> this way, at the very least, I don&#39;t think it can be done quite so simply (but if it works based on other answers, below, keep using it). I would recommend creating an .oft Outlook Template and manipulating the email body from its <code>WordEditor</code>. <a href=\"https://stackoverflow.com/questions/56670498/how-to-insert-a-table-after-body-of-e-mail-and-before-signature/56673269#56673269\">Here</a> is an example of placing a table inside an email body, which you could easily change to insert image instead of table."}, {"owner": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1571142316, "post_id": 58206415, "comment_id": 103134884, "body": "I&#39;m too new to vba and got excited when it worked, specially when you gave me the hint! Thank you so much for sharing this example, I love the learning experience that all members share here!"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "edited": false, "score": 0, "creation_date": 1570040407, "post_id": 58206649, "comment_id": 102792356, "body": "Thank you @BigBen, there&#39;s no error msg, however, I couldn&#39;t get the image, I got &quot;x&quot; object instead of the picture I&#39;m trying to embed, can you check why?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "edited": false, "score": 0, "creation_date": 1570040810, "post_id": 58206649, "comment_id": 102792567, "body": "I&#39;m not strong in HTML but my guess is that <code>&quot;ImageFile.img&quot;</code> should be <code>&quot;Angela.jpg&quot;</code> (unfortunately cannot check atm)."}, {"owner": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "edited": false, "score": 0, "creation_date": 1570042657, "post_id": 58206649, "comment_id": 102793421, "body": "Yes, you&#39;re right I changed the image file to the name of image and it worked perfectly great. However, what if I have multiple images, how can I embed them?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "edited": false, "score": 0, "creation_date": 1570043761, "post_id": 58206649, "comment_id": 102793886, "body": "I&#39;m not sure. You may get more help by asking that as a new question."}, {"owner": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "edited": false, "score": 0, "creation_date": 1570112865, "post_id": 58206649, "comment_id": 102818262, "body": "Thank you for your help @BigBen! I found the right code for multiple images, I just need to declare the path of each image:  Set oAttach1 = colAttach.Add(&quot;C:\\Users\\AA.jpg&quot;) and Set olkPA1 = oAttach1.PropertyAccessor then olkPA1.SetProperty PR_ATTACH_CONTENT_ID, &quot;AA.jpg&quot; and I was able to embed all images. Let me know if you need the full macro, I would be happy to help. By the way it&#39;s my first macro and I&#39;m so happy"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "edited": false, "score": 0, "creation_date": 1570112901, "post_id": 58206649, "comment_id": 102818286, "body": "It&#39;s hard to read that code in a comment so you could add it as an answer to your own question :)"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1570038147, "creation_date": 1570038147, "answer_id": 58206649, "question_id": 58206415, "link": "https://stackoverflow.com/questions/58206415/excel-vba-send-email-with-embed-image/58206649#58206649", "title": "excel vba send email with embed image", "body": "<p>If you're using late-binding, then you can't use members of the Outlook <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.olbodyformat\" rel=\"nofollow noreferrer\"><code>OlBodyFormat</code></a> enum.</p>\n\n<p><code>olFormatHTML</code> corresponds to <code>2</code>.</p>\n\n<pre><code>Sub Outlook_Email_With_Inline_Image()\n    Const olFormatHTML As Long = 2\n    ...\n    .BodyFormat = olFormatHTML\n    ...\nEnd Sub\n</code></pre>\n\n<p>Also - add <code>Option Explicit</code> to the top of your module and declare <em>all</em> variables.</p>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "is_accepted": false, "score": 1, "last_activity_date": 1570629480, "creation_date": 1570629480, "answer_id": 58305863, "question_id": 58206415, "link": "https://stackoverflow.com/questions/58206415/excel-vba-send-email-with-embed-image/58305863#58305863", "title": "excel vba send email with embed image", "body": "<pre><code>Sub email()\n\nDim aOutlook As Object\nDim aEmail As Object\nDim obj As Object\nDim olInsp As Object\nDim myDoc As Object\nDim oRng As Object\n\nConst PR_ATTACH_CONTENT_ID = \"http://schemas.microsoft.com/mapi/proptag/0x3712001F\"\nSet oApp = CreateObject(\"Outlook.Application\")\nSet oEmail = oApp.CreateItem(olMailItem)\nDim ToCc As Range, strBody, strSig As String\nDim fColorBlue, fColorGreen, fColorRed, fDukeBlue1, fDukeBlue2, fAggieMaroon, fAggieGray As String\nDim Greeting, emailContent As String\nDim emailOpen, emailSig As String\n\n\n\nFor Each ToCc In ActiveSheet.[A2:A2]\n\n\n'=============================================================\n\nDim ToEmail, CcEmail, ToNm, CcNm As String\nDim DescrDt, DescrID, DescrNm As String\n\n    ToNm = Cells(ToCc.Row, [C1].Column).Value\n    CcNm = Cells(ToCc.Row, [G1].Column).Value\n    ToEmail = Cells(ToCc.Row, [E1].Column).Value\n    CcEmail = Cells(ToCc.Row, [I1].Column).Value\n\n    DescrID = Cells(ToCc.Row, [B1].Column).Value\n    DescrNm = Cells(ToCc.Row, [D1].Column).Value\n    DescrDt = \"20190426\"\n\n\n\n'=============================================================\n'''determine strBody --email message\n\nDim strFontSize, strFontName, strFontColor As String\n    strFontName = \"Arial\"\n    strFontColor = fAggieGray\n    strFontSize = 13\n\n\nGreeting = \"&lt;BODY style=\" &amp; Chr(34) &amp; \"font-family:\" &amp; strFontName &amp; \"; font-size:\" &amp; strFontSize &amp; Chr(34) &amp; \"&gt;\" &amp; _\n            \"&lt;span style=\"\"color:\" &amp; strFontColor &amp; \"\"\"&gt;\" &amp; _\n    Application.WorksheetFunction.Proper(ToNm) &amp; \",\" &amp; \"&lt;br&gt; &lt;br&gt;\" &amp; _\n            \"&lt;/span style=\"\"color:\" &amp; strFontColor &amp; \"\"\"&gt;\" &amp; \"&lt;/BODY&gt;\"\n\n\n\nemailSig = \"&lt;BODY style=\" &amp; Chr(34) &amp; \"font-family:\" &amp; strFontName &amp; \"; font-size:\" &amp; strFontSize &amp; Chr(34) &amp; \"&gt;\" &amp; _\n            \"&lt;span style=\"\"color:\" &amp; strFontColor &amp; \"\"\"&gt;\" &amp; _\n    \"&lt;br&gt; &lt;br&gt;\" &amp; \"- OE &amp; HRIS Team\" &amp; \"&lt;br&gt;\" &amp; \"______________________\" &amp; \"&lt;br&gt; &lt;br&gt;\" &amp; _\n            \"&lt;/span style=\"\"color:\" &amp; strFontColor &amp; \"\"\"&gt;\" &amp; \"&lt;/BODY&gt;\" &amp; _\n            \"&lt;BODY style=\" &amp; Chr(34) &amp; \"font-family:\" &amp; strFontName &amp; \"; font-size: 10px;\"\"&gt;\" &amp; _\n            \"&lt;span style=\"\"color:\" &amp; strFontColor &amp; \"\"\"&gt;\" &amp; _\n    \"[Email generated through Excel Macros and Google meme download - source data: October 3, 2019]\" &amp; _\n            \"&lt;/span style=\"\"color:\" &amp; strFontColor &amp; \"\"\"&gt;\" &amp; \"&lt;/BODY&gt;\"\n\n\n\nSet colAttach = oEmail.Attachments\nSet oAttach1 = colAttach.Add(\"C:\\Users\\AA.jpg\")\nSet oAttach2 = colAttach.Add(\"C:\\Users\\BB.png\")\nSet oAttach3 = colAttach.Add(\"C:\\Users\\CC.jpg\")\nSet oAttach4 = colAttach.Add(\"C:\\Users\\DD.gif\")\nSet oAttach5 = colAttach.Add(\"C:\\Users\\EE.png\")\nSet oAttach6 = colAttach.Add(\"C:\\Users\\FF.jpg\")\nSet oAttach7 = colAttach.Add(\"C:\\Users\\GG.jpg\")\n\nSet olkPA1 = oAttach1.PropertyAccessor\nSet olkPA2 = oAttach2.PropertyAccessor\nSet olkPA3 = oAttach3.PropertyAccessor\nSet olkPA4 = oAttach4.PropertyAccessor\nSet olkPA5 = oAttach5.PropertyAccessor\nSet olkPA6 = oAttach6.PropertyAccessor\nSet olkPA7 = oAttach7.PropertyAccessor\n\n\n\nolkPA1.SetProperty PR_ATTACH_CONTENT_ID, \"AA.jpg\"\nolkPA2.SetProperty PR_ATTACH_CONTENT_ID, \"BB.png\"\nolkPA3.SetProperty PR_ATTACH_CONTENT_ID, \"CC.jpg\"\nolkPA4.SetProperty PR_ATTACH_CONTENT_ID, \"DD.gif\"\nolkPA5.SetProperty PR_ATTACH_CONTENT_ID, \"EE.png\"\nolkPA6.SetProperty PR_ATTACH_CONTENT_ID, \"FF.jpg\"\nolkPA7.SetProperty PR_ATTACH_CONTENT_ID, \"GG.jpg\"\n\n\noEmail.Close olSave\n\n\n\noEmail.HTMLBody = Greeting &amp; \"&lt;BODY style=\" &amp; Chr(34) &amp; \"font-family:\" &amp; strFontName &amp; \"; font-size:\" &amp; strFontSize &amp; Chr(34) &amp; \"&gt;\" &amp; _\n            \"&lt;span style=\"\"color:\" &amp; strFontColor &amp; \"\"\"&gt;\" &amp; _\n    \"&lt;br&gt; &lt;br&gt;\" &amp; _\n                    \"&lt;img src=\"\"cid:FF.jpg\"\"height=520 width=750&gt;\" &amp; _\n                    \"&lt;br&gt; &lt;br&gt;\" &amp; \"&lt;img src=\"\"cid:AA.jpg\"\"height=520 width=750&gt;\" &amp; _\n                    \"&lt;br&gt; &lt;br&gt;\" &amp; \"&lt;img src=\"\"cid:BB.png\"\"height=520 width=750&gt;\" &amp; _\n                    \"&lt;br&gt; &lt;br&gt;\" &amp; \"&lt;img src=\"\"cid:DD.gif\"\"height=520 width=750&gt;\" &amp; _\n                    \"&lt;br&gt; &lt;br&gt;\" &amp; \"&lt;img src=\"\"cid:GG.jpg\"\"height=520 width=750&gt;\" &amp; _\n                    \"&lt;br&gt; &lt;br&gt;\" &amp; \"&lt;img src=\"\"cid:EE.png\"\"height=520 width=750&gt;\" &amp; _\n                    \"&lt;/body&gt;\"\n\noEmail.Save\noEmail.To = \"MM@email.com\"\noEmail.CC = \"AA@email.com\"\n\noEmail.Subject = \"Congrats \" &amp; Application.WorksheetFunction.Proper(ToNm) &amp; Chr(32) &amp; Application.WorksheetFunction.Proper(DescrNm)\noEmail.display\n'oEmail.send\n\n\n\nNEXT_ToCC:\n    Set aEmail = Nothing\n    Set olInsp = Nothing\n    Set myDoc = Nothing\n    Set oRng = Nothing\nNext ToCc\n\n'oEmail.Send\n\nSet oEmail = Nothing\nSet colAttach = Nothing\nSet oAttach = Nothing\nSet oApp = Nothing\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11804244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c7e085796dd3a3fa5190eab05517d2?s=128&d=identicon&r=PG&f=1", "display_name": "Xina", "link": "https://stackoverflow.com/users/11804244/xina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1570629480, "creation_date": 1570037171, "last_edit_date": 1570037941, "question_id": 58206415, "link": "https://stackoverflow.com/questions/58206415/excel-vba-send-email-with-embed-image", "title": "excel vba send email with embed image", "body": "<p>I used below macro to create email with embedded picture but it didn't work, as I kept on receiving </p>\n\n<blockquote>\n  <p>run time error 5 \"Invalid procedure call or argument\" </p>\n</blockquote>\n\n<p>and highlighted this code <code>.BodyFormat = olFormatHTML</code>.</p>\n\n<pre><code>Sub Outlook_Email_With_Inline_Image()\n    'Add reference to Microsoft Outlook Object Library\n    Set aOutlook = CreateObject(\"Outlook.Application\")\n    Set aEmail = aOutlook.CreateItem(0)\n    'Dim OutApp As Outlook.Application\n    'Dim oOutlookEmail As Outlook.MailItem\n\n    'Create New Outlook Email Item to Attach Image(s)\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set oOutlookEmail = OutApp.CreateItem(0)\n\n    'Actual Excel VBA to send email with Embedded images\n    With oOutlookEmail\n        .To = \"user@gmail.com\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Congrats\"\n        .BodyFormat = olFormatHTML\n        .Attachments.Add \"C:\\Users\\Username\\Pictures\\Michael's Email Promotion\\Angela.jpg\", olByValue, 0\n        sImgName = \"ImageFile.img\"\n        .HTMLBody = \"&lt;img src='cid:\" &amp; sImgName &amp; \"'\" &amp; \" &gt;&lt;br&gt;\" 'Mention only the image file name not its path\n        'Or Use this below line.\n        '.HTMLBody = \"&lt;img src='\" &amp; sImgName &amp; \"'\" &amp; \" &gt;&lt;br&gt;\"\n        .Display\n    '    .Send 'or just put .Display to check\n    End With\n\n    Set OutlookMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570034385, "post_id": 58205726, "comment_id": 102789662, "body": "If macros are not enabled/trusted, they won&#39;t run."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 10155359, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KXF3RzGeUpw/AAAAAAAAAAI/AAAAAAAADtI/fpK2HYQ9EQU/photo.jpg?sz=128", "display_name": "Dali Hendaoui", "link": "https://stackoverflow.com/users/10155359/dali-hendaoui"}, "edited": false, "score": 0, "creation_date": 1570116663, "post_id": 58208582, "comment_id": 102820318, "body": "Thank you dear, However, can you please explain to me what do you mean by saying &quot;keep the sheet locked until they enable content which will then unlock the sheet as a proxy to twist their arm into enabling content. &quot; I just need the macro to run without the user enabling it (the form that I&#39;m trying to send to customers needs the macro to run)  Thanks again"}, {"owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "reply_to_user": {"reputation": 7, "user_id": 10155359, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KXF3RzGeUpw/AAAAAAAAAAI/AAAAAAAADtI/fpK2HYQ9EQU/photo.jpg?sz=128", "display_name": "Dali Hendaoui", "link": "https://stackoverflow.com/users/10155359/dali-hendaoui"}, "edited": false, "score": 0, "creation_date": 1570118570, "post_id": 58208582, "comment_id": 102821280, "body": "You can&#39;t make a macro that bypasses security measures. But if you write a code that locks all the spreadsheets on closing and unlocks it when it&#39;s opened, they won&#39;t be able to interact with the sheet until they enable macros. This is a hacky workaround that forces the user to enable macros if they want to use the sheet."}, {"owner": {"reputation": 7, "user_id": 10155359, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KXF3RzGeUpw/AAAAAAAAAAI/AAAAAAAADtI/fpK2HYQ9EQU/photo.jpg?sz=128", "display_name": "Dali Hendaoui", "link": "https://stackoverflow.com/users/10155359/dali-hendaoui"}, "edited": false, "score": 0, "creation_date": 1570121259, "post_id": 58208582, "comment_id": 102822442, "body": "Thank you very much Mark, you&#39;re a savior !"}], "tags": [], "owner": {"reputation": 1052, "user_id": 11820046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73032e9cdf06875fff17231806ccfee7?s=128&d=identicon&r=PG&f=1", "display_name": "Mark S.", "link": "https://stackoverflow.com/users/11820046/mark-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1570046450, "creation_date": 1570046450, "answer_id": 58208582, "question_id": 58205726, "link": "https://stackoverflow.com/questions/58205726/can-i-make-macro-excel-files-without-enabling-the-macro/58208582#58208582", "title": "Can I make macro Excel files without enabling the macro", "body": "<p>No, as a security feature of Excel it should prompt you to enable content to prevent harmful codes from being run in spreadsheets. What you're asking for is a bypass through security, which should not exist.</p>\n\n<p>This was a topic covered in the <a href=\"https://www.mrexcel.com/forum/excel-questions/968366-vba-macro-enable-content-document.html\" rel=\"nofollow noreferrer\">MREXCEL Forum</a></p>\n\n<p>You can however, keep the sheet locked until they enable content which will then unlock the sheet as a proxy to twist their arm into enabling content.</p>\n"}], "owner": {"reputation": 7, "user_id": 10155359, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KXF3RzGeUpw/AAAAAAAAAAI/AAAAAAAADtI/fpK2HYQ9EQU/photo.jpg?sz=128", "display_name": "Dali Hendaoui", "link": "https://stackoverflow.com/users/10155359/dali-hendaoui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58208582, "answer_count": 1, "score": 0, "last_activity_date": 1570086309, "creation_date": 1570034190, "last_edit_date": 1570086309, "question_id": 58205726, "link": "https://stackoverflow.com/questions/58205726/can-i-make-macro-excel-files-without-enabling-the-macro", "title": "Can I make macro Excel files without enabling the macro", "body": "<p>I have a macro Excel file (xlsm extension), that I want it to run on any PC without making the user enabling/trusting the macro in it.\nPS: this is only because the file contains multiple forms that needs to be filled with some restrictions, for example case sometimes need to be a number with a pre-defined length, or a string , etc.</p>\n\n<p>Thanks in advance,</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1570033568, "post_id": 58205535, "comment_id": 102789266, "body": "You need a 2D array."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1570033673, "post_id": 58205535, "comment_id": 102789321, "body": "@BigBen Nailed it. <code>Dim strFormulas(1 to 5, 1 to 2) ...</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1570033850, "post_id": 58205535, "comment_id": 102789416, "body": "Also the formulas must be viable formula: <code>&quot;=ROUNDUP(AVERAGE($B2:$Bxx),0)&quot;</code> will error since <code>xx</code> is not a valid row number."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1570033892, "post_id": 58205535, "comment_id": 102789432, "body": "Once you have the 2D array use <code>.Range(&quot;D2:E6&quot;).Formula = strFormulas</code> to place the whole array in the cells."}, {"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570034694, "post_id": 58205535, "comment_id": 102789790, "body": "@Scott Craner, I need somehow a universal approach because the end cell of the range may vary. I planned using Replace() like it&#39;s said here: <a href=\"https://stackoverflow.com/questions/58138084/filling-a-n-x-3-range-with-formulas-that-contain-iteratable-reference-to-a-list/58138611\" title=\"filling a n x 3 range with formulas that contain iteratable reference to a list\">stackoverflow.com/questions/58138084/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570034836, "post_id": 58205535, "comment_id": 102789863, "body": "@StacyRyutt the formula must work at each level of the replace.  You can not insert a garbage formula then replace to make work.  You need to have a functional formula then replace parts.  for ex: <code>&quot;=ROUNDUP(AVERAGE($B2:$B1040000),0)&quot;</code> then replace the <code>1040000</code> with the correct row number."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1570035003, "post_id": 58205535, "comment_id": 102789939, "body": "But you can also use a variable in the formula by setting the variable to the row desired then use: <code>&quot;=ROUNDUP(AVERAGE($B2:$B&quot; &amp; rw &amp; &quot;),0)&quot;</code>"}, {"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570035056, "post_id": 58205535, "comment_id": 102789962, "body": "@BigBen I get <code>Wrong number of dimensions</code> when initializing the array as <code>Dim strFormulas(1 To 5, 1 To 2) As Variant</code>. Any clues?"}, {"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570035154, "post_id": 58205535, "comment_id": 102790009, "body": "@ScottCraner Thank you. In fact, I have used a &#39;fake&#39; formula once, like in this example: <a href=\"https://stackoverflow.com/questions/58138084/filling-a-n-x-3-range-with-formulas-that-contain-iteratable-reference-to-a-list/58138611\" title=\"filling a n x 3 range with formulas that contain iteratable reference to a list\">stackoverflow.com/questions/58138084/&hellip;</a>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1570035258, "post_id": 58205535, "comment_id": 102790055, "body": "If you look though it does the replace before putting the formula in the cell, so the formula is a viable formula.  You are trying to place the formula in the cell prior to replace hence the error."}, {"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570035264, "post_id": 58205535, "comment_id": 102790060, "body": "@ScottCraner Any clues why <code>Dim strFormulas(1 to 5, 1 to 2)</code> raises the <code>Wrong dimensions error</code>?"}, {"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570035559, "post_id": 58205535, "comment_id": 102790196, "body": "@ScottCraner, thanks for <code>&quot;=ROUNDUP(AVERAGE($B2:$B&quot; &amp; rw &amp; &quot;),0)&quot;</code>. Didn&#39;t know you could do that. Fantastic!"}, {"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1570035696, "post_id": 58205535, "comment_id": 102790262, "body": "@ScottCraner, is it possible to replace sheet name in here <code>&quot;=COUNTA(Sheet!A$2:A$90000)&quot;</code>? &quot;=COUNTA(rw &amp; &quot;!A$2:A$90000)&quot; doesn&#39;t seem to work. Where am I failing?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "edited": false, "score": 0, "creation_date": 1570035843, "post_id": 58205986, "comment_id": 102790338, "body": "thank you!  Any way to also replace name of the worksheet? <code>&quot;=COUNTA(rw &amp; &quot;&#39;Sheet {2}&#39;!A2:A8000)&quot;</code> didn&#39;t work."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "edited": false, "score": 1, "creation_date": 1570035980, "post_id": 58205986, "comment_id": 102790401, "body": "<code>&quot;=COUNTA(&#39;&quot; &amp; rw &amp; &quot;&#39;!A2:A8000)&quot;</code>"}, {"owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "edited": false, "score": 1, "creation_date": 1570036268, "post_id": 58205986, "comment_id": 102790535, "body": "I am speechless! So simple! Thank you for your help and yet more for being so descriptive and specific. Your code and comments helped a lot!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1570035261, "creation_date": 1570035261, "answer_id": 58205986, "question_id": 58205535, "link": "https://stackoverflow.com/questions/58205535/how-do-i-fill-a-5-x-2-range-with-5-literals-in-one-column-and-5-formulas-in-anot/58205986#58205986", "title": "How do I fill a 5 x 2 range with 5 literals in one column and 5 formulas in another in a single run with Excel VBA", "body": "<pre><code>Sub FillSummary()\n    Dim strFormulas(1 To 5, 1 To 2) As Variant\n    Dim wsa As Worksheet: Set wsa = ActiveSheet\n\n    Dim rw As Long\n    rw = 41\n\n    With wsa\n        strFormulas(1, 1) = \"Average\"\n        strFormulas(1, 2) = \"=ROUNDUP(AVERAGE($B2:$B\" &amp; rw &amp; \"),0)\"\n        strFormulas(2, 1) = \"Maximum\"\n        strFormulas(2, 2) = \"=MAX($B2:$B41)\"\n        strFormulas(3, 1) = \"Median\"\n        strFormulas(3, 2) = \"=ROUND(MEDIAN($B2:$B41), 0)\"\n        strFormulas(4, 1) = \"Total\"\n        strFormulas(4, 2) = \"=COUNTA(Sheet!A$2:A$90000)\"\n        strFormulas(5, 1) = \"Total2\"\n        strFormulas(5, 2) = \"=COUNTA('Sheet {2}'!A2:A8000)\"\n        .Range(\"D2:E6\").Formula = strFormulas\n\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>Sub FillSummary()\n    Dim strFormulas(1 To 5, 1 To 2) As Variant\n    Dim wsa As Worksheet: Set wsa = ActiveSheet\n\n    Dim rw As Long\n    rw = 41\n\n    With wsa\n        strFormulas(1, 1) = \"Average\"\n        strFormulas(1, 2) = \"=ROUNDUP(AVERAGE($B2:$Bxx),0)\"\n        strFormulas(2, 1) = \"Maximum\"\n        strFormulas(2, 2) = \"=MAX($B2:$B41)\"\n        strFormulas(3, 1) = \"Median\"\n        strFormulas(3, 2) = \"=ROUND(MEDIAN($B2:$B41), 0)\"\n        strFormulas(4, 1) = \"Total\"\n        strFormulas(4, 2) = \"=COUNTA(Sheet!A$2:A$90000)\"\n        strFormulas(5, 1) = \"Total2\"\n        strFormulas(5, 2) = \"=COUNTA('Sheet {2}'!A2:A8000)\"\n\n        strFormulas(1, 2) = Replace(strFormulas(1, 2), \"xx\", rw)\n\n        .Range(\"D2:E6\").Formula = strFormulas\n\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11540199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb2c8dadf7910af46fa33a311646703?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy Ryutt", "link": "https://stackoverflow.com/users/11540199/stacy-ryutt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58205986, "answer_count": 1, "score": 1, "last_activity_date": 1570517762, "creation_date": 1570033397, "last_edit_date": 1570517762, "question_id": 58205535, "link": "https://stackoverflow.com/questions/58205535/how-do-i-fill-a-5-x-2-range-with-5-literals-in-one-column-and-5-formulas-in-anot", "title": "How do I fill a 5 x 2 range with 5 literals in one column and 5 formulas in another in a single run with Excel VBA", "body": "<p>I want to automatically fill a <code>5 x 2</code> range with text and corresponding formulas. Consider we take columns <code>D</code> and <code>E</code>. The resulting range of cells should look as follows:</p>\n\n<pre><code>| D       | E                             |\n|---------|-------------------------------|\n| Average | =ROUNDUP(AVERAGE($B2:$Bxx),0) |\n| Maximum | =MAX($B2:$B41)                |\n| Median  | =ROUND(MEDIAN($B2:$B41); 0)   |\n| Total   | =COUNTA(Sheet!A$2:A$90000)    |\n| Total2  | =COUNTA('Sheet {2}'!A2:A8000) |\n</code></pre>\n\n<p>I thought that I could fill the whole range with pairs text, formula. I've created the following code: </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub FillSummary()\nDim strFormulas(1 To 10) As Variant\nDim wsa As Worksheet: Set wsa = ActiveSheet\n\nWith wsa\n    strFormulas(1) = \"Average\"\n    strFormulas(2) = \"=ROUNDUP(AVERAGE($B2:$Bxx),0)\"\n    strFormulas(3) = \"Maximum\"\n    strFormulas(4) = \"=MAX($B2:$Bxx)\"\n    strFormulas(5) = \"Median\"\n    strFormulas(6) = \"=ROUND(MEDIAN($B2:$Bxx); 0)\"\n    strFormulas(7) = \"Total\"\n    strFormulas(6) = \"=COUNTA(Sheet!A$2:A$90000)\"\n    strFormulas(9) = \"Total2\"\n    strFormulas(10) = \"=COUNTA('Sheet {2}'!A2:A8000)\"\n    .Range(\"D2:E2\").Formula = strFormulas\n    .Range(\"D2:E6\").FillDown\n\nEnd With\nEnd Sub\n</code></pre>\n\n<p><strong>Important moment here: I need to set different cell addresses every time the code runs. That is why I have specified Bxx instead of specific addresses.</strong></p>\n\n<p>I planned to use Replace() after the formulas are added like:</p>\n\n<p><code>strFormulas(1) = Replace(xx, \"41\", sheetName)</code></p>\n\n<p>However, the code fails when executing line <code>.Range(\"D2:E2\").Formula = strFormulas</code>. What am I doing wrong?</p>\n\n<p>This code runs OK:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\nSub FillDAUSummary()\nDim strFormulas(1 To 10) As Variant\nDim wsa As Worksheet: Set wsa = ActiveSheet\n\n\nWith wsa\n    .Range(\"D2\").Formula = \"Average\"\n    .Range(\"E2\").Formula = \"=ROUNDUP(AVERAGE($B2:$B41),0)\"\n    .Range(\"D3\").Formula = \"Maximum\"\n    .Range(\"E3\").Formula = \"=MAX($B2:$B41)\"\n    .Range(\"D4\").Formula = \"Median\"\n    .Range(\"E4\").Formula = \"=ROUND(MEDIAN($B2:$B41), 0)\"\n    .Range(\"D5\").Formula = \"Total\"\n    .Range(\"E5\").Formula = \"=COUNTA(Sheet!A$2:A$90000)\"\n    .Range(\"D6\").Formula = \"Total2\"\n    .Range(\"E6\").Formula = \"=COUNTA('Sheet {2}'!A2:A8000)\"\nEnd With\nEnd Sub\n\n</code></pre>\n\n<p><strong>However, it has a shortcoming. I had to specify string range: <code>B$2:$B41</code>. In fact, I would like to specify the end of the range on every run.</strong>\nThank you.</p>\n"}, {"tags": ["regex", "vba", "ms-access"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1570032991, "post_id": 58205401, "comment_id": 102788976, "body": "Probably, <code>(?&lt;=\\d)-(?=[A-Za-z])|(?&lt;=[A-Za-z])-(?=\\d)</code>."}, {"owner": {"reputation": 95, "user_id": 5202448, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e85865b5b7dfc445c5e0462ae9cf871b?s=128&d=identicon&r=PG&f=1", "display_name": "John McMahon", "link": "https://stackoverflow.com/users/5202448/john-mcmahon"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1570033297, "post_id": 58205401, "comment_id": 102789120, "body": "Thank you. That works perfectly. However, I should add that I am trying to use this in Access VBA. It does not like the positive look ahead or look behind features. I will tinker around with this as a starting point...  but if you have any other thoughts, they would be appreciated! thank you!"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1570033529, "post_id": 58205401, "comment_id": 102789250, "body": "I will have other thoughts if you explain what you are doing: replacing, removing, extracting?"}, {"owner": {"reputation": 95, "user_id": 5202448, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e85865b5b7dfc445c5e0462ae9cf871b?s=128&d=identicon&r=PG&f=1", "display_name": "John McMahon", "link": "https://stackoverflow.com/users/5202448/john-mcmahon"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1570033718, "post_id": 58205401, "comment_id": 102789343, "body": "I edited the question to reflect this - but I am trying to remove any dashes that appear between alpha and numeric characters (or vice versa). For example, I would like to make 12-A-B-92CD4-5 should become 12A-B92CD4-5."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5202448, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e85865b5b7dfc445c5e0462ae9cf871b?s=128&d=identicon&r=PG&f=1", "display_name": "John McMahon", "link": "https://stackoverflow.com/users/5202448/john-mcmahon"}, "edited": false, "score": 1, "creation_date": 1570035858, "post_id": 58205644, "comment_id": 102790346, "body": "This worked perfectly. Thank you so much for your help and the explanation. This makes a lot more sense now."}], "tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1570034433, "last_edit_date": 1570034433, "creation_date": 1570033863, "answer_id": 58205644, "question_id": 58205401, "link": "https://stackoverflow.com/questions/58205401/how-to-locate-a-character-between-alpha-and-numeric-characters-using-regex/58205644#58205644", "title": "How to Locate a Character Between Alpha and Numeric Characters Using RegEx", "body": "<p>In general, a pattern to identify hyphens between letters and digits that is valid for regex engines supporting both lookbehinds and lookaheads is</p>\n\n<pre><code>(?&lt;=\\d)-(?=[A-Za-z])|(?&lt;=[A-Za-z])-(?=\\d)\n</code></pre>\n\n<p>The <code>(?&lt;=\\d)</code> is a positive lookbehind that matches a location immediately preceded with a digit, <code>(?&lt;=[A-Za-z])</code> is the lookbehind that matches the location preceded with a letter, the <code>(?=[A-Za-z])</code> positive lookahead requires a letter to appear imediately after the current position and the <code>(?=\\d)</code> requires a digit.</p>\n\n<p>To remove all the hyphens between letters and digits in VBA code use</p>\n\n<pre><code>(\\d)-(?=[A-Za-z])|([A-Za-z])-(?=\\d)\n</code></pre>\n\n<p>Replace with <code>$1$2</code> as the replacement string.</p>\n\n<p>See the <a href=\"https://regex101.com/r/bHYeUc/1\" rel=\"nofollow noreferrer\">regex demo</a></p>\n\n<p>The positive lookbehinds are replaced with capturing groups, and the <code>$1</code> / <code>$2</code> placeholders (replacement backreferences) refer to the values stored in the corresponding submatches.</p>\n\n<p>You still need lookaheads to enable overlapping matches, and fortunately VBA regex based on the older ECMA Script version supports lookaheads.</p>\n\n<p><strong>Sample code</strong>:</p>\n\n<pre><code>Dim objRegExp As Object\nSet objRegExp = CreateObject(\"vbscript.regexp\")\n\nobjRegExp.Global = True\nobjRegExp.Pattern = \"(\\d)-(?=[A-Za-z])|([A-Za-z])-(?=\\d)\"\ntext = objRegExp.Replace(text, \"$1$2\")\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 5202448, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e85865b5b7dfc445c5e0462ae9cf871b?s=128&d=identicon&r=PG&f=1", "display_name": "John McMahon", "link": "https://stackoverflow.com/users/5202448/john-mcmahon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58205644, "answer_count": 1, "score": 1, "last_activity_date": 1594421624, "creation_date": 1570032869, "last_edit_date": 1594421624, "question_id": 58205401, "link": "https://stackoverflow.com/questions/58205401/how-to-locate-a-character-between-alpha-and-numeric-characters-using-regex", "title": "How to Locate a Character Between Alpha and Numeric Characters Using RegEx", "body": "<p>I'm working in Access VBA and trying to replace any dashes that appear between an alpha and a numeric character (or vice versa). I am trying to accomplish this using a regular expression to locate a dash (and only the dash) if it appears between a letter and a number or a number and a letter.</p>\n\n<p>I was able to figure out the syntax to identify the pattern I was looking for - however, the expression selects the characters before and after the dash as well - and I am trying to match only the dash.</p>\n\n<p><code>/([0-9]-[A-Za-z])|([A-Z-a-z]-[0-9])/g</code></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Actual Results:\n1234-56789         nothing is matched\n12-A458-125        2-A is matched\n1-A-2-B-C985-ABC   1-A, A-2, 2-B,5-A are matched\n</code></pre>\n\n<p>I'm looking to identify only the - character in those situations</p>\n\n<p>Is this possible?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "loops", "match"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1570035759, "post_id": 58205311, "comment_id": 102790294, "body": "What have you tried? Putting up a code you receive and asking how to modify it to meet your needs, is probably not going to get you anything. What have you tried? You could do some research on what you are trying to accomplish and then when you run into a problem, you can ask a specific question.  Being &quot;suuupppeeerrrr appreciative &quot; is great, but showing a little effort to accomplish the task, will get individuals to  provide constructive guidance."}, {"owner": {"reputation": 25, "user_id": 12153954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66da19460dc2eb7b9735e077dae5c8b4?s=128&d=identicon&r=PG&f=1", "display_name": "adamjamesb", "link": "https://stackoverflow.com/users/12153954/adamjamesb"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1570080250, "post_id": 58205311, "comment_id": 102802214, "body": "I\u2019m very new to this but will try to add my own code first in the future!!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12153954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66da19460dc2eb7b9735e077dae5c8b4?s=128&d=identicon&r=PG&f=1", "display_name": "adamjamesb", "link": "https://stackoverflow.com/users/12153954/adamjamesb"}, "edited": false, "score": 0, "creation_date": 1570080296, "post_id": 58207043, "comment_id": 102802235, "body": "Thank you GMalc, I will test this as soon as I get the chance!"}, {"owner": {"reputation": 25, "user_id": 12153954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66da19460dc2eb7b9735e077dae5c8b4?s=128&d=identicon&r=PG&f=1", "display_name": "adamjamesb", "link": "https://stackoverflow.com/users/12153954/adamjamesb"}, "edited": false, "score": 0, "creation_date": 1570089452, "post_id": 58207043, "comment_id": 102805733, "body": "Runs perfectly!! Thank you very much!"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 0, "last_activity_date": 1570039759, "creation_date": 1570039759, "answer_id": 58207043, "question_id": 58205311, "link": "https://stackoverflow.com/questions/58205311/cycle-through-rows-to-match-2-cells-on-separate-worksheets-continued/58207043#58207043", "title": "Cycle through rows to match 2 cells on separate worksheets CONTINUED", "body": "<p>Your code checks for a specific value in one worksheet, but your asking to test for different values between two worksheet. So, I'm not too busy and I really want to be appreciated; so here is a basic macro that will loop through a column in one worksheet and test each cells value in another worksheets column for a match. If found it will offset 3 columns in the first worksheet and copy that value to the first worksheet column S current row. </p>\n\n<pre><code>'Define your variables\nDim ws1 As Worksheet, ws2 As Worksheet, cel As Range, i As Long\n\n'Assign your worksheet variables\nSet ws1 = ThisWorkbook.Sheets(\"Sheet1\")\nSet ws2 = ThisWorkbook.Sheets(\"Sheet2\")\n\n    'First loop through each cell in Sheet2, column E, start at row 2 to account\n    'for header row) to get the value to find in sheet1, column C.\n    For Each cel In ws2.Range(\"E2:E\" &amp; ws2.Range(\"E\" &amp; ws2.Rows.Count).End(xlUp).Row)\n\n        'Then loop through each cell in Sheet1, Column C. If you get a match, then\n        'copy the value from Sheet2, Column H, cel.row to Sheet1, Column S, i row.\n        For i = 2 To ws1.Range(\"C\" &amp; ws1.Rows.Count).End(xlUp).Row\n\n            If cel.Value = ws1.Cells(i, 3).Value Then\n                ws1.Cells(i, 3).Offset(, 16).Value = cel.Offset(, 3).Value\n            End If\n\n        Next i 'loops through every used cell in Column C for all matches\n    Next cel 'loop to the next cell in Sheets2, Columns E\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 12153954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66da19460dc2eb7b9735e077dae5c8b4?s=128&d=identicon&r=PG&f=1", "display_name": "adamjamesb", "link": "https://stackoverflow.com/users/12153954/adamjamesb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 58207043, "answer_count": 1, "score": 0, "last_activity_date": 1570039759, "creation_date": 1570032501, "question_id": 58205311, "link": "https://stackoverflow.com/questions/58205311/cycle-through-rows-to-match-2-cells-on-separate-worksheets-continued", "title": "Cycle through rows to match 2 cells on separate worksheets CONTINUED", "body": "<p>I have the following code (courtesy of M.Schalk - thank you!) and am looking to delve deeper. In particular:</p>\n\n<p>Every time a cell in column E of \"sheet2\" matches a cell in column C of \"sheet1\", I would like the cell contents of the cell in that row in column H of \"sheet2\" (3 cells to the right) to replace whats in column S if the matched row in \"sheet1\". I hope that makes sense!</p>\n\n<p>Once the cell contents has been pasted, I would like the loop to continue and the next match to paste it's column H cell.</p>\n\n<p>I know I've not explained this very well, so I will be suuupppeeerrrr appreciative if someone can work this one out!</p>\n\n<pre><code>Sub Test3()\n  Dim x As String, y As String\n  Dim found As Boolean\n  Dim i As Integer, lastRow As Long\n\n  lastRow = Worksheets(\"PLANNER_ONGOING_DISPLAY_SHEET\").Cells(Rows.Count, 3).End(xlUp).Row\n\n  x = \"test 73\"\n\n  For i = 4 To lastRow\n    'If you need to compare it to a cell in sheet2 you can also set the value of x here\n    y = Worksheets(\"PLANNER_ONGOING_DISPLAY_SHEET\").Cells(i, 3).Value2\n    If y = x Then\n        ' Do action here, example:\n        MsgBox \"Value found in cell \" &amp; \"C\" &amp; i\n    End If\n\n  Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1570032424, "post_id": 58205272, "comment_id": 102788711, "body": "This can be done with a simple formula."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6715086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e9c494efcaf8208693c0cddef6ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "cknowlan", "link": "https://stackoverflow.com/users/6715086/cknowlan"}, "edited": false, "score": 1, "creation_date": 1570110442, "post_id": 58209410, "comment_id": 102816855, "body": "One assumption for another doing this is the list of company&#39;s is sorted. I added a line before implementing the logic above to sort the sheet by company name."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 15, "user_id": 6715086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e9c494efcaf8208693c0cddef6ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "cknowlan", "link": "https://stackoverflow.com/users/6715086/cknowlan"}, "edited": false, "score": 0, "creation_date": 1570137395, "post_id": 58209410, "comment_id": 102828991, "body": "You are totally right @cknowlan. I just assumed that the column A was sorted."}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": true, "score": 0, "last_activity_date": 1570050657, "creation_date": 1570050657, "answer_id": 58209410, "question_id": 58205272, "link": "https://stackoverflow.com/questions/58205272/in-excel-vba-how-do-you-increase-a-number-in-one-column-by-one-based-on-the-valu/58209410#58209410", "title": "In excel VBA how do you increase a number in one column by one based on the value changing in another column", "body": "<p>Could be solved be either formula or VBA code.</p>\n\n<p>Logic is to see if your current cell with the company name is the same as the previous cell. If they are the same then copy previous value. Otherwise increase the invoice number with 1.</p>\n\n<p><strong>Formula</strong>, starts in cell <code>C2</code>:</p>\n\n<pre><code>=IF(A1=A2,C1,C1+1)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/mITqF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mITqF.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>VBA code</strong>:</p>\n\n<p>You might need to change the column number so it fits your dataset.</p>\n\n<pre><code>Sub IncreaseNumber()\n\nDim ws As Worksheet\nDim lrow As Long\nDim i As Long\n\nSet ws = Worksheets(\"Sheet1\") 'Name the worksheet\n\nlrow = ws.Cells(Rows.Count, \"A\").End(xlUp).Row 'find the lastrow in column A\n\nFor i = 2 To lrow 'Loop from second row to the last row\n   If ws.Cells(i - 1, \"A\").Value = ws.Cells(i, \"A\").Value Then 'If cell \"i -1\" and cell \"i\" is equal then\n        ws.Cells(i, \"B\").Value = ws.Cells(i - 1, \"B\").Value 'take the same value as row above\n    Else\n        ws.Cells(i, \"B\").Value = ws.Cells(i - 1, \"B\").Value + 1 'if not the same, then add 1 to the invoice number\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6715086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e9c494efcaf8208693c0cddef6ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "cknowlan", "link": "https://stackoverflow.com/users/6715086/cknowlan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 58209410, "answer_count": 1, "score": 1, "last_activity_date": 1570050657, "creation_date": 1570032344, "last_edit_date": 1570032377, "question_id": 58205272, "link": "https://stackoverflow.com/questions/58205272/in-excel-vba-how-do-you-increase-a-number-in-one-column-by-one-based-on-the-valu", "title": "In excel VBA how do you increase a number in one column by one based on the value changing in another column", "body": "<p>I have two columns in excel. One is a company name. The other column is an invoice number that should only increment upon change in company name. The beginning invoice number should be input \nInput Beginning Invoice number => 1001. What is the VBA code to increment the invoice number each time a new company occurs?</p>\n\n<pre><code>Company A      1001\nCompany A      1001\nCompany A      1001\nCompany B      1002\nCompany B      1002\nCompany C      1003\n</code></pre>\n"}, {"tags": ["vba", "if-statement", "ms-access"], "comments": [{"owner": {"reputation": 131, "user_id": 2824252, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2f282db1c6fec43c4dad4e1f735c0aa9?s=128&d=identicon&r=PG&f=1", "display_name": "A.Birdman", "link": "https://stackoverflow.com/users/2824252/a-birdman"}, "edited": false, "score": 0, "creation_date": 1570033162, "post_id": 58205248, "comment_id": 102789042, "body": "I will add that for the &#39;Else&#39; case, when the number doesn&#39;t end in &quot;A&quot;, the code works fine. It is only the &quot;A&quot; case that is causing the issue."}], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 0, "last_activity_date": 1570050901, "creation_date": 1570050901, "answer_id": 58209454, "question_id": 58205248, "link": "https://stackoverflow.com/questions/58205248/how-to-show-a-message-box-in-response-to-if-then-in-access-form/58209454#58209454", "title": "How to show a message box in response to if-then in access form", "body": "<p>Your MsgBox call is simply wrong. Syntax is:</p>\n\n<pre><code>MsgBox(prompt [, buttons] [, title] [, helpfile, context])\n</code></pre>\n\n<p>The <code>vbOK</code> at the end of</p>\n\n<pre><code>Response = MsgBox(Msg, Style, Title, vbOK)\n</code></pre>\n\n<p>doesn't belong there.</p>\n\n<p>Nobody uses the <code>helpfile, context</code> parameters anymore, but if you would, you'd have to provide them both.</p>\n\n<p>So with 4 parameters you get <code>Invalid procedure call or argument (Error 5)</code></p>\n"}], "owner": {"reputation": 131, "user_id": 2824252, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2f282db1c6fec43c4dad4e1f735c0aa9?s=128&d=identicon&r=PG&f=1", "display_name": "A.Birdman", "link": "https://stackoverflow.com/users/2824252/a-birdman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "accepted_answer_id": 58209454, "answer_count": 1, "score": 0, "last_activity_date": 1593762711, "creation_date": 1570032256, "last_edit_date": 1593762711, "question_id": 58205248, "link": "https://stackoverflow.com/questions/58205248/how-to-show-a-message-box-in-response-to-if-then-in-access-form", "title": "How to show a message box in response to if-then in access form", "body": "<p>I have a MS Access form for data edits. A subset of the data fields very occasionally need updates at this point, but generally do not. I have hidden the controls for those fields, requiring a user to click a button to intentionally show those hidden controls. An additional wrinkle is that cases ending in \"A\" can not be updated here, while those ending in any other letter may be. </p>\n\n<p>For the OnClick of my button I want to use an IF statement to </p>\n\n<ul>\n<li>(if they are on an \"A\" record) exclude the \"A\" records and open a messagebox to the user that they have to be updated on the main case form.</li>\n<li>(for any other records) show the fields to update. </li>\n</ul>\n\n<p>As a last bit, when they update any of the fields, I need to set a checkbox to TRUE so that in the future the record will not be overwritten in an update query. </p>\n\n<pre><code>Private Sub btnUpDtAllegInfo_Click()\n\nDim Msg, Style, Title, Response\n\n    Msg = \"Message to user\"\n    Style = vbCritical\n    Title = \"Can't update allegation A here\"\n\n' if \"A\" allegation, show error message\nIf Me.AltIntCaseNumber Like \"*A\" Then\n    Response = MsgBox(Msg, Style, Title, vbOK)\n\n' if not \"A\", show the edit fields and hide the text box. \nElse\n    Me.Location.Visible = True\n    Me.LocationCity.Visible = True\n    Me.LocationState.Visible = True\n    Me.ProviderName.Visible = True\n    Me.Site.Visible = True\n    Me.SiteCity.Visible = True\n    Me.SiteState.Visible = True\n    Me.SiteZip.Visible = True\n    Me.txtWarning.Visible = False\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The field being tested is AltIntCaseNumber. The other fields are updateable except for txtWarning which is a simple set of directions reminding the user of the rules (visible by default - hidden on click). Most of what I have above is cobbled from what I've found online. The parts have all worked elsewhere in other contexts, but for some reason when I set it up this way I get a 'Run-time error 5' that I can't resolve. On debug, the \"Response = MsgBox() call is highlighted. </p>\n\n<p>All the suggested posts I found related to other programing approaches (C#, ASP.Net) though I feel like the resolve should be pretty simple. </p>\n"}, {"tags": ["excel", "vba", "error-handling"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1570031664, "post_id": 58205062, "comment_id": 102788355, "body": "Move <code>Application.EnableEvents = True</code> after the <code>ErrorHandler:</code>. Otherwise, on an error, events aren&#39;t re-enabled. Also - replace <code>Range(Target.Address)</code> with <code>Target</code>."}, {"owner": {"reputation": 9, "user_id": 11633613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96861cbca3bf4d54d7d1aa62839c5158?s=128&d=identicon&r=PG&f=1", "display_name": "lekoppa", "link": "https://stackoverflow.com/users/11633613/lekoppa"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570032082, "post_id": 58205062, "comment_id": 102788560, "body": "@BigBen  Thanks for the quick fix!"}], "owner": {"reputation": 9, "user_id": 11633613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96861cbca3bf4d54d7d1aa62839c5158?s=128&d=identicon&r=PG&f=1", "display_name": "lekoppa", "link": "https://stackoverflow.com/users/11633613/lekoppa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570031548, "creation_date": 1570031548, "question_id": 58205062, "link": "https://stackoverflow.com/questions/58205062/errorhandler-for-worksheet-selection-change", "title": "ErrorHandler for Worksheet Selection Change", "body": "<p>I've been using the VBA code below to change the values in cells C6:C13 from \"Show\" to \"Hide\" at the click of a mouse.  It works great for it's intended purpose.  However, it will be necessary to hide/unhide column C from time to time, which is where I run into trouble.</p>\n\n<p>Because it contains my KeyCells range, selecting column C generates a debug error.  I added an ErrorHandler to compensate--  but once it is triggered, the sub no longer functions until the sheet is closed/reopened.</p>\n\n<p>Can anyone suggest a workaround?</p>\n\n<pre><code>  Application.EnableEvents = False\n  With Target\n\n  Dim KeyCells As Range\n  Set KeyCells = Range(\"C6:C13\")\n  On Error GoTo ErrorHandler\n\n  If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n\n     Select Case .Value\n      Case \"Show\"\n        .Value = \"Hide\"\n      Case \"Hide\"\n        .Value = \"Show\"\n    End Select\n  Range(\"B15\").Select\n  End If\n  End With\n\n  Application.EnableEvents = True\n\nErrorHandler:\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date", "gantt-chart"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570031144, "post_id": 58204939, "comment_id": 102788074, "body": "So, did your script work?"}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570031257, "post_id": 58204939, "comment_id": 102788145, "body": "Not well, it is slow and sometimes happens that it doesn&#39;t correspond to the dates."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1570032109, "post_id": 58204939, "comment_id": 102788575, "body": "You give a value to <code>ultimaColonna</code> <i>after</i> you set <code>rng</code> and <code>rng2</code>. Also, when you use <code>Worksheets(&quot;Commesse&quot;).Columns.Count</code> you end up with a huge number, try <code>ultimacolonna = Worksheets(&quot;Commesse&quot;).UsedRange.Columns.Count</code> instead"}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "edited": false, "score": 0, "creation_date": 1570100428, "post_id": 58204939, "comment_id": 102811437, "body": "Ok i found solution. The Cells(riga, cell.Column).Borders.Weight = xlMedium was causing the problem, now i will search for another way to add border."}], "owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570031150, "creation_date": 1570031030, "last_edit_date": 1570031150, "question_id": 58204939, "link": "https://stackoverflow.com/questions/58204939/how-to-create-a-gantt-chart-vba-using-cell-borders", "title": "How to create a Gantt chart [VBA] using cell borders", "body": "<p>I would like to have a gantt style chart in my project by adding in VBA border to specific cells like here: </p>\n\n<p><a href=\"https://i.stack.imgur.com/XTQpK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XTQpK.png\" alt=\"https://imgur.com/a/XqkKJxw\"></a></p>\n\n<p>I tried with this script : </p>\n\n<pre><code>Public Sub DisegnaLineeGantt(ByVal riga As Long)\n\n  Dim DataInizio, DataFine As Date\n  Dim cell As Range\n  Dim ultimaColonna As Long\n  Dim rng As Range\n  Dim rng2 As Range\n\n  Set rng = Range(Cells(15, 11), Cells(15, ultimaColonna))\n  Set rng2 = Range(Cells(riga, 11), Cells(riga, ultimaColonna))\n  rng2.Borders.LineStyle = xlNone\n  DataInizio = Cells(riga, 3)\n  DataFine = Cells(riga, 4)\n  ultimaColonna = Worksheets(\"Commesse\").Columns.Count\n\n  For Each cell In rng\n    If DataInizio = cell Then\n      Cells(riga, cell.Column).Borders(xlEdgeLeft).LineStyle = xlContinuous\n      Cells(riga, cell.Column).Borders(xlEdgeTop).LineStyle = xlContinuous\n      Cells(riga, cell.Column).Borders.Weight = xlMedium\n    ElseIf DataFine = cell Then\n      Cells(riga, cell.Column).Borders(xlEdgeRight).LineStyle = xlContinuous\n      Cells(riga, cell.Column).Borders(xlEdgeTop).LineStyle = xlContinuous\n      Exit For\n    ElseIf DataInizio &lt; cell And DataFine &gt; cell Then\n      Cells(riga, cell.Column).Borders(xlEdgeTop).LineStyle = xlContinuous\n    End If\n  Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570030628, "post_id": 58204765, "comment_id": 102787802, "body": "Have you tried replacing <code>&quot;.pdf&quot;</code> with <code>&quot;.jpg&quot;</code>? :D"}, {"owner": {"reputation": 597, "user_id": 2685323, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/541556255/picture?type=large", "display_name": "Emma", "link": "https://stackoverflow.com/users/2685323/emma"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570032063, "post_id": 58204765, "comment_id": 102788551, "body": "yes, unfortunately didn&#39;t work."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1570033522, "post_id": 58204765, "comment_id": 102789242, "body": "What do you mean <i>didn&#39;t work</i>? Did you apply extension change to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.slide.export\" rel=\"nofollow noreferrer\">Slide.Export</a> call?"}, {"owner": {"reputation": 597, "user_id": 2685323, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/541556255/picture?type=large", "display_name": "Emma", "link": "https://stackoverflow.com/users/2685323/emma"}, "edited": false, "score": 0, "creation_date": 1570035471, "post_id": 58204765, "comment_id": 102790170, "body": "I can only save as PDF not JPG, when i run the script, no image files are created"}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 2685323, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/541556255/picture?type=large", "display_name": "Emma", "link": "https://stackoverflow.com/users/2685323/emma"}, "edited": false, "score": 0, "creation_date": 1570084243, "post_id": 58206209, "comment_id": 102803461, "body": "That\u2019s great thanks - I am getting \u201ccompile error expected function or variable\u201d on line myslide=oPPTFike.Slides(1).Select"}, {"owner": {"reputation": 597, "user_id": 2685323, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/541556255/picture?type=large", "display_name": "Emma", "link": "https://stackoverflow.com/users/2685323/emma"}, "edited": false, "score": 0, "creation_date": 1570084411, "post_id": 58206209, "comment_id": 102803515, "body": "Removed the line above and get compile error - invalid qualifier on mySlide"}, {"owner": {"reputation": 597, "user_id": 2685323, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/541556255/picture?type=large", "display_name": "Emma", "link": "https://stackoverflow.com/users/2685323/emma"}, "edited": false, "score": 0, "creation_date": 1570084657, "post_id": 58206209, "comment_id": 102803609, "body": "Now working - line changed to oPPTFile.Export - thank you for your help !"}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 3, "last_activity_date": 1570036314, "creation_date": 1570036314, "answer_id": 58206209, "question_id": 58204765, "link": "https://stackoverflow.com/questions/58204765/vba-save-multiple-powerpoint-presentation-slides-as-jpg/58206209#58206209", "title": "VBA Save Multiple Powerpoint presentation slides as JPG", "body": "<p>You're almost there. Just add the FilterName argument after the path and file names. BTW, I doubt you need to select the slide in the previous line before exporting it.</p>\n\n<pre><code>myslide.Export oPPTFile.Path &amp; \"\\\" &amp; TrimFile &amp; \".jpg\", \"JPG\"\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 2685323, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/541556255/picture?type=large", "display_name": "Emma", "link": "https://stackoverflow.com/users/2685323/emma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 618, "favorite_count": 1, "accepted_answer_id": 58206209, "answer_count": 1, "score": 0, "last_activity_date": 1570036314, "creation_date": 1570030431, "last_edit_date": 1570030573, "question_id": 58204765, "link": "https://stackoverflow.com/questions/58204765/vba-save-multiple-powerpoint-presentation-slides-as-jpg", "title": "VBA Save Multiple Powerpoint presentation slides as JPG", "body": "<p>I have a folder full of PowerPoint presentations and wish to batch open each one and save each slide as an image. I have found some code that I am running as a macro in Excel to save as PDF - I can re-save as PDF but how do I modify this to include saving the slides as jpeg images ?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Option Explicit\r\nDim oPPTApp As PowerPoint.Application\r\nDim oPPTFile As PowerPoint.Presentation\r\nSub Converter()\r\nDim cnt As Integer, currfile As String\r\nDim TrimFile As String, Path As String, FilesInPath As String _\r\n, MyFiles() As String, Fnum As Long\r\nDim CalcMode As Long, LPosition As Long\r\nDim StartTime As Date, EndTime As Date\r\n\r\n     \r\nThisWorkbook.Activate\r\ncurrfile = ActiveWorkbook.Name\r\n         \r\nWindows(currfile).Activate\r\nSheets(\"Sheet1\").Activate\r\n   \r\nStartTime = Timer\r\nPath = Range(\"C3\").Text &amp; \"\\\"\r\n\r\nFilesInPath = Dir(Path &amp; \"*.pp*\")\r\nIf FilesInPath = \"\" Then\r\nMsgBox \"No files found\"\r\nExit Sub\r\nEnd If\r\n\r\nFnum = 0\r\nDo While FilesInPath &lt;&gt; \"\"\r\nFnum = Fnum + 1\r\nReDim Preserve MyFiles(1 To Fnum)\r\nMyFiles(Fnum) = FilesInPath\r\nFilesInPath = Dir()\r\nLoop\r\n\r\nWith Application\r\nCalcMode = .Calculation\r\n.Calculation = xlCalculationManual\r\n.ScreenUpdating = False\r\n.EnableEvents = False\r\nEnd With\r\n\r\nIf Fnum &gt; 0 Then\r\nFor Fnum = LBound(MyFiles) To UBound(MyFiles)\r\n  Set oPPTApp = CreateObject(\"PowerPoint.Application\")\r\n    oPPTApp.Visible = msoTrue\r\n     \r\n    On Error Resume Next\r\n   \r\nSet oPPTFile = oPPTApp.Presentations.Open(Path &amp; MyFiles(Fnum))\r\n\r\n\r\n   \r\n   \r\nOn Error GoTo 0\r\n\r\nIf Not oPPTFile Is Nothing Then\r\n\r\n\r\nLPosition = InStr(1, oPPTFile.Name, \".\") - 1\r\nTrimFile = Left(oPPTFile.Name, LPosition)\r\n\r\n\r\n//here trying to save the slides as images\r\nmyslide = oPPTFile.Slides(1).Select\r\nmyslide.Export oPPTFile.Path &amp; \"\\\" &amp; TrimFile &amp; \".pdf\"\r\n\r\n\r\n\r\n\r\nOn Error Resume Next\r\n\r\noPPTFile.ExportAsFixedFormat oPPTFile.Path &amp; \"\\\" &amp; TrimFile &amp; \".pdf\", _\r\nppFixedFormatTypePDF, ppFixedFormatIntentPrint\r\n\r\n\r\n   \r\n   End If\r\n   \r\noPPTFile.Close\r\n   \r\n   Next Fnum\r\nEnd If\r\n\r\n\r\nWith Application\r\n.ScreenUpdating = True\r\n.EnableEvents = True\r\n.Calculation = CalcMode\r\nEnd With\r\n \r\n    oPPTApp.Quit\r\n\r\n    Set oPPTFile = Nothing\r\n    Set oPPTApp = Nothing\r\n   \r\nEndTime = Timer\r\nMsgBox \" Task succesfully completed in \" &amp; Format(EndTime - StartTime, \"0.00\") &amp; \" seconds\"\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["excel", "vba", "select", "cell", "prompt"], "comments": [{"owner": {"reputation": 1802, "user_id": 11823079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQoIH.png?s=128&g=1", "display_name": "Norbert Bartko", "link": "https://stackoverflow.com/users/11823079/norbert-bartko"}, "edited": false, "score": 1, "creation_date": 1570034386, "post_id": 58204616, "comment_id": 102789663, "body": "That&#39;s not a question. Please look at <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a> and <a href=\"https://stackoverflow.com/tour\">take the tour</a>. Then also take a look at <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">how to create a minimal reproducible example</a>. Then edit your question and get some answers."}, {"owner": {"reputation": 1, "user_id": 12154529, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ndIt7CIBN0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcMBs9oBw-_OAaxs152u2pC4vwXBw/photo.jpg?sz=128", "display_name": "Mailbox", "link": "https://stackoverflow.com/users/12154529/mailbox"}, "reply_to_user": {"reputation": 1802, "user_id": 11823079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PQoIH.png?s=128&g=1", "display_name": "Norbert Bartko", "link": "https://stackoverflow.com/users/11823079/norbert-bartko"}, "edited": false, "score": 0, "creation_date": 1570036357, "post_id": 58204616, "comment_id": 102790576, "body": "I looked over your links (again) and I am not sure what you are looking for. Can you be more specific? The title is a question. The description provides more information and clarifies the question."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1570515663, "post_id": 58204616, "comment_id": 102927746, "body": "@Mailbox The issue is, there is no code in your question. So we cannot help you with your code if we don&#39;t see it. You need to show what you have done/tried so far, then explain what errors you got and where, or what your code actually did and what you expect it to do. If your code is not short then create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that represents the issue you have."}, {"owner": {"reputation": 1, "user_id": 12154529, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ndIt7CIBN0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcMBs9oBw-_OAaxs152u2pC4vwXBw/photo.jpg?sz=128", "display_name": "Mailbox", "link": "https://stackoverflow.com/users/12154529/mailbox"}, "edited": false, "score": 0, "creation_date": 1570559218, "post_id": 58204616, "comment_id": 102948415, "body": "I have updated my post with the code I am using. It works just like it should with no problems or errors. I am just looking for a way to reduce my &quot;click count&quot; when running the code. thanks for your consideration and help."}], "owner": {"reputation": 1, "user_id": 12154529, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ndIt7CIBN0U/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcMBs9oBw-_OAaxs152u2pC4vwXBw/photo.jpg?sz=128", "display_name": "Mailbox", "link": "https://stackoverflow.com/users/12154529/mailbox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570558646, "creation_date": 1570029940, "last_edit_date": 1570558646, "question_id": 58204616, "link": "https://stackoverflow.com/questions/58204616/how-can-my-macro-prompt-for-a-single-cell-selection-without-needing-to-click-oka", "title": "How can my macro prompt for a single cell selection without needing to click okay on an inputbox?", "body": "<p>I have an Excel macro that copies several cells from part of the worksheet to another. The macro uses inputbox to prompt the user to select a date to copy from and then prompts to select a date to paste to. The macro then copies several cells near the \"from\" date and pastes the information to the corresponding cells near the \"to\" date. Everything works, but it is a drag having to click okay on the inputbox after every selection. Is there a way to streamline this so the user only has to click the \"from\" and \"to\" cells? </p>\n\n<p>Current process:</p>\n\n<ol>\n<li>Click macro call button.</li>\n<li>Click \"from\" cell.</li>\n<li>Click okay on inputbox.</li>\n<li>Click \"to\" cell.</li>\n<li>click okay on inputbox.</li>\n</ol>\n\n<p>Desired process:</p>\n\n<ol>\n<li>Click macro call button.</li>\n<li>Click \"from\" cell.</li>\n<li>Click \"to\" cell.</li>\n</ol>\n\n<p>Here is the code I am using:</p>\n\n<pre><code>Dim fromdate As Range\nDim todate As Range\nDim x As Integer\nDim y As Integer\nActiveSheet.Unprotect\nFor x = 1 To 3\nSet fromdate = Application.InputBox(\"Select copy from date\", \"Select copy from date\", Type:=8)\nIf IsDate(fromdate.Value) = True Then 'ensure selected cell is a date\n   For y = 1 To 3\n   Set todate = Application.InputBox(\"Select copy to date\", \"Select copy to date\", Type:=8)\n   If IsDate(todate.Value) Then 'ensure selected cell is a date\n     ActiveSheet.Protect\n     'copy data\n     todate.Offset(1, 1) = fromdate.Offset(1, 1)\n     todate.Offset(1, 4) = fromdate.Offset(1, 4)\n     End\n   End If\n   MsgBox \"Pick the date cell\"\n   Next y\nEnd If\nMsgBox \"Pick the date cell\"\nNext x\nActiveSheet.Protect\n</code></pre>\n\n<p>As I stated above, this code works fine. I just don't want to have to click okay on the input box that pops up. I am hoping that there is some other command I can use instead of inputbox. I want to copy the data with three clicks. One to run the macro, one to select the \"from\" date, and one to select the \"to date.</p>\n"}, {"tags": ["vba", "object", "powerpoint", "shapes"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4637688, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d7f845f2eb63fb8d121961dda4b4643?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy", "link": "https://stackoverflow.com/users/4637688/stacy"}, "edited": false, "score": 0, "creation_date": 1570120957, "post_id": 58222284, "comment_id": 102822336, "body": "Thanks. I was hoping to be able to point to a location by name in case it is moved around in the template by the user. I may have to go the coordinate route though..."}, {"owner": {"reputation": 568, "user_id": 4630650, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/799739480117365/picture?type=large", "display_name": "Bhavesh Shaha", "link": "https://stackoverflow.com/users/4630650/bhavesh-shaha"}, "edited": false, "score": 0, "creation_date": 1570430477, "post_id": 58222284, "comment_id": 102896947, "body": "Side/Related Question: Is it possible to know at which coordinate the user clicked on the slide?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1570811530, "post_id": 58222284, "comment_id": 103045549, "body": "There may be a Windows API function that&#39;d help with this; while you can, I think, get the cursor position via VBA, you can&#39;t trap mouse-click events."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1570983285, "post_id": 58222284, "comment_id": 103081302, "body": "You might also consider adding tags to the shapes whose positions you want to &quot;protect&quot;. The tags could store each shape&#39;s top/left/height/width properties. A fairly simple routine could check each shape on each slide and if it contains positioning tags, move the shape to the desired position."}], "tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1570116207, "creation_date": 1570116207, "answer_id": 58222284, "question_id": 58204545, "link": "https://stackoverflow.com/questions/58204545/vba-to-move-ppt-object-to-a-specific-location/58222284#58222284", "title": "VBA to move ppt object to a specific location", "body": "<p>The position and size of shapes on a PPT slide is controlled by the .Top, .Left, .Height and .Width properties of the shape (specified in Points, 72 points to the inch).</p>\n\n<p>Assuming you know the slide's index and the name of the shape, this would move it to 1\" from the top and 1\" from the left edge of the slide:</p>\n\n<pre><code>With ActivePresentation.Slides(2).Shapes(\"YourShapeName\")\n  .Top = 72\n  .Left = 72\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 4637688, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5d7f845f2eb63fb8d121961dda4b4643?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy", "link": "https://stackoverflow.com/users/4637688/stacy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1582782098, "creation_date": 1570029664, "last_edit_date": 1582782098, "question_id": 58204545, "link": "https://stackoverflow.com/questions/58204545/vba-to-move-ppt-object-to-a-specific-location", "title": "VBA to move ppt object to a specific location", "body": "<p>I am using VBA to push calculations from Access into charts, graphs and tables in a template powerpoint presentation. The objects are manipulated with tables within Access for specific names, font size, chart type etc. The problem I am running into is moving my named objects within the powerpoint. Since I am using a powerpoint template I have specific slides that I need to move the objects to. Some of the slides have room for multiple shape/objects and are not necessarily in a specific slide order. The shapes are named within the presentation. I cannot find a command to move an object/shape to an identified location.     </p>\n\n<p>The closest thing I have found is something similar to :</p>\n\n<pre><code>    ActivePresentation.Slides(2).MoveTo to Pos:=1\n</code></pre>\n\n<p>However, this moves the entire slide and not just the table, graph or chart. Again, since the slide order may change I need to use the name of the object and the name of the shape in the slide to connect the two. Any command I should research would be helpful! TIA!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1570029487, "post_id": 58204363, "comment_id": 102787146, "body": "<code>LastRow = Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row</code> this would return the last row for column A in the <code>ActiveSheet</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 1, "last_activity_date": 1570029488, "creation_date": 1570029488, "answer_id": 58204500, "question_id": 58204363, "link": "https://stackoverflow.com/questions/58204363/duplicate-as-value-only-last-row-into-adjacent-column-excel/58204500#58204500", "title": "Duplicate as Value only last row into adjacent column Excel", "body": "<p>Try this:</p>\n\n<pre><code>Selection.Copy\nActiveSheet.Cells(Rows.Count, ActiveCell.Column).End(xlUp).PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 3816958, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9fa7532df6bf8c48d4c25302bb1571dd?s=128&d=identicon&r=PG&f=1", "display_name": "rzb1", "link": "https://stackoverflow.com/users/3816958/rzb1"}, "edited": false, "score": 0, "creation_date": 1570031062, "post_id": 58204568, "comment_id": 102788036, "body": "Thanks Tony, i figured it out with this"}], "tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1570030540, "last_edit_date": 1570030540, "creation_date": 1570029770, "answer_id": 58204568, "question_id": 58204363, "link": "https://stackoverflow.com/questions/58204363/duplicate-as-value-only-last-row-into-adjacent-column-excel/58204568#58204568", "title": "Duplicate as Value only last row into adjacent column Excel", "body": "<p>From a programming point of view, it's much better to define variables rather than using <code>Selection, .select, or ActiveCell,</code> etc... This code will place the cell you are looking for into the variable <code>r</code>, assuming the first header row (A1) is not empty. If you don't want to make any assumptions about the first or last row, see the last answer on <a href=\"https://stackoverflow.com/questions/11453658/find-the-last-cell-address-using-vba-excel\">this page</a>. In the code below, this would mean replacing <code>Set r = r.End(xlDown)</code> with <code>Set r = sh.Range(\"A:A\").Find(\"*\", Range(\"A1\"), SearchDirection:=xlPrevious)</code></p>\n\n<pre><code>Option Explicit\nSub test()\nDim sh As Worksheet, r As Range\nSet sh = ThisWorkbook.Worksheets(\"Sheet1\")\nSet r = sh.Range(\"A1\")\nSet r = r.End(xlDown)\nr.Select 'remove after code has been tested and you know it works\nEnd Sub\n</code></pre>\n\n<p>If you have more questions, just ask. There's a lot of help available to help you program in the proper way here on StackOverflow.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 3816958, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9fa7532df6bf8c48d4c25302bb1571dd?s=128&d=identicon&r=PG&f=1", "display_name": "rzb1", "link": "https://stackoverflow.com/users/3816958/rzb1"}, "is_accepted": false, "score": 0, "last_activity_date": 1570031020, "creation_date": 1570031020, "answer_id": 58204937, "question_id": 58204363, "link": "https://stackoverflow.com/questions/58204363/duplicate-as-value-only-last-row-into-adjacent-column-excel/58204937#58204937", "title": "Duplicate as Value only last row into adjacent column Excel", "body": "<p>Thanks all,\nI fixed it with help of both</p>\n\n<pre><code>    LastValue = Range(\"Table1[Opportunity no.]\").End(xlDown).Value\nSet ws = Worksheets(\"Datos\")\niRow = ws.Cells.Find(What:=\"*\", SearchOrder:=xlRows, _\n    SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n    With ws\n    .Cells(iRow, 2).Value = LastValue\n    End With\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 3816958, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9fa7532df6bf8c48d4c25302bb1571dd?s=128&d=identicon&r=PG&f=1", "display_name": "rzb1", "link": "https://stackoverflow.com/users/3816958/rzb1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1570031386, "creation_date": 1570029092, "last_edit_date": 1570031386, "question_id": 58204363, "link": "https://stackoverflow.com/questions/58204363/duplicate-as-value-only-last-row-into-adjacent-column-excel", "title": "Duplicate as Value only last row into adjacent column Excel", "body": "<p>I'm creating a VBA application with some forms. When the data is inserted into the Table, Column A calculates a value with a formula. After that I need to copy the resulting value (like paste special, values only) into the adjacent Row\n<a href=\"https://i.stack.imgur.com/s368q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s368q.png\" alt=\"Copy Last Row from Column A to Last Row Column B\"></a></p>\n\n<p>I just need to know how to select the last row everytime. I have tried with <code>ActiveCell</code>, <code>Find</code>, <code>Range</code> etc. but none are working</p>\n\n<pre><code>Selection.Copy\nActiveCell.Offset(0, 1).Select\nSelection.PasteSpecial Paste:=xlPasteValues\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 1, "last_activity_date": 1570028935, "creation_date": 1570028935, "answer_id": 58204310, "question_id": 58204226, "link": "https://stackoverflow.com/questions/58204226/how-to-define-the-length-number-of-elements-of-an-array-with-n-elements-in-vba/58204310#58204310", "title": "How to define the length (number of elements) of an array with N elements in VBA", "body": "<p>First, <code>Dim A As Variant</code> - always declare your variable, always start your modules with <code>Option Explicit</code>.  You can also turn this on by default (Tools > Options > Require Variable Declaration).</p>\n\n<p>Next, I believe you probably want <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/array-function\" rel=\"nofollow noreferrer\">the <code>Array</code> function</a>:</p>\n\n<pre><code>A = Array(12,9,8,12,16,19,3,2,5,20)\n</code></pre>\n\n<p>Using <code>[</code> and <code>]</code> has a completely different meaning in VBA - for example <code>[A1]</code> will (in Excel VBA) reference cell A1 of the ActiveSheet</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1570028943, "creation_date": 1570028943, "answer_id": 58204312, "question_id": 58204226, "link": "https://stackoverflow.com/questions/58204226/how-to-define-the-length-number-of-elements-of-an-array-with-n-elements-in-vba/58204312#58204312", "title": "How to define the length (number of elements) of an array with N elements in VBA", "body": "<ol>\n<li>Declare all you variables(Consider using <code>Option Explicit</code>).</li>\n<li>Use <code>Array()</code> not <code>[]</code></li>\n</ol>\n\n<hr>\n\n<pre><code>Option Base 1\nOption Explicit\n\nSub Question1()\n    Dim A()\n    A = Array(12, 9, 8, 12, 16, 19, 3, 2, 5, 20)\n\n    Dim i As Long\n    i = 1\n\n    Dim N As Long\n    N = UBound(A)\n\n    Dim summ As Double\n    summ = A(1)\n\n    For i = 1 To (N - 1)\n        summ = summ + A(i + 1)\n    Next i\n\n    Dim AVG As Double\n    AVG = summ / N\n\n    MsgBox \"Average is: \" &amp; AVG\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1570029206, "last_edit_date": 1570029206, "creation_date": 1570029010, "answer_id": 58204339, "question_id": 58204226, "link": "https://stackoverflow.com/questions/58204226/how-to-define-the-length-number-of-elements-of-an-array-with-n-elements-in-vba/58204339#58204339", "title": "How to define the length (number of elements) of an array with N elements in VBA", "body": "<p>You don't need to do so in Excel, you could just use a worksheet function like this:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    Dim A As Variant\n    A = Array(12,9,8,12,16,19,3,2,5,20)\n\n    Dim AVG As Single\n    AVG = Application.Average(A)\n    MsgBox \"Average is: \" &amp; AVG\n\nEnd Sub\n</code></pre>\n\n<ol>\n<li><p>Use always <code>Option Explicit</code> at the top of your module to force\nyourself to declare all your variables.     </p></li>\n<li><p>Don't use <code>integer</code> use a <code>Long</code>.</p></li>\n<li>UBound(array) gives you the index of the last member, LBound(array) gives you the index of the first one.</li>\n<li>You can use the same formulas you can use on your sheet like this <code>Application.WorksheetFunction.YourFormula</code> but if you skip the  <code>WorksheetFunction</code>and give the value to an array it won't raise an error if there is one.</li>\n</ol>\n\n<p>Although your way would be like this:</p>\n\n<pre><code>Sub Test2()\n\n    Dim A As Variant\n    A = [12,9,8,12,16,19,3,2,5,20]\n\n    Dim i As Long, Summ As Long\n    For i = 1 To UBound(A)\n        Summ = Summ + A(i)\n    Next i\n\n    AVG = Summ / UBound(A)\n\n    MsgBox \"Average is: \" &amp; AVG\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "is_accepted": false, "score": 0, "last_activity_date": 1570030672, "creation_date": 1570030672, "answer_id": 58204832, "question_id": 58204226, "link": "https://stackoverflow.com/questions/58204226/how-to-define-the-length-number-of-elements-of-an-array-with-n-elements-in-vba/58204832#58204832", "title": "How to define the length (number of elements) of an array with N elements in VBA", "body": "<p>First, since you're using Excel VBA, you don't need to use any special code to calculate the average of an array. You can use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.WorksheetFunction.Average\" rel=\"nofollow noreferrer\">WorksheetFunction.Average</a></p>\n\n<pre><code>Option Explicit\n\nSub Question1()\n    Dim a() As Variant ' has to be a variant array, since that's what the `Array` function returns.\n    Dim i As Integer\n    Dim summ As Integer\n    Dim avg As Double\n\n    a = Array(12, 9, 8, 12, 16, 19, 3, 2, 5, 20)\n\n    avg = Excel.WorksheetFunction.Average(a)\n\n    MsgBox \"Average is: \" &amp; avg\n\nEnd Sub\n</code></pre>\n\n<p>If you want your code to be more portable (i.e. not have to depend on Excel's worksheet functions), then I would recommend splitting your average-calculation into a separate function you can call with any array and any base. To calculate the length of an array, you want to use both the <code>LBound</code> and <code>UBound</code>, as documented <a href=\"https://stackoverflow.com/questions/30574814/get-length-of-array\">here</a>:</p>\n\n<pre><code>n = UBound(a) - LBound(a) + 1\n</code></pre>\n\n<p>Assuming, of course, that <code>a</code> is an array, this will always work, regardless of whether your array is 0-based, 1-based, or something completely different.</p>\n\n<p>Since you're looping over the array to get the sum anyways, you can also use that loop to get the length anyways. Something like this:</p>\n\n<pre><code>Option Explicit\n\n' assuming that arr is an array containing things we can sum, to get an average.\nPublic Function ArrayAverage(arr As Variant) As Double\n    Dim n As Long, sum As Double\n    Dim i As Long\n\n    n = 0: sum = 0\n    For i = LBound(arr) To UBound(arr)\n        n = n + 1\n        sum = sum + arr(i)\n    Next i\n\n    ArrayAverage = sum / n\nEnd Function\n\nPublic Sub Question1()\n    Dim a() As Variant, avg As Double\n\n    a = Array(12, 9, 8, 12, 16, 19, 3, 2, 5, 20)\n    avg = ArrayAverage(a)\n    MsgBox \"Average is: \" &amp; avg\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12154435, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-adyGB7P3758/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcFDdyd78pa-i_a7hcZ0y_99_K2wg/photo.jpg?sz=128", "display_name": "Sevan Ohanyan", "link": "https://stackoverflow.com/users/12154435/sevan-ohanyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1570030672, "creation_date": 1570028622, "last_edit_date": 1570028711, "question_id": 58204226, "link": "https://stackoverflow.com/questions/58204226/how-to-define-the-length-number-of-elements-of-an-array-with-n-elements-in-vba", "title": "How to define the length (number of elements) of an array with N elements in VBA", "body": "<p>I am just starting to learn to use VBA and I am writing a VBA code to find the average of an array with N elements. I am testing it with the array A defined at the start. If it were a MATLAB code I could use N=Length(A); and that would work, is there any function like that for VBA?\nNote: I am using Option Base 1 and I am getting a 'Run-time error '13': Type mismatch</p>\n\n<p>The code is as follows:</p>\n\n<p>Option Base 1</p>\n\n<pre><code>Sub Question1()\n\n    A = [12,9,8,12,16,19,3,2,5,20]\n    i = 1\n    Dim N As Integer\n    N = UBound(A)\n\n    summ = A(1)\n\n    For i = 1 To (N - 1)\n        summ = summ + A(i + 1)\n    Next i\n\n    AVG = summ / N\n\n    MsgBox \"Average is: \" &amp; AVG\n\nEnd Sub\n</code></pre>\n\n<p>Thanks.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ijtZu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ijtZu.jpg\" alt=\"This link is an image showing the code and error message\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570028473, "post_id": 58204082, "comment_id": 102786489, "body": "Maybe it would help if you gave some specific examples (not code, but words). How many cases for each variable? The issue isn&#39;t exactly clear. It may help to create arrays to loop through?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 2, "creation_date": 1570028617, "post_id": 58204082, "comment_id": 102786598, "body": "Whatever the variable <code>Projektfas</code> is it seems to be almost an Index for <code>eColor</code> so instead of a <code>Select Case</code> statement why not just <code>cellColor = eColor(Projektfas)</code>?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1570028812, "post_id": 58204082, "comment_id": 102786716, "body": "Lookup tables and VLookup"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1570033296, "post_id": 58204082, "comment_id": 102789119, "body": "Maybe it would help if you <b>show</b> specific examples (not code, not words, but DATA) of current input and desired output. Also, I see <i>database</i> used. Advise if data originates in an actual database or inside Excel."}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1570036756, "post_id": 58204082, "comment_id": 102790751, "body": "@urdearboy, of course - my apologies. So it&#39;s a hierarchy where the first one is &quot;on-top&quot; of the second one and so on. The 1st variable have 4 cases, the 2nd one have 5 cases, and the 3rd one have 3 cases. The issue is the many lines. I will have about 200 named ranges (down from 800 luckily). Each of these are declared once and assigned a value, also I provide each with a counter to ensure that a cell only get populated once. So this is 4 lines per named range = 800 lines of code for just the declaration!... The array thing is interesting, I&#39;m not quite sure how you would go about that tho?"}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1570036892, "post_id": 58204082, "comment_id": 102790801, "body": "@Tom, that is a great addition. I&#39;ll for sure change that. Thank you!"}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1570037338, "post_id": 58204082, "comment_id": 102791001, "body": "@Parfait, my apologies. The database is just in another excel sheet -  in the same workbook. Also, please see the image below. I hope this explains it. So first you have &quot;Function&quot; which is my &quot;variable 1&quot; - 4 different functions/input data are possible.  Secondly, &quot;Area&quot; or my &quot;variable 2&quot; - can have 4 different values. Third, you see &quot;short&quot; in the upper right bar. This value can be either &quot;short&quot;, &quot;medium&quot;, or &quot;Long&quot; and determines it&#39;s horizontal location. 2 other columns are therefore visible to the right. Lastly based on another variable &quot;project phase&quot; (1-6) a cell filling is assigned"}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570037348, "post_id": 58204082, "comment_id": 102791007, "body": "<a href=\"https://imgur.com/a/OMKb7sx\" rel=\"nofollow noreferrer\">imgur.com/a/OMKb7sx</a> . With the picture in mind, the input data was &quot;Function 1&quot;, &quot;Area 1&quot;, &quot;Short&quot;, &quot;K&quot;, &quot;2&quot;. The &quot;2&quot; being the project phase which determines the color"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570037992, "post_id": 58204232, "comment_id": 102791307, "body": "thank you so much! This will save me so much time - incredibly smooth. The second (case statement for another purpose) would have been about 3 times the size of this one haha, ridiculous! Any chance I also could bother you with the declaration part as well? Like, would you write 800 lines (1 range declaration, 1 assigning the range, 1 counter, giving the counter value of 0) for my about 200 named ranges? For this purpose, each named range will consist of 4 predetermined cells (to be filled if certain conditions are fulfilled)"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570047868, "post_id": 58204232, "comment_id": 102795617, "body": "I&#39;d be glad to help, but I might need to know a bit more about your specific case and will be out of office tommorrow. I would need a code sample of how you would do it, including maybe 2 or 3 of your named ranges. I need to see how they differ from each other etc. I will get back to you on Friday at the latest!"}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570082077, "post_id": 58204232, "comment_id": 102802772, "body": "of course - whenever you have time. I truly appreciate the help! Perhaps this image can shed some light on the intended output <a href=\"https://imgur.com/a/OMKb7sx\" rel=\"nofollow noreferrer\">imgur.com/a/OMKb7sx</a> . It i all about populating the right cells in that &quot;table&quot;. The first column &quot;Function&quot; have 4 different values. The second column &quot;Area&quot; have 4 different values per &quot;Function&quot;. In total, this sums up to 16 potential values for &quot;Area&quot;. Counting from above, &quot;Area 1&quot; can be the same as &quot;Area 10&quot; - meaning the same area can exist in multiple &quot;Functions&quot;. Lastly, each project is either &quot;short&quot;, &quot;medium&quot;, or &quot;long&quot;"}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570082426, "post_id": 58204232, "comment_id": 102802869, "body": "Under each of these (short, medium, long), 16 cells exist to be populated one at a time if certain conditions are fulfilled. In addition, based on an index value from one of the functions mentioned in the Q description, the cell is also to be &quot;colored&quot;"}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570082504, "post_id": 58204232, "comment_id": 102802909, "body": "Please check the Q description (the code part) - I will add a part of my declaration."}, {"owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570083055, "post_id": 58204232, "comment_id": 102803067, "body": "Edit: The naming is not important (the ranges)"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570188224, "post_id": 58204232, "comment_id": 102843985, "body": "I looked at everything you provided but still do not have a grasp of what you&#39;re trying to do. Would you be able to provide a sample workbook with let`s say four of your named ranges along with a sample of your desired output?"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570192779, "post_id": 58204232, "comment_id": 102846046, "body": "Could you just share a file? If not, pictures would be best I think."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "edited": false, "score": 0, "creation_date": 1570194221, "post_id": 58204232, "comment_id": 102846767, "body": "so-throwaway@web.de"}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 1, "last_activity_date": 1570028956, "last_edit_date": 1570028956, "creation_date": 1570028648, "answer_id": 58204232, "question_id": 58204082, "link": "https://stackoverflow.com/questions/58204082/another-way-to-avoid-1000-lines-of-code-declaration-and-an-enormous-case-tree/58204232#58204232", "title": "Another way to avoid 1000 lines of code (declaration and an enormous Case tree)", "body": "<p>There are a few ways this could be improved. For starters, this replaces the whole first <code>Select</code> block:</p>\n\n<pre><code>Dim cellColor As Long\ncellColor = eColor(Projektfas)\n</code></pre>\n\n<p>For that (presumably) huge nested <code>Select</code> block I would suggest you create a separate <code>Sub</code> for each level below the first so you don't have to repeat that entire code everytime. For example (using public variables fo <code>A1_O1KCounter</code> etc.):</p>\n\n<pre><code>Sub Subprocedure(Projektsikt As String)\n\nIf Projektsikt = \"Kort\" Then\n    A1_O1KCounter = A1_O1KCounter + 1\n    A1_O1K.Cells(A1_O1KCounter) = Projektkod\n    A1_O1K.Cells(A1_O1KCounter).Interior.Color = BorderColor\nElseIf Projektsikt = \"Medel\" Then\n    A1_O1MCounter = A1_O1MCounter + 1\n    A1_O1M.Cells(A1_O1MCounter) = Projektkod\n    A1_O1M.Cells(A1_O1MCounter).Interior.Color = BorderColor\nElseIf Projektsikt = \"L\u00e5ng\" Then\n    A1_O1LCounter = A1_O1LCounter + 1\n    A1_O1L.Cells(A1_O1LCounter) = Projektkod\n    A1_O1L.Cells(A1_O1LCounter).Interior.Color = BorderColor\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This procedure can be called everytime you need this particular check to happen. <code>Call Subprocedure(Projektsikt)</code></p>\n\n<p>In general, every repetitive piece of code can be \"outsourced\" to a different procedure to avoid redundancies. Without knowing the entire architecture of your code I presume there is also some potential for optimization when setting up the variables and the general structure.</p>\n"}], "owner": {"reputation": 67, "user_id": 12074048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/617c2d3916561ca69cc5613fa6795d2e?s=128&d=identicon&r=PG&f=1", "display_name": "OmgAllCaps", "link": "https://stackoverflow.com/users/12074048/omgallcaps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 58204232, "answer_count": 1, "score": 1, "last_activity_date": 1570082690, "creation_date": 1570028143, "last_edit_date": 1570082690, "question_id": 58204082, "link": "https://stackoverflow.com/questions/58204082/another-way-to-avoid-1000-lines-of-code-declaration-and-an-enormous-case-tree", "title": "Another way to avoid 1000 lines of code (declaration and an enormous Case tree)", "body": "<p>I'm trying to create a macro that loop through rows of information in a table (1 row = 1 object), where it extracts 5 pieces of information where 3 of these will be used to determine belonging (its rightful place within a range of cells) and the 4th is the name. The 5th variable  determines the cell color (filling).</p>\n\n<p>My first approach was a Case Statement, but it turns out that this will result in quite a big code and I'm wondering if this cannot be solved in a more sophisticated way.\nCurrently, my code looks as follows:</p>\n\n<p>-\nIs there another way of checking these conditions and then adding a name + cell color to a predetermined named range without using this massive structure (and the necessary declaration?</p>\n\n<pre><code>Function 1 'grabs variable 1 from the database. This can have 4 values\nFunction 2 'grabs variable 2 from the database. This can have 5 values\nFunction 3 'grabs variable 3 \"kort, medel or long) from the database\nFunction 4 'grabs the project name or \"Projektkod\" from the database\nFunction 5 'grabs a number between 1-6 that determine \"cellColor\" name\n\nDim A1_O1K As Range '1 of 100s. Same with the counter below\nSet A1_O1K = OverviewUtvecklingSheet.Range(\"A1_O1K\")     'This will be a named range - consisting of several cells\nDim A1_O1KCounter As Integer      ' to keep track on so that 1 cell in 1 range only get populated once\nA1_O1KCounter = 0\n\n    Dim cellColor As Long\n    Select Case Projektfas     \n        Case 1\n             cellColor = eColor(1)\n        Case 2\n             cellColor = eColor(2)\n        Case 3\n             cellColor = eColor(3)\n        Case 4\n             cellColor = eColor(4)\n        Case 5\n             cellColor = eColor(5)\n        Case 6\n             cellColor = eColor(6)               \n    End Select\n\n\n\n    Select Case Variable1\n        Case \"Variable1 A\"\n            Select Case Variable 2                \n                Case Is = \"Variable 2 A\"\n                    If Projektsikt = \"Kort\" Then\n                        A1_O1KCounter = A1_O1KCounter + 1\n                        A1_O1K.Cells(A1_O1KCounter) = Projektkod\n                        A1_O1K.Cells(A1_O1KCounter).Interior.Color = BorderColor                                                     \n                    ElseIf Projektsikt = \"Medel\" Then\n                        A1_O1MCounter = A1_O1MCounter + 1\n                        A1_O1M.Cells(A1_O1MCounter) = Projektkod\n                        A1_O1M.Cells(A1_O1MCounter).Interior.Color = BorderColor                           \n                    ElseIf Projektsikt = \"L\u00e5ng\" Then\n                        A1_O1LCounter = A1_O1LCounter + 1\n                        A1_O1L.Cells(A1_O1LCounter) = Projektkod\n                        A1_O1L.Cells(A1_O1LCounter).Interior.Color = BorderColor                          \n                    End If\n                Case Is = \"Variable 2 B\"\n                    If Projektsikt = \"Kort\" Then                         \n                    ElseIf Projektsikt = \"Medel\" Then                          \n                    ElseIf Projektsikt = \"L\u00e5ng\" Then                            \n                    End If\n                Case Is = \"Variable 2 C\"\n                    ..\n                Case Is = \"Variable 2 D\"\n                    ..                                              \n            End Select                            \n\n     Case \"Variable1 B\"\n            Select Case Variable 2  \n                 Case Is = \"Variable 2 A\"\n                    If Projektsikt = \"Kort\" Then                   \n                    ElseIf Projektsikt = \"Medel\" Then                   \n                    ElseIf Projektsikt = \"L\u00e5ng\" Then\n                    End If\n                Case Is = \"Variable 2 B\"\n                Case Is = \"Variable 2 C\"\n                Case Is = \"Variable 2 D\"\n            End select\n\n\n       Case \"Variable1 C\"\n       Case \"Variable1 D\"\n\n\n       End Select\n    End Select\n\n\nNext\n</code></pre>\n\n<p>'The following is all my declaration for just 1 row (Area 1 in the image). </p>\n\n<pre><code>Public A1_O1K As Range\nPublic A1_O1M As Range\nPublic A1_O1L As Range\nPublic A1_O1KCounter As Integer\nPublic A1_O1MCounter As Integer\nPublic A1_O1LCounter As Integer                                                                   \nSet A1_O1K = OverviewUtvecklingSheet.Range(\"A1_O1K\")\nSet A1_O1M = OverviewUtvecklingSheet.Range(\"A1_O1M\")\nSet A1_O1L = OverviewUtvecklingSheet.Range(\"A1_O1L\")\nA1_O1KCounter = 0\nA1_O1MCounter = 0\nA1_O1LCounter = 0\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1570026313, "post_id": 58203433, "comment_id": 102785188, "body": "<code>=&#39;C:\\whichever filepath\\[whichever file name.xlsx]Sheet1&#39;!$A$1</code>"}, {"owner": {"reputation": 1, "user_id": 9475737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cDSasvHE0ho/AAAAAAAAAAI/AAAAAAAAARE/TsTf32kNLHA/photo.jpg?sz=128", "display_name": "Friedrich Nietzsche", "link": "https://stackoverflow.com/users/9475737/friedrich-nietzsche"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1570027301, "post_id": 58203433, "comment_id": 102785811, "body": "Hello, unfortunately im asking for an alternative solution, because this way its not updating unless the other workbook is open, and i need to work with above 30 work books"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9475737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cDSasvHE0ho/AAAAAAAAAAI/AAAAAAAAARE/TsTf32kNLHA/photo.jpg?sz=128", "display_name": "Friedrich Nietzsche", "link": "https://stackoverflow.com/users/9475737/friedrich-nietzsche"}, "edited": false, "score": 0, "creation_date": 1570027006, "post_id": 58203632, "comment_id": 102785633, "body": "Hello, unfortunately im asking for an alternative solution, because this way its not updating unless the other workbook is open, and i need to work with above 30 work books"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 1, "user_id": 9475737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cDSasvHE0ho/AAAAAAAAAAI/AAAAAAAAARE/TsTf32kNLHA/photo.jpg?sz=128", "display_name": "Friedrich Nietzsche", "link": "https://stackoverflow.com/users/9475737/friedrich-nietzsche"}, "edited": false, "score": 0, "creation_date": 1570027411, "post_id": 58203632, "comment_id": 102785871, "body": "<a href=\"https://support.office.com/en-gb/article/control-when-external-references-links-are-updated-21e995b5-bab1-4328-8ab3-dd357fe0e653\" rel=\"nofollow noreferrer\">please read this</a> to automatically update external links without having to open all files. Excel has got you covered."}, {"owner": {"reputation": 1, "user_id": 9475737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cDSasvHE0ho/AAAAAAAAAAI/AAAAAAAAARE/TsTf32kNLHA/photo.jpg?sz=128", "display_name": "Friedrich Nietzsche", "link": "https://stackoverflow.com/users/9475737/friedrich-nietzsche"}, "edited": false, "score": 0, "creation_date": 1570028464, "post_id": 58203632, "comment_id": 102786484, "body": "That is your opinion i see. however please try it yourself. if you update with the file closed it will not update!"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 1, "user_id": 9475737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cDSasvHE0ho/AAAAAAAAAAI/AAAAAAAAARE/TsTf32kNLHA/photo.jpg?sz=128", "display_name": "Friedrich Nietzsche", "link": "https://stackoverflow.com/users/9475737/friedrich-nietzsche"}, "edited": false, "score": 0, "creation_date": 1570028673, "post_id": 58203632, "comment_id": 102786631, "body": "I have tried this several times before recommending it to you, I test my answers thoroughly, and it works every time. It will either prompt for you to enable automatic update of links, or allow you to click manual update of links. If not, there might be an issue with either the file or your access to it."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 1, "user_id": 9475737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cDSasvHE0ho/AAAAAAAAAAI/AAAAAAAAARE/TsTf32kNLHA/photo.jpg?sz=128", "display_name": "Friedrich Nietzsche", "link": "https://stackoverflow.com/users/9475737/friedrich-nietzsche"}, "edited": false, "score": 0, "creation_date": 1570028949, "post_id": 58203632, "comment_id": 102786804, "body": "Have you checked your references are definitely correct? Also what happens <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.updatelink\" rel=\"nofollow noreferrer\">when you try to force it with vba?</a>"}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1570026540, "creation_date": 1570026540, "answer_id": 58203632, "question_id": 58203433, "link": "https://stackoverflow.com/questions/58203433/excel-referencing-values-from-another-file/58203632#58203632", "title": "Excel - referencing values from another file", "body": "<p>The easiest way to get this done is writing whatever formula you need, while having the file you want to reference open.</p>\n\n<p>When you get to the part where you want to reference the other cell while writing your formula, simply click on that cell in the other workbook. It's path and reference will be automatically added to your formula, and will be updated even if the workbook is closed.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 12119368, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-keVIHk5Yr8s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdMCF_79Q11zyvxq9AVOk-jyVCAXQ/photo.jpg?sz=128", "display_name": "Dom", "link": "https://stackoverflow.com/users/12119368/dom"}, "is_accepted": false, "score": 0, "last_activity_date": 1570028980, "creation_date": 1570028980, "answer_id": 58204325, "question_id": 58203433, "link": "https://stackoverflow.com/questions/58203433/excel-referencing-values-from-another-file/58204325#58204325", "title": "Excel - referencing values from another file", "body": "<p>Here is another question similar to yours that has some ideas on how to mitigate this problem.</p>\n\n<p><a href=\"https://superuser.com/questions/1190809/how-to-update-automatically-and-continuously-cell-values-in-the-master-workbook\">https://superuser.com/questions/1190809/how-to-update-automatically-and-continuously-cell-values-in-the-master-workbook</a></p>\n\n<p>Unfortunately there isn't a super clean solution but the ideas listed at the link should certainly minimize your problems.</p>\n"}], "owner": {"reputation": 1, "user_id": 9475737, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cDSasvHE0ho/AAAAAAAAAAI/AAAAAAAAARE/TsTf32kNLHA/photo.jpg?sz=128", "display_name": "Friedrich Nietzsche", "link": "https://stackoverflow.com/users/9475737/friedrich-nietzsche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570028980, "creation_date": 1570025980, "last_edit_date": 1570028334, "question_id": 58203433, "link": "https://stackoverflow.com/questions/58203433/excel-referencing-values-from-another-file", "title": "Excel - referencing values from another file", "body": "<p>I'd like to use my Excel reports in another Excel file. </p>\n\n<p>I know I can just reference the file, but then it's impossible to use the data without opening the other file as well and I have about 30 files that I need to use.</p>\n\n<p>So I'd like to reference the data from these files in functions, without needing to have the other files open.</p>\n\n<p>Please advise what's the best way to approach this so I can update the values from other Excel files easily.</p>\n\n<p>Suppose I have files: A. and B and I want to calculate in A a formula for <code>=sum(B.#column1)</code>, without the need to have the file open at the time, and with the possibility to refresh data.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570025177, "post_id": 58203191, "comment_id": 102784502, "body": "<code>For Each cell In ws.UsedRange</code> - but there are faster ways to do this than looping over every single cell - also, you need to make sure the cell&#39;s value is numeric before attempting the <code>&gt;=</code> and <code>&lt;=</code>."}, {"owner": {"reputation": 17, "user_id": 11081197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec3cd4e8cf350cd964465463153236b?s=128&d=identicon&r=PG&f=1", "display_name": "Nagendra", "link": "https://stackoverflow.com/users/11081197/nagendra"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570025570, "post_id": 58203191, "comment_id": 102784717, "body": "I am very much new to macros. So, I do not know much about it. The cell values are Dates only, I have got them using conditional formatting. It would be really amazing if you could help me out here. Thanks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570025695, "post_id": 58203191, "comment_id": 102784784, "body": "Another note - don&#39;t you want to exclude <code>&quot;Sheet2&quot;</code> from your loop, i.e. <code>If ws.Name &lt;&gt; &quot;Sheet1&quot; And ws.Name &lt;&gt; &quot;Sheet2&quot; Then</code>?"}, {"owner": {"reputation": 17, "user_id": 11081197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec3cd4e8cf350cd964465463153236b?s=128&d=identicon&r=PG&f=1", "display_name": "Nagendra", "link": "https://stackoverflow.com/users/11081197/nagendra"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570025808, "post_id": 58203191, "comment_id": 102784854, "body": "I will fix that. Thank you."}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "edited": false, "score": 0, "creation_date": 1570032314, "post_id": 58203191, "comment_id": 102788667, "body": "Are you trying to loop through all sheets but Sheet1, or just through  to Sheet2?"}, {"owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "edited": false, "score": 0, "creation_date": 1570032341, "post_id": 58203191, "comment_id": 102788677, "body": "What are you trying to achieve with this: <code>cell.EntireRow.Copy Sheets(&quot;Sheet2&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0)</code> ?"}, {"owner": {"reputation": 17, "user_id": 11081197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec3cd4e8cf350cd964465463153236b?s=128&d=identicon&r=PG&f=1", "display_name": "Nagendra", "link": "https://stackoverflow.com/users/11081197/nagendra"}, "edited": false, "score": 0, "creation_date": 1570039708, "post_id": 58203191, "comment_id": 102792060, "body": "I just want to check if there is any date within two days from the current date, if yes, then copy that entire row from Sheet 1 to Sheet 2."}], "answers": [{"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": true, "score": 1, "last_activity_date": 1570028153, "creation_date": 1570028153, "answer_id": 58204086, "question_id": 58203191, "link": "https://stackoverflow.com/questions/58203191/i-am-trying-to-create-a-macro-to-check-the-whole-excel-sheet-and-find-if-there-a/58204086#58204086", "title": "I am trying to create a macro to check the whole excel sheet and find if there are any dates 2 days after or before from today&#39;s date", "body": "<p>To check the whole Excel sheet is really slow if you have a lot of data.</p>\n\n<p>But you can access directly to cells that contains a value, ignoring blanks and checking if the value fullfills your requirements.</p>\n\n<pre><code>For Each rng In ws.Cells.SpecialCells(xlCellTypeConstants, 1) 'change xlCellTypeConstants to xlCellTypeFormulas if your dates are formulas\n    If rng.Value &gt;= Date And rng.Value &lt;= (Date + 2) Then\n        'do what you want\n\n    End If\nNext rng\n</code></pre>\n\n<p>This code will check all <strong>non blank</strong> cells in the sheet. Also, notice that dates are numeric values, so if any cell contais a number, it will be treated as date even if the number is typed something like <code>12345</code>.</p>\n\n<p>Unless you know for sure that the only numbers in cells are dates, you should add an extra condition in your <code>IF...Then</code>to check if the number is really a date (maybe checking the format of the cell, or whatever).</p>\n\n<p>This code should speed up the process heavily. Your actual loop check <strong>all</strong> cells, so it's time consuming.</p>\n\n<p>Hope you can adapt this to your needs.</p>\n\n<blockquote>\n  <p><strong><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlcelltype\" rel=\"nofollow noreferrer\">XlCellType enumeration (Excel)</a></strong></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 11081197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec3cd4e8cf350cd964465463153236b?s=128&d=identicon&r=PG&f=1", "display_name": "Nagendra", "link": "https://stackoverflow.com/users/11081197/nagendra"}, "edited": false, "score": 0, "creation_date": 1570031126, "post_id": 58204302, "comment_id": 102788064, "body": "This code is working partially for me. It is copying the date to sheet 2 but the problem is I want to copy the entire row if the condition is fulfilled. I am unable to figure that out since I am a newbie."}], "tags": [], "owner": {"reputation": 11, "user_id": 9468809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaaef43076dfd92c18ec9440a4d79f84?s=128&d=identicon&r=PG&f=1", "display_name": "RogueScion", "link": "https://stackoverflow.com/users/9468809/roguescion"}, "is_accepted": false, "score": 0, "last_activity_date": 1570028913, "creation_date": 1570028913, "answer_id": 58204302, "question_id": 58203191, "link": "https://stackoverflow.com/questions/58203191/i-am-trying-to-create-a-macro-to-check-the-whole-excel-sheet-and-find-if-there-a/58204302#58204302", "title": "I am trying to create a macro to check the whole excel sheet and find if there are any dates 2 days after or before from today&#39;s date", "body": "<p>Like one of the other users suggested, you want to verify that you are comparing similar data types.  In the example below, I've added a check to verify that the cell you are comparing is, in fact, a date.  If so, then excel can handle subtracting them.  Additionally, the abs(value) will handle your \"before or after\" 2 day time check.</p>\n\n<p>As other people have said, there are other ways to handle this but this is how I'd approach checking every cell on the sheet using the method you started with.</p>\n\n<pre><code>Dim ws, copySheet As Worksheet\nDim cel, searchRange As Range\n\nSet ws = ActiveWorkbook.Sheets(\"SheetYouWantToCheck\")\nSet searchRange = ws.UsedRange\nSet copySheet = ActiveWorkbook.Sheets(\"SheetYouWantToCopyTo\")\n\nFor Each cel In searchRange.Cells\n    If IsDate(cel.Value) = True Then\n         If Abs(cel.Value - Date) &lt;= 2 Then\n              copySheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Value = cel.Value\n         End If\n    End If\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 169, "user_id": 8832702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4aea17d661267cc5edc6ec36f0ee229e?s=128&d=identicon&r=PG", "display_name": "Dschuli", "link": "https://stackoverflow.com/users/8832702/dschuli"}, "is_accepted": false, "score": 1, "last_activity_date": 1570029980, "creation_date": 1570029980, "answer_id": 58204629, "question_id": 58203191, "link": "https://stackoverflow.com/questions/58203191/i-am-trying-to-create-a-macro-to-check-the-whole-excel-sheet-and-find-if-there-a/58204629#58204629", "title": "I am trying to create a macro to check the whole excel sheet and find if there are any dates 2 days after or before from today&#39;s date", "body": "<p>I suggest you read the <code>usedRange</code> of your sheet(s) into an array (= 1 very fast statement) and then loop over the array. Pls. check my comments re copy target (<code>sheet2</code>) and avoiding copying the same line multiple times.</p>\n\n<pre><code>Private Sub CommandButton5_Click()\n\nDim ws As Worksheet\nDim lastCell As Range\nDim i As Long, j As Long, unusedRow As Long\nDim vals As Variant\nDim targetSheet As Worksheet\n\nSet targetSheet = Sheets(\"Sheet2\")                        'Do you really want to copy to Sheet2? Its one of the sheets you re searching........\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" Then\n        Set lastCell = ws.Cells.Find(What:=\"*\", After:=ws.Cells(1, 1), LookIn:=xlFormulas, LookAt:= _\n                xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, MatchCase:=False)\n        vals = Range(ws.Cells(1, 1), lastCell).Value\n        For i = 2 To UBound(vals, 1)                                'Excludes the first row of any sheet - as in your code\n            For j = 1 To UBound(vals, 2)\n                If IsDate(vals(i, j)) Then\n                    If vals(i, j) &gt;= Date - 2 And vals(i, j) &lt;= Date + 2 Then\n                        unusedRow = targetSheet.Cells.SpecialCells(xlCellTypeLastCell).Offset(1, 0).Row\n                        ws.Rows(i).Copy targetSheet.Cells(unusedRow, 1)\n                        Exit For                        'Assume you dont want to copy the same line more than once - so quit the inner loop after the first find\n                    End If\n                End If\n            Next j\n        Next i\n    End If\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1570033249, "post_id": 58204687, "comment_id": 102789093, "body": "Hi and welcome to stackoverflow. Thank you for contributing your answer. However can you please explain a little what your code does instead of just posting a block of code? It helps the poster learn about it and do it themselves. I also suggest <a href=\"https://stackoverflow.com/questions/38882321/better-way-to-find-last-used-row\">reading this</a> for reference."}, {"owner": {"reputation": 1, "user_id": 6872464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41117ee6c30182ae5aadd8e0b829a771?s=128&d=identicon&r=PG&f=1", "display_name": "rplst8", "link": "https://stackoverflow.com/users/6872464/rplst8"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1570194274, "post_id": 58204687, "comment_id": 102846796, "body": "@Plutian, I added a description."}], "tags": [], "owner": {"reputation": 1, "user_id": 6872464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41117ee6c30182ae5aadd8e0b829a771?s=128&d=identicon&r=PG&f=1", "display_name": "rplst8", "link": "https://stackoverflow.com/users/6872464/rplst8"}, "is_accepted": false, "score": 0, "last_activity_date": 1570194241, "last_edit_date": 1570194241, "creation_date": 1570030171, "answer_id": 58204687, "question_id": 58203191, "link": "https://stackoverflow.com/questions/58203191/i-am-trying-to-create-a-macro-to-check-the-whole-excel-sheet-and-find-if-there-a/58204687#58204687", "title": "I am trying to create a macro to check the whole excel sheet and find if there are any dates 2 days after or before from today&#39;s date", "body": "<p>To iterate over all of the cells that contain a date, first we can use the special cell type xCellTypeLastCell to find the last cell populated with data.</p>\n\n<p>Then, we loop over all the cells from the starting position of A1 (i.e. 1,1) until the last cell we found earlier.</p>\n\n<p>If we find a cell with the criteria defined by the OP, we copy it to another worksheet.</p>\n\n<pre><code>Private Sub CommandButton5_Click()\n\nDim ws As Worksheet, xlastRow As Integer, xlastCol As Integer\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" Then\n        xlastRow = ws.Cells.SpecialCells(xlCellTypeLastCell).Row\n        xlastCol = ws.Cells.SpecialCells(xlCellTypeLastCell).Column\n\n        Dim cell As Range\n        For Each cell In Range(ws.Cells(1, 1), ws.Cells(xlastRow, xlastCol))\n            If cell.Value &gt;= Date - 2 And cell.Value &lt;= Date + 2 Then\n\n                Dim destSheet As Worksheet\n                Set destSheet = Worksheets(\"Sheet2\")\n                cell.Copy destSheet.Range(cell.Address)\n\n            End If\n        Next cell\n    End If\nNext ws\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 893, "user_id": 10794555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0D8LRxW70DQ/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-icioZDBlm6V-nHzFzMNQ2LTv2Nmg/mo/photo.jpg?sz=128", "display_name": "Ama", "link": "https://stackoverflow.com/users/10794555/ama"}, "is_accepted": false, "score": 0, "last_activity_date": 1570032157, "last_edit_date": 1570032157, "creation_date": 1570031514, "answer_id": 58205057, "question_id": 58203191, "link": "https://stackoverflow.com/questions/58203191/i-am-trying-to-create-a-macro-to-check-the-whole-excel-sheet-and-find-if-there-a/58205057#58205057", "title": "I am trying to create a macro to check the whole excel sheet and find if there are any dates 2 days after or before from today&#39;s date", "body": "<p>There are very good suggestions here, in particular for general cases where complex calculations or iterations are to be made over large sets of data:</p>\n\n<ul>\n<li>Passing your data into an array instead of looping through each cell: with Office, what is <em>time-expensive</em> are call instantiations, and this reduces the calls from VBA to Excel to 1 large call rather than plenty of small calls.</li>\n<li>Relying on a filter such as <code>Cells.SpecialCells(xlCellTypeConstants, 1)</code> also reduces the amount of cells to be processed.</li>\n</ul>\n\n<p>But I believe that for your very specific case, you could do much simpler (and arguably efficient), by relying on <code>.Find()</code>, which will return the set of cells matching a given pattern (<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.find\" rel=\"nofollow noreferrer\">see documentation</a>).</p>\n\n<p>Simply search for cells whose values are equal to the 5 possibles dates: Today -2 through to Today +2 :</p>\n\n<pre><code>Private Sub CommandButton5_Click()\n\n    Dim FoundCell as Range\n    Dim ws As Worksheet\n\n    For Each ws In Worksheets\n\n        If ws.Name &lt;&gt; \"Sheet1\" Then\n\n            For i = -2 to 2 \n\n                FoundCell = ws.UsedRange.Find(Date(Now) + i,lookin:=xlValues)\n                If Not FoundCell Is Nothing then\n                    Something(FoundCell) 'Do Something on the first cell\n                    FoundCell = .FindNext(FoundCell) ' Go to the next cell found\n                End If\n\n            Next i\n\n        End If\n\n    Next ws   \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11081197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec3cd4e8cf350cd964465463153236b?s=128&d=identicon&r=PG&f=1", "display_name": "Nagendra", "link": "https://stackoverflow.com/users/11081197/nagendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58204086, "answer_count": 5, "score": 0, "last_activity_date": 1570194241, "creation_date": 1570025108, "last_edit_date": 1570030179, "question_id": 58203191, "link": "https://stackoverflow.com/questions/58203191/i-am-trying-to-create-a-macro-to-check-the-whole-excel-sheet-and-find-if-there-a", "title": "I am trying to create a macro to check the whole excel sheet and find if there are any dates 2 days after or before from today&#39;s date", "body": "<pre><code>Private Sub CommandButton5_Click()\n\nDim ws As Worksheet, lRow As Integer\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Sheet1\" Then\n        lRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        For Each cell In Range(\"A2:A\" &amp; lRow)\n            If cell.Value &gt;= Date - 2 And cell.Value &lt;= Date + 2 Then\n                cell.EntireRow.Copy Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n            End If\n        Next cell\n    End If\nNext ws\nEnd Sub\n</code></pre>\n\n<p>This code is searching in just 1st column, I want it to search in the whole sheet. How do I do that ?\nAny suggestions ?</p>\n"}, {"tags": ["excel", "vba", "ms-access", "userform"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570029723, "post_id": 58202712, "comment_id": 102787278, "body": "Have you stepped through to confirm that your recordset is actually getting data? Do any of your message box prompts fire? Note that you&#39;re only going to update 1 record with the RS even if it does return data."}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570032108, "post_id": 58202712, "comment_id": 102788574, "body": "Hey Mike, the list box displays the entire record, which I can choose from. When I choose it, it puts the details in the record in the textboxes provided for them. Using the same textboxes, I should be able to append/edit the data. That&#39;s where I am at right now."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570033662, "post_id": 58202712, "comment_id": 102789313, "body": "Per your comment to the answer below, have you been receiving the error &quot;no records in recordset&quot; all along? Have you ensured that <code>varr</code> is being populated correctly by stepping through the code and checking the value either in the immediate window or the watches window?"}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570034077, "post_id": 58202712, "comment_id": 102789517, "body": "Using the watch window, it says <code>out of context</code> under value while Empty under Type."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570034286, "post_id": 58202712, "comment_id": 102789616, "body": "Its suggested to use <code>Me.Arec36.Value</code> as opposed to <code>Me.Arec36</code> as you&#39;re specifically defining what to put into the variable as opposed to relying on default properties.  Not sure but my guess is the variable isn&#39;t transferring correctly.  Try stepping through the code to the <code>varr = Me.Arec36</code> and in the immediate window use <code>? Me.Arec36</code> / <code>? Me.Arec36.Value</code> and see if it returns a value."}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570034694, "post_id": 58202712, "comment_id": 102789791, "body": "added a watch for the <code>varr</code> when it changes. Stopped at the <code>cnn.open</code> line. It displays the actual value that should be equal to the table field entry."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570034893, "post_id": 58202712, "comment_id": 102789895, "body": "Ah, is varr value a string or a number?  If its a string, your sql is going to be formatted and interpreted as <code>&quot;SELECT * FROM tbl_raw WHERE Child_Ref = String&quot;</code>.  Where if its a text value it should be <code>&quot;SELECT * FROM tbl_Raw WHERE Child_Ref = &#39;STRING&#39;&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570035288, "post_id": 58202712, "comment_id": 102790074, "body": "I did this, <code>&quot;SELECT * FROM tbl_raw WHERE Child_Ref = varr&quot;,</code> and I got <code>No value given for one or more required parameters</code>"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570035369, "post_id": 58202712, "comment_id": 102790108, "body": "Change it to <code>&quot;SELECT * FROM tbl_raw WHERE Child_Ref = &#39;&quot; &amp; varr &amp; &quot;&#39;&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570035596, "post_id": 58202712, "comment_id": 102790218, "body": "I got a type mismatch error"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570035809, "post_id": 58202712, "comment_id": 102790319, "body": "What is an example value for <code>varr</code> and what is the table column type for <code>Child_ref</code> in <code>tbl_Raw</code>?"}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570036008, "post_id": 58202712, "comment_id": 102790414, "body": "Example value is <code>427926-100219-1-1</code> and the column type is <code>Short Text</code>"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570036221, "post_id": 58202712, "comment_id": 102790509, "body": "Alright, try updating to this - &quot;SELECT * FROM tbl_raw WHERE Child_Ref = &quot;&quot;&quot; &amp; varr &amp; &quot;&quot;&quot;&quot; - The single quotes may be causing an issue. Not sure how you weren&#39;t getting an error before when supplying a string value without any quotes in the first place though."}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570036536, "post_id": 58202712, "comment_id": 102790647, "body": "I tried to determine where the error actually stops and I saw it here.<code>rs(Cells(1, i).Value) = Me.Controls(&quot;Arec&quot; &amp; i).Value</code> our SQL statement seems to be working."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570037166, "post_id": 58202712, "comment_id": 102790928, "body": "Are the row 1 values you are trying to reference the same as the field names inside the database? Also, might be worth changing <code>Cells</code> to <code>Sheets(&quot;mySheetName&quot;).Cells(1,i).Value</code>. Also, reading your code, these &quot;headers&quot; would be starting at &quot;V1&quot; and continuing from there. Does that sound right?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570038519, "post_id": 58202712, "comment_id": 102791517, "body": "My guess is, whatever value in your <code>.Cells(1,i) </code> does not reference a string value or the value contained within does not match the headers of the database table.  Testing your code works fine on my end. Might be worth breaking out your loop and instead of looping through 12 columns, just use RS!FieldNameHere = Me.ArecFieldNumber.Value followed by RS.Update to ensure that its updating."}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570044023, "post_id": 58202712, "comment_id": 102793980, "body": "@mike the <code>RS!Fieldnamehere</code> worked!. The last error that I am getting is that when I put a date in the <code>Me.ArecFieldNumber.Value</code> works, however, if I try to put <code>blank</code> in the <code>Me.ArecFieldNumber.Value</code>, it says <code>type mismatch</code>. How do we go about this last item? You&#39;ve been a great help."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570045472, "post_id": 58202712, "comment_id": 102794637, "body": "Try blocking that one in an if statement. You can do something different, but for testing its probably easier to do <code>If isdate(Me.ArecDateField) Then RS!DateField = Me.ArecDateField Else RS!DateField = Null End If</code>. Not sure if that will work, can&#39;t test it at the moment."}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570045952, "post_id": 58202712, "comment_id": 102794870, "body": "I like the idea.. I&#39;ll test it tomorrow once I come in. Just got out of the office."}, {"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1570103993, "post_id": 58202712, "comment_id": 102813152, "body": "@mike the <code>if statement</code> worked. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "edited": false, "score": 0, "creation_date": 1570032303, "post_id": 58204688, "comment_id": 102788665, "body": "I&#39;m still getting the same message/error that I put in <b>There are no records in the recordset!</b>"}, {"owner": {"reputation": 1, "user_id": 5855347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08706ed0d677c314186d30209189ad9e?s=128&d=identicon&r=PG&f=1", "display_name": "lo__on", "link": "https://stackoverflow.com/users/5855347/lo-on"}, "reply_to_user": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "edited": false, "score": 0, "creation_date": 1570053776, "post_id": 58204688, "comment_id": 102797407, "body": "It could be <b>varr = Me.Arec36</b> instead of <b>varr = Me.Arec36.value</b>. I can&#39;t recall if that is necessary for userform controls."}], "tags": [], "owner": {"reputation": 1, "user_id": 5855347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08706ed0d677c314186d30209189ad9e?s=128&d=identicon&r=PG&f=1", "display_name": "lo__on", "link": "https://stackoverflow.com/users/5855347/lo-on"}, "is_accepted": false, "score": 0, "last_activity_date": 1570030178, "creation_date": 1570030178, "answer_id": 58204688, "question_id": 58202712, "link": "https://stackoverflow.com/questions/58202712/records-dont-appear-in-rs-when-updating-records-using-a-userform-commandbutton/58204688#58204688", "title": "records don&#39;t appear in RS when updating records using a userform commandbutton", "body": "<p>I think removing the <strong>Options:=adCmdText</strong> might be sufficient. The procedure isn't implemented as a Command.</p>\n\n<p>To add rows you need to have <strong>.AddNew</strong> before your update.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11825942, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2eVDtUa3hCw/AAAAAAAAAAI/AAAAAAAAAEU/291MApAUPZw/photo.jpg?sz=128", "display_name": "HvyLeadMark", "link": "https://stackoverflow.com/users/11825942/hvyleadmark"}, "edited": false, "score": 0, "creation_date": 1570047622, "post_id": 58206509, "comment_id": 102795526, "body": "Blank is not a valid date. Your Database is expecting a date.  It may be required on the table, or will not accept a &quot;&quot;, because it is a value.  Try inserting NULL instead of blank or &quot;&quot;."}], "tags": [], "owner": {"reputation": 1, "user_id": 11825942, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2eVDtUa3hCw/AAAAAAAAAAI/AAAAAAAAAEU/291MApAUPZw/photo.jpg?sz=128", "display_name": "HvyLeadMark", "link": "https://stackoverflow.com/users/11825942/hvyleadmark"}, "is_accepted": false, "score": 0, "last_activity_date": 1570037601, "creation_date": 1570037601, "answer_id": 58206509, "question_id": 58202712, "link": "https://stackoverflow.com/questions/58202712/records-dont-appear-in-rs-when-updating-records-using-a-userform-commandbutton/58206509#58206509", "title": "records don&#39;t appear in RS when updating records using a userform commandbutton", "body": "<p>RS is an index of the Access DB connection.  DB's do not have cells.  If you wanted to Write to RS, just reference the index FIELD as in RS(FIELDS(1, i).Value).  But, your query is also a select statement.  You cannot update a record set with a select statement, unless you are inserting into another table.  In order to update the record, you need to issue an UPDATE on the INDEX!  I hope this helps out.</p>\n"}], "owner": {"reputation": 1, "user_id": 12154041, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDjRr5_n2dLeIzovYZX49d7YPGJPl9k40LtK2mQ=k-s128", "display_name": "James Ian Penaranda", "link": "https://stackoverflow.com/users/12154041/james-ian-penaranda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570037601, "creation_date": 1570023435, "last_edit_date": 1570030715, "question_id": 58202712, "link": "https://stackoverflow.com/questions/58202712/records-dont-appear-in-rs-when-updating-records-using-a-userform-commandbutton", "title": "records don&#39;t appear in RS when updating records using a userform commandbutton", "body": "<p>I'm trying to append/update a certain record in the access db using a userform in Excel. I had the table imported from access DB to a list box, then when rows are double clicked, it copies the entries to text boxes which does it without fail. But when I change the values in the boxes, supposedly, it should update/append the record in the DB when the append button is clicked. However, it doesn't.</p>\n\n<pre><code>Private Sub cmdAppend_Click()\n    'Declaring the necessary variables.\n    Dim cnn As ADODB.Connection 'dim the ADO collection class\n    Dim rs As ADODB.Recordset 'dim the ADO recordset class\n    Dim i As Integer\n    Dim X As Integer\n    Dim varr As String\n\n    'add error handling\n    On Error GoTo errHandler:\n\n    If Me.Arec36.Value = \"\" Then\n        MsgBox \"You must enter Child Case.\", _\n        vbOKOnly Or vbInformation, \"Insufficent data\"\n        Exit Sub\n    End If\n\n    Set cnn = New ADODB.Connection ' Initialise the collection class variable\n\n    varr = Me.Arec36\n\n\n    'Connection class is equipped with a \u2014method\u2014 named Open\n    '\u2014-4 aguments\u2014- ConnectionString, UserID, Password, Options\n    'ConnectionString formula\u2014-Key1=Value1;Key2=Value2;Key_n=Value_n;\n    cnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; \"\\\\10.4.1.62\\RiskTeam\\Dispute Core Team Original\\Chimp Change\\Analysis\\Database\\ChimpDB.accdb\"\n\n    Set rs = New ADODB.Recordset 'assign memory to the recordset\n\n    'Create the SQL statement to retrieve the data from table.\n    rs.Open \"SELECT * FROM tbl_raw \" &amp; _\n    \"WHERE Child_Ref = \" &amp; varr, ActiveConnection:=cnn, _\n    CursorType:=adOpenDynamic, LockType:=adLockOptimistic, _\n    Options:=adCmdText\n\n    If rs.EOF And rs.BOF Then\n        'Close the recordet and the connection.\n        rs.Close\n        cnn.Close\n\n        'clear memory\n        Set rs = Nothing\n        Set cnn = Nothing\n\n        'Enable the screen.\n        Application.ScreenUpdating = True\n\n        'In case of an empty recordset display an error.\n        MsgBox \"There are no records in the recordset!\", vbCritical, \"No Records\"\n\n        Exit Sub\n    End If\n\n    With rs\n        For i = 22 To 35\n            rs(Cells(1, i).Value) = Me.Controls(\"Arec\" &amp; i).Value\n            Next i\n        rs.Update\n    End With\n\n    'clear the userform values\n    For X = 22 To 35\n        Me.Controls(\"Arec\" &amp; X).Value = \"\"\n        Me.Arec36.Value = \"\"\n        Me.Arec37.Value = \"\"\n    Next\n\n    'Close the recordset and the connection.\n    rs.Close\n    cnn.Close\n\n    'clear memory\n    Set rs = Nothing\n    Set cnn = Nothing\n\n    'refresh the listbox\n    ImportUserForm\n\n    'Enable the screen.\n    Application.ScreenUpdating = True\n\n    Me.lstDataAccess.RowSource = \"DataAccess\"\n\n    'Inform the user that the macro was executed successfully.\n    MsgBox \"Congratulation the data has been appended\", vbInformation, \"Append successful\"\n\n    'error handler\n    On Error GoTo 0\n\n    Exit Sub\n\nerrHandler:\n    'clear memory\n    Set rs = Nothing\n    Set cnn = Nothing\n\n    MsgBox \"Error \" &amp; Err.Number &amp; \" (\" &amp; Err.Description &amp; \") in procedure Append_Data\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "match"], "answers": [{"comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1570023006, "post_id": 58202558, "comment_id": 102783114, "body": "lastRow = Worksheets(&quot;PLANNER_ONGOING_DISPLAY_SHEET&quot;).cells(rows.count&zwnj;&#8203;,3).End(xlUp).Row"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1570023038, "post_id": 58202558, "comment_id": 102783133, "body": "@HarassedDad You&#39;re right, I just noticed it as well. It is corrected now."}, {"owner": {"reputation": 25, "user_id": 12153954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66da19460dc2eb7b9735e077dae5c8b4?s=128&d=identicon&r=PG&f=1", "display_name": "adamjamesb", "link": "https://stackoverflow.com/users/12153954/adamjamesb"}, "edited": false, "score": 0, "creation_date": 1570028306, "post_id": 58202558, "comment_id": 102786378, "body": "Thank you so much!  Follow up - if i wanted to match against another cell as opposed to the text &quot;test 73&quot; is there an easy way to do that? For example, cell E2 on &quot;Sheet 2&quot;?"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570028362, "post_id": 58202558, "comment_id": 102786421, "body": "Replace this <code>x = &quot;test 73&quot;</code> with <code>x = Sheets(&quot;Sheet2&quot;).Cells(2, 5).Value</code>. If this solved your problem please consider upvoting and accepting the answer so others might find it more easily."}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 0, "last_activity_date": 1570023017, "last_edit_date": 1570023017, "creation_date": 1570022920, "answer_id": 58202558, "question_id": 58202395, "link": "https://stackoverflow.com/questions/58202395/cycle-through-rows-to-match-two-cells-on-separate-worksheets/58202558#58202558", "title": "Cycle through rows to match two cells on separate worksheets", "body": "<p>You could take an easier approach, while also <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoiding <code>.Activate</code> and <code>.Select</code></a>:</p>\n\n<pre><code>Sub Test3()\n  Dim x As String, y As String\n  Dim found As Boolean\n  Dim i As Integer, lastRow As Long\n\n  lastRow = Worksheets(\"PLANNER_ONGOING_DISPLAY_SHEET\").Cells(Rows.Count, 3).End(xlUp).Row\n\n  x = \"test 73\"\n\n  For i = 4 To lastRow\n    'If you need to compare it to a cell in sheet2 you can also set the value of x here\n    y = Worksheets(\"PLANNER_ONGOING_DISPLAY_SHEET\").Cells(i, 3).Value2\n    If y = x Then\n        ' Do action here, example:\n        MsgBox \"Value found in cell \" &amp; \"C\" &amp; i\n    End If\n\n  Next i\n\nEnd Sub\n</code></pre>\n\n<p>This will go through all the used cells in column <code>C</code> and compare them to x. If a cell matches, its row number is returned via a <code>MsgBox</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 12153954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66da19460dc2eb7b9735e077dae5c8b4?s=128&d=identicon&r=PG&f=1", "display_name": "adamjamesb", "link": "https://stackoverflow.com/users/12153954/adamjamesb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58202558, "answer_count": 1, "score": 0, "last_activity_date": 1584308069, "creation_date": 1570022332, "last_edit_date": 1584308069, "question_id": 58202395, "link": "https://stackoverflow.com/questions/58202395/cycle-through-rows-to-match-two-cells-on-separate-worksheets", "title": "Cycle through rows to match two cells on separate worksheets", "body": "<p>I'm looking to cycle through each row in a column on worksheet 1, to match two cells (a cell in column C from worksheet 1 with a cell in column E from worksheet 2).</p>\n\n<p>If there is a match, I want to perform an action to an adjacent cell (I will work this bit out later) and then resume the loop until there are no more matches.</p>\n\n<p>So far I have the following:</p>\n\n<pre><code>Sub Test3()\n    Dim x As String\n    Dim found As Boolean\n    ' Select first line of data.\n    Worksheets(\"PLANNER_ONGOING_DISPLAY_SHEET\").Activate\n    Range(\"C4\").Select\n    ' Set search variable value.\n    x = \"test 73\"\n    ' Set Boolean variable \"found\" to false.\n    found = False\n    ' Set Do loop to stop at empty cell.\n    Do Until IsEmpty(ActiveCell)\n        ' Check active cell for search value.\n        If ActiveCell.Value = x Then\n            found = True\n            Exit Do\n        End If\n        ' Step down 1 row from present location.\n        ActiveCell.Offset(1, 0).Select\n    Loop\n    ' Check for found.\n    If found = True Then\n        MsgBox \"Value found in cell \" &amp; ActiveCell.Address\n    Else\n        MsgBox \"Value not found\"\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570023057, "post_id": 58202139, "comment_id": 102783149, "body": "What does the main VBA code do? Is it possibly triggering the change event?"}, {"owner": {"reputation": 23, "user_id": 12020316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b1013bc2629a5db14ed77d9c07f4ef?s=128&d=identicon&r=PG", "display_name": "Rere", "link": "https://stackoverflow.com/users/12020316/rere"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570023399, "post_id": 58202139, "comment_id": 102783388, "body": "The main code will create arrays of each columns, analyse and transform it and then export it in the worksheet data for pivot chart. Is the code: ThisWorkbook.RefreshAll function is to run the main and refresh the pivot chart?"}], "owner": {"reputation": 23, "user_id": 12020316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b1013bc2629a5db14ed77d9c07f4ef?s=128&d=identicon&r=PG", "display_name": "Rere", "link": "https://stackoverflow.com/users/12020316/rere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577504137, "creation_date": 1570021511, "last_edit_date": 1577504137, "question_id": 58202139, "link": "https://stackoverflow.com/questions/58202139/sequence-of-actions-after-data-connection-refresh", "title": "Sequence of actions after data connection refresh", "body": "<p>I have a data connection to an SQL database that refreshes every 15 min.</p>\n\n<p>I need a sequence of actions after the data refresh.</p>\n\n<p>In order:</p>\n\n<ul>\n<li>run main VBA code</li>\n<li>refresh pivot chart</li>\n<li>save file</li>\n</ul>\n\n<p>I tried on the worksheet of the data:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = False\n    ThisWorkbook.RefreshAll\n    Application.EnableEvents = True\n\n    If Not Intersect(Target, Me.Range(\"A2:J2\")) Is Nothing Then\n        ThisWorkbook.Save\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The main VBA code is in Module1. It crashes or gets stuck in a loop.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570021516, "post_id": 58201959, "comment_id": 102782158, "body": "Considering that declaration are ok (you are not declaring any variable), in your conditional, if there is a single CSV, you are adding and if there are more, you are copying again. If <code>fso.fileexists(filepath)</code> is true it is not against <code>fso.fileexists(filepath1) And fso.fileexists(filepath2)</code>, so maybe you are copying twice."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570021785, "post_id": 58201959, "comment_id": 102782309, "body": "How many items have you got in your CSV files?"}, {"owner": {"reputation": 1, "user_id": 12153679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207cb9b2953d00912c8cfa5940baad58?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/12153679/dean"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1571937382, "post_id": 58201959, "comment_id": 103413490, "body": "I had like a 1000 files"}], "answers": [{"tags": [], "owner": {"reputation": 674, "user_id": 11758142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8eCxl.jpg?s=128&g=1", "display_name": "EddiGordo", "link": "https://stackoverflow.com/users/11758142/eddigordo"}, "is_accepted": false, "score": 0, "last_activity_date": 1570021526, "creation_date": 1570021526, "answer_id": 58202145, "question_id": 58201959, "link": "https://stackoverflow.com/questions/58201959/for-loop-error-looping-through-rows-on-macro-while-extracting-data-from-csv-file/58202145#58202145", "title": "For loop error looping through rows on macro while extracting data from CSV files and putting selected data in a summary worksheet", "body": "<p>You should work with a database like Access or SQL Server to do heavy calculation stuff like that. \nExcel is good to show tables or graphs based on the result of queries providing by such software but is not adapted for processing that amount of data, ie 669 * 3018 = 2019042 iterations.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12153679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207cb9b2953d00912c8cfa5940baad58?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/12153679/dean"}, "is_accepted": true, "score": 0, "last_activity_date": 1571937333, "creation_date": 1571937333, "answer_id": 58546233, "question_id": 58201959, "link": "https://stackoverflow.com/questions/58201959/for-loop-error-looping-through-rows-on-macro-while-extracting-data-from-csv-file/58546233#58546233", "title": "For loop error looping through rows on macro while extracting data from CSV files and putting selected data in a summary worksheet", "body": "<p>I just ended up using python pandas dataframes and merged them (similar to SQL join) so I didn't have use a loop at all.</p>\n"}], "owner": {"reputation": 1, "user_id": 12153679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/207cb9b2953d00912c8cfa5940baad58?s=128&d=identicon&r=PG&f=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/12153679/dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 58546233, "answer_count": 2, "score": 0, "last_activity_date": 1571937333, "creation_date": 1570020902, "question_id": 58201959, "link": "https://stackoverflow.com/questions/58201959/for-loop-error-looping-through-rows-on-macro-while-extracting-data-from-csv-file", "title": "For loop error looping through rows on macro while extracting data from CSV files and putting selected data in a summary worksheet", "body": "<p>I am a supply chain analyst trying to summarize daily inventory CSV files on a separate spread sheet. On this spreadsheet, columns are different dates and there is 669 columns. Rows are certain items I want to check the inventory of and there is 3019 rows.</p>\n\n<p>I have a macro with two functions: one opens the csv files and the other gets the values matching the item numbers that are on my spreadsheet. I have found these functions on stack overflow. I loop through the columns/dates with a while loop that runs until there is no more dates. I loop through the rows/items with a for loop that runs from 2 to 3019. There is also an if statement inside the for loop. This checks to see if there is a single inventory data or multiple inventory entries for first and second warehouses. In the latter case sums up the inventory levels of both warehouses for the same items.I also shared the functions that I've used in the for loop. </p>\n\n<pre><code>Sub SummaryFile ()\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\nc = 2\nWhile Not (IsEmpty(Cells(1, c).Value))\n\n    For r = 2 To 3019\n        If fso.fileexists(filepath) Then\n            arr = CsvToArray(filepath)\n            Cells(r, c).Value = TestLookup(arr, Cells(r, 1), 2, 3)\n        ElseIf fso.fileexists(filepath1) And fso.fileexists(filepath2) Then\n            arr1 = CsvToArray(filepath1)\n            arr2 = CsvToArray(filepath2)\n            Cells(r, c).Value = TestLookup(arr1, Cells(r, 1), 2, 3) + TestLookup(arr2, Cells(r, 1), 2, 3)\n        End If\n    Next r\nWend\nEnd Sub\n\n\n\nFunction TestLookup(arr, val, lookincol As Integer, returnfromcol As Integer)\nDim r\nr = Application.Match(val, Application.Index(arr, 0, lookincol), 0)\nIf Not IsError(r) Then\n    TestLookup = arr(r, returnfromcol)\nElse\n    TestLookup = Null 'or some other \"error\" value\nEnd If\nEnd Function\n\n\nFunction CsvToArray(filepath) As Variant\nDim wb As Workbook\nApplication.ScreenUpdating = False\nSet wb = Workbooks.Open(filepath)\nCsvToArray = wb.Sheets(1).Range(\"A1\").CurrentRegion.Value\nwb.Close False\nEnd Function\n</code></pre>\n\n<p>I just want to get the inventory numbers for each of the items on each of the dates. If the item is not on the inventory list for that day then the \"TestLookup\" function returns a Null. When I try it on small number of rows and columns to test it it works, but when I try it for all the dates and items I need it for. It either finishes running the macro after a long time and it had only ran the macro on the first column and none of the other columns are populated or it gives an error saying it ran out of memory. Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 1, "creation_date": 1570019123, "post_id": 58201446, "comment_id": 102780837, "body": "Probably in your Regional settings in your computer system, got some issues with that."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570019135, "post_id": 58201446, "comment_id": 102780846, "body": "Does using <code>.Value2</code> change anything?"}, {"owner": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570019230, "post_id": 58201446, "comment_id": 102780899, "body": "@M.Schalk No it doesn&#39;t change anything"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570019314, "post_id": 58201446, "comment_id": 102780951, "body": "@SometingNew Keep <code>ComboBox2.Value</code> as it is, use <code>.Value2</code> for the cell"}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1570019394, "post_id": 58201446, "comment_id": 102780981, "body": "how do you set the combobox values?"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1570019409, "post_id": 58201446, "comment_id": 102780987, "body": "You can also try <code>Worksheets(&quot;Worksheet&quot;).Cells(2, 8).Text</code> instead. This might help your cause."}, {"owner": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1570019503, "post_id": 58201446, "comment_id": 102781032, "body": "@Dean it gives me error: Impossibile set &quot;Text&quot; for the property Range"}, {"owner": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "reply_to_user": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1570019535, "post_id": 58201446, "comment_id": 102781050, "body": "@SNicolaou I fill it from an array, but when filling it I already give him a format  <code>arr(i)= Format(myDay + i, &quot;dd&#47;mm&#47;yyyy&quot;)</code>"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570020318, "post_id": 58201446, "comment_id": 102781499, "body": "You could try something like this: <code>Worksheets(&quot;Worksheet&quot;).Cells(2, 8).Value = CStr(ComboBox2.Value)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1570020328, "post_id": 58201781, "comment_id": 102781508, "body": "obviously, change/rename accordingly :-)"}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": true, "score": 3, "last_activity_date": 1570020652, "last_edit_date": 1570020652, "creation_date": 1570020305, "answer_id": 58201781, "question_id": 58201446, "link": "https://stackoverflow.com/questions/58201446/excel-vba-date-changes-automatically/58201781#58201781", "title": "Excel VBA date changes automatically", "body": "<p>i would convert to a date the combobox value. tried (replicated) your issue and this fix worked for me. basically, use CDate to set the cell value.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\n  Dim v As Variant\n  Dim d As Date\n\n  v = Me.ComboBox1.Value\n  d = CDate(v)\n\n  Sheet3.Range(\"A1\").Value = d\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58201781, "answer_count": 1, "score": 0, "last_activity_date": 1570020652, "creation_date": 1570018966, "question_id": 58201446, "link": "https://stackoverflow.com/questions/58201446/excel-vba-date-changes-automatically", "title": "Excel VBA date changes automatically", "body": "<p>I have this strange problem. When I use this function </p>\n\n<pre><code>Worksheets(\"Worksheet\").Cells(2, 8).Value = ComboBox2.Value\n</code></pre>\n\n<p>Where my <strong>ComboBox2.Value = 02/01/2019</strong> I got the following output in Cells(2,8) --> <strong>01/02/2019</strong></p>\n\n<p>But in my cell properties I have already set that I want \"dd/mm/yyyy\" </p>\n\n<p>Where is the problem?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21, "user_id": 11868555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c097d94adf2418256222c236c97562?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/11868555/lukasz"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570017408, "post_id": 58200911, "comment_id": 102779896, "body": "BigBen formula should be &quot;=IF(H5-F5&lt;=0;0;H5-F5)&quot; of course with actual row number instead of 5"}, {"owner": {"reputation": 21, "user_id": 11868555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c097d94adf2418256222c236c97562?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/11868555/lukasz"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1570017675, "post_id": 58200911, "comment_id": 102780031, "body": "oh,sorrry. Run-time error 1004 / Application-defined or object defined error"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 1, "creation_date": 1570017726, "post_id": 58200911, "comment_id": 102780069, "body": "Which line produces the error? Did you initialize and declare <code>ws</code> correctly?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11868555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c097d94adf2418256222c236c97562?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/11868555/lukasz"}, "edited": false, "score": 0, "creation_date": 1570017945, "post_id": 58201086, "comment_id": 102780191, "body": "Yep, that&#39;s right. I wouldn&#39;t track that by myself. Thank you Gary&#39;s Student.  Do you know if it&#39;s connected to local set up of excel? And should I in other functions change is as well from &quot;;&quot; to &quot; &#39; &quot; ?"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 21, "user_id": 11868555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c097d94adf2418256222c236c97562?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/11868555/lukasz"}, "edited": false, "score": 0, "creation_date": 1570018129, "post_id": 58201086, "comment_id": 102780284, "body": "@Lukasz  Using <code>FornulaLocal</code> make it easier to copy formulas from the worksheet to VBA code."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1570017667, "creation_date": 1570017667, "answer_id": 58201086, "question_id": 58200911, "link": "https://stackoverflow.com/questions/58200911/formula-brings-error-with-punctuation-marks-vba/58201086#58201086", "title": ".Formula brings error with punctuation marks vba", "body": "<p>Replace:</p>\n\n<pre><code>ws.Range(\"J\" &amp; i).Formula = \"=IF(H\" &amp; i &amp; \"-F\" &amp; i &amp; \"&lt;=0;0;H\" &amp; i &amp; \"-F\" &amp; i &amp; \")\"\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>ws.Range(\"J\" &amp; i).Formula = \"=IF(H\" &amp; i &amp; \"-F\" &amp; i &amp; \"&lt;=0,0,H\" &amp; i &amp; \"-F\" &amp; i &amp; \")\"\n</code></pre>\n\n<p>If you want to make it easy, see:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.formulalocal\" rel=\"nofollow noreferrer\">Reference</a></p>\n"}], "owner": {"reputation": 21, "user_id": 11868555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c097d94adf2418256222c236c97562?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz", "link": "https://stackoverflow.com/users/11868555/lukasz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "closed_date": 1570018909, "answer_count": 1, "score": 2, "last_activity_date": 1570017667, "creation_date": 1570016992, "last_edit_date": 1570017292, "question_id": 58200911, "link": "https://stackoverflow.com/questions/58200911/formula-brings-error-with-punctuation-marks-vba", "closed_reason": "Duplicate", "title": ".Formula brings error with punctuation marks vba", "body": "<p>I have a problem with adding formula to a cell through VBA.\nEverything is ok till the moment when I add punctuation mark like \"(\" to it.\nWhat I'm doing wrong here?\nI've tried already using chr() function and it doesn't work.</p>\n\n<pre><code> Do Until ws.Cells(i, 1) = \"\"\n If ws.Cells(i, 7).Value &lt;&gt; \"\" Then\n    If ws.Cells(i, 7).Value &lt;&gt; 0 Then\n        ws.Cells(i, 7) = 200\n        ws.Cells(i, 8).Value = 0\n        ws.Cells(i, 9).Value = 0\n        ws.Range(\"J\" &amp; i).Formula = \"=IF(H\" &amp; i &amp; \"-F\" &amp; i &amp; \"&lt;=0;0;H\" &amp; i &amp; \"-F\" &amp; i &amp; \")\"\n</code></pre>\n\n<p>Regards,\nUkalo</p>\n"}, {"tags": ["excel", "vba", "logic"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12153346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a97e659ad5574fe9207676b165c54d2?s=128&d=identicon&r=PG&f=1", "display_name": "Digitaldamo", "link": "https://stackoverflow.com/users/12153346/digitaldamo"}, "edited": false, "score": 0, "creation_date": 1570097249, "post_id": 58200535, "comment_id": 102809767, "body": "Thank you CLR, that nailed it."}], "tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 1, "last_activity_date": 1570015573, "creation_date": 1570015573, "answer_id": 58200535, "question_id": 58200315, "link": "https://stackoverflow.com/questions/58200315/office-vba-failure-in-logic-criteria-for-a-do-until-loop/58200535#58200535", "title": "Office VBA - Failure in logic criteria for a Do Until Loop", "body": "<p>Change your criteria to:</p>\n\n<pre><code>Do Until Cells(r, c).Value &lt;&gt; \"Sick\" And Cells(4, c).Value &lt;&gt; \"Sat\" And Cells(4, c).Value &lt;&gt; \"Sun\"\n</code></pre>\n\n<p>You can't use <code>Or</code> combined with <code>Not</code> (in this case <code>&lt;&gt;</code>) that way. The value can never be\n<strong>Not(Sat) OR Not(Sun)</strong> at the same time. But it can be <strong>Not(Sat) AND Not(Sun)</strong> - which is what you're after.</p>\n"}], "owner": {"reputation": 3, "user_id": 12153346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a97e659ad5574fe9207676b165c54d2?s=128&d=identicon&r=PG&f=1", "display_name": "Digitaldamo", "link": "https://stackoverflow.com/users/12153346/digitaldamo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 58200535, "answer_count": 1, "score": 0, "last_activity_date": 1570015573, "creation_date": 1570014661, "question_id": 58200315, "link": "https://stackoverflow.com/questions/58200315/office-vba-failure-in-logic-criteria-for-a-do-until-loop", "title": "Office VBA - Failure in logic criteria for a Do Until Loop", "body": "<p>So, I am writing a VBA macro that will count the number of instances where by an employee is absent through sickness. An instance of sickness is defined as a period of contiguous workdays where the employee is recorded as being sick (so this obviously excludes weekends). You can view my source data <a href=\"https://drive.google.com/open?id=1OU3vS--TZV6ej8R3VEu3S4RBQpTwUtdub1rI6vus1-4\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>For some reason at run-time the logic is failing on this line:\n<code>Do Until Cells(r, c).Value &lt;&gt; \"Sick\" And (Cells(4, c).Value &lt;&gt; \"Sat\" Or Cells(4, c).Value &lt;&gt; Sun\")</code> and is therefore counting each Monday-sickness as a new instance. For example, Sheet \"Rota\" Row 10 has two instances of sick, but the macro will report four instances.</p>\n\n<p>Any help would be much appreciated.</p>\n\n<pre><code>Option Explicit\n\nSub AbsenceInstances()\n\n    Dim dtToday, dtStart As Date\n    Dim r, c, dblTodayCol, dblStartCol, dblInstances, dblAgentRow As Double\n    Dim rngFindRow As Range\n\n    Sheets(\"Rota\").Select\n\n'    dtToday = Int(Now())\n    dtToday = \"31/12/2019\"\n'    dtStart = dtToday - 364\n    dtStart = \"31/12/2018\"\n\n    'define upper &amp; lower boundaries of measurement area\n    On Error GoTo NotFound\n        dblTodayCol = WorksheetFunction.Match(CLng(CDate(dtToday)), Sheets(\"Rota\").Range(\"5:5\"), 0)\n        dblStartCol = WorksheetFunction.Match(CLng(CDate(dtStart)), Sheets(\"Rota\").Range(\"5:5\"), 0)\n    On Error GoTo 0\n    GoTo ContinueSub\n\nNotFound:\n    MsgBox \"Please check that your data incorporates information back to \" &amp; dtStart &amp; \", otherwise this function will not work.\", vbCritical\n    Exit Sub\n\nContinueSub:\n\n    'loop through employee list to determine number of absences\n    For r = 6 To 34\n        For c = dblStartCol To dblTodayCol\n            If Cells(r, c).Value = \"Sick\" Then\n                ' an instance of sick is defined as contiguous days absence excluding weekends\n                Do Until Cells(r, c).Value &lt;&gt; \"Sick\" And (Cells(4, c).Value &lt;&gt; \"Sat\" Or Cells(4, c).Value &lt;&gt; \"Sun\")\n                    If Cells(4, c).Value = \"Sat\" Then c = c + 1\n                    c = c + 1\n                Loop\n                dblInstances = dblInstances + 1\n            End If\n        Next c\n\n    ' identify employee's data-row to output result\n    Set rngFindRow = Sheets(\"Bradford scale\").Range(\"A:A\").Find(What:=Sheets(\"Rota\").Range(\"B\" &amp; r).Value, _\n                         After:=Range(\"A1\"), LookIn:=xlValues, _\n                         LookAt:=xlWhole, SearchOrder:=xlByRows, MatchCase:=False)\n\n    If Not rngFindRow Is Nothing Then\n        dblAgentRow = rngFindRow.Row\n        Set rngFindRow = Nothing\n    End If\n\n    ' output result for employee\n    Sheets(\"Bradford Scale\").Cells(dblAgentRow, 5).Value = dblInstances\n\n    ' reset for next employee\n    dblInstances = 0\n\n    Next r\n\n    Sheets(\"Bradford Scale\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "is_accepted": false, "score": 2, "last_activity_date": 1570014406, "creation_date": 1570014406, "answer_id": 58200231, "question_id": 58200045, "link": "https://stackoverflow.com/questions/58200045/how-to-saveas-pdf/58200231#58200231", "title": "How to SaveAs pdf?", "body": "<p>You have a parenthesis in the wrong spot.  Try this:</p>\n\n<pre><code>Format(Now(), \"yyyy.mm.dd\") &amp; \".pdf\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 4, "last_activity_date": 1570014939, "creation_date": 1570014939, "answer_id": 58200377, "question_id": 58200045, "link": "https://stackoverflow.com/questions/58200045/how-to-saveas-pdf/58200377#58200377", "title": "How to SaveAs pdf?", "body": "<p>You're asking Excel to format your filename like so:</p>\n\n<pre><code>Format(Now(), \"yyyy.mm.dd\" &amp; \".pdf\")\n</code></pre>\n\n<p>which is, to Excel, exactly the same as:</p>\n\n<pre><code>Format(Now(), \"yyyy.mm.dd.pdf\")\n</code></pre>\n\n<p>Because <code>.pdf</code> contains a <code>d</code>, it is replacing it with the day number (2).</p>\n\n<pre><code>Format(Now(), \"yyyy.mm.dd.pdf\")\n                       ^^  ^\n</code></pre>\n\n<p>Rearrange your formatting element to just the <code>yyyy.mm.dd</code> and then add on your file extension separately:</p>\n\n<pre><code>sSaveFolder = PdfPath &amp; \"\\\" &amp; Format(Now(), \"yyyy.mm.dd\") &amp; \".pdf\"\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58200377, "answer_count": 2, "score": 1, "last_activity_date": 1582157710, "creation_date": 1570013669, "last_edit_date": 1582157710, "question_id": 58200045, "link": "https://stackoverflow.com/questions/58200045/how-to-saveas-pdf", "title": "How to SaveAs pdf?", "body": "<p>Trying to save to pdf.</p>\n\n<pre><code>Sub fill2()\n    TemplateName = ThisWorkbook.path &amp; \"\\DOC\\test.docx\"\n    PdfPath = ThisWorkbook.path &amp; \"\\OutPut\"\n    sSaveFolder = PdfPath &amp; \"\\\" &amp; Format(Now(), \"yyyy.mm.dd\" &amp; \".pdf\")\n\n    Set WA = CreateObject(\"Word.Application\")\n    Set WD = WA.Documents.Add(TemplateName)\n    WA.Visible = False\n\n    WD.SaveAs sSaveFolder, 17\n    WD.Close False: Set WD = Nothing\n    WA.Quit False: Set WA = Nothing\nEnd Sub\n</code></pre>\n\n<p>The file saves with the extension p2f rather than pdf (changing letter&nbsp;d to number&nbsp;2).</p>\n\n<p><a href=\"https://i.stack.imgur.com/2nrbN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2nrbN.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "user-interface"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 2, "creation_date": 1570012666, "post_id": 58199774, "comment_id": 102777621, "body": "<code>CommandButton1.Left = (Me.InsideWidth - CommandButton1.Width) &#47; 2</code>"}, {"owner": {"reputation": 1, "user_id": 3268022, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007071490826/picture?type=large", "display_name": "LimeSoft", "link": "https://stackoverflow.com/users/3268022/limesoft"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1570015080, "post_id": 58199774, "comment_id": 102778706, "body": "@Siddharth Rout thank you! I debugged it and the inside with is 237,75. This tip helped me!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1570015537, "post_id": 58199774, "comment_id": 102778920, "body": "BTW you know you can center the button in the form in design time? VBA Menu: <code>Format|Center In Form</code>"}, {"owner": {"reputation": 1, "user_id": 3268022, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007071490826/picture?type=large", "display_name": "LimeSoft", "link": "https://stackoverflow.com/users/3268022/limesoft"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1570016022, "post_id": 58199774, "comment_id": 102779174, "body": "Yes, I know this. But usually I calculate it. If you design per hand, you get easily into weird numbers. I had also could use this function, but I just wanted to know why it didn&#39;t work for me :D"}], "owner": {"reputation": 1, "user_id": 3268022, "user_type": "registered", "profile_image": "https://graph.facebook.com/100007071490826/picture?type=large", "display_name": "LimeSoft", "link": "https://stackoverflow.com/users/3268022/limesoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570012403, "creation_date": 1570012403, "question_id": 58199774, "link": "https://stackoverflow.com/questions/58199774/vba-form-cant-get-any-button-input-in-center-with-math", "title": "VBA Form: can&#39;t get any button,input in center with math", "body": "<p>I'm trying to center a button in my form.</p>\n\n<p>Width form: 250</p>\n\n<p>With button: 200</p>\n\n<p>Tried left: 25</p>\n\n<p>So... the button should be centered. But it isn't. (don't have enough reputation to post a screenshot)</p>\n\n<p>I tried to center it relative to a full-with text. It put the left value of 20. But why?</p>\n"}, {"tags": ["excel", "vba", "range", "cell"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570012065, "post_id": 58199668, "comment_id": 102777361, "body": "There is a way, but you need to provide more information on where you want to check for it. Depending on inside which <code>For</code> loop you want the check to happen."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1570012068, "post_id": 58199668, "comment_id": 102777363, "body": "<i>Yes</i> there is a way. It will depend on your <code>Target</code> range. Is it n x 1, 1 x n, or n x n? This will determine how you check the &quot;previous&quot; cell, ie. <code>.Offset(-1,0)</code> for row and <code>.Offset(0,-1)</code> for column..."}, {"owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570012247, "post_id": 58199668, "comment_id": 102777450, "body": "@M.Schalk I want to do in For Each cell In rngCalendario, and the if statement under it would be something like :   If UCase(cell.Value) Like &quot;<i>&quot; &amp; risorsa &amp; &quot;</i>&quot; And prevCell.value &lt;&gt; cell.value then   do stuff   prevCell = cell"}], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 2, "last_activity_date": 1570012557, "creation_date": 1570012557, "answer_id": 58199812, "question_id": 58199668, "link": "https://stackoverflow.com/questions/58199668/is-there-a-way-vba-to-check-in-a-for-each-loop-if-the-looping-cell-is-to-the/58199812#58199812", "title": "Is there a way [VBA] to check in a for each loop if the looping cell is = to the previous?", "body": "<p>Here you go:</p>\n\n<pre><code>    If Not Intersect(Target, rng) Is Nothing Then\n\n    Dim prevCell As Variant 'Choose applicable type, probably String\n    risorsa = Cells(Target.Row, 3).Value\n\n    For Each cell In rngCalendario\n      If UCase(cell.Value) Like \"*\" &amp; risorsa &amp; \"*\" And prevCell = cell.Value Then 'current cell value is compared to previous cell\n        For i = cell.Row To RigaNomeProgetto Step -1\n          If Cells(i, 2).Value = 0 And cell.Row &lt; ultimaRiga Then\n            NomeProgetto = Cells(i, 1).Value\n            Exit For\n          End If\n        Next i\n        Output = LTrim(Output) &amp; NomeProgetto &amp; Chr(10) &amp; Chr(10) &amp; Chr(10)\n      End If\n      prevCell = cell.Value 'prevCell is assigned the value of the current cell\n    Next cell\n    Cells(2, 4) = Output\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 6256899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bcec0625bd826edcfefbe93369ec85f?s=128&d=identicon&r=PG&f=1", "display_name": "Lomoo", "link": "https://stackoverflow.com/users/6256899/lomoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 58199812, "answer_count": 1, "score": 1, "last_activity_date": 1570012557, "creation_date": 1570011829, "question_id": 58199668, "link": "https://stackoverflow.com/questions/58199668/is-there-a-way-vba-to-check-in-a-for-each-loop-if-the-looping-cell-is-to-the", "title": "Is there a way [VBA] to check in a for each loop if the looping cell is = to the previous?", "body": "<p>What i want is to look if the cell.value that increments, after the loop, is equals to itself but of precedent cicle.</p>\n\n<pre><code>If Not Intersect(Target, rng) Is Nothing Then\n  risorsa = Cells(Target.ROW, 3).Value\n  For Each cell In rngCalendario \n    If UCase(cell.Value) Like \"*\" &amp; risorsa &amp; \"*\" Then '\n      For i = cell.ROW To RigaNomeProgetto Step -1 \n        If Cells(i, 2).Value = 0 And cell.ROW &lt; ultimaRiga Then \n          NomeProgetto = Cells(i, 1).Value \n          Exit For\n        End If\n      Next i\n      Output = LTrim(Output) &amp; NomeProgetto &amp; Chr(10) &amp; Chr(10) &amp; Chr(10)  \n    End If\n  Next cell\n  Cells(2, 4) = Output\nEnd if\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter", "formatting", "autofilter"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570012817, "post_id": 58199518, "comment_id": 102777683, "body": "Check that one: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/reference/&hellip;</a>"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1570020749, "post_id": 58199518, "comment_id": 102781740, "body": "Probably comma (&quot;,&quot;) disappeared, because it comma is set as digit grouping symbol in your regional settings."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1570032521, "post_id": 58199518, "comment_id": 102788750, "body": "@Teamothy, comma is my decimal delimiter while point is the grouping symbol. However playing around with that didn&#39;t help either. Thanks for the suggestion though. I&#39;m now at the point where I know there must be a floating point error as <code>1:00</code> is actually <code>0,0416666666666667</code>. Putting <code>43467.0416666666666667</code> as criteria actually showed up as <code>3-1-2019 1:00</code> in the filter, however no result is shown...."}], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1570090984, "creation_date": 1570011201, "last_edit_date": 1570090984, "question_id": 58199518, "link": "https://stackoverflow.com/questions/58199518/autofilter-datetime-values-local-decimal-point-issue", "title": "AutoFilter DateTime values - Local decimal point issue", "body": "<p><strong><em>Background</em></strong></p>\n\n<p>While I was trying to solve a <a href=\"https://stackoverflow.com/q/58196880/9758194\">problem</a> for another user I ran into, seemingly, a local issue.</p>\n\n<p>Imagine some very simple sample data (being true date-time values):</p>\n\n<pre><code>| DateTimeVals   |\n|----------------|\n| 1-1-2019 01:00 |\n| 2-1-2019 01:00 |\n| 3-1-2019 01:00 |\n| 4-1-2019 01:00 |\n| 5-1-2019 01:00 |\n</code></pre>\n\n<p>It doesn't need to be more complicated to show you the issue at hand. Let's imagine we would want to filter on <code>3-1-2019 01:00</code> (3rd of Jan). Simply using:</p>\n\n<pre><code>Range(\"A1\").AutoFilter Field:=1, Criteria1:=\"3-1-2019 01:00\"\n</code></pre>\n\n<p>Works just fine, A hardcoded string variable does work, but I thought about something more dynamic filtering on the true numeric values as below.  </p>\n\n<hr>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Sub test()\n\nDim SearchNum As Double: SearchNum = DateValue(\"3-1-2019\") + TimeValue(\"1:00\")\nRange(\"A1\").AutoFilter Field:=1, Criteria1:=\"&gt;=\" &amp; SearchNum, Operator:=xlAnd, Criteria2:=\"&lt;=\" &amp; SearchNum\n\nEnd Sub\n</code></pre>\n\n<p>Keeping an eye out on this variable through <code>WATCHES</code> shows the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hRmAi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hRmAi.png\" alt=\"enter image description here\"></a></p>\n\n<p>But the filter applied shows 0 results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/m3LZ6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/m3LZ6.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here is the odd part, the filter applied tells me that I apparently filtered between the full value without a decimal comma.</p>\n\n<p><a href=\"https://i.stack.imgur.com/O9FrU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/O9FrU.png\" alt=\"enter image description here\"></a></p>\n\n<p>Manually adding the comma to this number made the number turn into a formatted date/time value. But no result is shown.</p>\n\n<hr>\n\n<p><strong><em>Workaround</em></strong></p>\n\n<p>I've found a way around it using the following code:</p>\n\n<pre><code>Sub test()\n\nDim str As String: str = DateSerial(2019, 1, 3) &amp; \" \" &amp; Format(TimeSerial(1, 0, 0), \"hh:mm\")\nRange(\"A1\").AutoFilter Field:=1, Criteria1:=str\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em>Question</em></strong></p>\n\n<p>While I did read about how MS might have neglected the <code>AutoFilter</code>, I'm thinking my issue described must have something to do with local settings. How would <code>VBA</code> insert the criteria as a whole number? And how to avoid it? Any other way around than my workaround (or a helper column)?</p>\n\n<hr>\n\n<p><strong><em>Note:</em></strong></p>\n\n<ul>\n<li>Changing the long number by manually inserting a comma changed the value in the correct date/time formatted value.</li>\n<li>Working with a <code>TimeValue</code> is prone to floating point errors, as <code>1:00</code> has much more decimals then the shown ones. Inserting the full numeric value in a string variable solved the disappearance of the comma and showed a formatted date/time value, however no result is shown.</li>\n</ul>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 2, "creation_date": 1570011091, "post_id": 58199491, "comment_id": 102776935, "body": "We will not write your code from scratch for you. What have you tried so far?"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1570011546, "post_id": 58199491, "comment_id": 102777141, "body": "This will be easy to do, create a foreach loop through your range, test if value is same as cell above, and delete row if true, skip if false."}, {"owner": {"reputation": 11, "user_id": 12039446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cae925a9817afc4ce328b0b44d090bbb?s=128&d=identicon&r=PG&f=1", "display_name": "W L", "link": "https://stackoverflow.com/users/12039446/w-l"}, "edited": false, "score": 0, "creation_date": 1570066085, "post_id": 58199491, "comment_id": 102799762, "body": "Hi I have tried using a for loop to delete the row if the value is not the same as the top... however as I have 100 000 rows, excel always ends up crashing."}], "owner": {"reputation": 11, "user_id": 12039446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cae925a9817afc4ce328b0b44d090bbb?s=128&d=identicon&r=PG&f=1", "display_name": "W L", "link": "https://stackoverflow.com/users/12039446/w-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570016742, "creation_date": 1570011038, "last_edit_date": 1570016742, "question_id": 58199491, "link": "https://stackoverflow.com/questions/58199491/vba-delete-entire-rows-if-value-is-duplicated-for-the-rows-below-until-the-next", "title": "VBA: Delete entire rows if value is duplicated for the rows below until the next different value is found and repear", "body": "<p>I have a sheet that has a column with true false values:</p>\n\n<p>T\nT\nT\nF\nF\nT\nT\nT\nF\nF\n.\n.\n.</p>\n\n<p>I want to delete rows based on the repeated values in this column such that the remaining rows will be summarised as below :</p>\n\n<p>T\nF\nT\nF\n.\n.\n.</p>\n\n<p>It will take the value i.e TRUE in the first row and iterate through each row to check for the next row that has a different value . </p>\n\n<p>Since Row 1 is TRUE, and Row 4 is false, rows 2 to 3 will be deleted. </p>\n\n<p>Next,it will continue by taking Row 3 value (which is FALSE) and check for the next different value (i.e.TRUE) and delete all the rows in between that. </p>\n\n<p>The above process is to continue until the last row in the sheet.</p>\n\n<p>Many thanks and appreciation for your help!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570015755, "post_id": 58199276, "comment_id": 102779032, "body": "As far as I checked... there is a non closed With statement in the code attached, so some of the functions are not working. Check it."}, {"owner": {"reputation": 341, "user_id": 4740702, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40d55fd0ed031bd42979c5a06cabcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "together", "link": "https://stackoverflow.com/users/4740702/together"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570119222, "post_id": 58199276, "comment_id": 102821593, "body": "The original one does not include"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570168231, "post_id": 58199276, "comment_id": 102835289, "body": "There are 12 &quot;with&quot; statements and 11 &quot;end with&quot; statements, so that code can not work without an error or unexpected result..."}, {"owner": {"reputation": 341, "user_id": 4740702, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40d55fd0ed031bd42979c5a06cabcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "together", "link": "https://stackoverflow.com/users/4740702/together"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570399233, "post_id": 58199276, "comment_id": 102891586, "body": "I counted few times, there  are 12 with and 12 &quot;end with&quot;, I have no idea which &quot;end with&quot; you missed. Again, this macro works well with single xlsm file, only not working in the addin XLAM file, if there is one &quot;End With&quot; missed, it should not be working in the xlsm files as well. Could you help to count them again?"}], "owner": {"reputation": 341, "user_id": 4740702, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40d55fd0ed031bd42979c5a06cabcfc3?s=128&d=identicon&r=PG&f=1", "display_name": "together", "link": "https://stackoverflow.com/users/4740702/together"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "closed_date": 1570382990, "answer_count": 0, "score": 0, "last_activity_date": 1570515894, "creation_date": 1570010279, "last_edit_date": 1570515894, "question_id": 58199276, "link": "https://stackoverflow.com/questions/58199276/correct-codes-format-to-set-the-chart-coordinates-title-font-and-added-text-in", "closed_reason": "Duplicate", "title": "Correct codes format to set the chart coordinates, title, font and added text in excel macro", "body": "<p>Wrote a macro to draw line with markers plot with excel, it works well in a single macro xlsm file. But when I tried to convert it to a excel addin (xlam file) , it got a lot of bugs.  All the bugs are related to the format of both X and Y coordinates, position, font type and size of chart title, and position, font type and sizeof added text.  Not sure what is the reason, need to know the correct format of them.  Any debug suggestions or help, really appreciated.  Please see my full macro codes as the following. Thanks.\nThe error message is<a href=\"https://i.stack.imgur.com/YZD3K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YZD3K.png\" alt=\"enter image description here\"></a><a href=\"https://i.stack.imgur.com/Usgd6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Usgd6.png\" alt=\"enter image description here\"></a>\nBut you checked with excel, the plot was drawn without chart title and the add text (that I want) and the format of coordinate was not that I tried to set. Again all these errors only happen with the xlam file, the macro works well with xlms fie.</p>\n\n<pre><code>Sub data_plot()\n\n\nsh_rows = ActiveWorkbook.ActiveSheet.Range(\"B65535\").End(xlUp).Row\n\n\nFor i = 1 To sh_rows\n\n    If ActiveSheet.Cells(i, 1).Value &lt; 0.000001 Then\n\n        ActiveSheet.Cells(i, 1).Value = 1000000000# * ActiveSheet.Cells(i, 1).Value\n\n    End If\nNext i\n\n\nii = sh_rows\n\n\nc_name = \"chart1\"\n\nOn Error GoTo err:\nActiveWorkbook.ActiveSheet.ChartObjects(c_name).Delete\nerr:\nSet ch = ActiveWorkbook.ActiveSheet.ChartObjects.Add(330, 120, 480, 270)  'set graph position and size\nch.Name = c_name\n\n\nWith ch.Chart\n\n    For iii = 1 To 2\n\n        .SeriesCollection.NewSeries\n        .SeriesCollection(iii).Values = _\n              Range(ActiveWorkbook.ActiveSheet.Cells(1, iii + 1), \n              ActiveWorkbook.ActiveSheet.Cells(ii, iii + 1))\n        .SeriesCollection(iii).XValues = _\n              Range(ActiveWorkbook.ActiveSheet.Cells(1, 1), \n              ActiveWorkbook.ActiveSheet.Cells(ii, 1))\n\n\n        .SeriesCollection(iii).ChartType = xlLineMarkers\n\n\n    Next iii\n\n    .SeriesCollection(1).Name = \"[110]\"\n    .SeriesCollection(1).MarkerStyle = 2\n    .SeriesCollection(1).MarkerSize = 12\n    .SeriesCollection(1).MarkerForegroundColor = RGB(255, 0, 0)\n    .SeriesCollection(1).MarkerBackgroundColor = RGB(255, 0, 0)\n    .SeriesCollection(1).Format.Fill.ForeColor.RGB = RGB(255, 0, 0)\n\n\n\n    .SeriesCollection(2).Name = \"[001]\"\n    .SeriesCollection(2).MarkerStyle = 2\n    .SeriesCollection(2).MarkerSize = 12\n    .SeriesCollection(2).MarkerForegroundColor = RGB(96, 96, 96)\n    .SeriesCollection(2).MarkerBackgroundColor = RGB(96, 96, 96)\n    .SeriesCollection(2).Format.Fill.ForeColor.RGB = RGB(96, 96, 96)\n\n\n    With .Legend\n        .IncludeInLayout = False\n        .Position = xlLegendPositionRight\n        .AutoScaleFont = False\n        .Font.Size = 14\n        .Top = 25\n        .Left = 392\n        .Width = 72\n        .Height = 40\n    End With\n\n    With .ChartArea.Fill\n        .Visible = msoTrue\n        .ForeColor.SchemeColor = 33\n       '.Transparency = 0\n        .Solid\n    End With\n\n\n    With .SeriesCollection(1).Format.Line\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(255, 0, 0)  'red\n        .Transparency = 0\n    End With\n\n    With .SeriesCollection(2).Format.Line\n        .Visible = msoTrue\n        .ForeColor.RGB = RGB(96, 96, 96) 'grey\n        .Transparency = 0\n    End With\n\n    .HasTitle = True\n\n    With .ChartTitle\n        .Text = ActiveWorkbook.ActiveSheet.Cells(5, 8)\n        .Left = 358\n        .Top = 236\n\n        With .Font\n            .Name = \"Tahoma\"\n            .Size = 10\n        End With\n    End With\n\n\n    With .Axes(xlCategory)\n        .HasTitle = True\n        .AxisTitle.Text = \"Position(nm)\"  'X-axis title\n        .TickLabels.Font.Size = 10 'X-axis coordinate number size\n        .AxisTitle.Font.Size = 14  'X-axis title word font size\n        .TickMarkSpacing = 3\n        .TickLabelSpacing = 5\n        .TickLabels.NumberFormatLocal = \"#,##0._);[red](#,##0.)\"\n        .TickLabels.NumberFormatLocal = \"#,##0_);[red](#,##0)\"\n        .TickLabels.NumberFormatLocal = \"0_);[red](0.)\"\n    End With\n\n    With .Axes(xlValue)\n\n       .HasTitle = True\n       .AxisTitle.Text = \"Strain\"   'Y-aixs title\n       .AxisTitle.Font.Size = 14  'y-axis title word font size\n       'Minimum value of Y axis\n       .Axes(xlValue).MinimumScale = -0.005\n       .Axes(xlValue).TickLabels.NumberFormatLocal = \"0.0%\"\n\n    End With\n\nEnd With\n\n\n\nDim thechartobj As ChartObject\nSet thechartobj = ActiveWorkbook.ActiveSheet.ChartObjects(ch.Name)\nDim thechart As Chart    \nSet thechart = thechartobj.Chart\nDim thetextbox As Shape\nSet thetextbox = thechart.Shapes.AddTextbox(msoTextOrientationHorizontal, 688, 372, 122, 20)\nWith thetextbox.TextFrame.Characters\n    .Text = ActiveSheet.Cells(6, 8)\n    With .Font\n        .Name = \"tahoma\"\n        .Size = 10\n        .Bold = msoTrue\n    End With\nEnd With\n\nSet ch.Name = ActiveWorkbook.ActiveSheet.Cells(5, 8)\n\nWith ch.Chart\n    .Export Filename:=ThisWorkbook.Path &amp; \"\\\\\" &amp; ch.Name &amp; \".jpg\"\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 8059863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7914875626d2fcf09dcdf08f09b2d0?s=128&d=identicon&r=PG&f=1", "display_name": "mrrclb48z", "link": "https://stackoverflow.com/users/8059863/mrrclb48z"}, "edited": false, "score": 0, "creation_date": 1570193757, "post_id": 58199012, "comment_id": 102846536, "body": "filter condition start  --- off  OK"}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 2, "last_activity_date": 1570009857, "last_edit_date": 1570009857, "creation_date": 1570009281, "answer_id": 58199012, "question_id": 58198945, "link": "https://stackoverflow.com/questions/58198945/excelvba-currentvaluecu-filter/58199012#58199012", "title": "ExcelVBA_CurrentValuecu_Filter?", "body": "<p>Try this code:</p>\n\n<pre><code>Sub ExcelVBA_CurrentValuecu_Filter()\n    With ThisWorkbook.ActiveSheet\n        .Range(.Cells(1, ActiveCell.Column), .Cells(.Rows.Count, ActiveCell.Column).End(xlUp)). _\n        AutoFilter Field:=1, Criteria1:=ActiveCell.Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>The statement <code>.Cells(.Rows.Count, ActiveCell.Column).End(xlUp)</code> will find the last cell in your column that has data in it. I used a <code>With</code> block to properly qualify all the ranges you're using in your code. That's why there's a dot <code>.</code> in front of <code>.Cells</code>. This is the same as always writing <code>ActiveSheet.Cells</code>.</p>\n"}], "owner": {"reputation": 213, "user_id": 8059863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7914875626d2fcf09dcdf08f09b2d0?s=128&d=identicon&r=PG&f=1", "display_name": "mrrclb48z", "link": "https://stackoverflow.com/users/8059863/mrrclb48z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 58199012, "answer_count": 1, "score": 0, "last_activity_date": 1570014017, "creation_date": 1570009021, "last_edit_date": 1570014017, "question_id": 58198945, "link": "https://stackoverflow.com/questions/58198945/excelvba-currentvaluecu-filter", "title": "ExcelVBA_CurrentValuecu_Filter?", "body": "<p>Thank you in advance and sorry for the bad english!</p>\n\n<p>I want</p>\n\n<p>fix100-->current column &amp; last row nummber?</p>\n\n<p>Cells(100, ActiveCell.Column))--->Cells(???, ActiveCell.Column))</p>\n\n<pre><code>Sub ExcelVBA_CurrentValuecu_Filter()\n    ActiveSheet.Range(Cells(1, ActiveCell.Column), Cells(100, ActiveCell.Column)).AutoFilter Field:=1, Criteria1:=ActiveCell.Value\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570008796, "post_id": 58198829, "comment_id": 102775777, "body": "Could you provide an example of the desired output? It&#39;s unclear to me how the multiple occurences of a product in <code>Sheet1</code> and <code>Sheet2</code> are supposed to be matched. Does the pattern in <code>Sheet1</code> differ from what you showed us? If it&#39;s a repeating pattern you could simply copy the data in <code>Sheet2</code> by hand, that would be the quickest way."}, {"owner": {"reputation": 1, "user_id": 12152665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226b60533bc39d2cb7ff1cf5e87b6c0f?s=128&d=identicon&r=PG&f=1", "display_name": "dmfn94", "link": "https://stackoverflow.com/users/12152665/dmfn94"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570036564, "post_id": 58198829, "comment_id": 102790666, "body": "Hi, thank you for your quick response. I&#39;ve added an example output in the edit above. I was trying to avoid copying manually as the data in Sheet1 is 19,000 rows long. If it helps, there are 11 types of product in total, which recur over multiple rows in Sheet1, but not in the same order as in Sheet2. However, when copying over from Sheet2 into Sheet1, I would like to keep the same order of Product - Product sub-category - Product origin that is in Sheet2. I hope that helps."}], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1570011392, "post_id": 58199361, "comment_id": 102777071, "body": "Obviously in your solution, you would need two &quot;Copy.Table&quot; (i.e. the yellow table) one for the product sub-category and one for the product origin"}, {"owner": {"reputation": 1, "user_id": 12152665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226b60533bc39d2cb7ff1cf5e87b6c0f?s=128&d=identicon&r=PG&f=1", "display_name": "dmfn94", "link": "https://stackoverflow.com/users/12152665/dmfn94"}, "edited": false, "score": 0, "creation_date": 1570036869, "post_id": 58199361, "comment_id": 102790795, "body": "Hi, thank you, I&#39;m afraid I&#39;m a bit unclear on how to use your formula. How would it work with eleven different products that each recur a different number of times in Sheet1 and Sheet2? E.g. &#39;Cheese&#39; recurs 5 times (i.e. five different combinations of Product-Product sub-category-Product origin), but &#39;Nuts&#39; recurs 37 times?"}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "reply_to_user": {"reputation": 1, "user_id": 12152665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226b60533bc39d2cb7ff1cf5e87b6c0f?s=128&d=identicon&r=PG&f=1", "display_name": "dmfn94", "link": "https://stackoverflow.com/users/12152665/dmfn94"}, "edited": false, "score": 0, "creation_date": 1570077503, "post_id": 58199361, "comment_id": 102801628, "body": "i don&#39;t know how your data is structured. If all cities and all markets have the same products then you can adapt my formula. if that&#39;s not the case then you can&#39;t use it."}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": false, "score": 0, "last_activity_date": 1570010559, "creation_date": 1570010559, "answer_id": 58199361, "question_id": 58198829, "link": "https://stackoverflow.com/questions/58198829/copy-rows-from-one-sheet-into-another-depending-on-value-in-cell/58199361#58199361", "title": "Copy rows from one sheet into another depending on value in cell", "body": "<p>if it is just copying static data repeatedly then perhaps something like this. If not, then i misunderstood your question.\nthis is the formula in cell B2:</p>\n\n<pre><code>=INDEX(Copy.Table,IF(MOD(ROW()-ROW($B$1),Table.Count)=0,$E$2,MOD(ROW()-ROW($B$1),Table.Count)))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3Cm6R.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3Cm6R.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 12152665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226b60533bc39d2cb7ff1cf5e87b6c0f?s=128&d=identicon&r=PG&f=1", "display_name": "dmfn94", "link": "https://stackoverflow.com/users/12152665/dmfn94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1584337586, "creation_date": 1570008607, "last_edit_date": 1584337586, "question_id": 58198829, "link": "https://stackoverflow.com/questions/58198829/copy-rows-from-one-sheet-into-another-depending-on-value-in-cell", "title": "Copy rows from one sheet into another depending on value in cell", "body": "<p>I have two sheets in my spreadsheet and I'm looking for some VBA code (or a simple formula) to batch copy values from one sheet into the other.</p>\n\n<p>Sheet1, has a list of cities, markets and products in three columns (A-C). Close to 19,000 rows in total.<br>\n<a href=\"https://i.stack.imgur.com/cCAAq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cCAAq.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet2, has a list of products, product sub-category, and product origin (columns A-C), Close to 300 rows in total.<br>\n<a href=\"https://i.stack.imgur.com/W5OL0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/W5OL0.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like to copy product sub-category and product origin (i.e. columns B and C in Sheet2) into Sheet1 where Product in Column C of Sheet1 = Product in Column A of Sheet2. Noting that I would like to keep the order that the rows are in Sheet2 when copying to Sheet1.</p>\n\n<p>I tried the following INDEX/MATCH approach, but it stops working after the 18th row (I have close to 19,000 rows in Sheet1), and it only works for one column at a time.</p>\n\n<blockquote>\n  <p>=IFERROR(INDEX('Sheet2'!$B$2:$B$284, SMALL(IF($D2='Sheet2'!$B$2:$B$284, ROW('Sheet2'!$B$2:$B$284)-1,\"\"), ROW()-1)),\"\")</p>\n</blockquote>\n\n<p>Example output using the sample data:\n<a href=\"https://i.stack.imgur.com/nxzdL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nxzdL.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "hyperlink"], "answers": [{"tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1570024314, "last_edit_date": 1570024314, "creation_date": 1570008145, "answer_id": 58198690, "question_id": 58198413, "link": "https://stackoverflow.com/questions/58198413/highlight-selected-cell-from-hyperlink-and-maintain-the-other-cell-color/58198690#58198690", "title": "Highlight selected cell from hyperlink and maintain the other cell color", "body": "<p>Presuming you still want to delete all the other colors inside the <code>.UsedRange</code> you could save the color of cell <code>A1</code> before deleting all the colors and then re-color <code>A1</code> afterwards. Try this code:</p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\nDim i As Long, lngCI As Long\nFor i = 1 To ThisWorkbook.Sheets.Count\n    lngCI = Sheets(i).Cells(1, 1).Interior.ColorIndex\n    Sheets(i).UsedRange.Interior.ColorIndex = -4142\n    Sheets(i).Cells(1, 1).Interior.ColorIndex = lngCI\nNext\nActiveSheet.Cells.Interior.ColorIndex = red 'Don't think this works, you could try .Color = RGBRed\nSelection.Cells.Interior.ColorIndex = 6\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1570008948, "last_edit_date": 1570008948, "creation_date": 1570008504, "answer_id": 58198796, "question_id": 58198413, "link": "https://stackoverflow.com/questions/58198413/highlight-selected-cell-from-hyperlink-and-maintain-the-other-cell-color/58198796#58198796", "title": "Highlight selected cell from hyperlink and maintain the other cell color", "body": "<p>To answer your question: change -4142 to 2</p>\n\n<p>However, this code raises a lot of questions. Why is it in a sheet instead of in a separate module? The line involving \"red\" is not being executed -- what do you intend? To avoid problems like this always include the following code at the top of your modules and it will let you know about the error.</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>Other advice: </p>\n\n<pre><code>(2) use breaks to pause your code and then step through it as it executes\n(3) use ranges to define the cells you are manipulating (e.g., dim r as range)\n(4) use `r.select` as you debug your code to see which cell is being manipulated\n</code></pre>\n\n<p>Regarding (4), be careful about which sheet is activated at the time <code>.select</code> is executed -- and remember to remove all <code>.select</code> statements once done debugging.</p>\n"}], "owner": {"reputation": 1, "user_id": 6222443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e37040c9298bc94473987cc19b2a434?s=128&d=identicon&r=PG&f=1", "display_name": "khuanseng", "link": "https://stackoverflow.com/users/6222443/khuanseng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570024314, "creation_date": 1570007018, "last_edit_date": 1570007318, "question_id": 58198413, "link": "https://stackoverflow.com/questions/58198413/highlight-selected-cell-from-hyperlink-and-maintain-the-other-cell-color", "title": "Highlight selected cell from hyperlink and maintain the other cell color", "body": "<p>I have two sheets 1 &amp; 2. I have a hyperlink in sheet 2 that will bring me to cell A2 in sheet 1 and highlight it in yellow. But at the same time it remove the color of cell A1 in sheet 1 too. </p>\n\n<p>How I maintain the color of cell A1 in sheet 1? </p>\n\n<p>I am using this vba code in sheet 2 </p>\n\n<pre><code>Private Sub Worksheet_FollowHyperlink(ByVal Target As Hyperlink)\n    Dim i As Long\n    For i = 1 To ThisWorkbook.Sheets.Count\n        Sheets(i).UsedRange.Interior.ColorIndex = -4142\n    Next\n    ActiveSheet.Cells.Interior.ColorIndex = red\n    Selection.Cells.Interior.ColorIndex = 6\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "cell"], "comments": [{"owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "edited": false, "score": 0, "creation_date": 1570007103, "post_id": 58198326, "comment_id": 102774977, "body": "Explained here.  <a href=\"https://www.excel-easy.com/vba/examples/swap-values.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/examples/swap-values.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1570089321, "post_id": 58199081, "comment_id": 102805677, "body": "Yes! you are right about &quot; why go through the effort of copying&quot; as it could be achieve through 4 steps. select 1st cell&gt;&gt; copy&gt;&gt; select 2nd cell &gt;&gt; Run the macro. your answer (best-way so far), there are 3 steps to follow. select 1st cell&gt;&gt; select 2nd cell&gt;&gt; Run the macro."}, {"owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 0, "creation_date": 1570089832, "post_id": 58199081, "comment_id": 102805898, "body": "can you explain, when code will go to second <code>else</code> statement??"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "edited": false, "score": 1, "creation_date": 1570090435, "post_id": 58199081, "comment_id": 102806168, "body": "@IbneAshiq the second if statement detects whether the two cells you have selected are directly adjacent. If so, there is only one area selected, and runs cell 1 and 2 from that area. However this won&#39;t work if the cells are apart on the sheet, which then won&#39;t be cell 1 and 2, but area 1 cell 1, area 2 cell 1. The if statement counts the amount of areas, and handles it either as two areas or two adjacent cells."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": true, "score": 2, "last_activity_date": 1570011140, "last_edit_date": 1570011140, "creation_date": 1570009528, "answer_id": 58199081, "question_id": 58198326, "link": "https://stackoverflow.com/questions/58198326/swap-any-two-cells-using-excel-vba-including-non-adjacent-cells/58199081#58199081", "title": "Swap any two cells using excel VBA - including non-adjacent cells", "body": "<p>This sub will do the trick:</p>\n\n<pre><code>Sub swapper()\nDim cellfirst As String, cellsecond As String\nIf Not Selection.Cells.Count = 2 Then\n    MsgBox (\"Please only select two cells\")\n        Else\n        If Selection.Areas.Count &gt; 1 Then\n            cellfirst = Selection(1).Value\n            cellsecond = Selection.Areas(2).Value\n            Selection(1).Value = cellsecond\n            Selection.Areas(2).Value = cellfirst\n                Else\n                cellfirst = Selection(1).Value\n                cellsecond = Selection(2).Value\n                Selection(1).Value = cellsecond\n                Selection(2).Value = cellfirst\n        End If\nEnd If\nEnd Sub\n</code></pre>\n\n<p>It will test if two cells are selected, if not give an error message. Then it will test if the cells are apart or close together. Then based on that store the values of both cells in strings, swap the strings, and print back to cell.</p>\n\n<p>Note: Select two different cells by holding <code>ctrl</code> and clicking on both cells.</p>\n\n<p>I realise this isn't 1 for 1 what you've asked for, but why go through the effort of copying something yourself when you can have the macro do it all for you?</p>\n"}], "owner": {"reputation": 615, "user_id": 6236294, "user_type": "registered", "accept_rate": 96, "profile_image": "https://graph.facebook.com/10204431270580592/picture?type=large", "display_name": "Ibn e Ashiq", "link": "https://stackoverflow.com/users/6236294/ibn-e-ashiq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 58199081, "answer_count": 1, "score": 0, "last_activity_date": 1582631008, "creation_date": 1570006658, "last_edit_date": 1592644375, "question_id": 58198326, "link": "https://stackoverflow.com/questions/58198326/swap-any-two-cells-using-excel-vba-including-non-adjacent-cells", "title": "Swap any two cells using excel VBA - including non-adjacent cells", "body": "<p>I need to swap two cell values. Holding <code>Shift Key</code> then pick &amp; drop method don't work here. so I decided to create a macro in which I can get Active cell address by</p>\n<pre><code>ActiveCell.Address\n</code></pre>\n<p>but how can I get address of the cell which I had copied before running this macro?\nto elaborate more these are the steps to swap values.</p>\n<blockquote>\n<p>Copy a cell</p>\n<p>Select another cell in the same sheet</p>\n<p>Run Macro to swap values (which will save activecell value as string and paste the copied cell value)</p>\n</blockquote>\n<p><strong>Updated:</strong> <em>For Switching Columns, Cells or Rows using VBA in less than Three steps please follow this <a href=\"https://youtu.be/MaiSBVguh28\" rel=\"nofollow noreferrer\">https://youtu.be/MaiSBVguh28</a></em></p>\n"}, {"tags": ["vba", "if-statement"], "comments": [{"owner": {"reputation": 605, "user_id": 7462954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05770fc274e4455c8d04ed7456426cbe?s=128&d=identicon&r=PG&f=1", "display_name": "SNR", "link": "https://stackoverflow.com/users/7462954/snr"}, "edited": false, "score": 1, "creation_date": 1570005456, "post_id": 58197896, "comment_id": 102774143, "body": "<code>If Not False</code> equals <code>If True</code> and also <code>If Not True</code> equals <code>If False</code>. <a href=\"https://en.wikipedia.org/wiki/Boolean_algebra\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Boolean_algebra</a>"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1570006776, "post_id": 58197896, "comment_id": 102774791, "body": "No need for <code>True</code> and <code>False</code>. If you deal with a <code>Boolean</code>, simply write <code>If x Then</code> or <code>If Not x Then</code>."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1570008221, "post_id": 58197896, "comment_id": 102775499, "body": "You will see <code>If Not obj Is Nothing</code> testing if an object is instantiated because <code>Is Something</code> is not a keyword.  We can&#39;t test if an object is something, we can only test if it is not nothing.  In the case of dictionaries, you can test if a key exists with <code>If dict.Exists(key)</code> but this will create the key if it doesn&#39;t already exist; that does not happen when using <code>If Not dict.Exists(key)</code>"}, {"owner": {"reputation": 3, "user_id": 11353525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d10c9d1e238076cff88ab1643648ac57?s=128&d=identicon&r=PG", "display_name": "sunnyimran", "link": "https://stackoverflow.com/users/11353525/sunnyimran"}, "edited": false, "score": 0, "creation_date": 1570020746, "post_id": 58197896, "comment_id": 102781739, "body": "ProfoundlyOblivious, as far as I understood is sometimes we need to test if something exists but there is no keyword for that time&#39;s &#39;exists&#39; so we check the opposite, negation of (if something not exists) will return required result. But what for the case where I have possibility to check both ways, like my question about  recordsets. I can test both cases. I came across a lot like &quot;If Not objMyRecordset.EOF=True&quot; while it is working other way too &quot;If objMyRecordset.EOF=False&quot; as there any real benefit in such scenario?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1570028468, "post_id": 58197896, "comment_id": 102786486, "body": "You should use is  &quot;If Not rs.EOF Then &quot; - there&#39;s no need for a true or false because EOF is  itself Boolean. The styles you are seeing is where people are copying this without understanding and adding a True or false. Strictly speaking the routine  &quot;If rs.EOF Then &#39;do nothing ELSE &#39;do something  &quot; is slightly more efficient then &quot;If Not rs.EOF then &#39;do something&quot; because the Not requires an extra clock cycle - but that&#39;s less important these days than it once was."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1570293673, "post_id": 58197896, "comment_id": 102871007, "body": "Sunny,  no &quot;real benefit&quot; exists between <code>Is</code> vs <code>Not Is</code> <a href=\"https://stackoverflow.com/questions/3818933/is-ifvar-true-faster-than-ifvar-false\">read here</a> and the speed of <code>If</code>  <a href=\"https://stackoverflow.com/questions/315306/is-if-expensive\">might surprise you</a>  Dropping the equivalence test (don&#39;t use <code>If True = True</code>, use <code>If True</code>) and using <code>False</code> instead <code>Not True</code> may be  faster <b>but</b> a well named variable in a context that makes your code more enjoyable to read and easier to understand is far more important than an imperceivable speed difference. If nanoseconds matter, don&#39;t use VBA."}, {"owner": {"reputation": 3, "user_id": 11353525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d10c9d1e238076cff88ab1643648ac57?s=128&d=identicon&r=PG", "display_name": "sunnyimran", "link": "https://stackoverflow.com/users/11353525/sunnyimran"}, "edited": false, "score": 0, "creation_date": 1571076365, "post_id": 58197896, "comment_id": 103112129, "body": "&quot;ProfoundlyOblivious&quot; and &quot;Harassed Dad&quot; your comments satisfies me. No idea how to mark my question as answered."}], "owner": {"reputation": 3, "user_id": 11353525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d10c9d1e238076cff88ab1643648ac57?s=128&d=identicon&r=PG", "display_name": "sunnyimran", "link": "https://stackoverflow.com/users/11353525/sunnyimran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570006638, "creation_date": 1570004918, "last_edit_date": 1570006638, "question_id": 58197896, "link": "https://stackoverflow.com/questions/58197896/if-statement-difference-between-if-not-false-vs-if-true", "title": "IF statement, difference between IF NOT ...False Vs IF TRUE", "body": "<p>I want to clarify VBA IF statement. What is the difference between them:</p>\n\n<pre><code>if x=true then\n'do something at true\nend if\n\nif NOT x=false then\n' do something at true\nend if\n</code></pre>\n\n<p>Both statements will check same conditions. What is the difference among them.</p>\n\n<p>To be more specific I am working on recordset object adodb and trying to find the difference between these and can't figure out</p>\n\n<pre><code>If Not objMyRecordset.EOF=True Then\n' do something when objMyRecordset.EOF is not true (Implicitly means False)\nEnd if\n\nIf objMyRecordset.EOF=False Then\n' do something when objMyRecordset.EOF returns False (implicitly means not True)\nEnd if\n</code></pre>\n\n<p>Both If's are checking same condition here too. But on numerous articles on internet I found the test condition with <code>If Not objMyRecordset.EOF=True Then</code>. There must be some real reason behind this. can someone explain?</p>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 392, "user_id": 11847698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HQoQQ.jpg?s=128&g=1", "display_name": "wallisers", "link": "https://stackoverflow.com/users/11847698/wallisers"}, "edited": false, "score": 3, "creation_date": 1570004886, "post_id": 58197829, "comment_id": 102773872, "body": "What have you tried so far?"}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570010780, "post_id": 58197829, "comment_id": 102776805, "body": "That question is duplicated. Check <a href=\"https://stackoverflow.com/questions/25169812/how-to-identify-first-second-etc-monday-or-other-day-of-week-for-a-given-month\" title=\"how to identify first second etc monday or other day of week for a given month\">stackoverflow.com/questions/25169812/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "reply_to_user": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1570016528, "post_id": 58197829, "comment_id": 102779426, "body": "@DavidGarc&#237;aBodego Thank you, but that is not a solution to my problem. I need a list of the <b>next <i>n</i> occurrences</b>, not just a single result."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "is_accepted": false, "score": 0, "last_activity_date": 1570017504, "last_edit_date": 1570017504, "creation_date": 1570017203, "answer_id": 58200968, "question_id": 58197829, "link": "https://stackoverflow.com/questions/58197829/list-of-1st-and-3rd-mondays-in-excel/58200968#58200968", "title": "List of 1st and 3rd Mondays in Excel", "body": "<p>This is the solution I have so far:</p>\n\n<pre><code>Private Sub Auto_Open()\n\nDim i, mday As Integer\nDim row, col As Integer\nDim d As Date\nDim min As Integer\n\nmin = 14    'Minimum set up period\n\ncol = 1     'Column to put results in\nrow = 2     'Row to start from\n\n\nd = Date + min + 9 - Weekday(Date) 'Find Monday after Minimum set up period\n\nWorksheets(\"options\").Activate\n\nFor i = 1 To 26     'Results up to 26 weeks in future\n    mday = day(d)\n    If (mday - 7 &lt;= 0) Then                                'First week\n        Cells(row, col).Value = d\n        row = row + 1\n    ElseIf (mday - 14 &gt; 0 And mday - 21 &lt;= 0) Then        'Third week\n        Cells(row, col).Value = d\n        row = row + 1\n    End If\n    d = d + 7   '+1 week\n    Next\n\nWorksheets(\"New Starter\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "edited": false, "score": 0, "creation_date": 1570017906, "post_id": 58201019, "comment_id": 102780168, "body": "Also we should give the formula for A1, how to find the first day of the current month."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "edited": false, "score": 0, "creation_date": 1570018570, "post_id": 58201019, "comment_id": 102780517, "body": "I just place a random date on A1 as it is not indicated on the question, it is just an issue to formulate it."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "edited": false, "score": 0, "creation_date": 1570018658, "post_id": 58201019, "comment_id": 102780571, "body": "@Ted209... in your original question you request to know the 1st and 3rd monday of each month so... what is the issue with the months with more than 3 mondays? Is there any other condition?"}, {"owner": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "edited": false, "score": 0, "creation_date": 1570018837, "post_id": 58201019, "comment_id": 102780684, "body": "Thanks David. There is one issue with that method though - the results will be out of whack after any month that contains 5 Mondays"}, {"owner": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "edited": false, "score": 0, "creation_date": 1570018871, "post_id": 58201019, "comment_id": 102780705, "body": "Apologies for the typo - should have been &quot;5 Mondays&quot;. The issue is that in a month with 5 Mondays, you&#39;ll get the 1st, 3rd, and 5th Monday in the list. The following month you&#39;ll get the 2nd and 4th. So, all the results will be out of kilter after that."}, {"owner": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "edited": false, "score": 0, "creation_date": 1570019187, "post_id": 58201019, "comment_id": 102780878, "body": "I think a way to mitigate this issue would be to check if the previous two rows had the same month - and if so, add 21 instead of 14."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "edited": false, "score": 0, "creation_date": 1570019350, "post_id": 58201019, "comment_id": 102780960, "body": "@Ted209 this code according to your question, so, if there is additionals conditions: Need of the 5th monday... Edit your post an include it, please"}], "tags": [], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "is_accepted": false, "score": 0, "last_activity_date": 1570019215, "last_edit_date": 1570019215, "creation_date": 1570017425, "answer_id": 58201019, "question_id": 58197829, "link": "https://stackoverflow.com/questions/58197829/list-of-1st-and-3rd-mondays-in-excel/58201019#58201019", "title": "List of 1st and 3rd Mondays in Excel", "body": "<p>Try this:</p>\n\n<p>On A1 place the first day of one month. On A2 place: <code>=EOMONTH(A1,0)+1</code></p>\n\n<p>On B1 place <code>=A1+MOD(8-WEEKDAY(A22,2),7).</code></p>\n\n<p>On C1 place <code>=B1+14</code></p>\n\n<p>Drag an drop down.</p>\n\n<p>The first column is taking the first day of one month and consecutive month, the column <code>B</code>is returning the first monday and colunm <code>C</code> is returning the third monday of that month.</p>\n\n<p>If you are looking for the 5th monday:</p>\n\n<p>On D1 place: <code>=IF(A1+MOD(8-WEEKDAY(A22,2),7)+28&lt;EOMONTH(A1,0)+1,A1+MOD(8-WEEKDAY(A22,2),7)+28,\"\")</code></p>\n"}], "owner": {"reputation": 1, "user_id": 12152625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7b3e5c7a344fb6cb892df2a12c88af0?s=128&d=identicon&r=PG&f=1", "display_name": "Ted209", "link": "https://stackoverflow.com/users/12152625/ted209"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1570019215, "creation_date": 1570004681, "last_edit_date": 1570018772, "question_id": 58197829, "link": "https://stackoverflow.com/questions/58197829/list-of-1st-and-3rd-mondays-in-excel", "title": "List of 1st and 3rd Mondays in Excel", "body": "<p>In Excel, I'd like a list of the 1st and 3rd Mondays in each month, for say the next six months after today.</p>\n\n<p>Using a formula-based approach, I can find the 1st or 3rd Monday after today. I got stuck when trying to populate the list after that. Particularly, a challenge is to account for months with 5 Mondays in them. The formulas get very complex very quickly!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "edited": false, "score": 0, "creation_date": 1570005177, "post_id": 58197907, "comment_id": 102774017, "body": "It doesn&#39;t work  <b>initial_array(i) = Format(firstDay + i + 1, &quot;d mmmm yyyy&quot;)</b> missing type"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "edited": false, "score": 0, "creation_date": 1570005666, "post_id": 58197907, "comment_id": 102774251, "body": "I corrected your array declaration, try the updated code"}, {"owner": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "edited": false, "score": 0, "creation_date": 1570006203, "post_id": 58197907, "comment_id": 102774512, "body": "It worked thank you. May I ask a little bit of explanation please?"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "edited": false, "score": 0, "creation_date": 1570006878, "post_id": 58197907, "comment_id": 102774853, "body": "I&#39;ve added some explanations to the my answer. If this solved your problem please accept the answer so it&#39;s easier to find for others."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "edited": false, "score": 0, "creation_date": 1570007131, "post_id": 58197907, "comment_id": 102774986, "body": "Glad to help :)"}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": true, "score": 2, "last_activity_date": 1570009890, "last_edit_date": 1570009890, "creation_date": 1570004968, "answer_id": 58197907, "question_id": 58197784, "link": "https://stackoverflow.com/questions/58197784/how-to-fill-an-array-with-dates-of-the-month/58197907#58197907", "title": "How to fill an array with dates of the month?", "body": "<p>You are not changing the values you're putting into the array, you're putting <code>Format(firstDay + 1, \"d mmmm yyyy\")</code> into the array multiple times. This might be what you're looking for:</p>\n\n<pre><code>For i = 0 To lastDay - firstDay\n\n    initial_array(i) = Format(firstDay + i + 1, \"d mmmm yyyy\")\n\nNext i\n</code></pre>\n\n<p>Also, arrays start at 0, so you should start populating your array at index 0.</p>\n\n<p>EDIT: Sorry, I completely missed your array declaration, try this corrected code:</p>\n\n<pre><code>Dim i As Integer\nDim arr As Variant\nDim firstDay As Date\nDim MyMounth As Long\nDim initial_array As Variant\nDim lastDay As Date\n\nMyMounth = 1\nfirstDay = DateSerial(Year(Date), MyMounth, 1)\n\nlastDay = DateAdd(\"m\", 1, firstDay) - 1\n\nReDim initial_array(lastDay - firstDay)\nFor i = 0 To lastDay - firstDay\n\n  initial_array(i) = Format(firstDay + i, \"d mmmm yyyy\")\n\nNext i\n\nComboBox3.List = initial_array\n</code></pre>\n\n<p>This will put every value including <code>firstDay</code> and <code>lastDay</code> into the array.</p>\n\n<p>EDIT: Explanation:\nBefore populating the array with your values you need to set the length of the array to the number of your values (since arrays start at 0, if you want to put the numbers from 11 through 15 in it, your array will look like this (index: value): 0: 11 - 1: 12 - 2: 13 - 3: 14 - 4: 15. So your array has a length of 5, but the last index is 4). The line <code>ReDim initial_array(lastDay - firstDay)</code> re-initializes the array with a length of <code>(lastDay - firstDay)</code>.</p>\n\n<p>Next, while looping through the array with a <code>For</code> loop and populating it with values you don't only need to increment the array index, but your values as well. The expression <code>Format(firstDay + 1, \"d mmmm yyyy\")</code> does not change, since <code>firstDay</code> never changes. So each time we increase <code>i</code> by 1 we also increase the value you're putting into the array by 1 by adding <code>i</code>.</p>\n"}], "owner": {"reputation": 49, "user_id": 12061753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7612f362f9aa9e511ea59aa33e57ad21?s=128&d=identicon&r=PG&f=1", "display_name": "SometingNew", "link": "https://stackoverflow.com/users/12061753/sometingnew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 58197907, "answer_count": 1, "score": 1, "last_activity_date": 1577823174, "creation_date": 1570004541, "last_edit_date": 1577823174, "question_id": 58197784, "link": "https://stackoverflow.com/questions/58197784/how-to-fill-an-array-with-dates-of-the-month", "title": "How to fill an array with dates of the month?", "body": "<p>I want to fill an array with values and then fill a combobox with the values of the array.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim i As Integer\nDim arr As Variant\nDim firstDay As Date\nDim MyMounth As Long\nDim initial_array As Variant\nDim lastDay As Date\n\nMyMounth = 1\nfirstDay = DateSerial(Year(Date), MyMounth, 1)\n\nlastDay = DateAdd(\"m\", 1, firstDay) - 1\n\nFor i = 1 To lastDay - firstDay\n\n    initial_array(i) = Format(firstDay + 1, \"d mmmm yyyy\")\n\nNext i\n\nComboBox3.List = initial_array\n</code></pre>\n\n<p>I got the first day and the last day of the Month <strong>January</strong> because of <code>MyMounth = 1</code>.</p>\n\n<p>How do I fill the array?</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570004564, "post_id": 58197556, "comment_id": 102773702, "body": "Can you show some more of your code? I think a simple solution might be to let user answer in a separate <code>MsgBox</code>, and tying further actions to the result of the <code>MsgBox</code>."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1570008512, "post_id": 58197556, "comment_id": 102775636, "body": "You can effectively pause the application until the user clicks a button by setting the form to display <code>Modal</code> in the properties window."}, {"owner": {"reputation": 1, "user_id": 10092785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af94be9fbf85056101175fb9406aba6?s=128&d=identicon&r=PG&f=1", "display_name": "km-b", "link": "https://stackoverflow.com/users/10092785/km-b"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570019114, "post_id": 58197556, "comment_id": 102780833, "body": "@M.Schalk  yes i have added codes to the question . I have used msgbox in another code and it runs perfectly but i want to use userForm so i can change the font size that is shown for user"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570019265, "post_id": 58197556, "comment_id": 102780917, "body": "Try setting <code>ShowModal</code> of your <code>UserForm</code> to <code>True</code>, as ProfoundlyOblivious suggested."}, {"owner": {"reputation": 1, "user_id": 10092785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af94be9fbf85056101175fb9406aba6?s=128&d=identicon&r=PG&f=1", "display_name": "km-b", "link": "https://stackoverflow.com/users/10092785/km-b"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570020787, "post_id": 58197556, "comment_id": 102781761, "body": "@M.Schalk I checked it, by default it&#39;s modal."}], "answers": [{"tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1570300506, "last_edit_date": 1570300506, "creation_date": 1570299886, "answer_id": 58251131, "question_id": 58197556, "link": "https://stackoverflow.com/questions/58197556/change-labels-caption-with-loop-in-a-vba-userform/58251131#58251131", "title": "Change label&#39;s caption with loop in a VBA userForm", "body": "<blockquote>\n  <p>You haven't shown us where you show the <code>UserForm</code> or how it is defined within your project and you haven't given a good description of the problem.  This forces assumptions that may not be accurate.</p>\n</blockquote>\n\n<p>Do not name your <code>UserForm</code> \"UserForm1\", give it a useful name.  Henceforth, I will refer to this as \"UserResponseForm\"</p>\n\n<p>Do not use default instance of a <code>UserForm</code>, use a variable and learn the difference between <code>Dim As</code> and <code>Dim As New</code>.  The difference is significant <strong>and</strong> important.</p>\n\n<pre><code>Dim myForm As UserResponseForm\n\nDim myForm As New UserResponseForm\n</code></pre>\n\n<p>Using UserResponseForm's property window, find and rename your labels \"Question\" and \"Answer\"</p>\n\n<p>In UserResponseForm's code use Ctrl + H to replace:</p>\n\n<p><code>UserForm1.Controls(\"answer\")</code> with <code>Me.Answer</code></p>\n\n<p>and</p>\n\n<p><code>Unload UserForm1</code> with <code>Me.Hide</code></p>\n\n<p>Move all of your code from <code>Private Sub UserForm_Activate</code> to a normal module. Give the module and the sub a useful name. I will refer to module as \"QuestionaireCodeModule\" and the sub as \"RunTheQuestionnaire\"</p>\n\n<p>The QuestionaireCodeModule should look similar to this</p>\n\n<pre><code>Option Explicit\n\nPrivate Const n As Long = 20 'you didn't show how n was populated or scoped so I put it here\n\nSub RunTheQuestionaire()\n\n    Dim i As Long\n    Dim myForm As New UserResponseForm \n\n    For i = 2 To n\n\n        Cells(i, 3) = Cells(i, 3) + 1 \n\n        If Cells(i, 3) = 1 Or Cells(i, 3) = 3 Then 'added or condition for clarity\n            myForm.Question.Caption = Cells(i, 1).Value 'lable 1 \n            myForm.Answer.Caption = vbNullString                 'lable 2        \n\n            'some codes...\n\n            'next three lines removed because they are redundant\n        'elseIf Cells(i, 3) = 3 Then\n            'UserForm1.Controls(\"question\").Caption = Cells(i, 1).Value 'lable 1 \n            'UserForm1.Controls(\"answer\").Caption = \"\"                  'lable 2  \n\n        End If\n\n        myForm.Show\n        If Not myForm.Visible Then Exit For\n\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>That should be it but I can't say if this will work for you or not because you did not provide enough to work with and the code you provided in your example won't compile.</p>\n"}], "owner": {"reputation": 1, "user_id": 10092785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1af94be9fbf85056101175fb9406aba6?s=128&d=identicon&r=PG&f=1", "display_name": "km-b", "link": "https://stackoverflow.com/users/10092785/km-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 614, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570300506, "creation_date": 1570003662, "last_edit_date": 1570021309, "question_id": 58197556, "link": "https://stackoverflow.com/questions/58197556/change-labels-caption-with-loop-in-a-vba-userform", "title": "Change label&#39;s caption with loop in a VBA userForm", "body": "<p>I want my code to loop through a range of cells and every time show the content of the cell (that is a question) in a label's caption of a userForm and allow the user  to choose the button of \"Yes\" (for knowing the answer) or \"NO\" (for not knowing the answer) and then the code use the user's response to perform some actions and then continue the loop for other cells.</p>\n\n<p>For each iteration in for loop i need user be allowed to choose \"Yes\" or \"No\" or \"Cancel\" and then the userForms code continue running. </p>\n\n<p>Here is some of the code:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n\nFor i = 2 To n\nCells(i, 3) = Cells(i, 3) + 1 \nIf Cells(i, 3) = 1 Then \n    UserForm1.Controls(\"question\").Caption = Cells(i, 1).Value 'lable 1 \n    UserForm1.Controls(\"answer\").Caption = \"\"                  'lable 2               \n    'some codes...\nelseIf Cells(i, 3) = 3 Then\nUserForm1.Controls(\"question\").Caption = Cells(i, 1).Value 'lable 1 \nUserForm1.Controls(\"answer\").Caption = \"\"                  'lable 2  \nnext\nend sub\n</code></pre>\n\n<p>and i need to run these codes whenever user clicks on a button on the form . then the rest of the above code be executed .</p>\n\n<pre><code>Private Sub ansYes_Click() 'If user clicks Yes show the answer and continue\n  UserForm1.Controls(\"answer\").Caption = Cells(i, 2)\n  UserForm1.Controls(\"answer\").Visible = True\nEnd Sub\nPrivate Sub ansNo_Click()  'If user clicks No show the answer and continue\n  UserForm1.Controls(\"answer\").Caption = Cells(i, 2)\n  UserForm1.Controls(\"answer\").Visible = True\nCells(i, 3) = 0\nCells(i, 4) = 1\nEnd Sub\nPrivate Sub ansCancel_Click() 'If user clicks cancel unload userform and exit the for loop\n  Unload UserForm1\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1570004224, "post_id": 58197526, "comment_id": 102773552, "body": "This can be done by making the formula a public function instead."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1570004347, "post_id": 58197526, "comment_id": 102773595, "body": "Do you need this to be appicable to different formulas or just this specific formula? @Plutian&#39;s solution is probably the most elegant, and applicable to both cases."}, {"owner": {"reputation": 3, "user_id": 12152476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2605d11c1cab2db7b7b39af36cec7175?s=128&d=identicon&r=PG&f=1", "display_name": "hammet", "link": "https://stackoverflow.com/users/12152476/hammet"}, "edited": false, "score": 0, "creation_date": 1570027873, "post_id": 58197526, "comment_id": 102786126, "body": "I&#39;m looking for the same behaviour as Eval function on Javascript"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12152476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2605d11c1cab2db7b7b39af36cec7175?s=128&d=identicon&r=PG&f=1", "display_name": "hammet", "link": "https://stackoverflow.com/users/12152476/hammet"}, "edited": false, "score": 0, "creation_date": 1570027897, "post_id": 58197980, "comment_id": 102786138, "body": "That is not what I need, sorry."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 3, "user_id": 12152476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2605d11c1cab2db7b7b39af36cec7175?s=128&d=identicon&r=PG&f=1", "display_name": "hammet", "link": "https://stackoverflow.com/users/12152476/hammet"}, "edited": false, "score": 0, "creation_date": 1570028416, "post_id": 58197980, "comment_id": 102786457, "body": "@hammet Can you elaborate? It does what you stated you need in your question. This method can easily be adapted for different outputs and inputs."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "reply_to_user": {"reputation": 3, "user_id": 12152476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2605d11c1cab2db7b7b39af36cec7175?s=128&d=identicon&r=PG&f=1", "display_name": "hammet", "link": "https://stackoverflow.com/users/12152476/hammet"}, "edited": false, "score": 0, "creation_date": 1570029893, "post_id": 58197980, "comment_id": 102787372, "body": "@hammet answer updated with a closer approximation to what you asked. If this is still not what you need, consider editing your question."}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1570029619, "last_edit_date": 1570029619, "creation_date": 1570005268, "answer_id": 58197980, "question_id": 58197526, "link": "https://stackoverflow.com/questions/58197526/is-it-possible-to-execute-a-formula-inside-a-variable/58197980#58197980", "title": "Is it possible to execute a formula inside a variable?", "body": "<p>The following function and sub calling that function inserts your formula into a cell with a specified range as the argument. You can set this to any cell.</p>\n\n<pre><code>Sub evaluate()\nDim x As Range\nDim blah As String\nSet x = Sheets(\"Sheet1\").Range(\"A2\")\nblah = Formulaz(x)\nRange(\"A3\").Formula = blah\nEnd Sub\n\nPublic Function Formulaz(x As Range)\nFormulaz = \"=43.025 *\" &amp; x.Address &amp; \"^-0.452\"\nEnd Function\n</code></pre>\n\n<p>To change this to take a string instead you can simply amend like so:</p>\n\n<pre><code>Dim x As String\nDim blah As String\nx = Range(\"A2\").Value\nblah = Formulaz(x)\nRange(\"A3\").Formula = blah\nEnd Sub\n\nPublic Function Formulaz(x As String)\nFormulaz = \"=43.025 *\" &amp; x &amp; \"^-0.452\"\nEnd Function\n</code></pre>\n\n<p>This yields the same result (the formula being inserted in a cell and the solution showing) but it takes the value of a cell as argument.</p>\n\n<p>As OP stated this is not what is needed, perhaps this works better:</p>\n\n<pre><code>Sub evaluate()\nDim x As String\nDim blah As String\nx = \"5\"\nblah = Formulaz(x)\nDebug.print blah\nEnd Sub\n\nPublic Function Formulaz(x As String)\nFormulaz = 43.025 * x ^ -0.452\nEnd Function\n</code></pre>\n\n<p>It returns the value of the expression with x passed as the argument. The output for x = 5 will be 20.78674 stored in Blah as a string.</p>\n"}, {"comments": [{"owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "reply_to_user": {"reputation": 3, "user_id": 12152476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2605d11c1cab2db7b7b39af36cec7175?s=128&d=identicon&r=PG&f=1", "display_name": "hammet", "link": "https://stackoverflow.com/users/12152476/hammet"}, "edited": false, "score": 0, "creation_date": 1570091684, "post_id": 58205728, "comment_id": 102806778, "body": "@hammet No problem. Glad I could help."}], "tags": [], "owner": {"reputation": 2239, "user_id": 1473412, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7ac8599add0ace676200f6d50d6d2ff1?s=128&d=identicon&r=PG", "display_name": "Gravitate", "link": "https://stackoverflow.com/users/1473412/gravitate"}, "is_accepted": true, "score": 0, "last_activity_date": 1570091595, "last_edit_date": 1570091595, "creation_date": 1570034200, "answer_id": 58205728, "question_id": 58197526, "link": "https://stackoverflow.com/questions/58197526/is-it-possible-to-execute-a-formula-inside-a-variable/58205728#58205728", "title": "Is it possible to execute a formula inside a variable?", "body": "<p>It is unclear whether you need to pull the formula from the object title at runtime, or whether you can hard code it.</p>\n\n<p>Hard coding it would be trivial. <code>Application.Evaluate</code> will give you very similar functionality to the EVAL function in Javascript.</p>\n\n<pre><code>x = 23\nformula= \"43,025*\" &amp; x &amp; \"^-0,452\"\nValue = Application.Evaluate(formula)\n</code></pre>\n\n<p>However, if you want to get the formula on the fly at runtime, that is a separate issue as you will need to find the range reference in the string and replace it with your new variable. If it is the same reference every time. That would be quite simple.</p>\n\n<p>I will leave this task up to you. If you need help, please clarify your exact requirements and I will update my answer. </p>\n"}], "owner": {"reputation": 3, "user_id": 12152476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2605d11c1cab2db7b7b39af36cec7175?s=128&d=identicon&r=PG&f=1", "display_name": "hammet", "link": "https://stackoverflow.com/users/12152476/hammet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 58205728, "answer_count": 2, "score": 0, "last_activity_date": 1570091595, "creation_date": 1570003526, "last_edit_date": 1570027936, "question_id": 58197526, "link": "https://stackoverflow.com/questions/58197526/is-it-possible-to-execute-a-formula-inside-a-variable", "title": "Is it possible to execute a formula inside a variable?", "body": "<p>I want to know if it is possible in VBA to use the content of a variable as \"code\". For example: </p>\n\n<pre><code>x = 23\n\nformula= \"43,025*X^-0,452\"\n\nValue = ExecuteContentOf(formula)\n</code></pre>\n\n<p>I have used a power curve in excel to calculate the formula that represents the best curve for 4 different x,y values. \n(1,40) (7, 20) (30,10) (60,6)</p>\n\n<p>The result is a graphic with the formula inside. Excel calculate that automatically. Using VBA I can extract the text of the formula from the  object title.</p>\n\n<p>The result us is = 43,025*C2^-0,452</p>\n\n<p>Now I want to use it myself in VBA changing C2 for other variable (not a cell), so y= 43,025*x^-0,452.\nAs the formula is in a string.. \nIs it possible to tell VBA to interpret it?</p>\n\n<p>I'm looking for the same functionality as the EVAL function on Javascript</p>\n"}, {"tags": ["excel", "vba", "filesystemobject"], "owner": {"reputation": 412, "user_id": 11927706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e37cae4cba7c4eafda7a0c885754dfce?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/11927706/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1570024388, "creation_date": 1570003321, "last_edit_date": 1570024388, "question_id": 58197470, "link": "https://stackoverflow.com/questions/58197470/vba-filesystemobject-showing-files-that-no-longer-exist", "title": "VBA FileSystemObject showing files that no longer exist", "body": "<p>I am having some behaviour which seems very weird to me within VBA.</p>\n\n<p>I have the following code:</p>\n\n<pre><code>Dim oFSO As FileSystemObject\nDim oFolder As Folder\nDim oFile As File\n\nSet oFSO = New FileSystemObject\nSet oFolder = oFSO.GetFolder(wbCases.Path &amp; \"\\..\\my\\sub\\path\\to\\photos\")\n\nFor Each oFile In oFolder.Files\n    If oFolder.Files.Count = 1 Then\n        Name oFolder.Path &amp; \"\\\" &amp; oFile.Name As oFolder.Path &amp; \"\\\" &amp; \"12345.jpg\"\n        oFSO.CopyFile oFolder.Path &amp; \"\\12345.jpg\", oFolder.Path &amp; \"\\\" &amp; \"1235.jpg\"\n\n    Else\n        If oFolder.Files.Count &gt; 1 Then\n            Kill oFile\n        End If\n    End If\nNext oFile\n</code></pre>\n\n<p>This code is supposed to check the contents of the folder specified in line </p>\n\n<pre><code>Set oFolder = oFSO.GetFolder(wbCases.Path &amp; \"\\..\\my\\sub\\path\\to\\photos\")\n</code></pre>\n\n<p>which resolves to following <strong>existing</strong> folder on a network drive:</p>\n\n<blockquote>\n  <p>I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos</p>\n</blockquote>\n\n<p>If there is more than one file in this folder, I want to delete all the files until there is only one left. Then I want to copy this last file. However, this last step should be irrelevant, I would think, to the issue I am encountering, as I am encountering said issue before having deleted all but one file.</p>\n\n<p>Namely, what is happening is that I am getting files which no longer exist in this directory.</p>\n\n<p>E.g., when executing this code, I have five files in this folder, as confirmed by cmd:</p>\n\n<blockquote>\n<pre><code>I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos&gt;dir\n Volume in drive I is DE_User11\n Volume Serial Number is 009A-9A03\n\n Directory of I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos\n\n02.10.2019  09:43    &lt;DIR&gt;          .\n02.10.2019  09:14    &lt;DIR&gt;          ..\n19.08.2019  16:01         4.818.169 32993a - Copy (3).jpg\n19.08.2019  16:01         4.818.169 32993a - Copy (3) - Copy - Copy.jpg\n19.08.2019  16:01         4.818.169 32993a - Copy (4).jpg\n19.08.2019  16:01         4.818.169 32993a - Copy (3) - Copy.jpg\n19.08.2019  16:01         4.818.169 32993a.jpg\n               5 File(s)     24.090.845 bytes\n               2 Dir(s)     153.919.488 bytes free\n</code></pre>\n</blockquote>\n\n<p>However, when looping through the files in this folder using above-posted VBA code, I get, for example, my oFile variable filled with the following file:</p>\n\n<pre><code>I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos\\2229.jpg\n</code></pre>\n\n<p>This file <strong>used to</strong> exist, but I deleted it a couple of days ago, and, as stated above, it does not exist according to the dir command of cmd. Yet, my VBA code seems to think it exists, causing issues when trying to delete it using</p>\n\n<pre><code>Kill oFile\n</code></pre>\n\n<p>Why is this happening?</p>\n\n<p><strong>Update:</strong> </p>\n\n<p>I have checked if the files VBA is finding are somehow hidden, and it seems they are. When I run </p>\n\n<pre><code>dir \\a\n</code></pre>\n\n<p>on the folder, I get the following output</p>\n\n<pre><code>I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos&gt;dir /a\n Volume in drive I is DE_User11\n Volume Serial Number is 009A-9A03\n\n Directory of I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos\n\n02.10.2019  09:43    &lt;DIR&gt;          .\n02.10.2019  09:14    &lt;DIR&gt;          ..\n29.08.2019  09:41            19.456 2229.jpg\n29.08.2019  09:41            19.456 2231.jpg\n29.08.2019  09:41            19.456 2228.jpg\n29.08.2019  09:41            19.456 2226.jpg\n19.08.2019  16:01         4.818.169 32993a - Copy (3).jpg\n29.08.2019  09:41            19.456 2224.jpg\n29.08.2019  09:41            19.456 2225.jpg\n29.08.2019  09:41            19.456 2227.jpg\n19.08.2019  16:01         4.818.169 32993a - Copy (3) - Copy - Copy.jpg\n19.08.2019  16:01         4.818.169 32993a - Copy (4).jpg\n19.08.2019  16:01         4.818.169 32993a - Copy (3) - Copy.jpg\n19.08.2019  16:01         4.818.169 32993a.jpg\n29.08.2019  09:41            19.456 2224 - Copy.jpg\n29.08.2019  09:41            19.456 2230.jpg\n              14 File(s)     24.265.949 bytes\n               2 Dir(s)     153.919.488 bytes free\n</code></pre>\n\n<p>However, I can not delete any of the hidden files:</p>\n\n<pre><code>I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos&gt;del 2229.jpg\nCould Not Find I:\\root of Local Copy for building\\my\\sub\\path\\to\\photos\\2229.jpg\n</code></pre>\n"}, {"tags": ["excel", "vba", "editor"], "answers": [{"tags": [], "owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "is_accepted": true, "score": 0, "last_activity_date": 1570003438, "creation_date": 1570003438, "answer_id": 58197499, "question_id": 58197337, "link": "https://stackoverflow.com/questions/58197337/how-to-fix-the-auto-capitalization-of-code-in-the-vb-editor-with-naming-collisio/58197499#58197499", "title": "How to fix the auto-capitalization of code in the VB editor with naming collision?", "body": "<p>Wrong capitalization is the result of that You used this special word for your variable. And after that Editor is using that word as your variable, not the word with its functionality in VBA.</p>\n\n<p>Editor will not know if now You want word 'workbook' as your variable and later as assigned VBA word.</p>\n\n<p>Try to avoid using word as variables, which are assigned to VBA language.</p>\n\n<p>You can't overcome this.</p>\n"}], "owner": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58197499, "answer_count": 1, "score": 1, "last_activity_date": 1570003438, "creation_date": 1570002847, "question_id": 58197337, "link": "https://stackoverflow.com/questions/58197337/how-to-fix-the-auto-capitalization-of-code-in-the-vb-editor-with-naming-collisio", "title": "How to fix the auto-capitalization of code in the VB editor with naming collision?", "body": "<p>As noted in this old unsolved <a href=\"https://www.ozgrid.com/forum/forum/help-forums/excel-general/106380-auto-capitalization-of-code-in-the-vb-editor\" rel=\"nofollow noreferrer\">question</a> in another site, when using variables and properties with the same names but different capitalization the Visual Basic Editor forces incorrect capitalization on the properties automatically.</p>\n\n<pre><code>Dim workbook As Excel.workbook\nDim worksheet As Excel.worksheet\nDim name As String\n\nSet workbook = Excel.Application.ThisWorkbook\nSet worksheet = workbook.ActiveSheet\nSet name = worksheet.name\n</code></pre>\n\n<p>In this example being \"Excel.<strong>w</strong>orkbook\", \"Excel.<strong>w</strong>orksheet\" and \"worksheet.<strong>n</strong>ame\".</p>\n\n<p>Is there any way to fix that or turn if off in the editor?</p>\n\n<p>The question isn't about whether it's a good idea or not to use reserved words as variable or sub/function names.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 1, "creation_date": 1570005801, "post_id": 58197906, "comment_id": 102774334, "body": "ideally, you want a combination of the two so you don&#39;t worry how you select your cells/rows."}, {"owner": {"reputation": 27, "user_id": 2431986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f577ef7e9a7c6b653c06d57dad2abd?s=128&d=identicon&r=PG", "display_name": "Youri Kamperman", "link": "https://stackoverflow.com/users/2431986/youri-kamperman"}, "edited": false, "score": 0, "creation_date": 1570012638, "post_id": 58197906, "comment_id": 102777611, "body": "I get what you are saying, but it is not a solution to my problem. The problem is that when I select 2 rows next to eachother (so 1 area), it will in this specific case not have the second row in the area."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "reply_to_user": {"reputation": 27, "user_id": 2431986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f577ef7e9a7c6b653c06d57dad2abd?s=128&d=identicon&r=PG", "display_name": "Youri Kamperman", "link": "https://stackoverflow.com/users/2431986/youri-kamperman"}, "edited": false, "score": 1, "creation_date": 1570013240, "post_id": 58197906, "comment_id": 102777848, "body": "See my updated post. Plus, going back to the code you have posted, there is definitely something wrong how you set your range variables, do revisit it i.e. &quot;Set rnge = Selection.SpecialCells(xlCellTypeVisible)&quot; will always give you the same rnge, why is it in the loop???"}, {"owner": {"reputation": 27, "user_id": 2431986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f577ef7e9a7c6b653c06d57dad2abd?s=128&d=identicon&r=PG", "display_name": "Youri Kamperman", "link": "https://stackoverflow.com/users/2431986/youri-kamperman"}, "edited": false, "score": 0, "creation_date": 1570017318, "post_id": 58197906, "comment_id": 102779853, "body": "You are right. I overlooked the fact that I used Selection here instead of the area. I cleaned up the code and checked if I used correct parameters inside the loop, and it is working now. Thanks for the help, and I will update my original post with the solution, which is a combination of your separate solutions."}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": true, "score": 1, "last_activity_date": 1570013075, "last_edit_date": 1570013075, "creation_date": 1570004968, "answer_id": 58197906, "question_id": 58197316, "link": "https://stackoverflow.com/questions/58197316/how-to-get-full-selection-from-excel-sheet-using-vba-without-the-filtered-rows-t/58197906#58197906", "title": "How to get full selection from Excel sheet using VBA without the filtered rows that are in between", "body": "<p>There are two approaches to how to select the cells:\nfor example, holding the shift key and clicking individually on two cells then you have two areas in your selection. holding the shift key and click and drag to select the two cells will create one area. ie. if my cells are A1 and B1 then in the first case i will get two areas \"$A$1\",\"$B$1\" whereas in the second case you will get one area \"$A$1:$B$1\"</p>\n\n<p>So if you want to go for one selection then you will need to split the selection as below: </p>\n\n<pre><code>Private Sub sTestSolution()\n\n  Dim area As Range, newRange As Range\n  Dim i As Long, x As Variant, y As Variant\n\n  Set newRange = Selection.SpecialCells(xlCellTypeVisible)\n  For Each area In newRange.Areas\n    Debug.Print area.Address\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>If you want to go for multiple selection then the code will be like this (adjust accordingly):</p>\n\n<pre><code>Private Sub sTestSolution()\n\n  Dim area As Range\n  Dim i As Long, x As Variant, y As Variant\n\n  For Each area In Selection.Areas\n      For i = 1 To area.Rows.Count\n          x = area.Cells(i, 1).Value\n          y = area.Cells(i, 2).Value\n          Debug.Print area.Address\n      Next i\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Following up on your comment, i get the below when i have selected those rows in my screenshot.\n<a href=\"https://i.stack.imgur.com/5Kw4W.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Kw4W.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 27, "user_id": 2431986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f577ef7e9a7c6b653c06d57dad2abd?s=128&d=identicon&r=PG", "display_name": "Youri Kamperman", "link": "https://stackoverflow.com/users/2431986/youri-kamperman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 58197906, "answer_count": 1, "score": 0, "last_activity_date": 1570019778, "creation_date": 1570002767, "last_edit_date": 1570019778, "question_id": 58197316, "link": "https://stackoverflow.com/questions/58197316/how-to-get-full-selection-from-excel-sheet-using-vba-without-the-filtered-rows-t", "title": "How to get full selection from Excel sheet using VBA without the filtered rows that are in between", "body": "<p>I am trying to get a selection from a worksheet in Excel using VBA, to use this selection as input for a next step of analysis on the data.\nThis works fine, until you make a selection that has filtered rows in between. In that case it will only get the part of the range that is before the filtered rows.</p>\n\n<p>How can I also get the selected row(s) after the filtered rows?</p>\n\n<p>Below is the code that I use for getting the selected rows from the sheet, and an example of a selection where the code does not work as intended.</p>\n\n<pre><code>    For Each area In Selection.Areas\n        Set newRange = area\n        Set rnge = Selection.SpecialCells(xlCellTypeVisible)\n        For i = 1 To rnge.Rows.Count\n            x = rnge.Cells(i, 5).Value\n            y = rnge.Cells(i, 6).Value\n            Write #1, x, y\n        Next i\n    Next\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/s2OGc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s2OGc.png\" alt=\"enter image description here\"></a></p>\n\n<p>Update: using the code below, I got it to work, thanks to SNicolaou's answer</p>\n\n<pre><code>    Set rnge = Selection.SpecialCells(xlCellTypeVisible)\n    For Each area In rnge.Areas\n        For i = 1 To area.Rows.Count\n            x = area.Cells(i, 5).Value\n            y = area.Cells(i, 6).Value\n            Write #1, x, y\n        Next i\n    Next\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570001000, "post_id": 58196880, "comment_id": 102772132, "body": "Do you have a problem with your code? What is your question?"}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "reply_to_user": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570001289, "post_id": 58196880, "comment_id": 102772254, "body": "the code I have is a problem cause its not working, any suggestion to help me? :( sorry i just new here and I dont really know how is that now working. Its working if the date formats is &quot;yyyy/dd/mm&quot; but if time included on format its gonna become this &quot;yyyy/dd/mm h:mm&quot; and its not working. I tried many answers i got in here but none of that help me :( or i just couldn&#39;t understand it :("}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570004154, "post_id": 58197577, "comment_id": 102773523, "body": "oops my bad, i forgot that. The format i looking for is this &quot;01/10/2018 4:20&quot;"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570004270, "post_id": 58197577, "comment_id": 102773566, "body": "Then just replace the criteria with <code>&quot;=01&#47;10&#47;2018 4:20&quot;</code>, as I said in my answer."}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570004828, "post_id": 58197577, "comment_id": 102773838, "body": "sir M.schalk huhu its still not working, yes the code run and input the filter value on filter data on uqual but I need to re-enter or hit ok button first to appear what i filter"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570005073, "post_id": 58197577, "comment_id": 102773969, "body": "So what exactly happens when you run the code? Do you get an empty table with all data filtered out?"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570005717, "post_id": 58197577, "comment_id": 102774285, "body": "I&#39;d need a screenshot of your unfiltered data for further advice"}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570006337, "post_id": 58197577, "comment_id": 102774567, "body": "Mr m.schalk i got link of screenshot above of my post. Please check it :) thank youuu"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570006925, "post_id": 58197577, "comment_id": 102774881, "body": "Thanks, but I need a screenshot of your data BEFORE applying the filter."}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570007662, "post_id": 58197577, "comment_id": 102775233, "body": "here&#39;s the image mr.Schalk <a href=\"https://i.stack.imgur.com/ligeB.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/ligeB.png</a>. sorry bout&#39; that hehe"}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570007905, "post_id": 58197577, "comment_id": 102775355, "body": "Thanks. Are you sure the date &quot;01/10/2018 4:20&quot; is in your data? Everything else looks fine. You could also use the alternative answer provided by JvDV"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1570009603, "post_id": 58197577, "comment_id": 102776218, "body": "This whole filter story becomes a funny side-quest for me now. I&#39;m on a system that uses local comma as decimal point and something like  <code>Dim SearchNum As Double: SearchNum = DateValue(&quot;01&#47;10&#47;2018&quot;) + TimeValue(&quot;4:20&quot;)</code> and then use <code>SearchNum</code> as criteria would not work for me. Strange."}, {"owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "edited": false, "score": 0, "creation_date": 1570009832, "post_id": 58197577, "comment_id": 102776333, "body": "It also did some funky stuff on my system. I applied a filter via VBA, which left me with a blank table. Then when I copied the criteria that were applied and compared it to my table via worksheet functions it found all the correct matches."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1570011234, "post_id": 58197577, "comment_id": 102777005, "body": "I asked the community <a href=\"https://stackoverflow.com/q/58199518/9758194\">here</a>. Not sure you had the same issue."}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 1, "creation_date": 1570016318, "post_id": 58197577, "comment_id": 102779322, "body": "yeap, im sure that date value is in my data. and before i doing this algo im testing it by manual to sure there\u2019s gonna be results"}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570070485, "post_id": 58197577, "comment_id": 102800501, "body": "just to add, i just figured that it cant filter by custom format. I tried changing all the date format to &quot;short date&quot; which is &quot;dd/mm/yyy&quot; (01/10/2018). and changing a bit of code .Criteria1:=CDate(&quot;2018/10/01&quot;). And it works fine. But i still need the custom format to filter perfectly :("}], "tags": [], "owner": {"reputation": 2081, "user_id": 9173379, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/0Y0Yl.jpg?s=128&g=1", "display_name": "riskypenguin", "link": "https://stackoverflow.com/users/9173379/riskypenguin"}, "is_accepted": false, "score": 1, "last_activity_date": 1570004277, "last_edit_date": 1570004277, "creation_date": 1570003741, "answer_id": 58197577, "question_id": 58196880, "link": "https://stackoverflow.com/questions/58196880/filtering-date-with-format-dd-mm-yyyy-hmm/58197577#58197577", "title": "filtering date with format &quot;dd/mm/yyyy h:mm&quot;", "body": "<p>I played around with your code and the filtering behavior is indeed weird in some instances. What fixed it for me is setting the <code>.Criteria</code> like this:</p>\n\n<pre><code>Sub qwe()\n ThisWorkbook.Sheets(\"book\").Range(\"f1\").AutoFilter Field:=6, Criteria1:=\"=2018/10/1 4:20\"\nEnd Sub\n</code></pre>\n\n<p>For this to work you need to make sure that your data is formatted like the <code>.Criteria</code>: <code>yyyy/mm/dd h:mm</code>.</p>\n\n<p>Please note that this is not the format you explicitly requested in your question (<code>dd/mm/yyyy h:mm</code>). If your data is formatted like that you will need to set the <code>.Criteria</code> like this: <code>\"=01/10/2018 4:20\"</code></p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570006558, "post_id": 58198010, "comment_id": 102774674, "body": "i tried it. But its not working either. And the format what I looking for is not in general, it is on custom &quot;dd/mm/yyyy h:mm&quot;"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570090780, "post_id": 58198010, "comment_id": 102806330, "body": "@user10182078, I posted a question myself <a href=\"https://stackoverflow.com/q/58199518/9758194\">here</a> with a working workaround (at least for me). See how I used format to specify my timevalue? You might need something similar for your datevalue too."}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570094019, "post_id": 58198010, "comment_id": 102808021, "body": "does it work ? i tried to use it but still empty table has shown"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570094094, "post_id": 58198010, "comment_id": 102808058, "body": "@user10182078, it does work for me (obviously you need to make some format adjustments in the code if need be). Can you upload a workbook with a sample of your data? I can have a look and maybe can try to make it work that way?"}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570148101, "post_id": 58198010, "comment_id": 102831486, "body": "sure, i just uploaded in here <a href=\"https://drive.google.com/open?id=1h3PVzrTeSvbTiFqlbEuL2BvuHZ2ZgTWS\" rel=\"nofollow noreferrer\">drive.google.com/open?id=1h3PVzrTeSvbTiFqlbEuL2BvuHZ2ZgTWS</a>"}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570165936, "post_id": 58198010, "comment_id": 102834753, "body": "take a look Thanksss :("}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570186044, "post_id": 58198010, "comment_id": 102842961, "body": "@user10182078, i edited my answer with some code that worked perfectly for me on the data you just sent me."}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570288157, "post_id": 58198010, "comment_id": 102869669, "body": "Mr. Jvdv did you change any formats on the data i sent to you? such as date formats? based on your answer, where does &quot;7&quot; seconds in timeserial come from?"}, {"owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "edited": false, "score": 0, "creation_date": 1570288965, "post_id": 58198010, "comment_id": 102869881, "body": "Mr. Jvdv Thank you for helping me!! :)) i just figure it with the help of your answer :D on my first try on your updated answer, its still now working. I just remove one &quot;h&quot; on format just like this Format(TimeSerial(4, 41, 7), &quot;h:mm&quot;) And it does perfectly work. Thank you for your help mister Jvdv!! ^_^"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1570186014, "last_edit_date": 1570186014, "creation_date": 1570005425, "answer_id": 58198010, "question_id": 58196880, "link": "https://stackoverflow.com/questions/58196880/filtering-date-with-format-dd-mm-yyyy-hmm/58198010#58198010", "title": "filtering date with format &quot;dd/mm/yyyy h:mm&quot;", "body": "<p>Try the following:</p>\n\n<pre><code>Sub test()\n\nDim str As String: str = DateSerial(2018, 10, 1) &amp; \" \" &amp; Format(TimeSerial(4, 41, 7), \"hh:mm\")\nThisWorkbook.Sheets(\"book\").Range(\"f1\").AutoFilter Field:=6, Criteria1:=str\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10182078, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nXkun05alyc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxazqVX3prLLUnpAq8mxm6fZEr5g/mo/photo.jpg?sz=128", "display_name": "user10182078", "link": "https://stackoverflow.com/users/10182078/user10182078"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 387, "favorite_count": 0, "accepted_answer_id": 58198010, "answer_count": 2, "score": 0, "last_activity_date": 1570186014, "creation_date": 1570000892, "last_edit_date": 1570065364, "question_id": 58196880, "link": "https://stackoverflow.com/questions/58196880/filtering-date-with-format-dd-mm-yyyy-hmm", "title": "filtering date with format &quot;dd/mm/yyyy h:mm&quot;", "body": "<p><a href=\"https://i.stack.imgur.com/ligeB.png\" rel=\"nofollow noreferrer\">here's</a> the screenshots of unfiltered data </p>\n\n<pre><code>Sub qwe()\n     ThisWorkbook.Sheets(\"book\").Range(\"f1\").AutoFilter Field:=6, Criteria1:=CDate(\"2018/10/1 4:20\")\n    End Sub\n</code></pre>\n\n<p>i need to filter date with a custom format of \"dd/mm/yyyy h:mm\" </p>\n"}, {"tags": ["excel", "vba", "for-loop"], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 11066955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78732e6aa0a129059d1a7e1a24985138?s=128&d=identicon&r=PG&f=1", "display_name": "hkml", "link": "https://stackoverflow.com/users/11066955/hkml"}, "edited": false, "score": 0, "creation_date": 1570001491, "post_id": 58196913, "comment_id": 102772349, "body": "Did not work. Gives me a runtime error &#39;1004&#39; and will not run through the entire workbook."}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "reply_to_user": {"reputation": 179, "user_id": 11066955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78732e6aa0a129059d1a7e1a24985138?s=128&d=identicon&r=PG&f=1", "display_name": "hkml", "link": "https://stackoverflow.com/users/11066955/hkml"}, "edited": false, "score": 0, "creation_date": 1570001582, "post_id": 58196913, "comment_id": 102772391, "body": "@hkml it is expected if there are no cells with category as <code>xlErrors</code>."}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "reply_to_user": {"reputation": 179, "user_id": 11066955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78732e6aa0a129059d1a7e1a24985138?s=128&d=identicon&r=PG&f=1", "display_name": "hkml", "link": "https://stackoverflow.com/users/11066955/hkml"}, "edited": false, "score": 0, "creation_date": 1570001647, "post_id": 58196913, "comment_id": 102772424, "body": "@hkml See the Error handler part at the end"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 1, "creation_date": 1570001719, "post_id": 58196913, "comment_id": 102772455, "body": "@pierre44 you can use <code>If Not Sheets(I).Cells.SpecialCells(xlCellTypeFormulas, xlErrors) is nothing then Sheets(I).Cells.SpecialCells(xlCellTypeFormulas, xlErrors).EntireRow.Delete</code> instead of <code>On Error</code> part."}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": true, "score": 5, "last_activity_date": 1570001474, "last_edit_date": 1570001474, "creation_date": 1570001028, "answer_id": 58196913, "question_id": 58196862, "link": "https://stackoverflow.com/questions/58196862/loop-through-entire-workbook-and-delete-rows-that-have-n-a/58196913#58196913", "title": "Loop through entire workbook and delete rows that have #N/A", "body": "<p>You just forgot to use your \"I\" in your loop:<br>\nif you simply add <code>Sheets(I).</code> your line will work in every sheet of the workbook.</p>\n\n<pre><code>Sub RemoveErrorsLoop()\n         Dim WS_Count As Integer\n         Dim I As Integer\n\n         ' Set WS_Count equal to the number of worksheets in the active\n         ' workbook.\n         WS_Count = ActiveWorkbook.Worksheets.Count\n\n         ' Begin the loop.\n         For I = 1 To WS_Count\n             Sheets(I).Cells.SpecialCells(xlCellTypeFormulas, xlErrors).EntireRow.Delete\n         Next I\n\nEnd Sub\n</code></pre>\n\n<p>I would even add an error handler to let the code work when you don't have #N/A in the sheet. </p>\n\n<pre><code>         For I = 1 To WS_Count\n            On Error Resume Next\n               Sheets(I).Cells.SpecialCells(xlCellTypeFormulas,xlErrors).EntireRow.Delete\n            On Error GoTo 0\n         Next I\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 11066955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78732e6aa0a129059d1a7e1a24985138?s=128&d=identicon&r=PG&f=1", "display_name": "hkml", "link": "https://stackoverflow.com/users/11066955/hkml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 58196913, "answer_count": 1, "score": 2, "last_activity_date": 1570001474, "creation_date": 1570000791, "last_edit_date": 1570001021, "question_id": 58196862, "link": "https://stackoverflow.com/questions/58196862/loop-through-entire-workbook-and-delete-rows-that-have-n-a", "title": "Loop through entire workbook and delete rows that have #N/A", "body": "<p>I have a workbook with 11 sheets. I need to delete the rows in all sheets where #N/A appears. How would I go about doing this?</p>\n\n<p>I have written out some code, see below, that allows me to delete only the #N/A rows that appear when my excel file is open to that specific tab. It will not loop through the entire workbook. </p>\n\n<pre><code>Sub RemoveErrorsLoop()\n\n     Dim WS_Count As Integer\n     Dim I As Integer\n\n     ' Set WS_Count equal to the number of worksheets in the active\n     ' workbook.\n     WS_Count = ActiveWorkbook.Worksheets.Count\n\n     ' Begin the loop.\n     For I = 2 To WS_Count\n         Cells.SpecialCells(xlCellTypeFormulas, xlErrors).EntireRow.Delete\n     Next I\n\nEnd Sub\n</code></pre>\n\n<p>I want code that will loop through all of my sheets and remove the rows that have #N/A. Thanks for any help!</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 674, "user_id": 11758142, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8eCxl.jpg?s=128&g=1", "display_name": "EddiGordo", "link": "https://stackoverflow.com/users/11758142/eddigordo"}, "is_accepted": false, "score": 0, "last_activity_date": 1569999353, "creation_date": 1569999353, "answer_id": 58196553, "question_id": 58196333, "link": "https://stackoverflow.com/questions/58196333/run-time-error-91-object-variable-or-with-block-variable-not-set-when-attac/58196553#58196553", "title": "&#39;Run-time error &#39;91&#39;: Object variable or With block variable not set&#39; when attaching a file", "body": "<p>You treat variable ClientDirectory as an object but in original code it is a simple string. That is why your line : </p>\n\n<pre><code>ClientDirectory = \"S:\\Client Folder\\\" &amp; JobLocation &amp; \"\\Site Drawings\\\"\n</code></pre>\n\n<p>fail.</p>\n\n<p>Also you missed that this variable is used in a Dir operation that store its result in requiredPDFs variable. That is that variable that contains file names.</p>\n"}], "owner": {"reputation": 21, "user_id": 11827982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c017e22cc0c56ae77b7f8ea29aeb068f?s=128&d=identicon&r=PG&f=1", "display_name": "QuickAccount", "link": "https://stackoverflow.com/users/11827982/quickaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574242367, "creation_date": 1569998324, "last_edit_date": 1574242367, "question_id": 58196333, "link": "https://stackoverflow.com/questions/58196333/run-time-error-91-object-variable-or-with-block-variable-not-set-when-attac", "title": "&#39;Run-time error &#39;91&#39;: Object variable or With block variable not set&#39; when attaching a file", "body": "<p>I am trying to scrape a directory for all the files in it, and only attach the most recently modified file.</p>\n\n<p>I have code that will attach files.</p>\n\n<p>I started off with code that is essentially like this</p>\n\n<pre><code>Dim JobLocation As String\nJobLocation = InputBox(\"What is the Clients Name ?\")\nClientDirectory = \"S:\\Client Folder\\\" &amp; JobLocation &amp; \"\\Site Drawings\\\"\nRequiredPDFs = Dir(ClientDirectory &amp; \"*.pdf\")\nDo While Len(RequiredPDFs) &gt; 0\n    .Attachments.Add ClientDirectory &amp; RequiredPDFs\n    RequiredPDFs = Dir\nLoop\n</code></pre>\n\n<p>I want to adapt the code to find the file that was last modified and only attach that file.</p>\n\n<pre><code>Sub Test()\n\nDim JobLocation As String\nDim objFile As Object\nDim dLastModifiedDate As Date\nDim strLastModifiedFilePath As String\nDim objMail As Outlook.MailItem\nDim ClientDirectory As Object\n\nJobLocation = InputBox(\"What is the Clients Name ?\")\nClientDirectory = \"S:\\Client Folder\\\" &amp; JobLocation &amp; \"\\Site Drawings\\\"\n\nIf ClientDirectory.Files.Count &gt; 0 Then\n    For Each objFile In ClientDirectory.Files\n        If (objFile.DateLastModified &gt; dLastModifiedDate) Then\n            strLastModifiedFilePath = objFile.Path\n            dLastModifiedDate = objFile.DateLastModified\n        End If\n    Next\n\n  If strLastModifiedFilePath &lt;&gt; \"\" Then\n      Set objMail = Outlook.Application.ActiveInspector.CurrentItem\n      objMail.Attachments.Add strLastModifiedFilePath\n  End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I expected this to crawl through each file, compare it to the next and then attach that which was the LastModified.</p>\n\n<p>It throws the following error:</p>\n\n<blockquote>\n  <p>'Run-time error '91': Object variable or With block variable not set'</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1569996030, "post_id": 58195956, "comment_id": 102770275, "body": "You are going to need a loop... If performance/speed is your concern, you can always drop the range into an array, loop there and paste it back to the range."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1570002227, "post_id": 58195956, "comment_id": 102772693, "body": "the type mismatch is because <code>.Value</code> is returning an <i>array</i>, and <code>+</code> doesn&#39;t work on arrays."}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1569998065, "creation_date": 1569998065, "answer_id": 58196285, "question_id": 58195956, "link": "https://stackoverflow.com/questions/58195956/is-there-a-concise-way-to-do-rangea1a10-value-rangea1a10-value-1-i/58196285#58196285", "title": "Is there a concise way to do Range(&quot;A1:A10&quot;).Value = Range(&quot;A1:A10&quot;).Value + 1 in vba", "body": "<p>Not sure if this is really concise but instead of copying the values to an array, add in a loop 1 and then write it back you could try the following code</p>\n\n<pre><code>Sub Test()\n\n    Dim rg1 As Range, rg2 As Range\n    Dim addVal As Long\n\n    addVal = 1\n    Set rg1 = Range(\"A1:A10\")\n\n    Set rg2 = rg1.Offset(, 1)\n    rg2.Formula = \"=RC[-1]+\" &amp; addVal\n\n    rg1.Value = rg2.Value\n    rg2.Clear\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 1, "last_activity_date": 1569998339, "creation_date": 1569998339, "answer_id": 58196335, "question_id": 58195956, "link": "https://stackoverflow.com/questions/58195956/is-there-a-concise-way-to-do-rangea1a10-value-rangea1a10-value-1-i/58196335#58196335", "title": "Is there a concise way to do Range(&quot;A1:A10&quot;).Value = Range(&quot;A1:A10&quot;).Value + 1 in vba", "body": "<p>This is what I'd do if you have a large chunk of data:</p>\n\n<pre><code>Option Explicit\nSub Increase_Decrease(UpOrDown As Long)\n\n    Dim LastRow As Long, i As Long\n    Dim arr As Variant\n\n    With ThisWorkbook.Sheets(\"MySheet\") 'Change MySheet for your sheet\n        LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row\n        arr = .Range(\"A1\", .Cells(LastRow, 1)).Value\n        For i = 1 To UBound(arr)\n            arr(i, 1) = arr(i, 1) + UpOrDown\n        Next i\n        .Range(\"A1\", .Cells(LastRow, 1)).Value = arr\n    End With\n\nEnd Sub\nSub Increase()\n\n    Increase_Decrease 1\n\nEnd Sub\nSub Decrease()\n\n    Increase_Decrease -1\n\nEnd Sub\n</code></pre>\n\n<p>Then you link your scroll up button to the Increase procedure, and the scroll down button to the decrease button.</p>\n"}, {"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1570003258, "creation_date": 1570003258, "answer_id": 58197444, "question_id": 58195956, "link": "https://stackoverflow.com/questions/58195956/is-there-a-concise-way-to-do-rangea1a10-value-rangea1a10-value-1-i/58197444#58197444", "title": "Is there a concise way to do Range(&quot;A1:A10&quot;).Value = Range(&quot;A1:A10&quot;).Value + 1 in vba", "body": "<p>You can do this without VBA as well.</p>\n\n<p>Demonstration setup will be</p>\n\n<p>Insert form control from <code>Developer &gt;&gt; Insert &gt;&gt; Form Controls &gt;&gt; Scroll Bar</code>.</p>\n\n<p>Parameters will be \nMinimum Value = 1\nMaximum Value = 100\nIncremental Change = 1\nPage Change = 10\nCell Link = <code>$B$1</code></p>\n\n<p>And then insert following formula in cell A1:\n<code>=ROW()-$B$1</code></p>\n\n<p>Copy down.</p>\n"}], "owner": {"reputation": 359, "user_id": 11752800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0738b66672d9042e140b75969ec18f?s=128&d=identicon&r=PG&f=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/11752800/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 58196335, "answer_count": 3, "score": 0, "last_activity_date": 1570003258, "creation_date": 1569995954, "last_edit_date": 1570001573, "question_id": 58195956, "link": "https://stackoverflow.com/questions/58195956/is-there-a-concise-way-to-do-rangea1a10-value-rangea1a10-value-1-i", "title": "Is there a concise way to do Range(&quot;A1:A10&quot;).Value = Range(&quot;A1:A10&quot;).Value + 1 in vba", "body": "<p>I have a bit of problem working with range variable. for example, I can directly do assignment on a range of cells like this:</p>\n\n<pre><code>Range(\"B1:B10\").Value = Range(\"A1:A10\").Value\n</code></pre>\n\n<p>However, is there a concise way to do increment of range of values then assignment, following is what i mean but resulted in type-mismatch error</p>\n\n<pre><code>Range(\"A1:A10\").Value = Range(\"A1:A10\").Value + 1 \n</code></pre>\n\n<p>Edit: Ultimately what i want to implement is a scroll_button, when _UP is clicked, all the cells in the range increase value by 1, when _Down is clicked, all the cells in the range decrease value by 1. What's the most efficient way to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569995403, "post_id": 58195808, "comment_id": 102770083, "body": "Shouldn&#39;t you be calling <code>AlignCommandButtonText</code> somewhere in your code?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1569997134, "post_id": 58195808, "comment_id": 102770621, "body": "A button has no <code>Refresh</code>-method. What do you want to achieve? Maybe just call <code>AlignCommandButtonText Button, BS_CENTER</code>"}, {"owner": {"reputation": 11, "user_id": 11602533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DmIrJVSAyig/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOxbfYwHwJ8lVpnI1b7moXz71t-Rg/mo/photo.jpg?sz=128", "display_name": "SofiaEd", "link": "https://stackoverflow.com/users/11602533/sofiaed"}, "edited": false, "score": 0, "creation_date": 1570006987, "post_id": 58195808, "comment_id": 102774911, "body": "Thomas - Your proposed call code didn&#39;t work.  Tim - To answer your question, please see two screenshots below -- Buttons, RunKoreanLanguageCode, ReturnToEnglishCode, and then Buttons in English alignment got changed!"}, {"owner": {"reputation": 11, "user_id": 11602533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DmIrJVSAyig/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOxbfYwHwJ8lVpnI1b7moXz71t-Rg/mo/photo.jpg?sz=128", "display_name": "SofiaEd", "link": "https://stackoverflow.com/users/11602533/sofiaed"}, "edited": false, "score": 0, "creation_date": 1570007103, "post_id": 58195808, "comment_id": 102774978, "body": "Still need a solution please?"}], "owner": {"reputation": 11, "user_id": 11602533, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DmIrJVSAyig/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOxbfYwHwJ8lVpnI1b7moXz71t-Rg/mo/photo.jpg?sz=128", "display_name": "SofiaEd", "link": "https://stackoverflow.com/users/11602533/sofiaed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570024372, "creation_date": 1569994957, "last_edit_date": 1570024372, "question_id": 58195808, "link": "https://stackoverflow.com/questions/58195808/vba-error-438-object-doesnt-support-centeralign-captions-of-command-button", "title": "VBA - Error 438 object doesn&#39;t support... CenterAlign captions of command buttons", "body": "<p>I'm getting an error 438 \"object doesn't support property...\" screenshot below.  My code below:  Objective is to center-align the caption/text of all command buttons on Userform1.  Why I'm getting this error?  How to fix it?</p>\n\n<pre><code>Option Explicit\n\n         '&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; Adapted from http://www.freevbcode.com/ShowCode.asp?ID=330\n\n#If VBA7 Then\n      Private Declare PtrSafe Function GetWindowLong&amp; Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long)\n      Private Declare PtrSafe Function SetWindowLong&amp; Lib \"user32\" Alias \"SetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long)\n#Else\n      Private Declare Function GetWindowLong&amp; Lib \"user32\" Alias \"GetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long)\n      Private Declare Function SetWindowLong&amp; Lib \"user32\" Alias \"SetWindowLongA\" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long)\n#End If\n\n'--------------------------------------------\n\nPublic Enum BUTTON_STYLE\n    BS_CENTER = &amp;H300&amp;\n    BS_LEFT = &amp;H100&amp;\n    BS_RIGHT = &amp;H200&amp;\n    BS_TOP = &amp;H400&amp;\nEnd Enum\n\n'--------------------------------------------\n\nPrivate Const GWL_STYLE&amp; = (-16)\n\nPublic Sub AlignCommandButtonText(Button As Object, Style As BUTTON_STYLE)\n      Dim lHwnd As Long\n      On Error Resume Next\n      lHwnd = Button.hwnd\n      Dim lWnd As Long\n      Dim lRet As Long\n      If lHwnd = 0 Then Exit Sub\n      lWnd = GetWindowLong(lHwnd, GWL_STYLE)\n      lRet = SetWindowLong(Command1.hwnd, GWL_STYLE, Style Or lWnd)\n      Button.Refresh\nEnd Sub\n\n\n'--------------------------------------------\n\nPublic Sub CenterAlignButtons()\n    For Each control_Object In UserForm1.Controls\n       If TypeName(control_Object) = \"CommandButton\" Then\n         Set Button = control_Object\n         Button.Refresh        '&lt;&lt;&lt;&lt;&lt;&lt;&lt; This method of calling is wrong, causing the error...?\n         DoEvents\n       End If\n    Next\nEnd Sub\n\n'--------------------------------------------\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/JZht3.jpg\" rel=\"nofollow noreferrer\">Error 438...</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Ao9od.jpg\" rel=\"nofollow noreferrer\">Before running language code</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Z5Evo.jpg\" rel=\"nofollow noreferrer\">After running language code</a></p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569993798, "post_id": 58195539, "comment_id": 102769688, "body": "You can&#39;t format after import - you have to declare the column type as part of the import process. Use the text import wizard:  <a href=\"https://support.office.com/en-us/article/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>   Or use Power Query if you know about that (and Google if not)"}, {"owner": {"reputation": 35, "user_id": 11950134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2457766977624026/picture?type=large", "display_name": "Walker Wayne", "link": "https://stackoverflow.com/users/11950134/walker-wayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569995075, "post_id": 58195539, "comment_id": 102769991, "body": "@TimWilliams Thanks for reply. So, i can&#39;t  format that after import the data, right ? I thought we can do that with vba. If we declare the column type before we import that, is that possible for me to import date again ( and result will hold 0 instead of delete it ) ?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569995230, "post_id": 58195539, "comment_id": 102770037, "body": "It&#39;s easy enough to test that by manually formatting the column and then importing.  If that works then you&#39;re good to go: if not then you need to format the data as part of the import as described in the link I posted in my comment."}, {"owner": {"reputation": 35, "user_id": 11950134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2457766977624026/picture?type=large", "display_name": "Walker Wayne", "link": "https://stackoverflow.com/users/11950134/walker-wayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569998989, "post_id": 58195539, "comment_id": 102771253, "body": "Thanks, i changed manually formatting the column and imported csv. But it still be deleted. i&#39;m not sure, i tried to import csv manually instead of csv but still..."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11950134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2457766977624026/picture?type=large", "display_name": "Walker Wayne", "link": "https://stackoverflow.com/users/11950134/walker-wayne"}, "edited": false, "score": 1, "creation_date": 1570000835, "post_id": 58195943, "comment_id": 102772049, "body": "Thanks! My problem has been solve. The point here is, i have to duplicated all the column that i have to declare to  .TextFileColumnDataTypes = Array(xlTextFormat,xlTextFormat,xlTextFormat,....)"}, {"owner": {"reputation": 35, "user_id": 11950134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2457766977624026/picture?type=large", "display_name": "Walker Wayne", "link": "https://stackoverflow.com/users/11950134/walker-wayne"}, "edited": false, "score": 0, "creation_date": 1570002661, "post_id": 58195943, "comment_id": 102772892, "body": "But, is that possible to declare all column instead of Array(2,2,2,2,2,2,2,2,2,2,2......) ? Because i&#39;m have to solve this problem with 100+ column"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570035060, "post_id": 58195943, "comment_id": 102789966, "body": "You could write a function which returns an array of <code>xlTextFormat</code> values of a specified size and call it like <code>.TextFileColumnDataTypes = TextFormatArray(100)</code>"}, {"owner": {"reputation": 35, "user_id": 11950134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2457766977624026/picture?type=large", "display_name": "Walker Wayne", "link": "https://stackoverflow.com/users/11950134/walker-wayne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1570086046, "post_id": 58195943, "comment_id": 102804149, "body": "@TimWilliams I did return in String like <code>.TextFileColumnDataTypes = Array(StringTypeVar)</code> but it has no reponse for this function. I find some reason, and i think that i can&#39;t count column while loading csv by vba"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1569995859, "creation_date": 1569995859, "answer_id": 58195943, "question_id": 58195539, "link": "https://stackoverflow.com/questions/58195539/changing-number-type-to-text-type-when-import-csv-by-vba/58195943#58195943", "title": "Changing Number type to Text type when import csv by vba", "body": "<p><em>Have you tried format the destination field</em> </p>\n\n<p><em>Example</em></p>\n\n<p><em><a href=\"https://docs.microsoft.com/en-us/office/vba/api/Excel.QueryTable.TextFileColumnDataTypes\" rel=\"nofollow noreferrer\">QueryTable.TextFileColumnDataTypes property</a></em></p>\n\n<blockquote>\n<pre><code>.TextFileColumnDataTypes = Array(xlTextFormat)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 35, "user_id": 11950134, "user_type": "registered", "profile_image": "https://graph.facebook.com/2457766977624026/picture?type=large", "display_name": "Walker Wayne", "link": "https://stackoverflow.com/users/11950134/walker-wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 58195943, "answer_count": 1, "score": 1, "last_activity_date": 1570021207, "creation_date": 1569993188, "last_edit_date": 1570021207, "question_id": 58195539, "link": "https://stackoverflow.com/questions/58195539/changing-number-type-to-text-type-when-import-csv-by-vba", "title": "Changing Number type to Text type when import csv by vba", "body": "<p>I got an import csv code below </p>\n\n<pre><code>Private Sub Workbook_Open()\n Dim xFileName As Variant\n    Dim Rg As Range\n    Dim xAddress As String\n    xFileName = Application.GetOpenFilename(\"CSV File (*.csv), *.csv\", , , , False)\n    If xFileName = False Then Exit Sub\n    On Error Resume Next\n    xAddress = Range(\"A1\").Address\n    With ActiveSheet.QueryTables.Add(\"TEXT;\" &amp; xFileName, Range(xAddress))\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 65001\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n\n<p>Normally, it worked but when import csv but some kind of column that has start with 0 number, then excel treat that cell as Number and delete ( hide ) all 0 begin cell.  </p>\n\n<p>I've tried to add this script in but that not work.</p>\n\n<pre><code>ActiveSheet.NumberFormat = \"@\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569992820, "post_id": 58195466, "comment_id": 102769419, "body": "This is a well-known (here at least) limitation of using UDF in Excel: see <a href=\"https://support.microsoft.com/en-us/help/170787/description-of-limitations-of-custom-functions-in-excel\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/170787/&hellip;</a>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1569996035, "post_id": 58195466, "comment_id": 102770278, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet\">Using a UDF in Excel to update the worksheet</a>"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1569993523, "creation_date": 1569993523, "answer_id": 58195588, "question_id": 58195466, "link": "https://stackoverflow.com/questions/58195466/put-results-of-a-vba-function-in-another-excel-cell/58195588#58195588", "title": "put results of a vba function in another excel cell", "body": "<p>...but here is a work-around using <code>Evaluate</code>:</p>\n\n<pre><code>Function myFunc(addrR As Range) As Integer\n\n    Dim wb, sht, addr\n\n    'where is the target cell?\n    addr = addrR.Address           'cell\n    sht = addrR.Parent.Name        'sheet\n    wb = addrR.Parent.Parent.Name  'workbook\n\n    'pass the location of the cell to be updated and the value to be inserted\n    Application.Evaluate \"SetIt(\"\"\" &amp; wb &amp; \"\"\",\"\"\" &amp; sht &amp; \"\"\",\"\"\" &amp; addr &amp; \"\"\",99)\"\n\n    myFunc = 88 'return a value to the calling cell\n\nEnd Function\n\n\n'Calling this using evaluate seems to bypass the restrictions\n'  Excel places on UDF's called from a worksheet\nFunction SetIt(wb As String, sht As String, addr As String, v)\n    Workbooks(wb).Sheets(sht).Range(addr).Value = v\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4898168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78bd986d2259ffd5a53f0546c6dc8ffa?s=128&d=identicon&r=PG", "display_name": "profSteve", "link": "https://stackoverflow.com/users/4898168/profsteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 58195588, "answer_count": 1, "score": 0, "last_activity_date": 1569993523, "creation_date": 1569992580, "last_edit_date": 1569992694, "question_id": 58195466, "link": "https://stackoverflow.com/questions/58195466/put-results-of-a-vba-function-in-another-excel-cell", "title": "put results of a vba function in another excel cell", "body": "<p>I need a VBA function that stores one of its results in a cell other than the cell that calls the function.  I have successfully passed to the function the address of that other cell.  My function works perfectly when called from another VBA macro, but when my function is called from a cell in an Excel worksheet it crashes with #VALUE! in the calling cell and without putting anything in the target cell.</p>\n\n<p>When I step through my function I see that it correctly has the address of the cell where I want to place a value.</p>\n\n<pre><code>Sub callMyFunc()     'when I call myFunc this way it works perfectly\n\n    Dim theAddrRang As Range, resp%\n\n    Set theAddrRang = Range(\"B17\")\n\n    resp = myFunc(theAddrRang)\n\n    MsgBox \"resp = \" &amp; resp\n\nEnd Sub  \n\n\n\nFunction myFunc(addrR As Range) As Integer  \n                        'If this function is called from worksheet it crashes\n    Dim theAddr$, addrRstr$\n\n    addrRstr = addrR.Address\n\n    theAddr = \"B14\"\n\n    MsgBox \"Two address strings: \" &amp; addrRstr &amp; \"    \" &amp; theAddr\n\n    Worksheets(\"Linda\").Range(theAddr).Value = 44      'B14   crashes at this step\n\n    Worksheets(\"Linda\").Range(addrRstr).Value = 66     'B17\n\n    myFunc = 88\n\nEnd Function       \n</code></pre>\n\n<p>I want function myFunc to put the values 44 and 66 in cells B14 and B17.  When I call my function from another macro it works perfectly.  When I type into a cell on my worksheet the following:  =myFunc(B17) , it correctly shows the message box with two addresses and then crashes on the next line of code. (Two addresses just to test that both work; I really need only the one passed as argument.)</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569995265, "post_id": 58195319, "comment_id": 102770049, "body": "Have you step-debugged? You will see that prevAddress is receiving the new value entered, not old value. So even if you did not get error, would not set combobox to previous input."}, {"owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569995405, "post_id": 58195319, "comment_id": 102770084, "body": "Yeah you are right just realized that"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1569996925, "post_id": 58195319, "comment_id": 102770554, "body": "Why do you need to micro-manage user input to UNBOUND control?"}, {"owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570036342, "post_id": 58195319, "comment_id": 102790571, "body": "I just learnt that the before update event fires after the combo box value change even in the bound control. To mitigate this I added :  <code>Me.cboSelectAddress.Undo</code> if the user selects no."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1570051135, "post_id": 58195319, "comment_id": 102796705, "body": "You can write answer to your own question."}], "answers": [{"tags": [], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "is_accepted": false, "score": 0, "last_activity_date": 1570075003, "creation_date": 1570075003, "answer_id": 58212102, "question_id": 58195319, "link": "https://stackoverflow.com/questions/58195319/ms-access-before-update-cancel-event-not-working-for-unbound-combo-box/58212102#58212102", "title": "MS Access before update cancel event not working for unbound combo box", "body": "<p>I just learnt that the before update event fires after the combo box value change even in the bound control. To mitigate this I added : <code>Me.cboSelectAddress.Undo</code> if the user selects no</p>\n"}], "owner": {"reputation": 895, "user_id": 10818509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3c36f15912146c6d0f1201f89a5d0e?s=128&d=identicon&r=PG&f=1", "display_name": "jedu", "link": "https://stackoverflow.com/users/10818509/jedu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594421634, "creation_date": 1569991333, "last_edit_date": 1594421634, "question_id": 58195319, "link": "https://stackoverflow.com/questions/58195319/ms-access-before-update-cancel-event-not-working-for-unbound-combo-box", "title": "MS Access before update cancel event not working for unbound combo box", "body": "<p>I have a combo box in Access that has a row source that is bound to a table but does not share the same record source as the form. I want the user to be able to select items from the drop down box but I want to give them a warning before they change stuff and if they say no then undo the changes like this:</p>\n\n<pre><code>Private Sub cboSelectAddress_BeforeUpdate(Cancel As Integer)\n    Dim rs As New ADODB.Recordset\n    Dim prevAddress As String\n\n    'prevAddress = Me.cboSelectAddress.Value\n\n    If MsgBox(\"Are You sure you want to change the value of the combo box?\", vbQuestion + vbYesNo + vbDefaultButton2, \"CTNO change altert\") = vbYes Then\n\n        'DO SOMETHING\n    Else\n        'Me.cboSelectAddress.Value = prevAddress\n        Cancel = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>As soon as I change the value of the combo box the value of the combo box changes and then and only then does the before_update event fires. </p>\n\n<p>To mitigate this, I tried to store the value of the address box before change and set it back to the original value if the user selects <code>NO</code> but this produces an error as well because it tries to go through the before update event itself. As you can see I have commented out that portion of the code.</p>\n"}, {"tags": ["excel", "vba", "progress-bar", "userform"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1569990989, "post_id": 58195044, "comment_id": 102769058, "body": "I forgot the Userform Code. Edited. This procedure is called from the Userform itself in order to hide the Title Bar. <code>&quot;Delete Zero&quot;</code> procedure it is taking too much time to delete all zero and &quot;&quot; values so I need to find some other way. That&#180;s why I introduce this bar. In normal use, I don&#180;t want to allow that the user can stop the procedure or close this progress bar. It is the first time that I am trying to use a progress bar. My previous trials, as they are having too much activity applying formats, as soon as I keep Application.ScreenUpdating = False, the progress bar didn&#180;t work."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1569991094, "post_id": 58195044, "comment_id": 102769079, "body": "Why don&#39;t you just disable the close button? And there are other ways to prevent a macro from completing (such as ctrl + pause) that is difficult to circumvent."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1569992129, "post_id": 58195044, "comment_id": 102769266, "body": "And your progress bar &quot;not working&quot; is what I assume to actually be &quot;not updating&quot;. People use <code>DoEvents</code> for various reasons, but the actual usage for this is to redraw your userform. So if your progress bar is not moving, then add a <code>DoEvents</code> line in your code to allow it to redraw itself."}, {"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1569994305, "post_id": 58195044, "comment_id": 102769808, "body": "My users have no idea of Ctrl+Pause Combo, so I was thinking in something more obvious. My previous approaches were with a custom chart that I can not refresh (as much as I know) with a DoEvents. You are right and I forgot to implement in my code."}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 0, "creation_date": 1569994477, "post_id": 58195326, "comment_id": 102769844, "body": "I like it. It is much better to not to hide the Title bar and capture the close button. I did not think on it. Thanks"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 1, "last_activity_date": 1569991674, "last_edit_date": 1569991674, "creation_date": 1569991369, "answer_id": 58195326, "question_id": 58195044, "link": "https://stackoverflow.com/questions/58195044/why-can%c2%b4t-i-hide-the-title-bar-on-a-progress-bar/58195326#58195326", "title": "Why Can&#180;t I hide the Title bar on a Progress bar?", "body": "<p>If you are just wanting to prevent a user from clicking the <code>X</code> close button, then you don't need to jump through a bunch of hoops to hide the title bar. Simply capture the event and cancel the request.</p>\n\n<p>In your userform code module, paste this code:</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n\n    Cancel = True\n\nEnd Sub\n</code></pre>\n\n<p>And that's all there is to it.</p>\n\n<hr>\n\n<p>Want to make it more sophisticated? Well, you can prompt the user first.</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n\n    if Inputbox(\"If you are sure you want to stop the procedure, please type the \" &amp; _\n                                                    \"word 'STOP'\") = \"STOP\" then\n        Cancel = False\n\n    Else\n\n        Cancel = True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 58195326, "answer_count": 1, "score": 1, "last_activity_date": 1569991674, "creation_date": 1569988887, "last_edit_date": 1569990542, "question_id": 58195044, "link": "https://stackoverflow.com/questions/58195044/why-can%c2%b4t-i-hide-the-title-bar-on-a-progress-bar", "title": "Why Can&#180;t I hide the Title bar on a Progress bar?", "body": "<p>I am trying to use some code from <a href=\"https://wellsr.com/vba/2017/excel/beautiful-vba-progress-bar-with-step-by-step-instructions/\" rel=\"nofollow noreferrer\">here</a>.\nI have checked in some programmings forums and it seems to be ok. But I am getting a 438 error on showing an Userform used as progress bar. I don\u00b4t have any knowledge at all on how to use libraries (It is my first time).</p>\n\n<p>The Header Code:</p>\n\n<pre><code>Option Explicit\nOption Private Module\n\n' FROM https://wellsr.com/vba/2017/excel/beautiful-vba-progress-bar-with-step-by-step-instructions/\nPublic Const GWL_STYLE = -16\nPublic Const WS_CAPTION = &amp;HC00000\n#If VBA7 Then\n    Public Declare PtrSafe Function GetWindowLong _\n                           Lib \"user32\" Alias \"GetWindowLongA\" ( _\n                           ByVal hWnd As Long, _\n                           ByVal nIndex As Long) As Long\n    Public Declare PtrSafe Function SetWindowLong _\n                           Lib \"user32\" Alias \"SetWindowLongA\" ( _\n                           ByVal hWnd As Long, _\n                           ByVal nIndex As Long, _\n                           ByVal dwNewLong As Long) As Long\n    Public Declare PtrSafe Function DrawMenuBar _\n                           Lib \"user32\" ( _\n                           ByVal hWnd As Long) As Long\n    Public Declare PtrSafe Function FindWindowA _\n                           Lib \"user32\" (ByVal lpClassName As String, _\n                           ByVal lpWindowName As String) As Long\n#Else\n    Public Declare Function GetWindowLong _\n                           Lib \"user32\" Alias \"GetWindowLongA\" ( _\n                           ByVal hWnd As Long, _\n                           ByVal nIndex As Long) As Long\n    Public Declare Function SetWindowLong _\n                           Lib \"user32\" Alias \"SetWindowLongA\" ( _\n                           ByVal hWnd As Long, _\n                           ByVal nIndex As Long, _\n                           ByVal dwNewLong As Long) As Long\n    Public Declare Function DrawMenuBar _\n                           Lib \"user32\" ( _\n                           ByVal hWnd As Long) As Long\n    Public Declare Function FindWindowA _\n                           Lib \"user32\" (ByVal lpClassName As String, _\n                           ByVal lpWindowName As String) As Long\n#End If\n</code></pre>\n\n<p>Procedure to hide the Title bar</p>\n\n<pre><code>Sub HideTitleBar(frm As Object)\n    Dim lngWindow As Long\n    Dim lFrmHdl As Long\n\n    lFrmHdl = FindWindowA(vbNullString, frm.Caption)\n    lngWindow = GetWindowLong(lFrmHdl, GWL_STYLE)\n    lngWindow = lngWindow And (Not WS_CAPTION)\n    Call SetWindowLong(lFrmHdl, GWL_STYLE, lngWindow)\n    Call DrawMenuBar(lFrmHdl)\nEnd Sub\n</code></pre>\n\n<p>When I try to show the Userform I got a constant 438 error on line: <code>lFrmHdl = FindWindowA(vbNullString, frm.Caption)</code>. I did not find why.</p>\n\n<p>The Macro I have created to call this Userform:</p>\n\n<pre><code>Sub Delete_Zero()\nDim LastRow As Long\nDim LastCol As Long\nDim i As Long\nDim j As Long\nDim pctdone As Single\n\n\n'(Step 1) Display your Progress Bar\nufProgress.LabelProgress.Width = 0\nufProgress.Show vbModeless\n\nLastRow = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row\nLastCol = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Column\nFor i = 1 To LastRow\n    For j = 1 To LastCol\n        If Cells(i, j).Value2 = 0 Or Cells(i, j).Value2 = \"\" Then\n            Cells(i, j).ClearContents\n        End If\n    Next j\n    '(Step 2) Update Progress Bar\n    pctdone = i / LastRow\n    With ufProgress\n        .LabelCaption.Caption = \"Processing Row \" &amp; i &amp; \" of \" &amp; LastRow\n        .LabelProgress.Width = pctdone * (.FrameProgress.Width)\n    End With\n    ufProgress.Repaint\n    '(Step 3) Unload Progress Bar\n    If i = LastRow Then Unload ufProgress\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Any help will be appreciated.</p>\n\n<p>UPDATE 1:\nI forgot to attach the code in the Userform:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    Me.Height = Me.Height - 10\n    HideTitleBar.HideTitleBar Me\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1569985172, "post_id": 58194579, "comment_id": 102768132, "body": "How many rows/columns are involved?"}, {"owner": {"reputation": 1732, "user_id": 11982798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99629abfd4d6ce4b3702d84cf1a1eef0?s=128&d=identicon&r=PG&f=1", "display_name": "user11982798", "link": "https://stackoverflow.com/users/11982798/user11982798"}, "edited": false, "score": 0, "creation_date": 1569987625, "post_id": 58194579, "comment_id": 102768507, "body": "Get your last row of used range, Paste the copied rows below the usedrange row at colomn A, delete row from row 1 to your saved Last Row (last row of previous used range)"}, {"owner": {"reputation": 1, "user_id": 5096096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1dcd82fa0c77ca09145b6d622d462a?s=128&d=identicon&r=PG&f=1", "display_name": "Nippers", "link": "https://stackoverflow.com/users/5096096/nippers"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1569989242, "post_id": 58194579, "comment_id": 102768784, "body": "@MathieuGuindon, I&#39;m currently using this macro on sheets with around 10 rows and columns, but I need it to be flexible about the ranges involved."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1570002076, "post_id": 58194674, "comment_id": 102772629, "body": "Since you ask, the DV was placed prior to your edits.  That version simply didn&#39;t work.  BTW the edited version still has issues. Consider what happens if UsedRange doesn&#39;t start at A1.  Also the OP is unclear on a few points: do they want to transpose formatting?   What if the transposed range contains Formulas?  What if other cells have formulas referring to the transposed range?"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1570002812, "post_id": 58194674, "comment_id": 102772953, "body": "@chris neilsen It is pretty obvious what the OPs intent is, both in written context and via code.  While the specific cases you mention are noteworthy in a larger context, they are irrelevant to the OPs question."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1570003421, "post_id": 58194674, "comment_id": 102773198, "body": "The OP has clearly stumbled on the PasteSpecial part. How do <i>you</i> know that other issues wouldn&#39;t become a factor after they solve that bit?  And answers on SO are as much for future readers as the OP.  If you don&#39;t want to address those issues in your answer  that&#39;s fine,  but at least mention there existence."}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1570006303, "post_id": 58194674, "comment_id": 102774554, "body": "@chris neilsen I am a bit dense, I just came about to agreeing with your first comment because you were absolutely right about formulas and formats; I had not considered I was only bringing values.  But I&#39;ll draw the line at divination.  If other factors come into play then another question should be made.  Post updated to reflect the OP&#39;s methods more accurately."}], "tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1570012229, "last_edit_date": 1570012229, "creation_date": 1569985061, "answer_id": 58194674, "question_id": 58194579, "link": "https://stackoverflow.com/questions/58194579/how-can-i-loop-over-sheets-in-an-excel-workbook-and-transpose-the-data-in-each-s/58194674#58194674", "title": "How can I loop over sheets in an Excel workbook and transpose the data in each sheet?", "body": "<p>You are getting that error because this line is pulling you out of Cut/Copy mode:</p>\n\n<p><code>Worksheets(i).Cells.ClearContents</code></p>\n\n<hr>\n\n<p>This transposes the <code>UsedRange</code> of every worksheet in the <code>ActiveWorkbook</code> and accommodates any number of columns or rows.</p>\n\n<pre><code>Sub TransposeIt()\n    Dim ws As Worksheet\n    Dim c As Long\n    Dim r As Long\n    Application.ScreenUpdating = False\n    For Each ws In ActiveWorkbook.Worksheets\n        With ws.UsedRange\n            c = .Columns.Count\n            r = .Rows.Count\n            .Copy\n        End With\n        With ws\n            .Cells(1, c + 1).PasteSpecial Transpose:=True\n            .Range(.Cells(1, 1), .Cells(1, c)).EntireColumn.Delete\n        End With\n    Next ws\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5096096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af1dcd82fa0c77ca09145b6d622d462a?s=128&d=identicon&r=PG&f=1", "display_name": "Nippers", "link": "https://stackoverflow.com/users/5096096/nippers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 131, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570012229, "creation_date": 1569984206, "question_id": 58194579, "link": "https://stackoverflow.com/questions/58194579/how-can-i-loop-over-sheets-in-an-excel-workbook-and-transpose-the-data-in-each-s", "title": "How can I loop over sheets in an Excel workbook and transpose the data in each sheet?", "body": "<p>I'm trying to write a VBA macro that will transpose the data on every sheet in an Excel workbook (turn the columns into rows and rows into columns).</p>\n\n<p>I've tried different versions of the following code, but PasteSpecial seems to cause problems when it's inside a loop.</p>\n\n<pre><code>Dim WS_Count As Integer\nDim i As Integer\n\nWS_Count = ActiveWorkbook.Worksheets.Count\n\nFor i = 1 To WS_Count\n    Worksheets(i).UsedRange.Copy\n    Worksheets(i).Cells.ClearContents\n    Worksheets(i).Range(\"A1\").PasteSpecial Transpose = True\nNext i\n</code></pre>\n\n<p>It gives me a run-time error '1004': PasteSpecial method of Range class failed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1569976894, "post_id": 58193823, "comment_id": 102766787, "body": "<code>Range(&quot;B1:H&quot; &amp; row2)</code> is referring to the active sheet..."}, {"owner": {"reputation": 51, "user_id": 11906577, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GTOD8wuMUGA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rduyPEgABloNiHHpjxVkziheWBbSQ/photo.jpg?sz=128", "display_name": "jack ryan", "link": "https://stackoverflow.com/users/11906577/jack-ryan"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1569978708, "post_id": 58193823, "comment_id": 102767076, "body": "@braX I have edited the code, but the borders are filling up ambiguously. If I run the script, sheet 4 is filling up with fine but borders of sheet 2 are getting filled with the range of sheet4"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1569981484, "post_id": 58193823, "comment_id": 102767500, "body": "Step through the code and verify that each time you get one of your lastrow variables you are getting what you expect."}, {"owner": {"reputation": 51, "user_id": 11906577, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GTOD8wuMUGA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rduyPEgABloNiHHpjxVkziheWBbSQ/photo.jpg?sz=128", "display_name": "jack ryan", "link": "https://stackoverflow.com/users/11906577/jack-ryan"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1569983892, "post_id": 58193823, "comment_id": 102767904, "body": "I have check the values of the variables and both of them have a different value(32 and 37) but the borders are getting drawn for both the sheets with the configuration of SHEET4 @braX"}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 0, "last_activity_date": 1569977568, "creation_date": 1569977568, "answer_id": 58193951, "question_id": 58193823, "link": "https://stackoverflow.com/questions/58193823/including-the-cell-borders-in-a-vba-script-for-dynamic-range/58193951#58193951", "title": "Including the cell borders in a vba script for dynamic range", "body": "<p>You are probably trying to do something like this (all instances of the sheet need to be qualified)</p>\n\n<pre><code>With Worksheets(\"Sheet4\")\n  row2 = .Cells(.Rows.Count, 1).End(xlUp).row\n  Set range2 = .Range(\"B1:H\" &amp; row2)\n  With range2.Borders\n    .LineStyle = xlContinuous\n    .Weight = xlThin\n    .ColorIndex = 0\n    .TintAndShade = 0\n  End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 11906577, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GTOD8wuMUGA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rduyPEgABloNiHHpjxVkziheWBbSQ/photo.jpg?sz=128", "display_name": "jack ryan", "link": "https://stackoverflow.com/users/11906577/jack-ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 58193951, "answer_count": 1, "score": 0, "last_activity_date": 1569983800, "creation_date": 1569976110, "last_edit_date": 1569983800, "question_id": 58193823, "link": "https://stackoverflow.com/questions/58193823/including-the-cell-borders-in-a-vba-script-for-dynamic-range", "title": "Including the cell borders in a vba script for dynamic range", "body": "<p>My code is supposed to copy the dynamic set of data from Sheet1 and Sheet2 to Sheet3 and 4 respectively.\nAfter the copying and formatting is done, I need to apply borders to the dynamic range.</p>\n\n<p>This is how my script looks like</p>\n\n<pre><code>Sub transfer()\nDim Lastrow As Integer\nDim Lastrow1 As Integer\nDim row1 As Long\nDim row2 As Long\nDim range1 As Range\nDim range2 As Range\n\n\n\nLastrow = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).row\nLastrow1 = Worksheets(\"Sheet3\").Cells(Rows.Count, 1).End(xlUp).row\nDebug.Print Lastrow\nDebug.Print Lastrow1\n\n\nWorksheets(\"Sheet1\").Range(\"B2:G\" &amp; Lastrow).copy Worksheets(\"Sheet2\").Range(\"B2\")\nWorksheets(\"Sheet3\").Range(\"B2:H\" &amp; Lastrow1).copy Worksheets(\"Sheet4\").Range(\"B2\")\n\nWith Worksheets(\"Sheet2\")\n row1 = Worksheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp).row\n Debug.Print row1\n Set range1 = Worksheets(\"Sheet2\").Range(\"B1:G\" &amp; row1)\n With range1.Borders\n    .LineStyle = xlContinuous\n    .Weight = xlThin\n    .ColorIndex = 0\n    .TintAndShade = 0\n\n    End With\nEnd With\n\nWith Worksheets(\"Sheet4\")\nrow2 = Worksheets(\"Sheet4\").Cells(Rows.Count, 1).End(xlUp).row\nDebug.Print row2\nSet range2 = Worksheets(\"Sheet4\").Range(\"B1:H\" &amp; row2)\nWith range2.Borders\n    .LineStyle = xlContinuous\n    .Weight = xlThin\n    .ColorIndex = 0\n    .TintAndShade = 0\n\n    End With\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>But The borders are not happening only when I am in the specific sheet even though I specified the sheetname.\nAlso, the borders drawn are inconsistent and not being applied to the entire range for sheet4</p>\n\n<p>Would appreciate any help.\nThanks.</p>\n"}, {"tags": ["arrays", "vba", "types", "type-mismatch", "byref"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1569976392, "post_id": 58193615, "comment_id": 102766702, "body": "Always helps to show a small sample of what you&#39;ve tried.  It sounds like you should probably create some custom Types or Classes (where each member has a specific datatype) for your different element types and then you can add those to a Collection/array and pass for processing."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12151081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1e1e948953de07197c2ecce9b38fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Whyengineersshouldntprogram", "link": "https://stackoverflow.com/users/12151081/whyengineersshouldntprogram"}, "edited": false, "score": 0, "creation_date": 1570033824, "post_id": 58195416, "comment_id": 102789403, "body": "This looks very promising, thank you! I won\u2019t be able to try it out till next week, but I\u2019ll let you know if it works out for my application!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1569992218, "creation_date": 1569992218, "answer_id": 58195416, "question_id": 58193615, "link": "https://stackoverflow.com/questions/58193615/how-do-i-assign-arrays-with-multiple-data-types-in-vba-and-then-use-the-data-in/58195416#58195416", "title": "How do I assign arrays with multiple data types in VBA and then use the data in functions requiring certain datatypes?", "body": "<p>It sounds like you should probably create some custom Types or Classes (where each class has members with specific datatypes) for your different element types and then you can add those to a Collection/array and pass around for processing.  </p>\n\n<p>For example using classes:</p>\n\n<p>Couple of very basic classes (just public variables, no methods):</p>\n\n<pre><code>'class module clsA\nPublic MyType As String\nPublic Pressure As Double\n\n'class module clsB\nPublic MyType As String\nPublic Length As Double\nPublic FinCount As Integer\n</code></pre>\n\n<p>In a regular code module:</p>\n\n<pre><code>Sub tester()\n    Dim colThings As New Collection, e\n\n    colThings.Add MakeTypeAThing(\"TypeA\", 67.92)\n    colThings.Add MakeTypeBThing(\"TypeB\", 19.56, 4)\n    colThings.Add MakeTypeAThing(\"TypeA\", 0.38)\n\n    For Each e In colThings\n        Debug.Print TypeName(e)\n    Next e\n\nEnd Sub\n\n\n'Couple of \"factory\" functions to create instances of your classes\n'  and set the member fields\n\nFunction MakeTypeAThing(typ As String, Pressure As Double) As clsA\n    Dim rv As New clsA\n    rv.MyType = typ\n    rv.Pressure = Pressure\n    Set MakeTypeAThing = rv\nEnd Function\n\nFunction MakeTypeBThing(typ As String, l As Double, Fins As Integer) As clsB\n    Dim rv As New clsB\n    rv.MyType = typ\n    rv.Length = l\n    rv.FinCount = Fins\n    Set MakeTypeBThing = rv\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12151081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c1e1e948953de07197c2ecce9b38fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Whyengineersshouldntprogram", "link": "https://stackoverflow.com/users/12151081/whyengineersshouldntprogram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1569992218, "creation_date": 1569973623, "question_id": 58193615, "link": "https://stackoverflow.com/questions/58193615/how-do-i-assign-arrays-with-multiple-data-types-in-vba-and-then-use-the-data-in", "title": "How do I assign arrays with multiple data types in VBA and then use the data in functions requiring certain datatypes?", "body": "<p>I am working on a program which performs calculations on several physical elements. There are about 5 types of elements, each requiring different inputs(with different datatypes) to calculations. There is no limit on the number of elements or order in which they can be calculated.</p>\n\n<p>For example: the first set of data might have an element of type A, and element of type B and a second element of type A.</p>\n\n<p>The second set of data might have an element of type C, an element of type B, and five elements of type A.</p>\n\n<p>Element type A might have a type(string) input and a pressure(double) input.\nElement type B might have a type(string) input, a length(double) input, number of fins(integer) input.\nElement type C might have a length(double) input, diameter(double) input and quantity(integer) input </p>\n\n<p>Since I don't know the number or type of elements ahead of time, I have been using a variant array which has a number of rows which can be assigned after elements are selected by the user, and a number of columns equal to the maximum number of data points needed by any element.</p>\n\n<p>The problem is that when I then try to use that data in other functions (by calling Array(1,2)) I get a \"byref argument type mismatch\" error. </p>\n\n<p>From what I can tell, this means that my program doesn't KNOW that the value contained in the slot of my array can/should be the correct datatype. it just sees \"variant\" as opposed to \"double\" or \"string\" and throws an error.</p>\n\n<p>I have found a couple ways around this. \n1)I can put the data in parenthesis when I call the function. Apparent this forces the data to conform to the expected datatype.\n<em>function(input1, (Array(1,2)), input3)</em></p>\n\n<p>2) I can go into all my functions and change the expected data-types to variant.</p>\n\n<p>The problem is I am performing an engineering calculation, and I care about maintaining a certain level of accuracy in my numbers. I also DON'T really want my functions to be able to run if the inputs don't make sense. It seems to me that option 1 carries a high risk of loosing important data during the forced conversion. I'm not sure that option 2 is any better, since vba doesn't seem to assign/track these datatypes like I was imagining it did.</p>\n\n<p>Is there any better way for me to assign and transfer data of a variety of types? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "edited": false, "score": 0, "creation_date": 1569981725, "post_id": 58193383, "comment_id": 102767543, "body": "Here is a good page on user form events. <a href=\"https://bettersolutions.com/vba/userforms/events.htm\" rel=\"nofollow noreferrer\">bettersolutions.com/vba/userforms/events.htm</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1569986392, "post_id": 58193383, "comment_id": 102768307, "body": "You can achieve what you want by subclassing the userform and trapping the worksheet events but it very messy."}], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1569985846, "creation_date": 1569985846, "answer_id": 58194741, "question_id": 58193383, "link": "https://stackoverflow.com/questions/58193383/which-event-fires-if-excel-vba-modeless-userform-window-gets-focus-back/58194741#58194741", "title": "which event fires if excel-vba modeless userform window gets focus back?", "body": "<p>Try this. the event occurs after the form appears, so hide the wb inside an initialize event.</p>\n\n<pre><code>    Private Sub UserForm_Initialize() \nSet WB = ThisWorkbook Windows(WB.Name).Visible = False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 372, "user_id": 1349511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6f52ab9ce3508ba99f0369fe16a3f1?s=128&d=identicon&r=PG", "display_name": "martin.lindenlauf", "link": "https://stackoverflow.com/users/1349511/martin-lindenlauf"}, "edited": false, "score": 0, "creation_date": 1570099336, "post_id": 58194810, "comment_id": 102810880, "body": "Unless there is another solution, IMO a workaround is a welcomed answer."}], "tags": [], "owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "is_accepted": false, "score": 0, "last_activity_date": 1569999872, "last_edit_date": 1569999872, "creation_date": 1569986558, "answer_id": 58194810, "question_id": 58193383, "link": "https://stackoverflow.com/questions/58193383/which-event-fires-if-excel-vba-modeless-userform-window-gets-focus-back/58194810#58194810", "title": "which event fires if excel-vba modeless userform window gets focus back?", "body": "<p>The event does not exist and you can use Windows hooks to achieve your desired result.  In my opinion, that's the direct answer and everything else is a workaround [unless it was posted by Siddharth Rout, in which case, THAT is the direct answer]</p>\n"}, {"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1569988493, "creation_date": 1569988493, "answer_id": 58194994, "question_id": 58193383, "link": "https://stackoverflow.com/questions/58193383/which-event-fires-if-excel-vba-modeless-userform-window-gets-focus-back/58194994#58194994", "title": "which event fires if excel-vba modeless userform window gets focus back?", "body": "<p>The <code>Activate</code> event doesn't fire when you switch between the application and a modeless userform. This is by design.</p>\n\n<p>Like I mentioned in the comments </p>\n\n<blockquote>\n  <p>You can achieve what you want by subclassing the userform and trapping the worksheet events but it very messy.</p>\n</blockquote>\n\n<p>Here is a very basic example. Sample file can be downloaded from <a href=\"https://www.dropbox.com/s/20jjovfng5x1qgn/Modeless%20orm%20Activate%20Event.xlsm?dl=0\" rel=\"nofollow noreferrer\">Here</a></p>\n\n<p><strong>READ ME FIRST</strong>:</p>\n\n<ol>\n<li>This is just a basic sample. Please close all Excel Files before testing this. </li>\n<li>If the user directly clicks a control on the userform and you want to run the <code>activate code</code> there as well then you will have to handle that as well.</li>\n<li>Once you are happy, amend it to suit your need.</li>\n</ol>\n\n<p><strong>Place code in a Module</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function CallWindowProc Lib \"user32\" Alias \"CallWindowProcA\" _\n(ByVal lpPrevWndFunc As Long, ByVal hwnd As Long, ByVal msg As Long, _\nByVal wParam As Long, ByVal lParam As Long) As Long\n\nPrivate Declare Function SetWindowLong&amp; Lib \"user32\" Alias \"SetWindowLongA\" _\n(ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long)\n\nPrivate Const GWL_WNDPROC = (-4)\nPrivate WinProcOld As Long\nPrivate Const WM_NCLBUTTONDOWN = &amp;HA1\n\nPublic formWasDeactivated As Boolean\n\n'~~&gt; Launch the form\nSub LaunchMyForm()\n    Dim frm As New UserForm1\n    frm.Show vbModeless\nEnd Sub\n\n'~~&gt; Hooking the Title bar in case user clicks on the title bar\n'~~&gt; to activate the form\nPublic Function WinProc(ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long\n    If wMsg = WM_NCLBUTTONDOWN Then\n        '~~&gt; Ignoring unnecessary clicks to the title bar\n        '~~&gt; by checking if the form was deactivated\n        If formWasDeactivated = True Then\n            formWasDeactivated = False\n            MsgBox \"Form Activated\"\n        End If\n    End If\n\n    WinProc = CallWindowProc(WinProcOld&amp;, hwnd&amp;, wMsg&amp;, wParam&amp;, lParam&amp;)\nEnd Function\n\n'~~&gt; Subclass the form\nSub SubClassUserform(hwnd As Long)\n    WinProcOld&amp; = SetWindowLong(hwnd, GWL_WNDPROC, AddressOf WinProc)\nEnd Sub\n\nSub UnSubClassUserform(hwnd As Long)\n    SetWindowLong hwnd, GWL_WNDPROC, WinProcOld&amp;\n    WinProcOld&amp; = 0\nEnd Sub\n</code></pre>\n\n<p>Create a Userform. Let's call it <code>Userform1</code>. Add a command button in the form. Let's call it <code>CommandButton1</code></p>\n\n<p><strong>Place code in Userform</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Function FindWindow Lib \"user32.dll\" _\nAlias \"FindWindowA\" (ByVal lpClassName As String, _\nByVal lpWindowName As String) As Long\n\nDim hwnd As Long\n\nPrivate Sub UserForm_Initialize()\n    hwnd = FindWindow(vbNullString, Me.Caption)\n    SubClassUserform hwnd\nEnd Sub\n\n'~~&gt; Userform Click event\nPrivate Sub UserForm_Click()\n    '~~&gt; Ignoring unnecessary clicks\n    '~~&gt; by checking if the form was deactivated\n    If formWasDeactivated = True Then\n        formWasDeactivated = False\n        MsgBox \"Form Activated\"\n    End If\nEnd Sub\n\n'~~&gt; Unload the form\nPrivate Sub CommandButton1_Click()\n    '~~&gt; In case hwnd gets reset for whatever reason.\n    hwnd = FindWindow(vbNullString, Me.Caption)\n    UnSubClassUserform hwnd\n\n    Unload Me\nEnd Sub\n</code></pre>\n\n<p>Place this code in the <strong>Workbook</strong> code area</p>\n\n<pre><code>Option Explicit\n\n'~~&gt; Checking if the form was deactivated\n'~~&gt; Add more events if you want\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\n    formWasDeactivated = True\nEnd Sub\n\nPrivate Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)\n    formWasDeactivated = True\nEnd Sub\n</code></pre>\n\n<p>Please feel free to add more workbook events. I have only used <code>Workbook_SheetActivate</code> and <code>Workbook_SheetSelectionChange</code></p>\n\n<p>And finally add a Form Button in the worksheet and assign the macro <code>LaunchMyForm</code> to it. And we are done</p>\n\n<p><strong>In Action</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/vRoxs.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vRoxs.gif\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1569990692, "post_id": 58195222, "comment_id": 102769012, "body": "@SiddharthRout, sorry, missed your hooking answer while I was writing this. Think they&#39;re different enough to keep, but let me know and I&#39;m happy to delete this answer."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1569991414, "post_id": 58195222, "comment_id": 102769136, "body": "Strange... I was testing your code on a modeless userform and it didn&#39;t work. will check in sometime again... <a href=\"https://www.dropbox.com/s/2wjho2t2lplkuo3/Delete%20Me%20Later.xlsm?dl=0\" rel=\"nofollow noreferrer\">THIS</a> is the file with your code..."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1569991605, "post_id": 58195222, "comment_id": 102769172, "body": "@SiddharhRout I&#39;ve had that before, but works fine with <code>Userform1.Show False</code> instead of <code>vbModeless</code>. No idea why."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1569991741, "post_id": 58195222, "comment_id": 102769195, "body": "No it doesn&#39;t work with <code>False</code> as well. BTW <code>?vbModeless=False</code> will give you true. So it shouldn&#39;t matter :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1569991807, "post_id": 58195222, "comment_id": 102769208, "body": "I have attached the sample file above. you can test it in that"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1569993085, "post_id": 58195222, "comment_id": 102769478, "body": "@SiddharhRout  Odd. I&#39;ve just tested the download and all working fine on my machine. Was your hook definitely attached?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1569993567, "post_id": 58195222, "comment_id": 102769620, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/200278/discussion-between-siddharth-rout-and-ambie\">continue this discussion in chat</a>."}, {"owner": {"reputation": 372, "user_id": 1349511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6f52ab9ce3508ba99f0369fe16a3f1?s=128&d=identicon&r=PG", "display_name": "martin.lindenlauf", "link": "https://stackoverflow.com/users/1349511/martin-lindenlauf"}, "edited": false, "score": 0, "creation_date": 1570103178, "post_id": 58195222, "comment_id": 102812769, "body": "I&#39;ve build a <a href=\"https://drive.google.com/open?id=1t1ETYpkuu2acNYfo3Z-5rqDO0M02tbXI\" rel=\"nofollow noreferrer\">sample file</a> too; main results: (1) code works, (2) random crashes of Excel (O365 V1902 11328.20420), (3) if form hooked, &quot;activate-event&quot; fires <i>after</i> button click in case of form already had focus, (4) if form hooked, switching focus back to form by clicking form button does <i>not</i> fire the button-clicked-event (as it does if form is unhooked), (5) the fireing of the &quot;activate-event&quot; causes windows to play a sound (but only if focus switched over to form, see (3))."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 2, "last_activity_date": 1615859064, "last_edit_date": 1615859064, "creation_date": 1569990476, "answer_id": 58195222, "question_id": 58193383, "link": "https://stackoverflow.com/questions/58193383/which-event-fires-if-excel-vba-modeless-userform-window-gets-focus-back/58195222#58195222", "title": "which event fires if excel-vba modeless userform window gets focus back?", "body": "<p>As far as I know, there isn't such an event within VBA. From the documentation:</p>\n<blockquote>\n<p>The Activate and Deactivate events occur only when you move the focus\nwithin an application. Moving the focus to or from an object in\nanother application doesn't trigger either event.</p>\n</blockquote>\n<p>However, the Windows APIs can handle the event with a <em>hook</em>. The problem with Win APIs within VBA is that errors aren't handled by VBA so Excel will crash if/when the code encounters an error; so they can be frustrating for the developer. From a purely personal perspective, I like to keep code within the hook procedures to a minimum and pass any values to a class that can then fire events - this at least minimises the crashes. It's also important to remember to unhook before finishing your session.</p>\n<p>Basic implementation of a Win API hook would look something like this:</p>\n<p><strong>In a class object (here it's called cHookHandler)</strong></p>\n<pre><code>Option Explicit\n\nPublic Event HookWindowActivated()\nPublic Event HookIdChanged()\n\nPrivate mHookId As LongPtr\nPrivate mTargetWindows As Collection\n\nPublic Property Get HookID() As LongPtr\n    HookID = mHookId\nEnd Property\n\nPublic Property Let HookID(RHS As LongPtr)\n    mHookId = RHS\n    RaiseEvent HookIdChanged\nEnd Property\n\nPublic Sub AttachHook()\n    modHook.AttachHook Me\nEnd Sub\n\nPublic Sub DetachHook()\n    modHook.DetachHook\nEnd Sub\n\nPublic Sub AddTargetWindow(className As String, Optional windowTitle As String)\n    Dim v(1) As String\n    \n    'Creates an array of [0 =&gt; className, 1=&gt; windowTitle]\n    'which is stored in a collection and tested for in\n    'your hook callback.\n    v(0) = className\n    v(1) = windowTitle\n    mTargetWindows.Add v\n    \nEnd Sub\n\nPublic Sub TestForTargetWindowActivated(className As String, windowTitle As String)\n    Dim v As Variant\n    \n    'Tests if the callback window is one that we're after.\n    For Each v In mTargetWindows\n        If v(0) = className Then\n            If v(1) = &quot;&quot; Or v(1) = windowTitle Then\n                'Fires the event that our target window has been activated.\n                RaiseEvent HookWindowActivated\n                Exit Sub\n            End If\n        End If\n    Next\nEnd Sub\n\nPrivate Sub Class_Initialize()\n    Set mTargetWindows = New Collection\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    modHook.DetachHook\nEnd Sub\n</code></pre>\n<p><strong>Module code (here the module is called modHook)</strong></p>\n<pre><code>Option Explicit\n\nPrivate Declare PtrSafe Function UnhookWindowsHookEx Lib &quot;user32&quot; _\n    (ByVal hHook As LongPtr) As Long\n \nPrivate Declare PtrSafe Function SetWindowsHookEx Lib &quot;user32&quot; _\n    Alias &quot;SetWindowsHookExA&quot; _\n    (ByVal idHook As Long, _\n    ByVal lpfn As LongPtr, _\n    ByVal hmod As LongPtr, _\n    ByVal dwThreadId As Long) As LongPtr\n\nPrivate Declare PtrSafe Function CallNextHookEx Lib &quot;user32&quot; _\n    (ByVal hHook As LongPtr, _\n    ByVal ncode As Long, _\n    ByVal wParam As LongPtr, _\n    lParam As Any) As LongPtr\n    \nPrivate Declare PtrSafe Function GetClassName Lib &quot;user32&quot; _\n    Alias &quot;GetClassNameA&quot; _\n    (ByVal hwnd As LongPtr, _\n    ByVal lpClassName As String, _\n    ByVal nMaxCount As Long) As Long\n    \nPrivate Declare PtrSafe Function GetWindowText Lib &quot;user32&quot; _\n    Alias &quot;GetWindowTextA&quot; _\n    (ByVal hwnd As LongPtr, _\n    ByVal lpString As String, _\n    ByVal cch As Long) As Long\n    \nPrivate Declare PtrSafe Function GetCurrentThreadId Lib &quot;kernel32&quot; () As Long\n\nPrivate Const WH_CBT As Long = 5\nPrivate Const HCBT_ACTIVATE As Long = 5\n\nPrivate mHookHandler As cHookHandler\n\nPublic Sub AttachHook(hookHandler As cHookHandler)\n    Set mHookHandler = hookHandler\n    mHookHandler.HookID = SetWindowsHookEx(WH_CBT, AddressOf CBTCallback, 0, GetCurrentThreadId)\nEnd Sub\n\nPrivate Function CBTCallback(ByVal lMsg As Long, _\n                             ByVal wParam As LongPtr, _\n                             ByVal lParam As LongPtr) As LongPtr\n    Dim className As String, windowTitle As String\n    \n    If mHookHandler Is Nothing Then Exit Function\n    \n    If lMsg = HCBT_ACTIVATE Then\n        className = GetClassText(wParam)\n        windowTitle = GetWindowTitle(wParam)\n        If Not mHookHandler Is Nothing Then\n            mHookHandler.TestForTargetWindowActivated className, windowTitle\n        End If\n    End If\n    CBTCallback = CallNextHookEx(mHookHandler.HookID, lMsg, ByVal wParam, ByVal lParam)\nEnd Function\n\nPublic Sub DetachHook()\n    Dim ret As Long\n    \n    If mHookHandler Is Nothing Then Exit Sub\n    \n    ret = UnhookWindowsHookEx(mHookHandler.HookID)\n    If ret = 1 Then\n        mHookHandler.HookID = 0\n    End If\nEnd Sub\n\nPrivate Function GetWindowTitle(wParam As LongPtr) As String\n    Dim tWnd As String\n    Dim lWnd As Long\n    \n    tWnd = String(100, Chr(0))\n    lWnd = GetWindowText(wParam, tWnd, 100)\n    tWnd = Left(tWnd, lWnd)\n\n    GetWindowTitle = tWnd\nEnd Function\n\nPrivate Function GetClassText(wParam As LongPtr) As String\n    Dim tWnd As String\n    Dim lWnd As Long\n    \n    tWnd = String(100, Chr(0))\n    lWnd = GetClassName(wParam, tWnd, 100)\n    tWnd = Left(tWnd, lWnd)\n\n    GetClassText = tWnd\nEnd Function\n</code></pre>\n<p><strong>And in this example, all events are captured within the <code>Userform</code></strong></p>\n<p>In this simple example, two buttons on the <code>Userform</code> attach and detach the hook, but you'd probably call the routines from somewhere else (perhaps the userform <code>Initialize</code> and <code>Terminate</code> events). The <code>Userform</code> also has a label <code>lblHook</code> displaying the HookId which I use during development - for production code, you probably wouldn't want this, so you could leave that bit out.</p>\n<pre><code>Option Explicit\n\nPrivate WithEvents mHookHandler As cHookHandler\n\nPrivate Sub btnHook_Click()\n    mHookHandler.AttachHook\nEnd Sub\n\nPrivate Sub btnUnhook_Click()\n    mHookHandler.DetachHook\nEnd Sub\n\nPrivate Sub mHookHandler_HookIdChanged()\n    lblHook.Caption = mHookHandler.HookID\nEnd Sub\n\nPrivate Sub mHookHandler_HookWindowActivated()\n    ' Caveat: this routine will crash if halted in debugger.\n    Debug.Print &quot;I've been activated!&quot;\nEnd Sub\n\nPrivate Sub UserForm_Initialize()\n    Set mHookHandler = New cHookHandler\n    \n    mHookHandler.AddTargetWindow &quot;ThunderDFrame&quot;, Me.Caption\nEnd Sub\n\nPrivate Sub UserForm_Terminate()\n    Set mHookHandler = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 1349511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d6f52ab9ce3508ba99f0369fe16a3f1?s=128&d=identicon&r=PG", "display_name": "martin.lindenlauf", "link": "https://stackoverflow.com/users/1349511/martin-lindenlauf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1024, "favorite_count": 1, "answer_count": 4, "score": 2, "last_activity_date": 1615859064, "creation_date": 1569971388, "last_edit_date": 1569973964, "question_id": 58193383, "link": "https://stackoverflow.com/questions/58193383/which-event-fires-if-excel-vba-modeless-userform-window-gets-focus-back", "title": "which event fires if excel-vba modeless userform window gets focus back?", "body": "<p>I've got a modeless userform in an Excel VBA project.\nThe userform is loaded by button on spreadsheet clicked (<em>not</em> an active-x button if that's relevant).\nBecause of modeless the user can work with excel or even other applications and than switch back to the form window. <strong>I need an event that fires if the form window becomes the active window again.</strong> I thought <code>UserForm_Activate</code> should do the job but it doesn't (neither does <code>UserForm_GotFocus</code> but there is no GotFocus event for userforms?). Is there any event that fires if the user switches back to a modeless userform (or in case not: is there any known work-around)? Or do I've got some strange bug here and <code>Activate</code> should fire?</p>\n\n<p>Here's all the code I used for testing purpose:</p>\n\n<pre><code>' standard module:\n\nSub BUTTON_FormLoad()\n    ' associated as macro triggered by button click on a sheet\n    UserForm1.Show vbModeless\nEnd Sub\n\n\n' UserForm1:\n\nPrivate Sub UserForm_Activate()\n    ' does not fire if focus comes back\n    Debug.Print \"Activated\"\nEnd Sub\n\nPrivate Sub UserForm_GotFocus()\n    ' does not fire if focus comes back\n    ' wrong code - no GotFocus event for userforms?\n    Debug.Print \"Focussed\"\nEnd Sub\n\nPrivate Sub UserForm_Click()\n    ' only fires if clicked *inside* form\n    ' does not fire eg if user clicks top of form window\n    Debug.Print \"Clicked\"\nEnd Sub\n</code></pre>\n\n<p>Where do I find the documentation of userform events? It's not on the '<a href=\"https://docs.microsoft.com/de-de/office/vba/language/reference/user-interface-help/userform-object\" rel=\"nofollow noreferrer\">UserForm object</a>' page.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570034917, "post_id": 58193377, "comment_id": 102789905, "body": "Yes, it is possible but there are several approaches for you to choose from."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570034938, "post_id": 58193377, "comment_id": 102789912, "body": "You could write a macro to be run once per day, say, which loops searching for \u201cCOMPLETE\u201d within a subject, extracting the 15-character code, searching for other emails with the same code and processing all the emails found.  The loop would continue until it failed to find an email with a subject containing \u201cCOMPLETE\u201d.  If you choose this approach, you must move the emails to a \u2018processed\u2019 folder or delete them.  If you do not, you will process the same emails every time you run the macro."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570034961, "post_id": 58193377, "comment_id": 102789922, "body": "Alternative, you could have a rule that called a macro when an email arrived with a subject containing \u201cCOMPLETE\u201d.  This macro would not loop; it would only extract, search and process once.  With this approach, you would not have to move or delete the emails (although you could) and the emails would be processed immediately rather than once per day."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570034994, "post_id": 58193377, "comment_id": 102789936, "body": "Where I have said \u201cprocess\u201d, you say \u201cforward to another email\u201d.  I assume you mean another email address.  Are you sure you mean \u201cforward\u201d?  Typically, with this type of requirement, the emails are moved to a shared mailbox for archiving."}, {"owner": {"reputation": 1, "user_id": 12151064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936431f882e37720709532b99bebda28?s=128&d=identicon&r=PG&f=1", "display_name": "MKunk1", "link": "https://stackoverflow.com/users/12151064/mkunk1"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1570130446, "post_id": 58193377, "comment_id": 102826259, "body": "Thanks Tony. I think it would be best to run on a loop once triggered, is it possible to have the macro move the emails once it sends? Yes it would need to forward as the emails are already in a shared inbox and will need to be sent and moved"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12151064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936431f882e37720709532b99bebda28?s=128&d=identicon&r=PG&f=1", "display_name": "MKunk1", "link": "https://stackoverflow.com/users/12151064/mkunk1"}, "edited": false, "score": 0, "creation_date": 1575851907, "post_id": 58261560, "comment_id": 104693781, "body": "Hi Tony, thank you very much for your help and I apologize for the lack of response earlier. I got sucked into a different project but finally am able to come back to this one. Your above code worked perfectly. For the second stage, I am assuming I now need to email each &quot;family&quot; to a specified address, for testing I will use my own email. Please let me know what is needed in order to proceed with stage 2 code. Thanks again."}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 0, "last_activity_date": 1570399260, "creation_date": 1570399260, "answer_id": 58261560, "question_id": 58193377, "link": "https://stackoverflow.com/questions/58193377/forward-email-based-on-part-of-a-subject-line/58261560#58261560", "title": "Forward email based on part of a subject line", "body": "<p>I will try to get you started but only you can debug any code as only you have the emails you wish to forward.  I have created some emails that match my understanding of your emails but I cannot be sure I have got then perfectly correct.</p>\n\n<p>I do not know how much VBA you know.  In general, once you know a statement exists, it is fairly easy to search the web for an explanation.  So I will concentrate of explaining what my code is doing.</p>\n\n<p>For the first stage of your macro you need to gather the following information:</p>\n\n<pre><code>abcdefghijklmno  Email1  Email2  Email3 . . .\nbcdefghijklmnop  Email4  Email5 . . .\n</code></pre>\n\n<p>where \u201cabcdefghijklmno\u201d and \u201cbcdefghijklmnop\u201d  are the code for a \u2018job\u2019 and Email1 to Email5 are the emails whose subjects include the codes.</p>\n\n<p>For a macro a folder, such as Inbox, is a collection.  There are different ways of identifying a particular Email but I think the most convenient way for your requirement is by its position or index within the collection.  The first email added to a folder will have an index of 1, the second and index of 2 and so on.  If you know about arrays, this will seem familiar.  The difference is that with collections you can delete existing items from or add new items in the middle of the collection.  Suppose, I have a collection with items A, B, C, E and F which will have indices 1 to 5.  I now add item D between items C and E.  Items A to C are still items 1 to 3.  But D is now item 4, E has become item 5 and F has become item 6.  You have the opposite situation when an item is deleted with items further down the collection having their index numbers reduced.  This is probably strange but I believe it will become clearer later when it becomes important.</p>\n\n<p>So what we need to create is:</p>\n\n<pre><code>abcdefghijklmno  25  34  70 . . .\nbcdefghijklmnop  29  123 . . .\n</code></pre>\n\n<p>After <code>Option Explicit</code>, which you can look up, the first statement is <code>Type tFamily</code>.  VBA comes with a wide variety of data types, for example: Long, Double, String and Boolean.  Sometimes these are not enough on their own and we need to combine them into what VBA calls user types and most other languages call structures.  You may have heard of classes.  Classes are a step up from user types and we do not need their extra functionality or extra complications.</p>\n\n<p>So I have written:</p>\n\n<pre><code>Type tFamily\n  Code As String\n  Members As Collection\nEnd Type\n</code></pre>\n\n<p>Here I have combined a String and a Collection into a larger type which I have named tFamily.  The \u201ct\u201d is my standard because I often have difficulty thinking of different names for my types and my variables.  This type matches the data I describe above.  I have called all the emails with the same code a Family.  Within a family, I have a string to hold the code and a collection to hold all the indices.</p>\n\n<p>Further down my code, I have defined an array of families:</p>\n\n<pre><code>  Dim Families() As tFamily\n</code></pre>\n\n<p>This is where I will hold all the information about the email families.</p>\n\n<p>The next important statement is:</p>\n\n<pre><code>  Set FldrInbox = Session.Folders(\"xxx\").Folders(\"Inbox\")\n</code></pre>\n\n<p>You need to replace \u201cxxx\u201d with the name of the shared mailbox.</p>\n\n<p>The first block of code, headed <em>Identify the 'COMPLETE' emails and record their indices in InxsItemComplete</em> scans through all the emails in Inbox and records the index of each email with a subject ending \u201cCOMPLETE\u201d.  With the example data above, at the end, <code>InxsItemComplete</code> would contain 123 and 70.</p>\n\n<p>The next statement is <code>ReDim Families(1 To InxsItemComplete.Count)</code>.  <code>InxsItemComplete.Count</code> is the number of complete families.  This statement sizes array <code>Families</code> so it can hold this number of families.  It is possible to have collections within collection but collections within an array are simpler. </p>\n\n<p>The next block extracts the code from each \u2018COMPLETE\u2019 and stores it and the index of the \u2018COMPLETE\u2019 email in <code>Families</code>.  The code assumes the emails subject is something like:</p>\n\n<pre><code>xxxxxxxxxx abcdefghijklmno spaces COMPLETE\n</code></pre>\n\n<p>The code sets <code>PosCodeEnd</code> to point before \u201cCOMPLETE\u201d.  It backs up until it finds a non-space and then extracts the previous 15 characters.  This code is then stored in <code>Families(InxF).Code</code>.  The index of the email is added to <code>Families(InxF).Members</code>.</p>\n\n<p>The next block again scans through all the emails in Inbox.  This time it is looks for emails with subjects that contain a code but do not end with \u201cCOMPLETE\u201d.  It adds the index of these emails to <code>Families(InxF).Members</code>.  These indices are added so these are in ascending sequence.  I will explain why this sequence is important when I add the next stage of this macro which forwards the emails.</p>\n\n<p>This is the end of stage 1.  All the data needed for forwarding emails has been collected.  The remaining block of code outputs the data to the Immediate Window so it can be checked.  With my test emails, that output is:</p>\n\n<pre><code>abcdefghijklmno\n  122 06/10/2019 13:28:38 Introductory text aaa abcdefghijklmno Progress\n  124 06/10/2019 13:27:35 Introductory text ccccc  abcdefghijklmno Progress\n  126 06/10/2019 13:26:05 Introductory text ccccc  abcdefghijklmno  Progress\n  127 06/10/2019 13:24:54 Introductory text aaa abcdefghijklmno  COMPLETE\nzyxwvutsrqponml\n  121 06/10/2019 13:29:10 Introductory text bbbbbb  zyxwvutsrqponml COMPLETE\n  123 06/10/2019 13:28:00 Introductory text bbbbbb  zyxwvutsrqponml   Progress\n  125 06/10/2019 13:26:38 Introductory text aaa zyxwvutsrqponml  Progress\n</code></pre>\n\n<p>The important part of this data is:</p>\n\n<pre><code>abcdefghijklmno\n  122\n  124\n  126\n  127\nzyxwvutsrqponml\n  121\n  123\n  125\n</code></pre>\n\n<p>That is the codes and the indices are the recorded data.  The received time and subject are to help you identify the referenced emails.</p>\n\n<p>You need to run this macro and check this output for:</p>\n\n<ul>\n<li>Every email with a subject ending \u201cCOMPLETE\u201d has been identified.</li>\n<li>The code has been correctly extracted.</li>\n<li>Every email containing a code has been found and recorded.</li>\n<li>The indices are in ascending sequence for each code.</li>\n</ul>\n\n<p>Come back with questions as necessary.  However, remember I cannot see your emails so there is a limit to how much I can help with the debugging.  Once you confirm that the diagnostic output is correct, I will add the code for stage 2. </p>\n\n<pre><code>Option Explicit\nType tFamily\n  Code As String\n  Members As Collection\nEnd Type\nSub FindAndForwardCompleteConversations()\n\n  Dim Families() As tFamily\n  Dim FldrInbox As Folder\n  Dim InxItemCrnt As Long\n  Dim InxF As Long          ' Index into Families and InxsItemComplete\n  Dim InxM As Long          ' Index into members of current family\n  Dim InxsItemComplete As New Collection\n  Dim Placed As Boolean\n  Dim PosCodeEnd As Long\n  Dim Subject As String\n\n  Set FldrInbox = Session.Folders(\"xxx\").Folders(\"Inbox\")\n\n  ' Identify the 'COMPLETE' emails and record their indices\n  For InxItemCrnt = FldrInbox.Items.Count To 1 Step -1\n    With FldrInbox.Items.Item(InxItemCrnt)\n      If .Class = olMail Then\n        If Right$(.Subject, 8) = \"COMPLETE\" Then\n          InxsItemComplete.Add InxItemCrnt\n        End If\n      End If\n    End With\n  Next\n\n  ReDim Families(1 To InxsItemComplete.Count)\n\n  ' Extract code from each \"COMPLETE\" emails and start families with 'COMPLETE' email\n  For InxF = 1 To InxsItemComplete.Count\n    Subject = FldrInbox.Items.Item(InxsItemComplete(InxF)).Subject\n    PosCodeEnd = Len(Subject) - 8 ' Position to space before COMPLETE\n    ' Position to first non-space character before COMPLETE\n    Do While Mid$(Subject, PosCodeEnd, 1) = \" \"\n      PosCodeEnd = PosCodeEnd - 1\n    Loop\n    Families(InxF).Code = Mid$(Subject, PosCodeEnd - 14, 15)\n    Set Families(InxF).Members = New Collection\n    Families(InxF).Members.Add InxsItemComplete(InxF)\n  Next\n\n  Set InxsItemComplete = Nothing   ' Release memory of collection which is no longer needed\n\n  ' Identify emails containing the same code as the 'COMPLETE' emails\n  ' and add to the appropriate Family\n  For InxItemCrnt = FldrInbox.Items.Count To 1 Step -1\n    With FldrInbox.Items.Item(InxItemCrnt)\n      If .Class = olMail Then\n        Placed = False\n        For InxF = 1 To UBound(Families)\n          If Right$(.Subject, 8) &lt;&gt; \"COMPLETE\" And _\n             InStr(1, .Subject, Families(InxF).Code) &lt;&gt; 0 Then\n            ' Add InxItemCrnt to collection of members for this family\n            ' so that indices are in ascending sequence\n            For InxM = 1 To Families(InxF).Members.Count\n              If InxItemCrnt &lt; Families(InxF).Members(InxM) Then\n                Families(InxF).Members.Add Item:=InxItemCrnt, Before:=InxM\n                Placed = True\n                Exit For\n              End If\n            Next\n            If Not Placed Then\n              Families(InxF).Members.Add Item:=InxItemCrnt\n              Placed = True\n            End If\n          End If\n          If Placed Then\n            ' Email added to current family so not need to check other families\n            Exit For\n          End If\n        Next\n      End If\n    End With\n  Next\n\n  ' Output collected information\n  For InxF = 1 To UBound(Families)\n    Debug.Print Families(InxF).Code\n    For InxM = 1 To Families(InxF).Members.Count\n      InxItemCrnt = Families(InxF).Members(InxM)\n      With FldrInbox.Items.Item(InxItemCrnt)\n        Debug.Print \"  \" &amp; InxItemCrnt &amp; \" \" &amp; .ReceivedTime &amp; \" \" &amp; .Subject\n      End With\n    Next\n  Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12151064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/936431f882e37720709532b99bebda28?s=128&d=identicon&r=PG&f=1", "display_name": "MKunk1", "link": "https://stackoverflow.com/users/12151064/mkunk1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1585375068, "creation_date": 1569971331, "last_edit_date": 1585375068, "question_id": 58193377, "link": "https://stackoverflow.com/questions/58193377/forward-email-based-on-part-of-a-subject-line", "title": "Forward email based on part of a subject line", "body": "<p>Is there a way to search an inbox for a part of a subject line from an email then forward the search results to another email address?</p>\n\n<p>Example:<br>\nCOMPLETE email comes into inbox, subject line of the email is \u201cThis is the subject COMPLETE\u201d. I want any emails with \u201csubject\u201d in the subject line to be forwarded to a different email address. </p>\n\n<p>EDIT: To clarify, the macro should search the subject line for a combination of letters and numbers, always 15 characters long, to the left of COMPLETE. </p>\n\n<p>Also, the macro would not need to be triggered when the COMPLETE email comes into the inbox (ok to be triggered manually). It would need to treat each complete email as a separate \u201cjob\u201d to repeat the search and forward for each email with complete in the subject.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4859, "user_id": 7431860, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/P6Jko.jpg?s=128&g=1", "display_name": "Nick Reed", "link": "https://stackoverflow.com/users/7431860/nick-reed"}, "edited": false, "score": 0, "creation_date": 1569970840, "post_id": 58193241, "comment_id": 102765719, "body": "Welcome to StackOverflow! Please edit the question to include the actual behavior of your code - until we know what it&#39;s doing wrong, it&#39;s hard to guess what might make it right."}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1569983759, "post_id": 58193241, "comment_id": 102767881, "body": "If you care speed, you should use Excel Formula."}], "answers": [{"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1569971868, "post_id": 58193302, "comment_id": 102765922, "body": "@watapana as I said, I misread your question the first time, but the newer code from about 9 minutes ago should work."}, {"owner": {"reputation": 1, "user_id": 12150986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68795d1cb904598241ac7b23a5cde2d?s=128&d=identicon&r=PG&f=1", "display_name": "watapana", "link": "https://stackoverflow.com/users/12150986/watapana"}, "edited": false, "score": 0, "creation_date": 1569971919, "post_id": 58193302, "comment_id": 102765934, "body": "I am receiving run-time &#39;1004&#39; at the   ElseIf aCell.Value2 = &quot;banana&quot; Then     aCell.Worksheet.Cells(aCell.Row, theColumnToWriteTo).Value = &quot;Vegetable&quot;"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 1, "user_id": 12150986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68795d1cb904598241ac7b23a5cde2d?s=128&d=identicon&r=PG&f=1", "display_name": "watapana", "link": "https://stackoverflow.com/users/12150986/watapana"}, "edited": false, "score": 0, "creation_date": 1569972086, "post_id": 58193302, "comment_id": 102765971, "body": "Not sure why. It works fine on mine. Feel free to download and review: <a href=\"https://1drv.ms/x/s!AiO7_3PtXmZ9goIy5hzGBf95yqJFEg?e=r0hxfj\" rel=\"nofollow noreferrer\">1drv.ms/x/s!AiO7_3PtXmZ9goIy5hzGBf95yqJFEg?e=r0hxfj</a>"}, {"owner": {"reputation": 1, "user_id": 12150986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68795d1cb904598241ac7b23a5cde2d?s=128&d=identicon&r=PG&f=1", "display_name": "watapana", "link": "https://stackoverflow.com/users/12150986/watapana"}, "edited": false, "score": 0, "creation_date": 1569972613, "post_id": 58193302, "comment_id": 102766065, "body": "It also gave me the error on your sheet, but I noticed when I clear column D before running the macro, I receive no error. I have no idea why.  But can you breakdown your macro for me to get an understanding on how it works?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 1, "user_id": 12150986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68795d1cb904598241ac7b23a5cde2d?s=128&d=identicon&r=PG&f=1", "display_name": "watapana", "link": "https://stackoverflow.com/users/12150986/watapana"}, "edited": false, "score": 0, "creation_date": 1569974083, "post_id": 58193302, "comment_id": 102766338, "body": "@watapana I updated my answer with a more advanced method (which I&#39;ve been meaning to post somewhere anyway). I can&#39;t imagine that won&#39;t work, but who knows."}, {"owner": {"reputation": 1, "user_id": 12150986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68795d1cb904598241ac7b23a5cde2d?s=128&d=identicon&r=PG&f=1", "display_name": "watapana", "link": "https://stackoverflow.com/users/12150986/watapana"}, "edited": false, "score": 0, "creation_date": 1569974672, "post_id": 58193302, "comment_id": 102766432, "body": "It works perfectly! Could you break down how to add lets say another ElseIf statement? &quot;Peer&quot; as an example"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1569985644, "post_id": 58193302, "comment_id": 102768205, "body": "May improve this using a <code>Select Case</code> switch instead of <code>If&#47;ElseIf&#47;...&#47;Else</code>, just my $0.02, but otherwise this looks good."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1570049778, "post_id": 58193302, "comment_id": 102796271, "body": "@DavidZemens at one point I ran a massive test comparing the two methods. Over the course of several million iterations, <code>elseif</code> performed a millisecond faster which should be translated to mean &quot;makes no difference to a normal person&quot;... so I updated the answer. Good call."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1570050685, "post_id": 58193302, "comment_id": 102796560, "body": "Yeah IDK performance-wise, my understanding is that they should be pretty close. I personally favor <code>Select</code> as more &quot;readable&quot;, but that&#39;s just an opinion. Good on you for doing the performance testing, though!"}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 3, "last_activity_date": 1570293713, "last_edit_date": 1570293713, "creation_date": 1569970630, "answer_id": 58193302, "question_id": 58193241, "link": "https://stackoverflow.com/questions/58193241/how-to-use-string-text-within-if-else-statements-in-excel-vba/58193302#58193302", "title": "How to use string-text within If-else statements in Excel VBA", "body": "<p>This should do what you want. Keep an eye out for caps issues, or just force everything to be upper/lower case.</p>\n\n<pre><code>Sub Categorize()\nDim aCell As Range\nConst theColumnToWriteTo As Long = 4 'column d    \n\nFor Each aCell In Range(\"b2:b100\").Cells\n\n\nIf aCell.Value2 = \"Apple\" Then\n\n    aCell.Worksheet.Cells(aCell.Row, theColumnToWriteTo).Value = \"Fruit\"\n\nElseIf aCell.Value2 = \"Banana\" Then\n    aCell.Worksheet.Cells(aCell.Row, theColumnToWriteTo).Value = \"Fruit\"\n\nElseIf aCell.Value2 = \"Onion\" Then\n    aCell.Worksheet.Cells(aCell.Row, theColumnToWriteTo).Value = \"Vegetable\"\n\nElse\n    aCell.Worksheet.Cells(aCell.Row, theColumnToWriteTo).Value = \"other\"\n\nEnd If\n\nNext aCell\n\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE</strong> Here's an alternative approach that is more complex, but is FAR more efficient and really is the \"<em>correct</em>\" way to do such actions. The result is that your worksheet is only modified once, which can make a huge difference when doing thousands of cells in a worksheet with formulas everywhere.</p>\n\n<p>You can change the  <code>Const</code> parameters.</p>\n\n<pre><code>Sub getArays()\nConst pullRangeAddress As String = \"B2:B100\"\nConst destinationAddress As String = \"C2\"\nDim WS As Worksheet: Set WS = ActiveSheet ' of whatever sheet\n\n\n\n    Dim tRay(): tRay() = WS.Range(pullRangeAddress).Value2\n\n    'create new blank array to hold values\n    ReDim nRay(LBound(tRay, 1) To UBound(tRay, 1), LBound(tRay, 2) To UBound(tRay, 2))\n\n\n    Dim x As Long, y As Long\n    For x = LBound(tRay, 1) To UBound(tRay, 1)\n        For y = LBound(tRay, 2) To UBound(tRay, 2)\n\n            If tRay(x, y) = \"Banana\" Then\n                nRay(x, y) = \"Fruit\"\n\n            ElseIf tRay(x, y) = \"Apple\" Then\n                nRay(x, y) = \"Fruit\"\n\n            ElseIf tRay(x, y) = \"Onion\" Then\n                nRay(x, y) = \"Vegetable\"\n\n            Else\n                nRay(x, y) = \"Other\"\n\n            End If\n        Next y\n    Next x\n\n\n    WS.Range(destinationAddress).Resize(UBound(nRay, 1), UBound(nRay, 2)) = nRay\n\nEnd Sub\n</code></pre>\n\n<p><strong>Updated Again Trying To Keep Everyone In The Comments Happy</strong></p>\n\n<p>You could use a select statement which is a little easier to visualize.</p>\n\n<pre><code>For x = LBound(tRay, 1) To UBound(tRay, 1)\n\nFor y = LBound(tRay, 2) To UBound(tRay, 2)\n\nSelect Case tRay(x, y)\n\n    Case \"Banana\", \"Apple\", \"Grapes\"\n        nRay(x, y) = \"Fruit\"\n\n    Case \"Onion\"\n        nRay(x, y) = \"Vegetable\"\n\n    Case \"Mushrooms\", \"Weed\"\n        nRay(x, y) = \"illegal\"\n\n    Case Else\n        nRay(x, y) = \"Other\"\n\n    End Select\nNext y\nNext x\n</code></pre>\n\n<p><strong>Adding Another Option That Leverages Excel's new <em>IFS</em> function...</strong>\nDifferent answer had a good idea of just using a formula. I like the concept, but <strong><em>no helper column allowed</em></strong>! </p>\n\n<pre><code>Range(\"D2:D200\").FormulaR1C1 _\n\"=IFS(OR(RC[-1]=\"\"Apple\"\",RC[-1]=\"\"Banana\"\"),\"\"Fruit\"\",RC[-1]=\"\"Onion\"\",\"\"Vegetable\"\",TRUE,\"\"Other\"\")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1570292974, "post_id": 58194553, "comment_id": 102870815, "body": "Technically this will not always return the same result of the macro as yours is case insensitive, which is actually probably what OP wanted. However, cheater column is no bueno! I&#39;m going to call the police.... just kidding. Nice answer I gave you a \ud83d\udc4d\ud83c\udffc"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1570293004, "post_id": 58194553, "comment_id": 102870822, "body": "<code>=IF(OR(EXACT(RC[-1],&quot;Apple&quot;),EXACT(RC[-1],&quot;Banana&quot;)),&quot;Fruit&quot;&zwnj;&#8203;,IF(EXACT(RC[-1],&quot;On&zwnj;&#8203;ion&quot;),&quot;Vegetable&quot;,&quot;O&zwnj;&#8203;ther&quot;))</code> for case insensative."}], "tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 1, "last_activity_date": 1569984569, "last_edit_date": 1569984569, "creation_date": 1569983986, "answer_id": 58194553, "question_id": 58193241, "link": "https://stackoverflow.com/questions/58193241/how-to-use-string-text-within-if-else-statements-in-excel-vba/58194553#58194553", "title": "How to use string-text within If-else statements in Excel VBA", "body": "<p>If you care about speed, use Excel Formula.\n<img src=\"https://i.stack.imgur.com/ClUwP.png\" alt=\"enter image description here\"></p>\n\n<p>If you want to use VBA, you could use <code>FormulaR1C1</code> property of <code>Range</code> object.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Range(\"D2:D200\").FormulaR1C1 = \"=iferror(vlookup(rc2,c7:c8,2,false),\"\"other\"\")\"\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/ho5Uq.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 14148683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75885bcaca7b5c646eae1ac3940feee9?s=128&d=identicon&r=PG", "display_name": "Galust", "link": "https://stackoverflow.com/users/14148683/galust"}, "edited": false, "score": 0, "creation_date": 1598111508, "post_id": 63538127, "comment_id": 112354149, "body": "how to solve the problem of automatically determining the maximum and minimum"}], "tags": [], "owner": {"reputation": 1, "user_id": 14148683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75885bcaca7b5c646eae1ac3940feee9?s=128&d=identicon&r=PG", "display_name": "Galust", "link": "https://stackoverflow.com/users/14148683/galust"}, "is_accepted": false, "score": 0, "last_activity_date": 1598111896, "last_edit_date": 1598111896, "creation_date": 1598111402, "answer_id": 63538127, "question_id": 58193241, "link": "https://stackoverflow.com/questions/58193241/how-to-use-string-text-within-if-else-statements-in-excel-vba/63538127#63538127", "title": "How to use string-text within If-else statements in Excel VBA", "body": "<pre><code>Sub UpdateScale()\nDim ChartVar As Chart\nDim lMax As Long, lMin As Long\n\nOn Error GoTo ScalingProblem\n    'Assigns the values in the Min and Max ranges to variables.\n    With \u00cb\u00e8\u00f1\u00f29\n    ' Sheet9\n        lMax = .Range(&quot;Max&quot;).Value\n        lMin = .Range(&quot;Min&quot;).Value\n        'Creates chart object.\n        Set ChartVar = .ChartObjects(&quot;Chart 1&quot;).Chart\n        \n               With ChartVar.Axes(xlValue, xlPrimary)  'Adjusts the price axis\n                   .MinimumScale = 1.301    'iMin\n                   .MaximumScale = 1.326    'iMax\n               End With\n            \n    End With\nExit Sub\n\nScalingProblem:\n'RetrievalProblem:\n'    MsgBox &quot;Unable to update chart scale.&quot;, vbCritical + vbOKOnly, &quot;Scaling Error&quot;\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12150986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d68795d1cb904598241ac7b23a5cde2d?s=128&d=identicon&r=PG&f=1", "display_name": "watapana", "link": "https://stackoverflow.com/users/12150986/watapana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1598111896, "creation_date": 1569970150, "last_edit_date": 1569971393, "question_id": 58193241, "link": "https://stackoverflow.com/questions/58193241/how-to-use-string-text-within-if-else-statements-in-excel-vba", "title": "How to use string-text within If-else statements in Excel VBA", "body": "<p>I'm trying to speed up a process where a macro checks a range of text in column B to group them in column C as a specific keyword. For example, if B2 has apple, it marks it as fruit in C2, if B3 has Onion, it marks it as vegetables in C3. Eventually some other texts I would like for them to just appear as \"other\". Unfortunately, I am not having any luck in actually making it work as I wish.</p>\n\n<pre><code>Sub Categorize()\n\nIf Range(\"B2:B100\").text=\"Apple\" then\nRange(\"C2:C100\").text=\"Fruit\"\n\nElseIf Range(\"B2:B100\").text=\"Banana\" Then\nRange(\"C2:C100\").text=\"Fruit\"\n\nElseIf Range(\"B2:B100\").text=\"Onion\" Then\nRange(\"C2:C100\").text=\"Vegetable\"\n\nElse\nRange(\"C2:C100\")=\"Other\"\n\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Can you guys help me out?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "edited": false, "score": 0, "creation_date": 1569970846, "post_id": 58193161, "comment_id": 102765720, "body": "You might want to include the code snipplet that includes the protection of the sheet."}, {"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "reply_to_user": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "edited": false, "score": 0, "creation_date": 1569971201, "post_id": 58193161, "comment_id": 102765812, "body": "I actually don&#39;t have any code to protect the sheet, I&#39;m simply using the buttons for &quot;Protect&quot; and &quot;Unprotect&quot; worksheet found in the ribbon."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1569974303, "post_id": 58193161, "comment_id": 102766370, "body": "I&#39;m confused. If you don&#39;t use code to protect the sheet, in what way can you determine whether <code>Userinterfaceonly</code> doesn&#39;t work out for you?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1569977288, "post_id": 58193161, "comment_id": 102766838, "body": "Unprotect the sheet at the start of your code, then re-protect at the end."}, {"owner": {"reputation": 161, "user_id": 9119508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2PLgg.jpg?s=128&g=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/9119508/lorne"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1570000979, "post_id": 58193161, "comment_id": 102772123, "body": "@TimWilliams That should not be necessary if he manages to protect Userinterfaceonly. I think the question is about how to achieve that."}, {"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1570026390, "post_id": 58193161, "comment_id": 102785246, "body": "Yes, my question is about syntax for Userinterfaceonly.  I&#39;m not sure exactly how to use it.  Can you shed some light on what I&#39;m doing wrong?"}], "answers": [{"tags": [], "owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1570054052, "creation_date": 1570054052, "answer_id": 58209948, "question_id": 58193161, "link": "https://stackoverflow.com/questions/58193161/allow-excel-macros-to-run-on-a-protected-sheet/58209948#58209948", "title": "Allow Excel Macros to Run On a Protected Sheet", "body": "<p>For anyone wondering, below is the solution:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    Worksheets(\"Data Entry\").Protect Userinterfaceonly:=True\n    Worksheets(\"Data Entry\").Range(\"C6:C10\") = \"\"\n    Worksheets(\"Data Entry\").Range(\"C12:C15\") = \"\"\n    Worksheets(\"Data Entry\").Range(\"C17:C19\") = \"\"\nConditionalDisplay\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 598, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570054107, "creation_date": 1569969618, "last_edit_date": 1570054107, "question_id": 58193161, "link": "https://stackoverflow.com/questions/58193161/allow-excel-macros-to-run-on-a-protected-sheet", "title": "Allow Excel Macros to Run On a Protected Sheet", "body": "<p>I have the following macro that is not able to run whenever I protect the sheet.</p>\n\n<pre><code>Sub ConditionalDisplay()\n    With Worksheets(\"Data Entry\")\n    If .Range(\"C13\") = \"\" Then\n        .Rows(\"14:15\").Hidden = True\n      Else\n        .Rows(\"14\").Hidden = .Range(\"C13\") = \"lbs/gal\"\n        .Rows(\"15\").Hidden = .Range(\"C13\") = \"g/L\"\n    End If\n\n    If .Range(\"C17\") = \"\" Then\n        .Rows(\"18:19\").Hidden = True\n        Else\n            .Rows(\"18\").Hidden = .Range(\"C17\") = \"lbs/gal\"\n            .Rows(\"19\").Hidden = .Range(\"C17\") = \"g/L\"\n    End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>If it's unprotected it works fine, but protecting the sheet throws an error when I open the workbook as this sub routine is called when the workbook opens.  I saw a couple of websites that reference using the <code>\"Me.Protect Userinterfaceonly:=true\"</code> but so far that has not worked out for me.</p>\n\n<p>Are there any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1569965881, "post_id": 58192488, "comment_id": 102764421, "body": "what are the file types you are trying to save as?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569966279, "post_id": 58192488, "comment_id": 102764543, "body": "What are the potential values for <code>TypeCode</code> which are stored on the worksheet?  If you&#39;re taking this approach you must use the numeric values for the various fileTypes - you cannot use (eg) the string &quot;xlWorkbookDefault&quot; but instead should have 51 (the numeric value)"}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1569966454, "post_id": 58192488, "comment_id": 102764575, "body": "The files I am attempting to save as are .csv, .xlsx, and .xls with type codes 6, 51, and 56 respectively"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569966541, "post_id": 58192488, "comment_id": 102764607, "body": "Maybe try <code>Debug.Print</code> ing the constructed filename to make sure there are no problems there"}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1569966807, "post_id": 58192488, "comment_id": 102764691, "body": "I changed the bottom two lines to comments and ran the code through the MM.DD.YY part, and that saved the file in the desired directory. So it works up until that point.   And I ran the index match sections and the variable sections in the immediate window, and they returned the correct values.   There just seems to be a problem when joining them together."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569967109, "post_id": 58192488, "comment_id": 102764782, "body": "Maybe make sure <code>TypeCode</code> is numeric and not coming in as a string"}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1569967339, "post_id": 58192488, "comment_id": 102764856, "body": "<code>TypeCode</code> is declared as an integer"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1569967723, "post_id": 58192488, "comment_id": 102764963, "body": "assume FileType is the extension of the file?  If so then you are missing a period between the date format and the extension."}, {"owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "edited": false, "score": 0, "creation_date": 1569970507, "post_id": 58192488, "comment_id": 102765646, "body": "The Index(Match()) returns the file extension as *.xslx, *.csv, or *.xls. Would I need an additional period on top of the one that is returned?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569970559, "post_id": 58192488, "comment_id": 102765656, "body": "Try hard-coding the FileFormat for a know extension - does that work?"}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "is_accepted": true, "score": 0, "last_activity_date": 1570027515, "creation_date": 1570027515, "answer_id": 58203905, "question_id": 58192488, "link": "https://stackoverflow.com/questions/58192488/how-to-use-vba-to-save-as-with-a-dynamic-file-type/58203905#58203905", "title": "How to use VBA to Save As with a dynamic file type", "body": "<p>Turns out it was a simple error. I had the asterisk included in the file extension being returned (ex. *.xlsx). Upon removing the asterisk from the file extensions in the table, the code ran fine.</p>\n"}], "owner": {"reputation": 13, "user_id": 12020711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b816ab8df1e6042f94cc758cd4832ddc?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/12020711/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 58203905, "answer_count": 1, "score": 0, "last_activity_date": 1570027515, "creation_date": 1569965348, "last_edit_date": 1569966287, "question_id": 58192488, "link": "https://stackoverflow.com/questions/58192488/how-to-use-vba-to-save-as-with-a-dynamic-file-type", "title": "How to use VBA to Save As with a dynamic file type", "body": "<p>I am attempting to write code that will automate updating inventory spreadsheets for different vendors. I have run into a problem when it comes to saving the files as the vendors require different file types when uploading the inventory. So what I am needing is some code that will dynamically change the save as file type depending on the vendor.</p>\n\n<p>What I have so far is a multi-select file dialogue which the user utilizes to select the spreadsheets they want to update. The VBA I have so far loops these selected templates which are opened, updated via formulas in the spreadsheet, and then saved  in a different folder and named with the vendor name and the current date.</p>\n\n<p>Here is the problem section of code I am working with:</p>\n\n<pre><code>CustomerWB.SaveAs Filename:=\"S:\\Online Inventory Reports\\\" _\n                &amp; Left(CustomerWB.Name, 6) _\n                &amp; \"\\\" _\n                &amp; Left(CustomerWB.Name, 6) _\n                &amp; \" \" _\n                &amp; Format(Now(), \"MM.DD.YY\") _\n                &amp; WorksheetFunction.Index(ThisWorkbook.Sheets(2).Range(\"B:B\"),WorksheetFunction.Match(Left(CustomerWB.Name, 6),ThisWorkbook.Sheets(2).Range(\"A:A\"),0)), _\n                FileFormat:=WorksheetFunction.Index(ThisWorkbook.Sheets(2).Range(\"C:C\"),WorksheetFunction.Match(Left(CustomerWB.Name, 6),ThisWorkbook.Sheets(2).Range(\"A:A\"),0))\n</code></pre>\n\n<p>I have debugged each piece of the code and it works up until I hit the <code>Index(Match()</code> sections.</p>\n\n<p>The formulas are looking into a table which has the vendor IDs next to the required file type and type code. When run in the immediate window, these formulas produce the desired result. But when they are run in this code, an error is returned: <code>Run-time error '1004': Method 'SaveAs' of Object '_Workbook' failed</code> So it seemed like VBA didn't like the fact I was mixing in worksheet functions when trying to save the file. </p>\n\n<p>So I moved the <code>Index(Match())</code> sections into the spreadsheet and had the VBA populate a cell with the vendor name. Then assigned variables to the values of the cells which now returned the file type and type code. The new code looks like this:</p>\n\n<pre><code>CustomerWB.SaveAs Filename:=\"S:\\Online Inventory Reports\\\" _\n                &amp; Left(CustomerWB.Name, 6) _\n                &amp; \"\\\" _\n                &amp; Left(CustomerWB.Name, 6) _\n                &amp; \" \" _\n                &amp; Format(Now(), \"MM.DD.YY\") _\n                &amp; FileType, _\n                FileFormat:=TypeCode\n</code></pre>\n\n<p>But I get the same error. Any help would be much appreciated.</p>\n"}, {"tags": ["excel", "vba", "string", "integer"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11645230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd5843a99e3b3f478a06de3ff80ec6c?s=128&d=identicon&r=PG&f=1", "display_name": "xxmalaboo", "link": "https://stackoverflow.com/users/11645230/xxmalaboo"}, "is_accepted": false, "score": 0, "last_activity_date": 1570554698, "creation_date": 1570554698, "answer_id": 58291037, "question_id": 58192458, "link": "https://stackoverflow.com/questions/58192458/how-to-find-a-date-in-a-column-return-a-row-number-location-as-an-integer-then/58291037#58291037", "title": "How to find a Date in a Column, return a row number location as an integer, then store as a variable to subtract dates", "body": "<p>For those interested - I found an easy way to do it using match function in VBA.  I was essentially trying to copy a time series of data from one spreadsheet to another - accomodating business day differences.</p>\n\n<p>See function Below:</p>\n\n<pre><code>Sub SearchFunction()\n\nDim raw As Worksheet, raw2 As Worksheet, raw3 As Worksheet, raw5 As Worksheet\n\nDim NewDates2 As Integer, RowOutputFile As Integer, RowOutputFile2 As Integer \nDim Wb7 As Workbook, Wb5 As Workbook\nDim NewDates As Long\nDim NewDates3 As Date, TextDate As Date\nDim Rng1 As Range, Rng2 As Range, Rng3 As Range\n\nSet Wb5 = Workbooks.Open(\"G:\\DATA......)\nSet raw = Sheets(\"BarraInputs\")\nSet raw2 = Sheets(\"BarraOutputTS\")\nSet raw3 = Sheets(\"BarraPerformance\")\n\nSet Wb7 = Workbooks.Open(\"G:\\DATA\\2......)\nApplication.DisplayAlerts = False\n\nSet raw5 = Sheets(\"dailyPnL\")\n\n\nWb5.Activate\nRowOutputFile = Range(\"A8\").End(xlDown).Row\n\nWb7.Activate\nraw5.Activate\n\nRowOutputFile2 = Range(\"A8\").End(xlDown).Row\n\nDim col_match As Double\ncol_match = Application.WorksheetFunction.Match(raw3.Cells(1, 1), raw5.Range(\"A:A\"), 0)\n\nStartCell = \"E\" &amp; col_match\nStartCell2 = \"G\" &amp; col_match\n\nDragRange = \"E\" &amp; col_match &amp; \":E\" &amp; RowOutputFile2\nDragRange2 = \"G\" &amp; col_match &amp; \":G\" &amp; RowOutputFile2\n\n        Set Rng1 = ActiveSheet.Range(DragRange)\n        Set Rng2 = ActiveSheet.Range(DragRange2)\n        Set Rng3 = Union(Rng1, Rng2)\n        Rng3.Copy\n\n        Wb5.Activate\n        raw3.Activate\n\n        StartCell3 = \"M\" &amp; RowOutputFile\n\n        Range(StartCell3).PasteSpecial xlPasteValuesAndNumberFormats\n\n   End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11645230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dd5843a99e3b3f478a06de3ff80ec6c?s=128&d=identicon&r=PG&f=1", "display_name": "xxmalaboo", "link": "https://stackoverflow.com/users/11645230/xxmalaboo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570554698, "creation_date": 1569965177, "last_edit_date": 1569969279, "question_id": 58192458, "link": "https://stackoverflow.com/questions/58192458/how-to-find-a-date-in-a-column-return-a-row-number-location-as-an-integer-then", "title": "How to find a Date in a Column, return a row number location as an integer, then store as a variable to subtract dates", "body": "<p>Trying to come up with a way to search for a date in a column, return the row number, then store it as an integer in which I could subtract an integer from the date found to give me a new value.  Such as 539 - 1 to give me the specific Date in Column A - Row 538</p>\n\n<p>I've tried referencing a FoundCell function in which it will return the address as a string, but not a value in which I could manipulate it - such as substracting due to the differences in object types. (Date, Range, String)</p>\n\n<p>I feel like I'm on the right path - but just don't know the right syntax to figure this out and googling has not gotten me an answer after searching.</p>\n\n<pre><code>    Sub TestFunction()\n\n    Set Wb7 = Workbooks.Open(\"G:\\DATA\\......xlsm\")\n\n    Set raw5 = Sheets(\"dailyPnL\")\n    Set Wb7 = ActiveWorkbook\n    Set raw5 = ActiveSheet\n\n    RowOutputFile2 = Range(\"A8\").End(xlDown).Row   \n</code></pre>\n\n<p>'This gives me the last date row value which is 539 in this case.\n'I want to be able to search for any Date Variable using - 2 as an example to give me row 537 then store it as a new variable / starting point.</p>\n\n<pre><code>    Dim WHAT_TO_FIND As Date\n    Dim FoundCell As Range  \n    Dim FindCell As Range\n    Dim FirstAddress As String\n    Dim TestAddress As Range\n\n\n    WHAT_TO_FIND = raw5.Cells(RowOutputFile2, 1)  '=9/27/2019\n    Set FoundCell = raw5.Range(\"A:A\").Find(What:=WHAT_TO_FIND)\n</code></pre>\n\n<p>'FoundCell = 9/27/2019</p>\n\n<pre><code>    With ActiveSheet\n    Set FindCell = .Cells.Find(What:=WHAT_TO_FIND)\n    End With\n    FirstAddress = FindCell.Address\n</code></pre>\n\n<p>'This provides me as a string \"$A$539</p>\n\n<pre><code>    Set TestAddress = Range(FirstAddress)\n</code></pre>\n\n<p>'Trying to convert TestAddress as a range to provide me with A539 that I could use as a starting point. </p>\n\n<p>'Eventually I want to use the \"Found\" start date in A539 as my reference point, and substract an Integer from it using the results from another variable.  Such as the difference between Workdays. </p>\n\n<pre><code>    Workdays = Application.WorksheetFunction.NetworkDays(raw3.Cells(RowOutputFile, 1), raw5.Cells(2, 1))\n</code></pre>\n\n<p>'For example this would give me 1 because it's taking the Dates between two spreadsheet and calculating the difference between them in business days. </p>\n\n<pre><code>    If Workdays = 1 Then\n\n    New1RowOutputFile = FoundCell - Workdays\n\n    End Sub\n</code></pre>\n\n<p>'This is my goal, to make New1RowOutputFile give me a row number subtracting the Workday Integer.  This would be 539 - 1 = 538.  Now I want the specific date that sits in A538 which would translated as the new \"New1RowOutputFile\" .            </p>\n\n<p>I get a bunch of different syntax errors switching between Dates, Ranges, and Integers that I just don't know how to do it.  Help is greatly appreciated!</p>\n"}, {"tags": ["excel", "vba", "countif"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569965342, "post_id": 58192422, "comment_id": 102764256, "body": "A formula will not open another file.  You will need to do it manually or use vba."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12150767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c956dc2247aa1e64628118576bf4f9e?s=128&d=identicon&r=PG&f=1", "display_name": "Suleiman", "link": "https://stackoverflow.com/users/12150767/suleiman"}, "edited": false, "score": 0, "creation_date": 1570028168, "post_id": 58193712, "comment_id": 102786282, "body": "Awesome, I will try this approach and let you know.   Thanks a lot"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1569974698, "creation_date": 1569974698, "answer_id": 58193712, "question_id": 58192422, "link": "https://stackoverflow.com/questions/58192422/countif-on-two-files/58193712#58193712", "title": "CountIf on two files", "body": "<p>Conceptually: </p>\n\n<p>In the other file, use a helper sheet or a helper column to perform the CountIF in that workbook.</p>\n\n<p>In the first file, use a simple cell reference to the other file's helper cells. </p>\n\n<p>The CountIF in the second file will either be recalculated on the fly if it is open, or, if it is closed, it will return the latest stored result of the CountIF.</p>\n"}], "owner": {"reputation": 1, "user_id": 12150767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c956dc2247aa1e64628118576bf4f9e?s=128&d=identicon&r=PG&f=1", "display_name": "Suleiman", "link": "https://stackoverflow.com/users/12150767/suleiman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574444467, "creation_date": 1569964990, "last_edit_date": 1574444467, "question_id": 58192422, "link": "https://stackoverflow.com/questions/58192422/countif-on-two-files", "title": "CountIf on two files", "body": "<p>I have two files and both have an ID or identifier that share the same value.</p>\n\n<p>I need to open the first file and run countif function to do the following:</p>\n\n<ol>\n<li>Read cells values in a specific columns from file 1.  </li>\n<li>Go to file 2 and run countif function to see how many values are exist in file 2 that matches the cells in file 1.  </li>\n<li>come back to file 1 and print the results next to each cell in file 1. </li>\n</ol>\n\n<p>I am able to run countif for only one cell. I can't find how I can use this function to open another file and look for an item and come back to print out inside the first one.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1569964589, "post_id": 58192280, "comment_id": 102764022, "body": "You&#39;re using <code>With</code>, but not connecting that with the <code>Range</code> objects. Add a period before all <code>Range</code> objects, e.g. <code>LastRow = .Cells()</code>, <code>.Range(&quot;C2:G2&quot; &amp; lastRow)</code>, etc. ...also, do you mean to do <code>.Range(&quot;C2:G&quot; &amp; lastRow)</code>? Finally, you could likely do this in two lines.  Get your lastRow, then <code>.Range(&quot;C2:G&quot; &amp; LastRow - 1).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = &quot;=R[-1]C&quot;</code>."}, {"owner": {"reputation": 1500, "user_id": 857031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0a2b914e7fbb73f6ec89bb125a489574?s=128&d=identicon&r=PG", "display_name": "jabs", "link": "https://stackoverflow.com/users/857031/jabs"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570030127, "post_id": 58192280, "comment_id": 102787521, "body": "Thanks Batman. I used your single line and it works, but the problem is the same. If there is no line in the detail preceding the subtotal line, the code will reach back until it finds a value to copy down. I want it to go back only to the row preceding the subtotal line."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570033903, "post_id": 58192280, "comment_id": 102789435, "body": "Does you &quot;subtotal&quot; line have &quot;Subtotal&quot; in a row? Say the sum is going in <code>B20</code>, does it say &quot;Subtotal&quot; in say <code>A20</code>?"}, {"owner": {"reputation": 1500, "user_id": 857031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0a2b914e7fbb73f6ec89bb125a489574?s=128&d=identicon&r=PG", "display_name": "jabs", "link": "https://stackoverflow.com/users/857031/jabs"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1570041800, "post_id": 58192280, "comment_id": 102792997, "body": "No, A20 has the client name, which is what was totaled on."}], "owner": {"reputation": 1500, "user_id": 857031, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0a2b914e7fbb73f6ec89bb125a489574?s=128&d=identicon&r=PG", "display_name": "jabs", "link": "https://stackoverflow.com/users/857031/jabs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569964094, "creation_date": 1569964094, "question_id": 58192280, "link": "https://stackoverflow.com/questions/58192280/excel-vba-copy-last-line-of-detail-line-into-subtotal-line", "title": "Excel vba Copy last line of detail line into subtotal line", "body": "<p>I run a vba script with a subtotal function. The script also copies the last line from the detail into the subtotal lines (on non-numeric lines).</p>\n\n<pre><code>     With sht\n        LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n        'Copy comment information to subtotal line\n        Range(\"C2:G2\" &amp; LastRow).Offset(-1, 0).Select\n        'Range(\"Z2:AA2\" &amp; LastRow).Offset(-1, 0).Select\n        Selection.SpecialCells(xlCellTypeBlanks).Select\n        Selection.FormulaR1C1 = \"=R[-1]C\"\n     End With\n</code></pre>\n\n<p>This works well on lines where there is data in the detail right above it. It doesn't work when the detail line is null - it will reach up until it finds something and copy it down. </p>\n\n<p>TIA.</p>\n"}, {"tags": ["excel", "vba", "compare"], "comments": [{"owner": {"reputation": 1, "user_id": 12075920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa347c58a75e7261ee0c8a662ea4e54b?s=128&d=identicon&r=PG", "display_name": "user208834", "link": "https://stackoverflow.com/users/12075920/user208834"}, "edited": false, "score": 0, "creation_date": 1569963869, "post_id": 58192231, "comment_id": 102763769, "body": "I forgot to say hello ;-)"}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1569966967, "post_id": 58192231, "comment_id": 102764742, "body": "Can you show us what you have tried?"}, {"owner": {"reputation": 1633, "user_id": 12001122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ec161ec6ec2ddb3c5ea5989f03fe053?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas", "link": "https://stackoverflow.com/users/12001122/jonas"}, "edited": false, "score": 0, "creation_date": 1570042430, "post_id": 58192231, "comment_id": 102793303, "body": "Unless the rows don&#39;t have fixed IDs or similar this will be a super tough or even impossible action in case new rows are added in between the table (there might be some workaround if you know which rows have been added). Please provide files/expected outcome"}], "owner": {"reputation": 1, "user_id": 12075920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa347c58a75e7261ee0c8a662ea4e54b?s=128&d=identicon&r=PG", "display_name": "user208834", "link": "https://stackoverflow.com/users/12075920/user208834"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570019797, "creation_date": 1569963819, "last_edit_date": 1570019797, "question_id": 58192231, "link": "https://stackoverflow.com/questions/58192231/comparing-tables-cell-by-cell", "title": "Comparing tables cell by cell", "body": "<p>I would like to compare two tables on a cell by cell bases. The difficulty is, however, that Information is always row-based meaning that Information in one row belongs together. It can theoretically happen that only single cells of a row are modified in the second (newer) table. Also, it can happen that new rows are added either at the end of the table or in between. I tried to concatenate all cells of one row into one Cell and then to compare these between the two tables, however, that is limited to 256 characters which are not enough for a complete row. At least in this way, I can detector new rows in the second table. Unfortunately, this does not work for the detection of differences on a  Cell level. Does anybody have an idea? Thanks a lot in advance. Best wishes, Hansi</p>\n"}, {"tags": ["arrays", "excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1569962304, "post_id": 58191918, "comment_id": 102763240, "body": "Ubound and Lbound are functions used to return array limits, not those of range objects. Check the documentation to see how they are used."}, {"owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569962684, "post_id": 58191918, "comment_id": 102763368, "body": "The problem is that I don&#39;t even know how to reference the ranges within my array, period. The value I have to sort by is at the (0, 1) position each time, so if I only knew how to reference it I&#39;d be in shape to keep going."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1569962934, "post_id": 58191918, "comment_id": 102763447, "body": "The easiest is to create a helper column that fills in the missing items in the second column, then sort on that new column. Then you can clear the helper column."}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "is_accepted": true, "score": 0, "last_activity_date": 1571163409, "creation_date": 1571163409, "answer_id": 58400495, "question_id": 58191918, "link": "https://stackoverflow.com/questions/58191918/how-do-i-reference-a-single-cell-within-an-array-of-ranges-in-vba-to-sort-by-it/58400495#58400495", "title": "How do I reference a single cell within an array of ranges in VBA to sort by it?", "body": "<p>Was a little cheeky in how I did this:</p>\n\n<pre><code>Dim sorting As Range\nDim everything() As Range\n\n'Values looped into everything() in different code not pasted here\n'y is likewise calculated elsewhere\n\nSet sorting = everything(y)\n\nsorting.Offset(0, 1).Select\nActiveCell.Select\n\n'The two values I need to sort by are below\nTemp1 = \"\" &amp; ActiveCell.Value\nven1 = \"\" &amp; ActiveCell.Offset(0, 1).Value\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10642369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d41bd0eb65ce084302a568011a05d30e?s=128&d=identicon&r=PG&f=1", "display_name": "Poppenhoffer", "link": "https://stackoverflow.com/users/10642369/poppenhoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 58400495, "answer_count": 1, "score": 0, "last_activity_date": 1571163409, "creation_date": 1569962091, "question_id": 58191918, "link": "https://stackoverflow.com/questions/58191918/how-do-i-reference-a-single-cell-within-an-array-of-ranges-in-vba-to-sort-by-it", "title": "How do I reference a single cell within an array of ranges in VBA to sort by it?", "body": "<p>So I have several different components, some of which have different subcomponents listed under them within the same sheet in a different column, like so:</p>\n\n<pre><code>1    C\n2    B\n           bi            10%\n           bii           30%\n           biii          60%\n3    A\n4    D\n           di            20%\n           dii           80%\netc.\n</code></pre>\n\n<p>What I want to do is sort them by A, B, C, D alphabetically without it also messing with the added info. Right now I have a code that counts each element, sizes the array appropriately, then loops in each range via selecting all associated rows for each item and looping the range in. However, when I try to sort, I can't seem to get it to work. Any idea how I can go about this? Thanks.</p>\n\n<pre><code>\nDim everything() As Range\nDim check As Range\nDim count As Range\n\nDim lr As Long\nDim x As Long\nDim y As Long\nDim z As Long\nDim q As Long\n\nDim Temptxt1 As String\nDim Temptxt2 As String\n\ny = 0\nz = 0\nq = 0\nWith ThisWorkbook.Sheets(\"Names and Vendors\")\nlr = .Cells(.Rows.count, \"B\").End(xlUp).Row\n\n    'Counts number of elements to size the \"everything\" array\n    For z = 2 To lr\n    Set count = .Range(\"B\" &amp; z)\n        If IsEmpty(count) = False Then\n            q = q + 1\n            End If\n    Next z\n    ReDim everything(z) As Range 'Resizes array\n\n    'Loops all RM info into array by each distinct range\n    For x = 2 To lr\n        Set check = .Range(\"B\" &amp; x).EntireRow\n        If IsEmpty(.Range(\"B\" &amp; 1 + x)) = True Then\n            Do While IsEmpty(.Range(\"B\" &amp; 1 + x)) = True And x &lt; lr\n                    Set check = Union(check, .Range(\"B\" &amp; 1 + x).EntireRow)\n                    x = x + 1\n                Loop\n        End If\n        Set everything(y) = check\n        y = y + 1\n        Next x\n\n    'This is where the code breaks. It gives me a type mismatch.\n    For x = LBound(everything) To UBound(everything)\n    For y = x To UBound(everything)\n      If UCase(everything(y)) &lt; UCase(everything(x)) Then\n        Temptxt1 = everything(x).Range(1, 2)\n        Temptxt2 = everything(y).Range(1, 2)\n        everything(x) = Temptxt2\n        everything(y) = Temptxt1\n      End If\n     Next y\n  Next x\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 842, "user_id": 6631196, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FrpVamcXlKg/AAAAAAAAAAI/AAAAAAAAAAA/JgmRFocK8CY/photo.jpg?sz=128", "display_name": "Ilia Gilmijarow", "link": "https://stackoverflow.com/users/6631196/ilia-gilmijarow"}, "edited": false, "score": 0, "creation_date": 1569961825, "post_id": 58191612, "comment_id": 102763068, "body": "Wouldn&#39;t it be simpler to ask for VOC content and then ask user to select unit for that number?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1569963936, "post_id": 58191612, "comment_id": 102763790, "body": "Sounds like you might want to use the <code>Worksheet_Change</code> event to run your code"}, {"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1569965717, "post_id": 58191612, "comment_id": 102764376, "body": "@LLia: I suppose that&#39;s one to go about it, sure =D"}], "answers": [{"tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 1, "last_activity_date": 1569960805, "creation_date": 1569960805, "answer_id": 58191669, "question_id": 58191612, "link": "https://stackoverflow.com/questions/58191612/conditional-display-of-rows-using-excel-vba/58191669#58191669", "title": "Conditional Display of Rows Using Excel VBA", "body": "<p>What you probably want is:</p>\n\n<pre><code>Sub ConditionalDisplay()\n    With Worksheets(\"Data Entry\")\n        If .Range(\"C6\") = \"\" Then\n            .Rows(\"7:8\").Hidden = True\n        End If\n        If .Range(\"C6\") = \"g/L\" Then\n            .Rows(\"8\").Hidden = True\n        End If\n        If .Range(\"C6\") = \"lbs/gal\" Then\n            .Rows(\"7\").Hidden = True\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Properly indenting your code helps to see what happens with it. <a href=\"http://rubberduckvba.com/Indentation\" rel=\"nofollow noreferrer\">This</a> can help</p>\n"}, {"comments": [{"owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "edited": false, "score": 0, "creation_date": 1570026485, "post_id": 58193175, "comment_id": 102785300, "body": "Does anyone have any tips on here on what this code is doing?"}], "tags": [], "owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1569969699, "creation_date": 1569969699, "answer_id": 58193175, "question_id": 58191612, "link": "https://stackoverflow.com/questions/58191612/conditional-display-of-rows-using-excel-vba/58193175#58193175", "title": "Conditional Display of Rows Using Excel VBA", "body": "<p>Apparently the answer was needing to have the following code on the Data Entry worksheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"C13\")) Is Nothing Then\n    ConditionalDisplay\nEnd If\nIf Not Intersect(Target, Range(\"C17\")) Is Nothing Then\n    ConditionalDisplay\nEnd If\nEnd Sub\n</code></pre>\n\n<p>My question is: what exactly do these commands do?  I haven't seen these before.</p>\n"}], "owner": {"reputation": 449, "user_id": 3100879, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/85e6fc486c9ebbc8b742538d5227b921?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan_C", "link": "https://stackoverflow.com/users/3100879/ryan-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1569969699, "creation_date": 1569960471, "last_edit_date": 1569961048, "question_id": 58191612, "link": "https://stackoverflow.com/questions/58191612/conditional-display-of-rows-using-excel-vba", "title": "Conditional Display of Rows Using Excel VBA", "body": "<p><strong>UPDATE</strong></p>\n\n<p>I've modified my code to this but now rows 11 and 12 aren't hiding and unhiding as they should.  Any help?</p>\n\n<pre><code>Sub ConditionalDisplay()\n    With Worksheets(\"Data Entry\")\n    If .Range(\"C6\") = \"\" Then\n        .Rows(\"7:8\").Hidden = True\n    Else\n        .Rows(\"7\").Hidden = .Range(\"C6\") = \"lbs/gal\"\n        .Rows(\"8\").Hidden = .Range(\"C6\") = \"g/L\"\n    End If\n    If .Range(\"C10\") = \"\" Then\n        .Rows(\"11:12\").Hidden = True\n    Else\n        .Rows(\"11\").Hidden = .Range(\"C10\") = \"lbs/gal\"\n        .Rows(\"12\").Hidden = .Range(\"C11\") = \"g/L\"\n    End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>I've had a similar question to this in the past but I'm stumped.  Full disclaimer: I'm a complete beginner when it comes to VBA.</p>\n\n<p>In the below image, I'm trying to have rows 7 and 8 conditionally display based on the input in cell C6.  Additionally, I'm trying to have rows 11 and 12 conditionally display based on input into cell C10.  The data validation choices in cells C6 and C10 are \"g/L\" and \"lbs/gal\".</p>\n\n<p><a href=\"https://i.stack.imgur.com/z71yG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/z71yG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Here's the code that I've started to write, but it doesn't function as intended.  I have a workbook open event that automatically calls the ConditionalDisplay sub routine when the workbook is opened, but I'm having a hard time figuring out how to unhide rows 7 and 8 after making a selection in cell C6.</p>\n\n<pre><code>Sub ConditionalDisplay()\n    With Worksheets(\"Data Entry\")\n    If .Range(\"C6\") = \"\" Then\n        .Rows(\"7:8\").Hidden = True\n    If .Range(\"C6\") = \"g/L\" Then\n        .Rows(\"8\").Hidden = True\n    If .Range(\"C6\") = \"lbs/gal\" Then\n        .Rows(\"7\").Hidden = True\n      End If\n      End If\n      End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>As written, this code is not working as intended.  Any suggestions?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1569960308, "post_id": 58191543, "comment_id": 102762505, "body": "<code>Range(&quot;O2:O&quot; &amp; LastRow).FormulaR1C1 = &quot;=TEXT(RC[-4],&quot;&quot;000000000&quot;&quot;)&quot;</code> No need to <code>Select</code> or <code>AutoFill</code>"}, {"owner": {"reputation": 71, "user_id": 11661025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15be80d8fc2e5b2de208c8ba5809574?s=128&d=identicon&r=PG&f=1", "display_name": "Lukec", "link": "https://stackoverflow.com/users/11661025/lukec"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1569960363, "post_id": 58191543, "comment_id": 102762519, "body": "@BigBen always coming through, thank you sir."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569962742, "post_id": 58191617, "comment_id": 102763392, "body": "Good answer. Would evaluate be a good alternative to include in your answer and avoid formulas alltogether?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569964247, "post_id": 58191617, "comment_id": 102763897, "body": "@JvdV probably, as long as OP doesn&#39;t actually need the formula. Feeling slightly lazy.... so if you add I&#39;ll upvote :)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569964692, "post_id": 58191617, "comment_id": 102764052, "body": "Haha I&#39;m not even close to a pc, a comment will have to do lol =)"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1569960510, "creation_date": 1569960510, "answer_id": 58191617, "question_id": 58191543, "link": "https://stackoverflow.com/questions/58191543/format-a-dynamic-range-of-data-to-text/58191617#58191617", "title": "Format a dynamic range of data to text", "body": "<p>No need to <code>Select</code> or <code>AutoFill</code>.</p>\n\n<p>Change the following:</p>\n\n<pre><code>Set rng = Cells(LastRow, 15)\n\nRange(\"O2\").Select\nActiveCell.FormulaR1C1 = \"=TEXT(RC[-4],\"\"000000000\"\")\"\nRange(\"O2\").Select\nSelection.AutoFill Destination:=Range(\"O2:rng\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>ws.Range(\"O2:O\" &amp; LastRow).FormulaR1C1 = \"=TEXT(RC[-4],\"\"000000000\"\")\"\n</code></pre>\n\n<p>It's my own preference to avoid <code>FormulaR1C1</code>:</p>\n\n<pre><code>ws.Range(\"O2:O\" &amp; LastRow).Formula = \"=TEXT(K2,\"\"000000000\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11661025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e15be80d8fc2e5b2de208c8ba5809574?s=128&d=identicon&r=PG&f=1", "display_name": "Lukec", "link": "https://stackoverflow.com/users/11661025/lukec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58191617, "answer_count": 1, "score": 0, "last_activity_date": 1569960510, "creation_date": 1569960126, "question_id": 58191543, "link": "https://stackoverflow.com/questions/58191543/format-a-dynamic-range-of-data-to-text", "title": "Format a dynamic range of data to text", "body": "<p>I'm trying to convert a string of numbers into 9 digit text. The column will vary in length every time this is run. </p>\n\n<p>Tried using a similar method to finding the LastRow. </p>\n\n<pre><code>Sub Macro3()\n'\nDim LastRow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Data Validation\")\n\nSheets(\"Data Validation\").Select\n\nCells.Replace What:=\"-\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\n    xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\nLastRow = ws.Cells.find(What:=\"*\", After:=ws.Cells(1, 1), \nLookIn:=xlFormulas, LookAt:= _\nxlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious, \nMatchCase:=False).Row\n\nSet rng = Cells(LastRow, 15)\n\nRange(\"O2\").Select\nActiveCell.FormulaR1C1 = \"=TEXT(RC[-4],\"\"000000000\"\")\"\nRange(\"O2\").Select\nSelection.AutoFill Destination:=Range(\"O2:rng\")\n\n\nEnd Sub\n</code></pre>\n\n<p>I'd like my text format to extend down the entire column of existing numbers. Currently I'm getting a Method Range of Object _Global failed error message.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1569959414, "post_id": 58191373, "comment_id": 102762141, "body": "What isn&#39;t working? Are you getting an error? Have you tried <code>Debug.Print</code> to see what the values are?"}, {"owner": {"reputation": 13, "user_id": 12149474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tJ2xqMueLGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reX7EN8D4ysqgtbPjbfSS0v7-vTig/photo.jpg?sz=128", "display_name": "Michael Djurdjevic", "link": "https://stackoverflow.com/users/12149474/michael-djurdjevic"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1569959824, "post_id": 58191373, "comment_id": 102762300, "body": "As I mentioned, no errors were thrown during the execution. Debug.Print shows nothing"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569959921, "post_id": 58191373, "comment_id": 102762341, "body": "Put a breakpoint or stepthrough code to where you compare <code>If temp = gageID</code> and either in your code or in the immediate window run <code>Debug.print temp</code> and <code>Debug.print gageID</code>.  If there are no errors it would seem pretty clear that its just not matching a value."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569960030, "post_id": 58191373, "comment_id": 102762385, "body": "Debug.print your rng.address and fully qualify your range, meaning include a worksheet object. Furthermore put these variables into the watches window and keep an eye out on them when you step through your code"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1569960185, "post_id": 58191373, "comment_id": 102762445, "body": "@MichaelDjurdjevic Can you show us an example of how you&#39;re calling <code>increase()</code>? Your code worked fine for me."}, {"owner": {"reputation": 13, "user_id": 12149474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tJ2xqMueLGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reX7EN8D4ysqgtbPjbfSS0v7-vTig/photo.jpg?sz=128", "display_name": "Michael Djurdjevic", "link": "https://stackoverflow.com/users/12149474/michael-djurdjevic"}, "edited": false, "score": 0, "creation_date": 1569961086, "post_id": 58191373, "comment_id": 102762789, "body": "<a href=\"https://i.imgur.com/Z32HJdx.png\" rel=\"nofollow noreferrer\">i.imgur.com/Z32HJdx.png</a> please see attached photo, why would bool be false in this case? I also tried <code>If temp Like gageID</code> with no success"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1569961404, "post_id": 58191373, "comment_id": 102762902, "body": "Seems like leadin/trailing spaces, use Trim"}, {"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1569961419, "post_id": 58191373, "comment_id": 102762907, "body": "Because they are not the same.  One has a leading space, one doesn&#39;t."}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 3, "creation_date": 1569961454, "post_id": 58191373, "comment_id": 102762918, "body": "Do you see that &quot; &quot; space in the gageID value? The strings must match exactly.  You can wrap them in <code>trim</code> to remove extra spaces on the outside. <code>If trim(temp) = trim(gageID)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1569998145, "creation_date": 1569998145, "answer_id": 58196295, "question_id": 58191373, "link": "https://stackoverflow.com/questions/58191373/if-statement-not-working-with-passed-argument-vba/58196295#58196295", "title": "If statement not working with passed argument VBA", "body": "<p><em>You could do <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/ltrim-rtrim-and-trim-functions\" rel=\"nofollow noreferrer\">Trim()</a> and use <strong><a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/strcomp-function\" rel=\"nofollow noreferrer\">StrComp function</a></em></strong></p>\n\n<blockquote>\n  <p>Returns a Variant (String) containing a copy of a specified string without leading spaces (LTrim), trailing spaces (RTrim), or both leading and trailing spaces (Trim).</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>A comparison of two sequences of characters. Use Option Compare to specify binary or text comparison. In English-U.S., binary comparisons are case sensitive; text comparisons are not.</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 12149474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tJ2xqMueLGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reX7EN8D4ysqgtbPjbfSS0v7-vTig/photo.jpg?sz=128", "display_name": "Michael Djurdjevic", "link": "https://stackoverflow.com/users/12149474/michael-djurdjevic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1585375135, "creation_date": 1569959267, "last_edit_date": 1585375135, "question_id": 58191373, "link": "https://stackoverflow.com/questions/58191373/if-statement-not-working-with-passed-argument-vba", "title": "If statement not working with passed argument VBA", "body": "<p>I have a macro in Outlook which passes an argument to a macro in Excel, the problem is a simple If statement not correctly comparing two values. It may be a data type thing but I'm really not sure as to why this isn't working</p>\n\n<p>I've tried using Like and InStr() but they still didn't work.</p>\n\n<pre><code>Sub increase(gageID As String)\nDim temp As String\n'MsgBox gageID  Shows correct string\nSet Rng = Range(Range(\"A2\"), Range(\"A\" &amp; Rows.Count).End(xlUp))\nFor Each cell In Rng\ntemp = cell.Value\n'MsgBox temp  Loops through every cell in column A correctly\n    If temp = gageID Then 'Can't compare for some reason\n        MsgBox cell.Value    'Code never reaches here, no errors thrown\n        MsgBox \"test3\"\n        cell.Offset(0, 9).Value = cell.Offset(0, 9).Value + 7       \n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8304340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i47Y2.jpg?s=128&g=1", "display_name": "OmarXShay", "link": "https://stackoverflow.com/users/8304340/omarxshay"}, "edited": false, "score": 1, "creation_date": 1569958546, "post_id": 58191211, "comment_id": 102761817, "body": "You&#39;re the greatest my friend! I had a feeling it was staring me right in the face. Thank you SO MUCH!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1569958416, "creation_date": 1569958416, "answer_id": 58191211, "question_id": 58191139, "link": "https://stackoverflow.com/questions/58191139/how-to-code-a-cancel-button-to-not-clear-the-form/58191211#58191211", "title": "How to code a Cancel button to not clear the form?", "body": "<p>Handle the result of the <code>MsgBox</code>:</p>\n\n<pre><code>Private Sub CommandButton23_Click()\n    Dim response As VbMsgBoxResult\n    response = MsgBox(\"Are you sure you want to clear this entire form?\", vbOKCancel)\n\n    If response = vbCancel Then Exit Sub\n\n    ...\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8304340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i47Y2.jpg?s=128&g=1", "display_name": "OmarXShay", "link": "https://stackoverflow.com/users/8304340/omarxshay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 58191211, "answer_count": 1, "score": 1, "last_activity_date": 1605772455, "creation_date": 1569958096, "last_edit_date": 1605772455, "question_id": 58191139, "link": "https://stackoverflow.com/questions/58191139/how-to-code-a-cancel-button-to-not-clear-the-form", "title": "How to code a Cancel button to not clear the form?", "body": "<p>I'm trying to create a 'Clear All Contents' button that clears my form and basically resets it for the user.</p>\n<p>I'm using the 'vbOKCancel' button constant. I thought hitting the 'Cancel' button would stop the code at that point from running any further. But when I hit the 'Cancel' button, it deletes all the data from my form.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton23_Click()\n\n    MsgBox &quot;Are you sure you want to clear this entire form?&quot;, vbOKCancel\n    \n    Dim aRange As Excel.Range\n    Set aRange = Range(&quot;E7&quot;).MergeArea\n    \n    Dim bRange As Excel.Range\n    Set bRange = Range(&quot;E9&quot;).MergeArea\n    \n    Dim cRange As Excel.Range\n    Set cRange = Range(&quot;E11&quot;).MergeArea\n    \n    Dim dRange As Excel.Range\n    Set dRange = Range(&quot;E15&quot;).MergeArea\n    \n    Dim eRange As Excel.Range\n    Set eRange = Range(&quot;E17&quot;).MergeArea\n    \n    Dim fRange As Excel.Range\n    Set fRange = Range(&quot;E19&quot;).MergeArea\n    \n    Dim gRange As Excel.Range\n    Set gRange = Range(&quot;E23&quot;).MergeArea\n    \n    Dim hRange As Excel.Range\n    Set hRange = Range(&quot;N7&quot;).MergeArea\n    \n    Dim iRange As Excel.Range\n    Set iRange = Range(&quot;N9&quot;).MergeArea\n    \n    Dim jRange As Excel.Range\n    Set jRange = Range(&quot;O11&quot;).MergeArea\n    \n    Dim kRange As Excel.Range\n    Set kRange = Range(&quot;Q11&quot;).MergeArea\n    \n    Dim lRange As Excel.Range\n    Set lRange = Range(&quot;N13&quot;).MergeArea\n    \n    Dim mRange As Excel.Range\n    Set mRange = Range(&quot;N15&quot;).MergeArea\n    \n    Dim nRange As Excel.Range\n    Set nRange = Range(&quot;O17&quot;).MergeArea\n    \n    Dim oRange As Excel.Range\n    Set oRange = Range(&quot;Q17&quot;).MergeArea\n    \n    Dim pRange As Excel.Range\n    Set pRange = Range(&quot;N23&quot;).MergeArea\n    \n    Dim xRange As Excel.Range\n    Set xRange = Range(&quot;G27&quot;).MergeArea\n    \n    aRange.ClearContents\n    bRange.ClearContents\n    cRange.ClearContents\n    dRange.ClearContents\n    eRange.ClearContents\n    fRange.ClearContents\n    gRange.ClearContents\n    hRange.ClearContents\n    iRange.ClearContents\n    jRange.ClearContents\n    kRange.ClearContents\n    lRange.ClearContents\n    mRange.ClearContents\n    nRange.ClearContents\n    oRange.ClearContents\n    pRange.ClearContents\n    xRange.ClearContents\n    \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1569958236, "post_id": 58191071, "comment_id": 102761685, "body": "Using a filter for this would be much more efficient than looping through rows."}, {"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 0, "creation_date": 1569958807, "post_id": 58191071, "comment_id": 102761908, "body": "I would start by putting a <code>Debug.Print(iLastRow)</code> prior to entering the loop, just to make sure that the <code>Count</code> statement is doing what you expect."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3638182, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/193903398/picture?type=large", "display_name": "Justin6587", "link": "https://stackoverflow.com/users/3638182/justin6587"}, "edited": false, "score": 0, "creation_date": 1570023317, "post_id": 58192294, "comment_id": 102783343, "body": "Thanks Darrell. I had to edit the code a little, but was able to get this approach to work. Great idea, and much better than looping."}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1569964144, "creation_date": 1569964144, "answer_id": 58192294, "question_id": 58191071, "link": "https://stackoverflow.com/questions/58191071/loop-through-a-table-and-copy-non-blank-rows-to-another-sheet/58192294#58192294", "title": "Loop through a table and copy non blank rows to another sheet", "body": "<p>Here's an option that filters, copies and deletes</p>\n\n<pre><code>Sub closeItems()\n\nDim tb1 As ListObject\nDim tb2 As ListObject\nDim Lrow As Long\n\nSet tb1 = ActiveSheet.ListObjects(\"Table1\")\nSet tb2 = Worksheets(\"Finished\").ListObjects(\"Finished\")\nLrow = tb2.ListRows.Count\n\ntb1.Range.AutoFilter Field:=8, Criteria1:=\"&lt;&gt;\" &amp; vbNullString\nNumRows = tb1.DataBodyRange.Cells.SpecialCells(xlCellTypeVisible).Rows.Count\ntb1.DataBodyRange.Cells.SpecialCells(xlCellTypeVisible).Copy\ntb2.DataBodyRange(Lrow + 1, 1).PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\n\n\nApplication.DisplayAlerts = False\ntb1.DataBodyRange.Cells.SpecialCells(xlCellTypeVisible).Delete\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3638182, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/193903398/picture?type=large", "display_name": "Justin6587", "link": "https://stackoverflow.com/users/3638182/justin6587"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 58192294, "answer_count": 1, "score": 0, "last_activity_date": 1569964144, "creation_date": 1569957782, "last_edit_date": 1569958145, "question_id": 58191071, "link": "https://stackoverflow.com/questions/58191071/loop-through-a-table-and-copy-non-blank-rows-to-another-sheet", "title": "Loop through a table and copy non blank rows to another sheet", "body": "<p>I have a table \"Table1\" that contains all the orders we have in-process. I would like to loop through this table to find rows that have a completion time entered, and move those to the completed table on another sheet. So it needs to loop through the table, check to see if the completion time column is empty. This is column 8 in the table and column J in the workbook.</p>\n\n<p>I have tried a few recommendations found on Stack and other sites, but nothing seems to be working. The following code does not return an error, but does nothing.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub closeItems()\n    Dim i, iLastRow As Integer\n    Dim oLastRow As ListRow\n\n    iLastRow = ActiveSheet.ListObjects(\"Table1\").ListRows.Count\n\n    For i = 1 To iLastRow\n        If Cells(i, 8).Value &lt;&gt; vbNullString Then\n            Rows(i).Copy\n            Set oLastRow = Worksheets(\"Finished\").ListObject(\"Finished\").ListRows.Add\n            Application.CutCopyMode = False\n            Rows(i).EntireRow.Delete\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>I would like to move the entries that are completed to the completed table and delete the row from the active table.</p>\n"}, {"tags": ["excel", "vba", "email"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569958307, "post_id": 58190936, "comment_id": 102761712, "body": "What happens if the updates occur over BOTH ranges indicated? What folder path are you talking about? The current path of the workbook?"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 12149683, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDdp_eUUtPGxH3iiB754SiOvT0BM9GeuJmCFlJbrg=k-s128", "display_name": "Kleber Ferraz", "link": "https://stackoverflow.com/users/12149683/kleber-ferraz"}, "is_accepted": true, "score": 1, "last_activity_date": 1569962883, "creation_date": 1569962883, "answer_id": 58192065, "question_id": 58190936, "link": "https://stackoverflow.com/questions/58190936/automatic-email-based-on-excel-range-updates-changes/58192065#58192065", "title": "Automatic Email Based on Excel Range Updates/Changes", "body": "<p>you can have a straightforward solution by simply splitting the watched ranges in two (or more). I'm not sure why you are saving the workbook after the change, but I place it inside the If-block, so you only have the workbook saved when the change is inside the watched ranges.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim xRg01, xRgSel01, xRg02, xRgSel02 As Range\n    Dim xOutApp As Object\n    Dim xMailItem As Object\n    Dim xMailBody, xFolderPath As String\n    'On Error Resume Next\n    '---------------------------------\n    'get workbook path\n    xFolderPath = ActiveWorkbook.Path\n    '---------------------------------\n    'Deal with first range\n    Set xRg01 = Range(\"D5:D10\")\n    Set xRgSel01 = Intersect(Target, xRg01)\n    If Not xRgSel01 Is Nothing Then\n        ActiveWorkbook.Save\n        Set xOutApp = CreateObject(\"Outlook.Application\")\n        Set xMailItem = xOutApp.CreateItem(0)\n        xMailBody = \"Hello,\" &amp; vbCrLf &amp; vbCrLf &amp; \"Cell D\" &amp; Target.Row &amp; \" has been changed, to value [\" &amp; Target.Value &amp; \"].\" &amp; vbCrLf &amp; vbCrLf &amp; \"Workbook path:\" &amp; xFolderPath\n        With xMailItem\n            .To = \"email@email.com\"\n            .Subject = \"Subject for xRg01\"\n            .Body = xMailBody\n            .Display\n        End With\n    End If\n    '---------------------------------\n    'Deal with the second range\n    Set xRg02 = Range(\"D12:D20\")\n    Set xRgSel02 = Intersect(Target, xRg02)\n    If Not xRgSel02 Is Nothing Then\n        ActiveWorkbook.Save\n        Set xOutApp = CreateObject(\"Outlook.Application\")\n        Set xMailItem = xOutApp.CreateItem(0)\n        xMailBody = \"Hello,\" &amp; vbCrLf &amp; vbCrLf &amp; \"Cell D\" &amp; Target.Row &amp; \" has been changed, to value [\" &amp; Target.Value &amp; \"].\" &amp; vbCrLf &amp; \"Workbook path:\" &amp; xFolderPath\n        With xMailItem\n            .To = \"another.email@email.com\"\n            .Subject = \"Subject for xRg02\"\n            .Body = xMailBody\n            .Display\n        End With\n    End If\n    '---------------------------------\n        Set xRg01 = Nothing\n        Set xRgSel01 = Nothing\n        Set xRg02 = Nothing\n        Set xRgSel02 = Nothing\n        Set xOutApp = Nothing\n        Set xMailItem = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 12132488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba2a0b32e6c5ff8af2d9561ccc873d22?s=128&d=identicon&r=PG&f=1", "display_name": "dkuka", "link": "https://stackoverflow.com/users/12132488/dkuka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 1, "accepted_answer_id": 58192065, "answer_count": 1, "score": 0, "last_activity_date": 1569962883, "creation_date": 1569957164, "last_edit_date": 1569958320, "question_id": 58190936, "link": "https://stackoverflow.com/questions/58190936/automatic-email-based-on-excel-range-updates-changes", "title": "Automatic Email Based on Excel Range Updates/Changes", "body": "<p>I have this excel macro that automatically sends an email when a cell is updated. I want to be able to send it to two different mailboxes based on cell update. For example if cell D5:D10 is updated the email gets sent to mailbox1, if cell D12:20 is updated the email gets sent to mailbox 2. I also want to include a folder path in the body message.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim xRgSel As Range\n    Dim xOutApp As Object\n    Dim xMailItem As Object\n    Dim xMailBody As String\n    On Error Resume Next\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Set xRg = Range(\"D5:D34\")\n    Set xRgSel = Intersect(Target, xRg)\n    ActiveWorkbook.Save\n    If Not xRgSel Is Nothing Then\n        Set xOutApp = CreateObject(\"Outlook.Application\")\n        Set xMailItem = xOutApp.CreateItem(0)\n        xMailBody = \"Hello,\" &amp; vbCrLf &amp; vbCrLf &amp; Me.Range(\"B\" &amp; Target.Row)&amp; \" has been completed.\"\n        With xMailItem\n            .To = \"email@email.com\"\n            .Subject = \"subject\"\n            .Body = xMailBody\n            .Display\n        End With\n        Set xRgSel = Nothing\n        Set xOutApp = Nothing\n        Set xMailItem = Nothing\n    End If\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer", "automation"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1569957088, "post_id": 58190690, "comment_id": 102761220, "body": "<code>&quot;I haven&#39;t tried yet if it works properly&quot;</code> why not? Give your code a test and let us know where you&#39;re having issues and we can advise from there."}], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1569957418, "creation_date": 1569957418, "answer_id": 58190992, "question_id": 58190690, "link": "https://stackoverflow.com/questions/58190690/how-to-perform-prnt-screen-and-save-it-into-a-specific-folder/58190992#58190992", "title": "How to perform Prnt Screen and save it into a specific folder", "body": "<p>The code you have only simulates \"pressing\" the PrtScrn key, but not \"releasing\" it. Add the second line here like this:</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Sub keybd_event Lib \"user32\" (ByVal bVk As Byte, ByVal _\n  bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\n\nPrivate Const VK_SNAPSHOT = &amp;H2C\nPrivate Const KEYEVENTF_KEYUP = 2\n\nSub PrintScreen()\n    keybd_event VK_SNAPSHOT, 1, 0, 0 'Key Down\n    keybd_event VK_SNAPSHOT, 1, KEYEVENTF_KEYUP , 0 'Key Up\nEnd Sub\n</code></pre>\n\n<p>You can then paste the screenshot to a Worksheet and export it as PDF</p>\n\n<pre><code>Sub SaveAsPDF()\n    Const FILE_PATH as String = \"C:\\Temp\\\"\n    PrintScreen 'Take a screenshot\n    With Sheet1\n        .Paste 'Paste it to Sheet1\n        .ExportAsFixedFormat xlTypePDF, FILE_PATH &amp; \"Screenshot File.pdf\" 'Export Sheet1 to PDF\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8001, "user_id": 10309381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a284b365772283540b23d67dbbbd2d2e?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak-MSFT", "link": "https://stackoverflow.com/users/10309381/deepak-msft"}, "is_accepted": false, "score": 1, "last_activity_date": 1570015117, "creation_date": 1570015117, "answer_id": 58200413, "question_id": 58190690, "link": "https://stackoverflow.com/questions/58190690/how-to-perform-prnt-screen-and-save-it-into-a-specific-folder/58200413#58200413", "title": "How to perform Prnt Screen and save it into a specific folder", "body": "<p>I found the code below in an another thread which is working as per your requirement.</p>\n\n<p>I tested it and it is taking snapshot and saving it to the specific folder.</p>\n\n<pre><code>Option Explicit\n'requires references: \"Microsoft HTML Object Library\" &amp; \"Microsoft Internet Controls\"\n\nPrivate Declare Sub keybd_event Lib \"user32\" (ByVal bVk As Byte, _\n    ByVal bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\nPrivate Declare Function ShowWindow Lib \"user32\" _\n    (ByVal hwnd As Long, ByVal nCmdShow As Long) As Long\n\nSub getSS()\n  Const url = \"stackoverflow.com\" 'page to get screenshot of (http is added below)\n  Const fName = \"D:\\thumb_\" &amp; url &amp; \".png\" 'output filename (can be png/jpg/bmp/gif)\n  Const imgScale = 0.25 'scale to 25% (to create thumbnail)\n\n  Dim ie As InternetExplorer, ws As Worksheet, sz As Long\n  Dim img As Picture, oCht As ChartObject\n  Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n  Set ie = GetIE()\n  With ie\n    .navigate \"http://\" &amp; url\n    Do: DoEvents: Loop While .busy Or .readyState &lt;&gt; 4 'wait for page load\n    ShowWindow Application.hwnd, 5 'activate IE window\n    Call keybd_event(44, 0, 0, 0) '44=\"VK_SNAPSHOT\"\n    Pause (0.25) 'pause so clipboard catches up\n    With ws\n      ShowWindow Application.hwnd, 5 'back to Excel\n      .Activate\n      .Paste\n      Set img = Selection\n      With img\n        Set oCht = ws.ChartObjects.Add(.Left, .Top, .Left + .Width, .Top + .Height)\n        oCht.Width = .Width * imgScale 'scale obj to picture size\n        oCht.Height = .Height * imgScale\n        oCht.Activate\n        ActiveChart.Paste\n        ActiveChart.Export fName, Mid(fName, InStrRev(fName, \".\") + 1)\n        oCht.Delete\n        .Delete\n      End With\n      .Activate\n    End With\n    .FullScreen = False\n    .Quit\n  End With\n  If Dir(fName) = \"\" Then Stop 'Something went wrong (file not created)\n  sz = FileLen(fName)\n  If sz = 0 Then Stop 'Something went wrong! (invalid filename maybe?)\n  Debug.Print \"Created '\" &amp; fName &amp; \"' from '\" &amp; url &amp; \"' (\" &amp; sz &amp; \" bytes)\": Beep\nEnd Sub\n\nSub Pause(sec As Single)\n  Dim t As Single: t = Timer\n  Do: DoEvents: Loop Until Timer &gt; t + sec\nEnd Sub\n\nFunction GetIE() As Object\n'requires references: \"Microsoft HTML Object Library\" &amp; \"Microsoft Internet Controls\"\n'return an object for the open Internet Explorer window, or create new one\n  For Each GetIE In CreateObject(\"Shell.Application\").Windows() 'Loop to find\n    If (Not GetIE Is Nothing) And GetIE.Name = \"Internet Explorer\" Then Exit For 'Found!\n  Next GetIE\n  If GetIE Is Nothing Then Set GetIE=CreateObject(\"InternetExplorer.Application\") 'Create\n  GetIE.Visible = True 'Make IE visible\n  GetIE.FullScreen = True\nEnd Function\n</code></pre>\n\n<p>Reference:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21580606/how-to-take-screenshot-of-webpage-using-vba\">How to take screenshot of webpage using VBA?</a></p>\n\n<p>Further, you can modify the code as per your own requirement.</p>\n"}], "owner": {"reputation": 81, "user_id": 11877464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a09c8ba1089745db5bbd4de9544af051?s=128&d=identicon&r=PG&f=1", "display_name": "Zakiirim", "link": "https://stackoverflow.com/users/11877464/zakiirim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 58190992, "answer_count": 2, "score": 0, "last_activity_date": 1570015117, "creation_date": 1569955987, "question_id": 58190690, "link": "https://stackoverflow.com/questions/58190690/how-to-perform-prnt-screen-and-save-it-into-a-specific-folder", "title": "How to perform Prnt Screen and save it into a specific folder", "body": "<p>I found a code to perform a Prnt Screen without using Sendkeys method:</p>\n\n<pre><code>Option Explicit\n\nPrivate Declare Sub keybd_event Lib \"user32\" (ByVal bVk As Byte, ByVal _\n  bScan As Byte, ByVal dwFlags As Long, ByVal dwExtraInfo As Long)\n\nPrivate Const VK_SNAPSHOT = &amp;H2C\n\nSub PrintScreen()\n    keybd_event VK_SNAPSHOT, 1, 0, 0\nEnd Sub\n</code></pre>\n\n<p>I haven't tried yet if it works properly (if not, I will use Sendkeys), but I'm wondering if there's a way to Prnt Screen and save it as .pdf/.jpg (doesn't matter) into a specific folder. All the print screen are about Internet Explorer pages.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 2, "creation_date": 1569956087, "post_id": 58190647, "comment_id": 102760854, "body": "I would use Collections and then change <code>d</code> to a Variant."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569956148, "post_id": 58190647, "comment_id": 102760875, "body": "You might just want to use somethign like <code>sh.Cells(y, 27).Value = Format(DateArr(y),&quot;yyyy-mm-dd&quot;)</code>.  How will you be pulling the information?  Manually adding dates in the code, pulling from a range in a sheet, etc.?"}, {"owner": {"reputation": 1, "user_id": 12150143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3355141970061906917c7a7c42b248d?s=128&d=identicon&r=PG&f=1", "display_name": "James Dolan", "link": "https://stackoverflow.com/users/12150143/james-dolan"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1569957334, "post_id": 58190647, "comment_id": 102761318, "body": "@BrianMStafford, that works! At least for my little test example. Fingers crossed it works for my main goal."}, {"owner": {"reputation": 1, "user_id": 12150143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3355141970061906917c7a7c42b248d?s=128&d=identicon&r=PG&f=1", "display_name": "James Dolan", "link": "https://stackoverflow.com/users/12150143/james-dolan"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1569957479, "post_id": 58190647, "comment_id": 102761373, "body": "@Cyril, I could have been more clear that this was just a test case. My actual use case is: I have a spreadsheet of people and the weekends where they will be on call. I&#39;m trying to loop through every line, create a object (custom class) for each person and then store their on call dates in a collection associated with my class and do some logic on the dates. I got stuck when I couldn&#39;t create a collection of dates."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1570024910, "post_id": 58190647, "comment_id": 102784331, "body": "@JamesDolan if you treat this like a standard array, you can just capture all of the range, e.g. <code>dim arr as variant</code> // <code>arr = range(cells(1,1),cells(lr,3)).value</code>.  You should be retaining the original date as a date, regardless of appending that data elsewhere or using it in formulae.  You shouldn&#39;t need to loop to create the array, unless you&#39;re looking to make a dictionary for unique dates."}], "answers": [{"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1569957417, "creation_date": 1569957417, "answer_id": 58190990, "question_id": 58190647, "link": "https://stackoverflow.com/questions/58190647/excel-vba-is-there-a-dynamic-array-that-can-be-used-for-dates/58190990#58190990", "title": "Excel VBA: Is there a dynamic Array that can be used for Dates?", "body": "<p>Dates are variants not objects</p>\n\n<p>Add for collections is a method.  In your code you have assumed it is a function and added unnecessary parentheses, e.g.</p>\n\n<pre><code>DateArr.add cdate(\"1/1/2019\")\n</code></pre>\n\n<p>To use a For Each then the indexing (controlling) variable must be an object or a variant.</p>\n\n<p>Thus your first example should work fine (other errors not withstanding) if you dim d as a variant.</p>\n"}], "owner": {"reputation": 1, "user_id": 12150143, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3355141970061906917c7a7c42b248d?s=128&d=identicon&r=PG&f=1", "display_name": "James Dolan", "link": "https://stackoverflow.com/users/12150143/james-dolan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570002509, "creation_date": 1569955741, "last_edit_date": 1570002509, "question_id": 58190647, "link": "https://stackoverflow.com/questions/58190647/excel-vba-is-there-a-dynamic-array-that-can-be-used-for-dates", "title": "Excel VBA: Is there a dynamic Array that can be used for Dates?", "body": "<p>I'm working on an Excel Macro and I want to create an array of dates and then loop through it, without knowing how many dates will be added. I thought this would be simple, but I can't get it to work. </p>\n\n<p>I tried using a collection:</p>\n\n<pre><code>Dim DateArr As Collection\nDim d As Date\n\nSet DateArr = New Collection\n\nDateArr.Add (CDate(\"1/1/2019\"))\nDateArr.Add (CDate(\"2/2/2020\"))\n\nFor Each d In DateArr\n    sh.Cells(y, 27).Value = d\nNext d\n</code></pre>\n\n<p>But I get an error that says \"For Each control variable must be Variant or Object\" and highlights the d in my loop. Are dates not objects?</p>\n\n<p>I also tried a Variant:</p>\n\n<pre><code>Dim DateArr As Variant\nDateArr.Add CDate(\"2/2/2020\")\nDateArr(1) = CDate(\"1/1/2019\")\n</code></pre>\n\n<p>But I can't find the right syntax for adding a Date. The .Add line gives me an \"Object Required\" error and the DateArr(1)= line gives me a \"Type Mismatch\" error. </p>\n\n<p>The only thing that kind of works is a standard array:</p>\n\n<pre><code>Dim DateArr() As Date\nDim y As Integer\nReDim DateArr(1 To 2) As Date\n\nDateArr(1) = CDate(\"1/1/2019\")\nDateArr(2) = CDate(\"2/2/2020\")\n\nFor y = LBound(DateArr) To UBound(DateArr)\n    sh.Cells(y, 27).Value = DateArr(y)\nNext y\n</code></pre>\n\n<p>But I have no idea how many dates will be in the array, so can't use anything static. Is there a way to use this same syntax without setting dimensions?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "image"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 3, "creation_date": 1569954025, "post_id": 58190232, "comment_id": 102760107, "body": "<a href=\"https://stackoverflow.com/questions/21103919/select-a-picture-in-the-active-cell/21104067#21104067\" title=\"select a picture in the active cell\">stackoverflow.com/questions/21103919/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 0, "last_activity_date": 1569958119, "creation_date": 1569958119, "answer_id": 58191143, "question_id": 58190232, "link": "https://stackoverflow.com/questions/58190232/how-can-i-insert-an-image-to-cell-on-vba/58191143#58191143", "title": "How can I insert an image to cell on vba?", "body": "<p>You'll need to set the Left and Top properties as follows...</p>\n\n<pre><code>Call ActiveSheet.Shapes.AddPicture(\"S:\\10_INGENIER\u00cdA DE FUNDICI\u00d3N\\03_CALIDAD\\Calidad central\\Septiembre 2019\\IMAGENES\\C1.png\", _\n   msoCTrue, msoCTrue, Cell.Left, Cell.Top, 25, 25)\n</code></pre>\n\n<p>However, your macro can be re-written as follows...</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    Dim PathToFolder As String\n    PathToFolder = \"S:\\10_INGENIER\u00cdA DE FUNDICI\u00d3N\\03_CALIDAD\\Calidad central\\Septiembre 2019\\IMAGENES\\\"\n\n    'Make sure path ends in backslash (\\)\n    If Right(PathToFolder, 1) &lt;&gt; \"\\\" Then\n        PathToFolder = PathToFolder &amp; \"\\\"\n    End If\n\n    Dim Cell As Range\n    Dim ImageFile As String\n    For Each Cell In Range(\"G1:G\" &amp; Cells(Rows.Count, \"G\").End(xlUp).Row) 'define range until last used row\n        If Len(Cell) &gt; 0 Then 'cell contains a value\n            If Cell.Value = 1 Then\n                ImageFile = PathToFolder &amp; \"C1.png\"\n            ElseIf Cell.Value = 2 Then\n                ImageFile = PathToFolder &amp; \"C2.png\"\n            ElseIf Cell.Value = 3 Then\n                ImageFile = PathToFolder &amp; \"C3.png\"\n            ElseIf Cell.Value = 4 Then\n                ImageFile = PathToFolder &amp; \"C4.png\"\n            Else\n                ImageFile = \"\"\n            End If\n            If Len(ImageFile) &gt; 0 Then 'variable contains a non-empty string\n                If Len(Dir(ImageFile, vbNormal)) &gt; 0 Then 'image file exists\n                    ActiveSheet.Shapes.AddPicture ImageFile, msoCTrue, msoCTrue, Cell.Left, Cell.Top, 25, 25\n                End If\n            End If\n        End If\n    Next Cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 12108204, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lrHzscTJgE0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reryFwWfOk3aMVzSFiejfmbHns0mA/photo.jpg?sz=128", "display_name": "Liliana Martinez", "link": "https://stackoverflow.com/users/12108204/liliana-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58191143, "answer_count": 1, "score": 0, "last_activity_date": 1569958119, "creation_date": 1569953596, "last_edit_date": 1569956079, "question_id": 58190232, "link": "https://stackoverflow.com/questions/58190232/how-can-i-insert-an-image-to-cell-on-vba", "title": "How can I insert an image to cell on vba?", "body": "<p>I'm working on this excel macro and the code I've been writing on (as bad as I can expect) checks every cell on the G:G range, and according to  its value, it inserts an image. Truth is I don't know exactly how to make that the image gets inserted in the cell that has been checked. \nI attach the code as I wrote it... </p>\n\n<pre><code>   Private Sub CommandButton1_Click()\n\n   Dim Cell As Range\n   For Each Cell In Range(\"G:G\")\n\n   If Cell.Value = 1 Then\n   Call ActiveSheet.Shapes.AddPicture(\"S:\\10_INGENIER\u00cdA DE FUNDICI\u00d3N\\03_CALIDAD\\Calidad central\\Septiembre 2019\\IMAGENES\\C1.png\", _\n   msoCTrue, msoCTrue, 0, 0, 25, 25)\n\n   ElseIf Cell.Value = 2 Then\n   Call ActiveSheet.Shapes.AddPicture(\"S:\\10_INGENIER\u00cdA DE FUNDICI\u00d3N\\03_CALIDAD\\Calidad central\\Septiembre 2019\\IMAGENES\\C2.png\", _\n   msoCTrue, msoCTrue, 0, 0, 25, 25)\n\n\n   ElseIf Cell.Value = 3 Then\n   Call ActiveSheet.Shapes.AddPicture(\"S:\\10_INGENIER\u00cdA DE FUNDICI\u00d3N\\03_CALIDAD\\Calidad central\\Septiembre 2019\\IMAGENES\\C3.png\", _\n   msoCTrue, msoCTrue, 0, 0, 25, 25)\n\n\n   ElseIf Cell.Value = 4 Then\n   Call ActiveSheet.Shapes.AddPicture(\"S:\\10_INGENIER\u00cdA DE FUNDICI\u00d3N\\03_CALIDAD\\Calidad central\\Septiembre 2019\\IMAGENES\\C4.png\", _\n   msoCTrue, msoCTrue, 0, 0, 25, 25)\n\n\n   End If\n\n   Next\n\n   End Sub\n</code></pre>\n\n<p>As I click on the command button, the images get inserted next to A1, and they're one over another. I want them to be in the cell where the checked value was, on range G:G. \nI've been reading about it, and I've been trying many different ways but since I'm not good at vba (or any other language) I'm totally lost and a little desesperate. </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1569953683, "post_id": 58190086, "comment_id": 102759970, "body": "have you attempted to set a global variable to <code>= err.description</code>, so you can use your variable in yoru msgbox?"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 2, "creation_date": 1569953859, "post_id": 58190086, "comment_id": 102760044, "body": "Error handling is going to track back to the most recent error handling directive.  When it encounters the error in the function it handles the error as described and resets the error handling.  If you want to see the error details you either need to move your error handling into the sub, manually send back error details from the function, raise the error details IN the function using the same method you already are or like Cyril indicated, save them in a global variable."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 5, "creation_date": 1569954547, "post_id": 58190086, "comment_id": 102760314, "body": "There are two ways of handling errors: returning error codes and raising exceptions. Either is fine, as long as it used consistently in the project. You are taking the worst from both worlds: you are swallowing the exception and returning a meaningless error code. Please don&#39;t try to fix this hybrid, instead pick one of the two ways. I suggest you pick exception handling and simply let the exception bubble up to the caller."}], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1569955255, "last_edit_date": 1569955255, "creation_date": 1569954121, "answer_id": 58190333, "question_id": 58190086, "link": "https://stackoverflow.com/questions/58190086/handling-error-of-returning-function-in-vba/58190333#58190333", "title": "Handling error of returning function in VBA", "body": "<p>One approach would be to return the error number instead of -1 and then using it to get the error information</p>\n\n<pre><code>Sub mySub\n\n    Dim returnValue as Integer\n\n    returnValue = functionA(...)\n\n    if returnValue &lt;&gt; 0 Then\n        On Error Resume Next\n        Err.Raise returnValue 'raise the same error that appeared in functionA to get its details\n        MsgBox \"The following error appeared: \" &amp; Err.Description &amp; \", Errornumber= \" &amp; Err.Number\n        On Error GoTo 0\n    Else\n        MsgBox \"Success\"\n    End If\n\nEnd Sub\n\nFunction functionA(...) as Integer\n\n    On error goto errorHandler\n    ' do something\n\n    funtionA = 0\n\n    Exit Function\n\n    errorHandler:\n        functionA = Err.Number\n\nEnd Function\n</code></pre>\n\n<p>A shorter and nicer way is to do all the error handling in the calling procedure. For example:</p>\n\n<pre><code>Sub mySub()\n    Dim returnValue as Integer \n    On Error Resume Next\n    returnValue = functionA(...) \n    If Err.Number &lt;&gt; 0 Then \n        MsgBox \"The following error appeared: \" &amp; err.description &amp; \", Errornumber= \" &amp; err.number \n    Else \n        MsgBox \"Success\" \n    End If \nEnd Sub\n</code></pre>\n\n<p>The function then becomes</p>\n\n<pre><code>Function functionA(...) as Integer\n\n    ' do something\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1569955568, "creation_date": 1569955568, "answer_id": 58190611, "question_id": 58190086, "link": "https://stackoverflow.com/questions/58190086/handling-error-of-returning-function-in-vba/58190611#58190611", "title": "Handling error of returning function in VBA", "body": "<p>A much better way of dealing with errors is by emulating the try/catch construct found in other languages.  The VBA way of doing this is described in the RubberDuck article on 'Pattern: TryParse'</p>\n\n<p><a href=\"https://rubberduckvba.wordpress.com/2019/05/09/pattern-tryparse/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2019/05/09/pattern-tryparse/</a></p>\n"}], "owner": {"reputation": 155, "user_id": 10084505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f11b965ba99caf12808437ef14ae02ee?s=128&d=identicon&r=PG&f=1", "display_name": "Wallnussfolie", "link": "https://stackoverflow.com/users/10084505/wallnussfolie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58190333, "answer_count": 2, "score": 2, "last_activity_date": 1569964926, "creation_date": 1569952867, "last_edit_date": 1569964926, "question_id": 58190086, "link": "https://stackoverflow.com/questions/58190086/handling-error-of-returning-function-in-vba", "title": "Handling error of returning function in VBA", "body": "<p>I'm struggling a little bit with handling the errors of a returning  function in VBA. </p>\n\n<p>I got some code in a sub which calls a function. The function returns 0 if it succeeds and -1 if there is an error. </p>\n\n<p>This is my sub:</p>\n\n<pre><code>Sub mySub\n\n    Dim returnValue as Integer\n\n    returnValue = functionA(...)\n\n    If returnValue = -1 Then\n        MsgBox \"The following error appeared: \" &amp; err.description &amp; \", Errornumber= \" &amp; err.number\n    Else\n        MsgBox \"Success\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>My function looks like this:</p>\n\n<pre><code>Function functionA(...) as Integer\n\n    On error goto errorHandler\n    ' do something\n\n    funtionA = 0\n\n    Exit Function\n\n    errorHandler:\n        functionA = -1 \n\nEnd Function\n</code></pre>\n\n<p>Now my problem: if the function returns -1 because it was stopped by an error, I cannot get any information from the error object in my calling sub. The errornumber is 0 and the description is emtpy. It seems like the end of the function resets the err object. \nIs there a smart way of achieving what I want to do? </p>\n\n<p>Thanks in advance! :) </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 380, "user_id": 11104095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc0018af5fc00eb65eaae5dcf4473e6?s=128&d=identicon&r=PG&f=1", "display_name": "K753", "link": "https://stackoverflow.com/users/11104095/k753"}, "edited": false, "score": 0, "creation_date": 1569956589, "post_id": 58190074, "comment_id": 102761032, "body": "I don&#39;t think that&#39;s possible with RunSavedImportExport but an alternative would be to check the table your importing to. If it&#39;s an append import you can count the number of records before and after."}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 11262633, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218237261991972/picture?type=large", "display_name": "mherzog", "link": "https://stackoverflow.com/users/11262633/mherzog"}, "edited": false, "score": 0, "creation_date": 1570048847, "post_id": 58190963, "comment_id": 102795947, "body": "Very helpful and much appreciated.  I marked your response as Answered."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1569957298, "creation_date": 1569957298, "answer_id": 58190963, "question_id": 58190074, "link": "https://stackoverflow.com/questions/58190074/get-the-number-of-records-processed-by-a-saved-import-ms-access-vba/58190963#58190963", "title": "Get the number of records processed by a saved import (MS Access, VBA)", "body": "<p>This is indeed not available using <code>DoCmd.RunSavedImportExport</code></p>\n\n<p>Instead, you can use a query to do the import, and <code>Database.RecordsAffected</code></p>\n\n<pre><code>Dim db As DAO.Database\nSet db = CurrentDb\ndb.Execute \"SELECT * INTO SomeTable FROM [Excel 12.0 XML;HDR=Yes;DATABASE=C:\\Path\\To\\File.xlsx].[MyNamedRange]\"\ndebug.print \"# rec loaded=\"&amp; db.RecordsAffected\n</code></pre>\n\n<p>You can adjust the query to be an append query if you need to append records to a table.</p>\n"}], "owner": {"reputation": 147, "user_id": 11262633, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218237261991972/picture?type=large", "display_name": "mherzog", "link": "https://stackoverflow.com/users/11262633/mherzog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 58190963, "answer_count": 1, "score": 2, "last_activity_date": 1594421644, "creation_date": 1569952788, "last_edit_date": 1594421644, "question_id": 58190074, "link": "https://stackoverflow.com/questions/58190074/get-the-number-of-records-processed-by-a-saved-import-ms-access-vba", "title": "Get the number of records processed by a saved import (MS Access, VBA)", "body": "<p>I am working with Microsoft Access.  I am executing a saved import (from an Excel spreadsheet) via VBA using the <code>DoCmd.RunSavedImportExport</code> command.  I would like to <strong><em>programmatically</em></strong> capture the number of records processed by this saved import.</p>\n\n<p>The MS documentation on <code>DoCmd.RunSavedImportExport</code> does not indicate there are any return values or ByRef parameters that I can use.</p>\n\n<p>I searched Google and SO, expecting an answer, as I would think this has already been addressed.  If I missed an answer out there on the interweb, please let me know!</p>\n\n<p>Here is the code I am using.  I'm happy to use a different method of importing my spreadsheet if it can give me the number of rows.</p>\n\n<pre><code>DoCmd.RunSavedImportExport \"&lt;name of saved import&gt;\"\n</code></pre>\n\n<p>I'd like something like:</p>\n\n<pre><code>numRec = DoCmd.RunSavedImportExport(\"&lt;name of saved import&gt;\")\ndebug.print \"# rec loaded=\"&amp; numRec\n</code></pre>\n"}, {"tags": ["html", "vba", "iframe", "web-scraping", "vbscript"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1569954642, "post_id": 58189767, "comment_id": 102760343, "body": "Did you try .ContentDocument rather than .ContentWindow.Document or is that not supported in vbs?"}, {"owner": {"reputation": 405, "user_id": 312176, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9c276f5d5bfc3d6b13533d66fa160771?s=128&d=identicon&r=PG", "display_name": "tunneling", "link": "https://stackoverflow.com/users/312176/tunneling"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1569955212, "post_id": 58189767, "comment_id": 102760539, "body": "Just tried it, and it appears to fail silently. No error dialog, but also no progress in navigating the website or additional logging messages. I have no idea how to debug that."}, {"owner": {"reputation": 3171, "user_id": 7319046, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XzLyqjFRNRQ/AAAAAAAAAAI/AAAAAAAAAgU/1U6zuMhm7zg/photo.jpg?sz=128", "display_name": "&#201;tienne Laneville", "link": "https://stackoverflow.com/users/7319046/%c3%89tienne-laneville"}, "edited": false, "score": 1, "creation_date": 1569968082, "post_id": 58189767, "comment_id": 102765057, "body": "Please add the code that shows how <code>oIE</code> object is created."}, {"owner": {"reputation": 405, "user_id": 312176, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9c276f5d5bfc3d6b13533d66fa160771?s=128&d=identicon&r=PG", "display_name": "tunneling", "link": "https://stackoverflow.com/users/312176/tunneling"}, "edited": false, "score": 0, "creation_date": 1569968360, "post_id": 58189767, "comment_id": 102765121, "body": "Added it. Pretty standard stuff as far as I can tell. The script successfully logs into the website, navigates a few pages, but then dies when I try to click a link that&#39;s in the iframe. The VBA version works fine."}], "owner": {"reputation": 405, "user_id": 312176, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9c276f5d5bfc3d6b13533d66fa160771?s=128&d=identicon&r=PG", "display_name": "tunneling", "link": "https://stackoverflow.com/users/312176/tunneling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1569968288, "creation_date": 1569951313, "last_edit_date": 1569968288, "question_id": 58189767, "link": "https://stackoverflow.com/questions/58189767/vba-to-vbs-iframe-permission-denied", "title": "VBA to VBS - iframe permission denied", "body": "<p>I recently wrote an Excel VBA script to login and navigate an intranet site to download a CSV report. It contains some links and buttons that I need to click inside an iframe. It took some effort to figure out the iframe stuff, but it works. I still don't know how to click \"Save\" without the download file dialog box being the active window, but that's for another day.</p>\n\n<p>I'm in the process of converting this script to VBS and have run into this error message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZEZHG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZEZHG.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here are the relevant code snippets:</p>\n\n<p><strong>VBA Code (this works)</strong></p>\n\n<pre><code>Set ie = New InternetExplorer\nie.Visible = True\n...\nDim iframeDoc As MSHTML.HTMLDocument\nSet iframeDoc = ie.document.frames(\"fmReports\").document\n' select the custom report\niframeDoc.getElementById(\"tvCustomReport\").Click\nApplication.Wait (Now + TimeValue(\"00:00:03\"))\n' run the report\niframeDoc.getElementById(\"btnRunReport\").Click\n</code></pre>\n\n<p><strong>VBS Code (this presents the error dialog above)</strong></p>\n\n<pre><code>Dim oIE\nSet oIE = CreateObject(\"InternetExplorer.Application\")\noIE.Visible = True\n...\nDim iframeDoc\nSet iframeDoc = oIE.document.getElementById(\"fmReports\").ContentWindow.Document\n' select the custom report\niframeDoc.getElementById(\"tvCustomReport\").Click\nWScript.Sleep 3000 'wait here just in case\n' run the report\niframeDoc.getElementById(\"btnRunReport\").Click\n</code></pre>\n\n<p><strong>Questions/Thoughts</strong></p>\n\n<p>I've turned off just about every security feature I can find in IE.</p>\n\n<p><strong>Are these different domains? (XSS issue perhaps)</strong>\nThe main intranet site url is <a href=\"http://192.168.0.111/app2019\" rel=\"nofollow noreferrer\">http://192.168.0.111/app2019</a> while the contents of the iframe url is <a href=\"http://192.168.0.111/app2018\" rel=\"nofollow noreferrer\">http://192.168.0.111/app2018</a>.</p>\n\n<p>Line 49 (referenced in the screenshot) of my full script is the second line in the VBS snippet (Set iframeDoc =...)</p>\n\n<p>Am I missing something obvious?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1569965662, "creation_date": 1569965662, "answer_id": 58192548, "question_id": 58189616, "link": "https://stackoverflow.com/questions/58189616/running-an-excel-macro-from-outlook/58192548#58192548", "title": "Running an Excel macro from Outlook", "body": "<p>Like this:</p>\n\n<pre><code>Sub Exc_macro(Item As Outlook.MailItem)\n\n    Dim ExApp As Object\n    Dim gageID As String\n    Dim cap As String\n\n    If Left(Item.Body, 6) = \"extend\" Then   'Check for keyword in body\n        gageID = Mid(Item.Subject, 23)  'Get equipment ID number\n        Set ExApp = GetObject(,\"Excel.Application\")\n        ExApp.Run \"'my ExcelWB.xlsm'!increase\", gageID\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Make your <code>increase</code> Sub  is in a regular code module</p>\n\n<p><a href=\"http://www.rondebruin.nl/win/s9/win001.htm\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/win/s9/win001.htm</a></p>\n"}], "owner": {"reputation": 13, "user_id": 12149474, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tJ2xqMueLGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reX7EN8D4ysqgtbPjbfSS0v7-vTig/photo.jpg?sz=128", "display_name": "Michael Djurdjevic", "link": "https://stackoverflow.com/users/12149474/michael-djurdjevic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 58192548, "answer_count": 1, "score": 0, "last_activity_date": 1585375146, "creation_date": 1569950546, "last_edit_date": 1585375146, "question_id": 58189616, "link": "https://stackoverflow.com/questions/58189616/running-an-excel-macro-from-outlook", "title": "Running an Excel macro from Outlook", "body": "<p>I am trying to set up an automated database in Excel which sends an email when a user has equipment signed out past the expected due date.</p>\n\n<p>I also want to implement a feature where the user can reply to the email with a keyword 'extend' to extend their sign out date by 7 days.</p>\n\n<p>I have the email sending correctly. I want to create a script in Outlook that links their reply to the Excel worksheet that is open. Both Outlook and Excel will be open at the same time on a dedicated PC. I don't want to open a new Excel file every time the Outlook macro runs.</p>\n\n<p>Here is the Outlook macro:</p>\n\n<pre><code>Sub Exc_macro(Item As Outlook.MailItem)\nDim ExApp As Workbook\nDim gageID As String\nDim cap As String\n\nIf Left(Item.Body, 6) = \"extend\" Then   'Check for keyword in body\n    gageID = Mid(Item.Subject, 23)  'Get equipment ID number\n    Set ExApp = Excel.ActiveWorkbook\n    Call ExApp.Application.Run(\"Module2.increase\", gageID)\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I want to pass the <code>gageID</code> argument to the Excel macro here:</p>\n\n<pre><code>Sub increase(gageID As String)\nSet Rng = Range(Range(\"A2\"), Range(\"A\" &amp; Rows.Count).End(xlUp))     \nFor Each cell In Rng\n    If cell.Value = gageID Then\n        cell.Offset(0, 9).Value = cell.Offset(0, 9).Value + 7\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p>How do I reference the open Workbook in Outlook and subsequently run the Excel macro?</p>\n"}]