[{"tags": ["excel", "vba", "if-statement", "case"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1574902972, "post_id": 59080140, "comment_id": 104397727, "body": "Hi thanks for the reply. Should I add in Then after Elseif Total.Value &lt;&gt; 0 I am receiving an error or this line."}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1574904425, "post_id": 59080140, "comment_id": 104397969, "body": "Missed out some &#39;Then&#39;"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1574905611, "post_id": 59080140, "comment_id": 104398153, "body": "If totalt = 0 then SLA should be Yes. I don&#39;t think I mentioned that. That probably changes things"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 0, "creation_date": 1574905746, "post_id": 59080140, "comment_id": 104398178, "body": "but in the case I am trying the TotalT is &gt; 10 and I also tried between 1-5 but it seems to pass over saying Yes or the value"}], "tags": [], "owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "is_accepted": false, "score": 0, "last_activity_date": 1574904399, "last_edit_date": 1574904399, "creation_date": 1574900233, "answer_id": 59080140, "question_id": 59079965, "link": "https://stackoverflow.com/questions/59079965/vba-if-statements-converted-to-case/59080140#59080140", "title": "VBA IF Statements converted to Case", "body": "<p>Your issue is likely the ElseIf condition is being used incorrectly.</p>\n\n<p>I assume that when TotalT.Value is 0 then you don't want to do anything? turning the inequality around helps if that's the case.</p>\n\n<p>Untested but hopefully cleaned:</p>\n\n<pre><code>If Data1 &lt;&gt; \"\" Then\n    Select Case Data5\n        Case \"A\", \"B\"\n            If TotalT.Value &lt;= 5 And TotalT.Value &lt;&gt; \"\" Then \n                SLA.Value = \"Yes\"\n            ElseIf TotalT.Value &lt;&gt; 0 Then\n                SLA.Value = TotalT - 5\n            End If\n        Case \"C\", \"D\"\n            If TotalT.Value &lt;= 1 And TotalT.Value &lt;&gt; \"\" Then \n                SLA.Value = \"Yes\"\n            ElseIf TotalT.Value &lt;&gt; 0 Then\n                SLA.Value = TotalT - 1\n            End If\n        Case \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"\n            If TotalT.Value &lt;= 10 And TotalT.Value &lt;&gt; \"\" Then \n                SLA.Value = \"Yes\"\n            ElseIf TotalT.Value &lt;&gt; 0 Then\n                SLA.Value = TotalT - 10\n            End If      \n    End Select\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 1, "creation_date": 1574901354, "post_id": 59080185, "comment_id": 104397424, "body": "I prefer this one due to the <code>Case Else</code> clause."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574902871, "post_id": 59080185, "comment_id": 104397706, "body": "@PaichengWu should there be something other than Between in the statement? I am getting Compile error: Expect: Then or GoTo where Between is."}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1574904450, "post_id": 59080185, "comment_id": 104397973, "body": "@Tmacjoshua Which line?"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574904539, "post_id": 59080185, "comment_id": 104397983, "body": "@PaichengWu all of the 3 between lines. Between specifically is highlighted"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1574904933, "post_id": 59080185, "comment_id": 104398032, "body": "@Tmacjoshua Try use <code>TotalT.Value &gt;= 1 And TotalT.Value &lt;= 5</code> instead of <code>BETWEEN</code> clause"}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574905549, "post_id": 59080185, "comment_id": 104398138, "body": "@PaichengWu Thanks when I run through the code line by line it seems to skip everything after If Data1 &lt;&gt; &quot;&quot; Then  until the last end if. Should there be a statement before that possibly. It should skip if Data1 has no value but should go through it until it finds its case otherwise. Appreciate the help"}, {"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "reply_to_user": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "edited": false, "score": 1, "creation_date": 1574906511, "post_id": 59080185, "comment_id": 104398305, "body": "@Tmacjoshua you should check the value of <code>Data1</code>."}, {"owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "reply_to_user": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574906777, "post_id": 59080185, "comment_id": 104398349, "body": "@PaichengWu Had Date1 instead of Data1 thank you so much!"}], "tags": [], "owner": {"reputation": 300, "user_id": 6552575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43124b4324887e160851ad9634cf78b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToCarbajal", "link": "https://stackoverflow.com/users/6552575/tocarbajal"}, "is_accepted": true, "score": 1, "last_activity_date": 1574901298, "last_edit_date": 1574901298, "creation_date": 1574900732, "answer_id": 59080185, "question_id": 59079965, "link": "https://stackoverflow.com/questions/59079965/vba-if-statements-converted-to-case/59080185#59080185", "title": "VBA IF Statements converted to Case", "body": "<p>You too can simplify your inner if statement.\nTry this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If Data1 &lt;&gt; \"\" Then\n    Select Case Data5\n        Case \"A\", \"B\"\n            If TotalT.Value Between 1 And 5 Then\n                SLA.Value = \"Yes\"\n            Else\n                SLA.Value = TotalT - 5\n            End If\n         Case \"C\", \"D\"\n            If TotalT.Value Between 1 And 1 Then\n                SLA.Value = \"Yes\"\n            Else\n                SLA.Value = TotalT - 1\n            End If\n         Case \"E\", \"F\", \"G\", \"H\", \"I\", \"J\"\n            If TotalT.Value Between 1 And 10 Then\n                SLA.Value = \"Yes\"\n            Else\n                SLA.Value = TotalT - 10\n            End If\n        Case Else\n            'TODO\n    End Select\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 10028661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f8722e4960be0c9207ebf5f5171c58f?s=128&d=identicon&r=PG&f=1", "display_name": "Tmacjoshua", "link": "https://stackoverflow.com/users/10028661/tmacjoshua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 59080185, "answer_count": 2, "score": -2, "last_activity_date": 1574904399, "creation_date": 1574898717, "last_edit_date": 1574903597, "question_id": 59079965, "link": "https://stackoverflow.com/questions/59079965/vba-if-statements-converted-to-case", "title": "VBA IF Statements converted to Case", "body": "<p>Hi this one of the first times I am using the case statement and it would be really helpful for someone to convert.</p>\n\n<p>I had a more simplistic If statement that was working but unable to have this work likely due to my end if/else placements. Always appreciate the help!</p>\n\n<pre><code>Public SLA As Range\nPublic Data1, Data5 As Range\nPublic TotalT As Range\n\nSet Data1 = Worksheets(\"Log\").Range(\"N\" &amp; ActiveCell.Row)\nSet Data5 = Worksheets(\"Log\").Range(\"R\" &amp; ActiveCell.Row)\nSet TotalT = Worksheets(\"Log\").Range(\"L\" &amp; ActiveCell.Row)\nSet SLA = Worksheets(\"Log\").Range(\"M\" &amp; ActiveCell.Row)\n\n\nSelect Case Data5 And Data1\nIf Data1 &lt;&gt; \"\" Then\n    If Data5 = \"A\" Or \"B\" Then\n        If TotalT.Value &lt;= 5 And TotalT.Value &lt;&gt; \"\" Then\n            SLA.Value = \"Yes\"\n        Else\n            If TotalT.Value = 0 Then\n            Else\n                SLA.Value = TotalT - 5\n\n            End If\n        End If\n    End If\nEnd If\n\nIf Data1 &lt;&gt; \"\" Then\n    If Data5 = \"C\" Or \"D\" Then\n        If TotalT.Value &lt;= 1 And TotalT.Value &lt;&gt; \"\" Then\n            SLA.Value = \"Yes\"\n        Else\n            If TotalT.Value = 0 Then\n            Else\n                SLA.Value = TotalT - 1\n            End If\n        End If\n    End If\nEnd If\n\nIf Data1 &lt;&gt; \"\" Then\n    If Data5 = \"E\" Or \"F\" Or \"G\" Or \"H\" Or \"I\" Or \"J\" Then\n        If TotalT.Value &lt;= 10 And TotalT.Value &lt;&gt; \"\" Then\n            SLA.Value = \"Yes\"\n        Else\n            If TotalT.Value = 0 Then\n            Else\n                SLA.Value = TotalT - 10\n            End If\n        End If\n    Else\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba", "events", "odbc", "refresh"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1574901185, "post_id": 59079912, "comment_id": 104397394, "body": "Could you add a litte more detail about the connection, and the code that doesn&#39;t suit.  I would like to know what you&#39;ve tried, save me trying something already known not to work :)"}, {"owner": {"reputation": 1, "user_id": 11530274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5fbf59db1ea8cd090b8d82118ace83?s=128&d=identicon&r=PG&f=1", "display_name": "n sherman", "link": "https://stackoverflow.com/users/11530274/n-sherman"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575256749, "post_id": 59079912, "comment_id": 104492385, "body": "Its an oracle database connection that runs  a basic sql every 15 minutes. i want some code that will trigger on that connection refreshing. its a report for a peak season in my warehouse that runs open orders. once the data is refreshed i have a macro that will email all of my higher ups  while i am not here. i just cant figure out the code to trigger the macro. i have tried on change macros but there are a few connections so i end up spamming emails every 15 minutes."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575281609, "post_id": 59079912, "comment_id": 104500552, "body": "Have you looked at event sinking?  You can use <code>withevents</code> to create a &quot;custom&quot; connection.  I&#39;ll add an answer, on how to do, but you&#39;ll need to play with it yourself as it will just be a thought, as you&#39;ve posted no code, so cant see the connection set up."}, {"owner": {"reputation": 1, "user_id": 11530274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5fbf59db1ea8cd090b8d82118ace83?s=128&d=identicon&r=PG&f=1", "display_name": "n sherman", "link": "https://stackoverflow.com/users/11530274/n-sherman"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575317677, "post_id": 59079912, "comment_id": 104518042, "body": "i dont think that is the route i need to go, the connection is already established and working fine. Also when trying to run this code i get user-defined type not defined error. ill post the connection details below."}, {"owner": {"reputation": 1, "user_id": 11530274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5fbf59db1ea8cd090b8d82118ace83?s=128&d=identicon&r=PG&f=1", "display_name": "n sherman", "link": "https://stackoverflow.com/users/11530274/n-sherman"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575317780, "post_id": 59079912, "comment_id": 104518088, "body": "DRIVER={Oracle in OraClient11g_home1};SERVER=********;UID=*********;PWD=******&zwnj;&#8203;**;DBQ=*******;DBA=W&zwnj;&#8203;;APA=T;EXC=F;XSM=Def&zwnj;&#8203;ault;FEN=T;QTO=T;FRC&zwnj;&#8203;=10;FDL=10;LOB=T;RST&zwnj;&#8203;=T;BTD=F;BNF=F;BAM=I&zwnj;&#8203;fAllSuccessful;NUM=N&zwnj;&#8203;LS;DPM=F;MTS=T;MDI=M&zwnj;&#8203;e;CSR=F;FWC=F;FBS=60&zwnj;&#8203;000;TLO=O;MLD=0;ODA=&zwnj;&#8203;F;"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575318182, "post_id": 59079912, "comment_id": 104518243, "body": "Yes, so you set the connection up using my code below, where your connection string is your oracle one."}, {"owner": {"reputation": 1, "user_id": 11530274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5fbf59db1ea8cd090b8d82118ace83?s=128&d=identicon&r=PG&f=1", "display_name": "n sherman", "link": "https://stackoverflow.com/users/11530274/n-sherman"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1575336969, "post_id": 59079912, "comment_id": 104523575, "body": "No the code below did not work. i think i may not have a reference active or something. the connection above i set up last year."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1575292315, "last_edit_date": 1575292315, "creation_date": 1575281845, "answer_id": 59136787, "question_id": 59079912, "link": "https://stackoverflow.com/questions/59079912/how-do-i-get-an-odbc-refresh-to-trigger-vb-code/59136787#59136787", "title": "How do i get an ODBC refresh to trigger vb code", "body": "<p>NOT AN ANSWER AN IDEA</p>\n\n<p>Create a class like so, ive called mine <code>clsCustomConnection</code></p>\n\n<pre><code>Private WithEvents cn As ADODB.Connection\n\nPublic Sub Initialise(cnADO As ADODB.Connection)\n    Set cn = cnADO\nEnd Sub\n\nPrivate Sub cn_ExecuteComplete(ByVal RecordsAffected As Long, ByVal pError As ADODB.Error, _\n                        adStatus As ADODB.EventStatusEnum, ByVal pCommand As ADODB.Command, _\n                        ByVal pRecordset As ADODB.Recordset, ByVal pConnection As ADODB.Connection)\n\n    '   Email function\n    MyEmailFunction (\"VBAEventExample.co.uk\")\n\nEnd Sub\n</code></pre>\n\n<p>Then in a normal module, something like so</p>\n\n<pre><code>Public CustomADOConnection As clsCustomConnection\n\nSub setupADOconnection()\n\n    Dim ADOConn1 As New ADODB.Connection\n\n    '   Set up connection\n    ADOConn1.ConnectionString = \"\"\n    ADOConn1.CursorLocation = adUseClient\n\n    '   Sink to custom connection\n    Set CustomADOConnection = New clsCustomConnection\n    CustomADOConnection.Initialise ADOConn1\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11530274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe5fbf59db1ea8cd090b8d82118ace83?s=128&d=identicon&r=PG&f=1", "display_name": "n sherman", "link": "https://stackoverflow.com/users/11530274/n-sherman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575292315, "creation_date": 1574898269, "question_id": 59079912, "link": "https://stackoverflow.com/questions/59079912/how-do-i-get-an-odbc-refresh-to-trigger-vb-code", "title": "How do i get an ODBC refresh to trigger vb code", "body": "<p>I have an odbc connection named \"Parcel Picks by Hour\" that is on an auto run timer every 15 minutes. I want to run an script that sends an email with the updated data after the refresh event is complete. all codes I have found were unsuccessful. since the timer is already built into the ODBC i dont want a code that refreshes the connection then sends an email i just want the refresh to trigger the code to run.  </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 547, "user_id": 10769002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2da3297e022f0a7082ce73c500c3e65b?s=128&d=identicon&r=PG&f=1", "display_name": "Jenn", "link": "https://stackoverflow.com/users/10769002/jenn"}, "is_accepted": false, "score": 0, "last_activity_date": 1575206741, "creation_date": 1575206741, "answer_id": 59125938, "question_id": 59079904, "link": "https://stackoverflow.com/questions/59079904/vba-excel-refresh-pivot-table-power-query/59125938#59125938", "title": "VBA Excel - Refresh Pivot Table/Power Query", "body": "<p>This is how you can refresh all Power Queries.</p>\n\n<pre><code>Sub RefreshAllPQ_Queries()\n\n    Dim Connection As WorkbookConnection\n    Dim lTest As Long\n\n    On Error Resume Next\n\n    For Each cn In ThisWorkbook.Connections\n\n        lTest = InStr(1, cn.OLEDBConnection.Connection, _\n                \"Provider=Microsoft.Mashup.OleDb.1\")\n\n        If Err.Number &lt;&gt; 0 Then\n\n            Err.Clear\n\n            Exit For\n\n        End If\n\n    If lTest &gt; 0 Then cn.Refresh\n\n    Next cn\n\n\nEnd Sub\n</code></pre>\n\n<p>And this is how you can refresh a pivot table.  </p>\n\n<pre><code>Sub RefreshPivotTable()\n\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim strWS As String\n    Dim strPT As String\n\n    strWS = \"Invoice\"\n    strPT = \"pt_Invoice\"\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(strWS)\n\n    ws.PivotTables(strPT).PivotCache.Refresh\n\n    Set ws = Nothing\n    Set wb = Nothing\n    strWS = vbNullString\n    strPT = vbNullString\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1454, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575206741, "creation_date": 1574898221, "last_edit_date": 1574912528, "question_id": 59079904, "link": "https://stackoverflow.com/questions/59079904/vba-excel-refresh-pivot-table-power-query", "title": "VBA Excel - Refresh Pivot Table/Power Query", "body": "<p>I'm trying to refresh a Power Query &amp; then a Pivot Table (running off that data) &amp; I can get it to work when I step through the code using F8 but it will not work when running the macro</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks!!</p>\n\n<pre><code>Sub Test()\n\nDim WB As Workbook\nDim pt As PivotTable\nSet WB = ThisWorkbook\nSet pt = ActiveSheet.PivotTables(\"PivotTable1\")\n\n'Refresh Power Queries &amp; Pivot Tables\nThisWorkbook.RefreshAll\nWB.Worksheets(\"By Customer Pivot\").Activate\npt.RefreshTable\n\n\nEnd Sub\n\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 51, "user_id": 11908660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d720ccc99073ff6b66653d5de33dd7?s=128&d=identicon&r=PG&f=1", "display_name": "Gage", "link": "https://stackoverflow.com/users/11908660/gage"}, "edited": false, "score": 1, "creation_date": 1574898296, "post_id": 59079847, "comment_id": 104396798, "body": "Is the Level argument missing in the values?"}, {"owner": {"reputation": 27, "user_id": 10225271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526bb78ff4b252efaf5b14d424f4dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "skirsch00", "link": "https://stackoverflow.com/users/10225271/skirsch00"}, "reply_to_user": {"reputation": 51, "user_id": 11908660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56d720ccc99073ff6b66653d5de33dd7?s=128&d=identicon&r=PG&f=1", "display_name": "Gage", "link": "https://stackoverflow.com/users/11908660/gage"}, "edited": false, "score": 0, "creation_date": 1574899190, "post_id": 59079847, "comment_id": 104397013, "body": "yes it was, that was definitely part of the problem"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1574902188, "post_id": 59079847, "comment_id": 104397587, "body": "Why tagging Excel?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1574926996, "post_id": 59079847, "comment_id": 104403734, "body": "What is the error? You insert all values as text which hopefully isn&#39;t correct."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 10225271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526bb78ff4b252efaf5b14d424f4dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "skirsch00", "link": "https://stackoverflow.com/users/10225271/skirsch00"}, "edited": false, "score": 0, "creation_date": 1574900410, "post_id": 59079888, "comment_id": 104397242, "body": "Tried it, still getting the same error"}], "tags": [], "owner": {"reputation": 3795, "user_id": 6672923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff4bdb9435397969c9b7d3acbdc1583?s=128&d=identicon&r=PG&f=1", "display_name": "zip", "link": "https://stackoverflow.com/users/6672923/zip"}, "is_accepted": false, "score": 0, "last_activity_date": 1574898128, "creation_date": 1574898128, "answer_id": 59079888, "question_id": 59079847, "link": "https://stackoverflow.com/questions/59079847/trying-to-execute-a-sql-statement-from-vba-to-an-access-database-getting-a-synt/59079888#59079888", "title": "Trying to execute a SQL statement from VBA to an Access database, getting a syntax error with the INSERT INTO statement", "body": "<p>Try this:</p>\n\n<pre><code>sqlStr = \"INSERT INTO Students (ID, [Last Name],  [First Name],  [E-mail Address], [Student ID], Level,  [Date of Birth],  [Home Phone], Address, City,  [State/Province]) VALUES ('\" &amp; ID.Value &amp; \"','\" &amp; lastName.Value &amp; \"','\" &amp; firstName.Value &amp; \"','\" &amp; email.Value &amp; \"','\" &amp; studentID.Value &amp; \"','\" &amp; birthday.Value &amp; \"','\" &amp; phone.Value &amp; \"','\" &amp; address.Value &amp; \"','\" &amp; city.Value &amp; \"','\" &amp; state.Value &amp; \"');\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1574898161, "creation_date": 1574898161, "answer_id": 59079896, "question_id": 59079847, "link": "https://stackoverflow.com/questions/59079847/trying-to-execute-a-sql-statement-from-vba-to-an-access-database-getting-a-synt/59079896#59079896", "title": "Trying to execute a SQL statement from VBA to an Access database, getting a syntax error with the INSERT INTO statement", "body": "<p>You'll need square brackets surrounding fields with spaces or special characters, e.g.:</p>\n\n<pre><code>(ID, [Last Name], [First Name], [E-mail Address], [Student ID], Level, [Date of Birth], [Home Phone], Address, City, [State/Province])\n</code></pre>\n\n<p>Also, unless all of your fields are text fields, you'll need to correctly represent the values depending on the data type - for example, if <code>Date of Birth</code> is a date field (as it should be), the date value should be supplied in the format:</p>\n\n<pre><code>#mm/dd/yyyy#\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 6552575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43124b4324887e160851ad9634cf78b0?s=128&d=identicon&r=PG&f=1", "display_name": "ToCarbajal", "link": "https://stackoverflow.com/users/6552575/tocarbajal"}, "is_accepted": false, "score": 0, "last_activity_date": 1574899325, "creation_date": 1574899325, "answer_id": 59080043, "question_id": 59079847, "link": "https://stackoverflow.com/questions/59079847/trying-to-execute-a-sql-statement-from-vba-to-an-access-database-getting-a-synt/59080043#59080043", "title": "Trying to execute a SQL statement from VBA to an Access database, getting a syntax error with the INSERT INTO statement", "body": "<p>The names of the fields with spaces need to be closed between sqaure brackets and check the data type of your values. Additionally you need to use a single quote (') in your varchar .Values.</p>\n\n<pre><code>sql_qry = \"INSERT INTO STUDENTS(ID, [NAME ST], AGE) VALUES(\" &amp; v1 &amp; \",'\" &amp; v2 &amp; \"',\" &amp; v3 &amp; \")\"\n</code></pre>\n\n<p>then</p>\n\n<pre><code>DoCmd.RunSQL (sql_qry)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1574929541, "post_id": 59080457, "comment_id": 104404844, "body": "... and from SQL injection and data formatting issues!"}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 1, "last_activity_date": 1574903418, "creation_date": 1574903418, "answer_id": 59080457, "question_id": 59079847, "link": "https://stackoverflow.com/questions/59079847/trying-to-execute-a-sql-statement-from-vba-to-an-access-database-getting-a-synt/59080457#59080457", "title": "Trying to execute a SQL statement from VBA to an Access database, getting a syntax error with the INSERT INTO statement", "body": "<p>You could open the table and insert the record directly without building the sql statement.</p>\n\n<pre><code>Dim rs as dao.recordset \nset rs = Currentdb.tabledefs(\"Students\").openrecordset\nRs.addnew\n    ' both rs(fieldname) and rs!fieldName would work\n    Rs(\"ID\") =  id \n    Rs![Last Name] = lastName\n    rs![First Name] =\n    rs![E-mail Address]=\n    rs![Student ID]=\n    rs!Level=\n    rs![Date of Birth]=\n    rs![Home Phone]=\n    rs!Address=\n    rs!City=\n    rs![State/Province]=\n\nRs.update\nRs.close\nSet rs = nothing\n</code></pre>\n\n<p>Assign rest of the text box values for each field and try it. At least you can escape from <code>syntax error</code></p>\n\n<p><em>replying from mobile</em></p>\n"}, {"tags": [], "owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "is_accepted": false, "score": 0, "last_activity_date": 1574903624, "creation_date": 1574903624, "answer_id": 59080479, "question_id": 59079847, "link": "https://stackoverflow.com/questions/59079847/trying-to-execute-a-sql-statement-from-vba-to-an-access-database-getting-a-synt/59080479#59080479", "title": "Trying to execute a SQL statement from VBA to an Access database, getting a syntax error with the INSERT INTO statement", "body": "<p>You set 11 fields to insert, but give only 10 values.\nYou lack the value of <code>Level</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>sqlStr = \"INSERT INTO Students \"\nsqlStr = sqlStr &amp; \"([ID], [Last Name], [First Name], [E-mail Address], [Student ID], [Level], [Date of Birth], [Home Phone], [Address], [City], [State/Province]) VALUES (\"\nsqlStr = sqlStr &amp; \"'\" &amp; ID.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",'\" &amp; lastName.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",'\" &amp; firstName.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",'\" &amp; email.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",'\" &amp; studentID.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",\" &amp; Level.Value &amp; \"\"      '&lt;--lack. if number\nsqlStr = sqlStr &amp; \",#\" &amp; birthday.Value &amp; \"#\"   '&lt;--if date, blocked with #\nsqlStr = sqlStr &amp; \",'\" &amp; phone.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",'\" &amp; address.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",'\" &amp; city.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \",'\" &amp; state.Value &amp; \"'\"\nsqlStr = sqlStr &amp; \");\"\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 10225271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/526bb78ff4b252efaf5b14d424f4dbc2?s=128&d=identicon&r=PG&f=1", "display_name": "skirsch00", "link": "https://stackoverflow.com/users/10225271/skirsch00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1574961853, "answer_count": 5, "score": -1, "last_activity_date": 1594233880, "creation_date": 1574897772, "last_edit_date": 1594233880, "question_id": 59079847, "link": "https://stackoverflow.com/questions/59079847/trying-to-execute-a-sql-statement-from-vba-to-an-access-database-getting-a-synt", "closed_reason": "Needs details or clarity", "title": "Trying to execute a SQL statement from VBA to an Access database, getting a syntax error with the INSERT INTO statement", "body": "<p>This is the code:</p>\n\n<pre><code>sqlStr = \"INSERT INTO Students (ID, Last Name, First Name, E-mail Address, Student ID, Level, Date of Birth, Home Phone, Address, City, State/Province) VALUES ('\" &amp; ID.Value &amp; \"','\" &amp; lastName.Value &amp; \"','\" &amp; firstName.Value &amp; \"','\" &amp; email.Value &amp; \"','\" &amp; studentID.Value &amp; \"','\" &amp; birthday.Value &amp; \"','\" &amp; phone.Value &amp; \"','\" &amp; address.Value &amp; \"','\" &amp; city.Value &amp; \"','\" &amp; state.Value &amp; \"');\"\n\nDoCmd.RunSQL sqlStr\n</code></pre>\n\n<p>The <code>.Value</code> variables are coming from text boxes from a userform.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-reports"], "answers": [{"comments": [{"owner": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "edited": false, "score": 0, "creation_date": 1574950660, "post_id": 59081469, "comment_id": 104416233, "body": "Thx, But I&#39;m asking about a case where a Single MS Access Report needs multiple parameter arguments(in fact, to be more specific, my Single MS Access Report expects an argument for it&#39;s own QueryDef, &amp; a listbox within said Single MS Access Report has another QueryDef associated with it which expects another argument parameter.)"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "reply_to_user": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "edited": false, "score": 1, "creation_date": 1574964504, "post_id": 59081469, "comment_id": 104422585, "body": "Having two separate places for params is difficult. Remove  all the parameters, and then just pass a simple where clause to the query.  It is these all over the place parameters that is causing difficulty here.  You should be able to filter the report, and not have to filter the  original query. This way, then you are free to cook up any filter you want.However, because you have a query, and then a report,you might consider overwriting the original query raw sql. However, if possible, pass a where clause."}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1574913018, "creation_date": 1574913018, "answer_id": 59081469, "question_id": 59079797, "link": "https://stackoverflow.com/questions/59079797/what-steps-in-order-to-implement-ms-access-report-in-such-a-way-that-different-q/59081469#59081469", "title": "What steps in order to implement MS Access Report in such a way that different query defintions take different arguments?", "body": "<p>Simply remove the query parms. Just base the report  on the raw query.</p>\n\n<p>Then, to filter the report - pass it a \"where\" clause.</p>\n\n<p>So:</p>\n\n<pre><code>dim strWhere     as string\ndim strReport    as string\n\nstrReport = \"OrgFinancialInstReport\"\nstrWhere = \"Arg = \" &amp; CInt(me.IdLabel.Caption)\nDoCmd.OpenReport strReport, acViewPreview,,strWhere\n\nDoCmd.OutputTo acOutputReport, strReport, acFormatPDF, \n     GetConstructedPdfFileName(CInt(Me.IdLabel.Caption), Me.InvestorName.Caption), True\nDoCmd.Close acReport, strReport\n</code></pre>\n\n<p>And for the other report, we go:</p>\n\n<pre><code>dim strWhere     as string\ndim strReport    as string\n\nstrReport = \"OrgFinancialInstReport\"\nstrWhere = \"Arg2 = \" &amp; CInt(Me.IdV2.Caption)\nDoCmd.OpenReport strReport, acViewPreview,,strWhere\n\nDoCmd.OutputTo acOutputReport, strReport, acFormatPDF, \n     GetConstructedPdfFileName(CInt(Me.IdLabel.Caption), Me.InvestorName.Caption), True\nDoCmd.Close acReport, strReport\n</code></pre>\n\n<p>You could even break out the above code that creates the PDF as a separate routine - call it from any form - just pass the report name, and the where clause, and maybe the caption.</p>\n\n<p>So, when you don't know the number of parameters ahead of time, or they change? Just use the  where clause. Your query will thus have no parameters. </p>\n"}], "owner": {"reputation": 521, "user_id": 6888123, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/259b4ffbfcfafd94b68e92e7de383aa7?s=128&d=identicon&r=PG&f=1", "display_name": "crazyTech", "link": "https://stackoverflow.com/users/6888123/crazytech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574913018, "creation_date": 1574897384, "last_edit_date": 1574910222, "question_id": 59079797, "link": "https://stackoverflow.com/questions/59079797/what-steps-in-order-to-implement-ms-access-report-in-such-a-way-that-different-q", "title": "What steps in order to implement MS Access Report in such a way that different query defintions take different arguments?", "body": "<p>On my work desktop, I have </p>\n\n<p>-Microsoft Office Professional Plus 2013 Access </p>\n\n<p>I've been tasked to create a MS Access application with an Access DB.</p>\n\n<p>I have an MS Access Report within my application</p>\n\n<p>The MS Access Report's Record Source is associated with a MS Access Query Definition</p>\n\n<p>, and furthermore, said MS Access Query Definition takes an argument which I've named as idArg ( of type Double ).</p>\n\n<p>However, within the MS Access Report, I also have a ListBox which is associated with Another MS Access Query Definition which takes a different argument which I've named as idArg2 ( of type Double ).</p>\n\n<p>The aforementioned MS Access Report will be ultimately used to generate a pdf version of itself.</p>\n\n<p>I generate the pdf  programmatically from a Form's VB code:</p>\n\n<pre><code>DoCmd.SetParameter \"idArg\", CInt(Me.IdLabel.Caption)\nDoCmd.SetParameter \"idArg2\", CInt(Me.IdV2.Caption)\nDoCmd.OpenReport \"OrgFinancialInstReport\", acViewPreview\n DoCmd.OutputTo acOutputReport, \"OrgFinancialInstReport\", acFormatPDF, GetConstructedPdfFileName(CInt(Me.IdLabel.Caption), Me.InvestorName.Caption), True\n  DoCmd.Close acReport, \"OrgFinancialInstReport\"\n</code></pre>\n\n<p>However, the code shown above Only successfully applies the CInt(Me.IdLabel.Caption) to \"idArg\" correctly but fails to apply the CInt(Me.IdV2.Caption) to \"idArg2\"</p>\n\n<p>therefore, when the above code is run, I see the popup box that requests a value for \"idArg2\"</p>\n\n<p>What steps do I have to take in order to implement said MS Access Report so that I can assign the CInt(Me.IdV2.Caption) to \"idArg2\" properly?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574893633, "post_id": 59079248, "comment_id": 104395622, "body": "When you change this to <code>.Send</code> you should be fine. Outlook is crashing since you are forcing so many windows to open. When you change to <code>.Send</code>, there is less UI processing and your instance of outlook is less likely to crash. You should test first of course (just send yourself all the emails)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574893834, "post_id": 59079248, "comment_id": 104395704, "body": "You could also speed things up here by switching to a <code>ELSE IF</code> to avoid running each value in your loop through every single test assuming each cell should only return TRUE for one instance. If it is TRUE for the first test, why run it through the next 2 knowing the result will be FALSE?"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574894453, "post_id": 59079248, "comment_id": 104395871, "body": "It looks like all of your email bodies are the exact same. Why not just have the body be a variable? Then you just have one section to draft the email...."}, {"owner": {"reputation": 1, "user_id": 12448498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63bd16fdd5590c0992f1c4eefc8b8b5e?s=128&d=identicon&r=PG&f=1", "display_name": "Daruco", "link": "https://stackoverflow.com/users/12448498/daruco"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574895438, "post_id": 59079248, "comment_id": 104396127, "body": "@urdearboy I will change to Else If statements.  That makes sense.  For the email bodies,  in my real code they do not say what is said here.  It was very specific outputs so i dumbed it down just for the post.  Like you said,  <code>.Send</code> should solve the problem but I&#39;d prefer close out of drafts than edit the spreadsheet on the frontend"}], "answers": [{"tags": [], "owner": {"reputation": 28, "user_id": 11425956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc525bc74909ff5495ce7527b5a3804?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/11425956/sergiu"}, "is_accepted": false, "score": 0, "last_activity_date": 1574920379, "creation_date": 1574920379, "answer_id": 59082510, "question_id": 59079248, "link": "https://stackoverflow.com/questions/59079248/wait-until-email-is-sent-in-outlook-before-moving-to-next-cell-row/59082510#59082510", "title": "Wait until email is sent in Outlook before moving to next cell row", "body": "<p><strong>not tested</strong></p>\n\n<p>first of all , sorry for replying with answer, i cannot comment due to not enough rep. \nOk i did some research online on your question, you might want to look into <code>.Display True</code></p>\n\n<p>It seems adding \"True\" to the display it makes the pop-up window modal.\nbeing modal puts the loop on hold until you click the send the email.</p>\n\n<p>just wanted to let you know about this , but cant comment.</p>\n"}], "owner": {"reputation": 1, "user_id": 12448498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63bd16fdd5590c0992f1c4eefc8b8b5e?s=128&d=identicon&r=PG&f=1", "display_name": "Daruco", "link": "https://stackoverflow.com/users/12448498/daruco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1578416379, "creation_date": 1574893480, "last_edit_date": 1578416379, "question_id": 59079248, "link": "https://stackoverflow.com/questions/59079248/wait-until-email-is-sent-in-outlook-before-moving-to-next-cell-row", "title": "Wait until email is sent in Outlook before moving to next cell row", "body": "<p>This VBA code for Excel should take info from specific cells in each row to populate an automated email follow up.</p>\n\n<p>The code moves through each row of the sheet and opens an email draft in Outlook.  This is problematic when the sheet has too many lines, Outlook will typically crash.</p>\n\n<p>I tried using various loops but it either breaks the script or causes the draft to reopen forcing me to have to kill Outlook.</p>\n\n<p>Is there a way to have open the draft and wait until the window is either closed or sent before it moves on to the next line?</p>\n\n<p>I am using <code>.Display</code> rather than <code>.Send</code> so that the email drafts can be reviewed, edited, or cancelled prior to send.</p>\n\n<p>Is there something that checks for <code>.Display = True</code> before moving to the new row in Excel?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub SendEmails()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim cell As Range\n    Dim Name As String\n    Dim FirstName As String\n    Dim LastName As String\n    Dim Temp\n\n    Application.ScreenUpdating = False\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    On Error GoTo cleanup\n\n    For Each cell In Columns(\"W\").Cells.SpecialCells(xlCellTypeConstants)\n        i = cell.Row                                                                \n        Temp = Split(Sheets(\"Sheet1\").Range(\"P\" &amp; i).Value)                         \n        FirstName = WorksheetFunction.Proper(Temp(LBound(Temp)))                   \n\n        If Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value = \"Yellow\" And Sheets(\"Sheet1\").Range(\"AE\" &amp; i).Value = \"Red\" Then\n            Set OutMail = OutApp.CreateItem(0)\n            On Error Resume Next\n            With OutMail\n                .To = cell.Value\n                .subject = \"Yellow Red\" &amp; Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value &amp; \" - \" &amp; Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value\n                .HTMLBody = \"&lt;p&gt;Good Afternoon \" &amp; FirstName &amp; \",\" &amp; \"&lt;/p&gt;\" &amp; \"&lt;p&gt;Thank you for Yellow.&lt;/p&gt;\" &amp; \"&lt;p&gt; Thanks &lt;/p&gt;\"\n                .Display\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n        End If\n\n        If Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value = \"Blue\" Then\n            Set OutMail = OutApp.CreateItem(0)\n            On Error Resume Next\n            With OutMail\n                .To = cell.Value\n                .subject = \"Blue\" &amp; Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value &amp; \" - \" &amp; Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value\n                .HTMLBody = \"&lt;p&gt;Good Afternoon \" &amp; FirstName &amp; \",\" &amp; \"&lt;/p&gt;\" &amp; \"&lt;p&gt;Thank you for Blue.&lt;/p&gt;\" &amp; \"&lt;p&gt; Thanks &lt;/p&gt;\"\n                .Display\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n        End If\n\n        If Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value = \"Yellow\" And Sheets(\"Sheet1\").Range(\"AE\" &amp; i).Value &lt;&gt; \"Red\" Then\n            Set OutMail = OutApp.CreateItem(0)\n            On Error Resume Next\n            With OutMail\n                .To = cell.Value\n                .subject = \"Yellow\" &amp; Sheets(\"Sheet1\").Range(\"A\" &amp; i).Value &amp; \" - \" &amp; Sheets(\"Sheet1\").Range(\"D\" &amp; i).Value\n                .HTMLBody = \"&lt;p&gt;Good Afternoon \" &amp; FirstName &amp; \",\" &amp; \"&lt;/p&gt;\" &amp; \"&lt;p&gt;Thank you for Yellow .&lt;/p&gt;\" &amp; \"&lt;p&gt; Thanks &lt;/p&gt;\"\n                .Display\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n        End If\n\n   Next cell\n\ncleanup:\n    Set OutApp = Nothing\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "recursion", "optimization", "collections", "stack"], "comments": [{"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1574900133, "post_id": 59079048, "comment_id": 104397195, "body": "Do you have a working recursive solution?"}, {"owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "reply_to_user": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1575002404, "post_id": 59079048, "comment_id": 104430616, "body": "Yes, do you think it is relevant/should be added to the post?"}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1575003227, "post_id": 59079048, "comment_id": 104430770, "body": "I think you should post it on CodeReview."}, {"owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "edited": false, "score": 0, "creation_date": 1575003366, "post_id": 59079048, "comment_id": 104430806, "body": "How be are the concatenated strings getting?"}], "answers": [{"tags": [], "owner": {"reputation": 4143, "user_id": 9912714, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUyii.jpg?s=128&g=1", "display_name": "TinMan", "link": "https://stackoverflow.com/users/9912714/tinman"}, "is_accepted": false, "score": 2, "last_activity_date": 1574900086, "creation_date": 1574900086, "answer_id": 59080119, "question_id": 59079048, "link": "https://stackoverflow.com/questions/59079048/udt-stack-in-vba/59080119#59080119", "title": "UDT Stack in VBA", "body": "<p>Here is a .Net Stack wrapper class that I wrote:</p>\n\n<h2>Stack Class</h2>\n\n<pre><code>Public Control As Object\n\nPrivate Sub Class_Initialize()\n    Set Me.Control = CreateObject(\"System.Collections.Stack\")\nEnd Sub\n\nRem Clear() Removes all objects from the Stack.\nPublic Sub Clear(value As Variant)\n    Me.Control.Clear\nEnd Sub\n\nRem Creates a shallow copy of the Control.\nPublic Function Clone()\n    Set Clone = Control.Clone\nEnd Function\n\nRem Contains(Object)    Determines whether an element is in the Stack.\nPublic Function Contains(value As Variant) As Boolean\n    Contains = Me.Control.Contains(value)\nEnd Function\n\nRem Gets the number of elements contained in the Stack.\nPublic Function Count() As Long\n    Count = Me.Control.Count\nEnd Function\n\nRem Determines whether the specified ObjectA is the Control\nPublic Function Equals(Control As Object) As Boolean\n    Equals = Control.Equals(Control)\nEnd Function\n\nRem GetHashCode()\nRem Serves as the default hash function. (Inherited from Object.)\nPublic Function GetHashCode() As Long\n    GetHashCode = Control.GetHashCode\nEnd Function\n\nRem Removes and returns the object at the top of the Stack.\nPublic Function Pop()\n    If IsObject(Me.Control.Peek) Then\n        Set Pop = Me.Control.Pop\n    Else\n        Pop = Me.Control.Peek\n    End If\nEnd Function\n\nRem Inserts an object at the top of the Stack.\nPublic Sub Push(value As Variant)\n    Me.Control.Push value\nEnd Sub\n\nRem Custom Function\nFunction This() As TTools.stack\n    Set This = Me\nEnd Function\n\nRem Copies the Stack to a new array.\nPublic Function ToArray() As Variant\n    ToArray = Me.Control.ToArray()\nEnd Function\n\nRem Returns a string that represents the current object.(Inherited from Object.)\nPublic Function toString() As String\n    toString = Control.toString\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><code>Math.Round()</code> is 20 times faster then using <code>Application.WorksheetFunction.RoundUp()</code>.</p>\n\n<blockquote>\n<pre><code>newItems(k - 1).b = Math.Round((items(i).b + items(j).b + items(j).g) / 2, 0)\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 414, "user_id": 3750262, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/903190092/picture?type=large", "display_name": "Greg", "link": "https://stackoverflow.com/users/3750262/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574900086, "creation_date": 1574892201, "last_edit_date": 1574894258, "question_id": 59079048, "link": "https://stackoverflow.com/questions/59079048/udt-stack-in-vba", "title": "UDT Stack in VBA", "body": "<h2>Goal</h2>\n\n<p>In transforming a recursive solution to an iterative one, I am trying to create a stack of UDTs(state) as seen below. </p>\n\n<h2>What I've tried &amp; the Issues</h2>\n\n<p>The collection implementation of a stack does not work due to UDTs not being allowed in collections. </p>\n\n<p>Implementing the UDTs as classes does not work due to the ~10x performance time (improving the performance is the sole goal of implementing in an iterative solution via a stack).</p>\n\n<p>I have not been able to find a native stack object in VBA. </p>\n\n<h2>Question</h2>\n\n<p>Is there a less computationally expensive way to add UDTs to a stack than implementing them as classes?</p>\n\n<h2>FYI</h2>\n\n<p>The solution is O(n!((n-1)/2)!) and my goal is solving for n=12 on personal PCs in &lt; 30min</p>\n\n<h2>Code Overview</h2>\n\n<pre><code>Public Type state\n items() As item2\n path As String\nEnd Type\n\nPublic Type item2\n b As Integer\n g As Integer\n n As String\nEnd Type\n\nSub fuse3(initialState As state)\n  Dim stack As collection\n  Dim top As state\n  Dim bestResult As result2\n  stack.Add initialState\n  While stack.Count &gt; 0\n    top = stack.item(stack.Count) '{ This is a pop\n    stack.Remove (stack.Count)        '{\n    ...\n    ...\n  Wend\nEnd Sub\n</code></pre>\n\n<h2>Full Code</h2>\n\n<pre><code>Option Explicit\nOption Base 1\nDim paths_explored As Double\n\nPublic Type state\n     items() As item2\n     path As String\nEnd Type\nPublic Type item2\n     b As Integer\n     g As Integer\n     n As String\nEnd Type\n\nPublic Type result2\n     v As Integer\n     p As String\nEnd Type\n\n\n\n'Recursive\nSub Fuser3()\n\n\nDim secs1, secs2 As Single\nsecs1 = Timer()\nDim markedABase As Boolean\n    markedABase = True\n    'note, if gem value is 1337 this means it was marked as the base and should not be fused onto others\n    ' and also means that 1337 should be subtracted from the final answer\n\n    '\n\n\n    'input data\n    Dim item1 As item2\n    item1.b = 100\n    item1.g = 1337\n    item1.n = \"1\"\n\n    Dim item2 As item2\n    item2.b = 100\n    item2.g = 64\n    item2.n = \"2\"\n\n    Dim item3 As item2\n    item3.b = 120\n    item3.g = 64\n    item3.n = \"3\"\n\n    Dim item4 As item2\n    item4.b = 120\n    item4.g = 64\n    item4.n = \"4\"\n\n    Dim item5 As item2\n    item5.b = 100\n    item5.g = 64\n    item5.n = \"5\"\n\n    Dim item6 As item2\n    item6.b = 260\n    item6.g = 24\n    item6.n = \"6\"\n\n    Dim item7 As item2\n    item7.b = 191\n    item7.g = 30\n    item7.n = \"7\"\n\n    Dim item8 As item2\n    item8.b = 197\n    item8.g = 30\n    item8.n = \"8\"\n\n    Dim item9 As item2\n    item9.b = 187\n    item9.g = 30\n    item9.n = \"9\"\n\n    Dim inputItems(7) As item2\n    inputItems(1) = item1\n    inputItems(2) = item2\n    inputItems(3) = item3\n    inputItems(4) = item4\n    inputItems(5) = item5\n    inputItems(6) = item6\n    inputItems(7) = item7\n    'inputItems(8) = item8\n    'inputItems(9) = item9\n\n\n    Dim inputPath As String\n    inputPath = \"If you asked Doll, she would would fuse \"\n    paths_explored = 0\n\n    'function\n    Dim initialState As state\n    initialState.items = inputItems\n    initialState.path = inputPath\n    Dim answer As result2\n    answer = fuse3(initialState)\n    secs2 = Timer()\n    If markedABase Then\n        MsgBox (answer.v - 1337 &amp; \" in \" &amp; paths_explored &amp; \" loops, \" &amp; secs2 - secs1 &amp; \" seconds   \" &amp; answer.p)\n    Else\n        MsgBox (answer.v &amp; \" in \" &amp; paths_explored &amp; \" loops, \" &amp; secs2 - secs1 &amp; \" seconds   \" &amp; answer.p)\n    End If\n\nEnd Sub\n\nFunction fuse3(initialState As state) As result2\n\nDim stack As collection\nDim top As state\nDim bestResult As result2\nstack.Add initialState\nWhile stack.Count &gt; 0\n    top = stack.item(stack.Count) '{ This is a pop\n    stack.Remove (stack.Count)        '{\n\n    Dim items() As item2\n    items = top.items\n    Dim path As String\n    path = top.path\n\n    Select Case UBound(items)\n      Case 0\n        'error\n      Case 1\n        Dim result As Integer\n        result = items(1).b + items(1).g\n        If result &gt; bestResult.v Then\n            bestResult.v = result\n            bestResult.p = path\n        End If\n      Case Else\n        Dim i As Integer\n        Dim j As Integer\n        Dim k As Integer\n        For i = 1 To UBound(items)\n          For j = 1 To UBound(items)\n            If i = j Then\n            Else\n                If items(j).b + items(j).g &lt; items(i).b Or items(j).g = 1337 Then\n                Else\n                  Dim fPath As String\n                  fPath = path + items(j).n + \"--&gt;\" + items(i).n + \", \"\n                  ReDim newItems(UBound(items) - 1) As item2\n\n                  'newItems = items\n                  'remove item j by not copying it over\n                  For k = 1 To UBound(items)\n                    If k = i Then\n                        If k &lt; j Then\n                            newItems(k).b = Application.WorksheetFunction.RoundUp((items(i).b + items(j).b + items(j).g) / 2, 0)\n                            newItems(k).g = items(k).g\n                            newItems(k).n = items(k).n\n                        Else\n                            newItems(k - 1).b = Application.WorksheetFunction.RoundUp((items(i).b + items(j).b + items(j).g) / 2, 0)\n                            newItems(k - 1).g = items(k).g\n                            newItems(k - 1).n = items(k).n\n                        End If\n                    Else\n                        If k &lt; j Then\n                            newItems(k).b = items(k).b\n                            newItems(k).g = items(k).g\n                            newItems(k).n = items(k).n\n                        ElseIf k &gt; j Then\n                            newItems(k - 1).b = items(k).b\n                            newItems(k - 1).g = items(k).g\n                            newItems(k - 1).n = items(k).n\n                        End If\n                    End If\n                  Next\n\n                  Dim newState As state\n                  newState.items = newItems\n                  newState.path = fPath\n                  stack.Add newState\n\n                End If\n            End If\n          Next\n        Next\n\n    End Select\nWend\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ribbon", "office-addins"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1574892712, "post_id": 59079040, "comment_id": 104395325, "body": "Seems like a reasonable approach. That makes it part of the file itself. Unless there is some sort of performance issue, I don&#39;t see any point in trying to change it."}], "owner": {"reputation": 434, "user_id": 8783311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbe3948e7f0f1a9e258e7eaa9c94a665?s=128&d=identicon&r=PG&f=1", "display_name": "jblack", "link": "https://stackoverflow.com/users/8783311/jblack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574892147, "creation_date": 1574892147, "question_id": 59079040, "link": "https://stackoverflow.com/questions/59079040/excel-vba-how-to-store-an-image-in-an-add-in", "title": "Excel VBA - How to store an image in an add-in", "body": "<p>In my add-in I have created a gallery on a custom Excel ribbon with specific images inside that the user can choose to use in their document.</p>\n\n<p>These specific images need to be stored in the add-in and not in an external folder, so that no matter where the add-in is installed the user will have access to the images. Currently I have stored the images on a hidden worksheet in the add-in.</p>\n\n<p>My question is, is the this the best way to do this or is there another more foolproof way of storing/accessing the images in an add-in?</p>\n\n<p>Thanks </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1574889495, "post_id": 59078104, "comment_id": 104394219, "body": "What have you tried so far?  The code you have is a good start,but your question is asking the SO community to write the code for you.  I would start by researching loops and possibly arrays to get to your goal."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1574887664, "creation_date": 1574887664, "answer_id": 59078204, "question_id": 59078104, "link": "https://stackoverflow.com/questions/59078104/how-to-print-values-into-next-empty-row-cells/59078204#59078204", "title": "How to print values into next empty row cells?", "body": "<p>There are quite a few ways to select/detect last row in Excel with VBA. The best one I usually use:</p>\n\n<pre><code>Function LastRow(wsName As String, Optional columnToCheck As Long = 1) As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(wsName)\n    LastRow = ws.Cells(ws.Rows.Count, columnToCheck).End(xlUp).Row\nEnd Function\n</code></pre>\n\n<p>This is how to use it for column \"E\" (5th column):</p>\n\n<p><code>someLastRow = LastRow(\"WorksheetName\", 5)</code></p>\n\n<p>If you have ideas for improvement, feel free to make PR: <a href=\"https://github.com/Vitosh/VBA_personal/blob/master/LastThings.vb\" rel=\"nofollow noreferrer\">https://github.com/Vitosh/VBA_personal/blob/master/LastThings.vb</a></p>\n"}], "owner": {"reputation": 65, "user_id": 9627705, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-duEOc0wEUNg/AAAAAAAAAAI/AAAAAAAAAH4/Ji-CS4SYZVo/photo.jpg?sz=128", "display_name": "Jake Blazer", "link": "https://stackoverflow.com/users/9627705/jake-blazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574887664, "creation_date": 1574887180, "question_id": 59078104, "link": "https://stackoverflow.com/questions/59078104/how-to-print-values-into-next-empty-row-cells", "title": "How to print values into next empty row cells?", "body": "<p>I have designed a VBA form to collect data from the user. However, I want to allow the user to fill the form multiple times and each time prints the filled out data into appropriate cells in the Excel sheet, so I want the VBA program to look for the next empty cell in the sheet without having the user to look manually and select it.</p>\n\n<pre><code>Cells(lastRow, 1) = emplName\nCells(lastRow, 2) = depTxt\nCells(lastRow, 3) = emplNo\nCells(lastRow, 4) = mngrName\nCells(lastRow, 5) = ComboBox1.Value\n</code></pre>\n\n<p>Here for instance, these five values should then print into the first row, if the form is used again, it should find the next empty row to print the values.</p>\n\n<p>Thank you for your time.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574887076, "post_id": 59078069, "comment_id": 104393270, "body": "use a pivot table."}, {"owner": {"reputation": 27, "user_id": 11066823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9903d447dec2f46e2453f09e3b4b2f?s=128&d=identicon&r=PG&f=1", "display_name": "10uss", "link": "https://stackoverflow.com/users/11066823/10uss"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574887227, "post_id": 59078069, "comment_id": 104393325, "body": "@ScottCraner thank you for your repsonse! The pivot table feels like a lot of hassle for a simple task. But in your opinioin that is the only solution?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574887330, "post_id": 59078069, "comment_id": 104393359, "body": "It is the easiest. Other wise you must loop the rows to get the unique list then loop again to get the sums."}, {"owner": {"reputation": 3280, "user_id": 777551, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RPOt3.jpg?s=128&g=1", "display_name": "mnieto", "link": "https://stackoverflow.com/users/777551/mnieto"}, "edited": false, "score": 0, "creation_date": 1574887358, "post_id": 59078069, "comment_id": 104393369, "body": "If your data came from a database, do: <code>select name, sum(apples) as Num from TableName group by name</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574887377, "post_id": 59078069, "comment_id": 104393378, "body": "Now if you have access to the NEW Dynamic Array formulas it can be done with two formula."}, {"owner": {"reputation": 27, "user_id": 11066823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9903d447dec2f46e2453f09e3b4b2f?s=128&d=identicon&r=PG&f=1", "display_name": "10uss", "link": "https://stackoverflow.com/users/11066823/10uss"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574887558, "post_id": 59078069, "comment_id": 104393454, "body": "@ScottCraner  Yeah clear, I also thought of recording a macro with dropping duplicates and then a sumifs function but that also needs a second sheet. However, this feels the same as the current solution, a lot of hassle for a simple task."}, {"owner": {"reputation": 27, "user_id": 11066823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9903d447dec2f46e2453f09e3b4b2f?s=128&d=identicon&r=PG&f=1", "display_name": "10uss", "link": "https://stackoverflow.com/users/11066823/10uss"}, "reply_to_user": {"reputation": 3280, "user_id": 777551, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/RPOt3.jpg?s=128&g=1", "display_name": "mnieto", "link": "https://stackoverflow.com/users/777551/mnieto"}, "edited": false, "score": 0, "creation_date": 1574887879, "post_id": 59078069, "comment_id": 104393588, "body": "@mnieto what do you mean with from a database? It is date retrieved from Navision, which I copy into the Excel sheet and then execute the macro mentioned in my question. This is also a bit of a task but it only needs to be done daily but not really user friendly. I think it is also possible to download the data directly from the database (have to check). So if your tip works, it is an option to look into."}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1574893266, "post_id": 59078069, "comment_id": 104395500, "body": "@10uss the comment from mnieto is the SQL you would use get your desired output right from the data source. It sounds like this doesn&#39;t apply to your data source if you are not familiar with the provided query. Pivot Table is by far the easiest solution here. Once you set it up once, all you have to do is refresh..."}], "owner": {"reputation": 27, "user_id": 11066823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df9903d447dec2f46e2453f09e3b4b2f?s=128&d=identicon&r=PG&f=1", "display_name": "10uss", "link": "https://stackoverflow.com/users/11066823/10uss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574887002, "creation_date": 1574887002, "question_id": 59078069, "link": "https://stackoverflow.com/questions/59078069/how-do-you-group-by-rows-in-vba-such-that-the-values-in-row-x-are-unique-and-the", "title": "How do you group by rows in VBA such that the values in row x are unique and the values in row y are summed up?", "body": "<p>Is there in VBA an equivalent function of the group by function in pandas (Python)? The groupby function does the following</p>\n\n<p><a href=\"https://i.stack.imgur.com/nOBNa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nOBNa.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>df.groupby(['Name']).sum()\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/XA0N8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XA0N8.png\" alt=\"enter image description here\"></a></p>\n\n<p>The line essentially returns each unique Name with in the Apples column the sum of the apples of each name. Currently I add data to a sheet which is linked to a pivot table (I refresh the pivot table time with a macro), a second sheet copies the data from the pivot table and paste it hard. Within the second sheet I use some vlookups and other functions to calculate some extra data. But I prefer to group by the data in the first sheet so that I don't need the pivot table and second sheet (much cleaner, cleaner file, smaller file etc.).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 9085446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QTMxB.png?s=128&g=1", "display_name": "MRah", "link": "https://stackoverflow.com/users/9085446/mrah"}, "is_accepted": true, "score": 1, "last_activity_date": 1581877978, "last_edit_date": 1581877978, "creation_date": 1574890784, "answer_id": 59078812, "question_id": 59077923, "link": "https://stackoverflow.com/questions/59077923/nested-loop-with-varying-number-of-iterations/59078812#59078812", "title": "Nested loop with varying number of iterations", "body": "<p>Assuming your data is kept in the following range A2:B16,</p>\n\n<p><a href=\"https://i.stack.imgur.com/xMoNO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xMoNO.png\" alt=\"enter image description here\"></a></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub KeepMyData()\n    Dim rngData As Range\n    Dim rngRow As Range\n    Dim valuesToKeep() As Integer\n    Dim iCounter As Integer\n    Dim blnKeep As Boolean\n\n    Set rngData = ThisWorkbook.Worksheets(1).Range(\"A2:B16\")\n\n'   Run through the loop to find the values to keep\n    For Each rngRow In rngData.Rows\n        If rngRow.Cells(1, 2) = \"yes\" Then\n            ReDim Preserve valuesToKeep(0 To iCounter)\n            valuesToKeep(iCounter) = rngRow.Cells(1, 1)\n            iCounter = iCounter + 1\n        End If\n    Next        \n\n'   Delete the unwanted values\n    For Each rngRow In rngData.Rows\n        blnKeep = False\n    '   Check if the current value is inside the values to keep\n        For iCounter = 0 To UBound(valuesToKeep)\n            If rngRow.Cells(1, 1).Value = valuesToKeep(iCounter) Then\n                blnKeep = True\n                Exit For\n            End If\n        Next\n        ' Use this if you want to delete the entire row\n        ' If Not blnKeep Then rngRow.Delete xlUp\n        ' Use this if you just want to clear the row\n        If Not blnKeep Then rngRow.Clear\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 59078812, "answer_count": 1, "score": 0, "last_activity_date": 1581877978, "creation_date": 1574886226, "last_edit_date": 1581792363, "question_id": 59077923, "link": "https://stackoverflow.com/questions/59077923/nested-loop-with-varying-number-of-iterations", "title": "Nested loop with varying number of iterations", "body": "<p>I have to loop through 1 to 5 to determine if I need to keep or delete the ID. </p>\n\n<p><a href=\"https://i.stack.imgur.com/zpbiI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zpbiI.png\" alt=\"enter image description here\"></a></p>\n\n<p>For example</p>\n\n<ul>\n<li>I loop through all the 1s, there are more than zero \"yes\" and I keep 1.</li>\n<li>Loop through all 2s, there's no \"yes\", so I delete both 2s.</li>\n<li>For the same reason, I keep all 3s, delete all 4s and keep all 5s.</li>\n</ul>\n\n<p>How do I set up these loops with different lengths?</p>\n\n<p>Below I used conditional formatting to highlight the first entry of each ID, but I'm not sure how to use it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ydlud.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ydlud.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 789, "user_id": 3705490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a39eg.gif?s=128&g=1", "display_name": "jimh", "link": "https://stackoverflow.com/users/3705490/jimh"}, "edited": false, "score": 0, "creation_date": 1574884850, "post_id": 59077262, "comment_id": 104392424, "body": "I would reformat this in markdown so the code you have contributed is a bit clearer with <code>code</code>"}, {"owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "edited": false, "score": 0, "creation_date": 1574905292, "post_id": 59077262, "comment_id": 104398090, "body": "From the above VBA script and the dropdown menu element, we don&#39;t know how the dropdown menu rendering and works, and not found the PartNo and SeriaNo elements. So, can you post the Enough code to reproduce the how the dropdown menu works as in <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1574967125, "post_id": 59077262, "comment_id": 104423410, "body": "you can FireEvent on mouse events or attach and dispatch an event. <a href=\"https://stackoverflow.com/a/56655037/6241235\">stackoverflow.com/a/56655037/6241235</a>"}], "owner": {"reputation": 1, "user_id": 12447893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021678678446d8a205cd3524e310ce33?s=128&d=identicon&r=PG&f=1", "display_name": "jdm", "link": "https://stackoverflow.com/users/12447893/jdm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574903295, "creation_date": 1574882941, "last_edit_date": 1574903295, "question_id": 59077262, "link": "https://stackoverflow.com/questions/59077262/excel-vba-control-of-internet-explorer-mouseover-drop-down", "title": "Excel VBA control of Internet Explorer Mouseover Drop Down", "body": "<p>I would appreciate some help with an Excel-based VBA tool. I'm trying to control a mouse-over dropdown menu in Internet Explorer, select a dropdown menu option, then fill input boxes with info from the Excel sheet. </p>\n\n<p>I've tried several methods offered in other question threads, but I can't seem to get it to work. I don't have access to SendKeys</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>Public Sub SN_Submit()\n\nDim table as HTMLTable\nDim IE As InternetExplorer\nDim objButton As Object\nSet IE = New InternetExplorerMedium\n\nIE.Navigate2 \"http://internal_company_website\"\nIE.Visible = True\n\nDo While IE.Busy\nDoEvents\nLoop\n\ndelay (1)\n\n******Here is where the dropdown portion of the code goes*****\nIE.document.getElementByID(\"PartNo\").Value = \"XX123\"\nIE.document.getElementByID(\"SerialNo\").Value = ThisWorkbook.Sheets(\"Sheet1\").Range(\"B3\")\n\ndelay (0.5)\n\nIE.Document.GetElementByID(\"Display\").Click\n</code></pre>\n\n<p>The dropdown menu element information is:\n<a href=\"https://i.stack.imgur.com/mqSBx.png\" rel=\"nofollow noreferrer\">Screenshot of Element</a></p>\n\n<p>Any help or direction would be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "edited": false, "score": 0, "creation_date": 1574883492, "post_id": 59077239, "comment_id": 104391841, "body": "That fixed the first error of the run time error but like i mentioned is it possible to convert the first value into the Number format rather than string format (It has preceding 00s) I&#39;m not sure of how to do it in vba unlike using a formula"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "edited": false, "score": 0, "creation_date": 1574883783, "post_id": 59077239, "comment_id": 104391979, "body": "A sneaky way to convert strings to numbers is to just add 0. So, range.value + 0 &amp; Range.Value + 0"}, {"owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "edited": false, "score": 0, "creation_date": 1574884554, "post_id": 59077239, "comment_id": 104392305, "body": "Many Thanks. I didn&#39;t know you could just add a 0 to it to convert it."}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 1, "last_activity_date": 1574882831, "creation_date": 1574882831, "answer_id": 59077239, "question_id": 59077168, "link": "https://stackoverflow.com/questions/59077168/merge-two-cells-into-one-with-vba/59077239#59077239", "title": "Merge two Cells into One with VBA", "body": "<p>You are using <code>Range.Cell.Value</code> when you should just be using <code>Range.Value</code></p>\n\n<pre><code>HSheet.Range(\"I\" &amp; J).Value = HSheet.Range(\"C\" &amp; J).Value &amp; HSheet.Range(\"D\" &amp; J).Value\n</code></pre>\n"}], "owner": {"reputation": 364, "user_id": 7100546, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-JXxsxGIx0pU/AAAAAAAAAAI/AAAAAAAAARI/JZZmtI_KRvw/photo.jpg?sz=128", "display_name": "Robert Farmer", "link": "https://stackoverflow.com/users/7100546/robert-farmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 59077239, "answer_count": 1, "score": 0, "last_activity_date": 1574882831, "creation_date": 1574882454, "question_id": 59077168, "link": "https://stackoverflow.com/questions/59077168/merge-two-cells-into-one-with-vba", "title": "Merge two Cells into One with VBA", "body": "<p>I have an excel that I'm trying to make helper columns with for comparisons and searches made up of two cells in the same row. \nThe Main Error I have with doing this is a Run-time error '438': Object doesn't support this property or method.\nThe Second Error I know will be present is that Cell 3 is in string format and has Prefixed 0s. I was able to remove them with a formula by changing the Number Format to \"Number\" before concatenating but I'm unsure how to do that in a Macro. </p>\n\n<p>I know if I was to do it manually in excel as a formula it would look like this: <code>=CONCAT(NUMBERVALUE(C#),D#)</code></p>\n\n<pre><code>hrow = HSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\nFor J = 2 To hrow\n    HSheet.Range(\"F\" &amp; J) = Application.VLookup(HSheet.Range(\"D\" &amp; J), PP.Range(\"D2:L\" &amp; lastrow), 9, False)\n    HSheet.Range(\"I\" &amp; J).Cell.Value = HSheet.Range(\"C\" &amp; J).Cell.Value &amp; HSheet.Range(\"D\" &amp; J).Cell.Value\nNext J\n</code></pre>\n\n<p>An Example of the data in my Cells in case it matters: </p>\n\n<pre><code>Cell C   |  Cell D  |    Cell I   |\n 0032    | AB975050 |  32AB975050 |\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574882534, "post_id": 59077157, "comment_id": 104391431, "body": "Why not use <code>dateString</code> as a date? You will either need to convert the string to date or date to string to compare which seems like unnecessary work when you could just use the logical variable types here (<i>assuming it&#39;s logical given lack of context</i>)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 1, "creation_date": 1574882645, "post_id": 59077157, "comment_id": 104391466, "body": "Also, you don&#39;t use <code>Set theDate = Format(....</code> since it&#39;s not an object. You assign the value the same way you would a string (as you have done for <code>dateString</code>)"}, {"owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1574885059, "post_id": 59077157, "comment_id": 104392502, "body": "Ive been getting a type mismatch. I am not sure if this matters but the dateString was actually being set to a sheet.name which would return a date in a string format. Anyhow, I went with the below answer by @MRah which works. Thanks for the timely response."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 0, "last_activity_date": 1574883201, "creation_date": 1574883201, "answer_id": 59077337, "question_id": 59077157, "link": "https://stackoverflow.com/questions/59077157/my-date-object-is-not-compiling-in-my-subroutine/59077337#59077337", "title": "My Date Object is not compiling in my Subroutine", "body": "<p>You use <code>Set</code> for objects and your variable is actually a date - thus no object exists to set. In short, remove <code>Set</code> from this line</p>\n\n<pre><code>theDate = format(CDate(dateString, \"mm/dd/yyyy\"))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 890, "user_id": 9085446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QTMxB.png?s=128&g=1", "display_name": "MRah", "link": "https://stackoverflow.com/users/9085446/mrah"}, "is_accepted": true, "score": 1, "last_activity_date": 1574883925, "creation_date": 1574883925, "answer_id": 59077485, "question_id": 59077157, "link": "https://stackoverflow.com/questions/59077157/my-date-object-is-not-compiling-in-my-subroutine/59077485#59077485", "title": "My Date Object is not compiling in my Subroutine", "body": "<p>Issue 1: Date is not an Object in VBA. Just remove Set before theDate,</p>\n\n<p>Issue 2: the format for the dateString is not a standard date format. The following code is one way to resolve this issue.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub External_Number()\r\n  Dim exBreak As String\r\n  Dim theDate As Date\r\n  Dim dateString As String    \r\n  Dim iMonth as Integer\r\n  Dim iDay as Integer\r\n  Dim iYear as Integer\r\n  Dim splitDate() as String\r\n\r\n  dateString = \"11.24.19\"\r\n  splitDate = Split(dateString, \".\")\r\n\r\n  iMonth = CInt(splitDate(0))\r\n  iDay = CInt(splitDate(1))\r\n\r\n  ' Please note that year will return only 19 and not 2019\r\n  iYear = CInt(splitDate(2))\r\n\r\n\r\n  ' theDate = format(CDate(dateString, \"mm/dd/yyyy\"))\r\n  If iMonth = Month(Date) Then\r\n  '...........Blah Blah Blah\r\n  Else\r\n  exNum = 1\r\n  End If\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 110, "user_id": 8676713, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/95724206c280d2070460f995332e8788?s=128&d=identicon&r=PG&f=1", "display_name": "yossup", "link": "https://stackoverflow.com/users/8676713/yossup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 59077485, "answer_count": 2, "score": 0, "last_activity_date": 1574900239, "creation_date": 1574882421, "last_edit_date": 1574900239, "question_id": 59077157, "link": "https://stackoverflow.com/questions/59077157/my-date-object-is-not-compiling-in-my-subroutine", "title": "My Date Object is not compiling in my Subroutine", "body": "<p>I am attempting to compare today's month(date) with a string in the format of month(\"mm.dd.yyyy\")\nIn my case:</p>\n\n<pre><code>Sub External_Number()\nDim exBreak As String\nDim theDate As Date\nDim dateString As String    \n\ndateString = \"11.24.19\"\nset theDate = format(CDate(dateString, \"mm/dd/yyyy\"))\nIf Month(theDate) = Month(Date) Then\n'...........Blah Blah Blah\nElse\nexNum = 1\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I am getting a object required error on the \"set theDate\" line.</p>\n"}, {"tags": ["sql", "excel", "vba", "connection", "excel-tables"], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 9085446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QTMxB.png?s=128&g=1", "display_name": "MRah", "link": "https://stackoverflow.com/users/9085446/mrah"}, "is_accepted": false, "score": 0, "last_activity_date": 1574886421, "creation_date": 1574886421, "answer_id": 59077959, "question_id": 59076665, "link": "https://stackoverflow.com/questions/59076665/refresh-all-does-refresh-the-connections-but-doesnt-refresh-the-tables/59077959#59077959", "title": "Refresh all does refresh the connections but doesn&#39;t refresh the tables", "body": "<p>You should access the connections through Workbook. Example,</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Sub Test()\r\n    Dim con As WorkbookConnection\r\n  \r\n    For Each con In ThisWorkbook.Connections\r\n    ' Your Conditions, for example, check connection name etc. \r\n    ' If con.Name = \"MyConnection\" Then\r\n        con.Refresh\r\n    ' Else \r\n    ' Do your thing\r\n    ' End if\r\n    Next\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1, "user_id": 12447772, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Qtpt2qMZdsU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdbgFgVEGuwKX_3ehYXGC00R4JElQ/photo.jpg?sz=128", "display_name": "user12447772", "link": "https://stackoverflow.com/users/12447772/user12447772"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574917573, "creation_date": 1574880218, "last_edit_date": 1574917573, "question_id": 59076665, "link": "https://stackoverflow.com/questions/59076665/refresh-all-does-refresh-the-connections-but-doesnt-refresh-the-tables", "title": "Refresh all does refresh the connections but doesn&#39;t refresh the tables", "body": "<p>I have three tables which pull data from SQL database.</p>\n\n<p>When I click refresh all from the data menu, the connections refresh but only sum of the tables are refreshed.</p>\n\n<p>When I right-click>refresh the tables themselves, they reflect the correct information (telling me that the connection was refreshed indeed).</p>\n\n<p>I tried <code>ActiveBook.RefreshAll</code> and the following code too:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim wks As Worksheet\nDim qt As QueryTable\n\nFor Each wks In Worksheets\n    For Each qt In wks.QueryTables\n        qt.Refresh BackgroundQuery:=False\n    Next qt\n\nNext wks\n\nSet qt = Nothing\n</code></pre>\n\n<p>How can I refresh the table using VBA code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574879849, "post_id": 59076524, "comment_id": 104390385, "body": "What have you done to that code to attempt to alter for your needs?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574880091, "post_id": 59076524, "comment_id": 104390478, "body": "Here is one that does the whole row: <a href=\"https://stackoverflow.com/questions/42425208/vba-split-cell-values-into-multiple-rows-and-keep-other-data\" title=\"vba split cell values into multiple rows and keep other data\">stackoverflow.com/questions/42425208/&hellip;</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574880208, "post_id": 59076524, "comment_id": 104390526, "body": "I&#39;m thinking this should be very doable through Power Query? Not tested."}, {"owner": {"reputation": 295, "user_id": 716255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4057228c332e51257f3041ab597c7c73?s=128&d=identicon&r=PG", "display_name": "user716255", "link": "https://stackoverflow.com/users/716255/user716255"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1574881045, "post_id": 59076524, "comment_id": 104390854, "body": "@ScottCraner I tried this      Lstrw = Cells(Rows.Count, &quot;F&quot;).End(xlUp).Row Set rng = Range(&quot;A2:F&quot; &amp; Lstrw)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574881212, "post_id": 59076524, "comment_id": 104390922, "body": "Please <a href=\"https://stackoverflow.com/posts/59076524/edit\">edit</a> your question to include the code and explain where it fails.  Comments should not be used for code."}], "answers": [{"tags": [], "owner": {"reputation": 295, "user_id": 716255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4057228c332e51257f3041ab597c7c73?s=128&d=identicon&r=PG", "display_name": "user716255", "link": "https://stackoverflow.com/users/716255/user716255"}, "is_accepted": false, "score": 0, "last_activity_date": 1575305169, "last_edit_date": 1575305169, "creation_date": 1574882035, "answer_id": 59077080, "question_id": 59076524, "link": "https://stackoverflow.com/questions/59076524/how-to-split-a-single-cell-into-multiple-rows/59077080#59077080", "title": "How to split a single cell into multiple rows?", "body": "<p>Modified the code on this post. It generated the solution I wanted.\n<a href=\"https://stackoverflow.com/questions/42425208/vba-split-cell-values-into-multiple-rows-and-keep-other-data\">VBA: Split cell values into multiple rows and keep other data</a></p>\n\n<pre><code>Sub splitByColF()\n    Dim r As Range, i As Long, ar\n    Set r = Worksheets(\"Sheet1\").Range(\"F999999\").End(xlUp)\n    Do While r.Row &gt; 1\n        ar = Split(r.Value, Chr(10))\n        If UBound(ar) &gt;= 0 Then r.Value = ar(0)\n        For i = UBound(ar) To 1 Step -1\n            r.EntireRow.Copy\n            r.Offset(1).EntireRow.Insert\n            r.Offset(1).Value = ar(i)\n        Next\n        Set r = r.Offset(-1)\n    Loop\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 295, "user_id": 716255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4057228c332e51257f3041ab597c7c73?s=128&d=identicon&r=PG", "display_name": "user716255", "link": "https://stackoverflow.com/users/716255/user716255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 566, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1583099446, "creation_date": 1574879507, "last_edit_date": 1583099446, "question_id": 59076524, "link": "https://stackoverflow.com/questions/59076524/how-to-split-a-single-cell-into-multiple-rows", "title": "How to split a single cell into multiple rows?", "body": "<p>I have a table that has six columns.  I would like the integer values in one single cell (F2) to be separated into multiple rows. </p>\n\n<p>Additionally, I need the rows from A-E to be associated with integer.</p>\n\n<p>I found a <a href=\"https://stackoverflow.com/questions/35439099/how-to-split-a-single-cell-into-multiple-rows-and-add-another-row\">post</a> akin to what I need, but it only works if you have two columns.</p>\n\n<p><a href=\"https://i.stack.imgur.com/LtTs2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LtTs2.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code I have been trying to run </p>\n\n<pre><code>Sub ChickatAH()\n    Dim rng As Range, Lstrw As Long, c As Range\n    Dim SpltRng As Range\n    Dim i As Integer\n    Dim Orig As Variant\n    Dim txt As String\n\n    Lstrw = Cells(Rows.Count, \"F\").End(xlUp).Row\n    Set rng = Range(\"A2:F\" &amp; Lstrw)\n\n    For Each cell In rng.Cells\n        Set SpltRng = cell.Offset(, 1)\n        txt = SpltRng.Value\n        Orig = Split(txt, Chr(10))\n    For i = 0 To UBound(Orig)\n        Cells(Rows.Count, \"H\").End(xlUp).Offset(1) = cell\n        Cells(Rows.Count, \"H\").End(xlUp).Offset(, 1) = Orig(i)\n    Next i\nNext cell\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1574894316, "post_id": 59076289, "comment_id": 104395837, "body": "Set a breakpoint at beginning of procedure and step debug. Make sure variables get values."}, {"owner": {"reputation": 5, "user_id": 12417590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390fa591a06c9fbd8938ecf82ff30335?s=128&d=identicon&r=PG&f=1", "display_name": "allendk", "link": "https://stackoverflow.com/users/12417590/allendk"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1574898473, "post_id": 59076289, "comment_id": 104396854, "body": "Would you recommend putting the breakpoint on the first toaddress = , line, and then hitting Shift+F8 by making it step through the lines?"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1574898605, "post_id": 59076289, "comment_id": 104396882, "body": "That&#39;s fine for breakpoint. Run function as normal - wherever it is called from - then progress one line at a time."}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 12417590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390fa591a06c9fbd8938ecf82ff30335?s=128&d=identicon&r=PG&f=1", "display_name": "allendk", "link": "https://stackoverflow.com/users/12417590/allendk"}, "is_accepted": false, "score": 0, "last_activity_date": 1574967307, "creation_date": 1574967307, "answer_id": 59094866, "question_id": 59076289, "link": "https://stackoverflow.com/questions/59076289/receiving-run-time-error-2293-microsoft-access-cant-send-this-e-mail-messag/59094866#59094866", "title": "Receiving &quot;Run-time error &#39;2293&#39;: Microsoft Access can&#39;t send this e-mail message&quot; after having no issues", "body": "<p>The email buttons now work after closing out the database and re-opening it. Still no clue why it gave me run-time errors before. If it happens again, I'll be back to add more insight.</p>\n"}, {"tags": [], "owner": {"reputation": 16, "user_id": 12545707, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AE1dVqV6C0E/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdAKL76rCQJYuUsh-7gc4SX9awCeA/photo.jpg?sz=128", "display_name": "Susan M", "link": "https://stackoverflow.com/users/12545707/susan-m"}, "is_accepted": true, "score": 0, "last_activity_date": 1576501610, "creation_date": 1576501610, "answer_id": 59357252, "question_id": 59076289, "link": "https://stackoverflow.com/questions/59076289/receiving-run-time-error-2293-microsoft-access-cant-send-this-e-mail-messag/59357252#59357252", "title": "Receiving &quot;Run-time error &#39;2293&#39;: Microsoft Access can&#39;t send this e-mail message&quot; after having no issues", "body": "<p>Anytime i get this error, it has nothing to do with the the database or the code, it is simply due to the fact that i have an outlook item open that is currently gettin edited that i have forgotten about.<br>\nAccess cannot create a new Outlook item while there is currently an Outlook item open in edit mode.\nClose down any Outlook items open in edit mode and try again.</p>\n"}], "owner": {"reputation": 5, "user_id": 12417590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/390fa591a06c9fbd8938ecf82ff30335?s=128&d=identicon&r=PG&f=1", "display_name": "allendk", "link": "https://stackoverflow.com/users/12417590/allendk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 59357252, "answer_count": 2, "score": 0, "last_activity_date": 1594233896, "creation_date": 1574878627, "last_edit_date": 1594233896, "question_id": 59076289, "link": "https://stackoverflow.com/questions/59076289/receiving-run-time-error-2293-microsoft-access-cant-send-this-e-mail-messag", "title": "Receiving &quot;Run-time error &#39;2293&#39;: Microsoft Access can&#39;t send this e-mail message&quot; after having no issues", "body": "<p>I have a button on an Access form that queues up an email and is linked to several fields on the form. Yesterday and this morning the button was working without issue. I have not changed the underlying code or any of the fields in the form, but suddenly the button is returning a <code>Run-time error '2293': Microsoft Access can't send this e-mail message</code> error message when I click it. An example of the code is as follows:</p>\n\n<pre><code>Private Sub cmd_Button_Click()\n\nDim toaddress As String\nDim ccaddress As String\nDim subject   As String\nDim message As String\n\ntoaddress = AddMailAddress(toaddress, Nz(Me.cmb_ProjectLead.Column(1), \"\"))\ntoaddress = AddMailAddress(toaddress, Nz(Me.cmb_ProjectLead2.Column(1), \"\"))\nccaddress = AddMailAddress(ccaddress, Nz(Me.cmb_OtherPOC.Column(1), \"\"))\nccaddress = AddMailAddress(ccaddress, Nz(Me.cmb_OtherPOC2.Column(1), \"\"))\n\nsubject = \"text\" &amp; me.txb_ProjectName\nmessage = \"text\" &amp; me.txb_ProjectName &amp; vbnewline &amp; me.txb_ProjectLocation &amp; vbnewline &amp; me.txb_ProjectDescription\n\nDoCmd.SendObject acSendNoObject, , , toaddress, ccaddress, , subject, message, True\n\nEnd Sub\n</code></pre>\n\n<p>When I click \"debug\" on the error message, the line <code>DoCmd.SendObject acSendNoObject, , , toaddress, ccaddress, , subject, message, True</code> is highlighted yellow with a yellow arrow pointed to it.</p>\n\n<p>A few notes that may be helpful:\nI'm working on a work issued computer and I have no Admin rights, so changing certain properties are not possible.\nI have to use a VPN which has pretty strict security standards.\nTo reiterate, this worked up until today. In fact for the same record, it worked one moment, and then 30 seconds later did not work.</p>\n\n<p>*Update: the command worked when I stripped everything except the sendobject line and replaced the values with text, i.e. </p>\n\n<pre><code>Private Sub cmd_Button_Click()\nDoCmd.SendObject acSendNoObject, , , \"toaddress\", \"ccaddress\", , \"subject\", \"message\", True\nEnd Sub\n</code></pre>\n\n<p>When I added just the <code>toaddress</code> and <code>ccaddress</code> back in, I got the 2293 error message.</p>\n\n<p>*Additional info that may help: This form has several \"Email To\" buttons as well as some \"Send Outlook Apppointment To\" buttons. They all also worked fine up until this morning, but are now generating various error messages when clicked. They all use the same <code>toaddress, ccaddress, subject, message,</code> etc format as my example here. </p>\n\n<p>The public function that is also linked to these commands is as follows:</p>\n\n<pre><code>Public Function AddMailAddress(address As String, newaddress As String)\n\n    If (address = \"\") And (newaddress = \"\") Then\n        Exit Function\n    End If\n\n    If address = \"\" Then\n        address = newaddress\n    Else\n\n        If Not newaddress = \"\" Then\n            If VBA.Right(address, 1) = \";\" Then\n                address = address &amp; newaddress\n            Else\n                address = address &amp; \";\" &amp; newaddress\n            End If\n        End If\n    End If\n\n\n    AddMailAddress = address\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 623, "user_id": 7299245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2370b2102321fe7fc9d42e540bad7f71?s=128&d=identicon&r=PG&f=1", "display_name": "ozo", "link": "https://stackoverflow.com/users/7299245/ozo"}, "edited": false, "score": 1, "creation_date": 1574878536, "post_id": 59076162, "comment_id": 104389788, "body": "works perfect, thank you very much. Is there any way to copy omitting the first 3 rows? because these do not contain important information (The filter being applied, a blank space, etc.)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 623, "user_id": 7299245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2370b2102321fe7fc9d42e540bad7f71?s=128&d=identicon&r=PG&f=1", "display_name": "ozo", "link": "https://stackoverflow.com/users/7299245/ozo"}, "edited": false, "score": 0, "creation_date": 1574883738, "post_id": 59076162, "comment_id": 104391954, "body": "Think the simplest way would be to delete the first 3 rows after pasting - see edit above."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 623, "user_id": 7299245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2370b2102321fe7fc9d42e540bad7f71?s=128&d=identicon&r=PG&f=1", "display_name": "ozo", "link": "https://stackoverflow.com/users/7299245/ozo"}, "edited": false, "score": 0, "creation_date": 1574885742, "post_id": 59076162, "comment_id": 104392768, "body": "Possibly not strictly needed, but as it suggests move rows below up (as opposed to left, which couldn&#39;t actually happen in this case!)"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1574883727, "last_edit_date": 1574883727, "creation_date": 1574878152, "answer_id": 59076162, "question_id": 59076093, "link": "https://stackoverflow.com/questions/59076093/how-to-copy-the-values-of-the-first-and-last-column-of-a-pivot-table/59076162#59076162", "title": "How to copy the values of the first and last column of a pivot table?", "body": "<p>Try this. You'd broken the back of it, just need to reference the two columns appropriately.</p>\n\n<pre><code>Sub Pivotcopy()\n\nDim pt As PivotTable\nSet pt = ActiveSheet.PivotTables(\"pivottable2\")\n\nWith pt.TableRange2\n    Union(.Columns(1), .Columns(.Columns.Count)).Copy\nEnd With\n\nWith Sheets(\"newsheet\").Range(\"A20\")\n   .PasteSpecial xlPasteValues\n   .Resize(3).EntireRow.Delete shift:=xlUp\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 623, "user_id": 7299245, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2370b2102321fe7fc9d42e540bad7f71?s=128&d=identicon&r=PG&f=1", "display_name": "ozo", "link": "https://stackoverflow.com/users/7299245/ozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 59076162, "answer_count": 1, "score": 0, "last_activity_date": 1574884846, "creation_date": 1574877933, "last_edit_date": 1574884846, "question_id": 59076093, "link": "https://stackoverflow.com/questions/59076093/how-to-copy-the-values-of-the-first-and-last-column-of-a-pivot-table", "title": "How to copy the values of the first and last column of a pivot table?", "body": "<p>I currently have code to copy the values from the pivot table and paste them onto a sheet:</p>\n\n<p>the summary code is:</p>\n\n<pre><code>Sub Pivotcopy()\n\n    Dim pt As PivotTable\n    Set pt = ActiveSheet.PivotTables(\"pivottable2\")\n    .\n    .\n    .\n    pt.TableRange2.Copy    \n    Sheets(\"newsheet\").Range(\"A20\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>However, this copies all the values. What I want is to copy only the first and last columns of the pivot table, i.e. the row labels column and the grand total column. After that I want to paste it in the \"newsheet\" sheet.</p>\n"}, {"tags": ["vba", "outlook", "attachment"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12447202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61953bd82bb1f1e97be8893a201340?s=128&d=identicon&r=PG&f=1", "display_name": "OLLI_S", "link": "https://stackoverflow.com/users/12447202/olli-s"}, "edited": false, "score": 0, "creation_date": 1574927061, "post_id": 59077191, "comment_id": 104403767, "body": "Thank you, Sam, your code works perfectly. I tested it with 20 different mails, will continue to test it more deeper."}, {"owner": {"reputation": 25, "user_id": 12447202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61953bd82bb1f1e97be8893a201340?s=128&d=identicon&r=PG&f=1", "display_name": "OLLI_S", "link": "https://stackoverflow.com/users/12447202/olli-s"}, "edited": false, "score": 0, "creation_date": 1575271579, "post_id": 59077191, "comment_id": 104496169, "body": "I tested your function, it is working great, @Sam. But for KeePass Databases (Filename.kdbx) it reports that it is embedded.  Now I could call your function only for image-files (what other files can be embedded?) or I don&#39;t call it for .kdbx files. What is the better way?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 25, "user_id": 12447202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61953bd82bb1f1e97be8893a201340?s=128&d=identicon&r=PG&f=1", "display_name": "OLLI_S", "link": "https://stackoverflow.com/users/12447202/olli-s"}, "edited": false, "score": 1, "creation_date": 1575279234, "post_id": 59077191, "comment_id": 104499292, "body": "I don&#39;t know. If the KeePass mails are generated from something not Outlook, I would suspect that they aren&#39;t properly created, making them a bit of a exception. On the other hand - I can see three cases: 1) Embedded image 2) Attached image 3) Other attachment. Cases outside this are probably quite few and can be squeezed into #3 without too much hazzle."}, {"owner": {"reputation": 25, "user_id": 12447202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61953bd82bb1f1e97be8893a201340?s=128&d=identicon&r=PG&f=1", "display_name": "OLLI_S", "link": "https://stackoverflow.com/users/12447202/olli-s"}, "edited": false, "score": 0, "creation_date": 1575284731, "post_id": 59077191, "comment_id": 104502221, "body": "The KeePass Database (.kdbx) is sent via Outlook.com (I send my KeePass database from home to work by email). So I will call your function only if the file is an image file (.bmp, .jpg, .jpeg, .gif, .png, .tif, .eps, .ps, .svg, .swf, .wmf). For all other files I assume it is attached to the email."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1574882584, "creation_date": 1574882584, "answer_id": 59077191, "question_id": 59075501, "link": "https://stackoverflow.com/questions/59075501/find-out-if-an-attachment-is-embedded-or-attached/59077191#59077191", "title": "Find out if an attachment is embedded or attached", "body": "<p>I'm not sure if this is a solution that is valid in all cases, but it works in my environment. That means \"test it properly\".</p>\n\n<pre><code>Const PR_ATTACH_CONTENT_ID = \"http://schemas.microsoft.com/mapi/proptag/0x3712001F\"\n\nFunction IsEmbedded(Att As Attachment) As Boolean\n    Dim PropAccessor As PropertyAccessor\n    Set PropAccessor = Att.PropertyAccessor\n    IsEmbedded = (PropAccessor.GetProperty(PR_ATTACH_CONTENT_ID) &lt;&gt; \"\")\nEnd Function\n</code></pre>\n\n<p>Call it with</p>\n\n<pre><code>If IsEmbedded(myAttachments(lngAttachmentCount)) Then\n    ...\nEnd If\n</code></pre>\n\n<p>The cryptic url-looking constant is not a url, but a property identifier. You can find a list of them here: <a href=\"https://interoperability.blob.core.windows.net/files/MS-OXPROPS/%5bMS-OXPROPS%5d.pdf\" rel=\"nofollow noreferrer\">https://interoperability.blob.core.windows.net/files/MS-OXPROPS/%5bMS-OXPROPS%5d.pdf</a>  </p>\n\n<p>That property is set to the url of the attachment if embedded. If not embedded, then it is empty.</p>\n"}], "owner": {"reputation": 25, "user_id": 12447202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b61953bd82bb1f1e97be8893a201340?s=128&d=identicon&r=PG&f=1", "display_name": "OLLI_S", "link": "https://stackoverflow.com/users/12447202/olli-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 745, "favorite_count": 1, "accepted_answer_id": 59077191, "answer_count": 1, "score": 1, "last_activity_date": 1578029573, "creation_date": 1574875536, "last_edit_date": 1578029573, "question_id": 59075501, "link": "https://stackoverflow.com/questions/59075501/find-out-if-an-attachment-is-embedded-or-attached", "title": "Find out if an attachment is embedded or attached", "body": "<p>I am coding a small VBA to show all attachments of an email in a list box.</p>\n\n<p>The user can select attachments that should be removed from the email and stored on a target folder.</p>\n\n<p>I am also adding a HTML file to the email that contains a list of all removed files (including a link to each file to the target folder).</p>\n\n<p>I have a problem with images, because they can be</p>\n\n<ul>\n<li>Attached as a normal file to the email</li>\n<li>Embedded to the email body (like a company logo in the signature)</li>\n</ul>\n\n<p>I want to show in my list box only those images, that are attached as files to the email.</p>\n\n<p>Embedded mails should be ignored.</p>\n\n<pre><code>Sub SaveAttachment()\n\n    Dim myAttachments           As Outlook.Attachments\n    Dim olMailItem              As Outlook.MailItem\n    Dim lngAttachmentCount      As Long\n    Dim Attachment_Filename     As String\n\n    Select Case True\n\n        Case TypeOf Application.ActiveWindow Is Outlook.Inspector\n            Set olMailItem = Application.ActiveInspector.CurrentItem\n        Case Else\n\n        With Application.ActiveExplorer.Selection\n            If .Count Then Set olMailItem = .Item(1)\n        End With\n\n        If olMailItem Is Nothing Then Exit Sub\n\n    End Select\n\n    Set myAttachments = olMailItem.Attachments\n\n    If myAttachments.Count &gt; 0 Then\n\n        For lngAttachmentCount = myAttachments.Count To 1 Step -1\n\n            '-------------------------------------------------------------------------\n            ' Add the attachment to the list of attachments (form)\n            '-------------------------------------------------------------------------\n            Attachment_Filename = myAttachments(lngAttachmentCount).FileName\n\n            With UserForm1.lstAttachments\n\n                .AddItem (Attachment_Filename)\n                .List(lngAttachmentListPos, 1) = Attachment_Type_Text\n                .List(lngAttachmentListPos, 2) = FormatSize(myAttachments(lngAttachmentCount).Size) &amp; \" KB\"\n\n            End With\n\n        Next lngAttachmentCount\n\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I added only the relevant parts of the code, so I hope I have not forgotten anything.</p>\n\n<p>At the moment I show all attachments (also embedded images).</p>\n\n<p>How would I find out if an attachment is embedded?</p>\n\n<p>I found a possible solution here:\n<a href=\"https://stackoverflow.com/questions/12310925/distinguish-visible-and-invisible-attachments-with-outlook-vba\">Distinguish visible and invisible attachments with Outlook VBA</a><br>\nThe source code provided is not working, it seems like the two URLs in line 2 and 3 no longer exist.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574875915, "post_id": 59075495, "comment_id": 104388614, "body": "You&#39;ll have to think about what exactly you want to color. Right now it&#39;s in mid air. Assign it to a Range object instead. Also there are smarter ways to test if a value exists inside another range than a loop. That will at least safe you the second loop."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574875958, "post_id": 59075495, "comment_id": 104388631, "body": "<code>Interior.ColorIndex</code> is a property of a range object, which is missing here."}, {"owner": {"reputation": 17, "user_id": 11363880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bec04d04996f6f5e9e72b2332c5a1f69?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11363880/mark"}, "edited": false, "score": 0, "creation_date": 1574877427, "post_id": 59075495, "comment_id": 104389307, "body": "I changed the code but it is filling all the cells green if they match or not."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574877791, "post_id": 59075495, "comment_id": 104389476, "body": "Think about the logic of what you&#39;re doing. Every time a cell in E doesn&#39;t match one in A it will be shaded. You need to better describe what you&#39;re trying to do."}, {"owner": {"reputation": 17, "user_id": 11363880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bec04d04996f6f5e9e72b2332c5a1f69?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11363880/mark"}, "edited": false, "score": 0, "creation_date": 1574878168, "post_id": 59075495, "comment_id": 104389636, "body": "The actual column letters do not matter, I want to be able to interchange those but the goal is to lope through the columns and if the cells do not match highlight those.  Right now it is highlighting them all if they match or not."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1574878484, "post_id": 59075495, "comment_id": 104389768, "body": "One observation is <code>Dim DerLigA, DerLigB  As Long, i, j As Long</code> isnt doing what you think it is.  Right now its defining DerLigA as a variant.  Change it to <code>Dim DerLigA As Long, DerLigB  As Long, i As Long, j As Long</code>"}, {"owner": {"reputation": 17, "user_id": 11363880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bec04d04996f6f5e9e72b2332c5a1f69?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11363880/mark"}, "edited": false, "score": 0, "creation_date": 1574880932, "post_id": 59075495, "comment_id": 104390819, "body": "Okay fixed the variables and I am still getting all the cells in column E highlighted even if they are different from column A.  Man this is frustrating I am not a coder but this can&#39;t be that hard I just want to compare two columns not next to each other and highlight the ones that do not match."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 0, "creation_date": 1574883884, "post_id": 59075495, "comment_id": 104392021, "body": "Is the requirement to compare (A2) to (E2)? and (A3) to (E3)? etc?  If so, then loose subscript &quot;i&quot; and make everything &quot;j&quot;. .. ..  OR.. .. Is the requirement to also compare (A2) to (E3),  and (A2) to (E4), .....  which is what is happening now??"}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1574884892, "creation_date": 1574884892, "answer_id": 59077690, "question_id": 59075495, "link": "https://stackoverflow.com/questions/59075495/compare-two-columns-and-highlight-any-difference/59077690#59077690", "title": "Compare two columns and highlight any difference", "body": "<p>If you change <code>If .Range(\"A\" &amp; i) = .Range(\"E\" &amp; j) Then</code> to <code>If .Range(\"A\" &amp; i) &lt;&gt; .Range(\"E\" &amp; j) Then</code> as per your statement you want to test if the values in the cells don't match;  Currently your code is looking to see if the values in the cells match.</p>\n\n<pre><code>Sub ColumnCompare()\n\nDim DerLigA As Long, DerLigB As Long, i As Long, j As Long\n\n\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Sheet1\")\n\n    DerLigA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    DerLigB = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n\n\n    For i = 2 To DerLigA\n        For j = 2 To DerLigB\n            If .Range(\"A\" &amp; i) &lt;&gt; .Range(\"E\" &amp; j) Then\n                .Range(\"E\" &amp; j).Interior.ColorIndex = 4\n            End If\n        Next j\n    Next i\nEnd With\n\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11363880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bec04d04996f6f5e9e72b2332c5a1f69?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11363880/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1579632046, "creation_date": 1574875505, "last_edit_date": 1579632046, "question_id": 59075495, "link": "https://stackoverflow.com/questions/59075495/compare-two-columns-and-highlight-any-difference", "title": "Compare two columns and highlight any difference", "body": "<p>I am trying to compare two columns and highlight any differences.</p>\n\n<p>The columns are not next to each other.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ColumnCompare()\n\nDim DerLigA As Long, DerLigB As Long, i As Long, j As Long\n\nApplication.ScreenUpdating = False\n\nWith Sheets(\"Sheet1\")\n\n    DerLigA = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    DerLigB = .Cells(.Rows.Count, \"E\").End(xlUp).Row\n\n    For i = 2 To DerLigA\n        For j = 2 To DerLigB\n            If .Range(\"A\" &amp; i) = .Range(\"E\" &amp; j) Then\n                .Range(\"E\" &amp; j).Interior.ColorIndex = 4\n            End If\n        Next j\n    Next i\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1574877143, "post_id": 59075415, "comment_id": 104389166, "body": "&quot;It doesn&#39;t work&quot; is not helpful - please elaborate."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1574877563, "post_id": 59075415, "comment_id": 104389372, "body": "Your code doesn&#39;t actually do any formatting either."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1574877800, "post_id": 59075415, "comment_id": 104389480, "body": "And since your vba code is setting up conditional formatting, I don&#39;t understand why you can&#39;t just use conditional formatting."}, {"owner": {"reputation": 1, "user_id": 12447186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3p2wDm9UH7z54bWjdwgM2wxqsQ9UaAOIJaBg18w=k-s128", "display_name": "Dani Mika", "link": "https://stackoverflow.com/users/12447186/dani-mika"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1574880890, "post_id": 59075415, "comment_id": 104390803, "body": "@RonRosenfeld it&#39;s because I&#39;m not the one who runs the code. It&#39;s for a different person in my company who doesn&#39;t know how to do it. So I did this macro to help him.  He&#39;s been using the macro for a while but he keeps forgeting to format it by himself so I wanted to change it so it would format itself."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12447186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3p2wDm9UH7z54bWjdwgM2wxqsQ9UaAOIJaBg18w=k-s128", "display_name": "Dani Mika", "link": "https://stackoverflow.com/users/12447186/dani-mika"}, "edited": false, "score": 0, "creation_date": 1574879864, "post_id": 59076119, "comment_id": 104390390, "body": "But it&#39;s not a fixed worksheet...   The person who uses it export it from a plataform he uses and uses a macro to find the clients he needs and then he writes out the reasons, so the macro itself its in the personal.xlsb."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1, "user_id": 12447186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3p2wDm9UH7z54bWjdwgM2wxqsQ9UaAOIJaBg18w=k-s128", "display_name": "Dani Mika", "link": "https://stackoverflow.com/users/12447186/dani-mika"}, "edited": false, "score": 0, "creation_date": 1574880953, "post_id": 59076119, "comment_id": 104390826, "body": "@DaniMika All you have to do is place this code in what ever worksheet that the person is adding the reasons to."}, {"owner": {"reputation": 1, "user_id": 12447186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3p2wDm9UH7z54bWjdwgM2wxqsQ9UaAOIJaBg18w=k-s128", "display_name": "Dani Mika", "link": "https://stackoverflow.com/users/12447186/dani-mika"}, "edited": false, "score": 0, "creation_date": 1574881524, "post_id": 59076119, "comment_id": 104391051, "body": "But then I would have to do it everyday, right? This person works in a diferent area in my company. He can&#39;t use excel much so I did this to help him. Now he highlights the row by himself, or at least he should. But he keeps forgeting to do it so I wanted to make it a part of the macro itself."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 1, "user_id": 12447186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3p2wDm9UH7z54bWjdwgM2wxqsQ9UaAOIJaBg18w=k-s128", "display_name": "Dani Mika", "link": "https://stackoverflow.com/users/12447186/dani-mika"}, "edited": false, "score": 0, "creation_date": 1574887695, "post_id": 59076119, "comment_id": 104393522, "body": "@DaniMika What I would do is create a blank workbook that the user only has to place on his desktop. When he opens the file it will import the data from the platform. The user then can modify and add the reasons, and as he adds the reasons in column 5, this macro placed in the worksheet will color the row automatically. Then using a button the worksheet can be saved as a new non-macro enabled workbook. By doing this, the blank workbook will not be changed, and can be reused each time he needs to create a new report."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1574878036, "creation_date": 1574878036, "answer_id": 59076119, "question_id": 59075415, "link": "https://stackoverflow.com/questions/59075415/how-can-a-format-an-entire-row-based-on-if-a-cell-contains-a-specific-word-using/59076119#59076119", "title": "How can a format an entire row based on if a cell CONTAINS a specific word using vba?", "body": "<p>I would use a worksheet change event. place this sub in your worksheet. Whenever any cell in column 5 changes and the value is \"risk\", it will color the row. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim Rng As Range\nSet Rng = Columns(5)\n\n    If Not Intersect(Rng, Target) Is Nothing And Target.Value = \"risk\" Then\n        Target.Offset(, -4).Resize(, 5).Interior.Color = vbYellow\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1574889750, "creation_date": 1574889750, "answer_id": 59078621, "question_id": 59075415, "link": "https://stackoverflow.com/questions/59075415/how-can-a-format-an-entire-row-based-on-if-a-cell-contains-a-specific-word-using/59078621#59078621", "title": "How can a format an entire row based on if a cell CONTAINS a specific word using vba?", "body": "<p>Try:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    Dim cell As Range\n\n    If Not Intersect(Target, Sh.UsedRange) Is Nothing Then\n\n        For Each cell In Target.Cells\n\n            With cell\n\n                If UCase(.Value) = \"RISK\" Then\n                    .Font.Color = vbRed\n                Else\n                    .Font.Color = vbBlack\n                End If\n\n            End With\n\n        Next cell\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12447186, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mA3p2wDm9UH7z54bWjdwgM2wxqsQ9UaAOIJaBg18w=k-s128", "display_name": "Dani Mika", "link": "https://stackoverflow.com/users/12447186/dani-mika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1574889750, "creation_date": 1574875139, "last_edit_date": 1574882178, "question_id": 59075415, "link": "https://stackoverflow.com/questions/59075415/how-can-a-format-an-entire-row-based-on-if-a-cell-contains-a-specific-word-using", "title": "How can a format an entire row based on if a cell CONTAINS a specific word using vba?", "body": "<p>I need to highlight and entire row if a cell string contains the word \"risk\". But I need to make it using vba since the person using it will write on it after using the macro.</p>\n\n<p>I have something like:</p>\n\n<p><img src=\"https://i.stack.imgur.com/BnRee.png\" alt=\"The client code, the value and a reason:\"></p>\n\n<p>The reason will be written afterwards and I need to highlight the row if someone writes the word risk anywhere in this column. Anything can be written there.</p>\n\n<p>I use this to highlite a row when I want a full match:</p>\n\n<pre><code>lastReg= Cells(Rows.Count, 1).End(xlUp).Row\nSet Rng = Range(\"A1:J\" &amp; lastReg)\nRng.FormatConditions.Add Type:=xlExpression, Formula1:=\"=$J1=\"\"Plat\"\"\"\n\n...\n</code></pre>\n\n<p>so I tried:</p>\n\n<pre><code>Rng.FormatConditions.Add Type:=xlExpression, Formula1:=\"=FIND(\"\"risk\"\",$J1)&gt;0\"\n</code></pre>\n\n<p>But it doesn't work. </p>\n\n<p>Edit: it gives me an execution error so the code itself doesn't run.</p>\n\n<p>Edit2: Someone else uses this macro, and he can't do it by himself so I wanted the code to do it for him.\nAlso, the code is stored in the personal.xlsb because he runs the code in a different worksheet everyday, so I can't pre config the formatConditions for the worksheet.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1574876745, "post_id": 59075253, "comment_id": 104388988, "body": "another thing to point out is to use <code>As Long</code> instead of <code>As Integer</code> due to the limitations on <code>As Integer</code>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4155377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2930fd898d962555b7dfddff102396?s=128&d=identicon&r=PG&f=1", "display_name": "4purs", "link": "https://stackoverflow.com/users/4155377/4purs"}, "edited": false, "score": 0, "creation_date": 1574875744, "post_id": 59075469, "comment_id": 104388524, "body": "ah i see thank you! but the second if statement where it checks if a number is between two other numbers does include decimals. would it not work in that case?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 3, "user_id": 4155377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2930fd898d962555b7dfddff102396?s=128&d=identicon&r=PG&f=1", "display_name": "4purs", "link": "https://stackoverflow.com/users/4155377/4purs"}, "edited": false, "score": 0, "creation_date": 1574875802, "post_id": 59075469, "comment_id": 104388549, "body": "Edited the answer to say real numbers"}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": 1, "last_activity_date": 1574876629, "last_edit_date": 1574876629, "creation_date": 1574875397, "answer_id": 59075469, "question_id": 59075253, "link": "https://stackoverflow.com/questions/59075253/subscript-out-of-range-error-comparing-one-array-to-another/59075469#59075469", "title": "Subscript out of range error comparing one array to another", "body": "<p>Remove the <code>.Concat</code> from <code>Else: array1(j, 11) = array1(j, 11).Concat(array2(i, 1))</code>  As the <code>&amp;</code> should be used to Concatenate.  The below code caused no errors as long as the values in the cells were real numbers.  Also for future reference <code>//get a subscript out of range error here</code> should be either <code>rem get a subscript out of range error here</code> or <code>'get a subscript out of range error here</code> to comment a line of code; using <code>//</code> VBA is expecting an operation to happen hence the error you received.</p>\n\n<pre><code>Sub test()\n    Dim array1() As Variant\n    Dim array2() As Variant\n    Dim i as Long, j As Long\n\n\n    array1 = Range(\"A2:K100000\").Value\n\n    array2 = Range(\"M2:Q834\").Value\n\n    For i = 1 To UBound(array2, 2)\n        For j = 1 To UBound(array1, 2)\n            If array2(i, 2) = array1(j, 7) Then\n                If array2(i, 3) &lt;= array1(j, 10) And array2(i, 3) &gt;= array1(j, 9) Then\n                    If IsEmpty(array1(j, 11)) Then\n                        array1(j, 11) = array2(i, 1)\n                    Else\n                       array1(j, 11) = array1(j, 11) &amp; (array2(i, 1))\n                    End If\n                End If\n            End If\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1574876869, "post_id": 59075686, "comment_id": 104389050, "body": "I didnt even notice the <code>Dim i, j As Integer</code>.  Thanks for pointing that out too along with all of your other excellent information."}, {"owner": {"reputation": 3, "user_id": 4155377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2930fd898d962555b7dfddff102396?s=128&d=identicon&r=PG&f=1", "display_name": "4purs", "link": "https://stackoverflow.com/users/4155377/4purs"}, "edited": false, "score": 0, "creation_date": 1574877076, "post_id": 59075686, "comment_id": 104389137, "body": "Ah you&#39;re right, I mean to count the height, but when i put ubound(array2,1) and ubound(array1,1) i then get a mismatch error."}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 3, "last_activity_date": 1574876308, "creation_date": 1574876308, "answer_id": 59075686, "question_id": 59075253, "link": "https://stackoverflow.com/questions/59075253/subscript-out-of-range-error-comparing-one-array-to-another/59075686#59075686", "title": "Subscript out of range error comparing one array to another", "body": "<p>I don't get a subscript out of range error, but I do see some other issues. I get a feeling that there are some differences in the code you are running and what you are posting. The things I noted:</p>\n\n<p><strong>Variable types</strong></p>\n\n<pre><code>Dim i, j As Integer\n</code></pre>\n\n<p>Two problems here. First, only the last variable will become an integer. Second, you should be using Long instead, otherwise you will get an overflow.</p>\n\n<pre><code>Dim i as Long, j As Long\n</code></pre>\n\n<p><strong>If Then Else</strong><br>\nUsing <code>Else:</code> is a very dangerous way of doing it. Do</p>\n\n<pre><code>If Condition Then\n    'Something\nElse\n    'Something else\nEnd If\n</code></pre>\n\n<p>instead. Quite soon you will have no clue of what <code>If</code> the <code>Else</code> belongs to.</p>\n\n<p><strong>UBound</strong><br>\nI suspect that </p>\n\n<pre><code>UBound(array2, 2)\n</code></pre>\n\n<p>should have been</p>\n\n<pre><code>UBound(array2, 1)\n</code></pre>\n\n<p>instead. The <code>, 2)</code> gives you the width of the array, but I guess you want the height of the array.</p>\n"}], "owner": {"reputation": 3, "user_id": 4155377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f2930fd898d962555b7dfddff102396?s=128&d=identicon&r=PG&f=1", "display_name": "4purs", "link": "https://stackoverflow.com/users/4155377/4purs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1582270688, "creation_date": 1574874477, "last_edit_date": 1582270688, "question_id": 59075253, "link": "https://stackoverflow.com/questions/59075253/subscript-out-of-range-error-comparing-one-array-to-another", "title": "Subscript out of range error comparing one array to another", "body": "<p>I align one set of data to another looping though cells. Essentially if IDs match and the next condition is satisfied, copy and paste the cell from one data set to the other in a new column.</p>\n\n<p>Looping though cells takes forever. I tried using arrays. I get the error</p>\n\n<blockquote>\n  <p>subscript out of range</p>\n</blockquote>\n\n<p>in <code>If array2(i, 2) = array1(j, 7) Then</code>.</p>\n\n<pre><code>Dim array1 As Variant\nDim array2 As Variant \nDim i, j As Integer  \n\narray1 = Range(\"A2:k100000\").Value\n\narray2 = Range(\"M2:Q834\").Value\n\nFor i = 1 To UBound(array2, 2)\n    For j = 1 To UBound(array1, 2)\n\n        If array2(i, 2) = array1(j, 7) Then '//get a subscript out of range error here\n\n            If array2(i, 3) &lt;= array1(j, 10) And array2(i, 3) &gt;= array1(j, 9) Then\n\n                If IsEmpty(array1(j, 11)) Then array1(j, 11) = array2(i, 1)\n\n            Else: array1(j, 11) = array1(j, 11).Concat(array2(i, 1))\n\n            End If\n        End If\n    Next j\nNext i\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1574895995, "post_id": 59074281, "comment_id": 104396258, "body": "Comparing  against a single value wont&#39; work - Categories property returns a &quot;;&quot; separated list of categories if more than one is set."}], "tags": [], "owner": {"reputation": 185, "user_id": 11116312, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xpSGIRqI4b4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNPsVUDBiaRp_oj3KvxIxzBXkndA/mo/photo.jpg?sz=128", "display_name": "David Podolak", "link": "https://stackoverflow.com/users/11116312/david-podolak"}, "is_accepted": true, "score": 1, "last_activity_date": 1574871044, "creation_date": 1574871044, "answer_id": 59074281, "question_id": 59074128, "link": "https://stackoverflow.com/questions/59074128/export-details-of-categorised-emails-to-excel/59074281#59074281", "title": "Export details of categorised emails to Excel", "body": "<p>You need to alter the 'if' statement. Mail Items have a property called categories which returns a string.\nChange:</p>\n\n<pre><code>If objMail.IsMarkedAsTask = True And objMail.FlagStatus &lt;&gt; olFlagComplete Then\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>If objMail.Categories = ***Insert Category Name In Quotes*** Then\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12441537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75cf13d750d988624c8ee139c14a314f?s=128&d=identicon&r=PG&f=1", "display_name": "Vorohi", "link": "https://stackoverflow.com/users/12441537/vorohi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 59074281, "answer_count": 1, "score": 0, "last_activity_date": 1578028713, "creation_date": 1574870514, "last_edit_date": 1578028713, "question_id": 59074128, "link": "https://stackoverflow.com/questions/59074128/export-details-of-categorised-emails-to-excel", "title": "Export details of categorised emails to Excel", "body": "<p>I found the below script online and tried to modify. I would like to check the Color Category instead of flagged emails.</p>\n\n<p>So as an example, it would not check if an email is flagged and then export the details to excel, but it would export all and add a Column 6 about the Category (name) the email is marked. </p>\n\n<p>Here is the code for processing the emails in Outlook </p>\n\n<pre><code>Sub ProcessMailFolders(ByVal objCurrentFolder As Outlook.Folder)\n    Dim i As Long\n    Dim objMail As Outlook.MailItem\n    Dim objFlaggedMail As Outlook.MailItem\n    Dim nLastRow As Integer\n    Dim objSubfolder As Outlook.Folder\n\n    For i = 1 To objCurrentFolder.Items.Count\n        If objCurrentFolder.Items(i).Class = olMail Then\n            'Export the information of each flagged email to Excel\n            Set objMail = objCurrentFolder.Items(i)\n            If objMail.IsMarkedAsTask = True And objMail.FlagStatus &lt;&gt; olFlagComplete Then\n                Set objFlaggedMail = objMail\n\n                With objExcelWorksheet\n                    nLastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row + 1\n                    .Range(\"A\" &amp; nLastRow) = objFlaggedMail.Subject\n                    .Range(\"B\" &amp; nLastRow) = objFlaggedMail.TaskStartDate\n                    .Range(\"C\" &amp; nLastRow) = objFlaggedMail.TaskDueDate\n                    .Range(\"D\" &amp; nLastRow) = objFlaggedMail.SenderName\n                    .Range(\"E\" &amp; nLastRow) = objFlaggedMail.To\n                End With\n            End If\n        End If\n    Next i\n\n    If objCurrentFolder.Folders.Count &gt; 0 Then\n        For Each objSubfolder In objCurrentFolder.Folders\n            Call ProcessMailFolders(objSubfolder)\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>The code referring to Excel I was able to modify, but not with checking the categorisation instead of flagged emails.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1743, "user_id": 2192832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2217d886c1805ab7398ffefb379ff71?s=128&d=identicon&r=PG", "display_name": "ivan_onys", "link": "https://stackoverflow.com/users/2192832/ivan-onys"}, "edited": false, "score": 0, "creation_date": 1574872234, "post_id": 59073675, "comment_id": 104386734, "body": "Hi Hakan. Please, follow <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask</a> and provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. From question it isn&#39;t clear what did you look for before posting to stackoverflow, why do you think provided code should work and what prevents you from progressing."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1574883086, "post_id": 59073675, "comment_id": 104391648, "body": "You may have answered your own question: <i>Table 1 and table 2 have exactly the same employees always</i>. So, of course the same named tabs would be overwritten with each run of code. Why not join the two tables and then export in each tab?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1575453528, "post_id": 59073675, "comment_id": 104568658, "body": "Since you already know how to use recordsets, instead of <code>TransferSpreadsheet</code>, use <code>Range.CopyFromRecordSet</code>. You will be in full control"}, {"owner": {"reputation": 11, "user_id": 12446744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-df4RnQHG1BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwBMkhp2Fq4PAA3dDiG8gSIzwsNg/photo.jpg?sz=128", "display_name": "H Dekker", "link": "https://stackoverflow.com/users/12446744/h-dekker"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1575453749, "post_id": 59073675, "comment_id": 104568815, "body": "@patrickHonorez Thanks for you help. I put the code above from several examples in 1 working code. So im am not so super vba programmer, so if you can more specific maybe with example then i can try to implement according to my situation. thanks in advance"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1575453749, "post_id": 59073675, "comment_id": 104568816, "body": "I once wrote a small function for that. You might get some inspiration from it. <a href=\"https://gist.github.com/PatrickHonorez/432c51c85721592675e2779773b831f2\" rel=\"nofollow noreferrer\">gist.github.com/PatrickHonorez/432c51c85721592675e2779773b83&zwnj;&#8203;1f2</a>"}, {"owner": {"reputation": 11, "user_id": 12446744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-df4RnQHG1BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwBMkhp2Fq4PAA3dDiG8gSIzwsNg/photo.jpg?sz=128", "display_name": "H Dekker", "link": "https://stackoverflow.com/users/12446744/h-dekker"}, "edited": false, "score": 0, "creation_date": 1575453806, "post_id": 59073675, "comment_id": 104568856, "body": "OK thanks i would look at that :)"}, {"owner": {"reputation": 11, "user_id": 12446744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-df4RnQHG1BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwBMkhp2Fq4PAA3dDiG8gSIzwsNg/photo.jpg?sz=128", "display_name": "H Dekker", "link": "https://stackoverflow.com/users/12446744/h-dekker"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1575454291, "post_id": 59073675, "comment_id": 104569132, "body": "@patrickHonorez i looked at it. Still not enough inspiration how to arrange 2 table with loop criteria per sheet.."}, {"owner": {"reputation": 11, "user_id": 12446744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-df4RnQHG1BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwBMkhp2Fq4PAA3dDiG8gSIzwsNg/photo.jpg?sz=128", "display_name": "H Dekker", "link": "https://stackoverflow.com/users/12446744/h-dekker"}, "edited": false, "score": 0, "creation_date": 1576051921, "post_id": 59073675, "comment_id": 104768825, "body": "Still not succeed working code..If someone has a solution?"}], "owner": {"reputation": 11, "user_id": 12446744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-df4RnQHG1BM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcwBMkhp2Fq4PAA3dDiG8gSIzwsNg/photo.jpg?sz=128", "display_name": "H Dekker", "link": "https://stackoverflow.com/users/12446744/h-dekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575452784, "creation_date": 1574869001, "last_edit_date": 1575452784, "question_id": 59073675, "link": "https://stackoverflow.com/questions/59073675/acces-vba-export-2-tables-to-one-excel-with-criteria", "title": "Acces VBA Export 2 tables to one excel with criteria", "body": "<p>I've been testing and searching for a couple of weeks and i think its now time after hundreds of tests, to ask help. Here's my situation.</p>\n\n<p>I have two tables in MS Access: </p>\n\n<ol>\n<li><p><code>Journal_personeel_verloning</code> (or <code>table1</code>)</p>\n\n<ul>\n<li><p>Table 1 has several employees, let's say: 5 different employees.</p></li>\n<li><p>Table 1 has working time details example: every day working from to hours</p></li>\n</ul></li>\n<li><p><code>Journal_personeel_verloning_2_all</code> (or <code>table2</code>)</p>\n\n<ul>\n<li><p>Table 2 has also several employees, let's say too: 5 different employees.</p></li>\n<li><p>Table 2 has total worked time for that month of each employee</p></li>\n</ul></li>\n</ol>\n\n<p>Notes: </p>\n\n<ul>\n<li><p>Table 1 and table 2 have exactly the same employees always.</p></li>\n<li><p><code>Persid</code> is the fieldname should filter on (both tables has this fieldname)</p></li>\n</ul>\n\n<hr>\n\n<p>What do I want to achieve: I want to export two tables to one Excel file with following conditions:</p>\n\n<ul>\n<li>1 Excel file containing data of 2 tables</li>\n<li>Each <code>PersID</code> on seperate sheet/tab</li>\n<li>Each sheet/tab name would be <code>PersID</code></li>\n</ul>\n\n<p>Problem</p>\n\n<p>I wrote a code which works fine with <code>table1</code>. When I do the same with <code>table2</code>, then it overwrites. So each time I have data of one table instead of data of two table per sheet/tab containing data from total two tables.</p>\n\n<p>I copied the code for <code>table2</code>. If I rename the Excel output file, then I get two separate files of course:</p>\n\n<pre><code>Dim qdf As DAO.QueryDef\nDim dbs As DAO.Database\nDim rstMgr As DAO.Recordset\nDim strSQL As String, strTemp As String, strMgr As String\n-----------------\n\nConst strFileName As String = \"Employee_Verloning\"\n\nDoCmd.SetWarnings False\n\n\nConst strQName As String = \"zExportQuery\"\n\nSet dbs = CurrentDb\nstrTemp = dbs.TableDefs(0).Name\n\nstrSQL = \"SELECT * FROM [\" &amp; strTemp &amp; \"] WHERE 1=0;\"\n\nSet qdf = dbs.CreateQueryDef(strQName, strSQL)\nqdf.Close\n\nstrTemp = strQName\n\nstrSQL = \"SELECT DISTINCT Persid FROM Journal_personeel_verloning;\"\n\nSet rstMgr = dbs.OpenRecordset(strSQL, dbOpenDynaset, dbReadOnly)\n\n\nIf rstMgr.EOF = False And rstMgr.BOF = False Then\n      rstMgr.MoveFirst\n      Do While rstMgr.EOF = False\n\n            strMgr = DLookup(\"CHAUFFEURR\", \"Journal_personeel_verloning\", _\n                  \"Persid = \" &amp; rstMgr!Persid.value)\n            strSQL = \"SELECT * FROM Journal_personeel_verloning WHERE \" &amp; _\n                  \"Persid = \" &amp; rstMgr!Persid.value &amp; \";\"\n\n\n            Set qdf = dbs.QueryDefs(strTemp)\n            qdf.Name = strMgr\n            strTemp = qdf.Name\n            qdf.SQL = strSQL\n            qdf.Close\n            Set qdf = Nothing\n\n\n            DoCmd.TransferSpreadsheet _\n            Transfertype:=acExport, _\n            SpreadsheetType:=acSpreadsheetTypeExcel9, _\n            TableName:=strTemp, _\n            Filename:=\"M:\\Public\\Exports XLS\\Personeel\\\" &amp; strFileName &amp; \".xls\", _\n            HasFieldNames:=True, _\n            Range:=strMgr\n\n            rstMgr.MoveNext\n\n\n      Loop\n\n\nEnd If\n\n\nrstMgr.Close\nSet rstMgr = Nothing\ndbs.QueryDefs.Delete strTemp\ndbs.Close\nSet dbs = Nothing\n</code></pre>\n\n<p>So any help is much appreciate...</p>\n\n<p>Edit:\nLet me more clear:</p>\n\n<pre><code>Table 1:\n\nID Persid Chauffeur Proj Starttime Endtime\n1  85     John      A    10:00     12:00\n2  86     Fred      X    10:00     12:00\n3  85     John      A    10:00     12:00\n4  86     Fred      A    10:00     12:00\n\nJournal_personeel_verloning_2_all (or table2)\n\nTable 2:\nID Persid Chauffeur Proj Totalworkedtime(decimal)\n1  85     John      A    4\n2  86     Fred      A    2\n3  86     Fred      X    2\n\nExport must look like this:\n\n1 excel file with:\ntabname: John\n\nID Persid Chauffeur Proj Starttime Endtime\n1  85     John      A    10:00     12:00\n3  85     John      A    10:00     12:00\n\n(1 or 2 empty rows)\n\nID Persid Chauffeur Proj Totalworkedtime(decimal)\n1  85     John      A    4\n\nsame excel with second tabname: Fred\n\nID Persid Chauffeur Proj Starttime Endtime\n2  86     Fred      X    10:00     12:00\n4  86     Fred      A    10:00     12:00\n\n(1 or 2 empty rows)\n\nID Persid Chauffeur Proj Totalworkedtime(decimal)\n2  86     Fred      A    2\n3  86     Fred      X    2\n</code></pre>\n\n<p>thanks in advance</p>\n"}, {"tags": ["excel", "vba", "intersect"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 0, "creation_date": 1574868606, "post_id": 59073188, "comment_id": 104384782, "body": "Thanks! Why should it be set? I read that <code>Set rng1 =</code> should be the same as <code>rng =</code>. If I want the rest of the code to run if the activecell is actually intersecting, what should it then be? The opposite of nothing?"}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "reply_to_user": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "edited": false, "score": 1, "creation_date": 1574870375, "post_id": 59073188, "comment_id": 104385733, "body": "When working with objects in VBA you have to use the &quot;Set&quot; keyword in order to assign them. As for the other question, the opposite of nothing is defined by the &quot;Not&quot; keywork before Intersect. Please remember to mark the answer with the green tick in order to help other find it."}], "tags": [], "owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1574867415, "creation_date": 1574867415, "answer_id": 59073188, "question_id": 59073085, "link": "https://stackoverflow.com/questions/59073085/define-range-with-last-row-intersect-activecell-and-range/59073188#59073188", "title": "Define range with last row &amp; Intersect activecell and range", "body": "<p>These two lines should be:</p>\n\n<pre><code>set rng1 = Range(\"H11:H\" &amp; lastrow)\nset rng2 = Range(\"I11:I\" &amp; lastrow)\n</code></pre>\n\n<p>With that, the intersect function should be:</p>\n\n<pre><code>if not Intersect(activecell, rng1) is nothing then\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 12446633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/311295a55860e3f0136e366e75147837?s=128&d=identicon&r=PG&f=1", "display_name": "Gisse", "link": "https://stackoverflow.com/users/12446633/gisse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "accepted_answer_id": 59073188, "answer_count": 1, "score": 0, "last_activity_date": 1574873201, "creation_date": 1574867062, "last_edit_date": 1574873201, "question_id": 59073085, "link": "https://stackoverflow.com/questions/59073085/define-range-with-last-row-intersect-activecell-and-range", "title": "Define range with last row &amp; Intersect activecell and range", "body": "<p>I'm new to VBA and am currently trying to define a range within a datasheet from column h11 to last data row in column h in order to run a macro, if the activecell is within that range.</p>\n\n<p>VB tells me \"Object Variable or With block variable not set\" when defining rng1 (and probably rng2 as well).</p>\n\n<p>I would like feedback on 2 things:\nWhat do I do to fix this error?\nHow do I proceed with the intersect function, when I fix the first error?</p>\n\n<p>I would really appreciate all help. I've been at it for a quite a while now and seems to be stuck.\nI've tried <code>rng1 = range(range(\"H11\") ,range(\"H\" &amp; Lastrow))</code>.\nPlease let me know if there is something I can do to learn faster or better - youtube videos or similar is very much appreciated.</p>\n\n<pre><code>Dim rng1 As Range\nDim rng2 As Range\nDim lastrow As Long\n\nlastrow = Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n\nrng1 = Range(\"H11:H\" &amp; lastrow)\nrng2 = Range(\"I11:I\" &amp; lastrow)\n\n'Sort on Product\n    If Intersect(activecell, rng1) = True Then```\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1574867225, "post_id": 59073052, "comment_id": 104384046, "body": "Welcome to Stack Overflow. Please note that because this is no free code writing service it is necessary that you show either what you have tried so far and where you got stuck or errors (by showing your code) or at least to show what you have researched and the effort you made. Otherwise it is just asking us to do all the work for you. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help you to improve your question. Reading <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> might help too."}], "answers": [{"tags": [], "owner": {"reputation": 22, "user_id": 12446804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e9545cd9d8c56534ef4c217bc5154b?s=128&d=identicon&r=PG&f=1", "display_name": "RuanRuan", "link": "https://stackoverflow.com/users/12446804/ruanruan"}, "is_accepted": false, "score": 1, "last_activity_date": 1574868376, "creation_date": 1574868376, "answer_id": 59073493, "question_id": 59073052, "link": "https://stackoverflow.com/questions/59073052/how-can-i-replace-the-text-in-cells-in-a-column/59073493#59073493", "title": "How can I replace the text in cells in a column?", "body": "<pre><code>Dim lastRow as long, ws as Worksheet, i as long\n\nSet ws = ThisWorkBook.Worksheets(\"YourWorksheetName\")\n\n' Suppose your third column is column C\nlastRow = ws.Cells(ws.Rows.Count, \"C\").End(xlUp).Row\n' Suppose the first row is the header, column C = 3 in terms of index\nFor i = 2 To lastRow\n    If ws.Cells(i,3).Value Like \"*@gmail.com*\" Then\n         ws.Cells(i,3).Value = \"external email address\"\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 12446634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9113ae6a7d5f7398977075dfc5df1e?s=128&d=identicon&r=PG&f=1", "display_name": "CheMBurN", "link": "https://stackoverflow.com/users/12446634/chemburn"}, "edited": false, "score": 0, "creation_date": 1574900752, "post_id": 59073621, "comment_id": 104397312, "body": "The first set of code worked perfectly!! When I said most of the work is done, its mostly just moving columns around and pivoting the data. I hit a brick wall when I got to this part. However, I had to remove the &#39;.DataBodyRange&#39; bit coz VBA didn&#39;t like it for some reason. Thank you so much!"}, {"owner": {"reputation": 58, "user_id": 12438891, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDqF_Uem83IWKhk4dT83AfFW4txS1MN6fyxUK93=k-s128", "display_name": "Vickyyy", "link": "https://stackoverflow.com/users/12438891/vickyyy"}, "reply_to_user": {"reputation": 29, "user_id": 12446634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9113ae6a7d5f7398977075dfc5df1e?s=128&d=identicon&r=PG&f=1", "display_name": "CheMBurN", "link": "https://stackoverflow.com/users/12446634/chemburn"}, "edited": false, "score": 1, "creation_date": 1574931422, "post_id": 59073621, "comment_id": 104405783, "body": "Your welcome :)  (btw. <i><b>DataBodyRange</b></i> bit refers to the range you wanna work with. So just the body  of <i><b>someTable</b></i> - excluding headers. If you replaced it with just <i><b>.Range</b></i> it will consider everything including headers, totals etc.)  Here You can find detailed info. <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/6/20/&hellip;</a>"}], "tags": [], "owner": {"reputation": 58, "user_id": 12438891, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDqF_Uem83IWKhk4dT83AfFW4txS1MN6fyxUK93=k-s128", "display_name": "Vickyyy", "link": "https://stackoverflow.com/users/12438891/vickyyy"}, "is_accepted": true, "score": 1, "last_activity_date": 1574870965, "last_edit_date": 1574870965, "creation_date": 1574868793, "answer_id": 59073621, "question_id": 59073052, "link": "https://stackoverflow.com/questions/59073052/how-can-i-replace-the-text-in-cells-in-a-column/59073621#59073621", "title": "How can I replace the text in cells in a column?", "body": "<p>It'd be nice if You showed what You mean by \"A lot of the stuff is already done\" and what You've achieved so far but...</p>\n\n<p>You could try using <strong><em>InStr()</em></strong> like this,</p>\n\n<pre><code>Sub ReplaceExternalEmails()\n\n    'ofc sheet's and listObj's indexes or \"names\" matters and depends on your case, try to figure these out\n    Dim someTable As ListObject\n    Set someTable = Sheets(1).ListObjects(1)\n\n    'Loop through 3rd column to check for external mails\n    Dim cel As Range\n    For Each cel In someTable.DataBodyRange.Columns(3).Cells\n        If InStr(cel.Value, \"@gmail.com\") Then\n            cel.Value = \"external email address\"\n        End If\n    Next cel\n\nEnd Sub\n</code></pre>\n\n<p>You could also add </p>\n\n<pre><code>cel.ClearFormats\n</code></pre>\n\n<p>inside for loop, or some other formating so it won't stay underlined blue if You care somehow.</p>\n\n<p>Another way to approach this (which is probably faster with larger datasets) is by replacing values, which is equivalent to <strong>CTRL+F / Replace</strong> method like this,</p>\n\n<pre><code>Sub ReplaceExternalEmails()\n\n    Dim someTable As ListObject\n    Set someTable = Sheets(1).ListObjects(1)\n\n    Dim fnd As Variant: fnd = \"*@gmail.com\"\n    Dim rpl As Variant: rpl = \"external email address\"\n\n    someTable.DataBodyRange.Columns(3).Replace _\n        What:=fnd, Replacement:=rpl\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 12446634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9113ae6a7d5f7398977075dfc5df1e?s=128&d=identicon&r=PG&f=1", "display_name": "CheMBurN", "link": "https://stackoverflow.com/users/12446634/chemburn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59073621, "answer_count": 2, "score": 0, "last_activity_date": 1578285557, "creation_date": 1574866960, "last_edit_date": 1578285557, "question_id": 59073052, "link": "https://stackoverflow.com/questions/59073052/how-can-i-replace-the-text-in-cells-in-a-column", "title": "How can I replace the text in cells in a column?", "body": "<p>I'm building a tool to parse/format copy pasted data into a more organized table.</p>\n\n<p>The final table is 4 columns and the 3rd column is email addresses.</p>\n\n<p>I would like to replace (@gmail.com) in the email address column with a value that says \"external email address\". The size of the table changes when new data in input.</p>\n\n<p>With my limited knowledge I've not been successful.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 1, "creation_date": 1574867220, "post_id": 59073022, "comment_id": 104384041, "body": "Edit your question and post some images of the data you\u2019re working with."}], "answers": [{"tags": [], "owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1574868302, "creation_date": 1574868302, "answer_id": 59073466, "question_id": 59073022, "link": "https://stackoverflow.com/questions/59073022/use-vba-to-add-a-validation-list-to-all-blank-cells-in-a-range/59073466#59073466", "title": "Use VBA to add a validation list to all blank cells in a range", "body": "<p>I actually found an easier way to solve my issue. Since the user would be making selections from the same list I realized I could just add a validation list to their cell while keeping their answer.</p>\n\n<pre><code>Sub FormulaTest()\n\nDim lRow As Integer\nDim conv As Worksheet\nSet conv = Sheets(\"Conversion\")\n\nlRow = conv.Range(\"A2\").End(xlDown).Row\n\nconv.Range(\"B2\").Formula = \"=IFNA(VLOOKUP(A2,Suggestions,4,FALSE),\"\"\"\")\"\nconv.Range(\"B2\").Copy\nconv.Range(\"B3:B\" &amp; lRow).PasteSpecial Paste:=xlFormulas\n\nFor i = 2 To lRow\n    Cells(i, 2).Validation.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=\"=ValidList\"\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 666, "user_id": 4035833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/719ac88e5e4bafdeeffd4094482dc0cb?s=128&d=identicon&r=PG&f=1", "display_name": "Part_Time_Nerd", "link": "https://stackoverflow.com/users/4035833/part-time-nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574868302, "creation_date": 1574866838, "question_id": 59073022, "link": "https://stackoverflow.com/questions/59073022/use-vba-to-add-a-validation-list-to-all-blank-cells-in-a-range", "title": "Use VBA to add a validation list to all blank cells in a range", "body": "<p>I am trying to add a validation list to range of cells if they are blank. I start the process by looking up a value in column A and seeing if that value is on another list. If not then the cell should be left blank and a validation list should be added to that blank cell. I have tried it a number of ways but my For loop is clearly incorrect because after cycling through the blank cells are still blank. I have looked at a few solutions on SO and a few other sites but I have not found anything that resolves my issue.</p>\n\n<pre><code> Sub FormulaTest()\n\nDim lRow As Integer\nDim conv As Worksheet\nSet conv = Sheets(\"Conversion\")\n\nlRow = conv.Range(\"A2\").End(xlDown).Row\n\nconv.Range(\"B2\").Formula = \"=IFNA(VLOOKUP(A2,Suggestions,4,FALSE),\"\"\"\")\"\nconv.Range(\"B2\").Copy\nconv.Range(\"B3:B\" &amp; lRow).PasteSpecial Paste:=xlFormulas\nconv.Range(\"B2:B\" &amp; lRow).Copy\nconv.Range(\"B2:B\" &amp; lRow).PasteSpecial Paste:=xlValues\n\nFor Each cell In Range(\"B2:B\" &amp; lRow).Cells\n    If IsEmpty(cell) = True Then\n        With cell.Validation\n            .Delete\n            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Formula1:=\"=ValidList\"\n        End With\n    End If\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1574866640, "post_id": 59072846, "comment_id": 104383674, "body": "First of all you need a <code>On Error Goto 0</code> instead of <code>Err.Clear</code>, otherwise the error reporting stays disabled and you won&#39;t ever see if something goes wrong behind this line (<a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>). <code>Err.Clear</code> just clears the error but if another error occurs you cannot see it because <code>On Error Resume Next</code> is still active! Tell us if there are errors after fixing that."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1574866655, "post_id": 59072846, "comment_id": 104383687, "body": "Further <code>Dim CurDt, LastAppDt As Date</code> will only declare <code>LastAppDt As Date</code> but <code>CurDt As Variant</code>. In VBA you need to specify a type for <b>every</b> variable: <code>Dim CurDt As Date, LastAppDt As Date</code> or it is <code>Variant</code> by default. Check this for all your variables and update the code in your question. \u2022 Finally you might benefit from reading  <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> to improve your question."}, {"owner": {"reputation": 1, "user_id": 11765435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmuD2mUL9B0/AAAAAAAAAAI/AAAAAAAAA8s/OPV7Lmq0avg/photo.jpg?sz=128", "display_name": "Yurie Ames", "link": "https://stackoverflow.com/users/11765435/yurie-ames"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1574867042, "post_id": 59072846, "comment_id": 104383926, "body": "Thank you! I will try this."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1574867202, "post_id": 59072846, "comment_id": 104384025, "body": "Note that this might not fix your actual issue. But it has to be fixed anyway, or you might not be able to find and fix the actual issue unless the mentioned points are fixed. So this is just the first step on your way to identify your problem."}, {"owner": {"reputation": 1, "user_id": 11765435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmuD2mUL9B0/AAAAAAAAAAI/AAAAAAAAA8s/OPV7Lmq0avg/photo.jpg?sz=128", "display_name": "Yurie Ames", "link": "https://stackoverflow.com/users/11765435/yurie-ames"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1574867634, "post_id": 59072846, "comment_id": 104384270, "body": "I made the changes as suggested, but I&#39;m getting an error.  &quot;Variable not defined&quot;"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1574869159, "post_id": 59072846, "comment_id": 104385051, "body": "In which code do you get the error? Please <a href=\"https://stackoverflow.com/posts/59072846/edit\">edit</a> and update the code in your question."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1574873515, "post_id": 59072846, "comment_id": 104387428, "body": "There&#39;s an edit link below the question which can be used to make changes to the content of the question. Please use that to update the question to the code you&#39;re currently using. Include the error message and indicate which line of code is triggering the error."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1574873621, "post_id": 59072846, "comment_id": 104387486, "body": "Also, when you&#39;re getting this kind of error it&#39;s an indication that <code>Option Explicit</code> may not be at the top of the code page. Make sure to add that. It may also help you when asking here to review the topic <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Since people will not have your files and cannot look over your shoulder (nor do they want your files) you need to provide enough information for them to be able to reproduce what you&#39;re doing."}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1574895194, "post_id": 59072846, "comment_id": 104396075, "body": "A rather different approach would be to use an Excel-driven mailmerge with a suitable filter so that only the relevant records are processed. For some code to get you started, see <i>Run a Mailmerge from Excel, Sending the Output to Individual Files</i> in the <b>Mailmerge Tips and Tricks</b> thread at: <a href=\"http://www.msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\" rel=\"nofollow noreferrer\">msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 1, "user_id": 11765435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmuD2mUL9B0/AAAAAAAAAAI/AAAAAAAAA8s/OPV7Lmq0avg/photo.jpg?sz=128", "display_name": "Yurie Ames", "link": "https://stackoverflow.com/users/11765435/yurie-ames"}, "edited": false, "score": 0, "creation_date": 1575228623, "post_id": 59072846, "comment_id": 104486262, "body": "I was able to successfully fill in my word template by using the mail merge feather and inserting the correct merge field to pull the date from my spreadsheet. I&#39;m able to this all from word. Is it possible to execute this from excel with the ability to select on demand, dynamic row numbers ie. From: 120 To:127 etc or select individual row numbers. Using maybe a Macro or something?"}], "owner": {"reputation": 1, "user_id": 11765435, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-cmuD2mUL9B0/AAAAAAAAAAI/AAAAAAAAA8s/OPV7Lmq0avg/photo.jpg?sz=128", "display_name": "Yurie Ames", "link": "https://stackoverflow.com/users/11765435/yurie-ames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574867002, "creation_date": 1574866320, "last_edit_date": 1574867002, "question_id": 59072846, "link": "https://stackoverflow.com/questions/59072846/fill-in-word-document-from-a-excel-spreadsheet-with-the-ability-to-select-which", "title": "Fill in Word document from a excel spreadsheet with the ability to select which row(s) to be used to generate the doc", "body": "<p>I'm struggling for the last 9 hrs trying to create a process that will allow me to auto fill in a Word doc(Template) with information from a excel spreadsheet. I've mapped the word doc to best of my ability using <code>&lt;&lt;&gt;&gt;</code> to match the needed infor from the spreadsheet. But when the Macro is ran it continues the replicate only the some of the data in the first row and the only way to stop the replication is to stop word from the \"task manager\". Also, I can't figure how to select just the row(s) that I would like to be used to generate the word doc...I'm burnt out at this point.</p>\n\n<p>Please help me.</p>\n\n<p>This is the VBA I'm working with.</p>\n\n<pre><code>\nSub CreateWordDocuments()\nDim CustRow, CustCol, LastRow, TemplRow, DaysSince, FrDays, ToDays As Long\nDim DocLoc, TagName, TagValue, TemplName, FileName As String\nDim CurDt, LastAppDt As Date\nDim WordDoc, WordApp, OutApp, OutMail As Object\nDim WordContent As Word.Range\nWith Sheet1\n\n If .Range(\"B3\").Value = Empty Then\n   MsgBox \"Please select a correct template from the drop down list\"\n   .Range(\"G3\").Select\n   Exit Sub\n End If\n   TemplRow = .Range(\"B3\").Value 'Set Template Row\n   TemplName = .Range(\"G3\").Value 'Set Template Name\n   DocLoc = Sheet2.Range(\"F\" &amp; TemplRow).Value 'Word Document Filename\n\n   'Open Word Template\n   On Error Resume Next 'If Word is already running\n   Set WordApp = GetObject(\"Word.Application\")\n   If Err.Number &lt;&gt; 0 Then\n   'Launch a new instance of Word\n   Err.Clear\n   'On Error GoTo Error_Handler\n   Set WordApp = CreateObject(\"Word.Application\")\n   WordApp.Visible = True 'Make the application visible to the user\n   End If\n\n\n   LastRow = .Range(\"E9999\").End(xlUp).Row  'Determine Last Row in Table\n       For CustRow = 8 To LastRow\n               DaysSince = .Range(\"M\" &amp; CustRow).Value\n               If TemplName &lt;&gt; .Range(\"N\" &amp; CustRow).Value And Row &gt;= FrDays And DaysSince &lt;= ToDays Then\n                               Set WordDoc = WordApp.Documents.Open(FileName:=DocLoc, ReadOnly:=False) 'Open Template\n                               For CustCol = 5 To 13 'Move Through 9 Columns\n                                   TagName = .Cells(7, CustCol).Value 'Tag Name\n                                   TagValue = .Cells(CustRow, CustCol).Value 'Tag Value\n                                    With WordDoc.Content.Find\n                                       .Text = TagName\n                                       .Replacement.Text = TagValue\n                                       .Wrap = wdFindContinue\n                                       .Execute Replace:=wdReplaceAll 'Find &amp; Replace all instances\n                                    End With\n                               Next CustCol\n\n                       If .Range(\"I3\").Value = \"PDF\" Then\n                                      FileName = ThisWorkbook.Path &amp; \"\\\" &amp; .Range(\"E\" &amp; CustRow).Value &amp; \"_\" &amp; .Range(\"F\" &amp; CustRow).Value &amp; \".pdf\" 'Create full filename &amp; Path with current workbook location, Last Name &amp; First Name\n                                      WordDoc.ExportAsFixedFormat OutputFileName:=FileName, ExportFormat:=wdExportFormatPDF\n                                      WordDoc.Close False\n                                  Else: 'If Word\n                                      FileName = ThisWorkbook.Path &amp; \"\\\" &amp; .Range(\"E\" &amp; CustRow).Value &amp; \"_\" &amp; .Range(\"F\" &amp; CustRow).Value &amp; \".docx\"\n                                      WordDoc.SaveAs FileName\n                                  End If\n                                  .Range(\"V\" &amp; CustRow).Value = TemplName 'Template Name\n                                  .Range(\"W\" &amp; CustRow).Value = Now\n\n                                          WordDoc.Close\n\n\n           End If '3 condition met\n       Next CustRow\n       WordApp.Quit\nEnd With\nEnd Sub``` \n\n\n\n\n\n\n\n\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1574876576, "post_id": 59072836, "comment_id": 104388903, "body": "I&#39;m not sure I understand what you&#39;re trying to do. Your code seems to work fine to copy a range of values to a new worksheet into the next empty row."}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1574878985, "post_id": 59072836, "comment_id": 104390003, "body": "This is where my confusion comes in. I used this code before to copy and paste into the next empty row and it worked (as you had mentioned) but now it overrides any existing values in the table. I&#39;m not sure what is causing it to override existing data rather then adding it to the next empty row."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1574879744, "post_id": 59072836, "comment_id": 104390343, "body": "Are there any empty rows in column B after your data in your &quot;Create_kit&quot; worksheet? If you&#39;ve exceeded the max rows on the sheet, your code will start pasting over data."}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1574881065, "post_id": 59072836, "comment_id": 104390861, "body": "Yes there are empty rows. For example, if I have added data in B6:F10 and try to run the code it will erase what is already there. There are empty rows after B6, there can be as many rows after as it is a table and it expands as new things are needed."}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1575314476, "post_id": 59072836, "comment_id": 104516787, "body": "@MilesFett I am hoping I could use your help on this again. I was able to solve the overriding issue but I am still experiencing a problem when the values from &quot;Create_kit&quot; are pasted over to &quot;Create_assembly&quot;. It pastes the values maybe 50 lines after the last entry in the table rather than in the next empty row."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1575321515, "post_id": 59072836, "comment_id": 104519485, "body": "I don&#39;t see <code>&quot;Create_assembly&quot;</code> can you update your code to include what you&#39;ve changed?"}, {"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "reply_to_user": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "edited": false, "score": 0, "creation_date": 1575383302, "post_id": 59072836, "comment_id": 104542801, "body": "Apologies, I meant to say &quot;Update_kit&quot; to &quot;Create_kit&quot;. The above code is still valid, but fortunately I was able to work my way through it and make it work for what I wanted. Regardless, thankyou for your input!"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1574869534, "post_id": 59073638, "comment_id": 104385234, "body": "I&#39;m not sure I follow what you commented, but yes I would like to copy from column B and paste into column B of the new sheet. I am copying and pasting data from tables."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "reply_to_user": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "edited": false, "score": 0, "creation_date": 1574876801, "post_id": 59073638, "comment_id": 104389012, "body": "@icalderon I believe he&#39;s asking if there are any empty cells in column B. If there are, your last row is going to be found at the first empty cell."}], "tags": [], "owner": {"reputation": 22, "user_id": 12446804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e9545cd9d8c56534ef4c217bc5154b?s=128&d=identicon&r=PG&f=1", "display_name": "RuanRuan", "link": "https://stackoverflow.com/users/12446804/ruanruan"}, "is_accepted": false, "score": -1, "last_activity_date": 1574868862, "creation_date": 1574868862, "answer_id": 59073638, "question_id": 59072836, "link": "https://stackoverflow.com/questions/59072836/how-to-paste-range-of-cells-in-the-next-empty-table-row/59073638#59073638", "title": "How to paste range of cells in the next empty table row?", "body": "<p>Could you confirm that in column B that you would like to copy/paste, there is no empty cell because the function you used \"wsCopy.Cells(wsCopy.Rows.count, \"B\").End(xlUp).Row\" can find the last row where there is no empty cell in the middle.</p>\n"}], "owner": {"reputation": 43, "user_id": 12293602, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBi_EYO2IE_TXzMyX-LcMOcvN3Xt0ipKqaueiZq0e0=k-s128", "display_name": "icalderon", "link": "https://stackoverflow.com/users/12293602/icalderon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574870479, "creation_date": 1574866293, "last_edit_date": 1574870479, "question_id": 59072836, "link": "https://stackoverflow.com/questions/59072836/how-to-paste-range-of-cells-in-the-next-empty-table-row", "title": "How to paste range of cells in the next empty table row?", "body": "<p>I would like to copy a range of cells from one table to another on a different sheet, but when it pastes to the new table it overrides existing information. </p>\n\n<p>Here is the code I am currently using:</p>\n\n<pre><code>Dim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim db As Worksheet\n\nDim lCopy As Long\nDim lDest As Long\n\nDim lCopy2 As Long\nDim lDest2 As Long\n\nSet db = Sheet1\n\ndb.range(\"B6:F1000\").ClearContents\n\n  Sheets(\"Create_kit\").range(\"B4\").Value = Sheets(\"Update_kit\").range(\"B3\").Value\n  Sheets(\"Create_kit\").range(\"C4\").Value = Sheets(\"Update_kit\").range(\"C3\").Value\n\n  Set wsCopy = Worksheets(\"Update_kit\") 'Copies table\n  Set wsDest = Worksheets(\"Create_kit\") 'Pastes table\n\n  lCopy = wsCopy.Cells(wsCopy.Rows.count, \"B\").End(xlUp).Row\n  lDest = wsDest.Cells(wsDest.Rows.count, \"B\").End(xlUp).Offset(1).Row\n\n  'Copies any cell within the table\n  wsCopy.range(\"B5:F\" &amp; lCopy).Copy\n  wsDest.range(\"B\" &amp; lDest).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>I tried changing <code>Offset(1)</code> to <code>Offset(0)</code> but I did not notice any changes after running the code. </p>\n\n<p>I would like to have the new data pasted in the next empty row in column B in the new table. I have tried to look at other asked questions but I have been unsuccessful in finding a solution.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1574865462, "post_id": 59072521, "comment_id": 104382977, "body": "Can you <a href=\"https://stackoverflow.com/posts/59072521/edit\">edit</a> your question with some sample code or pseudo-code?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1574865826, "post_id": 59072521, "comment_id": 104383194, "body": "Can you also explain what you mean by &quot;saved in some cell&quot;?"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1574869714, "post_id": 59072521, "comment_id": 104385347, "body": "Are you trying to store an entire array into a single worksheet cell?"}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574865861, "post_id": 59072662, "comment_id": 104383211, "body": "Upvoted. Not really sure what OP wants, but this is a good point to consider."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1574866011, "post_id": 59072662, "comment_id": 104383301, "body": "@BigBen Not sure too ^^ but if that is what he tried to do, we can shorten the discussion completely because it&#39;s not possible, and he needs to change the approach completely."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1575057332, "post_id": 59072662, "comment_id": 104451960, "body": "FYI posted an answer with other workarounds to <code>ReDim</code> both dimensions in a 2-dim array; you might be interested especially in the advanced features of the <code>Application.Index</code> function :-) +1 @PEH"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1575060487, "post_id": 59072662, "comment_id": 104452767, "body": "@T.M. Nice thoughts +1 :) Actually the <code>Index</code> solution is technically more like creating a new (smaller) array out of the old one and write it back into the old variable <code>v</code> rather than re-dimensioning the array. Even if that has the same result :) \u2022 Would be interesting to do some tests about speed of that workaround (or if pushing it into a range like your first idea is even faster)."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1575061774, "post_id": 59072662, "comment_id": 104453107, "body": "Note that if you Dim an array as shown here it&#39;s fixed size and cannot be Redim&#39;d (with or without Preserve). If you Dim it as a dynamic array <code>Dim Arr()</code> then size it with <code>ReDim Arr(1 To 6, 1 To 6)</code> then the commentary around Preserve is true."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1575113678, "post_id": 59072662, "comment_id": 104461712, "body": "As suggested I did some tests showing that the <code>Index</code> function prevails over the <code>Push to Range</code> method, i.e. it&#39;s roughly twice as fast: 100k rows are executed within 0.28 seconds, 500k in 1.45 secs and 1 million in 2,92 secs vs. 0.59, 2.97, 6,20 secs (whereas the workaround looping thru a newly built array is the fastest way, even 1M under 1 second - @PEH"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1575132966, "post_id": 59072662, "comment_id": 104466518, "body": "@T.M. wow I didn&#39;t expect the loop to be the fastest ^^ Nice job."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 4, "last_activity_date": 1575061860, "last_edit_date": 1575061860, "creation_date": 1574865693, "answer_id": 59072662, "question_id": 59072521, "link": "https://stackoverflow.com/questions/59072521/excel-vba-dynamic-array/59072662#59072662", "title": "Excel VBA Dynamic array", "body": "<p>Note that if you have an array </p>\n\n<pre><code>Dim Arr()\nReDim Arr(1 To 6, 1 To 6)\n</code></pre>\n\n<p>you can only change the last dimension eg </p>\n\n<pre><code>ReDim Preserve Arr(1 To 6, 1 To 5) \n</code></pre>\n\n<p>but never the first one. Therefore what you ask for is not possible without loosing the data in the array.</p>\n\n<p>The only workaround for that is to create a new array and move the data from the old array to the new one field by field.</p>\n"}, {"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1575057163, "creation_date": 1575057163, "answer_id": 59110317, "question_id": 59072521, "link": "https://stackoverflow.com/questions/59072521/excel-vba-dynamic-array/59110317#59110317", "title": "Excel VBA Dynamic array", "body": "<p><strong>Write 6x6 array values back to sheet as if redimmed to 5x5</strong></p>\n\n<p>As far as I understand your intention, you want to \n - save 2-dim array values to a range (referenced by a given top cell) and\n - to get rid of the upper boundary in <em>both</em> dimensions for reasons whatever.</p>\n\n<p>If not added one by one, you might have gotten the original data from a sheet range as follows</p>\n\n<pre><code>Dim v                               ' provide for a variant array\nv = Sheet1.Range(\"A2\").Resize(6, 6) ' assign all data to 1-based 2-dim array v\n</code></pre>\n\n<p>Note the fully qualified range reference via a sheet's <code>CodeName</code>, assuming basic data in a sheet \nwith VBE Tool Window (Name) of e.g. <code>Sheet1</code>.     </p>\n\n<p><strong>Attempt 1 - resize the hosting target range to receive array v</strong></p>\n\n<p>This would be the easiest way to get the needed values into the sheet, but \nwith the disadvantage that you did'nt change the related array likewise, e.g.</p>\n\n<pre><code>With Sheet2\n    .Cells.Clear            ' emptying any content in target sheet\n    .Range(\"A2\").Resize(5, 5) = v   ' start cell e.g. in A2 (leaving room for title row)\nEnd With\n</code></pre>\n\n<p>To overcome this, you might want to copy to a temporary sheet and return the resized values only</p>\n\n<pre><code>    With Sheet2\n        .Cells.Clear            ' emptying any content in target sheet\n        .Range(\"A2\").Resize(5, 5) = v   ' blueprint the entire array via a filtering bottle neck\n        v = .UsedRange          ' resize the array, too :-)\n    End With    \n\n</code></pre>\n\n<p><strong>Attempt 2 - redim the original array</strong></p>\n\n<p>In case you'd try to redimension the original array via \u25ba <code>ReDim</code> or <code>ReDim Preserve</code>, \nPEH mentioned correctly, that it's only possible to <em>change the</em> <strong>last dimension</strong>, <em>e.g.</em></p>\n\n<pre><code>ReDim Preserve Arr(1 To 6, 1 To 5) \n</code></pre>\n\n<p><em>but never the first one.</em></p>\n\n<p><strong>TL;DR</strong></p>\n\n<p>The cited answer states as well:</p>\n\n<blockquote>\n  <p>The <strong>only</strong> workaround for that is to create a new array and move the data\n    from the old array to the new one field by field.</p>\n</blockquote>\n\n<p>Out of inquisitiveness I tried to find other workarounds.</p>\n\n<p><strong><code>[1]</code> Using the \u25ba <code>Application.Index</code> function</strong></p>\n\n<pre><code>    v = Application.Index(v, Evaluate(\"row(1:5)\"), Array(1, 2, 3, 4, 5))\n</code></pre>\n\n<p>or alternatively via procedure call <code>RD</code> (short for <code>ReDim</code>)</p>\n\n<pre><code>RD v, 5, 5\n'...\n\nSub RD(Arr, UBnd1&amp;, UBnd2&amp;)\n    Arr = Application.Index(Arr, Evaluate(\"row(1:\" &amp; UBnd1 &amp; \")\"), Application.Transpose(Evaluate(\"row(1:\" &amp; UBnd2 &amp; \")\")))\nEnd Sub\n</code></pre>\n\n<p>C.f. the advanced features and pecularities of the <code>Application.Index</code> function \nat <a href=\"https://stackoverflow.com/questions/51688593/excel-vba-insert-new-first-column-in-datafield-array-without-loops-or-api-call/51714153#51714153\">Insert new first column in array without loops</a></p>\n\n<p><strong><code>[2]</code> Using a listbox'es <code>.List</code> property</strong></p>\n\n<p>An alternative would be \n - to redim an array in its 2nd dim, \n - assign it to a ListBox.List created on the fly,\n - remove last rows and assign <code>.List</code> property back to the array</p>\n\n<p><strong>Caveat:</strong> the <code>.List</code> property returns a zero-based 2-dim array instead 1-based items\nsee <a href=\"https://stackoverflow.com/questions/53938280/may-i-return-a-0-base-array-from-ws-usedrange-value/53950312#53950312\">return 0-based array from UsedRange value</a>\nto reflect the method.</p>\n\n<p><strong><code>[3]</code> Possible memory methods avoiding too much loops, e.g. via <code>MemCpy</code> or <code>CopyMemory</code></strong></p>\n\n<p>\u25baWould be interested in any feed back knowing a valid answer, could pose a new question if wanted.</p>\n"}], "owner": {"reputation": 11, "user_id": 2188461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4833828fb8778248cc5e443fed16e69e?s=128&d=identicon&r=PG", "display_name": "miikii", "link": "https://stackoverflow.com/users/2188461/miikii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1575061860, "creation_date": 1574865308, "last_edit_date": 1574869556, "question_id": 59072521, "link": "https://stackoverflow.com/questions/59072521/excel-vba-dynamic-array", "title": "Excel VBA Dynamic array", "body": "<p>I know we can write dynamic array \nMy question is \nCan i write values 6*6 it will get me a 36 array </p>\n\n<p>I want this to be saved in some cell as my values could be changed to 5*5 \nBasically my array is dynamic i want each result to be saved</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "edited": false, "score": 0, "creation_date": 1574866892, "post_id": 59072581, "comment_id": 104383837, "body": "thanks for answering, sorry if I ask, but If I only have one input, only the year 2020. How could i achieve this?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1574867966, "post_id": 59072581, "comment_id": 104384433, "body": "@TheMite my code does the whole 2020, you just need to edit the  <code>FirstDay =....</code> and the <code>LastDay = ...</code> to suit your needs. Right now it does the year 2020."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "edited": false, "score": 0, "creation_date": 1574868095, "post_id": 59072581, "comment_id": 104384502, "body": "yeah sorry Damian my question was wrong really sorry, it does 2020. I was asking about a list of years, like if the user chooses 2022 from a list, how can I obtain FirstDay and LastDay? I hope you understood me"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "edited": false, "score": 0, "creation_date": 1574869156, "post_id": 59072581, "comment_id": 104385049, "body": "I&#39;ve found it out! Thanks Damian no more answers needed"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1574873708, "post_id": 59072581, "comment_id": 104387528, "body": "@TheMite glad you found out how. You only needed to turn the 2020 into a variable and pass it through the procedure as parameter."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 0, "last_activity_date": 1574865488, "creation_date": 1574865488, "answer_id": 59072581, "question_id": 59072309, "link": "https://stackoverflow.com/questions/59072309/list-all-days-in-a-row-vba-excel/59072581#59072581", "title": "List all days in a row VBA EXCEL", "body": "<p>This simple macro would let you choose the time periods aswell:</p>\n\n<pre><code>Option Explicit\nSub Test()\n\n    'First day to the time period\n    Dim FirstDay As Date\n    FirstDay = DateSerial(2020, 1, 1)\n\n    'last day to the time period\n    Dim LastDay As Date\n    LastDay = DateSerial(2020, 12, 31)\n\n    'count the days between first and last day\n    Dim Counter As Long\n    Counter = DateDiff(\"d\", FirstDay, LastDay)\n\n    'Resize an array as large as the days you neeed\n    ReDim arr(0 To Counter + 1) As Date\n\n    'loop through the array with the DateSerial function adding 1 day to the first day of the period\n    Dim i As Long\n    For i = 0 To UBound(arr)\n        arr(i) = DateSerial(2020, 1, 1 + i)\n    Next i\n\n    'Drop the array to your desired row\n    Range(\"A1\").Resize(1, UBound(arr)).Value = arr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9758877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 59072581, "answer_count": 1, "score": 0, "last_activity_date": 1574865488, "creation_date": 1574864644, "question_id": 59072309, "link": "https://stackoverflow.com/questions/59072309/list-all-days-in-a-row-vba-excel", "title": "List all days in a row VBA EXCEL", "body": "<p>I have a list of years (ex. 2016, 2017, 2018, 2019, 2020, 2021...)</p>\n\n<p>How to list all the days of the year 2020?</p>\n\n<p>So i would have: .Cells(2, 2) = 01/01/2020.... and so on until 31/12/2020 in the same row obviously</p>\n\n<p>This is what my code looks like, but I think that I made it work only for the current year eg. 2019</p>\n\n<pre><code>Dim MyMounth As Long\nDim MounthDays As Long\nDim MounthDays2 As Long\nDim MounthDaysAppoggio As Long\nDim riga As Long\nDim numeri As Long\nDim mese As Long\n\nMounthDaysAppoggio = 1\nMounthDays = Day(DateSerial(Year(Date), MounthDaysAppoggio + 1, 1) - 1)\n\nmese = 1\nriga = 2\nnumeri = 1\n\nMounthDays2 = 0\n\nFor q = 1 To 12\n\nFor Row = 2 To MounthDays + 1\n\nMounthDays2 = MounthDays2 + 1\nCells(4, riga).NumberFormat = 0\nCells(4, riga).Value = MounthDays2\nCells(4, riga).VerticalAlignment = xlCenter\nCells(4, riga).HorizontalAlignment = xlCenter\nCells(4, riga).BorderAround ColorIndex:=1, Weight:=xlMedium\n\nriga = riga + 1\n\nNext Row\n\nMounthDays = Day(DateSerial(Year(Date), MounthDaysAppoggio + 1, 1) - 1)\n\nMounthDays2 = 0\n\nNext q\n</code></pre>\n"}, {"tags": ["excel", "vba", "match", "string-matching"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574864324, "post_id": 59072179, "comment_id": 104382270, "body": "Here&#39;s a useful VBA resource: a <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">smart indenter</a> to fix your indentation."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1574864499, "post_id": 59072179, "comment_id": 104382369, "body": "Have you attempted to look at variant arrays?  Looping through variant arrays, particularly with <code>InStr()</code> would get <i>like</i> matches, and would be fairly quick compared to having Excel go cell to cell, sheet to sheet."}, {"owner": {"reputation": 1, "user_id": 12446266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bddbd07d7b54c5b061a5a76dea30159?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Patt", "link": "https://stackoverflow.com/users/12446266/matt-patt"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1574864777, "post_id": 59072179, "comment_id": 104382558, "body": "@Cyril, unfortunately I need exact matches."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1574865011, "post_id": 59072179, "comment_id": 104382690, "body": "@MattPatt Then you can do <code>if array_a(i,j) = array_b(r,c) then</code> for exact matches.  Do you have issues with leading/trailing spaces?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1574865116, "post_id": 59072179, "comment_id": 104382756, "body": "Overall, have you inspected the actual strings of the lookup and the expected-match values to ensure they are <i>exactly</i> the same?"}, {"owner": {"reputation": 1, "user_id": 12446266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bddbd07d7b54c5b061a5a76dea30159?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Patt", "link": "https://stackoverflow.com/users/12446266/matt-patt"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1574865400, "post_id": 59072179, "comment_id": 104382939, "body": "@Cyril Yes they are exact matches as it works perfectly in column one of sheet 2 but then gets spotty after column one. I&#39;m wondering if its an issue with the code or an issue with the limitations of Excel VBA (asking it to do too much but the code si okay)"}], "answers": [{"tags": [], "owner": {"reputation": 22, "user_id": 12446804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92e9545cd9d8c56534ef4c217bc5154b?s=128&d=identicon&r=PG&f=1", "display_name": "RuanRuan", "link": "https://stackoverflow.com/users/12446804/ruanruan"}, "is_accepted": false, "score": 0, "last_activity_date": 1574869224, "creation_date": 1574869224, "answer_id": 59073739, "question_id": 59072179, "link": "https://stackoverflow.com/questions/59072179/matching-text-in-cells-of-one-column-against-cells-in-columns-with-a-variable-nu/59073739#59073739", "title": "Matching text in cells of one column against cells in columns with a variable number of rows", "body": "<p>can you add .Cells(i,j).Value to see whether it works or not:</p>\n\n<pre><code>If .Cells(i, c).Value = WS.Cells(j, 1).Value Then\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12446266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bddbd07d7b54c5b061a5a76dea30159?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Patt", "link": "https://stackoverflow.com/users/12446266/matt-patt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1606905573, "creation_date": 1574864238, "last_edit_date": 1606905573, "question_id": 59072179, "link": "https://stackoverflow.com/questions/59072179/matching-text-in-cells-of-one-column-against-cells-in-columns-with-a-variable-nu", "title": "Matching text in cells of one column against cells in columns with a variable number of rows", "body": "<p>I have an Excel file with two sheets: Master and sheet two.<br />\nMaster has one column of roughly 50 rows each containing a word.<br />\nSheet two has 23 columns of varying lengths, the largest going up to 95 rows.</p>\n<p>My goal is to use column one on Master to search each column on sheet 2 for text matches and then output all the matches below their respective columns on sheet 2.</p>\n<p>The issue is after the first column on sheet 2 the matching often misses words.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub CompareFNL()\n\nApplication.ScreenUpdating = False\n\nDim WS As Worksheet\n\nSet WS = Sheets(&quot;Master&quot;)\n\nDim rng As Range\nDim Column2 As Integer\nDim RowsMaster As Integer, Rows2 As Integer\n\nRowsMaster = WS.Cells(100, 1).End(xlUp).row\nRows2 = Worksheets(2).Cells(100, 1).End(xlUp).row\n\nColumn2 = Worksheets(2).Cells(1, 24).End(xlToRight).Column\n\n' Get the number of used rows for each sheet\nWith Worksheets(2)\n    For c = 1 To Column2\n    \n        For i = 1 To Rows2\n            'Loop through Sheet 2\n        \n            For j = 1 To RowsMaster\n                'Loop through the Master sheet\n            \n                If .Cells(i, c) = WS.Cells(j, 1) Then\n                    'If a match is found:\n                    Worksheets(2).Cells(i + 110, c) = WS.Cells(j, 1)\n                    'Copy int sheet2 in their respective columns\n                    Exit For\n                End If\n            Next j\n        Next i\n    Next c\n\n    'Store blank cells inside a variable\n\n    On Error GoTo NoBlanksFound\n    Set rng = Range(&quot;a110:x250&quot;).SpecialCells(xlCellTypeBlanks)\n    On Error GoTo 0\n\n    'Delete blank cells and shift upward\n    rng.Rows.delete Shift:=xlShiftUp\n\n'ERROR HANLDER\nNoBlanksFound:\n    MsgBox &quot;No Blank cells were found&quot;\n\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["r", "excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574863862, "post_id": 59072048, "comment_id": 104381981, "body": "What line throws the RTE 1004?"}, {"owner": {"reputation": 11, "user_id": 12446246, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8-N9FAYedF0dxC-x1yK7GhJelczePY7MR3uEqRg=k-s128", "display_name": "OliMyFriend", "link": "https://stackoverflow.com/users/12446246/olimyfriend"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574864304, "post_id": 59072048, "comment_id": 104382260, "body": "That&#39;s the issue. It is not indicated where the error appears. But the vba code runs well when I make the change myself without R."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574864349, "post_id": 59072048, "comment_id": 104382287, "body": "What line is highlighted when you click <code>Debug</code> after the error message appears?"}, {"owner": {"reputation": 11, "user_id": 12446246, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8-N9FAYedF0dxC-x1yK7GhJelczePY7MR3uEqRg=k-s128", "display_name": "OliMyFriend", "link": "https://stackoverflow.com/users/12446246/olimyfriend"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574864566, "post_id": 59072048, "comment_id": 104382406, "body": "I can&#39;t click debug. :("}], "owner": {"reputation": 11, "user_id": 12446246, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD8-N9FAYedF0dxC-x1yK7GhJelczePY7MR3uEqRg=k-s128", "display_name": "OliMyFriend", "link": "https://stackoverflow.com/users/12446246/olimyfriend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574929224, "creation_date": 1574863777, "last_edit_date": 1574929224, "question_id": 59072048, "link": "https://stackoverflow.com/questions/59072048/trigger-excel-worksheet-change-to-change-cells-using-r", "title": "Trigger Excel Worksheet_Change to change cells using R", "body": "<p>I modify a cell in an Excel file using R.</p>\n\n<p>When this cell is manually changed, Worksheet_Change launches to indicate the date of the modification (in two other cells).</p>\n\n<p>When I run my code in R, the date of the modification in column 46 (see VBA code ModificationDate1) is indicated. The date of the modification in column 40 (see VBA code ModificationDate2) doesn't appear. I get a VBA error 1004.</p>\n\n<p>It is not indicated where the error appears. I can't click debug.</p>\n\n<p>I would like the date of the modification in column 40 to also appear. (This later appears when I make a change directly in Excel.)</p>\n\n<p><strong>My code in R:</strong></p>\n\n<pre class=\"lang-r prettyprint-override\"><code>if (NewInput != CurrentData) {\n  xlApp &lt;- COMCreate(\"Excel.Application\")\n  wb &lt;- xlApp[[\"Workbooks\"]]$Open(\"path.xlsm\")\n  sheet &lt;- wb$Worksheets(\"Sheet1\")\n  cell  &lt;- sheet$Cells(Outputrow + 6, 7)\n  cell[[\"Value\"]] &lt;- paste0(NewInput)\n  wb$Save()\n  xlApp$Quit()\n  }\n</code></pre>\n\n<p><strong>My codes in vba:</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n'**ModificationDate1**\nDim WorkRng As Range\nDim Rng As Range\n\nLastRow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\nSet Rng = Range(Cells(7, 7), Cells(LastRow, 7))\n\nIf Not Intersect(Target, Rng) Is Nothing Then\n    Call UnprotectCells\n    Cells(Target.Row, 46).Value = Date\n    Call ProtectCells\nEnd If\n\n'**ModificationDate2**\nDim rng1 As Range\nDim rng2 As Range\n\nSet rng1 = Range(Cells(7, 3), Cells(LastRow, 4))\nSet rng2 = Range(Cells(7, 7), Cells(LastRow, 10))\n\nIf Not Intersect(Target, Union(rng1, rng2)) Is Nothing Then\n    Call UnprotectCells\n    Cells(Target.Row, 40).Value = Date\n    Call ProtectCells\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1574863255, "post_id": 59071805, "comment_id": 104381593, "body": "On what line is the error?"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1574863653, "post_id": 59071805, "comment_id": 104381854, "body": "And what does this sentence mean <i>&quot;In subtotal Emails Folder count of emails for 7855, almost 5083 emails auto-downloaded to &quot;Box folder&quot; but End of time, it&#39;s through error.&quot;</i> I&#39;m having a hard time understanding it."}, {"owner": {"reputation": 21, "user_id": 6070451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXa6c.jpg?s=128&g=1", "display_name": "Guna", "link": "https://stackoverflow.com/users/6070451/guna"}, "edited": false, "score": 0, "creation_date": 1574866664, "post_id": 59071805, "comment_id": 104383693, "body": "&quot;Run-time error &#39;-2147221233 (8004010f)&#39;:  cannot save the attachment the operation failed, an object cannot be found  Sorry, It means we created New Folder Under, in Inbox, we set up rules to move all email to the subfolder  Here, overall 7855 as of now, when I run macro almost 5083 documents moved to local path..   it seems if same XXAAA.pdf multi times is it over placed  am right, then why am getting this runtime error??"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1574897362, "post_id": 59071805, "comment_id": 104396584, "body": "Which line through the error? It sure sounds like the message was deleted/moved while the loop was executing."}, {"owner": {"reputation": 21, "user_id": 6070451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXa6c.jpg?s=128&g=1", "display_name": "Guna", "link": "https://stackoverflow.com/users/6070451/guna"}, "reply_to_user": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1574932133, "post_id": 59071805, "comment_id": 104406176, "body": "@Dmitry Streblechenko, How to avoid this error today, I noticed that error occurred, &quot;Object not found&quot;, It seems some specific date PDF document unable to open it  ( I think pdf error - Unable to open manually too )   Error came and stopped - this line &quot;Atmt.SaveAsFile FileName&quot;"}, {"owner": {"reputation": 21, "user_id": 6070451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXa6c.jpg?s=128&g=1", "display_name": "Guna", "link": "https://stackoverflow.com/users/6070451/guna"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1574936112, "post_id": 59071805, "comment_id": 104408393, "body": "@JNevill How to avoid this error today, I noticed that error occurred, &quot;Object not found&quot;, It seems some specific date PDF document unable to open it ( I think pdf error - Unable to open manually too ) Error came and stopped - this line &quot;Atmt.SaveAsFile FileName"}], "owner": {"reputation": 21, "user_id": 6070451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pXa6c.jpg?s=128&g=1", "display_name": "Guna", "link": "https://stackoverflow.com/users/6070451/guna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1576399864, "creation_date": 1574862915, "last_edit_date": 1576399864, "question_id": 59071805, "link": "https://stackoverflow.com/questions/59071805/download-pdf-document-from-mail-error-on-one-document-cannot-save-the-attachme", "title": "Download pdf document from mail error on one document: &quot;Cannot save the attachment. The operation failed. An object cannot be found&quot;", "body": "<p>I am trying to download pdf documents from a particular Email ID Address to Box_folder.</p>\n\n<p>I got this error</p>\n\n<blockquote>\n  <p>Cannot save the attachment. The operation failed. An object cannot be found.</p>\n</blockquote>\n\n<p>on this line <code>Atmt.SaveAsFile FileName</code>.</p>\n\n<p>It seems some specific date PDF document unable to open it. I think pdf error - Unable to open manually too.</p>\n\n<p>In subtotal Emails Folder count of emails for 7855, almost 5083 emails auto-downloaded to \"Box folder\" but End of time, it's through error.</p>\n\n<pre><code>Sub Saveattachment()\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Dim lngCount As Long\n    Dim filepath As Variant\n\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Select a Folder\"\n        .AllowMultiSelect = False\n        .InitialFileName = \"C:\\\"\n        .Show\n        ' Display paths of each file selected\n        If .SelectedItems.Count &gt; 0 Then\n            filepath = .SelectedItems(1) &amp; \"\\\"\n        Else\n            Exit Sub\n        End If\n    End With\n\n    Dim olApp As Outlook.Application\n    Dim olNamespace As Outlook.Namespace\n    Dim olItem As Outlook.MailItem\n    Dim i As Integer\n    Dim b As Integer\n    Dim olInbox  As Outlook.MAPIFolder\n    Dim olFolder As Outlook.MAPIFolder\n    Dim lngCol As Long\n    Dim oMsg As Outlook.MailItem\n    Dim mainWB As Workbook\n    Dim keyword\n    Dim Count\n    Dim Atmt\n    Dim f_random\n    Dim FileName\n    Dim foldernew As String\n\n    'Dim olInbox As inbo\n    Set olApp = New Outlook.Application\n    Set olNamespace = olApp.GetNamespace(\"MAPI\")\n\n    Set olInbox = olNamespace.GetDefaultFolder(Outlook.olFolderInbox)\n    Set olInbox = olInbox.Folders(\"Tax PDF\")\n    Dim oItems As Outlook.Items\n    Set oItems = olInbox.Items\n\n    'Subject of mail\n    keyword = \"noreply@XXXX.XXX.in\"\n\n    For i = 1 To oItems.Count\n        If TypeName(oItems.Item(i)) = \"MailItem\" Then\n            Set oMsg = oItems.Item(i)\n            If InStr(1, oMsg.Sender.GetExchangeUser.PrimarySmtpAddress, keyword, vbTextCompare) &gt; 0 Then\n                For Each Atmt In oMsg.Attachments\n                    FileName = filepath &amp; Atmt.FileName\n                    If Right(FileName, 3) = \"PDF\" Then\n                        Atmt.SaveAsFile FileName\n                    End If\n                Next Atmt\n            End If\n        End If\n    Next\n\n    MsgBox \"Files has been Moved to Respective Folder\", vbInformation, \"Excel to Outlook\"\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1574862768, "post_id": 59071630, "comment_id": 104381311, "body": "Do you open Report view or Print preview? Section <code>Format</code> events only run in Print views."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1574863814, "post_id": 59071630, "comment_id": 104381960, "body": "@Andre <a href=\"https://docs.microsoft.com/en-us/office/vba/api/Access.Section.OnFormat\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/Access.Section.OnFor&zwnj;&#8203;mat</a> says event will fire ` for previewing or printing`"}, {"owner": {"reputation": 45, "user_id": 6710503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ee634892116d4089dcff582a31653d?s=128&d=identicon&r=PG&f=1", "display_name": "Adri", "link": "https://stackoverflow.com/users/6710503/adri"}, "edited": false, "score": 0, "creation_date": 1574865297, "post_id": 59071630, "comment_id": 104382874, "body": "I open report in Report View. So this won&#39;t work. Is there another solution?"}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1574865542, "post_id": 59071630, "comment_id": 104383028, "body": "@Adri Move the code to <code>On Load</code> event"}, {"owner": {"reputation": 45, "user_id": 6710503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ee634892116d4089dcff582a31653d?s=128&d=identicon&r=PG&f=1", "display_name": "Adri", "link": "https://stackoverflow.com/users/6710503/adri"}, "edited": false, "score": 0, "creation_date": 1574865873, "post_id": 59071630, "comment_id": 104383222, "body": "Thank you krish KM. That solved the problem."}], "answers": [{"tags": [], "owner": {"reputation": 1534, "user_id": 5373986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5937e22068b8355cf94c4c18f747660f?s=128&d=identicon&r=PG&f=1", "display_name": "Taazar", "link": "https://stackoverflow.com/users/5373986/taazar"}, "is_accepted": true, "score": 1, "last_activity_date": 1574873232, "creation_date": 1574873232, "answer_id": 59074914, "question_id": 59071630, "link": "https://stackoverflow.com/questions/59071630/labels-do-not-disappear/59074914#59074914", "title": "Labels do not disappear", "body": "<p>Section Format events only run in Print or Print Preview views. \u2013 Andre</p>\n\n<p>If you are opening the report in Report View you will want to move your code to the <code>On Load</code> event.</p>\n"}], "owner": {"reputation": 45, "user_id": 6710503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ee634892116d4089dcff582a31653d?s=128&d=identicon&r=PG&f=1", "display_name": "Adri", "link": "https://stackoverflow.com/users/6710503/adri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 59074914, "answer_count": 1, "score": 1, "last_activity_date": 1594348988, "creation_date": 1574862339, "last_edit_date": 1594348988, "question_id": 59071630, "link": "https://stackoverflow.com/questions/59071630/labels-do-not-disappear", "title": "Labels do not disappear", "body": "<p>On a report I have a grouptxt.\nOn opening I'm trying to manipulate some labels.\nWhen Rit = 0 then the labels and txt should be true or false (see below).\nBut it doesn't work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Groepskoptekst1_Format(Cancel As Integer, FormatCount As Integer)\n    If Me.Rit = 0 Or IsNull(Me.Rit) Then\n        Me.lblDatum.Visible = True\n        Me.Datum.Visible = True\n        Me.Rit.Visible = False\n        Me.lblRit.Visible = False\n        Me.GeenRit.Visible = True\n        Me.Traject.Visible = False\n        Me.lblKm.Visible = False\n    Else\n        Me.lblDatum.Visible = True\n        Me.Datum.Visible = True\n        Me.Rit.Visible = True\n        Me.lblRit.Visible = True\n        Me.GeenRit.Visible = False\n        Me.Traject.Visible = True\n        Me.lblKm.Visible = True\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powershell"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1574861010, "post_id": 59070787, "comment_id": 104380290, "body": "Maybe a 32 bits Powershell trying to run a 64 bits Access, or vice versa?"}, {"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1574861791, "post_id": 59070787, "comment_id": 104380757, "body": "I do have 32-bit MS Access. I just tried running the script on  Windows PowerShell ISE (x86) and I received the same error. Is there anything else I should test in regards to a 32-bit and 64-bit mismatch?"}, {"owner": {"reputation": 3830, "user_id": 3156906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db841c057fb6288bd0d97017a52b9568?s=128&d=identicon&r=PG&f=1", "display_name": "mclayton", "link": "https://stackoverflow.com/users/3156906/mclayton"}, "edited": false, "score": 1, "creation_date": 1574861842, "post_id": 59070787, "comment_id": 104380792, "body": "Looks like your central IT department has added some rules to Grouo Policy to configure PowerShell Execution Policy. From the error message, they\u2019ve set it to Remote Signed. In my experience that\u2019s normally enough to run most scripts - are you sure you need \u201cBypass\u201d, or could you just use Remote Signed?"}, {"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "edited": false, "score": 0, "creation_date": 1574862032, "post_id": 59070787, "comment_id": 104380900, "body": "I believe Remote Signed works just fine. I have run into this before. I normally hit &quot;Accept All&quot; and it works. Should I do anything with the policy then?"}], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "edited": false, "score": 0, "creation_date": 1574874641, "post_id": 59073075, "comment_id": 104388022, "body": "I don&#39;t have the option to run as an administrator by right clicking. I thought that was the case before, but it was working just fine. It just broke all of a sudden with no changes on my end. Can I run it elevated another way? I will have to get IT to do it with their admin privileges then."}, {"owner": {"reputation": 61, "user_id": 8941510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1461868ed05b64a3c832938185ee3035?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell Agee", "link": "https://stackoverflow.com/users/8941510/darrell-agee"}, "reply_to_user": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "edited": false, "score": 0, "creation_date": 1574973129, "post_id": 59073075, "comment_id": 104425103, "body": "I would say see if you can get them to run it and see if that works.  That would at least tell you if there was an issue related to permissions.  It could have been they pushed some policy changes to the device.  If that is the issue then you might want to see if they can give you a service account or something to run with elevated permissions."}, {"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "edited": false, "score": 1, "creation_date": 1575519696, "post_id": 59073075, "comment_id": 104596118, "body": "I put in the ticket with my IT and I am waiting to hear back. I did not forget, and I appreciate your assistance. I will post back once I get them to try to run it elevated. I actually converted the entire process over to Python since I want to learn Python anyway, so it was a good learning experience."}, {"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "edited": false, "score": 0, "creation_date": 1576211187, "post_id": 59073075, "comment_id": 104833429, "body": "The IT guy couldn&#39;t figure anything out. I tried a few things and used his admin permissions, but nothing was working. The Python script is running great though, and it&#39;s better than the original script I created. I will try to elevate it to Tier 2 support and see. I appreciate your advice!"}], "tags": [], "owner": {"reputation": 61, "user_id": 8941510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1461868ed05b64a3c832938185ee3035?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell Agee", "link": "https://stackoverflow.com/users/8941510/darrell-agee"}, "is_accepted": false, "score": 1, "last_activity_date": 1574867030, "creation_date": 1574867030, "answer_id": 59073075, "question_id": 59070787, "link": "https://stackoverflow.com/questions/59070787/powershell-exception-calling-unable-to-cast-com-object-error-loading-type-li/59073075#59073075", "title": "PowerShell Exception Calling &quot;Unable to cast COM object&quot; - Error loading type library/DLL", "body": "<p>So if I am understanding the problem the solution should be quite simple.  Before you run the Powershell script right click on it and hit run as administrator.  The reason the error is occurring is that you need escalated privileges to set the execution policy. As for the other issue it may be that those files are now protected and therefore unable to load so by using the run as administration option it should allow it to access those files.</p>\n\n<p>I have had several issue in the past where just running with escalated permissions has fixed problems.  Now I would not do this as a permanent fix but if this works it would at least get it working again.<a href=\"https://blogs.msdn.microsoft.com/aaron_margosis/2004/06/17/why-you-shouldnt-run-as-admin/\" rel=\"nofollow noreferrer\">This is why you shouldn't</a></p>\n"}], "owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574867030, "creation_date": 1574859432, "question_id": 59070787, "link": "https://stackoverflow.com/questions/59070787/powershell-exception-calling-unable-to-cast-com-object-error-loading-type-li", "title": "PowerShell Exception Calling &quot;Unable to cast COM object&quot; - Error loading type library/DLL", "body": "<p>I have the following script in PowerShell which has been executing fine for months. I did not change anything, but I am receiving the error below. I've tried on other machines, but I keep receiving the same error. Any assistance or guidance would be greatly appreciated. I would have to get our IT involved for any registry or permission changes, and I would have to walk them through the process as well.</p>\n\n<p><strong>Script</strong></p>\n\n<pre><code># start Excel\n$excel = New-Object -comobject Excel.Application\n$ms_access = New-Object -comobject Access.Application\n\nfunction Test-IsFileAvailable {\n    [CmdletBinding()]\n    param (\n        [parameter(Mandatory = $true, ValueFromPipeline = $true, Position = 0)]\n        [string]$Path\n    )\n\n    if (!(Test-Path -Path $Path -PathType Leaf)) {\n        # the file is not found\n        Write-Verbose \"File '$Path' not found.\"\n        return $false\n    }\n\n    try {\n        $file   = New-Object System.IO.FileInfo $Path\n        $stream = $file.Open([System.IO.FileMode]::Open, \n                             [System.IO.FileAccess]::ReadWrite, \n                             [System.IO.FileShare]::None)\n\n        if ($stream) { $stream.Close() }\n        Write-Verbose \"File '$Path' is not locked.\"\n        return $true\n    } \n    catch {\n        # file is locked by a process.\n        Write-Verbose \"File '$Path' is locked by another process.\"\n        return $false\n    }\n}\n\n#set path files\n$FilePath_raw = 'N:\\DATA\\StatusReport_Raw.xlsx'\n\n$FilePath_report = 'N:DATA\\StatusReport.xlsx'\n\n$FilePath_date = 'N:\\DATA\\ReportDate.xlsx'\n\n$FilePath_access = \"N:\\DATA\\Access\\Processing.accdb\"\n\nif (!(Test-IsFileAvailable $FilePath_raw -Verbose)) { exit }\nif (!(Test-IsFileAvailable $FilePath_report -Verbose)) { exit }\nif (!(Test-IsFileAvailable $FilePath_date -Verbose)) { exit }\nif (!(Test-IsFileAvailable $FilePath_access -Verbose)) { exit }\n\n\n#make it visible ($true) or invisible ($false)\n$excel.Visible = $false\n\n$wb_eval1 = $excel.Workbooks.Open($FilePath_raw)\n$ws_eval1 = $wb_eval1.sheets.Item(1)\n\n$wb_eval2 = $excel.Workbooks.Open($FilePath_report)\n$ws_eval2 = $wb_eval2.sheets.Item(1)\n\n$wb_date = $excel.Workbooks.Open($FilePath_date)\n$ws_date = $wb_date.sheets.Item(1)\n\n$ws_eval2.Cells.Clear()\n$lrow2 = $ws_eval1.usedRange.Rows.Count\n$range2=$ws_eval1.Range(\"A3:AA$lrow2\")\n$range2.copy()\n$cpy_range_eval = $ws_eval2.Range(\"A1\")\n$ws_eval2.Paste($cpy_range_eval)\n\n$date_range = $ws_eval1.Range(\"B1\")\n$date_range.copy()\n\n$cpy_range_date = $ws_date.Range(\"A2\")\n$ws_date.Paste($cpy_range_date)\n\n$wb_date.Save()\n$wb_date.Close()\n\n$wb_eval2.Save()\n$wb_eval2.Close()\n$wb_eval1.Close()\n\n$ms_access.OpenCurrentDatabase($Filepath_access)\n$ms_access.Run(\"ExportExcel\")\n\n$excel.Quit() \n$ms_access.Quit()\n\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($wb_eval1)  | Out-Null\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($wb_eval2)  | Out-Null\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($wb_date)   | Out-Null\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel)     | Out-Null\n[System.Runtime.Interopservices.Marshal]::ReleaseComObject($ms_access) | Out-Null\n[System.GC]::Collect()\n[System.GC]::WaitForPendingFinalizers()\n$excel = $ms_access = $null\n\n$wshell = New-Object -ComObject Wscript.Shell\n$output = $wshell.Popup(\"The task has finished\")\n\n\nAdd-Type -AssemblyName System.Windows.Forms\n$global:balloon = New-Object System.Windows.Forms.NotifyIcon\n$path = (Get-Process -id $pid).Path\n$balloon.Icon = [System.Drawing.Icon]::ExtractAssociatedIcon($path)\n$balloon.BalloonTipIcon = [System.Windows.Forms.ToolTipIcon]::Info \n$balloon.BalloonTipText = 'The reports have been processed.'\n$balloon.BalloonTipTitle = \"Attention $Env:USERNAME\" \n$balloon.Visible = $true \n$balloon.ShowBalloonTip(20000)\n</code></pre>\n\n<p><strong>Error Message</strong></p>\n\n<pre><code>Set-ExecutionPolicy : Windows PowerShell updated your execution policy successfully, but the setting is overridden by a policy defined at a more specific scope.  Due to the override, your\nshell will retain its current effective execution policy of RemoteSigned. Type \"Get-ExecutionPolicy -List\" to view your execution policy settings. For more information please see \"Get-Help\nSet-ExecutionPolicy\".\nAt line:1 char:46\n+ ...  -ne 'AllSigned') { Set-ExecutionPolicy -Scope Process Bypass }; &amp; 'N ...\n+                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : PermissionDenied: (:) [Set-ExecutionPolicy], SecurityException\n    + FullyQualifiedErrorId : ExecutionPolicyOverride,Microsoft.PowerShell.Commands.SetExecutionPolicyCommand\nVERBOSE: File 'N:\\DATA\\StatusReport_Raw.xlsx' is not locked.\nVERBOSE: File 'N:\\DATA\\StatusReport.xlsx' is not locked.\nVERBOSE: File 'N:\\DATA\\ReportDate.xlsx' is not locked.\nVERBOSE: File 'N:\\DATA\\Access\\Processing.accdb' is not locked.\nTrue\nTrue\nTrue\nException calling \"OpenCurrentDatabase\" with \"1\" argument(s): \"Unable to cast COM object of type\n'Microsoft.Office.Interop.Access.ApplicationClass' to interface type 'Microsoft.Office.Interop.Access._Application'.\nThis operation failed because the QueryInterface call on the COM component for the interface with IID\n'{68CCE6C0-6129-101B-AF4E-00AA003F0F07}' failed due to the following error: Error loading type library/DLL. (Exception\nfrom HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY)).\"\nAt N:\\RUN\\RUN.ps1:82 char:1\n+ $ms_access.OpenCurrentDatabase($Filepath_access)\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\n    + FullyQualifiedErrorId : InvalidCastException\n\nException calling \"Run\" with \"1\" argument(s): \"Unable to cast COM object of type\n'Microsoft.Office.Interop.Access.ApplicationClass' to interface type 'Microsoft.Office.Interop.Access._Application'.\nThis operation failed because the QueryInterface call on the COM component for the interface with IID\n'{68CCE6C0-6129-101B-AF4E-00AA003F0F07}' failed due to the following error: Error loading type library/DLL. (Exception\nfrom HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY)).\"\nAt N:\\RUN\\RUN.ps1:83 char:1\n+ $ms_access.Run(\"ExportExcel\")\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\n    + FullyQualifiedErrorId : InvalidCastException\n\nException calling \"Quit\" with \"0\" argument(s): \"Unable to cast COM object of type\n'Microsoft.Office.Interop.Access.ApplicationClass' to interface type 'Microsoft.Office.Interop.Access._Application'.\nThis operation failed because the QueryInterface call on the COM component for the interface with IID\n'{68CCE6C0-6129-101B-AF4E-00AA003F0F07}' failed due to the following error: Error loading type library/DLL. (Exception\nfrom HRESULT: 0x80029C4A (TYPE_E_CANTLOADLIBRARY)).\"\nAt N:\\RUN\\RUN.ps1:86 char:1\n+ $ms_access.Quit()\n+ ~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\n    + FullyQualifiedErrorId : InvalidCastException\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574861372, "post_id": 59070329, "comment_id": 104380509, "body": "you need to reset <code>Start</code> at page 1 otherwise it isn&#39;t set when going to the screen saver.  I think"}, {"owner": {"reputation": 1520, "user_id": 1401087, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/9ggcn.png?s=128&g=1", "display_name": "Andrew Morris", "link": "https://stackoverflow.com/users/1401087/andrew-morris"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574862171, "post_id": 59070329, "comment_id": 104380965, "body": "@Nathan_Sav It&#39;s not really had any effect, I think I need a way of resetting the timer each time, it seems as though it&#39;s just doing that while loop regardless. Is that the correct kinda way you&#39;d write a countdown though? Like I say, I&#39;m not a VBA man"}], "answers": [{"tags": [], "owner": {"reputation": 521, "user_id": 12268796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LVipW.jpg?s=128&g=1", "display_name": "barneyos", "link": "https://stackoverflow.com/users/12268796/barneyos"}, "is_accepted": false, "score": 0, "last_activity_date": 1574874956, "creation_date": 1574874956, "answer_id": 59075368, "question_id": 59070329, "link": "https://stackoverflow.com/questions/59070329/making-a-fake-screensaver-in-ppt-using-vba/59075368#59075368", "title": "Making a fake screensaver in PPT using VBA", "body": "<p>Try maybe something like below (using class events)</p>\n\n<pre><code>' AppEvents class module\nOption Explicit\n\nPublic WithEvents App As Application\n\nConst Delay As Integer = 5\n\nDim Start\nDim actualSlide As Integer\n\n\nPrivate Sub App_SlideShowNextSlide(ByVal Wn As SlideShowWindow)\n    With Wn.Presentation.SlideShowWindow\n        Start = Timer\n        actualSlide = .View.Slide.SlideIndex\n        If actualSlide &gt; 1 Then\n            Do While Timer &lt; Start + Delay\n                DoEvents\n                If .View.Slide.SlideIndex &lt;&gt; actualSlide Then\n                    Start = Timer\n                    actualSlide = .View.Slide.SlideIndex\n                End If\n            Loop\n            .View.GotoSlide (.Presentation.Slides(1).SlideIndex)\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Module code</p>\n\n<pre><code>' Module 1\nOption Explicit\n\nPublic pApp As AppEvents\n\nSub GetAppClass()\n    Set pApp = New AppEvents\n    Set pApp.App = Application\n    ActivePresentation.SlideShowSettings.Run\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1520, "user_id": 1401087, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/9ggcn.png?s=128&g=1", "display_name": "Andrew Morris", "link": "https://stackoverflow.com/users/1401087/andrew-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1582096432, "creation_date": 1574857930, "last_edit_date": 1582096432, "question_id": 59070329, "link": "https://stackoverflow.com/questions/59070329/making-a-fake-screensaver-in-ppt-using-vba", "title": "Making a fake screensaver in PPT using VBA", "body": "<p>I'm trying to mimic a screensaver on PowerPoint that will return to my first slide after X amount of seconds of inactivity.</p>\n\n<p>The PowerPoint presentation is all just completely image based and every click will transition through the slides, so it doesn't have to be sophisticated at all, just that at the start of each slide it counts down 5 seconds, then returns to slide 1 (which is my fake screensaver page).</p>\n\n<p>I've already got something working in a basic format, it takes you to the first page after 5 seconds, but the timer doesn't restart once you go to a new slide, once it starts counting down, regardless of if you move to the next slide after 3 seconds, you don't get another 5 second countdown, it just finishes the remaining 2 seconds and redirects you.</p>\n\n<p>VBA is definitely not my primary language, I'm just piecing this together with what I can find, but my current code is below</p>\n\n<pre><code>Sub Auto_NextSlide(Index As Long)\n\nDim Delay, Start\n\nIf Index &gt; 1 Then\n    Delay = 5\n    Start = Timer\n    Do While Timer &lt; Start + Delay\n        DoEvents\n    Loop\n\n    SlideShowWindows(1).View.GotoSlide (SlideShowWindows(1).Presentation.Slides(1).SlideIndex)\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 15, "user_id": 6865957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1c6bfb172bd7f7c3d1ddc8b66acdc7?s=128&d=identicon&r=PG&f=1", "display_name": "ferocious12", "link": "https://stackoverflow.com/users/6865957/ferocious12"}, "edited": false, "score": 0, "creation_date": 1574941572, "post_id": 59070090, "comment_id": 104411366, "body": "edited please unmark as on hold"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6865957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1c6bfb172bd7f7c3d1ddc8b66acdc7?s=128&d=identicon&r=PG&f=1", "display_name": "ferocious12", "link": "https://stackoverflow.com/users/6865957/ferocious12"}, "edited": false, "score": 0, "creation_date": 1574924235, "post_id": 59077950, "comment_id": 104402696, "body": "Thank you !  Couple of things if you can help more: 1. I want the url of the image in column C, I tried it by it&#39;s attribute &quot;c1ZEkM&quot; but didn&#39;t work. 2. how can I loop through all the pages if it is more than one e.g. in this case there are 3 pages <a href=\"https://www.daraz.lk/ac/?from=input&amp;q=sarees\" rel=\"nofollow noreferrer\">daraz.lk/ac/?from=input&amp;q=sarees</a>"}, {"owner": {"reputation": 15, "user_id": 6865957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1c6bfb172bd7f7c3d1ddc8b66acdc7?s=128&d=identicon&r=PG&f=1", "display_name": "ferocious12", "link": "https://stackoverflow.com/users/6865957/ferocious12"}, "edited": false, "score": 0, "creation_date": 1575139647, "post_id": 59077950, "comment_id": 104468151, "body": "@Damian, Geert Bellekens, Ryan Wildry, SIM, QHarr. I have made the changes to the question but still I am banned from posting. Can you please have a look. Thanks"}], "tags": [], "owner": {"reputation": 1819, "user_id": 10046897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58775bff3c1d7010b8568a75adacd3b?s=128&d=identicon&r=PG&f=1", "display_name": "Zwenn", "link": "https://stackoverflow.com/users/10046897/zwenn"}, "is_accepted": true, "score": 0, "last_activity_date": 1574887473, "last_edit_date": 1574887473, "creation_date": 1574886365, "answer_id": 59077950, "question_id": 59070090, "link": "https://stackoverflow.com/questions/59070090/web-scraping-excel-vba/59077950#59077950", "title": "Web Scraping excel VBA", "body": "<p>The macro you posted is a little creepy for different reasons. Use this to reach your goal:</p>\n\n<pre><code>Sub WriteOutProductInfo()\n\n'This macro works on the sheet it's startetd from\n\nDim browser As Object\nDim url As String\nDim nodesAllOffers As Object\nDim nodeOneOffer As Object\nDim currentRow As Long\n\n  'Row, for title and price for current offer\n  currentRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row + 1\n  'Make sure that line 2 is the start line if nothing has been entered in the table yet\n  If currentRow = 1 Then currentRow = 2\n\n  'Your sample url\n  'You can loop over various urls from a table with the following code\n  '(Loop not included here)\n  url = \"https://www.daraz.lk/catalog/?from=input&amp;q=sarees&amp;ppath=31186:3287\"\n\n  'Initialize Internet Explorer, set visibility,\n  'call URL and wait until page is fully loaded\n  Set browser = CreateObject(\"internetexplorer.application\")\n  browser.Visible = False\n  browser.navigate url\n  Do Until browser.ReadyState = 4: DoEvents: Loop\n\n  'Get all html elements with the css class \"c3KeDq\" in a node collection\n  'These are all offers of the called page, which contain in each case\n  'the connected information (title and price)\n  '\n  'This is a sample of the html code for one offer\n  '&lt;div class=\"c3KeDq\"&gt;\n  '  &lt;div class=\"c3vCyH\"&gt;\n  '  &lt;/div&gt;\n  '  &lt;div class=\"c16H9d\"&gt;\n  '    &lt;a age=\"0\" href=\"//www.daraz.lk/products/ladies-office-and-saree-wear-brown-i102604104-s1009196133.html?search=1\"\n  '       title=\"Ladies Office And Saree Wear - Brown\"&gt;\n  '      Ladies Office And Saree Wear - Brown\n  '    &lt;/a&gt;\n  '  &lt;/div&gt;\n  '  &lt;div class=\"c3gUW0\"&gt;\n  '    &lt;span class=\"c13VH6\"&gt;\n  '      Rs. 1,150\n  '    &lt;/span&gt;\n  '  &lt;/div&gt;\n  '  &lt;div class=\"c3lr34\"&gt;\n  '  &lt;/div&gt;\n  '  &lt;div class=\"c15YQ9\"&gt;\n  '    &lt;span class=\"c2i43- c1enUu\" title=\"Sri Lanka\"&gt;\n  '      Sri Lanka\n  '    &lt;/span&gt;\n  '  &lt;/div&gt;\n  '  &lt;div class=\"c2attd\"&gt;\n  '    &lt;div class=\"c31VUX\"&gt;\n  '      &lt;button age=\"0\" type=\"button\" class=\"ant-btn c1xzE_ ant-btn-primary ant-btn-lg\"&gt;\n  '        ADD TO CART\n  '      &lt;/button&gt;\n  '    &lt;/div&gt;\n  '  &lt;/div&gt;\n  '&lt;/div&gt;\n  Set nodesAllOffers = browser.document.getElementsByClassName(\"c3KeDq\")\n  If Not nodesAllOffers Is Nothing Then\n    'If we got the node collection\n    'We step through all offers and pull the titel and price out\n    For Each nodeOneOffer In nodesAllOffers\n      'Get title\n      ActiveSheet.Cells(currentRow, 1).Value = getValueByClassName(nodeOneOffer, \"c16H9d\")\n      'Get price\n      ActiveSheet.Cells(currentRow, 2).Value = getValueByClassName(nodeOneOffer, \"c13VH6\")\n      'Next offer (row)\n      currentRow = currentRow + 1\n    Next nodeOneOffer\n  End If\n\n  'Clean up\n  browser.Quit\n  Set browser = Nothing\n  Set nodesAllOffers = Nothing\n  Set nodeOneOffer = Nothing\nEnd Sub\n</code></pre>\n\n<p>And this function:</p>\n\n<pre><code>Private Function getValueByClassName(htmlNode As Object, cssClassName As String) As String\n\n'This function works with a single node\n'If htmlNode is a node collection, you will got only the first value\n\nDim nodeByClassName As Object\nDim resultString As String\n\n  'Try to get wanted node\n  Set nodeByClassName = htmlNode.getElementsByClassName(cssClassName)(0)\n  If Not nodeByClassName Is Nothing Then\n    'If we got the class node\n    'Take innertext\n    resultString = Trim(nodeByClassName.innertext)\n  End If\n\n  'Clean up\n  Set nodeByClassName = Nothing\n\n  'Return result string\n  getValueByClassName = resultString\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 6865957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e1c6bfb172bd7f7c3d1ddc8b66acdc7?s=128&d=identicon&r=PG&f=1", "display_name": "ferocious12", "link": "https://stackoverflow.com/users/6865957/ferocious12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1353, "favorite_count": 0, "closed_date": 1574890794, "accepted_answer_id": 59077950, "answer_count": 1, "score": 0, "last_activity_date": 1575139053, "creation_date": 1574857134, "last_edit_date": 1575139053, "question_id": 59070090, "link": "https://stackoverflow.com/questions/59070090/web-scraping-excel-vba", "closed_reason": "Needs details or clarity", "title": "Web Scraping excel VBA", "body": "<p>I want to scrap product titles, prices, seller and image url from an eCommerce website. The results need to be copied to active sheet in column A-D. Below code was originally developed for Amazon by one of @QHarr. Any help to update it to get the desired result?</p>\n\n<p>I have included the image how the result will look like. Thanks</p>\n\n<pre><code>Public Sub WriteOutProductInfo()\n\n'VBE&gt;Tools&gt;References&gt; Microsoft HTML Object Library\nDim html As MSHTML.HTMLDocument\n\nSet html = New MSHTML.HTMLDocument\n\nWith CreateObject(\"MSXML2.XMLHTTP\")\n    ' change the url for the page of amazon from where to copy data\n    .Open \"GET\", \"https://www.daraz.lk/catalog/?from=input&amp;q=sarees&amp;ppath=31186:3287\", False\n    .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n    .send\n    html.body.innerHTML = .responseText\nEnd With\n\n' 1. declare additional headers as variable\n\nDim headers(), titles As Object, prices As Object, original_prices As Object\nDim seller As Object\n\nheaders = Array(\"Title\", \"Price\")\n\nWith html\n    Set titles = .querySelectorAll(\".c3gUW0,.c13VH6\")\n    Set prices = .querySelectorAll(\".------------\")\nEnd With\n\nDim results(), r As Long, priceInfo As String\n\nReDim results(1 To titles.Length, 1 To UBound(headers) + 1)\n\nFor r = 0 To titles.Length - 1\n    results(r + 1, 1) = titles.Item(r).innerText        \nNext\n\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\nWith ws\n    .Cells(1, 1).Resize(1, UBound(headers) + 1) = headers\n    .Cells(2, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\nEnd With\n\nEnd sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QAxAV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QAxAV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574859501, "post_id": 59070035, "comment_id": 104379469, "body": "How many possible <code>Status</code> value do you have? 3?"}, {"owner": {"reputation": 1, "user_id": 11055543, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7H8zJ59SyiM/AAAAAAAAAAI/AAAAAAAADqQ/jFfx8ihcTXE/photo.jpg?sz=128", "display_name": "Yousef Rifai", "link": "https://stackoverflow.com/users/11055543/yousef-rifai"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574869795, "post_id": 59070035, "comment_id": 104385398, "body": "I have 5 status values in total"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11055543, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7H8zJ59SyiM/AAAAAAAAAAI/AAAAAAAADqQ/jFfx8ihcTXE/photo.jpg?sz=128", "display_name": "Yousef Rifai", "link": "https://stackoverflow.com/users/11055543/yousef-rifai"}, "edited": false, "score": 0, "creation_date": 1574869887, "post_id": 59070520, "comment_id": 104385457, "body": "Thanks for the advice, I will try that out"}], "tags": [], "owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "is_accepted": false, "score": 0, "last_activity_date": 1574858568, "creation_date": 1574858568, "answer_id": 59070520, "question_id": 59070035, "link": "https://stackoverflow.com/questions/59070035/if-a-cell-in-column-a-in-sheet-2-equal-to-a-value-from-sheet-1-then-return-the-v/59070520#59070520", "title": "If a cell in column A in sheet 2 equal to a value from sheet 1 then return the values from sheet 2 to column B and c in sheet 1", "body": "<p>This can be done with formulas, however getting the latest value isn't as easy as it seems. This can be achieved however by following <a href=\"https://exceljet.net/how-to-lookup-first-and-last-match\" rel=\"nofollow noreferrer\">this tutorial</a> for reference. I especially refer to the part using <code>LOOKUP(</code>.</p>\n\n<p>Other than that, all you need to do is set your ranges to refer to the correct sheet.</p>\n\n<pre><code>=IFNA(LOOKUP(2,1/(Sheet2!A:A=Sheet1!A2),Sheet2!B:B),\"\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 11055543, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7H8zJ59SyiM/AAAAAAAAAAI/AAAAAAAADqQ/jFfx8ihcTXE/photo.jpg?sz=128", "display_name": "Yousef Rifai", "link": "https://stackoverflow.com/users/11055543/yousef-rifai"}, "edited": false, "score": 0, "creation_date": 1574869861, "post_id": 59070996, "comment_id": 104385445, "body": "Thank you, I will try it out"}], "tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1574860176, "creation_date": 1574860176, "answer_id": 59070996, "question_id": 59070035, "link": "https://stackoverflow.com/questions/59070035/if-a-cell-in-column-a-in-sheet-2-equal-to-a-value-from-sheet-1-then-return-the-v/59070996#59070996", "title": "If a cell in column A in sheet 2 equal to a value from sheet 1 then return the values from sheet 2 to column B and c in sheet 1", "body": "<p><a href=\"https://i.stack.imgur.com/vHVu1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vHVu1.png\" alt=\"enter image description here\"></a></p>\n\n<p>My formula in B2 is:</p>\n\n<pre><code>=INDEX(Sheet2!$B:$B;MAX(SI(Sheet2!$A:$A=Sheet1!A2;ROW(Sheet2!$A:$A)-MIN(ROW(Sheet2!$A:$A))+1)))\n</code></pre>\n\n<p>My formula in C2 IS:</p>\n\n<pre><code>=INDEX(Sheet2!$C:$C;MAX(SI(Sheet2!$A:$A=Sheet1!A2;ROW(Sheet2!$A:$A)-MIN(ROW(Sheet2!$A:$A))+1)))\n</code></pre>\n\n<blockquote>\n  <p><strong>Both formulas are array formulas</strong> so instead of entering them with <kbd>ENTER</kbd>, they must be entered pressing\n  <kbd>ENTER</kbd>+<kbd>CTRL</kbd>+<kbd>SHIFT</kbd> at same time</p>\n</blockquote>\n\n<p>Anyways, these formulas will probably make your file heavy and slower. Think about redesigning the way you save data, and consider adding a date field, and resuming data with Pivot Tables.</p>\n"}], "owner": {"reputation": 1, "user_id": 11055543, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-7H8zJ59SyiM/AAAAAAAAAAI/AAAAAAAADqQ/jFfx8ihcTXE/photo.jpg?sz=128", "display_name": "Yousef Rifai", "link": "https://stackoverflow.com/users/11055543/yousef-rifai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574860176, "creation_date": 1574856945, "last_edit_date": 1574857225, "question_id": 59070035, "link": "https://stackoverflow.com/questions/59070035/if-a-cell-in-column-a-in-sheet-2-equal-to-a-value-from-sheet-1-then-return-the-v", "title": "If a cell in column A in sheet 2 equal to a value from sheet 1 then return the values from sheet 2 to column B and c in sheet 1", "body": "<p>I am looking to do a kind of automatic cell updates on excel, which is a status update for a product we got and the location of the product in the warehouse. </p>\n\n<p>I have basic knowledge of VBA and I didn't manage to code anything to help me with that. I tried to use If function, but didn't make sense because I can't find a way to achieve what I need. </p>\n\n<p>Here is sheet 1</p>\n\n<p><img src=\"https://i.stack.imgur.com/gdB09.png\" alt=\"Sheet one\"></p>\n\n<p>and sheet 2</p>\n\n<p><img src=\"https://i.stack.imgur.com/4z7Jx.png\" alt=\"enter image description here\"></p>\n\n<p>examples.</p>\n\n<p>This is what I am trying to achieve: \nif a cell within Sheet2 column A range = Cell A2 in sheet 1, then fill Sheet1, B2 cell and Sheet1, C2 cell with the information from sheet2 on the condition that it is the most recent entry (in the example images it is the entry with the dispatched status) </p>\n\n<p>Would you recommend VBA or using formulas, and if so what should I do?</p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12445324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/860f76ef4f470c52fadea7877efdf3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Joy", "link": "https://stackoverflow.com/users/12445324/joy"}, "edited": false, "score": 0, "creation_date": 1574864440, "post_id": 59069713, "comment_id": 104382334, "body": "Thank you so much for your answer, I&#39;m am so rusty having not used access for the past 15 years."}], "tags": [], "owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "is_accepted": false, "score": 0, "last_activity_date": 1574855816, "creation_date": 1574855816, "answer_id": 59069713, "question_id": 59069463, "link": "https://stackoverflow.com/questions/59069463/comparing-fields-to-allow-action/59069713#59069713", "title": "Comparing fields to allow action", "body": "<p>checking isnull would be <code>IsNull(fieldName)</code> and your <code>If</code> is wrong too.</p>\n\n<p>try this</p>\n\n<pre><code>If([Quote Status] = \"Accepted\" And nz([Customer PO Number],\"\") = \"\") Then \n    MsgBox \"Please complete Customer PO Number before setting Status to Accepted\"\nEnd If\n</code></pre>\n\n<p><em>Note:</em>\navoid having spaces in your field names.</p>\n"}], "owner": {"reputation": 1, "user_id": 12445324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/860f76ef4f470c52fadea7877efdf3c4?s=128&d=identicon&r=PG&f=1", "display_name": "Joy", "link": "https://stackoverflow.com/users/12445324/joy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593766815, "creation_date": 1574855057, "last_edit_date": 1593766815, "question_id": 59069463, "link": "https://stackoverflow.com/questions/59069463/comparing-fields-to-allow-action", "title": "Comparing fields to allow action", "body": "<p>I want to stop the user continuing if certain criteria are not met.</p>\n\n<p>I have a table with a 'Quote Status' Field and a 'Customer PO Number' field. I want to make sure if the quote status is changed to \"accepted\" the Customer PO Number field is completed.</p>\n\n<p>I tried various ways at various points of validation (field updates and user exits).</p>\n\n<p>The basic code.</p>\n\n<pre><code>= IIf([Quote Status] = \"Accepted\" And [Customer PO Number] IsNull Then \n = MsgBox \"Please complete Customer PO Number before setting Status to Accepted\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574855436, "post_id": 59069408, "comment_id": 104377149, "body": "Answer to your first question: changed formula outputs are not recognized as <code>Change</code> events, however you can catch them through the <code>Calculate</code> event. Have alook <a href=\"https://stackoverflow.com/a/11409569/9758194\">here</a>"}, {"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1574855518, "post_id": 59069408, "comment_id": 104377202, "body": "As you now know, the <code>Change</code> event is not triggered by a formula update.  <i>If</i> my understanding of <b>Volatile Functions</b> is correct, then you can create a <b>Volatile UDF</b> that will achieve your goals.  Please understand I have not tested to confirm my understanding is accurate, let alone suitable for your purpose, but I do believe it is worth exploring."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1574855751, "post_id": 59069408, "comment_id": 104377322, "body": "Instead of using formulas to update your child values, you could get around this issue altogether by updating your child values with VBA instead. You could trigger this with a <code>change</code> event."}], "owner": {"reputation": 2010, "user_id": 568074, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/703433b0a4b362e4c1041f8f2f46832c?s=128&d=identicon&r=PG", "display_name": "Timoth&#233;e Bourguignon", "link": "https://stackoverflow.com/users/568074/timoth%c3%a9e-bourguignon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574855997, "creation_date": 1574854848, "last_edit_date": 1574855997, "question_id": 59069408, "link": "https://stackoverflow.com/questions/59069408/do-not-update-linked-excel-cell-based-on-a-timestamp", "title": "Do not update linked Excel cell based on a timestamp", "body": "<p>First question: two Excel cells are linked (A6 = A3). When I update A3, A6 gets updated. </p>\n\n<p>How can I register to the change event of A6?</p>\n\n<p>By using the following VBA code, I register to the change event of A3, but I cannot find how to register for the automatic change of A6. </p>\n\n<ol>\n<li>Any idea how to do this?</li>\n</ol>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(\"A14:A15\"))_\n            Is Nothing Then\n        MsgBox \"Cell \" &amp; Target.Address &amp; \" has changed.\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>Here's the broader scenario that I am trying to achieve: Depending of the value of a timestamp, I would like the second cell to update itself, or keep its current value. </p>\n\n<p>Here's the current behavior. A6 and A7 reference A3. If I update A3 to \"2\", A6 and A7 gets updated to \"2\" as well. Regardless what the timestamp says (the C column just contains the formula used in the B column, for explanation purpose):</p>\n\n<p><a href=\"https://i.stack.imgur.com/U24Vc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/U24Vc.png\" alt=\"Example1\"></a></p>\n\n<p>What I would like to achieve is the following. </p>\n\n<p><a href=\"https://i.stack.imgur.com/3I9sP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3I9sP.png\" alt=\"Example2\"></a></p>\n\n<p>The timestamp B6 is one minute in the past and B7 one minute in the future. After updating A3 to \"2\", I want A6 to remain \"1\", and B7 to update itself to \"2\".</p>\n\n<p>In order to do this, I thought I can use the change event described above and block the update event after I tested the timestamps in a macro. </p>\n\n<ol start=\"2\">\n<li>Any better idea on how to achieve this?</li>\n</ol>\n"}, {"tags": ["vba", "ms-access", "outlook", "html-email"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1574862709, "post_id": 59071647, "comment_id": 104381273, "body": "But note that most mail clients won&#39;t load external images automatically, so the recipient needs to click &quot;load images&quot; (or similar) before the image is shown."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1574862413, "creation_date": 1574862413, "answer_id": 59071647, "question_id": 59069401, "link": "https://stackoverflow.com/questions/59069401/inserting-an-ole-object-image-into-an-html-email-using-access-vba/59071647#59071647", "title": "Inserting an OLE Object image into an html email using Access VBA", "body": "<p>You must have the image stored somewhere where anyone can reach it fast. If not, you will have to build a MIME message with the embedded image which is more complicated and may bloat the message.</p>\n\n<p>We use <a href=\"https://imgur.com/\" rel=\"nofollow noreferrer\">Imgur</a> to store the images. This is free, fast, and will run \"forever\".</p>\n\n<p>Here is an example of a file in use as my signature:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\n\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"da\" charset=\"iso-8859-1\"&gt;\n\n&lt;head&gt;\n    &lt;title&gt;E-mailsignatur Cactus Data ApS&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body style=\"font-family: calibri, 'segoe ui', helvetica, arial, sans-serif\"&gt;\n\n    &lt;span style=\"font-size: 11pt\"&gt;\n        Venlig hilsen / Best regards / Freundlichen Gr\u00fc\u00dfen&lt;br&gt;\n        Gustav Brock\n    &lt;/span&gt;\n    &lt;hr&gt;\n    &lt;p style=\"text-align: center; margin-top: 10px; margin-bottom: 0px;\"&gt;\n        &lt;img src=\"https://i.imgur.com/HbdRTBD.gif\" alt=\"Cactus Data ApS\" title=\"Cactus Data ApS\" /&gt;&lt;br&gt;\n        &lt;span style=\"font-size: 9pt;\"&gt;\n            Kalkbr\u00e6nderil\u00f8bskaj 4 A \u00b7 2100 K\u00f8benhavn \u00d8 \u00b7 Danmark&lt;br&gt;\n            CVR/VAT: DK12002696 \u00b7 Telefon: +45 39 29 49 48 \u00b7 E-mail: &lt;a title=\"gustav@cactus.dk\" href=\"mailto:Gustav%20Brock%20%3cgustav@cactus.dk%3e?subject=Re:%20E-mail\"&gt;Gustav Brock&lt;/a&gt;\n        &lt;/span&gt;\n    &lt;/p&gt;\n    &lt;hr&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>When done and carefully tested (very important, as Outlook doesn't render exactly as the common browsers), it is a simple matter to create VBA that will recreate it.</p>\n\n<p>Or, alternatively as we do, store the complete HTML in a Note (Long Text) field and retrieve it when creating the e-mail.</p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1574898178, "creation_date": 1574898178, "answer_id": 59079899, "question_id": 59069401, "link": "https://stackoverflow.com/questions/59069401/inserting-an-ole-object-image-into-an-html-email-using-access-vba/59079899#59079899", "title": "Inserting an OLE Object image into an html email using Access VBA", "body": "<p>Using the Outlook Object Model? See <a href=\"https://stackoverflow.com/questions/17195207/including-pictures-in-an-outlook-email\">Including Pictures in an Outlook Email</a></p>\n\n<p>Keep in mind that OLE objects cannot be inserted into HTML messages - you either need to convert the OLE object to an image and add it as an attachment, or the message has to be in the RTF format, but then inserting OLE objects is not for the faint-hearted. </p>\n"}], "owner": {"reputation": 23, "user_id": 7474115, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154927012277433/picture?type=large", "display_name": "Chris", "link": "https://stackoverflow.com/users/7474115/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 59079899, "answer_count": 2, "score": 0, "last_activity_date": 1593960770, "creation_date": 1574854815, "last_edit_date": 1593960770, "question_id": 59069401, "link": "https://stackoverflow.com/questions/59069401/inserting-an-ole-object-image-into-an-html-email-using-access-vba", "title": "Inserting an OLE Object image into an html email using Access VBA", "body": "<p>I have to insert an image, stored in an Access table in an OLE Object field, into the body of an Outlook html email.</p>\n\n<p>I am building the html using a string variable, strBOD:</p>\n\n<pre><code>strBOD = strBOD &amp; \"&lt;tr&gt;\" &amp; \"&lt;img src=\"\"smiley.gif\"\" alt=\"\"Smiley face\"\" height=\"\"42\"\" width=\"\"42\"\"&gt;\" &amp; \"&lt;/tr&gt;\"\n</code></pre>\n\n<p>I need to replace the \"smiley.gif\" in the example above with the OLE Object.</p>\n"}, {"tags": ["excel", "vba", "search", "replace", "find"], "comments": [{"owner": {"reputation": 1555, "user_id": 6717520, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eobu4.jpg?s=128&g=1", "display_name": "phpdroid", "link": "https://stackoverflow.com/users/6717520/phpdroid"}, "edited": false, "score": 1, "creation_date": 1574854971, "post_id": 59069397, "comment_id": 104376885, "body": "what all have you tried please include in question?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574854982, "post_id": 59069397, "comment_id": 104376893, "body": "Use a simple loop through your list in sheet2 and utilize the <code>Range.Replace</code> method. Also, these things <i>have</i> been done before and are to be found on SO I&#39;m sure. They revolve around <a href=\"https://www.extendoffice.com/documents/excel/707-excel-replace-accented-characters.html\" rel=\"nofollow noreferrer\">this</a> function."}, {"owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "edited": false, "score": 0, "creation_date": 1574855142, "post_id": 59069397, "comment_id": 104377003, "body": "I have no VBA experience and hoped this may solve my issue. I have this problem often and normally manually check cell by cell and over type which takes hours!"}, {"owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "edited": false, "score": 0, "creation_date": 1574855176, "post_id": 59069397, "comment_id": 104377021, "body": "I found a few solutions on here but they don&#39;t work for my parameters and probably linking to the wring cells, sheets or data."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574855200, "post_id": 59069397, "comment_id": 104377039, "body": "Well, instead of cell-by-cell, you can find &gt; Replace &gt; All....if you do this manually. If you plan on using VBA, are you expecting others to write it for you? Or do you have some code?"}, {"owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "edited": false, "score": 0, "creation_date": 1574855257, "post_id": 59069397, "comment_id": 104377068, "body": "I&#39;ve tried a basic substitute string but I have like 89 characters so this becomes too long."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1574855350, "post_id": 59069397, "comment_id": 104377117, "body": "Try looping through Sheet2, columns A&amp;B. For each pair of the original character (<code>strChar</code>) &amp; desired replacement (<code>strRepl</code>) you can then do <code>Sheet1.UsedRange.Replace What:=strChar, Replacement:=strRepl</code>"}, {"owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "edited": false, "score": 0, "creation_date": 1574855528, "post_id": 59069397, "comment_id": 104377209, "body": "Sorry I thought that&#39;s what this site is for. I presumed it may already be available. I have found similar solutions but not quite exact so they don&#39;t work. Not to worry."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1574856098, "post_id": 59069397, "comment_id": 104377522, "body": "Hi Ross, SO is actually trying to help users with their existing solutions and tries to develop/improve their skills. Please edit your question to show us your approach (even the most basic, failed one), so that we can develop it together. You will benefit from it greatly as it will get you started with VBA and you will understand the code. Fingers crossed!"}, {"owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "edited": false, "score": 1, "creation_date": 1574856862, "post_id": 59069397, "comment_id": 104377953, "body": "Thanks Justyna. I have tried a few. Such as:  Sub Test()      Dim Sh1 As Worksheet     Dim Sh2 As Worksheet         Set Sh1 = Sheets(1)     Set Sh2 = Sheets(2)     For Each cel In Sh2.Columns(1).SpecialCells(2)  &#39;Text to find         With Sh1.Cells   &#39;Text to search             Set c = .Find(cel, lookat:=xlPart)             Do                 If Not c Is Nothing Then                     c.Value = Replace(c, cel, cel.Offset(, 1))                 End If                 Set c = .FindNext(c)             Loop Until c Is Nothing         End With     Next End Sub"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574858491, "post_id": 59069397, "comment_id": 104378910, "body": "Ross, best is to update your question with your attempt so that people that visit this page won&#39;t have to find this information in a comment."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1574858716, "post_id": 59069397, "comment_id": 104379027, "body": "Hey Ross, you almost got it! You can either use Dave&#39;s solution (posted below), or use your own code that I will adjust in a minute."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "edited": false, "score": 0, "creation_date": 1574860440, "post_id": 59070026, "comment_id": 104379959, "body": "Dave, you are a gent and a genius! \ud83d\udc4d This worked perfectly. Really appreciated."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574860932, "post_id": 59070026, "comment_id": 104380245, "body": "The solution for distinguishing between upper- and lowercase is right in front of your eyes. <code>MatchCase:=False</code> &gt; <code>MatchCase:=True</code>, and that would eliminate the need to iterate over all cells =)"}, {"owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "edited": false, "score": 0, "creation_date": 1574861805, "post_id": 59070026, "comment_id": 104380770, "body": "Thanks also to JvdV and Justyna. You are life savers. Well a huge amount of time savers. Thanks so much guys."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1580449992, "post_id": 59070026, "comment_id": 106108574, "body": "Why have you not picked this as an answer? don&#39;t leave threads unanswered!"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1574856914, "creation_date": 1574856914, "answer_id": 59070026, "question_id": 59069397, "link": "https://stackoverflow.com/questions/59069397/multiple-find-replace/59070026#59070026", "title": "Multiple Find &amp; Replace", "body": "<p>Experience has shown me that upper &amp; lower case chars are treated the same when using find and replace.</p>\n\n<p>The below sample uses column Q as the character to find and column R as the replacement. The code does the find replace for cells in column A</p>\n\n<pre><code>Sub Using_Replace()\n    Dim LstRw As Long, rng As Range, c As Range\n\n    LstRw = Cells(Rows.Count, \"Q\").End(xlUp).Row\n    Set rng = Range(\"Q1:Q\" &amp; LstRw)\n\n    For Each c In rng.Cells\n\n        Range(\"A:A\").Replace what:=c, Replacement:=c.Offset(, 1), _\n                             LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n                             SearchFormat:=False, ReplaceFormat:=False\n    Next c\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://i.stack.imgur.com/rvk2E.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rvk2E.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>When you test out the code you will notice the find/replace does not notice the difference between the characters in Q6 &amp; Q15.</p>\n\n<p>But if you loop through each cell, the differences are recognized.</p>\n\n<p>-</p>\n\n<pre><code>Sub Using_LikeLoop()\n    Dim LstRw As Long, rng As Range, c As Range\n    Dim frNg As Range, f As Range\n\n    LstRw = Cells(Rows.Count, \"Q\").End(xlUp).Row\n    Set rng = Range(\"Q1:Q\" &amp; LstRw)\n    Set frNg = Range(\"A1:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n\n    For Each c In rng.Cells\n\n        For Each f In frNg.Cells\n\n            If f Like \"*\" &amp; c &amp; \"*\" Then f = Replace(f, c, c.Offset(, 1))\n\n        Next f\n\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574860372, "post_id": 59070613, "comment_id": 104379939, "body": "Almost there, I would suggest including a <code>MatchCase</code> to distinguish between upper and lowercase =)"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574860654, "post_id": 59070613, "comment_id": 104380091, "body": "Then, if I would be nitpicking (I know, can be anoying), best is to iterate through memory, capturing sheet 2&#39;s values in a 2d-array. Nonetheless, good job, I can&#39;t upvote twice"}], "tags": [], "owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "is_accepted": false, "score": 2, "last_activity_date": 1574860461, "last_edit_date": 1574860461, "creation_date": 1574858884, "answer_id": 59070613, "question_id": 59069397, "link": "https://stackoverflow.com/questions/59069397/multiple-find-replace/59070613#59070613", "title": "Multiple Find &amp; Replace", "body": "<p>Ross, your solution almost did the trick. You can simplify it by using:</p>\n\n<pre><code>Sub ReplaceChar()\n    Dim Sh1 As Worksheet\n    Dim Sh2 As Worksheet\n    Dim cel As Range\n\n    Set Sh1 = Sheets(1)\n    Set Sh2 = Sheets(2)\n\n    For Each cel In Sh2.Columns(1).SpecialCells(2)\n        With Sh1.Cells\n            .Replace What:=cel, Replacement:=cel.Offset(, 1), MatchCase:=True\n        End With\n    Next\nEnd Sub\n</code></pre>\n\n<p>Sheet1 and Sheet2 before running the macro:</p>\n\n<p><a href=\"https://i.stack.imgur.com/buLz3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/buLz3.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/1KMLI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1KMLI.png\" alt=\"enter image description here\"></a></p>\n\n<p>...and here's Sheet1 after running the code:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xDBar.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xDBar.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 12445385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/697a91dc1b719532bb0f1c0a2f97fc7f?s=128&d=identicon&r=PG&f=1", "display_name": "Ross G 1209", "link": "https://stackoverflow.com/users/12445385/ross-g-1209"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574860461, "creation_date": 1574854801, "last_edit_date": 1574857093, "question_id": 59069397, "link": "https://stackoverflow.com/questions/59069397/multiple-find-replace", "title": "Multiple Find &amp; Replace", "body": "<p>I've trawled this site but not found anything exact for my issue.</p>\n\n<p>I have an excel file (Sheet1) containing various foreign characters (eg. \"\u00e4\" or \"\u00d6\") within multiple columns and rows (basically the entire sheet).</p>\n\n<p>In Sheet2 I have a list/table (Columns A &amp; B) of these characters (A) and what they need to be replaced with (B).</p>\n\n<p>I would like a VBA code to search for all of these characters in Sheet1 and replace them all with the corresponding alternative.</p>\n\n<p>Any help would be amazing.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 4, "creation_date": 1574853842, "post_id": 59069010, "comment_id": 104376279, "body": "Can we see how you populate the collection too?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 0, "creation_date": 1574854540, "post_id": 59069010, "comment_id": 104376663, "body": "<i>my VBA IDE insists on range</i> you have probably a global variable/sub/function named <code>range</code> somewhere in the code."}], "answers": [{"comments": [{"owner": {"reputation": 44021, "user_id": 8741, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/feef9dda8bbe41e9def78c274a37f60c?s=128&d=identicon&r=PG", "display_name": "ProfK", "link": "https://stackoverflow.com/users/8741/profk"}, "edited": false, "score": 1, "creation_date": 1574854275, "post_id": 59069217, "comment_id": 104376508, "body": "Yes, I was using <code>rangeCollection.Add(theRange)</code>, with parenthesis, which apparently forces the argumant to by passed <code>ByVal</code>. I removed the parenthesis and now my loop is working!"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 2, "last_activity_date": 1574854160, "creation_date": 1574854160, "answer_id": 59069217, "question_id": 59069010, "link": "https://stackoverflow.com/questions/59069010/why-does-this-vba-code-give-me-an-object-required-error/59069217#59069217", "title": "Why does this VBA code give me an Object Required error?", "body": "<p>The answer lays in the way you populate your collection I'm sure. For example see the following:</p>\n\n<pre><code>Sub Test()\n\nDim ranges As New Collection\nDim rng1 As Range, rng2 As Range, rng3 As Range\nDim cellRange As Range, cell As Range\n\nSet rng1 = Range(\"A1:A3\")\nSet rng2 = Range(\"B1:B3\")\nSet rng3 = Range(\"C1:C3\")\n\nranges.Add rng1\nranges.Add rng2\nranges.Add rng3\n\nFor Each cellRange In ranges\n    Debug.Print cellRange.Address\n    For Each cell In cellRange\n        Debug.Print cell.Address\n    Next cell\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 44021, "user_id": 8741, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/feef9dda8bbe41e9def78c274a37f60c?s=128&d=identicon&r=PG", "display_name": "ProfK", "link": "https://stackoverflow.com/users/8741/profk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 59069217, "answer_count": 1, "score": 0, "last_activity_date": 1574855415, "creation_date": 1574853532, "last_edit_date": 1574854060, "question_id": 59069010, "link": "https://stackoverflow.com/questions/59069010/why-does-this-vba-code-give-me-an-object-required-error", "title": "Why does this VBA code give me an Object Required error?", "body": "<p>I have the following code in an Excel macro:</p>\n\n<pre><code>Dim cellRange As range\nDim cell As range\nDim cellFormula As String\nDim yearCells As New Collection\n\nFor Each cellRange In ranges\n    For Each cell In cellRange.Cells\n        cellFormula = GetCellFormula(cell)\n        If (cellFormula = formulaYears) Then\n            yearCells.Add (cell)\n        End If\n    Next\nNext\n</code></pre>\n\n<p>Where <code>ranges</code> is a <code>Collection</code> object holding many Range objects.</p>\n\n<p>When I run the code, I get an \"Object required\" error on the line <code>For Each cellRange In ranges</code>. Why is this? After all, <code>cellRange</code> is declared as an object, i.e. <code>Dim cellRange As range</code>. If I convert the code to a <code>For</code> loop, I have the same error on a line:</p>\n\n<pre><code>Set cellRange = ranges(i)\n</code></pre>\n\n<p>BTW, my VBA IDE insists on <code>range</code> always having a lower case initial letter. When I type <code>Range</code> the editor \"corrects\" it to <code>range</code>. Yet other code using <code>range</code> objects works fine.</p>\n"}, {"tags": ["excel", "vba", "loops", "copy", "paste"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574852396, "post_id": 59068514, "comment_id": 104375467, "body": "Can you explain &quot;this one doesn&#39;t work either&quot;? Right away I can tell you that you can&#39;t paste a whole range in a single cell with this line: <code>Worksheets(&quot;2015 output&quot;).Range(&quot;A&quot; &amp; i).Value = Worksheets(&quot;LI&quot;).Range(&quot;F5:F183&quot;).Value</code>"}, {"owner": {"reputation": 23, "user_id": 12444996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d185bd078b8a97f2f73dd80116ae57?s=128&d=identicon&r=PG&f=1", "display_name": "milkycat", "link": "https://stackoverflow.com/users/12444996/milkycat"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574852653, "post_id": 59068514, "comment_id": 104375606, "body": "@JvdV it was producing an output of numbers that I don\u2019t recognise, not sure where they came from. My mistake it\u2019s a single cell."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1574855787, "post_id": 59068514, "comment_id": 104377351, "body": "Please update your question with the single cell code."}, {"owner": {"reputation": 23, "user_id": 12444996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d185bd078b8a97f2f73dd80116ae57?s=128&d=identicon&r=PG&f=1", "display_name": "milkycat", "link": "https://stackoverflow.com/users/12444996/milkycat"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1574862398, "post_id": 59068514, "comment_id": 104381081, "body": "@CLR Updated.     Please note this is my first time with VBA. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 0, "last_activity_date": 1574864964, "creation_date": 1574864964, "answer_id": 59072409, "question_id": 59068514, "link": "https://stackoverflow.com/questions/59068514/copying-and-pasting-loop-in-vba-excel-for-multiple-outputs/59072409#59072409", "title": "Copying and pasting loop in VBA Excel for multiple outputs", "body": "<p>Your question is a little hard to read so I've written an answer based on what I think is the most obvious issue with your code. Apologies if I've misread your query or missed the point entirely..</p>\n\n<p>You appear to be trying to copy the contents of </p>\n\n<p><code>Worksheets(\"LI\").Range(\"F5:F183\")</code> (179 cells) </p>\n\n<p>to </p>\n\n<p><code>Worksheets(\"2015 output\").Range(\"A\" &amp; i &amp; \":AW\" &amp; i)</code> (49 cells)</p>\n\n<p>Ignoring the fact that you can't copy 179 entries into 49 (it will only copy the first 49) - I think you are probably seeing the first entry repeated across all 49 cells?</p>\n\n<p>This would be because you're not transposing the range (in this case, switching from a column to a row).</p>\n\n<p>Try something like this to Transpose:</p>\n\n<pre><code>Worksheets(\"2015 output\").Range(\"A\" &amp; i &amp; \":AW\" &amp; i).Value = _\n                WorksheetFunction.Transpose(Worksheets(\"LI\").Range(\"F5:F57\").Value)\n</code></pre>\n\n<p>Keep in mind though, I've changed the source range to just the first 49 cells. You don't have to but I'm highlighting it in case you weren't aware this is happening.</p>\n"}], "owner": {"reputation": 23, "user_id": 12444996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2d185bd078b8a97f2f73dd80116ae57?s=128&d=identicon&r=PG&f=1", "display_name": "milkycat", "link": "https://stackoverflow.com/users/12444996/milkycat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 59072409, "answer_count": 1, "score": 2, "last_activity_date": 1574864964, "creation_date": 1574851931, "last_edit_date": 1574862239, "question_id": 59068514, "link": "https://stackoverflow.com/questions/59068514/copying-and-pasting-loop-in-vba-excel-for-multiple-outputs", "title": "Copying and pasting loop in VBA Excel for multiple outputs", "body": "<p>So I have the following excel tabs:\nCode 1, Code 2, Code 3, LI, 2015, 2016, 2017, 2018, 2019, output for 2015 etc.</p>\n\n<p>For 2015, I have a table in '2015' tab with 10 rows a list of 3 code and their respective % values. e.g. </p>\n\n<pre><code>ref       name   yr     code 1   %     code 2   %      code 3    %\n12345   NAME    2015    AB  50% CD  37% EF  13%\n78901   NAME    2015    AX  54% OD  30% NG  6%\n26572   NAME    2015    AE  60% CD  27% PF  13%\n</code></pre>\n\n<p>I need the code 1 'AB' and % '50%' to be put into cells B5 and B6 in the tab Code 1. Same for codes 2 and 3 'CS' and '37%' in B5 and B6 in tab Code 2 etc. These then produce an pattern in the LI tab in cells F5:F183 which then needs copying for each reference and pasting into the output for 2015 tab for each reference. Then this loops for each reference and repeats pasting the output.</p>\n\n<p>So far I have this for the copying and pasting part:</p>\n\n<pre><code>    Sub Copy_and_paste2()\n        Dim rng2 As Range, cell2 As Range\n        Dim i As Integer\n        i = 3\n        Set rng2 = Worksheets(\"2015\").Range(\"D10:D21\")\n        For Each cell2 In rng2\n           Worksheets(\"Code 1\").Range(\"B5\").Value = cell2.Value  \n            Worksheets(\"2015 output\").Range(\"A\" &amp; i &amp; \":AW\" &amp; i).Value = Worksheets(\"LI\").Range(\"F5:F183\").Value\n            i = i + 1\n        Next cell2\nEnd Sub\n</code></pre>\n\n<p>At this point I was just trying to make it work for the first code with no % then I can try add the later ones but this one doesn't work either. Any advice?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 2, "creation_date": 1574853423, "post_id": 59068450, "comment_id": 104376056, "body": "There are a fair number of actions missing from your code, and it&#39;s not very efficient to start with. I recommend <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">reading this</a> to avoid using <code>select</code> and <code>activate</code>, which is considered bad practice. Also <a href=\"https://www.automateexcel.com/vba/add-and-name-worksheets/\" rel=\"nofollow noreferrer\">check out this</a> to help with adding sheets. I&#39;m afraid at the moment your code has too many separate issues to fix in one concise answer."}, {"owner": {"reputation": 11, "user_id": 12438377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041d30d00273e8dcb8bd52d4905cccd5?s=128&d=identicon&r=PG&f=1", "display_name": "JBL", "link": "https://stackoverflow.com/users/12438377/jbl"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1574867651, "post_id": 59068450, "comment_id": 104384280, "body": "Thank you for the links and help, Plutian :)"}], "owner": {"reputation": 11, "user_id": 12438377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041d30d00273e8dcb8bd52d4905cccd5?s=128&d=identicon&r=PG&f=1", "display_name": "JBL", "link": "https://stackoverflow.com/users/12438377/jbl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574856878, "creation_date": 1574851731, "last_edit_date": 1574856878, "question_id": 59068450, "link": "https://stackoverflow.com/questions/59068450/vba-create-worksheets-without-duplicates-and-copy-paste-data-to-new-sheet-based", "title": "VBA create worksheets without duplicates and copy/paste data to new sheet based on conditions", "body": "<p>I've been trying to create a macro for creating worksheets. The code should do the following:</p>\n\n<ol>\n<li>Create worksheets based on names from Columne \"AG\" in sheet (page 1) the new sheets should be added after sheet (page 1) and cannot be duplicates  </li>\n<li>The range of column AG is variable   </li>\n<li>Rename each worksheet as per the name in each cell in column AG (no duplicates)  </li>\n<li>Copy row data to the new sheet based on names form Columne AG</li>\n</ol>\n\n<p>Column AG can have the same name multiple times eg.  </p>\n\n<pre><code>Finland 100 \nNorway 50\nFinland 90 \n</code></pre>\n\n<p>The code should create a new sheet called \"Finland\" and copy all the row data that contains Finland in Column AG and do the same for Norway. </p>\n\n<p>Code example for copy and paste data. However, it seems like it doesn\u2019t work all the time and the code can't create sheets.</p>\n\n<pre><code>Sub Copycontent()\n\na = Worksheets(\"Page 1\").Cells(Rows.Count, 1).End(xlUp).Row\n\nFor i = 1 To a \n\n   If Worksheets(\"Page 1\").Cells(i, 33).Value = \"NO\" Then\n\n       Worksheets(\"Page 1\").Rows(i).Copy\n       Worksheets(\"Norway\").Activate\n       b = Worksheets(\"Norway\").Cells(Rows.Count, 1).End(xlUp).Row\n       Worksheets(\"Norway\").Cells(b + 1, 1).Select\n       ActiveSheet.Paste\n       Worksheets(\"Page 1\").Activate \n\n  ElseIf Worksheets(\"Page 1\").Cells(i, 33).Value = \"FI\" Then\n\n       Worksheets(\"page 1\").Rows(i).Copy\n       Worksheets(\"Finland\").Activate\n       c = Worksheets(\"Finland\").Cells(Rows.Count, 1).End(xlUp).Row\n       Worksheets(\"Finland\").Cells(c + 1, 1).Select\n       ActiveSheet.Paste\n       Worksheets(\"Page 1\").Activate\n\nEnd If\n\nNext\n\nApplication.CutCopyMode = False\n\nThisWorkbook.Worksheets(\"Page 1\").Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n\n<p>Thank you in advance </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1574851339, "post_id": 59068217, "comment_id": 104374883, "body": "In the immediate window (or the variables brower), inspect the Workbooks collection. The name might be slightly wrong. i.e. put <code>? Workbooks(0).Name</code> then try <code>? Workbooks(1).Name</code> etc."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 1, "creation_date": 1574851341, "post_id": 59068217, "comment_id": 104374885, "body": "<code>Set wbl2 = Workbooks(&quot;pltemplate.xlsx&quot;)</code> When you execute this line, the workbook <code>pltemplate.xlsx</code> must be already opened <b>in the same instance of Excel</b>. IF the workbooks is not opened, you must use <code>Set wbl2 = Workbooks.Open(&quot;pathtofile&#47;pltemplate.xlsx&quot;)</code>"}, {"owner": {"reputation": 1, "user_id": 12392239, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nbielKXq88s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN2sR_sJ7LedLfgvI8V6Gg7WgdFw/photo.jpg?sz=128", "display_name": "lynX", "link": "https://stackoverflow.com/users/12392239/lynx"}, "reply_to_user": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574851596, "post_id": 59068217, "comment_id": 104375015, "body": "@FoxfireAndBurnsAndBurns That makes sense, originally my code was Workbooks(&quot;source.xlsx&quot;).Worksheets(&quot;odbd&quot;).Range(&quot;A2:AK&quot; &amp; lrl).Copy - the same format for the paste destination but I would still get the same run-time error, which is when I thought to try defining the variables"}, {"owner": {"reputation": 1, "user_id": 12392239, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nbielKXq88s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN2sR_sJ7LedLfgvI8V6Gg7WgdFw/photo.jpg?sz=128", "display_name": "lynX", "link": "https://stackoverflow.com/users/12392239/lynx"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1574851660, "post_id": 59068217, "comment_id": 104375046, "body": "@Nick.McDermaid could you kindly direct me on how to do so, I&#39;m still quite new to VBA and not too familiar with all the terms and tools"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1574851888, "post_id": 59068217, "comment_id": 104375181, "body": "Before using <code>Workbooks(&quot;source.xlsx&quot;).Worksheets(&quot;odbd&quot;).Range(&quot;A2:AK&quot; &amp; lrl).Copy</code>, the workbook must be already opened as I said. About what @Nick.McDermaid said, he means you must check the VBA Editor Project tree, and see if the Workbook <code>pltemplate.xlsx</code> is there. Check <a href=\"https://bettersolutions.com/vba/visual-basic-editor/projectexplorerwindow-window.png\" rel=\"nofollow noreferrer\">bettersolutions.com/vba/visual-basic-editor/&hellip;</a>. The Workbook should be there"}, {"owner": {"reputation": 1, "user_id": 12392239, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nbielKXq88s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN2sR_sJ7LedLfgvI8V6Gg7WgdFw/photo.jpg?sz=128", "display_name": "lynX", "link": "https://stackoverflow.com/users/12392239/lynx"}, "edited": false, "score": 0, "creation_date": 1574852150, "post_id": 59068217, "comment_id": 104375326, "body": "The destination workbook (pltemplate) is already open, there&#39;s some code before the above code which opens a new instance of excel then opens the pltemplate workbook into it.  In regards to the editor project tree, the destination workbook isn&#39;t there, is there a way to add it to the source workbook?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1574852183, "post_id": 59068217, "comment_id": 104375348, "body": "The immediate window is <code>CTRL-G</code>. What does <code>? Workbooks(0).Name</code> say? What about <code>? Workbooks.Count</code>? There are a lot of excellent tips here <a href=\"https://www.myonlinetraininghub.com/debugging-vba-code\" rel=\"nofollow noreferrer\">myonlinetraininghub.com/debugging-vba-code</a>"}, {"owner": {"reputation": 1, "user_id": 12392239, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nbielKXq88s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN2sR_sJ7LedLfgvI8V6Gg7WgdFw/photo.jpg?sz=128", "display_name": "lynX", "link": "https://stackoverflow.com/users/12392239/lynx"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1574852530, "post_id": 59068217, "comment_id": 104375540, "body": "@Nick.McDermaid I opened the immediate window and typed in ? Workbooks(0).Name and hit enter (hope that&#39;s correct) and it just throws out the same run-time error again?  Workbooks.count returns &quot;1&quot;"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1574852685, "post_id": 59068217, "comment_id": 104375617, "body": "Sorry.. it&#39;s been a long time. <code>? Workbooks.Count</code> means &quot;print the number of items in the workbook collection - you only have one item. I messed up the other one it should be <code>? Workbooks(1).Name</code> which means &quot;print the name of the first iten in the workbooks collection&quot;. Basically the workbook isn&#39;t open for some reason. At a guess, you need to open the workbook in the <i>current</i> excel instance, not a new one."}, {"owner": {"reputation": 1, "user_id": 12392239, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nbielKXq88s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN2sR_sJ7LedLfgvI8V6Gg7WgdFw/photo.jpg?sz=128", "display_name": "lynX", "link": "https://stackoverflow.com/users/12392239/lynx"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 1, "creation_date": 1574852959, "post_id": 59068217, "comment_id": 104375771, "body": "@Nick.McDermaid I see, I&#39;m guessing that the most simple solution is to open the destination workbook in the same instance of excel as the source workbook?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1574853020, "post_id": 59068217, "comment_id": 104375813, "body": "Yep that&#39;d be right but not certain of the syntax right at this minute"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1574853793, "post_id": 59068217, "comment_id": 104376256, "body": "<i>The destination workbook (pltemplate) is already open, there&#39;s some code before the above code which opens a new instance of excel</i> Then you can&#39;t do anything between worbooks opened in diferent instances of Excel. Each VBA macro runs across own instance, so your only solution is opening both workbooks inside same instance of excel"}, {"owner": {"reputation": 1, "user_id": 12392239, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nbielKXq88s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN2sR_sJ7LedLfgvI8V6Gg7WgdFw/photo.jpg?sz=128", "display_name": "lynX", "link": "https://stackoverflow.com/users/12392239/lynx"}, "edited": false, "score": 0, "creation_date": 1574853889, "post_id": 59068217, "comment_id": 104376313, "body": "Hey guys thanks for your advice, the macro runs fine now that the destination workbook is opened within the same instance of excel as the source workbook."}], "answers": [{"tags": [], "owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "is_accepted": false, "score": 0, "last_activity_date": 1574858898, "creation_date": 1574858898, "answer_id": 59070617, "question_id": 59068217, "link": "https://stackoverflow.com/questions/59068217/referencing-a-workbook-in-another-excel-instance-produces-run-time-error-9/59070617#59070617", "title": "Referencing a workbook, in another Excel instance, produces &#39;Run-time error &#39;9&#39;: Subscript out of range&#39;", "body": "<p>After last OP comment, the solution was opening both workbooks in same instance of Excel.</p>\n\n<p><em>The destination workbook (pltemplate) is already open, there's some code before the above code which opens a new instance of excel</em></p>\n\n<p>Then you can't do anything between worbooks opened in diferent instances of Excel. Each VBA macro runs across own instance, so your only solution is opening both workbooks inside same instance of excel:</p>\n\n<p><code>Set wbl2 = Workbooks(\"pltemplate.xlsx\")</code> When you execute this line, the workbook <code>pltemplate.xlsx</code> must be already opened <strong>in the same instance of Excel</strong>.</p>\n\n<p>IF the workbooks is not opened, you must use:</p>\n\n<pre><code>Set wbl2 = Workbooks.Open(\"pathtofile/pltemplate.xlsx\")\n</code></pre>\n\n<p>More info about Excel instances and/or related info:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/51366121/how-to-reference-a-workbook-from-another-excel-instance?noredirect=1&amp;lq=1\">How to reference a workbook from another excel instance</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/40410554/running-multiple-instances-of-excel-simultaneously-from-vba?noredirect=1&amp;lq=1\">Running Multiple Instances of Excel simultaneously from VBA?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/56780454/can-having-multiple-instances-of-excel-open-cause-vba-issues/56781317\">Can having multiple instances of Excel open cause VBA issues?</a></p>\n"}], "owner": {"reputation": 1, "user_id": 12392239, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-nbielKXq88s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reN2sR_sJ7LedLfgvI8V6Gg7WgdFw/photo.jpg?sz=128", "display_name": "lynX", "link": "https://stackoverflow.com/users/12392239/lynx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1580460927, "creation_date": 1574851036, "last_edit_date": 1580460927, "question_id": 59068217, "link": "https://stackoverflow.com/questions/59068217/referencing-a-workbook-in-another-excel-instance-produces-run-time-error-9", "title": "Referencing a workbook, in another Excel instance, produces &#39;Run-time error &#39;9&#39;: Subscript out of range&#39;", "body": "<p>I would like to open a workbook in a new instance of Excel, then copy ranges from within several different sheets in another (already open) workbook to specified ranges in the newly opened workbook.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Dim wbl As Workbook\nSet wbl = Workbooks(\"exports  - 27thNov.xlsm\")\nDim wsl As Worksheet\nSet wsl = Sheets(\"odbd\")\nDim lrl As Long\nlrl = wsl.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nDim wbl2 As Workbook\nSet wbl2 = Workbooks(\"pltemplate.xlsx\")\nDim wsl2 As Worksheet\nSet wsl2 = wbl2.Sheets(\"S\")\n\nwbl.Worksheets(\"odbd\").Range(\"A2:AK\" &amp; lrl).Copy\nwbl2.Activate\nwsl2.Range(\"A4\").Select\nwsl2.Range(\"A4\").PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>Note: the Activate &amp; Select commands were added to try to force the macro to work in some way.</p>\n\n<p>Also, I changed the name of the destination workbook (\"pltemplate.xlsx\") to make it a more simple string, as well as the name of the source worksheet (\"S\"), yet I get the same run-time error message.</p>\n\n<p>The line which throws out the error is:</p>\n\n<pre><code>Set wbl2 = Workbooks(\"pltemplate.xlsx\")\n</code></pre>\n"}, {"tags": ["excel", "vba", "text-files"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574850485, "post_id": 59067882, "comment_id": 104374360, "body": "Can you post your code.  Have you looked at the other methods of use of a text file <code>append</code>  or do you want to insert at a specific point in the file"}, {"owner": {"reputation": 19, "user_id": 10875002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a3bad97e201b08028d48899f8082ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Avidan", "link": "https://stackoverflow.com/users/10875002/dan-avidan"}, "edited": false, "score": 0, "creation_date": 1574862228, "post_id": 59067882, "comment_id": 104380995, "body": "I have 2 excel cells. one with a string and the other cell with a number. I want to take the string and copy it to a txt file in line number I have in the other excel cell"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1574874021, "post_id": 59067882, "comment_id": 104387686, "body": "Dan, you need to prefix the screen name of the person you want to address with <code>@</code> in order to notify them of a response in comments."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1574874150, "post_id": 59067882, "comment_id": 104387762, "body": "One very important point would be to <i>remove</i> the line <code>On Error Resume Next</code>. This will be hiding any errors which makes it almost impossible to trouble-shoot problems in your code."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10875002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a3bad97e201b08028d48899f8082ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Avidan", "link": "https://stackoverflow.com/users/10875002/dan-avidan"}, "edited": false, "score": 0, "creation_date": 1574862089, "post_id": 59069562, "comment_id": 104380926, "body": "thanks but no. I have 2 excel cells. one with a string and the other cell with a number. I want to take the string and copy it to a txt file in line number I have in the other excel cell."}], "tags": [], "owner": {"reputation": 5, "user_id": 12436103, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q4r6l.jpg?s=128&g=1", "display_name": "Jadey Swan-McCay", "link": "https://stackoverflow.com/users/12436103/jadey-swan-mccay"}, "is_accepted": false, "score": 0, "last_activity_date": 1574855402, "creation_date": 1574855402, "answer_id": 59069562, "question_id": 59067882, "link": "https://stackoverflow.com/questions/59067882/insert-string-into-a-specific-line-in-a-text-file/59069562#59069562", "title": "Insert string into a specific line in a text file", "body": "<p>Not sure what code you have tried. It would be easier if you included your code.</p>\n\n<p>You could try using:</p>\n\n<pre><code>If Application.Options.Overtype Then\n        Application.Options.Overtype = False\n    End If\n</code></pre>\n\n<p>If you are trying to add a line to the end of your document you can use the following code:</p>\n\n<pre><code>Function WordAddEnd()\n   Dim objWord As Object, objDoc As Object, objSelection As Object\n   Dim endpoint As Integer, moveit As Integer\n   Dim FileString As String\n\n\nendpoint = 6\nmoveit = 0\nFileString = \"C:\\location\\folder\\document.docx\"\nSet objWord = CreateObject(\"Word.Application\")\nOnerror resumenext   \n'change error handling\n\nSet objDoc = objWord.documents.Open(FileString)\n\nSet objSelection = objWord.Selection\n\nWith objSelection\n    .EndKey endpoint, moveit\n'finds end point of document\n\n    .typeparagraph     \n'goes to next line (like pressing the enter key)\n\n    .TypeText (\"It's some text you wanted\")\n'your text here\n\nEnd With\nobjWord.documents.Close\n\nEnd Function\n</code></pre>\n\n<p>If the document in question is already open, there will be an error so you'll need some error handling in here. </p>\n"}], "owner": {"reputation": 19, "user_id": 10875002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a3bad97e201b08028d48899f8082ff?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Avidan", "link": "https://stackoverflow.com/users/10875002/dan-avidan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574873915, "creation_date": 1574849947, "last_edit_date": 1574873915, "question_id": 59067882, "link": "https://stackoverflow.com/questions/59067882/insert-string-into-a-specific-line-in-a-text-file", "title": "Insert string into a specific line in a text file", "body": "<p>I have an excel sheet with strings in the rows.\nI have a txt file.\nI already have the specific number of lines I want to insert the strings.</p>\n\n<p>but when I use \"write\" it deletes all and then inserts the string.</p>\n\n<p>How can I insert a string into a specific line in a text file? i'll use a loop to open and close all the txt files.</p>\n\n<p>the code works. just need to put the string in the txt file.\np.s the note is in Hebrew.</p>\n\n<pre><code>Sub SearchTextFile()\n\n\n'--------------------------------------------------------------------------------------------------\u00fa\u00e7\u00e9\u00ec\u00fa \u00f8\u00e9\u00f6\u00fa \u00f7\u00e5\u00e3\n    Dim Start, Finish, TotalTime As Date\n\n    Start = Timer\n\n'--------------------------------------------------------------------------------------------------\u00e1\u00e9\u00e8\u00e5\u00ec \u00e7\u00e9\u00f9\u00e5\u00e1\u00e9\u00ed \u00e5\u00f2\u00e3\u00eb\u00e5\u00f0\u00e9 \u00ee\u00f1\u00ea \u00e5\u00e4\u00fa\u00f8\u00e0\u00e5\u00fa\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n    Application.AskToUpdateLinks = False\n\n'--------------------------------------------------------------------------------------------------\u00e4\u00e7\u00e6\u00f8\u00fa \u00e7\u00e9\u00f9\u00e5\u00e1\u00e9\u00ed \u00e5\u00f2\u00e3\u00eb\u00e5\u00f0\u00e9 \u00ee\u00f1\u00ea \u00e5\u00e4\u00fa\u00f8\u00e0\u00e5\u00fa\n    'Application.Calculation = xlCalculationAutomatic\n    'Application.ScreenUpdating = True\n    'Application.DisplayAlerts = True\n    'Application.AskToUpdateLinks = True\n\n\n    Dim strLine1, strLine2, strSearch1, strSearch2, Mid1, Mid2 As String\n    Dim i, j, z, h As Integer\n    Dim x, LineCount1, LineCount2 As Long\n    Dim blnFound As Boolean\n\n    x = 2\n    LineCount1 = 0\n    h = 0\n    Do Until IsEmpty(Cells(x, 2))\n\n        myFileCOMPANY = \"L:\\\" &amp; Cells(x, 2) &amp; \"\\COMPANY.bat\" '\u00e1\u00e3\u00e9\u00f7\u00e4 \u00f8\u00e0\u00f9\u00e5\u00f0\u00e9\u00ed \u00e4\u00e0\u00ed \u00ee\u00f1\u00f4\u00f8 \u00e4\u00e7\u00e1\u00f8\u00e4 \u00f7\u00e9\u00e9\u00ed \u00e1\u00eb\u00ec\u00ec\n\n        If Not Dir(myFileCOMPANY) = \"\" Then '\u00e0\u00ed \u00ec\u00e0 \u00f8\u00e9\u00f7\n\n           strFileName = \"L:\\\" &amp; Cells(x, 2) &amp; \"\\COMPANY.bat\" '\u00f0\u00fa\u00e9\u00e1 - \u00e0\u00e9\u00f4\u00e4 \u00ec\u00e7\u00f4\u00f9\n\n           strSearch1 = Cells(x, 7)  '\u00ee\u00e4 \u00ec\u00e7\u00f4\u00f9\n           strSearch1 = \"If Exist Dfile\" &amp; Format(strSearch1, \"000\") '\u00f9\u00e9\u00f0\u00e5\u00e9 \u00f4\u00e5\u00f8\u00ee\u00e8\n\n           i = FreeFile\n\n           On Error Resume Next\n           Open strFileName For Input As #i\n\n           Do While Not EOF(i)\n\n               LineCount1 = LineCount1 + 1\n               Line Input #i, strLine1\n\n               If InStr(1, strLine1, strSearch1, vbBinaryCompare) &gt; 0 Then '\u00e4\u00e1\u00e9\u00e3\u00f7\u00e4 \u00f2\u00f6\u00ee\u00e4 \u00e4\u00e0\u00ed \u00e4\u00e8\u00f7\u00f1\u00e8 \u00f9\u00ee\u00e7\u00f4\u00f9\u00e9\u00ed \u00f7\u00e9\u00e9\u00ed \u00e1\u00f9\u00e5\u00f8\u00e4 \u00e4\u00e6\u00e5\n\n                     strSearch2 = \"pz-\"\n\n                     Line Input #i, strLine2\n\n                         For j = 1 To 4\n                         If InStr(1, strLine2, strSearch2, vbBinaryCompare) + 1 &gt; 0 Then '\u00e4\u00e1\u00e9\u00e3\u00f7\u00e4 \u00f2\u00f6\u00ee\u00e4 \u00e4\u00e0\u00ed \u00e4\u00e8\u00f7\u00f1\u00e8 \u00f9\u00ee\u00e7\u00f4\u00f9\u00e9\u00ed \u00f7\u00e9\u00e9\u00ed \u00e1\u00f9\u00e5\u00f8\u00e4 \u00e4\u00e6\u00e5\n\n                             Cells(x, 11) = Cells(x, 2) '\u00ee\u00f1\u00f4\u00f8 \u00e7\u00e1\u00f8\u00e4\n                             Cells(x, 12) = Format(Cells(x, 7), \"000\") '\u00ee\u00f1\u00f4\u00f8 \u00fa\u00fa\n                             Cells(x, 13) = LineCount1 + j '\u00ee\u00f1\u00f4\u00f8 \u00f9\u00e5\u00f8\u00e4\n                             blnFound = True\n                             Cells(x, 14) = Len(strLine2) '\u00e0\u00e5\u00f8\u00ea \u00f9\u00e5\u00f8\u00e4\n                             Cells(x, 15) = \"1.\" &amp; strSearch1 &amp; \"  2.\" &amp; strSearch2 '\u00fa\u00e5 \u00f9\u00e0\u00e5\u00fa\u00e5 \u00e7\u00e9\u00f4\u00f9\u00e5\n                             Cells(x, 16) = strLine2 '\u00e8\u00f7\u00f1\u00e8 \u00e1\u00f9\u00e5\u00f8\u00e4 \u00ec\u00f4\u00f0\u00e9\n                             Mid1 = Mid(Cells(x, 16), Cells(x, 14) - 12, 5)\n                             Cells(x, 17) = Cells(x, 16) &amp; \" \" &amp; Mid1 &amp; Cells(x, 3) &amp; \".pdf\"\n\n                                For z = 1 To 10 '\u00e1\u00ee\u00e9\u00e3\u00e4 \u00e5\u00e9\u00f9 \u00f2\u00e5\u00e3 \u00ee\u00e0\u00e5\u00fa\u00e4 \u00e4\u00e7\u00e1\u00f8\u00e4 \u00e5\u00e0\u00e5\u00fa\u00e5 \u00e4\u00fa\u00fa \u00e0\u00e6 \u00eb\u00e0\u00ef \u00e4\u00fa\u00e5\u00f1\u00f4\u00e5\u00fa \u00eb\u00f8\u00e8\u00e9\u00f1\u00e9\u00ed \u00f0\u00f6\u00e1\u00f8\u00e9\u00ed\n                                If Cells(x, 7) = Cells(x + z, 7) And Cells(x, 2) = Cells(x + z, 2) Then\n\n                                     Cells(x + z, 16) = Cells(x + h, 17)\n                                     Mid2 = Mid(Cells(x + z, 16), Cells(x, 14) - 12, 5)\n                                     Cells(x + z, 17) = Cells(x + z, 16) &amp; \" \" &amp; Mid2 &amp; Cells(x + z, 3) &amp; \".pdf\"\n                                     h = h + 1\n                                End If\n                                Next z\n\n                             Exit For\n\n\n\n                        End If\n                        Next j\n\n                           Open myFileCOMPANY For Output As #i\n                            Write #i, \"dfgdfg\" 'Cells(x + z, 17)\n\n                Exit Do\n\n                Else: Cells(x, 11) = Cells(x, 2)\n                      Cells(x, 12) = Cells(x, 7)\n                      Cells(x, 15) = \"Dfile\" &amp; Format(Cells(x, 7), \"000\") &amp; \" not found\"\n\n               End If\n\n           Loop\n\n           Close #i\n\n            LineCount1 = 0\n\n            Else: Cells(x, 11) = \"No folder number \" &amp; Cells(x, 2)\n\n        End If\n        x = x + h\n        h = 0\n        x = x + 1\n\n    Loop\n\n\n'--------------------------------------------------------------------------------------------------\u00e4\u00e7\u00e6\u00f8\u00fa \u00e7\u00e9\u00f9\u00e5\u00e1\u00e9\u00ed \u00e5\u00f2\u00e3\u00eb\u00e5\u00f0\u00e9 \u00ee\u00f1\u00ea \u00e5\u00e4\u00fa\u00f8\u00e0\u00e5\u00fa\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n    Application.AskToUpdateLinks = True\n\n\n'--------------------------------------------------------------------------------------------------\u00e6\u00ee\u00ef \u00f1\u00e9\u00e5\u00ed \u00f8\u00e9\u00f6\u00fa \u00f7\u00e5\u00e3 \u00e5\u00e7\u00e9\u00f9\u00e5\u00e1\n    Finish = Timer\n    TotalTime = Format((Finish - Start) / 86400, \"hh:mm:ss\")\n\n    MsgBox (\"\u00e4\u00e3\u00e5''\u00e7 \u00ee\u00e5\u00eb\u00ef\" &amp; vbNewLine &amp; \"\u00e6\u00ee\u00ef \u00f8\u00e9\u00f6\u00fa \u00f7\u00e5\u00e3: \" &amp; TotalTime)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "xlwings"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user945754"}, "edited": false, "score": 0, "creation_date": 1585252418, "post_id": 59098207, "comment_id": 107703106, "body": "Where can I find more info the win32com api? For instance if I want to change the reference style?"}], "tags": [], "owner": {"reputation": 37, "user_id": 12407770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42dc8fea7c77d8838db31936a9cf60e8?s=128&d=identicon&r=PG&f=1", "display_name": "Monkey Hou", "link": "https://stackoverflow.com/users/12407770/monkey-hou"}, "is_accepted": false, "score": 0, "last_activity_date": 1574995856, "creation_date": 1574995856, "answer_id": 59098207, "question_id": 59066450, "link": "https://stackoverflow.com/questions/59066450/how-to-set-a-excels-sheet-activewindow-displaygridlines-false-use-python-xlwi/59098207#59098207", "title": "how to set a Excel&#39;s sheet ActiveWindow.DisplayGridlines = False use Python xlwings", "body": "<pre><code>import win32com.client\n\nexcel = win32com.client.Dispatch(\"Excel.Application\")\nexcel.visible = True\n# wb = excel.Workbooks.Open(r'c:\\Users\\Administrator\\Desktop\\2019-11-25.xlsx')\nexcel.Windows[excel.Activeworkbook.name].DisplayGridlines = False\nexcel.Activeworkbook.save\nexcel.quit()\n</code></pre>\n\n<p>To solve the question using win32com package.</p>\n"}, {"comments": [{"owner": {"reputation": 1336, "user_id": 12078469, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/agNqa.jpg?s=128&g=1", "display_name": "Kim Tang", "link": "https://stackoverflow.com/users/12078469/kim-tang"}, "edited": false, "score": 1, "creation_date": 1600328291, "post_id": 63933108, "comment_id": 113054281, "body": "Hi, welcome to Stack Overflow! While this code may answer the question, it would be better to include some context, explaining how it works and when to use it. Code-only answers are not useful in the long run. <a href=\"https://meta.stackoverflow.com/questions/300837/what-comment-should-i-add-to-code-only-answers\">Reference</a>"}], "tags": [], "owner": {"reputation": 26, "user_id": 14292466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b3129767395cf0af4bd1a02415529f3?s=128&d=identicon&r=PG", "display_name": "MAOMAOYOU", "link": "https://stackoverflow.com/users/14292466/maomaoyou"}, "is_accepted": true, "score": 1, "last_activity_date": 1600327264, "creation_date": 1600327264, "answer_id": 63933108, "question_id": 59066450, "link": "https://stackoverflow.com/questions/59066450/how-to-set-a-excels-sheet-activewindow-displaygridlines-false-use-python-xlwi/63933108#63933108", "title": "how to set a Excel&#39;s sheet ActiveWindow.DisplayGridlines = False use Python xlwings", "body": "<pre><code>import xlwings as xw\napp = xw.apps.active\napp.api.ActiveWindow.DisplayGridlines = True\napp.api.ActiveWindow.DisplayGridlines = False\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12407770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42dc8fea7c77d8838db31936a9cf60e8?s=128&d=identicon&r=PG&f=1", "display_name": "Monkey Hou", "link": "https://stackoverflow.com/users/12407770/monkey-hou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 63933108, "answer_count": 2, "score": 0, "last_activity_date": 1600327264, "creation_date": 1574845095, "last_edit_date": 1574847938, "question_id": 59066450, "link": "https://stackoverflow.com/questions/59066450/how-to-set-a-excels-sheet-activewindow-displaygridlines-false-use-python-xlwi", "title": "how to set a Excel&#39;s sheet ActiveWindow.DisplayGridlines = False use Python xlwings", "body": "<p>In Excel VBA I can use ActiveWindow.DisplayGridlines = False to make sht.DisplayGridlines disappear.</p>\n\n<p>In python xlwings I don't know how to do it.</p>\n\n<p>There is my code:</p>\n\n<pre><code>import xlwings as xw\n\nclass MyExcel():\n    \"\"\"\n    \u5b9a\u4e49Excel\u7c7b\n    \"\"\"\n\n    def __init__(self, wb=None):\n        if wb:\n            self.wb = wb\n        else:\n            try\uff1a\n                self.wb = xw.books.active\n            except:\n                print('\u4e0d\u5b58\u5728\u6253\u5f00\u7684\u5de5\u4f5c\u7c3f')\n\n        self.app = xw.App(visible=True, add_book=False)\n\n    def sht(self, sht_name, clean = True, DisplayGridlines = False):\n        try:\n            return self.wb.sheets.add(name=sht_name, after=self.wb.sheets[-1].name)\n        except ValueError:\n            return self.wb.sheets[sht_name]\n\n        if DisplayGridlines == False:\n            self.wb.activate\n            self.wb.sheets[sht_name].activate\n            self.app.api.ActiveWindow.DisplayGridlines = False #wrong!!!\n\n        if clean:\n            self.wb.sheets[sht_name].cells.clear()\n\n\ndef main():\n    sht = MyExcel().sht('a')\n\nif __name__ == '__main__':\n    main()\n</code></pre>\n"}, {"tags": ["html", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574844885, "post_id": 59066358, "comment_id": 104371174, "body": "Try <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.sendkeys\" rel=\"nofollow noreferrer\">Application.SendKeys</a>"}, {"owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574854813, "post_id": 59066358, "comment_id": 104376805, "body": "Didn\u2019t work.\u201d Argument not optional\u201d error"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574855785, "post_id": 59066358, "comment_id": 104377348, "body": "Post your attempt that returned that error."}, {"owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574858702, "post_id": 59066358, "comment_id": 104379018, "body": "How VBA acts \u201cEnter\u201d like visit web after filling value? Is there an other way?"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574859554, "post_id": 59066358, "comment_id": 104379494, "body": "&#39;Application.SendKeys(&quot;~&quot;)`"}, {"owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574859842, "post_id": 59066358, "comment_id": 104379660, "body": "I found it needs a left \u201cclick\u201d first in input and \u201cEnter\u201d. How to click it in input?Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1574892481, "creation_date": 1574892481, "answer_id": 59079102, "question_id": 59066358, "link": "https://stackoverflow.com/questions/59066358/how-vba-sends-enter-to-execute-web/59079102#59079102", "title": "How VBA sends &quot;ENTER&quot; to execute Web", "body": "<p>The page does an xhr POST request so you can just mimic that adding the expected <code>Content-Type</code> header. I use clipboard to write out <code>table</code> matched by classname but you could loop the <code>trs</code> and <code>tds</code> of the <code>table</code> node.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub WriteOutMonthlyStockTrading()\n    'VBE&gt;Tools&gt;References&gt;Microsoft HTML Object Library\n    Dim http As Object, html As MSHTML.HTMLDocument\n\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n    Set html = New MSHTML.HTMLDocument\n\n    With http\n        .Open \"POST\", \"https://www.tpex.org.tw/web/stock/statistics/monthly/st44.php?l=zh-tw\", False\n        .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n        .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n        .send \"yy=2019&amp;input_stock_code=5904\"\n        html.body.innerHTML = .responseText\n    End With\n\n    Dim clipboard As Object\n\n    Set clipboard = GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n\n    clipboard.SetText html.querySelector(\".page-table-board\").outerHTML\n\n    clipboard.PutInClipboard\n    ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").PasteSpecial\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12134970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2afcc035fed9696571975c3ee64009?s=128&d=identicon&r=PG&f=1", "display_name": "Pablofan", "link": "https://stackoverflow.com/users/12134970/pablofan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 59079102, "answer_count": 1, "score": 0, "last_activity_date": 1574892512, "creation_date": 1574844753, "last_edit_date": 1574892512, "question_id": 59066358, "link": "https://stackoverflow.com/questions/59066358/how-vba-sends-enter-to-execute-web", "title": "How VBA sends &quot;ENTER&quot; to execute Web", "body": "<p>How VBA sends \"ENTER\" to execute Web? When \"5904\" is filled in input in Web, then it needs manual press \"ENTER\" in keyborad. So how VBA in auto press it for web.</p>\n\n<pre><code>Public Sub Web()\nDim ie As New InternetExplorer\n\nWith ie\n.Visible = True\n.Navigate2 \"https://www.tpex.org.tw/web/stock/statistics/monthly/st44.php?l=zh-tw\"\n\nWhile .Busy Or .readyState &lt; 4: DoEvents: Wend\n Set ticker = ie.document.getElementById(\"input_stock_code\")\n ticker.Value = \"5904\"\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1574848661, "post_id": 59066174, "comment_id": 104373249, "body": "Did you rename the <code>Sub</code>s as well?"}, {"owner": {"reputation": 1, "user_id": 12436556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0f5cfc8e20d7b237ec8d7ed1d8529c?s=128&d=identicon&r=PG&f=1", "display_name": "Lawrence Drew ", "link": "https://stackoverflow.com/users/12436556/lawrence-drew"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1574860406, "post_id": 59066174, "comment_id": 104379947, "body": "Yes I&#39;ve renamed the Subs as well but did work. Could this be a bug with VBA?"}], "answers": [{"comments": [{"owner": {"reputation": 2484, "user_id": 6202343, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oFqmLMTwapE/AAAAAAAAAAI/AAAAAAAAA2s/FWR1z9aNzO8/photo.jpg?sz=128", "display_name": "PaichengWu", "link": "https://stackoverflow.com/users/6202343/paichengwu"}, "edited": false, "score": 0, "creation_date": 1574847243, "post_id": 59066283, "comment_id": 104372389, "body": "OP&#39;s buttons are <code>Active-X controls</code>, not <code>Form controls</code>.  Your method will only work on <code>Form controls</code>."}], "tags": [], "owner": {"reputation": 28, "user_id": 11425956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc525bc74909ff5495ce7527b5a3804?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/11425956/sergiu"}, "is_accepted": false, "score": -1, "last_activity_date": 1574844428, "creation_date": 1574844428, "answer_id": 59066283, "question_id": 59066174, "link": "https://stackoverflow.com/questions/59066174/comand-button-1-and-2-have-swapped-over/59066283#59066283", "title": "Comand button 1 and 2 have swapped over?", "body": "<p>right click on your button , go to Assign Macro, and assign the correct one maybe?\nThe name in the list of macros will be the name of the sub (i.e CommandButtonNew_Click())</p>\n"}], "owner": {"reputation": 1, "user_id": 12436556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0f5cfc8e20d7b237ec8d7ed1d8529c?s=128&d=identicon&r=PG&f=1", "display_name": "Lawrence Drew ", "link": "https://stackoverflow.com/users/12436556/lawrence-drew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574846157, "creation_date": 1574844021, "last_edit_date": 1574846157, "question_id": 59066174, "link": "https://stackoverflow.com/questions/59066174/comand-button-1-and-2-have-swapped-over", "title": "Comand button 1 and 2 have swapped over?", "body": "<p>I've got the following code for two command buttons. It worked fine while I was writing and testing the code. However as I've gone to the sheet today and tested the buttons they have swapped over. I've renamed the buttons and that didn't work and I've even swapped the names over and it still runs the code of its counterpart. </p>\n\n<pre><code>'Show new entry form\nPrivate Sub CommandButtonNew_Click()\nNewCollectionUserForm.Show\nEnd Sub\n\n'Email range\nPrivate Sub CommandButtonEmail_Click()\n\nDim WorkRng As Range\nOn Error Resume Next\nxTitleId = \"Uplifts\"\nSet WorkRng = Application.Selection\nSet WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\nApplication.ScreenUpdating = False\nWorkRng.Select\nActiveWorkbook.EnvelopeVisible = True\n\nWith ActiveSheet.MailEnvelope\n    .Introduction = \"Hi, Here is the the current outstanding uplifts:\"\n    .Item.To = \"test@test.com\"\n    .Item.CC = \"test2@test.com\"\n    .Item.Subject = \"Outstanding Uplifts\"\n    .BodyFormat = olFormatHTML\n    .Item.Send\nEnd With\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "sumifs"], "comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 1, "creation_date": 1574856594, "post_id": 59065891, "comment_id": 104377788, "body": "Call me an old fuddy duddy, but I&#39;d try to take the easy way out with <code>Application.WorksheetFunction.SumProduct( ... )</code> or if you want the result in a cell, <code>Workbook.Worksheet.Range.Formula = &quot;=SUMPRODUCT( ...&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 11769384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SlA0YJTBuVQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfQ_lBtHA4z3tGCIZKu8JXGfcFR1g/photo.jpg?sz=128", "display_name": "D3rk0n3r", "link": "https://stackoverflow.com/users/11769384/d3rk0n3r"}, "reply_to_user": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1574858001, "post_id": 59065891, "comment_id": 104378607, "body": "Could be a nice idea. Will try that"}], "owner": {"reputation": 1, "user_id": 11769384, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SlA0YJTBuVQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfQ_lBtHA4z3tGCIZKu8JXGfcFR1g/photo.jpg?sz=128", "display_name": "D3rk0n3r", "link": "https://stackoverflow.com/users/11769384/d3rk0n3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574846741, "creation_date": 1574842880, "last_edit_date": 1574846741, "question_id": 59065891, "link": "https://stackoverflow.com/questions/59065891/vba-sumifs-array-values", "title": "Vba Sumifs Array Values", "body": "<p>I got an Array with double values. Now I want to sum all values if sheet, date, and name are the same. I think I will need another array for the results?</p>\n\n<p>My values array looks like:</p>\n\n<pre><code>Sheet     Date     Value  Name   \nSheet1    04.13    4,2    Friedrich\nSheet1    04.13    13     Karl\nSheet1    04.13    5      Friedrich\nSheet1    05.15    8      Mark\n</code></pre>\n\n<p>My result array should be:</p>\n\n<pre><code>Sheet     Date     Value  Name\nSheet1    04.13    9,2    Friedrich\nSheet1    04.13    13     Karl\nSheet1    05.15    8      Mark\n</code></pre>\n\n<p>But i dont know how to build it.</p>\n\n<p>Heres my Code for the Values Array.</p>\n\n<pre><code>Dim values(160, 3) As Variant\nFor temp5 = 1 To lastrow\n\n    values(temp5 - 1, 0) = blatt.Name\n    values(temp5 - 1, 1) = Format(blatt.Cells(temp5 + 1, 2).Value, \"mm.yy\")\n    If (IsEmpty(blatt.Cells(temp5 + 1, 4).Value)) Then\n        values(temp5 - 1, 2) = 0\n    Else\n        values(temp5 - 1, 2) = blatt.Cells(temp5 + 1, 4).Value\n    End If\n    values(temp5 - 1, 3) = blatt.Cells(temp5 + 1, 8).Value\n\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "user-defined-functions"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574843022, "post_id": 59065876, "comment_id": 104370201, "body": "If you happen to have access to <code>TEXTJOIN</code> function it&#39;s very simple. Otherwise, with just 5 columns you can write a stacked <code>IF</code> condition. If you have way more columns, your best bet is writing an UDF."}], "answers": [{"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1575877189, "post_id": 59066114, "comment_id": 104699154, "body": "@HaroonFuad, has this helped you out? If so consider to upvote/mark as answer to close the thread."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1574844858, "last_edit_date": 1574844858, "creation_date": 1574843795, "answer_id": 59066114, "question_id": 59065876, "link": "https://stackoverflow.com/questions/59065876/how-to-append-to-text-based-on-condition/59066114#59066114", "title": "How to append to text based on condition", "body": "<p>If you happen to have access to <code>TEXTJOIN</code> function you can use the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gGrUq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gGrUq.png\" alt=\"enter image description here\"></a></p>\n\n<p>Formula in <code>F2</code>:</p>\n\n<pre><code>=TEXTJOIN(\",\",TRUE,IF(A2:E2&gt;0,$A$1:$E$1,\"\"))\n</code></pre>\n\n<p><sub><strong>Note 1:</strong> It's an array formula and needs to be confirmed through <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd></sub></p>\n\n<p><sub><strong>Note 2:</strong> Without access to <code>TEXTJOIN</code> this will become a much more painfull process, but for just the 5 columns you can try <code>=IF(A2&gt;0,A$1&amp;\",\",\"\")&amp;IF(B2&gt;0,B$1&amp;\",\",\"\")&amp;IF(C2&gt;0,C$1&amp;\",\",\"\")&amp;IF(D2&gt;0,D$1&amp;\",\",\"\")&amp;IF(E2&gt;0,E$1&amp;\",\",\"\")</code>, however you'll have to expand to get rid of the trailing comma</sub></p>\n\n<hr>\n\n<p>If both the above options are not feasible, your best bet will be to write a UDF. For this exercise, you can write a rather simple one:</p>\n\n<pre><code>Public Function TextJoin2(rng1 As Range, rng2 As Range) As String\n\nWith Application\n    Dim arr As Variant: arr = .Evaluate(\"IF(\" &amp; rng1.Address &amp; \"&gt;0,\" &amp; rng2.Address &amp; \",\"\" \"\")\")\n    TextJoin2 = Replace(.Trim(Join(arr, \" \")), \" \", \",\")\nEnd With\n\nEnd Function\n</code></pre>\n\n<p>Call in <code>F2</code> like: <code>=TEXTJOIN2(A2:E2,A$1:E$1)</code> and drag down.</p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574845147, "post_id": 59066444, "comment_id": 104371307, "body": "If someone has access to <code>CONCAT</code> they have access to <code>TEXTJOIN</code>. Which makes your second exercise redundant."}], "tags": [], "owner": {"reputation": 1, "user_id": 2102269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802aebddc7a0c8df6dab2fae6ec2b09b?s=128&d=identicon&r=PG", "display_name": "danijeldz", "link": "https://stackoverflow.com/users/2102269/danijeldz"}, "is_accepted": false, "score": 0, "last_activity_date": 1574845083, "creation_date": 1574845083, "answer_id": 59066444, "question_id": 59065876, "link": "https://stackoverflow.com/questions/59065876/how-to-append-to-text-based-on-condition/59066444#59066444", "title": "How to append to text based on condition", "body": "<p>You can use <code>=CONCAT(IF(A2:E2&gt;0;$A$1:$E$1&amp;\",\";\"\"))</code> as array formula, confirm with <kbd>Shift</kbd><kbd>Ctrl</kbd><kbd>Enter</kbd>.\nPut this formula in <code>F2</code> cell in your example. Expand that formula to whole range\nWhat remains here is to remove comma on the end of result string.</p>\n\n<p>That full formula would be like this</p>\n\n<p><code>=LEFT(CONCAT(IF(A2:E2&gt;0;$A$1:$E$1&amp;\",\";\"\"));LEN(CONCAT(IF(A2:E2&gt;0;$A$1:$E$1&amp;\",\";\"\")))-1)</code></p>\n"}], "owner": {"reputation": 83, "user_id": 1898046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/640234d471fef9f77136ea86f16e3f30?s=128&d=identicon&r=PG", "display_name": "Haroon Fuad", "link": "https://stackoverflow.com/users/1898046/haroon-fuad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574845083, "creation_date": 1574842825, "last_edit_date": 1574844881, "question_id": 59065876, "link": "https://stackoverflow.com/questions/59065876/how-to-append-to-text-based-on-condition", "title": "How to append to text based on condition", "body": "<p>How to create a formula in result column based on the values of the previous column \n<a href=\"https://i.stack.imgur.com/ZaAnB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZaAnB.png\" alt=\"enter image description here\"></a></p>\n\n<p>if values in any previous columns (from c1 to c5) is greater than zero, I want to add it to the result.</p>\n"}, {"tags": ["excel", "vba", "range", "copy-paste"], "comments": [{"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1574858334, "post_id": 59065748, "comment_id": 104378826, "body": "Hi Simone. Why do you want to avoid copy and paste? This should be the easiest solution and will automatically resize the second empty table, i.e. <code>wsReturnsOnly.ListObjects(&quot;Table_Waste_Returns_Only&quot;).DataBo&zwnj;&#8203;dyRange.Copy wsOrdReturns.ListObjects(&quot;Table_Orders_Returned&quot;).DataBodyRa&zwnj;&#8203;nge</code>"}, {"owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "reply_to_user": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1575273628, "post_id": 59065748, "comment_id": 104496922, "body": "Thank you @JustynaMK it works perfectly. I read on some blogs that if you can use other forms of coding and avoid copy-paste, it&#39;s better and avoids complications. But I guess it&#39;s best for some solutions. Thank you for your help."}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1575321899, "post_id": 59065748, "comment_id": 104519642, "body": "Glad it&#39;s working for you! Agreed it&#39;s better for copying cell&#39;s values to avoid copy-paste, but I think tables could be an exception to this rule (especially for the benefit of having them automatically resized). Cheers &amp; take care :)"}], "owner": {"reputation": 143, "user_id": 8131651, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212848180980497/picture?type=large", "display_name": "Simone Fick", "link": "https://stackoverflow.com/users/8131651/simone-fick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1578163836, "creation_date": 1574842274, "last_edit_date": 1578163836, "question_id": 59065748, "link": "https://stackoverflow.com/questions/59065748/copy-whole-table-data-to-a-different-table", "title": "Copy whole table data to a different table", "body": "<p>I'm trying to copy the DataBodyRange from one table into a table on a different sheet, which is empty and has the same headings.</p>\n\n<p>I want to avoid using copy and paste if possible.</p>\n\n<p>Currently, it only pastes the first line of the first table, and I think the problem is my range on the second table. This is a dynamic range, so setting the second table's range is not something I want to do.</p>\n\n<pre><code>wsOrdReturns.ListObjects(\"Table_Orders_Returned\").DataBodyRange.Value = wsReturnsOnly.ListObjects(\"Table_Waste_Returns_Only\").DataBodyRange.Value\n</code></pre>\n\n<p>'<strong>Table_Orders_Returned</strong>' is the second empty table</p>\n\n<p>'<strong>Table_Waste_Returns_Only</strong>' is the first table with the data I need to copy</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 1, "creation_date": 1574841954, "post_id": 59065590, "comment_id": 104369690, "body": "See <a href=\"https://docs.microsoft.com/en-gb/office/vba/excel/concepts/cells-and-ranges/refer-to-named-ranges\" rel=\"nofollow noreferrer\">this link</a>"}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 1, "creation_date": 1574841968, "post_id": 59065590, "comment_id": 104369697, "body": "Can you clarify which value is in your named range? Is it <code>200</code> or <code>&gt;=200</code>? If the first, your criteria should be <code>&quot;&gt;=&quot; &amp; Range(&quot;Volume&quot;).value</code>. If the second it should just be <code>Range(&quot;Volume&quot;).value</code>"}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1574842040, "post_id": 59065590, "comment_id": 104369731, "body": "value is in my named range is 200"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574842194, "post_id": 59065590, "comment_id": 104369788, "body": "You might want to refrain from using <code>ActiveSheet</code>. Since you will also want to refer to a specific sheet holding your named ranges, a <code>With</code> statement seems at place here."}, {"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1574842384, "post_id": 59065590, "comment_id": 104369868, "body": "I got your point, thank you to all of you for help me."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "edited": false, "score": 0, "creation_date": 1576398841, "post_id": 59065854, "comment_id": 104881973, "body": "yes, it helped me a lot, thq for giving your valuable time to share ans."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1574842754, "creation_date": 1574842754, "answer_id": 59065854, "question_id": 59065590, "link": "https://stackoverflow.com/questions/59065590/vba-reference-to-named-range/59065854#59065854", "title": "VBA reference to named range", "body": "<p>As per my comment, you might want to consider a <code>With</code> statement, better not to refer to <code>ActiveSheet</code>   </p>\n\n<pre><code>Sub FILTER2()\n\nWith Sheet1 'Change according to your sheets CodeName\n    .Range(\"$A$2:$AC$500\").AutoFilter 6, \"&gt;=\" &amp; .Range(\"VOLUME\")\n    .Range(\"$A$2:$AC$500\").AutoFilter 21, \"&gt;=\" &amp; .Range(\"MOVE\")\n    .Range(\"$A$2:$AC$500\").AutoFilter 28, \"&gt;=\" &amp; .Range(\"STRENTH\")\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 11425956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dc525bc74909ff5495ce7527b5a3804?s=128&d=identicon&r=PG&f=1", "display_name": "Sergiu", "link": "https://stackoverflow.com/users/11425956/sergiu"}, "is_accepted": false, "score": 0, "last_activity_date": 1574844154, "last_edit_date": 1574844154, "creation_date": 1574843809, "answer_id": 59066119, "question_id": 59065590, "link": "https://stackoverflow.com/questions/59065590/vba-reference-to-named-range/59066119#59066119", "title": "VBA reference to named range", "body": "<p>you can try defining a variable to contain the value of your named range.\nNamed Range in your sheet as \"Volume\" then i can store that value in var namedRange1.</p>\n\n<p>example below: </p>\n\n<pre><code>Sub FILTER2()  \n\nnamedRange1 = range(\"Volume\")\n\n'FILTER CRITERIA\nActiveSheet.range(\"$A$2:$AC$500\").AutoFilter Field:=6, Criteria1:=\"&gt;=\" &amp; namedRange1, _\n    Operator:=xlAnd\n</code></pre>\n\n<p>....same with the other lines, just define new variable to contain new named range</p>\n"}], "owner": {"reputation": 133, "user_id": 11542140, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTkSASrLazo/AAAAAAAAAAI/AAAAAAAAABQ/pdJs1QIx6OY/photo.jpg?sz=128", "display_name": "Arshit patel", "link": "https://stackoverflow.com/users/11542140/arshit-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 59065854, "answer_count": 2, "score": 0, "last_activity_date": 1574844154, "creation_date": 1574841597, "last_edit_date": 1574841822, "question_id": 59065590, "link": "https://stackoverflow.com/questions/59065590/vba-reference-to-named-range", "title": "VBA reference to named range", "body": "<p>I have following code in which I have tried to applied 3 filters, now what I want is, to apply this filter criteria based on named range\nI have stored relevant value in specific cell and given names to that range</p>\n\n<p>for first criteria i.e. >=200 named range is <code>VOLUME</code></p>\n\n<p>for second criteria i.e. >=0.07 named range is <code>MOVE</code></p>\n\n<p>for third criteria i.e. >=400 named range is <code>STRENTH</code></p>\n\n<p>So what are the changes that I need to make in following code?</p>\n\n<pre><code>Sub FILTER2()\n\n'FILTER CRITERIA\nActiveSheet.Range(\"$A$2:$AC$500\").AutoFilter Field:=6, Criteria1:=\"&gt;=200\", _\n    Operator:=xlAnd\nActiveSheet.Range(\"$A$2:$AC$500\").AutoFilter Field:=21, Criteria1:=\"&gt;=0.07\" _\n    , Operator:=xlAnd\nActiveSheet.Range(\"$A$2:$AC$500\").AutoFilter Field:=28, Criteria1:=\"&gt;=400\" _\n    , Operator:=xlAnd\n\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1574849593, "post_id": 59065244, "comment_id": 104373840, "body": "<code>Ws2.range(&quot;B6:Y&quot; &amp; lrow1).copy ... copies cells only from B1:Y6</code>  that will happen if <code>lrow1</code> equals 1.  Check the contents of the column you&#39;re getting the last row from"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1574849826, "post_id": 59065244, "comment_id": 104373959, "body": "There are lots of examples of using Dir to iterate a folder on SO. <a href=\"https://stackoverflow.com/a/8787868/445425\">Here&#39;s one</a>"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1574849945, "post_id": 59065244, "comment_id": 104374032, "body": "You are also doing a lot of implicit Active Book/Sheet/Range references which you don&#39;t need to do.  These may cause you to reference the wrong objects"}], "owner": {"reputation": 1, "user_id": 8870207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b436480c39403e5191eaae36126d6f?s=128&d=identicon&r=PG&f=1", "display_name": "shin", "link": "https://stackoverflow.com/users/8870207/shin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574849378, "creation_date": 1574840288, "last_edit_date": 1574849378, "question_id": 59065244, "link": "https://stackoverflow.com/questions/59065244/excel-vba-do-while-loop-in-a-directory-folder-and-rows-count", "title": "Excel VBA Do While loop in a directory folder and rows count", "body": "<p>I have 2 questions with my coding. Please bear with me since I'm not an expert on this.</p>\n\n<ol>\n<li><p>Ws2.range(\"B6:Y\" &amp; lrow1).copy - doesn't seem to work the way I wanted it to be. It copies cells only from B1:Y6 but the intention is to copy cells starting ffrom B6:Y until the last row.</p></li>\n<li><p>Dir Do while loops only on one file even though I have multiple files on the specified folder path. Thus, creating an infinite loop.</p></li>\n</ol>\n\n<p>Any idea on what am I doing wrong?</p>\n\n<pre><code>Private Sub conso()\nDim folder As String, consofolder As String\nDim files As String, consofile As String\nDim dateyear As String, team As String\nDim strfile As String, newdate As String\nDim wb1 As Workbook, wb2 As Workbook\nDim lrow1 As Long, lrow2 As Long\nDim ws1 As Worksheet, ws2 As Worksheet\n\ndateyear = Range(\"A2\").Value\nnewdate = Format(dateyear, \"mmmm yyyy\")\nteam = Range(\"B2\").Value\nfolder = Range(\"C2\").Value\nconsofolder = folder &amp; newdate &amp; \"\\\" &amp; team\nconsofile = \"conso \"\nfiles = Dir(consofolder &amp; \"\\*.xlsm\")\nstrfile = consofolder &amp; \"\\\" &amp; consofile &amp; team &amp; \" - \" &amp; newdate &amp; \".xlsm\"\n\nApplication.DisplayAlerts = False\nApplication.AskToUpdateLinks = False\nApplication.AutomationSecurity = msoAutomationSecurityLow\nWorkbooks.Open Filename:=folder &amp; \"\\\" &amp; \"conso conso\" &amp; \".xlsm\"\nSet wb1 = Workbooks(\"conso conso.xlsm\")\nwb1.Activate\nSet ws1 = wb1.Worksheets(\"Input\")\nIf Len(Dir(strfile)) = 0 Then\n\n    GoTo conso\nElse\n    MsgBox \"Conso already in place\"\n    Exit Sub\nEnd If\nconso:\nDo While files &lt;&gt; \"\"\n    Debug.Print files\n\n    Workbooks.Open Filename:=consofolder &amp; \"\\\" &amp; files\n    Set wb2 = Workbooks(files)\n    Set ws2 = wb2.Worksheets(\"Input\")\n    With wb2\n        With Worksheets(\"Input\")\n            lrow1 = .Cells(.Rows.Count, 1).End(xlUp).Row\n        End With\n    End With\n    ws2.Range(\"B6:Y\" &amp; lrow1).Copy\n    wb1.Activate\n    With wb1\n        With Worksheets(\"Input\")\n            lrow2 = .Cells(.Rows.Count, 1).End(xlUp).Row\n        End With\n    End With\n    ws1.Range(\"B\" &amp; lrow2).PasteSpecial\n    wb2.Close\n    files = Dir(consofolder &amp; \"\\*.xlsm\")\n\n    Set wb2 = Nothing\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "undo"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1574839818, "post_id": 59065015, "comment_id": 104368670, "body": "If you pause the procedure when inside the <code>undoLastAction</code> and check the <code>EnableEvents</code> status in the debug window, what does it return? True or False?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574840852, "post_id": 59065015, "comment_id": 104369169, "body": "<code>Call turnOffExcelFeatures</code> should be before <code>If errMsg &lt;&gt; &quot;&quot; Then</code>?"}, {"owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574860918, "post_id": 59065015, "comment_id": 104380233, "body": "@SiddharthRout Thanks for the suggestion. I tried it and updated my question but still got the exact same problem. At least deleting rows still works."}, {"owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "reply_to_user": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1574861006, "post_id": 59065015, "comment_id": 104380287, "body": "@Damian Exactly what I expect. <code>EnableEvents</code> is <code>True</code> when the sub starts, becomes <code>False</code> during execution of <code>turnOffExcelFeatures()</code>, only becoming <code>True</code> when <code>turnOnExcelFeatures()</code> is called."}], "owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574860841, "creation_date": 1574839346, "last_edit_date": 1574860841, "question_id": 59065015, "link": "https://stackoverflow.com/questions/59065015/worksheet-change-event-occuring-multiple-times-only-when-inserting-rows", "title": "Worksheet change event occuring multiple times only when inserting row(s)", "body": "<p>I'm upgrading a moderately complicated Excel spreadsheet which validates user input, otherwise the spreadsheet can be very easily broken. Part of this validation involves ensuring certain cells with data needed for the spreadsheet to operate are not deleted. To achieve this I have the submodule</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal target As Range)\n    Dim errMsg As String\n\n    On Error GoTo turnAutomationOn:\n    Call turnOffExcelFeatures\n    Worksheets(WORKSHEET_NAME).UsedRange 'gets rid of ghost cells\n\n    ' check critical data and forumlae have not been disturbed or deleted\n\n    If errMsg &lt;&gt; \"\" Then\n        Call outputErrorMessage(errMsg)   ' definitely works\n        Call undoLastAction()\n        Exit Sub\n    End If\n\n    ' process change made\n\nturnAutomationOn:\n    Call turnOnExcelFeatures\nEnd Sub\n</code></pre>\n\n<p>where the functions <code>turnOffExcelFeatures()</code>, <code>turnOnExcelFeatures()</code>, and <code>undoLastAction()</code> are defined as</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' Increase performance by turning of certian Excel features\n' WARNING: Make sure to call turnOnExcelFeatures() before calling function/sub ends!\nPublic Function turnOffExcelFeatures()\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Application.Calculation = xlCalculationManual\n    Application.EnableEvents = False\n    ActiveSheet.DisplayPageBreaks = False\nEnd Function\n\n' Turns Excel features back on that are turned off by turnOffExcelFeatures()\nPublic Function turnOnExcelFeatures()\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    Application.Calculation = xlCalculationAutomatic\n    ActiveSheet.DisplayPageBreaks = True\n    Application.EnableEvents = True\nEnd Function\n\nPublic Function undoLastAction()\n    On Error Resume Next ' in case Application.Undo fails due to empty undo stack\n\n    Dim enableEventsStatus As Boolean\n\n    With Application\n        enableEventsStatus = .EnableEvents\n        .EnableEvents = False\n        .Undo\n        .EnableEvents = enableEventsStatus\n    End With\nEnd Function\n</code></pre>\n\n<p>Generally speaking, this code works just fine. However, when inserting row(s) the <code>undoLastAction()</code> function is being called a second time. This makes the script stop at the <code>.Undo</code> line, where Excel outputs a Run-time error '1004'. I'm guessing this is because the first run of the <code>Worksheet_change()</code> sub clears the undo stack. Strangely, this only occurs when inserting a new row(s); changing a cell value, inserting columns, deleting columns, and deleting rows don't have the same issue.</p>\n\n<p>After experimenting with breakpoints, I can confirm that the <code>Worksheet_change()</code> sub is being run multiple times <strong>only</strong> when inserting new row(s).</p>\n\n<p>Considering my usage of setting of the <code>EnableEvents</code> variable, I don't understand why inserting new rows would cause the worksheet change event to occur. I've tried searching for <code>EnableEvents</code> via Ctrl + F, but I can only find it in the <code>turnOffExcelFeatures()</code> and <code>turnOnExcelFeatures()</code> functions. Furthermore, the <code>On Error Resume Next</code> in the <code>undoLastAction()</code> doesn't appear to do anything.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1574839346, "post_id": 59064931, "comment_id": 104368468, "body": "you can get  the number of columns using <code>Ubound(A, 2)</code> and the number of rows by using <code>Ubound(A)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 82, "user_id": 6181876, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5229395c2fb5685b8654510643868694?s=128&d=identicon&r=PG&f=1", "display_name": "Rain", "link": "https://stackoverflow.com/users/6181876/rain"}, "is_accepted": true, "score": 0, "last_activity_date": 1574844943, "last_edit_date": 1574844943, "creation_date": 1574839584, "answer_id": 59065079, "question_id": 59064931, "link": "https://stackoverflow.com/questions/59064931/temporary-storage-vector/59065079#59065079", "title": "Temporary Storage Vector", "body": "<p>This is similar to my previous homework. </p>\n\n<pre><code>If TypeName(A) = \"Range\" Then\n    N = A.Columns.Count ' Error checking for LU as range goes here (NxN, numerical).\nElse\n    N = UBound(A) ' Error checking for LU as variant array goes here (NxN, numerical).\nEnd If\n</code></pre>\n\n<p>You can make a temporary storage doing this </p>\n\n<pre><code>ReDim dy(1 To N)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12443362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d4173548d15aef360687f0dcfb2b726?s=128&d=identicon&r=PG&f=1", "display_name": "Min", "link": "https://stackoverflow.com/users/12443362/min"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 59065079, "answer_count": 1, "score": 0, "last_activity_date": 1574844955, "creation_date": 1574839000, "last_edit_date": 1574840811, "question_id": 59064931, "link": "https://stackoverflow.com/questions/59064931/temporary-storage-vector", "title": "Temporary Storage Vector", "body": "<p>The \"A\" is the matrix from the worksheet. How do count the columns in a matrix and create a temporary storage vector at N columns. </p>\n\n<pre><code>Public Function Array_ASolve(A As Variant, y As Range, p As Range, w As Double) As Variant\n  Dim dA() As Double, dy() As Double, dx() As Double, dxx() As Double, dz() As Double, dp() As Double, dv() As Double\n  Dim i As Long, j As Long, N As Long\n</code></pre>\n"}, {"tags": ["java", "excel", "vba", "spring-boot", "apache-poi"], "comments": [{"owner": {"reputation": 5138, "user_id": 7109162, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/eaf2daca9ef0a1751603bd0f707f0139?s=128&d=identicon&r=PG&f=1", "display_name": "XtremeBaumer", "link": "https://stackoverflow.com/users/7109162/xtremebaumer"}, "edited": false, "score": 2, "creation_date": 1574838552, "post_id": 59064546, "comment_id": 104368112, "body": "Whats the question?"}], "answers": [{"tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": false, "score": 1, "last_activity_date": 1574841934, "last_edit_date": 1574841934, "creation_date": 1574841528, "answer_id": 59065569, "question_id": 59064546, "link": "https://stackoverflow.com/questions/59064546/integrate-excel-vba-code-to-java-code-to-finally-create-the-feature-of-selecting/59065569#59065569", "title": "Integrate Excel VBA code to Java code to finally create the feature of selecting multiple values from the drop down list in a cell of an excel sheet", "body": "<p>The <code>VBA</code> code cannot be integrated to the <code>Java</code>code which creates the data validation. The <code>VBA</code> code runs within the <code>Excel</code> <code>GUI</code> while the <code>Java</code> code only creates the <code>Excel</code> file and does not interact with <code>Excel</code>'s <code>GUI</code> in any case.</p>\n\n<p>Your provided <code>VBA</code> code is special code for <code>Worksheet_Change</code> event. So it runs every time when something changes on the worksheet it is applied to. So it is able providing additional functionality after someone has selected a value from datavalidation dropdown. It gives the user the possibility to select multiple values, one after the other, for the cell.</p>\n\n<p>What one could do to combinate that with <code>apache poi</code> code is having a <code>*.xlsm</code> template which has the <code>Worksheet_Change</code> applied to a worksheet already. Then <code>apache poi</code> can open that template, add data validation and write that to a new <code>*.xlsm</code> file. </p>\n\n<p>Example:</p>\n\n<p><code>ExcelTemplate.xlsm</code> has the <code>Sub</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Dim Oldvalue As String\n Dim Newvalue As String\n Application.EnableEvents = True\n On Error GoTo Exitsub\n If Target.Column = 1 Then\n  If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then GoTo Exitsub\n  If Target.Value = \"\" Then GoTo Exitsub\n  Application.EnableEvents = False\n  Newvalue = Target.Value\n  Application.Undo\n  Oldvalue = Target.Value\n  If Oldvalue = \"\" Then\n   Target.Value = Newvalue\n  ElseIf InStr(1, Oldvalue, Newvalue) = 0 Then\n   Target.Value = Oldvalue &amp; \", \" &amp; Newvalue\n  Else\n   Target.Value = Oldvalue\n  End If\n End If\n Application.EnableEvents = True\nExitsub:\n Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>applied to first worksheet.</p>\n\n<p>Then after following code</p>\n\n<pre class=\"lang-java prettyprint-override\"><code>import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport org.apache.poi.ss.util.*;\nimport org.apache.poi.ss.usermodel.*;\n\nclass CreateDataValidation {\n\n public static void main(String[] args) throws Exception {\n\n  String excelTemplatePath = \"./ExcelTemplate.xlsm\";\n  String excelResultPath = \"./ExcelResult.xlsm\";\n\n  Workbook workbook = WorkbookFactory.create(new FileInputStream(excelTemplatePath));\n\n  Sheet sheet = workbook.getSheetAt(0);\n\n  String[] optionsArray = new String[] {\"Value 1\", \"Value 2\", \"Value 3\"};\n\n  int no_of_rows = 10000;\n\n  DataValidationConstraint constraint = sheet.getDataValidationHelper().createExplicitListConstraint(optionsArray);\n  CellRangeAddressList addressList = new CellRangeAddressList(0, no_of_rows, 0, 0);\n  DataValidation dataValidation = sheet.getDataValidationHelper().createValidation(constraint, addressList);\n  sheet.addValidationData(dataValidation);\n\n  FileOutputStream out = new FileOutputStream(excelResultPath);\n  workbook.write(out);\n  out.close();\n  workbook.close();\n }\n}\n</code></pre>\n\n<p>the <code>ExcelResult.xlsm</code> has the datavalidation in first sheet in range <code>A1:A10001</code>. And since it has the <code>Worksheet_Change</code> <code>Sub</code> applied to that sheet too, it provides the additional functionality as long as running macro code will be allowed.</p>\n"}], "owner": {"reputation": 31, "user_id": 12410469, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ackkKaIXq9w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcIrQw6RzGrW71ukLSyPiqlH5ID2g/photo.jpg?sz=128", "display_name": "sumit mamtani", "link": "https://stackoverflow.com/users/12410469/sumit-mamtani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574854020, "creation_date": 1574837423, "last_edit_date": 1574854020, "question_id": 59064546, "link": "https://stackoverflow.com/questions/59064546/integrate-excel-vba-code-to-java-code-to-finally-create-the-feature-of-selecting", "title": "Integrate Excel VBA code to Java code to finally create the feature of selecting multiple values from the drop down list in a cell of an excel sheet", "body": "<p>I have a VBA code for selecting multiple values at once from the drop-down list in a cell of an excel sheet. I want to integrate this code with my java code which allows us to select only \nvalue at a time from the drop-down list in a cell of an excel sheet using Apache Poi, so that after integration I should finally be able to select multiple values at once from the drop-down list in a cell of an excel sheet.</p>\n\n<pre><code>\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\nDim Oldvalue As String\nDim Newvalue As String\nApplication.EnableEvents = True\nOn Error GoTo Exitsub\nIf Target.Address = \"$C$2\" Then\n  If Target.SpecialCells(xlCellTypeAllValidation) Is Nothing Then\n    GoTo Exitsub\n  Else: If Target.Value = \"\" Then GoTo Exitsub Else\n    Application.EnableEvents = False\n    Newvalue = Target.Value\n    Application.Undo\n    Oldvalue = Target.Value\n      If Oldvalue = \"\" Then\n        Target.Value = Newvalue\n      Else\n        If InStr(1, Oldvalue, Newvalue) = 0 Then\n            Target.Value = Oldvalue &amp; \", \" &amp; Newvalue\n      Else:\n        Target.Value = Oldvalue\n      End If\n    End If\n  End If\nEnd If\nApplication.EnableEvents = True\nExitsub:\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Java code for selecting only value at a time from the drop-down list in a cell of an excel sheet using Apache Poi</p>\n\n<pre><code>XSSFDataValidationHelper dvHelper = new XSSFDataValidationHelper((XSSFSheet)sheet);\n\nString[] arrayList = allowedValues.toArray(new String[allowedValues.size()]);\n\nXSSFDataValidationConstraint dvConstraint = (XSSFDataValidationConstraint) dvHelper.createExplicitListConstraint(arrayList);\n\nCellRangeAddressList addressList = new CellRangeAddressList(row.getRowNum() + 1, 10000, cell.getColumnIndex(), cell.getColumnIndex());\n\nXSSFDataValidation validation = (XSSFDataValidation) dvHelper.createValidation(dvConstraint, addressList);\n\nvalidation.setShowErrorBox(true);\n\nvalidation.createErrorBox(\"ERROR MESSAGE:Invalid Data\", \"Please provide valid data in the drop down list.\");\n\nsheet.addValidationData(validation);\n\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "replace"], "comments": [{"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574841589, "post_id": 59064418, "comment_id": 104369535, "body": "Write your range to an array and loop through there - much faster!"}, {"owner": {"reputation": 59, "user_id": 10651865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cdfea5dfa53056bc595ca46f4f811?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Shazam", "link": "https://stackoverflow.com/users/10651865/mr-shazam"}, "reply_to_user": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 0, "creation_date": 1574845517, "post_id": 59064418, "comment_id": 104371478, "body": "Hi Dean, tnak you. I tried it, but it took nearly the same time, I think the big time waster is the replacement method itself"}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10651865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cdfea5dfa53056bc595ca46f4f811?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Shazam", "link": "https://stackoverflow.com/users/10651865/mr-shazam"}, "edited": false, "score": 0, "creation_date": 1574845551, "post_id": 59065824, "comment_id": 104371492, "body": "Thank you, I tried it, but it took nearly the same time, I think the big time waster is the replacement method itself"}, {"owner": {"reputation": 105, "user_id": 6199625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83d46ef1482a035f7af3951acb0af26?s=128&d=identicon&r=PG&f=1", "display_name": "cr44sh", "link": "https://stackoverflow.com/users/6199625/cr44sh"}, "reply_to_user": {"reputation": 59, "user_id": 10651865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cdfea5dfa53056bc595ca46f4f811?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Shazam", "link": "https://stackoverflow.com/users/10651865/mr-shazam"}, "edited": false, "score": 2, "creation_date": 1574845912, "post_id": 59065824, "comment_id": 104371685, "body": "There is no usage of the replacement method when working with arrays like in this example. Generally working with arrays should be considerably faster, as it doesn&#39;t loop through the worksheet itself, but a copy of the contents which are stored in a variable."}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 1, "creation_date": 1574846558, "post_id": 59065824, "comment_id": 104372037, "body": "shouldn&#39;t that last line read <code>wscheck.range(&quot;Data&quot;).Value2 = arrData</code>"}, {"owner": {"reputation": 105, "user_id": 6199625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83d46ef1482a035f7af3951acb0af26?s=128&d=identicon&r=PG&f=1", "display_name": "cr44sh", "link": "https://stackoverflow.com/users/6199625/cr44sh"}, "edited": false, "score": 1, "creation_date": 1574848193, "post_id": 59065824, "comment_id": 104372957, "body": "For consistency purposes you are right, I guess. However, without further testing I would assume that when pasting back to the sheet there should be no measurable difference between using .value (<a href=\"https://docs.microsoft.com/de-de/office/vba/api/excel.range.value\" rel=\"nofollow noreferrer\">which is the standard</a>) and .value2."}, {"owner": {"reputation": 59, "user_id": 10651865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cdfea5dfa53056bc595ca46f4f811?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Shazam", "link": "https://stackoverflow.com/users/10651865/mr-shazam"}, "edited": false, "score": 0, "creation_date": 1574848289, "post_id": 59065824, "comment_id": 104373008, "body": "but I have to find the corresponding cell in the sheet(&quot;Check&quot;) first, because it is somewhere in the document (always differently structured). And then I tried the .find and .replace method, both take a very long time. i don&#39;t understand how I can use an array if I don&#39;t know the target cell where something will be replaced? sorry, I used the first al arrays."}, {"owner": {"reputation": 105, "user_id": 6199625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83d46ef1482a035f7af3951acb0af26?s=128&d=identicon&r=PG&f=1", "display_name": "cr44sh", "link": "https://stackoverflow.com/users/6199625/cr44sh"}, "edited": false, "score": 1, "creation_date": 1574848783, "post_id": 59065824, "comment_id": 104373328, "body": "Could you provide some more information about the structure of your sheet?"}, {"owner": {"reputation": 59, "user_id": 10651865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cdfea5dfa53056bc595ca46f4f811?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Shazam", "link": "https://stackoverflow.com/users/10651865/mr-shazam"}, "edited": false, "score": 1, "creation_date": 1574856795, "post_id": 59065824, "comment_id": 104377911, "body": "I have got it!!! thank you very much for your ideas! this helped me!! T have extended it a little bit under the code, if you see mistakes please let me know!!"}], "tags": [], "owner": {"reputation": 105, "user_id": 6199625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83d46ef1482a035f7af3951acb0af26?s=128&d=identicon&r=PG&f=1", "display_name": "cr44sh", "link": "https://stackoverflow.com/users/6199625/cr44sh"}, "is_accepted": true, "score": 1, "last_activity_date": 1574843167, "last_edit_date": 1574843167, "creation_date": 1574842621, "answer_id": 59065824, "question_id": 59064418, "link": "https://stackoverflow.com/questions/59064418/speed-up-a-vba-replace-loop-possible-or-use-other-method/59065824#59065824", "title": "Speed up a VBA Replace-loop possible or use other method?", "body": "<p>You might benefit from this valuable piece of text: </p>\n\n<p><a href=\"https://www.microsoft.com/en-us/microsoft-365/blog/2009/03/12/excel-vba-performance-coding-best-practices/\" rel=\"nofollow noreferrer\">https://www.microsoft.com/en-us/microsoft-365/blog/2009/03/12/excel-vba-performance-coding-best-practices/</a></p>\n\n<p>So in your case the Code could somewhat look like this:</p>\n\n<pre><code>Dim arrData as Variant, arrSource as Variant, k as long\narrData = wsCheck.Range(\"Data\").value2 'this creates a two-dimensional array with rows on the first and columns on the second index\narrSource = wsSource.Range(...).value2\n\n'loop through rows I suppose\nfor k = LBound(arrData,1) to UBound(arrData,1)\n    if arrData(k, yourColumn) = ... then\n        arrData(k, yourColumn) = arrSource(rowhere, columnhere)\n    endif   \nnext k\n\nwscheck.range(\"Data\") = arrData\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 6199625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83d46ef1482a035f7af3951acb0af26?s=128&d=identicon&r=PG&f=1", "display_name": "cr44sh", "link": "https://stackoverflow.com/users/6199625/cr44sh"}, "edited": false, "score": 0, "creation_date": 1575275631, "post_id": 59070010, "comment_id": 104497671, "body": "It would be logical to use your array arrNames instead of <code>wsNia.Cells(i,2) etc.</code>"}], "tags": [], "owner": {"reputation": 59, "user_id": 10651865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cdfea5dfa53056bc595ca46f4f811?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Shazam", "link": "https://stackoverflow.com/users/10651865/mr-shazam"}, "is_accepted": false, "score": 0, "last_activity_date": 1574856861, "creation_date": 1574856861, "answer_id": 59070010, "question_id": 59064418, "link": "https://stackoverflow.com/questions/59064418/speed-up-a-vba-replace-loop-possible-or-use-other-method/59070010#59070010", "title": "Speed up a VBA Replace-loop possible or use other method?", "body": "<p>Its working now!!!\nIf you see mistakes let me know!</p>\n\n<pre><code>Dim arrData As Variant, arrSource As Variant, arrNames As Variant, k As Long\n\narrData = wsChecklist.Range(\"Checklist\").Value2 'this creates a two-dimensional array with rows on the first and columns on the second index\narrSource = wsSupport.Range(\"ReplaceNames\").Value2\narrNames = wsNia.Range(\"D1:D1000\").Value2\n\n'loop through rows I suppose\nFor k = LBound(arrData, 1) To UBound(arrData, 1)\nFor j = LBound(arrData, 2) To UBound(arrData, 2)\n\n'    If UCase(arrData(k, j)) = UCase(arrSource(x, 1)) Then\n    If UCase(arrSource(x, 1)) = UCase(arrData(k, j)) Then\n\n    For i = 1 To 1000\n            Name1 = wsNia.Cells(i, 2)\n            Name2 = wsNia.Cells(i, 3)\n            Name = Name1 &amp; \"_\" &amp; Name2\n\n        If UCase(arrData(k, j)) = UCase(Name) Then\n                arrData(k, j) = arrNames(i, 1)\n                x = x + 1\n                k = 1\n                j = 1\n                i = 1\n\n            Exit For\n        End If\n\n\nNext i\n\n    End If\n\nIf k &gt; 2900 And x &lt; 265 Then\n    x = x + 1\n    j = 1\n    k = 1\nEnd If\n\nNext j\nNext k\n\nwsChecklist.Range(\"Checklist\").Value2 = arrData\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 10651865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/474cdfea5dfa53056bc595ca46f4f811?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Shazam", "link": "https://stackoverflow.com/users/10651865/mr-shazam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 59065824, "answer_count": 2, "score": 0, "last_activity_date": 1574856861, "creation_date": 1574836815, "last_edit_date": 1574846210, "question_id": 59064418, "link": "https://stackoverflow.com/questions/59064418/speed-up-a-vba-replace-loop-possible-or-use-other-method", "title": "Speed up a VBA Replace-loop possible or use other method?", "body": "<p>I have a small VBA Loop but it takes over 2-3 minute to finish, any idea how I can speed up/rewrite it that it will be faster?</p>\n\n<p>The Range \"Replace Names\" is a List of 500 names of named areas in \"Data\".\nThe for loop searches for the one that matches the name in \"Data\" and replaces the one with the name from \"Source\". This also works fine, but it takes a while. Is there a faster method?</p>\n\n<pre><code>Application.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\n    For Each ID_name In wsSupport.Range(\"ReplaceNames\")\n        wsCheck.Range(\"Data\").Replace ID_name, wsSource.Range(ID_name), xlWhole\n\n    Next\n\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1574854459, "post_id": 59063921, "comment_id": 104376629, "body": "Suggest to declare the object variable <code>wb</code> and set it to memory, e.g. via <code>Dim wb As WorkBook</code> and <code>Set wb = ThisWorkbook</code> (or just use the sheet&#39;s CodeName as reference - see VB Editor&#39;s tool window ~&gt; <code>(Name)</code> in brackets); btw try to avoid unnecessary <code>Activate</code> and <code>.Select</code> :-)"}, {"owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1574877027, "post_id": 59063921, "comment_id": 104389114, "body": "Thanks so I need to set it in the Sub Procedure it is running, it cannot obtain that data from another Sub"}], "owner": {"reputation": 39, "user_id": 12401306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0398ce99e0e65db50c2fa20fb48d53c?s=128&d=identicon&r=PG&f=1", "display_name": "Mturks83", "link": "https://stackoverflow.com/users/12401306/mturks83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574849721, "creation_date": 1574834356, "last_edit_date": 1574849721, "question_id": 59063921, "link": "https://stackoverflow.com/questions/59063921/excel-vba-module-wide-variable", "title": "Excel VBA - Module wide variable", "body": "<p>I have allocated my variables above the 1st sub procedure to make it available to all sub procedures. When I run my 2nd procedure I receive a 'with block variable not set' error</p>\n\n<pre><code>Dim CWS As Worksheet\n\n\nSub Test()\n\nSet CWS = WB.Worksheets(\"Checks\")\n\nCWS.Activate\nCWS.Range(\"M5:M16\").Copy\nCWS.Range(\"f5\").PasteSpecial xlValues\n\nCWS.Range(\"M19:M32\").Copy\nCWS.Range(\"f19\").PasteSpecial xlValues\n\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574833224, "post_id": 59063694, "comment_id": 104366091, "body": "Please include the code you are using in your question and explain the problems you are having with it."}], "answers": [{"tags": [], "owner": {"reputation": 426, "user_id": 6805396, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1202317043165603/picture?type=large", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6805396/vlad"}, "is_accepted": true, "score": 0, "last_activity_date": 1574835111, "creation_date": 1574835111, "answer_id": 59064075, "question_id": 59063694, "link": "https://stackoverflow.com/questions/59063694/vba-copy-row-values-one-row-up/59064075#59064075", "title": "VBA copy row values one row up", "body": "<p>You should try this:</p>\n\n<pre><code>Sub MoveValues()    \n    With ActiveSheet\n        For Each Row In .Rows\n            If Row.Cells(3) &lt;&gt; 0 Then\n                Range(Cells(Row.Row, 3), Cells(Row.Row, 5)).Cut Destination:=Range(Cells(Row.Row - 1, 3), Cells(Row.Row - 1, 5))\n            End If\n        Next Row\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10917972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b059334f314587600a2d8d50672085d?s=128&d=identicon&r=PG&f=1", "display_name": "vbalearner9999", "link": "https://stackoverflow.com/users/10917972/vbalearner9999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 59064075, "answer_count": 1, "score": 0, "last_activity_date": 1574835111, "creation_date": 1574833114, "last_edit_date": 1574833208, "question_id": 59063694, "link": "https://stackoverflow.com/questions/59063694/vba-copy-row-values-one-row-up", "title": "VBA copy row values one row up", "body": "<p>I have a filtered spreadsheet with alternating rows as follows:\n- a value in col A in one row\n- next row has values in col C and E\nUsing VBA, how do I copy paste the values in col C and E up one row for the entire used range of the sheet?</p>\n\n<p><a href=\"https://i.stack.imgur.com/4cmmn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4cmmn.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want the numbers to be moved up one row to be in the same row as the letters.</p>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574832170, "post_id": 59063317, "comment_id": 104365737, "body": "So you are supplying it with one filename but expecting it to output multiple files? It doesnt work like that - Excel has no option for doing what you want. You would have to loop through all of the sheets and save each one individually because CSV files do not support saving multiple sheets."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574832264, "post_id": 59063317, "comment_id": 104365774, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/59075/save-each-sheet-in-a-workbook-to-separate-csv-files\">Save each sheet in a workbook to separate CSV files</a>"}, {"owner": {"reputation": 73, "user_id": 11644805, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KUz4THudr0w/AAAAAAAAAAI/AAAAAAAAAF4/l7L0x7UiFp0/photo.jpg?sz=128", "display_name": "Sabatino Ognibene", "link": "https://stackoverflow.com/users/11644805/sabatino-ognibene"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574834477, "post_id": 59063317, "comment_id": 104366520, "body": "No I&#39;m not trying to save each worksheet.  The one worksheet it saves is fine.  I just need it to save as a copy and let me keep working on the XLSX file.  SaveAsCopy does not work.  Interesting that you linked the save each sheet thing because I already read that before posting."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574834724, "post_id": 59063317, "comment_id": 104366609, "body": "OK, then how about this one? <a href=\"https://stackoverflow.com/questions/34155718/vba-saving-single-sheet-as-csv-not-whole-workbook\" title=\"vba saving single sheet as csv not whole workbook\">stackoverflow.com/questions/34155718/&hellip;</a> - it makes a copy of your active sheet, and then saves that as the CSV, leaving your multisheet workbook in tact."}, {"owner": {"reputation": 73, "user_id": 11644805, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KUz4THudr0w/AAAAAAAAAAI/AAAAAAAAAF4/l7L0x7UiFp0/photo.jpg?sz=128", "display_name": "Sabatino Ognibene", "link": "https://stackoverflow.com/users/11644805/sabatino-ognibene"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574836727, "post_id": 59063317, "comment_id": 104367373, "body": "braX that&#39;s very close.  The code is truncated in that link however.  IE:  lastcol and lastrow are not DIMed or Set.  I will have to look at it tomorrow and see if I can piece it back together.  If I&#39;m able to figure it out based on that link, I will responding saying as much."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574836790, "post_id": 59063317, "comment_id": 104367399, "body": "Sounds good - make sure to look at the accepted answer, and not the code in the question itself (which is truncated as you say)"}], "owner": {"reputation": 73, "user_id": 11644805, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-KUz4THudr0w/AAAAAAAAAAI/AAAAAAAAAF4/l7L0x7UiFp0/photo.jpg?sz=128", "display_name": "Sabatino Ognibene", "link": "https://stackoverflow.com/users/11644805/sabatino-ognibene"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 422, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574835404, "creation_date": 1574831071, "last_edit_date": 1574835404, "question_id": 59063317, "link": "https://stackoverflow.com/questions/59063317/save-copy-as-csv-msdos-without-closing-changing-workbooks", "title": "Save Copy as CSV MSDOS (Without closing/changing workbooks)", "body": "<p>I have a macro that saves the current workbook as CSV MSDOS format.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub Save_CSV()\nDim Location, FileName As String\n            Location = \"C:\\Users\\myawesomename\\OneDrive\\Desktop\\GM MRP\\\"\n            FileName = Left(ActiveWorkbook.name, Len(ActiveWorkbook.name) - 5)\n                ActiveWorkbook.SaveAs FileName:= _\n                    Location &amp; FileName &amp; \".csv\", FileFormat:= _\n                    xlCSVMSDOS, CreateBackup:=False\n                ActiveWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>After I use this macro, I'm no longer working on the xlsv.  Rather, I'm working on the CSV version with all the sheets still present.  If I close the workbook without saving it, I can then open the CSV file and only the first sheet is present.  It's fine that only the first sheet is present but I want it to save a separate CSV file (with the first sheet only present) while continuing to work on the XLSX file without opening the CSV at all.  I'm not trying to save each sheet as a separate file.</p>\n\n<p>I tried several things including changing \"Activeworkbook.SaveAs\" to \"Activeworkbook.savecopyas\" but I couldn't achieve the desired result.  </p>\n\n<p>Thank you,</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574830235, "post_id": 59063156, "comment_id": 104365278, "body": "Please include the code you are using for this in your question. Stack Overflow is not a free code writing service."}, {"owner": {"reputation": 1, "user_id": 10631680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab32076fe31b31aeee3665185de3efd?s=128&d=identicon&r=PG&f=1", "display_name": "Vainika", "link": "https://stackoverflow.com/users/10631680/vainika"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574830636, "post_id": 59063156, "comment_id": 104365371, "body": "Sorry, I have edited. Not sure if it helps.."}, {"owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574832315, "post_id": 59063156, "comment_id": 104365792, "body": "Do you explicitly need this in vba? as it can be done with fomula as well."}, {"owner": {"reputation": 1, "user_id": 10631680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab32076fe31b31aeee3665185de3efd?s=128&d=identicon&r=PG&f=1", "display_name": "Vainika", "link": "https://stackoverflow.com/users/10631680/vainika"}, "reply_to_user": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574833928, "post_id": 59063156, "comment_id": 104366346, "body": "@Bankar i would prefer VBA, but i can try with the formula as well."}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "is_accepted": false, "score": 0, "last_activity_date": 1574834684, "creation_date": 1574834684, "answer_id": 59063987, "question_id": 59063156, "link": "https://stackoverflow.com/questions/59063156/change-value-of-second-and-following-duplicates/59063987#59063987", "title": "Change value of second and following duplicates", "body": "<p>Here would be a formula approach, assume Column A is the duplicated data and column B the dates. Row one contains the headers and the required info is from row 2 onwards</p>\n\n<pre><code>First, sort the data, column B oldest to newest, then Column A smallest to largest\n\nIn cell C2, copy back the date from cell B2 (as this is the first data row, it will be the same date)\n\nIn cell C3, input the formula =IF(A2=A1,B2+1,B2), and copy it down to the final row of the raw data\n</code></pre>\n\n<p>You can script the same into vba, by recording the steps above and fine tuning where necessary</p>\n"}], "owner": {"reputation": 1, "user_id": 10631680, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab32076fe31b31aeee3665185de3efd?s=128&d=identicon&r=PG&f=1", "display_name": "Vainika", "link": "https://stackoverflow.com/users/10631680/vainika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574834684, "creation_date": 1574829986, "last_edit_date": 1574831371, "question_id": 59063156, "link": "https://stackoverflow.com/questions/59063156/change-value-of-second-and-following-duplicates", "title": "Change value of second and following duplicates", "body": "<p>I have 2 columns of data. As shown in the image below, first column has a list of duplicates and second column has the first day of the month as date. The first duplicate should be remained as 01-11-19, whereas the next duplicate should have 1 to be added in the cell to make it 02-11-19, followed by the other duplicates. How do I code this in VBA?</p>\n\n<p>I tried this function, but it's not working as expected since it's modifying both the duplicates, but I only want the next duplicate to be modified.</p>\n\n<pre><code>Dim Rng, cel As range\n\nSet Rng = .range(.Cells(firstrow, 1), .Cells(lastrow, 2))\n\nFor Each cel In Rng\n    If WorksheetFunction.CountIf(Rng, cel.value) &gt; 1 Then\n        WorksheetName.Cells(cel.row, 2).value = WorksheetName.Cells(cel.row, 2).value + 1\n    End If \nNext cel\n</code></pre>\n\n<p>Column 1 with duplicates and column 2 to be added 1 to make it next following date</p>\n\n<p><a href=\"https://i.stack.imgur.com/GAWyz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GAWyz.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1325, "user_id": 9679683, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sa5Kn9CC-VQ/AAAAAAAAAAI/AAAAAAAAAC4/7Rvi79V1uTI/photo.jpg?sz=128", "display_name": "ProfoundlyOblivious", "link": "https://stackoverflow.com/users/9679683/profoundlyoblivious"}, "edited": false, "score": 0, "creation_date": 1574853008, "post_id": 59062643, "comment_id": 104375800, "body": "Not 100% certain I understand your problem or your objective but you may benefit from looking into <code>DateSerial</code>.  It&#39;s a bit more intuitive than some other options."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11854924, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WM98ZFdK39s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdO8nmmqeWuynleCi3FtGk5ckiMrg/photo.jpg?sz=128", "display_name": "Darren", "link": "https://stackoverflow.com/users/11854924/darren"}, "edited": false, "score": 1, "creation_date": 1574904188, "post_id": 59070533, "comment_id": 104397931, "body": "Hi there I would like to thank you for your help. Really appreciate it as I solely learnt it off the internet with zero knowledge. your explanation really helped me out. Thank you once again!"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1574858600, "creation_date": 1574858600, "answer_id": 59070533, "question_id": 59062643, "link": "https://stackoverflow.com/questions/59062643/creating-a-string-of-month-in-a-column/59070533#59070533", "title": "Creating a string of month in a column", "body": "<p><strong>Write month dates into column</strong></p>\n\n<p>You have several issues here. Basically you aren't incrementing the year (correct: <code>Year(Now)</code> + increment) and you are overwriting each target cell 12-times with the last calculated value.</p>\n\n<p><strong>Working example procedure</strong></p>\n\n<pre><code>Option Explicit                     ' declaration head of your code module\n\nSub demo()\nWith Sheet1                         ' &lt;&lt; Reference the sheet's CodeName, e.g. Sheet1\n    Dim repetition As Long          ' &lt;&lt; Long, provide for counters greater than ~65K\n    For repetition = 1 To 10        ' &lt;&lt; change to ..= 1 to 1 if only one column :-)\n\n        Dim mon As Long\n        For mon = 1 To 12\n          ' calculate month date via DateSerial function (arguments year,month,day) \n            Dim StartDate As Date\n            StartDate = DateSerial(Year(Now) + repetition, mon, 1)\n          ' write to fully referenced range - note the prefixed \".\" referring to the sheet object  \n            .Cells((repetition - 1) * 12 + mon, 1).Value = StartDate\n            .Cells((repetition - 1) * 12 + mon, 1).NumberFormat = \"mmm-yyyy\"\n        Next mon\n\n    Next repetition\nEnd With\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11854924, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WM98ZFdK39s/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdO8nmmqeWuynleCi3FtGk5ckiMrg/photo.jpg?sz=128", "display_name": "Darren", "link": "https://stackoverflow.com/users/11854924/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 59070533, "answer_count": 1, "score": 0, "last_activity_date": 1574858600, "creation_date": 1574825946, "last_edit_date": 1574857850, "question_id": 59062643, "link": "https://stackoverflow.com/questions/59062643/creating-a-string-of-month-in-a-column", "title": "Creating a string of month in a column", "body": "<p>I would like to create a date column formatted via <code>\"mmm-yyyy\"</code> but starting with next year's date, i.e.</p>\n\n<pre><code>Jan-2020\nFeb-2020\nMar-2020\nApr-2020\nMay-2020\nJun-2020\nJul-2020\nAug-2020\nSep-2020\nOct-2020\nNov-2020\nDec-2020\n</code></pre>\n\n<p>My code only created the <em>same</em> month for 12 times. Can any one help me with this? </p>\n\n<p><strong>My current code</strong></p>\n\n<pre><code>Sub demo()\n\n'month recurring till dec\nDim x As Integer\nDim i As Integer\n\nFor x = 1 To 12\n\n    For i = 1 To 12\n        StartDate = (month(x + 1)) &amp; \"-\" &amp; (Year(Now())) + 1\n        Cells(i, 1).Value = StartDate\n        Cells(i, 1).NumberFormat = \"mmm-yyyy\"\n    Next i\n\nNext x\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1574828487, "post_id": 59062631, "comment_id": 104364851, "body": "still cant get it after 7 posts in 24 hours, eh?"}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 8185239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed11af270cf8f2f40b242374e1421738?s=128&d=identicon&r=PG", "display_name": "Edoardo Facchinelli", "link": "https://stackoverflow.com/users/8185239/edoardo-facchinelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1574827797, "creation_date": 1574827797, "answer_id": 59062881, "question_id": 59062631, "link": "https://stackoverflow.com/questions/59062631/bold-the-entire-row-based-on-a-cells-font/59062881#59062881", "title": "Bold the entire row based on a cell&#39;s font", "body": "<p>The code sample is missing an <code>end with</code> after the first one to run.</p>\n\n<p>Other than that, the issue is here: <code>If cell(cell.Row, 6).Font.Bold</code></p>\n\n<p><code>cell</code> is already a Range type reference to the cell you need, so you don't need to look up anything, in fact doing that causes it to point elsewhere with the cell function: for example this is from the watch window, note the value difference:</p>\n\n<pre><code>Watch :   : cell.Address              : \"$F$2\" : String         : Module1.Bold\nWatch :   : cell(cell.Row, 6).Address : \"$K$3\" : Variant/String : Module1.Bold\n</code></pre>\n\n<p>This is the full code:</p>\n\n<pre><code>Sub Bold()\n\n    Dim CheckRange As Range\n    Dim cell As Range\n\n    With ActiveSheet\n        Set CheckRange = .Range(\"F2:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row)\n\n    End With\n\n    With CheckRange\n    .FormatConditions.Delete\n    .FormatConditions.Add Type:=xlCellValue, Operator:=xlGreaterEqual, Formula1:=\"1000000\"\n        With .FormatConditions(1)\n             .Font.Bold = True\n             .StopIfTrue = False\n        End With\n    End With\n\n    For Each cell In CheckRange\n        If cell.Font.Bold = True Then\n            cell.EntireRow.Font.Bold = True\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 10312648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff78a557a612bb7606635b940b42a70?s=128&d=identicon&r=PG&f=1", "display_name": "JeffCh", "link": "https://stackoverflow.com/users/10312648/jeffch"}, "edited": false, "score": 0, "creation_date": 1574830937, "post_id": 59062927, "comment_id": 104365435, "body": "Both methods work just fine! Thanks a bunch! May I know how does Offset and Resize work in this case? <code>cell.Offset(, -5).Resize(1, 26).Font.Bold = True</code>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "reply_to_user": {"reputation": 43, "user_id": 10312648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff78a557a612bb7606635b940b42a70?s=128&d=identicon&r=PG&f=1", "display_name": "JeffCh", "link": "https://stackoverflow.com/users/10312648/jeffch"}, "edited": false, "score": 0, "creation_date": 1574832408, "post_id": 59062927, "comment_id": 104365828, "body": "You&#39;re welcome. As cell in column F so offset by -5 will make the cell address is in Column A then from A to Z is 26 Columns so I used Resize."}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 1, "last_activity_date": 1574828172, "creation_date": 1574828172, "answer_id": 59062927, "question_id": 59062631, "link": "https://stackoverflow.com/questions/59062631/bold-the-entire-row-based-on-a-cells-font/59062927#59062927", "title": "Bold the entire row based on a cell&#39;s font", "body": "<p>May be using a formula for the conditional formatting is better</p>\n\n<pre><code>Sub Bold()\nWith ActiveSheet.UsedRange\n    .FormatConditions.Delete\n    .Range(\"A1:Z\" &amp; .Cells(Rows.Count, 6).End(xlUp).Row).FormatConditions.Add Type:=xlExpression, Formula1:=\"=$F1&gt;=1000000\"\n    With .FormatConditions(1)\n        .Font.Bold = True\n        .StopIfTrue = False\n    End With\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Or to adhere to your code you can use offset and resize in the loop</p>\n\n<pre><code>Sub Bold()\nDim checkRange As Range, cell As Range\n\nWith ActiveSheet\n    Set checkRange = .Range(\"F2:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row)\nEnd With\n\nWith checkRange\n    .FormatConditions.Delete\n    .FormatConditions.Add Type:=xlCellValue, Operator:=xlGreaterEqual, Formula1:=\"1000000\"\n    With .FormatConditions(1)\n        .Font.Bold = True\n        .StopIfTrue = False\n    End With\nEnd With\n\nFor Each cell In checkRange\n    If cell.DisplayFormat.Font.Bold = True Then\n        cell.Offset(, -5).Resize(1, 26).Font.Bold = True\n    End If\nNext cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10312648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff78a557a612bb7606635b940b42a70?s=128&d=identicon&r=PG&f=1", "display_name": "JeffCh", "link": "https://stackoverflow.com/users/10312648/jeffch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "accepted_answer_id": 59062927, "answer_count": 2, "score": -2, "last_activity_date": 1574829739, "creation_date": 1574825858, "last_edit_date": 1574829739, "question_id": 59062631, "link": "https://stackoverflow.com/questions/59062631/bold-the-entire-row-based-on-a-cells-font", "title": "Bold the entire row based on a cell&#39;s font", "body": "<p>I have a set of data in columns A to Z, if any cells in Column F is bolded, shall call to bold the entire row.</p>\n\n<p>For example, F3 and F80 is bolded. A3:Z3 and A80:Z80 shall be bolded. My code only works until bolding cells in column F, can't proceed to bold the entire row.</p>\n\n<pre><code>Sub Bold()\n\n    Dim CheckRange As Range\n    Dim cell As Range\n\n    With ActiveSheet\n        Set CheckRange = .Range(\"F2:F\" &amp; .Cells(.Rows.Count, \"F\").End(xlUp).Row)\n\n    End With\n\n    With CheckRange\n    .FormatConditions.Delete\n    .FormatConditions.Add Type:=xlCellValue, Operator:=xlGreaterEqual, formula1:=\"1000000\"\n        With .FormatConditions(1)\n             .Font.Bold = True\n             .StopIfTrue = False\n        End With\n\n    For Each cell In CheckRange\n        If cell(cell.Row, 6).Font.Bold = True Then\n            cell.EntireRow.Font.Bold = True\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Any help is much appreciated.</p>\n"}, {"tags": ["excel", "vba", "powershell", "csv", "scripting"], "comments": [{"owner": {"reputation": 65, "user_id": 7749215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82621c10327bd2f41a9b6ec8c4788900?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Chandra", "link": "https://stackoverflow.com/users/7749215/mahesh-chandra"}, "edited": false, "score": 0, "creation_date": 1575349093, "post_id": 59062618, "comment_id": 104526062, "body": "Can no one help with the VBA code to Powershell conversion ?"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 7749215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82621c10327bd2f41a9b6ec8c4788900?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Chandra", "link": "https://stackoverflow.com/users/7749215/mahesh-chandra"}, "edited": false, "score": 0, "creation_date": 1574890776, "post_id": 59062765, "comment_id": 104394684, "body": "Thanks for directing me in the right direction. lesson learned quotes are important."}, {"owner": {"reputation": 11243, "user_id": 9132707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12beb3b6caac330d6ebf6c855c35d1e?s=128&d=identicon&r=PG&f=1", "display_name": "postanote", "link": "https://stackoverflow.com/users/9132707/postanote"}, "reply_to_user": {"reputation": 65, "user_id": 7749215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82621c10327bd2f41a9b6ec8c4788900?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Chandra", "link": "https://stackoverflow.com/users/7749215/mahesh-chandra"}, "edited": false, "score": 0, "creation_date": 1574891100, "post_id": 59062765, "comment_id": 104394790, "body": "No worries, it catches many who are new to PowerShell or coming from a different language and using what they know from there and/or habits that are not the same in PowerShell."}], "tags": [], "owner": {"reputation": 11243, "user_id": 9132707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f12beb3b6caac330d6ebf6c855c35d1e?s=128&d=identicon&r=PG&f=1", "display_name": "postanote", "link": "https://stackoverflow.com/users/9132707/postanote"}, "is_accepted": false, "score": 0, "last_activity_date": 1574829071, "last_edit_date": 1574829071, "creation_date": 1574826866, "answer_id": 59062765, "question_id": 59062618, "link": "https://stackoverflow.com/questions/59062618/csv-to-excel-with-pivot-table/59062765#59062765", "title": "CSV to Excel with pivot table", "body": "<p>It is because this is exactly what you told it to do.</p>\n\n<pre><code>$excel.Workbooks.item(1).SaveAs('C:\\Users\\User\\Desktop\\$name.xlsx',51)\n</code></pre>\n\n<p>Quotes are important. Single quotes mean to pass the string exactly as-is.</p>\n\n<p>As defined in the help files.</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_quoting_rules\" rel=\"nofollow noreferrer\">about_Quoting_Rules - PowerShell | Microsoft Docs</a></li>\n</ul>\n\n<p>Variables must be expanded, and in a string, you must use double-quotes.</p>\n\n<pre><code>$excel.Workbooks.item(1).SaveAs(\"C:\\Users\\User\\Desktop\\$name.xlsx\",51)\n</code></pre>\n\n<p>Here are a couple of good articles for your edification on the topic as well:</p>\n\n<ul>\n<li><a href=\"https://trevorsullivan.net/2016/07/20/powershell-quoting\" rel=\"nofollow noreferrer\">A Story of PowerShell Quoting Rules</a></li>\n<li><a href=\"https://www.computerperformance.co.uk/powershell/quotes\" rel=\"nofollow noreferrer\">Windows PowerShell Quotes</a></li>\n</ul>\n\n<p>Point of note: \nThat Write-Host is not needed if all you are doing is outputting text to the screen. In Powe3rShell output to the screen is the default. Also, depending on what version of PowerShell you are on, Write-Host empties the buffer, and anything after that is not usable elsewhere. Later versions of PowerShell does not have this issue, but it's still best to avoid Write-Host, unless you are sending a colorized text to the screen, or other custom formatting scenarios.</p>\n\n<p>Additional reading:</p>\n\n<ul>\n<li><a href=\"http://www.jsnover.com/blog/2013/12/07/write-host-considered-harmful\" rel=\"nofollow noreferrer\">Write-Host Considered Harmful</a></li>\n</ul>\n\n<p>... Jeffrey Snover changes his stance on this as of May 2016.</p>\n\n<blockquote>\n  <p>With PowerShell v5 Write-Host no longer \"kills puppies\". data is\n  captured into info stream ... </p>\n  \n  <p><a href=\"https://twitter.com/jsnover/status/727902887183966208\" rel=\"nofollow noreferrer\">https://twitter.com/jsnover/status/727902887183966208</a> ...</p>\n  \n  <p><a href=\"https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Utility/Write-Information?view=powershell-5.1\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Utility/Write-Information?view=powershell-5.1</a></p>\n</blockquote>\n\n<p>Lastly, you are no completely cleaning up behind yourself. Though you are quitting Excel, you are not exiting the Excel process, thus releasing those resources and the COM stuff. So, stopping that process and garbage collection is warranted. </p>\n\n<p>For example:</p>\n\n<pre><code>Get-Process -Name 'EXCEL' | Stop-Process\n\nFunction Clear-ResourceEnvironment\n{\n    # Clear any PowerShell sessions created\n    Get-PSSession | Remove-PSSession\n\n    # Release any COM object created\n    $null = [System.Runtime.InteropServices.Marshal]::ReleaseComObject([System.__ComObject]$Shell)\n\n    # Perform garbage collection on session resources \n    [System.GC]::Collect()         \n    [GC]::Collect()\n    [GC]::WaitForPendingFinalizers()\n\n    &lt;# \n    Remove any custom variables created\n    some list of your variable, or a wildcard when prefix was used.\n    #&gt;\n\n    Get-Variable -Name MyShell -ErrorAction SilentlyContinue | Remove-Variable\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7749215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82621c10327bd2f41a9b6ec8c4788900?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Chandra", "link": "https://stackoverflow.com/users/7749215/mahesh-chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574971410, "creation_date": 1574825781, "last_edit_date": 1574971410, "question_id": 59062618, "link": "https://stackoverflow.com/questions/59062618/csv-to-excel-with-pivot-table", "title": "CSV to Excel with pivot table", "body": "<p>So I am trying to write a easy code to convert a csv to excel, insert a pivot table and then save it. the below code runs fine but the excel file is being saved with the name $name instead of the content of $name... and also can I use VBA code in powershell script ? I want to insert a pivot table and I can only find vba code for it....</p>\n\n<pre><code>    Add-Type -AssemblyName System.Windows.Forms\n\n    $FileBrowser = New-Object System.Windows.Forms.OpenFileDialog -Property @{\n\n    InitialDirectory = [Environment]::GetFolderPath('Desktop')\n\n    Filter = 'SpreadSheet (*.csv)|*.csv'\n\n    }\n\n    $FileBrowser.ShowDialog()\n\n    $file = $FileBrowser.FileName\n\n    $name= $FileBrowser.SafeFileName\n\n    Write-Host $name\n\n    $excel = New-Object -ComObject Excel.Application\n\n    $excel.Visible = $true\n\n    $excel.DisplayAlerts = $false\n\n    $excel.Workbooks.Open($file)\n\n    $excel.Workbooks.item(1).SaveAs('C:\\Users\\User\\Desktop\\$name.xlsx',51)\n\n    $excel.Quit()\n\n    [System.Runtime.InteropServices.Marshal]::ReleaseComObject($excel)\n</code></pre>\n\n<p>so after fixing the code here is the end product.... </p>\n\n<pre><code>    Add-Type -AssemblyName System.Windows.Forms\n    $FileBrowser = New-Object System.Windows.Forms.OpenFileDialog -Property @{ \n    InitialDirectory = [Environment]::GetFolderPath('Desktop')\n    Filter = 'SpreadSheet (*.csv)|*.csv'\n     }\n    $FileBrowser.ShowDialog()\n    $file = $FileBrowser.FileName\n    $name = $FileBrowser.SafeFileName -replace \".{4}$\"\n    $excel = New-Object -ComObject Excel.Application\n    $excel.Visible = $true\n    $excel.DisplayAlerts = $false\n    $excel.Workbooks.Open($file)\n    #$excel.Workbooks.Item(1).activate()\n    #$excel.ActiveSheet.Cells.Select()  \n$excel.Workbooks.item(1).SaveAs(\"C:\\Users\\User\\Desktop\\$name.xlsx\",51)\n    $excel.Quit()\n    [System.Runtime.InteropServices.Marshal]::ReleaseComObject($excel)\n</code></pre>\n\n<p>Now I want to add a Pivot table to this. I added the lines to activate the workbook and select all the cells... now I have the VBA code but can someone help me translate it to the powershell ?</p>\n\n<pre><code>Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"2!R1C1:R1048576C27\", Version:=6).CreatePivotTable TableDestination:= _\n        \"Sheet1!R3C1\", TableName:=\"PivotTable3\", DefaultVersion:=6\n    Sheets(\"Sheet1\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Domain\")\n        .Orientation = xlRowField\n        .Position = 1\n</code></pre>\n\n<p>The above VBA is a macro that I recorded that gives us the steps... now we just have to translate it to power shell... I am lost as figuring the code till now itself was hours of tinkering...  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 12364291, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fMKI48h2CQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3qiw9n-qssf_vl1taucdzodXHKg/photo.jpg?sz=128", "display_name": "Hexmoon", "link": "https://stackoverflow.com/users/12364291/hexmoon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574824258, "post_id": 59062340, "comment_id": 104363945, "body": "Im using the pagefields to filter out to show for specific years for the chart"}, {"owner": {"reputation": 1, "user_id": 12364291, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fMKI48h2CQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3qiw9n-qssf_vl1taucdzodXHKg/photo.jpg?sz=128", "display_name": "Hexmoon", "link": "https://stackoverflow.com/users/12364291/hexmoon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574824828, "post_id": 59062340, "comment_id": 104364049, "body": "It is part of the table for the chart,it is just that i am filtering out the years on the table then extracting the table data to create the chart based on the code"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574824871, "post_id": 59062340, "comment_id": 104364057, "body": "Untested, but does <code>TableRange1</code> fail?"}, {"owner": {"reputation": 1, "user_id": 12364291, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fMKI48h2CQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3qiw9n-qssf_vl1taucdzodXHKg/photo.jpg?sz=128", "display_name": "Hexmoon", "link": "https://stackoverflow.com/users/12364291/hexmoon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574825531, "post_id": 59062340, "comment_id": 104364209, "body": "I tested it just now,it still fails on the button2 _click code"}], "owner": {"reputation": 1, "user_id": 12364291, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fMKI48h2CQ0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc3qiw9n-qssf_vl1taucdzodXHKg/photo.jpg?sz=128", "display_name": "Hexmoon", "link": "https://stackoverflow.com/users/12364291/hexmoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574823394, "creation_date": 1574823394, "question_id": 59062340, "link": "https://stackoverflow.com/questions/59062340/run-time-error-method-setsourcedata-of-object-chart-failed-while-attemptin", "title": "Run time error : Method &#39;SetSourceData of object &#39;_chart&#39; failed while attempting to create multiple pivot charts from pivot tables", "body": "<p>I am trying to generate 2 charts based on a pivot table with data pulled from a microsoft access table with conditions and filters based on button click, however everytime i tried to run a macro for a button script for the 2nd button i get the error on the title.</p>\n\n<p>This is the code that is not functioning</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nDim sh As Shape\nDim ch As Chart\nDim pc As PivotCache\nDim ws As Worksheet\nDim pt As PivotTable\nDim NameString As String\nDim Pf As PivotField\nDim NumFilter As Integer\n\nNameString = \"Department Comparison\" &amp; \" \" &amp; TextBox1.Value\nSet pc = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=Sheet1.Name &amp; \"!\" &amp; Sheet1.Range(\"A1\").CurrentRegion.Address, Version:=xlPivotTableVersion15)\n\nSet ws = Worksheets.Add\nws.Name = NameString\n\nRange(\"A3\").Select\n\nSet pt = pc.CreatePivotTable(TableDestination:=ActiveCell, TableName:=NameString)\n\npt.AddFields RowFields:=\"Ms\", PageFields:=\"Y\", ColumnFields:=\"D\"\n\n\npt.AddDataField pt.PivotFields(\"RT\"), Function:=XlConsolidationFunction.xlSum\n\npt.AddDataField pt.PivotFields(\"ORT\"), Function:=XlConsolidationFunction.xlSum\n\npt.AddDataField pt.PivotFields(\"EA\"), Function:=XlConsolidationFunction.xlSum\n\npt.AddDataField pt.PivotFields(\"PA\"), Function:=XlConsolidationFunction.xlSum\n\npt.DataFields(1).NumberFormat = \"#,##0\"\n\nSet ws = Worksheets(NameString)\nSet sh = ws.Shapes.AddChart2(XlChartType:=XlChartType.xlLine, Left:=300, Top:=500, Width:=500, Height:=500)\nSet ch = sh.Chart\nSet pt = ws.PivotTables(1)\n\nch.SetSourceData pt.TableRange2\n\nSet Pf = ActiveSheet.PivotTables(NameString).PivotFields(\"Y\")\n\nPf.CurrentPage = TextBox1.Value\n\n\npt.PivotFields(\"Ms\").AutoSort Order:=xlAscending, Field:=\"Sum of ORT\"\n\n\nSet pc = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=Sheet2.Name &amp; \"!\" &amp; Sheet2.Range(\"A1\").CurrentRegion.Address, Version:=xlPivotTableVersion15)\n\n\nRange(\"J3\").Select\n\nSet pt = pc.CreatePivotTable(TableDestination:=ws.Cells(3, 11), TableName:=NameString &amp; \" Employees\")\n\npt.AddFields RowFields:=\"Month\", PageFields:=\"Year\", ColumnFields:=\"Department\"\n\npt.AddDataField pt.PivotFields(\"RT\"), Function:=XlConsolidationFunction.xlSum\n\n\n\npt.DataFields(1).NumberFormat = \"#,##0\"\n\nSet ws = Worksheets(NameString)\nSet sh = ws.Shapes.AddChart2(XlChartType:=XlChartType.xlLine, Left:=800, Top:=500, Width:=500, Height:=500)\nSet ch = sh.Chart\nSet pt = ws.PivotTables(NameString &amp; \" Employees\")\n\nch.SetSourceData pt.TableRange2     ///This is where the debugger points at the error\n\nSet Pf = ActiveSheet.PivotTables(NameString &amp; \" Employees\").PivotFields(\"Year\")\n\nPf.CurrentPage = TextBox1.Value\nEnd Sub\n</code></pre>\n\n<p>I had the first button with almost the same code with the exceptionfor setting the current page fields and it worked fine but this is the one that had issues,i compared both side to side and they are 99% the same</p>\n\n<p>First button click code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim sh As Shape\nDim ch As Chart\nDim pc As PivotCache\nDim ws As Worksheet\nDim pt As PivotTable\nDim NameString As String\nDim Pf As PivotField\nDim NumFilter As Integer\n\nNameString = ComboBox2.Value &amp; \" \" &amp; TextBox1.Value\nSet pc = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=Sheet1.Name &amp; \"!\" &amp; Sheet1.Range(\"A1\").CurrentRegion.Address, Version:=xlPivotTableVersion15)\n\nSet ws = Worksheets.Add\nws.Name = NameString\n\nRange(\"A3\").Select\n\nSet pt = pc.CreatePivotTable(TableDestination:=ActiveCell, TableName:=NameString)\n\npt.AddFields RowFields:=\"Ms\", PageFields:=Array(\"D\", \"Y\")\n\n\npt.AddDataField pt.PivotFields(\"RT\"), Function:=XlConsolidationFunction.xlSum\n\npt.AddDataField pt.PivotFields(\"ORT\"), Function:=XlConsolidationFunction.xlSum\n\npt.AddDataField pt.PivotFields(\"EA\"), Function:=XlConsolidationFunction.xlSum\n\npt.AddDataField pt.PivotFields(\"PA\"), Function:=XlConsolidationFunction.xlSum\n\npt.DataFields(1).NumberFormat = \"#,##0\"\n\nSet ws = Worksheets(NameString)\nSet sh = ws.Shapes.AddChart2(XlChartType:=XlChartType.xlLine, Left:=300, Top:=500, Width:=500, Height:=500)\nSet ch = sh.Chart\nSet pt = ws.PivotTables(1)\n\nch.SetSourceData pt.TableRange2\n\nSet Pf = ActiveSheet.PivotTables(NameString).PivotFields(\"Y\")\n\nPf.CurrentPage = TextBox1.Value\n\nSet Pf = ActiveSheet.PivotTables(NameString).PivotFields(\"D\")\n\nPf.CurrentPage = ComboBox2.Value\n\npt.PivotFields(\"Ms\").AutoSort Order:=xlAscending, Field:=\"Sum of ORT\"\n\nNameString = ComboBox2.Value &amp; \" \" &amp; TextBox1.Value\nSet pc = ThisWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=Sheet2.Name &amp; \"!\" &amp; Sheet2.Range(\"A1\").CurrentRegion.Address, Version:=xlPivotTableVersion15)\n\n\nRange(\"J3\").Select\n\nSet pt = pc.CreatePivotTable(TableDestination:=ws.Cells(3, 11), TableName:=NameString &amp; \" Employees\")\n\npt.AddFields RowFields:=\"Month\", PageFields:=\"Year\", ColumnFields:=\"Department\"\n\npt.AddDataField pt.PivotFields(\"RT\"), Function:=XlConsolidationFunction.xlSum\n\n\n\npt.DataFields(1).NumberFormat = \"#,##0\"\n\nSet ws = Worksheets(NameString)\nSet sh = ws.Shapes.AddChart2(XlChartType:=XlChartType.xlLine, Left:=800, Top:=500, Width:=500, Height:=500)\nSet ch = sh.Chart\nSet pt = ws.PivotTables(NameString &amp; \" Employees\")\n\nch.SetSourceData pt.TableRange2\n\nSet Pf = ActiveSheet.PivotTables(NameString &amp; \" Employees\").PivotFields(\"Year\")\n\nPf.CurrentPage = TextBox1.Value\n\nSet Pf = ActiveSheet.PivotTables(NameString &amp; \" Employees\").PivotFields(\"Department\")\n\nWith ActiveSheet.PivotTables(NameString &amp; \" Employees\").PivotFields(\"Department\")\nFor i = 1 To .PivotItems.Count - 1\n.PivotItems(.PivotItems(i).Name).Visible = False\nNext i\n\nEnd With\n\nPf.PivotItems(ComboBox2.Value).Visible = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "date", "datediff"], "comments": [{"owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574821561, "post_id": 59062071, "comment_id": 104363385, "body": "What do you want the result to be in, number of days?"}, {"owner": {"reputation": 68, "user_id": 10493976, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ovA01OJj9k/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXXYrGKFVPGWxYlswVhWq6zSRY4nw/mo/photo.jpg?sz=128", "display_name": "Samuel Leiton", "link": "https://stackoverflow.com/users/10493976/samuel-leiton"}, "reply_to_user": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574821755, "post_id": 59062071, "comment_id": 104363431, "body": "I just need numbers@Bankar"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574821883, "post_id": 59062071, "comment_id": 104363457, "body": "<code>Debug.Print DateDiff(&quot;d&quot;, #1&#47;16&#47;2019#, #2&#47;15&#47;2020#)</code> will give <code>395</code>"}, {"owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574822359, "post_id": 59062071, "comment_id": 104363543, "body": "Can&#39;t you just minus the dates? Assume Cell A1 = 2/15/2020, B1 = 11/16/2019. A1-B1 gives you 91, meaning the difference is 91 days"}, {"owner": {"reputation": 68, "user_id": 10493976, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ovA01OJj9k/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXXYrGKFVPGWxYlswVhWq6zSRY4nw/mo/photo.jpg?sz=128", "display_name": "Samuel Leiton", "link": "https://stackoverflow.com/users/10493976/samuel-leiton"}, "reply_to_user": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574822547, "post_id": 59062071, "comment_id": 104363598, "body": "sorry, I didn&#39;t understand your previous question, i&#39;m trying are getting days, month, year in numbers.  @Bankar"}, {"owner": {"reputation": 68, "user_id": 10493976, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ovA01OJj9k/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXXYrGKFVPGWxYlswVhWq6zSRY4nw/mo/photo.jpg?sz=128", "display_name": "Samuel Leiton", "link": "https://stackoverflow.com/users/10493976/samuel-leiton"}, "reply_to_user": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574822567, "post_id": 59062071, "comment_id": 104363604, "body": "For that, I use DateAdd to generate a future date using the month and day of the birthday date, to be able to compare This future date with otherDate and get something more accurate and eliminate unnecessary days?   @Bankar"}, {"owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 1, "creation_date": 1574822748, "post_id": 59062071, "comment_id": 104363653, "body": "Sorry mate, you lost me completely, can you edit the question to include samples? and what is the expected output?"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "is_accepted": false, "score": 0, "last_activity_date": 1574832014, "creation_date": 1574832014, "answer_id": 59063473, "question_id": 59062071, "link": "https://stackoverflow.com/questions/59062071/vba-function-to-get-difference-from-birth-date-and-other-date-using-datediff/59063473#59063473", "title": "VBA: function to get difference from birth date and other date using DateDiff", "body": "<p>Ah ok got you. You can use formula for this. Let's assume Cell A1 contains 2/15/2020 and Cell B1 contains 11/16/2019</p>\n\n<pre><code>To get the day only difference: =DATEDIF(B1,A1,\"md\")\n\nTo get the month only difference: =DATEDIF(B1,A1,\"ym\")\n\nTo get the year only difference: =DATEDIF(B1,A1,\"y\")\n</code></pre>\n\n<p>So if you want it to show in one cell, you can combine them like below:</p>\n\n<pre><code>=DATEDIF(B1,A1,\"md\") &amp; \" day(s), \"&amp;DATEDIF(B1,A1,\"ym\")&amp;\" month(s), \"&amp;DATEDIF(B1,A1,\"y\")&amp;\" year(s)\" \n\nThis will output 30 day(s), 2 month(s), 0 year(s)\n</code></pre>\n"}], "owner": {"reputation": 68, "user_id": 10493976, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5ovA01OJj9k/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXXYrGKFVPGWxYlswVhWq6zSRY4nw/mo/photo.jpg?sz=128", "display_name": "Samuel Leiton", "link": "https://stackoverflow.com/users/10493976/samuel-leiton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574832014, "creation_date": 1574820987, "last_edit_date": 1574823449, "question_id": 59062071, "link": "https://stackoverflow.com/questions/59062071/vba-function-to-get-difference-from-birth-date-and-other-date-using-datediff", "title": "VBA: function to get difference from birth date and other date using DateDiff", "body": "<p>I broke my head to get the date difference between two Dates, but at the beginning I had constant problems, for example:</p>\n\n<p>If the month was the same in both values \u200b\u200bto be compared, the result was the negative days.\nOr in some cases where it should be differences of 2 months and 30 days, it managed to have results like 3 months and 1 days, how?</p>\n\n<p>well an example would be the following:\ndate1 = \"02/15/2020\"\ndate2 = \"11/16/2019\"</p>\n\n<p>where in the end I got\nmonth = 3\nday = 1\nwhy?\nbecause at the end of 11 from 2019 to 2 of 2020 there are 3 months ... and day = 1 because of 16 - 15 are 1 (?) and if the date was a \"11/14/2019\" you would get a: day = -1</p>\n\n<p>In the end I managed to solve all my problems with the following code:</p>\n\n<pre><code>Public Function GetDiffDate(birthdate As Date, otherDate As Date) As Variant\nDim CurrentDate, Years, ThisYear, Months, ThisMonth, Days\n\nCurrentDate = CDate(birthdate )\nYears = DateDiff(\"yyyy\", CurrentDate, otherDate ) - 1\nThisYear = DateAdd(\"yyyy\", Years, otherDate )\nMonths = DateDiff(\"m\", ThisYear, otherDate )\nThisMonth = DateAdd(\"m\", Months, ThisYear)\nDays = DateDiff(\"d\", ThisMonth, otherDate )\n\nDo While (Days &lt; 0) Or (Days &gt; 0 And Months = 12) Or (Months &lt; 0) Or (Months = 12) Or (Years &lt; 0)\n\n'&gt; Here I can deduce if the days are negative, if so, then reduce the\n'&gt; account by one month and re-draw the days of difference\n\nIf Days &lt; 0 Then \n                If Months &gt; 0 Then Months = Months - 1\n                ThisMonth = DateAdd(\"m\", Months, ThisYear)\n                Days = DateDiff(\"d\", ThisMonth, otherDate ) * -1\n            End If\n            If Months &lt; 0 Then\n                ThisYear = DateAdd(\"yyyy\", Years, CurrentDate)\n                Months = DateDiff(\"m\", ThisYear, otherDate )\n                ThisMonth = DateAdd(\"m\", Months, ThisYear)\n                Days = DateDiff(\"d\", ThisMonth, otherDate )\n            End If\n\n            If Days &gt; 0 And Months = 12 Then\n                If Years &gt;= 0 Then Years = Years + 1\n                Months = 0\n            ThisMonth = DateAdd(\"m\", Months, ThisYear)\n            End If\n\n            If Months = 12 And Days = 0 Then\n                    Years = Years + 1\n                    Months = 0\n            End If\n        Loop\n    End Function\n</code></pre>\n\n<p>Example<br>\nThe mistakes I had were like this:\nbirthDate = \"02/15/2019\"\notherDate = \"02/16/2020\"</p>\n\n<p>with this code i get:</p>\n\n<pre><code>Years = DateDiff (\"yyyy\", CurrentDate, otherDate)\n\u00a0\u00a0\u00a0\u00a0 ThisYear = DateAdd (\"yyyy\", Years, otherDate)\n\u00a0\u00a0\u00a0\u00a0 Months = DateDiff (\"m\", ThisYear, otherDate)\n\u00a0\u00a0\u00a0\u00a0 ThisMonth = DateAdd (\"m\", Months, ThisYear)\n\u00a0\u00a0\u00a0\u00a0 Days = DateDiff (\"d\", ThisMonth, otherDate)\n</code></pre>\n\n<p>Results:</p>\n\n<blockquote>\n  <p>Years = 1 Months = 3 Days = -1</p>\n</blockquote>\n\n<p>but the real value should be</p>\n\n<blockquote>\n  <p>Years = 0, Months = 2, Days = 30</p>\n</blockquote>\n\n<p>For this I implemented my while do and if conditions to adjust the result as it should be.\nBut my question is:</p>\n\n<blockquote>\n  <p>If there is another way to make this more elegant?</p>\n</blockquote>\n\n<p>I appreciate it and greetings!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574819949, "post_id": 59061849, "comment_id": 104363080, "body": "You can just use the <code>Replace</code> function to replace all the <code>$</code> with an empty string..."}], "answers": [{"comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574819895, "post_id": 59061889, "comment_id": 104363072, "body": "you can edit your question instead of replying to it as an answer..."}, {"owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574820661, "post_id": 59061889, "comment_id": 104363202, "body": "Oh true. I just used the &quot;Answer Your Question&quot; button, but that also works."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574821063, "post_id": 59061889, "comment_id": 104363274, "body": "Actually, you&#39;ve answered your own question, which is perfectly acceptable, and I&#39;d argue preferred to editing the original. <a href=\"https://stackoverflow.com/help/self-answer\">stackoverflow.com/help/self-answer</a>"}, {"owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574821966, "post_id": 59061889, "comment_id": 104363476, "body": "@SiddharthRout I should have looked for the actual documentation, yes. I did Google it, however whatever I original searched for didn&#39;t come up with what I needed. If you read the &quot;I just hadn&#39;t phrased my question well enough in previous attempts to find out.&quot; portion of my answer, you&#39;d know that I actually made an attempt :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574822009, "post_id": 59061889, "comment_id": 104363481, "body": "<code>.address vba</code> If you search this in google, see what do you get :)"}, {"owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574822235, "post_id": 59061889, "comment_id": 104363521, "body": "@SiddharthRout Like I said, I hadn&#39;t phrased it well enough. I suppose being more concise and direct typically yields better results, in this case, actual documentation. I&#39;ll take your comment as a lesson then."}], "tags": [], "owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "is_accepted": false, "score": 0, "last_activity_date": 1574819427, "creation_date": 1574819427, "answer_id": 59061889, "question_id": 59061849, "link": "https://stackoverflow.com/questions/59061849/return-relative-cell-reference-in-vba/59061889#59061889", "title": "Return Relative Cell Reference in VBA", "body": "<p>I feel a bit foolish, but I suppose I just hadn't phrased my question well enough in previous attempts to find out.</p>\n\n<p>It is done by using (0,0) as arguments. i.e. <code>myWorksheet.Cells(2,2).Address(0,0)</code> will return B2</p>\n"}], "owner": {"reputation": 33, "user_id": 8425958, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CqsG2.jpg?s=128&g=1", "display_name": "RunningEXE", "link": "https://stackoverflow.com/users/8425958/runningexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574819871, "creation_date": 1574819070, "last_edit_date": 1574819871, "question_id": 59061849, "link": "https://stackoverflow.com/questions/59061849/return-relative-cell-reference-in-vba", "title": "Return Relative Cell Reference in VBA", "body": "<p>I've been looking up some things on the <code>Address</code> function, but whenever it is called on a specific range of cells I get the absolute cell reference value instead of the <em>relative</em> cell reference. </p>\n\n<p>I'm wondering if there's a way to return it without the '$'. I'm used to the <code>ADDRESS</code> formula, but haven't used it's VBA equivalent before. Is there a way to give the function a reference type like you can with the formula?</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1574818476, "post_id": 59061287, "comment_id": 104362828, "body": "split this in two routines. Maybe one to collect the data in a array and the other to run over the array and send the mails. Then you know that the data is correct and it will be much more easy to debug then to do it all in once."}, {"owner": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1574832718, "post_id": 59061287, "comment_id": 104365933, "body": "@ThomasLudewig, sorry just a bit new on VBA. Could you kindly show us, please? This will be a point of reference for most. Also, I&#39;m not aware of how to paste excel attachments in emails as copy and paste in the table format. (as opposed to sending a whole attachment workbook) Really appreciate you looking into this, Thanks"}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 1, "creation_date": 1574854348, "post_id": 59061287, "comment_id": 104376563, "body": "Sure i could do that. Means that i than make other peoples job for free. I also have no own need for a spam mailer. All you need can be found via google by small own afford. LOOK for VBA and VB6.And BTW: this approach of a solution is in my eyes also a no go."}, {"owner": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1574898221, "post_id": 59061287, "comment_id": 104396769, "body": "@ThomasLudewig had a search and couldn&#39;t find it. Would it be possible to answer on here, please?  I appreciate your help. Thanks in advance"}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1574971122, "post_id": 59061287, "comment_id": 104424574, "body": "After the weekend, at this moment i am to full with my work load."}, {"owner": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "reply_to_user": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1575183224, "post_id": 59061287, "comment_id": 104475662, "body": "Hi @ThomasLudewig, any luck trying out this issue?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1575266490, "post_id": 59061287, "comment_id": 104494545, "body": "On a side note, you should not create a Sub that has same name as builtin functions. <code>Split(...)</code> is one of the builtin functions frequently used."}, {"owner": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575381005, "post_id": 59061287, "comment_id": 104541368, "body": "Can you explain a little more about what your data looks like? What filter do you need to apply and where is the recipient located? From your example I&#39;m assuming you filter by recipient, and copy all the lines with that recipient on into the email. Is that correct?"}, {"owner": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "reply_to_user": {"reputation": 2127, "user_id": 11936678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d57966e93e6697f9ebca80653feed1dd?s=128&d=identicon&r=PG", "display_name": "Plutian", "link": "https://stackoverflow.com/users/11936678/plutian"}, "edited": false, "score": 0, "creation_date": 1575407089, "post_id": 59061287, "comment_id": 104554550, "body": "Hi @Plutian, The aim is to have a Master File(EXCEL SHEET) which will contain email addresses to over 50 companies with cc&#39;d email addresses, subject and body massage. The task will be to filter a column and send to the respective companies with a copy and paste attachment as opposed to an excel attachment. Then send to a company. Thanks in advance (It would also be nice to have a tracker to output to the user as &quot;attachment send to comp21&quot;, etc but not necessary)."}, {"owner": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1575414830, "post_id": 59061287, "comment_id": 104557169, "body": "Did Alex L&#39;s answer work for you? If not, is there more you&#39;re looking for?"}, {"owner": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "reply_to_user": {"reputation": 481, "user_id": 4647394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/06d6fcb008fd47cdc43d3964580baf4a?s=128&d=identicon&r=PG&f=1", "display_name": "seadoggie01", "link": "https://stackoverflow.com/users/4647394/seadoggie01"}, "edited": false, "score": 0, "creation_date": 1575468923, "post_id": 59061287, "comment_id": 104577270, "body": "@seadoggie01, pardon me as I&#39;m fairly new and stilll learning. I have been running Alex&#39;s code and keep bumping into errors. I have fixed a few but now stuck on Set table_range = Sheets(sheet_name_range).Range(range_string)   throwing me this error: Runtime error &#39;9&#39;: Subscript out of range. It will be supa if you can help me. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "edited": false, "score": 0, "creation_date": 1575468974, "post_id": 59066394, "comment_id": 104577303, "body": "Run-time error &#39;9&#39;: Subscript out of range. How do i solve this please ?"}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "edited": false, "score": 0, "creation_date": 1575839921, "post_id": 59066394, "comment_id": 104691329, "body": "@MartinQ: Excel Workbook here: <a href=\"https://drive.google.com/file/d/1yO0HvonMV6HHyLRjmHS2PHVquIDvjI5S/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1yO0HvonMV6HHyLRjmHS2PHVquIDvjI5S/&hellip;</a>"}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "edited": false, "score": 0, "creation_date": 1575840073, "post_id": 59066394, "comment_id": 104691366, "body": "Hey @MartinQ, I assume you have an error like you said here <code>Set table_range = Sheets(sheet_name_range).Range(range_string) throwing me this error: Runtime error &#39;9&#39;: Subscript out of range</code>, due to not having valid sheet name and/or range name in cells(2,1) and Cells(2,9). This code is the point when these values are used: <code>sheet_name = Sheet1.Cells(i, 1).Value &amp; sheet_name_range = Sheet1.Cells(i, 9).Value</code>, You need to have the data set out as I had in the screenshot - If I attach my Excel Workbook here does that help?"}], "tags": [], "owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1575839896, "last_edit_date": 1575839896, "creation_date": 1574844903, "answer_id": 59066394, "question_id": 59061287, "link": "https://stackoverflow.com/questions/59061287/how-to-filter-master-workbook-to-send-result-as-a-table-not-a-file/59066394#59066394", "title": "How to filter master workbook to send result as a table, not a file?", "body": "<p>I would approach it one of two ways, convert the range to an HTML table and insert that into the email or use <code>SendKeys '^c', true</code> and then <code>SendKeys '^v', true</code>. My preference is the first option and here is the code:</p>\n\n<pre><code>Sub LoopThroughTable()\n\n    Set ws = ActiveSheet\n\n    For i = 2 To Sheet1.Cells(Sheet1.Rows.Count, 1).End(xlUp).Row\n        email_to = Sheet1.Cells(i, 5).Value\n        email_subject = Sheet1.Cells(i, 4).Value\n\n        folder_path = Sheet1.Cells(i, 2).Value\n\n        Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n        'Set fld = FSO.GetFolder(folder_path)\n        If FSO.FolderExists(folder_path) Then\n            'Nothing, folder is good\n        Else\n            'Just save to desktop\n            folder_path = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\")\n            Sheet1.Cells(i, 2).Value = folder_path\n        End If\n\n        If Right(folder_path, 1) &lt;&gt; \"\\\" Then\n            Sheet1.Cells(i, 2).Value = folder_path &amp; \"\\\"\n        End If\n\n        file_path = Sheet1.Cells(i, 2).Value &amp; Sheet1.Cells(i, 3).Value\n\n        sheet_name = Sheet1.Cells(i, 1).Value\n        sheet_name_range = Sheet1.Cells(i, 9).Value\n        Dim table_range As Range\n        Dim range_string As String\n        range_string = Sheet1.Cells(i, 10)\n        Set table_range = Sheets(sheet_name_range).Range(range_string) 'Range(\"A3:C8\") 'etc.\n\n        email_body = Sheet1.Cells(i, 8).Value &amp; \"&lt;br&gt;&lt;br&gt;\" &amp; ConvertRangeToHTMLTable(table_range)\n\n        CopySheetAndSave sheet_name, file_path\n\n        SendOutlookMessage email_to, email_subject, file_path, email_body\n        ThisWorkbook.Activate\n    Next i\n\n    ws.Activate\n\nEnd Sub\n\nSub CopySheetAndSave(ByVal sheet_name As String, ByVal full_path As String)\n\n    SheetName = sheet_name\n    FullPath = full_path\n\n    Sheets(SheetName).Select\n    Sheets(SheetName).Copy\n    'ChDir \"C:\\Users\\username\\Downloads\"\n    Workbooks(Workbooks.Count).SaveAs Filename:=FullPath, FileFormat:= _\n        xlOpenXMLWorkbook, CreateBackup:=False\n    Workbooks(Workbooks.Count).Close\nEnd Sub\n\n\nSub SendOutlookMessage(ByVal email_to As String, ByVal email_subject As String, ByVal file_path As String, ByVal email_body As String)\n\n    emailTo = email_to\n    emailSub = email_subject\n    FullPath = file_path\n    HTMLBODY = email_body\n\n    DoEvents\n    Application.Wait 1\n\n    Dim olApp As Object\n    Dim olMail As Object\n\n    Set olApp = CreateObject(\"Outlook.Application\")\n    Set olMail = olApp.CreateItem(0)\n    With olMail\n        .to = emailTo\n        .Subject = emailSub\n        .Attachments.Add (FullPath)\n\n        .HTMLBODY = HTMLBODY\n        DoEvents\n\n        .Display\n        Application.Wait 1\n        .Send\n\n    End With\n\n    Application.Wait 1\n\n    Set olMail = Nothing\n    Set olApp = Nothing\n\nEnd Sub\n\n'Following function converts Excel range to HTML table\n'Taken from https://excelsirji.com/vba-code-to-convert-excel-range-into-html-table/\nPublic Function ConvertRangeToHTMLTable(rInput As Range) As String\n    'Declare variables\n    Dim rRow As Range\n    Dim rCell As Range\n    Dim strReturn As String\n    'Define table format and font\n    strReturn = \"&lt;Table border='1' cellspacing='0' cellpadding='7' style='border-collapse:collapse;border:none'&gt;  \"\n    'Loop through each row in the range\n    For Each rRow In rInput.Rows\n        'Start new html row\n        strReturn = strReturn &amp; \" &lt;tr align='Center'; style='height:10.00pt'&gt; \"\n        For Each rCell In rRow.Cells\n            'If it is row 1 then it is header row that need to be bold\n            If rCell.Row = 1 Then\n                strReturn = strReturn &amp; \"&lt;td valign='Center' style='border:solid windowtext 1.0pt; padding:0cm 5.4pt 0cm 5.4pt;height:1.05pt'&gt;&lt;b&gt;\" &amp; rCell.Text &amp; \"&lt;/b&gt;&lt;/td&gt;\"\n            Else\n                strReturn = strReturn &amp; \"&lt;td valign='Center' style='border:solid windowtext 1.0pt; padding:0cm 5.4pt 0cm 5.4pt;height:1.05pt'&gt;\" &amp; rCell.Text &amp; \"&lt;/td&gt;\"\n            End If\n        Next rCell\n        'End a row\n        strReturn = strReturn &amp; \"&lt;/tr&gt;\"\n    Next rRow\n    'Close the font tag\n    strReturn = strReturn &amp; \"&lt;/font&gt;&lt;/table&gt;\"\n    'Return html format\n    ConvertRangeToHTMLTable = strReturn\nEnd Function\n</code></pre>\n\n<p>Note that the ConvertRangeToHTMLTable is not my function I took it from:\n<a href=\"https://excelsirji.com/vba-code-to-convert-excel-range-into-html-table/\" rel=\"nofollow noreferrer\">https://excelsirji.com/vba-code-to-convert-excel-range-into-html-table/</a></p>\n\n<p>I have a helper/loader function LoopThroughTable as a way to send as many emails as in the table on Sheet1 like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Uqdpj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Uqdpj.png\" alt=\"Excel Screenshot\"></a></p>\n\n<p>Note that I also send a specific sheet only as an attachment but you can modify that code to remove that part if you don't wish to do that. Any questions please ask in the comments and if this solves your problem please consider to mark it as the correct answer.</p>\n\n<p>Excel Sheet attached here: <a href=\"https://drive.google.com/file/d/1yO0HvonMV6HHyLRjmHS2PHVquIDvjI5S/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1yO0HvonMV6HHyLRjmHS2PHVquIDvjI5S/view?usp=sharing</a></p>\n"}], "owner": {"reputation": 383, "user_id": 3374382, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/794dd6e71e7f9d48a01e60070c02fa8b?s=128&d=identicon&r=PG", "display_name": "Martin Q", "link": "https://stackoverflow.com/users/3374382/martin-q"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "accepted_answer_id": 59066394, "answer_count": 1, "score": 0, "last_activity_date": 1608212896, "creation_date": 1574813945, "last_edit_date": 1608212896, "question_id": 59061287, "link": "https://stackoverflow.com/questions/59061287/how-to-filter-master-workbook-to-send-result-as-a-table-not-a-file", "title": "How to filter master workbook to send result as a table, not a file?", "body": "<p>My mission is to filter a master workbook to send results to their respective recipients. The recipients and body of the email which will be located in a workbook.</p>\n<p>I have to send over 50 emails, with results in table format, to over 50 different recipients.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub split()\n\n    Dim wswb As String\n    Dim wssh As String\n\n    Dim vColumn As Variant\n\n    Dim i As Integer\n    Dim vcounter As Variant\n    Dim vfilter As String\n\n    wswb = ActiveWorkbook.Name\n    wssh = ActiveSheet.Name\n\n    vColumn = InputBox(&quot;Select Column to Filter&quot;, &quot;Column Selection&quot;)\n\n    Columns(vColumn).Copy\n    Sheets.Add\n\n    ActiveSheet.Name = &quot;Working_Magic&quot;\n    Range(&quot;A1&quot;).PasteSpecial\n\n    Columns(&quot;A&quot;).RemoveDuplicates Columns:=1, Header:=xlYes\n\n    vcounter = Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row\n\n    For i = 2 To vcounter\n        vfilter = Sheets(&quot;Working_Magic&quot;).Cells(i, 1)\n        Sheets(wssh).Activate\n        ActiveSheet.Columns.AutoFilter field:=Columns(vColumn).Column, Criteria1:=vfilter\n        Cells.Copy\n        Workbooks.Add\n      \n        Range(&quot;A1&quot;).PasteSpecial\n        If vfilter &lt;&gt; &quot;&quot; Then\n            ActiveWorkbook.SaveAs ThisWorkbook.Path &amp; &quot;\\DSAttachments_to_email\\&quot; &amp; vfilter\n        Else\n            ActiveWorkbook.SaveAs ThisWorkbook.Path &amp; &quot;\\DSAttachments_to_email\\_Empty&quot;\n        End If\n        ActiveWorkbook.Close\n        Workbooks(wswb).Activate\n    \n    Next i\n    Sheets(&quot;Working_Magic&quot;).Delete\n    \nEnd Sub\n</code></pre>\n<p>I do not need to save the attachment in a folder as shown in the code above rather send report to all respective recipients.</p>\n"}, {"tags": ["vba", "api", "pdf", "foxit"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1574811528, "post_id": 59060895, "comment_id": 104361225, "body": "<code>SendKeys</code> is almost impossible to reliably debug. A common kludge is to introduce little pauses of e.g. 0.5 seconds between successive <code>SendKeys</code> invocations. But -- even if you get it to &quot;work&quot; it is likely to break sooner or later. You are essentially typing blind, not even being 100% sure what window you are typing to."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1574812834, "post_id": 59060895, "comment_id": 104361571, "body": "I dont even bother with <code>SendKeys</code> - If that&#39;s the only way to communicate with something then it&#39;s not worth the time."}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1574815219, "post_id": 59060895, "comment_id": 104362124, "body": "Like the others said, <code>SendKeys</code> is a recipe for disaster. Since you are using Excel, you probably also have Word. So what you could do is open the PDF in Word (it will convert the file to a Word-read/writeable format), then save/export the content as a text file, then use that as input (or even talk to Word directly). This would be <i>much</i> less error-prone. I haven&#39;t tried it beyond just recording a macro (in Word) to see what happens if you open a PDF in it and that seems to work fine. I use Office 2019 btw."}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1574815375, "post_id": 59060895, "comment_id": 104362153, "body": "Links that may interest you: <a href=\"https://stackoverflow.com/questions/36270247/extract-data-from-pdf-and-add-to-worksheet\" title=\"extract data from pdf and add to worksheet\">stackoverflow.com/questions/36270247/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/3567441/extract-data-from-word-document-to-an-excel-spreadsheet\" title=\"extract data from word document to an excel spreadsheet\">stackoverflow.com/questions/3567441/&hellip;</a>"}, {"owner": {"reputation": 644, "user_id": 8671209, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212727830903077/picture?type=large", "display_name": "Thomas Ludewig", "link": "https://stackoverflow.com/users/8671209/thomas-ludewig"}, "edited": false, "score": 0, "creation_date": 1574818197, "post_id": 59060895, "comment_id": 104362764, "body": "Might be possible that the foxit thing needs some time to perform your actions. I would try to put some delays between the send key calls."}], "owner": {"user_type": "does_not_exist", "display_name": "user12432590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574811040, "creation_date": 1574810911, "last_edit_date": 1574811040, "question_id": 59060895, "link": "https://stackoverflow.com/questions/59060895/why-does-the-loop-in-my-vba-code-stop-working-after-the-third-go", "title": "Why does the loop in my VBA code stop working after the third go?", "body": "<p>So what I am trying to do is go through a PDF, send key for CTRL+F to find a string of text from column C and highlight the first result, then another send key to bookmark the word. When I try looping, it succeeds for the first 3, but fails.\nI am using Foxit, and I can't seem to find a better alternative to the sendcodes, so I am open to recommendations as well. I have looked through the API Foxit guide, and have not found any codes specific to what I need.</p>\n\n<pre><code>Sub BookmarkingWithSendKeys()\n\nActiveWorkbook.FollowHyperlink \"C:\\Test.pdf\"\n\n    Dim searchString As String\n    'Create loop using variable i, searching PDF in column C (3 if you do R1C1).\n    FinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n    For I = 1 To FinalRow\n\n    searchString = Cells(I, 3).Value\n\n    'Send \"CTRL + F\" keys to the opened PDF to invoke find within that file\n    'The second argument \"true\" implies that Excel will wait for the keys to be processed before returning control to the macro.\n    SendKeys \"^f\", True\n\n    'Type the search string in the find box that opens\n    SendKeys searchString, True\n\n    'Hit enter to perform the search\n    SendKeys \"{Enter}\", True\n\n    'Bookmark highlighted text\n    SendKeys \"^b\", True\n\n    'Hit enter to perform the bookmark\n    SendKeys \"{Enter}\", True\n        Next I\n\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1574812113, "post_id": 59060758, "comment_id": 104361363, "body": "You can edit your question and post some images of the results you\u2019re expecting in each step and maybe it\u2019s easier to understand the requirements. Also state what Excel version you\u2019re using? And how often are you going to process the data."}, {"owner": {"reputation": 13, "user_id": 12441567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d201a94845f974dc9baa728588c468fd?s=128&d=identicon&r=PG&f=1", "display_name": "beard_monger", "link": "https://stackoverflow.com/users/12441567/beard-monger"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1574813036, "post_id": 59060758, "comment_id": 104361624, "body": "Thank you for the feedback.  I have updated the post."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1574818569, "post_id": 59060758, "comment_id": 104362844, "body": "Picker list is in the same order as the column headers? You could use index and use the relative row number (1,2,3...) to get the column and use countif based on the number of times the person\u2019s name appears to get the row in which it\u2019s located. I\u2019m not in front of a computer, but maybe the logic can help you."}, {"owner": {"reputation": 1300, "user_id": 7602468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3XKX5.gif?s=128&g=1", "display_name": "p._phidot_", "link": "https://stackoverflow.com/users/7602468/p-phidot"}, "edited": false, "score": 0, "creation_date": 1574849710, "post_id": 59060758, "comment_id": 104373897, "body": "In the Andrew selection list.. Banana is the 1st selection and also his/her last selection.. is the raw data also having the same case ?"}, {"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1574857893, "post_id": 59060758, "comment_id": 104378554, "body": "I&#39;m voting to close this question as off-topic because this is simply a requirements dump and not a question about a problem in the code."}, {"owner": {"reputation": 13, "user_id": 12441567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d201a94845f974dc9baa728588c468fd?s=128&d=identicon&r=PG&f=1", "display_name": "beard_monger", "link": "https://stackoverflow.com/users/12441567/beard-monger"}, "edited": false, "score": 0, "creation_date": 1574869322, "post_id": 59060758, "comment_id": 104385136, "body": "Yeah, sorry p._phidot.  That was sloppy assembly of trying to put together some simple sample data on my end.  It was unintentional."}, {"owner": {"reputation": 13, "user_id": 12441567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d201a94845f974dc9baa728588c468fd?s=128&d=identicon&r=PG&f=1", "display_name": "beard_monger", "link": "https://stackoverflow.com/users/12441567/beard-monger"}, "reply_to_user": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1574869574, "post_id": 59060758, "comment_id": 104385257, "body": "@GeertBellekens Sorry, that is not my intention.  I can get so far as to write out: {=INDEX($B$3:$E$10,1,(MATCH(I3:I10,$B$2:$E$2,0)))} which will give me the highest ranked option from each person down the board.  However, I am trying to find a method that steps through this such that it either a) considers the items above it in the &quot;pick&quot; column and excludes them or b) delete items from the array as they are selected before proceeding to the next selection."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1574881639, "post_id": 59060758, "comment_id": 104391100, "body": "Posted a solution using the <code>Filter</code> function and a user defined function to get the next valid search item, as the condition of uniqueness breaks the basic row wise search order. This seemed to be your main issue; if helpful, feel free to accept by ticking the hollow green checkmark just underneath the voting buttons, near the top of this answer  :-) @beard_monger"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1574881035, "last_edit_date": 1574881035, "creation_date": 1574880619, "answer_id": 59076769, "question_id": 59060758, "link": "https://stackoverflow.com/questions/59060758/is-there-a-way-to-loop-through-a-list-without-making-duplicate-selections/59076769#59076769", "title": "Is there a way to loop through a list without making duplicate selections?", "body": "<p><strong>Get items in a deviating search order if not unique</strong></p>\n\n<p>Basically you follow a rowwise search order from left to right (from <em>Tom to Alex</em>) continuing with the next rank row, but <em>deviating</em> as soon as you find a duplo in current <code>results</code>.</p>\n\n<p>I demonstrate an approach </p>\n\n<ul>\n<li><strong><code>[1]</code></strong> assigning the complete data range to a 2-dim array <code>data</code>,</li>\n<li><strong><code>[2]</code></strong> looping through the data searching for a valid (i.e. unique) item that can be written into a <code>results</code> array (see section <code>[c]</code>); these results are found via <code>[a]</code> a special helper function <code>getNextItem()</code> and <code>[b]</code> using the <code>Filter</code> function (<code>False</code> parameter to remove all current findings)</li>\n<li><strong><code>[3]</code></strong> eventually writing results back to sheet.</li>\n</ul>\n\n<pre><code>\nSub PickNick()\n    Const Tom = 1, Alex&amp; = 4\n  ' [0] temporary array with all available picks\n    Dim tmp\n    tmp = Array(\"Apple\", \"Banana\", \"Carrots\", \"Grapes\", \"Limes\", \"Orange\", \"Squash\", \"Tomatoes\")\n  ' [1] get data from sheet (via CodeName) &amp; prepare results array\n    Dim data:  data = Sheet1.Range(\"B3:E10\")\n    ReDim results(1 To UBound(data), 1 To 1)\n  ' [2] Loop through data (rank 1-2 and every picker)\n    Dim rnk&amp;, picker&amp;\n    For rnk = 1 To 2\n        For picker = Tom To Alex\n          ' [a] get next (unique) item via function getNextItem (see below)\n            Dim nxt: nxt = getNextItem(data, results, rnk, picker)\n          ' [b] filter out next item (remove it from temp array)\n            tmp = Filter(tmp, nxt, False, vbTextCompare)\n          ' [c] note results in array pick\n            results((rnk - 1) * Alex + picker, 1) = nxt\n        Next picker\n    Next rnk\n  ' [3] write results back to sheet (start cell H3)\n    Sheet1.Range(\"H3\").Resize(UBound(data), 1) = results\n\nEnd Sub\n</code></pre>\n\n<p><strong>Helper function <code>getNextItem()</code> called by above procedure</strong></p>\n\n<pre><code>Function getNextItem(data, results, rnk, picker)\n' Purpose: get next unique item in data, i.e. the first occurrence in results\n' Method:  if not unique check the following items in the pickers data column\n' Note:    called in section [2a] of main procedure PickNick\n    Dim FirstOccurrence\n    Dim i&amp;, nxt\n    getNextItem = \"?\"                   ' provide for no result\n    For i = rnk To UBound(results)\n        nxt = data(i, picker)\n        FirstOccurrence = IsError(Application.Match(nxt, Application.Transpose(results), False))\n        If FirstOccurrence Then\n            getNextItem = nxt             ' return next item as function result\n            Exit Function\n        End If\n    Next i\nEnd Function\n\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ksk9A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ksk9A.png\" alt=\"Data Range B3:E10\"></a></p>\n"}], "owner": {"reputation": 13, "user_id": 12441567, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d201a94845f974dc9baa728588c468fd?s=128&d=identicon&r=PG&f=1", "display_name": "beard_monger", "link": "https://stackoverflow.com/users/12441567/beard-monger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 59076769, "answer_count": 1, "score": 1, "last_activity_date": 1578128319, "creation_date": 1574810027, "last_edit_date": 1578128319, "question_id": 59060758, "link": "https://stackoverflow.com/questions/59060758/is-there-a-way-to-loop-through-a-list-without-making-duplicate-selections", "title": "Is there a way to loop through a list without making duplicate selections?", "body": "<p>I created sample data as an image (I couldn't figure out how to put a table in):</p>\n\n<p>Sample Data: this shows three stages of processing of the data\n<img src=\"https://i.stack.imgur.com/6E3Le.png\" alt=\"Sample Data: this shows three stages of processing of the data\"></p>\n\n<p>I have a number of people (4 people across the top).  They have ranked 8 fruits and vegetables 1-8.  The people (pickers) are then placed in a list where they get assigned the highest ranked fruit/veggie left in the pool based on their ranking.</p>\n\n<p>So for example, in the first position, Tom goes first and has Apple ranked first so he would get assigned Apple.  Then Andrew would get assigned his highest ranked fruit/veggie that was not previously selected.  I would like to automate the population of the \"pick\" column.</p>\n\n<p>I have looked through the questions here and elsewhere for a similar example.  I thought perhaps this was possible to solve using array and index+match but I couldn't come up with a structure that worked.  I could try to process this in something outside of Excel but I think that might be even more of a headache.  </p>\n\n<p>I thought there would be something via VBA but that is a little out of my wheelhouse.</p>\n\n<p>How might this be achieved with built in Excel tooling?</p>\n\n<p>I suppose one likely option would be selected items getting removed from the list as they are selected.</p>\n\n<p>This would be a one time processing, but in the real data it is dozens of people with hundreds of rankings so it is a long list to process.</p>\n\n<p>I am using Excel 2016 (16.0.11328.20420 64-Bit).</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574808806, "post_id": 59060372, "comment_id": 104360441, "body": "What is <code>r</code> and what is <code>Z</code> ?"}, {"owner": {"reputation": 1, "user_id": 12353184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd86fbc197ea11fb4002c5bce6705a35?s=128&d=identicon&r=PG&f=1", "display_name": "qamar", "link": "https://stackoverflow.com/users/12353184/qamar"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574809117, "post_id": 59060372, "comment_id": 104360540, "body": "I have edited the code and mentioned r and z as well. Those are my own ranges according to my need in which cells I want to check."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1574810098, "post_id": 59060372, "comment_id": 104360822, "body": "Replace <code>r.Rows(i).Replace What:=Chr(32), Replacement:=&quot;&quot;, LookAt:=xlPart</code> with <code>r.Rows(i).Formula = Application.Trim(r.Rows(i).Formula)</code>"}, {"owner": {"reputation": 1, "user_id": 12353184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd86fbc197ea11fb4002c5bce6705a35?s=128&d=identicon&r=PG&f=1", "display_name": "qamar", "link": "https://stackoverflow.com/users/12353184/qamar"}, "edited": false, "score": 0, "creation_date": 1574825286, "post_id": 59060372, "comment_id": 104364150, "body": "This works fine thank you"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12353184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd86fbc197ea11fb4002c5bce6705a35?s=128&d=identicon&r=PG&f=1", "display_name": "qamar", "link": "https://stackoverflow.com/users/12353184/qamar"}, "edited": false, "score": 0, "creation_date": 1574825191, "post_id": 59060946, "comment_id": 104364125, "body": "If there is a space in cell it is not deleting that row. I want the whole row to be deleted if there is no data and have spaces in the cell."}, {"owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "reply_to_user": {"reputation": 1, "user_id": 12353184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd86fbc197ea11fb4002c5bce6705a35?s=128&d=identicon&r=PG&f=1", "display_name": "qamar", "link": "https://stackoverflow.com/users/12353184/qamar"}, "edited": false, "score": 0, "creation_date": 1574826736, "post_id": 59060946, "comment_id": 104364458, "body": "I tested the code in a cut down context and with my own test data and it works, but without seeing your data set etc I can&#39;t tell why its specifically not working for you. Have you run it in debug and checked whether, for example, there are hidden characters (like Alt-Enter or =CHAR(10)) in the data which makes it look like it should work but actually trips up the logic? And given that the code addition simply checks that if a cell is completely comprised of spaces and if so then make it empty ... it shouldn&#39;t be too difficult to check. Cheers."}], "tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": false, "score": 0, "last_activity_date": 1574811317, "creation_date": 1574811317, "answer_id": 59060946, "question_id": 59060372, "link": "https://stackoverflow.com/questions/59060372/delete-empty-rows-in-excel-using-vba/59060946#59060946", "title": "Delete Empty Rows In Excel Using VBA", "body": "<p>If you don't mind that the cells which have both data and leading/lagging spaces are modified (trimmed), then Siddharth's response is really neat. Another option is to check whether the cell is composed entirely of spaces ... something like ...  </p>\n\n<pre><code>iRowLast = .Cells(.Rows.Count, iCol_Exp).End(xlUp).Row\nSet r = .Range(\"A1:F48\")\nSet Z = ActiveSheet.Range(\"A1:Z50\")\n\nFor i = iRowLast To 10 Step (-1)\n    'r.Rows(i).Replace What:=Chr(32), Replacement:=\"\", LookAt:=xlPart\n    For Each vcell In r.Rows(i).Columns\n        If Len(Replace(vcell, \" \", \"\")) = 0 Then vcell = \"\"\n    Next\n\n    If WorksheetFunction.CountA(r.Rows(i)) = 0 Then Z.Rows(i).Delete\nNext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12353184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd86fbc197ea11fb4002c5bce6705a35?s=128&d=identicon&r=PG&f=1", "display_name": "qamar", "link": "https://stackoverflow.com/users/12353184/qamar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574811317, "creation_date": 1574807679, "last_edit_date": 1574809074, "question_id": 59060372, "link": "https://stackoverflow.com/questions/59060372/delete-empty-rows-in-excel-using-vba", "title": "Delete Empty Rows In Excel Using VBA", "body": "<p>I am trying to delete empty rows in excel by using below code:</p>\n\n<pre><code>iRowLast = .Cells(.Rows.Count, iCol_Exp).End(xlUp).Row\nSet r = .Range(\"A1:F48\")\nSet Z = ActiveSheet.Range(\"A1:Z50\")\n\nFor i = iRowLast To 10 Step (-1)\n    r.Rows(i).Replace What:=Chr(32), Replacement:=\"\", LookAt:=xlPart\n    If WorksheetFunction.CountA(r.Rows(i)) = 0 Then Z.Rows(i).Delete\nNext\n</code></pre>\n\n<p>I am looking for empty cell and spaces as well and want to delete the row only if all the respective columns are empty or have spaces with out any actual data. </p>\n\n<p>The problem in this code is it is also deleting spaces between data in excel sheet. Please provide suggestion how can I avoid that.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 3, "creation_date": 1574804771, "post_id": 59059780, "comment_id": 104359087, "body": "<i>&quot;but bugs out after that&quot;</i> - what is your error message?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 1, "creation_date": 1574804890, "post_id": 59059780, "comment_id": 104359130, "body": "Does this abbreviated version of your code have the same error message as the original?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1574804989, "post_id": 59059780, "comment_id": 104359155, "body": "What is the value of <code>thisFile</code>?"}, {"owner": {"reputation": 45, "user_id": 11700036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GKrY9aBjCUg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYTLcdAw4_oyfhMtaeyOr5SB2VvA/photo.jpg?sz=128", "display_name": "gerpes8", "link": "https://stackoverflow.com/users/11700036/gerpes8"}, "edited": false, "score": 0, "creation_date": 1574805230, "post_id": 59059780, "comment_id": 104359247, "body": "Runtime error - Document not saved"}, {"owner": {"reputation": 45, "user_id": 11700036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GKrY9aBjCUg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYTLcdAw4_oyfhMtaeyOr5SB2VvA/photo.jpg?sz=128", "display_name": "gerpes8", "link": "https://stackoverflow.com/users/11700036/gerpes8"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1574805258, "post_id": 59059780, "comment_id": 104359258, "body": "@Mistella ok good point I did not try that. If I replace thisfile with just i it works fine so I did not think about that.... is this because the workbook the file value is in is not activated?"}, {"owner": {"reputation": 6762, "user_id": 845655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ySyzL.jpg?s=128&g=1", "display_name": "DeanOC", "link": "https://stackoverflow.com/users/845655/deanoc"}, "edited": false, "score": 0, "creation_date": 1574805436, "post_id": 59059780, "comment_id": 104359323, "body": "Not an answer to your problem, but you only need to do the <code>ChDir &quot;C:\\IntelPT&quot;</code> once, so it could be moved above the For loop. tbh, not sure why you need it at all, since you are specifying the output folder in your filename."}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1574805623, "post_id": 59059780, "comment_id": 104359391, "body": "Did you check that <code>thisFile</code> doesn&#39;t have characters that aren&#39;t allowed in a file name?"}, {"owner": {"reputation": 45, "user_id": 11700036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GKrY9aBjCUg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYTLcdAw4_oyfhMtaeyOr5SB2VvA/photo.jpg?sz=128", "display_name": "gerpes8", "link": "https://stackoverflow.com/users/11700036/gerpes8"}, "edited": false, "score": 0, "creation_date": 1574805692, "post_id": 59059780, "comment_id": 104359416, "body": "I just have sample values set right now as filename1, filename2... etc..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1574807210, "post_id": 59059780, "comment_id": 104359964, "body": "Be specific with all your Range/Cells references - you should include the workbook and the worksheet; even if you&#39;re assuming it&#39;s the active workbook/sheet, you should spell it out.  And why are you exporting the same sheet multiple times?  Is this your <i>actual</i> code?"}, {"owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "edited": false, "score": 0, "creation_date": 1574814118, "post_id": 59059780, "comment_id": 104361858, "body": "Can you check if you&#39;re getting the desired value at &quot;thisfile&quot;? Something seems off, you have thisFile = Cells(i, 3).Value, but your max row is based on column B, lr = Cells(Rows.Count, 2).End(xlUp).Row"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 7281771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f55a48618eb62480218e0cfd72aa36?s=128&d=identicon&r=PG&f=1", "display_name": "Xlsx", "link": "https://stackoverflow.com/users/7281771/xlsx"}, "is_accepted": false, "score": 0, "last_activity_date": 1574815091, "creation_date": 1574815091, "answer_id": 59061422, "question_id": 59059780, "link": "https://stackoverflow.com/questions/59059780/why-cant-i-save-my-file-like-this-excel-vba/59061422#59061422", "title": "Why can&#39;t I save my file like this? Excel/VBA", "body": "<p>Are your this file contents in Column B or C? The code works, but I think there was a mistake in your last row or the location of \"thisfile\" value. Always best for you to verify the value in the variable (thisfile), ensuring the desired value is obtained</p>\n\n<p>If the file contents are in column B, this line:</p>\n\n<pre><code>        thisFile = Cells(i, 3).Value\n</code></pre>\n\n<p>should be changed to:</p>\n\n<pre><code>        thisFile = Cells(i, 2).Value\n</code></pre>\n\n<p>If the file contents are in column C, this line:</p>\n\n<pre><code>        lr = Cells(Rows.Count, 2).End(xlUp).Row\n</code></pre>\n\n<p>should be changed to:</p>\n\n<pre><code>        lr = Cells(Rows.Count, 3).End(xlUp).Row\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 11700036, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GKrY9aBjCUg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYTLcdAw4_oyfhMtaeyOr5SB2VvA/photo.jpg?sz=128", "display_name": "gerpes8", "link": "https://stackoverflow.com/users/11700036/gerpes8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574815091, "creation_date": 1574804621, "last_edit_date": 1574805756, "question_id": 59059780, "link": "https://stackoverflow.com/questions/59059780/why-cant-i-save-my-file-like-this-excel-vba", "title": "Why can&#39;t I save my file like this? Excel/VBA", "body": "<p>What's wrong with this at the exportpdf level? It saves the first file correctly but bugs out after that. I have cut out most of the macro just in case there is some stuff in there that looks unneeded.</p>\n\n<pre><code>Sub ptSub()\n    lr = Cells(Rows.Count, 2).End(xlUp).Row\n    For i = 2 To lr\n        thisFile = Cells(i, 3).Value\n        ChDir \"C:\\IntelPT\"\n        ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n            \"C:\\IntelPT\\\" &amp; _\n            thisFile &amp; \".pdf\", Quality:=xlQualityStandard, _\n            IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _\n            False\n        Next i\n    End Sub \n</code></pre>\n\n<p>If I have just this</p>\n\n<pre><code> \"C:\\IntelPT\\\" &amp; _\n                i &amp; \".pdf\", Quality:=xlQualityStandard, _\n                IncludeDocProperties:=True, IgnorePrintAreas:=False, \n</code></pre>\n\n<p>It works how I want it to but I dont want an iterator as the filename</p>\n"}, {"tags": ["html", "vba", "ms-access", "pdf", "while-loop"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1574807050, "post_id": 59059627, "comment_id": 104359907, "body": "I am confused. You say code should and does attach 3 PDF files and insert 3 images and then say you want only 1 PDF file attached and only 1 image inserted."}, {"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1575126461, "post_id": 59059627, "comment_id": 104464726, "body": "From your public data I see that you have not yet visited the tour to get an overview of how this site works. Please do so, and read it to the end, it only takes a minute. Also familiarize yourself with the help center, especially <a href=\"https://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1574808753, "creation_date": 1574808753, "answer_id": 59060568, "question_id": 59059627, "link": "https://stackoverflow.com/questions/59059627/is-there-a-way-to-attach-a-pdf-file-as-an-attachment-and-simultaneously-insert/59060568#59060568", "title": "Is there a way to attach a .pdf file as an attachment and simultaneously insert a .html file as an image in the body of the email using ms access", "body": "<p>In the immediate beginning of your <code>For Each FSOFile</code> loop, you load the <code>HTML</code> part (including the image) into the variable <code>strHTML</code>, which you then assign to <code>.HTMLBody</code>. But you never clear this variable in preparation for the next email. Add <code>strHTML = \"\"</code> before the `Do loop:</p>\n\n<pre><code>If Not (rs.EOF And rs.BOF) Then\n    strHTML = \"\"                'add this line\n    Do While Not EOF(1)\n        Input #1, strline\n        strHTML = strHTML &amp; strline\n    Loop\n    Close #1\n    rsFNHtml.MoveNext\nEnd If\n</code></pre>\n\n<p>Note also, <code>(rs.EOF And rs.BOF)</code> should be <code>(rs.EOF Or rs.BOF)</code></p>\n"}], "owner": {"reputation": 11, "user_id": 12338434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93576ae19cc0e2d7f2ea71ad891fb8aa?s=128&d=identicon&r=PG&f=1", "display_name": "GrowGiver602", "link": "https://stackoverflow.com/users/12338434/growgiver602"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574808753, "creation_date": 1574803888, "last_edit_date": 1574805025, "question_id": 59059627, "link": "https://stackoverflow.com/questions/59059627/is-there-a-way-to-attach-a-pdf-file-as-an-attachment-and-simultaneously-insert", "title": "Is there a way to attach a .pdf file as an attachment and simultaneously insert a .html file as an image in the body of the email using ms access", "body": "<p>I have written some VBA code in MS Access where I am attempting to do the following:</p>\n\n<p>Action:\nAttach a pdf file as an attachment to a MS Outlook email\nInsert an html file, that's saved as a .html file on a different file path, into the HTMLBody of the same MS Outlook email; and\nLoop through a record set</p>\n\n<p>Situation:\nCurrently, I have written code that attaches the 1st pdf, as an attachment, and inserts the 1st html file, as an image, into the HTML body. However, when the code loops back through the 2nd, 3rd, etc it:\nAttaches the 2nd pdf as an attachment (as it should), and inserts the 1st html and 2nd html image, into the body; loops through again and<br>\nAttaches the 3rd pdf as an attachment(as it should), and inserts the 1st html, 2nd html and 3rd html image, into the body; and so on</p>\n\n<p>Desired Results:\nI would like for the code to loop through and attach the:\n1st pdf file as an attachment, and the 1st  html file as an image in the HTMLbody\n2nd pdf file as an attachment, and the 2nd  html file as an image in the HTMLbody; and\nContinue through the end of the data set where the email contains 1 pdf file as an attachment; and 1 html image in the HTML body of the Outlook email.</p>\n\n<pre><code>Private Sub cmdEmailLetters_Click()\n\n\n    Dim folderName As String\n    Dim FSOLibrary As Object\n    Dim FSOFolder As Object\n    Dim FSOFile As Object\n    Dim FilePathName As String\n    Dim FilePathName2 As String\n    Dim rs As DAO.Recordset\n    Dim db As DAO.Recordset\n    Dim rsEmail As Recordset\n    Dim rsEmail2 As Recordset\n    Dim rsFileName As Recordset\n    Dim rsGID As Recordset\n    Dim rsFNHtml As Object\n    Dim rsFName As Object\n    Dim strline, strHTML\n    Dim count As Integer\n\n\n\n    'Set the file name to a variable\n    folderName = \"H:\\Customer Outreach\\Customer_Letters\\\"\n\n\n    'Set all the references to the FSO Library\n    Set FSOLibrary = New FileSystemObject\n    Set FSOFolder = FSOLibrary.GetFolder(folderName)\n    Set FSOFile = FSOFolder.Files\n    Set rs = CurrentDb.OpenRecordset(\"TestFinalEmailList\") \n    Set rsEmail = CurrentDb.OpenRecordset(\"TestFinalEmailList\") \n    Set rsEmail2 = CurrentDb.OpenRecordset(\"TestFinalEmailList\") \n    Set rsFileName = CurrentDb.OpenRecordset(\"TestFinalEmailList\") \n    Set rsGID = CurrentDb.OpenRecordset(\"TestFinalEmailList\") \n    Set rsFNHtml = CurrentDb.OpenRecordset(\"TestFinalEmailList\")\n    Set rsFName = CurrentDb.OpenRecordset(\"TestFinalEmailList\")\n\n\n\n    'Use For Each loop to loop through each file in the folder\n    For Each FSOFile In FSOFolder.Files\n\n        Open \"H:\\Customer Outreach\\Customer_Letters_html\\Customer Request - \" &amp; rsFNHtml!FILE_NAME_Html \n        &amp; \".html\" For Input As 1\n          If Not (rs.EOF And rs.BOF) Then\n           Do While Not EOF(1)\n           Input #1, strline\n           strHTML = strHTML &amp; strline\n         Loop\n           Close #1\n           rsFNHtml.MoveNext\n        End If\n\n        If rsGID!CustID = rsFileName!FILE_NAME Then\n        Set appOutlook = CreateObject(\"Outlook.Application\")\n        Set MailOutlook = appOutlook.CreateItem(olMailItem)\n\n              With MailOutlook\n\n                .BodyFormat = olFormatHTML\n                .To = rsEmail!CUST_Mn_EMAIL\n                .CC = rsEmail2!SCND_EMAIL\n                ''.bcc = \"\"\n                .Subject = \"TEST\"\n                .Importance = olImportanceHigh  'High importance\n                .HTMLBody = strHTML\n                .Attachments.Add (FSOFile)\n                '.Send\n                .Display    'Used during testing without sending (Comment out .Send if using this line)\n            End With\n               Else\n            MsgBox rsGID!GRANTEEID &amp; \" No file matching \" &amp; strPath &amp; strFilter &amp; \" found.\" &amp; vbCrLf &amp; _\n                \"Processing terminated.\"\n             Exit Sub\n         End If\n\n        rsGID.MoveNext\n        rsFileName.MoveNext\n        rsEmail.MoveNext\n        rsEmail2.MoveNext\n\n        Next\n\n        'Release the memory\n        Set FSOLibrary = Nothing\n        Set FSOFolder = Nothing\n        Set FSOFile = Nothing\n        Set rsEmail = Nothing\n        Set rsFNHtml = Nothing\n        Set strHTML = Nothing\n        Set rs = Nothing\n\n\nMsgBox \"Email transfer is complete!\", , \"STATUS\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba", "dictionary", "collections"], "comments": [{"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1574802831, "post_id": 59059354, "comment_id": 104358305, "body": "I forgot that you can implement a key value pair using a collection... similar to a dictionary... I have also never done this... I don&#39;t know if that would be an elegant solution..."}, {"owner": {"reputation": 68, "user_id": 12115844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFb9Y.jpg?s=128&g=1", "display_name": "Cooper", "link": "https://stackoverflow.com/users/12115844/cooper"}, "edited": false, "score": 0, "creation_date": 1574803116, "post_id": 59059354, "comment_id": 104358416, "body": "Hi XCELLGUY, could you give us a little more info please, is the first workbook only getting updated from the second workbook? or are there other sources that will be changing the data? I assume you are talking about more than just a transpose of the same data? What do you to want to happen when the data in the 2nd workbook changes? do you want the just the last row to change or do you want a new row with updated values below it?"}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 68, "user_id": 12115844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFb9Y.jpg?s=128&g=1", "display_name": "Cooper", "link": "https://stackoverflow.com/users/12115844/cooper"}, "edited": false, "score": 0, "creation_date": 1574803317, "post_id": 59059354, "comment_id": 104358489, "body": "Of course this is a simplified example... but the key in this example is that I only have new data for sam and meg... so only sam and meg will get updated values... the other values will stay the same..."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 68, "user_id": 12115844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFb9Y.jpg?s=128&g=1", "display_name": "Cooper", "link": "https://stackoverflow.com/users/12115844/cooper"}, "edited": false, "score": 0, "creation_date": 1574803943, "post_id": 59059354, "comment_id": 104358760, "body": "Wait... Can I use &quot;.PasteSpecial&quot; and &quot;SkipBlanks:=True&quot; and &quot;Transpose:=True&quot;... I have never used or known about the &quot;SkipBlanks&quot; option... I think I can make that work."}, {"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "reply_to_user": {"reputation": 68, "user_id": 12115844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFb9Y.jpg?s=128&g=1", "display_name": "Cooper", "link": "https://stackoverflow.com/users/12115844/cooper"}, "edited": false, "score": 0, "creation_date": 1574804139, "post_id": 59059354, "comment_id": 104358847, "body": "Yes... I think that&#39;s my simplest option. I can use a lookup function and then use &quot;.PasteSpecial&quot; and &quot;SkipBlanks:=True&quot; and &quot;Transpose:=True&quot;..."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1574804694, "post_id": 59059354, "comment_id": 104359054, "body": "Why can&#39;t you just link the cells in workbook A to Workbook B? So, when ever the value gets updated in Workbook B the value in Workbook A gets updated."}], "answers": [{"tags": [], "owner": {"reputation": 68, "user_id": 12115844, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kFb9Y.jpg?s=128&g=1", "display_name": "Cooper", "link": "https://stackoverflow.com/users/12115844/cooper"}, "is_accepted": false, "score": 0, "last_activity_date": 1574804190, "creation_date": 1574804190, "answer_id": 59059698, "question_id": 59059354, "link": "https://stackoverflow.com/questions/59059354/update-cell-value-if-new-value-is-availiable/59059698#59059698", "title": "Update cell value if new value is availiable", "body": "<p>So if you want to get data from one book to another then vlookup is the simplest solution</p>\n\n<p><a href=\"https://photos.app.goo.gl/CRjxhJHVKm6xKJ8x7\" rel=\"nofollow noreferrer\">https://photos.app.goo.gl/CRjxhJHVKm6xKJ8x7</a></p>\n\n<p>I nested it within an if statement that checks to see if there is an error, if there is an error then it just grabs the value from the line above. I.e. if the Name doesn't exist on your second sheet, then there is an error and it will just grab from the line above.</p>\n\n<pre><code>=IF(ISERROR(VLOOKUP(A1,[Book2]Sheet1!$A$2:$B$5,2,FALSE)),A11,VLOOKUP(A1,[Book2]Sheet1!$A$2:$B$5,2,FALSE))\n</code></pre>\n\n<p>On the face value, this does what you are asking but the way you phrased the question implies that there is some other functionality and some other things you need to do that this solution will possibly get in the way of. That's why I was trying to clarify what you really want to achieve.</p>\n\n<p>Anyway, hopefully its a step in the right direction... Goodluck!</p>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1574817542, "post_id": 59059726, "comment_id": 104362635, "body": "So i do not need the plus 1. But looks like this will work. Thank you."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1574837837, "post_id": 59059726, "comment_id": 104367800, "body": "@xcellguy. If this has answered your question please upvote/accept the answer by clicking the checkmark on the left. Doing so would return the favour in the form of exp points plus it would close the thread"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1574838763, "post_id": 59059726, "comment_id": 104368208, "body": "On another note, I see you have loads of open questions. You might want to revisit those too and accept the answers given if they helped you out. Clicking the checkmark will accept the answer (closing the thread) and the arrows (also on the left of the answers) will upvote the answer as being helpful. It&#39;s only a decent thing to do. @xcellguy"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "edited": false, "score": 0, "creation_date": 1575876735, "post_id": 59059726, "comment_id": 104698966, "body": "@XCELLGUY, if this thread needs to be closed you need to start marking answer as being correct. Also see my last comment."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1574804745, "last_edit_date": 1574804745, "creation_date": 1574804326, "answer_id": 59059726, "question_id": 59059354, "link": "https://stackoverflow.com/questions/59059354/update-cell-value-if-new-value-is-availiable/59059726#59059726", "title": "Update cell value if new value is availiable", "body": "<p>Here is my take on it. No dictionary, however going through memory in an array:</p>\n\n<hr>\n\n<p><strong><em><sub>Sample data:</sub></em></strong></p>\n\n<p>Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vjP6Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vjP6Q.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/70qAl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/70qAl.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong><em><sub>Sample code:</sub></em></strong></p>\n\n<pre><code>Sub Test()\n\nDim lr As Long, x As Long, col As Long\nDim arr As Variant\n\n'Step 1: Get the values to update\nWith Sheet1 \n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    arr = .Range(\"A1:B\" &amp; lr)\nEnd With\n\n'Step 2: Go through our values to update\nWith Sheet2\n    For x = LBound(arr) To UBound(arr)\n        col = .Rows(1).Find(arr(x, 1), Lookat:=xlWhole).Column\n        .Cells(.Cells(.Rows.Count, col).End(xlUp).Row + 1, col) = arr(x, 2)\n    Next x\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong><em><sub>Result:</sub></em></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/k6Xc6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k6Xc6.png\" alt=\"enter image description here\"></a></p>\n\n<p>Remove the <code>+1</code> in case you want to rewrite the last entry in the found column. I just assumed you wanted to paste the value underneath. Also, I refered to sheets, you can simply refer to the other open workbook.</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "is_accepted": true, "score": 0, "last_activity_date": 1575986176, "creation_date": 1575986176, "answer_id": 59268853, "question_id": 59059354, "link": "https://stackoverflow.com/questions/59059354/update-cell-value-if-new-value-is-availiable/59268853#59268853", "title": "Update cell value if new value is availiable", "body": "<p>Firstly, a little more background on my problem. I am opening text files, extracting data, re-arranging the data on an excel sheet (wkbTemp), and then copying the re-arranged data to \"wkbCompiledDataTable.\"</p>\n\n<p>Here is how i solved my problem.</p>\n\n<pre><code>wkbTemp.Sheets(1).Activate\nLRow = Cells(Rows.Count, 9).End(xlUp).Offset(0, 0).row \n\nwkbTemp.Sheets(1).Range(\"J1:N\" &amp; LRow).Copy\n\nwkbCompiledDataTable(1).Activate   \nLRow = Cells(Rows.Count, 1).End(xlUp).Offset(0, 0).row    \n\nwkbCompiledDataTable(1).Sheets(1).Range(\"D\" &amp; LRow).PasteSpecial _\n                                                          Paste:=xlPasteValues, _\n                                                          SkipBlanks:=True, _\n                                                          Transpose:=True\n</code></pre>\n\n<p>As I said earlier, the actual application is much more complicated. This routine is actually in a loop. So for example I actually have \"wkbCompiledDataTable(i)\" instead of \"wkbCompiledDataTable(1).\" But for me this was the simplest solution. wkbTemp.Sheets(1) Column \"J\" has data. Column \"K\" is blank. Column \"L\", Column \"M\", Column \"N\" has data (These 3 columns are the columns I was concerned with data changing).</p>\n"}], "owner": {"reputation": 149, "user_id": 9370341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ec8a0d4e3168e01b94be2cb46050dd?s=128&d=identicon&r=PG&f=1", "display_name": "XCELLGUY", "link": "https://stackoverflow.com/users/9370341/xcellguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 59268853, "answer_count": 3, "score": 0, "last_activity_date": 1575986176, "creation_date": 1574802596, "question_id": 59059354, "link": "https://stackoverflow.com/questions/59059354/update-cell-value-if-new-value-is-availiable", "title": "Update cell value if new value is availiable", "body": "<p>So I am brainstorming a few different ways to accomplish this task... but none of the ways I am thinking are very clean. I am looking for a clean way to accomplish this.</p>\n\n<p>I have 2 workbooks (workbook A, workbook B).</p>\n\n<p>Workbook A looks like this:</p>\n\n<pre><code> A    B    C    D    E\nTom  Bob  Sam  Ted  Meg\n 1    4    9    3    2\n</code></pre>\n\n<p>The A,B,C... are the columns (not actually on the sheet) and the 1,4,9,3,2 is data on the last row (could be row 10 or row 1000, etc...)</p>\n\n<p>Workbook B looks like this:</p>\n\n<pre><code>  A    B\n Sam   5   \n Meg   1\n</code></pre>\n\n<p>I want to update workbook A with any values on workbook B. So... in this example... Sam and Meg has a new value... So I want to update workbook A to look like this:</p>\n\n<pre><code> A    B    C    D    E\nTom  Bob  Sam  Ted  Meg\n 1    4    5    3    1\n</code></pre>\n\n<p>I feel like the simplest way to do this may be to make something like a dictionary or something like that but I have never used a dictionary and don't know if some other method would be easier / simpler. </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1574804379, "post_id": 59059321, "comment_id": 104358941, "body": "Your current question is too broad to answer.  Do you want your Inbox monitored for these emails?  Do you want to run a macro each morning that looks for this email?  What does &quot;save a copy with a date&quot; mean?  What does &quot;Same case with just an excel file&quot; mean?  &quot; I would like to replace the old file without asking a question.&quot;  Which old file?  Which unzip package do you use?  Does it have a command line interface?  What you seek is almost certainly possible.  Have you tried creating a macro using code you found here or elsewhere?"}, {"owner": {"reputation": 11, "user_id": 11241854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed07c8290ebc818ef1f4bbba96f49f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias B", "link": "https://stackoverflow.com/users/11241854/ilias-b"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1574804806, "post_id": 59059321, "comment_id": 104359100, "body": "Okay what I wrote is certainly not clear. I will try to rewrite and make it more easy to understand."}, {"owner": {"reputation": 11, "user_id": 11241854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed07c8290ebc818ef1f4bbba96f49f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias B", "link": "https://stackoverflow.com/users/11241854/ilias-b"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1574805321, "post_id": 59059321, "comment_id": 104359278, "body": "I receive 4 weekly mails with attachments, 2 zip files and 2 excel files. For the zipped files, I want to extract and save to a specified folder the .csv files. Then make a renamed copy of the .csv files to another folder. Same logic applies for the excel files as well, extract and save to a specified folder and then make a renamed copy to another folder. I would like one code for all these steps, is it possible? Hope it makes more sense now? :)"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1574808521, "post_id": 59059321, "comment_id": 104360361, "body": "You need to add this extra detail to your question.  Comments are limited to 500 characters and have only basic formatting.  A complete question would be much easier to understand than a vague question plus comments."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1574808565, "post_id": 59059321, "comment_id": 104360376, "body": "How are these four emails recognised?  Are they from a particular sender? Do they have a particular subject?  Could an Outlook rule recognise them or must you as a human identify them?  Having identified one of these emails, saving attachments is easy.  Creating a second copy of a file with a new name in a different folder is easy."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1574808606, "post_id": 59059321, "comment_id": 104360386, "body": "I use WinZip which has a command line interface.  I have not unzipped files with VBA for some years since I use VB for archiving and restoring files.  I have recently discovered how to unzip from VBA using 7-Zip which was tricky.  What zip-unzip package do you use?  Does it have a command line interface?  Do you know that CLI or are you hoping someone here knows it?"}, {"owner": {"reputation": 11, "user_id": 11241854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed07c8290ebc818ef1f4bbba96f49f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias B", "link": "https://stackoverflow.com/users/11241854/ilias-b"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1574843275, "post_id": 59059321, "comment_id": 104370336, "body": "I just edited the original post, sorry for the inconvenience."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11241854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed07c8290ebc818ef1f4bbba96f49f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias B", "link": "https://stackoverflow.com/users/11241854/ilias-b"}, "edited": false, "score": 0, "creation_date": 1574927713, "post_id": 59066433, "comment_id": 104404027, "body": "Thanks as well, much appreciated! I will take a look and adjust the code. Thanks again :)"}], "tags": [], "owner": {"reputation": 105, "user_id": 6199625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83d46ef1482a035f7af3951acb0af26?s=128&d=identicon&r=PG&f=1", "display_name": "cr44sh", "link": "https://stackoverflow.com/users/6199625/cr44sh"}, "is_accepted": false, "score": 0, "last_activity_date": 1574845037, "creation_date": 1574845037, "answer_id": 59066433, "question_id": 59059321, "link": "https://stackoverflow.com/questions/59059321/detect-new-mail-then-extract-unzip-and-rename-attachments/59066433#59066433", "title": "Detect new mail then extract, unzip and rename attachments", "body": "<p>I won't develop the code for your specific problem, but I recently wrote something similar. Maybe you can go from here by altering to your criteria etc.</p>\n\n<p>In my case I had two e-mails incoming shortly after another, within 60 seconds. Both mails had \"FP\" in their subject and a .pdf-attachment. The task was to concatenate these attachments using the installed PDF24, which luckily offers a shell command for this.\nThis was the code, placed in the \"ThisOutlookSession\" of the Outlook VBA project explorer.</p>\n\n<pre><code>Public btAttachmentMails As Byte\nPublic dtArrivalStamp As Date\nPublic strPathFirstMailAttachment As String\nPrivate WithEvents inboxItems As Outlook.Items\n\nPrivate Sub Application_Startup()\n  Dim outlookApp As Outlook.Application\n  Dim objectNS As Outlook.NameSpace\n\n  Set outlookApp = Outlook.Application\n  Set objectNS = outlookApp.GetNamespace(\"MAPI\")\n  Set inboxItems = objectNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub inboxItems_ItemAdd(ByVal Item As Object)\nOn Error GoTo ErrorHandler\n\nDim Msg As Outlook.MailItem\nIf TypeName(Item) = \"MailItem\" Then\n\n    Dim i As Integer\n    Dim strDocumentsFolder As String\n    strDocumentsFolder = CreateObject(\"WScript.Shell\").SpecialFolders(16)\n    strPathFirstMailAttachment = strDocumentsFolder &amp; \"\\attachment_mail1.pdf\"\n\n    If Item.Subject Like \"FP*\" Then\n\n        If btAttachmentMails = 0 Then\n            'first mail -&gt; save attachment and set counter to 1\n            btAttachmentMails = 1\n            dtArrivalStamp = Time\n\n            For i = 1 To Item.Attachments.Count\n                If InStr(Item.Attachments.Item(i).DisplayName, \".PDF\") &gt; 0 Then\n                    Item.Attachments.Item(i).SaveAsFile strPathFirstMailAttachment\n                End If\n            Next i\n\n        ElseIf btAttachmentMails = 1 Then\n            Dim dtNow As Date: dtNow = Time\n\n            If TimeDiff(dtArrivalStamp, dtNow) &lt;= 60 Then\n            'second mail within 60 seconds with subject containing \"FP\" -&gt; save attachment and concatenate both via pdf24, then delete both files\n\n                'save attachment of second mail\n                Dim strPathSecondMailAttachment As String\n                strPathSecondMailAttachment = strDocumentsFolder &amp; \"\\attachment_mail2.pdf\"\n\n                For i = 1 To Item.Attachments.Count\n                    If InStr(Item.Attachments.Item(i).DisplayName, \".PDF\") &gt; 0 Then\n                        Item.Attachments.Item(i).SaveAsFile strPathSecondMailAttachment\n                    End If\n                Next i\n\n                'concatenate pdf documents via pdf24 shell\n                Dim strOutputPath As String\n                strOutputPath = CreateObject(\"WScript.Shell\").SpecialFolders(\"Desktop\") &amp; \"\\\" &amp; Year(Date) &amp; Month(Date) &amp; Day(Date) &amp; \"_Wartungsplan_\" &amp; Replace(CStr(Time), \":\", \"-\") &amp; \".PDF\"\n                Shell (\"\"\"C:\\Program Files (x86)\\PDF24\\pdf24-DocTool.exe\"\" -join -profile \"\"default/good\"\" -outputFile \" &amp; strOutputPath &amp; \" \" &amp; strPathFirstMailAttachment &amp; \" \" &amp; strPathSecondMailAttachment)\n\n                'inform user\n                MsgBox (\"Files have been successfully concatenated. You can find the combined file on your desktop.\")\n\n                'reset status, delete temporary documents\n                btAttachmentMails = 0\n                If CreateObject(\"Scripting.FileSystemObject\").fileexists(strPathFirstMailAttachment) Then Kill strPathFirstMailAttachment\n                If CreateObject(\"Scripting.FileSystemObject\").fileexists(strPathSecondMailAttachment) Then Kill strPathSecondMailAttachment\n\n            Else\n            'second mail did not arrive within 60 seconds -&gt; treat as first mail\n            'save new arrival time and overwrite old firstMailAttachment with this one\n\n                dtArrivalStamp = Time\n\n                For i = 1 To Item.Attachments.Count\n                    If InStr(Item.Attachments.Item(i).DisplayName, \".PDF\") &gt; 0 Then\n                        Item.Attachments.Item(i).SaveAsFile strPathFirstMailAttachment 'overwrites existing file\n                    End If\n                Next i\n\n            End If\n\n        End If\n\n    End If\n\nEnd If\n\nExitNewItem:\n    Exit Sub\n\nErrorHandler:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description &amp; \" - please contact XY\"\n    Resume ExitNewItem\nEnd Sub\n\nFunction TimeDiff(StartTime As Date, StopTime As Date)\n    TimeDiff = Abs(StopTime - StartTime) * 86400\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11241854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed07c8290ebc818ef1f4bbba96f49f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias B", "link": "https://stackoverflow.com/users/11241854/ilias-b"}, "edited": false, "score": 0, "creation_date": 1574927680, "post_id": 59070540, "comment_id": 104404011, "body": "Thanks for your detailed answer, much appreciated! I will take a look and let you know if it works! Wish I could repay somehow"}], "tags": [], "owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "is_accepted": false, "score": 1, "last_activity_date": 1574858617, "creation_date": 1574858617, "answer_id": 59070540, "question_id": 59059321, "link": "https://stackoverflow.com/questions/59059321/detect-new-mail-then-extract-unzip-and-rename-attachments/59070540#59070540", "title": "Detect new mail then extract, unzip and rename attachments", "body": "<p>cr44sh has posted an answer while I was creating mine.  He has recommended using a new item event while I have recommended using a rule.  I prefer rules but you can choose which ever approach you favour.   </p>\n\n<p>It is impossible to fully answer your question but I believe I can give enough help for you to construct the macros you need yourself.</p>\n\n<p>You say that these emails can be identified with VBA.  That suggests the best approach is an Outlook rule which uses the \u201crun a script\u201d option where \u201crun a script\u201d means \u201crun a macro\u201d.  I will discuss the rule later but first you need the macros that will be run.</p>\n\n<p>You will need two macros like this:</p>\n\n<pre><code>Public Sub Type1Email(ByRef ItemCrnt As MailItem)\n  ' Relevant code\nEnd Sub\nPublic Sub Type2Email(ByRef ItemCrnt As MailItem)\n  ' Relevant code\nEnd Sub\n</code></pre>\n\n<p>I am sure you can create better names for these macros.  I have read that macros to be run by a rule must be in <code>ThisOutlookSession</code>.  In my experience, they can be in an ordinary module providing they are declared as <code>Public</code>.  I only use <code>ThisOutlookSession</code> for code that has to be in that code area.  If code can be in a module, that is where I place it.  I suggest creating a new module which will be named Module1 or Module2.  Use function key <kbd>F4</kbd> to access its properties and rename it as \u201cModRuleMacros\u201d or similar.  Giving modules meaningful names makes it so much easier to find the code you want to look at today.</p>\n\n<p>Although the aim is to create a macro to be run by a rule, you need a way of testing the macro.  If you have some of these emails saved somewhere, you can activate the rule by moving one of those emails to Inbox.  However, I generally find it easier to use a macro like this:</p>\n\n<pre><code>Sub TestType1Email()\n\n  Dim Exp As Explorer\n  Dim ItemCrnt As MailItem\n\n  Set Exp = Outlook.Application.ActiveExplorer\n\n  If Exp.Selection.Count = 0 Then\n    Call MsgBox(\"Pleaase select one or more emails then try again\", vbOKOnly)\n    Exit Sub\n  Else\n    For Each ItemCrnt In Exp.Selection\n      Call Type1Email(ItemCrnt)\n    Next\n  End If\n\nEnd Sub\n</code></pre>\n\n<p>To use this macro, you select one or more Type1 emails and then run macro <code>TestType1Email</code>.  This macro will pass the selected emails, one at a time, to the macro <code>Type1Email</code>.  This will allow you to single step through macro <code>Type1Email</code> and ensure that it works to your entire satisfaction.  I find this to be the easier method of testing a new Outlook macro.</p>\n\n<p>It may be helpful to check what a rule can do for you.  Select one of these emails and then click on <kbd>Rules</kbd>, which is in the middle of the Home tab, and then <kbd>Create rule \u2026</kbd>.  Selecting one of these emails means the first window is filled out with some options.  Click <kbd>Advanced options \u2026</kbd>.  The new window lists all the options for selecting an email.  Are all the options you need to select a type 1 or a type 2 email listed?  The list is comprehensive but not complete.  For example, you cannot select by the presence of attachments.  Identify the options you can use and identify the options you need that are missing.  Click <kbd>Cancel</kbd> twice to exist from rule creation.  </p>\n\n<p>You will need include code for any missing options in your macro.</p>\n\n<p>Your question implies you have all the code you need for processing the emails except for suppressing the replace question.  You need to check if there is an existing file before creating the new file.  This is the routine that I use to check if a file exists: </p>\n\n<pre><code>Public Function FileExists(ByVal PathName As String, ByVal FileName As String) As Boolean\n\n  ' Returns True if file exists.  Assumes path already tested.\n\n  ' Coded by Tony Dallimore\n  ' Based on code written by iDevlop: http://stackoverflow.com/a/28237845/973283\n\n  ' Ensure only one \"\\\" between path and filename\n  If Right$(PathName, 1) &lt;&gt; \"\\\" Then\n    PathName = PathName &amp; \"\\\"\n  End If\n  If Left$(FileName, 1) = \"\\\" Then\n    FileName = Mid$(FileName, 2)\n  End If\n\n  FileExists = False\n  On Error Resume Next\n  FileExists = ((GetAttr(PathName &amp; FileName) And vbDirectory) &lt;&gt; vbDirectory)\n  On Error GoTo 0\n\nEnd Function\n</code></pre>\n\n<p>If the file exists, you can:</p>\n\n<ul>\n<li>Use VBA statement <code>Kill</code> (<a href=\"https://docs.microsoft.com/en-gb/office/vba/Language/Reference/user-interface-help/kill-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-gb/office/vba/Language/Reference/user-interface-help/kill-statement</a>) to delete the old file.</li>\n<li>Use VBA statement Name (<a href=\"https://docs.microsoft.com/en-gb/office/vba/language/reference/user-interface-help/name-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-gb/office/vba/language/reference/user-interface-help/name-statement</a>)  to move the old file to another folder or rename it perhaps by adding a date at the beginning of the name.</li>\n</ul>\n\n<p>I favour the second option because I do not like deleting a file until I am really, really sure I will not need it again.  I saw too many situations during my career where a file deleted as no longer needed was found to be incorrectly or incompletely processed a few months later. </p>\n\n<p>Once you have fully tested the macros, you can create the rules to execute them.  For each type of email:</p>\n\n<ul>\n<li>Select an email of the required type.</li>\n<li>Click on <kbd>Rules</kbd> and then <kbd>Create rule \u2026</kbd>.</li>\n<li>Tick any relevant boxes on the first window.</li>\n<li>Click <kbd>Advanced options \u2026</kbd>.</li>\n<li>Tick all relevant boxes on the second window.</li>\n<li>Click <kbd>Next</kbd>.</li>\n<li>Tick the box against \u201cRun a script\u201d.</li>\n<li>Click <kbd>a script</kbd>.</li>\n<li>You will be shown a list of all the macros that can be run from a rule.  Select the required macro.</li>\n<li>Click <kbd>Next</kbd>.</li>\n<li>Tick the box against any appropriate exceptions and enter any additional information required.</li>\n<li>Click <kbd>Next</kbd>.</li>\n<li>Name the rule.  Tick \u201crun this rule against any messages already in Inbox\u201d if required.  Review the rule and edit if necessary.</li>\n<li>Click <kbd>Finish</kbd>.</li>\n</ul>\n\n<p>I hope the above is enough to plug the holes in your knowledge.</p>\n"}], "owner": {"reputation": 11, "user_id": 11241854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed07c8290ebc818ef1f4bbba96f49f5?s=128&d=identicon&r=PG&f=1", "display_name": "Ilias B", "link": "https://stackoverflow.com/users/11241854/ilias-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1578101235, "creation_date": 1574802372, "last_edit_date": 1578101235, "question_id": 59059321, "link": "https://stackoverflow.com/questions/59059321/detect-new-mail-then-extract-unzip-and-rename-attachments", "title": "Detect new mail then extract, unzip and rename attachments", "body": "<p>I receive 4 weekly emails from 3 different senders. </p>\n\n<p>Emails 1 and 2 are from the same sender and can be recognized through VBA. These emails contain zip files, where each zip file has one .csv file.</p>\n\n<p>Emails 3 and 4 can also be recognized by VBA and the attachments are Excel sheets (.xlsx).</p>\n\n<p>I want to extract and unzip (where needed) and save these 4 files in a folder as; <code>email1.report</code>, <code>email2.report</code> etc.<br>\nThen make a copy of these 4 files in a different folder for each file and rename like; \"Today's date\".email1.report.csv etc.</p>\n\n<p>I want to combine these steps in a single code and to replace the email1.report, email2.report etc., files without a prompt asking \"do you want to replace the files? Yes, No?\"</p>\n\n<p>Is it possible to detect the new weekly emails and do this automatically?</p>\n\n<p>The code I use to unzip and save:</p>\n\n<pre><code>Else\n    For Each Atmt In Item.Attachments\n        If Right(Atmt.FileName, 3) = \"zip\" Then\n            FileNameFolder = \"C:\\Users\\...\"\n            FileName = FileNameFolder &amp; Left(Atmt.FileName, (InStr(1, Atmt.FileName, \".zip\") - 1)) &amp; \".txt\"\n            Atmt.SaveAsFile FileName\n\n            FileNameT = FileNameFolder &amp; Atmt.FileName\n\n            Name FileName As FileNameT\n\n            Set oApp = CreateObject(\"Shell.Application\")\n            oApp.NameSpace((FileNameFolder)).CopyHere oApp.NameSpace((FileNameT)).Items\n\n            Kill FileNameT\n\n            i = i + 1\n        End If\n    Next Atmt\n    'item.Close\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "powerpivot", "slicers"], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574803112, "post_id": 59059405, "comment_id": 104358413, "body": "Per the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.slicercache.visiblesliceritems\" rel=\"nofollow noreferrer\">link</a> already provided, this will fail for a slicer connected to an OLAP data source."}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1574802809, "creation_date": 1574802809, "answer_id": 59059405, "question_id": 59059282, "link": "https://stackoverflow.com/questions/59059282/is-there-really-no-way-to-count-the-number-of-visible-slicer-items-in-a-slicer-c/59059405#59059405", "title": "Is there really no way to count the number of Visible Slicer Items in a Slicer connected to an OLAP data source?", "body": "<p>Try using this logic:</p>\n\n<pre><code>Sub Test()\n\n    Dim SC As SlicerCache\n    Dim SI As SlicerItem\n\n    For Each SC In ThisWorkbook.SlicerCaches 'this will loop through all your slicer caches in the whole workbook\n        'if you want to skip an slicer do it here and skip to the next\n        For Each SI In SC.VisibleSlicerItems 'this will loop through all your visible slicer items\n            'some code\n        Next SI\n    Next SC\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 646, "user_id": 8668095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s2WoT.jpg?s=128&g=1", "display_name": "Kapil Raghuwanshi", "link": "https://stackoverflow.com/users/8668095/kapil-raghuwanshi"}, "edited": false, "score": 0, "creation_date": 1588846719, "post_id": 61654203, "comment_id": 109059551, "body": "Can you please share more insights of your working code snippet?"}], "tags": [], "owner": {"reputation": 36, "user_id": 10250426, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ZAxX9OtlzfU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNImthywJhGAUgcEA9zfWqz8VbTuA/mo/photo.jpg?sz=128", "display_name": "Alan K", "link": "https://stackoverflow.com/users/10250426/alan-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1588851789, "last_edit_date": 1588851789, "creation_date": 1588843222, "answer_id": 61654203, "question_id": 59059282, "link": "https://stackoverflow.com/questions/59059282/is-there-really-no-way-to-count-the-number-of-visible-slicer-items-in-a-slicer-c/61654203#61654203", "title": "Is there really no way to count the number of Visible Slicer Items in a Slicer connected to an OLAP data source?", "body": "<p>Sorry, for the late answer, but I just want to share below solution that worked for me:</p>\n\n<p>UBound(ThisWorkbook.SlicerCaches(SC1).SlicerCacheLevels(1).VisibleSlicerItemsList)</p>\n\n<p>EDIT:</p>\n\n<p>The .VisibleSlicerItemsList property returns an array so You can't use the .count property on It, like You would do on collections. In order to get the length of an array, use the function UBound (<a href=\"https://www.excel-easy.com/vba/examples/size-of-an-array.html\" rel=\"nofollow noreferrer\">see here</a>).</p>\n"}], "owner": {"reputation": 3, "user_id": 12361753, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC1aFpTUDQ9I4vYnZmEw5aA--xMzgqn_5aJTv9mXQ=k-s128", "display_name": "Nathan Jewkes", "link": "https://stackoverflow.com/users/12361753/nathan-jewkes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 61654203, "answer_count": 2, "score": 0, "last_activity_date": 1588851789, "creation_date": 1574802177, "question_id": 59059282, "link": "https://stackoverflow.com/questions/59059282/is-there-really-no-way-to-count-the-number-of-visible-slicer-items-in-a-slicer-c", "title": "Is there really no way to count the number of Visible Slicer Items in a Slicer connected to an OLAP data source?", "body": "<p>I'm trying to loop through all slicer items from three slicers and then call another sub within the inner most loop. The slicers are connected to an OLAP data source. For each slicer I'd only like it to loop through visible slicer items. I hide the items with no data after selecting an item from the outer slicer. If I use the following code, then it will loop through all slicer items, not just the visible ones:</p>\n\n<pre><code>'Begin Loop through Fund Name Slicer\ni = 1\n\nDo Until i = ActiveWorkbook.SlicerCaches(SC1).SlicerCacheLevels.Item.count + 1\n\n    'select ith item in Fund Name Slicer\n    ActiveWorkbook.SlicerCaches(SC1).VisibleSlicerItemsList = Array( _\n    ActiveWorkbook.SlicerCaches(SC1).SlicerCacheLevels.Item.SlicerItems(i).Name)\n\n    'hide items with no data in Scenario Name Slicer\n    With ActiveWorkbook.SlicerCaches(SC2).Slicers(S2)\n        .SlicerCacheLevel.CrossFilterType = xlSlicerCrossFilterHideButtonsWithNoData\n        .SlicerCacheLevel.SortItems = xlSlicerSortDataSourceOrder\n    End With\n\n    'Begin Loop through Scenario Name Slicer\n    j = 1\n\n        Do Until j = ActiveWorkbook.SlicerCaches(SC2).SlicerCacheLevels.Item.count + 1\n\n            'select jth item in Scenario Name Slicer\n            ActiveWorkbook.SlicerCaches(SC2).VisibleSlicerItemsList = Array( _\n            ActiveWorkbook.SlicerCaches(SC2).SlicerCacheLevels.Item.SlicerItems(j).Name)\n\n            'hide items with no data in Override Set Name Slicer\n            With ActiveWorkbook.SlicerCaches(SC3).Slicers(S3)\n                .SlicerCacheLevel.CrossFilterType = xlSlicerCrossFilterHideButtonsWithNoData\n                .SlicerCacheLevel.SortItems = xlSlicerSortDataSourceOrder\n            End With\n\n            'Begin Loop through Override Set Name Slicer\n            k = 1\n\n                Do Until k = ActiveWorkbook.SlicerCaches(SC3).SlicerCacheLevels.Item.count + 1\n\n                    'Select kth item in Override Set Name Slicer\n                    ActiveWorkbook.SlicerCaches(SC3).VisibleSlicerItemsList = Array( _\n                    ActiveWorkbook.SlicerCaches(SC3).SlicerCacheLevels.Item.SlicerItems(k).Name)\n\n                    'Call sub that copies and pastes summary values\n                    Call SelectedComboOnly\n\n                    k = k + 1\n\n                Loop\n\n            j = j + 1\n\n        Loop\n\n    i = i + 1\n\nLoop\n\n</code></pre>\n\n<p>I tried to replace the Do Until statements with something like:</p>\n\n<pre><code>Do Until  i = ActiveWorkbook.SlicerCaches(SC1).VisibleSlicerItems.count + 1\n</code></pre>\n\n<p>but this throws a run time error. I found <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.slicercache.visiblesliceritems\" rel=\"nofollow noreferrer\">here</a> that \"Attempting to access the VisibleSlicerItems property for slicers that are connected to an OLAP data source (SlicerCache.OLAP = True) generates a run-time error.\" Is there really no way to access the number of visible slicer items here? Or should I try something completely different? My macro does what it's supposed to do, but it takes about 25 minutes. I'm just trying to run through only visible slicer items to optimize the code. This would take the combinations that it has to run through from 1,458 to 84. I already have screen updating off.</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574801227, "post_id": 59058681, "comment_id": 104357642, "body": "If you make Excel visible you may be able to see what the problem is.  Sounds like the real problem may be in your Excel VBA, not in your Outlook code."}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1574801868, "post_id": 59058681, "comment_id": 104357921, "body": "You haven&#39;t specified the workbook that holds the macro...Try <code>xlApp.Application.Run sourceWB.Name &amp;  &quot;AINT.Cali_B_Click&quot;</code> You may have to play with that syntax a little...use your immediate window as a guide."}, {"owner": {"reputation": 13, "user_id": 11460791, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-79nhf65ejbA/AAAAAAAAAAI/AAAAAAAAABI/Z0d1vPgIVuU/photo.jpg?sz=128", "display_name": "Laharl Krichevki", "link": "https://stackoverflow.com/users/11460791/laharl-krichevki"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574880770, "post_id": 59058681, "comment_id": 104390762, "body": "@TimWilliams @MBB70  I took a look at the excel macros, however they just move information from one cell to another, however i&#39;ll give it a further look.  The macro runs fine, even without especifing the workbook, i tried using <code>xlApp.Application.Run sourceWB.Name &amp; &quot;AINT.Cali_B_Click&quot;</code> but the macro didn&#39;t work with this.  I tried using <code>Shell &quot;taskkill &#47;f &#47;im excel.exe&quot;, vbHide</code> , wich ends the Excel task, however when running for the seccond time with task kill, i get the error &quot;462 - The remote server machine does not exist or is unavailable&quot;"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574893850, "post_id": 59058681, "comment_id": 104395709, "body": "You\u2019re missing a <code>!</code> between them workbook name and the macro name.  And if the workbook name has spaces it needs to be in single quotes."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 11460791, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-79nhf65ejbA/AAAAAAAAAAI/AAAAAAAAABI/Z0d1vPgIVuU/photo.jpg?sz=128", "display_name": "Laharl Krichevki", "link": "https://stackoverflow.com/users/11460791/laharl-krichevki"}, "is_accepted": true, "score": 0, "last_activity_date": 1575379920, "creation_date": 1575379920, "answer_id": 59158293, "question_id": 59058681, "link": "https://stackoverflow.com/questions/59058681/closing-an-excel-application-using-outlook-vba-after-using-an-excel-function/59158293#59158293", "title": "Closing an Excel Application using Outlook VBA after using an Excel function", "body": "<p>Turns out using <code>xlApp.Application.Run \"AINT.Cali_B_Click\"</code> or <code>xlApp.Application.Run sourceWB.Name &amp; \"AINT.Cali_B_Click\"</code> left open references on the VBA code.</p>\n\n<p>The way to call the code without lefting any open is using <code>CallByName</code>,</p>\n\n<p>As in <code>Call CallByName(AINT, \"Cali_B_Click\", VbMethod)</code></p>\n\n<p>This way the VBA code can call the function and run as many times as needed without the current error.</p>\n"}], "owner": {"reputation": 13, "user_id": 11460791, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-79nhf65ejbA/AAAAAAAAAAI/AAAAAAAAABI/Z0d1vPgIVuU/photo.jpg?sz=128", "display_name": "Laharl Krichevki", "link": "https://stackoverflow.com/users/11460791/laharl-krichevki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 59158293, "answer_count": 1, "score": 0, "last_activity_date": 1578828587, "creation_date": 1574799024, "last_edit_date": 1578828587, "question_id": 59058681, "link": "https://stackoverflow.com/questions/59058681/closing-an-excel-application-using-outlook-vba-after-using-an-excel-function", "title": "Closing an Excel Application using Outlook VBA after using an Excel function", "body": "<p>I am working on a sort of \"BOT\" for Outlook (using Outlook VBA), in which I receive info by mail, split the mail body, paste it on Excel and execute Excel macros.</p>\n\n<p>After adding the part where I call the Excel macro, I get </p>\n\n<blockquote>\n  <p>'1004 - application-defined or object-defined error'</p>\n</blockquote>\n\n<p>if I'm running this for the second + time.</p>\n\n<pre><code>xlApp.Application.Run \"AINT.Cali_B_Click\"\n</code></pre>\n\n<p>Even though I'm setting my Excel variables to nothing and using <code>.close</code> and <code>.quit</code>, Excel is still running.</p>\n\n<p>How can I end the application reference that is keeping Excel open?</p>\n\n<p>Here's my full code:</p>\n\n<pre><code>Private Sub inboxItems_ItemAdd(ByVal Item As Object)\n    On Error GoTo ErrorHandler\n    Dim Msg         As Outlook.MailItem\n    Dim MessageInfo\n    Dim Result\n    Dim splitter()  As String\n    Dim splitter2() As String\n    Dim loopH As String\n    Dim str         As Variant\n    Dim LoopCali    As Integer\n    Dim i, j          As Integer\n    Dim xlApp      As Object\n    Dim sourceWB   As Object\n    Dim Header, QuoteSTG, AINT, Treinamento As Object\n    Dim strFile, file_name    As String\n    Dim shellcom As String\n\n    i = 1\n\n    If TypeName(Item) = \"MailItem\" Then\n        If InStr(Item.Subject, \"BOT\") &gt; 0 Then\n            splitter = Split(Item.Body, vbCrLf)\n\n            Set xlApp = CreateObject(\"Excel.Application\")\n            strFile = \"C:\\Users\\e1257539\\Desktop\\SMOBOT\\SMO_TOOL_BOT.xlsm\"\n            With xlApp\n                .Visible = False\n                .EnableEvents = False\n                .DisplayAlerts = False\n            End With\n            Set sourceWB = Workbooks.Open(strFile)\n            sourceWB.Activate\n            Set Header = sourceWB.Sheets(4)\n            Set QuoteSTG = sourceWB.Sheets(13)\n            Set AINT = sourceWB.Sheets(7)\n            Set Treinamento = sourceWB.Sheets(10)\n\n            file_name = QuoteSTG.Range(\"A\" + CStr(QuoteSTG.Range(\"B1\").Value2)).Value2\n            QuoteSTG.Range(\"A\" + CStr(QuoteSTG.Range(\"B1\").Value2)).Value2 = \"\"\n\n            If splitter(2) = \"Calibra\u00e7\u00e3o\" Then\n                loopH = splitter(26)\n                LoopCali = CInt(loopH)\n                sourceWB.Save\n                Header.Range(\"D6\").Value2 = splitter(22)\n                Header.Range(\"D8\").Value2 = splitter(12)\n                Header.Range(\"F4\").Value2 = \"AINT\"\n                Header.Range(\"F3\").Value2 = \"EXW\"\n                Header.Range(\"C2\").Value2 = file_name\n                Header.Range(\"C4\").Value2 = \"Calibra\u00e7\u00e3o\"\n                Header.Range(\"L2\").Value2 = \"30\"\n                Header.Range(\"K12\").Value2 = Item.Subject '&lt; criar string?\n                j = 40\n                For i = 1 To LoopCali\n                    splitter2 = Split(splitter(j), \"-\")\n                    AINT.Range(\"N7\").Value2 = splitter2(0)\n                    AINT.Range(\"N13\").Value2 = splitter2(1)\n                    j = j + 2\n                    If splitter(j) &lt;&gt; \"\" Then\n                        AINT.Range(\"N14\").Value2 = splitter(j)\n                    End If \n                    j = j + 2\n                    If splitter(j) &lt;&gt; \"\" Then\n                        AINT.Range(\"N16\").Value2 = splitter(j)\n                    End If\n                    j = j + 2\n                    If splitter(j) &lt;&gt; \"\" Then\n                        If splitter2(0) &lt;&gt; \"RMT\" Then\n                            AINT.Range(\"N15\").Value2 = splitter(j)\n                        End If\n                    End If\n                    j = j + 2\n                    If splitter(j) &lt;&gt; \"\" Then\n                        AINT.Range(\"N17\").Value2 = splitter(j)\n                    End If\n                    j = j + 2\n                    xlApp.Application.Run \"AINT.Cali_B_Click\" '&lt; calling the excel sub \n                Next i\n\n            End If\n\n        End If\n\n    End If\n\n    'Closing excel\n    MkDir \"C:\\Users\\e1257539\\Desktop\\SMOBOT\\\" + file_name\n    sourceWB.SaveAs FileName:=\"C:\\Users\\e1257539\\Desktop\\SMOBOT\\\" + file_name + \"\\\" + file_name\n    sourceWB.Close (False)\n    xlApp.Quit\n    Set xlApp = Nothing\n    Set sourceWB = Nothing\n    Set AINT = Nothing\n    Set QuoteSTG = Nothing\n    Set Header = Nothing\n\nErrorHandler:\n    MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n    If Not sourceWB Is Nothing Then\n        sourceWB.Close (False)\n    End If\n    If Not xlApp Is Nothing Then\n        xlApp.Quit\n    End If\n    Set xlApp = Nothing\n    Set sourceWB = Nothing\n    Set AINT = Nothing\n    Set QuoteSTG = Nothing\n    Set Header = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "timestamp", "range", "automatic-updates"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1574798688, "post_id": 59058478, "comment_id": 104356564, "body": "This code runs when a change is detected in the worksheet the code is saved to.  Also, without qualify a sheet, <code>Range()</code> will refer to the active sheet (which I assume is the same one that stores this code)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574799226, "post_id": 59058478, "comment_id": 104356792, "body": "Put the code in Worksheet2 code and then change the cells on worksheet1."}, {"owner": {"reputation": 11, "user_id": 12440551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9c6d5eb9da6125462f45bf4d0105?s=128&d=identicon&r=PG&f=1", "display_name": "leslie", "link": "https://stackoverflow.com/users/12440551/leslie"}, "edited": false, "score": 0, "creation_date": 1574870570, "post_id": 59058478, "comment_id": 104385847, "body": "So should i use with after i set my range? to reference the range on the non-active sheet? not sure what function to use"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12440551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9c6d5eb9da6125462f45bf4d0105?s=128&d=identicon&r=PG&f=1", "display_name": "leslie", "link": "https://stackoverflow.com/users/12440551/leslie"}, "edited": false, "score": 0, "creation_date": 1574868018, "post_id": 59058985, "comment_id": 104384465, "body": "Thank you for the response, This code has a compile error.&quot;Expected end sub&quot; and it highlights the first line of code yellow."}, {"owner": {"reputation": 688, "user_id": 11766312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fc60fb0c356f40c1b09794cccd8ee65?s=128&d=identicon&r=PG&f=1", "display_name": "Miles Fett", "link": "https://stackoverflow.com/users/11766312/miles-fett"}, "reply_to_user": {"reputation": 11, "user_id": 12440551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9c6d5eb9da6125462f45bf4d0105?s=128&d=identicon&r=PG&f=1", "display_name": "leslie", "link": "https://stackoverflow.com/users/12440551/leslie"}, "edited": false, "score": 0, "creation_date": 1576257523, "post_id": 59058985, "comment_id": 104853506, "body": "@leslie just add <code>End Sub</code> after the last line of code and it will work."}], "tags": [], "owner": {"reputation": 1, "user_id": 12440706, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBhYqPVhQ52Twjm7jnNfLNNPo2M1R0GQx1a6LWU=k-s128", "display_name": "Nakul Sanyashi", "link": "https://stackoverflow.com/users/12440706/nakul-sanyashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1576283217, "last_edit_date": 1576283217, "creation_date": 1574800569, "answer_id": 59058985, "question_id": 59058478, "link": "https://stackoverflow.com/questions/59058478/how-do-i-get-the-timestamp-to-update-when-the-cell-contains-a-formula-referenci/59058985#59058985", "title": "How do i get the Timestamp to update, when the cell contains a formula referencing another cell in another worksheet?", "body": "<p>Try this - </p>\n\n<pre><code>Private Sub Worksheet_Calculate()\n    Dim myTableRange As Range\n    Dim myDateTimeRage As Range\n    Dim myUpdatedRange As Range\n    Set myTableRange = Range(\"D1:D314\")   \n\n    For Each cell In myTableRange\n        Dim OldValue As Variant\n        Application.EnableEvents = False\n        Application.Undo\n        OldValue = cell.Value\n        Application.Undo\n        Application.EnableEvents = True\n        If OldValue &lt;&gt; cell.Value Then\n            Set myDateTimeRage = Range(\"N\" &amp; cell.Row)\n            Set myUpdatedRange = Range(\"O\" &amp; cell.Row)    \n                If myDateTimeRage.Value = \"\" Then\n                    myDateTimeRage.Value = Now\n                End If\n            myUpdatedRange.Value = Now\n        End If    \n    Next cell\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12440551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9c6d5eb9da6125462f45bf4d0105?s=128&d=identicon&r=PG&f=1", "display_name": "leslie", "link": "https://stackoverflow.com/users/12440551/leslie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1576283217, "creation_date": 1574798044, "last_edit_date": 1574798250, "question_id": 59058478, "link": "https://stackoverflow.com/questions/59058478/how-do-i-get-the-timestamp-to-update-when-the-cell-contains-a-formula-referenci", "title": "How do i get the Timestamp to update, when the cell contains a formula referencing another cell in another worksheet?", "body": "<p>The following code is what gives me an initial timestamp (<code>N</code>) and updated time (<code>O</code>).</p>\n\n<p>This works when the cell's in column <code>D</code> on <code>WORKSHEET1</code> are manually updated. </p>\n\n<p>The cell's in Column <code>D</code> <code>WORKSHEET1</code> reference <code>WORKSHEET2</code> Column <code>E</code> now. So for example <code>D4</code> on <code>WORKSHEET1</code> is <code>='WORKSHEET2'!E23</code>.</p>\n\n<p>When values are updated on <code>WORKSHEET2</code>, the <code>D</code> column on <code>WORKSHEET1</code> updates automatically. </p>\n\n<p>The timestamp code below then stops working and does not pick up this value change.\nCan I insert a VBA code so that when i change the values on <code>WORKSHEET2</code>, and it updates on <code>WORKSHEET1</code> because of the formula in cel <code>D</code>, the timestamp will work?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim myTableRange As Range\n\nDim myDateTimeRage As Range\n\nDim myUpdatedRange As Range\n\nSet myTableRange = Range(\"D1:D314\")\n\nIf Intersect(Target, myTableRange) Is Nothing Then Exit Sub\n\nSet myDateTimeRage = Range(\"N\" &amp; Target.Row)\n\nSet myUpdatedRange = Range(\"O\" &amp; Target.Row)\n\nIf myDateTimeRage.Value = \"\" Then\n\n    myDateTimeRage.Value = Now\nEnd If\n\nmyUpdatedRange.Value = Now\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "foreach", "nested-loops"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574797832, "post_id": 59058370, "comment_id": 104356165, "body": "What do you mean with loops back through cells on the same sheet a second time? That part is not very clear. It loops all sheets. However you haven&#39;t fully declared: <code>Range(Cell.Address) = &quot;Yes&quot;</code> which references the <code>ActiveSheet</code>. Is that what you meant? Then change to <code>.Range(Cell.Address) = &quot;Yes&quot;</code>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1574798037, "post_id": 59058370, "comment_id": 104356257, "body": "Also, you set your range outside your loop. You want to refer to all these sheets their own rng and rngError i suppose. Since you loop through each sheet you don&#39;t have to set sht outside your loop."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1574798138, "post_id": 59058370, "comment_id": 104356309, "body": "<code>Set rng</code> <i>inside</i> your loop"}, {"owner": {"reputation": 45, "user_id": 12203043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a195f23264bea1789d667bc731abad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan S", "link": "https://stackoverflow.com/users/12203043/ryan-s"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574802065, "post_id": 59058370, "comment_id": 104357998, "body": "@JvdV. this resulted in a Complie Error &quot;invalid or unqualified Reference&quot;  To expand on what I meant in my explanation, the msg box goes through and lets me change the cell to yes/no for all the cells with errors, but then it starts going back through those same cells i just changed as if there were still an error there and asks me to select yes/no again."}, {"owner": {"reputation": 45, "user_id": 12203043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a195f23264bea1789d667bc731abad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan S", "link": "https://stackoverflow.com/users/12203043/ryan-s"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574802196, "post_id": 59058370, "comment_id": 104358058, "body": "@Cybernetic.nomad, I put the range inside the loop and it started with the errors (like it should) and then started going through each cell in the sheet asking me to change it to yes/no."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 12203043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a195f23264bea1789d667bc731abad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan S", "link": "https://stackoverflow.com/users/12203043/ryan-s"}, "edited": false, "score": 0, "creation_date": 1575294887, "post_id": 59059403, "comment_id": 104507464, "body": "Hi Nakul, thanks for trying! This code works on a single sheet but doesn&#39;t loop through the sheets."}], "tags": [], "owner": {"reputation": 1, "user_id": 12440706, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBhYqPVhQ52Twjm7jnNfLNNPo2M1R0GQx1a6LWU=k-s128", "display_name": "Nakul Sanyashi", "link": "https://stackoverflow.com/users/12440706/nakul-sanyashi"}, "is_accepted": false, "score": 0, "last_activity_date": 1574802805, "creation_date": 1574802805, "answer_id": 59059403, "question_id": 59058370, "link": "https://stackoverflow.com/questions/59058370/nested-for-each-with-msgbox/59059403#59059403", "title": "Nested For Each with msgbox", "body": "<p>Try this -</p>\n\n<pre><code>Sub test()\nOn Error Resume Next\nDim rng As Range\nDim rngError As Range\nDim Sht As Worksheet\n\nSet Sht = Sheets(\"Sheet2\")\nSet rng = Sht.Range(\"A1:N2000\")\n\nGoTo lable\n\nlable:\nSet rngError = rng.SpecialCells(xlCellTypeFormulas, xlErrors)\n\nFor Each Sht In ActiveWorkbook.Worksheets\n\n    If (Not rngError Is Nothing) Then\n      If rngError &lt;&gt; \"Yes\" And rngError &lt;&gt; \"No\" Then\n        For Each Cell In rngError\n            Answer = MsgBox(\"message in the box\", vbQuestion + vbYesNo + vbDefaultButton2, \"Name Change Check\")\n                If Answer = vbYes Then\n                      Range(Cell.Address) = \"Yes\"\n                Else\n                      Range(Cell.Address) = \"No\"\n                End If\n                rngError = Nothing\n        GoTo lable\n        Next Cell\n          End If\n    End If\n\nNext Sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 12203043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a195f23264bea1789d667bc731abad32?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan S", "link": "https://stackoverflow.com/users/12203043/ryan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574802805, "creation_date": 1574797529, "question_id": 59058370, "link": "https://stackoverflow.com/questions/59058370/nested-for-each-with-msgbox", "title": "Nested For Each with msgbox", "body": "<p>Goal: Search each cell of each sheet in the workbook to see if there is an error. If there is an error, a msgbox pops and gives you the ability to change the cell from the error to either \"Yes\" or \"No\".</p>\n\n<p>Problem: \nInstead of looping through the sheets it loops back through the cells on the same sheet a second time.<br>\nI tried moving the final End If after Next Sht but it came up with a compile Error \"Next Without For\".</p>\n\n<p>I also know from other reading it is not good to use a Cell reference in the Next Cell, and realize this may be the issue, but I am not sure how to correct it.  </p>\n\n<pre><code>Sub test()\nOn Error Resume Next\nDim rng As Range\nDim rngError As Range\nDim Sht As Worksheet\n\nSet Sht = Sheets(\"Sheet1\")\nSet rng = Sht.Range(\"A1:N2000\")\nSet rngError = rng.SpecialCells(xlCellTypeFormulas, xlErrors)\n\nFor Each Sht In ActiveWorkbook.Worksheets\n\n    If Not rngError Is Nothing Then\n        For Each Cell In rngError\n            Answer = MsgBox(\"message in the box\", vbQuestion + vbYesNo + vbDefaultButton2, \"Name Change Check\")\n                If Answer = vbYes Then\n                      Range(Cell.Address) = \"Yes\"\n                Else\n                      Range(Cell.Address) = \"No\"\n                End If\n        Next Cell\n    End If\n\nNext Sht\n\nEnd Sub\n</code></pre>\n\n<p>As a side note, the below part of the code works perfectly on its own. Its only when I added the nested loop that it went haywire. </p>\n\n<pre><code>If Not rngError Is Nothing Then\n    For Each Cell In rngError\n        Answer = MsgBox(\"message in the box\", vbQuestion + vbYesNo + vbDefaultButton2, \"Name Change Check\")\n            If Answer = vbYes Then\n                  Range(Cell.Address) = \"Yes\"\n            Else\n                  Range(Cell.Address) = \"No\"\n            End If\n    Next Cell\n</code></pre>\n"}, {"tags": ["python", "excel", "vba", "filter", "win32com"], "comments": [{"owner": {"reputation": 138, "user_id": 7364668, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/amHYW.jpg?s=128&g=1", "display_name": "Sha", "link": "https://stackoverflow.com/users/7364668/sha"}, "edited": false, "score": 1, "creation_date": 1574798186, "post_id": 59057946, "comment_id": 104356338, "body": "better you put some example with the excel sheet and it&#39;s easy anyone to understand better your question"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10559489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcbc7d4f17867ee488cc6ba46321608b?s=128&d=identicon&r=PG&f=1", "display_name": "pav", "link": "https://stackoverflow.com/users/10559489/pav"}, "edited": false, "score": 0, "creation_date": 1575557569, "post_id": 59067537, "comment_id": 104613493, "body": "I ended up just writing a macro that uses the parameters passed from python and filters. Thank you!"}], "tags": [], "owner": {"reputation": 311, "user_id": 12188100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11d40878af10139c21d72589b3c6b49b?s=128&d=identicon&r=PG&f=1", "display_name": "tst", "link": "https://stackoverflow.com/users/12188100/tst"}, "is_accepted": false, "score": 0, "last_activity_date": 1574848835, "creation_date": 1574848835, "answer_id": 59067537, "question_id": 59057946, "link": "https://stackoverflow.com/questions/59057946/how-to-filter-in-excel-using-python/59067537#59067537", "title": "How to filter in Excel using Python?", "body": "<p>I recently wrote a Python script to automate Macros. Basically, the idea was to batch-edit a collection of .doc files and have a macro run for all of them, without having to open them one by one.</p>\n\n<p>First:\nWhat is this macro you want to run? \nSecond: \nWhat is the data that you need to make visible, and what do you mean by that?</p>\n\n<p>To get you started, try this:</p>\n\n<pre><code>data = [{\"test1\": 1, \"test2\": 2}, {\"test1\": 3, \"test2\": 4}]\n\nimport win32com.client as win32\ndef openExcel():\n\n    xl = win32.gencache.EnsureDispatch('Excel.Application')\n    wb = xl.Workbooks.Add()\n    #wb = xl.Workbooks.Open(filepath)\n    ws = wb.Sheets(1) #The worksheet you want to edit later\n    xl.Visible = True\n\n    return ws\n\ndef print2Excel(datapoint:dict, ws):\n    print(datapoint)\n\n    const = win32.constants #.Insert()-Methods keywargs are packaged into const.\n    ws.Range(\"A1:B1\").Insert(const.xlShiftDown, const.xlFormatFromRightOrBelow)\n    ws.Cells(1,1).Value = datapoint[\"test1\"]\n    ws.Cells(1,2).Value = datapoint[\"test2\"]\n\nws = openExcel() #&lt;- When using Open(filepath), pass the whole filepath, starting at C:\\ or whatever drive.\nfor datapoint in data:\n    print2Excel(datapoint, ws)\n</code></pre>\n\n<p>This showcases some of the basics on how to work with Excel objects in win32com</p>\n"}], "owner": {"reputation": 35, "user_id": 10559489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcbc7d4f17867ee488cc6ba46321608b?s=128&d=identicon&r=PG&f=1", "display_name": "pav", "link": "https://stackoverflow.com/users/10559489/pav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1582235275, "creation_date": 1574795669, "last_edit_date": 1582235275, "question_id": 59057946, "link": "https://stackoverflow.com/questions/59057946/how-to-filter-in-excel-using-python", "title": "How to filter in Excel using Python?", "body": "<p>I am trying to automate a macro-enabled Excel workbook process using Python. I would like to use <code>win32com</code> if possible but am open to switching to other libraries if needed.</p>\n\n<p>Once I get the workbook open and on the sheet I need, there is data already there with auto-filters applied. I just need to filter on a column to make the data available to the macro when I run it.</p>\n\n<p>I use <code>wb.RefreshAll()</code> to import the data from existing connections. Eventually I will need to pass a value entered by the user to the filter as it will be different each time the automation runs.</p>\n\n<p>Most solutions involve copying select data to a Pandas DataFrame etc. but I need the filtered data to remain in the sheet so it can be used by the macro.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1574794244, "post_id": 59057597, "comment_id": 104354604, "body": "<code>Range(&quot;D4:D7&quot;).Formula = &quot;=D97&quot;</code>. <code>Range(&quot;D10:D13&quot;).Formula = &quot;=D103&quot;</code>. You can write a formula to an entire range, and Excel will update the relative references. So you can probably simplify whatever you&#39;re doing with other columns."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1574794689, "post_id": 59057597, "comment_id": 104354794, "body": "In fact, if you need multiple columns to do the same, eg: <code>Range(&quot;D4:D7,F4:F7,H4:H7.....etc....&quot;).Formula = &quot;=D97&quot;</code> Either way, iterating over <code>Range</code> objects is slow. So you might want to ask the question &quot;Do I need the formulas?&quot;. If the answer is no, then you might want to work through memory which is faster."}, {"owner": {"reputation": 11, "user_id": 12440187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dca5c37ea076331f616dd9f5f3d8d75?s=128&d=identicon&r=PG&f=1", "display_name": "Yunaa", "link": "https://stackoverflow.com/users/12440187/yunaa"}, "edited": false, "score": 0, "creation_date": 1574796735, "post_id": 59057597, "comment_id": 104355673, "body": "Cool, that&#39;s good to know, updated the above to simplify as only 3 lines of ranges instead of the plethora it was. I believe it reduced the run time a little, seems to be ~19s to run, so helped. Thanks"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1574797032, "post_id": 59057597, "comment_id": 104355804, "body": "It would help your efforts to speed up your code if you use <code>Timer</code> and put some <code>Debug.Print</code> statements in your code to find out where the most time is being taken"}, {"owner": {"reputation": 11, "user_id": 12440187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dca5c37ea076331f616dd9f5f3d8d75?s=128&d=identicon&r=PG&f=1", "display_name": "Yunaa", "link": "https://stackoverflow.com/users/12440187/yunaa"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1574800141, "post_id": 59057597, "comment_id": 104357161, "body": "Thanks @TimWilliams, that was super helpful. Found an error with my <code>Call OptimizeCode_End</code> part of it that I likely would not have found otherwise. So that shaved 9s off where it was erroring in the background. The brunt is the opening of the workbooks, 1 in particular since it&#39;s a large file with the budgeting information for every account which takes ~6s to open."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1574807749, "post_id": 59057597, "comment_id": 104360137, "body": "I have found when you declare variables and the order in which you use them can impact the time a macro takes to run."}, {"owner": {"reputation": 11, "user_id": 12440187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dca5c37ea076331f616dd9f5f3d8d75?s=128&d=identicon&r=PG&f=1", "display_name": "Yunaa", "link": "https://stackoverflow.com/users/12440187/yunaa"}, "edited": false, "score": 0, "creation_date": 1574808110, "post_id": 59057597, "comment_id": 104360245, "body": "I see, the order I use is <code>Sub OptimizeCode_Begin()      Application.ScreenUpdating = False     Application.DisplayAlerts = False     Application.AskToUpdateLinks = False     ActiveSheet.DisplayPageBreaks = False  End Sub</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12440187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dca5c37ea076331f616dd9f5f3d8d75?s=128&d=identicon&r=PG&f=1", "display_name": "Yunaa", "link": "https://stackoverflow.com/users/12440187/yunaa"}, "is_accepted": true, "score": 1, "last_activity_date": 1574811631, "creation_date": 1574811631, "answer_id": 59060986, "question_id": 59057597, "link": "https://stackoverflow.com/questions/59057597/speeding-up-this-code-opening-workbooks/59060986#59060986", "title": "Speeding up this code (opening workbooks)", "body": "<p>Looks like 1 quickfire way to speed this up by a decent margin was to change the other workbook files to binary .xlsb which reduced the load time of these files to a third of what they were.</p>\n"}], "owner": {"reputation": 11, "user_id": 12440187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dca5c37ea076331f616dd9f5f3d8d75?s=128&d=identicon&r=PG&f=1", "display_name": "Yunaa", "link": "https://stackoverflow.com/users/12440187/yunaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 59060986, "answer_count": 1, "score": 0, "last_activity_date": 1574811631, "creation_date": 1574794155, "last_edit_date": 1574806697, "question_id": 59057597, "link": "https://stackoverflow.com/questions/59057597/speeding-up-this-code-opening-workbooks", "title": "Speeding up this code (opening workbooks)", "body": "<p>I've been trying to speed up this code as it's currently taking ~22 seconds to run and i'm sure it can be done much smarter than i'm able to with my current level of ability.</p>\n\n<p>I'm confident the delay is being caused by opening the other workbooks, so just trying to figure out how to smarten this process up.</p>\n\n<p>Basically I have 60 versions of this spreadsheet (1 for each department) using this code to update the data when the datasheet is generated through BisTalk each morning, this to supply departments with an up to date forecast of their wage spend.</p>\n\n<p>It opens these sheets in order to refresh the data in the document (essentially only needs to open and then close these 3 workbooks), so changes made can be done from 1 workbook and flow through all 60 of these workbooks when departments open the doc and run the update button performing the below macro.</p>\n\n<p>Edit: Using methods below and using timers all the time is coming from opening wb3 (6.8s) &amp; wb5 (5.8s). So if I can somehow speed those up it would have a massive effect, the remainder of the macro takes 3.25s to process.</p>\n\n<pre><code>Public CalcState As Long\nPublic EventState As Boolean\nPublic PageBreakState As Boolean\n\nSub OptimizeCode_Begin()\n\nApplication.ScreenUpdating = False\n\nEventState = Application.EnableEvents\nApplication.EnableEvents = False\n\nCalcState = Application.Calculation\nApplication.Calculation = xlCalculationManual\n\nPageBreakState = ActiveSheet.DisplayPageBreaks\nActiveSheet.DisplayPageBreaks = False\n\nEnd Sub\n\nSub OptimizeCode_End()\n\nActiveSheet.DisplayPageBreaks = PageBreakState\nApplication.Calculation = CalcState\nApplication.EnableEvents = EventState\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\nSub UpdateForecaster()\n\n' UpdateForecaster\n' *************************************\n\n' Blocking the ability to pause macro due to sensitive information\n    Application.EnableCancelKey = xlDisabled\n\n'Optimize Code\n  Call OptimizeCode_Begin\n\n\nDim Main As Workbook\nSet Main = ActiveWorkbook\nDim wb2 As Workbook\nDim wb3 As Workbook\nDim wb4 As Workbook\nDim wb5 As Workbook\n\n'Opening Data Sheets\n    Set wb2 = Workbooks.Open(\"Sheet with the workbook paths, so can easily be updated within rather than updating the code on the 60 versions of this document for each store\", ReadOnly:=True)\nDim directory1 As String\nDim directory2 As String\n    directory1 = Worksheets(\"Sheet1\").Range(\"A2\").Value\n    directory2 = Worksheets(\"Sheet1\").Range(\"A4\").Value\n\n    Set wb3 = Workbooks.Open(directory1, ReadOnly:=True, Password:=\"password\")\n    Set wb4 = Workbooks.Open(directory2, ReadOnly:=True)\n    Set wb5 = Workbooks.Open(Filename:= _\n    \"datasheet\", ReadOnly:=True, Password:=\"password\")\n    wb5.Close\n    Main.Activate\n\n'Refreshing Cell Information\n    Range(\"D4\").Formula = \"=d97\"\n    Range(\"D5\").Formula = \"=d98\"\n    Range(\"D6\").Formula = \"=d99\"\n    Range(\"D7\").Formula = \"=d100\"\n    Range(\"D10\").Formula = \"=d103\"\n    Range(\"D11\").Formula = \"=d104\"\n    Range(\"D12\").Formula = \"=d105\"\n    Range(\"D13\").Formula = \"=d106\"\n\n    ('Same as above across other columns to refresh')              \n\n    ' Close Workbooks\n    wb3.Close False\n    wb4.Close False\n    wb2.Close False\n\n'Optimize Code\n  Call OptimizeCode_End\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "query-variables"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1574797746, "post_id": 59057464, "comment_id": 104356127, "body": "Is the db local(to the workbook) or on a server?  Have you tried ScreenUpdating = False? Including the where criteria in the CommandText?"}, {"owner": {"reputation": 21, "user_id": 1434902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a86e7148919fe7d83dcb0299b9dc4e1a?s=128&d=identicon&r=PG", "display_name": "vicx", "link": "https://stackoverflow.com/users/1434902/vicx"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1574813086, "post_id": 59057464, "comment_id": 104361629, "body": "hi. the issue is here source and criteria ActiveWorkbook.Queries.Add Name:=&quot;customers Materials&quot;, Formula:= _     &quot;let&quot; &amp; Chr(13) &amp; &quot;&quot; &amp; Chr(10) &amp; &quot;    Source = Access.Database(File.Contents(macroWB &amp; &quot;&quot;\\Database2.accdb&quot;&quot;), [CreateNavigationProperties=true]),&quot; &amp; Chr(13) &amp; &quot;&quot; &amp; Chr(10) &amp; &quot;    #&quot;&quot;_customers Materials&quot;&quot; = Source{[Schema=&quot;&quot;&quot;&quot;,Item=&quot;&quot;customers Materials&quot;&quot;]}[Data],&quot; &amp; Chr(13) &amp; &quot;&quot; &amp; Chr(10) &amp; &quot;    #&quot;&quot;Filtered Rows&quot;&quot; = Table.SelectRows(#&quot;&quot;_customers Materials&quot;&quot;, each ([Cutomername] = cust))&quot; &amp; Chr(13) &amp; &quot;&quot; &amp; Chr(10) &amp; &quot;in&quot; &amp; Chr(13) &amp; &quot;&quot; &amp; Chr(10) &amp; &quot;    #&quot;&quot;Filtered Rows&quot;&quot;&quot;"}], "owner": {"reputation": 21, "user_id": 1434902, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a86e7148919fe7d83dcb0299b9dc4e1a?s=128&d=identicon&r=PG", "display_name": "vicx", "link": "https://stackoverflow.com/users/1434902/vicx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574794288, "creation_date": 1574793582, "last_edit_date": 1574794288, "question_id": 59057464, "link": "https://stackoverflow.com/questions/59057464/import-access-db-in-excel-using-a-query-with-variables", "title": "Import access db in excel using a query with variables", "body": "<p>I have an issue trying to import access db through a query , but using variables\nvariables are macroWB and cust\nmacroWB refers to filepath\ncust refers to selected customer name\nVBA code works with fixed values\nAlso please advice if there are a more professional(faster) approach</p>\n\n<pre><code>On Error Resume Next\nSheets(\"db\").Delete\nOn Error GoTo 0\n\nDim pq As Object\n  For Each pq In ThisWorkbook.Queries\n    pq.Delete\n  Next\n\nDim macroWB As String\nmacroWB = ThisWorkbook.Path\ncust = Sheets(\"pre-filter\").Range(\"C5\").Value\n\nActiveWorkbook.Queries.Add Name:=\"customers Materials\", Formula:= _\n    \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Source = Access.Database(File.Contents(macroWB &amp; \"\"\\Database2.accdb\"\"), [CreateNavigationProperties=true]),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"_customers Materials\"\" = Source{[Schema=\"\"\"\",Item=\"\"customers Materials\"\"]}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Filtered Rows\"\" = Table.SelectRows(#\"\"_customers Materials\"\", each ([Cutomername] = cust))\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Filtered Rows\"\"\"\nSheets.Add After:=ActiveSheet\nWith ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n    \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=\"\"customers Materials\"\";Extended Properties=\"\"\"\"\" _\n    , Destination:=Range(\"$A$1\")).QueryTable\n    .CommandType = xlCmdSql\n    .CommandText = Array(\"SELECT * FROM [customers Materials]\")\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .PreserveColumnInfo = False\n    .ListObject.DisplayName = \"customers_Materials\"\n    .Refresh BackgroundQuery:=False\nEnd With\nSelection.ListObject.QueryTable.Refresh BackgroundQuery:=False\nRange(\"customers_Materials[[#Headers],[Cutomername]]\").Select\n\nActiveSheet.Name = \"db\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1574793612, "post_id": 59057452, "comment_id": 104354303, "body": "Add a new variable: <code>Dim FileName</code>, then immediately delete, to &quot;fix&quot; the capitalization. But as far as your other question, we&#39;d need more detail (i.e. the code in question that is &quot;ignored&quot;). Otherwise we really can&#39;t help."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574793645, "post_id": 59057452, "comment_id": 104354314, "body": "If the capitalization changes then some where you have declared that as a variable,sub,function,module,..."}, {"owner": {"reputation": 9, "user_id": 12411425, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212254591239996/picture?type=large", "display_name": "Bill Littlejohn", "link": "https://stackoverflow.com/users/12411425/bill-littlejohn"}, "edited": false, "score": 0, "creation_date": 1574800684, "post_id": 59057452, "comment_id": 104357406, "body": "The code when using F8 to step through seems to skip over this section... See above"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1574800798, "post_id": 59057452, "comment_id": 104357469, "body": "If make the code less &#39;sloppy&#39;, with proper indenting, issues may become more apparent."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 12411425, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212254591239996/picture?type=large", "display_name": "Bill Littlejohn", "link": "https://stackoverflow.com/users/12411425/bill-littlejohn"}, "is_accepted": false, "score": 0, "last_activity_date": 1574801600, "creation_date": 1574801600, "answer_id": 59059183, "question_id": 59057452, "link": "https://stackoverflow.com/questions/59057452/excel-ignoring-code-that-works-in-other-workbooks/59059183#59059183", "title": "Excel ignoring code that works in other workbooks", "body": "<p>It appears that the order of the tabs was the issue. I noticed  that <code>Lastrow = Sourcewb.Sheets(1).Cells(Sourcewb.Sheets(1).Rows.Count, \"A\").End(xlUp).Row</code> </p>\n\n<p>Lastrow = 0.</p>\n\n<p>I moved the front 2 tabs which had no data to the end of the tabs and it works.</p>\n\n<p>Otherwise, for whatever reason, it would find zero as the last row and simply skip to the end.</p>\n"}], "owner": {"reputation": 9, "user_id": 12411425, "user_type": "registered", "profile_image": "https://graph.facebook.com/10212254591239996/picture?type=large", "display_name": "Bill Littlejohn", "link": "https://stackoverflow.com/users/12411425/bill-littlejohn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574801600, "creation_date": 1574793534, "last_edit_date": 1574801042, "question_id": 59057452, "link": "https://stackoverflow.com/questions/59057452/excel-ignoring-code-that-works-in-other-workbooks", "title": "Excel ignoring code that works in other workbooks", "body": "<p>I have code that runs in several other workbooks but seems to be ignored in a specific one.</p>\n\n<p>The only difference I can see between the ones that work and the one that doesn't, is a line that has <code>SaveAs Filename:</code> vs <code>SaveAs FileName:</code>. Somehow I cannot imagine that would cause the whole script to be ignored but??</p>\n\n<p>The other thing is when I attempt to change the code from <code>Filename</code> to <code>FileName</code>, excel changes it back as soon as I go to the next line.</p>\n\n<p>Corrupt file? </p>\n\n<p>Apologies for the sloppy code... :(</p>\n\n<pre><code>```Sub Create_Individual_Files()\n\nApplication.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n    Application.DisplayAlerts = False\n\n\n\n\n    Dim i               As Integer\n    Dim x               As String\n    Dim Lastrow         As Long\n    Dim NewBook         As Workbook\n    Dim Sourcewb        As Workbook: Set Sourcewb = ThisWorkbook\n    Dim FileExtStr      As String\n    Dim FileFormatNum   As Long\n    Dim FName           As String\n    Dim Fpath           As String\n    Dim FName2          As String\n\n        Fpath = Sheets(\"Variables\").Range(\"B1\").Text\n        FName = Sheets(\"Variables\").Range(\"B9\").Text\n        FName2 = Sheets(\"Variables\").Range(\"B2\").Text\n\n    'Find the last row of data in each  tab.\n    Lastrow = Sourcewb.Sheets(1).Cells(Sourcewb.Sheets(1).Rows.Count, \"A\").End(xlUp).Row\n\n\n    'This section creates each new file, retaining all formulas, from the existing tabs in the master workbook. Then saves the file with the individuals name.\n    For i = 2 To Lastrow\n        x = Sourcewb.Sheets(1).Range(\"A\" &amp; i).Value\n        Sourcewb.Sheets(Array(\"Summary\", \"Pivot\", \"Data\", \"Modifier %\", \"Modifier Dollar\", \"Variables\")).Copy\n        Set NewBook = ActiveWorkbook\n        FileExtStr = \".xlsx\": FileFormatNum = 51\n        With NewBook\n            .SaveAs Filename:=Fpath &amp; FName2 &amp; \"-\" &amp; x &amp; FName &amp; \".xlsx\"\n            '.Close False\n\n\n        End With\n\n\n\n    ''''''''''''''''''''''''''''''''''''''''''''\n    'The section below deletes data from each tab that is not specific to the individual.\n\n    Sheets(\"Variables\").Select\n'    Range(\"C5\").Select\n'    Selection.Copy\n    Range(\"B10\").Select\n    ActiveCell.FormulaR1C1 = x\n'    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n'        :=False, Transpose:=False\n        Sheets(\"Summary\").Select\n    Call Loop_Delete_Summary\n        Sheets(\"Data\").Select\n        ActiveSheet.ListObjects(1).Unlist\n    Call Loop_Delete_Summary\n        Sheets(\"Modifier %\").Select\n        ActiveWorkbook.ActiveSheet.ListObjects(1).Unlist\n    Call Delete_Modifier_Percent\n        Sheets(\"Modifier Dollar\").Select\n        ActiveSheet.ListObjects(1).Unlist\n    Call Loop_Delete_Summary\n        'Sheets(\"Controls\").Select\n        Sheets(\"Variables\").Select\n    ActiveWindow.SelectedSheets.Delete\n    Call ResetCursor\n\n\n    ''''''''''''''''''''''''''''''''''''''''''''\n         Next i\n\n\n\n        ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n\n  Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n    Application.DisplayAlerts = True\n\n\nEnd Sub```\n\n\n\n\n\n\n\n```Sub Loop_Delete_Summary()\n\n    Dim Firstrow As Long\n    Dim Lastrow As Long\n    Dim Lrow As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n    Dim rng As Range\n\n\n\n\n    With ActiveSheet\n\n\n        .Select\n\n        ViewMode = ActiveWindow.View\n        ActiveWindow.View = xlNormalView\n\n\n        'Set the first and last row to loop through\n        Firstrow = .UsedRange.Offset(1).Row\n        Lastrow = .UsedRange.Rows(.UsedRange.Rows.Count).Row\n\n        'Loop from Lastrow to Firstrow (bottom to top)\n        For Lrow = Lastrow To Firstrow Step -1\n\n            'Check the values in the A column\n            With .Cells(Lrow, \"A\")\n\n                If Not IsError(.Value) Then\n\n                    If .Value &lt;&gt; Worksheets(\"Variables\").Range(\"B10\") Then\n\n\n                        If rng Is Nothing Then\n                            Set rng = .Cells\n                        Else\n                            Set rng = Application.Union(rng, .Cells)\n                        End If\n                    End If\n\n                End If\n            End With\n\n        Next Lrow\n\n    End With\n\n    'Delete all rows at once\n    If Not rng Is Nothing Then rng.EntireRow.Delete\n\n    ActiveWindow.View = ViewMode\n    With Application\n        .ScreenUpdating = True\n        .Calculation = CalcMode\n    End With\n\n\n\n\nEnd Sub```\n\n\n\n\n\n\n\n```Sub Loop_Delete_Modifier_Percent()\n    Dim Firstrow As Long\n    Dim Lastrow As Long\n    Dim Lrow As Long\n    Dim CalcMode As Long\n    Dim ViewMode As Long\n\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n    End With\n\n    'We use the ActiveSheet but you can replace this with\n    'Sheets(\"MySheet\")if you want\n    With ActiveSheet\n\n        'We select the sheet so we can change the window view\n        .Select\n\n        'If you are in Page Break Preview Or Page Layout view go\n        'back to normal view, we do this for speed\n        ViewMode = ActiveWindow.View\n        ActiveWindow.View = xlNormalView\n\n        'Turn off Page Breaks, we do this for speed\n        .DisplayPageBreaks = False\n\n        'Set the first and last row to loop through\n        Firstrow = 2\n        Lastrow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        'We loop from Lastrow to Firstrow (bottom to top)\n        For Lrow = Lastrow To Firstrow Step -1\n\n            'We check the values in the A column in this example\n            With .Cells(Lrow, \"B\")\n\n                If Not IsError(.Value) Then\n\nSelect Case .Value\nCase Is &lt;&gt; Worksheets(\"Variables\").Range(\"B10\").Value: .EntireRow.Delete\nEnd Select\n\n                End If\n\n            End With\n\n        Next Lrow\n\n    End With\n\n    ActiveWindow.View = ViewMode\n    With Application\n        .ScreenUpdating = True\n        .Calculation = CalcMode\n    End With\nEnd Sub```\n</code></pre>\n\n<p>*****The code when using F8 to step through seems to skip over this section...*****</p>\n\n<pre><code>``` x = Sourcewb.Sheets(1).Range(\"A\" &amp; i).Value\n        Sourcewb.Sheets(Array(\"Summary\", \"Pivot\", \"Data\", \"Modifier %\", \"Modifier Dollar\", \"Variables\")).Copy\n        Set NewBook = ActiveWorkbook\n        FileExtStr = \".xlsx\": FileFormatNum = 51\n        With NewBook\n            .SaveAs Filename:=Fpath &amp; FName2 &amp; \"-\" &amp; x &amp; FName &amp; \".xlsx\"\n            '.Close False\n\n\n        End With\n\n\n   Sheets(\"Variables\").Select\n'    Range(\"C5\").Select\n'    Selection.Copy\n    Range(\"B10\").Select\n    ActiveCell.FormulaR1C1 = x\n'    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n'        :=False, Transpose:=False\n        Sheets(\"Summary\").Select\n    Call Loop_Delete_Summary\n        Sheets(\"Data\").Select\n        ActiveSheet.ListObjects(1).Unlist\n    Call Loop_Delete_Summary\n        Sheets(\"Modifier %\").Select\n        ActiveWorkbook.ActiveSheet.ListObjects(1).Unlist\n    Call Delete_Modifier_Percent\n        Sheets(\"Modifier Dollar\").Select\n        ActiveSheet.ListObjects(1).Unlist\n    Call Loop_Delete_Summary\n        'Sheets(\"Controls\").Select\n        Sheets(\"Variables\").Select\n    ActiveWindow.SelectedSheets.Delete\n    Call ResetCursor\n\n\n         Next i```\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574789060, "post_id": 59056299, "comment_id": 104352140, "body": "What&#39;s the value of <code>F1</code>?"}, {"owner": {"reputation": 13, "user_id": 11428712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2108913182550179/picture?type=large", "display_name": "Jan Nik", "link": "https://stackoverflow.com/users/11428712/jan-nik"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574791664, "post_id": 59056299, "comment_id": 104353444, "body": "@braX: F1 is a number (starting at 1) that gets updated after an email is sent. The number is used to lookup the next company in a separate table that contains all the company names."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574791781, "post_id": 59056299, "comment_id": 104353503, "body": "I think it was @BigBen who asked that..."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574791908, "post_id": 59056299, "comment_id": 104353577, "body": "So <code>Range(&quot;F1&quot;).Value = Range(&quot;F1&quot;).Value + 1</code> causes a Type Mismatch error when <code>F1</code> = 1?"}, {"owner": {"reputation": 13, "user_id": 11428712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2108913182550179/picture?type=large", "display_name": "Jan Nik", "link": "https://stackoverflow.com/users/11428712/jan-nik"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574792155, "post_id": 59056299, "comment_id": 104353688, "body": "@BigBen, my bad. When skipping through the code with F8, Range(&quot;F1&quot;) gets highlighted, and then hitting F8 again causes Error &#39;13."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1574795718, "post_id": 59056299, "comment_id": 104355246, "body": "@JanNik What is in cell <code>F1</code> when you&#39;re attempting to add 1 to it? Let&#39;s say the word &quot;Test&quot; was in cell <code>F1</code> - then you&#39;re going to get a type mismatch when you try to add a number to a text value."}, {"owner": {"reputation": 13, "user_id": 11428712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2108913182550179/picture?type=large", "display_name": "Jan Nik", "link": "https://stackoverflow.com/users/11428712/jan-nik"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1574808275, "post_id": 59056299, "comment_id": 104360287, "body": "@dwirony F1 is always a number, so I don&#39;t think the mismatch can come from adding numbers and text. I usually start it at 0 so that during the first run through the code it goes to 1 and pulls the data in row 1 from the table."}], "owner": {"reputation": 13, "user_id": 11428712, "user_type": "registered", "profile_image": "https://graph.facebook.com/2108913182550179/picture?type=large", "display_name": "Jan Nik", "link": "https://stackoverflow.com/users/11428712/jan-nik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574788922, "creation_date": 1574788911, "last_edit_date": 1574788922, "question_id": 59056299, "link": "https://stackoverflow.com/questions/59056299/sending-emails-with-attachments-to-multiple-recipients", "title": "Sending Emails with Attachments to Multiple Recipients", "body": "<p>Alright, let me preface by saying that this is one of the first times that I've used VBA to automate something. I need to send out invoices (as a pdf) to a list of companies that subscribe to a newsletter; each company has between 1-50 emails that are subscribed. I am able to send out the invoices to each recipient individually, but I want to get it so that all subscribers from a company are in the Recipient section of the Outlook email. The idea is to have a pivot table that shows the list of subscribers which the email should be sent to. That list gets used as the recipients in the email. I think I can figure out how to get this going, but I am getting a </p>\n\n<blockquote>\n  <p>Run-time Error '13: Type Mismatch</p>\n</blockquote>\n\n<p>between the \"+1 to Lookup Cell\" step and the \"Set outlookapp = CreateObject\" step. Its frustrating because this is the exact code I used to send out the email individually, with the only modification thus far being the \"Add +1 to Lookup Cell\" step. Did a bit of research into Error'13 and couldnt figure it out, hoping someone can shed some light on this. Thanks!</p>\n\n<pre><code> Sub Send_Invoices()\n    Dim edress As String\n    Dim strfrom As String\n    Dim subj As String\n    Dim message As String\n    Dim filename As String\n    Dim filename2 As String\n    Dim outlookapp As Object\n    Dim outlookmailitem As Object\n    Dim myAttachments As Object\n    Dim path As String\n    Dim lastrow As Integer\n    Dim attachment As String\n    Dim attachment2 As String\n    Dim x As Integer\n    Dim wk As Worksheet\n\n'Define Worksheet\n    Set wk = Worksheets(\"Sending Invoices\")\n\n'Add +1 to the Lookup Cell\n    Do\n    Range(\"F1\").Value = Range(\"F1\").Value + 1\n\n\n    Set outlookapp = CreateObject(\"Outlook.Application\")\n    Set outlookmailitem = outlookapp.CreateItem(0)\n    Set myAttachments = outlookmailitem.Attachments\n        path = \"C:\\Users\\...\\Desktop\\...\\Invoices\\\"\n\n'Set the recipient address column\n    edress = wk.Cells(8, 12)\n    'Set the Subject\n    subj = \"12/1/2019: Annual Support for ...\"\n    'Set the filename and location of Invoice\n    filename = wk.Cells(2, 4)\n    attachment = wk.Cells(2, 6)\n\n    'Repeat for the Subscriber Lists\n    filename2 = wk.Cells(2, 5)\n    attachment2 = wk.Cells(2, 7)\n\n    outlookmailitem.To = edress\n    outlookmailitem.cc = \"\"\n    outlookmailitem.bcc = \"\"\n    outlookmailitem.Subject = subj\n    outlookmailitem.body = \"Dear ...\"\n\n              myAttachments.Add (attachment)\n              myAttachments.Add (attachment2)\n            'outlookmailitem.Display\n            outlookmailitem.send\n\n\n    lastrow = lastrow + 1\n    edress = \"\"\n    x = x + 1\n\n\n    Set outlookapp = Nothing\n    Set outlookmailitem = Nothing\n\n    Loop Until Range(\"F1\") &gt;= Range(\"F2\")\n\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 2, "creation_date": 1574788823, "post_id": 59056227, "comment_id": 104352029, "body": "Open Tools - References and have a look. Does it say MISSING anywhere?"}, {"owner": {"reputation": 1, "user_id": 12439693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4583f2d4288e5fdebdcf582a1552e9d1?s=128&d=identicon&r=PG&f=1", "display_name": "LargePetey", "link": "https://stackoverflow.com/users/12439693/largepetey"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1574795843, "post_id": 59056227, "comment_id": 104355297, "body": "The references option is unable to be selected within the VBA interface."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1574798232, "post_id": 59056227, "comment_id": 104356359, "body": "If that&#39;s the case, you are either editing a cell or have a macro running. Or something else that is blocking VBE. Try restarting Excel if you can&#39;t find out what."}, {"owner": {"reputation": 1, "user_id": 12439693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4583f2d4288e5fdebdcf582a1552e9d1?s=128&d=identicon&r=PG&f=1", "display_name": "LargePetey", "link": "https://stackoverflow.com/users/12439693/largepetey"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1574799515, "post_id": 59056227, "comment_id": 104356913, "body": "Opening the references menu, it doesn&#39;t say missing anywhere, darn!"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1574800180, "post_id": 59056227, "comment_id": 104357174, "body": "The same question, but for the 2010 machine."}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1574808014, "post_id": 59056227, "comment_id": 104360213, "body": "step thru the code.. what is the value of <code>i</code>?"}, {"owner": {"reputation": 1, "user_id": 12439693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4583f2d4288e5fdebdcf582a1552e9d1?s=128&d=identicon&r=PG&f=1", "display_name": "LargePetey", "link": "https://stackoverflow.com/users/12439693/largepetey"}, "edited": false, "score": 0, "creation_date": 1575385169, "post_id": 59056227, "comment_id": 104544113, "body": "How am I able to discern the value of i? I&#39;m unfamiliar with VBA so an explanation in layman&#39;s terms would be very helpful..."}], "owner": {"reputation": 1, "user_id": 12439693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4583f2d4288e5fdebdcf582a1552e9d1?s=128&d=identicon&r=PG&f=1", "display_name": "LargePetey", "link": "https://stackoverflow.com/users/12439693/largepetey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574788742, "creation_date": 1574788703, "last_edit_date": 1574788742, "question_id": 59056227, "link": "https://stackoverflow.com/questions/59056227/macro-in-excel-2016-but-gives-me-a-compile-error-in-excel-2010", "title": "Macro in Excel 2016 but gives me a compile error in Excel 2010", "body": "<p>I am running a macro that works on 2016, but when opened in 2010 throws up a compile error. The purpose of the macro is to export excel data into a pdf and attach it to a new email in outlook. </p>\n\n<p>The VBA code is below. The error that occurs is on line 18, =Left, I've put it in bold. </p>\n\n<p>I am somewhat new to VBA and I'm using a former colleagues macro, any help is appreciated!</p>\n\n<p>The problem in the code is below, the error that is highlighted is the Left function. I can post the entire macro if neccessary. </p>\n\n<pre><code>' Define PDF filename\nPdfFile = ActiveWorkbook.FullName\ni = InStrRev(PdfFile, \".\")\nIf i &gt; 1 Then PdfFile = Left(PdfFile, i - 1)\nPdfFile = PdfFile &amp; \".pdf\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "pull"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574788496, "post_id": 59056146, "comment_id": 104351871, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.getopenfilename\" rel=\"nofollow noreferrer\"><code>Application.GetOpenFilename</code></a> to get a filename to open?"}, {"owner": {"reputation": 3, "user_id": 12257463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1217bf4492290c6c49f4c35c92eb2a33?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar_Torres", "link": "https://stackoverflow.com/users/12257463/cesar-torres"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574789325, "post_id": 59056146, "comment_id": 104352285, "body": "@BigBen The problem is that the files are in shared networks"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574789377, "post_id": 59056146, "comment_id": 104352314, "body": "Shouldn&#39;t be a problem for getting their filename as already noted, and then opening them."}, {"owner": {"reputation": 3, "user_id": 12257463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1217bf4492290c6c49f4c35c92eb2a33?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar_Torres", "link": "https://stackoverflow.com/users/12257463/cesar-torres"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574789574, "post_id": 59056146, "comment_id": 104352414, "body": "@BigBen How could I modify the code for calling the data from the other workbook? Thanks"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574789714, "post_id": 59056146, "comment_id": 104352477, "body": "Taking a guess - here&#39;s the <a href=\"https://docs.microsoft.com/es-mx/office/vba/api/excel.application.getopenfilename\" rel=\"nofollow noreferrer\">documentation</a> in Spanish, if that&#39;s helpful."}, {"owner": {"reputation": 3, "user_id": 12257463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1217bf4492290c6c49f4c35c92eb2a33?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar_Torres", "link": "https://stackoverflow.com/users/12257463/cesar-torres"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574790041, "post_id": 59056146, "comment_id": 104352658, "body": "@BigBen Friend, it doesn&#39;t work, The InputRng stand in the workbook where the macro is"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574790148, "post_id": 59056146, "comment_id": 104352709, "body": "Can you <a href=\"https://stackoverflow.com/posts/59056146/edit\">edit</a> your question with how you&#39;ve tried to implement <code>Application.GetOpenFilename</code> or how you&#39;re opening/referencing those other workbooks?"}, {"owner": {"reputation": 3, "user_id": 12257463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1217bf4492290c6c49f4c35c92eb2a33?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar_Torres", "link": "https://stackoverflow.com/users/12257463/cesar-torres"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574795308, "post_id": 59056146, "comment_id": 104355086, "body": "@BigBen I can get data from other workbook with the variable source but the problem is if I do tha task with many workbooks"}, {"owner": {"reputation": 3, "user_id": 12257463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1217bf4492290c6c49f4c35c92eb2a33?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar_Torres", "link": "https://stackoverflow.com/users/12257463/cesar-torres"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1574796300, "post_id": 59056146, "comment_id": 104355498, "body": "@BigBen The idea is to be able to get data from whatever workbook"}], "owner": {"reputation": 3, "user_id": 12257463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1217bf4492290c6c49f4c35c92eb2a33?s=128&d=identicon&r=PG&f=1", "display_name": "Cesar_Torres", "link": "https://stackoverflow.com/users/12257463/cesar-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574795227, "creation_date": 1574788423, "last_edit_date": 1574795227, "question_id": 59056146, "link": "https://stackoverflow.com/questions/59056146/pull-data-from-different-workbooks-in-excel", "title": "Pull data from different workbooks in excel", "body": "<p>I'm trying to pull data from workbooks with different names with the  InputRng in VBA, the code works perfectly in the same workbook but I need to get the data from other many workbooks that have different names always.  Below is my code.</p>\n\n<pre><code>Sub CopyData()\n\n   Dim Rng As Range\n   Dim InputRng As Range, OutRng As Range\n   xTitleId = \"Administraci\u00f3n de insumos\"\n\n   Set InputRng = Application.Selection\n   Set InputRng = Application.InputBox(\"Rango :\", xTitleId, InputRng.Address, Type:=8)\n       InputRng.Copy\n\n   Workbooks(\"sh3\").Activate\n   Sheets(\"Hola\").Select\n   Application.Goto Reference:=\"R1C1\"\n   ActiveSheet.Paste\n\nEnd SUb\n</code></pre>\n\n<p>How can I get the data from the other workbooks with that function or if exists another way to do it</p>\n\n<p>Thanks a lot</p>\n\n<p>This is the line with Application.GetOpenFilename</p>\n\n<pre><code>Sub Macro1()\n\nDim source As Worksheet\n\n*ChDir \"\\\\pr0980nas\\bases 2010 2019\"*\nSet source = Workbooks(\"Libro4\").Sheets(1)\n\nfileToOpen = Application.GetOpenFilename(\"Files (*.xlsb), *.xlsb\")\n   Set InputRng = Application.Selection\n   Set InputRng = Application.InputBox(\"Seleccionar Rango :\", xTitleId, InputRng.Address, Type:=8)\n       InputRng.Copy\n\n   Workbooks(\"Libro4\").Activate\n   Sheets(\"Hola\").Select\n   Application.Goto Reference:=\"R1C1\"\n   ActiveSheet.Paste\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1574788604, "post_id": 59056105, "comment_id": 104351924, "body": "Paste over the range of cells, rather than to each individual cell.  That allows Excel to do its job and utilize the Fixed portions of the address.  No need to loop.\\"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "edited": false, "score": 0, "creation_date": 1574791607, "post_id": 59056408, "comment_id": 104353414, "body": "Interesting. Your solution using &#39;With Range(&quot;GapTable&quot;) does work, but it fills in an additional 20 rows of formulas, even though I only have 2 rows originally in the table (excluding the header). Not sure why this is happening, the .rows.count returns 2 when I step through it."}, {"owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "edited": false, "score": 0, "creation_date": 1574791834, "post_id": 59056408, "comment_id": 104353535, "body": "I think I know why..... the Range(Cells1(1,2) part doesn&#39;t reference the first row, second column of my &quot;GapTable&quot;, it&#39;s just Cell B1 on the sheet. Should this be happening with range(&quot;gaptable&quot;)?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "edited": false, "score": 1, "creation_date": 1574793326, "post_id": 59056408, "comment_id": 104354189, "body": "@Sudio Sorry, that <code>.</code> should be before that <code>.cells()</code> reference."}, {"owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "edited": false, "score": 0, "creation_date": 1574793602, "post_id": 59056408, "comment_id": 104354299, "body": "Thanks @Cyril, tested and it works great. Thanks for the assist"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 2, "last_activity_date": 1574793377, "last_edit_date": 1574793377, "creation_date": 1574789288, "answer_id": 59056408, "question_id": 59056105, "link": "https://stackoverflow.com/questions/59056105/looping-through-a-table-and-changing-formula/59056408#59056408", "title": "Looping through a table and changing formula", "body": "<p>As written in my comment, you can paste over the range, where the dynamic references are to the upper left cell, e.g.,</p>\n\n<pre><code>with Range(\"GapTable\")\n    .range(.cells(1,2),.cells(.Rows.Count,.Columns.Count)).Formula = \"=IFERROR(ROUND(AVERAGEIFS(prof_gap, series, $A21, grade, B$20),2), \"\"N/A\"\")\"\nend with\n</code></pre>\n\n<p>If you have to loop, you can use counters, e.g.:</p>\n\n<pre><code>dim colnum as long, rownum as long\nFor i = 1 To Range(\"GapTable\").Rows.Count\n    For i2 = 2 To Range(\"GapTable\").Columns.Count\n        Range(\"GapTable\").Cells(i, i2).Formula = \"=IFERROR(ROUND(AVERAGEIFS(prof_gap, series, $A\" &amp; rownum &amp; \", grade, \" &amp; cells(20,colnum).address &amp; \"),2), \"\"N/A\"\")\"\n        colnum = colnum + 1\n    Next i2\n    rownum = rownum + 1\nNext i    \n</code></pre>\n\n<p>Note that you have to convert the column number to an address, which is why the <code>cell()</code> reference includes the <code>20</code>.</p>\n\n<p>I did not include the error handling for resetting <code>rownum</code>/<code>colnum</code> to <em>reset</em> back to 20/2, respectively.  Just throwing out the concept if for some reason you can't just paste over the range.</p>\n\n<hr>\n\n<p><strong>Edit1:</strong> forgot the <code>.</code> in front of <code>cells(1,2)</code> in the <code>with</code>statement for pasting over a range.</p>\n"}], "owner": {"reputation": 101, "user_id": 10560279, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-wQzGnSqEnR8/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCnU-kGzjWDce6CKHogb6TgxMv8iw/mo/photo.jpg?sz=128", "display_name": "Sudio", "link": "https://stackoverflow.com/users/10560279/sudio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 59056408, "answer_count": 1, "score": 0, "last_activity_date": 1574793377, "creation_date": 1574788251, "question_id": 59056105, "link": "https://stackoverflow.com/questions/59056105/looping-through-a-table-and-changing-formula", "title": "Looping through a table and changing formula", "body": "<p>I've got a relatively small table (2-5 rows / 7-9 columns) that I'm trying to loop through and calculate values using .formula. I'm having some issues figuring out how I refer to the absolute values of the column or row of the cell that I'm on. Here's what I've hard-coded so far:</p>\n\n<pre><code>For i = 1 To Range(\"GapTable\").Rows.Count\n    For i2 = 2 To Range(\"GapTable\").Columns.Count\n        Range(\"GapTable\").Cells(i, i2).Formula = \"=IFERROR(ROUND(AVERAGEIFS(prof_gap, series, $A21, grade, B$20),2), \"\"N/A\"\")\"\n    Next i2\nNext i\n</code></pre>\n\n<p>I'm trying to figure out how to change $A21 to lock the column in as an absolute, and B$20 to lock the row in, with the formula copying to the adjacent cells correctly (the same as if you took the cursor and filled in the values). The code works now, but obviously the values are all the same. Any suggestions how I address this issue, or a better way of doing this?</p>\n"}, {"tags": ["vba", "ms-project"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 3157070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96126fd01fbb8d8771d27da9ac8aec7?s=128&d=identicon&r=PG&f=1", "display_name": "nanuuq", "link": "https://stackoverflow.com/users/3157070/nanuuq"}, "edited": false, "score": 0, "creation_date": 1578137868, "post_id": 59340705, "comment_id": 105346191, "body": "Sorry for the late answer: this is partly the way I tried in the meantime: User defined field with formula <code>IIf(([Start]&lt;=DateValue(&quot;21&#47;5&#47;202&quot;)) And ([End]&gt;=DateValue(&quot;21&#47;5&#47;202&quot;));&quot;YES&quot;;&quot;NO&quot;)</code> and then filter for &quot;YES&quot;. Looking into vba now and your link."}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1576375604, "creation_date": 1576375604, "answer_id": 59340705, "question_id": 59055880, "link": "https://stackoverflow.com/questions/59055880/find-the-tasks-where-there-is-a-certain-date-between-start-and-finish/59340705#59340705", "title": "Find the tasks, where there is a certain date between start and finish", "body": "<p>The trick to finding tasks that are running within a certain window of time is look for tasks that <em>start before the end of the window</em> <strong>AND</strong> <em>finish after the start of the window</em>.</p>\n\n<p>To find tasks that are running on 22 Mai 2021 (e.g. the window is one day), use this: <code>Start &lt; #22/5/2021# And Finish &gt;= #21/5/2021#</code>.</p>\n\n<p>This will find all four cases you want:</p>\n\n<ol>\n<li>Tasks that start before the window starts but finish during the window.</li>\n<li>Tasks that start during the window and finish after the window ends.</li>\n<li>Tasks that start and finish during the window.</li>\n<li>Tasks that start before the window starts and finish after the window ends.</li>\n</ol>\n\n<p>In this case you are looking for a window that is a single day, however this method works well for longer periods--for example, to find all tasks running in the next 90 days.</p>\n\n<p>Also see <a href=\"https://stackoverflow.com/questions/55156271/identifying-specific-resources-that-are-overallocated-in-ms-project-using-timesc/55169657#55169657\">this related question</a> with graphic illustrating 1-4.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 3157070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96126fd01fbb8d8771d27da9ac8aec7?s=128&d=identicon&r=PG&f=1", "display_name": "nanuuq", "link": "https://stackoverflow.com/users/3157070/nanuuq"}, "is_accepted": false, "score": 0, "last_activity_date": 1578218770, "creation_date": 1578218770, "answer_id": 59598761, "question_id": 59055880, "link": "https://stackoverflow.com/questions/59055880/find-the-tasks-where-there-is-a-certain-date-between-start-and-finish/59598761#59598761", "title": "Find the tasks, where there is a certain date between start and finish", "body": "<p>Finally, I found 3 ways of solving this:</p>\n\n<ol>\n<li>VBA and custom field with formula (fastest):\nThanks to <a href=\"https://stackoverflow.com/a/48754562/3157070\">https://stackoverflow.com/a/48754562/3157070</a></li>\n</ol>\n\n<pre><code>Sub DateFilter()\n\nDim dateString As String\nDim customFormula As String\n\ndateString = VBA.Interaction.InputBox(\"Date Input\", \"Date\", \"01/01/2020\")\n\n\ncustomFormula = \"IIf(([Start]&lt;=DateValue(\"\"\" &amp; dateString &amp; \"\"\")) And ([End]&gt;=DateValue(\"\"\" &amp; dateString &amp; \"\"\"));\"\"YES\"\";\"\"NO\"\")\"\n'Debug.Print customFormula\n\n'put it into custom field Text24\nCustomFieldSetFormula FieldID:=pjCustomTaskText24, Formula:=customFormula\nCustomFieldProperties FieldID:=pjCustomTaskText24, Attribute:=pjFieldAttributeFormula, SummaryCalc:=pjCalcNone, GraphicalIndicators:=False\n\n'Call custom filter\nFilterApply \"YES\"\nEnd Sub\n\n</code></pre>\n\n<ol start=\"2\">\n<li>Custom field with formula without vba:</li>\n</ol>\n\n<pre><code>IIf(([Start]&lt;=DateValue(\"7/14/2022\")) And ([End]&gt;=DateValue(\"7/14/2022\"));\"YES\";\"NO\")\n</code></pre>\n\n<ol start=\"3\">\n<li>VBA only (I don't know why, but takes several minutes for 4000 rows...):</li>\n</ol>\n\n<p>Thanks to <a href=\"https://stackoverflow.com/a/59340705/3157070\">https://stackoverflow.com/a/59340705/3157070</a></p>\n\n<pre><code>Sub DateFilter1()\n\nDim T As Task\nDim dateString As String\n\nApplication.ScreenUpdating = False\n\ndateString = VBA.Interaction.InputBox(\"Date Input\", \"Date\", \"01/01/2020\")\n\nFor Each T In ActiveProject.Tasks\n\n    If T.ScheduledStart &lt;= dateString And T.ScheduledFinish &gt;= dateString Then\n\n        T.Text24 = \"YES\"\n\n    Else\n        T.Text24 = \"NO\"\n\n    End If\nNext\n\nApplication.ScreenUpdating = True\nFilterApply \"YES\"\n\nEnd Sub\n\n</code></pre>\n\n<p>All of these solved my problem.\nPlease share your improvements.</p>\n"}], "owner": {"reputation": 81, "user_id": 3157070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c96126fd01fbb8d8771d27da9ac8aec7?s=128&d=identicon&r=PG&f=1", "display_name": "nanuuq", "link": "https://stackoverflow.com/users/3157070/nanuuq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1581410045, "creation_date": 1574787470, "last_edit_date": 1581410045, "question_id": 59055880, "link": "https://stackoverflow.com/questions/59055880/find-the-tasks-where-there-is-a-certain-date-between-start-and-finish", "title": "Find the tasks, where there is a certain date between start and finish", "body": "<p>I am trying to create a filter to find all tasks that are running on a certain day.</p>\n\n<pre><code>Task 1  10 M\u00e4rz 2021 08:00  23 April 2021 08:00\nTask 2  23 April 2021 08:00 26 Mai 2021 08:00\nTask 3  20 Mai 2021 08:00   26 Mai 2021 08:00\n</code></pre>\n\n<p>Search for 22. Mai 2021, should return Task 1 and Task 2 in the Gantt Chart.</p>\n\n<p>I have 4k+ rows, and I would like to see only these tasks.</p>\n\n<p>Could be filter, function or VBA.</p>\n\n<p>I am not getting it with the filters.</p>\n\n<p>I am familiar with Excel VBA, but new to MS Project.</p>\n"}, {"tags": ["excel", "vba", "optimization", "compare"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1574786664, "post_id": 59055651, "comment_id": 104350907, "body": "load the data into variant arrays and loop those, not ranges."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1574786709, "post_id": 59055651, "comment_id": 104350938, "body": "What&#39;s the <code>OptimizeCode_Begin</code> and <code>_End</code> code? Also, if you&#39;re looking to optimize, this might be a better question for <a href=\"https://codereview.stackexchange.com/\">CodeReview</a>"}, {"owner": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1574786843, "post_id": 59055651, "comment_id": 104351022, "body": "@BruceWayne -- I&#39;m guessing they&#39;re from here:  <a href=\"https://www.thespreadsheetguru.com/blog/2015/2/25/best-way-to-improve-vba-macro-performance-and-prevent-slow-code-execution\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2015/2/25/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 12439455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dbd710444f31a29179950e54ade6959?s=128&d=identicon&r=PG&f=1", "display_name": "bentleytrader", "link": "https://stackoverflow.com/users/12439455/bentleytrader"}, "reply_to_user": {"reputation": 30124, "user_id": 334849, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0f39fc02c4a24b3c4825dae3d850004a?s=128&d=identicon&r=PG", "display_name": "LittleBobbyTables - Au Revoir", "link": "https://stackoverflow.com/users/334849/littlebobbytables-au-revoir"}, "edited": false, "score": 0, "creation_date": 1574787106, "post_id": 59055651, "comment_id": 104351146, "body": "@LittleBobbyTables you are correct"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1574787399, "post_id": 59055651, "comment_id": 104351303, "body": "Every time one pierces the veil of the worksheet, either to read or write, it slows down the code.  This happens regardless if the screen updates are turned on or off.  Limit the number of times this happens and your code will run quickly.  to do this load everything that needs to be referenced into a variant array.  Create a variant array for the output.  Then iterate the data array putting the desired output in the output array.  Then put the output array data in the desired output range.  This limits the number of times the veil is pierced to two not hundreds."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1574787571, "post_id": 59055651, "comment_id": 104351395, "body": "These <code>Dim dumpSheet, activeSheet, outputSheet As Worksheet</code> are only defining the last."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574788723, "post_id": 59055651, "comment_id": 104351979, "body": "Try and avoid defining names that can cause confusion, like <code>activeSheet</code>"}, {"owner": {"reputation": 1, "user_id": 12439455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dbd710444f31a29179950e54ade6959?s=128&d=identicon&r=PG&f=1", "display_name": "bentleytrader", "link": "https://stackoverflow.com/users/12439455/bentleytrader"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574788836, "post_id": 59055651, "comment_id": 104352038, "body": "@nathan_Sav noted. I realized that after adding the optimization sub"}], "owner": {"reputation": 1, "user_id": 12439455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dbd710444f31a29179950e54ade6959?s=128&d=identicon&r=PG&f=1", "display_name": "bentleytrader", "link": "https://stackoverflow.com/users/12439455/bentleytrader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575194501, "creation_date": 1574786603, "last_edit_date": 1575194501, "question_id": 59055651, "link": "https://stackoverflow.com/questions/59055651/how-to-optimize-vba-code-for-comparing-information", "title": "How to optimize VBA Code for comparing information", "body": "<p>The code is doing everything that I need it to. It's taking much too long though upwards of a couple minutes to complete the macro. How can I optimize this VBA code to run quicker?</p>\n\n<p>I'm new to VBA and I'm not quite sure how to proceed. This code will be running on roughly 35,000 lines of data.</p>\n\n<p>I have a feeling it's because my loop is not running on an array?</p>\n\n<pre><code>Public Sub matchRow()\n\n    Dim dumpSheet, activeSheet, outputSheet As Worksheet\n    Dim startRow, outputRow, tempDumpRow, tempActiveRow, activeRowCount, finishedActiveIndex As Integer\n    Dim finishedActive() As String\n    Dim isExist As Boolean\n\n    Call OptimizeCode_Begin\n\n    'Set sheets\n    Set dumpSheet = Sheets(\"Dump\")\n    Set activeSheet = Sheets(\"Active Directory\")\n    Set outputSheet = Sheets(\"Output\")\n\n    'Set start row of each sheet for data\n    startRow = 5\n    outputRow = 5\n\n    'Get row count from Active Depository sheet\n    activeRowCount = activeSheet.Range(\"B5:D5\").End(xlDown).Row\n\n    'Set index\n    finishedActiveIndex = 5\n\n    'Re-define array\n    ReDim finishedActive(5 To activeRowCount - 1)\n\n    'Set the start row\n    tempDumpRow = startRow\n\n    'Here I looped with OR state, you can modify it to AND start if you want\n    Do While dumpSheet.Range(\"B\" &amp; tempDumpRow) &lt;&gt; \"\" Or dumpSheet.Range(\"C\" &amp; tempDumpRow) &lt;&gt; \"\" Or dumpSheet.Range(\"D\" &amp; tempDumpRow) &lt;&gt; \"\"\n\n        'Reset exist flag\n        isExist = False\n\n        'loop all row in Active Depository sheet\n        For tempActiveRow = 5 To activeRowCount Step 1\n\n            'If row is not finished for checking.\n            If UBound(Filter(finishedActive, tempActiveRow)) &lt; 0 Then\n\n                'If all cell are equal\n                If dumpSheet.Range(\"B\" &amp; tempDumpRow) = activeSheet.Range(\"B\" &amp; tempActiveRow) And _\n                   dumpSheet.Range(\"C\" &amp; tempDumpRow) = activeSheet.Range(\"C\" &amp; tempActiveRow) And _\n                   dumpSheet.Range(\"D\" &amp; tempDumpRow) = activeSheet.Range(\"D\" &amp; tempActiveRow) Then\n\n                    'Set true to exist flag\n                    isExist = True\n\n                    'Store finished row\n                    finishedActive(finishedActiveIndex) = tempActiveRow\n\n                    finishedActiveIndex = finishedActiveIndex + 1\n\n                    'exit looping\n                    Exit For\n\n                End If\n\n            End If\n\n        Next tempActiveRow\n\n        'Show result\n        outputSheet.Range(\"B\" &amp; outputRow) = dumpSheet.Range(\"B\" &amp; tempDumpRow)\n        outputSheet.Range(\"C\" &amp; outputRow) = dumpSheet.Range(\"C\" &amp; tempDumpRow)\n        outputSheet.Range(\"D\" &amp; outputRow) = dumpSheet.Range(\"D\" &amp; tempDumpRow)\n\n        If isExist Then\n            outputSheet.Range(\"E\" &amp; outputRow) = \"\"\n        Else\n            outputSheet.Range(\"E\" &amp; outputRow) = \"Item found in \"\"Dump\"\" but not in \"\"Active Directory\"\"\"\n        End If\n\n        'increase output row\n        outputRow = outputRow + 1\n\n        'go next row\n        tempDumpRow = tempDumpRow + 1\n\n    Loop\n\n    'loop all row in Active Depository sheet\n    For tempActiveRow = 5 To activeRowCount Step 1\n\n        'If row is not finished for checking.\n        If UBound(Filter(finishedActive, tempActiveRow)) &lt; 0 Then\n\n            'Show result\n            outputSheet.Range(\"B\" &amp; outputRow) = activeSheet.Range(\"B\" &amp; tempActiveRow)\n            outputSheet.Range(\"C\" &amp; outputRow) = activeSheet.Range(\"C\" &amp; tempActiveRow)\n            outputSheet.Range(\"D\" &amp; outputRow) = activeSheet.Range(\"D\" &amp; tempActiveRow)\n            outputSheet.Range(\"E\" &amp; outputRow) = \"Item found in \"\"Active Directory\"\" but not in \"\"Dump\"\"\"\n\n            'increase output row\n            outputRow = outputRow + 1\n\n        End If\n\n    Next tempActiveRow\n\n    Call OptimizeCode_End\n\nEnd Sub\n\n\n\n\nSub OptimizeCode_Begin()\n\n    Application.ScreenUpdating = False\n\n    EventState = Application.EnableEvents\n    Application.EnableEvents = False\n\n    CalcState = Application.Calculation\n    Application.Calculation = xlCalculationManual\n\n    PageBreakState = activeSheet.DisplayPageBreaks\n    activeSheet.DisplayPageBreaks = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dllimport"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1574787793, "post_id": 59055509, "comment_id": 104351526, "body": "Do you have the Solve Add-in enabled and, if so, is it working correctly?"}, {"owner": {"reputation": 1880, "user_id": 11636588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EY5kD.jpg?s=128&g=1", "display_name": "Teamothy", "link": "https://stackoverflow.com/users/11636588/teamothy"}, "edited": false, "score": 0, "creation_date": 1574836983, "post_id": 59055509, "comment_id": 104367467, "body": "Maybe that will help <a href=\"https://stackoverflow.com/questions/57721661/how-to-permanently-turn-on-solver-in-vba-reference/57721993#57721993\" title=\"how to permanently turn on solver in vba reference\">stackoverflow.com/questions/57721661/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11820070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04489f33bda7fc55b25713816f98d59a?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewZF", "link": "https://stackoverflow.com/users/11820070/andrewzf"}, "edited": false, "score": 0, "creation_date": 1574884914, "post_id": 59056439, "comment_id": 104392447, "body": "So I had definitely enabled solver when I started working on the file as an .xlsx. But it must have been disabled when I converted the file to .xlsm. I went back and enabled solver again, and low and behold, what do I see in the references near the top, Solver! Tested the program and it works fine now. Thank you so much for the help!!"}], "tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": true, "score": 1, "last_activity_date": 1574793067, "last_edit_date": 1574793067, "creation_date": 1574789404, "answer_id": 59056439, "question_id": 59055509, "link": "https://stackoverflow.com/questions/59055509/error-cant-add-a-reference-to-the-specified-file-for-excel-2016-solver32-dll/59056439#59056439", "title": "Error &quot;Can&#39;t add a reference to the specified file.&quot; for Excel 2016 SOLVER32.DLL Add-in VBA", "body": "<p>The VBA reference that you need is to the solver add-in, which is the file <code>SOLVER.xlam</code>, and <em>not</em> to the DLL <code>SOLVER32.DLL</code>. The latter can't be directly added to a VBA project (I tried but also failed) but is doubtless called by the solver add-in behind the scenes.</p>\n\n<p>If you have the solver add-in enabled, the reference to the Solver add-in should appear (relatively early) in the list of available references in the VBA editor. That you report not seeing it is strong evidence that you have not enabled the add-in (which can be done from the user interface under <code>File/Option/Add-ins</code>). Since you have been experimenting with moving folders around, you should be sure that they are in their default location, otherwise Excel might not know where to look for it when you try to install it.</p>\n"}], "owner": {"reputation": 3, "user_id": 11820070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04489f33bda7fc55b25713816f98d59a?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewZF", "link": "https://stackoverflow.com/users/11820070/andrewzf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 59056439, "answer_count": 1, "score": 0, "last_activity_date": 1574793067, "creation_date": 1574786125, "last_edit_date": 1574786930, "question_id": 59055509, "link": "https://stackoverflow.com/questions/59055509/error-cant-add-a-reference-to-the-specified-file-for-excel-2016-solver32-dll", "title": "Error &quot;Can&#39;t add a reference to the specified file.&quot; for Excel 2016 SOLVER32.DLL Add-in VBA", "body": "<p>I have been trying to import the excel Solver Add-in to VBA and am unable to do so. I can see the DLL file on my system when I click browse from the references in window in VBA (It isn't visible from the window). However, whenever I try to open the DLL file, it gives the the error message in the title. I am getting very frustrated that this is unable to work. I have tried moving the DLL file to other locations and calling it from there, but I am unable to. I have researched this problem, but nothing has resolved the issue. I am using Excel 2016. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574785391, "post_id": 59055203, "comment_id": 104350210, "body": "Are you sure you don&#39;t have some stray cell way off to the right somewhere? if you debug print <code>ActiveSheet.UsedRange.Address</code> what is the result?"}, {"owner": {"reputation": 1, "user_id": 12439192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IC95EVGIjpY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrzLqxsOH_HZBfD5xn6k51YMvC-g/photo.jpg?sz=128", "display_name": "Julie Parker", "link": "https://stackoverflow.com/users/12439192/julie-parker"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574786129, "post_id": 59055203, "comment_id": 104350599, "body": "Thanks! It is pulling a lot (about 16,000) of extra columns.  But there&#39;s no visible data out there on the spreadsheet and clearing columns doesn&#39;t seem to help.  Do I resolve this by setting a print area?"}, {"owner": {"reputation": 1, "user_id": 12439192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IC95EVGIjpY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrzLqxsOH_HZBfD5xn6k51YMvC-g/photo.jpg?sz=128", "display_name": "Julie Parker", "link": "https://stackoverflow.com/users/12439192/julie-parker"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1574869688, "post_id": 59055203, "comment_id": 104385330, "body": "Finally found the issue: Don&#39;t use FitToPagesWide without also setting FitToPagesTall.  Thanks @cybernetic.nomad for your help!"}], "owner": {"reputation": 1, "user_id": 12439192, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IC95EVGIjpY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcrzLqxsOH_HZBfD5xn6k51YMvC-g/photo.jpg?sz=128", "display_name": "Julie Parker", "link": "https://stackoverflow.com/users/12439192/julie-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574785106, "creation_date": 1574785106, "question_id": 59055203, "link": "https://stackoverflow.com/questions/59055203/pagesetup-zoom-removes-pagebreaks-and-shrinks-export", "title": "PageSetup.Zoom removes pagebreaks and shrinks export", "body": "<p>I've got a report that needs to be reformatted and then saved as a PDF using a macro.  I'm a complete newbie to VBA, but I've got it doing everything I need, but when I add the last bit of formatting</p>\n\n<pre><code>.Zoom = False\n.FitToPagesWide = 1\n</code></pre>\n\n<p>all the page breaks disappear and the report shrinks to a inch and a half wide on the page. If I remove those two lines, it prints the same range over 3 landscape pages.  I feel like I'm missing a nugget of VBA wisdom.  Here's what I've done so far:</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = ActiveWorkbook.Worksheets(\"Suggested Stock\")\nDim LastRow As Long\nLastRow = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\nDim iRow As Long\nFor iRow = 6 To LastRow Step 1\n   If Cells(iRow, 2) = \"Subtotal\" Then\n       ws.HPageBreaks.Add Before:=ws.Rows(iRow).Offset(1, 0)\n   End If\nNext iRow\n\nRange(\"6:13\").Delete Shift:=xlUp\nRange(\"D:AS\").ColumnWidth = 4\nRange(\"D7:AS7\").Orientation = xlUpward\nRange(\"D6:AS6\").WrapText = True\nRange(\"6:6\").RowHeight = 30\nWith ActiveSheet.PageSetup\n    .Orientation = xlLandscape\n    .CenterFooter = \"Page &amp;P of &amp;N\"\n    .PrintTitleRows = ActiveSheet.Rows(\"6:7\").Address\n    .Zoom = False\n    .FitToPagesWide = 1\n\nEnd With\n\nActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, _\n    Filename:=\"C:\\Users\\Julie Sager\\Documents\\TM Reports\\Suggested Stock.pdf\", _\n        Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False\n</code></pre>\n"}, {"tags": ["excel", "vba", "temp"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1574785014, "post_id": 59055044, "comment_id": 104349985, "body": "<code>GetTempPath</code> is not a part of Excel object model. There is an <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-gettemppatha\" rel=\"nofollow noreferrer\">API function</a> under same name, but you don&#39;t have it <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/declare-statement\" rel=\"nofollow noreferrer\">declared</a>."}, {"owner": {"reputation": 1, "user_id": 12438939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019e6165c3f65191dc4f22ac46fcb7fd?s=128&d=identicon&r=PG&f=1", "display_name": "WazzaWhat", "link": "https://stackoverflow.com/users/12438939/wazzawhat"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1574786038, "post_id": 59055044, "comment_id": 104350547, "body": "Hi thanks, could you please give an example of how to declare the function?"}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 0, "creation_date": 1574786176, "post_id": 59055044, "comment_id": 104350622, "body": "Declaration for VB:<code>Private Declare Function GetTempPath Lib &quot;kernel32&quot; Alias &quot;GetTempPathA&quot; (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long</code>"}, {"owner": {"reputation": 1, "user_id": 12438939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019e6165c3f65191dc4f22ac46fcb7fd?s=128&d=identicon&r=PG&f=1", "display_name": "WazzaWhat", "link": "https://stackoverflow.com/users/12438939/wazzawhat"}, "edited": false, "score": 0, "creation_date": 1574786987, "post_id": 59055044, "comment_id": 104351098, "body": "Hi, I added the code  but it returns &quot;argument not optional&quot; highlighting GetTempPath in the sub routine, Thanks"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1574788026, "post_id": 59055044, "comment_id": 104351658, "body": "Well, you didnt supply the arguments when you called it... it expects a Long and a String."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1574788513, "post_id": 59055044, "comment_id": 104351879, "body": "You should better look into why it works on your laptop, as it really should not."}, {"owner": {"reputation": 1, "user_id": 12438939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019e6165c3f65191dc4f22ac46fcb7fd?s=128&d=identicon&r=PG&f=1", "display_name": "WazzaWhat", "link": "https://stackoverflow.com/users/12438939/wazzawhat"}, "edited": false, "score": 0, "creation_date": 1575891005, "post_id": 59055044, "comment_id": 104705755, "body": "Solved by not using the temp file location but created a folder all users can access as the temporary location. all works good now."}], "owner": {"reputation": 1, "user_id": 12438939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/019e6165c3f65191dc4f22ac46fcb7fd?s=128&d=identicon&r=PG&f=1", "display_name": "WazzaWhat", "link": "https://stackoverflow.com/users/12438939/wazzawhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574784580, "creation_date": 1574784580, "question_id": 59055044, "link": "https://stackoverflow.com/questions/59055044/gettemppath-vba-working-on-laptop-64-bit-but-not-on-desktop-32-bit", "title": "GetTempPath VBA working on laptop 64 bit but not on desktop 32 bit", "body": "<p>I've created an excel sheet that has a form that the user fills out. on button click it should generate a copy to be emailed, it works fine on my 64 bit laptop but when I try to run it on one of our 32 bit desktops an error is displayed \"Compile error - can't find project or library\" with the GetTempPath highlighted. I've tried TempFilePath = Environ$(\"temp\") &amp; \"\\\" but this still throws the same error. looking at the TEMP and TMP path for both environments through command prompt they are the same.</p>\n\n<pre><code>{\nSub CommandButton1_Click()\nIf (Range(\"C7\") = Empty) Or (Range(\"C11\") = Empty) Or (Range(\"C15\") = Empty) Or (Range(\"C19\") = \nEmpty) Or (Range(\"C23\") = Empty) Or (Range(\"C27\") = Empty) Or (Range(\"C32\") = Empty) Or \n(Range(\"C41\") = Empty) Or (Range(\"C45\") = Empty) Then\nMsgBox \"Mandatory fields require input\"\nElse\nDim FileExtStr As String\nDim FileFormatNum As Long\nDim Sourcewb As Workbook\nDim Destwb As Workbook\nDim TempFilePath As String\nDim TempFileName As String\nDim OutApp As Object\nDim OutMail As Object\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\nSet Sourcewb = ActiveWorkbook\nSheets(\"Data\").Visible = True\nSheets(\"Data\").Activate\nActiveSheet.Range(\"A2:K2\").Select\nSelection.Copy\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\n'Copy the ActiveSheet to a new workbook\nSheets(\"Data\").Copy\nSet Destwb = ActiveWorkbook\n\n'Determine the Excel version and file extension/format\nWith Destwb\n   If Val(Application.Version) &lt; 12 Then\n      'You use Excel 97-2003\n        FileExtStr = \".xls\": FileFormatNum = -4143\n    Else\n        'You use Excel 2007-2016\n        Select Case Sourcewb.FileFormat\n        Case 51: FileExtStr = \".xlsx\": FileFormatNum = 51\n        Case 52:\n            If .HasVBProject Then\n                FileExtStr = \".xlsm\": FileFormatNum = 52\n            Else\n                FileExtStr = \".xlsx\": FileFormatNum = 51\n            End If\n        Case 56: FileExtStr = \".xls\": FileFormatNum = 56\n        Case Else: FileExtStr = \".xlsb\": FileFormatNum = 50\n       End Select\n   End If\nEnd With\n\n'Save the new workbook/Mail it/Delete it\nTempFilePath = GetTempPath\nTempFileName = Sourcewb.Name &amp; \" \" &amp; Format(Now, \"dd-mmm-yy h-mm-ss\")\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(0)\n\nWith Destwb\n    .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, FileFormat:=FileFormatNum\n    On Error Resume Next\n    With OutMail\n        .to = Range(\"A100\")\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Referral\"\n        .Body = \"Hi there, see attached form.\"\n        .Attachments.Add Destwb.FullName\n        'You can add other files also like this\n        '.Attachments.Add (\"C:\\test.txt\")\n        .Send   'or use .Display\n    End With\n    On Error GoTo 0\n    .Close SaveChanges:=False\nEnd With\n\nMsgBox (\"Submitted, Thank you\")\n'Delete the file you have send\nKill TempFilePath &amp; TempFileName &amp; FileExtStr\nSourcewb.Close SaveChanges:=False\n\nSet OutMail = Nothing\nSet OutApp = Nothing\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\nEnd With\nEnd If\nEnd Sub\n}\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12439176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ef2606cb1e7d1f9ea4e1dfe5e3111b?s=128&d=identicon&r=PG&f=1", "display_name": "justen 0351", "link": "https://stackoverflow.com/users/12439176/justen-0351"}, "is_accepted": false, "score": 0, "last_activity_date": 1575476235, "creation_date": 1575476235, "answer_id": 59180377, "question_id": 59054929, "link": "https://stackoverflow.com/questions/59054929/can-someone-help-me-make-this-formula-work-on-an-entire-column/59180377#59180377", "title": "can someone help me make this formula work on an entire column?", "body": "<p>I was able to find the solution myself. the below code is what i used. I thought i would share it just in case someone else had the same issue.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code> Sub FIND_MATCHES()\r\n\r\nDim barcode As Worksheet\r\nDim order As Worksheet\r\n    Set barcode = ActiveWorkbook.Sheets(\"BARCODE\")\r\n    Set order = ActiveWorkbook.Sheets(\"ORDER REPORT\")\r\nDim LASTROW As Long\r\nDim c As Long\r\nDim X As Integer\r\n    X = 1\r\nDim finalrow As String\r\n    finalrow = order.cells(Rows.COUNT, 12).End(xlUp).Row\r\nDim location As Range\r\n    Set location = barcode.cells.Item(X, \"E\")\r\nDim HELPER As String\r\nDim NUMROWS As String\r\n        \r\n        NUMROWS = order.cells(Rows.COUNT, 14).End(xlUp).Row\r\n        HELPER = barcode.cells.Item(X, \"E\").Value\r\n        LASTROW = order.cells(Rows.COUNT, 14).End(xlUp).Row\r\n           \r\n Dim ENDROW As String\r\n        ENDROW = order.cells(Rows.COUNT, 4).End(xlUp).Row\r\n            For X = 1 To ENDROW\r\n                \r\n                    For c = 7 To NUMROWS\r\n                            If order.cells(c, 14).Value = barcode.cells.Item(X, \"E\").Value Then\r\n                                order.cells(c, 12).Value = order.cells(c, 6).Value - barcode.cells.Item(X, \"E\").OFFSET(0, -2).Value + barcode.cells.Item(X, \"E\").OFFSET(0, -1).Value\r\n                            Else\r\n                                 ActiveCell.OFFSET(1, 0).Select\r\n                                 End If\r\n                    Next c\r\n           Next X\r\n          order.Range(\"A2\").Select\r\n\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1, "user_id": 12439176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07ef2606cb1e7d1f9ea4e1dfe5e3111b?s=128&d=identicon&r=PG&f=1", "display_name": "justen 0351", "link": "https://stackoverflow.com/users/12439176/justen-0351"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575476235, "creation_date": 1574784225, "last_edit_date": 1574785830, "question_id": 59054929, "link": "https://stackoverflow.com/questions/59054929/can-someone-help-me-make-this-formula-work-on-an-entire-column", "title": "can someone help me make this formula work on an entire column?", "body": "<p>im hoping that someone can help me to take a macro down an entire column.here is what i am trying to do.</p>\n\n<p>the following table is in a worksheet called barcode. it is my master list. column E:E, is a helper column that has part numbers with countif numbers attach like so=:1,:2,:3, etc. i did this because i have multiple orders for part numbers that are due on different dates in the order report. in column c, there is a number of how many of a part has been ran. in column d, the number of parts that have been scrapped and would have to be ran again. i have highlighted a row to use as an example. in this case. part number ms-100 has a total of 1 part ran and zero scrapped.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w2ZGF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w2ZGF.png\" alt=\"enter image description here\"></a></p>\n\n<p>the next sheet is my order report sheet. it displays what a customer has ordered of what part. the calculation that i want to have is: if ms-100:1 on the order report matches what is on the master list, then take the qty from the order report and subtract how many were ran, and add how many were scrapped. so for this case. if ms-100:1 =ms-100:1 then cell f8 =12-1+0.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nT7AB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nT7AB.png\" alt=\"enter image description here\"></a></p>\n\n<p>my current code will do that, but it will only do the cells that i point them to and not the entire column. to make it easier to see if this code works or not, instead of changing the values of column f on the order report, i moved it to column l. the goal is to have the value change in f, but for now i was putting the value in l. as you can see, in L7, it says no order. i hope this clarifies what i am trying to accomplish. thank you very much. here is the code that i have so far. i was attempting to use for each cell but it doesnt seem to be working.</p>\n\n<pre><code>Sub FIND_MATCHES()\n\nDim sh1 As Worksheet\n\nDim sh4 As Worksheet\n\nSet sh1 = ActiveWorkbook.Sheets(\"BARCODE\")\n\nSet sh4 = ActiveWorkbook.Sheets(\"ORDER REPORT\")\nDim CELL As Range\nDim LASTROW As Long\nDim R As Long\nDim c As Range\n    Set c = sh4.Range(\"L:L\")\n\n\n    LASTROW = sh4.CELLS(Rows.COUNT, 12).End(xlDown).Row\n    'LASTROW = Range(\"F7:F\" &amp; Rows.COUNT).End(xlUp).Row\n\nDim COMPID As Range\n    Set COMPID = sh1.Range(\"E:E\").Find(What:=sh4.Range(\"N7\").Value, LookIn:=xlValues, LOOKAT:=xlWhole)\n    'sh4.Range(\"L7:L\" &amp; LASTROW).Activate\n    'sh4.Range(\"L7:L\" &amp; LASTROW).Select\nFor Each CELL In c\nIf COMPID Is Nothing Then\n    sh4.Range(\"L7\").Value = \"NO ORDER\"\n    Else\n    'TEST CELL'sh4.Range(\"L7\").Value = COMPID.Offset(, -2).Value\n    sh4.Range(\"L7\").Value = sh4.Range(\"F7\").Value - COMPID.Offset(0, -2).Value + COMPID.Offset(0, -1).Value\n    'Range(\"L7:L\" &amp; LASTROW).Select\n   ' Range(\"L8\").Select\n    Exit For\nEnd If\n\nNext CELL\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 0, "creation_date": 1574784691, "post_id": 59054924, "comment_id": 104349784, "body": "I don&#39;t get it, you want your procedure to show the data for all 4 values at the same time or filter 1 at a time and do something?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "edited": false, "score": 0, "creation_date": 1574798958, "post_id": 59055367, "comment_id": 104356677, "body": "I&#39;m trying to use the second version of the code you provided which updates all, however it&#39;s throwing a subscript out of range error. Is there something that I&#39;m over looking?"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "edited": false, "score": 0, "creation_date": 1574799233, "post_id": 59055367, "comment_id": 104356793, "body": "@Gil when trying to filter? might be some empty values on the range? or some codes which aren&#39;t on the olap?"}, {"owner": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "edited": false, "score": 0, "creation_date": 1574799650, "post_id": 59055367, "comment_id": 104356963, "body": "Yes there are empty values in the range which is why I want the range to stop reading at the point where the next cell is empty"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "edited": false, "score": 0, "creation_date": 1574800804, "post_id": 59055367, "comment_id": 104357474, "body": "@Gil try my edit.. it will ignore empty cells and loop only to the last row (will ignore empty cells that might be in between your range)"}, {"owner": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "edited": false, "score": 0, "creation_date": 1574801004, "post_id": 59055367, "comment_id": 104357557, "body": "I&#39;m getting a new error &quot;Compile Error: Constant expression required&quot;, which is highlighting the LastRow in Dim PortfolioCodes(1 To LastRow - 6) As String"}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "reply_to_user": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "edited": false, "score": 0, "creation_date": 1574801346, "post_id": 59055367, "comment_id": 104357694, "body": "@Gil sorry! change <code>Dim</code>for <code>ReDim</code> like my code now."}, {"owner": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "edited": false, "score": 0, "creation_date": 1574802661, "post_id": 59055367, "comment_id": 104358220, "body": "Thank you so much! Worked like a charm!"}], "tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": true, "score": 1, "last_activity_date": 1574801328, "last_edit_date": 1574801328, "creation_date": 1574785639, "answer_id": 59055367, "question_id": 59054924, "link": "https://stackoverflow.com/questions/59054924/loop-through-array-and-change-filter-on-olap-pivot-table/59055367#59055367", "title": "Loop Through Array and Change Filter on OLAP Pivot Table", "body": "<p>Here, the two possible answers to your question:</p>\n\n<pre><code>Option Explicit\nSub Update_Filters()\n\n    'this code will filter one portfolio code at a time\n    Dim LastRow As Long\n    With ThisWorkbook.Sheets(\"Configuration Sheet\")\n        LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n        Dim PortfolioCodes As Variant\n        PortfolioCodes = .Range(\"C7:C\" &amp; LastRow).Value\n    End With\n\n    For i = LBound(PortfolioCodes) To UBound(PortfolioCodes)\n        ThisWorkbook.Sheets(\"List\").PivotTables(\"List\").PivotFields( _\n        \"[Portfolio].[Portfolio Code].[Portfolio Code]\").VisibleItemsList = _\n            Array(\"[Portfolio].[Portfolio Code].&amp;[\" &amp; PortfolioCodes(i) &amp; \"]\")\n        'some code\n    Next i\n\nEnd Sub\nSub Update_FiltersALL()\n\n    'This code will filter all the portfolio codes in your range\n    With ThisWorkbook.Sheets(\"Configuration Sheet\")\n\n        Dim LastRow As Long\n        LastRow = .Cells(.Rows.Count, \"C\").End(xlUp).Row\n\n        Dim i As Long\n        i = 1\n\n        ReDim PortfolioCodes(1 To LastRow - 6) As String\n        Dim C As Range\n        For Each C In .Range(\"C7:C\" &amp; LastRow)\n            If Not IsEmpty(C) Then\n                PortfolioCodes(i) = \"[Portfolio].[Portfolio Code].&amp;[\" &amp; C.Value &amp; \"]\"\n                i = i + 1\n            End If\n        Next C\n    End With\n\n    ThisWorkbook.Sheets(\"List\").PivotTables(\"List\").PivotFields( _\n    \"[Portfolio].[Portfolio Code].[Portfolio Code]\").VisibleItemsList = PortfolioCodes\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3573760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6fe0d874c4311466e1429453d6ca324?s=128&d=identicon&r=PG&f=1", "display_name": "Gil", "link": "https://stackoverflow.com/users/3573760/gil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 59055367, "answer_count": 1, "score": 0, "last_activity_date": 1574801328, "creation_date": 1574784219, "last_edit_date": 1574785858, "question_id": 59054924, "link": "https://stackoverflow.com/questions/59054924/loop-through-array-and-change-filter-on-olap-pivot-table", "title": "Loop Through Array and Change Filter on OLAP Pivot Table", "body": "<p>I'm pretty new to VBA so I'm looking for some help on setting up a macro that will add the values from a specific range to an array and then loop through that array to update the filters on a pivot table. However not every value might be set. An example of this would be that only 4 values are set out of a 100 so it would only loop through it 4 times and update the filter with those 4 values. I have never worked with for loops before so any guidance on this would be extremely helpful.</p>\n\n<p>My code so far:</p>\n\n<pre><code>Sub Update_Filters()\n\n    Dim PortfolioCodes As Variant\n    PortfolioCodes = Sheets(\"Configuration Sheet\").Range(\"C7:C45\").Value\n\n    Sheets(\"List\").PivotTables(\"List\").PivotFields( _\n        \"[Portfolio].[Portfolio Code].[Portfolio Code]\").VisibleItemsList = Array( _\n        \"[Portfolio].[Portfolio Code].&amp;[ABC1]\", \"[Portfolio].[Portfolio Code].&amp;[ABC2]\", _\n        \"[Portfolio].[Portfolio Code].&amp;[XYZ1]\", \"[Portfolio].[Portfolio Code].&amp;[XYZ2]\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "listbox"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1574787752, "post_id": 59054791, "comment_id": 104351503, "body": "The <code>=</code> needs to be <code>in</code> so like this <code>select \u2026.. where x in (1,2,3,4,5)</code>"}, {"owner": {"reputation": 1, "user_id": 12438940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b4a5d48edf6061c5287c7d5d495ac9?s=128&d=identicon&r=PG&f=1", "display_name": "AM7223", "link": "https://stackoverflow.com/users/12438940/am7223"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574792489, "post_id": 59054791, "comment_id": 104353825, "body": "Adding In made no difference- same error"}, {"owner": {"reputation": 1, "user_id": 12438940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b4a5d48edf6061c5287c7d5d495ac9?s=128&d=identicon&r=PG&f=1", "display_name": "AM7223", "link": "https://stackoverflow.com/users/12438940/am7223"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574797864, "post_id": 59054791, "comment_id": 104356181, "body": "Thank you. The IN did work but not at once! Turned out there should be no space between In and ( and then it worked! where SGistID IN(&quot; &amp; strSearch &amp; &quot;)&quot;"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1574801931, "post_id": 59054791, "comment_id": 104357950, "body": "@Nathan_Sav, sounds a valid answer if you want to write it up. AM7223, tag the comma on at the end instead of beginning and don&#39;t have to bother with trimming. Trailing comma in series will be ignored."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1574850229, "creation_date": 1574850229, "answer_id": 59067967, "question_id": 59054791, "link": "https://stackoverflow.com/questions/59054791/ms-access-search-split-form-with-unbound-listbox/59067967#59067967", "title": "MS Access Search split Form with unbound listbox", "body": "<p>You need to use the SQL <code>IN</code> or build an <code>OR</code> statement.  <code>IN</code> would be more readable.</p>\n\n<p>like so:</p>\n\n<p>The <code>=</code> needs to be in so like this <code>select * from [qryScreening] where [GistID] in (1,2,3,4,5)</code></p>\n\n<p>Also, may read a bit better to check the selected items count rather than a reliance on the string length.</p>\n"}], "owner": {"reputation": 1, "user_id": 12438940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b4a5d48edf6061c5287c7d5d495ac9?s=128&d=identicon&r=PG&f=1", "display_name": "AM7223", "link": "https://stackoverflow.com/users/12438940/am7223"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574850229, "creation_date": 1574783846, "last_edit_date": 1574796760, "question_id": 59054791, "link": "https://stackoverflow.com/questions/59054791/ms-access-search-split-form-with-unbound-listbox", "title": "MS Access Search split Form with unbound listbox", "body": "<p>I am a novice in MS access and struggling to come up with a correct code lines to enable a multiparameter search form. I have a query that collects info from 3 tables. Two of the fields in this query are a cascade combobox and a listbox. The listbox updates (by Requery) from the combobox. For each value in combobox, there are 3-5 values in the list box. I tried to set up a search form (splitform with spreadsheet) where the Unbound combobox and listbox would find all the values that were selected in the listbox and show the resulting pool of values in the spreadsheet of the splitform. The combo-listbox and the form are working OK to show all initial values and works OK when only ONE of the values was selected in the list box. However, when more than 1 value is selected in the listbox, I get a message </p>\n\n<blockquote>\n  <p>Syntax error (comma) in query expression '(GistID = (4,9))'</p>\n</blockquote>\n\n<p>or similar depending on the GistName ID#.</p>\n\n<p>The code for this form:</p>\n\n<pre><code>Private Sub cmdSearch_Click()\n    Dim varItem as Variant\n    Dim strSearch As String\n    Dim Task as String\n\n    For Each varItem In Me!listbGist.ItemsSelected\n        strSearch=strSearch &amp; \",\" &amp; Me.listbGist.ItemData(varItem)\n    Next varItem\n    If Len(strSearch)=0 Then\n        Task=\"select * From qryScreening\"\n    Else\n        strSearch=Right(strSearch, Len(strSearch)-1)\n        Task=\"select * from qryScreening where (GistID=(\"&amp; strSearch &amp; \"))\"\n    End if\n    DoCmD. ApplyFilter Task\nEnd Sub\n</code></pre>\n\n<p>The code generates a string ,X,X,X and the Len function removes the first comma as I learned via MsgBox(strSearch) but the filter Task does not run if more than 1 value was selected in the listbox.\nCould you please suggest a remedy to this code that is not working now.</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1574784130, "creation_date": 1574784130, "answer_id": 59054896, "question_id": 59054735, "link": "https://stackoverflow.com/questions/59054735/extracting-page-number-using-sentence-reference-from-word-document/59054896#59054896", "title": "Extracting Page number using sentence reference from Word Document", "body": "<p>You need to use the word <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/set-statement\" rel=\"nofollow noreferrer\">SET</a></p>\n\n<p>Change <code>w = wdDoc.Sentences(i).Words(1)</code> to <code>Set w = wdDoc.Sentences(i).Words(1)</code> You also have a typo in <code>Left(\"Opening Phrase to check\"), 15)</code>. it should be <code>Left(\"Opening Phrase to check\", 15)</code></p>\n\n<p>Try this. This works for me</p>\n\n<pre><code>Dim w As Object\n\nn = wdDoc.Sentences.Count\n\nFor i = 1 To n\n    If Left(wdDoc.Sentences(i), 15) = Left(\"Opening Phrase to check\", 15) Then\n        Set w = wdDoc.Sentences(i).Words(1)\n        MsgBox w.Information(wdActiveEndPageNumber)\n    End If\nNext i\n</code></pre>\n\n<p><strong>Note</strong>: If you are late binding MS Word from MS Excel then ensure that you have declared this at the top</p>\n\n<pre><code>Const wdActiveEndPageNumber As Integer = 3 \n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 10841362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1e6ae39b0811fbf83e222ec0d3a94e?s=128&d=identicon&r=PG&f=1", "display_name": "BasketballAutomation", "link": "https://stackoverflow.com/users/10841362/basketballautomation"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574784130, "creation_date": 1574783688, "last_edit_date": 1574783888, "question_id": 59054735, "link": "https://stackoverflow.com/questions/59054735/extracting-page-number-using-sentence-reference-from-word-document", "title": "Extracting Page number using sentence reference from Word Document", "body": "<p>I'm working to extract the page number from a word document based on specific phrases. I cannot seem to debug or understand why my code isn't working - any suggestions or help is greatly appreciated!</p>\n\n<p>For a quick walkthrough, wdDoc is my current word document ... opened using GetObject(). I'm trying to print the page number to sheet1 for now just as a test case. I'm just trying to match the the first phrase (thus the \"opening phrase to check\" example case). And I've used a msg box to confirm that I've found an opening phrase match (i.e., the if statement is working, I just can't get the page number).</p>\n\n<pre><code>n = wdDoc.Sentences.Count\nFor i = 1 To n\nIf left(wdDoc.Sentences(i), 15) = Left(\"Opening Phrase to check\"), 15) Then\n   w = wdDoc.Sentences(i).Words(1)\n   Sheets(\"Sheet1\").Cells(4, 1) = w.Information(wdActiveEndPageNumber)\nEnd If\nNext i\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "edited": false, "score": 2, "creation_date": 1574792658, "post_id": 59054652, "comment_id": 104353887, "body": "That would be <code>acCmdCompactDatabase</code>. @HelO&#39;Ween"}, {"owner": {"reputation": 648, "user_id": 6626183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a57210a6e0933a32691c61eba6f218df?s=128&d=identicon&r=PG&f=1", "display_name": "Hel O&#39;Ween", "link": "https://stackoverflow.com/users/6626183/hel-oween"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1574952291, "post_id": 59054652, "comment_id": 104417106, "body": "@Andre, you&#39;re correct, ofc. I deleted my wrong comment."}], "answers": [{"comments": [{"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1574799847, "post_id": 59057356, "comment_id": 104357050, "body": "Correct - the command checks if the database can be published as a web application. Those 2010 web applications allow VBA and VBA client forms to be published (but not run), so even VBA and  non web forms will in fact pass the compatibility check."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1574793091, "creation_date": 1574793091, "answer_id": 59057356, "question_id": 59054652, "link": "https://stackoverflow.com/questions/59054652/what-does-runcommand-accmdcompatcheckdatabase-do/59057356#59057356", "title": "What does &quot;RunCommand acCmdCompatCheckDatabase&quot; do?", "body": "<p>It's the same as the menu command</p>\n\n<pre><code>File -&gt; Save &amp; Publish -&gt; Publish to Access Services -&gt; Run Compatibility Checker\n</code></pre>\n\n<p>(in Access 2010, I don't have a newer version here to check how it's called there.)</p>\n\n<p>See <a href=\"https://support.office.com/en-us/article/build-an-access-database-to-share-on-the-web-cca08e35-8e51-45ce-9269-8942b0deab26\" rel=\"nofollow noreferrer\">Build an Access database to share on the Web</a></p>\n"}], "owner": {"reputation": 33, "user_id": 7198494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c6d98cd3e13f5f41a7340a21a52bd94?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin Nirmul", "link": "https://stackoverflow.com/users/7198494/ashwin-nirmul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574793091, "creation_date": 1574783411, "last_edit_date": 1574793081, "question_id": 59054652, "link": "https://stackoverflow.com/questions/59054652/what-does-runcommand-accmdcompatcheckdatabase-do", "title": "What does &quot;RunCommand acCmdCompatCheckDatabase&quot; do?", "body": "<p>I'm just curious how or when or why I would use this command: </p>\n\n<pre><code>DoCmd.RunCommand acCmdCompatCheckDatabase\n</code></pre>\n"}]