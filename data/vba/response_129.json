[{"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1498757519, "post_id": 44814856, "comment_id": 76643567, "body": "Thank you so much! I&#39;ve been self-teaching myself a lot of Access/VBA so I  usually don&#39;t even know where to start (I have very little/no coding experience...learning it as i go along). do you know of any resources for learning SQL/querying within VBA?"}, {"owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1498757984, "post_id": 44814856, "comment_id": 76643883, "body": "Also, for the [MaxDateParam], is there a way to tweak the date it&#39;s pulling? I figured out that I&#39;ll need to tweak the query a little bit (I don&#39;t necessarily want the max date. My table has a bunch of entries that records dates, so I want the most recent date that was recorded. For example, I might have a date of 7/1/2017 recorded on 6/1/2017. But if I record a date of 6/15/2017 recorded on 6/5/2017, I want it to update to the date that was recorded on 6/5/2017.)"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1498759262, "post_id": 44814856, "comment_id": 76644581, "body": "Try using the <a href=\"https://www.techonthenet.com/access/functions/domain/dlast.php\" rel=\"nofollow noreferrer\">DLast()</a> domain aggregate which returns last saved value by criteria. But it also sounds like you want to have a <i>DateCreated</i> with default <code>=Now()</code> or <i>DateModified</i> field where a save function on form updates this field. This would be another SO question."}, {"owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1498760250, "post_id": 44814856, "comment_id": 76645139, "body": "Great thank you. I ended up combining my original method of writing a SQL query and set the value of that query to the MaxDateParam so I&#39;d be able to modify the query if I needed to. Thank you. This was very helpful"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1498760551, "post_id": 44814856, "comment_id": 76645335, "body": "Consider a saved query. No need to open a recordset and queries can read form controls without quotes. You would then need a <code>DLookup</code> on query. And glad I could help. Please accept answer (tick mark to side) to confirm resolution."}, {"owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1498761392, "post_id": 44814856, "comment_id": 76645841, "body": "Is there a pro to using a saved query/dlookup over my method of opening a recordset?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "edited": false, "score": 0, "creation_date": 1498761733, "post_id": 44814856, "comment_id": 76646022, "body": "Probably more to do with preference, but opening a recordset for one value seem like too much overhead. Also, saved queries are more efficient than VBA string queries as the Access database engine saves best execution plan and cannot do so if called on the fly in VBA. In fact, the prepared statement here can be a saved query and then change: <code>Set qdef = CurrentDb.QueryDefs(&quot;mySavedQuery&quot;)</code>"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1498698853, "creation_date": 1498698853, "answer_id": 44814856, "question_id": 44813985, "link": "https://stackoverflow.com/questions/44813985/running-update-qry-in-vba-based-on-a-query-value/44814856#44814856", "title": "Running Update Qry in VBA Based on a Query Value", "body": "<p>Action queries (<code>DELETE</code>, <code>UPDATE</code>, <code>INSERT INTO</code>) are to be executed (<code>CurrentDb.Execute</code>) while <code>SELECT</code> queries are to be opened as recordsets (<code>CurrentDb.OpenRecordset</code>).</p>\n\n<p>Additionally, consider using parameterization to avoid any need of quote enclosure or string concatenation in query. And here the max date is calculated with domain aggregate, <code>DMax()</code>, instead of opening another query.</p>\n\n<pre><code>Dim strSQL As String\nDim qdef As Querydef\n\n' PREPARE SQL STATEMENT\nstrSQL = \"PARAMETERS [MaxDateParam] Date, [FormIDParam] Long;\" _\n           &amp; \"UPDATE Tbl_Name SET CollectionDate = [MaxDateParam]\" _\n           &amp; \" WHERE PID = [FormIDParam];\"\n\n' BUILD TEMP QUERY\nSet qdef = CurrentDb.CreateQueryDef(\"\", strSQL)\n\n' BIND PARAMETERS\nqdef!MaxDateParam = DMax(\"Date1_Event\", \"TBL_Event\", \"ID=\" &amp; [Forms]![FRM_Main]![ID])\nqdef!FormIDParam = [Forms]![FRM_Main]![ID]\n\n' EXECUTE ACTION\nqdef.Execute dbFailOnError\n\nSet qdef = Nothing\n</code></pre>\n\n<p>Though above may look unusual and slightly more lines. Don't be intimidated and run for the easy 1-2 lines. Parameterization is a programming industry best practice not just in VBA but across all general purpose languages that run dynamic SQL queries using values from user input.</p>\n"}], "owner": {"reputation": 13, "user_id": 7896840, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/da620cd2d27d1416329d202ae7cb0edd?s=128&d=identicon&r=PG&f=1", "display_name": "xpandamonium", "link": "https://stackoverflow.com/users/7896840/xpandamonium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 44814856, "answer_count": 1, "score": 0, "last_activity_date": 1498698853, "creation_date": 1498691858, "last_edit_date": 1498697616, "question_id": 44813985, "link": "https://stackoverflow.com/questions/44813985/running-update-qry-in-vba-based-on-a-query-value", "title": "Running Update Qry in VBA Based on a Query Value", "body": "<p>I am trying to run an Update Query in VBA and am at a lost as to what I'm supposed to write for the code. I'm running a query to find the most recent date from a table. That query works fine. Now I want to run an update query to update another table's date field to equal to the date that was queried. Here is what I have: </p>\n\n<pre><code>Dim Date1 As Date\nDim newdate1\n\n'selects datadate 1\nDate1 = CurrentDb.OpenRecordset(\"Select Max(Date1_Event) from TBL_Event WHERE ID = '\" &amp; [Forms]![FRM_Main]![ID] &amp; \"'\")(0)\n\n'update datadate 1\nnewdate1 = CurrentDb.OpenRecordset(\"Update Tbl_Name set CollectionDate = DataDate1 WHERE PID = '\" &amp; [Forms]![FRM_Main]![ID] &amp; \"'\")(0)\n</code></pre>\n\n<p>Is there a way to run an update query like this? Thank you. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1498689265, "post_id": 44813479, "comment_id": 76607823, "body": "Have you got the correct number of spaces in your string as in the HTML?  Does the HTML even contain spaces?  (It might just look that way in whatever application you are using to view it.)  Does the HTML contain CR/LF characters or perhaps just LF or just CR characters?  (Or, again, maybe it has neither and it is just the viewer which is showing it as if they are there.)"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 3, "creation_date": 1498689649, "post_id": 44813479, "comment_id": 76607942, "body": "You may need to use <code>vbCr</code> or <code>vbLf</code> instead of <code>vbCrLf</code> to match <code>\\n</code>. You can use <code>Asc(Mid(html_source, position, 1))</code> to distinguish a carriage return from a line feed in the source."}, {"owner": {"reputation": 305, "user_id": 8137587, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e0c86d52418348655261a908f625ff00?s=128&d=identicon&r=PG&f=1", "display_name": "Exam Orph", "link": "https://stackoverflow.com/users/8137587/exam-orph"}, "edited": false, "score": 2, "creation_date": 1498690046, "post_id": 44813479, "comment_id": 76608054, "body": "Thank you so much - you guys are great!! vbLf fixed it. If you could please post this as an answer - I will mark it as complete for others reference. Thanks again!"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498755762, "post_id": 44813479, "comment_id": 76642558, "body": "@YowE3K I copied the comment to an answer."}], "answers": [{"tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1498755648, "creation_date": 1498755648, "answer_id": 44831099, "question_id": 44813479, "link": "https://stackoverflow.com/questions/44813479/errors-when-using-instr-to-search-html/44831099#44831099", "title": "Errors when using InStr() to search HTML", "body": "<p>You may need to use <code>vbCr</code> or <code>vbLf</code> instead of <code>vbCrLf</code> to match <code>\\n</code>. You can use <code>Asc(Mid(html_source, position, 1))</code> to determine what is used for a newline in the html source.</p>\n\n<p>Hope that helps</p>\n"}], "owner": {"reputation": 305, "user_id": 8137587, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e0c86d52418348655261a908f625ff00?s=128&d=identicon&r=PG&f=1", "display_name": "Exam Orph", "link": "https://stackoverflow.com/users/8137587/exam-orph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 44831099, "answer_count": 1, "score": 0, "last_activity_date": 1498755648, "creation_date": 1498688619, "question_id": 44813479, "link": "https://stackoverflow.com/questions/44813479/errors-when-using-instr-to-search-html", "title": "Errors when using InStr() to search HTML", "body": "<p>I'm having difficulty using InStr() for multiple line inputs when searching through HTML code - here's a simplified version of my code with comments showing errors at debug.print:</p>\n\n<pre><code>Sub TestInStr()\nDim XMLPage As New MSXML2.XMLHTTP60\nDim html\n\nXMLPage.Open \"GET\", \"https://www.hltv.org/stats/matches/mapstatsid/48623/masterminds-vs-riotous-raccoons\", False\nXMLPage.send\nIf XMLPage.Status &lt;&gt; 200 Then MsgBox XMLPage.statusText\nhtml = XMLPage.responseText\n\nDim str1, str2, str3, str4 As String\n\n'Multi Line HTML\nstr1 = \"&lt;div class=\"\"bold\"\"&gt;Breakdown&lt;/div&gt;\" &amp; vbCrLf &amp; \"                    &lt;/div&gt;\" &amp; vbCrLf &amp; \"                    &lt;div class=\"\"match-info-row\"\"&gt;\" &amp; vbCrLf &amp; \"                      &lt;div class=\"\"right\"\"&gt;\"\nstr2 = \"&lt;/div&gt;\" &amp; vbCrLf &amp; \"                      &lt;div class=\"\"bold\"\"&gt;Team rating&lt;/div&gt;\"\nDebug.Print InStr(html, str1) 'Cant find, value = 0 (Multi Line HTML)\nDebug.Print InStr(html, str2) 'Cant find, value = 0 (Multi Line HTML)\n\n\n'Single Line HTML\nstr3 = \"&lt;div class=\"\"bold\"\"&gt;Breakdown&lt;/div&gt;\"\nstr4 = \"&lt;div class=\"\"match-info-row\"\"&gt;\"\nDebug.Print InStr(html, str3) 'Found, value = 15503 (Single Line HTML)\nDebug.Print InStr(html, str4) 'Found, value = 15208 (Single Line HTML)\nEnd Sub\n</code></pre>\n\n<p>Here's the source HTML code:</p>\n\n<pre><code>            &lt;div class=\"bold\"&gt;Breakdown&lt;/div&gt;\n            &lt;/div&gt;\n            &lt;div class=\"match-info-row\"&gt;\n              &lt;div class=\"right\"&gt;0.91 : 1.27&lt;/div&gt;\n              &lt;div class=\"bold\"&gt;Team rating&lt;/div&gt;\n</code></pre>\n\n<p>As shown, when I try to pass multiple lines of HTML into InStr(), it return's a 0, finding nothing. But if I do the same by breaking the string down into single lines and repeat - it works fine.</p>\n\n<p>Is there any way in which I could pass multiple lines of text into InStr() when searching through HTML and get a return? Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 8216142, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qwivHYedacE/AAAAAAAAAAI/AAAAAAAAGII/kWpd88zqyvQ/photo.jpg?sz=128", "display_name": "Antti Kivivalli", "link": "https://stackoverflow.com/users/8216142/antti-kivivalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1498692400, "creation_date": 1498692400, "answer_id": 44814070, "question_id": 44813421, "link": "https://stackoverflow.com/questions/44813421/copy-range-based-on-criteria-then-dynamically-create-a-new-worksheet-containing/44814070#44814070", "title": "Copy range based on criteria then dynamically create a new worksheet containing it", "body": "<p>How about this? If you don't need the filtered list for anything else, you could also read it into a variable and pick the unique items to another variable and the create the sheets based on the latter one?</p>\n\n<pre><code>Sub NewSheets()\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    Dim vList()\n    Dim vUniqueList()\n    Dim vUniqueCount As Integer\n    Dim vIsUnique As Boolean\n\n    vList = Range([A1], Range(\"A\" &amp; Rows.Count).End(xlUp))\n\n    ReDim vUniqueList(1 To UBound(vList, 1))\n    vUniqueCount = 0\n\n    For n = 1 To UBound(vList, 1)\n        vIsUnique = True\n        For m = 1 To UBound(vList, 1)\n            If vUniqueList(m) = vList(n, 1) Then\n                vIsUnique = False\n            End If\n        Next m\n        If vIsUnique Then\n            vUniqueCount = vUniqueCount + 1\n            vUniqueList(vUniqueCount) = vList(n, 1)\n        End If\n    Next n\n\n    For n = 1 To vUniqueCount\n        With Sheets.Add(after:=Sheets(Sheets.Count))\n            .Name = vUniqueList(n)\n        End With\n    Next n\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1498745583, "post_id": 44814908, "comment_id": 76635412, "body": "hey there, thank you this creates the sheets based on the column I selected, however it doesnt populate over the unique rows from the main sheet. also I had to adjust the code a bit to change the dictionary to an object as a Dim and then CreateObject(&quot;Scripting.Dictionary&quot;). (im using 2016)."}, {"owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 1, "creation_date": 1498746572, "post_id": 44814908, "comment_id": 76636225, "body": "hey there, thank you i realised some of my values were &gt; 31 so it wasnt matching. I will make a filter to fix them up so its less then 31.. also I had to adjust the code a bit to change the dictionary to an object as a Dim and then CreateObject(&quot;Scripting.Dictionary&quot;). (im using 2016).So this works a treat. Paul, thank you for this"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "edited": false, "score": 0, "creation_date": 1498746736, "post_id": 44814908, "comment_id": 76636367, "body": "Great ! I&#39;m glad you have it figured out. I also added a note about adding an early binding to Microsoft Scripting Runtime (it&#39;s a bit faster to do it like that)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 3, "last_activity_date": 1509600502, "last_edit_date": 1592644375, "creation_date": 1498699345, "answer_id": 44814908, "question_id": 44813421, "link": "https://stackoverflow.com/questions/44813421/copy-range-based-on-criteria-then-dynamically-create-a-new-worksheet-containing/44814908#44814908", "title": "Copy range based on criteria then dynamically create a new worksheet containing it", "body": "<p>The 3 procedures bellow, in a separate module, will create and populate new sheets with unique values in column F, on the main sheet</p>\n<hr />\n<blockquote>\n<p>This uses dictionaries and <strong>late binding is slow</strong>: <strike>CreateObject(&quot;Scripting.Dictionary&quot;)</strike></p>\n<p><strong>Early binding is fast</strong>: VBA Editor -&gt; <strong>Tools</strong> -&gt; <strong>References</strong> -&gt; Add <strong>Microsoft Scripting Runtime</strong></p>\n</blockquote>\n<hr />\n<pre><code>Option Explicit\n\nPrivate Const X As String = vbNullString\n\nPublic Sub GetUniques()\n    Const MAIN_COL As Long = 6    'F            '&lt;-------------------- update column number\n    Dim ws As Worksheet, arr As Variant, r As Long, rng As Range, d As Dictionary\n    Dim val As Variant, wsNew As Worksheet, lr As Long, lc As Long\n\n    Set ws = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)  '&lt;-------------------- update sheet name\n    lr = ws.Cells(ws.Rows.Count, MAIN_COL).End(xlUp).Row\n    lc = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column\n    Set rng = ws.Range(ws.Cells(1, MAIN_COL), ws.Cells(lr, MAIN_COL))\n    arr = rng:  Set d = New Dictionary\n    For r = 1 To UBound(arr)\n        If Len(arr(r, 1)) &gt; 0 Then\n            val = CleanWsName(CStr(arr(r, 1)))\n            If Not d.Exists(val) Then d.Add val, X\n        End If\n    Next\n    Application.ScreenUpdating = False:     Application.DisplayAlerts = False\n    For Each val In d\n        Set wsNew = MakeWS(val)\n        rng.AutoFilter Field:=1, Criteria1:=&quot;=&quot; &amp; val\n        ws.Range(ws.Cells(1, 1), ws.Cells(lr, lc)).SpecialCells(xlCellTypeVisible).Copy\n        With wsNew.Cells(1, 1)\n            .PasteSpecial xlPasteColumnWidths\n            .PasteSpecial xlPasteAll\n            Application.CutCopyMode = False\n            wsNew.Activate: .Cells(1, 1).Select\n        End With\n    Next\n    ws.Activate:    ws.Cells(1, 1).Copy:    rng.AutoFilter\n    Application.ScreenUpdating = True:      Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n<hr />\n<pre><code>Public Function CleanWsName(ByVal wsName As String) As String\n    Const x = vbNullString\n\n    wsName = Trim$(wsName)    'Trim, then remove [ ] / \\ &lt; &gt; : * ? | &quot;\n    wsName = Replace(Replace(Replace(wsName, &quot;[&quot;, x), &quot;]&quot;, x), &quot; &quot;, x)\n    wsName = Replace(Replace(Replace(wsName, &quot;/&quot;, x), &quot;\\&quot;, x), &quot;:&quot;, x)\n    wsName = Replace(Replace(Replace(wsName, &quot;&lt;&quot;, x), &quot;&gt;&quot;, x), &quot;*&quot;, x)\n    wsName = Replace(Replace(Replace(wsName, &quot;?&quot;, x), &quot;|&quot;, x), Chr(34), x)\n\n    If Len(wsName) = 0 Then wsName = &quot;DT &quot; &amp; Format(Now, &quot;yyyy-mm-dd hh.mm.ss&quot;)\n    CleanWsName = Left$(wsName, 31)         'Resize to max len of 31\nEnd Function\n\nPublic Function MakeWS(ByVal wsName As String) As Worksheet\n    Dim ws As Worksheet, result As Boolean, activeWS As Worksheet, id As Long\n\n    With ThisWorkbook\n        If .Worksheets.Count = 1 And .Worksheets(1).Name = wsName Then Exit Function\n        id = IIf(ActiveSheet.Index = 1, ActiveSheet.Index + 1, ActiveSheet.Index - 1)\n        Set activeWS = ActiveSheet\n        If activeWS.Name = wsName Then Set activeWS = .Worksheets(id)\n        For Each ws In .Worksheets\n            If ws.Name = wsName Then\n                ws.Delete\n                Exit For\n            End If\n        Next\n        Set ws = .Worksheets.Add(After:=.Worksheets(.Worksheets.Count))\n    End With\n    ws.Name = wsName\n    activeWS.Activate\n    Set MakeWS = ws\nEnd Function\n</code></pre>\n<hr />\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 35, "user_id": 4908606, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10152859390977543/picture?type=large", "display_name": "Christopher Pieper", "link": "https://stackoverflow.com/users/4908606/christopher-pieper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 44814908, "answer_count": 2, "score": 1, "last_activity_date": 1509600502, "creation_date": 1498688244, "last_edit_date": 1498699509, "question_id": 44813421, "link": "https://stackoverflow.com/questions/44813421/copy-range-based-on-criteria-then-dynamically-create-a-new-worksheet-containing", "title": "Copy range based on criteria then dynamically create a new worksheet containing it", "body": "<p>I have a sheet with values, what I want is with each unique value in column F to make a sheet named that, and copy all those rows to the new sheet. </p>\n\n<p>this code looks close, but i need it to make a new sheet with each criteria (individuals)</p>\n\n<pre><code>Sub NewSheetData()\n\n    With Application\n.ScreenUpdating = False\n.EnableEvents = False\nEnd With\n\nDim Rng As Range, rCell As Range\n\n Set Rng = Range([A1], Range(\"A\" &amp; Rows.Count).End(xlUp))\n\nFor Each rCell In Range(\"MyTable\")\nOn Error Resume Next\n    With Rng\n        .AutoFilter , field:=1, Criteria1:=rCell.Value\n        .Offset(1).SpecialCells(xlCellTypeVisible).EntireRow.Copy _\n            Sheets(\"Sheet2\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        .AutoFilter\n    End With\nOn Error GoTo 0\nNext rCell\n\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "sharepoint"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1498691379, "creation_date": 1498691379, "answer_id": 44813919, "question_id": 44813345, "link": "https://stackoverflow.com/questions/44813345/is-there-a-way-to-make-an-excel-sheet-live-editable-by-multiple-people-on-sharep/44813919#44813919", "title": "Is there a way to make an excel sheet live editable by multiple people on sharepoint?", "body": "<p>Depends on your version of SharePoint. With SharePoint 365, which is online, files can be edited in Excel Online, which allows co-authoring by multiple people. </p>\n\n<p>For on-premises farms you can use the Excel Web App, which also allows simultaneous editing by multiple people. </p>\n\n<p><a href=\"https://support.office.com/en-us/article/Introduction-to-Excel-Web-App-d2838b0e-ee37-467f-a4c7-38d2bd81bfd1\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Introduction-to-Excel-Web-App-d2838b0e-ee37-467f-a4c7-38d2bd81bfd1</a></p>\n"}], "owner": {"reputation": 71, "user_id": 8197419, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f5f94371a6c5f484cc5b9b4dffaaff7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mdaox", "link": "https://stackoverflow.com/users/8197419/mdaox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1498743808, "answer_count": 1, "score": -1, "last_activity_date": 1498691379, "creation_date": 1498687823, "question_id": 44813345, "link": "https://stackoverflow.com/questions/44813345/is-there-a-way-to-make-an-excel-sheet-live-editable-by-multiple-people-on-sharep", "closed_reason": "Not suitable for this site", "title": "Is there a way to make an excel sheet live editable by multiple people on sharepoint?", "body": "<p>I am trying to make a workbook that automatically updates when it is saved or completely live, to be used almost like a google doc sheet but it needs to be on excel. But it needs to be viewed or edited by multiple people at the same time. It needs to be done on share point. Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498687692, "post_id": 44813295, "comment_id": 76607279, "body": "Well, the snippets work fine for me on the examples you&#39;ve provided."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1498688031, "post_id": 44813295, "comment_id": 76607408, "body": "&quot;I tried some stuff but nothing worked&quot; is typically not a good approach when posting here.  Including the actual code you tried, along with a description of what happened when you ran it will get you more suggestions and help."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498688265, "post_id": 44813295, "comment_id": 76607484, "body": "That wasn&#39;t me, but that edit&#39;s not going to improve your chances...  There&#39;s a pretty good answer here: <a href=\"https://www.mrexcel.com/forum/excel-questions/567315-check-if-url-exists-so-then-return-true.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>   Maybe change the GET to HEAD, since you don&#39;t really need to actually download the image."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498688431, "post_id": 44813295, "comment_id": 76607538, "body": "...or look here <a href=\"https://stackoverflow.com/questions/36064315/excel-vba-script-to-find-404-errors-in-a-list-of-urls/36065167#36065167\" title=\"excel vba script to find 404 errors in a list of urls\">stackoverflow.com/questions/36064315/&hellip;</a>"}, {"owner": {"reputation": 343, "user_id": 2012584, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ojua3.png?s=128&g=1", "display_name": "Rocket Spaceman", "link": "https://stackoverflow.com/users/2012584/rocket-spaceman"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498688829, "post_id": 44813295, "comment_id": 76607670, "body": "Post is edited now to share details, and code examples used, including 404 image link. That is actually one of the tutorials and code snippets I&#39;ve attempted already @TimWilliams I just finished a college class in excel, we didn&#39;t cover very much in VBA, just the basics for seeing macro codes after they are recorded."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498689625, "post_id": 44813295, "comment_id": 76607937, "body": "I just plugged your sample url into <a href=\"https://stackoverflow.com/questions/1542790/msxml2-xmlhttp-request-to-validate-entered-url-in-asp-classic\">this</a> and it reported a 404 error."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 2012584, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ojua3.png?s=128&g=1", "display_name": "Rocket Spaceman", "link": "https://stackoverflow.com/users/2012584/rocket-spaceman"}, "edited": false, "score": 0, "creation_date": 1498690995, "post_id": 44813655, "comment_id": 76608286, "body": "That worked! Thank you so much @TimWilliams! <a href=\"http://i.imgur.com/eSUn4ta.png\" rel=\"nofollow noreferrer\">screenshot</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 343, "user_id": 2012584, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ojua3.png?s=128&g=1", "display_name": "Rocket Spaceman", "link": "https://stackoverflow.com/users/2012584/rocket-spaceman"}, "edited": false, "score": 1, "creation_date": 1498693502, "post_id": 44813655, "comment_id": 76608932, "body": "@LevyImage - If you have 30K rows (per your original post) then you are going to want to make that WinHttp.WinHttpRequest.5.1 <b>static</b> like <a href=\"https://stackoverflow.com/documentation/vba/877/declaring-variables/16978/when-to-use-a-static-variable#t=20170628234448361758\">this</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1498696356, "post_id": 44813655, "comment_id": 76609588, "body": "In addition/alternatively to suggestion from @Jeeped, consider not using a UDF but a Sub instead, to ensure you&#39;re only running each check once."}, {"owner": {"reputation": 343, "user_id": 2012584, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ojua3.png?s=128&g=1", "display_name": "Rocket Spaceman", "link": "https://stackoverflow.com/users/2012584/rocket-spaceman"}, "edited": false, "score": 0, "creation_date": 1498706120, "post_id": 44813655, "comment_id": 76611727, "body": "Do you have any suggestions on how to basically rasterize the column used with this formula to just leave behind the values? When I copy/paste values only, it freezes excel (over 20K rows). If I try to save as a text based file type like CSV, excel also freezes. I&#39;ll read up on what the difference between UDF and Sub, again I&#39;m new to VB, thank you."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1498710513, "last_edit_date": 1498710513, "creation_date": 1498689679, "answer_id": 44813655, "question_id": 44813295, "link": "https://stackoverflow.com/questions/44813295/how-to-do-image-url-validation-in-excel-2016/44813655#44813655", "title": "How to do image url validation in excel 2016?", "body": "<p>This works for me.  It doesn't return a boolean but the actual Status or the error description if there is one during execution:</p>\n\n<pre><code>Public Function IsURLGood(url As String)\n    Dim request As Object\n    Set request = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n    On Error GoTo haveError\n    With request\n        .Open \"HEAD\", url\n        .Send\n        IsURLGood = .Status\n    End With\n    Exit Function\nhaveError:\n    IsURLGood = Err.Description\nEnd Function\n</code></pre>\n\n<p>Quick test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XgWyy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XgWyy.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Instead of running it as a UDF you can do this:</p>\n\n<pre><code>Sub ProcessUrls()\n    Dim c As Range\n    For Each c in Activesheet.Range(\"A1:A20000\").Cells\n        c.Offset(0, 1).Value = IsURLGood(c.Value) 'put result in ColB\n    Next c\nEnd sub\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 2012584, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Ojua3.png?s=128&g=1", "display_name": "Rocket Spaceman", "link": "https://stackoverflow.com/users/2012584/rocket-spaceman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1970, "favorite_count": 1, "accepted_answer_id": 44813655, "answer_count": 1, "score": 1, "last_activity_date": 1498710513, "creation_date": 1498687581, "last_edit_date": 1498690430, "question_id": 44813295, "link": "https://stackoverflow.com/questions/44813295/how-to-do-image-url-validation-in-excel-2016", "title": "How to do image url validation in excel 2016?", "body": "<p>Is there a way to get reported Valid or invalid in excel if an image URL gives a 404 error? <br/>Without opening each image? eg checking header for 404?<br/><br/> here's some snippets I've tried</p>\n\n<pre><code>Function URLExists(url As String) As Boolean\n    Dim Request As Object\n    Dim ff As Integer\n    Dim rc As Variant\n\n    On Error GoTo EndNow\n    Set Request = CreateObject(\"WinHttp.WinHttpRequest.5.1\")\n\n    With Request\n      .Open \"GET\", url, False\n      .Send\n      rc = .StatusText\n    End With\n    Set Request = Nothing\n    If rc = \"OK\" Then URLExists = True\n\n    Exit Function\nEndNow:\nEnd Function\n</code></pre>\n\n<p><br/></p>\n\n<pre><code>Public Function IsURLGood(url As String) As Boolean\n    Dim request As New WinHttpRequest\n\n    On Error GoTo IsURLGoodError\n    request.Open \"HEAD\", url\n    request.Send\n    If request.Status = 200 Then\n        IsURLGood = True\n    Else\n        IsURLGood = False\n    End If\n    Exit Function\n\nIsURLGoodError:\n    IsURLGood = False\nEnd Function\n</code></pre>\n\n<p><br/>\nThese report on all URLS, for me, TRUE. When I check, for example <br/></p>\n\n<pre><code>http://www.bangallawebservices.com/images/BWA22055.jpg\n</code></pre>\n\n<p><br/>\nthese are definitely giving undesired results for return values, the above image is an example of the 404 error that's being counted as a valid URL in excel via these code snippets.</p>\n\n<p><br/>\nI've also tried the free demo of the Office PowerUp addin, with <code>pwrISBROKENURL</code> which returned all false (not broken) when some are in fact broken. Excel is granted full access to internet through firewall.\n<a href=\"https://www.youtube.com/watch?v=HU99-fXNV40\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=HU99-fXNV40</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1498687579, "post_id": 44813156, "comment_id": 76607248, "body": "Could it be due to the lack of a reference to the sheet your <code>str1</code> is on? Make sure to explicitly give the sheet whenever you use a range like <code>Cells()</code>."}, {"owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1498689145, "post_id": 44813156, "comment_id": 76607781, "body": "@BruceWayne You are doing justice to your username. Savior!!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1498689397, "post_id": 44813156, "comment_id": 76607867, "body": "Yeah, that&#39;s always something to be careful of.  Note that you do not need the first <code>...Activate</code> line.  That&#39;s probably what&#39;s partially confusing you/your code. You <code>Activated</code> the Sheet2, but then use <code>With Sheets(&quot;Sheet1&quot;)</code>...so any time it used <code>Cells()</code> unqualified, it was looking at <code>Sheet2()</code>.  Also, replace the <code>ActiveSheet.Cells(...)</code> with <code>Worksheets(&quot;Sheet2&quot;).Cells(2,14)...</code> (assuming it&#39;s &quot;Sheet2&quot; you want). :D"}], "owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 540, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498686897, "creation_date": 1498686897, "question_id": 44813156, "link": "https://stackoverflow.com/questions/44813156/comparing-text-in-cells-in-vba-using-strcomp", "title": "comparing text in cells in vba using strcomp", "body": "<p>I have a matrix of rows and columns with data as string not integer. I have a reference cell which I want to compare with the a particular cell in each row. I have the following code.</p>\n\n<pre><code>`Worksheets(\"Sheet2\").Activate\nWith Sheets(\"Sheet1\")\nstr2 = Cells(1, 14).Value\nFor j = 1 To .Cells(.Rows.Count, 2).End(xlUp).Row\n           str1 = Cells(j, 2).Value\n           result = StrComp(str1, str2, vbBinaryCompare)\n           If result = 0 Then\n             .Range(.Cells(j, 1), .Cells(j, 12)).Copy\n             ActiveSheet.Cells(2, 14).PasteSpecial Transpose:=True\n           End If\nNext j\nEnd With`\n</code></pre>\n\n<p>The problem is it is telling me that every comparison is true. Where am I going wrong?</p>\n"}, {"tags": ["excel", "vba", "count", "rows", "copy-paste"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 3, "creation_date": 1498686512, "post_id": 44813022, "comment_id": 76606800, "body": "<code>Cells(Application.Rows.Count, 1).End(xlUp).EntireRow.Select</code> should start you off. Also no need to select stuff"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 1, "creation_date": 1498687540, "post_id": 44813022, "comment_id": 76607229, "body": "To expand on @MacroMarc&#39;s last sentence, it&#39;s <b>highly</b> suggested to <a href=\"https://stackoverflow.com/questions/10714251/\">avoid using <code>.Select</code>/<code>.Activate</code></a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1498698914, "post_id": 44813022, "comment_id": 76610131, "body": "fwiw, if you are indeed looking from the bottom up to find the last used row, you do not have to .Insert 13 new rows before filling the next 13 blank rows with values/formulas."}], "answers": [{"tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 1, "last_activity_date": 1498688172, "creation_date": 1498688172, "answer_id": 44813410, "question_id": 44813022, "link": "https://stackoverflow.com/questions/44813022/select-entire-last-row/44813410#44813410", "title": "Select Entire Last Row", "body": "<p>You need to resize it</p>\n\n<pre><code>Sub temp()\n    Dim lr As Long\n    lr = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Rows(lr).Copy\n    Range(\"A\" &amp; lr).Resize(14, Columns.Count).PasteSpecial xlPasteAll\nEnd Sub\n</code></pre>\n\n<p>Don't select things, it's very bad practice.</p>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1498695872, "post_id": 44814371, "comment_id": 76609466, "body": "Nice Jeeped :)."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1498694892, "creation_date": 1498694892, "answer_id": 44814371, "question_id": 44813022, "link": "https://stackoverflow.com/questions/44813022/select-entire-last-row/44814371#44814371", "title": "Select Entire Last Row", "body": "<p>You could 'select' the multiple rows with a .Resize then Fill Down.</p>\n\n<pre><code>dim rws as long\nrws = 14   'total # of rows 3:16\nwith worksheets(\"sheet1\")\n    .cells(.rows.count, \"A\").end(xlup).resize(rws, .columns.count).filldown\nend with\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1387, "favorite_count": 0, "accepted_answer_id": 44814371, "answer_count": 2, "score": 1, "last_activity_date": 1498694892, "creation_date": 1498686170, "last_edit_date": 1498687310, "question_id": 44813022, "link": "https://stackoverflow.com/questions/44813022/select-entire-last-row", "title": "Select Entire Last Row", "body": "<p>I am trying to get my code to find the last row in a sheet and copy THE WHOLE ROW and paste it below. Currently I have: </p>\n\n<pre><code>Cells(Application.Rows.Count, 1).End(xlUp).Select\nSelection.Copy\nCells(Application.Rows.Count, 1).End(xlUp).Offset(1, 0).Select\nSelection.Insert Shift:=xlDown\n Application.CutCopyMode = False\n</code></pre>\n\n<p>Which is great at finding the last cell in the row, however when it copies/pastes this, it's only grabbing that first cell. SO, what I'm wondering is if you can use this code to find the last row and then SELECT the ENTIRE row, and then copy/paste it below. Keep in mind I can't just type </p>\n\n<pre><code>Rows(\"3:3\").Select\nSelection.Copy\nRows(\"4:4\").Select\nSelection.Insert Shift:=xlDown\n</code></pre>\n\n<p>Because the row will be variable. Thanks!</p>\n\n<pre><code>Dim lastRow As Long\n\nlastRow = Cells(Application.Rows.Count, 1).End(xlUp).Row\n\n Rows(lastRow).Select\n Selection.Copy\n Rows(lastRow).Offset(1, 0).Select\n Selection.Insert Shift:=xlDown\n Application.CutCopyMode = False\n</code></pre>\n\n<p>The code above will find the last row, select it, copy it, and paste it below. However, I need to copy the last row and paste it in several rows below it in some cases, so:</p>\n\n<pre><code>  Rows(\"3:3\").Select\nSelection.Copy\nRows(\"4:16\").Select\nSelection.Insert Shift:=xlDown\n</code></pre>\n\n<p>Something to that effect, however I'm not able to paste the selected row in several rows because</p>\n\n<pre><code> Rows(lastRow:4).Select\n</code></pre>\n\n<p>freaks it out. Is there any way to add that \"16\" to the last row so it copies the row and pastes it into the next 14 rows, etc.?</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1498688137, "post_id": 44812753, "comment_id": 76607441, "body": "Have you tried adding a ORDER BY clause to your SELECT string?"}, {"owner": {"reputation": 3, "user_id": 6872920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755cfccce7fefd5c134ac92e53f3f19?s=128&d=identicon&r=PG&f=1", "display_name": "cowboyish1", "link": "https://stackoverflow.com/users/6872920/cowboyish1"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1498690134, "post_id": 44812753, "comment_id": 76608086, "body": "I have, right after GCRITERIA, but perhaps I did not format it correctly. ??"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1498728080, "post_id": 44812753, "comment_id": 76622276, "body": "Would it not be better to apply a filter and order by on the form rather than changing the record source?"}, {"owner": {"reputation": 3, "user_id": 6872920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755cfccce7fefd5c134ac92e53f3f19?s=128&d=identicon&r=PG&f=1", "display_name": "cowboyish1", "link": "https://stackoverflow.com/users/6872920/cowboyish1"}, "edited": false, "score": 0, "creation_date": 1498744314, "post_id": 44812753, "comment_id": 76634343, "body": "I&#39;m not trying to change the record source. I just want the records returned to be sorted. When I add an ORDER BY statement to the form, it works when the form is viewed, but it does not work when the form is searched. I&#39;m not sure how to apply a filter to the form. Maybe a filter WITH and Order By on the form would work??"}], "answers": [{"comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 3, "user_id": 6872920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755cfccce7fefd5c134ac92e53f3f19?s=128&d=identicon&r=PG&f=1", "display_name": "cowboyish1", "link": "https://stackoverflow.com/users/6872920/cowboyish1"}, "edited": false, "score": 0, "creation_date": 1498755340, "post_id": 44819237, "comment_id": 76642297, "body": "Debug your GCriteria string."}, {"owner": {"reputation": 3, "user_id": 6872920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755cfccce7fefd5c134ac92e53f3f19?s=128&d=identicon&r=PG&f=1", "display_name": "cowboyish1", "link": "https://stackoverflow.com/users/6872920/cowboyish1"}, "edited": false, "score": 0, "creation_date": 1498755790, "post_id": 44819237, "comment_id": 76642576, "body": "That&#39;s what I&#39;ve been attempting to do for the past couple of days with no luck."}, {"owner": {"reputation": 3, "user_id": 6872920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755cfccce7fefd5c134ac92e53f3f19?s=128&d=identicon&r=PG&f=1", "display_name": "cowboyish1", "link": "https://stackoverflow.com/users/6872920/cowboyish1"}, "edited": false, "score": 0, "creation_date": 1498757930, "post_id": 44819237, "comment_id": 76643845, "body": "That did it, my friend :)! Thanks for sticking in there to help a guy with limited VBA skills. Much appreciated!"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1498756418, "last_edit_date": 1498756418, "creation_date": 1498722573, "answer_id": 44819237, "question_id": 44812753, "link": "https://stackoverflow.com/questions/44812753/how-do-i-add-an-order-by-statement-to-a-vba-search-function/44819237#44819237", "title": "How Do I add an ORDER BY statement to a VBA Search Function", "body": "<p>This should do:</p>\n\n<pre><code>Dim Sql As String\n\nSql = \"select * from qry_crystals_specimens_formsearchDNC where \" &amp; GCriteria &amp; \" order by LastName, FirstName, ID\"\n\nDebug.Print Sql\n\nForm_frm_crystals_specimens_master.RecordSource = Sql\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6872920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7755cfccce7fefd5c134ac92e53f3f19?s=128&d=identicon&r=PG&f=1", "display_name": "cowboyish1", "link": "https://stackoverflow.com/users/6872920/cowboyish1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 44819237, "answer_count": 1, "score": 0, "last_activity_date": 1594639655, "creation_date": 1498684937, "last_edit_date": 1594639655, "question_id": 44812753, "link": "https://stackoverflow.com/questions/44812753/how-do-i-add-an-order-by-statement-to-a-vba-search-function", "title": "How Do I add an ORDER BY statement to a VBA Search Function", "body": "<p>I have an Access 2010 Form in which I have a Search \"button.\" The Search works perfectly, but I would like it to return records ordered by ID, LastName, FirstName, and I can't figure out how to do it. Below is the working VBA that I am currently using. Any help is greatly appreciated></p>\n\n<pre><code>Private Sub SearchCrystals_Click()\nIf Len(cboSearchField) = 0 Or IsNull(cboSearchField) = True Then\n        MsgBox \"You must select a field to search.\"\n\n    ElseIf Len(txtSearchString) = 0 Or IsNull(txtSearchString) = True Then\n        MsgBox \"You must enter a search string.\"\n\n    Else\n\n        'Generate search criteria\n        GCriteria = cboSearchField.Value &amp; \" LIKE '*\" &amp; txtSearchString &amp; \"*'\"\n\n        'Filter qry_crystals_specimens_formsearchDNC based on search criteria\n        Form_frm_crystals_specimens_master.RecordSource = \"select * from qry_crystals_specimens_formsearchDNC where \" &amp; GCriteria\n        Form_frm_crystals_specimens_master.Caption = \"qry_crystals_specimens_formsearchDNC (\" &amp; cboSearchField.Value &amp; \" contains '*\" &amp; txtSearchString &amp; \"*')\"\n\n        'Close frmSearch\n        DoCmd.Close acForm, \"frm_search_crystals_specimens\"\n\n        MsgBox \"Results have been filtered.\"\n\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 2, "last_activity_date": 1498684957, "creation_date": 1498684957, "answer_id": 44812762, "question_id": 44812686, "link": "https://stackoverflow.com/questions/44812686/reference-cell-location-with-variable/44812762#44812762", "title": "Reference cell location with variable", "body": "<p>Use <code>R1C1</code> notation for this:</p>\n\n<pre><code>if Cells(jj, 2) = \"Some Criteria\" Then Cells(jj, 3).FormulaR1C1 = \"=RC1^2\"\n</code></pre>\n\n<p>or you could calculate an <code>A1</code> notation formula such as</p>\n\n<pre><code>if Cells(jj, 2) = \"Some Criteria\" Then Cells(jj, 3).Formula = \"=$A\" &amp; jj &amp; \"^2\"\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7602580, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4a35655945c9bba66d00509b6d53d0cd?s=128&d=identicon&r=PG&f=1", "display_name": "Omar123456789", "link": "https://stackoverflow.com/users/7602580/omar123456789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1448, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498684957, "creation_date": 1498684679, "last_edit_date": 1531164843, "question_id": 44812686, "link": "https://stackoverflow.com/questions/44812686/reference-cell-location-with-variable", "title": "Reference cell location with variable", "body": "<p>I need to reference a cell location with a variable, here is the code:</p>\n\n<pre><code> Dim jj As Integer\n jj = 1\n Do While jj &lt;= x\n      if Cells(jj, 2) = \"Some Criteria\" Then Cells(jj, 3).Formula = \"=Cells(jj,1)^2\"\n      jj = jj + 1\n      Else\n      jj = jj + 1\n      End If\n Loop\n</code></pre>\n\n<p>The problem is that the value in cell C1 (i.e. when cells(jj, 3) when jj =1) literally reads =Cells(jj,1)^2 which results in an error because excel outside of VBA does not recognized cells(jj,3) as a formula or any kind of value. </p>\n\n<p>I need to cycle through the rows moving down. Is there anyway to do accomplish this and insert a formula into a cell that references a cell location with a variable as the row? </p>\n\n<p>Thanks! Anything helps!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498683256, "post_id": 44812313, "comment_id": 76605329, "body": "Yes, call the second macro and pass the workbook(s) through to that macro, then you should be able to &quot;reset&quot; the variables and go from there."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1498684069, "post_id": 44812313, "comment_id": 76605729, "body": "If you close the Workbook that originated the code call the code itself will close. AFAIK there is no way to pass execution to another workbook and then be able to close the originating workbook."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1498685499, "post_id": 44812313, "comment_id": 76606381, "body": "I&#39;m not sure if I completely understand your question, but you could put the VBA you are running in your personal macro workbook.  Then you can run it without the code being dependent on a specific workbook."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498688602, "post_id": 44812313, "comment_id": 76607591, "body": "@ScottHoltzman - Ah yeah, I was just starting to write a way to do what I meant, and realized that when I close the workbook with the macro, of course the macro stops! :P"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498688790, "post_id": 44812313, "comment_id": 76607652, "body": "Perhaps this is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a>. <i>Why</i> do you want to close the workbook and continue the same macro? Couldn&#39;t you write the first half of the macro, then call a second macro that picks up after the first?  Or, just hide the first workbook until the single macro is done, and <i>then</i> close it?"}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1498690470, "post_id": 44812313, "comment_id": 76608161, "body": "@ScottHoltzman - That what I though (pass execution is not possible). But I was surprised not to find such a question here."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498690577, "post_id": 44812313, "comment_id": 76608195, "body": "@BruceWayne - I updated the question to add what I&#39;m trying to do. Hiding such a big workbook is not an option and would left me with the same problem next time."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1498690928, "post_id": 44812313, "comment_id": 76608269, "body": "&quot;...tell the user it can now close WbA and open WB and import the data back.&quot; - do you mean import the data back to WbA? ...Hm, what if you instead ran this from Personal.xlsb and went from there? Instead of storing this in WbA.  Or am I correct in Assuming you can&#39;t simply add this to people&#39;s Personal.xlsbs.  ...maybe run it from an Add-on?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1498692345, "post_id": 44812313, "comment_id": 76608652, "body": "@BruceWayne that. This is an application-level problem in need of an application-level solution. A nicely written Excel add-in could handle this much better."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498693571, "post_id": 44812313, "comment_id": 76608945, "body": "@BruceWayne - No, opening WbB then importing user data in WbB. - I&#39;m not willing to use Personal.xlsb (and putting it in XLSTART...) since I don&#39;t want this big Wb to load everytime a user launch Excel (but only when needed) and since I&#39;m not willing to modify user&#39;s Personal.xlsb. And regarding my problem of updating the macro, having it in XLSTART would probably make it more difficult. Regarding Add-On, I don&#39;t know much about that but wouldn&#39;t updating the Add-On be complicated too ?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498694699, "post_id": 44812313, "comment_id": 76609197, "body": "You write it so that it <i>doesn&#39;t</i> need to be updated to handle a new version of WbA/WbB."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1498696944, "post_id": 44812313, "comment_id": 76609717, "body": "The best idea is, as @Mat&#39;sMug says, to use an add-in for the macros (and probably load those macros all the time), but I would keep the data in a separate workbook/s and only open it/them when it/they need to be used.  (i.e. the <code>xlam</code> should only contain the code and, perhaps, sheets containing lookup tables used to simplify coding - but any data, or anything the user can change / configure, would be in the data workbooks.)  And if the macros are updated to handle a new format of the data workbook, include code that automatically updates old format workbooks."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1498719767, "post_id": 44812313, "comment_id": 76616760, "body": "I should clearly separate <code>code</code> vs <code>user data &amp; parameters</code> (and make it a real VB application). Actually, the macro do uses a <code>parameters folder</code> (C:/Temp/myMacro since it doesn&#39;t need any folder permission), for debug logging, error logging, temporary user data, downloads... It also make use of a read only <code>network folder</code> for updating lookup tables and databases... Having the code in a <code>xlam Add-In</code> would make sense considering the <code>application-level</code> vs <code>Wb-level</code> discussion, but if the <code>Add-In</code> contains all the code, wouldn&#39;t that make it more difficult to update the code and userfoms ?"}], "answers": [{"comments": [{"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1498690770, "post_id": 44812719, "comment_id": 76608240, "body": "That doesn&#39;t fit my problem. I&#39;m trying to pass execution and kill WbA, not just halt execution for a while..."}], "tags": [], "owner": {"reputation": 116, "user_id": 7127458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63cdf0112f5ca43f329d6a4db1796855?s=128&d=identicon&r=PG&f=1", "display_name": "Bad_Mama_Jama", "link": "https://stackoverflow.com/users/7127458/bad-mama-jama"}, "is_accepted": false, "score": -3, "last_activity_date": 1498685367, "last_edit_date": 1498685367, "creation_date": 1498684824, "answer_id": 44812719, "question_id": 44812313, "link": "https://stackoverflow.com/questions/44812313/passing-vba-execution-to-another-workbook/44812719#44812719", "title": "Passing VBA execution to another workbook", "body": "<p>You just have to leave workbook A open while the code runs, the last line of code you need to execute should be </p>\n\n<pre><code>WorkbookA.Close\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1498686559, "post_id": 44813061, "comment_id": 76606819, "body": "Ok, I&#39;m forced to upvote this. But I <b>have</b> to say this kind of circular-referencing code is completely disgusting and I would be <b>very</b> mad at whoever used this trick in production code. That hack defies the VBA call stack logic, defies common sense, defies everything that&#39;s good in the world."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1498686684, "post_id": 44813061, "comment_id": 76606864, "body": "@Mat&#39;sMug You should know by now that I have no logic (even if VBA does have call stack logic), that I have no common sense, and that I (and everything else in the world) can&#39;t be called &quot;good&quot;. :D"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498686970, "post_id": 44813061, "comment_id": 76606996, "body": "@OP FWIW the <i>real</i> reason I dislike this solution is because <code>WbB.xlsm</code> has no business knowing about <code>WbA.xlsm</code> - the Golden Rule is that the object that creates something, is responsible for destroying that thing. So if A creates B, then B can&#39;t destroy A - it&#39;s A&#39;s responsibility to destroy B, by any programming standards."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498687115, "post_id": 44813061, "comment_id": 76607060, "body": "@Mat&#39;sMug - Edited answer so that <code>WbB.xlsm</code> knows nothing about <code>WbA.xlsm</code>.  (It&#39;s actually how I originally tested it, but I decided to move the close into <code>WbB.xlsm</code> just to ensure that it worked there too, and that&#39;s how it was when I pasted the code into the answer.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498687162, "post_id": 44813061, "comment_id": 76607081, "body": "That&#39;s <b>much</b> better!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498687387, "post_id": 44813061, "comment_id": 76607168, "body": "@Mat&#39;sMug Simplified it even more.  (I wasn&#39;t sure whether <code>OnTime</code> would handle a call to another workbook, but it does.)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1498688678, "post_id": 44813061, "comment_id": 76607616, "body": "...Wow, this is neat/crazy.  And also, I think I <a href=\"https://i.imgur.com/2Qgxpp4.png\" rel=\"nofollow noreferrer\">found a picture of you</a> writing this answer."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1498688798, "post_id": 44813061, "comment_id": 76607656, "body": "@BruceWayne People in my office are going to wonder what I am laughing about.  They might actually work out that I&#39;m not doing what I am being paid to do - so stop posting those pics! :D"}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1498691375, "post_id": 44813061, "comment_id": 76608380, "body": "I had a self updating sheet a while ago, upon open it would look for an open workbook with the same name and _old at the end and close it without save (this is incase it had just self updated). Then it would check for a new version, if it existed then it would rename itself to have _old at the end which didn&#39;t stop any code running, it would then copy the new one then the last thing the auto_open macro did was open the new one."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1498691527, "post_id": 44813061, "comment_id": 76608422, "body": "@YowE3K - Forget to mention I&#39;d also need to pass some args to WbB (the location (WbC) of user data exported from WbA that need to be imported back in WbB). I don&#39;t think OnTime would let me do that (but I could export the location into some config file or stored those data in a know location)"}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498691702, "post_id": 44813061, "comment_id": 76608465, "body": "@Mat&#39;sMug - About to golden rule. Actually, next step would actually be WbB killing (ie destroying) WbA since WbB would become the new WbA (if that make any sense, see my edit about what I&#39;m trying to do)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 1, "creation_date": 1498692228, "post_id": 44813061, "comment_id": 76608616, "body": "@Tibo Ah, I see now. You see a macro is meant to operate at workbook level, and IMO the problem you&#39;re solving is at application level - I&#39;ll try to spare a minute to write up a more idiomatic solution tonight."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498692986, "post_id": 44813061, "comment_id": 76608806, "body": "@Mat&#39;sMug. This should totally be an application rather than a wb. We actually asked our external dev team if they could include an equivalent of my &#39;macro&#39; in our Information System, but due to time constraint (+ an expected life time of the &#39;macro&#39; of less than 10 months), I&#39;m stuck with do what I can with Excel. I&#39;m not sure of what an &quot;idiomatic solution&quot; means and looks like. Please, let me understand what that means before writing any code. (Another constraint is I need to be able to understand/update... the whole solution)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1498693266, "post_id": 44813061, "comment_id": 76608873, "body": "@Tibo very simple: make it an Excel add-in; it loads with Excel, and closes with Excel. I have ideas about how to deal with the versioning so that you don&#39;t need to redeploy the add-in every time a new version is issued, but essentially, move the app-level code to its own workbook and then Save As &quot;Excel Add-in&quot; - and then you can have fancypants buttons in the Ribbon to run your add-in code."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498694462, "post_id": 44813061, "comment_id": 76609147, "body": "@Mat&#39;sMug. The macro being rather big (20 sheets + 10 code modules + 10 userforms), I don&#39;t it to be launched with Excel but only when the user need it. To do so, maybe I could include in the Add-In only the fraction of the code needed to check if a new version of the macro in available on the network... But then I&#39;m stuck with how to update the Add-In. (One reason to deploy the update could be that the network directory is expected to change in the next few days). I do use a personal xlam Add-In and Ribbon but I&#39;m not sure if Add-In is easy to deal with when distributing it..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498694590, "post_id": 44813061, "comment_id": 76609166, "body": "Huh, I used to run and distribute an Excel add-in with over 70 class modules. Not sure what the problem is here."}, {"owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "edited": false, "score": 0, "creation_date": 1498695026, "post_id": 44813061, "comment_id": 76609271, "body": "The Wb take about 6Mo, have about 150 Public Const, load big 2D arrays in memory, have 20 sheets with formatting... so I&#39;d rather not have it loaded unless when necessary. (Note there aren&#39;t any class module since I have know idea about what it is used for...)"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 2, "last_activity_date": 1498688487, "last_edit_date": 1498688487, "creation_date": 1498686353, "answer_id": 44813061, "question_id": 44812313, "link": "https://stackoverflow.com/questions/44812313/passing-vba-execution-to-another-workbook/44813061#44813061", "title": "Passing VBA execution to another workbook", "body": "<p>You can do this by using <code>Application.OnTime</code>:</p>\n\n<p>Code in WbA.xlsm:</p>\n\n<pre><code>Sub Macro1()\n    Application.OnTime Now(), \"WbB.xlsm!Macro2\"\n    ThisWorkbook.Close\nEnd Sub\n</code></pre>\n\n<p>Code in WbB.xlsm:</p>\n\n<pre><code>Sub Macro2()\n    MsgBox ThisWorkbook.Name &amp; \" says hello\"\nEnd Sub\n</code></pre>\n\n<p>Because <code>Macro2</code> is being called by the Application via a scheduled task, it no longer needs WbA to be open.</p>\n\n<hr>\n\n<p>Note:  <code>WbB.xlsm</code> does not even need to be open when <code>Macro1</code> is run, providing you fully qualify the workbook name:</p>\n\n<p>Code in WbA.xlsm:</p>\n\n<pre><code>Sub Macro1()\n    Application.OnTime Now(), \"'C:\\Temp\\SO_Test\\WbB.xlsm'!Macro2\"\n    ThisWorkbook.Close\nEnd Sub\n</code></pre>\n\n<p>Code in WbB.xlsm:</p>\n\n<pre><code>Sub Macro2()\n    MsgBox ThisWorkbook.Name &amp; \" says hello\"\nEnd Sub\n</code></pre>\n\n<p>Assuming <code>WbA.xlsm</code> was the only workbook open in Excel when <code>Macro1</code> was run, you might actually see an empty Excel for a very short time before <code>WbB.xlsm</code> is opened and execution continues.</p>\n"}], "owner": {"reputation": 384, "user_id": 4021742, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/cfccc79ddd782f8d13a88715aebcd061?s=128&d=identicon&r=PG", "display_name": "Tibo", "link": "https://stackoverflow.com/users/4021742/tibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 44813061, "answer_count": 2, "score": 2, "last_activity_date": 1498693077, "creation_date": 1498682976, "last_edit_date": 1498693077, "question_id": 44812313, "link": "https://stackoverflow.com/questions/44812313/passing-vba-execution-to-another-workbook", "title": "Passing VBA execution to another workbook", "body": "<p>I though there would be many answers to this question, but didn't find any obvious one.</p>\n\n<p>Is it possible to pass VBA execution to another workbook ?</p>\n\n<p>What I'd like to do is : pass execution from <code>ThisWorbook</code> (WbA) to another workbook (WbB, ie make WbB the new <code>ThisWorkook</code>), then close Wb A.</p>\n\n<h2>Edit</h2>\n\n<p><strong>What I'm actually trying to do...</strong></p>\n\n<p>I'm looking for a way to update a workbook I'm distributing to a few people and which contains 20 sheets + 10 code modules + 10 userforms.</p>\n\n<p><strong>My current solution</strong></p>\n\n<p>Every time the workbook (WbA) is open, the code will first check if a newer version is available on a network directory. If so, the macro propose to the user to automatically download/save the new workbook (WbB) and export user data from WbA.</p>\n\n<p>But, after that, I'm forced to tell the user it can now closed WbA and open WbB and import the data back in WbB.</p>\n\n<p>I'd rather automate the close WbA / open WbB / import data back too.</p>\n"}, {"tags": ["vba", "excel", "range", "ms-office"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498684633, "post_id": 44812209, "comment_id": 76605958, "body": "When <code>currentColumn</code> is <code>2</code>, do you still want to sum the five columns to the left of it (i.e. column <code>A</code>, column <code>0</code>, column <code>-A</code>, column <code>-B</code>, and column <code>-C</code>, of which only column <code>A</code> will be valid)?  And note that <code>Range</code>, <code>Cells</code> and <code>Rows</code> in your code are referring to the <code>ActiveSheet</code>, which may or may not be <code>Sheets(&quot;SLTData&quot;)</code>.  (You should always qualify references to <code>Range</code>, <code>Cells</code>, <code>Rows</code>, etc.)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8228383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35f62a6928312a63696359a28625843?s=128&d=identicon&r=PG&f=1", "display_name": "nikedude", "link": "https://stackoverflow.com/users/8228383/nikedude"}, "edited": false, "score": 0, "creation_date": 1498684074, "post_id": 44812397, "comment_id": 76605733, "body": "AWESOME!  Thank You!"}], "tags": [], "owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "is_accepted": true, "score": 1, "last_activity_date": 1498684086, "last_edit_date": 1498684086, "creation_date": 1498683307, "answer_id": 44812397, "question_id": 44812209, "link": "https://stackoverflow.com/questions/44812209/vba-add-new-column-then-copy-cells-and-then-sum-cells/44812397#44812397", "title": "VBA - Add new Column then COPY cells and then SUM cells", "body": "<p>Instead of <code>Range(\"G\" &amp; i)</code> use <code>Cells(row, column)</code> (both row and column are integer). To sum up the 5 cells left of it: <code>Cells(row, column) = WorksheetFunction.Sum(Range(Cells(row, column-5), Cells(row, column-1)))</code></p>\n"}], "owner": {"reputation": 13, "user_id": 8228383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f35f62a6928312a63696359a28625843?s=128&d=identicon&r=PG&f=1", "display_name": "nikedude", "link": "https://stackoverflow.com/users/8228383/nikedude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 655, "favorite_count": 0, "accepted_answer_id": 44812397, "answer_count": 1, "score": 0, "last_activity_date": 1498684086, "creation_date": 1498682557, "question_id": 44812209, "link": "https://stackoverflow.com/questions/44812209/vba-add-new-column-then-copy-cells-and-then-sum-cells", "title": "VBA - Add new Column then COPY cells and then SUM cells", "body": "<p>I am attempting to create a new column that consolidates multiple values into a single Column. The code below has no problems creating a new column exactly where I need it. </p>\n\n<p>Within each newly created column however, I would like my code to Sum the previous 5 cells within the same row. It works currently, but is static(The new column is G in the below example, and it sums B:F). I think I need some sort of Offset function built into it to allow the Range it sums to be dynamic (Previous 5 columns), as it loops through the entire sheet.</p>\n\n<p>Additionally, I would love it to copy the Header information from rows 1-9 from the column to the left of the new column, into the new column, and place the word \"Combo\" into Row 10 of the new column.</p>\n\n<p>Office 2013</p>\n\n<p>Any help with this endeavor would be great.\nThanks</p>\n\n<pre><code>Dim currentColumn As Integer\nDim columnHeading As String\n\nFor currentColumn = Sheets(\"SLTData\").UsedRange.Columns.Count To 2 Step -1\n\ncolumnHeading = Sheets(\"SLTData\").UsedRange.Cells(10, currentColumn).Value\n\n'CHECK WHETHER TO KEEP THE COLUMN\nSelect Case columnHeading\n    Case \"PD.G0100\", \"PD.G0500\", \"PD.G0800\", \"PD.G0900\", \"PD.G1000\", \"PD.G0300\", \"PD.G0400\", \"PD.G0150\", \"PD.G0600\"\n        'Do nothing\n    Case Else\n\n        If InStr(1, _\n           Sheets(\"SLTData\").UsedRange.Cells(10, currentColumn).Value, _\n           \"Homer\", vbBinaryCompare) = 0 Then\n\n\n            Sheets(\"SLTData\").Columns(currentColumn).Insert\n                For i = 11 To Cells(Rows.Count, \"B\").End(xlUp).Row\n                Range(\"G\" &amp; i) = WorksheetFunction.Sum(Range(\"B\" &amp; i), Range(\"C\" &amp; i), Range(\"D\" &amp; i), Range(\"E\" &amp; i), Range(\"F\" &amp; i))\n                Next i\n        End If\nEnd Select\nNext\n</code></pre>\n"}, {"tags": ["python", "vba", "excel", "shell"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498682900, "post_id": 44812085, "comment_id": 76605143, "body": "Nic I do not work with Py but based on what you said in the last line, I would double check what <code>Program</code> is evaluating to? <code>Program = Join(args, &quot; &quot;)</code> you may want to put a breakpoint there and check?"}, {"owner": {"reputation": 2140, "user_id": 4570230, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/I2tMC.jpg?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/4570230/nicholas"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498686946, "post_id": 44812085, "comment_id": 76606986, "body": "@SiddharthRout I edited my post based on your comment."}, {"owner": {"reputation": 2140, "user_id": 4570230, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/I2tMC.jpg?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/4570230/nicholas"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498691482, "post_id": 44812085, "comment_id": 76608406, "body": "@SiddharthRout It looks like the reason is I cannot have folder whose name has space. As I recalled, I moved my relevant files to the folder <code>Insurance Project\\Health Insurance Company Regression</code> today. Now I changed &quot;Insurance Project&quot; to &quot;Insurance_Project&quot; and &quot;Health Insurance Company Regression&quot; to &quot;Health_Insurance_Company_Regression&quot;, then things started to work. But do you know if this is an issue caused by Excel VBA rather than my Python and Anaconda? I would like to exclude this possibility."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498718545, "post_id": 44812085, "comment_id": 76616027, "body": "This is not a bug. You need to pad the spaces with double quotes. If you search stackoverflow, you will see lot of questions on this :) \u2013"}], "owner": {"reputation": 2140, "user_id": 4570230, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/I2tMC.jpg?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/4570230/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 846, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1498691701, "creation_date": 1498682099, "last_edit_date": 1498691701, "question_id": 44812085, "link": "https://stackoverflow.com/questions/44812085/vba-shell-function-fails-to-execute-python-script", "title": "VBA Shell function fails to execute Python script", "body": "<p>I tried to execute Python script using the VBA code below (please run <code>sub Test()</code>),</p>\n\n<pre><code>Option Explicit\n\n#If VBA7 And Win64 Then\n    Declare PtrSafe Function OpenProcess Lib \"kernel32\" _\n    (ByVal dwDesiredAccess As Long, _\n     ByVal bInheritHandle As Long, _\n     ByVal dwProcessId As Long) As Long\n\n    Declare PtrSafe Function GetExitCodeProcess Lib \"kernel32\" _\n    (ByVal hProcess As Long, lpExitCode As Long) As Long\n#Else\n    Declare Function OpenProcess Lib \"kernel32\" _\n    (ByVal dwDesiredAccess As Long, _\n     ByVal bInheritHandle As Long, _\n     ByVal dwProcessId As Long) As Long\n\n    Declare Function GetExitCodeProcess Lib \"kernel32\" _\n    (ByVal hProcess As Long, lpExitCode As Long) As Long\n#End If\n\nConst interpreter_path As String = \"C:\\Users\\dongm\\Anaconda2\\python.exe\"\n\n\nSub Test()\n    RegressAndWait \"Output\"\nEnd Sub\n\nPrivate Sub RegressAndWait(ByVal output_folder_name As String)\n\n    Dim TaskID As Long, hProc As Long, lExitCode As Long\n    Dim ACCESS_TYPE As Integer, STILL_ACTIVE As Integer\n\n    ACCESS_TYPE = &amp;H400\n    STILL_ACTIVE = &amp;H103\n\n    Dim Program As String, args(1 To 5) As String\n    args(1) = interpreter_path\n    args(2) = ThisWorkbook.path &amp; \"\\regressions.py\"\n    args(3) = \"\"\"\" &amp; \"dummy\" &amp; \"\"\"\"\n    args(4) = \"\"\"\" &amp; \".\" &amp; \"\"\"\"\n    args(5) = \"\"\"\" &amp; output_folder_name &amp; \"\"\"\"\n    Program = Join(args, \" \")\n\n    ChDir ThisWorkbook.path\n    TaskID = Shell(Program, vbNormalFocus)\n    hProc = OpenProcess(ACCESS_TYPE, False, TaskID)\n    If Err &lt;&gt; 0 Then\n        MsgBox \"Cannot run regressions.py\", vbCritical, \"Error\"\n        Exit Sub\n    End If\n    Do\n        GetExitCodeProcess hProc, lExitCode\n        DoEvents\n    Loop While lExitCode = STILL_ACTIVE\nEnd Sub\n</code></pre>\n\n<p>After running <code>sub Test()</code>, I can see the prompt window flashes and then exits as if the prompt window is opened but never used (I can't see if there is any message written to the prompt window since it disappears really fast). </p>\n\n<p>However, I can run the python script manually without using VBA by opening <code>Anaconda Prompt</code> window, and then <code>cd</code> to my current folder address (why <code>ChDir ThisWorkbook.path</code>), and then enter <code>python regressions.py \"dummy\" \".\"</code> to the prompt window to run the python script.</p>\n\n<p>My VBA code is basically just repeating what I have done manually, but why it doesn't work?</p>\n\n<p>In addition, it's very strange that my code used to work well, but this morning I just found that it no longer works.</p>\n\n<hr>\n\n<p>FYI, I stepped into <code>Program</code> using debugger before jumping into the <code>Shell</code> function, the <code>?Program</code> in the immediate window gives me</p>\n\n<p><code>C:\\Users\\dongm\\Anaconda2\\python.exe C:\\Company\\Insurance Project\\Health Insurance Company Regression\\regressions.py \"dummy\" \".\" \"Output\"</code> </p>\n\n<hr>\n\n<p>After some manipulation, it seems that the reason that I am no longer able to call Python script is because I have folder that has space in its name. As I recalled, I moved the relevant files this morning to a different directory. I just changed <code>Insurance Project</code> to <code>Insurance_Project</code> and <code>Health Insurance Company Regression</code> to <code>Health_Insurance_Company_Regression</code>, then everything backs to normal. This is really an interesting bug, which I have never seen before, but I wonder what can cause this. Excel VBA or Python and Anaconda?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1498681863, "post_id": 44811937, "comment_id": 76604647, "body": "Not sure off the top of my head but I&#39;m wagering that a single <i>point</i> object (e.g., <code>Points(j)</code> doesn&#39;t have a <code>DataLabels</code> collection. Try simply <code>.SeriesCollection(j).DataLabels.Count</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "edited": false, "score": 0, "creation_date": 1498685921, "post_id": 44812222, "comment_id": 76606543, "body": "First thing i&#39;ll try tomorow at work! Thank you sir :)"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1498682614, "creation_date": 1498682614, "answer_id": 44812222, "question_id": 44811937, "link": "https://stackoverflow.com/questions/44811937/run-time-error-438-while-looping-through-every-charts-of-a-sheet/44812222#44812222", "title": "Run-time error &#39;438&#39; While looping through every charts of a sheet", "body": "<p>You can't iterate over the <code>Points(j).DataLabels</code> because <code>Point</code> object doesn't have a <code>DataLabels</code> property.</p>\n\n<p>Try this (modified to not <em>delete</em> the caption just use an empty string):</p>\n\n<pre><code>Dim cObj As ChartObject, cht As Chart, srs As Series, p As Integer\nFor Each cObj In ActiveSheet.ChartObjects\n    Set cht = cObj.Chart\n    With cht\n        For Each srs In .SeriesCollection\n            If srs.HasDataLabels Then\n                For p = 1 To srs.Points.Count\n                    If srs.Points(p).HasDataLabel Then\n                        If srs.DataLabels.Item(p).Caption = \"#N/A\" Then\n                            srs.DataLabels.Item(p).Caption = \"\"\n                        End If\n                    End If\n                Next\n            End If\n        Next\n    End With\nNext\n</code></pre>\n\n<p>Try deleting from a collection and you'll run in to errors unless you do it in reverse index (which is possible, but not necessary in this case when you can just use an empty string).</p>\n\n<p>Also added some logic to ensure you don't hit error if a DataLabel has already been deleted (i.e., it's possible for <code>srs.HasDataLabel</code> to be <code>True</code> while it can be <code>False</code> for an individual <code>Point</code> in the series.</p>\n"}], "owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 44812222, "answer_count": 1, "score": -1, "last_activity_date": 1498682614, "creation_date": 1498681471, "question_id": 44811937, "link": "https://stackoverflow.com/questions/44811937/run-time-error-438-while-looping-through-every-charts-of-a-sheet", "title": "Run-time error &#39;438&#39; While looping through every charts of a sheet", "body": "<p>I'm using a macro to go through every charts of a sheet to hide any data label with a #N/A value/caption (I use two series in my charts, one green and one red depending on an objective).</p>\n\n<p>When I run this sub, I get this: \"Run-time error '438' : Object doesn't support this property or methode</p>\n\n<p>the code line where this happen is this one :<br>\n<code>For l = 1 To .SeriesCollection(k).Points(j).DataLabels.Count</code></p>\n\n<p>I've been look on the many other question/answer for this issue but every cases seems diferent when it comes to this kind of error.</p>\n\n<p>Is there anyone with a better understanding of VBA that could pin point the problem?</p>\n\n<pre><code>   Sub LoopThroughCharts()\n'PURPOSE: Loop through every graph in the a selected worksheet\n\nDim sht As Worksheet\nDim CurrentSheet As Worksheet\nDim cht As ChartObject\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nSet CurrentSheet = ActiveSheet\n\nWith ActiveWorkbook.Worksheets(\"Graph Annuel\")\n  For Each cht In .ChartObjects\n    cht.Activate\n    With ActiveChart\n    For k = 1 To .SeriesCollection.Count\n        For j = 1 To .SeriesCollection(k).Points.Count\n            For l = 1 To .SeriesCollection(k).Points(j).DataLabels.Count\n               If .SeriesCollection.Points(j).DataLabels.Item(l).Caption = \"#N/A\" Then\n                   .SeriesCollection.Points(j).DataLabels.Item(l).Delete\n                End If\n            Next l\n        Next j\n    Next k\n   End With\n  Next cht\nEnd With\n\nCurrentSheet.Activate\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498682222, "post_id": 44811854, "comment_id": 76604817, "body": "Protip: with <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>&#39;s next release (scheduled some time in July), you can replace <code>&#39;Description: {foo bar}</code> with <code>&#39;@Description(&quot;foo bar&quot;)</code>, and then you&#39;ll get to see that description at call sites and in the Object Browser! =)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8228310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652c9082c2e3a283b9ae3d7ab3dc92e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarbear_85", "link": "https://stackoverflow.com/users/8228310/sarbear-85"}, "edited": false, "score": 0, "creation_date": 1498682705, "post_id": 44812008, "comment_id": 76605060, "body": "Thanks so much BruceWayne! You have no idea how helpful that was, I really appreciate it! It is 99% working, just one little snag. The data from each workbook is now pasting to a new column each time, however it seems to start the new column on the row where the previous row finishes. For example, if the data on column A ends on row 3, the data on row B pastes onto row 4. Any thoughts?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 11, "user_id": 8228310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652c9082c2e3a283b9ae3d7ab3dc92e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarbear_85", "link": "https://stackoverflow.com/users/8228310/sarbear-85"}, "edited": false, "score": 0, "creation_date": 1498683139, "post_id": 44812008, "comment_id": 76605273, "body": "@sarbear_85 - Try taking out the ` + 1` in that <code>Set Dest = ...</code> line.  That&#39;s looking for the last row, then adding another. If you take that out it should work."}, {"owner": {"reputation": 11, "user_id": 8228310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652c9082c2e3a283b9ae3d7ab3dc92e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarbear_85", "link": "https://stackoverflow.com/users/8228310/sarbear-85"}, "edited": false, "score": 0, "creation_date": 1498683352, "post_id": 44812008, "comment_id": 76605384, "body": "I tried that but no luck. When I took out + 1 it pasted the data in B3 instead of B4 for example, so it took it up one row."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 11, "user_id": 8228310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652c9082c2e3a283b9ae3d7ab3dc92e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarbear_85", "link": "https://stackoverflow.com/users/8228310/sarbear-85"}, "edited": false, "score": 0, "creation_date": 1498683882, "post_id": 44812008, "comment_id": 76605650, "body": "@sarbear_85 - Where <i>should</i> the data start? Should it literally just go from A1, then next iteration, B1, next iteration C1, etc...?  So <b>copy</b> <code>xx1:xx100</code>, paste in other workbook <code>A1:A100</code>, then next <b>copy</b> say <code>yy1:yy10</code>, paste to <code>B1:B10</code>?"}, {"owner": {"reputation": 11, "user_id": 8228310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652c9082c2e3a283b9ae3d7ab3dc92e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarbear_85", "link": "https://stackoverflow.com/users/8228310/sarbear-85"}, "edited": false, "score": 0, "creation_date": 1498683973, "post_id": 44812008, "comment_id": 76605689, "body": "That&#39;s exactly right, it should paste into the first cell in each column."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 11, "user_id": 8228310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652c9082c2e3a283b9ae3d7ab3dc92e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarbear_85", "link": "https://stackoverflow.com/users/8228310/sarbear-85"}, "edited": false, "score": 0, "creation_date": 1498686061, "post_id": 44812008, "comment_id": 76606607, "body": "@sarbear_85 - Ah! Then just do <code>Set Dest = shtDest.Range(colLetter &amp; &quot;1&quot;)</code>"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1498681816, "creation_date": 1498681816, "answer_id": 44812008, "question_id": 44811854, "link": "https://stackoverflow.com/questions/44811854/vba-combine-multiple-workbooks-into-one/44812008#44812008", "title": "VBA Combine multiple workbooks into one", "body": "<p>I'm assuming that everything is working okay - you just need to change the destination column from A, to B, to C, ... as the macro continues on.</p>\n\n<p>Here's one way you could do it.</p>\n\n<p>Add this function to your code (above/below your current sub):</p>\n\n<pre><code>Function Col_Letter(lngCol As Long) As String\nDim vArr\nvArr = Split(Cells(1, lngCol).Address(True, False), \"$\")\nCol_Letter = vArr(0)\nEnd Function\n</code></pre>\n\n<p>Then replace your <code>Do Until...</code> loop with this:</p>\n\n<pre><code>Dim col As Long\ncol = 1\nDo Until Filename = vbNullString\n    If Not Filename = ThisWB Then\n        Set Wkb = Workbooks.Open(Filename:=Path &amp; \"\\\" &amp; Filename)\n        Set CopyRng = Wkb.Sheets(1).Range(Cells(RowofCopySheet, 1), Cells(ActiveSheet.UsedRange.Rows.Count, ActiveSheet.UsedRange.Columns.Count))\n        colLetter = Col_Letter(col)\n        Set Dest = shtDest.Range(colLetter &amp; shtDest.UsedRange.SpecialCells(xlCellTypeLastCell).Row + 1)\n        CopyRng.Copy Dest\n        Wkb.Close False\n        col = col + 1\n    End If\n\n    Filename = Dir()\nLoop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1498735491, "creation_date": 1498735491, "answer_id": 44823793, "question_id": 44811854, "link": "https://stackoverflow.com/questions/44811854/vba-combine-multiple-workbooks-into-one/44823793#44823793", "title": "VBA Combine multiple workbooks into one", "body": "<p>Modify your dest like this.</p>\n\n<p>from</p>\n\n<pre><code>Set Dest = shtDest.Range(\"A\" &amp; shtDest.UsedRange.SpecialCells(xlCellTypeLastCell).Row + 1)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Set Dest = shtDest.Cells(1, Columns.Count).End(xlToLeft)(1, 2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 1, "last_activity_date": 1498751999, "creation_date": 1498751999, "answer_id": 44830026, "question_id": 44811854, "link": "https://stackoverflow.com/questions/44811854/vba-combine-multiple-workbooks-into-one/44830026#44830026", "title": "VBA Combine multiple workbooks into one", "body": "<p>Consider this.</p>\n\n<pre><code>Sub Basic_Example_1()\n    Dim MyPath As String, FilesInPath As String\n    Dim MyFiles() As String\n    Dim SourceRcount As Long, Fnum As Long\n    Dim mybook As Workbook, BaseWks As Worksheet\n    Dim sourceRange As Range, destrange As Range\n    Dim rnum As Long, CalcMode As Long\n\n    'Fill in the path\\folder where the files are\n    MyPath = \"C:\\Users\\Ron\\test\"\n\n    'Add a slash at the end if the user forget it\n    If Right(MyPath, 1) &lt;&gt; \"\\\" Then\n        MyPath = MyPath &amp; \"\\\"\n    End If\n\n    'If there are no Excel files in the folder exit the sub\n    FilesInPath = Dir(MyPath &amp; \"*.xl*\")\n    If FilesInPath = \"\" Then\n        MsgBox \"No files found\"\n        Exit Sub\n    End If\n\n    'Fill the array(myFiles)with the list of Excel files in the folder\n    Fnum = 0\n    Do While FilesInPath &lt;&gt; \"\"\n        Fnum = Fnum + 1\n        ReDim Preserve MyFiles(1 To Fnum)\n        MyFiles(Fnum) = FilesInPath\n        FilesInPath = Dir()\n    Loop\n\n    'Change ScreenUpdating, Calculation and EnableEvents\n    With Application\n        CalcMode = .Calculation\n        .Calculation = xlCalculationManual\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Add a new workbook with one sheet\n    Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n    rnum = 1\n\n    'Loop through all files in the array(myFiles)\n    If Fnum &gt; 0 Then\n        For Fnum = LBound(MyFiles) To UBound(MyFiles)\n            Set mybook = Nothing\n            On Error Resume Next\n            Set mybook = Workbooks.Open(MyPath &amp; MyFiles(Fnum))\n            On Error GoTo 0\n\n            If Not mybook Is Nothing Then\n\n                On Error Resume Next\n\n                With mybook.Worksheets(1)\n                    Set sourceRange = .Range(\"A1:C1\")\n                End With\n\n                If Err.Number &gt; 0 Then\n                    Err.Clear\n                    Set sourceRange = Nothing\n                Else\n                    'if SourceRange use all columns then skip this file\n                    If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                        Set sourceRange = Nothing\n                    End If\n                End If\n                On Error GoTo 0\n\n                If Not sourceRange Is Nothing Then\n\n                    SourceRcount = sourceRange.Rows.Count\n\n                    If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                        MsgBox \"Sorry there are not enough rows in the sheet\"\n                        BaseWks.Columns.AutoFit\n                        mybook.Close savechanges:=False\n                        GoTo ExitTheSub\n                    Else\n\n                        'Copy the file name in column A\n                        With sourceRange\n                            BaseWks.cells(rnum, \"A\"). _\n                                    Resize(.Rows.Count).Value = MyFiles(Fnum)\n                        End With\n\n                        'Set the destrange\n                        Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                        'we copy the values from the sourceRange to the destrange\n                        With sourceRange\n                            Set destrange = destrange. _\n                                            Resize(.Rows.Count, .Columns.Count)\n                        End With\n                        destrange.Value = sourceRange.Value\n\n                        rnum = rnum + SourceRcount\n                    End If\n                End If\n                mybook.Close savechanges:=False\n            End If\n\n        Next Fnum\n        BaseWks.Columns.AutoFit\n    End If\n\nExitTheSub:\n    'Restore ScreenUpdating, Calculation and EnableEvents\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://www.rondebruin.nl/win/s3/win008.htm\" rel=\"nofollow noreferrer\">https://www.rondebruin.nl/win/s3/win008.htm</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8228310, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652c9082c2e3a283b9ae3d7ab3dc92e2?s=128&d=identicon&r=PG&f=1", "display_name": "sarbear_85", "link": "https://stackoverflow.com/users/8228310/sarbear-85"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2345, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1498751999, "creation_date": 1498681178, "last_edit_date": 1498682122, "question_id": 44811854, "link": "https://stackoverflow.com/questions/44811854/vba-combine-multiple-workbooks-into-one", "title": "VBA Combine multiple workbooks into one", "body": "<p>I am stumped! I am trying to copy data from multiple workbooks in a folder and paste them into one Master workbook. I have a loop that will go through each workbook in a folder, copy the data and then paste it into the Master workbook. The problem is, I need the data to be pasted onto a new column each time. For example data from workbook1 should paste into column A, workbook2 should past to column B and so on.</p>\n\n<p>I can get the code to paste the data from each workbook but it keeps copying it into one row. How do I get it to move to the next column instead of moving onto the next row?</p>\n\n<pre><code>'Description: Combines all files in a folder to a master file.\nSub MergeFiles()\n    Dim path As String, ThisWB As String, lngFilecounter As Long\n    Dim wbDest As Workbook, shtDest As Worksheet, ws As Worksheet\n    Dim Filename As String, Wkb As Workbook\n    Dim CopyRng As Range, Dest As Range\n    Dim RowofCopySheet As Integer\n\n    RowofCopySheet = 2 ' Row to start on in the sheets you are copying from\n\n    ThisWB = ActiveWorkbook.Name\n\n    path = \"C:\\testing\"\n\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n    Set shtDest = ActiveWorkbook.Sheets(1)\n    Filename = Dir(path &amp; \"\\*.xl*\", vbNormal)\n    If Len(Filename) = 0 Then Exit Sub\n    Do Until Filename = vbNullString\n        If Not Filename = ThisWB Then\n            Set Wkb = Workbooks.Open(Filename:=path &amp; \"\\\" &amp; Filename)\n            Set CopyRng = Wkb.Sheets(1).Range(Cells(RowofCopySheet, 1), Cells(ActiveSheet.UsedRange.Rows.Count, ActiveSheet.UsedRange.Columns.Count))\n            Set Dest = shtDest.Range(\"A\" &amp; shtDest.UsedRange.SpecialCells(xlCellTypeLastCell).Row + 1)\n            CopyRng.Copy Dest\n            Wkb.Close False\n        End If\n\n        Filename = Dir()\n    Loop\n\n    Range(\"A1\").Select\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\n\n    MsgBox \"Done!\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498681267, "post_id": 44811828, "comment_id": 76604284, "body": "Where do you use the second sheet? You should be explicit in the code. I&#39;m assuming the destination sheet is the <code>ActiveSheet</code>, no?  Also, why have the <code>((Cells(k,2)))</code> instead of just <code>Cells(k, 2)</code>?  Also, what&#39;s your question...is there an error thrown, is it not doing what you expect, etc..."}, {"owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498681496, "post_id": 44811828, "comment_id": 76604433, "body": "Hi Bruce, sorry for not being clear in first go.  Yes, the destination is activesheet which is (&quot;Sheet2&quot;) ((cells(k,2))) should have been cells(k,2). I was playing around with something when I forgot to remove that. It is giving me &quot;run-time error &#39;1004&#39;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498681497, "post_id": 44811828, "comment_id": 76604436, "body": "Use <a href=\"https://stackoverflow.com/questions/11631363/how-to-copy-a-line-in-excel-using-a-specific-word-and-pasting-to-another-excel-s\">AUTOFILTER</a>. If you want to still use loops then see <a href=\"https://stackoverflow.com/questions/44774795/copying-the-matched-row-in-another-sheet\">THIS</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498681900, "post_id": 44811828, "comment_id": 76604664, "body": "Do you want to look on <code>Sheet1</code> for the <code>If</code> statement? Or are you counting the rows in <code>Sheet1</code> (say it&#39;s 100), then on your other sheet, checking cells 1 to 100?"}, {"owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498682343, "post_id": 44811828, "comment_id": 76604890, "body": "@BruceWayne The <code>Sheet1</code> has multiple rows and columns. The <code>if</code> statement is checking one cell from this matrix in <code>Sheet1</code> and if that matches, I want to copy that entire row containing that cell to another <code>Sheet2</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498683204, "post_id": 44811828, "comment_id": 76605305, "body": "Then you need to tell VBA you want it to go to <code>Sheet2</code>.  Something like <code>Worksheets(&quot;Sheet2&quot;).Cells(2, 14).PasteSpecial Transpose:= True</code>, no?"}, {"owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "edited": false, "score": 0, "creation_date": 1498683406, "post_id": 44811828, "comment_id": 76605418, "body": "Yes, but <code>Sheet2</code> is already active in the function this loop is a part of."}, {"owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "edited": false, "score": 0, "creation_date": 1498683844, "post_id": 44811828, "comment_id": 76605628, "body": "So I found a solution, it is working partially though. Instead of copying just that row, it copies all the rows. Idk where am I going wrong             <code>With Sheets(&quot;Sheet1&quot;)              Worksheets(&quot;Sheet1&quot;).Cells(1, 14).Value = Driver_sel             For j = 1 To Worksheets(&quot;Sheet1&quot;).Cells(Rows.Count, 2).End(xlUp).Row                 If Cells(j, 2).Value = Cells(1, 14) Then                   .Range(.Cells(j, 1), .Cells(j, 12)).Copy                  ActiveSheet.Cells(2, 14).PasteSpecial Transpose:=True                End If             Next j             End With          End If</code>"}, {"owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "edited": false, "score": 0, "creation_date": 1498684646, "post_id": 44811828, "comment_id": 76605963, "body": "Am I doing the comparison right way? The cells I am comparing don&#39;t have integers but string values."}], "owner": {"reputation": 11, "user_id": 8228311, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BCj30EqdfRQ/AAAAAAAAAAI/AAAAAAAAA_g/2CPF_OQJ6XE/photo.jpg?sz=128", "display_name": "Rohan Jain", "link": "https://stackoverflow.com/users/8228311/rohan-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498681074, "creation_date": 1498681074, "question_id": 44811828, "link": "https://stackoverflow.com/questions/44811828/to-copy-range-from-one-sheet-to-another-using-result-obtained-from-comparison-lo", "title": "To copy range from one sheet to another using result obtained from comparison loop", "body": "<p>I am trying to copy a range from one sheet to another which is a result of a comparison loop. the loop first compares values in one of the cells of a row with something on the sheet and if its a match, it copies that entire range to another sheet. Here is my code:</p>\n\n<pre><code>        Worksheets(\"Sheet1\").Cells(1, 14).Value = Driver_sel\n        For k = 1 To Worksheets(\"Sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n           If ((Cells(k, 2))) = Cells(1, 14) Then\n             Worksheets(\"Sheet1\").Range(Cells(k, 1), Cells(k, 12)).Copy\n             ActiveSheet.Cells(2, 14).PasteSpecial Transpose:=True\n           End If\n        Next k\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1498681529, "post_id": 44811659, "comment_id": 76604459, "body": "IIf(condition, true_block, false_block) should help you (similar to the excel if-function): <code>IIf(IsNull(Range(cell).value), &quot;N&#47;A&quot;, Range(cell.value))</code>"}, {"owner": {"reputation": 3, "user_id": 8196101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058123de54bb89c8e3d9635fbe449fb3?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Gonzales", "link": "https://stackoverflow.com/users/8196101/gabriel-gonzales"}, "reply_to_user": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1498748431, "post_id": 44811659, "comment_id": 76637783, "body": "Thank you JanB. Sorry for the novice questions, but I&#39;m still getting an Error. Doing more research, I&#39;m thinking that this is designating an Empty or Blank Cell. But my understanding is that the &quot;Null&quot; function shouldn&#39;t care if the cell is blank or empty, correct? Below is the line that is giving me the error. I double checked and there is nothing showing in cell E18, but I&#39;m not sure if its empty or blank?"}, {"owner": {"reputation": 3, "user_id": 8196101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058123de54bb89c8e3d9635fbe449fb3?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Gonzales", "link": "https://stackoverflow.com/users/8196101/gabriel-gonzales"}, "reply_to_user": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "edited": false, "score": 0, "creation_date": 1498748570, "post_id": 44811659, "comment_id": 76637892, "body": "Range(&quot;L&quot; &amp; fRow).Value = IIf(IsNull(Range(&quot;E18&quot;).Value), &quot;N/A&quot;, Range(&quot;E18&quot;).Value * 25.4) &#39;Bolt Hole Size [mm]"}], "owner": {"reputation": 3, "user_id": 8196101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058123de54bb89c8e3d9635fbe449fb3?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Gonzales", "link": "https://stackoverflow.com/users/8196101/gabriel-gonzales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498680388, "creation_date": 1498680388, "question_id": 44811659, "link": "https://stackoverflow.com/questions/44811659/copying-a-range-and-calculating-a-value", "title": "Copying a Range and Calculating a Value", "body": "<p>I am currently building a sheet that will organize data from designated cells into another designated cell. In some cases the cell being referenced to will be blank. Instead of having a blank cell or \"#VALUE\" showing in the compiled area, I'd like to have \"N/A\" show up instead. The code I have now works if there is a value in every cell being referenced to. But if one cell is empty (H12, E18, E17, E16, E15, etc) the code stops and an Error message appears as \"Run Time error '13': Type mismatch\". </p>\n\n<pre><code>   Private Sub CommandButton2_Click()\n\n   'See if quote full\n    'if quote not full then add item\n    If Application.WorksheetFunction.CountA(Range(\"A27:A102\")) &lt; 75 Then\n     Dim fRow As Integer\n    'search for first empty row on quote in specified range\n    'and assign \"fRow\" to row number\n    fRow = Range(\"A27:A102\").Find(What:=\"\", _\n            After:=[A27], LookIn:=xlValues, _\n            LookAt:=xlPart, SearchOrder:=xlByColumns, _\n            SearchDirection:=xlNext, MatchCase:=False, _\n            SearchFormat:=False).row\n    'copy cell for cell\n    Range(\"A\" &amp; fRow).Value = Range(\"B7\") &amp; \"-\" &amp; Range(\"B10\") &amp; \"-\" &amp; Range(\"E7\") &amp; \"-\" &amp; Range(\"E8\") &amp; \"-\" &amp; Range(\"E11\")\n    Range(\"B\" &amp; fRow).Value = Range(\"B14\").Value 'Pipe Schedule\n    Range(\"C\" &amp; fRow).Value = Range(\"B11\").Value 'Gasket Size NPS\n    Range(\"D\" &amp; fRow).Value = Range(\"H12\").Value 'Sleeve Length [in]\n    Range(\"E\" &amp; fRow).Value = Range(\"H12\").Value * 25.4 'Sleeve Length [mm]\n    Range(\"F\" &amp; fRow).Value = Range(\"H13\").Value 'Sleeve Qty\n    Range(\"G\" &amp; fRow).Value = Range(\"H11\").Value 'Bolt Size\n    Range(\"H\" &amp; fRow).Value = Range(\"H9\").Value 'Isolating/BackUp Washer Qty\n    'Range(\"I\" &amp; fRow).Value = Range(\"H9\").Value 'Empty\n    Range(\"J\" &amp; fRow).Value = Range(\"E19\").Value 'Bolt Hole Qty\n    Range(\"K\" &amp; fRow).Value = Range(\"E18\").Value 'Bolt Hole Size [in]\n    Range(\"L\" &amp; fRow).Value = Range(\"E18\").Value * 25.4 'Bolt Hole Size [mm]\n    Range(\"M\" &amp; fRow).Value = Range(\"E17\").Value 'Bolt Hole Circle [in]\n    Range(\"N\" &amp; fRow).Value = Range(\"E17\").Value * 25.4 'Bolt Hole Circle [mm]\n    Range(\"O\" &amp; fRow).Value = Range(\"E16\").Value 'D Dim [in]\n    Range(\"P\" &amp; fRow).Value = Range(\"E16\").Value * 25.4 'D Dim [mm]\n    Range(\"Q\" &amp; fRow).Value = Range(\"E15\").Value 'C Dim [in]\n    Range(\"R\" &amp; fRow).Value = Range(\"E15\").Value * 25.4 'C Dim [mm]\n    Range(\"S\" &amp; fRow).Value = Range(\"E13\").Value 'B Dim [in]\n    Range(\"T\" &amp; fRow).Value = Range(\"E13\").Value * 25.4 'B Dim [mm]\n    Range(\"U\" &amp; fRow).Value = Range(\"E14\").Value 'A Dim [in]\n    Range(\"V\" &amp; fRow).Value = Range(\"E14\").Value * 25.4 'A Dim [mm]\n    Range(\"W\" &amp; fRow).Value = Range(\"B11\").Value 'Gasket Size NPS\nElse ' if quote full give message\n    MsgBox \"Cart Full - Good Work!\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I know the error is because I'm trying to calculate a value from a blank cell, but how can I insert some type of \"If\" statement; or other logic, for the calculated values to return a number or \"N/A\" (if the reference cell is blank)?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1498680871, "post_id": 44811447, "comment_id": 76604022, "body": "my answer here shows a simple way to test for duplicates while looping through a range/array <a href=\"https://stackoverflow.com/questions/42301589/identifying-duplicate-values-and-copying-to-other-cells-using-for-loops-in-vba-e/42301986#42301986\" title=\"identifying duplicate values and copying to other cells using for loops in vba e\">stackoverflow.com/questions/42301589/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 8216142, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-qwivHYedacE/AAAAAAAAAAI/AAAAAAAAGII/kWpd88zqyvQ/photo.jpg?sz=128", "display_name": "Antti Kivivalli", "link": "https://stackoverflow.com/users/8216142/antti-kivivalli"}, "is_accepted": false, "score": 0, "last_activity_date": 1498691268, "creation_date": 1498691268, "answer_id": 44813902, "question_id": 44811447, "link": "https://stackoverflow.com/questions/44811447/unique-values-from-a-range/44813902#44813902", "title": "Unique Values from a range", "body": "<p>How about this... although again it is a bit difficult to grasp or simulate your real situation...</p>\n\n<pre><code>Sub RoleModified()\n\n'define variables\nDim RoleWkb As Workbook, figWkb As Workbook, RoleWkst As Worksheet, figWkst As Worksheet\nDim aCell As Long, a As Long, c As String, i As String, id As String, email As String, cityname As Variant\n\n'added some variables\nDim vNames()                'to contain all the original names\nDim vUniqueNames()          'to collect unique ones\nDim vUniqueCount As Integer 'to count the unique ones\nDim vUnique As Boolean      'to mark that it was stored already\n\n'open workbook\nfNameAndPath = Application.GetOpenFilename(Title:=\"Role Workbook\")\nSet RoleWkb = ThisWorkbook\nSet figWkb = ThisWorkbook\nSet RoleWkst = RoleWkb.Sheets(\"UserProfile\")\nSet figWkst = figWkb.Worksheets(\"User Information\")\ncityname = InputBox(\"City name?\", , \"London\")\n\n'whatever way you can refer to where the names are, this worked for my \n'simulation...\nfigWkst.Select\nvNames = Intersect(figWkst.UsedRange, Range(\"F:F\"))\n\n'set up the variables\nReDim vUniqueNames(1 To UBound(vNames, 1))\nvUniqueCount = 0\n\n'loop through all the names and take each one only once\nFor n = 1 To UBound(vNames, 1)\n    vUnique = True\n    'test it against those already stored\n    For m = 1 To UBound(vNames, 1)\n        If vUniqueNames(m) = vNames(n, 1) Then\n            vUnique = False\n        End If\n    Next m\n    'if not found, store it\n    If vUnique Then\n        vUniqueCount = vUniqueCount + 1\n        vUniqueNames(vUniqueCount) = vNames(n, 1)\n    End If\nNext n\n\n'placing unique names to the other sheet, meaning of x's missed\nFor n = 1 To vUniqueCount\n    RoleWkst.Cells(10 + n, 18) = cityname &amp; \" \" &amp; _\n    vUniqueNames(n) &amp; \" Watcher\"\nNext n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7565043, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8fb99751eb9b167319cff6dc6d2c7e5a?s=128&d=identicon&r=PG&f=1", "display_name": "gksdmsgP", "link": "https://stackoverflow.com/users/7565043/gksdmsgp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498691268, "creation_date": 1498679614, "question_id": 44811447, "link": "https://stackoverflow.com/questions/44811447/unique-values-from-a-range", "title": "Unique Values from a range", "body": "<p>I am trying to write a code that looks at the opened worksheet (figWkst), looks in column F, and collects all the unique names, then adds one unique name at a time followed by the word \"watcher\" and a comma. </p>\n\n<p>So, for example, if the unique names in column F are \"Red, White, Blue, Green\", then column R row n in the new worksheet will show \"Red Watcher, White Watcher, Blue Watcher, Green Watcher.\" What I have now only displays in column R what column F row n displays.</p>\n\n<p>I was thinking of using dictionaries but I can't seem to wrap my head around it. Any help would be appreciated! Thank you. Here is my code:</p>\n\n<pre><code>Sub Role()\n\n'define variables\nDim RoleWkb As Workbook, figWkb As Workbook, RoleWkst As Worksheet, figWkst As Worksheet\nDim aCell As Long, a As Long, c As String, i As String, id As String, email As String, cityname As Variant\n\n'open workbook\nfNameAndPath = Application.GetOpenFilename(Title:=\"Role Workbook\")\nSet RoleWkb = Workbooks.Open(fNameAndPath)\nSet figWkb = ThisWorkbook\nSet RoleWkst = RoleWkb.Sheets(\"UserProfile\")\nSet figWkst = figWkb.Worksheets(\"User Information\")\ncityname = InputBox(\"City name?\")\n\n\n\n'adding watcher group\naCell = figWkst.Range(\"D\" &amp; Rows.Count).End(xlUp).Row\nFor a = 12 To aCell\n    If figWkst.Cells(a, 17) = \"x\" Or figWkst.Cells(a, 17) = \"X\" Then\n        If RoleWkst.Cells(a - 1, 18) &lt;&gt; \"\" Then\n            RoleWkst.Cells(a - 1, 18) = Trim(RoleWkst.Cells(a - 1, 18) &amp; \", \" &amp; cityname &amp; \" \" &amp; figWkst.Cells(a, 6) &amp; \" Watcher\")\n        Else\n            RoleWkst.Cells(a - 1, 18) = Trim(cityname &amp; \" \" &amp; figWkst.Cells(a, 6) &amp; \" Watcher\")\n        End If\n    End If\nNext a\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498679576, "post_id": 44811381, "comment_id": 76603264, "body": "any reason you&#39;re using ActiveX controls in favor of Form Controls?  Not sure what would cause this, but ActiveX are notoriously problematic IMO."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498680001, "post_id": 44811381, "comment_id": 76603536, "body": "Works just for me. Did you try stepping through the code?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498681148, "post_id": 44811381, "comment_id": 76604211, "body": "I just made some changes to my post. you may have to refresh it to see it"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8160289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c357ac59b2a6bd68ae57072d521bfe36?s=128&d=identicon&r=PG&f=1", "display_name": "ThisOne", "link": "https://stackoverflow.com/users/8160289/thisone"}, "edited": false, "score": 0, "creation_date": 1498735768, "post_id": 44811706, "comment_id": 76627472, "body": "I put in this code. When I tried to change ComboBoxes the first throws               &quot;ClearContents method of Range class failed 30&quot;. The second box throws &quot;We cant do that to a merged cell 30&quot; when I select No or Unknown. I&#39;m assuming that these may be referencing the same line in the ComboBox13 sub, which still doesn&#39;t answer the question as to how its possible for the code to skip into another sub in this way. I&#39;m going to changing a few more things and I will post the results of what I find."}, {"owner": {"reputation": 3, "user_id": 8160289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c357ac59b2a6bd68ae57072d521bfe36?s=128&d=identicon&r=PG&f=1", "display_name": "ThisOne", "link": "https://stackoverflow.com/users/8160289/thisone"}, "edited": false, "score": 0, "creation_date": 1498736020, "post_id": 44811706, "comment_id": 76627670, "body": "I made a simple change, since the numbering was ambiguous as to which sub was referenced in the message, so I simply changed the numbering in ComboBox13 to 11, 21, 31, ect ... As I had guessed both ComboBoxes threw a message with the number 31, so the ComboBox1 sub is still going into ComboBox13 somehow? Also I commented out the Clear and Value statements in ComboBox13 and that stopped the errors"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 3, "user_id": 8160289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c357ac59b2a6bd68ae57072d521bfe36?s=128&d=identicon&r=PG&f=1", "display_name": "ThisOne", "link": "https://stackoverflow.com/users/8160289/thisone"}, "edited": false, "score": 0, "creation_date": 1498742017, "post_id": 44811706, "comment_id": 76632540, "body": "you didnt have to change the numbering.. you could have added few words to the error handler. For example <code>MsgBox Err.Description &amp; vbNewLine &amp; Erl &amp; &quot; in Sub ComboBox1_Change()&quot;</code> and <code>MsgBox Err.Description &amp; vbNewLine &amp; Erl &amp; &quot; in Sub ComboBox13_Change()&quot;</code>"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1498681081, "last_edit_date": 1498681081, "creation_date": 1498680578, "answer_id": 44811706, "question_id": 44811381, "link": "https://stackoverflow.com/questions/44811381/vba-excel-script-going-into-another-sub-without-reason-run-time-error-1004/44811706#44811706", "title": "VBA: Excel script going into another sub without reason, Run-time error 1004", "body": "<p>This doesn't answer your question but when I tried your above code, it didn't give me any error. I also see lot of unnecessary repetitions in your code. You entire code can be written as </p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    ActiveSheet.Unprotect\n\n    Rows(\"16:18\").EntireRow.Hidden = True\n\n    If ComboBox1 = \"Field Failure\" Then\n        Rows(16).EntireRow.Hidden = False\n    ElseIf ComboBox1 = \"ACUTEC Customer\" Then\n        Rows(\"17:18\").EntireRow.Hidden = False\n    End If\n\n    ActiveSheet.Protect DrawingObjects:=False, _\n    Contents:=True, Scenarios:=True, AllowFormattingRows:=True\nEnd Sub\n\nPrivate Sub ComboBox13_Change()\n    ActiveSheet.Unprotect\n    If ComboBox13 = \"No\" Or ComboBox13 = \"Unknown\" Then\n        Range(\"J20\").ClearContents\n    Else\n        Range(\"J20\").Value = \"Please comment on the repeat issue, \" &amp; _\n        \"including  related notification numbers or other applicable data\"\n    End If\n    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, _\n    Scenarios:=True, AllowFormattingRows:=True\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong>: Try this code and see if you are still getting the error. You need to paste this code in the worksheet code area which has the combo boxes.</p>\n\n<p>And if you are still getting the error then use this code and tell us what error message do you see?</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    On Error GoTo Whoa\n\n10    ActiveSheet.Unprotect\n\n20    Rows(\"16:18\").EntireRow.Hidden = True\n\n30    If ComboBox1 = \"Field Failure\" Then\n40        Rows(16).EntireRow.Hidden = False\n50    ElseIf ComboBox1 = \"ACUTEC Customer\" Then\n60        Rows(\"17:18\").EntireRow.Hidden = False\n70    End If\n\n80    ActiveSheet.Protect DrawingObjects:=False, _\n      Contents:=True, Scenarios:=True, AllowFormattingRows:=True\nLetsContinue:\n90    Exit Sub\nWhoa:\n100    MsgBox Err.Description &amp; vbNewLine &amp; Erl\n110    Resume LetsContinue\nEnd Sub\n\nPrivate Sub ComboBox13_Change()\n    On Error GoTo WTF\n\n10    ActiveSheet.Unprotect\n20    If ComboBox13 = \"No\" Or ComboBox13 = \"Unknown\" Then\n30        Range(\"J20\").ClearContents\n40    Else\n50        Range(\"J20\").Value = \"Please comment on the repeat issue, \" &amp; _\n        \"including  related notification numbers or other applicable data\"\n60    End If\n70    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, _\n    Scenarios:=True, AllowFormattingRows:=True\nBRB:\n80    Exit Sub\nWTF:\n90    MsgBox Err.Description &amp; vbNewLine &amp; Erl\n100    Resume BRB\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 8160289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c357ac59b2a6bd68ae57072d521bfe36?s=128&d=identicon&r=PG&f=1", "display_name": "ThisOne", "link": "https://stackoverflow.com/users/8160289/thisone"}, "is_accepted": false, "score": 0, "last_activity_date": 1498736714, "creation_date": 1498736714, "answer_id": 44824243, "question_id": 44811381, "link": "https://stackoverflow.com/questions/44811381/vba-excel-script-going-into-another-sub-without-reason-run-time-error-1004/44824243#44824243", "title": "VBA: Excel script going into another sub without reason, Run-time error 1004", "body": "<p>So although it doesn't answer the core problem of my issue it seems that a few modifications on Siddharth Rout's was able to get my form to work as I needed.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nOn Error GoTo Whoa\n\n10    ActiveSheet.Unprotect\n\n20    Rows(\"16:18\").EntireRow.Hidden = True\n\n30    If ComboBox1 = \"Field Failure\" Then\n40        Rows(16).EntireRow.Hidden = False\n50    ElseIf ComboBox1 = \"ACUTEC Customer\" Then\n60        Rows(\"17:18\").EntireRow.Hidden = False\n70    End If\n\n80    ActiveSheet.Protect DrawingObjects:=False, _\n       Contents:=True, Scenarios:=True, AllowFormattingRows:=True\n  LetsContinue:\n90    Exit Sub\nWhoa:\n100    'MsgBox Err.Description &amp; vbNewLine &amp; Erl\n110    Resume LetsContinue\nEnd Sub\n\nPrivate Sub ComboBox13_Change()\n     On Error GoTo WTF\n\n11    ActiveSheet.Unprotect\n21    If ComboBox13 = \"No\" Or ComboBox13 = \"Unknown\" Then\n          Rows(21).EntireRow.Hidden = True\n          Rows(22).EntireRow.Hidden = True\n41    Else\n          Rows(21).EntireRow.Hidden = False\n          Rows(22).EntireRow.Hidden = False\n61    End If\n71    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, _\n       Scenarios:=True, AllowFormattingRows:=True\nBRB:\n81    Exit Sub\nWTF:\n91    'MsgBox Err.Description &amp; vbNewLine &amp; Erl\n101   Resume BRB\nEnd Sub\n</code></pre>\n\n<p>However, as I stated this still doesn't answer how the ComboBox1 sub was able to pass into the ComboBox13 sub.</p>\n"}], "owner": {"reputation": 3, "user_id": 8160289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c357ac59b2a6bd68ae57072d521bfe36?s=128&d=identicon&r=PG&f=1", "display_name": "ThisOne", "link": "https://stackoverflow.com/users/8160289/thisone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498736714, "creation_date": 1498679367, "last_edit_date": 1531164843, "question_id": 44811381, "link": "https://stackoverflow.com/questions/44811381/vba-excel-script-going-into-another-sub-without-reason-run-time-error-1004", "title": "VBA: Excel script going into another sub without reason, Run-time error 1004", "body": "<p>So I am creating a form on excel using activeX and form controls. The form (for the most part) works exactly as intended. That is except for a strange interaction that is occurring between two separate activeX ComboBoxes. Both the ComboBoxes have subs attached to them that hide/unhide different rows. The issue that I am having is that when the second sub's lines are commented out the first sub runs correctly. But when neither are commented the first sub skips over parts of its own code and goes into the other sub and inevitably throws a Run time error 1004.</p>\n\n<p>I have tried even moving the second sub into two separate subs withing another module to try and avoid the issue, however that didn't work correctly. </p>\n\n<p>Both subs are right here ... The lines that cause are still left commented so anyone looking at this will know where the error occurs.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nIf ComboBox1 = \"Field Failure\" Then\n    ActiveSheet.Unprotect\n    ComboBox1.AutoSize = False\n    [16:18].EntireRow.Hidden = True\n    [16:16].EntireRow.Hidden = False\n    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        True, AllowFormattingRows:=True\n\nElseIf ComboBox1 = \"ACUTEC Customer\" Then\n     ActiveSheet.Unprotect\n     [16:18].EntireRow.Hidden = True\n     [17:18].EntireRow.Hidden = False\n    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n         True, AllowFormattingRows:=True\nElse\n  ActiveSheet.Unprotect\n  Rows(\"16:18\").EntireRow.Hidden = True\n  ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        True, AllowFormattingRows:=True\nEnd If\nEnd Sub\nPrivate Sub ComboBox13_Change()\nComboBox13.AutoSize = False\nIf ComboBox13 = \"No\" Then\n Call Combo13Hide\nElseIf ComboBox13 = \"Unknown\" Then\n Call Combo13Hide\nElse\n Call Combo13Unhide\nEnd If\nEnd Sub\n</code></pre>\n\n<p>In Other Module</p>\n\n<pre><code>Public Sub Combo13Hide()\n  ActiveSheet.Unprotect\n  'Rows(\"21:22\").EntireRow.Hidden = True\n  Range(\"J20\").Value = \"\"\n  ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        True, AllowFormattingRows:=True\nEnd Sub\n\nPublic Sub Combo13Unhide()\n    ActiveSheet.Unprotect\n    'Rows(\"21:22\").EntireRow.Hidden = False\n    Range(\"J20\").Value = \"Please comment on the repeat issue, including \n        related notification numbers or other applicable data\"\n    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _\n        True, AllowFormattingRows:=True\nEnd Sub\n</code></pre>\n\n<p>Any help or advice would be greatly appreciated, and I would be happy to provide any additional information</p>\n"}, {"tags": ["regex", "vba", "replace", "ms-word"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1498679463, "post_id": 44811325, "comment_id": 76603200, "body": "What kind of regex engine does it use?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1498679871, "post_id": 44811325, "comment_id": 76603449, "body": "I don&#39;t think you need most of those escapes. Try this using a C-style string <code>&quot;((https|http):&#47;&#47;)?([0-9a-zA-z.-]+)\\\\.([0-9a-zA-Z.]{2,6})([0&zwnj;&#8203;-9a-zA-Z.&#47;-]+)?&quot;</code> I made a correction of <code>A-z</code> to <code>A-Z</code> in the class."}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1498681555, "post_id": 44811325, "comment_id": 76604473, "body": "You are confused because <code>Selection.Find</code> uses <i>wildcard</i> expression, and inside the VBA code, you used a Microsoft VBScript Regular Expressions 5.5 <i>regular</i> expressions. The wildcard expressions do not have a <i>zero or more</i> / <i>zero or one</i> quantifiers. They cannot match empty strings."}, {"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "edited": false, "score": 0, "creation_date": 1498681941, "post_id": 44811325, "comment_id": 76604690, "body": "if I understand what you&#39;re asking, it&#39;s VBA"}, {"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "edited": false, "score": 0, "creation_date": 1498683189, "post_id": 44811325, "comment_id": 76605294, "body": "@sln -- using the C-Style string, ..it&#39;s giving me the following error- and points at the Selection.find.execute line:  Run-time error &#39;5560&#39;:  The Find What text contains a Pattern Match expression which is not valid."}, {"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1498683343, "post_id": 44811325, "comment_id": 76605381, "body": "@Wiktor - I&#39;m fairly new to coding, but do understand what you&#39;re saying.. is there another way to make it work?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1498683392, "post_id": 44811325, "comment_id": 76605410, "body": "Use VBA code with the regex. There is a <code>RegExp.Replace</code> method. BTW, VBA strings are not C string literals, escape sequences cannot be defined in them, e.g. you cannot define a newline with <code>&quot;\\n&quot;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1498683749, "post_id": 44811325, "comment_id": 76605583, "body": "I think you should set <code>MatchWildcards = FALSE</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user557597"}, "edited": false, "score": 0, "creation_date": 1498683929, "post_id": 44811325, "comment_id": 76605669, "body": "Btw, what version Office are you using ?"}, {"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "edited": false, "score": 0, "creation_date": 1498685208, "post_id": 44811325, "comment_id": 76606255, "body": "@sln- using Office 13, and I tried the MatchWildcards=False with no luck"}, {"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "reply_to_user": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1498685264, "post_id": 44811325, "comment_id": 76606288, "body": "@Wiktor Thank you for steering me in the right direction I was able to get it to work using the following code.. however it&#39;s stripping the formatting for the entire document- any idea how to have the changes only impact the strings I&#39;m searching?"}, {"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1498685625, "post_id": 44811325, "comment_id": 76606428, "body": "Ok, to keep formatting, you need to use wildcards. And that means you need to use more than 2 patterns: you need to split them so as to cover all cases where you had optional subpatterns."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "edited": false, "score": 0, "creation_date": 1498762461, "post_id": 44825804, "comment_id": 76646395, "body": "Thank! This resolved my issue w/ formatting. The issue I have now is that the removals need to be in certain order.  I&#39;ll need to remove email addresses first, then URLs/Domains- if not done this way then email domains would be removed but not emails.  The RegEx worked, but while using commas instead of semicolons.  I&#39;ve been trying to adjust the regex, but with no luck- the current regex only removes a domain (with http or https) if it ends w/ a &quot;/&quot;.  Do you know how I&#39;d be able to adjust this to accommodate Domains w/o URI paths as well as URLs that include full URI path?"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "edited": false, "score": 0, "creation_date": 1498811051, "post_id": 44825804, "comment_id": 76663933, "body": "That&#39;s all? No problem, simply swap the patterns! I have edited the code accordinglxy, including going back to commas in the quantifiers."}, {"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "edited": false, "score": 0, "creation_date": 1499710450, "post_id": 44825804, "comment_id": 77011972, "body": "Thanks this is great!  I&#39;ve been trying with no luck to make a MS Word friendly regex that will match on URLs/domains that don&#39;t start w/ http(s), and that will incorporate &#39;www.&#39; as well as just a domain w/ no preceding text (google.com/asda/adasd).  Any idea on best approach here?"}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1499765870, "post_id": 44825804, "comment_id": 77035229, "body": "FYI: <code>htt[ps]{1,2}</code> matches <code>httpp</code> or <code>httss</code>, those are not valid protocols"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1499769087, "post_id": 44825804, "comment_id": 77037575, "body": "@Toto: correct, but what are the odds of httpp://yadda or httss://yadda occuring without being a mistyped URL? I reckon zero."}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1499771831, "post_id": 44825804, "comment_id": 77039489, "body": "Use <code>https?</code> that makes the <code>s</code> optional. Also <code>{1,}</code> can be rewritten <code>+</code>"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "reply_to_user": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1499772028, "post_id": 44825804, "comment_id": 77039632, "body": "@Toto: No, that does not work. This is using Word placeholder characters, not regular regex. Word behaves a little differently there."}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1499772203, "post_id": 44825804, "comment_id": 77039750, "body": "OK. I wasn&#39;t aware of that."}, {"owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "edited": false, "score": 0, "creation_date": 1499796188, "post_id": 44825804, "comment_id": 77057449, "body": "@LocEngineer that doesn&#39;t seem to work.. some of the example domain types I&#39;m trying to encompass include: Google.google.com; Google.com; Google.com/asd-23.htm; www.google.com/33dsa/; google-google.com/123123/1232/2dfsd.pdf"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1499844797, "post_id": 44825804, "comment_id": 77075843, "body": "I see. The pattern did have trouble with the first of your mentioned URLs. I have adjusted the code. Should work better now."}], "tags": [], "owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1499844732, "last_edit_date": 1499844732, "creation_date": 1498741074, "answer_id": 44825804, "question_id": 44811325, "link": "https://stackoverflow.com/questions/44811325/find-and-replace-urls-and-email-addresses/44825804#44825804", "title": "Find and replace URLs and Email addresses", "body": "<p>I've tinkered a bit and converted your patterns to a Word compatible placeholder pattern since you need to do this with Word search/replace rather than regex engine.</p>\n\n<p><strong>Important note:</strong></p>\n\n<blockquote>\n  <p>In Word, placeholder patterns have a localized part, meaning that\n  quantifiers may be separated by semicolon rather than comma, depending\n  on your locale.</p>\n</blockquote>\n\n<p>Also note, that the question mark does not mean \"optional\" in Word but rather \"1 character of any sort\". Therefore you will need a third pattern if you have URLs without http/s intro.</p>\n\n<p>That said, this here should give you a good start. Note my use of semicolons in the {} quantifiers, please replace with comma if required by your locale. Also note my not using Selection:</p>\n\n<pre><code>Dim patterns As Variant\nDim placeholder As Variant\n\npatterns = Array(\"[a-zA-Z0-9.]{1,}(\\@)[a-zA-Z]{1,}.[a-zA-Z0-9]{2,6}\", \"htt[ps]{1,2}://[0-9a-zA-Z.\\-]{1,}[0-9a-zA-Z.\\/\\-_]{1,}\", \"[0-9a-zA-Z\\-]{3,}.[0-9a-zA-Z.\\/\\-_]{3,}\")\nplaceholder = Array(\"[EMAIL REMOVED]\", \"[URL REMOVED]\", \"[URL REMOVED]\")\n\nFor i = 0 To 2\n    With ActiveDocument.Content.Find\n        .ClearFormatting\n        .Replacement.ClearFormatting\n        .text = patterns(i)\n        .Replacement.text = placeholder(i)\n        .MatchWildcards = True\n        .Execute Replace:=wdReplaceAll\n    End With\nNext i\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8227919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7af430d4e8479314d16c72d652f5899c?s=128&d=identicon&r=PG&f=1", "display_name": "TheTruth25", "link": "https://stackoverflow.com/users/8227919/thetruth25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 606, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1499844732, "creation_date": 1498679161, "last_edit_date": 1499568771, "question_id": 44811325, "link": "https://stackoverflow.com/questions/44811325/find-and-replace-urls-and-email-addresses", "title": "Find and replace URLs and Email addresses", "body": "<p>I'm able to use regex to find and replace IP addresses within a Microsoft Word Document, however I'm unable to do the same for Email addresses and URLs.</p>\n\n<p>Here are the Regular Expressions for both URLs and Email addresses that have been tested so I know they work. I've been unable to get the macro to use them for find and replace.</p>\n\n<p>URL: \"((https|http)://)?([0-9a-zA-z.-]+).([0-9a-zA-Z.]{2,6})([0-9a-zA-z.-/]+)\"</p>\n\n<p>Email: \"[a-zA-Z0-9.]+(\\@)[a-zA-Z]+(.)[a-zA-Z0-9]{2,6}\"</p>\n\n<pre><code>Sub Test()\n    Selection.HomeKey Unit:=wdStory\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    Selection.Find.MatchWildcards = True\n\n\n    ' Remove IPs\n    With Selection.Find\n        .Text = \"[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}\"\n        .Replacement.Font.ColorIndex = wdRed\n        .Replacement.Text = \"[IP REMOVED]\"\n        .Forward = True\n        .Wrap = wdFindContinue\n        .Format = True\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchAllWordForms = False\n        .MatchSoundsLike = False\n        .MatchWildcards = True\n    End With\n    Selection.Find.Execute Replace:=wdReplaceAll\nEnd Sub\n</code></pre>\n\n<p>I tested my regular expressions using this code:</p>\n\n<pre><code>Sub Test_Regex()\n    Dim objRegExp As Object\n    Set objRegExp = CreateObject(\"vbscript.regexp\")\n    objRegExp.Global = IsGlobal1\n    objRegExp.Pattern = \"((https|http)\\:\\/\\/)?([0-9a-zA-z\\.\\-]+)\\.([0-9a-zA-Z\\.]{2,6})([0-9a-zA-z\\.\\-\\/]+)?\"\n    objRegExp.IgnoreCase = Not IsCaseSensitive1\n    RegExpReplace = objRegExp.Replace(\"google.com/asdasd/asda/asda.cssd\", \"RegexWorks\")\n    MsgBox (RegExpReplace)\nEnd Sub\n</code></pre>\n\n<p>@Wiktor Stribi\u017cew -- I tried using a regex based on your most recent comment in order to preserve the formatting but it's still stripping formatting when i run it.  Is this urlPattern regex the same as how you described it?</p>\n\n<pre><code>Sub Test()\n    Dim urlPattern As String: urlPattern = \"((https)\\:\\/\\/)([0-9a-zA-z\\.\\-]+)\\.([0-9a-zA-Z\\.]{2,6})([0-9a-zA-z\\.\\-\\/]+)\"\n    Dim regExp As Object\n    Set regExp = CreateObject(\"vbscript.regexp\")\n\n    With regExp\n        .Pattern = urlPattern\n        .Global = True\n        ActiveDocument.Range = regExp.Replace(ActiveDocument.Range, \"[REDACTED]\")\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1498678342, "post_id": 44810964, "comment_id": 76602593, "body": "All exclamation marks beyond the first in <code>[Forms]![frmBrowseTickets]![NavigationSubform].Form![ticketI&zwnj;&#8203;D].Value</code> should be dots, as far as I know. Not posting it as the answer because I&#39;m unsure it&#39;s as simple as that. So <code>[Forms]![frmBrowseTickets].[NavigationSubform].Form.[ticketI&zwnj;&#8203;D].Value</code>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498682305, "post_id": 44810964, "comment_id": 76604868, "body": "I NEVER use Navigation form because of difficulty referencing forms. Review <a href=\"http://www.accessforums.net/showthread.php?t=32053\" rel=\"nofollow noreferrer\">accessforums.net/showthread.php?t=32053</a>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1498682469, "post_id": 44810964, "comment_id": 76604945, "body": "@ErikvonAsmuth: The original syntax is correct. The only dots are before Form and Value."}, {"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498740948, "post_id": 44810964, "comment_id": 76631593, "body": "@June7 I know, this has been a nightmare to try to reference... that said, it looks nice and figuring out how to make this hyperlink function right is the last step to finishing my project so I&#39;m determined to make it work somehow! I reviewed that link and <b>think</b> my syntax used to reference the forms is right..."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498756119, "post_id": 44810964, "comment_id": 76642761, "body": "I would use dot before reference to control (in this case, cboGoToRecord) and ! (bang) before a field reference. However, I don&#39;t think even that will resolve issue. Are cboGoToRecord and ticketID on the same subform?"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "edited": false, "score": 0, "creation_date": 1498740778, "post_id": 44812162, "comment_id": 76631455, "body": "Both of them output a value of 1, but I think it&#39;s an issue with the value of the ticketID being read correctly. I can&#39;t figure out how to make VBA register that I&#39;m clicking on a number &quot;4&quot;, not just some hyperlink. It insists on always having a value of 1. Perhaps the solution is just to create another hyperlinked field for opening the record and leaving ticketID as a regular text box...hm.."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1498682381, "creation_date": 1498682381, "answer_id": 44812162, "question_id": 44810964, "link": "https://stackoverflow.com/questions/44810964/referencing-the-value-of-a-hyperlinked-text-box/44812162#44812162", "title": "Referencing the value of a hyperlinked text box", "body": "<p>When this works:</p>\n\n<pre><code>Debug.Print [Forms]![frmBrowseTickets]![NavigationSubform].Form![ticketID].Value\n</code></pre>\n\n<p>then also check out:</p>\n\n<pre><code> Debug.Print [Forms]![frmBrowseTickets]![NavigationSubform].Form![cboGoToRecord].Value\n</code></pre>\n\n<p>As June7, I never use the Navigation form. It complicates everything too much.</p>\n"}], "owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498742881, "creation_date": 1498677865, "last_edit_date": 1498742881, "question_id": 44810964, "link": "https://stackoverflow.com/questions/44810964/referencing-the-value-of-a-hyperlinked-text-box", "title": "Referencing the value of a hyperlinked text box", "body": "<p>So I'm having some difficulties with this code. I know it's obnoxiously wordy, but every attempt I made to turn some of these form references into variables to save space ended with me having even less functionality than before.</p>\n\n<p>Basically what I've done so far is create a navigation form with several tabs, one to create a ticket, one to resolve/edit a ticket, and one to search the tickets. The search tab is basically a continuous form that updates based on the search criteria I enter. My goal is that when I click on the ticketID for each record, it will take me to the selected record on the Resolve/Edit Ticket page (on that page I have a combo box [called cboGoToRecord] where you can select the record you want).</p>\n\n<p>I have a hyperlink in place that takes the user to the Resolve/Edit page and code that works ONLY when the line I've denoted with four asterisks (for clarity) is replaced with </p>\n\n<pre><code>rst.FindFirst \"ticketID =\" &amp; [some number].\n</code></pre>\n\n<p>When I do that, the results are as expected. If I leave it as it is below, every record looks up the first record (A Debug.print check shows that the value of this field is apparently always 1...) So I guess what I need to figure out is <strong>how do I access the ticketID hyperlink's value so that I can put it on that line and make my code function effectively?</strong> I apologize if this is overly detailed but figured too much was better than not enough. </p>\n\n<pre><code> Private Sub ticketID_Click()\n\n    'Takes user from Search Tickets to Resolve/Edit Issues tab\n    DoCmd.BrowseTo acBrowseToForm, \"frmResolveIssues\", \"frmBrowseTickets.NavigationSubform\"\n\n    On Error Resume Next\n    Dim rst As Object\n    Set rst = Forms!frmBrowseTickets!NavigationSubform.Form.RecordsetClone\n    [Forms]![frmBrowseTickets]![NavigationSubform].Form![cboGoToRecord].Value = [Forms]![frmBrowseTickets]![NavigationSubform].Form![ticketID].Value\n****rst.FindFirst \"ticketID =\" &amp; [Forms]![frmBrowseTickets]![NavigationSubform].Form![cboGoToRecord].Value\n    Forms!frmBrowseTickets!NavigationSubform.Form.Bookmark = rst.Bookmark\n\n    Debug.Print [Forms]![frmBrowseTickets]![NavigationSubform].Form![ticketID].Value\n\nEnd Sub\n</code></pre>\n\n<p><strong>Edit:</strong>\nAfter altering my form to add a separate hyperlink and referencing the static ticketID, I have concluded that everything I thought was true was not. Finding the value of a hyperlink was NOT the problem. The problem is that my ticketID value truly does insist on being one, and I have no clue how to fix that.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498677750, "post_id": 44810855, "comment_id": 76602272, "body": "You are probably looking for the <code>.Text</code> method. <code>Range(&quot;A1&quot;).Text</code>"}, {"owner": {"reputation": 1, "user_id": 8228061, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154590857356835/picture?type=large", "display_name": "Benjamin Hirt", "link": "https://stackoverflow.com/users/8228061/benjamin-hirt"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498680561, "post_id": 44810855, "comment_id": 76603867, "body": "Thank you !! Range(&quot;A2&quot;).Value = Range(&quot;A1&quot;).Text"}], "answers": [{"tags": [], "owner": {"reputation": 331, "user_id": 7834321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fb04269e2225ecafbcf20dfbbd76d?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Nevins", "link": "https://stackoverflow.com/users/7834321/tim-nevins"}, "is_accepted": false, "score": 0, "last_activity_date": 1498688172, "creation_date": 1498688172, "answer_id": 44813411, "question_id": 44810855, "link": "https://stackoverflow.com/questions/44810855/paste-the-displayed-value-of-a-cell-in-excel/44813411#44813411", "title": "Paste the displayed value of a cell in Excel", "body": "<p>Use \"Precision as Displayed\" functionality....</p>\n\n<p>Format all your cells as you want them to be shown.\nClick the file tab , and then click Options.\nClick Advanced, and then under When calculating this workbook, select the Set precision as displayed check box, and then click OK.\nClick OK.</p>\n\n<p>In my opinion, you should used this feature carefully. You'll get a warning when you set this. It is set on a workbook basis, so all worksheets in the workbook will be affected.</p>\n\n<p>I've never actually used this feature other than playing around with it, so best of luck!</p>\n"}], "owner": {"reputation": 1, "user_id": 8228061, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154590857356835/picture?type=large", "display_name": "Benjamin Hirt", "link": "https://stackoverflow.com/users/8228061/benjamin-hirt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1042, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498688172, "creation_date": 1498677514, "question_id": 44810855, "link": "https://stackoverflow.com/questions/44810855/paste-the-displayed-value-of-a-cell-in-excel", "title": "Paste the displayed value of a cell in Excel", "body": "<p>I would like to know if there is a way either with excel formulas or VBA to paste the displayed value of a cell and not the actual value of a cell.\nFor example, let's say the value of cell A1 is 945.66, it could be eventually displayed as 946 if one removes the display of the decimals.\nI'd like to paste the displayed value of 946 in another cell, say A2.\nThe paste special method \"pastevalueandnumberformat\" indeed displays the value 946 in the cell A2 but the actual value of the cell is 945.66. </p>\n\n<p>I can't use the round function as I want to check what is actually displayed and run some calculation with the displayed value and not the actual value</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1498681462, "creation_date": 1498681462, "answer_id": 44811935, "question_id": 44810771, "link": "https://stackoverflow.com/questions/44810771/run-time-error-424-object-required-ms-access-vba-objects-are-declared-but/44811935#44811935", "title": "Run Time Error &quot;424&quot; Object Required / Ms Access VBA ./ Objects are declared but still the error Could some one spot the error?", "body": "<p><code>Server</code> is not defined at that exact line.\nYou can use <code>SET Conn1 = CurrentProject.Connection</code> to avoid having to create a new connection from scratch.</p>\n"}], "owner": {"reputation": 1, "user_id": 8107910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7811fc539fa79e7ae3cabcbe8bdaf1e3?s=128&d=identicon&r=PG&f=1", "display_name": "George Lee", "link": "https://stackoverflow.com/users/8107910/george-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594639659, "creation_date": 1498677218, "last_edit_date": 1594639659, "question_id": 44810771, "link": "https://stackoverflow.com/questions/44810771/run-time-error-424-object-required-ms-access-vba-objects-are-declared-but", "title": "Run Time Error &quot;424&quot; Object Required / Ms Access VBA ./ Objects are declared but still the error Could some one spot the error?", "body": "<p>Private Sub method3_Click()</p>\n\n<pre><code>Dim conn1 As ADODB.Connection\nDim recSet As ADODB.Recordset\n\nmySQL = \"Select * from Contact\"\nSet conn1 = New ADODB.Connection\nconn1.Provider = \"Microsoft.ACE.OLEDB.12.0\"\n</code></pre>\n\n<p>'ERROR WHEN PROGRAM REACHES THE LINE BELOW</p>\n\n<pre><code>conn1.Open (Server.Mappath(\"G:\\Data\\StudentDB.accDB\"))\n\n Set recSet = New ADODB.Recordset\n recSet.Open mySQL, conn1, adOpenDynamic, adLockOptimistic\n\n     mobile = recSet.Field(3)\n recSet.Close\n conn1.Close\n\nSet conn = Nothing\nSet recSet = Nothing\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "ms-word"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498677669, "post_id": 44810582, "comment_id": 76602227, "body": "I am not sure if you can do that without opening it? What&#39;s wrong with <a href=\"https://stackoverflow.com/questions/10512560/save-embedded-word-doc-as-pdf\">Opening</a> it?"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498677909, "post_id": 44810582, "comment_id": 76602354, "body": "I&#39;m preparing that for print some information on a form. for beauty I need get information from specific cells and print in appropriate place on a form, as invisible and <b>not shown open embedded document</b> and <b>update message</b>."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498677988, "post_id": 44810582, "comment_id": 76602395, "body": "<code>o form</code>? BTW did you see the link that I posted in the first comment"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498678574, "post_id": 44810582, "comment_id": 76602713, "body": "Yes, I checked that link. I need copy content of my embedded Word document and past that, without opening that embedded OLE. greatly problem in above code is in &#39;ActiveSheet.OLEObjects(P).Copy&#39;. I need copy content of document, invisible."}], "answers": [{"tags": [], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "is_accepted": true, "score": 0, "last_activity_date": 1508152207, "creation_date": 1508152207, "answer_id": 46768926, "question_id": 44810582, "link": "https://stackoverflow.com/questions/44810582/copy-content-of-word-ole-object-without-opening-in-excel-with-vba/46768926#46768926", "title": "Copy content of word OLE object without opening, in Excel with VBA", "body": "<pre><code>Sub PrintIt(P As String)\nDim objWord As Object\nDim ObjDoc As Object\nDim Oshp As Object\n\nApplication.ScreenUpdating = False\n\nActiveSheet.OLEObjects(P).Activate\nSet objWord = GetObject(, \"Word.Application\")\nobjWord.Visible = False\n\nSet ObjDoc = objWord.ActiveDocument\n\nObjDoc.Fields.Update\nFor Each Oshp In ObjDoc.Content.ShapeRange\n    Oshp.TextFrame.TextRange.Fields.Update\nNext\n\nObjDoc.PrintOut Background:=False\nObjDoc.PrintOut\n\nobjWord.Quit SaveChanges:=False\nApplication.ScreenUpdating = True\nEnd Sub 'Print it\n</code></pre>\n"}], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1698, "favorite_count": 0, "accepted_answer_id": 46768926, "answer_count": 1, "score": 0, "last_activity_date": 1508187603, "creation_date": 1498676521, "last_edit_date": 1508187603, "question_id": 44810582, "link": "https://stackoverflow.com/questions/44810582/copy-content-of-word-ole-object-without-opening-in-excel-with-vba", "title": "Copy content of word OLE object without opening, in Excel with VBA", "body": "<p>I have an Excel sheet with Microsoft Word OLE objects embedded.</p>\n\n<p>My embedded Word documents have some fields that should been updated with specific cells.</p>\n\n<p>I need to print the content of that embedded document, <strong><em>without</em></strong> <strong>visible document opening</strong> and \"<strong>update document prompts</strong>\".</p>\n\n<p>My problem is in copying the content of the Word-embedded OLE object in an invisible Word document without update prompting.</p>\n\n<p>I try this:</p>\n\n<p>This code paint a box around the embedded word document in destination printable document.</p>\n\n<p>Please help me copy content of embedded document or ..., and print an embedded document without updating prompt and visible window.</p>\n\n<pre><code>Sub PrintIt(P As String, w, h As Double)\n    Dim objWord As Object\n    Dim ObjDoc As Object\n\n    Application.ScreenUpdating = False\n\n    Set objWord = CreateObject(\"Word.Application\")\n    objWord.Visible = False\n\n    ActiveSheet.OLEObjects(P).Copy\n\n    Set ObjDoc = objWord.Documents.Add\n    ObjDoc.PageSetup.PageWidth = objWord.CentimetersToPoints(w)\n    ObjDoc.PageSetup.PageHeight = objWord.CentimetersToPoints(h)\n    ObjDoc.Content.Paste\n\n    ObjDoc.PrintOut Background:=False\n    ObjDoc.PrintOut\n\n    objWord.Quit SaveChanges:=False\n    Application.ScreenUpdating = True\nEnd Sub 'Print it\n</code></pre>\n"}, {"tags": ["vba", "excel", "variables", "offset"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 2, "creation_date": 1498676398, "post_id": 44810505, "comment_id": 76601522, "body": "<code>Range(&quot;B18:J&quot; &amp; Range(&quot;O24&quot;).Value).PrintOut Preview:=True</code>. <code>Range(&quot;O24&quot;).Value</code> will return the value of cell O24 and then append it to the rest of the range, which begins at B18"}, {"owner": {"reputation": 75, "user_id": 8167828, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/303095b0b9f6e9fd355283bc7c2e11d5?s=128&d=identicon&r=PG&f=1", "display_name": "Caleb Sutton", "link": "https://stackoverflow.com/users/8167828/caleb-sutton"}, "reply_to_user": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1498677165, "post_id": 44810505, "comment_id": 76601972, "body": "That works! Put it in the answers section and ill mark it as correct."}], "answers": [{"tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 1, "last_activity_date": 1498678991, "creation_date": 1498678991, "answer_id": 44811277, "question_id": 44810505, "link": "https://stackoverflow.com/questions/44810505/excel-vba-how-to-select-a-certain-cell-then-offset-a-variable-number-or-rows-d/44811277#44811277", "title": "Excel VBA. How to select a certain cell, then offset a variable number or rows down, and then print that selection", "body": "<p>You can use</p>\n\n<pre><code>Range(\"B18:J\" &amp; Range(\"O24\").Value).PrintOut Preview:=True\n</code></pre>\n\n<p>Since the value in cell O24 contains the number of rows you want to print down to you can print the range beginning at cell B18 and ending at cell J and the value of cell O24 by appending the value in cell O24 to B18:J.</p>\n"}], "owner": {"reputation": 75, "user_id": 8167828, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/303095b0b9f6e9fd355283bc7c2e11d5?s=128&d=identicon&r=PG&f=1", "display_name": "Caleb Sutton", "link": "https://stackoverflow.com/users/8167828/caleb-sutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 44811277, "answer_count": 1, "score": 0, "last_activity_date": 1513505372, "creation_date": 1498676241, "last_edit_date": 1513505372, "question_id": 44810505, "link": "https://stackoverflow.com/questions/44810505/excel-vba-how-to-select-a-certain-cell-then-offset-a-variable-number-or-rows-d", "title": "Excel VBA. How to select a certain cell, then offset a variable number or rows down, and then print that selection", "body": "<p>Just like it says in the title. I need to print in an area from B18 to J18 and down a variable number of rows. I don't know how to set this up. That variable number is being kept in cell O24 by using a <code>=COUNTA(B20:B65536)</code>function. I just need the selection to go down that many number of rows. </p>\n\n<p>Here is my code so far. </p>\n\n<pre><code>Sub PrintPlease()\n\nI = Cells(\"O24\").Value\n\nWith ActiveSheet.PageSetup\n    .Zoom = False\n    .Orientation = xlPortrait\n    .FitToPagesWide = 1\n    .FitToPagesTall = 1\n\n    ExecuteExcel4Macro (\"PAGE.SETUP(,,,,,,,,,,,,{#N/A,#N/A})\")\n    If .Zoom &lt; 30 Then\n        .Zoom = 50\n    Else\n        .Zoom = False\n        .FitToPagesWide = 1\n    End If\n\nEnd With\n\nRange (\"B18:J18\"), Cells(\"B18\").Offset((I), 3).PrintOut, Preview:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "pdf", "if-statement", "printing", "export"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 5070490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-JgqPYDH8XKs/AAAAAAAAAAI/AAAAAAAABbU/2fdAoI6FyLo/photo.jpg?sz=128", "display_name": "Doons", "link": "https://stackoverflow.com/users/5070490/doons"}, "edited": false, "score": 0, "creation_date": 1499113932, "post_id": 44812231, "comment_id": 76764988, "body": "Thanks, I&#39;ll personalize from there :)"}], "tags": [], "owner": {"reputation": 1438, "user_id": 7381844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/472a02745987037a063febc591fbb937?s=128&d=identicon&r=PG&f=1", "display_name": "jBuchholz", "link": "https://stackoverflow.com/users/7381844/jbuchholz"}, "is_accepted": true, "score": 1, "last_activity_date": 1498682638, "creation_date": 1498682638, "answer_id": 44812231, "question_id": 44810386, "link": "https://stackoverflow.com/questions/44810386/enable-export-as-pdf-inside-workbook-beforeprint-cancel/44812231#44812231", "title": "Enable export as pdf inside Workbook_BeforePrint Cancel", "body": "<p>ActivePrinter displays the current printer name (something like Canon MP230 series auf Ne03:). When exporting to pdf the active printer changes accordingly (at my current station: Foxit Reader PDF Printer auf Ne01:).</p>\n\n<p>So assuming your pdf-printer is foxit, you could use the following code:</p>\n\n<pre><code>...\nif (Left(ActivePrinter, 5) &lt;&gt; \"Foxit\") then\n    'regular printing, therefore execute your code\nelse\n    'pdf-priner, therefore do something else (or nothing)\nend if\n...\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5070490, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-JgqPYDH8XKs/AAAAAAAAAAI/AAAAAAAABbU/2fdAoI6FyLo/photo.jpg?sz=128", "display_name": "Doons", "link": "https://stackoverflow.com/users/5070490/doons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 44812231, "answer_count": 1, "score": 0, "last_activity_date": 1498682638, "creation_date": 1498675814, "question_id": 44810386, "link": "https://stackoverflow.com/questions/44810386/enable-export-as-pdf-inside-workbook-beforeprint-cancel", "title": "Enable export as pdf inside Workbook_BeforePrint Cancel", "body": "<p>it seems my <em>\"Workbook_BeforePrint(Cancel As Boolean)\"</em> is stopping me from exporting to PDF. I have found that if I remove this sub, PDF export works, but I'd like to keep my \"fixes\" before print.</p>\n\n<p>Is there a way to rewrite my code to handle export to pdf?</p>\n\n<p>A) To ignore the \"Before print cancel\" on export (no after effects on PDF)</p>\n\n<p>or</p>\n\n<p>B) Make the code work for export, retaining the after effects my code adds</p>\n\n<pre><code>Private Sub Workbook_BeforePrint(Cancel As Boolean)\n    Application.Volatile True\n    Cancel = True\n\n    Application.EnableEvents = False\n    Application.ScreenUpdating = False\n\n   'My code\n\n    Application.EnableEvents = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498675998, "post_id": 44810373, "comment_id": 76601257, "body": "<code>I am completely new to VBA....</code> Did you write this code?"}, {"owner": {"reputation": 301, "user_id": 6144802, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-Iqtvo3-SXds/AAAAAAAAAAI/AAAAAAAABGE/RdsOlAAxU7o/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6144802/sergey"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498676052, "post_id": 44810373, "comment_id": 76601301, "body": "Yes. I have experience in other languages"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498676326, "post_id": 44810373, "comment_id": 76601485, "body": "You&#39;ll want to drop the <code>snake_case</code> and adopt <code>PascalCase</code> for member names. In VBA the underscore has a special meaning; your functions can&#39;t be refactored into an interface named like that."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1498676212, "post_id": 44810478, "comment_id": 76601415, "body": "Congrats on reaching that 100K! Have another!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1498676322, "post_id": 44810478, "comment_id": 76601479, "body": "Thank you guys :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498676377, "post_id": 44810478, "comment_id": 76601515, "body": "I believe you might be eligible for a little something from the Stack Overflow team. Congrats!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498676422, "post_id": 44810478, "comment_id": 76601535, "body": "Thanks @Mat&#39;sMug but I seriously doubt that... :D"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498676461, "post_id": 44810478, "comment_id": 76601560, "body": "<a href=\"https://meta.stackoverflow.com/q/321681/1188513\">I seriously think so =)</a> - &quot;Assuming you have a valid email address on your profile and you are opted in to receiving emails from us, you should get an automated email within a week of hitting the reputation threshold. If not, check your spam folder and make sure it didn&#39;t end up there.&quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1498676578, "post_id": 44810478, "comment_id": 76601636, "body": "News Alert! SO Mug up on eBay!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498676658, "post_id": 44810478, "comment_id": 76601681, "body": "@Mat&#39;sMug: Aha! That&#39;s news to me... yeah SO has the correct email."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498676739, "post_id": 44810478, "comment_id": 76601731, "body": "Congrats again - next stop 250K!"}, {"owner": {"reputation": 301, "user_id": 6144802, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-Iqtvo3-SXds/AAAAAAAAAAI/AAAAAAAABGE/RdsOlAAxU7o/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6144802/sergey"}, "edited": false, "score": 0, "creation_date": 1498676993, "post_id": 44810478, "comment_id": 76601867, "body": "@SiddharthRout still get same error. For some reason, excel shows that error in Sub task6()"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498677116, "post_id": 44810478, "comment_id": 76601939, "body": "You didn&#39;t have to make so many changes. You could have declared <code>a</code> in <code>Sub task6</code>  as <code>Dim a() as Integer</code>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498677280, "post_id": 44810478, "comment_id": 76602022, "body": "@Jeeped: I can see you are going to reach there pretty soon :D"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498677876, "post_id": 44810478, "comment_id": 76602336, "body": "Late into the party!  congratulations :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498748889, "post_id": 44810478, "comment_id": 76638125, "body": "@Mat&#39;sMug: Received the &quot;You are Killing it!&quot; email :)"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499931519, "post_id": 44810478, "comment_id": 77121066, "body": "@Mat&#39;sMug : <a href=\"https://meta.stackoverflow.com/questions/321681/do-users-still-get-the-package-when-their-rep-reaches-100k/352173#352173\" title=\"do users still get the package when their rep reaches 100k\">meta.stackoverflow.com/questions/321681/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499945550, "post_id": 44810478, "comment_id": 77131010, "body": "Nice! Congrats again!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1499945830, "post_id": 44810478, "comment_id": 77131186, "body": "@Mat&#39;sMug: The only reason why I am updating you is because you were the one who made me aware of it :) Thanks again."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 7, "last_activity_date": 1498676278, "last_edit_date": 1498676278, "creation_date": 1498676147, "answer_id": 44810478, "question_id": 44810373, "link": "https://stackoverflow.com/questions/44810373/vba-type-mismatch-array-or-user-defined-type-expected/44810478#44810478", "title": "VBA. &quot;Type mismatch: array or user-defined type expected&quot;", "body": "<p>The problem is the function <code>Function find_index_of_min_elem(ByRef Arr() As Integer)</code> is expecting an <code>Integer</code> as a parameter and you are passing <code>a</code> as a <code>Variant</code> </p>\n\n<pre><code>a = generate_array(20)\nIndexOfMinElemInA = find_index_of_min_elem(a)\n</code></pre>\n\n<p>The next error that you will get is on <code>Dim Arr(Size) As Integer</code>. You cannot dimension an array like that.</p>\n\n<p>I would recommend reading up on arrays.</p>\n\n<p>There may be other errors but I have not checked those.</p>\n"}, {"tags": [], "owner": {"reputation": 1554, "user_id": 6833290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wyRfl.jpg?s=128&g=1", "display_name": "Tony M", "link": "https://stackoverflow.com/users/6833290/tony-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1498975007, "creation_date": 1498975007, "answer_id": 44867881, "question_id": 44810373, "link": "https://stackoverflow.com/questions/44810373/vba-type-mismatch-array-or-user-defined-type-expected/44867881#44867881", "title": "VBA. &quot;Type mismatch: array or user-defined type expected&quot;", "body": "<p>What about this? Make a second column of index numbers (in sequence from small to large) and then order the two rows by your original column. I've included the example below to illustrate:\nA = the original column of numbers,\nB = the column of index numbers\nD &amp; E are the result of sorting A &amp; B by column A \nThe answer is then: the lowest number \"0\" was at index 7</p>\n\n<p><a href=\"https://i.stack.imgur.com/iJqPV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iJqPV.png\" alt=\"example screenshot\"></a></p>\n"}], "owner": {"reputation": 301, "user_id": 6144802, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh3.googleusercontent.com/-Iqtvo3-SXds/AAAAAAAAAAI/AAAAAAAABGE/RdsOlAAxU7o/photo.jpg?sz=128", "display_name": "Sergey", "link": "https://stackoverflow.com/users/6144802/sergey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 44810478, "answer_count": 2, "score": 1, "last_activity_date": 1498975007, "creation_date": 1498675774, "last_edit_date": 1498676702, "question_id": 44810373, "link": "https://stackoverflow.com/questions/44810373/vba-type-mismatch-array-or-user-defined-type-expected", "title": "VBA. &quot;Type mismatch: array or user-defined type expected&quot;", "body": "<p>I am completely new to VBA. I need to write a program, which will generate an array of integer and will find an index of the minimal element. I got this error \n\"Type mismatch: array or user-defined type expected.\" I looked into many similar questions, but couldn't figure out what is wrong.</p>\n\n<pre><code>Function random_integer(Min As Integer, Max As Integer)\nrandom_integer = Int((Max - Min + 1) * Rnd + Min)\nEnd Function\n\nFunction generate_array(Size As Integer)\nDim Arr(Size)\nFor i = 0 To UBound(Arr)\n    Arr(i) = random_integer(i - 10, i + 10)\nNext\ngenerate_array = Arr\nEnd Function\n\nFunction find_index_of_min_elem(ByRef Arr() As Variant)\nDim Min As Integer\nMin = Arr(0)\nDim MinIndex As Integer\nMinIndex = 0\nFor i = 1 To UBound(Arr)\n    If Arr(i) &lt; Min Then\n        Min = Arr(i)\n        MinIndex = i\n    End If\nNext\nfind_index_of_min_elem = MinIndex\nEnd Function\n\nSub task6()\nA = generate_array(20)\nIndexOfMinElemInA = find_index_of_min_elem(A)\nMsgBox IndexOfMinElemInA\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "syntax", "ms-access-2013", "ms-access-2016"], "comments": [{"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "reply_to_user": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1498675925, "post_id": 44810280, "comment_id": 76601216, "body": "@JacobH Yep. This is a problem I&#39;m having in an MS Access DB."}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1498676022, "post_id": 44810280, "comment_id": 76601280, "body": "Not to ask the obvious, but do you have a query saved in that database exactly called &quot;qry_InventoryModule_PKG&quot;?"}, {"owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "reply_to_user": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1498676370, "post_id": 44810280, "comment_id": 76601512, "body": "@JacobH yup, I just double checked too."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498677125, "post_id": 44810280, "comment_id": 76601949, "body": "Your query opens without any problems, right? Make a backup, and delete all the data in your table and see if it works?"}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1498686021, "post_id": 44810280, "comment_id": 76606589, "body": "1) It is most helpful to those answering your question if you include the error code description along with the number... add that detail to the question text. 2)  A simple web search reveals that Access error 3464 is a &quot;Data Type Mismatch in criteria expression&quot;.  2a)  &quot;Criteria expression&quot; immediately implies that the problem is in the query itself, not in your VBA code."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498757225, "post_id": 44810280, "comment_id": 76643414, "body": "Why are you opening a query? Is this an action SQL? To do what? Edit question to post the SQL."}], "owner": {"reputation": 1062, "user_id": 4838216, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/4d5cbe16a581e7620802a34270c46595?s=128&d=identicon&r=PG&f=1", "display_name": "whatwhatwhat", "link": "https://stackoverflow.com/users/4838216/whatwhatwhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498675660, "creation_date": 1498675430, "last_edit_date": 1498675660, "question_id": 44810280, "link": "https://stackoverflow.com/questions/44810280/runtime-error-3464-when-trying-to-use-simple-vb-code-to-open-a-query", "title": "Runtime Error 3464 when trying to use simple VB code to open a query", "body": "<p>I have a button that, when clicked, checks to see what the value of a particular option is. If that option is selected, open a specific query. I can't figure out why this is giving me an error:</p>\n\n<pre><code>'PKG query\n    If (Me.opt_Pkg.Value = -1) Then\n\n        DoCmd.OpenQuery (\"qry_InventoryModule_PKG\")\n\n    End If\n</code></pre>\n\n<p>I also tried this, but it gave me the same error:</p>\n\n<pre><code>'PKG query\n    If Me.opt_MarsSAP_Pkg = -1 Then\n\n        DoCmd.OpenQuery \"qry_InventoryModule_PKG\"\n\n    End If\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1498677691, "post_id": 44810173, "comment_id": 76602240, "body": "I totally don&#39;t have a clue what your problem exactly is. Could you try clarifying your question? What exactly doesn&#39;t work, and what exactly does? <code>&#39;somehow subtract 72 from qty get remainder number</code> is just <code>qty - 72</code>, isn&#39;t it? Why are you comparing variables with themselves?"}, {"owner": {"reputation": 13, "user_id": 5477846, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153462683907713/picture?type=large", "display_name": "RManthey", "link": "https://stackoverflow.com/users/5477846/rmanthey"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1498677993, "post_id": 44810173, "comment_id": 76602400, "body": "yes for that it is.  My end goal is she puts in an order and when she clicks the PackingListbtn it will generate a packing list based on best pallet configuration.   I am unsure of how to code this exactly.  The picture shows that I have two products with the same CaseSize.  So in theory I want that packing list to be broken down into 4 pallets with one of those pallets having 66 of product 20894 and 6 (remainder from &#39;qty-72) of 20852 ..."}], "owner": {"reputation": 13, "user_id": 5477846, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153462683907713/picture?type=large", "display_name": "RManthey", "link": "https://stackoverflow.com/users/5477846/rmanthey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498763342, "creation_date": 1498675074, "last_edit_date": 1498763342, "question_id": 44810173, "link": "https://stackoverflow.com/questions/44810173/microsoft-access-vba-code-for-building-a-pallet-packing-list", "title": "Microsoft Access VBA code for Building a Pallet Packing List", "body": "<p>I have a Commercial Invoicing System developed in Access that our International Orders section uses.  The database itself runs near very well, as it is very simple and minimal.  However, now they want the packing list to auto build the pallets for them also.  Here is a quick breakdown of what I am trying to do:</p>\n\n<h2>Product  |   CaseSize       |  CasesPerPallet</h2>\n\n<h2>11111     |   11x12x9 @ 8lbs |  72</h2>\n\n<h2>12221    |   11x12x9 @ 8lbs |  72</h2>\n\n<h2>55555    |   11x14x10 @ 9lbs|  72</h2>\n\n<h2>ETC.</h2>\n\n<p>I have 7 different CaseSizes and 5 different CasesPerPallet quantities for all of our products.</p>\n\n<p>What I would like is for my packing list to do this:</p>\n\n<p>Example Joe's Grocery orders 150 cases of product 11111 and 138 cases of 12221 .. I want my report to \"know\" that I need 4 pallets of 72 keeping the products together by 1st productID and then leftovers (remainders) by CaseSize... i.e. 4 of the 11111 product would go with 66 of 12221.  </p>\n\n<p>However with many different sized cases I'm not sure how efficient this could be as sometimes we put the larger cases on the bottom and the smaller cases on the top of those to reduce pallet footprint.  </p>\n\n<p>I am thinking I need an if statement:</p>\n\n<pre><code>if [ProdID!CaseSize] = [ProdID!CaseSize] and QTY &gt;72 Then\n   subtract 72 from qty get remainder number; pallet++\n    if [ProdID!CaseSize] = [ProdID!CaseSize] and QTY &gt;72 Then\n    subtract 72 from qty get remainder number; pallet++\n   Else \n   End if\nEnd if\n</code></pre>\n\n<p>So I'm thinking it needs to be a loop until it is no longer true then exit and show me total number of pallets.</p>\n\n<p>The only other way I could think of doing this is to just add another field and have the order rep identify the pallet as she inputs the order.  This would cause her to put the order in according to pallet.   </p>\n\n<p>So she could enter 11111 x 72    pallet 1\n                   11111 x 72    pallet 2\n                   11111 x 6     pallet 3\n                   12221 x 66    pallet 3\n                   12221 x 72    pallet 4\n  Then I could group my packing list by pallet but I don't want her to go through all this.</p>\n\n<p>thank you in advance for your help!!</p>\n\n<p>The attached picture shows an order I made up.  You can see they are all the same products but I do not have them grouped</p>\n\n<p><a href=\"https://i.stack.imgur.com/nLWwn.png\" rel=\"nofollow noreferrer\">This picture shows how the packing list looks now</a></p>\n"}, {"tags": ["vba", "excel", "sumifs"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8227838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7080e76953396285c8bc59d901ad7911?s=128&d=identicon&r=PG&f=1", "display_name": "PMac", "link": "https://stackoverflow.com/users/8227838/pmac"}, "edited": false, "score": 0, "creation_date": 1498678984, "post_id": 44810361, "comment_id": 76602923, "body": "I ran this and got a type mismatch error on the .formula line"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 1, "last_activity_date": 1498677959, "last_edit_date": 1498677959, "creation_date": 1498675724, "answer_id": 44810361, "question_id": 44810125, "link": "https://stackoverflow.com/questions/44810125/issues-using-sumifs-in-vba/44810361#44810361", "title": "Issues using sumifs() in VBA", "body": "<p>It's difficult to exploit the power of the structured formula from VBA. Since you have a tested and working formula, you can let the cell evaluate it <em>as is</em> and then fix the value. for example:</p>\n\n<pre><code>With sheet1.Cells(2, 14)\n  .Formula = \"=SUMIFS([Hours],[Operators], [@Operators], [Forging], [@Forging], [Operation], [@Operation], [Job No], [@[Job No]], [Time], \"\"&gt;\"\" &amp; [Time] - Time(1, 0, 0), [Time], \"\"&lt;\"\" &amp; [Time] + Time(1, 0, 0), [Workcenter], [@Workcenter])\"\n  .Value = .Value * 60\nEnd with\n</code></pre>\n\n<p>only thing to be careful about here was: double-up any double-quotes inside the initial formula.</p>\n"}], "owner": {"reputation": 11, "user_id": 8227838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7080e76953396285c8bc59d901ad7911?s=128&d=identicon&r=PG&f=1", "display_name": "PMac", "link": "https://stackoverflow.com/users/8227838/pmac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1498677959, "creation_date": 1498674927, "question_id": 44810125, "link": "https://stackoverflow.com/questions/44810125/issues-using-sumifs-in-vba", "title": "Issues using sumifs() in VBA", "body": "<p>I'm trying to basically translate a formula from excel into VBA. I'm using the SUMIFS() command and I have it referring to columns in an already established table. This is what I have so far but I keep getting an object error.</p>\n\n<pre><code>Cells(2, 14).Value = 60 * Application.WorksheetFunction.SumIfs([Hours],[Operators], [@Operators], [Forging], [@Forging], [Operation], [@Operation], [Job No], [@[Job No]], [Time], \"&gt;\" &amp; [Time] - Time(1, 0, 0), [Time], \"&lt;\" &amp; [Time] + Time(1, 0, 0), [Workcenter], [@Workcenter])\n</code></pre>\n\n<p>I'm guessing that this isn't how you use SUMIFS() so how do you modify this so that it can function as it does in excel.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1498675506, "post_id": 44809942, "comment_id": 76600958, "body": "I had another account, but I can&#39;t remember the log in. That being said I am still fairly new to coding. Almost all that I know I learned by myself on the job by googling, so my knowledge is only to very specific things. Thank you though. I was worried my post was too long."}, {"owner": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1498675708, "post_id": 44809942, "comment_id": 76601094, "body": "True. I was hoping someone might give insight to what else could be causing the error. Also I removed the macro tag from my post."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1498694812, "post_id": 44809942, "comment_id": 76609219, "body": "There is an IE setting that might relate to whether some links open in new tabs, new windows or the existing tab. Open IE11, click the gear icon then choose Internet Options &gt; General tab &gt; Tabs and look at the &quot;Open links from other programs in&quot; setting to see if it differs between the two laptops.  As you mentioned pop-ups, you might want to check the &quot;When a pop-up is encountered&quot; setting as well. It might also be worth manually checking a tracking number on that website on each laptop to see if anything works differently between the two"}, {"owner": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "edited": false, "score": 0, "creation_date": 1498748313, "post_id": 44809942, "comment_id": 76637665, "body": "Thank you for your response; however, I have checked both of these options and I haven&#39;t been able to find any differences. I double checked was version and update we have on IE as well since he uses it frequently and I don&#39;t, but it&#39;s exactly the same. Walking through the tracking process manually on each laptop also looks exactly the same. Each laptop when I click the link it opens in a new tab that is still in the same window as the original tab."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "edited": false, "score": 0, "creation_date": 1498676333, "post_id": 44810323, "comment_id": 76601492, "body": "I had previously tried commenting out ie.quit to no avail, sorry forgot to mention that in the post. Using your suggested ieDOC.getElementsById(&quot;clickElement&quot;).Click results in Runtime error 438, object doesn&#39;t support this property or method. As for the shell windows suggestion I&#39;ll have to try that tomorrow, but I feel like that&#39;s not the issue either. The new tab never opens, as if the button wasn&#39;t clicked. Not that there are 2 pages to choose from and it&#39;s going to the wrong one. It&#39;s just going to the only one. Could this even be a code problem since it works on mine but not his?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "edited": false, "score": 1, "creation_date": 1498678281, "post_id": 44810323, "comment_id": 76602557, "body": "It may be a timing issue: maybe experiment with al onger delay than two seconds.  Quitting IE immediately after clicking the link is not a good plan I think, so I would also address that.  <code>ShellWindows</code>  includes Windows Explorer windows, so maybe the macro is grabbing one of those instead of your intended IE window: if your colleague has windows explorer open but you typically don&#39;t then that might explain the differences.  I&#39;m on Win7 so can&#39;t really test in any way that&#39;s going to closely mimic your setup."}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "edited": false, "score": 0, "creation_date": 1498691914, "post_id": 44810323, "comment_id": 76608524, "body": "Slight typo: (incorrect) <code>getElementsById</code> in the code block but (correct) <code>getElementById</code> in the text. Going by their comment on this answer, @SarahDawnLewis has used the incorrect version"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1498692157, "post_id": 44810323, "comment_id": 76608599, "body": "@barrowc - fixed my typo - thanks for the correction"}, {"owner": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "edited": false, "score": 0, "creation_date": 1498748618, "post_id": 44810323, "comment_id": 76637920, "body": "Neither the correct not incorrect version of getElementByID seems to be working on either laptop. I&#39;m not sure why. I double checked to make sure everything matched the getElementByID that I use earlier in my code and it does other than variable names. I haven&#39;t been able to test out the shell windows code yet, I&#39;ve been in meetings. For some reason when I change the timing on my computer it still works, but on his it crashes the macro at &quot;Set htmlColl = ieDOC.getElementsByTagName(&quot;a&quot;)&quot;. I tried moving ie.quit to just before ie2.quit. It it still works on mine, but not on his."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1498692101, "last_edit_date": 1498692101, "creation_date": 1498675594, "answer_id": 44810323, "question_id": 44809942, "link": "https://stackoverflow.com/questions/44809942/pilot-freight-tracking-macro-working-on-one-computer-but-not-another/44810323#44810323", "title": "Pilot freight tracking macro working on one computer but not another", "body": "<p>Instead of this:</p>\n\n<pre><code>Set htmlColl = ieDOC.getElementsByTagName(\"a\")\nFor Each htmlInput In htmlColl\n    If htmlInput.ID = \"clickElement\" Then\n        htmlInput.Click\n    Exit For\n    End If\nNext htmlInput\n</code></pre>\n\n<p>You should be able to just do this:</p>\n\n<pre><code> ieDOC.getElementById(\"clickElement\").Click\n</code></pre>\n\n<p><code>Id</code> is supposed to be unique within a given page.  I see you've used <code>getElementById</code> elsewhere, so was there some reason it's not used here?</p>\n\n<p>I'd guess maybe the problem is this:</p>\n\n<pre><code>ie.Quit\n</code></pre>\n\n<p>so try commenting that out. Something to do perhaps with where new pages load (new window vs new tab?)  </p>\n\n<p>If you're having problems grabbing the correct IE document, then try something like:</p>\n\n<pre><code>Function GetIE(sLocation As String) As Object\n\n    Dim objShell As Object, objShellWindows As Object, o As Object\n    Dim sURL As String\n    Dim retVal As Object\n\n    Set retVal = Nothing\n    Set objShell = CreateObject(\"Shell.Application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each o In objShellWindows\n        sURL = \"\"\n        On Error Resume Next\n        'check the URL and if it's the one you want then\n        ' assign it to the return value and exit the loop\n        sURL = o.document.Location\n        On Error GoTo 0\n        If sURL Like sLocation &amp; \"*\" Then\n            Set retVal = o\n            Exit For\n        End If\n    Next o\n    Set GetIE = retVal\n\nEnd Function\n</code></pre>\n\n<p>This function will return an IE window which matches the provided URL (i.e. the first on whose URL begins with the passed <code>sLocation</code> string)</p>\n"}], "owner": {"reputation": 11, "user_id": 8227673, "user_type": "registered", "profile_image": "https://graph.facebook.com/1364538286933627/picture?type=large", "display_name": "Sarah Dawn Lewis", "link": "https://stackoverflow.com/users/8227673/sarah-dawn-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498692101, "creation_date": 1498674209, "last_edit_date": 1498675616, "question_id": 44809942, "link": "https://stackoverflow.com/questions/44809942/pilot-freight-tracking-macro-working-on-one-computer-but-not-another", "title": "Pilot freight tracking macro working on one computer but not another", "body": "<p>Recently our office upgraded to new laptops. Luckily in changing over from Windows 7 to 10 and from desktop to Laptops we did not experience any issues with running this macro other than needing to enable popups on Pilotdelivers.com. For a few weeks now we've run this macro on two different laptops and everything has gone smoothly. </p>\n\n<p>Today, on one of the laptops the macro is no longer working correctly, but on the other it's fine. I checked to make sure popups were enabled and that both computers are running from the same excel worksheet on our network. I restarted the computer twice and ran the macro with no other applications open. Laptops are the same model, installed at the same time. Identical software installations and updates. The laptop that is having trouble is used by my less computer savvy co worker and the laptop that's working is mine. So it's possible that there's some setting he changed that he shouldn't have, but I'm not sure what to check.</p>\n\n<p>It seems like it's skipping the portion of code that clicks a link to open a new tab.</p>\n\n<p>What the macro is supposed to do: </p>\n\n<ol>\n<li>copy the tracking number on the worksheet</li>\n<li>open IE</li>\n<li>insert the tracking number into the text box</li>\n<li>click track</li>\n<li>wait for the new page to load</li>\n<li>click the tracking number link</li>\n<li>wait for the new tab to load</li>\n<li>close the first tab</li>\n<li>check to see if the most recent update is DELIVERED</li>\n<li>if yes it switches back to excel and inputs DELIVERED and the\n delivery date, if not it looks at the most recent update and adds\n that line to the worksheet.</li>\n</ol>\n\n<p>What seems like the macro is doing:</p>\n\n<ol>\n<li>copy the tracking number on the worksheet</li>\n<li>open IE</li>\n<li>insert the tracking number into the text box</li>\n<li>click track</li>\n<li>wait for the new page to load</li>\n<li>seems to skip clicking on the tracking number link</li>\n<li>wait for the current page to load (which is already loaded)</li>\n<li>when looking for the latest update it grabs the tracking number\ninstead (since it's not the expected page)</li>\n<li>check to see if it's marked DELIVERED\n10.if yes it switches back to excel and inputs DELIVERED and the\ndelivery date, if not it looks at the most recent update and adds\nthat line to the worksheet</li>\n</ol>\n\n<p>It seems like it skips some or all of this section of code:</p>\n\n<pre><code>Dim ieDOC As HTMLDocument\nSet ieDOC = ie.document\n\nSet htmlColl = ieDOC.getElementsByTagName(\"a\")\nFor Each htmlInput In htmlColl\n    If htmlInput.ID = \"clickElement\" Then\n        htmlInput.Click\n    Exit For\n    End If\nNext htmlInput\n\nie.Quit\n\nSet shellWins = New ShellWindows\nIf shellWins.Count &gt; 0 Then\n    Set ie2 = shellWins.Item(1)\nEnd If\n</code></pre>\n\n<p>Full code below:</p>\n\n<pre><code>Sub PilotTracking()\nDim ProURL As String\nDim ie As Object\nDim ie2 As Object\nDim RowCount As Integer\nDim i As Integer\nDim html_Document As HTMLDocument\nDim htmlColl As MSHTML.IHTMLElementCollection\nDim htmlInput As MSHTML.HTMLInputElement\nDim shellWins As ShellWindows\nDim htmlColl2 As MSHTML.IHTMLElementCollection\nDim htmlInput2 As MSHTML.HTMLInputElement\nDim marker As Integer\n\nRowCount = 0\nProURL = \"http://www.pilotdelivers.com/\"\n\nDo While Not ActiveCell.Offset(RowCount, -5).Value = \"\"\n\nSet ie = CreateObject(\"InternetExplorer.application\")\n\nWith ie\n    .Visible = True\n    .navigate ProURL\n    Do Until Not ie.Busy And ie.readyState = 4: DoEvents: Loop\nEnd With\n\nSet Doc = ie.document 'works don't delete\n\nDoc.getElementById(\"tbShipNum\").innerHTML = ActiveCell.Offset(RowCount, -5).Value 'works don't delete\n\nDoc.getElementById(\"btnTrack\").Click 'works don't delete\n\nDo Until Not ie.Busy And ie.readyState = 4: DoEvents: Loop\n\ni = 0\nDo While i &lt; 4\n    WaitHalfSec\n    i = i + 1\nLoop\n\nDo Until Not ie.Busy And ie.readyState = 4: DoEvents: Loop\n\nDim ieDOC As HTMLDocument\nSet ieDOC = ie.document\n\nSet htmlColl = ieDOC.getElementsByTagName(\"a\")\nFor Each htmlInput In htmlColl\n    If htmlInput.ID = \"clickElement\" Then\n        htmlInput.Click\n    Exit For\n    End If\nNext htmlInput\n\nie.Quit\n\n\nSet shellWins = New ShellWindows\nIf shellWins.Count &gt; 0 Then\n    Set ie2 = shellWins.Item(1)\nEnd If\n\ni = 0\nDo While i &lt; 8\n    WaitHalfSec\n    i = i + 1\nLoop\n\nDo Until Not ie2.Busy And ie2.readyState = 4: DoEvents: Loop\n\nSet htmlColl2 = ie2.document.getElementsByTagName(\"td\")\nFor Each htmlInput2 In htmlColl2\n    If htmlInput2.className = \"dxgv\" Then\n        If ActiveCell.Offset(RowCount).Value = \"\" Then\n            ActiveCell.Offset(RowCount).Value = htmlInput2.innerText\n        Else\n            If ActiveCell.Offset(RowCount).Value &lt;&gt; \"DELIVERED\" Then\n                ActiveCell.Offset(RowCount, -2).Value = \"\"\n            Else\n                ActiveCell.Offset(RowCount, -2).Value = htmlInput2.innerText\n            End If\n            Exit For\n        End If\n    End If\nNext htmlInput2\n\nie2.Quit\nSet shellWins = Nothing\nSet ie = Nothing\nSet ie2 = Nothing\n\nRowCount = RowCount + 1\n\nLoop\n\nSet shellWins = Nothing\nSet ie = Nothing\nSet ie2 = Nothing\n\nEnd Sub\n\nSub WaitHalfSec()\n    Dim t As Single\n    t = Timer + 1 / 2\n        Do Until t &lt; Timer: DoEvents: Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "subscript"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1498672977, "post_id": 44809503, "comment_id": 76599482, "body": "<code>1</code> You do not have a sheet with that name <code>2</code> If you can visually see it then either it has leading or trailing spaces  or it is in another workbook."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498673190, "post_id": 44809503, "comment_id": 76599597, "body": "BTW <code>Dim UAI, customer, today, prodNum, name As String</code> is declaring <code>name</code> as a <code>String</code>, and everything else is an implicit <code>Variant</code>. Ditto for <code>Dim row, rowSize, x As Integer</code> where <code>x</code> is an <code>Integer</code> and <code>row</code> and <code>rowSize</code> are implicit <code>Variant</code>. My <a href=\"http://rubberduckvba.com/inspections/list\" rel=\"nofollow noreferrer\">Rubberduck</a> add-in could fix that for you."}, {"owner": {"reputation": 17, "user_id": 8227692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926ced95f42c3e7ea6dd84208f4058a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mikayla S", "link": "https://stackoverflow.com/users/8227692/mikayla-s"}, "edited": false, "score": 0, "creation_date": 1498673244, "post_id": 44809503, "comment_id": 76599626, "body": "So the name should be the name of the file I am trying to make the macro on?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498673370, "post_id": 44809503, "comment_id": 76599708, "body": "No. <code>Sheets(&quot;Quote Log&quot;)</code> is looking to pull a sheet named &quot;Quote Log&quot; from the <code>Sheets</code> collection (should be the <code>Worksheets</code> collection BTW) of whatever workbook is the active workbook, and the error tells you that there&#39;s no &quot;Quote Log&quot; sheet in that workbook. Either you have the wrong book active, or you mispelled the sheet name, or a user went in and renamed the sheet, or whatever. There&#39;s no &quot;Quote Log&quot; sheet in the <code>Sheets</code> collection."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498673728, "post_id": 44809503, "comment_id": 76599921, "body": "That&#39;s good work on rubberduck @Mat&#39;sMug :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1498673810, "post_id": 44809503, "comment_id": 76599975, "body": "@SiddharthRout thanks! Now I need it to be able to infer types from usage, and that inspection+quickfix will be complete! =)"}, {"owner": {"reputation": 17, "user_id": 8227692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926ced95f42c3e7ea6dd84208f4058a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mikayla S", "link": "https://stackoverflow.com/users/8227692/mikayla-s"}, "edited": false, "score": 0, "creation_date": 1498673927, "post_id": 44809503, "comment_id": 76600047, "body": "I am now getting &quot;Run-time error &#39;438&#39;: Object  doesn&#39;t support this property or method on the following line: Set FeasibilitySheet = Feasibility.Workbook(&quot;Feasibility&quot;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498674231, "post_id": 44809503, "comment_id": 76600245, "body": "<code>Feasibility</code> is a <code>Workbook</code> object, it doesn&#39;t have a <code>Workbook</code> member. Do you not get intellisense/autocomplete when you type the dot after <code>Feasibility.</code>?"}, {"owner": {"reputation": 17, "user_id": 8227692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926ced95f42c3e7ea6dd84208f4058a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mikayla S", "link": "https://stackoverflow.com/users/8227692/mikayla-s"}, "edited": false, "score": 0, "creation_date": 1498674685, "post_id": 44809503, "comment_id": 76600491, "body": "No, I do not get that when I type the dot."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498674984, "post_id": 44809503, "comment_id": 76600649, "body": "You do not have as sheet <code>Feasibility</code> in the workbook <code>QF-010 UMD Team Feasibility R1.xlsx</code>. Open it manually and check."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498675140, "post_id": 44809503, "comment_id": 76600737, "body": "<code>Sub Feasibility()</code> and then <code>Dim Feasibility As Workbook</code>? Bad idea. Not that you will get an error in your above code but like I said it is a bad idea. Change one of them"}, {"owner": {"reputation": 17, "user_id": 8227692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926ced95f42c3e7ea6dd84208f4058a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mikayla S", "link": "https://stackoverflow.com/users/8227692/mikayla-s"}, "edited": false, "score": 0, "creation_date": 1498675143, "post_id": 44809503, "comment_id": 76600740, "body": "Correct, I only have one sheet and it is called Sheet1"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498675171, "post_id": 44809503, "comment_id": 76600757, "body": "So change <code>Set FeasibilitySheet = Feasibility.Sheets(&quot;Feasibility&quot;)</code> to <code>Set FeasibilitySheet = Feasibility.Sheets(&quot;Sheet1&quot;)</code>"}, {"owner": {"reputation": 17, "user_id": 8227692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926ced95f42c3e7ea6dd84208f4058a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mikayla S", "link": "https://stackoverflow.com/users/8227692/mikayla-s"}, "edited": false, "score": 0, "creation_date": 1498675206, "post_id": 44809503, "comment_id": 76600779, "body": "The issue is that I did not write any of this code and have never worked with macros and I am trying to fix someone else&#39;s code that is broken"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498675273, "post_id": 44809503, "comment_id": 76600818, "body": "<code>The issue is that I did not write any of this code and have never worked with macros and I am trying to fix someone else&#39;s code that is broken \u2013 Mikayla S just now</code> Then you are in the wrong forum. :) You have 2 options <code>1</code> Learn VBA and then try fixing it <code>2</code> Hire someone to fix it."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498675307, "post_id": 44809503, "comment_id": 76600835, "body": "Sorry but I will have to vote to close this question as &quot;Too Broad&quot;"}, {"owner": {"reputation": 17, "user_id": 8227692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926ced95f42c3e7ea6dd84208f4058a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mikayla S", "link": "https://stackoverflow.com/users/8227692/mikayla-s"}, "edited": false, "score": 0, "creation_date": 1498675553, "post_id": 44809503, "comment_id": 76600991, "body": "Thank you! The code is now working."}], "owner": {"reputation": 17, "user_id": 8227692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926ced95f42c3e7ea6dd84208f4058a6?s=128&d=identicon&r=PG&f=1", "display_name": "Mikayla S", "link": "https://stackoverflow.com/users/8227692/mikayla-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 699, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498673047, "creation_date": 1498672511, "last_edit_date": 1498673047, "question_id": 44809503, "link": "https://stackoverflow.com/questions/44809503/run-time-error-9-subscript-out-of-range-when-naming-a-sheet", "title": "Run-time error &#39;9&#39;: Subscript out of range when naming a sheet", "body": "<p>The following is an Excel Macro that I am trying to debug but I have never worked with these before.</p>\n\n<p>The line <code>Set log = Sheets(\"Quote Log\")</code> is being highlighted in yellow and the error is <code>Sheets(\"Quote Log\")</code> = <em>Subscript out of range</em></p>\n\n<pre><code>Sub Feasibility()\n\n    Dim Feasibility As Workbook\n    Dim FeasibilitySheet, log As Worksheet\n    Dim row, rowSize, x As Integer\n    Dim UAI, customer, today, prodNum, name As String\n\n    Set log = Sheets(\"Quote Log\")\n    Application.ScreenUpdating = False\n\n    If checkSelection() Then\n\n        row = getSelectionRow()\n        rowSize = getSelectionRowSize()\n\n        For x = row To rowSize\n            Set Feasibility = Workbooks.Open(Environ$(\"UserProfile\") &amp; \"\\My Documents\\\" &amp; \"QF-010 UMD Team Feasibility R1.xlsx\")\n            Set FeasibilitySheet = Feasibility.Sheets(\"Feasibility\")\n\n            UAI = log.Cells(x, 1)\n            customer = log.Cells(x, 2)\n            prodNum = log.Cells(x, 5)\n            name = log.Cells(x, 6)\n            today = log.Cells(x, 17)\n\n           FeasibilitySheet.Range(\"B3\") = customer\n           FeasibilitySheet.Range(\"F3\") = today\n           FeasibilitySheet.Range(\"C4\") = prodNum\n           FeasibilitySheet.Range(\"C5\") = name\n           FeasibilitySheet.Range(\"D41\") = today\n           FeasibilitySheet.Range(\"D43\") = today\n           FeasibilitySheet.Range(\"E45\") = today\n\n\n            Feasibility.SaveAs Environ$(\"UserProfile\") &amp; \"\\My Documents\\\" &amp; _\n                 \"Feasibility \" &amp; prodNum &amp; \" \" &amp; UAI &amp; \".xls\"\n\n           Feasibility.Close\n\n\n        Next\n\n    End If\n\n    ''''\n\n\n    Application.ScreenUpdating = True\n    'RFI\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 285, "user_id": 4363220, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/72b2ab45797bd766e0bedceeeccf7cca?s=128&d=identicon&r=PG&f=1", "display_name": "Jian", "link": "https://stackoverflow.com/users/4363220/jian"}, "edited": false, "score": 0, "creation_date": 1498675854, "post_id": 44810033, "comment_id": 76601176, "body": "The code creates worksheets with names a_1, a_2, b_1, b_2, c_1, c_2, d_1, and d_2."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 285, "user_id": 4363220, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/72b2ab45797bd766e0bedceeeccf7cca?s=128&d=identicon&r=PG&f=1", "display_name": "Jian", "link": "https://stackoverflow.com/users/4363220/jian"}, "edited": false, "score": 0, "creation_date": 1498675966, "post_id": 44810033, "comment_id": 76601237, "body": "Yeah, I thought it looked funny the first time around. Should be fixed now."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1498675942, "last_edit_date": 1498675942, "creation_date": 1498674539, "answer_id": 44810033, "question_id": 44809488, "link": "https://stackoverflow.com/questions/44809488/create-worksheet-multiply-times-for-the-same-type-using-vba-macro/44810033#44810033", "title": "Create worksheet multiply times for the same type using VBA macro", "body": "<p>Collect the name prefix and the number of suffixes into an array.</p>\n\n<pre><code>Sub GenerateWorksheets()\n    Dim a as long, b as long, nams as variant\n\n    with workSheets(\"Sheet1\")\n        nams = .Range(.cells(2, \"A\"), .cells(.rows.count, \"B\").end(xlup)).value2\n    end with\n\n    For a =lbound(nams, 1) to ubound(nams, 1)\n        For b =1 to nams(a, 2)\n            with workSheets.Add( after:=workSheets(workSheets.Count))\n                .name = nams(a, 1) &amp; \"_\" &amp; b\n            end with\n        next b\n    Next a\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 4363220, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/72b2ab45797bd766e0bedceeeccf7cca?s=128&d=identicon&r=PG&f=1", "display_name": "Jian", "link": "https://stackoverflow.com/users/4363220/jian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 44810033, "answer_count": 1, "score": -1, "last_activity_date": 1498677032, "creation_date": 1498672440, "last_edit_date": 1498677032, "question_id": 44809488, "link": "https://stackoverflow.com/questions/44809488/create-worksheet-multiply-times-for-the-same-type-using-vba-macro", "title": "Create worksheet multiply times for the same type using VBA macro", "body": "<p>I am trying to create worksheet multiply times for different items specified in sheet1 using VBA macro.</p>\n\n<p>For example, I have a table in sheet1 with some test type and the times tested.</p>\n\n<pre><code>Test Type          Times Tested\n   a                     1  \n   b                     2  \n   c                     1  \n   d                     2  \n</code></pre>\n\n<p>I want macro to create sets of worksheets with the following names: a_1, b_1, b_2, c_1, d_1, and d_2 based on the test type and the times tested.</p>\n\n<p>Following is the code I have written only for the test type, which only creates sheets with names: a, b, c, and d</p>\n\n<pre><code>Sub GenerateWorksheets()\n    Dim MyCell As Range, MyRange As Range\n\n    Set MyRange = Sheets(\"Sheet1\").Range(\"A2\")\n    Set MyRange = Range(MyRange, MyRange.End(xlDown))\n\n    For Each MyCell In MyRange\n        Sheets.Add after:=Sheets(Sheets.Count)\n        Sheets(Sheets.Count).Name = MyCell.Value\n    Next MyCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1498676840, "post_id": 44809362, "comment_id": 76601780, "body": "add DoEvents before your Loop Until mensaje = 1 as it sounds like it is a screen updating issue, unless this is not all the code and you turn screen updating on/off somewhere."}, {"owner": {"reputation": 11, "user_id": 8227438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47abba21b8a9be488041ca12d2dab0a?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo R", "link": "https://stackoverflow.com/users/8227438/gonzalo-r"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1498677721, "post_id": 44809362, "comment_id": 76602254, "body": "Yes, this is all the code. It worked with screenupdating option, thanks!"}], "owner": {"reputation": 11, "user_id": 8227438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c47abba21b8a9be488041ca12d2dab0a?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalo R", "link": "https://stackoverflow.com/users/8227438/gonzalo-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1524058164, "creation_date": 1498671924, "last_edit_date": 1531164843, "question_id": 44809362, "link": "https://stackoverflow.com/questions/44809362/vba-excel-the-hangman", "title": "VBA Excel - The Hangman", "body": "<p>I was trying to develop a code for the hangman using the template in this picture. <a href=\"http://www.wiseowl.co.uk/files/exercise-images/e1759/i3892.gif\" rel=\"nofollow noreferrer\">http://www.wiseowl.co.uk/files/exercise-images/e1759/i3892.gif</a></p>\n\n<p>I think I have managed to do that; however, one problem that I have is that the when the subroutine is working and the user calls for a wrong letter, the shape does not automatically color to black. It is just when the game finishes that the user can see the picture colored, whether he/she wins or loses.</p>\n\n<p>Do you know any way to fix this?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub nuevo_juego()\n'Erasing the word\nSet palabra = ThisWorkbook.Worksheets(\"Game\").[b2]\n\ni = 0\nWhile Not IsEmpty(palabra.Offset(0, i))\n   i = i + 1\nWend\n\npalabra.Resize(2, i + 1).Clear\n\n\n'Hide Figure\nFor Each a In Worksheets(\"Game\").Shapes\n    a.Line.ForeColor.RGB = RGB(255, 255, 255)\nNext a\n\n\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'                    Game                      '\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\n'User 1 introduces a word\nword = InputBox(\"User 1: Enter a word\")\nn_word = Len(word)\n\nSet palabra = ThisWorkbook.Worksheets(\"Game\").[b2]\n\nFor x = 1 To n_word\n    palabra.Offset(0, x - 1).Font.Color = RGB(255, 255, 255)\n    palabra.Offset(0, x - 1) = Mid(word, x, 1)\nNext x\n\n'Count the number of shapes (tries) the person has\nn_shapes = Worksheets(\"Game\").Shapes.Count\n\nSet inicio = palabra.Offset(1, 0)\n\ns = 0\n\nDo\n\n'Count the number of words the user has guessed\nn_guess = WorksheetFunction.CountA(inicio.Resize(1, n_word))\n\n'If the number of letters guessed is equal to the length of the word and the last shape is still white, you win\nIf n_guess = n_word And Worksheets(\"Game\").Shapes(n_shapes).Line.ForeColor.RGB = RGB(255, 255, 255) \nThen\n    MsgBox (\"Ganaste!!\")\n    mensaje = 1\n\n'If the number of letters guessed is less than the length of the word and the last shape is black, you win\nElseIf n_guess &lt; n_word And Worksheets(\"Game\").Shapes(n_shapes).Line.ForeColor.RGB = RGB(0, 0, 0) Then\n    MsgBox (\"Perdiste!!\")\n    mensaje = 1\n\n'Otherwise, we keep playing\nElse\n    'User 2 guesses a letter\n    letra = InputBox(\"User 2: Guess a letter\", \n\"Hangman\")\n\n'Ask letter by letter of the word chosen by user 1 if it is equal to the guessed letter. If it is, then we put the letter in the cell below. We count if there is any math in cont.\ncont = 0\nFor j = 0 To n_word - 1\n    If palabra.Offset(0, j).Value = letra Then\n        cont = cont + 1\n        inicio.Offset(0, j) = palabra.Offset(0, j)\n    End If\nNext j\n\n'If there was not a match, then a shape is colored (HERE IS MY PROBLEM). If not, keep playing.\n    If cont = 0 Then\n        s = s + 1\n        MsgBox (\"There was not a match, please try again. You have \" &amp; 9 - s &amp; \" tries left\")\n        Worksheets(\"Game\").Shapes(s).Line.ForeColor.RGB = RGB(0, 0, 0)\n    Else\n        MsgBox (\"You guessed a letter!\")\n    End If\n\nEnd If\n\nLoop Until mensaje = 1\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "answers": [{"comments": [{"owner": {"reputation": 217, "user_id": 4502464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/3m5gt.jpg?s=128&g=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/4502464/ashwin"}, "edited": false, "score": 0, "creation_date": 1498731930, "post_id": 44809686, "comment_id": 76624972, "body": "Thanks for the suggestions, code looks clean now.  How can i make this <code>Function sheetExists</code> function case sensitive? For Example: If my excel have a sheet called <code>sheet1</code> and i pass <code>SHEET1</code> into <code>sheetToFind</code>, it should treat <code>SHEET1</code> as a new sheet."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 217, "user_id": 4502464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/3m5gt.jpg?s=128&g=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/4502464/ashwin"}, "edited": false, "score": 1, "creation_date": 1498746760, "post_id": 44809686, "comment_id": 76636393, "body": "@Ashwin You can&#39;t do that; sheet names ARE case insensitive! You wont be able to add a new sheet with an existing name with changing case."}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 3, "last_activity_date": 1498676199, "last_edit_date": 1498676199, "creation_date": 1498673260, "answer_id": 44809686, "question_id": 44809181, "link": "https://stackoverflow.com/questions/44809181/avoid-adding-duplicate-sheets-to-excel-work-book/44809686#44809686", "title": "Avoid adding duplicate sheets to Excel Work book", "body": "<p>You have a parameter <code>wb As Excel.Workbook</code> to your <code>Function sheetExists</code>, great, use it! why use then the hazardous <code>ActiveWorkbook</code>, which has all chances to be some other WB than the one you want to examine?</p>\n\n<p>Replace all occurrences of <code>ActiveWorkbook</code> with <code>wb</code></p>\n\n<pre><code>Function sheetExists(sheetToFind ,wb As Excel.Workbook) As Boolean\n    WS_Count = wb.Worksheets.Count  ' &lt;-------------------------------------- wb\n    sheetExists = False\n\n    For I = 1 To WS_Count\n        If wb.Worksheets(I).Name = sheetToFind Then    ' &lt;------------------- wb\n            sheetExists = True\n            Exit Function\n        End If\n    Next\nEnd Function\n</code></pre>\n\n<p>Moreover, the other code needs some corrections in addition to dropping the <code>Activate</code> stuff</p>\n\n<pre><code>For Each SheetName In SheetNames\n     If Not sheetExists(SheetName , newWB) Then\n        Set FilPage = newWB.Worksheets.Add\n        SheetName = Replace(Replace(Replace(Replace(Replace(SheetName, \".\", \" \"), \"[\", \" \"), \"]\", \" \"), \"/\", \"_\"), \"\\\", \" \")\n        If Len(SheetName) &gt; 30 Then SheetName = Left(SheetName, 23) &amp; \"-trimed\"\n        FilPage.Name = SheetName\n        FilPage.Range(\"A1\").PasteSpecial\n    End If\nNext\n</code></pre>\n\n<hr>\n\n<p>The function SheetExists can be further simplified as: (Copyright @DavidZemens)</p>\n\n<pre><code>Function sheetExists(sheetToFind,wb As Excel.Workbook) As Boolean\n    Dim ws as Worksheet\n    sheetExists = False\n    On Error Resume Next\n    Set ws = wb.Worksheets(sheetToFind)\n    sheetExists = Not (ws Is Nothing)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 4502464, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/3m5gt.jpg?s=128&g=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/4502464/ashwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 44809686, "answer_count": 1, "score": 0, "last_activity_date": 1498676199, "creation_date": 1498671251, "last_edit_date": 1498671722, "question_id": 44809181, "link": "https://stackoverflow.com/questions/44809181/avoid-adding-duplicate-sheets-to-excel-work-book", "title": "Avoid adding duplicate sheets to Excel Work book", "body": "<p>I have a collection words inside <code>SheetNames</code> and i'm trying to add new <code>Worksheet</code> for each word inside <code>SheetNames</code>, please find the code below.</p>\n\n<p>Before adding the <code>Worksheet</code> i'm trying to validate whether the sheet is already existing in my workbook using <code>sheetExists function</code>, code provided below.</p>\n\n<pre><code>For Each SheetName In SheetNames\n\n     If sheetExists(SheetName , newWB) = False Then\n        newWB.Activate\n        Set FilPage = Worksheets.Add\n        FilPage.Activate\n        SheetName = Replace(Replace(Replace(Replace(Replace(SheetName, \".\", \" \"), \"[\", \" \"), \"]\", \" \"), \"/\", \"_\"), \"\\\", \" \")\n        If Len(SheetName) &lt;= 30 Then\n            FilPage.Name = SheetName\n        Else\n            SheetName = Left(SheetName, 23) &amp; \"-trimed\"\n        End If\n        ActiveSheet.Range(\"A1\").Activate\n        ActiveCell.PasteSpecial\n    End If\nNext\n</code></pre>\n\n<p>The code valediction using <code>function sheetExists</code> is not working consistently.</p>\n\n<pre><code>Function sheetExists(sheetToFind ,wb As Excel.Workbook) As Boolean\n\n    WS_Count = ActiveWorkbook.Worksheets.Count\n\n    sheetExists = False\n\n    For I = 1 To WS_Count\n        If ActiveWorkbook.Worksheets(I).Name = sheetToFind Then\n            sheetExists = True\n            Exit Function\n        End If\n    Next\n\nEnd Function\n</code></pre>\n\n<p>i can see some of the worksheet added with names \"Sheet99\" or \"Sheet12\" etc. even though <code>SheetName</code> is passed into the function. sometimes if <code>sheetExists function returns True</code> still workbook is trying to add a <code>worksheet</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 243, "user_id": 6456800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7d9c1c5f3fb0426747663d2c944482?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown", "link": "https://stackoverflow.com/users/6456800/unknown"}, "edited": false, "score": 0, "creation_date": 1498671719, "post_id": 44809130, "comment_id": 76598749, "body": "Validate pivot table name &quot;PivotTable1&quot; and pivot field name &quot;Sum of Income&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8183316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507177b37cb7f37a57340167d59ca399?s=128&d=identicon&r=PG&f=1", "display_name": "rmj209", "link": "https://stackoverflow.com/users/8183316/rmj209"}, "edited": false, "score": 1, "creation_date": 1498680649, "post_id": 44809355, "comment_id": 76603919, "body": "Thanks! I used the macro recorder and saw that ActiveSheet.PivotTables(&quot;PivotTable1&quot;).PivotFields(&quot;[Measure&zwnj;&#8203;s].[Sum of Income]&quot;) was the correct code."}, {"owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "reply_to_user": {"reputation": 11, "user_id": 8183316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507177b37cb7f37a57340167d59ca399?s=128&d=identicon&r=PG&f=1", "display_name": "rmj209", "link": "https://stackoverflow.com/users/8183316/rmj209"}, "edited": false, "score": 0, "creation_date": 1498680831, "post_id": 44809355, "comment_id": 76604007, "body": "Glad I helped you :)"}], "tags": [], "owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "is_accepted": false, "score": 0, "last_activity_date": 1498671898, "creation_date": 1498671898, "answer_id": 44809355, "question_id": 44809130, "link": "https://stackoverflow.com/questions/44809130/vba-for-pivot-table-with-query-table-as-data-source/44809355#44809355", "title": "VBA for Pivot Table with query table as data source", "body": "<p>It would seem your code isn't able to reach the <code>.Calcuation</code> propertie. Try to use a macro recorder to check if your names are valid when you use this code. </p>\n\n<p>My guess is that \"Sum of Income\" is the source of this error in your case.</p>\n"}], "owner": {"reputation": 11, "user_id": 8183316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/507177b37cb7f37a57340167d59ca399?s=128&d=identicon&r=PG&f=1", "display_name": "rmj209", "link": "https://stackoverflow.com/users/8183316/rmj209"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 362, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498688567, "creation_date": 1498671072, "last_edit_date": 1498688567, "question_id": 44809130, "link": "https://stackoverflow.com/questions/44809130/vba-for-pivot-table-with-query-table-as-data-source", "title": "VBA for Pivot Table with query table as data source", "body": "<p>I have a pivot table that has a connection to a query in the workbook to serve as the data source. When I try to write the following VBA code:</p>\n\n<pre><code>ActiveSheet.PivotTables(\"PivotTable1\").PivotFields(\"Sum of Income\").Calculation = xlNormal,\n</code></pre>\n\n<p>I get runtime error:</p>\n\n<blockquote>\n  <p>'1004' - unable to get the pivotfields property of the pivottable class. </p>\n</blockquote>\n\n<p>Is this because I have an error in my code or because I'm not using a regular data source?</p>\n"}, {"tags": ["date", "ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498670722, "post_id": 44808932, "comment_id": 76598152, "body": "What do you mean by &#39;breaks&#39;? What error do you get? EmpEndDate is not referenced in any expression. Perhaps you need to use Nz() function. You have a custom function Months()? The intrinsic function is Month()."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1498671048, "post_id": 44808932, "comment_id": 76598333, "body": "I do not see you declare EmpEndDate  anywhere in the code you provide so where would this variable come from?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1498671309, "post_id": 44808932, "comment_id": 76598528, "body": "@Sorceri it&#39;s not referenced anywhere in the function either. Perhaps OP means to add it as a parameter?"}, {"owner": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "edited": false, "score": 0, "creation_date": 1498671771, "post_id": 44808932, "comment_id": 76598782, "body": "My sincerest apologies for not providing nearly enough information. I&#39;ve updated my question."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "edited": false, "score": 0, "creation_date": 1498675632, "post_id": 44809530, "comment_id": 76601043, "body": "It works! It&#39;s a miracle! But only when there&#39;s an EmpStartDate entered. Otherwise, I get #Type! errors. Why is this?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "edited": false, "score": 0, "creation_date": 1498676482, "post_id": 44809530, "comment_id": 76601580, "body": "@Zuzu You have a Nz function that I do not know.  I ran this giving a start date of 45 days previous to today and an end date of now.  Removing the Nz Function it returns -2 so possible your error is in there?..."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1498683006, "post_id": 44809530, "comment_id": 76605193, "body": "You don&#39;t have to convert to a number. Dates are dates, so: <code>If EmpEndDate = #00:00# Then EmpEndDate = Date</code>."}, {"owner": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "edited": false, "score": 0, "creation_date": 1498747680, "post_id": 44809530, "comment_id": 76637132, "body": "Hrm. I&#39;m clearly not understanding. I&#39;ve tried the following (and a few slight variations) in VBA: ?RetentionMonths(2015-01-01, Nz(EmpEndDate, Date)) and ?RetentionMonths(2015-01-01, Nz(2017-06-29, Date)) ... And I&#39;m getting 1339 or -4. Ack. I&#39;m sorry, I&#39;m such a noob. :( I also clearly don&#39;t know how to format comments here either... sorry for the block of text."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "reply_to_user": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "edited": false, "score": 0, "creation_date": 1498754380, "post_id": 44809530, "comment_id": 76641776, "body": "@Zuzu  add the NZ function to your question"}, {"owner": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "edited": false, "score": 0, "creation_date": 1498760047, "post_id": 44809530, "comment_id": 76645021, "body": "Sorceri, would it be possible for you to provide an example? Terribly sorry for the trouble!"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1498765170, "post_id": 44809530, "comment_id": 76647809, "body": "in your RetentionMonths function the last line is RetentionMonths = Months(FollowingMonth, Nz(EmpEndDate, Date)).  NZ(Date, Date) is a Method you must have created.  Edit your question to include this method.  Also an example of how you are calling the method and I am guessing the cell format as well."}, {"owner": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "edited": false, "score": 0, "creation_date": 1499886886, "post_id": 44809530, "comment_id": 77104943, "body": "Forgot to follow up on this question -- oops. I rewrote the whole thing from scratch and got it working. Must&#39;ve been some stupid little typo somewhere. Thank you for your help!! :)"}], "tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": true, "score": 0, "last_activity_date": 1498672631, "creation_date": 1498672631, "answer_id": 44809530, "question_id": 44808932, "link": "https://stackoverflow.com/questions/44808932/access-use-date-if-available-else-use-todays-date/44809530#44809530", "title": "Access - Use date if available, else use today&#39;s date", "body": "<p>you can check for the value of 0 for the end date by using clng</p>\n\n<pre><code>Public Function RetentionMonths(ByVal EmpStartDate As Date, _\n    Optional ByVal EmpEndDate As Date) _\n    As Integer\n\n    Dim RetentionStartdate As Date\n    Dim FollowingMonth As Date\n    Dim tempEndDate As Date\n\n    If CLng(EmpEndDate) = 0 Then EmpEndDate = Now()\n\n\n        RetentionStartdate = DateAdd(\"ww\", 14, DateAdd(\"d\", vbSaturday - Weekday(EmpStartDate), EmpStartDate))\n        FollowingMonth = DateSerial(Year(RetentionStartdate), Month(RetentionStartdate) + 1, 1)\n        RetentionMonths = Months(FollowingMonth, Nz(EmpEndDate, Date))\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8003877, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/68549eb5964eb6b71853ea103fcef0dd?s=128&d=identicon&r=PG&f=1", "display_name": "Zuzu", "link": "https://stackoverflow.com/users/8003877/zuzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 44809530, "answer_count": 1, "score": 0, "last_activity_date": 1498672631, "creation_date": 1498670404, "last_edit_date": 1498671735, "question_id": 44808932, "link": "https://stackoverflow.com/questions/44808932/access-use-date-if-available-else-use-todays-date", "title": "Access - Use date if available, else use today&#39;s date", "body": "<p>So this is driving me crazy and it should be super easy to do. I don't know why I can't get it working. :( At present my functions are calculating the difference between a start date and today's date, and it's working great, but now I need to implement an optional end date. So if there is an EmpEndDate available, it should be used, otherwise today's date should be used.</p>\n\n<p>Here's one of my functions:</p>\n\n<pre><code>Public Function RetentionMonths(ByVal EmpStartDate As Date) As Integer\n\n    Dim RetentionStartdate As Date\n    Dim FollowingMonth As Date\n\n        RetentionStartdate = DateAdd(\"ww\", 14, DateAdd(\"d\", vbSaturday - Weekday(EmpStartDate), EmpStartDate))\n        FollowingMonth = DateSerial(Year(RetentionStartdate), Month(RetentionStartdate) + 1, 1)\n        RetentionMonths = Months(FollowingMonth, Date)\n\nEnd Function\n</code></pre>\n\n<p>Edit: The Months() function</p>\n\n<pre><code>Public Function Months( _\n  ByVal datDate1 As Date, _\n  ByVal datDate2 As Date, _\n  Optional ByVal booLinear As Boolean) _\n  As Integer\n\n  Dim intDiff   As Integer\n  Dim intSign   As Integer\n  Dim intMonths As Integer\n\n  intMonths = DateDiff(\"m\", datDate1, datDate2)\n\n  If DateDiff(\"d\", datDate1, datDate2) &gt; 0 Then\n    intSign = Sgn(DateDiff(\"d\", DateAdd(\"m\", intMonths, datDate1), datDate2))\n    intDiff = Abs(intSign &lt; 0)\n  Else\n    intSign = Sgn(DateDiff(\"d\", DateAdd(\"m\", -intMonths, datDate2), datDate1))\n    If intSign &lt;&gt; 0 Then\n      intDiff = Abs(booLinear)\n    End If\n    intDiff = intDiff - Abs(intSign &lt; 0)\n  End If\n\n  Months = intMonths - intDiff\n\nEnd Function\n</code></pre>\n\n<p>And one way I've tried to tackle the issue:</p>\n\n<pre><code>Public Function RetentionMonths(ByVal EmpStartDate As Date, _\n    Optional ByVal EmpEndDate As Date) _\n    As Integer\n\n    Dim RetentionStartdate As Date\n    Dim FollowingMonth As Date\n\n        RetentionStartdate = DateAdd(\"ww\", 14, DateAdd(\"d\", vbSaturday - Weekday(EmpStartDate), EmpStartDate))\n        FollowingMonth = DateSerial(Year(RetentionStartdate), Month(RetentionStartdate) + 1, 1)\n        RetentionMonths = Months(FollowingMonth, Nz(EmpEndDate, Date))\n\nEnd Function\n</code></pre>\n\n<p>I'm either getting crazy negative numbers in fields that used to work, or #Name? errors.</p>\n"}, {"tags": ["excel", "vba", "checkbox"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498670093, "post_id": 44808785, "comment_id": 76597792, "body": "The easiest thing to do would be to name your checkboxes so that you can use their name in order to deduce which Column they are for. I.e., name it <code>Col1Checkbox1</code> so you can use <code>Instr(0,cb.Name,&quot;Col1&quot;)</code> as part of a <code>if</code> statement"}, {"owner": {"reputation": 13, "user_id": 6475112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98dac7ed7da06f8ce8dbb03ca2820636?s=128&d=identicon&r=PG&f=1", "display_name": "cmileski1993", "link": "https://stackoverflow.com/users/6475112/cmileski1993"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498671031, "post_id": 44808785, "comment_id": 76598323, "body": "so if it is like 500 checkboxes I would have to name all 500?"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498671246, "post_id": 44808785, "comment_id": 76598483, "body": "Why not create the checkboxes programmatically? Then you can specify the column without the name."}, {"owner": {"reputation": 13, "user_id": 6475112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98dac7ed7da06f8ce8dbb03ca2820636?s=128&d=identicon&r=PG&f=1", "display_name": "cmileski1993", "link": "https://stackoverflow.com/users/6475112/cmileski1993"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498671651, "post_id": 44808785, "comment_id": 76598716, "body": "Not 100% sure on how to do that. i was using kutools to batch make all the checkboxes."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498671989, "post_id": 44808785, "comment_id": 76598907, "body": "<code>Set cb = ActiveSheet.CheckBoxes.Add(99.75, 78, 24, 17.25)</code> then <code>cb.Name=&quot;yourname&quot;</code> sets the name.  You can put this in a loop and change the x,y coordinates to generate the checkboxes"}, {"owner": {"reputation": 13, "user_id": 6475112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98dac7ed7da06f8ce8dbb03ca2820636?s=128&d=identicon&r=PG&f=1", "display_name": "cmileski1993", "link": "https://stackoverflow.com/users/6475112/cmileski1993"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498672660, "post_id": 44808785, "comment_id": 76599292, "body": "if its not to big of a deal could you write exactly how I would need to put that into vba. I am very new to vba."}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1498672760, "post_id": 44808785, "comment_id": 76599351, "body": "You can also use Offset:  <code>cb.LinkedCell = cb.Offset(i, 3).Address</code> Since you know each column is three columns over from the current Checkbox."}, {"owner": {"reputation": 13, "user_id": 6475112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98dac7ed7da06f8ce8dbb03ca2820636?s=128&d=identicon&r=PG&f=1", "display_name": "cmileski1993", "link": "https://stackoverflow.com/users/6475112/cmileski1993"}, "edited": false, "score": 0, "creation_date": 1498673073, "post_id": 44808785, "comment_id": 76599537, "body": "for cb.LinkedCell = ActiveSheet.CheckBoxes.Offset(i, 3).Address i got error run-time error &#39;438&#39;: Object dosen&#39;t support this property or method."}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "edited": false, "score": 0, "creation_date": 1498673262, "post_id": 44808785, "comment_id": 76599635, "body": "Wow... you were quick.  As I hit enter, I realized I had a mistake.  I edited it, but you found my first entry.  Refresh your page and try <code>cb</code> instead of <code>activesheet.CheckBoxes</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6475112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98dac7ed7da06f8ce8dbb03ca2820636?s=128&d=identicon&r=PG&f=1", "display_name": "cmileski1993", "link": "https://stackoverflow.com/users/6475112/cmileski1993"}, "edited": false, "score": 0, "creation_date": 1498678992, "post_id": 44809890, "comment_id": 76602927, "body": "it didn&#39;t like          cb.LinkedCell = cb.Offset(i, 3).Address"}, {"owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "reply_to_user": {"reputation": 13, "user_id": 6475112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98dac7ed7da06f8ce8dbb03ca2820636?s=128&d=identicon&r=PG&f=1", "display_name": "cmileski1993", "link": "https://stackoverflow.com/users/6475112/cmileski1993"}, "edited": false, "score": 0, "creation_date": 1498751530, "post_id": 44809890, "comment_id": 76640060, "body": "I made a change to the code to use a Range cell so the offset will work.  See if that helps."}], "tags": [], "owner": {"reputation": 593, "user_id": 3421419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ar7RS.jpg?s=128&g=1", "display_name": "abraxascarab", "link": "https://stackoverflow.com/users/3421419/abraxascarab"}, "is_accepted": true, "score": 1, "last_activity_date": 1498750819, "last_edit_date": 1498750819, "creation_date": 1498674021, "answer_id": 44809890, "question_id": 44808785, "link": "https://stackoverflow.com/questions/44808785/vba-code-to-link-checkboxes-to-certain-columns/44809890#44809890", "title": "VBA Code to link checkboxes to certain columns", "body": "<p><strong>Edit</strong></p>\n\n<p>Ok... let's try again:</p>\n\n<p>Since the Check Box object does not have cell information for the cell it's located in, we will have to use the <code>Offset</code> property more creatively.</p>\n\n<p>Since we know there are 3 check boxes per row, we can find the total number of check boxes and divide by 3 to find out how many rows there are.</p>\n\n<p>Then by setting a Range to a single cell at the top of column \"E\", you can use the offset property on that cell.</p>\n\n<p>Assuming you placed your Check Boxes on the sheet down column \"E\" sequentially, and then down column \"F\" next, then down \"G\", we can reset the offsets once we get to the last row of each column.  (If you place the check boxes on the sheet in row order, you'll have to invert the loop logic.)  (If you placed the check boxes on randomly, you are out of luck and will have to set your linked cells manually.)</p>\n\n<pre><code>Sub LinkChecks()\n\nDim rng As Range\n\nDim strColumn As String\n\nDim i As Integer\nDim intCount As Integer\nDim intRowCnt As Integer\nDim intRowOffset As Integer\nDim intColumnOffset As Integer\nDim dCnt As Double\n\ni = 1               ' Your initial row offset\nintCount = 0        ' A counter for total number of check boxes\nintRowCnt = 0       ' A Row counter to find last row\nintRowOffset = i    ' Current Row offset from initial rng cell\nintColumnOffset = 3 ' Current Column Offset (3 over from first check box column)\n\nstrColumn = \"E\"     ' Set a starting Column of your first check box\nSet rng = ActiveSheet.Cells(1, strColumn) ' Set initial rng cell\n\n' Count how many check boxes are on the active sheet\nFor Each cb In ActiveSheet.CheckBoxes\n   intCount = intCount + 1\nNext cb\n\n' Since you know you have 3 check boxes per row,\n'   you can divide by 3 to get your row count\ndCnt = intCount / 3\n' *** Put test for remainder problems here ***\n\nFor Each cb In ActiveSheet.CheckBoxes\n\n   cb.LinkedCell = rng.Offset(intRowOffset, intColumnOffset).Address\n   intRowOffset = intRowOffset + 1\n\n   ' Increment your row count until you get to last row\n   intRowCnt = intRowCnt + 1\n   If intRowCnt &gt;= dCnt Then\n      intRowCnt = 0 ' Reset you row counter\n      intColumnOffset = intColumnOffset + 1 ' Increment Offset to the next column\n      intRowOffset = i ' Reset Row offset back to top row\n   End If\n\nNext cb\n\nEnd Sub\n</code></pre>\n\n<p>As long as your check boxes were placed on the sheet down each column, the above program should find the correct Linked Cell for each box.</p>\n\n<p>If they were placed in a different order, then at least this code shows you how to set an initial Range cell and how you can reference other cells with an offset.</p>\n\n<p>Hopefully this code or a combination of these ideas will help you with your problem. :)</p>\n"}], "owner": {"reputation": 13, "user_id": 6475112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98dac7ed7da06f8ce8dbb03ca2820636?s=128&d=identicon&r=PG&f=1", "display_name": "cmileski1993", "link": "https://stackoverflow.com/users/6475112/cmileski1993"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1423, "favorite_count": 0, "accepted_answer_id": 44809890, "answer_count": 1, "score": 1, "last_activity_date": 1558534974, "creation_date": 1498669873, "last_edit_date": 1558534974, "question_id": 44808785, "link": "https://stackoverflow.com/questions/44808785/vba-code-to-link-checkboxes-to-certain-columns", "title": "VBA Code to link checkboxes to certain columns", "body": "<p>I have three columns E(insufficient QTY) F(Too Slow) and G(Not Listed) They all have checkboxes in them. I need to link\nE to H\nF to I\nG to J</p>\n\n<p>The following code works nicely if there was only 1 column of checkboxes but I don't know how to improve the code to run by checkboxes in a certain column. Right now it just searches the entire sheet for checkboxes and links them to the desired column.</p>\n\n<pre><code>Sub LinkChecks()\n'Update 20150310\ni = 2\nFor Each cb In ActiveSheet.CheckBoxes\ncb.LinkedCell = Cells(i, \"I\").Address\ni = i + 1\nNext cb\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1498669511, "post_id": 44808621, "comment_id": 76597433, "body": "You can&#39;t do columns, that way, disconnected, you can however change all the <code>Columns</code> To <code>Range</code> and it will work.  BTW, did you try my code from the last question?  It should work with the text."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1498669649, "post_id": 44808621, "comment_id": 76597504, "body": "Does <code>score = Range(&quot;KPI!A6&quot;).Value</code> really work?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1498669701, "post_id": 44808621, "comment_id": 76597537, "body": "@CallumDA unfortunately it does."}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1498669848, "post_id": 44808621, "comment_id": 76597640, "body": "@ScottCraner wow... seems like a recipe for disaster to me."}, {"owner": {"reputation": 45, "user_id": 8222808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e434456796e78784b63d490aff810639?s=128&d=identicon&r=PG&f=1", "display_name": "bjefko", "link": "https://stackoverflow.com/users/8222808/bjefko"}, "edited": false, "score": 0, "creation_date": 1498672543, "post_id": 44808621, "comment_id": 76599233, "body": "Thank you very much!  The Range instead of columns worked out.  I didn&#39;t try it initially because I thought that it wouldn&#39;t work with text, so I just fixed what I had.  Just curious, what problems might I run into if I keep the score = Range(&quot;KPI!A6&quot;).Value ?"}], "owner": {"reputation": 45, "user_id": 8222808, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e434456796e78784b63d490aff810639?s=128&d=identicon&r=PG&f=1", "display_name": "bjefko", "link": "https://stackoverflow.com/users/8222808/bjefko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498669307, "creation_date": 1498669307, "question_id": 44808621, "link": "https://stackoverflow.com/questions/44808621/run-time-error-13-type-mismatch-on-case-sub", "title": "Run-time error 13: Type mismatch on case sub", "body": "<p>I'm having an issue running some relatively basic \"Case\" code.  I keep getting a \"Run-time error '13': Type mismatch\" when the correct case is selected and the action is being executed.  In this case I have my score value as cell A6, which is stored as text.  The data is coming through via another reporting tool we use so I'm not able to modify the format of the cell value.  It will have to stay as text.  The current value is \"May\" so the code is running through the different cases and selecting the case \"May\" correctly, but will not execute the action for that case.  Any ideas on how to correct this run-time error?  I've tried all sorts of different data types for the declaration, but nothing seems to be working.  Thanks!</p>\n\n<pre><code>Dim score As Variant\nscore = Range(\"KPI!A6\").Value\nSelect Case score\nCase \"January\"\n    Columns(\"D:N\").EntireColumn.Hidden = True\nCase score = \"February\"\n    Columns(\"C:C,E:N\").EntireColumn.Hidden = True\nCase \"March\"\n    Columns(\"C:D,F:N\").EntireColumn.Hidden = True\nCase \"April\"\n    Columns(\"C:E,G:N\").EntireColumn.Hidden = True\nCase \"May\"\n    Columns(\"C:F,H:N\").EntireColumn.Hidden = True\nCase \"June\"\n    Columns(\"C:G,I:N\").EntireColumn.Hidden = True\nCase \"July\"\n    Columns(\"C:H,J:N\").EntireColumn.Hidden = True\nCase \"August\"\n    Columns(\"C:I,K:N\").EntireColumn.Hidden = True\nCase \"September\"\n    Columns(\"C:J,L:N\").EntireColumn.Hidden = True\nCase \"October\"\n    Columns(\"C:K,M:N\").EntireColumn.Hidden = True\nCase \"November\"\n    Columns(\"C:L,N:N\").EntireColumn.Hidden = True\nCase \"December\"\n    Columns(\"C:M\").EntireColumn.Hidden = True\nEnd Select\n</code></pre>\n"}, {"tags": ["excel", "directory", "vba"], "owner": {"reputation": 11, "user_id": 8041594, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8Zz_xfzBoJU/AAAAAAAAAAI/AAAAAAAAB4M/zOdfJRKrXVg/photo.jpg?sz=128", "display_name": "In&#233;s G&#243;mez Benavent", "link": "https://stackoverflow.com/users/8041594/in%c3%a9s-g%c3%b3mez-benavent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 432, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498721027, "creation_date": 1498668947, "last_edit_date": 1531164843, "question_id": 44808518, "link": "https://stackoverflow.com/questions/44808518/macro-dir-list-folders-and-dir-list-subfolders-error", "title": "Macro DIR () List folders and dir () list Subfolders error", "body": "<p>I have made a macro that lists folders of a route and then with the data of list 1, I get a list of 2 folders. But it looks when listing the 2 path is saved in the data of the 1, I do not know how to make each one have its list.</p>\n\n<pre><code>'mySourcePath Is the main route of the 1 list\n Sub ListMyFiles(mySourcePath)\n' List the files and directories within \"C:\\\".\nmySourcePath = mySourcePath &amp; \"\\\"\nDim fList As String \nDim fLists As String\nDim fName As String\nDim fNames As String\nDim numero As String\nnumero = 0\niRow = 2\nFor inicios = 0 To Total\nfName = Dir(mySourcePath, vbDirectory)\n'The variable fName now contains the name of the first file or directory within \"C:\\\".\nIf InStr(fNames, \".\") &gt; 0 Then\n    numero = Left(fNames, InStr(fNames, \".\") - 1)\n    ElseIf InStr(fNames, \"..\") &gt; 0 Then\n    numero = Left(fNames, InStr(fNames, \"..\") - 1)\nEnd If\nIf numero = \"\" Then\ninicios = 0\nEnd If\nDo While fName &lt;&gt; \"\"\n'Store the current file or directory name in the string fList.\nfList = fList &amp; vbNewLine &amp; fName\ndatos = Range(\"A\" &amp; iRow).Value\naux = 0\nMsgBox \"Ruta 1.1: \" &amp; fList\nMsgBox \"Datos: \" &amp; datos\nIf datos &lt;&gt; fName Then\nfName = Dir()\nElseIf datos = fName Then\n   'The 2 path modifies to list other folders\n    rutas = mySourcePath &amp; fName &amp; \"\\ASUNTOS\\\"\nfNames = Dir(rutas, vbDirectory)\nDo While fNames &lt;&gt; \"\"\n'fLists = fLists &amp; vbNewLine &amp; fNames\n' Get the next file or directory within \"C:\\\".\nIf InStr(fNames, \".\") &gt; 0 Then\n    numero = Left(fNames, InStr(fNames, \".\") - 1)\n    ElseIf InStr(fNames, \"-\") &gt; 0 Then\n    numero = Left(fNames, InStr(fNames, \"-\") - 1)\n    ElseIf InStr(fNames, \"_\") &gt; 0 Then\n    numero = Left(fNames, InStr(fNames, \"_\") - 1)\nEnd If\nIf numero = \"\" Then\nfNames = Dir()\nEnd If\nIf numero &lt;&gt; \"\" Then\niRows = 2\nFor inicio = 0 To Total\ndato = Range(\"B\" &amp; iRows).Value\nIf dato = numero Then\nRange(\"F\" &amp; iRows).Value = numero\nruta = fNames + numero\nActiveSheet.Hyperlinks.Add Anchor:=Cells(iRows, \"E\"), Address:=ruta, TextToDisplay:=numero\nEnd If\nIf dato &lt;&gt; numero Then\nEnd If\nIf dato = \"\" Then\nEnd If\niRows = iRows + 1\nNext inicio\nfNames = Dir()\nEnd If\nLoop\niRow = iRow + 1\nEnd If\nLoop\nfName = fName\nfName = Dir()\niRow = iRow + 1 \nNext inicios\nEnd Sub\n</code></pre>\n\n<p>Total is how much data is in column E, I run it with a For to buy the data, if it is the same as the name of the folder.\nI look in sub folders if there is a name of column H, that is called the same and if so I make the hyperlink.\nExample:</p>\n\n<p>Column E:500, 752 , 800, 450, 1052</p>\n\n<p>Column H: Alfredo,  Maria , Ana,  Ethan, Alvaro            </p>\n\n<p>Routes:\n C: \\ Users \\ User \\ Documents \\ 500 \n  C: \\ Users \\ User \\ Documents \\ 800\n  C: \\ Users \\ User \\ Documents \\ 450\n  C: \\ Users \\ user \\ Documents \\ 500 \\ ASUNTOS \\ Maria\n  C: \\ Users \\ user \\ Documents \\ 500 \\ ASUNTOS \\ Alvaro\n  C: \\ Users \\ User \\ Documents \\ 800 \\ ASUNTOS \\ Ana</p>\n\n<p>In fList I get:\n  .\n  ..\n  500\n  500</p>\n\n<p>I would have to leave: \n  .\n  ..\n  500\n  752</p>\n"}, {"tags": ["java", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7604875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6AOG.png?s=128&g=1", "display_name": "Vin&#237;cius Santos", "link": "https://stackoverflow.com/users/7604875/vin%c3%adcius-santos"}, "edited": false, "score": 0, "creation_date": 1498669107, "post_id": 44808499, "comment_id": 76597193, "body": "Where and how can i put this in cell?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 33, "user_id": 7604875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6AOG.png?s=128&g=1", "display_name": "Vin&#237;cius Santos", "link": "https://stackoverflow.com/users/7604875/vin%c3%adcius-santos"}, "edited": false, "score": 0, "creation_date": 1498669293, "post_id": 44808499, "comment_id": 76597296, "body": "@Vin&#237;ciusMartins it&#39;s a macro, it&#39;s meant to be <i>executed</i>, not &quot;put into a cell&quot;. Macros aren&#39;t <i>user-defined functions</i>. If you want to type <code>=SomeFunction(F5)</code> in <code>F6</code> then make it a <code>Function</code> instead of a <code>Sub</code>, and parameterize it with a <code>Range</code>. Read up on &quot;Excel UDF&quot; for more info."}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "reply_to_user": {"reputation": 33, "user_id": 7604875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6AOG.png?s=128&g=1", "display_name": "Vin&#237;cius Santos", "link": "https://stackoverflow.com/users/7604875/vin%c3%adcius-santos"}, "edited": false, "score": 0, "creation_date": 1498669863, "post_id": 44808499, "comment_id": 76597651, "body": "@Vin&#237;ciusMartins  See my <b>EDIT#1</b>"}, {"owner": {"reputation": 33, "user_id": 7604875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6AOG.png?s=128&g=1", "display_name": "Vin&#237;cius Santos", "link": "https://stackoverflow.com/users/7604875/vin%c3%adcius-santos"}, "edited": false, "score": 0, "creation_date": 1498670252, "post_id": 44808499, "comment_id": 76597877, "body": "It works when i put some text in cell, but in this case is a javaee system. and generate this excel when i click to generate on site. i need to recive ${mestre.origim.name()} need to change dinamic"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1498669835, "last_edit_date": 1498669835, "creation_date": 1498668883, "answer_id": 44808499, "question_id": 44808356, "link": "https://stackoverflow.com/questions/44808356/how-to-change-an-excel-cell-when-the-value-retrived-from-database-is-diferent/44808499#44808499", "title": "How to change an Excel cell when the value retrived from database is diferent?", "body": "<p>Your code works if packaged in a <strong>SUB()</strong>:</p>\n\n<pre><code>Sub vini()\n    Dim score As String, result As String\n\n    score = Range(\"F5\").Value\n\n    Select Case score\n       Case \"CONTAS_PAGAR\"\n          result = \"Contas a pagar\"\n       Case \"CONTAS_RECEBER\"\n          result = \"Contas a receber\"\n       Case \"MOVIMENTO_BANCARIO\"\n          result = \"Movimento banc\u00e1rio\"\n       Case \"MOVIMENTO_CAIXA\"\n          result = \"Movimento de caixa\"\n       Case Else\n          result = \"N\u00e3o encontrado\"\n    End Select\n    Range(\"F6\").Value = result\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/KVJ0L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KVJ0L.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>As a function:</p>\n\n<pre><code>Function vini(score As String) As String\n    Select Case score\n       Case \"CONTAS_PAGAR\"\n          result = \"Contas a pagar\"\n       Case \"CONTAS_RECEBER\"\n          result = \"Contas a receber\"\n       Case \"MOVIMENTO_BANCARIO\"\n          result = \"Movimento banc\u00e1rio\"\n       Case \"MOVIMENTO_CAIXA\"\n          result = \"Movimento de caixa\"\n       Case Else\n          result = \"N\u00e3o encontrado\"\n    End Select\n\n    vini = result\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/iMtz7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iMtz7.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 7604875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S6AOG.png?s=128&g=1", "display_name": "Vin&#237;cius Santos", "link": "https://stackoverflow.com/users/7604875/vin%c3%adcius-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 44808499, "answer_count": 1, "score": 0, "last_activity_date": 1498669835, "creation_date": 1498668389, "question_id": 44808356, "link": "https://stackoverflow.com/questions/44808356/how-to-change-an-excel-cell-when-the-value-retrived-from-database-is-diferent", "title": "How to change an Excel cell when the value retrived from database is diferent?", "body": "<p>The notation of cell is ${detalhes.origim.name()}, return a String in cell but the name of string is always \"TEST_TEST\" but i need to rename on this spreadsheet to something like \"Teste beautiful form\". this notation can return just 4 diferent names. Is there any way to use a switch case on excel? ty.</p>\n\n<p>I try module on vba but didnt work, how can i rename this?\nCode i try: </p>\n\n<pre><code>Dim score As String, result As String\nscore = Range(\"F5\").Value\n\nSelect Case score\n   Case \"CONTAS_PAGAR\"\n      result = \"Contas a pagar\"\n   Case \"CONTAS_RECEBER\"\n      result = \"Contas a receber\"\n   Case \"MOVIMENTO_BANCARIO\"\n      result = \"Movimento banc\u00e1rio\"\n   Case \"MOVIMENTO_CAIXA\"\n      result = \"Movimento de caixa\"\n   Case Else\n      result = \"N\u00e3o encontrado\"\nEnd Select\nRange(\"F6\").Value = result\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7696753, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6eaa15793ae29d031aed1b899c083214?s=128&d=identicon&r=PG&f=1", "display_name": "JKnight", "link": "https://stackoverflow.com/users/7696753/jknight"}, "edited": false, "score": 1, "creation_date": 1498674902, "post_id": 44808611, "comment_id": 76600603, "body": "Works perfect. I really appreciate your help!"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1498669275, "creation_date": 1498669275, "answer_id": 44808611, "question_id": 44808309, "link": "https://stackoverflow.com/questions/44808309/vba-import-first-worksheet-from-closed-workbook-to-active-workbook/44808611#44808611", "title": "VBA Import First Worksheet from Closed workbook to Active Workbook", "body": "<p>Try this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub copyFirstWS()\n    Dim wb As Workbook\n\n    Set wb = Workbooks.Open(\"C:\\Users\\ME\\Desktop\\Book1.xlsx\")\n\n    With ThisWorkbook\n        wb.Worksheets(1).Copy After:=.Worksheets(.Worksheets.Count)\n    End With\n\n    wb.Close savechanges:=False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7696753, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6eaa15793ae29d031aed1b899c083214?s=128&d=identicon&r=PG&f=1", "display_name": "JKnight", "link": "https://stackoverflow.com/users/7696753/jknight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 677, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498669275, "creation_date": 1498668242, "question_id": 44808309, "link": "https://stackoverflow.com/questions/44808309/vba-import-first-worksheet-from-closed-workbook-to-active-workbook", "title": "VBA Import First Worksheet from Closed workbook to Active Workbook", "body": "<p>I'm having trouble modifying this code to copy the first worksheet of a closed workbook and import it to the active workbook. It wants to copy all worksheets and it adds \"after:=WB.Sheets(WB.Sheets.Count)\" to a random cell in the sheet. \nAny help is greatly appreciated.</p>\n\n<pre><code>Dim WB As Workbook\nDim SourceWB As Workbook\nDim WS As Worksheet\nDim ASheet As Worksheet\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nSet WB = ActiveWorkbook\nSet ASheet = ActiveSheet\nSet SourceWB = Workbooks.Open(\"C:\\Users\\ME\\Desktop\\Book1.xlsx\") \n\nFor Each WS In SourceWB.Worksheets\n    WS.Copy after:=WB.Sheets(WB.Sheets.Count)\nNext WS\n\n    SourceWB.Close savechanges:=False\n    Set WS = Nothing\n    Set SourceWB = Nothing\n\nWB.Activate\nASheet.Select\n    Set ASheet = Nothing\n    Set WB = Nothing\n\nApplication.EnableEvents = True\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "edited": false, "score": 1, "creation_date": 1498669015, "post_id": 44808222, "comment_id": 76597137, "body": "This bit <code>row_number = row_number + 1</code> makes it look like you intended this to be a loop, but never made it one. Hence, it only runs once for one part number, then stops."}, {"owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "reply_to_user": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "edited": false, "score": 0, "creation_date": 1498670128, "post_id": 44808222, "comment_id": 76597815, "body": "That&#39;s awesome, thanks for seeing that! I just added &quot;Do&quot; above my Row_number and &quot;Loop Until Item_In_Review = &quot;&quot;&quot; after my End With statement, and that cleared it all up! Thanks again man!"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "is_accepted": true, "score": 0, "last_activity_date": 1498670339, "creation_date": 1498670339, "answer_id": 44808915, "question_id": 44808222, "link": "https://stackoverflow.com/questions/44808222/vba-userform-single-sheet-linked-inventory-entries/44808915#44808915", "title": "VBA Userform Single Sheet Linked Inventory Entries", "body": "<p>This is now how my code looks, for anyone wanting to know. I will update the links I have provided in a few, to help anyone that wants use my forms.</p>\n\n<pre><code>   Private Sub XREFCONFIRM1_Click()\n\n    Dim iRow1 As Long\n    Dim iRow2 As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"1STDRAFT\")\n    row_number = 4\n\n    iRow1 = ws.Cells.Find(What:=PART1.Text, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole).Row\n\n    iRow2 = ws.Cells.Find(What:=PART2.Text, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole).Row\n\n    Do  \n    row_number = row_number + 1\n\n        item_in_review = Sheets(\"1STDRAFT\").Range(\"A\" &amp; row_number).Value\n\n    With ws\n       If item_in_review = PART1.Text Then\n\n      .Cells(iRow1, 15).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 15).Value\n      .Cells(iRow1, 16).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 16).Value\n      .Cells(iRow1, 17).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 17).Value\n      .Cells(iRow1, 18).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 18).Value\n      .Cells(iRow1, 19).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 19).Value\n      .Cells(iRow1, 20).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 20).Value\n      .Cells(iRow1, 21).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 21).Value\n      .Cells(iRow1, 22).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 22).Value\n      .Cells(iRow1, 23).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 23).Value\n      .Cells(iRow1, 24).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 24).Value\n      .Cells(iRow1, 25).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 25).Value\n\n     'With ws\n            'If item_in_review = PART2.Text Then\n      .Cells(iRow2, 15).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 1).Value\n      .Cells(iRow2, 16).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 2).Value\n      .Cells(iRow2, 17).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 3).Value\n      .Cells(iRow2, 18).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 5).Value\n      .Cells(iRow2, 19).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 8).Value\n      .Cells(iRow2, 20).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 9).Value\n      .Cells(iRow2, 21).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 10).Value\n      .Cells(iRow2, 22).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 11).Value\n      .Cells(iRow2, 23).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 12).Value\n      .Cells(iRow2, 24).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 13).Value\n      .Cells(iRow2, 25).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 14).Value\n\n            End If\n        End With\n          Loop Until item_in_review = \"\"\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7512453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b5a8a807ec12c2b045fa0125bd7b1e3?s=128&d=identicon&r=PG&f=1", "display_name": "chrisleepotter", "link": "https://stackoverflow.com/users/7512453/chrisleepotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 44808915, "answer_count": 1, "score": 2, "last_activity_date": 1501525953, "creation_date": 1498667974, "last_edit_date": 1501525953, "question_id": 44808222, "link": "https://stackoverflow.com/questions/44808222/vba-userform-single-sheet-linked-inventory-entries", "title": "VBA Userform Single Sheet Linked Inventory Entries", "body": "<p>I have an excel sheet/userform that I am making for inventory purposes.</p>\n\n<p>The first function of my userform is to take data for a connector and a mate from my textboxes on the form, and put it on my sheet in the rows/cells I tell it to. That code works fine.</p>\n\n<p>The second function is to cross-reference the connector and the mate, so that when I either search or change the parts' data I have up-to-date information.\nI do this by storing the cell addresses in Row 1 upon connector and mate creation. Then when I hit \"confirm\" the addresses are copied to specified cells within their own rows with the \"=\" sign added, to create reference formulas.  </p>\n\n<p>One row in the sheet is for connectors with mate references after it, the next row is for Mates with connector references after it. Then I move on to the next rows and do it again.</p>\n\n<p>I can only do this with one pair of part numbers, and with no other part numbers after that. \nWhat am I doing wrong?</p>\n\n<p>Code: </p>\n\n<pre><code>    Private Sub XREFCONFIRM1_Click()\n\n    Dim iRow1 As Long\n    Dim iRow2 As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"1STDRAFT\")\n    row_number = 4\n\n    iRow1 = ws.Cells.Find(What:=PART1.Text, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole).Row\n\n    iRow2 = ws.Cells.Find(What:=PART2.Text, SearchOrder:=xlRows, _\n        SearchDirection:=xlPrevious, LookIn:=xlValues, LookAt:=xlWhole).Row\n\n        row_number = row_number + 1\n\n        item_in_review = Sheets(\"1STDRAFT\").Range(\"A\" &amp; row_number).Value\n\n    With ws\n       If item_in_review = PART1.Text Then\n\n      .Cells(iRow1, 15).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 15).Value\n      .Cells(iRow1, 16).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 16).Value\n      .Cells(iRow1, 17).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 17).Value\n      .Cells(iRow1, 18).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 18).Value\n      .Cells(iRow1, 19).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 19).Value\n      .Cells(iRow1, 20).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 20).Value\n      .Cells(iRow1, 21).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 21).Value\n      .Cells(iRow1, 22).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 22).Value\n      .Cells(iRow1, 23).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 23).Value\n      .Cells(iRow1, 24).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 24).Value\n      .Cells(iRow1, 25).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 25).Value\n\n     'With ws\n            'If item_in_review = PART2.Text Then\n      .Cells(iRow2, 15).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 1).Value\n      .Cells(iRow2, 16).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 2).Value\n      .Cells(iRow2, 17).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 3).Value\n      .Cells(iRow2, 18).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 5).Value\n      .Cells(iRow2, 19).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 8).Value\n      .Cells(iRow2, 20).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 9).Value\n      .Cells(iRow2, 21).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 10).Value\n      .Cells(iRow2, 22).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 11).Value\n      .Cells(iRow2, 23).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 12).Value\n      .Cells(iRow2, 24).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 13).Value\n      .Cells(iRow2, 25).Value = \"=\" &amp; Sheets(\"1STDRAFT\").Cells(1, 14).Value\n\n            End If\n        End With\n\n\n    End Sub\n</code></pre>\n\n<p>Drive Folder Link: <a href=\"https://drive.google.com/drive/folders/0Bz4rZ9ZqoU0tbkdaQjBBZVgyRTA?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/drive/folders/0Bz4rZ9ZqoU0tbkdaQjBBZVgyRTA?usp=sharing</a></p>\n\n<p>File Direct Link: <a href=\"https://drive.google.com/file/d/0Bz4rZ9ZqoU0tVmJKa0xlUXBNcGc/view?usp=sharing\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/0Bz4rZ9ZqoU0tVmJKa0xlUXBNcGc/view?usp=sharing</a></p>\n\n<p>Photo Link: <a href=\"https://docs.google.com/spreadsheets/d/1Tzi_2gaaXypBen2Ls7p21USat8uS_qhcRDwmGQLCcXE/edit?usp=sharing\" rel=\"nofollow noreferrer\">https://docs.google.com/spreadsheets/d/1Tzi_2gaaXypBen2Ls7p21USat8uS_qhcRDwmGQLCcXE/edit?usp=sharing</a></p>\n"}, {"tags": ["vba", "excel", "data-connections"], "comments": [{"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498672263, "post_id": 44807984, "comment_id": 76599069, "body": "<code>ActiveWorkbook.RefreshAll</code> ? or Workbook(&quot;&lt;&lt;Your Workbook Name&gt;&gt;&quot;).RefreshAll`"}, {"owner": {"reputation": 23, "user_id": 8171676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38144d3a100eff5e16b706f58aaa4ec2?s=128&d=identicon&r=PG&f=1", "display_name": "LostVBAGuy", "link": "https://stackoverflow.com/users/8171676/lostvbaguy"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498678579, "post_id": 44807984, "comment_id": 76602716, "body": "So I was trying to come up with a way to avoid that dialog box and tell Excel which files to get with minimal user input.  Basically, I have VBA look at the 8 folders and grab the most recent document from each.  I am doing this to try and cut down on human error because sometimes people pull incorrect documents."}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498682208, "post_id": 44807984, "comment_id": 76604808, "body": "Why not delete the old connection connections?"}, {"owner": {"reputation": 23, "user_id": 8171676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38144d3a100eff5e16b706f58aaa4ec2?s=128&d=identicon&r=PG&f=1", "display_name": "LostVBAGuy", "link": "https://stackoverflow.com/users/8171676/lostvbaguy"}, "reply_to_user": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498767745, "post_id": 44807984, "comment_id": 76649187, "body": "Apparently the most simple solutions escape me.  Go figure."}], "owner": {"reputation": 23, "user_id": 8171676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38144d3a100eff5e16b706f58aaa4ec2?s=128&d=identicon&r=PG&f=1", "display_name": "LostVBAGuy", "link": "https://stackoverflow.com/users/8171676/lostvbaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 531, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498680858, "creation_date": 1498667193, "question_id": 44807984, "link": "https://stackoverflow.com/questions/44807984/vba-refreshing-data-connection-by-selecting-a-new-text-file-without-adding-a-new", "title": "VBA Refreshing Data Connection by selecting a new text file without adding a new table", "body": "<p>So I've been trying to figure out how to do this but I am only able to get VBA to add new connections and not refresh the current one (without prompting the user).</p>\n\n<p>Basically, I have multiple things that need to be refreshed at once and it would be far easier if I could just run this macro and have it do all of the refreshes for me without me having to manually select the dozen or so text files.</p>\n\n<p>So far, the only version of this that I have been able to get to work is the following:</p>\n\n<pre><code>Set RefreshWorkbook = ThisWorkbook.Sheets(4).QueryTables _\n.Add(Connection:=strFilename, _\nDestination:=declinerefresh.Cells(1, 1))\n\nWith RefreshWorkbook\n    .TextFilePromptOnRefresh = False\n    .TextFileCommaDelimiter = True\n    .Refresh\nEnd With\n</code></pre>\n\n<p>Unfortunately, this means that every time I run this script, it creates new connections in the workbook. I am hoping to be able to run some sort of script that will basically refresh the workbook and open the new file without needing any user input (because every day I have to run a bunch of different reports and compile them for comparison, oh and I can't delete the old ones).</p>\n\n<p>Thanks for any advice!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 4747836, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-xOrR2DmZZOU/AAAAAAAAAAI/AAAAAAAABUs/GcM2FRIgH2c/photo.jpg?sz=128", "display_name": "Toast", "link": "https://stackoverflow.com/users/4747836/toast"}, "is_accepted": false, "score": 0, "last_activity_date": 1498667549, "creation_date": 1498667549, "answer_id": 44808101, "question_id": 44807955, "link": "https://stackoverflow.com/questions/44807955/calling-cellsi-j-into-formula-in-vba/44808101#44808101", "title": "Calling .Cells(i,j) into .formula in VBA", "body": "<p>When using .Formula, it expects a string, and it must be formatting the same way that you would enter it into the cell itself without VBA (including the \"=\" at the beginning). Try </p>\n\n<pre><code>Sheets(\"Stats\").Cells(j, i).Formula = _\n   \"=SUM(\" &amp; Sheets(\"Stats\").Cells(1, i).address &amp; _\n   \",\" &amp; Sheets(\"Stats\").Cells(1, i).address &amp; \", A3)\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1498669573, "creation_date": 1498669573, "answer_id": 44808700, "question_id": 44807955, "link": "https://stackoverflow.com/questions/44807955/calling-cellsi-j-into-formula-in-vba/44808700#44808700", "title": "Calling .Cells(i,j) into .formula in VBA", "body": "<p>You can use the <code>With</code> statement in your case can simplify a lot:</p>\n\n<pre><code>With Sheets(\"Stats\")    \n    .Cells(j, i).Formula = \"=Sum(\" &amp; .Cells(1, i).Address &amp; \",\" &amp; .Cells(1, i).Address &amp; \", A3)\"\nEnd With\n</code></pre>\n\n<p><strong>Note</strong>: whenever trying to debug if your formula is correct, use the <code>Debug.Print</code>.</p>\n\n<p>In your case, if you put <code>i = 2</code> , and below this code:</p>\n\n<pre><code>With Sheets(\"Stats\")\n    Debug.Print \"=Sum(\" &amp; .Cells(1, i).Address &amp; \",\" &amp; .Cells(1, i).Address &amp; \", A3)\"\n</code></pre>\n\n<p>You will the following formula in the immediate window:</p>\n\n<pre><code>=Sum($B$1,$B$1, A3)\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4610861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/90d4e6f3cbfb7029fd04ab22ec426b03?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lynch", "link": "https://stackoverflow.com/users/4610861/peter-lynch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498669573, "creation_date": 1498667118, "last_edit_date": 1531164843, "question_id": 44807955, "link": "https://stackoverflow.com/questions/44807955/calling-cellsi-j-into-formula-in-vba", "title": "Calling .Cells(i,j) into .formula in VBA", "body": "<p>Hi I want to call cells using the .cells(i,j) into a .formula</p>\n\n<p>My macro at the moment prints a value/formula into an array of cells.\nIt works fine for values but I'm having difficulty insert a formula that doesn't return an error.</p>\n\n<p>Here is the relevent line of code</p>\n\n<pre><code>Sheets(\"Stats\").Cells(j, i).Formula = SUM(Sheets(\"Stats\").Cells(1, i),Sheets(\"Stats\").Cells(1, i), A3)\n</code></pre>\n\n<p>This is an alternate line for simplicity basically I want to be able to use both the .cells call and the alphanumeric call in the same formula.</p>\n\n<p>Thanks very much</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498667092, "post_id": 44807841, "comment_id": 76595943, "body": "&quot;stuck&quot; as like an infinite loop? Or do you have an error?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498667306, "post_id": 44807841, "comment_id": 76596086, "body": "Your possible misuse of <code>On Error Resume Next</code> may be masking errors -- it looks like your entire <code>Else</code> block is within the <code>Resume Next</code> (assuming no error with the <code>Workbooks.Open</code> statement. Also, you may want to avoid relying on <code>ActiveWorkbook</code>, best to assign to another <code>Workbook</code> type object variable and work with that."}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498667650, "post_id": 44807841, "comment_id": 76596285, "body": "Yeah i left it on for about an hour and a half and it was still on the first document of the first folder/subfolder. No errors."}, {"owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1498667698, "post_id": 44807841, "comment_id": 76596319, "body": "@DavidZemens I&#39;m sorry, I don&#39;t have a lot of experience with VBA Excel so I&#39;m not sure what changes have to be made from your explanation"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 0, "last_activity_date": 1498678215, "last_edit_date": 1498678215, "creation_date": 1498669573, "answer_id": 44808701, "question_id": 44807841, "link": "https://stackoverflow.com/questions/44807841/how-to-search-excel-workbooks-in-folders-and-subfolders-for-a-specific-string-o/44808701#44808701", "title": "How to search excel workbooks in folders, and subfolders for a specific string of text in Excel VBA", "body": "<p>This should improve the error handler which was potentially causing problems as it was not properly scoped.</p>\n\n<p>I've changed both the <code>Find</code> and <code>FindNext</code> to use the <code>After</code> argument, without which you may get some unexpected results. Per <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/range-findnext-method-excel\" rel=\"nofollow noreferrer\">the documentation</a> (emphasis added):</p>\n\n<blockquote>\n  <p>After:= The cell after which you want to search. This corresponds to the position of the active cell when a search is done from the user interface. Be aware that After must be a single cell in the range. Remember that the search begins after this cell; the specified cell is not searched until the method wraps back around to this cell. <strong>If this argument is not specified, the search starts after the cell in the upper-left corner of the range.</strong></p>\n</blockquote>\n\n<p>Also I'm not sure why you were offseting by <code>a</code> in case of error, rather than just using the <code>LRow</code> computation. I've made that change also.</p>\n\n<p>Put a Breakpoint on the line below where I note <code>'##### BREAK here and step through code using F8</code>, then step through the code line-by-line using <kbd>F8</kbd> to confirm that this method is working correctly. Once you've confirmed, remove the breakpoint and you can allow the code to run to completion.</p>\n\n<pre><code>Public WS As Worksheet\nSub SearchWKBooksSubFolders(Optional Folderpath As Variant, Optional Str As Variant)\nDim myfolder As String\nDim a As Single\nDim sht As Worksheet\nDim Lrow As Single\nDim Folders() As String\nDim Folder As Variant\nReDim Folders(0)\nIf IsMissing(Folderpath) Then\n    Set WS = Sheets.Add\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Show\n        myfolder = .SelectedItems(1) &amp; \"\\\"\n    End With\n    Str = Application.InputBox(prompt:=\"Search string:\", Title:=\"Search all workbooks in a folder\", Type:=2)\n    If Str = \"\" Then Exit Sub\n    WS.Range(\"A1\") = \"Search string:\"\n    WS.Range(\"B1\") = Str\n    WS.Range(\"A2\") = \"Path:\"\n    WS.Range(\"B2\") = myfolder\n    WS.Range(\"A3\") = \"Folderpath\"\n    WS.Range(\"B3\") = \"Workbook\"\n    WS.Range(\"C3\") = \"Worksheet\"\n    WS.Range(\"D3\") = \"Cell Address\"\n    WS.Range(\"E3\") = \"Link\"\n    Folderpath = myfolder\n    Value = Dir(myfolder, &amp;H1F)\nElse\n    If Right(Folderpath, 2) = \"\\\\\" Then\n        Exit Sub\n    End If\n    Value = Dir(Folderpath, &amp;H1F)\nEnd If\nDo Until Value = \"\"\n    If Value = \".\" Or Value = \"..\" Then\n    Else\n        If GetAttr(Folderpath &amp; Value) = 16 Then\n            Folders(UBound(Folders)) = Value\n            ReDim Preserve Folders(UBound(Folders) + 1)\n        ElseIf (Right(Value, 3) = \"xls\" Or Right(Value, 4) = \"xlsx\" Or Right(Value, 4) = \"xlsm\") And Left(Value, 1) &lt;&gt; \"~\" Then Then\n            On Error Resume Next\n            Dim wb As Workbook\n            Set wb = Workbooks.Open(Filename:=Folderpath &amp; Value, Password:=\"zzzzzzzzzzzz\")\n            On Error GoTo 0\n            'If there is an error on Workbooks.Open, then wb Is Nothing:\n            If wb Is Nothing Then\n                Lrow = WS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n                WS.Range(\"A\" &amp; Lrow).Value = Value\n                WS.Range(\"B\" &amp; Lrow).Value = \"Password protected\"\n            Else\n                For Each sht In wb.Worksheets\n                    'Expand all groups in sheet\n                    sht.Outline.ShowLevels RowLevels:=8, ColumnLevels:=8\n                    Set c = sht.Cells.Find(Str, After:=sht.Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\n                    If Not c Is Nothing Then\n                        firstAddress = c.Address\n                        Do\n                            Lrow = WS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n                            WS.Range(\"A\" &amp; Lrow).Value = Folderpath\n                            WS.Range(\"B\" &amp; Lrow).Value = Value\n                            WS.Range(\"C\" &amp; Lrow).Value = sht.Name\n                            WS.Range(\"D\" &amp; Lrow).Value = c.Address\n                            WS.Hyperlinks.Add Anchor:=WS.Range(\"E\" &amp; Lrow), Address:=Folderpath &amp; Value, SubAddress:= _\n                            \"'\" &amp; sht.Name &amp; \"'\" &amp; \"!\" &amp; c.Address, TextToDisplay:=\"Link\"\n                            Set c = sht.Cells.FindNext(After:=c)\n\n                        Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\n                    End If\n                Next sht\n                wb.Close False\n            End If\n        End If\n    End If\n    Value = Dir\nLoop\nFor Each Folder In Folders\n    Call SearchWKBooksSubFolders(Folderpath &amp; Folder &amp; \"\\\", Str)\nNext Folder\nCells.EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n\n<p>This seems to be working as expected for me:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3MHDK.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3MHDK.png\" alt=\"enter image description here\"></a></p>\n\n<p>On the problem with subfolders, while you're calling this procedure recursively, you're <strong>not</strong> passing the <em>optional</em> <code>Str</code> argument to the recursive calls. So for the subfolders, the function is searching for empty <code>Variant</code> type, which it finds in many, many cells!</p>\n\n<p>Change:</p>\n\n<pre><code>SearchWKBooksSubFolders (Folderpath &amp; Folder &amp; \"\\\")\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>Call SearchWKBooksSubFolders(Folderpath &amp; Folder &amp; \"\\\", Str)\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8227264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a672d92c875921b21b9d8e862c7f0212?s=128&d=identicon&r=PG&f=1", "display_name": "mmajdalani", "link": "https://stackoverflow.com/users/8227264/mmajdalani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1302, "favorite_count": 1, "accepted_answer_id": 44808701, "answer_count": 1, "score": 0, "last_activity_date": 1498765149, "creation_date": 1498666766, "last_edit_date": 1498765149, "question_id": 44807841, "link": "https://stackoverflow.com/questions/44807841/how-to-search-excel-workbooks-in-folders-and-subfolders-for-a-specific-string-o", "title": "How to search excel workbooks in folders, and subfolders for a specific string of text in Excel VBA", "body": "<p>I currently have a huge folder that has many folders inside of many folders that contain Excel workbooks. I'd like to have a user input to ask for a string of numbers (Ex: 405599) and search through every folder, subfolder, workbook, sheet and provide a link or location of that file. This is code currently, But it seems to get stuck searching the very first row of the first document and then crashes. </p>\n\n<p><img src=\"https://i.stack.imgur.com/vvVo9.png\" alt=\"enter image description here\"></p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>   Public WS As Worksheet\r\nSub SearchWKBooksSubFolders(Optional Folderpath As Variant, Optional Str As Variant)\r\nDim myfolder As String\r\nDim a As Single\r\nDim sht As Worksheet\r\nDim Lrow As Single\r\nDim Folders() As String\r\nDim Folder As Variant\r\nReDim Folders(0)\r\nIf IsMissing(Folderpath) Then\r\nSet WS = Sheets.Add\r\nWith Application.FileDialog(msoFileDialogFolderPicker)\r\n    .Show\r\n    myfolder = .SelectedItems(1) &amp; \"\\\"\r\nEnd With\r\nStr = Application.InputBox(prompt:=\"Search string:\", Title:=\"Search all workbooks in a folder\", Type:=2)\r\nIf Str = \"\" Then Exit Sub\r\nWS.Range(\"A1\") = \"Search string:\"\r\nWS.Range(\"B1\") = Str\r\nWS.Range(\"A2\") = \"Path:\"\r\nWS.Range(\"B2\") = myfolder\r\nWS.Range(\"A3\") = \"Folderpath\"\r\nWS.Range(\"B3\") = \"Workbook\"\r\nWS.Range(\"C3\") = \"Worksheet\"\r\nWS.Range(\"D3\") = \"Cell Address\"\r\nWS.Range(\"E3\") = \"Link\"\r\nFolderpath = myfolder\r\nValue = Dir(myfolder, &amp;H1F)\r\nElse\r\nIf Right(Folderpath, 2) = \"\\\\\" Then\r\n    Exit Sub\r\nEnd If\r\nValue = Dir(Folderpath, &amp;H1F)\r\nEnd If\r\nDo Until Value = \"\"\r\nIf Value = \".\" Or Value = \"..\" Then\r\nElse\r\n    If GetAttr(Folderpath &amp; Value) = 16 Then\r\n        Folders(UBound(Folders)) = Value\r\n        ReDim Preserve Folders(UBound(Folders) + 1)\r\n    ElseIf (Right(Value, 3) = \"xls\" Or Right(Value, 4) = \"xlsx\" Or Right(Value, 4) = \"xlsm\") And Left(Value, 1) &lt;&gt; \"~\" Then\r\n        On Error Resume Next\r\n        Dim wb As Workbook\r\n        Set wb = Workbooks.Open(Filename:=Folderpath &amp; Value, Password:=\"zzzzzzzzzzzz\")\r\n        On Error GoTo 0\r\n        'If there is an error on Workbooks.Open, then wb Is Nothing:\r\n        If wb Is Nothing Then\r\n            Lrow = WS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\r\n            WS.Range(\"A\" &amp; Lrow).Value = Value\r\n            WS.Range(\"B\" &amp; Lrow).Value = \"Password protected\"\r\n        Else\r\n            For Each sht In wb.Worksheets\r\n                'Expand all groups in sheet\r\n                sht.Unprotect\r\n\r\n                sht.Outline.ShowLevels RowLevels:=8, ColumnLevels:=8\r\n                Set c = sht.Cells.Find(Str, After:=sht.Cells(1, 1), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext)\r\n                If Not c Is Nothing Then\r\n                    firstAddress = c.Address\r\n                    Do\r\n                        Lrow = WS.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\r\n                        WS.Range(\"A\" &amp; Lrow).Value = Folderpath\r\n                        WS.Range(\"B\" &amp; Lrow).Value = Value\r\n                        WS.Range(\"C\" &amp; Lrow).Value = sht.Name\r\n                        WS.Range(\"D\" &amp; Lrow).Value = c.Address\r\n                        WS.Hyperlinks.Add Anchor:=WS.Range(\"E\" &amp; Lrow), Address:=Folderpath &amp; Value, SubAddress:= _\r\n                        \"'\" &amp; sht.Name &amp; \"'\" &amp; \"!\" &amp; c.Address, TextToDisplay:=\"Link\"\r\n                        Set c = sht.Cells.FindNext(After:=c)\r\n\r\n                    Loop While Not c Is Nothing And c.Address &lt;&gt; firstAddress\r\n                End If\r\n            Next sht\r\n            wb.Close False\r\n        End If\r\n    End If\r\nEnd If\r\nValue = Dir\r\nLoop\r\nFor Each Folder In Folders\r\nCall SearchWKBooksSubFolders(Folderpath &amp; Folder &amp; \"\\\", Str)\r\nNext Folder\r\nCells.EntireColumn.AutoFit\r\nEnd Sub</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["vba", "excel", "tabs", "advanced-filter"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1498707751, "post_id": 44807755, "comment_id": 76612111, "body": "Can you show a resulting tab as well? (one expected result)"}, {"owner": {"reputation": 33, "user_id": 8227084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1b41dd5052f0a6d1f2f4f2b92a38a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aimaria", "link": "https://stackoverflow.com/users/8227084/aimaria"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1498759363, "post_id": 44807755, "comment_id": 76644628, "body": "I just updated the post with the &quot;Resulting tab&quot; picture and here is the link as well: <a href=\"https://i.stack.imgur.com/xY4uZ.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/xY4uZ.png</a>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1498779880, "post_id": 44807755, "comment_id": 76653737, "body": "ok, I&#39;ll update your question to include both images - we prefer all images included in the question because some users don&#39;t have access to other sites"}, {"owner": {"reputation": 33, "user_id": 8227084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1b41dd5052f0a6d1f2f4f2b92a38a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aimaria", "link": "https://stackoverflow.com/users/8227084/aimaria"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1498834098, "post_id": 44807755, "comment_id": 76679063, "body": "That makes total sense - thank you so much Paul! :)"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8227084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1b41dd5052f0a6d1f2f4f2b92a38a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aimaria", "link": "https://stackoverflow.com/users/8227084/aimaria"}, "edited": false, "score": 1, "creation_date": 1498834577, "post_id": 44838204, "comment_id": 76679382, "body": "I could kiss you right now! This is exactly what I was looking for!"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 33, "user_id": 8227084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1b41dd5052f0a6d1f2f4f2b92a38a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aimaria", "link": "https://stackoverflow.com/users/8227084/aimaria"}, "edited": false, "score": 0, "creation_date": 1498872805, "post_id": 44838204, "comment_id": 76693823, "body": "@Aimaria Glad it worked as per your requirement. And thanks for your sweet kiss. :)"}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1498793871, "creation_date": 1498793871, "answer_id": 44838204, "question_id": 44807755, "link": "https://stackoverflow.com/questions/44807755/vba-advanced-autofilter-create-new-sheets-based-on-range/44838204#44838204", "title": "VBA Advanced AutoFilter + Create new sheets based on range", "body": "<p>For what you have shown in the images, you may try something like this to achieve that...</p>\n\n<pre><code>Sub InsertSheets()\nDim sws As Worksheet, ws As Worksheet\nDim slr As Long, i As Long\nDim Rng As Range, Cell As Range\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nSet sws = Sheets(\"Sheet1\")\nIf sws.Range(\"A12\").Value = \"\" Then\n    MsgBox \"No Interval Numbers found on the sheet.\", vbExclamation\n    Exit Sub\nEnd If\nslr = sws.Range(\"A11\").End(xlDown).Row\nSet Rng = sws.Range(\"A12:A\" &amp; slr)\nFor Each Cell In Rng\n    On Error Resume Next\n    Sheets(Cell.Value).Delete\n    On Error GoTo 0\n    sws.Copy after:=Sheets(Sheets.Count)\n    Set ws = ActiveSheet\n    ws.Name = Cell.Value\n    ws.DrawingObjects.Delete\n    With ws\n        For i = slr To 12 Step -1\n            If i &lt;&gt; Cell.Row Then ws.Rows(i).Delete\n        Next i\n    End With\n    Set ws = Nothing\nNext Cell\nsws.Activate\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8227084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1b41dd5052f0a6d1f2f4f2b92a38a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aimaria", "link": "https://stackoverflow.com/users/8227084/aimaria"}, "edited": false, "score": 1, "creation_date": 1498834633, "post_id": 44838552, "comment_id": 76679432, "body": "Same to you Paul! This is awesome! I still only know enough about VBA to be dangerous and there is no way I could have done this on my own. Thank you, thank you, so much. It works perfectly."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 33, "user_id": 8227084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1b41dd5052f0a6d1f2f4f2b92a38a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aimaria", "link": "https://stackoverflow.com/users/8227084/aimaria"}, "edited": false, "score": 0, "creation_date": 1498836794, "post_id": 44838552, "comment_id": 76680784, "body": "I&#39;m glad it helped! please click on the check mark on the top-left of the answer to mark it as accepted, if it works"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1509600656, "last_edit_date": 1509600656, "creation_date": 1498796431, "answer_id": 44838552, "question_id": 44807755, "link": "https://stackoverflow.com/questions/44807755/vba-advanced-autofilter-create-new-sheets-based-on-range/44838552#44838552", "title": "VBA Advanced AutoFilter + Create new sheets based on range", "body": "<p>Another option (tested)</p>\n\n<p>All functions bellow, in a separate module<br>\nIt copies the main sheet, deletes the button and uses auto filter to remove unneeded rows</p>\n\n<hr>\n\n<blockquote>\n  <p>This uses dictionaries and <strong>late binding is slow</strong>: <strike>CreateObject(\"Scripting.Dictionary\")</strike></p>\n  \n  <p><strong>Early binding is fast</strong>: VBA Editor -> <strong>Tools</strong> -> <strong>References</strong> -> Add <strong>Microsoft Scripting Runtime</strong></p>\n</blockquote>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Const X As String = vbNullString\nPublic Sub CreateTabs()\n    Const FIRST_CELL    As String = \"Interval Number\"\n    Const LAST_CELL     As String = \"Vesting Doc Number (LC/RS)\"\n    Dim wb As Workbook, ws As Worksheet, wsNew As Worksheet, d As Dictionary, i As Long\n    Dim fr As Long, lr As Long, fc As Long, found As Range, rng As Range, val As String\n\n    SetDisplay False\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Offshore Searches\")\n    Set found = FindCell(ws.UsedRange, FIRST_CELL)\n    If Not found Is Nothing Then\n        fr = found.Row + 1\n        fc = found.Column\n    End If\n    Set found = FindCell(ws.UsedRange, LAST_CELL)\n    If Not found Is Nothing Then lr = found.Row - 1\n\n    If fr &gt; 0 And fc &gt; 0 And lr &gt;= fr Then\n        If Not ws.AutoFilter Is Nothing Then ws.UsedRange.AutoFilter\n        Set rng = ws.Range(ws.Cells(fr, fc), ws.Cells(lr, fc))\n        Dim arr As Variant, r As Long\n        arr = rng\n        Set d = New Dictionary\n        For r = 1 To UBound(arr)\n            val = Trim(CStr(arr(r, 1)))\n            val = CleanWsName(val)\n            If Not d.Exists(val) Then d.Add r, val\n        Next\n        For i = 1 To d.Count\n          If Not WsExists(d(i)) Then\n            ws.Copy After:=wb.Worksheets(wb.Worksheets.Count)\n            Set wsNew = wb.Worksheets(wb.Worksheets.Count)\n            With wsNew\n             .Name = d(i): If .Shapes.Count = 1 Then wsNew.Shapes.Item(1).Delete\n             Set rng = .Range(.Cells(fr - 1, fc), .Cells(lr, fc))\n         rng.AutoFilter Field:=1, Criteria1:=\"&lt;&gt;\" &amp; d(i), Operator:=xlAnd, Criteria2:=\"&lt;&gt;\"\n             Set rng = rng.Offset(1).Resize(rng.Rows.Count - 1)\n             rng.SpecialCells(xlCellTypeVisible).EntireRow.Delete Shift:=xlUp\n             rng.AutoFilter\n            End With\n          End If\n        Next\n    End If\n    ws.Activate\n    SetDisplay True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub SetDisplay(Optional ByVal status As Boolean = False)\n    Application.ScreenUpdating = status\n    Application.DisplayAlerts = status\nEnd Sub\n\nPublic Function FindCell(ByRef rng As Range, ByVal celVal As String) As Range\n    Dim found As Range\n    If Not rng Is Nothing Then\n        If Len(celVal) &gt; 0 Then\n            Set found = rng.Find(celVal, MatchCase:=True)\n            If Not found Is Nothing Then Set FindCell = found\n        End If\n    End If\nEnd Function\n\nPublic Function CleanWsName(ByVal wsName As String) As String\n    Const x = vbNullString\n    wsName = Trim$(wsName)    'Trim, then remove [ ] / \\ &lt; &gt; : * ? | \"\n    wsName = Replace(Replace(Replace(wsName, \"[\", x), \"]\", x), \" \", x)\n    wsName = Replace(Replace(Replace(wsName, \"/\", x), \"\\\", x), \":\", x)\n    wsName = Replace(Replace(Replace(wsName, \"&lt;\", x), \"&gt;\", x), \"*\", x)\n    wsName = Replace(Replace(Replace(wsName, \"?\", x), \"|\", x), Chr(34), x)\n    If Len(wsName) = 0 Then wsName = \"DT \" &amp; Format(Now, \"yyyy-mm-dd hh.mm.ss\")\n    CleanWsName = Left$(wsName, 31)         'Resize to max len of 31\nEnd Function\n\nPublic Function WsExists(ByVal wsName As String) As Boolean\n    Dim ws As Worksheet\n    With ThisWorkbook\n        For Each ws In .Worksheets\n            If ws.Name = wsName Then\n                WsExists = True\n                Exit Function\n            End If\n        Next\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Assumptions</p>\n\n<ul>\n<li>Interval Numbers format is consistent: Unit &amp; \" - \" &amp; Week (=B12 &amp; \" - \" &amp; C12)</li>\n<li>Interval Numbers are not longer than 31 character, and don't contain these special chars: [ ] / \\ ? * .\n\n<ul>\n<li>If so, the sheet names will be shortened to 31 chars</li>\n<li>and all special chars mentioned removed (Excel limitation for Sheet names)</li>\n</ul></li>\n<li>Working row starts after cell \"Interval Number\" and stop before \"Vesting Doc Number (LC/RS)\"</li>\n<li>There are no spaces before or after \"Interval Number\" and \"Vesting Doc Number (LC/RS)\"</li>\n<li>Main tab name is exactly \"Offshore Searches\", and it contains only one button (\"Create Tabs\")</li>\n</ul>\n"}], "owner": {"reputation": 33, "user_id": 8227084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1b41dd5052f0a6d1f2f4f2b92a38a8?s=128&d=identicon&r=PG&f=1", "display_name": "Aimaria", "link": "https://stackoverflow.com/users/8227084/aimaria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1154, "favorite_count": 0, "accepted_answer_id": 44838552, "answer_count": 2, "score": 3, "last_activity_date": 1509600656, "creation_date": 1498666481, "last_edit_date": 1498780352, "question_id": 44807755, "link": "https://stackoverflow.com/questions/44807755/vba-advanced-autofilter-create-new-sheets-based-on-range", "title": "VBA Advanced AutoFilter + Create new sheets based on range", "body": "<p>I need to create new tabs in a workbook based upon a range of cells in a worksheet template. I also want to delete rows of data that do not match the tab name. For example, from the table below I would have a new tab named \"2206 - 6\" and only data associated with that would remain, keeping in mind that this range of data will change each time the macro is used.</p>\n\n<p><strong>Before</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q9Zr0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q9Zr0.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>After</strong>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/IJwue.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IJwue.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Interval Number\n2206 - 6\n6304 - 5\n4102 - 20</p>\n\n<p>The table begins in row 11, but I need to retain all of the information above. I have an Advanced Filter Macro that gets close to what I want, but its doing two things I don't want: creating empty tabs and not retaining information above row 11. </p>\n\n<pre><code>Sub parse_data()\n    Dim lr As Long\n    Dim ws As Worksheet\n    Dim vcol, i As Integer\n    Dim icol As Long\n    Dim myarr As Variant\n    Dim title As String\n    Dim titlerow As Integer\n\n    vcol = 1\n    Set ws = Sheets(\"Offshore Searches\")\n    lr = ws.Cells(ws.Rows.Count, vcol).End(xlUp).Row\n    title = \"A11:G20\"\n    titlerow = ws.Range(title).Cells(1).Row\n    icol = ws.Columns.Count\n    ws.Cells(1, icol) = \"Unique\"\n\n    For i = 2 To lr\n        On Error Resume Next\n        If ws.Cells(i, vcol) &lt;&gt; \"\" And _\n          Application.WorksheetFunction.Match(ws.Cells(i, vcol), ws.Columns(icol), 0) = 0 Then\n            ws.Cells(ws.Rows.Count, icol).End(xlUp).Offset(1) = ws.Cells(i, vcol)\n        End If\n    Next\n\n    myarr = Application.WorksheetFunction.Transpose(ws.Columns(icol).SpecialCells(xlCellTypeConstants))\n    ws.Columns(icol).Clear\n\n    For i = 2 To UBound(myarr)\n        ws.Range(title).AutoFilter field:=vcol, Criteria1:=myarr(i) &amp; \"\"\n        If Not Evaluate(\"=ISREF('\" &amp; myarr(i) &amp; \"'!A1)\") Then\n            Sheets.Add(after:=Worksheets(Worksheets.Count)).Name = myarr(i) &amp; \"\"\n        Else\n            Sheets(myarr(i) &amp; \"\").Move after:=Worksheets(Worksheets.Count)\n        End If\n        ws.Range(\"A\" &amp; titlerow &amp; \":A\" &amp; lr).EntireRow.Copy Sheets(myarr(i) &amp; \"\").Range(\"A1\")\n        Sheets(myarr(i) &amp; \"\").Columns.AutoFit\n    Next\n    ws.AutoFilterMode = False\n    ws.Activate\nEnd Sub\n</code></pre>\n\n<p>I also have a macro which creates tabs based on a range without the advanced filter, so each tab looks identical (just the tab name changes)</p>\n\n<pre><code>Sub CreateWorkSheetByRange()\n    Dim WorkRng As Range\n    Dim ws As Worksheet\n    Dim arr As Variant\n\n    On Error Resume Next\n\n    Set WorkRng = Application.Selection\n    Set WorkRng = Application.InputBox(\"Range\", xTitleId, WorkRng.Address, Type:=8)\n    arr = WorkRng.Value\n    Sheets(\"Offshore Searches\").Select\n        Cells.Select\n        Selection.Copy\n    Application.ScreenUpdating = False\n\n    For i = 1 To UBound(arr, 1)\n        For j = 1 To UBound(arr, 2)\n            Set ws = Worksheets.Add(after:=Application.ActiveSheet)\n            ws.Name = arr(i, j)\n            ActiveSheet.Paste\n            Range(\"A1\").Select\n        Next\n    Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Is there a way to both create tabs based on a range while simultaneously using an advanced filter?</p>\n"}, {"tags": ["vba", "email", "outlook", "clipboard"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4810091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a267f906ea50b9645bf6d73ec4f6341?s=128&d=identicon&r=PG&f=1", "display_name": "Bob ", "link": "https://stackoverflow.com/users/4810091/bob"}, "edited": false, "score": 0, "creation_date": 1498737392, "post_id": 44808445, "comment_id": 76628727, "body": "because it&#39;s not always to a new mail-message, but sometimes to other appointments, OneNote, etc."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 13, "user_id": 4810091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a267f906ea50b9645bf6d73ec4f6341?s=128&d=identicon&r=PG&f=1", "display_name": "Bob ", "link": "https://stackoverflow.com/users/4810091/bob"}, "edited": false, "score": 0, "creation_date": 1498742597, "post_id": 44808445, "comment_id": 76632974, "body": "Appointments allow to add embedded message attachments in exactly same way -  AppointmentItem.Attachments.Add(YourMailItem)."}, {"owner": {"reputation": 13, "user_id": 4810091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a267f906ea50b9645bf6d73ec4f6341?s=128&d=identicon&r=PG&f=1", "display_name": "Bob ", "link": "https://stackoverflow.com/users/4810091/bob"}, "edited": false, "score": 0, "creation_date": 1498744670, "post_id": 44808445, "comment_id": 76634657, "body": "the Point is that I&#39;d like the flexibility to create one button and then have the message on the clipboard. afterwards i could then decide whether I&#39;d like it in an appointment, in a document, in a PowerPoint slide or wherever. also: i don&#39;t want to start off with a completely new email or appointment, but also have the possibility to paste multiple open Messages into one. therefore the clipboard functionality would fit perfectly."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 13, "user_id": 4810091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a267f906ea50b9645bf6d73ec4f6341?s=128&d=identicon&r=PG&f=1", "display_name": "Bob ", "link": "https://stackoverflow.com/users/4810091/bob"}, "edited": false, "score": 0, "creation_date": 1498750504, "post_id": 44808445, "comment_id": 76639331, "body": "You can do that, but the users don&#39;t generally appreciate when their clipboard is wiped out/replaced. To use the clipboard, you would need to hack the private clipboard format used by Outlook when an item is copied to the clipboard."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 13, "user_id": 4810091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a267f906ea50b9645bf6d73ec4f6341?s=128&d=identicon&r=PG&f=1", "display_name": "Bob ", "link": "https://stackoverflow.com/users/4810091/bob"}, "edited": false, "score": 0, "creation_date": 1498750540, "post_id": 44808445, "comment_id": 76639356, "body": "For the clipboard format, see <a href=\"https://github.com/yasoonOfficial/outlook-dndprotocol\" rel=\"nofollow noreferrer\">github.com/yasoonOfficial/outlook-dndprotocol</a>"}, {"owner": {"reputation": 13, "user_id": 4810091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a267f906ea50b9645bf6d73ec4f6341?s=128&d=identicon&r=PG&f=1", "display_name": "Bob ", "link": "https://stackoverflow.com/users/4810091/bob"}, "edited": false, "score": 0, "creation_date": 1498753312, "post_id": 44808445, "comment_id": 76641220, "body": "i wouldn&#39;t mind all too much about that since I&#39;d conciously press the button to save it to the clipboard (I&#39;d almost use ctrl-c shortcut for it if it wouldn&#39;t have interfered with the other functionality of this oh-so-wonderful shortcut :-)  in any case thanks for the hint, will have a look whether i manage to solve my Problem using it!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1498668685, "creation_date": 1498668685, "answer_id": 44808445, "question_id": 44807575, "link": "https://stackoverflow.com/questions/44807575/copy-email-object-to-outlook-clipboard/44808445#44808445", "title": "copy email object to outlook clipboard", "body": "<p>Why would you want to copy anything to the clipboard? You can attach any message to another message by calling <code>MailItem.Attachments.Add</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 4810091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a267f906ea50b9645bf6d73ec4f6341?s=128&d=identicon&r=PG&f=1", "display_name": "Bob ", "link": "https://stackoverflow.com/users/4810091/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 787, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498668685, "creation_date": 1498665892, "question_id": 44807575, "link": "https://stackoverflow.com/questions/44807575/copy-email-object-to-outlook-clipboard", "title": "copy email object to outlook clipboard", "body": "<p>when having email Messages open in Outlook 2013 (in reading mode) that I'd like to Forward to somebody else as an embedded attachment, i always have to find the original mail again before being able to attach it in a new or existing message or appointment or ... </p>\n\n<p>Much like the 'Forward as attachment'-button under 'home > message > respond > more > Forward as attachment' I'd like to copy the current mail to the clipboard. This way i can add the object to any new Messages/appointments/etc. </p>\n\n<p>Other Forum entries only copy the Body of the mail e.g.:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/3949918/copy-email-to-the-clipboard-with-outlook-vba\">Copy email to the clipboard with Outlook VBA</a></li>\n<li><a href=\"https://www.experts-exchange.com/questions/24515660/outlook-script-to-copy-email-to-clipboard.html\" rel=\"nofollow noreferrer\">https://www.experts-exchange.com/questions/24515660/outlook-script-to-copy-email-to-clipboard.html</a></li>\n</ul>\n\n<p>I'd like to have the complete object in though. </p>\n\n<p>is there anybody that can help me finding the correct Expression for that? \ni figured if i Change the \"M.HTMLBody\" in the below code to something like object I'd be golden.</p>\n\n<pre><code>Sub Test()\n    Dim M As MailItem, Buf As MSForms.DataObject\n\n    Set M = ActiveExplorer().Selection.item(1)\n    Set Buf = New MSForms.DataObject\n    Buf.SetText M.HTMLBody\n    Buf.PutInClipboard\n\nEnd Sub\n</code></pre>\n\n<p>many thanks in advance!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498667773, "post_id": 44807464, "comment_id": 76596372, "body": "You declare <code>MyFile</code> and assign <code>UserFile</code>, for starters."}], "answers": [{"comments": [{"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 1, "creation_date": 1498666268, "post_id": 44807614, "comment_id": 76595438, "body": "That would refer to the file itself. I think you mean <code>Userfile.Name</code> or <code>Userfile.Fullname</code> :)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1498667719, "post_id": 44807614, "comment_id": 76596338, "body": "@BrandonBarney <code>UserFile</code> is just a[n undeclared] [variant/]string. <code>UserFile = Application.GetOpenFilename</code>"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1498667945, "post_id": 44807614, "comment_id": 76596482, "body": "@BrandonBarney  Thanks for pointing it out to me.  I&#39;ve edited my post accordingly."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498669680, "post_id": 44807614, "comment_id": 76597523, "body": "@Mat&#39;sMug My bad. I completely skipped over reading the code and just assumed I knew what the variable meant. Please ignore my comment :p. I must not have been paying attention!"}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 2, "last_activity_date": 1498668455, "last_edit_date": 1498668455, "creation_date": 1498666030, "answer_id": 44807614, "question_id": 44807464, "link": "https://stackoverflow.com/questions/44807464/how-to-reference-a-user-defined-workbook-and-worksheet-excel-vba/44807614#44807614", "title": "How to reference a user defined workbook and worksheet excel VBA", "body": "<p>You'll need to split the path and filename so that it can be placed within the formula in the appropriate spots.  Also, you can avoid using the Select method, since it's not really needed and very inefficient.  Try...</p>\n\n<pre><code>Sub Macro5()\n\n    Dim UserFile As String, MyPath As String, MyFile As String\n\n    UserFile = Application.GetOpenFilename( _\n         FileFilter:=\"Excel Files (*.xls;*.xlsx), *.xls;*.xls\", Title:=\"Select a file\")\n\n    If UserFile = \"False\" Then\n        MsgBox \"User cancelled...\", vbInformation\n        Exit Sub\n    End If\n\n    MyPath = Left(UserFile, InStrRev(UserFile, \"\\\"))\n    MyFile = Mid(UserFile, InStrRev(UserFile, \"\\\") + 1)\n\n    ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP(RC[-5],'\" &amp; MyPath &amp; \"[\" &amp; MyFile &amp; \"]Availability'!R3C1:R321C24,9,0)\"\n\n    ActiveCell.Copy Destination:=ActiveCell.Range(\"A1:A37\")\n\nEnd Sub\n</code></pre>\n\n<p>You'll notice that I also added a few lines to allow the user to cancel the dialog box.  And I added a FileFilter for the GetOpenFilename method to ensure that only the correct file type (ie. xls or xlsx) is selected by the user.  Change as desired.</p>\n"}], "owner": {"reputation": 1964, "user_id": 2123706, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7f9f8aacaafd903d700846efd805bd55?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/2123706/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 616, "favorite_count": 0, "closed_date": 1498667679, "accepted_answer_id": 44807614, "answer_count": 1, "score": -1, "last_activity_date": 1498668455, "creation_date": 1498665510, "question_id": 44807464, "link": "https://stackoverflow.com/questions/44807464/how-to-reference-a-user-defined-workbook-and-worksheet-excel-vba", "closed_reason": "Duplicate", "title": "How to reference a user defined workbook and worksheet excel VBA", "body": "<p>I have a snippet of VBA code where I have the user select a file to refer to for a vlookup, and assign this to a variable, UserFile. Late on in the code, I have a snippet that wants to refer to a sheet in UserFile.</p>\n\n<p>It works when I put in the actual name of the file, how can I make it work so that it refers to UserFile, as opposed to the named file (it changes daily)</p>\n\n<p>This works:</p>\n\n<pre><code>Sub Macro5()\n        Dim MyFile As String\n        UserFile = Application.GetOpenFilename()\n\n        ActiveCell.Select\n        ActiveCell.FormulaR1C1 = _\n            \"=VLOOKUP(RC[-5],'[M2606170810.xlsx]Availability'!R3C1:R321C24,9,0)\"\n        ActiveCell.Select\n        Selection.Copy\n        ActiveCell.Range(\"A1:A37\").Select\n        ActiveSheet.Paste\n    End Sub\n</code></pre>\n\n<p>This does not (only change is in the vlookup formula):</p>\n\n<pre><code>Sub Macro5()\n    Dim MyFile As String\n    UserFile = Application.GetOpenFilename()\n\n    ActiveCell.Select\n    ActiveCell.FormulaR1C1 = _\n        \"=VLOOKUP(RC[-5],'[UserFile]Availability'!R3C1:R321C24,9,0)\"\n    ActiveCell.Select\n    Selection.Copy\n    ActiveCell.Range(\"A1:A37\").Select\n    ActiveSheet.Paste\nEnd Sub\n</code></pre>\n\n<p>I tried <a href=\"https://stackoverflow.com/questions/31697629/reference-an-excel-sheet-from-another-workbook-without-copying-the-sheet\">Reference an excel sheet from another workbook without copying the sheet</a> but to no avail.</p>\n\n<p>I want the option for the user to select the correct file to refer to, and wanted to add this in the flow</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "edited": false, "score": 0, "creation_date": 1498664188, "post_id": 44806871, "comment_id": 76593910, "body": "Is it possible your criteria expression <code>WHERE EV_ID = &quot; &amp; para &amp; &quot;;&quot;</code> has a data type mismatch? Perhaps it is not expecting a string? Anyway, you may  be better off setting default values through the Access design gui."}, {"owner": {"reputation": 1, "user_id": 8226980, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211929096516123/picture?type=large", "display_name": "Greg Elliott", "link": "https://stackoverflow.com/users/8226980/greg-elliott"}, "reply_to_user": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "edited": false, "score": 0, "creation_date": 1498665204, "post_id": 44806871, "comment_id": 76594684, "body": "Thanks for this. To test it I changed the query to a hard value and it worked. Although the input is a number i.e 55231, the datatype in the ODBC table is a VarChar so I was expecting string to work. Is there a different datatype that would be a more likely match?"}, {"owner": {"reputation": 1, "user_id": 8226980, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211929096516123/picture?type=large", "display_name": "Greg Elliott", "link": "https://stackoverflow.com/users/8226980/greg-elliott"}, "reply_to_user": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "edited": false, "score": 0, "creation_date": 1498665441, "post_id": 44806871, "comment_id": 76594866, "body": "I also tried building the query with a parameter in Access then using &quot;SELECT * FROM qrySELECT_MINIMUM_ID&quot; but it errored with expected 1 parameter got 0, is there a way to set the parameter with an Input Box or otherwise?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8226980, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211929096516123/picture?type=large", "display_name": "Greg Elliott", "link": "https://stackoverflow.com/users/8226980/greg-elliott"}, "is_accepted": false, "score": 0, "last_activity_date": 1498742276, "creation_date": 1498742276, "answer_id": 44826260, "question_id": 44806871, "link": "https://stackoverflow.com/questions/44806871/how-to-autopopulate-the-field-of-a-table-in-ms-access-with-a-identity-created-in/44826260#44826260", "title": "How to autopopulate the field of a table in MS Access with a Identity created in seperate table", "body": "<p>I managed to achieve what I was trying using a different method and thought I would post for someone to find useful in the future. </p>\n\n<p>To get around the issue of inconsistent datatype I used a query to run the SQL (including inputting the User ID) , and append it to a new table. Then pull the information from that table with a DLookup, then purge that table. I ended up with the following code. </p>\n\n<pre><code>Private Sub cmdSubmitDetails_Click()\n\nDim x As String\nDim y As String\nDim z As String\n\nDoCmd.SetWarnings False\nDoCmd.OpenQuery (\"AppendID\")\nx = DLookup(\"[ID]\", \"[TempID]\")\nMe.ID = x\ny = DLookup(\"[EV_ID]\", \"[TempID]\")\nMe.EVALUATOR_ID = y\nDoCmd.OpenQuery (\"qryDELETE_TEMP_ID\")\nDoCmd.OpenQuery (\"qryAddNextCallID\")\nDoCmd.OpenQuery (\"qryDELETE_MINIMUM_ID\")\nDoCmd.SetWarnings True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8226980, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211929096516123/picture?type=large", "display_name": "Greg Elliott", "link": "https://stackoverflow.com/users/8226980/greg-elliott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498742276, "creation_date": 1498663828, "question_id": 44806871, "link": "https://stackoverflow.com/questions/44806871/how-to-autopopulate-the-field-of-a-table-in-ms-access-with-a-identity-created-in", "title": "How to autopopulate the field of a table in MS Access with a Identity created in seperate table", "body": "<p>I am building a form in MS Access using linked ODBC tables which is to become a large input basis for some of our teams. I have most of it worked out however am trying to auto generate a Primary ID for the main table and populate the text box so the agent doesn't have to. Effectively building an auto number in SQL. </p>\n\n<p>I have the generation and rolling edits in the ODBC tables working and am just stuck on getting the generated code into the relevant field. I am using a macro on button click and have the following code: </p>\n\n<pre><code>Private Sub cmdSubmitDetails_Click()\n\nDim strSQL As String\nDim rst As Recordset\nDim db As Database\nDim para As String\n\npara = InputBox(\"Please Enter Your User ID:\")\nstrSQL = \"SELECT Min([P_ID]) AS ID FROM QA_IDS WHERE EV_ID = \" &amp; para &amp; \";\"\n\nSet db = CurrentDb\nSet rst = db.OpenRecordset(strSQL)\nMe.ID.Text = rst!ID\n\nrst.Close\nSet rst = Nothing\nSet db = Nothing\n\n\nEnd Sub\n</code></pre>\n\n<p>Me.ID is the field I am trying to populate. It is erroring out in the line </p>\n\n<pre><code>Set rst = db.OpenRecordset(strSQL)\n</code></pre>\n\n<p>with the error Run-time error '3464' Data type mismatch in criteria expression.</p>\n\n<p>It's my first real dabble in MS Access and I've searched for the solution online. Any help would be greatly appreciated. </p>\n"}, {"tags": ["arrays", "excel", "vba", "ms-word", "string-matching"], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1498690527, "post_id": 44808965, "comment_id": 76608179, "body": "Thank you for your response  @ryguy72 but I think your VBA code belongs to excel but what I&#39;m trying to do is create this program in VBA Word. Actually when I test your code from the Word VBEditor the &quot;GetOpenFilename&quot; method doesn&#39;t exist for Word so I think this won&#39;t do the job but I&#39;m still looking for other ideas if you have. Thanks."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1498746786, "post_id": 44808965, "comment_id": 76636407, "body": "Oh, I think I understand now.  I updated my original post.  Try the code.  Does it do what you want?"}, {"owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "edited": false, "score": 0, "creation_date": 1498809264, "post_id": 44808965, "comment_id": 76662994, "body": "Thanks for your time @ryguy72 but the question is how can we populate the array of strings variable with strings present in an excel file. How to achieve that? That&#39;s where I&#39;m getting stuck."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498746807, "last_edit_date": 1498746807, "creation_date": 1498670506, "answer_id": 44808965, "question_id": 44806730, "link": "https://stackoverflow.com/questions/44806730/search-for-matching-keywords-in-word-document-based-on-a-populated-array-of-stri/44808965#44808965", "title": "Search for matching keywords in word document based on a populated array of string from excel", "body": "<p>Does this do what you want?</p>\n\n<pre><code>Sub HighlightMultipleWords()\n\nDim sArr() As String\nDim rTmp As Range\nDim x As Long\n\nsArr = Split(\"Cat Bat Rat\") ' YOUR ARRAY OF WORDS\nOptions.DefaultHighlightColorIndex = wdYellow\n\nFor x = 0 To UBound(sArr)\nSet rTmp = ActiveDocument.Range\n\n    With rTmp.Find\n    .Text = sArr(x)\n    .Replacement.Text = sArr(x)\n    .Replacement.Highlight = True\n    .Execute Replace:=wdReplaceAll\n    End With\n\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 4494439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/38fc613ccbe0551f9ffb0b120cabeee0?s=128&d=identicon&r=PG&f=1", "display_name": "Stackgeek", "link": "https://stackoverflow.com/users/4494439/stackgeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498746807, "creation_date": 1498663455, "last_edit_date": 1498679117, "question_id": 44806730, "link": "https://stackoverflow.com/questions/44806730/search-for-matching-keywords-in-word-document-based-on-a-populated-array-of-stri", "title": "Search for matching keywords in word document based on a populated array of string from excel", "body": "<p><strong>What the program should do?</strong><br>\nI have two files; one Word file, and one Excel file. The Word file contains some text. The Excel file contains defined strings. What I'm trying to achieve is create a VBA program which will connect to an Excel file in the same or a different directory and get data from 2 columns of the Excel file and store them temporarily in a multi-dimensional array. The array will then be used to search for matching words within the document and highlight them. </p>\n\n<p><strong>What I've achieved so far</strong><br>\nI have come up with the code to find matching words from the array in the word document and highlight them. What I'm still struggling with is the connection to the Excel file to get this array dynamically populated.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Sub HighlightMatches()\n    Dim range As range\n    Dim i As Long\n    Dim wordsArray\n\nwordsArray = Array(\"Lion\", \"Hello\", \"Cat\", \"Lorem Ipsum\")\nFor i = 0 To UBound(wordsArray)\n    Set range = ActiveDocument.range\n\n    With range.Find\n    .Text = wordsArray(i)\n    .Format = True\n    .MatchCase = True\n        Do While .Execute(Forward:=True) = True\n            range.HighlightColorIndex = wdYellow\n        Loop\n    End With\nNext\nEnd Sub\n</code></pre>\n\n<p>I would appreciate your ideas of how to achieve this in the best way.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1498663658, "post_id": 44806654, "comment_id": 76593494, "body": "&quot;Does anything seem wrong in this?&quot;... Yes!.. No indentation! All sorts of things could be wrong but it&#39;s hard to read without indentation. You know... sometimes indentation actually shows you where you went wrong immediately."}, {"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1498663953, "post_id": 44806654, "comment_id": 76593735, "body": "This works ok for me. Could do with seeing the rest of the code. Indents would also help!"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 1, "creation_date": 1498664301, "post_id": 44806881, "comment_id": 76593967, "body": "I&#39;m trying this tomorrow but seems way much better ! Thanks a lot :) Have a nice day"}, {"owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1498730545, "post_id": 44806881, "comment_id": 76624002, "body": "Actually, I don&#39;t exactly see the difference between your code and mine, especially about the range. I precise that I verify if there some blak cells as from cell A14. Until column H and until last populated row. thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1498732627, "post_id": 44806881, "comment_id": 76625388, "body": "@Jeofbist3 - well, it is your code, I just made it work for me. The reason why you may think that it does not work is in the first 2 sentences of my answer."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "edited": false, "score": 0, "creation_date": 1498732936, "post_id": 44806881, "comment_id": 76625574, "body": "@Jeofbist3 Can you give a screenshot of a case that does not work?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1498663863, "creation_date": 1498663863, "answer_id": 44806881, "question_id": 44806654, "link": "https://stackoverflow.com/questions/44806654/vba-check-blank-cells-wrong-output/44806881#44806881", "title": "VBA - Check blank cells - Wrong output", "body": "<p>Probably you are not realizing, that you are looking in a <code>range(A14:H LAST Row)</code> Thus, if you have 5 rows, then the range is still Range(A14:H5). And there, you have empty values.</p>\n\n<pre><code>Public Sub TestME()\n\n    Dim bIsEmpty As Boolean\n\n    Set sht = ThisWorkbook.Worksheets(2)\n    Set StartCell = Range(\"A14\")\n\n    LastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).row\n\n    MsgBox (LastRow)\n    Set Rrng = Range(\"A1 : H\" &amp; LastRow)\n\n    For Each cell In Rrng\n        If IsEmpty(cell) = True Then\n            bIsEmpty = True\n            Exit For\n        End If\n    Next cell\n\n    If bIsEmpty Then\n        MsgBox \"There are empty cells in the file\"\n    Else\n        MsgBox \"All cells have values!\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "is_accepted": false, "score": 0, "last_activity_date": 1498730373, "creation_date": 1498730373, "answer_id": 44821989, "question_id": 44806654, "link": "https://stackoverflow.com/questions/44806654/vba-check-blank-cells-wrong-output/44821989#44821989", "title": "VBA - Check blank cells - Wrong output", "body": "<p>That's strange indeed because it also work sometimes. I mean the output message \"All cells have value\" is conformed to what's really in the file (no blanks at all) but sometimes not..</p>\n\n<p>Here is my full code: </p>\n\n<pre><code>  Sub empty_cells()                 \n  Dim sht As Worksheet        \n  Dim Rrng As Range        \n  Dim cell As Range                \n  Dim LastRow As Long\n  Dim StartCell As Range\n  Dim bIsEmpty As Boolean\n  Set sht = ThisWorkbook.Worksheets(\"SS upload\")\n  Set StartCell = Range(\"A14\")\n  LastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\n  MsgBox (LastRow)\n  Set Rrng = Range(\"A14 : H\" &amp; LastRow)\n  For Each cell In Rrng\n  If IsEmpty(cell) = True Then\n  bIsEmpty = True\n  Exit For\n End If\n Next cell\nIf bIsEmpty = True Then\nMsgBox \"There are empty cells in the file\"\nElse\nMsgBox \"All cells have values!\"\n  End If\n End Sub\n</code></pre>\n\n<p>thanks for your support :)</p>\n"}], "owner": {"reputation": 47, "user_id": 8155558, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e527318c91c07920527b679e1a2cee56?s=128&d=identicon&r=PG&f=1", "display_name": "Jeofbist3", "link": "https://stackoverflow.com/users/8155558/jeofbist3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1519503917, "creation_date": 1498663272, "last_edit_date": 1519503917, "question_id": 44806654, "link": "https://stackoverflow.com/questions/44806654/vba-check-blank-cells-wrong-output", "title": "VBA - Check blank cells - Wrong output", "body": "<p>I have a code that checks in a range if some cells are blank (empty or not). It gives me a message saying so. But, it seems not working well : the output message always says that there are some empty cells in the range (column A to H, until the last populated row) whereas it's the contrary (always data). \nI precise that the layout of the range is a table! MsgBox(LastRow) is every time equal to the last row also..\nHere is a part of the code:</p>\n\n<pre><code>Set sht = ThisWorkbook.Worksheets(\"SS upload\")         \nSet StartCell = Range(\"A14\")            \nLastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).Row\nMsgBox (LastRow)\nSet Rrng = Range(\"A14 : H\" &amp; LastRow)\nFor Each cell In Rrng\nIf IsEmpty(cell) = True Then\nbIsEmpty = True\nExit For\nEnd If\nNext cell\nIf bIsEmpty = True Then\nMsgBox \"There are empty cells in the file\"\nElse\nMsgBox \"All cells have values!\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Does anything seem wrong in this? </p>\n\n<p>Thank you for your precious help! :)\nRegards</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1498663342, "post_id": 44806593, "comment_id": 76593256, "body": "No, but you could write your own function."}, {"owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1498663757, "post_id": 44806593, "comment_id": 76593569, "body": "@Rory - nice catch! However, actually my code is like <code>With wsh            .Cells().Address(0, 0) End with</code>  So, how could I access object under With-statement from within my function? Only pass it as a parameter?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1498663962, "post_id": 44806593, "comment_id": 76593743, "body": "Yes, as a parameter."}], "owner": {"reputation": 342, "user_id": 4041590, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4a4188b4aed52554049a6a0eae090626?s=128&d=identicon&r=PG&f=1", "display_name": "Shurov", "link": "https://stackoverflow.com/users/4041590/shurov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498663109, "creation_date": 1498663109, "last_edit_date": 1531164843, "question_id": 44806593, "link": "https://stackoverflow.com/questions/44806593/use-relative-address-0-0-by-default", "title": "Use relative address (0, 0) by default", "body": "<p>I'm typing a lot of <code>Range.Cells().Address(0,0)</code> in my code to populate worksheet with logic-intensive formulas, so my code becomes quite long.</p>\n\n<p>Is there any setting (something like <code>Application.UseRelativeAddress = True</code>) that will make Excel to treat simple <code>Range.Cells().Address</code> as a Relative address by default?</p>\n\n<p><em>I know, it won't save me too much space, but my inner perfectionist can't deal with this zeros in each cell-reference :)</em></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "is_accepted": true, "score": 1, "last_activity_date": 1498664087, "creation_date": 1498664087, "answer_id": 44806959, "question_id": 44806486, "link": "https://stackoverflow.com/questions/44806486/use-hyperlink-to-navigate-to-another-tab-in-navigation-form/44806959#44806959", "title": "Use hyperlink to navigate to another tab in Navigation form", "body": "<p>Note: I have solved this issue. I used... </p>\n\n<pre><code>doCmd.BrowseTo acBrowseToForm, \"name of form that is showing up as the subform\", \"name of navigation form.NavigationSubform\"\n</code></pre>\n\n<p>Now on to the hard part: creating links to specific records.</p>\n"}], "owner": {"reputation": 89, "user_id": 4872152, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10204150407987018/picture?type=large", "display_name": "Eleyna", "link": "https://stackoverflow.com/users/4872152/eleyna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 44806959, "answer_count": 1, "score": 0, "last_activity_date": 1498664087, "creation_date": 1498662826, "question_id": 44806486, "link": "https://stackoverflow.com/questions/44806486/use-hyperlink-to-navigate-to-another-tab-in-navigation-form", "title": "Use hyperlink to navigate to another tab in Navigation form", "body": "<p>So I'm creating a ticketing system. I have a tab to create a ticket, resolve/edit a ticket, and to search the ticket list (a continuous form displaying results based on my search criteria). What I ultimately want to do is create a link from the record on the Search Ticket List tab that opens up the record in the Resolve/Edit ticket tab. But before I can begin tackling the specifics of that, I need to know:</p>\n\n<p><strong>How in the world do I create a link from one tab to another??</strong> </p>\n\n<p>They all seem to use the same subform, so it's not like I can use that as a reference to point my link there. I'm fairly new to access (I've just been muddling along with the help of Google and YouYube tutorials, so be gentle :D</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 1, "creation_date": 1498662925, "post_id": 44806349, "comment_id": 76592914, "body": "Aren&#39;t you concatenating offset rows? Try: Range(&quot;D2:D&quot; &amp; lngLastRow).Formula = &quot;=CONCATENATE(R[0]C[1],&quot;&quot;&quot;&quot;,R[0]C[2])&quot;"}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1498663342, "post_id": 44806349, "comment_id": 76593255, "body": "@Flephal I concur as long as that header is in your file as well."}, {"owner": {"reputation": 1, "user_id": 8226732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f13750cb9c2cb20dcd8c8b9b90cf2?s=128&d=identicon&r=PG&f=1", "display_name": "D Moran", "link": "https://stackoverflow.com/users/8226732/d-moran"}, "reply_to_user": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1498663674, "post_id": 44806349, "comment_id": 76593506, "body": "@Flephal That worked!"}], "owner": {"reputation": 1, "user_id": 8226732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40f13750cb9c2cb20dcd8c8b9b90cf2?s=128&d=identicon&r=PG&f=1", "display_name": "D Moran", "link": "https://stackoverflow.com/users/8226732/d-moran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498662990, "creation_date": 1498662475, "last_edit_date": 1531164843, "question_id": 44806349, "link": "https://stackoverflow.com/questions/44806349/concatenating-two-columns-into-one-with-dynamic-range-vba", "title": "Concatenating two columns into one with dynamic range VBA", "body": "<p>I am trying to concatenate two columns in Excel using VBA. Everything before \"Dim...\" is just formatting I need for the sheet I'm working with. The \"Dim...\" piece is giving me trouble because it moves all of the result data up one row and eliminates the value I have in D2 to start. The code I am using is below:</p>\n\n<pre><code>Range(\"D1\").EntireColumn.Insert\n\n Range(\"D1\").EntireColumn.NumberFormat = \"General\"\n\n Range(\"D2\").Select\n\nDim lngLastRow As Long \nlngLastRow = Cells(Rows.Count, \"B\").End(xlUp).Row\n\n    Range(\"D2:D\" &amp; lngLastRow).Formula = \"=CONCATENATE(R[1]C[1],\"\"\"\",R[1]C[2])\"\n</code></pre>\n\n<p><strong>Raw data:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/hYAxU.png\" rel=\"nofollow noreferrer\">Raw data</a></p>\n\n<p><strong>Results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/5QB2b.png\" rel=\"nofollow noreferrer\">Results after macro</a></p>\n\n<p>Any help would be awesome and if you need anything else, let me know! I tried to include all pertinent info.</p>\n"}, {"tags": ["vba", "excel", "types", "decimal"], "comments": [{"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 2, "creation_date": 1498662170, "post_id": 44806204, "comment_id": 76592329, "body": "Use <code>Single</code> or <code>Double</code>. <code>Long</code> is just another integer type."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1498662633, "post_id": 44806204, "comment_id": 76592680, "body": "That&#39;s all documentated in <a href=\"https://stackoverflow.com/documentation/vba/3418/data-types-and-limits#t=201706281509383174707\">Data Types and Limits</a> in Documentation.SO; this question is useless and doesn&#39;t show much research effort."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 1, "creation_date": 1498662784, "post_id": 44806204, "comment_id": 76592805, "body": "I should also mention that defining your variables like you do in the first line, only the last one is actually defined as a <code>Long</code>. The rest of them are defined as <code>Variant</code>."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "edited": false, "score": 0, "creation_date": 1498662803, "post_id": 44806204, "comment_id": 76592827, "body": "FYI, your <code>Dim</code> statement is only declaring <code>xSt4P</code> as a Long, not the rest of them.  You need to specify the type for EACH variable, not just the one at the end.  You&#39;ll notice that your debug printing is rounding this variable and not the rest of them.  The answer correctly identifies the problem with the <code>Long</code> datatype, but I figured I&#39;d mention this."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498662854, "post_id": 44806204, "comment_id": 76592861, "body": "@Mat&#39;sMug there&#39;s no option to close for this reason :D"}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498662914, "post_id": 44806204, "comment_id": 76592907, "body": "@Mat&#39;sMug See this <a href=\"https://meta.stackoverflow.com/questions/260828/do-we-need-a-close-reason-for-zero-effort-questions\">meta question</a> about closing along these lines."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 1, "creation_date": 1498662972, "post_id": 44806204, "comment_id": 76592955, "body": "@Phylogenesis/A.S.H. thanks. FWIW I was merely justifying my downvote, didn&#39;t vote to close (yet - there&#39;s certainly a dupe somewhere)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498663279, "post_id": 44806204, "comment_id": 76593202, "body": "Also FWIW <code>Dim xUmsatz, xOLiP, xSt1B, xSt1P, xSt2B, xSt2P, xSt3B, xSt3P, xSt4B, xSt4P As Long</code> declares <code>xSt4P</code> (whatever that means) as a <code>Long</code>, and everything else is an implicit <code>Variant</code> - a classic beginner mistake. Avoid declaring multiple variables in the same instruction, avoid walls of declarations at the top of a procedure - declare variables as close as possible to their first usage. Thank yourself later. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> can probably help you with some other VBA traps."}, {"owner": {"reputation": 59, "user_id": 5142723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktvgI.jpg?s=128&g=1", "display_name": "Philipp", "link": "https://stackoverflow.com/users/5142723/philipp"}, "edited": false, "score": 0, "creation_date": 1498720738, "post_id": 44806204, "comment_id": 76617344, "body": "Thanks to all of you for pointing out my mistake about defining the variables. That saved me a lot of headache."}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1498662461, "creation_date": 1498662461, "answer_id": 44806340, "question_id": 44806204, "link": "https://stackoverflow.com/questions/44806204/vba-when-passing-on-0-02-to-an-integer-its-value-is-0/44806340#44806340", "title": "VBA - When passing on 0,02 to an Integer, it&#39;s Value is 0", "body": "<p>Try the following to understand the difference between different value types:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim k As Long\n    Dim p As Double\n\n    k = 0.4\n    Debug.Print k\n\n    k = 0.7\n    Debug.Print k\n\n    p = 0.4\n    Debug.Print p\n\nEnd Sub\n</code></pre>\n\n<p>The result would be in the immediate window.</p>\n"}, {"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 0, "last_activity_date": 1498663408, "last_edit_date": 1498663408, "creation_date": 1498662732, "answer_id": 44806447, "question_id": 44806204, "link": "https://stackoverflow.com/questions/44806204/vba-when-passing-on-0-02-to-an-integer-its-value-is-0/44806447#44806447", "title": "VBA - When passing on 0,02 to an Integer, it&#39;s Value is 0", "body": "<p>Read up on your Visual Basic for Applications data types <a href=\"https://msdn.microsoft.com/en-us/library/aa263420(v=vs.60).aspx\" rel=\"nofollow noreferrer\">here on MSDN</a></p>\n\n<p>Code example for the basic numeric types:</p>\n\n<pre><code>Sub Some_sub()\n\nDim a As Double\nDim b As Long\nDim c As Integer\nDim d As Single\n\na = 0.02 \nb = 0.02 \nc = 0.02 \nd = 0.02 \n\nDebug.Print a 'output: 0.02\nDebug.Print b 'output: 0\nDebug.Print c 'output: 0\nDebug.Print d 'output: 0.02\n\nEnd Sub\n</code></pre>\n\n<p>As said in the comments: Use Single or Double.</p>\n"}], "owner": {"reputation": 59, "user_id": 5142723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktvgI.jpg?s=128&g=1", "display_name": "Philipp", "link": "https://stackoverflow.com/users/5142723/philipp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 44806447, "answer_count": 2, "score": -5, "last_activity_date": 1498663408, "creation_date": 1498662114, "last_edit_date": 1498663357, "question_id": 44806204, "link": "https://stackoverflow.com/questions/44806204/vba-when-passing-on-0-02-to-an-integer-its-value-is-0", "title": "VBA - When passing on 0,02 to an Integer, it&#39;s Value is 0", "body": "<p>This function is used to determine a promotion-percentage based on the revenue of a customer. This is a example scaling:</p>\n\n<pre><code>Without Limit     -&gt; 2.0%\nfrom 30.000,-     -&gt; 3,0%\nfrom 50.000,-     -&gt; 3,5%\nfrom 75.000,-     -&gt; 4,0%\n</code></pre>\n\n<p>All values are retrieved from an Excel sheet and stored in Longs. </p>\n\n<p>The Problem is when the promotion tier is determined, I am passing the percentage value to the function (which is Datatype Integer).</p>\n\n<pre><code>PercentageInstallation = xSt3P\n</code></pre>\n\n<p>xSt3P is 0.03, but PercentageInstallation says 0.</p>\n\n<p>Here is the function:</p>\n\n<pre><code>Public Function PercentageInstallation(xRwCtr As Integer, xKdnr1 As Integer, xSource As Worksheet) As Integer\n\n    Dim xUmsatz, xOLiP, xSt1B, xSt1P, xSt2B, xSt2P, xSt3B, xSt3P, xSt4B, xSt4P As Long\n\n    xUmsatz = xSource.Cells(xRwCtr, \"I\")    'Gesamtumsatz\n    xOLiP = xSource.Cells(xRwCtr, \"Q\")      'ohne Limit\n    xSt1B = xSource.Cells(xRwCtr, \"R\")      'Stufe 1 Betrag\n    xSt1P = xSource.Cells(xRwCtr, \"S\")      'Stufe 1 Prozent\n    xSt2B = xSource.Cells(xRwCtr, \"T\")      'Stufe 2 Betrag\n    xSt2P = xSource.Cells(xRwCtr, \"U\")      'Stufe 2 Prozent\n    xSt3B = xSource.Cells(xRwCtr, \"V\")      'Stufe 3 Betrag\n    xSt3P = xSource.Cells(xRwCtr, \"W\")      'Stufe 3 Prozent\n    xSt4B = xSource.Cells(xRwCtr, \"X\")      'Stufe 4 Betrag\n    xSt4P = xSource.Cells(xRwCtr, \"Y\")      'Stufe 4 Prozent\n\n    Debug.Print (\"----------------------\")\n    Debug.Print (\"&gt; \" &amp; xUmsatz)\n    Debug.Print (\"&gt; \" &amp; xOLiP)\n    Debug.Print (\"&gt; \" &amp; xSt1B)\n    Debug.Print (\"&gt; \" &amp; xSt1P)\n    Debug.Print (\"&gt; \" &amp; xSt2B)\n    Debug.Print (\"&gt; \" &amp; xSt2P)\n    Debug.Print (\"&gt; \" &amp; xSt3B)\n    Debug.Print (\"&gt; \" &amp; xSt3P)\n    Debug.Print (\"&gt; \" &amp; xSt4B)\n    Debug.Print (\"&gt; \" &amp; xSt4P)\n    Debug.Print (\"----------------------\")\n\n\n    If xUmsatz &gt; xSt4B And xSt4B &lt;&gt; \"\" Then\n        Debug.Print (\"Its tier 4!\")\n        PercentageInstallation = xSt4P\n\n    ElseIf xUmsatz &gt; xSt3B And xSt3B &lt;&gt; \"\" Then\n        Debug.Print (\"Its tier 3!\")\n        PercentageInstallation = xSt3P\n\n    ElseIf xUmsatz &gt; xSt2B And xSt2B &lt;&gt; \"\" Then\n        Debug.Print (\"Its tier 2!\")\n        PercentageInstallation = xSt2P\n\n    ElseIf xUmsatz &gt; xSt1B And xSt1B &lt;&gt; \"\" Then\n        Debug.Print (\"Its tier 1!\")\n        PercentageInstallation = xSt1P\n\n    ElseIf xOLiP &lt;&gt; \"\" Then\n        Debug.Print (\"Its tier without Limit!\")\n        PercentageInstallation = xOLiP\n\n    Else\n        Call Error(4, xKdnr1)\n\n    End If\n\nEnd Function\n</code></pre>\n\n<p>And here is the Output from Debug.Print:</p>\n\n<pre><code>----------------------\n&gt; 81475,57\n&gt; 0,02\n&gt; 30000\n&gt; 0,03\n&gt; 50000\n&gt; 0,035\n&gt; 75000\n&gt; 0,04\n&gt; \n&gt; 0\n----------------------\nIts tier 3!\n</code></pre>\n\n<p>I tried to define the function as Long, but this didn't solve the problem.</p>\n"}, {"tags": ["excel", "syntax", "copy-paste", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1498661881, "post_id": 44805982, "comment_id": 76592101, "body": "Range is either a string or two cells marking the extents of the range.  You could do <code>Sheets(&quot;Y&quot;).Range(Sheets(&quot;Y&quot;).Cells(1, 1).Address(0,0))</code> to return a string.  But you cannot denote a range of one cell."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 2, "last_activity_date": 1498661983, "last_edit_date": 1498661983, "creation_date": 1498661884, "answer_id": 44806097, "question_id": 44805982, "link": "https://stackoverflow.com/questions/44805982/range-copy-destination-a1-vs-cells1-1-excel-vba/44806097#44806097", "title": "range.copy Destination &quot;A1&quot; vs &quot;Cells(1,1)&quot; Excel/VBA", "body": "<p>Unqualified <code>Cells(1,1)</code> belongs to the ActiveSheet, which is currently Sheets(\"X\"), so it does not belong to <code>Sheets(\"Y\")</code>.</p>\n\n<p>OTOH: this should work:</p>\n\n<pre><code>Destination:=Sheets(\"Y\").Range(Sheets(\"Y\").Cells(1, 1), Sheets(\"Y\").Cells(1, 1)) \n'                             ^^^^^^^^^^^^^\n</code></pre>\n\n<p>Dont use unqualified  ranges. Drop the <code>Activate</code> stuf altogether from your code.</p>\n"}, {"comments": [{"owner": {"reputation": 269, "user_id": 4797660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f0b5968db664b293d39b27843b34648?s=128&d=identicon&r=PG&f=1", "display_name": "BuckTurgidson", "link": "https://stackoverflow.com/users/4797660/buckturgidson"}, "edited": false, "score": 0, "creation_date": 1498723399, "post_id": 44806102, "comment_id": 76618994, "body": "&#39;The copy only works because you activate sheet X first.&#39; I&#39;m quite puzzled since I activate sheet &quot;X&quot; and &quot;A1&quot; refers (and works!) on sheet &quot;Y&quot;. Any idea if Microsoft publishes any documentation that explains how this works on the background?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 269, "user_id": 4797660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f0b5968db664b293d39b27843b34648?s=128&d=identicon&r=PG&f=1", "display_name": "BuckTurgidson", "link": "https://stackoverflow.com/users/4797660/buckturgidson"}, "edited": false, "score": 1, "creation_date": 1498725647, "post_id": 44806102, "comment_id": 76620488, "body": "Yes, <code>Sheets(&quot;Y&quot;).Range(&quot;A1&quot;)</code> works as it refers to A1 on Sheet Y - it&#39;s all one reference.   <code>Sheets(&quot;X&quot;).Range(Cells(1, 1), Cells(1, 30))</code> uses three references - <code>Sheets(&quot;X&quot;).Range(</code> references Sheet X while <code>Cells(1, 1)</code> and <code>Cells(1, 30)</code> reference the ActiveSheet.  To get those to reference Sheet X as well you&#39;d write <code>Sheets(&quot;X&quot;).Range(Sheets(&quot;X&quot;).Cells(1, 1), Sheets(&quot;X&quot;).Cells(1, 30))</code> - but then it will look at the active workbook so you need to qualify that as well - <code>ThisWorkbook.Sheets(&quot;X&quot;).Range(ThisWorkbook.Sheets(&quot;X&quot;).Cell&zwnj;&#8203;s(1, 1), ThisWorkbook.Sheets(&quot;X&quot;).Cells(1, 30))</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 269, "user_id": 4797660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f0b5968db664b293d39b27843b34648?s=128&d=identicon&r=PG&f=1", "display_name": "BuckTurgidson", "link": "https://stackoverflow.com/users/4797660/buckturgidson"}, "edited": false, "score": 0, "creation_date": 1498725880, "post_id": 44806102, "comment_id": 76620646, "body": "That last bit of code in my previous comment gets very clunky - which is why there&#39;s <code>With...End With</code> blocks.  <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb(v=vs.90).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/wc500chb(v=vs.90).aspx</a> or using variables: <code>Set wrkSht = ThisWorbook.Worksheets(X)</code> and <code>wrksht.Range(wrksht.Cells(1, 1), wrksht.Cells(1, 30))</code>"}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 2, "last_activity_date": 1498661895, "creation_date": 1498661895, "answer_id": 44806102, "question_id": 44805982, "link": "https://stackoverflow.com/questions/44805982/range-copy-destination-a1-vs-cells1-1-excel-vba/44806102#44806102", "title": "range.copy Destination &quot;A1&quot; vs &quot;Cells(1,1)&quot; Excel/VBA", "body": "<p>You haven't qualified the sheet name.  So the copy happens on the ActiveSheet it then tries to reference Cell(1,1) from the ActiveSheet but on sheet Y:  </p>\n\n<p><code>Sheets(\"Y\").Range(Cells(1, 1))</code></p>\n\n<p>Sheets(\"Y\") is sheet Y.\nCells(1,1) is the ActiveSheet.</p>\n\n<p>The copy only works because you activate sheet X first.  Remove that line, select another sheet and it will fail on that as well.</p>\n"}], "owner": {"reputation": 269, "user_id": 4797660, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6f0b5968db664b293d39b27843b34648?s=128&d=identicon&r=PG&f=1", "display_name": "BuckTurgidson", "link": "https://stackoverflow.com/users/4797660/buckturgidson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18541, "favorite_count": 0, "accepted_answer_id": 44806097, "answer_count": 2, "score": 2, "last_activity_date": 1498661983, "creation_date": 1498661618, "last_edit_date": 1531164843, "question_id": 44805982, "link": "https://stackoverflow.com/questions/44805982/range-copy-destination-a1-vs-cells1-1-excel-vba", "title": "range.copy Destination &quot;A1&quot; vs &quot;Cells(1,1)&quot; Excel/VBA", "body": "<p>Consider the below:</p>\n\n<pre><code>    Sheets(\"X\").Activate\n    Sheets(\"X\").Range(Cells(1, 1), Cells(1, 30)).Copy Destination:=Sheets(\"Y\").Range(\"A1\") 'Syntax 1\n    Sheets(\"X\").Range(Cells(1, 1), Cells(1, 30)).Copy Destination:=Sheets(\"Y\").Range(Cells(1, 1)) 'Syntax 2\n</code></pre>\n\n<p>Why does Syntax 1 works while Syntax 2 runs into 'Application-defined or object-defined error'?</p>\n"}, {"tags": ["vba", "excel"], "owner": {"reputation": 33, "user_id": 4454212, "user_type": "registered", "profile_image": "https://graph.facebook.com/555485889/picture?type=large", "display_name": "Ted Dennis", "link": "https://stackoverflow.com/users/4454212/ted-dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1498661284, "creation_date": 1498661284, "last_edit_date": 1531164843, "question_id": 44805842, "link": "https://stackoverflow.com/questions/44805842/exce4macro-print-code-needs-changing", "title": "Exce4Macro Print code needs changing", "body": "<p>I have a macro written by someone else with which ends -</p>\n\n<pre><code>    End If\n\nExecuteExcel4Macro \"PRINT(1,,,1,,,,,,,,2,,,TRUE,,FALSE)\"\n\nSheets(\"policy data\").Select\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Instead of Printing directly, I need to change this so that I print to pdf to file and save</p>\n\n<p>Can I amend this existing code ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1498661188, "post_id": 44805757, "comment_id": 76591534, "body": "You&#39;re trying to pass an array to something that clearly expects a single value."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498661210, "post_id": 44805757, "comment_id": 76591564, "body": "Fresh from today: <a href=\"https://stackoverflow.com/questions/44802467/using-left-for-variable/44802555\" title=\"using left for variable\">stackoverflow.com/questions/44802467/using-left-for-variable&zwnj;&#8203;/&hellip;</a>?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1498661233, "post_id": 44805757, "comment_id": 76591574, "body": "or try to replace the last part to <code>sht.Range(&quot;B1&quot;).Value</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498662894, "post_id": 44805757, "comment_id": 76592889, "body": "<code>= sht.Range(&quot;B1:B3&quot;).Value</code> - Try entering <code>=B1:B3</code> in cell <code>D1</code>. What do you expect Excel to return for D1&#39;s value? You need to figure out which of the 3 values you want to assign to that text element; you can&#39;t assign a &quot;bunch of values&quot; to a single string."}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498728486, "post_id": 44805757, "comment_id": 76622553, "body": "@Mat&#39;sMug : Then how can i pass a range of values? I want values from B1 to B3 .."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498741968, "post_id": 44805757, "comment_id": 76632492, "body": "You can&#39;t. You need to figure out a way to combine them into one single value. Concatenate them?"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498729624, "post_id": 44821288, "comment_id": 76623359, "body": "yayy!! Scriptman to the rescue :) Now the error doesnot show up, but it shows 0 in all the three boxes in SAP why is that so?"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498733195, "post_id": 44821288, "comment_id": 76625729, "body": "First I would test the formula without SAP only in Excel. for example: sht.Range(&quot;A1&quot;).value = xcl.WorksheetFunction.Sum(sht.Range(&quot;B1:B3&quot;))"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498733916, "post_id": 44821288, "comment_id": 76626235, "body": "i checked !! Still returning value as 0."}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498735152, "post_id": 44821288, "comment_id": 76627028, "body": "Then the error is in the formula or in the cells to which the formula refers. But you can also test the following. for example: = sht.Range(&quot;B1&quot;).Value + sht.Range(&quot;B2&quot;).Value + sht.Range(&quot;B3&quot;).Value"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498735758, "post_id": 44821288, "comment_id": 76627465, "body": "Still it is returning as 0. Just a small doubt, why are you using Sum function ? We dont want to add the values We just want a set of values in the column(User ids) to be copied into SAP field columns"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498735927, "post_id": 44821288, "comment_id": 76627602, "body": "Cant we do something like this? rng=Range(&quot;B1:B3&quot;) sht.Range(&quot;rng&quot;).Value  Not sure. need help with the syntax"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498738009, "post_id": 44821288, "comment_id": 76629198, "body": "It does not help. You would have to present the contents of the 3 affected cells here. Then one could talk about it further."}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498741501, "post_id": 44821288, "comment_id": 76632073, "body": "The cells contain User IDs like BC1234, CD1234, BCDEFG"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498741581, "post_id": 44821288, "comment_id": 76632132, "body": "@AnirudhChauhan you have 3 values and 1 slot. Either you add them up to make 1 value, or you find 2 more slots so you can fit your 3 values."}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1498742325, "post_id": 44821288, "comment_id": 76632794, "body": "Now we know, the values can not be added. Do you want to pass the value from Excel, depending on &quot;j&quot;? This could be realized as follows: session.findById(&quot;wnd[1]/usr/tabsTAB_STRIP....ctxtRSCSEL_255&zwnj;&#8203;-SLOW_I[1,&quot; &amp; Int(j) &amp; &quot;]&quot;).Text = sht.Range(&quot;B&quot; &amp; cstr(j+1))"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1498744267, "post_id": 44821288, "comment_id": 76634294, "body": "@Mat&#39;sMug : I dont have one slot i have multiple slots in SAP fields. It is like a column Hence, I am using j variable in for loop to fetch the values"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498744643, "post_id": 44821288, "comment_id": 76634636, "body": "@ScriptMan : No...it does not depend on j. j variable is used in for loop as column number in SAP field.  Likewise, we can use variable i to loop the column number in excel Do you know any sort of this possibility?"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1498745156, "post_id": 44821288, "comment_id": 76635064, "body": "To understand what you want to do, you should assign the values from Excel in the following way. for example: session.findById(&quot;wnd[1]/usr/tabsTAB_STRIP....ctxtRSCSEL_255&zwnj;&#8203;-SLOW_I[1,0]&quot;).Text = &quot;BC1234&quot;; session.findById(&quot;wnd[1]/usr/tabsTAB_STRIP....ctxtRSCSEL_255&zwnj;&#8203;-SLOW_I[1,1]&quot;).Text = &quot;CD1234&quot;; session.findById(&quot;wnd[1]/usr/tabsTAB_STRIP....ctxtRSCSEL_255&zwnj;&#8203;-SLOW_I[1,2]&quot;).Text = &quot;BCDEFG&quot;"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498746176, "post_id": 44821288, "comment_id": 76635897, "body": "@ScriptMan : I cannot do that..because I dont know what will be the value of these fields Moreover, It is not just these three. There are upto 80 userids"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "edited": false, "score": 0, "creation_date": 1498806413, "post_id": 44821288, "comment_id": 76661375, "body": "Too bad it did not work. In the 6th comment before, the solution you did accept later was already available."}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1499066370, "post_id": 44821288, "comment_id": 76737686, "body": "@ScriptMan : no worries, scriptman you will always be my hero :)"}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 0, "last_activity_date": 1498728539, "creation_date": 1498728539, "answer_id": 44821288, "question_id": 44805757, "link": "https://stackoverflow.com/questions/44805757/the-method-got-an-invalid-argument-error-in-rangeb1b3-value/44821288#44821288", "title": "&quot;The method got an invalid argument&quot; error in Range(&quot;B1:B3&quot;).Value", "body": "<p>If you create a sum, you can transfer it to SAP.</p>\n\n<p>for example:</p>\n\n<p>session.findById(\"wnd[1]/usr/tabsTAB_STRIP....ctxtRSCSEL_255-SLOW_I[1,\" &amp; Int(j) &amp; \"]\").Text = xcl.WorksheetFunction.Sum(sht.Range(\"B1:B3\"))</p>\n\n<p>Regards,\nScriptMan</p>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498745156, "post_id": 44827187, "comment_id": 76635063, "body": "Absolutely correct!! This works !! Thankyou so much Now i have 2 heroes : scriptman and mat&#39;s mug :)"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498745792, "post_id": 44827187, "comment_id": 76635569, "body": "Just one more thing.. It works with 3 fields What if I have more than 10 fields in a column in excel sheet? By your method, SAP is taking only 8 fields at one time."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498745971, "post_id": 44827187, "comment_id": 76635717, "body": "You control the value of <code>j</code>. I don&#39;t know how the SAP API works, that&#39;s for you to figure out. Make it loop from 0 to 9 and you&#39;ll store <code>B1:B10</code> into <code>[1,0]</code> through <code>[1,9]</code>; whether or not that&#39;s valid depends on how the API works."}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498746032, "post_id": 44827187, "comment_id": 76635774, "body": "Actually what i am trying is after executing a transaction, I get bunch of user ids, then I copy it and paste it into another transaction window. But the problem is &quot;UPLOAD FROM CLIPBOARD&quot; doesnot work in vba hence, i copy the user ids into excel and then fetch them into SAP"}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498746101, "post_id": 44827187, "comment_id": 76635832, "body": "@ScriptMan : can you help here?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498746125, "post_id": 44827187, "comment_id": 76635848, "body": "And this is why asking about Y when you want to solve X, is wasting everyone&#39;s time. Good luck."}, {"owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 0, "creation_date": 1498746239, "post_id": 44827187, "comment_id": 76635950, "body": "haha..that is because X does not work :) So, we have to go through Y because Y will definitely work. Just need some help outta there :-)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "edited": false, "score": 1, "creation_date": 1498746433, "post_id": 44827187, "comment_id": 76636106, "body": "What Mat&#39;sMug is trying to tell you, @AnirudhChauhan, is that if you had &quot;Actually&quot; asked the &quot;what I am trying to do...&quot; part as your <i>original</i> question, you&#39;d have received an answer to that instead of finding a fix to a problem that doesn&#39;t actually address your real problem."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1498744516, "creation_date": 1498744516, "answer_id": 44827187, "question_id": 44805757, "link": "https://stackoverflow.com/questions/44805757/the-method-got-an-invalid-argument-error-in-rangeb1b3-value/44827187#44827187", "title": "&quot;The method got an invalid argument&quot; error in Range(&quot;B1:B3&quot;).Value", "body": "<blockquote>\n  <p><em>How can I pass a range of values?</em></p>\n</blockquote>\n\n<p>You don't. You can't put 3 cell values in 1 slot. You want <code>[B1:B3]</code> in 3 slots, so inside your 0-2 loop you'll take the cell in column <code>B</code> at row <code>j + 1</code> - I had a hard time formatting that ID string in the code block, so I extracted it into its own variable; it also makes the assignment instruction a bit clearer:</p>\n\n<pre><code>Dim id As String\nid = \"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssubSCREEN_HEADER:SAPLALDB:3010/tblSAPLALDBSINGLE/ctxtRSCSEL_255-SLOW_I\"\n\nFor j = 0 To 2\n    session.findById(id &amp; \"[1, \" &amp; j &amp; \"]\").Text = sht.Range(\"B\" &amp; j + 1).Value\nNext j\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 8226773, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e07ea380f75b87d008e44ecb1d9223b2?s=128&d=identicon&r=PG&f=1", "display_name": "Anirudh Chauhan", "link": "https://stackoverflow.com/users/8226773/anirudh-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2509, "favorite_count": 0, "accepted_answer_id": 44827187, "answer_count": 2, "score": -1, "last_activity_date": 1499021594, "creation_date": 1498661081, "last_edit_date": 1531164843, "question_id": 44805757, "link": "https://stackoverflow.com/questions/44805757/the-method-got-an-invalid-argument-error-in-rangeb1b3-value", "title": "&quot;The method got an invalid argument&quot; error in Range(&quot;B1:B3&quot;).Value", "body": "<p>I am trying to fetch data from excel sheet into my SAP system with the help of following part of the code :</p>\n\n<pre><code>Dim xcl As Object\n\nDim wbk As Workbook\n\nDim sht As Worksheet\n\nApplication.DisplayAlerts = False\n\nSet xcl = CreateObject(\"Excel.Application\")\n\nSet wbk = Workbooks.Open(\"C:\\....\")\n\nSet sht= wbk.Sheets(\"excel1\")\n\nDim j As Integer\n\nFor j = 0 To 2\n\n **session.findById(\"wnd[1]/usr/tabsTAB_STRIP/tabpSIVA/ssubSCREEN_HEADER:SAPLALDB:3010/tblSAPLALDBSINGLE/ctxtRSCSEL_255-SLOW_I[1,\" &amp; Int(j) &amp; \"]\").Text = sht.Range(\"B1:B3\").Value**\n\nNext j\n\nEnd Sub\n</code></pre>\n\n<p>With lots of research on stackoverflow(@scriptman is my hero), i am finally able to fetch data in SAP system using \" &amp; Int(j) &amp; \".\nBut it only works if  I am using sht.Range(\"B1\").Value</p>\n\n<p>If i use,  sht.Range(\"B1:B3\").Value, I get error in the above bold line as \n\"Runtime error 613\"\nThe method got an invalid arguement\"</p>\n\n<p>Please help.\nI am stuck at this since a month.</p>\n"}, {"tags": ["excel", "vba", "if-statement", "runtime-error"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 1, "creation_date": 1498661388, "post_id": 44805700, "comment_id": 76591694, "body": "As a side point, is there any reason you didn&#39;t use <code>i=2</code> at the beginning and remove <i>allll</i> that <code>2 + i</code> stuff?"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498661542, "post_id": 44805700, "comment_id": 76591821, "body": "You must have some <code>#NA</code> (or other error) in the cell <code>(&quot;M&quot; &amp; 2 + i)</code>."}, {"owner": {"reputation": 2235, "user_id": 7535125, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209489062678374/picture?type=large", "display_name": "Brandon Barney", "link": "https://stackoverflow.com/users/7535125/brandon-barney"}, "edited": false, "score": 0, "creation_date": 1498663409, "post_id": 44805700, "comment_id": 76593312, "body": "First off, make sure you qualify all of your range references. Currently, you are using the implicit Activesheet reference which may be what you intend at the time of the code running, or it may not. If the activesheet changes you wont know it is operating on the wrong sheet until it is potentially too late.  As A.S.H has suggested, you likely have some kind of error within the cell that is causing the code to throw an error of its own. VBA cannot implicitly compare an error type to a string type. Try debug.Printing the values you are trying to compare so you can see what the code sees."}], "owner": {"reputation": 1, "user_id": 8226656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad22aae674259028d5d43f3f1f93ae66?s=128&d=identicon&r=PG&f=1", "display_name": "Kodde", "link": "https://stackoverflow.com/users/8226656/kodde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498661725, "creation_date": 1498660929, "question_id": 44805700, "link": "https://stackoverflow.com/questions/44805700/if-and-statement-run-time-error-13", "title": "IF ... (AND) statement run time error &quot;13&quot;", "body": "<p>I need help with my if statements. In the code show below: The first if ... then section works just as intended, however the second section creates a run time error \"13\". Can someone please explain me how to fix this issue? / what i'm doing wrong?</p>\n\n<pre><code>Sub ASN_BaaN3()\nDim i As Integer\ni = 0\n\nThisWorkbook.Sheets(\"BaaN\").Activate\n\nDo While ThisWorkbook.Sheets(\"BaaN\").Cells(2 + i, 1) &lt;&gt; \"\"\n\n    'CHECK NON SERIALIZED\n    If Range(\"J\" &amp; 2 + i).Value = \"N\" Then\n        Range(\"P\" &amp; 2 + i).Value = \"Ok, Non Serialized\"\n        Range(\"P\" &amp; 2 + i).EntireRow.Interior.Color = RGB(198, 239, 206)\n    End If\n\n    If Range(\"J\" &amp; 2 + i).Value = \"Y\" And _\n    Range(\"M\" &amp; 2 + i).Value = \"ACK\" And _\n    Range(\"o\" &amp; 2 + i).Value = \"TRUE\" Then\n        Range(\"P\" &amp; 2 + i).Value = \"Ok, Non Serialized\"\n        Range(\"P\" &amp; 2 + i).EntireRow.Interior.Color = RGB(198, 239, 206)\n    End If\n\n    i = i + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>when typing the code like this i get the same error:</p>\n\n<pre><code>    If Range(\"J\" &amp; 2 + i).Value = \"Y\" Then\n    If Range(\"M\" &amp; 2 + i).Value = \"ACK\" Then\n    If Range(\"O\" &amp; 2 + i).Value = \"TRUE\" Then\n        Range(\"P\" &amp; 2 + i).Value = \"Ok, Non Serialized\"\n        Range(\"P\" &amp; 2 + i).EntireRow.Interior.Color = RGB(198, 239, 206)\n    End If\n    End If\n    End If\n</code></pre>\n\n<p>Also when typing the code like this </p>\n\n<pre><code>    If Range(\"J\" &amp; 2 + i).Value = \"Y\" Then\n    If Range(\"M\" &amp; 2 + i).Value = \"Y\" Then\n</code></pre>\n\n<p>Please help!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498662253, "post_id": 44805929, "comment_id": 76592390, "body": "If you dont mind, can you tell me how we do it without using function ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498662300, "post_id": 44805929, "comment_id": 76592430, "body": "also, the above Counts for the values in column, but it doesnot look for the week number and fill the table accordingly in sheet2."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498662723, "post_id": 44805929, "comment_id": 76592754, "body": "Is there a reason that you don&#39;t want to use the countif function?  I think that is going to be the easiest way.  I guess you could loop through each row in column I with an if statement to see if it was 1 or not.  But that would be really inefficient and unnecessarily complicated."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498663836, "post_id": 44805929, "comment_id": 76593636, "body": "it does not look for the CW. and paste the result in sheet2."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498663894, "post_id": 44805929, "comment_id": 76593682, "body": "if you can look at my Image, it should check with the CW in sheet1, and then post the Count value to sheet2 accordingly. @jarom"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498663938, "post_id": 44805929, "comment_id": 76593720, "body": "I see now that I misunderstood your question.  Stand by while I correct it."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498663995, "post_id": 44805929, "comment_id": 76593768, "body": "sorry Jarom, i have to edit the Image again, may be then you will understand better. IT posted wrongly."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498672241, "post_id": 44805929, "comment_id": 76599057, "body": "can you help me to solve ? I am waiting for your response"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498675794, "post_id": 44805929, "comment_id": 76601137, "body": "I edited the posting.  The code is different than before."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1498721516, "post_id": 44805929, "comment_id": 76617834, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/147896/discussion-between-mikz-and-jarom\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": false, "score": 1, "last_activity_date": 1498665972, "last_edit_date": 1498665972, "creation_date": 1498661477, "answer_id": 44805929, "question_id": 44805589, "link": "https://stackoverflow.com/questions/44805589/vba-to-count-the-value-in-column-and-fill-the-table-in-another-sheet/44805929#44805929", "title": "VBA to Count the value in column and fill the table in another sheet", "body": "<p>To solve this problem, we have to use a couple of loops.  First, we have to do an outer loop to go through the week numbers in sheet2, then imbedded in that loop we have to look at each row in sheet1 to see if it matches the week from sheet2 and to see if column T = 1 and if column U = 0.  The code creates a counter that increase T by one every time a row in T is equal to 1 and does the same for U every time a row in U = 0.</p>\n\n<pre><code>Sub test()\nDim col As Range\nDim row As Range\nDim sh1 As Worksheet\nDim sh2 As Worksheet\nDim T As Integer\nDim U As Integer\nDim wk As String\n\nSet sh1 = Sheets(\"Sheet1\")\nSet sh2 = Sheets(\"Sheet2\")\n\n\n\nFor Each col In sh2.Columns 'This loops through all populated columns in row one\n    If sh2.Cells(1, col.Column).Value = \"\" Then\n        Exit For\n    End If\n\n    wk = sh2.Cells(1, col.Column).Value\n\n    For Each rw In sh1.Rows\n        If sh1.Cells(rw.row, 50).Value = \"\" Then\n            Exit For\n        End If\n\n        If sh1.Cells(rw.row, 50) = wk And sh1.Cells(rw.row, 20) = 1 Then\n            T = T + 1\n        End If\n\n        If sh1.Cells(rw.row, 50) = wk And sh1.Cells(rw.row, 21) = 0 Then\n            U = U + 1\n        End If\n    Next rw\n\nsh2.Cells(2, col.Column) = T 'put counters into 2nd and 3rd row under each week, you can adjust this to put the number in a different cell.\nsh2.Cells(3, col.Column) = U\n\nT = 0 'reset counters to start looking at next week.\nU = 0\n\nNext col\n\nEnd Sub\n</code></pre>\n\n<p>For some reason I wasn't able to view the images that you just uploaded.  You may have to adjust my code to adapt to the specifics of your excel file.  It will be good VBA practice for you.  My code assumes the sheet2 has the week numbers going across the columns without any blank cells in between them.  The vba drops the code in the 2nd and 3rd row under the corresponding week number.  You can change this by changing the code that is indicated in the comments.</p>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1019, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498665972, "creation_date": 1498660625, "last_edit_date": 1498664139, "question_id": 44805589, "link": "https://stackoverflow.com/questions/44805589/vba-to-count-the-value-in-column-and-fill-the-table-in-another-sheet", "title": "VBA to Count the value in column and fill the table in another sheet", "body": "<p>I am having two Sheets , sheet1 and sheet2.</p>\n\n<p>I have a table with the weekno, delay , Ok, percenatage of Delay and Percentage of OK. </p>\n\n<p>In sheet 1, i am looking for the column T, and Count the number of '1' in the column. Similarly i look for column U and Count the number of '0' in the column. </p>\n\n<p>the Count value has to be filled in sheet2 of the table looking into the week. I have my week in the column AX of sheet1. </p>\n\n<p>I used formula like Countif for calculating the number of 1 in both the column. \ncould someone guide me how we can do it in VBA, to Count the value in column and pasting the result in a table in another sheet.I am struck how to start with coding. This is my sheet1, i have to Count the number of 1 in column t and u\n<a href=\"https://i.stack.imgur.com/EAPCf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EAPCf.png\" alt=\"resembels sheet1 , where I Need to Count the 1&#39;s in column T and U. checking the week.\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Qj0Sg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Qj0Sg.png\" alt=\"sheet2, where the Count value has to be entered in the table according to the week and calculate its percentage\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 2, "creation_date": 1498660356, "post_id": 44805452, "comment_id": 76590902, "body": "Do you have a sheet that is called, <i>exactly</i>, &quot;In-Transit&quot;?"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1498660492, "post_id": 44805452, "comment_id": 76591012, "body": "Check this: <a href=\"https://msdn.microsoft.com/en-us/library/aa264519(v=vs.60).aspx\" rel=\"nofollow noreferrer\">Subscript out of range (Error 9)</a> to resolve your issue."}, {"owner": {"reputation": 1, "user_id": 7605905, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457439330967439/picture?type=large", "display_name": "Vinod Patil", "link": "https://stackoverflow.com/users/7605905/vinod-patil"}, "edited": false, "score": 0, "creation_date": 1498660591, "post_id": 44805452, "comment_id": 76591084, "body": "Yes I do have the Sheet Named In-Transit in the target file"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7605905, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457439330967439/picture?type=large", "display_name": "Vinod Patil", "link": "https://stackoverflow.com/users/7605905/vinod-patil"}, "edited": false, "score": 0, "creation_date": 1498662780, "post_id": 44805731, "comment_id": 76592798, "body": "Thank you so much for your inputs the error has caught &amp; corrected the code."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1498661009, "creation_date": 1498661009, "answer_id": 44805731, "question_id": 44805452, "link": "https://stackoverflow.com/questions/44805452/vba-error-run-time-error-9-subscript-out-of-range/44805731#44805731", "title": "VBA Error Run time error 9 Subscript Out of range", "body": "<p>We are dealing with <strong>two</strong> workbooks:</p>\n\n<ol>\n<li>the workbook containing the macro <em>(wb1)</em></li>\n<li>the workbook opened by the macro <em>(wb2)</em></li>\n</ol>\n\n<p>Once <em>wb2</em> has been opened, it becomes the <code>Active</code> workbook and the line:</p>\n\n<pre><code>Sheets(\"In-Transit\").Select\n</code></pre>\n\n<p>will only work if that sheet is in <em>wb2</em>.  If the sheet is in the original workbook <em>(wb1)</em>, that workbook must be re-activated beforre the sheet can be <code>Selected</code>.  Also make sure that there are no extra spaces in the sheetname.</p>\n"}], "owner": {"reputation": 1, "user_id": 7605905, "user_type": "registered", "profile_image": "https://graph.facebook.com/1457439330967439/picture?type=large", "display_name": "Vinod Patil", "link": "https://stackoverflow.com/users/7605905/vinod-patil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498661009, "creation_date": 1498660227, "last_edit_date": 1498660292, "question_id": 44805452, "link": "https://stackoverflow.com/questions/44805452/vba-error-run-time-error-9-subscript-out-of-range", "title": "VBA Error Run time error 9 Subscript Out of range", "body": "<p>I am getting Run time error 9</p>\n\n<pre><code>Sub Conway()\nDim aRng As Range\nDim Data As Range, c As Collection\nDim v As String, i As Long, ary\nSet c = New Collection\n    Path = \"D:\\InTransit DR Report\\\"\n    RawFile = Application.GetOpenFilename(, , \"Please Select InTransit Raw WorkBook:\")\n    Application.DisplayAlerts = False\n    If RawFile = \"False\" Then\n        MsgBox \"Please select appropriate Final Output file\", vbCritical, \"Nike InTransit DR Automation\"\n        Exit Sub\n    Else\n        Workbooks.Open RawFile, True, False\n    Application.Wait (10)\n    Application.Visible = False\n    Application.Visible = True\n    Application.WindowState = xlMaximized\n    ActiveWindow.WindowState = xlMaximized\n    End If\n    Sheets(\"In-Transit\").Select 'Getting error here\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1498660096, "post_id": 44805328, "comment_id": 76590716, "body": "Do you have a Worksheet, named <code>Sheet1</code>?"}, {"owner": {"reputation": 13, "user_id": 8226664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734fb67e4ffa3ee69fca15a137c149ed?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/8226664/wayne"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1498660760, "post_id": 44805328, "comment_id": 76591225, "body": "Yes, I&#39;ve left Sheet1 in the sourceWB.  Manually opening that workbook confirms Sheet1 exists and the values I&#39;m writing to cells A1 and B1 are there."}, {"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1498661045, "post_id": 44805328, "comment_id": 76591435, "body": "From your code i understand that you are using a macro that will open and excel and then you want to delete something from the excel you just opened. If my assumption it&#39;s correct you need to declare the new excel.  Try something like this :Application.DisplayStatusBar = False     Dim xl As New Excel.Application     xl.Workbooks.Open (Worksheets(&quot;MAIN&quot;).Range(&quot;B7&quot;).Value)     xl.Visible = True     With xl         Worksheets(&quot;something&quot;).Range(&quot;A1&quot;).clear         Worksheets(&quot;something&quot;).Range(&quot;A1&quot;).clear     End With"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1498660234, "creation_date": 1498660234, "answer_id": 44805455, "question_id": 44805328, "link": "https://stackoverflow.com/questions/44805328/attempting-to-clear-the-values-in-two-cells-in-a-different-workbook-when-i-close/44805455#44805455", "title": "Attempting to clear the values in two cells in a different workbook when I close the workbook. Run-time 91 error", "body": "<p>Try to run the following code until you can do it without an error:</p>\n\n<pre><code>Sub TestClear()\n\n    Dim SourceWb        As Workbook\n    Dim myWS            As Worksheet\n\n    Set SourceWb = ThisWorkbook\n    Set myWS = SourceWb.Worksheets(\"Sheet1\")\n\n    Debug.Print myWS.Name\n\nEnd Sub\n</code></pre>\n\n<p>Probably the error is in the way you use <code>SourceWb</code> or you do not have <code>Sheet1</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8226664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734fb67e4ffa3ee69fca15a137c149ed?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/8226664/wayne"}, "edited": false, "score": 1, "creation_date": 1498661558, "post_id": 44805685, "comment_id": 76591830, "body": "That was it.  Thank you for your assistance!"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 0, "last_activity_date": 1498660882, "creation_date": 1498660882, "answer_id": 44805685, "question_id": 44805328, "link": "https://stackoverflow.com/questions/44805328/attempting-to-clear-the-values-in-two-cells-in-a-different-workbook-when-i-close/44805685#44805685", "title": "Attempting to clear the values in two cells in a different workbook when I close the workbook. Run-time 91 error", "body": "<p>You are victim of a re-entrant, theoretically never-ending routine. <strong>Without disabling events</strong>, inside <code>Workbook_BeforeClose</code>, you call <code>ThisWorkbook.Close</code>  which will again cause <code>Workbook_BeforeClose</code> to be invoked, then again and again. This causes <strong>undefined behavior</strong> (probably a <em>StackOverfow</em>!)</p>\n\n<p>Quick-fix: disable events:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    Application.EnableEvents = False '&lt;------- To avoid re-entance\n    On Error Resume Next\n    TestClear\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8226664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734fb67e4ffa3ee69fca15a137c149ed?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/8226664/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 44805685, "answer_count": 2, "score": 1, "last_activity_date": 1498661084, "creation_date": 1498659901, "last_edit_date": 1498661084, "question_id": 44805328, "link": "https://stackoverflow.com/questions/44805328/attempting-to-clear-the-values-in-two-cells-in-a-different-workbook-when-i-close", "title": "Attempting to clear the values in two cells in a different workbook when I close the workbook. Run-time 91 error", "body": "<p>I'm attempting to clear the values in two cells in a different workbook when I close the workbook I'm actively using.  When I close my workbook I receive the following error:</p>\n\n<blockquote>\n  <p>Run-time error '91': Object variable or With block variable not set</p>\n</blockquote>\n\n<p>Using debug and stepping through I can find the line where I receive the error but for the life of me I'm not seeing what I'm missing.</p>\n\n<p>I call my macro from:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    TestClear\n\nEnd Sub\n\nSub TestClear()\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Dim SourceWb As Workbook, myWS As Worksheet\n\n    Set SourceWb = Workbooks.Open(\"Workbook file location, in this case it's on a network share\")\n    Set myWS = SourceWb.Sheets(\"Sheet1\") &lt;---- Here is where I receive the Run-Time error    '91'\n\n    myWS.Range(\"A1\").Clear\n    myWS.Range(\"B1\").Clear\n\n    SourceWb.Close SaveChanges:=1\n    ThisWorkbook.Close SaveChanges:=1\n\n    Application.ScreenUpdating = True\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "search"], "comments": [{"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1498659036, "post_id": 44804731, "comment_id": 76589833, "body": "In this instance you may need Criteria1:=&quot;<i>&quot; &amp; sht.Shapes(&quot;CountrySearch&quot;).TextFrame.Characters.Text &amp; &quot;</i>&quot;"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 1, "creation_date": 1498659195, "post_id": 44804731, "comment_id": 76589949, "body": "What exactly do you mean by an approximate match?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1498659974, "post_id": 44804731, "comment_id": 76590610, "body": "It depends on the type of match you want:  <a href=\"https://stackoverflow.com/questions/491148/best-fuzzy-matching-algorithm\" title=\"best fuzzy matching algorithm\">stackoverflow.com/questions/491148/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1498660569, "creation_date": 1498660569, "answer_id": 44805569, "question_id": 44804731, "link": "https://stackoverflow.com/questions/44804731/wrote-a-macro-search-that-needs-approximate-match-instead-of-exact/44805569#44805569", "title": "Wrote a Macro Search that needs approximate match instead of exact", "body": "<p>Try changing Criteria1 to this</p>\n\n<p>if it's searching for a string:</p>\n\n<blockquote>\n  <p>Criteria1:= <strong>\"*\" &amp;</strong> sht.Shapes(\"CountrySearch\").TextFrame.Characters.Text <strong>&amp; \"*\"</strong></p>\n</blockquote>\n\n<p>or, if you have numbers</p>\n\n<blockquote>\n  <p>Criteria1:= <strong>\">=\"</strong> &amp; sht.Shapes(\"CountrySearch\").TextFrame.Characters.Text</p>\n</blockquote>\n"}], "owner": {"reputation": 31, "user_id": 8226564, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/20d586d4631d139310d72aac42922e5b?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/8226564/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1498661106, "creation_date": 1498658519, "last_edit_date": 1498661106, "question_id": 44804731, "link": "https://stackoverflow.com/questions/44804731/wrote-a-macro-search-that-needs-approximate-match-instead-of-exact", "title": "Wrote a Macro Search that needs approximate match instead of exact", "body": "<p>I wrote a macro to search through a filter for an exact match in column A and it needs an approximate match for a search in column B. Right now I only have it as an exact match, and I need help making it an approximate match code.  Below is my code:</p>\n\n<pre><code>Sub SearchBox1()\n\nDim myButton As OptionButton\nDim MyVal As Long\nDim sht As Worksheet\nDim myField As Long\nDim DataRange As Range\nDim mySearch As Variant\n\n'Load Sheet into A Variable\n Set sht = ActiveSheet\n\n'Unfilter Data (if necessary)\n On Error Resume Next\n    sht.ShowAllData\n On Error GoTo 0\n\n 'Filtered Data Range (include column heading cells)\n  ActiveSheet.Range(\"$A50:$L$130\").AutoFilter Field:=2, Criteria1:=sht.Shapes(\"CountrySearch\").TextFrame.Characters.Text\n  Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1498658712, "post_id": 44804574, "comment_id": 76589577, "body": "Yes, there&#39;s a way to connect MS Access database with Excel. See: <a href=\"https://support.office.com/en-us/article/Connect-to-an-Access-database-a3d6500c-4bec-40ce-8cdf-fb4edb723525\" rel=\"nofollow noreferrer\">Connect to an Access database</a>"}, {"owner": {"reputation": 1, "user_id": 8226499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2742e34d2182470039ad5e3c05e4f6fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley Y", "link": "https://stackoverflow.com/users/8226499/ashley-y"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1498658991, "post_id": 44804574, "comment_id": 76589796, "body": "@MaciejLos When I do this, the tables I&#39;m trying to import don&#39;t come up as options to select (I believed because they are linked tables?)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1498659010, "post_id": 44804574, "comment_id": 76589813, "body": "Using an excel sheet as a linked table is pretty nifty for a lot of reasons. Though I would consider data integrity and risk of getting bad data before going down this route - or having a slew of decent validations"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1498661185, "post_id": 44804574, "comment_id": 76591529, "body": "It seems to over 65000 row after 2007.  I test 240000 row. It is possible. but needs long times."}, {"owner": {"reputation": 1255, "user_id": 3103059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ace5267f00efbd4a9a1d6af5beefd00?s=128&d=identicon&r=PG&f=1", "display_name": "agcala", "link": "https://stackoverflow.com/users/3103059/agcala"}, "edited": false, "score": 0, "creation_date": 1547897706, "post_id": 44804574, "comment_id": 95356686, "body": "@Ashley See my answer."}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": false, "score": 1, "last_activity_date": 1498659338, "creation_date": 1498659338, "answer_id": 44805071, "question_id": 44804574, "link": "https://stackoverflow.com/questions/44804574/linking-an-access-database-to-excel-without-importing-the-whole-table/44805071#44805071", "title": "linking an access database to excel (without importing the whole table)", "body": "<p>See this ancient article, which should help you get the data you actually need rather than everything:</p>\n\n<p><a href=\"http://dailydoseofexcel.com/archives/2004/12/13/parameters-in-excel-external-data-queries/\" rel=\"nofollow noreferrer\">http://dailydoseofexcel.com/archives/2004/12/13/parameters-in-excel-external-data-queries/</a></p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1498668014, "creation_date": 1498668014, "answer_id": 44808237, "question_id": 44804574, "link": "https://stackoverflow.com/questions/44804574/linking-an-access-database-to-excel-without-importing-the-whole-table/44808237#44808237", "title": "linking an access database to excel (without importing the whole table)", "body": "<p>Try the following script.  This should give you what you want.</p>\n\n<pre><code>Option Compare Database\n\nPrivate Sub Command0_Click()\n\nDim InputFile As String\nDim InputPath As String\n\nInputPath = \"C:\\your_path_here\\Desktop\\\"\nInputFile = Dir(InputPath &amp; \"*.xlsx\")\n\nDo While InputFile &lt;&gt; \"\"\n\n    DoCmd.TransferSpreadsheet acLink, , InputFile, InputPath &amp; InputFile, True '&lt; The true is for column headers\n    InputFile = Dir\nLoop\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1255, "user_id": 3103059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ace5267f00efbd4a9a1d6af5beefd00?s=128&d=identicon&r=PG&f=1", "display_name": "agcala", "link": "https://stackoverflow.com/users/3103059/agcala"}, "is_accepted": false, "score": 0, "last_activity_date": 1547915286, "last_edit_date": 1547915286, "creation_date": 1547897328, "answer_id": 54266607, "question_id": 44804574, "link": "https://stackoverflow.com/questions/44804574/linking-an-access-database-to-excel-without-importing-the-whole-table/54266607#54266607", "title": "linking an access database to excel (without importing the whole table)", "body": "<p><strong>You can work with Access database tables from Excel without importing the table into an Excel worksheet:</strong></p>\n\n<pre><code>Dim cnn As ADODB.Connection  ' Needs a reference to the Microsoft ActiveX                         \nDim rs  As ADODB.Recordset   ' Data Objects Library\n\nSet cnn = CreateObject(\"ADODB.Connection\") \ncnn.Open \"DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=database-path\\Data.accdb;\"\nSet rs = cnn.Execute(\"SELECT * FROM MyTable\")\nWhile Not rs.EOF\n  Debug.Print rs(1)\n  rs.MoveNext\nWend\n</code></pre>\n\n<p>You may need the <a href=\"https://www.microsoft.com/en-us/download/confirmation.aspx?id=13255\" rel=\"nofollow noreferrer\"> Microsoft Access Database Engine 2010 Redistributable</a> which you should install with the <strong>/passive</strong> option if you are using a x86 Access version on a x64 OS.</p>\n"}], "owner": {"reputation": 1, "user_id": 8226499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2742e34d2182470039ad5e3c05e4f6fe?s=128&d=identicon&r=PG&f=1", "display_name": "Ashley Y", "link": "https://stackoverflow.com/users/8226499/ashley-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4787, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1547915286, "creation_date": 1498658179, "last_edit_date": 1531161705, "question_id": 44804574, "link": "https://stackoverflow.com/questions/44804574/linking-an-access-database-to-excel-without-importing-the-whole-table", "title": "linking an access database to excel (without importing the whole table)", "body": "<p>Is there any way to link tables in an Access database to Excel without importing the entire table? I need to reference/lookup cells in the Access table but don't want to import the whole table into the excel workbook (tables are too big). </p>\n\n<p>My second option is to export the Access tables into a separate excel workbook, then just reference this new workbook instead of the Access database itself. When I try to do this only around 65,000 rows of data from any Access table actually export to Excel, as the rest 'couldn't be copied to the clipboard'. Is there a simple way around this? (I want to actually have a connection between the excel/access files, so the data can be refreshed, not just copy and paste the rows over)</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498658533, "post_id": 44804672, "comment_id": 76589421, "body": "No it doesnt work. (forgot some <b>s</b> somewhere<b>s</b>. :D"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498658568, "post_id": 44804672, "comment_id": 76589441, "body": "@A.S.H I added Worksheet(1) later, initially it was with the original names of my Excel :D"}, {"owner": {"reputation": 15, "user_id": 8164942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178ad9eab50ba7856d5d3d7812a1b771?s=128&d=identicon&r=PG&f=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/8164942/johan"}, "edited": false, "score": 1, "creation_date": 1498659550, "post_id": 44804672, "comment_id": 76590256, "body": "Thank you! Indeed that was the problem. z was a string instead of an integer."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 15, "user_id": 8164942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178ad9eab50ba7856d5d3d7812a1b771?s=128&d=identicon&r=PG&f=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/8164942/johan"}, "edited": false, "score": 1, "creation_date": 1498659657, "post_id": 44804672, "comment_id": 76590346, "body": "@Johan the take-away is &quot;declare all your variables with an explicit type, and use meaningful names&quot;. <code>z</code> doesn&#39;t mean anything. Also FWIW you don&#39;t want to use an <code>Integer</code> for anything that means to represent a row number. Use a <code>Long</code> instead, lest you run into overflow errors one day or another."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1498658572, "last_edit_date": 1498658572, "creation_date": 1498658387, "answer_id": 44804672, "question_id": 44804510, "link": "https://stackoverflow.com/questions/44804510/error-13-type-mismatch-copy-paste/44804672#44804672", "title": "error 13 type mismatch copy paste", "body": "<p>I think the problem is in the value of <code>z</code>.\nI have tried to following, it works:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Worksheets(1).Range(\"A10:M19\").Copy\n    Worksheets(2).Range(\"A1:M10\").Offset(1, 0).PasteSpecial xlPasteFormats\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8164942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178ad9eab50ba7856d5d3d7812a1b771?s=128&d=identicon&r=PG&f=1", "display_name": "Johan", "link": "https://stackoverflow.com/users/8164942/johan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 44804672, "answer_count": 1, "score": 1, "last_activity_date": 1498659066, "creation_date": 1498658011, "last_edit_date": 1531164843, "question_id": 44804510, "link": "https://stackoverflow.com/questions/44804510/error-13-type-mismatch-copy-paste", "title": "error 13 type mismatch copy paste", "body": "<p>I have a code, where I changed some values. Now I have the following error: error 13, type do not match. The error is pointing is this direction:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"AS\").Range(\"A10:M19\").Copy\nThisWorkbook.Sheets(\"InvoerIO\").Range(\"A1:M10\").Offset(z, 0).PasteSpecial xlPasteFormats \n</code></pre>\n\n<p>What could be the problem?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8226505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6055e381082d9944d226bc28b06ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Hadland", "link": "https://stackoverflow.com/users/8226505/darren-hadland"}, "edited": false, "score": 1, "creation_date": 1498718787, "post_id": 44805209, "comment_id": 76616151, "body": "Fantastic, this worked a dream. Thank you for the help Batman."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 15, "user_id": 8226505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6055e381082d9944d226bc28b06ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Hadland", "link": "https://stackoverflow.com/users/8226505/darren-hadland"}, "edited": false, "score": 0, "creation_date": 1498839742, "post_id": 44805209, "comment_id": 76682729, "body": "@DarrenHadland - Just to note too - if you&#39;re ever going through a sheet and deleting rows, it&#39;s always best to start at the end and step backwards.  Otherwise, if you go forwards, when you delete a row, the next <code>i</code> would be the <b>next</b> row...since the rows move up when you delete, it&#39;ll effectively skip a row.  ...does that make sense? That&#39;s why I did <code>for i = endRow to 3 Step -1</code>, instead of <code>for i = 3 to endRow</code>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1498659657, "creation_date": 1498659657, "answer_id": 44805209, "question_id": 44804492, "link": "https://stackoverflow.com/questions/44804492/if-cell-closed-project-cut-cell-and-past-into-projects-closed-worksheet-on/44805209#44805209", "title": "If cell = closed project, cut cell and past into &quot;Projects closed&quot; worksheet on next available row", "body": "<p>If you're going to cut rows, and don't want an empty row left, try this instead:</p>\n\n<pre><code>For i = endrow To 3 Step -1\n    If ASR.Cells(i, \"C\").Value = \"Project Closed\" Then\n           ASR.Cells(i, \"C\").EntireRow.Copy Destination:=LS.Range(\"A\" &amp; LS.Rows.Count).End(xlUp).Offset(1)\n           ASR.Cells(i, \"C\").EntireRow.Delete\n    End If\nNext\n</code></pre>\n\n<p>This should go through the ASR sheet, copy any matches, then remove that row and continue onwards.</p>\n"}], "owner": {"reputation": 15, "user_id": 8226505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6055e381082d9944d226bc28b06ce6?s=128&d=identicon&r=PG&f=1", "display_name": "Darren Hadland", "link": "https://stackoverflow.com/users/8226505/darren-hadland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 44805209, "answer_count": 1, "score": 0, "last_activity_date": 1498659657, "creation_date": 1498657982, "question_id": 44804492, "link": "https://stackoverflow.com/questions/44804492/if-cell-closed-project-cut-cell-and-past-into-projects-closed-worksheet-on", "title": "If cell = closed project, cut cell and past into &quot;Projects closed&quot; worksheet on next available row", "body": "<p>Currently working on a spread sheet to track work progress. row \"C\" has a drop down from cells C12:C3000, if this is selected to \"Project closed\" I need to row to be cut and paste to the worksheet \"Project closed\" with no empty row left once the row is cut. </p>\n\n<p>I have come across this VBA code and adapted it to my own use. but to no avail. I am very new to the world of VBA so not sure I've done it right.</p>\n\n<p>Sub cut_paste()\n    Dim i As Variant\n    Dim endrow As Integer\n    Dim ASR As Worksheet, LS As Worksheet</p>\n\n<pre><code>Set ASR = ActiveWorkbook.Sheets(\"In Progress\")\nSet LS = ActiveWorkbook.Sheets(\"Project Closed\")\n\nendrow = ASR.Range(\"A\" &amp; ASR.Rows.Count).End(xlUp).Row\n\nFor i = 3 To endrow\n    If ASR.Cells(i, \"C\").Value = \"Project Closed\" Then\n       ASR.Cells(i, \"C\").EntireRow.cut Destination:=LS.Range(\"A\" &amp; LS.Rows.Count).End(xlUp).Offset(1)\n    End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "excel", "search"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1498659416, "post_id": 44804462, "comment_id": 76590150, "body": "Before that line, you never give <code>searchColumn</code> a value, so it doesn&#39;t have a value for that.  Also, what kind of range are you searching? You may need to do <code>...Range(searchColumn &amp; &quot;:&quot; &amp; j + 1).Value</code>, if <code>searchColumn</code> is going to be a letter, like <code>A</code>, <code>B</code>, etc..."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 2, "creation_date": 1498659470, "post_id": 44804462, "comment_id": 76590195, "body": "You&#39;re after the <code>FindAll</code> functionality as built and described by Chip Pearson <a href=\"http://www.cpearson.com/excel/FindAll.aspx\" rel=\"nofollow noreferrer\">here</a> and also written about by Ron de Bruin <a href=\"https://www.rondebruin.nl/win/s9/win006.htm\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 75, "user_id": 8167828, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/303095b0b9f6e9fd355283bc7c2e11d5?s=128&d=identicon&r=PG&f=1", "display_name": "Caleb Sutton", "link": "https://stackoverflow.com/users/8167828/caleb-sutton"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498660456, "post_id": 44804462, "comment_id": 76590981, "body": "@BruceWayne I changed somethings around above. I meant to change anything that is &quot;searchColumn&quot; to &quot;searchRange&quot; because since I am searching the entire workbook, im not just searching a specific column on each page. I don&#39;t know if this will change your answer or not. I also am now having a &quot;Type mismatch&quot; error at &quot;searchRange = Columns(&quot;A:J&quot;)&quot;."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1498661507, "post_id": 44804462, "comment_id": 76591798, "body": "@CalebSutton doing <code>searchRange</code> as a string mainly complicates things...first you would just want <code>searchRange = &quot;A:J&quot;</code>. ...but even still <code>...Range(searchRange &amp; j + 2)</code> doesn&#39;t make sense..."}], "answers": [{"tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 1, "last_activity_date": 1498659418, "creation_date": 1498659418, "answer_id": 44805105, "question_id": 44804462, "link": "https://stackoverflow.com/questions/44804462/search-an-entire-workbook-with-vba/44805105#44805105", "title": "Search an entire workbook with VBA", "body": "<p>this is something quick and dirty that will describe how to easily search all</p>\n\n<pre><code> this = ComboBox2.Value\n dim arr() as variant\n arr = thisworkbook.sheets(\"yoursheet\").usedrange\n for i = lbound(arr,1) to ubound(arr,1)\n      for j = lbound(arr,2) to ubound(arr,2)\n           if arr(i,j) = this then\n                'code for found item\n           end if\n      next j\n next i\n</code></pre>\n\n<p>I know you are already kind of doing this, but I thought it was worth pointing out that it could be done in a much simpler fashion. </p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 8167828, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/303095b0b9f6e9fd355283bc7c2e11d5?s=128&d=identicon&r=PG&f=1", "display_name": "Caleb Sutton", "link": "https://stackoverflow.com/users/8167828/caleb-sutton"}, "is_accepted": false, "score": 0, "last_activity_date": 1498668080, "creation_date": 1498668080, "answer_id": 44808258, "question_id": 44804462, "link": "https://stackoverflow.com/questions/44804462/search-an-entire-workbook-with-vba/44808258#44808258", "title": "Search an entire workbook with VBA", "body": "<p>This is the code that I recieved that solved my problem. </p>\n\n<pre><code>Sub FindOne()\n\n    Range(\"B19:J5000\") = \"\"\n\n    Application.ScreenUpdating = False\n\n    Dim k As Integer, EndPasteLoopa As Integer, searchColumn As Integer, searchAllCount As Integer\n    Dim myText As String\n    Dim totalValues As Long\n    Dim nextCell As Range\n    Dim searchAllCheck As Boolean\n\n    k = ThisWorkbook.Worksheets.Count\n    myText = ComboBox1.Value\n    Set nextCell = Range(\"B20\")\n    If myText = \"\" Then\n        MsgBox \"No Address Found\"\n        Exit Sub\n    End If\n\n    Select Case ComboBox2.Value\n        Case \"SEARCH ALL\"\n            searchAllCheck = True\n        Case \"EQUIPMENT NUMBER\"\n            searchColumn = 1\n        Case \"EQUIPMENT DESCRIPTION\"\n            searchColumn = 3\n        Case \"DUPONT NUMBER\"\n            searchColumn = 6\n        Case \"SAP NUMBER\"\n            searchColumn = 7\n        Case \"SSI NUMBER\"\n            searchColumn = 8\n        Case \"PART DESCRIPTION\"\n            searchColumn = 9\n        Case \"\"\n            MsgBox \"Please select a value for what you are searching by.\"\n    End Select\n\n    For I = 2 To k\n        totalValues = Sheets(I).Cells(Rows.Count, \"A\").End(xlUp).Row\n        ReDim AddressArray(totalValues) As String\n\n        If searchAllCheck Then\n            searchAllCount = 5\n            searchColumn = 1\n        Else\n            searchAllCount = 0\n        End If\n\n        For qwerty = 0 To searchAllCount\n            If searchAllCount Then\n                Select Case qwerty\n                    Case \"1\"\n                        searchColumn = 3\n                    Case \"2\"\n                        searchColumn = 6\n                    Case \"3\"\n                        searchColumn = 7\n                    Case \"4\"\n                        searchColumn = 8\n                    Case \"5\"\n                        searchColumn = 9\n                End Select\n            End If\n\n            For j = 0 To totalValues\n                AddressArray(j) = Sheets(I).Cells(j + 1, searchColumn).Value\n            Next j\n\n            For j = 0 To totalValues\n                If InStr(1, AddressArray(j), myText) &gt; 0 Then\n                    EndPasteLoop = 1\n                    If (Sheets(I).Cells(j + 2, searchColumn).Value = \"\") Then EndPasteLoop = Sheets(I).Cells(j + 1, searchColumn).End(xlDown).Row - j - 1\n                    For r = 1 To EndPasteLoop\n                        Range(nextCell, nextCell.Offset(0, 8)).Value = Sheets(I).Range(\"A\" &amp; j + r, \"I\" &amp; j + r).Value\n                        Set nextCell = nextCell.Offset(1, 0)\n                    Next r\n                End If\n            Next j\n        Next qwerty\n    Next I\n    Debug.Print tc\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 8167828, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/303095b0b9f6e9fd355283bc7c2e11d5?s=128&d=identicon&r=PG&f=1", "display_name": "Caleb Sutton", "link": "https://stackoverflow.com/users/8167828/caleb-sutton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1512, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1498668080, "creation_date": 1498657908, "last_edit_date": 1498660304, "question_id": 44804462, "link": "https://stackoverflow.com/questions/44804462/search-an-entire-workbook-with-vba", "title": "Search an entire workbook with VBA", "body": "<p>I have a part database that I need to search through to find whatever is searched for. I created a search page that gives the options to search specific columns or search in every column. It then prints the information that it finds out on the search page. I have the search via column part done, but I am struggling with the search all part. I keep getting an error 1004 at the line \"AddressArray(j) = Sheets(i).Range(searchColumn &amp; j + 1).Value\". I assume that it has something to do with that line is looking to only search columns and not an entire workbook, but I don't know how to fix it. </p>\n\n<p>Here is the code</p>\n\n<pre><code>Sub FindAll()\n\nRange(\"B19:J1500\") = \"\"\n\n    Application.ScreenUpdating = False\n\n    Dim k As Integer, EndPasteLoopa As Integer\n    Dim myText As String, searchRange As String\n    Dim totalValues As Long\n    Dim nextCell As Range\n\n    k = ThisWorkbook.Worksheets.Count\n    myText = ComboBox1.Value\n    Set nextCell = Range(\"B20\")\n    If myText = \"\" Then\n        MsgBox \"No Address Found\"\n        Exit Sub\n    End If\n\n    Select Case ComboBox2.Value\n        Case \"SEARCH ALL\"\n            searchRange = Columns(\"A:J\")\n    End Select\n\n    For i = 2 To k\n        totalValues = Sheets(i).Cells(Rows.Count, \"A\").End(xlUp).Row\n        ReDim AddressArray(totalValues) As String\n\n        For j = 0 To totalValues\n            AddressArray(j) = Sheets(i).Range(searchRange &amp; j + 1).Value\n        Next j\n\n        For j = 0 To totalValues\n            If InStr(1, AddressArray(j), myText) &gt; 0 Then\n                EndPasteLoop = 1\n                If (Sheets(i).Range(searchRange &amp; j + 2).Value = \"\") Then EndPasteLoop = Sheets(i).Range(searchRange &amp; j + 1).End(xlDown).Row - j - 1\n                For r = 1 To EndPasteLoop\n                    Range(nextCell, nextCell.Offset(0, 8)).Value = Sheets(i).Range(\"A\" &amp; j + r, \"I\" &amp; j + r).Value\n                    Set nextCell = nextCell.Offset(1, 0)\n                Next r\n            End If\n        Next j\n    Next i\n    Debug.Print tc\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498663341, "post_id": 44804342, "comment_id": 76593254, "body": "See @Shai Rado&#39;s answer. Your code IS looping through all the sheets, but it is doing the same code again on the activated ws because you did not fully specify what cells you were referring to, so it assumed the same active sheet."}], "answers": [{"comments": [{"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498658665, "post_id": 44804654, "comment_id": 76589528, "body": "Why did this answer get downvoted? It looks correct to me. What am I missing?"}, {"owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "reply_to_user": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498658759, "post_id": 44804654, "comment_id": 76589609, "body": "I got downvoted 1 min after posting. The guy didn&#39;t even try the code..."}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498658886, "post_id": 44804654, "comment_id": 76589714, "body": "The OP didn&#39;t downvote you. He doesn&#39;t have enough reputation for that. Someone else did."}, {"owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "reply_to_user": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498659148, "post_id": 44804654, "comment_id": 76589908, "body": "Yes i know that but whoever did it, he did it without any reason and he did not take the time to evaluate my answer... it&#39;s kind disapointing.. I&#39;m trying really hard to reach that glorious 50 rep and I get these kinds of treatment :P"}], "tags": [], "owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "is_accepted": false, "score": 0, "last_activity_date": 1498658343, "creation_date": 1498658343, "answer_id": 44804654, "question_id": 44804342, "link": "https://stackoverflow.com/questions/44804342/excel-vba-loop-through-the-spreadsheets-and-preform-another-loop/44804654#44804654", "title": "Excel VBA - Loop through the spreadsheets and preform another loop", "body": "<p>I use this to loop through my worksheet :</p>\n\n<pre><code>     For i = 1 To ActiveWorkbook.Worksheets.Count\n       ActiveWorkbook.Worksheets(i)\n       'adapt your code into that\n     Next i\n</code></pre>\n\n<p>It may work better for you</p>\n"}, {"comments": [{"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498663371, "post_id": 44804981, "comment_id": 76593279, "body": "This will work, however it is best practice to avoid using <code>.Activate</code> if you can avoid it."}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "reply_to_user": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498667235, "post_id": 44804981, "comment_id": 76596042, "body": "@SandPiper Agreed.  Do you know of how you could avoid this without using &#39;with&#39;?"}, {"owner": {"reputation": 2524, "user_id": 6186333, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/ad477c5a0eb77e7fca29602b23db102f?s=128&d=identicon&r=PG&f=1", "display_name": "SandPiper", "link": "https://stackoverflow.com/users/6186333/sandpiper"}, "edited": false, "score": 0, "creation_date": 1498667357, "post_id": 44804981, "comment_id": 76596117, "body": "Use a for loop instead, then replace <code>WITH</code> with <code>ActiveWorkbook.Worksheets(i).Cells(...)</code>"}], "tags": [], "owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "is_accepted": false, "score": 0, "last_activity_date": 1498660137, "last_edit_date": 1498660137, "creation_date": 1498659144, "answer_id": 44804981, "question_id": 44804342, "link": "https://stackoverflow.com/questions/44804342/excel-vba-loop-through-the-spreadsheets-and-preform-another-loop/44804981#44804981", "title": "Excel VBA - Loop through the spreadsheets and preform another loop", "body": "<p>You have to tell the vba to select the next worksheet.  Right now it is looping through the number of worksheets you have, but since there is nothing in the code that activates the next worksheets it just loops on the first one.  Try this:</p>\n\n<pre><code>Sub Hours()\nDim ws As Worksheet\nDim I As Integer\n\n    For Each ws In ActiveWorkbook.Worksheets\n        ws.Activate\n        For I = 6 To 21\n\n            k = I + 1\n\n            If Cells(k, 7).Value = \"\" Then\n\n            ElseIf Cells(I, 8).Value &lt;&gt; Cells(k, 7) Then\n                 Cells(I, 8).Font.Color = vbRed\n                 Cells(k, 7).Font.Color = vbRed\n            End If\n        Next I\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Just to give you a little extra information, I usually use this code to handle looping through worksheets:</p>\n\n<pre><code>sub example()\nws = ThisWorkbook.Worksheets.Count\nfor i = 1 to ws\n'other code\nnext i\nend sub\n</code></pre>\n\n<p>What I like about this way of doing it is that I have more flexibility to not necessarily loop through all worksheets.  Often I don't want to execute a process on the first or last worksheet.  To accomplish that I can adjust the for statement like this:</p>\n\n<pre><code>'to not loop through the last worksheet\nfor i = 1 to ws - 1\n\n'to not loop through the first worksheet\nfor i = 2 to ws\n</code></pre>\n\n<p>I like this way for more flexibility.  Of course if you want to loop through every worksheet using the <code>for each ws</code> method is simpler since you don't have to define a variable.  I just wanted to expand on the subject.</p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498669884, "post_id": 44805038, "comment_id": 76597666, "body": "@MikeisWright  have you read and tested the code in my answer above ? is it working for you as intended ?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 13, "user_id": 8226326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4d822bdf5af4df999a0ab6f4edeecc?s=128&d=identicon&r=PG&f=1", "display_name": "MikeisWright", "link": "https://stackoverflow.com/users/8226326/mikeiswright"}, "edited": false, "score": 0, "creation_date": 1498670347, "post_id": 44805038, "comment_id": 76597944, "body": "@MikeisWright you&#39;re welcome, now it&#39;s your turn when you mark as &quot;ANSWER&quot; , by clicking the gray check-mark on the left side of my answer (it will turn green)"}, {"owner": {"reputation": 13, "user_id": 8226326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4d822bdf5af4df999a0ab6f4edeecc?s=128&d=identicon&r=PG&f=1", "display_name": "MikeisWright", "link": "https://stackoverflow.com/users/8226326/mikeiswright"}, "edited": false, "score": 0, "creation_date": 1498672248, "post_id": 44805038, "comment_id": 76599061, "body": "Gotcha, never used this website before. Checked it now."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1498659266, "creation_date": 1498659266, "answer_id": 44805038, "question_id": 44804342, "link": "https://stackoverflow.com/questions/44804342/excel-vba-loop-through-the-spreadsheets-and-preform-another-loop/44805038#44805038", "title": "Excel VBA - Loop through the spreadsheets and preform another loop", "body": "<p>Try the code below, use the <code>With ws</code> statement to get all objects, such as <code>Cells</code> qualified with the current <code>Worksheet</code> you are looping through.</p>\n\n<p><strong><em>Code</em></strong></p>\n\n<pre><code>Sub Hours()\n\nDim ws As Worksheet\nDim i As Long, k As Long\n\nFor Each ws In ActiveWorkbook.Worksheets\n    With ws\n        For i = 6 To 21\n            'k = i + 1 ' not needed, just change k to i + 1\n            ' merge 2 Ifs to one using an And\n            If .Cells(i + 1, 7).Value &lt;&gt; \"\" And .Cells(i, 8).Value &lt;&gt; .Cells(i + 1, 7) Then\n                 .Cells(i, 8).Font.Color = vbRed\n                 .Cells(i + 1, 7).Font.Color = vbRed\n            End If\n        Next i\n    End With\nNext ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1498669755, "creation_date": 1498669755, "answer_id": 44808754, "question_id": 44804342, "link": "https://stackoverflow.com/questions/44804342/excel-vba-loop-through-the-spreadsheets-and-preform-another-loop/44808754#44808754", "title": "Excel VBA - Loop through the spreadsheets and preform another loop", "body": "<p>Consider this.</p>\n\n<pre><code>Sub Test1()\n'UpdatebyExtendoffice20161222\n      Dim x As Integer\n      Dim ws As Worksheet\n\n      ' Begin looping through the sheets\n      For Each ws In ActiveWorkbook.Worksheets\n      ws.Select\n        ' Begin looping through the cells\n        ' Set numrows = number of rows of data.\n        NumRows = Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\n        ' Select cell a1.\n        Range(\"A1\").Select\n        ' Establish \"For\" loop to loop \"numrows\" number of times.\n        For x = 1 To NumRows\n           ' Insert your code here.\n           ' Selects cell down 1 row from active cell.\n           ActiveCell.Offset(1, 0).Select\n\n           ' After a blank cells is found, move to the next sheet\n        Next\n\n      Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8226326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e4d822bdf5af4df999a0ab6f4edeecc?s=128&d=identicon&r=PG&f=1", "display_name": "MikeisWright", "link": "https://stackoverflow.com/users/8226326/mikeiswright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 44805038, "answer_count": 4, "score": 1, "last_activity_date": 1498688207, "creation_date": 1498657605, "last_edit_date": 1498688207, "question_id": 44804342, "link": "https://stackoverflow.com/questions/44804342/excel-vba-loop-through-the-spreadsheets-and-preform-another-loop", "title": "Excel VBA - Loop through the spreadsheets and preform another loop", "body": "<p>I'm probably just doing something wrong.</p>\n\n<p>I'm trying to loop through each worksheet In a work book, and on each worksheet I want it to preform another loop. The problem is that I doesn't move onto the next worksheet and only works on the active one.\n Any help would be appreciated.</p>\n\n<pre><code>Sub Hours()     \n    Dim ws As Worksheet\n    Dim I As Integer\n\n        For Each ws In ActiveWorkbook.Worksheets\n            For I = 6 To 21\n\n                k = I + 1\n\n                If Cells(k, 7).Value = \"\" Then\n\n                ElseIf Cells(I, 8).Value &lt;&gt; Cells(k, 7) Then\n                     Cells(I, 8).Font.Color = vbRed\n                     Cells(k, 7).Font.Color = vbRed\n                End If\n            Next I\n    Next ws     \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "edited": false, "score": 1, "creation_date": 1498657395, "post_id": 44804188, "comment_id": 76588383, "body": "<a href=\"https://stackoverflow.com/questions/31547268/vba-textbox-new-next-line\" title=\"vba textbox new next line\">stackoverflow.com/questions/31547268/vba-textbox-new-next-li&zwnj;&#8203;ne</a> set multiline to true?"}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "edited": false, "score": 0, "creation_date": 1498658484, "post_id": 44804188, "comment_id": 76589389, "body": "@anotherfred, That solved it, thanks. Suggest an answer and I&#39;ll approve it."}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "closed_date": 1498659148, "answer_count": 0, "score": 0, "last_activity_date": 1498657202, "creation_date": 1498657202, "question_id": 44804188, "link": "https://stackoverflow.com/questions/44804188/excel-vba-userform-textbox-add-new-line", "closed_reason": "Duplicate", "title": "Excel vba UserForm TextBox add new line", "body": "<p>I have UserForm with ProgressBar and TextBoxes in it. TextBoxes are updated during code execution, but it doesn't add new line as it is supposed to do:</p>\n\n<pre><code> UserForm1.TextBox1.Value = UserForm1.TextBox1.Value &amp; \"Opened file \" &amp; i &amp; Chr(13)\n</code></pre>\n\n<p>I tried also <code>vbNewLine</code> and <code>vbCrLf</code> with the same result: it just show this <a href=\"https://i.stack.imgur.com/DeCTx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DeCTx.png\" alt=\"enter image description here\"></a> symbol instead of putting text on the next line.</p>\n\n<p>How to fix it?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1498658074, "last_edit_date": 1498658074, "creation_date": 1498657408, "answer_id": 44804260, "question_id": 44804130, "link": "https://stackoverflow.com/questions/44804130/using-a-linest-function-within-a-nested-loop/44804260#44804260", "title": "Using a Linest Function within a Nested Loop", "body": "<p>you need to remove the vba part from the quotes and concatenate.</p>\n\n<pre><code>ActiveSheet.Range(\"M21\").value = ActiveSheet.Evaluate(\"Linest(\" &amp; gRange.Address(0,0) &amp; \",G9:G112)\")(1)\n</code></pre>\n\n<p>The Second one:</p>\n\n<pre><code>With ActiveSheet\n    .Range(\"M22\").value = .Evaluate(\"Linest(\" &amp; .Range(.cells(9,2),.cells(112,2)).Address(0,0) &amp; \",\" &amp; .Range(.cells(9,7),.cells(112,7)).Address(0,0) &amp; \")\")(1)\nEnd With\n</code></pre>\n\n<p>This will also error if the two ranges are not the same size.  So make sure they are.</p>\n"}], "owner": {"reputation": 1, "user_id": 8117710, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b409dc2af0c80a1f9db7be2678f02d35?s=128&d=identicon&r=PG&f=1", "display_name": "Y.Ono", "link": "https://stackoverflow.com/users/8117710/y-ono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498690685, "creation_date": 1498657049, "last_edit_date": 1498690685, "question_id": 44804130, "link": "https://stackoverflow.com/questions/44804130/using-a-linest-function-within-a-nested-loop", "title": "Using a Linest Function within a Nested Loop", "body": "<p>I am working with VBA and I'm very much a novice.  I basically have 3 columns of data which act as the independent variable (MSCI Value, Growth and Small Cap) and then a blank column followed by numerous columns containing fund data (dependent variables).  Most of these have the same number of rows but a few do not.</p>\n\n<p>I am looking to use the Linest Function in excel to produce the coefficient (beta) of each fund with each independant variable separately (MSCI growth, Value, Small cap).  I am unsure what is the best way to set out my data and vba. And thoughts/ ideas would be much appreciated. </p>\n\n<p>Currently my thoughts are a nested loop.  Whereby I use the Linest function to regress the first independent variable (MSCI Growth, column 2) against the first dependent variable (column 6) and this column number in the range is incremented each time until the column is blank (there are no more funds), and when this happens it loops back to the first fund but changes to the next independent variable (MSCI Value, column 3).  This process is repeated until the last independent variable (MSCI Growth, column 4) is regressed against the last fund.</p>\n\n<p>My problem so far has been 1) creating a Linest Function using named ranges \n2) creating a table where the results of the loop are placed.</p>\n\n<pre><code>Set StartCell = Range(\"B9\")\n\nLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nSet gRange = Range(StartCell, Cells(LastRow, 2)) 'MSCI growth range\n\nRange(\"M21\").value = Evaluate(\"Linest(gRange,G9:G112)\") 'column G contains the first fund.\n</code></pre>\n\n<p>This code doesn't run, I think it has something to do with the array formula, I only need the coefficient so do not need to run the whole array.</p>\n\n<p>I tried using cell references but when I ran the code I got #VALUE</p>\n\n<pre><code>Range(\"M22\").value = Evaluate(\"Linest(Range((cells(9,2):cells(112,2)),Range(cells(9,7):cells(112,7)))\")\n</code></pre>\n\n<p>Maybe I am going about this the wrong way, I want to create a global macro I can use on other sheets but I am unsure how to approach the task.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 6823044, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c0429021091e5d86e0e2a3ffc935b165?s=128&d=identicon&r=PG&f=1", "display_name": "Joe smo", "link": "https://stackoverflow.com/users/6823044/joe-smo"}, "is_accepted": false, "score": 0, "last_activity_date": 1498657660, "creation_date": 1498657660, "answer_id": 44804363, "question_id": 44803991, "link": "https://stackoverflow.com/questions/44803991/delete-all-group-content-controls-only-in-vba/44804363#44804363", "title": "Delete all Group content controls only in VBA", "body": "<p>After digging a little more, I realized that group content controls dont have a title. I thought the \"Group\" would be used for the tag, or title of the control, but it does not. Here is the updated code (but doesn't guarantee only group controls will be deleted).</p>\n\n<pre><code>Dim cc As ContentControl\n\n  For Each cc In ActiveDocument.SelectContentControlsByTag(\"\")\n    cc.Delete\n  Next\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 6823044, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c0429021091e5d86e0e2a3ffc935b165?s=128&d=identicon&r=PG&f=1", "display_name": "Joe smo", "link": "https://stackoverflow.com/users/6823044/joe-smo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498678878, "creation_date": 1498656725, "last_edit_date": 1498678878, "question_id": 44803991, "link": "https://stackoverflow.com/questions/44803991/delete-all-group-content-controls-only-in-vba", "title": "Delete all Group content controls only in VBA", "body": "<p>I have looked all over for a solution, but for some reason I am not able to delete group content controls only in vba. I do not want to delete the contents within these controls, just the control itself. Here is the code I am using to currently isolate group content controls to delete:</p>\n\n<pre><code>Dim cc As ContentControl\n\n  For Each cc In ActiveDocument.SelectContentControlsByTag(\"Group\")\n    cc.Delete\n  Next\n</code></pre>\n\n<p>Does anyone know why this will not delete Group content controls? Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1498656291, "post_id": 44803736, "comment_id": 76587510, "body": "reference should be in <code>()</code> not after <code>.</code>: see here: <a href=\"https://www.techonthenet.com/excel/formulas/istext.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/istext.php</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "is_accepted": false, "score": 1, "last_activity_date": 1498656703, "creation_date": 1498656703, "answer_id": 44803981, "question_id": 44803736, "link": "https://stackoverflow.com/questions/44803736/vba-error-with-istext-function-in-if-statement/44803981#44803981", "title": "VBA error with ISTEXT function in IF statement", "body": "<p><a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/worksheetfunction-istext-method-excel\" rel=\"nofollow noreferrer\"><code>IsText</code></a> is a method of the <code>WorksheetFunction</code> class. </p>\n\n<p>You have got your syntax wrong, the correction would be:</p>\n\n<pre><code>If WorksheetFunction.IsText(Sheets(\"Strategies\").Cells(i, 6)) = True Then\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4572, "user_id": 2445415, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dc71bb0d143a5595e296f0264dc4eb16?s=128&d=identicon&r=PG", "display_name": "Jakob Busk S&#248;rensen", "link": "https://stackoverflow.com/users/2445415/jakob-busk-s%c3%b8rensen"}, "is_accepted": false, "score": 0, "last_activity_date": 1498656968, "creation_date": 1498656968, "answer_id": 44804097, "question_id": 44803736, "link": "https://stackoverflow.com/questions/44803736/vba-error-with-istext-function-in-if-statement/44804097#44804097", "title": "VBA error with ISTEXT function in IF statement", "body": "<p>The <code>IsText()</code> method should not be called with a <code>.</code>, but rather using <code>()</code>, like this:</p>\n\n<pre><code>For i = 1 To 100\n    s = Sheets(\"Strategies\").Cells(i, 6).Value\n    If Application.WorksheetFunction.IsText(s)Then\n        Sheets(\"Strategies\").Select\n        Cells(i, 6).Select\n        Selection.Copy\n        Sheets(\"Stats\").Select\n        Cells(2, j).Select\n        Sheets(\"Stats\").Paste\n        j = j + 1\n    End If\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1498657738, "post_id": 44804228, "comment_id": 76588675, "body": "If Wf.IsText(vDB(i, 1)) Then  is same with    If Not IsNumeric(vDB(i, 1)) Then ."}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1498657312, "creation_date": 1498657312, "answer_id": 44804228, "question_id": 44803736, "link": "https://stackoverflow.com/questions/44803736/vba-error-with-istext-function-in-if-statement/44804228#44804228", "title": "VBA error with ISTEXT function in IF statement", "body": "<p>Using Variant is so fast.</p>\n\n<pre><code>Sub test()\n\nDim i As Integer\nDim j As Integer\nDim Wf As WorksheetFunction\nDim fromWs As Worksheet, ToWs As Worksheet\nDim vDB, vR()\n\nSet fromWs = Sheets(\"Strategies\")\nSet ToWs = Sheets(\"Stats\")\n\nSet Wf = WorksheetFunction\nvDB = fromWs.Range(\"f1\").Resize(100)\n\n\n\n    For i = 1 To UBound(vDB, 1)\n        If Wf.IsText(vDB(i, 1)) Then\n            j = j + 1\n            ReDim Preserve vR(1 To j)\n            vR(j) = vDB(i, 1)\n        End If\n    Next i\n    If j &gt; 0 Then\n        ToWs.Range(\"a2\").Resize(1, j) = vR\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": false, "score": 0, "last_activity_date": 1498657858, "creation_date": 1498657858, "answer_id": 44804431, "question_id": 44803736, "link": "https://stackoverflow.com/questions/44803736/vba-error-with-istext-function-in-if-statement/44804431#44804431", "title": "VBA error with ISTEXT function in IF statement", "body": "<p>You could tidy the whole thing up as follows:</p>\n\n<pre><code>Dim i As Integer, j As Integer\nDim sourcesheet As Worksheet, targetsheet As Worksheet\n\nj = 1\n\nSet sourcesheet = Sheets(\"Strategies\")\nSet targetsheet = Sheets(\"Stats\")\n\nWith sourcesheet   \n    For i = 1 To 100\n        s = .Cells(i, 6).Value\n        If Application.WorksheetFunction.IsText(s) Then\n            .Cells(i, 6).Copy targetsheet.Cells(2, j)\n            j = j + 1\n        End If\n    Next i\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4610861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/90d4e6f3cbfb7029fd04ab22ec426b03?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Lynch", "link": "https://stackoverflow.com/users/4610861/peter-lynch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12996, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1578645940, "creation_date": 1498656084, "last_edit_date": 1578645940, "question_id": 44803736, "link": "https://stackoverflow.com/questions/44803736/vba-error-with-istext-function-in-if-statement", "title": "VBA error with ISTEXT function in IF statement", "body": "<p>Just started using VBA and I'm basically looking to check if an item in a column is text and then copy it to another sheet in a row. I get stopped at the first line of the IF statement with </p>\n\n<blockquote>\n  <p>Error 424 - Object Required</p>\n</blockquote>\n\n<p>Have looked at a few of these questions and websites and can't seem to figure out where I've gone wrong.</p>\n\n<p>Thanks very much.</p>\n\n<pre><code>Sub Copier() \n\nDim i As Integer\nDim j As Integer\n\nj = 1\n\nFor i = 1 To 100\n    If IsText.Sheets(\"Strategies\").Cells(i, 6) = True Then\n        Sheets(\"Strategies\").Select\n        Cells(i, 6).Select\n        Selection.Copy\n        Sheets(\"Stats\").Select\n        Cells(2, j).Select\n        Sheets(\"Stats\").Paste\n        j = j + 1\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1498655484, "post_id": 44803332, "comment_id": 76586845, "body": "I doubt your field is already called &quot;Sum Of...&quot; so use: <code>pt7.AddDataField pt7.PivotFields(&quot;Reasons for Delay&quot;), &quot;Sum of Reasons for Delay&quot;, xlSum</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1498655571, "post_id": 44803332, "comment_id": 76586922, "body": "@Rory beat me to it (I was trying to post as answer)"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1498656312, "post_id": 44803332, "comment_id": 76587530, "body": "@Rory still the error exist."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1498658330, "post_id": 44803332, "comment_id": 76589249, "body": "It works for me assuming the field name is correct."}], "answers": [{"tags": [], "owner": {"reputation": 32, "user_id": 7694537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y5Ohw.jpg?s=128&g=1", "display_name": "Shums", "link": "https://stackoverflow.com/users/7694537/shums"}, "is_accepted": false, "score": 0, "last_activity_date": 1498655596, "creation_date": 1498655596, "answer_id": 44803545, "question_id": 44803332, "link": "https://stackoverflow.com/questions/44803332/application-defined-error-while-creating-pivot-table/44803545#44803545", "title": "Application Defined Error while creating Pivot table", "body": "<p>Change this line:\npt7.AddDataField pt7.PivotFields(\"Sum of Reasons for Delay\"), \"Sum of Reasons for Delay\", xlSum\nto:\npt7.AddDataField pt7.PivotFields(\"Sum of Reasons for Delay\"), \"Reasons for Delay\", xlSum</p>\n"}, {"tags": [], "owner": {"reputation": 32, "user_id": 7694537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y5Ohw.jpg?s=128&g=1", "display_name": "Shums", "link": "https://stackoverflow.com/users/7694537/shums"}, "is_accepted": false, "score": 0, "last_activity_date": 1498658631, "creation_date": 1498658631, "answer_id": 44804776, "question_id": 44803332, "link": "https://stackoverflow.com/questions/44803332/application-defined-error-while-creating-pivot-table/44804776#44804776", "title": "Application Defined Error while creating Pivot table", "body": "<p>Try Below code:</p>\n\n<pre><code>Sub CreatePivotTable()\nDim PSheet As Worksheet\nDim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\nDim LastRow As Long\nDim LastCol As Long\nWith Application\n    .ScreenUpdating = False\n    .DisplayStatusBar = True\n    .StatusBar = \"!!! Please Be Patient...Updating Records !!!\"\n    .EnableEvents = False\n    .Calculation = xlManual\nEnd With\n'Delete Preivous Pivot Table Worksheet &amp; Insert a New Blank Worksheet With Same Name\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"PivotTable\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"PivotTable\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"PivotTable\")\nSet DSheet = Worksheets(\"Pivot_Reasons\")\n'Define Data Range\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n'Define Pivot Cache\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\nTableName:=\"FilteredPivotTable\")\n'Insert Blank Pivot Table\nSet PTable = PCache.CreatePivotTable(TableDestination:=PSheet.Cells(1, 1), \nTableName:=\"FilteredPivotTable\")\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"FilteredPivotTable\").PivotFields(\"Reasons for \nDelay\")\n .Orientation = xlRowField\n .Position = 1\nEnd With\n'Insert Data Field\nWith ActiveSheet.PivotTables(\"FilteredPivotTable\").PivotFields(\"Reasons for \nDelay\")\n .Orientation = xlDataField\n .Position = 1\n .Function = xlSum\n .NumberFormat = \"#,##0\"\n .Name = \"Reasons\"\nEnd With\n\n'Format Pivot Table\nActiveSheet.PivotTables(\"FilteredPivotTable\").CompactLayoutRowHeader = \"Reasons\"\nActiveSheet.PivotTables(\"FilteredPivotTable\").ShowTableStyleRowStripes = True\nActiveSheet.PivotTables(\"FilteredPivotTable\").TableStyle2 = \"PivotStyleMedium9\"\nWith Application\n    .ScreenUpdating = True\n    .DisplayStatusBar = True\n    .StatusBar = False\n    .EnableEvents = True\n    .Calculation = xlAutomatic\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498658631, "creation_date": 1498654999, "question_id": 44803332, "link": "https://stackoverflow.com/questions/44803332/application-defined-error-while-creating-pivot-table", "title": "Application Defined Error while creating Pivot table", "body": "<p>I am using an VBA code to generate a Pivot table, my code works well with other sheet, but in this sheet it is always creating an error. I checked the column Name, sheet Name everyting, still I could not figure out where I am making mistake. I even recorded macro to crosscheck, still i am clueless. </p>\n\n<pre><code>Sub AutoPivot7()\n\nDim ws7 As Worksheet\nDim pc7 As PivotCache\nDim pt7 As PivotTable\nDim ct7 As Integer\nSet ws7 = Sheets(\"Pivot_Reasons\")\n\n\nSet pc7 = ActiveWorkbook.PivotCaches.Create(xlDatabase, \"'Reasons for Delay'!R1C1:R1048576C2\")\n\nSet pt7 = pc7.CreatePivotTable(ws7.Range(\"B3\"))\n\npt7.AddDataField pt7.PivotFields(\"Sum of Reasons for Delay\"), \"Sum of Reasons for Delay\", xlSum\n\nWith pt7\n\nWith .PivotFields(\"Reasons for Delay\")\n.Orientation = xlRowField\n.Position = 1\n.AutoSort xlDescending, \"Sum of Reasons for Delay\"\n\nEnd With\n\nWith .PivotFields(\"Sum of Reasons for Delay\")\n.Calculation = xlPercentOfTotal\nEnd With\nEnd With\nEnd Sub\n</code></pre>\n\n<p>The error occurs in the line</p>\n\n<blockquote>\n  <p>pt7.AddDataField pt7.PivotFields(\"Sum of Reasons for Delay\"), \"Sum of\n  Reasons for Delay\", xlSum</p>\n</blockquote>\n\n<p>if i remove this and run my code, i am not getting the error. I also have attached the record macro which i reffered  </p>\n\n<pre><code>Sub Macro7()\n'\n' Macro7 Macro\n'\n\n'\n    ActiveCell.Offset(-21, -1).Range(\"Table3[#All]\").Select\n    Sheets.Add\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        \"Table3\", Version:=xlPivotTableVersion15).CreatePivotTable TableDestination _\n        :=\"Sheet1!R3C1\", TableName:=\"PivotTable44\", DefaultVersion:= _\n        xlPivotTableVersion15\n    Sheets(\"Sheet1\").Select\n    Cells(3, 1).Select\n    With ActiveSheet.PivotTables(\"PivotTable44\").PivotFields(\"Reasons for Delay\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    ActiveSheet.PivotTables(\"PivotTable44\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable44\").PivotFields(\"Sum of Reasons for Delay\"), _\n        \"Sum of Sum of Reasons for Delay\", xlSum\n    ActiveSheet.PivotTables(\"PivotTable44\").PivotFields(\"Reasons for Delay\"). _\n        AutoSort xlDescending, \"Sum of Sum of Reasons for Delay\"\n    ActiveCell.Offset(0, 1).Range(\"A1\").Select\n    With ActiveSheet.PivotTables(\"PivotTable44\").PivotFields( _\n        \"Sum of Sum of Reasons for Delay\")\n        .Calculation = xlPercentOfTotal\n        .NumberFormat = \"0,00%\"\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "boolean"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498655387, "post_id": 44803296, "comment_id": 76586752, "body": "I suspect that the variable is not within scope. Use <code>Option Explicit</code> at the top of your module (the one containing your sub above) and check if the compiler yells."}, {"owner": {"reputation": 261, "user_id": 8218934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uu1lp.jpg?s=128&g=1", "display_name": "Diveye", "link": "https://stackoverflow.com/users/8218934/diveye"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498655648, "post_id": 44803296, "comment_id": 76586989, "body": "That was the solution to my problem. Public variables can&#39;t be accessed from one module to another. They only work inside the same module for all the different subs within that module apparently. Thanks A.S.H !"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498655818, "post_id": 44803296, "comment_id": 76587110, "body": "<code>public safe_mode as Boolean</code> at the very top of a module."}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498656199, "post_id": 44803685, "comment_id": 76587426, "body": "No, if you declare it as <code>Public</code> it will be available in all the project. And a more important answer, <b>Always</b> use <code>Option Explicit</code>. It will save you a <b>lot lot</b> of time on the long run :)"}], "tags": [], "owner": {"reputation": 261, "user_id": 8218934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uu1lp.jpg?s=128&g=1", "display_name": "Diveye", "link": "https://stackoverflow.com/users/8218934/diveye"}, "is_accepted": false, "score": 0, "last_activity_date": 1498655953, "creation_date": 1498655953, "answer_id": 44803685, "question_id": 44803296, "link": "https://stackoverflow.com/questions/44803296/vba-true-boolean-condition-not-respected/44803685#44803685", "title": "VBA True boolean condition not Respected", "body": "<p>Answer: Define variable as public at the top of the module. It will work only for the module. If it is defined in another module it won't be automatically imported. </p>\n"}, {"comments": [{"owner": {"reputation": 261, "user_id": 8218934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uu1lp.jpg?s=128&g=1", "display_name": "Diveye", "link": "https://stackoverflow.com/users/8218934/diveye"}, "edited": false, "score": 0, "creation_date": 1498738694, "post_id": 44803949, "comment_id": 76629781, "body": "Thanks for the help! I managed to get my login system to work thanks to both your answer and ASH&#39;s. Got to remember to keep Option Ecplicit defined..."}], "tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": true, "score": 0, "last_activity_date": 1498656603, "creation_date": 1498656603, "answer_id": 44803949, "question_id": 44803296, "link": "https://stackoverflow.com/questions/44803296/vba-true-boolean-condition-not-respected/44803949#44803949", "title": "VBA True boolean condition not Respected", "body": "<p>so I think that Your variable is empty. It is not clear to me when You insert value to safe_mode, e. g. when You reopen Your workbook the safe_mode will be cleared, so maybe You need a sub which fires at workbook open and sets the value of safe_mode? Second option is to store value in a VBA hidden tab.</p>\n\n<p>I've modified a little Your code so that You could test it (to check if safe_mode is not empty):</p>\n\n<pre><code>Public safe_mode As Boolean\n\nPrivate Sub Dev_Mode_Click()\n\nDim pass As String\n\nIf IsEmpty(safe_mode) = True Then\n   MsgBox(\"Cannot check if admin mode\")\nElse\n   If (safe_mode = False) Then\n\n   pass = InputBox(\"Password\")\n      If pass &lt;&gt; \"admin_rights\" Then\n         Sheets(\"Database\").Visible = xlSheetVeryHidden\n         Sheets(\"NewFile\").Visible = xlSheetVeryHidden\n         Sheets(\"LandingPage\").Dev_Mode.Caption = \"Admin\"\n         MsgBox (\"Invalid Password\")\n         safe_mode = False\n         MsgBox (safe_mode)\n         Exit Sub\n      Else\n         Sheets(\"Database\").Visible = True\n         Sheets(\"NewFile\").Visible = True\n         Sheets(\"LandingPage\").Dev_Mode.Caption = \"Log Off\"\n         safe_mode = True\n         MsgBox (safe_mode)\n         Exit Sub\n      End If\n   ElseIf (safe_mode = True) Then\n\n      Sheets(\"Database\").Visible = xlSheetVeryHidden\n      Sheets(\"NewFile\").Visible = xlSheetVeryHidden\n      safe_mode = False\n      Sheets(\"LandingPage\").Dev_Mode.Caption = \"Admin\"\n      MsgBox (\"Disconnect successful\")\n      MsgBox (safe_mode)\n      Exit Sub\n   End If\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 8218934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/uu1lp.jpg?s=128&g=1", "display_name": "Diveye", "link": "https://stackoverflow.com/users/8218934/diveye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1279, "favorite_count": 0, "accepted_answer_id": 44803949, "answer_count": 2, "score": 3, "last_activity_date": 1498656603, "creation_date": 1498654929, "question_id": 44803296, "link": "https://stackoverflow.com/questions/44803296/vba-true-boolean-condition-not-respected", "title": "VBA True boolean condition not Respected", "body": "<p>This is probably a really stupid question but I can't seem to find my way around it... I defined a global variable called safe_mode and is a boolean. In one of my subs I need to check its value and give it a new value accordingly. The code below will give you more information.   </p>\n\n<pre><code>Private Sub Dev_Mode_Click()\n\nDim pass As String\n\n\nIf safe_mode = False Then\n\npass = InputBox(\"Password\")\nIf pass &lt;&gt; \"admin_rights\" Then\n    Sheets(\"Database\").Visible = xlSheetVeryHidden\n    Sheets(\"NewFile\").Visible = xlSheetVeryHidden\n    Sheets(\"LandingPage\").Dev_Mode.Caption = \"Admin\"\n    MsgBox (\"Invalid Password\")\n    safe_mode = False\n    MsgBox (safe_mode)\n    Exit Sub\nElse\n    Sheets(\"Database\").Visible = True\n    Sheets(\"NewFile\").Visible = True\n    Sheets(\"LandingPage\").Dev_Mode.Caption = \"Log Off\"\n    safe_mode = True\n    MsgBox (safe_mode)\n    Exit Sub\nEnd If\nEnd If\n\nIf safe_mode = True Then\n\n    Sheets(\"Database\").Visible = xlSheetVeryHidden\n    Sheets(\"NewFile\").Visible = xlSheetVeryHidden\n    safe_mode = False\n    Sheets(\"LandingPage\").Dev_Mode.Caption = \"Admin\"\n    MsgBox (\"Disconnect successful\")\n    MsgBox (safe_mode)\n    Exit Sub\nEnd If\nEnd Sub\n</code></pre>\n\n<p>The value of safe_mode is correctly attributed. In other words I am getting true when in Admin mode and False when Logged Off. However, the If safe_mode = true condition is not respected. I am getting prompted for a password even when logging off which makes no sense, seeing as that code is only run when the safe_mode = false and the variable returns true in the MsgBox. Upon correct password entry while trying to log off the variable remains true. The only way to set it back to false is by missspelling the password. Any know their way around this? </p>\n\n<p>Thanks!\nD.</p>\n"}, {"tags": ["excel", "error-handling", "vba"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498654581, "post_id": 44802914, "comment_id": 76586059, "body": "Do you have the file &quot;some file.xlsm&quot; opened while executing this code? Do you have the line with fileNotOpen label defined in the same Sub? Also: The showing the erroring line in Yellow is exactly what that Option you&#39;re referring to does.  If you turn that option off, you should go to the &quot;fileNotOpen&quot; label <b>after</b> the yellow line fails (once more hitting F8)."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498654828, "post_id": 44802914, "comment_id": 76586272, "body": "@RikSportel the option <code>Break on Unhandled Errors</code> is actually the one that makes code jump to the error handling label without breaking. Anyway, @OP, in addition to the questions above, do you have some other <code>On Error</code> statements in the same sub?"}, {"owner": {"reputation": 1252, "user_id": 2220657, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/304eee32aaa733abc444e925f91dd9ae?s=128&d=identicon&r=PG", "display_name": "Serge In&#225;cio", "link": "https://stackoverflow.com/users/2220657/serge-in%c3%a1cio"}, "edited": false, "score": 0, "creation_date": 1498654933, "post_id": 44802914, "comment_id": 76586379, "body": "I updated the code a bit. I have other on error go to labels yes, but they are before this error handling (attempt), and they work."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498655038, "post_id": 44802914, "comment_id": 76586454, "body": "@A.S.H Yeah you&#39;re right, my bad. It&#39;ll break when unhandled (which it shouldn&#39;t be) yet bahves like it&#39;s unhandled (hence my questions)."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498655044, "post_id": 44802914, "comment_id": 76586458, "body": "@SergeIn&#225;cio, if you had <code>On Error Resume Next</code> before that line and an error does occur, your new  <code>On Error GoTo fileNotOpen</code> wont work unless you call <code>Resume something</code>. Post some of those statements."}, {"owner": {"reputation": 1252, "user_id": 2220657, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/304eee32aaa733abc444e925f91dd9ae?s=128&d=identicon&r=PG", "display_name": "Serge In&#225;cio", "link": "https://stackoverflow.com/users/2220657/serge-in%c3%a1cio"}, "edited": false, "score": 0, "creation_date": 1498655622, "post_id": 44802914, "comment_id": 76586970, "body": "Thanks for all the help so far. When I call Resume the file freezes :S. I added some more code. hopefully now it is enough."}], "answers": [{"comments": [{"owner": {"reputation": 1252, "user_id": 2220657, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/304eee32aaa733abc444e925f91dd9ae?s=128&d=identicon&r=PG", "display_name": "Serge In&#225;cio", "link": "https://stackoverflow.com/users/2220657/serge-in%c3%a1cio"}, "edited": false, "score": 1, "creation_date": 1498656434, "post_id": 44803749, "comment_id": 76587633, "body": "Wow. awesome, thank you so much for taking the time :)"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 1, "last_activity_date": 1498656575, "last_edit_date": 1498656575, "creation_date": 1498656103, "answer_id": 44803749, "question_id": 44802914, "link": "https://stackoverflow.com/questions/44802914/not-able-to-handle-runtime-error-9-with-on-error-go-to-label/44803749#44803749", "title": "Not able to handle runtime error 9 with on error go to [label]", "body": "<p>That's it. As I said in the comments, when an error occurs, and you handle it, you cannot setup a new <code>On Error</code> mechanism until you explicitly invoke the <code>Resume</code> keyword in any way.</p>\n\n<p>One possible way to achieve it, if you dont want to change the flow of your routine, is just to add a label before your new <code>On Error</code> statement and <code>Resume</code> on it. Like this, for example:</p>\n\n<pre><code>Sub Some_sub()\n  ' Some code ...\n\n  On Error GoTo resumeCode\n  If Workbooks(\"Some file.xlsm\").ReadOnly Then\n    GoTo readOnlyError\n  End If\n\n  ' Some more code ...\n\nresumeCode:\n  Resume ResumeHere ' &lt;---------------------------------------- Invoke Resume\n\nResumeHere:               ' &lt;------------------------------------- Add some label\n\nOn Error GoTo fileNotOpen\nWorkbooks(\"Some file.xlsm\").Activate\n\nExit Sub\n\nfileNotOpen:\n   msgBox \"Error: Claims followup.xlsm is not open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"Open the file in read/write\"\n  Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>You should be careful though, the keyword <code>Resume</code> will itself raise an error if the error status is blank and it is reached from normal flow, In that case you should put the error handling sections, each apart, in the end of your routine and resume at any labels within the normal flow from there. This is generally the usual approach.</p>\n"}], "owner": {"reputation": 1252, "user_id": 2220657, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/304eee32aaa733abc444e925f91dd9ae?s=128&d=identicon&r=PG", "display_name": "Serge In&#225;cio", "link": "https://stackoverflow.com/users/2220657/serge-in%c3%a1cio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 44803749, "answer_count": 1, "score": 1, "last_activity_date": 1498656575, "creation_date": 1498654040, "last_edit_date": 1531161705, "question_id": 44802914, "link": "https://stackoverflow.com/questions/44802914/not-able-to-handle-runtime-error-9-with-on-error-go-to-label", "title": "Not able to handle runtime error 9 with on error go to [label]", "body": "<p>I have the followin code. But the error does not get handled</p>\n\n<pre><code>Sub Some_sub()\n\nSome code here\n\nOn Error GoTo resumeCode\nIf Workbooks(\"Some file.xlsm\").ReadOnly Then\n    GoTo readOnlyError\nEnd If\n\nresumeCode:\n\nOn Error GoTo fileNotOpen\nWorkbooks(\"Some file.xlsm\").Activate\n\nsome more code here\n\nExit Sub\n\nfileNotOpen:\n    MsgBox \"Error: Claims followup.xlsm is not open.\" &amp; Chr(10) &amp; Chr(10) &amp; \n\"Open the file in read/write\"\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>When I run debug mode it shows me this line: <code>Workbooks(\"Some file.xlsm\").Activate</code> in yellow. Instead of handling the error and going to the label.</p>\n\n<p>Within VBA under Tools -> Options -> General Tab: Break on Unhandled Errors active.</p>\n\n<p>When I have the file open it runs the code like it should. When it is closed it does not handle the error.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks in advance for your help</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498654138, "post_id": 44802851, "comment_id": 76585696, "body": "Where is the listbox, on a sheet?"}, {"owner": {"reputation": 6672, "user_id": 2446254, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/4SJnD.png?s=128&g=1", "display_name": "Cody \uff27", "link": "https://stackoverflow.com/users/2446254/cody-%ef%bc%a7"}, "edited": false, "score": 0, "creation_date": 1498654996, "post_id": 44802851, "comment_id": 76586432, "body": "VBA code shouldn&#39;t run on the worksheet if the worksheet is locked with a password and <code>UserInterFaceOnly</code> isn&#39;t set to <code>true</code>."}, {"owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "edited": false, "score": 0, "creation_date": 1498655754, "post_id": 44802851, "comment_id": 76587050, "body": "Yes list box is visible on a sheet"}], "answers": [{"tags": [], "owner": {"reputation": 309, "user_id": 8201890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYB8I.png?s=128&g=1", "display_name": "MisterBic", "link": "https://stackoverflow.com/users/8201890/misterbic"}, "is_accepted": false, "score": 0, "last_activity_date": 1498656342, "creation_date": 1498656342, "answer_id": 44803829, "question_id": 44802851, "link": "https://stackoverflow.com/questions/44802851/prevent-vba-code-from-other-workbook-working-with-objects/44803829#44803829", "title": "Prevent VBA code from other workbook working with objects", "body": "<p>What you can do is lock your VBA project and change your \"subs\" into \"function\", this way, a more advanced user have no access to the macro you've written without unlocking the project. </p>\n\n<p>(Functions are not visible from the \"assign a macro\" button in the developer ribbon where Subs are)</p>\n"}, {"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1498660562, "post_id": 44805134, "comment_id": 76591068, "body": "This should be an edit to your original question, rather than an answer to it."}], "tags": [], "owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "is_accepted": false, "score": 0, "last_activity_date": 1498659489, "creation_date": 1498659489, "answer_id": 44805134, "question_id": 44802851, "link": "https://stackoverflow.com/questions/44802851/prevent-vba-code-from-other-workbook-working-with-objects/44805134#44805134", "title": "Prevent VBA code from other workbook working with objects", "body": "<p>I tried <code>UserInterFaceOnly</code> - and I'm not sure at this moment what it is supposed to do but it is not doing what I wanted</p>\n\n<p>To be more clear, I have 2 list boxes and several comboboxes on Sheet1. When I'm sending file to users, I want to lock ListBoxes, or rather <code>.enabled = False</code></p>\n\n<p>What I'm trying to do is to prevent other user to write in some other workbook</p>\n\n<pre><code> Workbooks(\"opexRequest\").Sheets(\"Report\").ListBoxes(\"lstDepartment\").Enabled = True\n</code></pre>\n\n<p>this line woudl enable the list box, and user can change values, and macro will genarate new SQL string for Departments user is not supposed to have access to. I need to have comboboxes enabled, so user can view different dates, and versions of plan for his department.</p>\n\n<p>By accident I found a way I guess. </p>\n\n<p>Within Sheet1 I have this code</p>\n\n<pre><code>Sub lstDepartment_change()\n\n        'checks first if lock checkbox is true/false, clears selection and disables listbox, _\n        if checkbox is locked and yet listbox is enabled and allows change\n\n        If Me.chkLock = True Then\n                Me.ListBoxes(\"lstDepartment\").Enabled = False\n                Me.ListBoxes(\"lstdirector\").Enabled = False\n                Call clearlistbox\n                End\n            ElseIf Me.chkLock = False Then\n                Call ControlsM.directorpopulation\n        End If\n\n    End Sub\n\n\n\n    Sub lstDirector_change()\n\n        'checks first if lock checkbox is true/false, clears selection and disables listbox, _\n        if checkbox is locked and yet listbox is enabled and allows change\n\n        If Me.chkLock = True Then\n            Me.ListBoxes(\"lstDepartment\").Enabled = False\n            Me.ListBoxes(\"lstdirector\").Enabled = False\n            Call clearlistbox\n            End\n        ElseIf Me.chkLock = False Then\n\n        End If\n\n\n    End Sub\n\n\n\n    Private Sub chkLock_Click()\n\n        'locking/unlocking with password inbox call\n\n        If Me.chkLock.Value = True Then\n                Me.ListBoxes(\"lstDepartment\").Enabled = False\n                Me.ListBoxes(\"lstDirector\").Enabled = False\n            ElseIf Me.chkLock.Value = False Then\n\n                If PasswordInputBoxM.InputBoxPassword(\"Enter password\", \"Password Required\") = \"****\" Then\n                        Me.ListBoxes(\"lstDepartment\").Enabled = True\n                        Me.ListBoxes(\"lstDirector\").Enabled = True\n                    Else\n                        Me.chkLock.Value = True\n                        MsgBox \"Wrong Password\"\n                        Exit Sub\n                End If\n        End If\n\n    End Sub\n</code></pre>\n\n<p>If someone tries to unlock just listbox, and tries to change value, it will check the checkbox value, and clears the selected list and locks the listbox\nIf someone tries to unlock listbox and uncheck lock checkbox, it will automatically ask for password\nProblem is, that someone can change selected value from other workbook. I do not know how to handle that</p>\n\n<pre><code> Workbooks(\"opexRequest\").Sheets(\"Report\").ListBoxes(\"lstDepartment\").Enabled = True 'handled\n    Workbooks(\"opexRequest\").Sheets(\"Report\").chkLock.value = False 'handled\n    Workbooks(\"opexRequest\").Sheets(\"Report\").ListBoxes(\"lstDepartment\").Selected(1) = True 'do not know how to prevent this\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6584418, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6660e3f529cd90d79af7d4e4d73a1105?s=128&d=identicon&r=PG&f=1", "display_name": "Matus", "link": "https://stackoverflow.com/users/6584418/matus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498659489, "creation_date": 1498653897, "question_id": 44802851, "link": "https://stackoverflow.com/questions/44802851/prevent-vba-code-from-other-workbook-working-with-objects", "title": "Prevent VBA code from other workbook working with objects", "body": "<p>I need to disable a control (list box in this case), so user cannot get data from other departments. I do have a macro that can enable/disable it, and ask for password. </p>\n\n<p>What I need is to prevent semidecent user to write a macro for enabling this list box in another workbook and unlocking it this way. It is possible in some way prevent VBA code from other modules to work with this control? So only code written in that one sheet can enable or disable it.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1498719456, "post_id": 44802557, "comment_id": 76616550, "body": "Can you share an example spreadsheet?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8123028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0aba00f2365acf8f3fa408506ce716c2?s=128&d=identicon&r=PG&f=1", "display_name": "Shahnawaz", "link": "https://stackoverflow.com/users/8123028/shahnawaz"}, "is_accepted": false, "score": -1, "last_activity_date": 1498653681, "creation_date": 1498653681, "answer_id": 44802768, "question_id": 44802557, "link": "https://stackoverflow.com/questions/44802557/how-to-copy-paste-a-table-from-excel-sheet-to-outlook-mail/44802768#44802768", "title": "How to copy paste a table from Excel sheet to outlook mail", "body": "<p>(1) Ctrl+A in your excel then (2) Ctrl+C  and (3) Ctrl+V in outlook</p>\n"}, {"tags": [], "owner": {"reputation": 32, "user_id": 7694537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y5Ohw.jpg?s=128&g=1", "display_name": "Shums", "link": "https://stackoverflow.com/users/7694537/shums"}, "is_accepted": false, "score": 0, "last_activity_date": 1498654013, "creation_date": 1498654013, "answer_id": 44802904, "question_id": 44802557, "link": "https://stackoverflow.com/questions/44802557/how-to-copy-paste-a-table-from-excel-sheet-to-outlook-mail/44802904#44802904", "title": "How to copy paste a table from Excel sheet to outlook mail", "body": "<ol>\n<li>Select First Cell of your table, means first header cell</li>\n<li>Press Ctrl+A</li>\n<li>Press Ctrl+C</li>\n<li>Switch to Outlook</li>\n<li>Place the Cursor in your Email Body where you want table</li>\n<li>Press Ctrl+V</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 3970, "user_id": 1818089, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/UrgND.png?s=128&g=1", "display_name": "computingfreak", "link": "https://stackoverflow.com/users/1818089/computingfreak"}, "edited": false, "score": 1, "creation_date": 1528692822, "post_id": 48259306, "comment_id": 88587303, "body": "this is a nice trick, Excel to Word to Outlook, Totally Microsoft Style. I wish they could learn something from Apple. But, it takes years. oh, wait, it&#39;s 2018 already..."}], "tags": [], "owner": {"reputation": 189, "user_id": 6787964, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b3099dd0e76e1ebf2b8229cd47073704?s=128&d=identicon&r=PG&f=1", "display_name": "sathya", "link": "https://stackoverflow.com/users/6787964/sathya"}, "is_accepted": false, "score": 2, "last_activity_date": 1516005182, "creation_date": 1516005182, "answer_id": 48259306, "question_id": 44802557, "link": "https://stackoverflow.com/questions/44802557/how-to-copy-paste-a-table-from-excel-sheet-to-outlook-mail/48259306#48259306", "title": "How to copy paste a table from Excel sheet to outlook mail", "body": "<p><strong><em>The below steps you have to follow,</em></strong></p>\n\n<pre><code>      Copy the tables into Microsoft word application\n      Now Copy the tables from Microsoft word application\n      Now Past the copied tables from Microsoft word application to your Email\n</code></pre>\n\n<p><strong><em>This will work perfectly, let me know via comments if you are still facing the issue.</em></strong></p>\n"}], "owner": {"reputation": 97, "user_id": 8005749, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/536e8f5062d8d8667356137fa1e508df?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/8005749/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8682, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1592872386, "creation_date": 1498653194, "last_edit_date": 1592872386, "question_id": 44802557, "link": "https://stackoverflow.com/questions/44802557/how-to-copy-paste-a-table-from-excel-sheet-to-outlook-mail", "title": "How to copy paste a table from Excel sheet to outlook mail", "body": "<p>I have a dynamic table in sheet2 of my Excel sheet.\nHow to copy this entire table from sheet2 to outlook mail body using Outlook VBA.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498656262, "post_id": 44802467, "comment_id": 76587485, "body": "Unrelated, but your code will be much easier to read and maintain if it&#39;s properly indented. Notice <code>If...End If</code> and <code>For...Next</code> blocks in the answers you got. If you&#39;re not sure how to do it, I invite you to take a look at what my <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">Rubberduck</a> can do for you (e.g. consistently indent an entire project, identify undeclared variables, etc)."}], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1498653184, "creation_date": 1498653184, "answer_id": 44802554, "question_id": 44802467, "link": "https://stackoverflow.com/questions/44802467/using-left-for-variable/44802554#44802554", "title": "Using Left() for variable", "body": "<blockquote>\n<pre><code>Testvariable = Range(\"A1\", \"A\" &amp; a)\n</code></pre>\n</blockquote>\n\n<p><code>Testvariable</code> is an <strong>array</strong> (unless <code>a=1</code>, which is not your case here)</p>\n\n<p><code>Left</code> is flexible enough to accept numbers in addition to strings, but NOT arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498653294, "post_id": 44802555, "comment_id": 76585022, "body": "It is not an object actually but an array, because it was not assigned using the <code>Set</code> keyword."}, {"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498653463, "post_id": 44802555, "comment_id": 76585163, "body": "Appears to return object of type Range. <a href=\"https://msdn.microsoft.com/VBA/Excel-VBA/articles/range-object-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/VBA/Excel-VBA/articles/range-object-excel</a>  But either way, it&#39;s not a string."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 2, "creation_date": 1498653630, "post_id": 44802555, "comment_id": 76585301, "body": "The <code>Range</code> function returns a Range object, But when you assign it to the variable <code>Testvariable</code> without the <code>Set</code> keyword, an implicit call to <code>.Value</code> is made and the result is an array. Objects cannot be assigned without the <code>Set</code> keyword. Yes it&#39;s not a string, the answer is valid but only apart of this  subtlety :)"}, {"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 1, "creation_date": 1498654071, "post_id": 44802555, "comment_id": 76585639, "body": "I added that to an edit since it&#39;s worthwhile information.  It&#39;s never good to rely on VBA implicits, which is why I changed the variables to be properly declared."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1498656354, "post_id": 44802555, "comment_id": 76587566, "body": "VBA <code>Integer</code> is a 16-bit integer type, that will overflow at 32,768; better use a <code>Long</code> (32-bit integer), especially for row counts."}], "tags": [], "owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "is_accepted": false, "score": 3, "last_activity_date": 1498660022, "last_edit_date": 1498660022, "creation_date": 1498653188, "answer_id": 44802555, "question_id": 44802467, "link": "https://stackoverflow.com/questions/44802467/using-left-for-variable/44802555#44802555", "title": "Using Left() for variable", "body": "<p>Trouble is you are trying to take the left of a <code>Range</code> object that happens to give you an array when assigned without the <code>set</code> keyword, when <code>left</code> wants a <code>string</code>.</p>\n\n<p>This post here explains how to convert a range to a string, that you can then pass to left.\n<a href=\"https://stackoverflow.com/questions/41777996/how-can-i-convert-a-range-to-a-string-vba\">How can I convert a range to a string (VBA)?</a></p>\n\n<pre><code>Sub test()\n    dim a as long\n    a = UsedRange.Rows.Count\n    dim Testvariable as string\n    Testvariable = RangeToString(Range(\"A1\", \"A\" &amp; a))\n    dim FirstNo as string\n    FirstNo = Left(Testvariable, 1)\n    dim i as long\n    For i= 1 To a\n        If FirstNo(i,1) = \"1\" Then\n            Cells(i,2) = \"abc\" &amp; FirstNo(i,1)\n        Else \n            Cells(i,2) = \"def\" &amp; FirstNo(i,1)\n        End if\n    Next\nEnd Sub\n\nFunction RangeToString(ByVal myRange as Range) as String\n    RangeToString = \"\"\n    If Not myRange Is Nothing Then\n        Dim myCell as Range\n        For Each myCell in myRange\n            RangeToString = RangeToString &amp; \",\" &amp; myCell.Value\n        Next myCell\n        'Remove extra comma\n        RangeToString = Right(RangeToString, Len(RangeToString) - 1)\n    End If\nEnd Function\n</code></pre>\n\n<p>Also, be sure to always declare your variables correctly.</p>\n\n<p><code>a = UsedRange.Rows.Count</code> means create a variable called <code>a</code> of type <code>variant</code> and give it the value of <code>UsedRange.Rows.Count</code></p>\n\n<p><code>Testvariable = Range(\"A1\", \"A\" &amp; a)</code> means create a variable called <code>Testvariable</code> of type <code>variant</code> and give it the <code>.value</code> of the range object (an array)</p>\n\n<p>If these were declared properly</p>\n\n<pre><code>    dim a as long\n    a = UsedRange.Rows.Count\n    dim Testvariable as string\n    Testvariable = Range(\"A1\", \"A\" &amp; a)\n</code></pre>\n\n<p>The assignment of Testvariable would have failed with a much more obvious error, informing you that you can't convert an array to a string.</p>\n"}, {"tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 1, "last_activity_date": 1498654113, "last_edit_date": 1498654113, "creation_date": 1498653773, "answer_id": 44802805, "question_id": 44802467, "link": "https://stackoverflow.com/questions/44802467/using-left-for-variable/44802805#44802805", "title": "Using Left() for variable", "body": "<p>If I follow your flow, I think this will get you what you are looking for.</p>\n\n<pre><code>Sub test()\n    Dim ws As Worksheet\n    Set ws = ActiveWorkbook.ActiveSheet\n    a = ws.UsedRange.Rows.Count\n    TestVariable = Range(\"A1\", \"A\" &amp; a)\n\n    For i = 1 To a\n        FirstNo = Left(TestVariable(i, 1), 1)\n\n        If FirstNo = \"1\" Then\n            Cells(i, 2) = \"abc\" &amp; FirstNo(i, 1)\n        Else\n            Cells(i, 2) = \"def\" &amp; FirstNo\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I think the issue was, in addition to the other two answers, was that you need to loop through the cells <strong>and</strong> output something based on each cells value. Therefore, just throw your code just above your <code>for</code> loop inside and change as needed.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8220384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e1f6e3ed231207be2eb5572087715a?s=128&d=identicon&r=PG", "display_name": "kct360", "link": "https://stackoverflow.com/users/8220384/kct360"}, "edited": false, "score": 0, "creation_date": 1498663626, "post_id": 44804864, "comment_id": 76593474, "body": "Thanks for the very detailed explanation.   What is the difference between <code>Testvariable</code> to refer to a range or values?   Is it that for range, if usedRows = 5,   <code>Testvariable</code> will be A1:A5   whereas for values,   <code>Testvariable</code> will be the actual values?   Tried both range and values for the purpose of this code, either range or values work the same."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21, "user_id": 8220384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e1f6e3ed231207be2eb5572087715a?s=128&d=identicon&r=PG", "display_name": "kct360", "link": "https://stackoverflow.com/users/8220384/kct360"}, "edited": false, "score": 0, "creation_date": 1498663773, "post_id": 44804864, "comment_id": 76593585, "body": "If it&#39;s a <code>Range</code>, then you&#39;re looking at an <i>object</i> that has state and methods. If it&#39;s an array of values, well, that&#39;s all there is to it. If you need the values and nothing else, work with the array. If you need the object and its members, work with a <code>Range</code>. As with everything, #ItDepends."}, {"owner": {"reputation": 21, "user_id": 8220384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e1f6e3ed231207be2eb5572087715a?s=128&d=identicon&r=PG", "display_name": "kct360", "link": "https://stackoverflow.com/users/8220384/kct360"}, "edited": false, "score": 0, "creation_date": 1498664516, "post_id": 44804864, "comment_id": 76594105, "body": "Not exactly sure what that really means, maybe with more experience i can truly comprehend. I&#39;ve done the formula in excel prior to attempting on VBA (Thought it will be a good way to try typing my own code by converting from excel formulas to VBA, but it looks like it is much harder/complicated than expected, as evident in this example.)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21, "user_id": 8220384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e1f6e3ed231207be2eb5572087715a?s=128&d=identicon&r=PG", "display_name": "kct360", "link": "https://stackoverflow.com/users/8220384/kct360"}, "edited": false, "score": 0, "creation_date": 1498665364, "post_id": 44804864, "comment_id": 76594812, "body": "@kct360 you&#39;ll love what VBA can do for you. A bunch of friends and I are writing <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>, a VBE add-in  that can probably help you on your journey. Have fun!"}, {"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "reply_to_user": {"reputation": 21, "user_id": 8220384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e1f6e3ed231207be2eb5572087715a?s=128&d=identicon&r=PG", "display_name": "kct360", "link": "https://stackoverflow.com/users/8220384/kct360"}, "edited": false, "score": 0, "creation_date": 1498665591, "post_id": 44804864, "comment_id": 76594990, "body": "@kct360 You accidentally fell into the trap of how badly VBA handles objects. So it&#39;s understandable you got confused. This link explains the available primitive types in VBA. <a href=\"http://www.informit.com/articles/article.aspx?p=339929&amp;seqNum=2\" rel=\"nofollow noreferrer\">informit.com/articles/article.aspx?p=339929&amp;seqNum=2</a>  Note that Range isn&#39;t one of them, so you can deduce Range is an object instead.  It&#39;s more complicated than that but hopefully it helps you get started.  The other confusing thing is arrays.  Arrays are like groups of the same type.  Groups of strings, groups of integers, groups of objects.  It&#39;s a way for you to use 1 variable to store many values."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1498665869, "post_id": 44804864, "comment_id": 76595203, "body": "@TrevorD exactly what&#39;s &quot;bad&quot; about how VBA &quot;handles&quot; objects? default members are a COM thing, VBA is COM. Blame COM, not VBA =)"}, {"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1498666316, "post_id": 44804864, "comment_id": 76595473, "body": "How about the way you implement such a feature into your own classes involves notepad? <a href=\"https://bytes.com/topic/access/insights/694992-how-declare-default-property-class-module\" rel=\"nofollow noreferrer\">bytes.com/topic/access/insights/&hellip;</a> All of VBA objects screams &quot;after thought&quot;."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 1, "creation_date": 1498667233, "post_id": 44804864, "comment_id": 76596041, "body": "@TrevorD ah! good one! Just so happens that the next release of Rubberduck will introduce <code>@PredeclaredId</code>, <code>@Exposed</code>, <code>@DefaultMember</code>, <code>@Enumerator</code> and <code>@Description</code> annotations (aka &quot;magic comments&quot;), and an inspection quick-fix to synchronize annotations and attributes =)  ...FWIW these were editable in VB6, it&#39;s the VBA editor that removed them."}, {"owner": {"reputation": 2243, "user_id": 3389900, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/73283dbb19b8c2ffe975ef7d63fac6ab?s=128&d=identicon&r=PG&f=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/3389900/trevor"}, "edited": false, "score": 0, "creation_date": 1498669056, "post_id": 44804864, "comment_id": 76597166, "body": "I actually don&#39;t recall them being editable in VB6.  That would have been handy to know back in the day when VB6 was relevant. :-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1498658841, "creation_date": 1498658841, "answer_id": 44804864, "question_id": 44802467, "link": "https://stackoverflow.com/questions/44802467/using-left-for-variable/44804864#44804864", "title": "Using Left() for variable", "body": "<p>VBA does a lot of things behind your back, to \"make things easier\". The problem is that these things come back and bite you later.</p>\n\n<p>Undeclared variables, for example. Without <code>Option Explicit</code> specified at the top of every module, VBA will happily compile code that uses variables that aren't declared. Sounds useful? It would be, if the types were <em>inferred</em>. But instead VBA declares an on-the-fly <code>Variant</code>, that holds whatever you put into it (and changes its type to accomodate whatever you're assigning).</p>\n\n<blockquote>\n<pre><code>a = UsedRange.Rows.Count\n</code></pre>\n</blockquote>\n\n<p>Here <code>a</code> is an implicit <code>Variant/Long</code>. Declare it as a <code>Long</code> integer:</p>\n\n<pre><code>Dim a As Long\n</code></pre>\n\n<p>Even better, give it a meaningful name:</p>\n\n<pre><code>Dim usedRows As Long\nusedRows = UsedRange.Rows.Count\n</code></pre>\n\n<p>Now the fun part:</p>\n\n<blockquote>\n<pre><code>Testvariable = Range(\"A1\", \"A\" &amp; a)\n</code></pre>\n</blockquote>\n\n<p>Here <code>Testvariable</code> is an implicit <code>Variant/Array</code>. How so? The code that VBA sees looks something like this:</p>\n\n<pre><code>Testvariable = Range(\"A1\", \"A\" &amp; a).Value\n</code></pre>\n\n<p>And because <code>a</code> wouldn't be <code>1</code>, that <code>.Value</code> is referring to more than one single cell - Excel's object model gives you an array that contains the values of all cells in the specified range, and that's what <code>Testvariable</code> contains.</p>\n\n<p>If you wanted <code>Testvariable</code> to refer to a <em>range</em> rather than just their values, you would declare a <code>Range</code> object variable, and assign it with the <code>Set</code> keyword:</p>\n\n<pre><code>Dim testVariable As Range\nSet testVariable = ActiveSheet.Range(\"A1:A\" &amp; a)\n</code></pre>\n\n<p>Notice the explicit <code>ActiveSheet</code> here: without it the code does exactly the same thing, so why put it in? Because you want to be as <em>explicit</em> as possible: unqualified <code>Range</code>, <code>Cells</code>, <code>Rows</code>, <code>Columns</code> and <code>Names</code> calls all implicitly refer to the active worksheet - and that's yet another source of bugs (just google up \"range error 1004\", you'll find hundreds of Stack Overflow questions about it).</p>\n\n<p>If you meant <code>testVariable</code> to contain the <em>values</em> of every cell in that specified range, then you would declare and assign <code>testVariable</code> like this:</p>\n\n<pre><code>Dim testVariable As Variant\ntestVariable = ActiveSheet.Range(\"A1:A\" &amp; a).Value\n</code></pre>\n\n<p>And now you have an array that contains all values in range <code>\"A1:A\" &amp; a</code> of the active worksheet: that's what your code does.. implicitly.</p>\n\n<blockquote>\n<pre><code>FirstNo = Left(Testvariable, 1)\n</code></pre>\n</blockquote>\n\n<p>So now we want the \"first number\", and we're reading it off a variant array.</p>\n\n<p>The <code>Left</code> (or <code>Left$</code>) function is from the <code>VBA.Strings</code> module, and means to works with strings; it can work with other types too (with implicit type conversions), but if you give it an object reference <em>or an array</em>, it won't know how to convert it for you, and VBA will raise a run-time error.</p>\n\n<p>The <code>testVariable</code> variant array contains <code>Variant</code> values: most cells will contain a <code>Double</code> floating-point value. Others will contain a <code>String</code>. Some cells can contain an error value (e.g. <code>#N/A</code>, <code>#VALUE!</code>, or <code>#REF!</code>) - and VBA will not be able to implicitly convert such error values either.</p>\n\n<p>So before you read any cell's value, you need to make sure you <em>can</em> read it; use the <code>IsError</code> function for that:</p>\n\n<pre><code>If IsError(testVariable(1, 1)) Then\n    Exit Sub ' cell contains an error; cannot process\nIf Not IsNumeric(testVariable(1, 1)) Then\n    Exit Sub ' cell doesn't contain a number; cannot process\nEnd If\n\n' now that we KNOW our value is a numeric value...\nDim firstNumber As Double\nfirstNumber = testVariable(1, 1)\n</code></pre>\n\n<p>Notice that <code>(1, 1)</code>? That's because <code>testVariable</code> is a 1-based 2D array (without <code>Option Base 1</code> implicitly sized arrays are always 0-based, except when you're getting one from a <code>Range</code>), so to read the value in the first row / first column, you need to read the value at index <code>(1, 1)</code>.</p>\n\n<p>But that's not what you're trying to do.</p>\n\n<blockquote>\n  <p><em>So I was trying to append prefixes to a set of values, depending on the first number of <strong>each value</strong>.</em></p>\n</blockquote>\n\n<p>\"Each value\" means you need to iterate the values, so you have a loop there.</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To a\n    '...\nNext\n</code></pre>\n\n<p>It's not the \"first number\" we want, it's the <code>firstDigit</code>, <em>of every cell we're looping over</em>.</p>\n\n<blockquote>\n<pre><code>If FirstNo(i,1) = \"1\" Then\n</code></pre>\n</blockquote>\n\n<p>Here you've lost track of the types you're dealing with: <code>FirstNo</code> was assigned <em>before</em> the loop started, so its value will be constant at every iteration.</p>\n\n<p>You mean to do this:</p>\n\n<pre><code>Dim values As Variant\nvalues = ActiveSheet.Range(\"A1:A\" &amp; usedRows).Value\n\nDim i As Long\nFor i = 1 To usedRows\n    If Not IsError(values(i)) Then\n\n        Dim representation As String\n        representation = CStr(values(i))\n\n        Dim prefix As String\n        If Left$(representation, 1) = \"1\" Then\n            prefix = \"abc\"\n        Else\n            prefix = \"def\"\n        End If\n\n        ActiveSheet.Range(\"B\" &amp; i).Value = prefix &amp; representation\n\n    End If\nNext\n</code></pre>\n\n<p>Now that everything is explicit and properly indented, it's much easier to see what's going on... and now I'd seriously question why you need VBA to do that:</p>\n\n<pre><code>[B1] = IFERROR(IF(LEFT(A1, 1) = \"1\", \"abc\" &amp; A1, \"def\" &amp; A1), \"\")\n</code></pre>\n\n<p>And drag the formula down.</p>\n"}], "owner": {"reputation": 21, "user_id": 8220384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31e1f6e3ed231207be2eb5572087715a?s=128&d=identicon&r=PG", "display_name": "kct360", "link": "https://stackoverflow.com/users/8220384/kct360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1205, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1498660022, "creation_date": 1498652971, "question_id": 44802467, "link": "https://stackoverflow.com/questions/44802467/using-left-for-variable", "title": "Using Left() for variable", "body": "<p>I'm new to VBA.\nSo i was trying to append prefixes to a set of values, depending on the first number of each value. \nHowever i get a Type mismatch error on line 4. I suppose it is because I am trying to use Left() on a variable, and it is supposed to be used on a string (or something of that sorts?)\nHow do i accomplish that?</p>\n\n<p>Thank you in advance</p>\n\n<pre><code>Sub test()\na = UsedRange.Rows.Count\nTestvariable = Range(\"A1\", \"A\" &amp; a)\nFirstNo = Left(Testvariable, 1)\nFor i= 1 To a\nIf FirstNo(i,1) = \"1\" Then\nCells(i,2) = \"abc\" &amp; FirstNo(i,1)\nElse Cells(i,2) = \"def\" &amp; FirstNo(i,1)\nEnd if\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498653550, "post_id": 44802412, "comment_id": 76585233, "body": "You can use <code>copyfromrecordset</code> insetad of looping try source=&quot;Select * from [Memory]&quot; also try adding a closing &quot;;&quot; to the connection stirng"}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498653779, "post_id": 44802412, "comment_id": 76585424, "body": "Hi Nathan, I have some 15 million records, and some records sets are close ot 1.3 million, I have to pull these into a excel tab which will accomote only close to a million. that&#39;s the problem , because of which I need to go for looping. My plan is to further modify this code to loop to next worksheet, once a sheet is filled. I mean move to next sheet and update.  Let me know if I am not clear."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498653924, "post_id": 44802412, "comment_id": 76585533, "body": "Yes, I helped you with the SQL for that, so you could use copyfromrecordset :)"}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498654070, "post_id": 44802412, "comment_id": 76585638, "body": "Yes Nathan, but I am not an expert in coding, and was not able to correctly implement it. Could you help me with a simple code to just loop through all records and update sheets 1 by 1 till all records from access and updated into excel."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498654490, "post_id": 44802412, "comment_id": 76585988, "body": "a bit brute force, but you could say <code>sheets(INT(r&#47;10000)+1).range(&quot;a&quot; &amp; r).value=</code> something along those lines, so when record 9999, <code>INT(r&#47;10000)+1</code> would give 1, when 1999 it will give 2 and so on"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498654812, "post_id": 44802412, "comment_id": 76586259, "body": "I&#39;ve added some more to yesterday&#39;s answer"}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498655795, "post_id": 44802412, "comment_id": 76587092, "body": "ok .working on that...thanks Nathan."}, {"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498658413, "post_id": 44802412, "comment_id": 76589325, "body": "Hi Nathan, I am getting error at rst.open strSQL, currentproject.connection, adOpenKeySet. the select statement includes a reseverd word, or the punctuation is incorrect.or th argument name is incorrect or missing.   kindly help correcting it"}], "answers": [{"comments": [{"owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "edited": false, "score": 0, "creation_date": 1498729926, "post_id": 44808458, "comment_id": 76623574, "body": "Thanks @ ryguy, These are quite useful..thanks again for your help"}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": true, "score": 1, "last_activity_date": 1498668723, "creation_date": 1498668723, "answer_id": 44808458, "question_id": 44802412, "link": "https://stackoverflow.com/questions/44802412/not-able-to-pull-records-from-access-to-excel-probable-connection-issue/44808458#44808458", "title": "Not able to pull records from access to excel, Probable connection issue", "body": "<p>When going from Access to Excel, you have quite a few options!  </p>\n\n<p>Here's one way to EXPORT data from Access to Excel.</p>\n\n<pre><code>Dim lngColumn As Long\nDim xlx As Object, xlw As Object, xls As Object, xlc As Object\nDim dbs As DAO.Database\n Dim rst As DAO.Recordset\n Dim blnEXCEL As Boolean, blnHeaderRow As Boolean\n\n blnEXCEL = False\n\n' Replace True with False if you do not want the first row of\n ' the worksheet to be a header row (the names of the fields\n ' from the recordset)\n blnHeaderRow = True\n\n' Establish an EXCEL application object\n On Error Resume Next\n Set xlx = GetObject(, \"Excel.Application\")\n If Err.Number &lt;&gt; 0 Then\n       Set xlx = CreateObject(\"Excel.Application\")\n       blnEXCEL = True\n End If\n Err.Clear\n On Error GoTo 0\n\n' Change True to False if you do not want the workbook to be\n ' visible when the code is running\n xlx.Visible = True\n\n' Replace C:\\Filename.xls with the actual path and filename\n' of the EXCEL file into which you will write the data\nSet xlw = xlx.Workbooks.Open(\"C:\\Filename.xls\")\n\n' Replace WorksheetName with the actual name of the worksheet\n' in the EXCEL file\n' (note that the worksheet must already be in the EXCEL file)\nSet xls = xlw.Worksheets(\"WorksheetName\")\n\n' Replace A1 with the cell reference into which the first data value\n' is to be written\nSet xlc = xls.Range(\"A1\") ' this is the first cell into which data go\n\nSet dbs = CurrentDb()\n\n' Replace QueryOrTableName with the real name of the table or query\n' whose data are to be written into the worksheet\nSet rst = dbs.OpenRecordset(\"QueryOrTableName\", dbOpenDynaset, dbReadOnly)\n\nIf rst.EOF = False And rst.BOF = False Then\n\n      rst.MoveFirst\n\n      If blnHeaderRow = True Then\n             For lngColumn = 0 To rst.Fields.Count - 1\n                   xlc.Offset(0, lngColumn).Value = rst.Fields(lngColumn).Name\n             Next lngColumn \n             Set xlc = xlc.Offset(1,0)\n       End If\n\n      ' write data to worksheet\n      Do While rst.EOF = False\n            For lngColumn = 0 To rst.Fields.Count - 1\n                  xlc.Offset(0, lngColumn).Value = rst.Fields(lngColumn).Value\n            Next lngColumn\n            rst.MoveNext\n            Set xlc = xlc.Offset(1,0)\n      Loop\n\nEnd If\n\nrst.Close\nSet rst = Nothing\n\ndbs.Close\nSet dbs = Nothing\n\n' Close the EXCEL file while saving the file, and clean up the EXCEL objects\n Set xlc = Nothing\n Set xls = Nothing\n xlw.Close True   ' close the EXCEL file and save the new data\n Set xlw = Nothing\n If blnEXCEL = True Then xlx.Quit\n Set xlx = Nothing\n</code></pre>\n\n<p>Here's another way.</p>\n\n<pre><code>Dim lngColumn As Long\n Dim xlx As Object, xlw As Object, xls As Object, xlc As Object\n Dim dbs As DAO.Database\n Dim rst As DAO.Recordset\n Dim strPathFileName As String, strWorksheetName As String\n Dim strRecordsetDataSource As String\n Dim blnEXCEL As Boolean, blnHeaderRow As Boolean\n\n blnEXCEL = False\n\n' Replace C:\\Filename.xls with the actual path and filename\n ' that will be used to save the new EXCEL file into which you \n ' will write the data\n strPathFileName = \"C:\\Filename.xls\"\n\n' Replace QueryOrTableName with the real name of the table or query\n ' whose data are to be written into the worksheet\n strRecordsetDataSource = \"QueryOrTableName\"\n\n' Replace True with False if you do not want the first row of\n ' the worksheet to be a header row (the names of the fields\n ' from the recordset)\n blnHeaderRow = True\n\n' Establish an EXCEL application object\n On Error Resume Next\n Set xlx = GetObject(, \"Excel.Application\")\n If Err.Number &lt;&gt; 0 Then\n       Set xlx = CreateObject(\"Excel.Application\")\n       blnEXCEL = True\n End If\n Err.Clear\n On Error GoTo 0\n\n' Change True to False if you do not want the workbook to be\n ' visible when the code is running\n xlx.Visible = True\n\n' Create a new EXCEL workbook\n Set xlw = xlx.Workbooks.Add\n\n' Rename the first worksheet in the EXCEL file to be the first 31 \n ' characters of the string in the strRecordsetDataSource variable\n Set xls = xlw.Worksheets(1)\n xls.Name = Trim(Left(strRecordsetDataSource, 31))\n\n' Replace A1 with the cell reference of the first cell into which the \n ' headers will be written (blnHeaderRow = True), or into which the data \n ' values will be written (blnHeaderRow = False)\n Set xlc = xls.Range(\"A1\")\n\n Set dbs = CurrentDb()\n\n Set rst = dbs.OpenRecordset(strRecordsetDataSource, dbOpenDynaset, dbReadOnly)\n\n If rst.EOF = False And rst.BOF = False Then\n       ' Write the header row to worksheet\n       If blnHeaderRow = True Then\n             For lngColumn = 0 To rst.Fields.Count - 1\n                   xlc.Offset(0, lngColumn).Value = rst.Fields(lngColumn).Name\n             Next lngColumn\n             Set xlc = xlc.Offset(1,0)\n       End If\n\n       ' copy the recordset's data to worksheet\n       xlc.CopyFromRecordset rst\n End If\n\n rst.Close\n Set rst = Nothing\n dbs.Close\n Set dbs = Nothing\n\n' Save and close the EXCEL file, and clean up the EXCEL objects\n Set xlc = Nothing\n Set xls = Nothing\n xlw.SaveAs strPathFileName\n xlw.Close False\n Set xlw = Nothing\n If blnEXCEL = True Then xlx.Quit\n Set xlx = Nothing\n</code></pre>\n\n<p>Here's a way to IMPORT date from Access to Excel.</p>\n\n<pre><code>Sub ADOImportFromAccessTable(DBFullName As String, _\n    TableName As String, TargetRange As Range)\n' Example: ADOImportFromAccessTable \"C:\\FolderName\\DataBaseName.mdb\", _\n    \"TableName\", Range(\"C1\")\nDim cn As ADODB.Connection, rs As ADODB.Recordset, intColIndex As Integer\n    Set TargetRange = TargetRange.Cells(1, 1)\n    ' open the database\n    Set cn = New ADODB.Connection\n    cn.Open \"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=\" &amp; _\n        DBFullName &amp; \";\"\n    Set rs = New ADODB.Recordset\n    With rs\n        ' open the recordset\n        .Open TableName, cn, adOpenStatic, adLockOptimistic, adCmdTable \n        ' all records\n        '.Open \"SELECT * FROM \" &amp; TableName &amp; _\n            \" WHERE [FieldName] = 'MyCriteria'\", cn, , , adCmdText \n        ' filter records\n\n        RS2WS rs, TargetRange ' write data from the recordset to the worksheet\n\n'        ' optional approach for Excel 2000 or later (RS2WS is not necessary)\n'        For intColIndex = 0 To rs.Fields.Count - 1 ' the field names\n'            TargetRange.Offset(0, intColIndex).Value = rs.Fields(intColIndex).Name\n'        Next\n'        TargetRange.Offset(1, 0).CopyFromRecordset rs ' the recordset data\n\n    End With\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\nEnd Sub\n</code></pre>\n\n<p>Here's one more way to IMPORT your data.</p>\n\n<pre><code>Sub DAOCopyFromRecordSet(DBFullName As String, TableName As String, _\n    FieldName As String, TargetRange As Range)\n' Example: DAOCopyFromRecordSet \"C:\\FolderName\\DataBaseName.mdb\", _\n    \"TableName\", \"FieldName\", Range(\"C1\")\nDim db As Database, rs As Recordset\nDim intColIndex As Integer\n    Set TargetRange = TargetRange.Cells(1, 1)\n    Set db = OpenDatabase(DBFullName)\n    Set rs = db.OpenRecordset(TableName, dbOpenTable) ' all records\n    'Set rs = db.OpenRecordset(\"SELECT * FROM \" &amp; TableName &amp; _\n        \" WHERE \" &amp; FieldName &amp; _\n        \" = 'MyCriteria'\", dbReadOnly) ' filter records\n    ' write field names\n    For intColIndex = 0 To rs.Fields.Count - 1\n        TargetRange.Offset(0, intColIndex).Value = rs.Fields(intColIndex).Name\n    Next\n    ' write recordset\n    TargetRange.Offset(1, 0).CopyFromRecordset rs\n    Set rs = Nothing\n    db.Close\n    Set db = Nothing\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 424, "user_id": 7676648, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/MKp0t.jpg?s=128&g=1", "display_name": "Apurv Pawar", "link": "https://stackoverflow.com/users/7676648/apurv-pawar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 44808458, "answer_count": 1, "score": 1, "last_activity_date": 1498678765, "creation_date": 1498652859, "last_edit_date": 1498678765, "question_id": 44802412, "link": "https://stackoverflow.com/questions/44802412/not-able-to-pull-records-from-access-to-excel-probable-connection-issue", "title": "Not able to pull records from access to excel, Probable connection issue", "body": "<p>I using the below code to pull records from access to excel.\nI am getting error at </p>\n\n<p>connDB.Open ConnectionString:=\"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDB</p>\n\n<p>The error says\"invalid sql statement, delete, insert,procedure,selet or update\"</p>\n\n<p>Kindly help as I am stuck and cannot move forward at all....</p>\n\n<p>please help.</p>\n\n<p>Sub automateAccessADO_9()\n'Using ADO to Import data from an Access Database Table to an Excel worksheet (your host application).\n'refer Image 9a to view the existing SalesManager Table in MS Access file \"SalesReport.accdb\".</p>\n\n<p>'To use ADO in your VBA project, you must add a reference to the ADO Object Library in Excel (your host application) by clicking Tools-References in VBE, and then choose an appropriate version of Microsoft ActiveX Data Objects x.x Library from the list.</p>\n\n<pre><code>'--------------\n'DIM STATEMENTS\n\nDim strMyPath As String, strDBName As String, strDB As String, strSQL As String\nDim i As Long, n As Long, lFieldCount As Long\nDim rng As Range\n\n'instantiate an ADO object using Dim with the New keyword:\nDim adoRecSet As New ADODB.Recordset\nDim connDB As New ADODB.Connection\n\n'--------------\n'THE CONNECTION OBJECT\n\nstrDBName = \"Computer.accdb\"\nstrMyPath = ThisWorkbook.Path\nstrDB = strMyPath &amp; \"\\\" &amp; strDBName\n\n'Connect to a data source:\n'For pre - MS Access 2007, .mdb files (viz. MS Access 97 up to MS Access 2003), use the Jet provider: \"Microsoft.Jet.OLEDB.4.0\". For Access 2007 (.accdb database) use the ACE Provider: \"Microsoft.ACE.OLEDB.12.0\". The ACE Provider can be used for both the Access .mdb &amp; .accdb files.\nconnDB.Open ConnectionString:=\"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDB\n\n'--------------\n'OPEN RECORDSET, ACCESS RECORDS AND FIELDS\n\nDim ws As Worksheet\n'set the worksheet:\nSet ws = ActiveWorkbook.Sheets(\"Sheet1\")\n\n'Set the ADO Recordset object:\nSet adoRecSet = New ADODB.Recordset\n\n'Opening the table named SalesManager:\nstrTable = \"memory\"\n\n'--------------\n'COPY RECORDS FROM ALL FIELDS OF A RECORDSET:\n'refer Image 9d to view records copied to Excel worksheet\n\nadoRecSet.Open Source:=strTable, ActiveConnection:=connDB, CursorType:=adOpenStatic, LockType:=adLockOptimistic\n\nSet rng = ws.Range(\"A1\")\nlFieldCount = adoRecSet.Fields.Count\n\nFor i = 0 To lFieldCount - 1\n'copy column names in first row of the worksheet:\nrng.Offset(0, i).Value = adoRecSet.Fields(i).Name\nadoRecSet.MoveFirst\n\n'copy record values starting from second row of the worksheet:\nn = 1\nDo While Not adoRecSet.EOF\nrng.Offset(n, i).Value = adoRecSet.Fields(i).Value\nadoRecSet.MoveNext\nn = n + 1\nLoop\n\nNext i\n\n'select column range to AutoFit column width:\nRange(ws.Columns(1), ws.Columns(lFieldCount)).AutoFit\n'worksheet columns are deleted because this code is only for demo:\nRange(ws.Columns(1), ws.Columns(lFieldCount)).Delete\nadoRecSet.Close\n\n'close the objects\nconnDB.Close\n\n'destroy the variables\nSet adoRecSet = Nothing\nSet connDB = Nothing\n\nEnd Sub \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498680916, "post_id": 44802268, "comment_id": 76604050, "body": "Check out DoCmd.FindRecord method."}, {"owner": {"reputation": 1, "user_id": 8225968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55dc754c1fdbffe94f5c793673009099?s=128&d=identicon&r=PG&f=1", "display_name": "Dave B.", "link": "https://stackoverflow.com/users/8225968/dave-b"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498925114, "post_id": 44802268, "comment_id": 76705336, "body": "I&#39;ve been trying to get DoCmd.Find Record but I&#39;m not getting the proper syntax to make it work :("}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1498931946, "post_id": 44802268, "comment_id": 76707226, "body": "Edit question to show what you have tried."}], "answers": [{"tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 0, "last_activity_date": 1498932053, "creation_date": 1498932053, "answer_id": 44863938, "question_id": 44802268, "link": "https://stackoverflow.com/questions/44802268/jumping-to-another-record-based-on-equaling-a-field-value/44863938#44863938", "title": "Jumping to another record based on equaling a field value", "body": "<p>DoCmd.FindRecord is one approach. </p>\n\n<p>Here is example of another.</p>\n\n<pre><code>Private Sub lbxProjects_AfterUpdate()\nWith Me\n.RecordsetClone.FindFirst \"ProjRecID=\" &amp; .lbxProjects.Column(7)\nIf Not .RecordsetClone.NoMatch Then\n    .Bookmark = Me.RecordsetClone.Bookmark\n    .cbxStateNum = Null\n    .lbxProjects.Requery\n    .Detail.Visible = True\n    .cbxName.Requery\n    .cbxName.SetFocus\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8225968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55dc754c1fdbffe94f5c793673009099?s=128&d=identicon&r=PG&f=1", "display_name": "Dave B.", "link": "https://stackoverflow.com/users/8225968/dave-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498932053, "creation_date": 1498652471, "last_edit_date": 1498653081, "question_id": 44802268, "link": "https://stackoverflow.com/questions/44802268/jumping-to-another-record-based-on-equaling-a-field-value", "title": "Jumping to another record based on equaling a field value", "body": "<p>I have been writing a parts database in Access 2013 creating forms for all my various needs. Each Part has it's own record but now I need to add an \"alternate part\" field. In other words, if Part 123 is not available, I have listed an alternate item that can be used instead. What I want to do is double click on this alternate part field \"Alternate\" and have it jump to the record (in the same table) where the PartID field = the Alternate field in the first record I'm not sure if this is a DoCmd type statement or a find statement of some sort. Thanks in advance for your help!</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498651549, "post_id": 44801908, "comment_id": 76583701, "body": "Look at the <code>INDIRECT</code> worksheet function first <code>=COUNTIFS(INDIRECT(&quot;&#39;CNAEs Inv&#225;lidos &quot; &amp; combo value &amp; &quot;&#39;!A:A&quot;;C8)</code> along these lines"}, {"owner": {"reputation": 27, "user_id": 7914121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f869352361ca61475796c8fa10aa43?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Torres", "link": "https://stackoverflow.com/users/7914121/rafael-torres"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498652232, "post_id": 44801908, "comment_id": 76584259, "body": "Thank you for the help Nathan, I will try. Another question, please: How do I get a ActiveX ComboBox value without using vba? The &#39;combo value&#39; works?"}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1498652407, "post_id": 44801908, "comment_id": 76584379, "body": "@RafaelTorres - if you want to ask another question go ahead and start a new question :)"}, {"owner": {"reputation": 27, "user_id": 7914121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f869352361ca61475796c8fa10aa43?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Torres", "link": "https://stackoverflow.com/users/7914121/rafael-torres"}, "reply_to_user": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "edited": false, "score": 0, "creation_date": 1498652516, "post_id": 44801908, "comment_id": 76584450, "body": "@RobinMackenzie No problem. Thought it was related to the problem. Thanks"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498652865, "post_id": 44801908, "comment_id": 76584713, "body": "Do you need an ActiveX ComboBox per se? Otherwise use a Form control and just set the Input Range and and output range. Use the output range combined with a lookup function to get the text values again and use <code>Indirect</code> formula to get the result you need."}, {"owner": {"reputation": 27, "user_id": 7914121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f869352361ca61475796c8fa10aa43?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Torres", "link": "https://stackoverflow.com/users/7914121/rafael-torres"}, "edited": false, "score": 0, "creation_date": 1498653165, "post_id": 44801908, "comment_id": 76584934, "body": "<code>Indirect</code> with Form control did the trick. Thank you all!"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498654049, "post_id": 44801908, "comment_id": 76585616, "body": "I&#39;ll add this as answer then. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1498653354, "creation_date": 1498653354, "answer_id": 44802621, "question_id": 44801908, "link": "https://stackoverflow.com/questions/44801908/changing-formula-content-based-on-combobox-value/44802621#44802621", "title": "Changing formula content based on ComboBox value", "body": "<p>Look at the <code>INDIRECT</code> worksheet function first <code>=COUNTIFS(INDIRECT(\"'CNAEs Inv\u00e1lidos \" &amp; combo value &amp; \"'!A:A\";C8)</code> along these lines</p>\n"}, {"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1498654165, "creation_date": 1498654165, "answer_id": 44802962, "question_id": 44801908, "link": "https://stackoverflow.com/questions/44801908/changing-formula-content-based-on-combobox-value/44802962#44802962", "title": "Changing formula content based on ComboBox value", "body": "<p>Do you need an <code>ActiveX ComboBox</code> per se? </p>\n\n<p>Otherwise use a <code>Form control</code> instead. \nIn the Form control formatting, set the Input Range and and Output cell. \nInput Range will take your text values (MAI, JUN, etc.)\nOutput cell will display the selected index (1, 2, etc.) in the dropdown.</p>\n\n<p>Use the output cell value in a lookup function to get the text values again from the Input Range. Then use the <code>Indirect</code> formula to get the resulting formula you're after.</p>\n"}], "owner": {"reputation": 27, "user_id": 7914121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69f869352361ca61475796c8fa10aa43?s=128&d=identicon&r=PG&f=1", "display_name": "Rafael Torres", "link": "https://stackoverflow.com/users/7914121/rafael-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 44802621, "answer_count": 2, "score": 0, "last_activity_date": 1498654165, "creation_date": 1498651450, "last_edit_date": 1498651556, "question_id": 44801908, "link": "https://stackoverflow.com/questions/44801908/changing-formula-content-based-on-combobox-value", "title": "Changing formula content based on ComboBox value", "body": "<p>I have a ComboBox which searches through a determined Range and replace a content from all formulas. Example:</p>\n\n<p>Current Value from ComboBox is \"MAI\"</p>\n\n<p><code>=COUNTIFS('CNAEs Inv\u00e1lidos MAI'!A:A;C8)</code></p>\n\n<p>The user select from the ComboBox the value \"JUN\" and the vba function replaces it to:</p>\n\n<p><code>=COUNTIFS('CNAEs Inv\u00e1lidos JUN'!A:A;C8)</code></p>\n\n<p>The search and replace only works once, because I cannot get the current value from the ComboBox to search.</p>\n\n<p>So far this is what I have:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub ComboBox1_Change()\nRange(\"A1:R53\").Select\n    Selection.Replace What:=ComboBox1.Value, Replacement:=ComboBox1.Value, LookAt:=xlPart, _\n        SearchOrder:=xlByRows, MatchCase:=False\n        Range(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Is there a way to get the ComboBox current value and the ComboBox new selected value?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1498650670, "post_id": 44801265, "comment_id": 76583024, "body": "Im not sure I understand what you want, but array1 would be just a value of double not an array.  Can you elaborate on what you want to achieve."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1498652034, "post_id": 44801265, "comment_id": 76584108, "body": "Is this about a multi-valued field?"}], "owner": {"reputation": 1, "user_id": 8225791, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bMLOj.jpg?s=128&g=1", "display_name": "TA1287", "link": "https://stackoverflow.com/users/8225791/ta1287"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498678747, "creation_date": 1498649645, "last_edit_date": 1498678747, "question_id": 44801265, "link": "https://stackoverflow.com/questions/44801265/passing-a-field-for-access-query-to-a-module-function-as-an-array", "title": "Passing a Field for Access Query to a Module Function as an Array", "body": "<p>I am trying to write a function in a module that we take a field from a MS ACCESS query that is passed to it and return the values of the field to another field in the Query. </p>\n\n<p>The code that I have written in the module is provided below. </p>\n\n<pre><code>    Public Function YearAmps(ByRef array1() As Double)\n\n    Dim array2(0 To UBound(array1())) As Double\n\n    Dim I\n\n    For I = 0 To UBound(array2())\n        array2(I) = array1(I)\n\n    Next I\n\n    YearAmps = array2\n\nEnd Function\n</code></pre>\n\n<p>When I put the following in the Query field: YearAmps([SN]), where YearAmps is the function that I am calling and SN is the field that I am passing to the function and run the code, I get an error. </p>\n\n<p>Does anyone know where I am going wrong. Is is possible to pass a field from an Query as an array in a Module and then return that array? </p>\n\n<p>Any help would be greatly appreciated. </p>\n"}, {"tags": ["vba", "excel", "filter"], "answers": [{"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1498651461, "last_edit_date": 1498651461, "creation_date": 1498651029, "answer_id": 44801724, "question_id": 44801190, "link": "https://stackoverflow.com/questions/44801190/vba-if-filter-show-does-not-show-values/44801724#44801724", "title": "VBA If filter show/does not show values", "body": "<p>This is because the SpecialCells(xlCellTypeVisible) is a <strong>multi-area</strong> range, so <code>.Rows.Count</code> will return the number of rows in the first area only!</p>\n\n<p>You need to scroll the areas and sum their number of rows.</p>\n\n<pre><code>Dim area As Range\nFor each area in Range(\"$A$1:$AG$\" &amp; LastRow).SpecialCells(xlCellTypeVisible)\n  counter = counter + area.Rows.Count\nNext\n</code></pre>\n\n<p>Alternatively, since you only want to check if all is filtered, just check a double condition: one area only and one row only:</p>\n\n<pre><code>With ActiveSheet.Range(\"$A$1:$AG$\" &amp; LastRow).SpecialCells(xlCellTypeVisible)\n  If .Areas.Count = 1 And .Rows.Count = 1 Then\n    'All is filtered ! no error, remove filter\n    Range(\"$A$1:$AG$\" &amp; LastRow).AutoFilter\n  End If\nEnd with\n</code></pre>\n\n<p>yet a third way, even simpler:</p>\n\n<pre><code>With ActiveSheet.Range(\"$A$1:$AG$\" &amp; LastRow)\n  .AutoFilter Field:=33, Criteria1:=\"error\"\n  If .SpecialCells(xlCellTypeVisible).Count = .Columns.Count Then .AutoFilter 'no error\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8018205, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c4901ccbc4abcd5dce7a6e0fd8a47b99?s=128&d=identicon&r=PG&f=1", "display_name": "Petanek333", "link": "https://stackoverflow.com/users/8018205/petanek333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1329, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498651461, "creation_date": 1498649419, "last_edit_date": 1531164843, "question_id": 44801190, "link": "https://stackoverflow.com/questions/44801190/vba-if-filter-show-does-not-show-values", "title": "VBA If filter show/does not show values", "body": "<p>I have been struggling with this for some time and would like to know where am I doing wrong.\nI have some source data and the last column (AG) is an excel function that evaluates if there are some N/As in some columns. If yes, it shows \"error\", otherwise it shows \"ok\". \nIn my code I would like for the macro to filldown the formulas in columns R to AG (that works fine) and to evaluate if there are some filtered errors. If there are some errors, I want it to stop (so that the user sees those filtred errors), if there are only \"ok\"s, I would like to show all the values (no filter).\nHere is my code:</p>\n\n<pre><code>Sub macro()\nWith Worksheets(\"Source\")\nLastRow = .Cells(Rows.Count, \"A\").End(xlUp).Row\nEnd With\n\nSheets(\"Source\").Select\nRange(\"R2:AG2\").Select\nSelection.AutoFill Destination:=Range(\"R2:AG\" &amp; LastRow)\n\nActiveSheet.Range(\"$A$1:$AG$\" &amp; LastRow).AutoFilter Field:=33, Criteria1:=\"error\"\n\nCounter = Range(\"$A$1:$AG$\" &amp; \nLastRow).SpecialCells(xlCellTypeVisible).Rows.Count\nIf Counter = 1 Then\nActiveSheet.Range(\"$A$1:$AG$\" &amp; LastRow).AutoFilter Field:=33\nElse\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The idea is, if the counter (number of visible rows, so only the header) is equal to 1, there are no errors and the filter should be disabled, if there are some other visible rows, the filter stays (blank after \"else\" statement) and the user then sees those mistakes.\nProblem is, the counter is always 1 even if there are some errors.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1498646461, "post_id": 44800042, "comment_id": 76580230, "body": "Your ShExist function doesn&#39;t actually return anything as the &#39;answer&#39; is stored in <code>WorksheetExists</code> not <code>ShExist</code>. See my answer below for better working function."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1498993851, "post_id": 44800042, "comment_id": 76718975, "body": "You are welcome ;)"}], "answers": [{"tags": [], "owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "is_accepted": true, "score": 8, "last_activity_date": 1498646353, "creation_date": 1498646353, "answer_id": 44800183, "question_id": 44800042, "link": "https://stackoverflow.com/questions/44800042/function-to-check-whether-a-sheet-exists-in-if-statement/44800183#44800183", "title": "Function to check whether a sheet exists, in If statement", "body": "<p>Your function isn't complete or correct. The following would work:</p>\n\n<pre><code>Function ShExist(name As String)\n    ShExist = Evaluate(\"ISREF('\" &amp; (name) &amp; \"'!A1)\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 1, "accepted_answer_id": 44800183, "answer_count": 1, "score": 1, "last_activity_date": 1499507606, "creation_date": 1498645921, "last_edit_date": 1531164843, "question_id": 44800042, "link": "https://stackoverflow.com/questions/44800042/function-to-check-whether-a-sheet-exists-in-if-statement", "title": "Function to check whether a sheet exists, in If statement", "body": "<p>I have a function to check whether a sheet exists. I cannot get it to work in an if statement. </p>\n\n<p>I would rather not create a variable before the if statement which saves the results. Should I change the function to a sub?</p>\n\n<pre><code>sub tester()\n    If ShExist(\"Equity\") = True then call differentfunction\nend sub\n\nFunction ShExist(name As String)\n    Dim WorksheetExists\n    WorksheetExists = Evaluate(\"ISREF('\" &amp; (name) &amp; \"'!A1)\")\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1498647562, "post_id": 44800040, "comment_id": 76581002, "body": "Have you checked that the folder you are saving into actually exists?"}, {"owner": {"reputation": 1, "user_id": 5885171, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qQJn4UcKDJg/AAAAAAAAAAI/AAAAAAAAAfE/GZpIv4lwUiw/photo.jpg?sz=128", "display_name": "mikica90", "link": "https://stackoverflow.com/users/5885171/mikica90"}, "reply_to_user": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1498650911, "post_id": 44800040, "comment_id": 76583221, "body": "Yes and it exist but the program during download (or rather before it) creates another folder within selected folder and names it &quot;Export28-06-17 12H04M40S&quot; and what I didn&#39;t say in my original question is that download actually starts and it downloads approximately 40 pictures and then the error appears."}, {"owner": {"reputation": 4257, "user_id": 1028679, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/fe67e29bbbb733dedab9bdf075a9ff38?s=128&d=identicon&r=PG", "display_name": "rmcsharry", "link": "https://stackoverflow.com/users/1028679/rmcsharry"}, "edited": false, "score": 0, "creation_date": 1498651904, "post_id": 44800040, "comment_id": 76583993, "body": "Ok in that case I don&#39;t know why you get the error, sorry."}, {"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1498652076, "post_id": 44800040, "comment_id": 76584144, "body": "can you show us all of your code ?"}, {"owner": {"reputation": 1, "user_id": 5885171, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qQJn4UcKDJg/AAAAAAAAAAI/AAAAAAAAAfE/GZpIv4lwUiw/photo.jpg?sz=128", "display_name": "mikica90", "link": "https://stackoverflow.com/users/5885171/mikica90"}, "edited": false, "score": 0, "creation_date": 1498674216, "post_id": 44800040, "comment_id": 76600235, "body": "Here&#39;s the code <a href=\"https://pastebin.com/XYf2p0Bn\" rel=\"nofollow noreferrer\">pastebin.com/XYf2p0Bn</a>"}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": false, "score": 0, "last_activity_date": 1498653286, "creation_date": 1498653286, "answer_id": 44802595, "question_id": 44800040, "link": "https://stackoverflow.com/questions/44800040/vba-run-time-error-3004-when-trying-to-mass-download-images-form-excel-table/44802595#44802595", "title": "VBA run-time error 3004 when trying to mass download images form excel table", "body": "<ol>\n<li><p>Are You sure that oStream is not empty - maybe there was some other error to Your code and now You try to save sth what is empty to file?</p></li>\n<li><p>Does the place You want to save exists?</p></li>\n<li><p>You choose the mode overwrite, so maybe the file that You want to overwrite is opened somewhere?</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 130, "user_id": 1460240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/703affd3cd1d5bef1d938ce09636a5b8?s=128&d=identicon&r=PG", "display_name": "hgc2002", "link": "https://stackoverflow.com/users/1460240/hgc2002"}, "is_accepted": false, "score": 1, "last_activity_date": 1524649765, "creation_date": 1524649765, "answer_id": 50019097, "question_id": 44800040, "link": "https://stackoverflow.com/questions/44800040/vba-run-time-error-3004-when-trying-to-mass-download-images-form-excel-table/50019097#50019097", "title": "VBA run-time error 3004 when trying to mass download images form excel table", "body": "<p>It happened to me that my file path had some characters that Windows doesn't accept like chr(10). After replacing that for other (like \"-\") it worked perfectly.</p>\n"}], "owner": {"reputation": 1, "user_id": 5885171, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qQJn4UcKDJg/AAAAAAAAAAI/AAAAAAAAAfE/GZpIv4lwUiw/photo.jpg?sz=128", "display_name": "mikica90", "link": "https://stackoverflow.com/users/5885171/mikica90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3013, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524649765, "creation_date": 1498645920, "question_id": 44800040, "link": "https://stackoverflow.com/questions/44800040/vba-run-time-error-3004-when-trying-to-mass-download-images-form-excel-table", "title": "VBA run-time error 3004 when trying to mass download images form excel table", "body": "<p>I got a huge excel table from manufacturer with VBA program with you can download all images from URL's in the table. When starting download it says run-time error '3004' write to file failed.</p>\n\n<p>In debugger it says that this is the problem</p>\n\n<pre><code>oStream.SaveToFile strordner &amp; \"\\\" &amp; Name, 2  ' 1 = no overwrite, 2 = overwrite\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498647439, "post_id": 44800039, "comment_id": 76580924, "body": "Maybe <code>Paste:=xlPasteAllMergingConditionalFormats</code> instead of <code>Paste:=xlPasteValues</code>?"}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498650042, "post_id": 44800039, "comment_id": 76582552, "body": "I tried doing that , but some cell values have formulas so i get a &quot;#REF&quot; error on the other sheet."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1498650235, "post_id": 44800039, "comment_id": 76582695, "body": "You can try to do the <code>PasteSpecial</code> twice: once with <code>xlPasteAllMergingConditionalFormats </code> and then with <code>xlPateValues</code>. Give it a try."}], "answers": [{"tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": true, "score": 1, "last_activity_date": 1498653010, "creation_date": 1498653010, "answer_id": 44802481, "question_id": 44800039, "link": "https://stackoverflow.com/questions/44800039/keeping-conditional-formatting/44802481#44802481", "title": "Keeping Conditional Formatting", "body": "<p>so I recommend to replace this:</p>\n\n<pre><code> Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteAllMergingConditionalFormats, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\nApplication.CutCopyMode = False 'so that Excel will not be in the copy mode\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 44802481, "answer_count": 1, "score": 1, "last_activity_date": 1498653010, "creation_date": 1498645920, "last_edit_date": 1498652460, "question_id": 44800039, "link": "https://stackoverflow.com/questions/44800039/keeping-conditional-formatting", "title": "Keeping Conditional Formatting", "body": "<p>Hi I'm busy with a VBA macro that copies data from one sheet to another, problem is whenever i paste the data to the other sheet, the conditional formatting falls off.It messes up with what i want to achieve. Isn't there a code I could use to keep conditional formatting. here is my code:</p>\n\n<pre><code>'In this example I am Copying the Data from Sheet1 (Source) to Sheet2 \n(Destination)\nSub sbCopyRangeToAnotherSheet()\n'Method 1\nApplication.ScreenUpdating = False\n\n\n'Set active sheet as current sheet\ntemp = ActiveSheet.Index\n\n'Clear contents in sheet 1\nSheets(\"Sheet1\").Select\nRange(\"B22\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\n'Clear Specials in Sheet 1\nRange(\"B13\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.ClearContents\n\n'Return to current sheet and copy required contents\nSheets(temp).Select\nRange(\"D51\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nRange(Selection, Selection.End(xlDown)).Select\n        Selection.Copy\n\n'Paste data in sheet 1\nWorksheets(\"Sheet1\").Activate\n\nk = Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\nRange(\"B22\").Select  ' kindly change the code to suit your paste location\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n:=False, Transpose:=False\n\n'Copy specials over to sheet1\n\nSheets(temp).Select\nRange(\"i36\").Select\n\np = Range(Selection, Selection.End(xlDown)).Count\n\n\nj = 0\n\nFor k = 1 To p\nSheets(temp).Select\n\nt = Range(\"i36\").Offset(k - 1, 0).Value\ns = Range(\"j36\").Offset(k - 1, 0).Value\n\n\nIf t = True Then\nSheets(\"Sheet1\").Select\nj = j + 1\nRange(\"b13\").Offset(j - 1, 0).Value = s\n\nElse: End If\n\nNext k\n\n'Delete Empty Rows In UPL\n\nDim iRow As Long, lastRow As Long\n\nDim ws As Worksheet\nSet ws = Worksheets(\"Sheet1\") 'qualify your sheet\n\nlastRow = ws.Range(\"A\" &amp; ws.Rows.Count).End(xlUp).Row 'find last used row\n\nFor iRow = lastRow To 1 Step -1 'run from last used row backwards to row 1\n    If ws.Cells(iRow, 3).Text = \"#N/A\" Or _\n       ws.Cells(iRow, 4).Text = \"#N/A\" Then\n        ws.Rows(iRow).Delete\n    End If\nNext iRow\n\n' Paste Unit Into UPL\n\nSheets(temp).Select\ntemp = Sheets(temp).Range(\"d35\").Value\n\nmodel = Range(\"D26\").Value\nSheets(\"Sheet1\").Select\nRange(\"B11\").Value = temp &amp; \" \" &amp; model\n\n\nEnd Sub\n</code></pre>\n\n<p>Please Assist</p>\n"}, {"tags": ["vba", "sharepoint", "adodb"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8330821, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/667e3c2155f8ae1782d77249a1be2dac?s=128&d=identicon&r=PG", "display_name": "Arpan", "link": "https://stackoverflow.com/users/8330821/arpan"}, "is_accepted": false, "score": 0, "last_activity_date": 1500458882, "creation_date": 1500458882, "answer_id": 45187377, "question_id": 44800009, "link": "https://stackoverflow.com/questions/44800009/run-time-error-80004005-invalid-argument-adodb-sharepoint-list-using-vba/45187377#45187377", "title": "Run-time error 80004005 Invalid argument ADODB SharePoint list using VBA", "body": "<p>I think I have found the issues. There are two ways to solve the issue:</p>\n\n<ol>\n<li><p>Save the Excel file in One Drive and connection string would stop throwing error. Strangely it doesn't run from local folder but runs from OneDrive folder.</p></li>\n<li><p>Run it from Excel 2013.</p></li>\n</ol>\n\n<p>Please let me know if it helps.</p>\n"}], "owner": {"reputation": 11, "user_id": 8199287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad17e65f9e7c5528f83e727f3cf6a4f3?s=128&d=identicon&r=PG&f=1", "display_name": "derkacz", "link": "https://stackoverflow.com/users/8199287/derkacz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 768, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500458882, "creation_date": 1498645851, "question_id": 44800009, "link": "https://stackoverflow.com/questions/44800009/run-time-error-80004005-invalid-argument-adodb-sharepoint-list-using-vba", "title": "Run-time error 80004005 Invalid argument ADODB SharePoint list using VBA", "body": "<p>Hello I have code like below and when I run it i got error in line marked below. Error is \"Run-time error 80004005 Invalid argument\". I was looking for some tips to solve the problem but none of them helps me. Thanks for any advice.   </p>\n\n<pre><code>Sub TestInsertToSharepoint()\n\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConn As String\nDim sSQL As String\n\n\n\nsDEMAND_ROLE_GUID = \"guid\"\nsSHAREPOINT_SITE = \"sharepointsite\"\n\n\nsConn = \"Provider=Microsoft.ACE.OLEDB.12.0;WSS;IMEX=1;RetrieveIds=Yes;\" &amp; _\n\"DATABASE=\" &amp; sSHAREPOINT_SITE &amp; \";\" &amp; _\n\"LIST=\" &amp; sDEMAND_ROLE_GUID &amp; \";\"\n\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\nWith cn\n.ConnectionString = sConn\n.Open &lt;--------- here I got error\nEnd With\n\nsSQL = \"INSERT INTO tblAddingData (Title) VALUES ('FIRSTEDIT')\"\n\nrs.Open sSQL, cn\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "for-loop"], "answers": [{"tags": [], "owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "is_accepted": false, "score": 0, "last_activity_date": 1498646264, "creation_date": 1498646264, "answer_id": 44800155, "question_id": 44799902, "link": "https://stackoverflow.com/questions/44799902/vba-for-function-not-completing-cycle/44800155#44800155", "title": "VBA &#39;For&#39; function not completing cycle", "body": "<p>Don't increment empty_column1 when you have deleted a column.</p>\n\n<pre><code>For iRepeat = 1 To iTimes\n    If Sheets(\"Optimisation\").Cells(1, empty_column1).Value = \"FAIL\" Then\n        Sheets(\"Optimisation\").Columns(empty_column1).EntireColumn.Delete\n    Else\n        empty_column1 = empty_column1 + 1\n    End If\nNext iRepeat\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 3, "last_activity_date": 1498646318, "creation_date": 1498646318, "answer_id": 44800173, "question_id": 44799902, "link": "https://stackoverflow.com/questions/44799902/vba-for-function-not-completing-cycle/44800173#44800173", "title": "VBA &#39;For&#39; function not completing cycle", "body": "<p>When deleting objects, in your case Columns, allways loop backwards, so change your loop:</p>\n\n<pre><code>For iRepeat = 1 To iTimes\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>For iRepeat = iTimes To 1 Step -1\n</code></pre>\n\n<p>Try the code below:  </p>\n\n<pre><code>With Sheets(\"Optimisation\")\n    For iRepeat = iTimes To 1 Step -1\n        If .Cells(1, iRepeat).Value = \"FAIL\" Then\n            .Columns(iRepeat).Delete\n        End If\n    Next iRepeat\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7505419, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209968451980646/picture?type=large", "display_name": "Darren Gillen", "link": "https://stackoverflow.com/users/7505419/darren-gillen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 44800173, "answer_count": 2, "score": 1, "last_activity_date": 1498646318, "creation_date": 1498645562, "last_edit_date": 1531164843, "question_id": 44799902, "link": "https://stackoverflow.com/questions/44799902/vba-for-function-not-completing-cycle", "title": "VBA &#39;For&#39; function not completing cycle", "body": "<p>I have a series of columns in a sheet called \"Optimisation\". Some of the columns contain just one entry (\"FAIL\") and others contain a set of integers. </p>\n\n<p>I need to cycle through the columns and delete the ones that have FAIL in them. The code I have used is as follows:</p>\n\n<pre><code>Sub delete_fails()\n\nDim empty_column1 As Integer\nDim iTimes As Long\nDim iRepeat As Integer\n\niTimes = Application.WorksheetFunction.CountA(Sheets(\"Optimisation\").Range(\"1:1\"))\n\nempty_column1 = 1\n\n    For iRepeat = 1 To iTimes\n        If Sheets(\"Optimisation\").Cells(1, empty_column1).Value = \"FAIL\" Then\n            Sheets(\"Optimisation\").Columns(empty_column1).EntireColumn.Delete\n        End If\n        empty_column1 = empty_column1 + 1\n        Next iRepeat\n\nEnd Sub\n</code></pre>\n\n<p>The code partially works because it deletes some of the FAIL columns but doesn't delete them all. I have to run the macro 10-15 times before all the FAIL columns are successfully deleted. Is there a bug in the code that I can clear up so I only have to run the macro once? Maybe I need to instruct Excel to ignore any column with numbers in it and move on to the next one?</p>\n\n<p>(Note: Total VBA newb here so apologies in advance if the coding hurts your brain.)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498645467, "post_id": 44799831, "comment_id": 76579619, "body": "can you explain a little clearer are the images what you want to achieve?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498645538, "post_id": 44799831, "comment_id": 76579669, "body": "@Nathan Sav, The Image1 Shows the sheet1 i have and Image 2 Shows the sheet2, in the column result, i want the sum of each column from sheet1."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498645584, "post_id": 44799831, "comment_id": 76579704, "body": "@Nathan_Sav should i edit my post still ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498645732, "post_id": 44799831, "comment_id": 76579811, "body": "@Nathan_Savinstead typing in each row in sheet2 in column result =Sum(BW! AD2:AD591) I Need an vba that would sum each column in sheet1 and print the sum result in sheet2 column Result."}, {"owner": {"reputation": 907, "user_id": 5752528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b1754f69488117c0de4445a406fef4?s=128&d=identicon&r=PG&f=1", "display_name": "Nitesh Halai", "link": "https://stackoverflow.com/users/5752528/nitesh-halai"}, "edited": false, "score": 0, "creation_date": 1498645772, "post_id": 44799831, "comment_id": 76579839, "body": "Wouldn&#39;t the use of pivot tables be easier?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498645834, "post_id": 44799831, "comment_id": 76579881, "body": "Nitesh Halai, The Problem of Pivot is not possible, because i have designed this template in my worksheet. Pivot is not accepting them"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1498645974, "post_id": 44799831, "comment_id": 76579963, "body": "look at <code>OFFSET</code> and <code>MATCH</code>  offset A1:A100 based on the match of Reason in row 1 of sheet1, a formula would be something like this <code>=SUM(OFFSET(Sheet1!$A$2:$A$10,0,MATCH(Reason!A1,Sheet1!$A$1:&zwnj;&#8203;$B$1,0)-1))</code>"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498646089, "post_id": 44799831, "comment_id": 76580025, "body": "@Nathan_Sav sorry, i dint get your point"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498646177, "post_id": 44799831, "comment_id": 76580083, "body": "Give it more than 2 minutes research :)"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498646241, "post_id": 44799831, "comment_id": 76580124, "body": "I am sorry, i dint understand what you meant, thats why replied quickly."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498646559, "post_id": 44799831, "comment_id": 76580291, "body": "you could even have static fomula and derive the headers for reasons from row 1 of sheet 1, so naturally in sync Reason a1=Sheet1 a1, Reason a2=sheet1 b1 for example..."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498646748, "post_id": 44799831, "comment_id": 76580409, "body": "@Nathan_Sav the above you suggested a formula ? but i Need an VBA"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498646816, "post_id": 44799831, "comment_id": 76580461, "body": "Which is why I showed the formula, so you can work it out in VBA.  Your code adds a formula any way :)"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498646849, "post_id": 44799831, "comment_id": 76580481, "body": "instaed doing Offset, i would rather go with sum which will be easy ryt?"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498651581, "post_id": 44801256, "comment_id": 76583720, "body": "Thank you Mrig :) that is very eay to understand also."}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": true, "score": 2, "last_activity_date": 1498649629, "creation_date": 1498649629, "answer_id": 44801256, "question_id": 44799831, "link": "https://stackoverflow.com/questions/44799831/sum-acorss-sheets-in-vba/44801256#44801256", "title": "sum acorss sheets in vba", "body": "<p>Assumptions:</p>\n\n<ol>\n<li><code>Sheets(\"BW\")</code> is the sheet why you have data from <code>Column AD-AW</code></li>\n<li>In <code>Sheets(\"Reasons\")</code> <code>Column A</code> you have listed down the headers of <code>Sheets(\"BW\")</code> <code>Column AD-AW</code> in same order, so there's no need to match for the headers</li>\n<li>You want sum of corresponding <code>Sheets(\"Reasons\")</code> <code>Column A</code> items in <code>Sheets(\"Reasons\")</code> <code>Column B</code></li>\n<li><p>Last row of each sheet is on the basis of number of records in <code>Column A</code> of both sheets</p>\n\n<pre><code>Sub sum()\n    Dim BWlRow As Long, CWlRow As Long, i As Long\n    Dim Sformula As String\n    Dim wsBW As Worksheet, wsCW As Worksheet\n\n    Set wsBW = Sheets(\"BW\"): Set wsCW = Sheets(\"Reasons\")\n\n    BWlRow = wsBW.Cells(wsBW.Rows.Count, \"A\").End(xlUp).Row\n    CWlRow = wsCW.Cells(wsCW.Rows.Count, \"A\").End(xlUp).Row\n\n    Sformula = \"=SUM(INDIRECT(\"\"BW!\"\" &amp; CELL(\"\"address\"\",OFFSET(AD$2,0,ROW()-2)) &amp; \"\":\"\" &amp; CELL(\"\"address\"\",OFFSET(AD$10,0,ROW()-2))))\"\n\n    With wsCW\n        With .Range(.Cells(2, 2), .Cells(CWlRow, 2))\n            .Formula = Sformula\n            .Value = .Value\n        End With\n    End With\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 44801256, "answer_count": 1, "score": 0, "last_activity_date": 1498649629, "creation_date": 1498645366, "question_id": 44799831, "link": "https://stackoverflow.com/questions/44799831/sum-acorss-sheets-in-vba", "title": "sum acorss sheets in vba", "body": "<p>I have two Sheets , sheet1 called BW, and sheet 2 called reasons.</p>\n\n<p>In sheet 1 I have columns AD till AW, which has to be added individually. i have table in sheet2, where I have listed the column names of AD till AW . in the second column of sheet 2 i Need the sum of column AD till AW. I tried a code like below</p>\n\n<pre><code>Sub sum()\n\n    Dim BWlRow As Long, CWlRow As Long, i As Long\n    Dim Sformula As String\n    Dim wsBW As Worksheet, wsCW As Worksheet\n\n    Set wsBW = Sheets(\"BW\"): Set wsCW = Sheets(\"Reasons\")\n\n    BWlRow = wsBW.Cells(wsBW.Rows.Count, \"A\").End(xlUp).Row\n    CWlRow = wsCW.Cells(wsCW.Rows.Count, \"A\").End(xlUp).Row\n\n\n    For i = 30 To 47 '\n        Sformula = \"=SUM(AD2, BW)\"\n\n\n      With wsBW\n    With .Range(.Cells(2, i), .Cells(BWlRow, i))\n        .Formula = Sformula\n        .Value = .Value\n    End With\nEnd With\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I am not able to succeed with this. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Yt8pD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yt8pD.png\" alt=\"I have like this in sheet 1 from column AD till AW\"></a>\n<a href=\"https://i.stack.imgur.com/dVfy9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dVfy9.png\" alt=\"I Need to have this result.\"></a></p>\n"}, {"tags": ["excel", "error-handling", "vba"], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": true, "score": 1, "last_activity_date": 1498644648, "creation_date": 1498644648, "answer_id": 44799577, "question_id": 44799448, "link": "https://stackoverflow.com/questions/44799448/how-to-stop-excel-from-running-through-all-the-errors/44799577#44799577", "title": "how to stop excel from running through all the errors", "body": "<p>Try adding a line <code>Exit Sub</code> after the message box. Execution continues after the messagebox for error1.</p>\n\n<p>So it should look like this:</p>\n\n<pre><code>Exit Sub\n\nerror1\n    MsgBox \"Claims followup.xlsm is not open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"Open the file in read/write\"\n    Exit Sub\nerror2\n    MsgBox \"Please make sure that the Claims followup file is open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"If the file is open make sure that you the Solicitation Number is written correctly.\"\n    Exit Sub\nerror3\n    MsgBox \"Your Claim followup file is in -read only- mode. Your changes may not be saved\"\n    Exit Sub\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 415, "user_id": 8046743, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-237d2qB61Ek/AAAAAAAAAAI/AAAAAAAAAo4/uI3mifr9y4c/photo.jpg?sz=128", "display_name": "Sourav De", "link": "https://stackoverflow.com/users/8046743/sourav-de"}, "is_accepted": false, "score": 0, "last_activity_date": 1498644856, "creation_date": 1498644856, "answer_id": 44799651, "question_id": 44799448, "link": "https://stackoverflow.com/questions/44799448/how-to-stop-excel-from-running-through-all-the-errors/44799651#44799651", "title": "how to stop excel from running through all the errors", "body": "<p>If you are trying to differentiate between error you can do so using <code>Err.Number</code> and catch the specific error and show message accordingly so in you case it should be:</p>\n\n<pre><code>    `Sub some_sub()\n\n        On Error GoTo errorHandler\n        Some code here   \n\n\n    Exit Sub\n    errorHandler:\nif Err.Number= Err no corresponds to Claims followup.xlsm is not open\n    MsgBox \"Claims followup.xlsm is not open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"Open the file in read/write\"\nelseif Err.Number = Err no corresponds to Solicitation Number is written correctly\n        MsgBox \"Please make sure that the Claims followup file is open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"If the file is open make sure that you the Solicitation Number is written correctly.\"    \nelseif Err.Number = Err no corresponds to Claim followup file is in -read only- mode\n        MsgBox \"Your Claim followup file is in -read only- mode. Your changes may not be saved\"\n\n    End Sub\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1498646736, "creation_date": 1498646736, "answer_id": 44800304, "question_id": 44799448, "link": "https://stackoverflow.com/questions/44799448/how-to-stop-excel-from-running-through-all-the-errors/44800304#44800304", "title": "how to stop excel from running through all the errors", "body": "<p>Try to avoid the error in the first place.  For unexpected errors use a <code>Select...Case</code> in your error handler and have the code exit the procedure in the same place so all the required tidying up is performed.  </p>\n\n<p>I've added a couple of function that check files are open or exist.</p>\n\n<pre><code>Sub some_sub()\n\n    Dim x As Long\n    Dim y As Long\n    Dim wrkBk As Workbook\n    Dim wrkSht As Workbook\n    Dim sPath As String, sFile As String\n\n    On Error GoTo ErrorHandler\n\n        sPath = \"C:\\\"\n        sFile = \"Claims followup.xlsm\"\n\n        'Avoid error by checking file exists and is open.\n        If FileExists(sPath &amp; sFile) Then\n\n            'Avoided Error1 &amp; 2 completely by checking if the file is open first.\n            If WorkBookIsOpen(sPath &amp; sFile) Then\n                Set wrkBk = Workbooks(sFile)\n            Else\n                Set wrkBk = Workbooks.Open(sPath &amp; sFile)\n            End If\n\n            'Avoid error 3 by checking if it's read only first.\n            If Not wrkBk.ReadOnly Then\n\n                'These all throw errors.\n                x = \"A\"\n                y = 0\n                Debug.Print 20 / y\n\n                Set wrkSht = ThisWorkbook.Worksheets(\"Non Existent Worksheet\")\n\n            End If\n\n        End If\n\n            On Error GoTo 0\n\nSingleExitPoint:\n    'Tidy up, close connections, etc....\n\nExit Sub\n\nErrorHandler:\n    Select Case Err.Number\n        Case 13 'Type Mismatch\n            x = 0\n            Resume Next 'Continue on the line following the error.\n        Case 11 'Division by zero\n            y = 2\n            Resume 'Continue on the line that caused the error.\n        Case 9 'Subscript out of range\n            Resume SingleExitPoint\n\n    End Select\n\nEnd Sub\n\nPublic Function WorkBookIsOpen(FullFilePath As String) As Boolean\n\n    Dim ff As Long\n\n    On Error Resume Next\n\n    ff = FreeFile()\n    Open FullFilePath For Input Lock Read As #ff\n    Close ff\n    WorkBookIsOpen = (Err.Number &lt;&gt; 0)\n\n    On Error GoTo 0\n\nEnd Function\n\nPublic Function FileExists(ByVal FileName As String) As Boolean\n    Dim oFSO As Object\n    Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n    FileExists = oFSO.FileExists(FileName)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1252, "user_id": 2220657, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/304eee32aaa733abc444e925f91dd9ae?s=128&d=identicon&r=PG", "display_name": "Serge In&#225;cio", "link": "https://stackoverflow.com/users/2220657/serge-in%c3%a1cio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 44799577, "answer_count": 3, "score": 0, "last_activity_date": 1498646736, "creation_date": 1498644247, "last_edit_date": 1531161705, "question_id": 44799448, "link": "https://stackoverflow.com/questions/44799448/how-to-stop-excel-from-running-through-all-the-errors", "title": "how to stop excel from running through all the errors", "body": "<p>I have the following code to handle my errors:</p>\n\n<pre><code>Sub some_sub()\n\n    On Error GoTo error1\n    Some code here\n\n    On Error GoTo error2\n    Some more code here\n\n    On Error GoTo error3\n    final piece of code here\n\n\n\nExit Sub\n\nerror1\n    MsgBox \"Claims followup.xlsm is not open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"Open the file in read/write\"\n\nerror2\n    MsgBox \"Please make sure that the Claims followup file is open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"If the file is open make sure that you the Solicitation Number is written correctly.\"\n\nerror3\n    MsgBox \"Your Claim followup file is in -read only- mode. Your changes may not be saved\"\n\nEnd Sub\n</code></pre>\n\n\n\n<pre><code>Sub some_sub()\n\n    On Error GoTo error1\n    Some code here\n\n    On Error GoTo error2\n    Some more code here\n\n    On Error GoTo error3\n    final piece of code here\n\n\n\nExit Sub\n\nerror1\n    MsgBox \"Claims followup.xlsm is not open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"Open the file in read/write\"\n\nerror2\n    MsgBox \"Please make sure that the Claims followup file is open.\" &amp; Chr(10) &amp; Chr(10) &amp; \"If the file is open make sure that you the Solicitation Number is written correctly.\"\n\nerror3\n    MsgBox \"Your Claim followup file is in -read only- mode. Your changes may not be saved\"\n\nEnd Sub\n</code></pre>\n\n<p>However, when the \"error1\" is detected it fires \"error2\" and \"error3\" as well, but I only want it to fire \"error1\". If \"error2\" fires \"error3\" fires as well. And when error3 is fired it is the only one, so it is running from top to bottom from the error it found.</p>\n\n<p>My question is: How can I change this code so it only fires the error one of the errors?</p>\n\n<p>Thanks in advance for any help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498644915, "post_id": 44799412, "comment_id": 76579268, "body": "What do you mean with &quot;Global&quot;? That the entire OS doesn&#39;t update the screen or just Excel?"}, {"owner": {"reputation": 161, "user_id": 7955781, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c04d43b2ea06ddeb392897f5834a7869?s=128&d=identicon&r=PG&f=1", "display_name": "C. Henke", "link": "https://stackoverflow.com/users/7955781/c-henke"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498644994, "post_id": 44799412, "comment_id": 76579311, "body": "Actually just Excel."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498647949, "post_id": 44799412, "comment_id": 76581258, "body": "Now, since you don&#39;t have a full / code example I don&#39;t know what&#39;s going on in your solution. What you can do is run the code against a hidden Excel instance: <code>Dim xlApp as Application</code> and then use <code>Set xlApp = New Application</code> (it&#39;s hidden by default.) Next open/close files and do the edits in that instance. Since it&#39;ll never show, the screenupdating issue will simply not be there. I&#39;d need a full example to work out a more accurate answer."}], "owner": {"reputation": 161, "user_id": 7955781, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c04d43b2ea06ddeb392897f5834a7869?s=128&d=identicon&r=PG&f=1", "display_name": "C. Henke", "link": "https://stackoverflow.com/users/7955781/c-henke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498644161, "creation_date": 1498644161, "last_edit_date": 1531164843, "question_id": 44799412, "link": "https://stackoverflow.com/questions/44799412/global-screenupdating-deactivate", "title": "Global Screenupdating deactivate", "body": "<p>I am working on a project where the Screen should not update while working. \nUnfortunately I need to use a tool by SAP (SAPBEX) that activates this Updating again. </p>\n\n<p>Is there a way to do Application.ScreenUpdating = false globally so that no other functions are able to activate it again?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 2, "last_activity_date": 1498644511, "creation_date": 1498644511, "answer_id": 44799531, "question_id": 44799315, "link": "https://stackoverflow.com/questions/44799315/excel-vba-opening-new-application-microsoft-excel-is-waiting-for-another-appli/44799531#44799531", "title": "Excel vba, Opening new Application: Microsoft Excel is waiting for another application to complete an OLE action", "body": "<p>This happens because the Excel instance in <code>ExcelApp</code> is waiting for User Input, most likely. </p>\n\n<p>You can try to add <code>ExcelApp.DisplayAlerts = False</code> to skip any pop-ups that might be there.</p>\n\n<p>Also, while troubleshooting add the line <code>ExcelApp.Visible = True</code> so you can see what's going on in the second instance and troubleshoot there.</p>\n\n<p>I encountered this problem in the following situations:</p>\n\n<ul>\n<li>An alert was opened by the Application Instance and it was awaiting user input.</li>\n<li>While opening a file, it was coming up with some message about a crash when the file was previously opened and whether I wanted to open the saved version or the in memory version (although this should happen before the <code>msgBox</code>)</li>\n<li>If you run the code multiple times and it crashes, it might have the file open as read only since there's another hidden instance of Excel that locked it (check your task manager for other Excel processes)</li>\n</ul>\n\n<p>Rest assured that in any case the problem is not with your code itself - It runs fine here.</p>\n"}, {"tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": false, "score": 1, "last_activity_date": 1498652479, "creation_date": 1498652479, "answer_id": 44802270, "question_id": 44799315, "link": "https://stackoverflow.com/questions/44799315/excel-vba-opening-new-application-microsoft-excel-is-waiting-for-another-appli/44802270#44802270", "title": "Excel vba, Opening new Application: Microsoft Excel is waiting for another application to complete an OLE action", "body": "<p>Code that works for me.</p>\n\n<p>You can select the file from FileDialog. In comments You have code that close the workbook without saving changes. Hope it helps.</p>\n\n<pre><code>Option Explicit\n\nSub Import(Control As IRibbonControl)\nDim fPath As Variant\nDim WB As Workbook\nDim CW As Workbook\n\n\n\nOn Error GoTo ErrorHandl\nSet CW = Application.ActiveWorkbook\nfPath = Application.GetOpenFilename(FileFilter:=\"Excel file, *.xl; *.xlsx; *.xlsm; *.xlsb; *.xlam; *.xltx; *.xls; *.xlt \", Title:=\"Choose file You want to openn\")\nIf fPath = False Then Exit Sub\nApplication.ScreenUpdating = False\nSet WB = Workbooks.Open(FileName:=fPath, UpdateLinks:=0, IgnoreReadOnlyRecommended:=True)\nSet WB = ActiveWorkbook\n\nMsgBox(\"File was opened.\")\n\n'Application.DisplayAlerts = False\n'WB.Close SaveChanges:=False\n'Application.DisplayAlerts = True\n'MsgBox (\"File was closed\")\nExit Sub\n\n\nErrorHandl:\nMsgBox (\"Error occured. It is probable that the file that You want to open is already opened.\")\nExit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1385, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1498652479, "creation_date": 1498643903, "question_id": 44799315, "link": "https://stackoverflow.com/questions/44799315/excel-vba-opening-new-application-microsoft-excel-is-waiting-for-another-appli", "title": "Excel vba, Opening new Application: Microsoft Excel is waiting for another application to complete an OLE action", "body": "<p>I have the following vba code. It creates new Excel application and uses it to open a file. Then it MsgBoxes some cell's value in this file.    </p>\n\n<pre><code>Sub TestInvis()\n        Dim ExcelApp As Object\n        Set ExcelApp = CreateObject(\"Excel.Application\")\n\n        Dim WB As Workbook\n        Set WB = ExcelApp.Application.Workbooks.Open(\"Y:\\vba\\test_reserves\\test_data\\0503317-3_FO_001-2582480.XLS\")\n\n        Dim title As String\n        title = WB.Worksheets(1).Cells(5, 4).Value\n        MsgBox (title)\n\n        WB.Save\n        WB.Close\n\n        ExcelApp.Quit\n        Set ExcelApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>The problem is that after MsgBoxing it slows down and eventually gives a <code>Microsoft Excel is waiting for another application to complete an OLE action</code> window. Why does it do this? It's not like there are any hard commands being implemented. And how should I deal with it?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498643169, "post_id": 44798861, "comment_id": 76578079, "body": "Where do you set <code>extractedFirstRow</code>? Is that a public / global variable which is available to the routine? Are the <code>sheetEXTRACTED</code> and <code>sheetCTF</code> the actual sheetnames in VBE or are they the tab names? In that case you&#39;d need <code>Worksheets(&quot;sheetEXTRACTED&quot;)</code>"}, {"owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498643931, "post_id": 44798861, "comment_id": 76578595, "body": "Sorry, yes <code>extractedFirstRow</code> is a global variable in a different module. And yes they are both the actual sheet names set in a different module."}], "answers": [{"tags": [], "owner": {"reputation": 1063, "user_id": 8019379, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZcQhe.png?s=128&g=1", "display_name": "Lucas Raphael Pianegonda", "link": "https://stackoverflow.com/users/8019379/lucas-raphael-pianegonda"}, "is_accepted": true, "score": 1, "last_activity_date": 1498643039, "creation_date": 1498643039, "answer_id": 44799008, "question_id": 44798861, "link": "https://stackoverflow.com/questions/44798861/vba-run-time-error-1004-when-called-from-different-worksheet/44799008#44799008", "title": "VBA: Run time error 1004 when called from different worksheet?", "body": "<p>I suggest:</p>\n\n<pre><code>Sub SUB_copyCtfColsToExtracted(sourceCol As Long, destCol As Long)\n\nsheetCTF.Range(sheetCTF.Cells(ctfHeadingRow, sourceCol), sheetCTF.Cells(ctfLastRow,sourceCol)).SpecialCells(xlCellTypeVisible).Copy _\nDestination:=sheetEXTRACTED.Range(sheetEXTRACTED.Cells(extractedFirstRow, destCol).Address)\n\nEnd Sub\n</code></pre>\n\n<p>This should resolve the problem. The error apears if the reference to a object like \"range()\" or \"Cells\" is not clearly defined.</p>\n"}], "owner": {"reputation": 301, "user_id": 3433053, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b08b686f8d28b970829bc41338824850?s=128&d=identicon&r=PG&f=1", "display_name": "Slab", "link": "https://stackoverflow.com/users/3433053/slab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 44799008, "answer_count": 1, "score": 0, "last_activity_date": 1498643039, "creation_date": 1498642633, "last_edit_date": 1531164843, "question_id": 44798861, "link": "https://stackoverflow.com/questions/44798861/vba-run-time-error-1004-when-called-from-different-worksheet", "title": "VBA: Run time error 1004 when called from different worksheet?", "body": "<p>If this sub is called via the worksheet \"sheetCTF\" then it works. If it is called via the worksheet \"sheetEXTRACTED\" then I get</p>\n\n<p>\"Run time error 1004 - Method 'Range' of object '_Worksheet' failed\"</p>\n\n<p>Why?</p>\n\n<pre><code>Public Const ctfHeadingRow As Long = 1\nPublic Const ctfLastRow As Long = 200\n\nSub SUB_copyCtfColsToExtracted(sourceCol As Long, destCol As Long)\n\nsheetCTF.Range(Cells(ctfHeadingRow, sourceCol), Cells(ctfLastRow,sourceCol)).SpecialCells(xlCellTypeVisible).Copy _\nDestination:=sheetEXTRACTED.Range(Cells(extractedFirstRow, destCol).Address)\n\nEnd Sub\n</code></pre>\n\n<p>(Sheet are set in different module).</p>\n"}, {"tags": ["excel", "ms-word", "vba"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498642831, "post_id": 44798711, "comment_id": 76577833, "body": "Yes this is possible. What have you tried so far and where did you get stuck? Please read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1498645135, "post_id": 44798711, "comment_id": 76579390, "body": "@RikSportel I am learning by doing and I have come so far as serching for alternativs. i found some questions about similar things on this site but i wanted to make a question as well. I noticed now that the texts that i wanted to improt was in table form so it should be easyer. Still, thank you for youre responce though it was  badly asked."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498652852, "post_id": 44800962, "comment_id": 76584699, "body": "Can you explain this line a bit:  Set wApp = New Word.Application &#39;Get a word application object, so you can open and manipulate documents from your Excel macro"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498653280, "post_id": 44800962, "comment_id": 76585014, "body": "<code>Set wApp = New Word.Application</code> opens/creates a Word instance. By default it is invisible. If you add <code>wApp.Visible = True</code> on the next line, you&#39;ll see what it did. The part after the &#39; is just a comment. I assume the code will be part of an Excel macro, that&#39;s why you need the reference to a <code>Word.Application</code> object - Excel itself doesn&#39;t read word files."}, {"owner": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498707697, "post_id": 44800962, "comment_id": 76612097, "body": "Ok, so basically I make a macro that copies the table from Word into Excel and the macro is then linked to the VBA? Is it possible to determine which table it should copy via VBA or do I have to make one makro per table? In the workbook I am using there is an active table of &quot;option-numbers&quot; that varies from every project. The same &quot;option-numbers&quot; are in the Word-file i am copying from."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498719481, "post_id": 44800962, "comment_id": 76616570, "body": "VBA is the programming language in which you write macros.  You need a Macro in Excel that opens word documents and copies tables.  My answer provides the starting point: open the word documents and finding the tables in there, so take it from there.  This is the point where you start trying and write your own code.  If you run into trouble, post a specific question with a code example so we can help you with that. We can&#39;t do your work for you - SO is not a free coding service."}, {"owner": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498731588, "post_id": 44800962, "comment_id": 76624747, "body": "So, now i tried to make my macro, that opens the word-file, copies and paste it in ecxel. I used some of the codes you gave me but since i don&#180;t need to edit the table only copy it I deleted from &quot;set wtable&quot; to wDoc. When i tried to run it gives an error on the last row of the module. The error is 1004, pastespecial mothod in worksheet-class falied. the last row looks like this:     ActiveSheet.PasteSpecial Format:=&quot;HTML&quot;, Link:=False, DisplayAsIcon:= _         False, NoHTMLFormatting:=True"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498733276, "post_id": 44800962, "comment_id": 76625777, "body": "Good. So my answer was what you needed to get started. Mark it as such then. Next, you can ask a new and specific question for your new and specific problem, where you provide the code you have so far. People will be happy to help."}, {"owner": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498734219, "post_id": 44800962, "comment_id": 76626455, "body": "Will do, how do I get the code pasted in a more neat and readble way? Have been trying touse the formatting in the help link without success."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498734293, "post_id": 44800962, "comment_id": 76626510, "body": "Just paste it, select it and click the {} button"}, {"owner": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498737505, "post_id": 44800962, "comment_id": 76628826, "body": "Where do i find that button? Do I have to download google prettify?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "edited": false, "score": 0, "creation_date": 1498737701, "post_id": 44800962, "comment_id": 76628982, "body": "Dude... When you write a question or an answer (and you&#39;re about to post a second question) there&#39;s some mark-up tools there above the field in which you write..."}], "tags": [], "owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "is_accepted": false, "score": 0, "last_activity_date": 1498648738, "creation_date": 1498648738, "answer_id": 44800962, "question_id": 44798711, "link": "https://stackoverflow.com/questions/44798711/how-to-inport-text-from-ms-word-via-vba-commandbutton/44800962#44800962", "title": "How to inport text from MS Word via vba-commandbutton", "body": "<p>Alright, since your question does not hold any code and doesn't really tell us much about the approach you're after, I'll just give some general pointers on how to access tables in a word document from an Excel macro.</p>\n\n<p>First, you'll need to add a reference to the <code>Microsoft Word #.# Object Library</code>. To do this, open your VBE (alt+F11), click on <code>tools</code>, <code>References...</code> and check the checkbox for this library. The <code>#.#</code> above is the version number. For example word 2016 will be the <code>Microsoft Word 16.0 Object Library</code>.</p>\n\n<p>Now you'll have access to Word objects in your Excel VBE. \nYou can do something like this:</p>\n\n<pre><code>Sub Test()\nDim wApp As Word.Application\nDim wDoc As Word.Document\nDim wTable As Word.Table\nDim r As Word.Row\nDim c As Word.Cell\n\nSet wApp = New Word.Application 'Get a word application object, so you can open and manipulate documents from your Excel macro.\nSet wDoc = wApp.Documents.Open(\"C:\\temp\\temp.docx\") 'Open your document.\n\nSet wTable = wDoc.Tables(1) 'To access the first table in the document\n\nFor Each r In wTable.Rows 'Loop over Word table rows\n    For Each c In r.Cells 'Loop over Word table cells\n        'Do stuff with the table:\n        MsgBox c.Range.Text\n        ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\").Value = c.Range.Text\n    Next c\nNext r\n\n'and clean up after yourself:\nSet wTable = Nothing\n\nwDoc.Close SaveChanges:=False\nwApp.Quit\n\nSet wDoc = Nothing\nSet wApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>Good luck.</p>\n"}], "owner": {"reputation": 1, "user_id": 8225089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d973a0e8db125654539d7a4965d10bd?s=128&d=identicon&r=PG&f=1", "display_name": "J.Nyman", "link": "https://stackoverflow.com/users/8225089/j-nyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1498648738, "creation_date": 1498642287, "last_edit_date": 1531164843, "question_id": 44798711, "link": "https://stackoverflow.com/questions/44798711/how-to-inport-text-from-ms-word-via-vba-commandbutton", "title": "How to inport text from MS Word via vba-commandbutton", "body": "<p>I am trying to make a configuration tool that is linked to several Excel-files.\nThey are all linked by an \"option-number\".\nAre there any way to import a portion of a whole MS Word-document via the \n\"option-number\" link to Excel?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1498641427, "post_id": 44798349, "comment_id": 76576839, "body": "A <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"nofollow noreferrer\">UUID/GUID (Universally unique identifier)</a> could be an approach to generate unique IDs without a need to document them in a list and no need to lookup for free unique IDs."}, {"owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498642288, "post_id": 44798349, "comment_id": 76577450, "body": "I forgot to mention that this unique ID must be exactly 6 digits lenght. (I expect about 50-100 documents created every day. So I expect it to raise by 1 from 000001 to 999999"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498643090, "post_id": 44798349, "comment_id": 76578025, "body": "6 digits is not much. You will need a global system accessible to every user that gives out the next valid free ID (Excel is not suitable for this approach you will just end up fiddling around, without having a solid and reliable solution)."}, {"owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1498643491, "post_id": 44798349, "comment_id": 76578278, "body": "For now 1 person is gathering all docs, printing it and making a stamp (phisically). Stamp increases by 1 every time it&#39;s &quot;stamped&quot;. I&#39;m looking for idea to avoid printing and making stamps digitally."}], "answers": [{"comments": [{"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1498643336, "post_id": 44798882, "comment_id": 76578193, "body": "This could work with just using the last four digits as a counter.  It will allow each of the 100 (00-99) users to create 10,000 records. (000000 - 009999 to 990000 - 999999).  You&#39;d have to store the number as text to allow for leading zeros.  My first thought was to use a database - no file sharing problems then, but I find there&#39;s always problems with getting management/IT Support to allow small databases (Access specifically)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1498643488, "post_id": 44798882, "comment_id": 76578277, "body": "@DarrenBartrup-Cook Well, the database would work as a charm - it would take care of instant access and would queue the users appropriately. Concerning the leading zeroes - you store the numbers as INT, and if you get <code>23</code> you make it to <code>000023</code> in your code, the database is used as a counter."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1498643626, "post_id": 44798882, "comment_id": 76578382, "body": "I was thinking of the leading zeros in Excel.  In a database most of the problems magically disappear.... to be replaced by other ones."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1498643638, "last_edit_date": 1498643638, "creation_date": 1498642673, "answer_id": 44798882, "question_id": 44798349, "link": "https://stackoverflow.com/questions/44798349/ensure-unique-value-id-in-excel-from-many-users/44798882#44798882", "title": "Ensure unique value (ID) in Excel from many users", "body": "<p>Best case scenario for 6 digit uniquness, I can think of:</p>\n\n<ul>\n<li>Assign every user a specific number, depending on his username. Use Environ(\"Username\") for this. Thus the first two digits are taken. Up to 100 users.</li>\n<li>For the next 4 digits, use the time it was created. Using <code>Now()</code></li>\n<li>Hope that no user would create 2 files within one minute. Or make sure that the code runs more than a minute.</li>\n<li>Then speak with your bosses and ask for 6 digits more, to ensure uniqueness. </li>\n<li>Add day, month and year.</li>\n</ul>\n\n<p>Or make a small DB with one table. In this table, you need one column with one value. Every user can access the value, then increment it automatically. It would work.</p>\n\n<p>As a worst case and science fiction scenario, if you are not allowed to use a DB - use GoogleDocs. Make a new user, set a new password and make the incrementer of a the counter there. Then access it through the code. And increment it.</p>\n"}], "owner": {"reputation": 155, "user_id": 4968648, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8bb2f7933dec1fc3a31d67dbe1dbbf84?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Plich", "link": "https://stackoverflow.com/users/4968648/micha%c5%82-plich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1498643638, "creation_date": 1498641317, "question_id": 44798349, "link": "https://stackoverflow.com/questions/44798349/ensure-unique-value-id-in-excel-from-many-users", "title": "Ensure unique value (ID) in Excel from many users", "body": "<p>I have many users, creating documents in Excel, working in many different workstations (in one company).\nI need to ensure unique ID number for each document created.</p>\n\n<p>The only solution I came up is to create shared Excel file with prepared unique ID in column A, and Status (Free/In Use) in Column B, and every time user needs ID, he uses macro to search first Free status in column B, take value from column A, and set status to In Use.\nI do not like this solution - are there any more stable and reliable ideas?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498642093, "post_id": 44798228, "comment_id": 76577311, "body": "What error is shown on what line precisely?"}, {"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498642444, "post_id": 44798228, "comment_id": 76577557, "body": "when not debugging the application-defined or object-defined error message box occurs and the code stops.   When debugging, the listbox1.list line gets a variable not defined error when setup.activate is called from another module (setup is the worksheet name)"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498643061, "post_id": 44798228, "comment_id": 76578002, "body": "remove that code then if the control doesn&#39;t exist, comment the code out, or remove it."}, {"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1498643352, "post_id": 44798228, "comment_id": 76578209, "body": "I have done that in this instance, but there are many other workbooks that may be affected similarly (I&#39;ve fixed 2 others already), and I&#39;d like to find them myself"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498644697, "post_id": 44798228, "comment_id": 76579122, "body": "Do you know which workbooks are affected? If so, you could write code that manipulates their VBA project using the VBA extensibility library (after allowing programmatic access to the VBProject in the security center). This isn&#39;t very hard to do."}, {"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1498645383, "post_id": 44798228, "comment_id": 76579558, "body": "Not all of them, at the moment its playing whack a mole as they get reported.  If I can replicate the problem locally, I&#39;ll run them sequentially."}, {"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1498645522, "post_id": 44798228, "comment_id": 76579660, "body": "Actually, If I&#39;m going to do that I may as well just do a full compile on each workbook to flush out any hidden errors."}, {"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1498645917, "post_id": 44798228, "comment_id": 76579934, "body": "I&#39;ll likely loop through all files in a folder and call compile detailed <a href=\"https://stackoverflow.com/questions/28001620/can-i-compile-vba-on-workbook-open\">here</a> I&#39;ll post code later.  Will solve the overall problem but its not really an answer to my question, so I&#39;ll leave it open."}], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1498641833, "post_id": 44798410, "comment_id": 76577134, "body": "Thanks for the response.  Option explicit is on at the start of the code (I&#39;ll update the question to include), and i have that setting on on my machine"}, {"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1498642055, "post_id": 44798410, "comment_id": 76577281, "body": "@Thomas: The setting does not affect existing modules, it only ensure Option Explicit is added to newly inserted modules."}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1498642593, "post_id": 44798410, "comment_id": 76577669, "body": "Yes I think it need some clarification, I adapt my answer"}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1506017038, "last_edit_date": 1506017038, "creation_date": 1498641512, "answer_id": 44798410, "question_id": 44798228, "link": "https://stackoverflow.com/questions/44798228/how-to-force-vba-compile-of-worksheet-code-on-worksheet-activate/44798410#44798410", "title": "How to force vba compile of worksheet code on worksheet.activate", "body": "<p>The Option explicit on top of your modules forces a variable check, you can comment it if you don't want the variable check, or add it if you want it.</p>\n\n<p>Note that this option can be added automatically in all new modules created, with a setting in the options:</p>\n\n<p>VBE's Tools \u25ba Options \u25ba Editor \u25ba Checkbox <em>Require Variable Declaration</em></p>\n"}, {"comments": [{"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1498657167, "post_id": 44802107, "comment_id": 76588184, "body": "Thanks for the comprehensive response. I will check if there are reference issues  (mine is x64 and his is new, so probably x64 but could be it)"}, {"owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "edited": false, "score": 0, "creation_date": 1498657426, "post_id": 44802107, "comment_id": 76588407, "body": "I also agree with error handling the offending code. These are inherited workbooks, which have quite a lot of technical debt - as evidenced by a deleted listbox but the event handler remaining. It&#39;s an on going process to improve them as I get time."}], "tags": [], "owner": {"reputation": 366, "user_id": 6855279, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/43315b5490866e1323c3f9240bbda572?s=128&d=identicon&r=PG&f=1", "display_name": "Mikisz", "link": "https://stackoverflow.com/users/6855279/mikisz"}, "is_accepted": false, "score": 0, "last_activity_date": 1498657350, "last_edit_date": 1498657350, "creation_date": 1498652035, "answer_id": 44802107, "question_id": 44798228, "link": "https://stackoverflow.com/questions/44798228/how-to-force-vba-compile-of-worksheet-code-on-worksheet-activate/44802107#44802107", "title": "How to force vba compile of worksheet code on worksheet.activate", "body": "<p>From my experience, errors sometimes occur in VBA on other machines when You use in Your code some commands specific to x86 architecture when other machine is x64 and due to the fact that You use references (in VBA Tools->references) that are not available on other machines. Last cause that I've met were different security settings, e. g. maybe Your code uses sth that requires access to vba object model (in Excel File->Options->Trust center->Trust center settings->Macro settings). So first of all I recommend to check the Windows architecture on the suspected machine. Then check the references that You use in a workbook. And at the end check the trust center settings. I think that it might be very probable that You will not get the same errors on Your machine as they might be specific to only one machine (e. g. different system architecture, some specific references or trust center settings). </p>\n\n<p>If the error is caused by a specific line in the code I understand that, e. g. there are two users of woorkbook and one deleted a tab, to which Your code reference and that causes the error. So I think that maybe a good approach for You will be to manage error. You can use On Error statements in vba, e. g. You have code that fires at workbook open and it runs three procedures from Modules, so You can do sth like this:</p>\n\n<p>On Error GoTo Procedure1Error</p>\n\n<p>here run procedure one</p>\n\n<p>On Error GoTo Procedure2Error</p>\n\n<p>here run procedure two</p>\n\n<p>On Error GoTo Procedure3Error</p>\n\n<p>here run procedure three</p>\n\n<p>Exit Sub</p>\n\n<p>Procedure1Error:</p>\n\n<p>MsgBox (\"Procedure 1 caused fatal error. Code was not executed.)\nExit Sub</p>\n\n<p>Procedure2Error:</p>\n\n<p>MsgBox (\"Procedure 2 caused fatal error. Code was not executed.)\nExit Sub</p>\n\n<p>Procedure3Error:</p>\n\n<p>MsgBox (\"Procedure 3 caused fatal error. Code was not executed.)\nExit Sub</p>\n\n<p>End Sub</p>\n\n<p>If You do not notify user about problems then You could use the just On Error resume next (Your code will continue to execute) but I do not recommend it.</p>\n"}], "owner": {"reputation": 398, "user_id": 6078278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e20571bec0ff1ae72b53cd22c31b295?s=128&d=identicon&r=PG&f=1", "display_name": "Phil", "link": "https://stackoverflow.com/users/6078278/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1506017038, "creation_date": 1498640925, "last_edit_date": 1498642812, "question_id": 44798228, "link": "https://stackoverflow.com/questions/44798228/how-to-force-vba-compile-of-worksheet-code-on-worksheet-activate", "title": "How to force vba compile of worksheet code on worksheet.activate", "body": "<p>I have inherited maintenance many excel sheets that are used by many people in my company.  Recently one user has started getting application-defined errors which do not occur on other computers.\nI've debugged on his machine, and they happen when a worksheet is activated.  It only occurs on worksheets with VBA in the sheet, and where there is an error in an unused routine.\neg.</p>\n\n<pre><code>option explicit\n\nsub RunReport()\n... \nSetup.Activate 'compilation error occurs here when debugging\n'I assume that this is the cause of the application-defined error which occurs when not debugging\n...\nend sub\n</code></pre>\n\n<p>workbook named Setup</p>\n\n<pre><code>Option Explicit\n\n.... other code    \n\nPrivate Sub ListBox1_Initialize()'Listbox1 has been deleted from the sheet so this is never called\n        Dim allReports() As String\n        allReports = Split(ALL_LOCS, DELIM)\n        ListBox1.list = allReports 'compile error here because listbox1 doesn't exist\n    End Sub\n</code></pre>\n\n<p>I assume that there is a setting that is calling a full compile of the code when the worksheet is activated.  I want to turn it on on my dev environment so I can investigate these issues locally.<br>\nWhere can I find this setting?\n(I am using office 2013)</p>\n\n<p>Edit:\nFor clarifcation based on answers.\nOption Explicit is set at the start of the code.  I have autosyntax checking and require variable declaration set on my dev setup that does not experience this issue.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498639923, "post_id": 44797793, "comment_id": 76575840, "body": "I prefer comparing dates with <code>DateDiff</code> function."}, {"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 1, "creation_date": 1498640057, "post_id": 44797793, "comment_id": 76575916, "body": "Your problem can be cause if your 2 dates contains hours and minutes.  You need to format them and in case they contain hours and minutes you need to split them and the you can get rid of the hr and min."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498640289, "post_id": 44797793, "comment_id": 76576075, "body": "@lonut how do i get rid of the hours and min"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498640328, "post_id": 44797793, "comment_id": 76576100, "body": "try <code>cdate(.Cells(i, 27).Value)</code> or even something like <code>cdate(replace(.Cells(i, 27).Value,&quot;.&quot;,&quot;&#47;&quot;))</code>"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498640550, "post_id": 44797793, "comment_id": 76576241, "body": "@Nathan_Sav still the Problem exist. I have time stamp in my column"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498640584, "post_id": 44797793, "comment_id": 76576261, "body": "@ShaiRado can you tell me how I can use that here?"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498640625, "post_id": 44797793, "comment_id": 76576281, "body": "Give me half an hour, I&#39;m having lunch now"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498640653, "post_id": 44797793, "comment_id": 76576303, "body": "Sure. @ShaiRado I can wait"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1498640949, "post_id": 44797793, "comment_id": 76576496, "body": "<code>format(.Cells(i, 27).Value,&quot;dd&#47;mm&#47;yyyy&quot;)</code>  ???<code>format(replace(.Cells(i, 27).Value,&quot;.&quot;,&quot;&#47;&quot;),&quot;dd&#47;mm&#47;yyyy&quot;)</code>  Can you show an example of some data in the post."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1498640989, "post_id": 44797793, "comment_id": 76576524, "body": "If you want to ignore the time portion of a date field, just use <code>Int</code> - i.e. <code>If Int(.Cells(i, 27).Value) &lt;= Int(.Cells(i, 23).Value) Then</code>"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 0, "creation_date": 1498641103, "post_id": 44797793, "comment_id": 76576615, "body": "Look up DateDiff. Or else crudely you could do int or fix functions."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1498641268, "post_id": 44797793, "comment_id": 76576734, "body": "@YowE3K Yes, this is in addition to my CDATE post earlier."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1498641665, "post_id": 44797793, "comment_id": 76577023, "body": "@YowE3K Thank you it works."}, {"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 0, "creation_date": 1498641918, "post_id": 44797793, "comment_id": 76577185, "body": "@Mikz if your date contains hr and minute(it should look like this mm/dd/yyyy hr:mm:ss) and if you are using an array to read them, you can use this statement: dim date() as string  date()= Split(your_array, &quot; &quot;) and then the result only with the date will be date(0). In case you don&#39;t use array you can still replace the array statement with a string or with the statement you currently use cells(x,y).value."}], "answers": [{"tags": [], "owner": {"reputation": 638, "user_id": 5784703, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/baf58841d489e6b0ff32d3551f420806?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Burns", "link": "https://stackoverflow.com/users/5784703/mr-burns"}, "is_accepted": false, "score": 1, "last_activity_date": 1498642545, "creation_date": 1498642545, "answer_id": 44798817, "question_id": 44797793, "link": "https://stackoverflow.com/questions/44797793/compaing-dates-with-vba/44798817#44798817", "title": "Compaing dates with VBA", "body": "<p>Something like this should do it for you, your issue ,like the comments state, is that you are likely passing the time in your dates, the <code>Format</code> function will allow you to remove them, The reason for <code>On Error Resume Next</code> is that if the cells value is blank is will give the error <code>13 - Type Mismatch</code></p>\n\n<pre><code>Sub Compare1()\n\n    Dim i As Long, lngLastRow As Long\n    Dim ws As Worksheet\n    Dim FirstDate As Date, SecondDate As Date\n\n    Set ws = Sheets(\"BW\")\n\n    With ws\n\n        For i = 2 To 591\n\n            On Error Resume Next\n            FirstDate = Format(.Cells(i, \"AA\").Value, \"dd/mm/yyyy\")\n            SecondDate = Format(.Cells(i, \"W\").Value, \"dd/mm/yyyy\")\n            On Error GoTo 0\n\n            If FirstDate = Empty Then\n                .Cells(i, 28).Value = \"N/A\"\n            Else\n                If FirstDate &lt;= SecondDate Then\n                    .Cells(i, \"AB\").Value = \"OK\"\n                    .Cells(i, \"AB\").Interior.Color = RGB(0, 255, 0)\n                Else\n                    .Cells(i, \"AB\").Value = \"NOK\"\n                    .Cells(i, \"AB\").Interior.Color = RGB(255, 0, 0)\n                End If\n            End If\n\n        Next i\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>You can also use the below instead of the <code>If</code> statement, I personally feel it is simpiler and clean but that is personal preference</p>\n\n<pre><code>Select Case FirstDate\n    Case Is = \"\"\n        .Cells(i, \"AB\").Value = \"N/A\"\n    Case Is &lt;= SecondDate\n        .Cells(i, \"AB\").Value = \"OK\"\n        .Cells(i, \"AB\").Interior.Color = RGB(0, 255, 0)\n    Case Is &gt; SecondDate\n        .Cells(i, \"AB\").Value = \"NOK\"\n        .Cells(i, \"AB\").Interior.Color = RGB(255, 0, 0)\nEnd Select\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498644329, "post_id": 44799352, "comment_id": 76578874, "body": "because they from database, and it cant be ignored."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498678348, "post_id": 44799352, "comment_id": 76602594, "body": "@Mikz If the data is from a database, and the designer of the database decided that it was important that the fields contain a specific time, it is probably wrong to treat 10:00am as being earlier than 7:00am, so your current code is probably working correctly."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1498680838, "post_id": 44799352, "comment_id": 76604010, "body": "currently it is working fine. Both the ideas are good, with datediff and INT"}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1498643989, "creation_date": 1498643989, "answer_id": 44799352, "question_id": 44797793, "link": "https://stackoverflow.com/questions/44797793/compaing-dates-with-vba/44799352#44799352", "title": "Compaing dates with VBA", "body": "<p>If your columns W and AA contain dates <strong>with times</strong>, the easiest fix is to just remove those times by taking the integral part of the date/time value.</p>\n\n<p>So you can use:</p>\n\n<pre><code>If Int(.Cells(i, 27).Value) &lt;= Int(.Cells(i, 23).Value) Then\n</code></pre>\n\n<hr>\n\n<p>Just be aware that this will be deciding that a date/time of, for instance, 10:00am on 28 June 2017 is less than or equal to 7:00am on the same date, which sounds like what you are trying to do - but it does raise the question of why the times are in the cells if they are just going to be ignored anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 2, "last_activity_date": 1498645835, "creation_date": 1498645835, "answer_id": 44800003, "question_id": 44797793, "link": "https://stackoverflow.com/questions/44797793/compaing-dates-with-vba/44800003#44800003", "title": "Compaing dates with VBA", "body": "<p>You can use the <code>DateDiff</code> function to get the Delta between 2 dates.</p>\n\n<p>When putting \"d\" as the first parameter, you are checking the delta in days, so if both dates are the same, just the hourse ar different, the result will still be <code>0</code>.</p>\n\n<p>To learn more about <code>DateDiff</code> function go to <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/datediff-function\" rel=\"nofollow noreferrer\">MSDN</a></p>\n\n<p><strong><em>Code</em></strong>  </p>\n\n<pre><code>Sub Compare1()\n\n    Dim i               As Long\n    Dim lngLastRow      As Long\n    Dim ws              As Worksheet\n    Dim DeltaDays       As Long\n\n    Set ws = Sheets(\"BW\")\n    With ws\n        For i = 2 To 591\n            If .Cells(i, 27).Value = \"\" Then\n                .Cells(i, 28).Value = \"N/A\"\n            Else\n                DeltaDays = DateDiff(\"d\", .Cells(i, 27).Value, .Cells(i, 23).Value)\n                If DeltaDays &lt;= 0 Then\n                    .Cells(i, 28).Value = \"OK\"\n                    .Cells(i, 28).Interior.Color = RGB(0, 255, 0)\n                Else\n                    .Cells(i, 28).Value = \"NOK\"\n                    .Cells(i, 28).Interior.Color = RGB(255, 0, 0)\n                End If\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44800003, "answer_count": 3, "score": 0, "last_activity_date": 1498645835, "creation_date": 1498639727, "last_edit_date": 1498639880, "question_id": 44797793, "link": "https://stackoverflow.com/questions/44797793/compaing-dates-with-vba", "title": "Compaing dates with VBA", "body": "<p>I am comparing two Dates in column W and AA. \nThe case is if Column AA > W, then it should print Nok.\nIf column AA &lt;= W , then it should print OK.</p>\n\n<p>I have my code working. but the Problem is  equal to condition is not satisfied.  </p>\n\n<p>For eg I have a date 01.09.2017 in column W and AA, According to the formula it should be Ok, but it prints NOK. </p>\n\n<p>Could anyone tell me , what is wrong with the condition. I want it to do in VBA. </p>\n\n<pre><code>Sub Compare1()\n\n    Dim i               As Long\n    Dim lngLastRow      As Long\n    Dim ws              As Worksheet            \n\n    Set ws = Sheets(\"BW\")    \n    With ws            \n        For i = 2 To 591\n            If .Cells(i, 27).Value = \"\" Then            \n                .Cells(i, 28).Value = \"N/A\"\n            Else            \n                If .Cells(i, 27).Value &lt;= .Cells(i, 23).Value Then            \n                    .Cells(i, 28).Value = \"OK\"\n                    .Cells(i, 28).Interior.Color = RGB(0, 255, 0)            \n                Else                \n                    .Cells(i, 28).Value = \"NOK\"              \n                    .Cells(i, 28).Interior.Color = RGB(255, 0, 0)\n                End If            \n            End If                \n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 492, "user_id": 7434553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4dbF.png?s=128&g=1", "display_name": "IQV", "link": "https://stackoverflow.com/users/7434553/iqv"}, "edited": false, "score": 1, "creation_date": 1498639642, "post_id": 44797707, "comment_id": 76575643, "body": "You simply have to write two expressions, as you did it with <code>print</code>."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 1, "creation_date": 1498642962, "post_id": 44797707, "comment_id": 76577925, "body": "Don&#39;t use <code>And</code>, use <code>:</code> - or you could wrap the two lines in an <code>IF..END IF</code>"}, {"owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "edited": false, "score": 1, "creation_date": 1498643596, "post_id": 44797707, "comment_id": 76578361, "body": "And better use <code>ws2.Cells(i, 7)</code> insted of <code>ws2.Range(&quot;G&quot; &amp; i)</code>."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1498649359, "post_id": 44797707, "comment_id": 76582113, "body": "You could also loop backwards using <code>For i = Last to 2 Step -1</code>. That way you don&#39;t need the <code>i = i -1</code> line in the first place."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1498669857, "post_id": 44797707, "comment_id": 76597648, "body": "@maniA  have you read and tested the code in my answer below ? is it working for you as intended ?"}, {"owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "edited": false, "score": 0, "creation_date": 1499874358, "post_id": 44797707, "comment_id": 77097877, "body": "yes sorry I was absence! Thanks a lot"}], "answers": [{"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 5, "last_activity_date": 1498639637, "creation_date": 1498639637, "answer_id": 44797761, "question_id": 44797707, "link": "https://stackoverflow.com/questions/44797707/using-and-operator-after-then-of-a-if-condtion-in-vba/44797761#44797761", "title": "using And operator after &quot;Then&quot; of a If-condtion in VBA?", "body": "<p>If you want to perform multiple operations in case the <code>If</code> criteria is met, then you need to put each operation in a seperate line, and close the <code>If...</code> with an <code>End If</code>.</p>\n\n<p>Try the code below:</p>\n\n<pre><code>If InStr(1, strg, Delim &amp; ws2.Range(\"G\" &amp; i).Value &amp; Delim, vbTextCompare) Then\n    ws2.Range(\"G\" &amp; i).EntireRow.Delete\n    i = i - 1\nEnd If\n</code></pre>\n\n<p>You can delete an entire row also by using:</p>\n\n<pre><code>ws2.Rows(i).Delete\n</code></pre>\n"}], "owner": {"reputation": 1267, "user_id": 3305448, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/104e751a2bb56b5e1ea34d237b310065?s=128&d=identicon&r=PG&f=1", "display_name": "maniA", "link": "https://stackoverflow.com/users/3305448/mania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 44797761, "answer_count": 1, "score": 0, "last_activity_date": 1498639637, "creation_date": 1498639483, "last_edit_date": 1531164843, "question_id": 44797707, "link": "https://stackoverflow.com/questions/44797707/using-and-operator-after-then-of-a-if-condtion-in-vba", "title": "using And operator after &quot;Then&quot; of a If-condtion in VBA?", "body": "<p>part of my code looks as follows:</p>\n\n<pre><code>For i = 2 To Last Step 1\n      If InStr(1, strg, Delim &amp; ws2.Range(\"G\" &amp; i).Value &amp; Delim, vbTextCompare) Then _\n       ws2.Range(\"G\" &amp; i).EntireRow.Delete And i = i - 1\n\n       Debug.Print i\nNext i\n</code></pre>\n\n<p>The code works well without And-Part.\nI get an error because of <code>i=i-1</code>. How can I say if the condition true do This <code>AND</code> That?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91, "user_id": 7557408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e2ce02d4f8e8c9251c5fa62c54dfef3?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut", "link": "https://stackoverflow.com/users/7557408/ionut"}, "edited": false, "score": 1, "creation_date": 1498638681, "post_id": 44797231, "comment_id": 76575019, "body": "Please show us your code and what have you tried until now."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1498638743, "post_id": 44797231, "comment_id": 76575050, "body": "@Berend - really a well asked question, you simply miss the point that this is not a code-for-me-site and etc... Thus, show what you have tried until now."}, {"owner": {"reputation": 15, "user_id": 8224647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a9c686a6e4bc491bd8bb9f964e4712?s=128&d=identicon&r=PG&f=1", "display_name": "Berend Starkenburg", "link": "https://stackoverflow.com/users/8224647/berend-starkenburg"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1498640205, "post_id": 44797231, "comment_id": 76576019, "body": "@Vityata, Hmm, my fault. I uploaded this question before reading the guidelines."}, {"owner": {"reputation": 15, "user_id": 8224647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a9c686a6e4bc491bd8bb9f964e4712?s=128&d=identicon&r=PG&f=1", "display_name": "Berend Starkenburg", "link": "https://stackoverflow.com/users/8224647/berend-starkenburg"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1498646911, "post_id": 44797231, "comment_id": 76580525, "body": "@Vityata - I added the macro that I use now. The problem is that the reference ID stays the same as the base product reference ID. However, I want it to copy the combinations product reference ID."}], "answers": [{"comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 15, "user_id": 8224647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a9c686a6e4bc491bd8bb9f964e4712?s=128&d=identicon&r=PG&f=1", "display_name": "Berend Starkenburg", "link": "https://stackoverflow.com/users/8224647/berend-starkenburg"}, "edited": false, "score": 0, "creation_date": 1498658462, "post_id": 44802339, "comment_id": 76589368, "body": "@BerendStarkenburg - welcome. A few ideas for the next time you ask - make sure to remove all unnecessary info from your question and to summarize it to input, output and business logic. Otherwise, it gets too large. + always include what have you tried so far + code."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1498653491, "last_edit_date": 1498653491, "creation_date": 1498652633, "answer_id": 44802339, "question_id": 44797231, "link": "https://stackoverflow.com/questions/44797231/is-there-a-macro-to-conditionally-copy-data-to-another-worksheet/44802339#44802339", "title": "Is there a macro to conditionally copy data to another worksheet?", "body": "<p>This works. Just rename the three worksheets to <code>A</code>, <code>B</code> and <code>C</code>.</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\n    Dim lngCounter      As Long\n    Dim a               As Long '- do not name like this\n\n    Dim rngCell         As Range\n    Dim rngCell2        As Range\n\n    Dim rngSource       As Range\n\n    With Worksheets(\"B\")\n        Set rngSource = .Range(.Cells(1, 1), .Cells(5, 1))\n    End With\n\n    Worksheets(\"C\").Cells.Clear\n\n    With Worksheets(\"A\")\n\n    For Each rngCell In .Range(.Cells(1, 1), .Cells(5, 1))\n        For Each rngCell2 In rngSource\n            If rngCell2 = rngCell Then\n                a = a + 1\n                Worksheets(\"C\").Rows(a).Value = Worksheets(\"B\").Rows(rngCell2.Row).Value\n                Worksheets(\"C\").Cells(a, 4) = rngCell.Offset(0, 1)\n            End If\n        Next rngCell2\n    Next rngCell\n\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This is the result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/S7S1v.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S7S1v.png\" alt=\"enter image description here\"></a></p>\n\n<p>To make the code further workable, make sure that you make the ranges and the arrays with variables.</p>\n"}], "owner": {"reputation": 15, "user_id": 8224647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6a9c686a6e4bc491bd8bb9f964e4712?s=128&d=identicon&r=PG&f=1", "display_name": "Berend Starkenburg", "link": "https://stackoverflow.com/users/8224647/berend-starkenburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 44802339, "answer_count": 1, "score": 0, "last_activity_date": 1518801443, "creation_date": 1498638162, "last_edit_date": 1518801443, "question_id": 44797231, "link": "https://stackoverflow.com/questions/44797231/is-there-a-macro-to-conditionally-copy-data-to-another-worksheet", "title": "Is there a macro to conditionally copy data to another worksheet?", "body": "<p>At my work I have two databases with the same products. The first database contains all the products with all possible combinations (in this istance the database consists of motor exhausts, which are available in different colors and materials). The second database only contains the base product. The product ID of the combinations correspondences with the ID of the base products. The database with the base products also contains a lot of information about the products.</p>\n\n<p><strong>Sample data combinations</strong></p>\n\n<pre><code>- Product ID - Reference number\n1.12012        E3A02ET7\n2.12012        E3A02EN7\n3.12013        E3A02ES6\n4.12014        E9A03ES\n5.12014        E9A03EN\n</code></pre>\n\n<p><strong>Sample data base</strong></p>\n\n<pre><code>- Product ID - Name     -     Price - Reference number\n1.12012        Gilera Fuoco   \u20ac363    E3A02ET\n2.12013        Gilera Nexus   \u20ac363    E3A02ES\n3.12014        Gilera Runner  \u20ac363    E9A03EN\n</code></pre>\n\n<p><strong>Prefered output</strong></p>\n\n<pre><code> - Product ID - Name     -     Price - Reference number\n1. 12012        Gilera Fuoco   \u20ac363    E3A02ET7\n2. 12012        Gilera Fuoco   \u20ac363    E3A02EN7\n3. 12013        Gilera Nexus   \u20ac363    E3A02ES6\n4. 12014        Gilera Runner  \u20ac363    E9A03ES\n5. 12014        Gilera Runner  \u20ac363    E9A03EN\n</code></pre>\n\n<p>Since I want to upload every product to my webshop, I need to format the combinations database in the same way as the base product database, with all the useful information. The way I want to do this, is to use a macro that only copies the combinations product reference number, with the entire base product row, if the combinations product's ID matches the base product's ID. Since a lot of combinations products match the same base product's ID, the macro needs to copy the data multiple times. Also, the combinations database has information about the exhaust's material and color in another colon (I exluded it to make my sample database less messy.). If it's possible, I want to add this information to the product name.</p>\n\n<p>This is what I have now:</p>\n\n<pre><code>Sub CopyYes()\n    Dim c As Range\n    Dim j As Long\n    Dim Source As Worksheet\n    Dim Target As Worksheet\n    Dim Condition As Worksheet\n\n\n    Set Source = ActiveWorkbook.Worksheets(\"Blad2\")\n    Set Target = ActiveWorkbook.Worksheets(\"Blad3\")\n    Set Condition = ActiveWorkbook.Worksheets(\"Blad1\")\n\n    j = 1    \n      For Each d In Condition.Range(\"A1:A86\")\n        For Each c In Source.Range(\"A1:A893\")\n            If d = c Then\n                Source.Rows(c.Row).Copy Target.Rows(j)\n                j = j + 1\n            End If\n        Next c\n      Next d\nEnd Sub\n</code></pre>\n\n<p>Much obliged,</p>\n\n<p>B. van Starkenburg</p>\n"}, {"tags": ["javascript", "jquery", "html", "ajax", "vba"], "comments": [{"owner": {"reputation": 30794, "user_id": 1906356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nOR-lGSM4OQ/AAAAAAAAAAI/AAAAAAAAAKc/JK3VzYOOB-I/photo.jpg?sz=128", "display_name": "madalinivascu", "link": "https://stackoverflow.com/users/1906356/madalinivascu"}, "edited": false, "score": 0, "creation_date": 1498638194, "post_id": 44797202, "comment_id": 76574742, "body": "what is this specific page level ? lvl 5 lvl 20 are we in a game?"}, {"owner": {"reputation": 30794, "user_id": 1906356, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nOR-lGSM4OQ/AAAAAAAAAAI/AAAAAAAAAKc/JK3VzYOOB-I/photo.jpg?sz=128", "display_name": "madalinivascu", "link": "https://stackoverflow.com/users/1906356/madalinivascu"}, "edited": false, "score": 0, "creation_date": 1498638243, "post_id": 44797202, "comment_id": 76574776, "body": "what you seek to build is called a crawler"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4573198, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5458a9e52b9221edb037816229e53218?s=128&d=identicon&r=PG", "display_name": "Petyo DImitrov", "link": "https://stackoverflow.com/users/4573198/petyo-dimitrov"}, "edited": false, "score": 0, "creation_date": 1498641876, "post_id": 44797456, "comment_id": 76577162, "body": "It is perfect. Thank you very much for the answer! :)  Can you teach me how you manage to  create this url?"}, {"owner": {"reputation": 1606, "user_id": 4296373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0FjCTYoKpgU/AAAAAAAAAAI/AAAAAAAAAIE/4W7C-1H81lQ/photo.jpg?sz=128", "display_name": "Ebrahim Poursadeqi", "link": "https://stackoverflow.com/users/4296373/ebrahim-poursadeqi"}, "reply_to_user": {"reputation": 45, "user_id": 4573198, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5458a9e52b9221edb037816229e53218?s=128&d=identicon&r=PG", "display_name": "Petyo DImitrov", "link": "https://stackoverflow.com/users/4573198/petyo-dimitrov"}, "edited": false, "score": 0, "creation_date": 1498642309, "post_id": 44797456, "comment_id": 76577463, "body": "you can go to developer mode in google chrome and in a network tab. any url is called will show there."}, {"owner": {"reputation": 45, "user_id": 4573198, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5458a9e52b9221edb037816229e53218?s=128&d=identicon&r=PG", "display_name": "Petyo DImitrov", "link": "https://stackoverflow.com/users/4573198/petyo-dimitrov"}, "edited": false, "score": 0, "creation_date": 1498648613, "post_id": 44797456, "comment_id": 76581639, "body": "Yeah I check in Network tab, but there are only files and scripts that are loaded...."}, {"owner": {"reputation": 1606, "user_id": 4296373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0FjCTYoKpgU/AAAAAAAAAAI/AAAAAAAAAIE/4W7C-1H81lQ/photo.jpg?sz=128", "display_name": "Ebrahim Poursadeqi", "link": "https://stackoverflow.com/users/4296373/ebrahim-poursadeqi"}, "reply_to_user": {"reputation": 45, "user_id": 4573198, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5458a9e52b9221edb037816229e53218?s=128&d=identicon&r=PG", "display_name": "Petyo DImitrov", "link": "https://stackoverflow.com/users/4573198/petyo-dimitrov"}, "edited": false, "score": 0, "creation_date": 1498650004, "post_id": 44797456, "comment_id": 76582524, "body": "I edited my answer and added some more detail.checked it out"}], "tags": [], "owner": {"reputation": 1606, "user_id": 4296373, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0FjCTYoKpgU/AAAAAAAAAAI/AAAAAAAAAIE/4W7C-1H81lQ/photo.jpg?sz=128", "display_name": "Ebrahim Poursadeqi", "link": "https://stackoverflow.com/users/4296373/ebrahim-poursadeqi"}, "is_accepted": true, "score": 1, "last_activity_date": 1498649955, "last_edit_date": 1498649955, "creation_date": 1498638763, "answer_id": 44797456, "question_id": 44797202, "link": "https://stackoverflow.com/questions/44797202/how-to-force-load-every-element-on-a-page/44797456#44797456", "title": "How to force load every element on a page?", "body": "<p>This is calling url </p>\n\n<pre><code>https://www.technomarket.bg/product/filter?filter_form%5Bsort%5D=default&amp;filter_form%5Bprice%5D%5Bmin%5D=39&amp;filter_form%5Bprice%5D%5Bmax%5D=2099&amp;filter_form%5Bspec_gsm_display%5D%5Bmin%5D=&amp;filter_form%5Bspec_gsm_display%5D%5Bmax%5D=&amp;filter_form%5Bspec_gsm_battery%5D%5Bmin%5D=&amp;filter_form%5Bspec_gsm_battery%5D%5Bmax%5D=&amp;filter_key=%2Ftelefoni%7Cstatic%7Cstatic&amp;from=80&amp;size=20\n</code></pre>\n\n<p>where you can set size to any arbitrary size of products you need\nor you can use application like burpsuite to change size of products you need\nin google chrome in network tab as google loading new stuff you can see xhr type request in you can see details on that\n<a href=\"https://i.stack.imgur.com/Lu3Vv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Lu3Vv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 4573198, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/5458a9e52b9221edb037816229e53218?s=128&d=identicon&r=PG", "display_name": "Petyo DImitrov", "link": "https://stackoverflow.com/users/4573198/petyo-dimitrov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 44797456, "answer_count": 1, "score": 0, "last_activity_date": 1498649955, "creation_date": 1498638044, "question_id": 44797202, "link": "https://stackoverflow.com/questions/44797202/how-to-force-load-every-element-on-a-page", "title": "How to force load every element on a page?", "body": "<p>This page have limited number of devices with class <strong><em>col-md-4</em></strong>. When you reach specific page level then another devices are loaded.<a href=\"https://www.technomarket.bg/telefoni\" rel=\"nofollow noreferrer\">enter link description here</a></p>\n\n<p>Is there a way to make a url which will show me all devices without the need to scroll to see them? \nI need this for VBA script which will make a list with devices url links.</p>\n\n<p>Thank you in advance.</p>\n"}]